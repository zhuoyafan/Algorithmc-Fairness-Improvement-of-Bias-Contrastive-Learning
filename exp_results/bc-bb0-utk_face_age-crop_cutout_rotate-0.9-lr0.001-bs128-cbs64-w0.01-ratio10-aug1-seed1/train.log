Log level set to: INFO
Set seed: 1
=======> Using Fixed Random Seed: 1 <========
save_path: exp_results/bc-bb0-utk_face_age-crop_cutout_rotate-0.9-lr0.001-bs128-cbs64-w0.01-ratio10-aug1-seed1
get_utk_face - split: train, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_age-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
Binary Target 1
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Normal Label Distribution: 
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
Binary Target 1
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Normal Label Distribution: 
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 10684, target_attr: gender, bias_attr: age bias_rate: 0.9
['[train] target_0-bias_0: 8237', '[train] target_0-bias_1: 147', '[train] target_1-bias_0: 823', '[train] target_1-bias_1: 1477']
confusion_matrix - 
 original: tensor([[8237.,  823.],
        [ 147., 1477.]]), 
 normalized: tensor([[0.909, 0.091],
        [0.091, 0.909]]), 
 b|y: tensor([[0.982, 0.018],
        [0.358, 0.642]])
get_utk_face - split: train, aug: 1, given_y: True, ratio: 10
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_age-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
Binary Target 1
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Normal Label Distribution: 
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
Binary Target 1
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Normal Label Distribution: 
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 10684, target_attr: gender, bias_attr: age bias_rate: 0.9
['[train] target_0-bias_0: 8237', '[train] target_0-bias_1: 147', '[train] target_1-bias_0: 823', '[train] target_1-bias_1: 1477']
get_utk_face - split: valid, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_age-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [1030, 195]
Target 1: [841, 202]
Binary Target 1
---------------------------
Target 0: [1030, 195]
Target 1: [841, 202]
===================================
Normal Label Distribution: 
Target 0: [1030, 195]
Target 1: [841, 202]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 2268, target_attr: gender, bias_attr: age bias_rate: 0.9
['[valid] target_0-bias_0: 1030', '[valid] target_0-bias_1: 195', '[valid] target_1-bias_0: 841', '[valid] target_1-bias_1: 202']
get_utk_face - split: test, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_age-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [1061, 176]
Target 1: [867, 165]
Binary Target 1
---------------------------
Target 0: [1061, 176]
Target 1: [867, 165]
===================================
Normal Label Distribution: 
Target 0: [1061, 176]
Target 1: [867, 165]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 2269, target_attr: gender, bias_attr: age bias_rate: 0.9
['[test] target_0-bias_0: 1061', '[test] target_0-bias_1: 176', '[test] target_1-bias_0: 867', '[test] target_1-bias_1: 165']
decay_epochs: [6, 13]
[1 / 20] Learning rate: 0.001 weight: 0.01
[1 / 20] Loss: 4.8780792401284145 CE Loss: 0.5591205727826428 Con Loss: 4.87248803506135
[1 / 20] tensor([[0.999, 1.000],
        [0.005, 0.006]]) {'epoch': 1, 'valid/acc': 54.012, 'valid/acc_unbiased': 50.11, 'valid/diff': 0.274, 'valid/acc_skew': 50.119, 'valid/acc_align': 50.102, 'test/acc': 54.694, 'test/acc_unbiased': 50.243, 'test/diff': 0.119, 'test/acc_skew': 50.231, 'test/acc_align': 50.256}
[1 / 20] best valid accuracy: 50.110 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 54.012, 'best_valid_valid/acc_unbiased': 50.11, 'best_valid_valid/diff': 0.274, 'best_valid_valid/acc_skew': 50.119, 'best_valid_valid/acc_align': 50.102, 'best_valid_test/acc': 54.694, 'best_valid_test/acc_unbiased': 50.243, 'best_valid_test/diff': 0.119, 'best_valid_test/acc_skew': 50.231, 'best_valid_test/acc_align': 50.256}
[1 / 20] best test accuracy: 50.243 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 54.012, 'best_test_valid/acc_unbiased': 50.11, 'best_test_valid/diff': 0.274, 'best_test_valid/acc_skew': 50.119, 'best_test_valid/acc_align': 50.102, 'best_test_test/acc': 54.694, 'best_test_test/acc_unbiased': 50.243, 'best_test_test/diff': 0.119, 'best_test_test/acc_skew': 50.231, 'best_test_test/acc_align': 50.256}
[2 / 20] Learning rate: 0.001 weight: 0.01
[2 / 20] Loss: 4.748751446442942 CE Loss: 0.5335261057664821 Con Loss: 4.743416185996721
[2 / 20] tensor([[0.997, 1.000],
        [0.003, 0.006]]) {'epoch': 2, 'valid/acc': 54.101, 'valid/acc_unbiased': 50.269, 'valid/diff': 0.451, 'valid/acc_skew': 50.238, 'valid/acc_align': 50.301, 'test/acc': 54.561, 'test/acc_unbiased': 50.167, 'test/diff': 0.271, 'test/acc_skew': 50.173, 'test/acc_align': 50.162}
[2 / 20] best valid accuracy: 50.269 at epoch 2 
 best_stats: {'best_valid_epoch': 2, 'best_valid_valid/acc': 54.101, 'best_valid_valid/acc_unbiased': 50.269, 'best_valid_valid/diff': 0.451, 'best_valid_valid/acc_skew': 50.238, 'best_valid_valid/acc_align': 50.301, 'best_valid_test/acc': 54.561, 'best_valid_test/acc_unbiased': 50.167, 'best_valid_test/diff': 0.271, 'best_valid_test/acc_skew': 50.173, 'best_valid_test/acc_align': 50.162}
[2 / 20] best test accuracy: 50.243 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 54.012, 'best_test_valid/acc_unbiased': 50.11, 'best_test_valid/diff': 0.274, 'best_test_valid/acc_skew': 50.119, 'best_test_valid/acc_align': 50.102, 'best_test_test/acc': 54.694, 'best_test_test/acc_unbiased': 50.243, 'best_test_test/diff': 0.119, 'best_test_test/acc_skew': 50.231, 'best_test_test/acc_align': 50.256}
[3 / 20] Learning rate: 0.001 weight: 0.01
[3 / 20] Loss: 4.706516385123061 CE Loss: 0.5354390049953668 Con Loss: 4.701161981566218
[3 / 20] tensor([[0.994, 1.000],
        [0.025, 0.000]]) {'epoch': 3, 'valid/acc': 54.365, 'valid/acc_unbiased': 50.271, 'valid/diff': 1.124, 'valid/acc_skew': 50.832, 'valid/acc_align': 49.709, 'test/acc': 55.223, 'test/acc_unbiased': 50.493, 'test/diff': 1.551, 'test/acc_skew': 51.269, 'test/acc_align': 49.717}
[3 / 20] best valid accuracy: 50.271 at epoch 3 
 best_stats: {'best_valid_epoch': 3, 'best_valid_valid/acc': 54.365, 'best_valid_valid/acc_unbiased': 50.271, 'best_valid_valid/diff': 1.124, 'best_valid_valid/acc_skew': 50.832, 'best_valid_valid/acc_align': 49.709, 'best_valid_test/acc': 55.223, 'best_valid_test/acc_unbiased': 50.493, 'best_valid_test/diff': 1.551, 'best_valid_test/acc_skew': 51.269, 'best_valid_test/acc_align': 49.717}
[3 / 20] best test accuracy: 50.493 at epoch 3 
 best_stats: {'best_test_epoch': 3, 'best_test_valid/acc': 54.365, 'best_test_valid/acc_unbiased': 50.271, 'best_test_valid/diff': 1.124, 'best_test_valid/acc_skew': 50.832, 'best_test_valid/acc_align': 49.709, 'best_test_test/acc': 55.223, 'best_test_test/acc_unbiased': 50.493, 'best_test_test/diff': 1.551, 'best_test_test/acc_skew': 51.269, 'best_test_test/acc_align': 49.717}
[4 / 20] Learning rate: 0.001 weight: 0.01
[4 / 20] Loss: 4.702339279834629 CE Loss: 0.5314450970038811 Con Loss: 4.69702483026868
[4 / 20] tensor([[1.000, 1.000],
        [0.003, 0.000]]) {'epoch': 4, 'valid/acc': 54.101, 'valid/acc_unbiased': 50.153, 'valid/diff': 0.188, 'valid/acc_skew': 50.059, 'valid/acc_align': 50.248, 'test/acc': 54.65, 'test/acc_unbiased': 50.087, 'test/diff': 0.173, 'test/acc_skew': 50.173, 'test/acc_align': 50.0}
[4 / 20] best valid accuracy: 50.271 at epoch 3 
 best_stats: {'best_valid_epoch': 3, 'best_valid_valid/acc': 54.365, 'best_valid_valid/acc_unbiased': 50.271, 'best_valid_valid/diff': 1.124, 'best_valid_valid/acc_skew': 50.832, 'best_valid_valid/acc_align': 49.709, 'best_valid_test/acc': 55.223, 'best_valid_test/acc_unbiased': 50.493, 'best_valid_test/diff': 1.551, 'best_valid_test/acc_skew': 51.269, 'best_valid_test/acc_align': 49.717}
[4 / 20] best test accuracy: 50.493 at epoch 3 
 best_stats: {'best_test_epoch': 3, 'best_test_valid/acc': 54.365, 'best_test_valid/acc_unbiased': 50.271, 'best_test_valid/diff': 1.124, 'best_test_valid/acc_skew': 50.832, 'best_test_valid/acc_align': 49.709, 'best_test_test/acc': 55.223, 'best_test_test/acc_unbiased': 50.493, 'best_test_test/diff': 1.551, 'best_test_test/acc_skew': 51.269, 'best_test_test/acc_align': 49.717}
[5 / 20] Learning rate: 0.001 weight: 0.01
[5 / 20] Loss: 4.693144315193316 CE Loss: 0.5249655847913627 Con Loss: 4.687894658353256
[5 / 20] tensor([[1., 1.],
        [0., 0.]]) {'epoch': 5, 'valid/acc': 54.012, 'valid/acc_unbiased': 50.0, 'valid/diff': 0.0, 'valid/acc_skew': 50.0, 'valid/acc_align': 50.0, 'test/acc': 54.517, 'test/acc_unbiased': 50.0, 'test/diff': 0.0, 'test/acc_skew': 50.0, 'test/acc_align': 50.0}
[5 / 20] best valid accuracy: 50.271 at epoch 3 
 best_stats: {'best_valid_epoch': 3, 'best_valid_valid/acc': 54.365, 'best_valid_valid/acc_unbiased': 50.271, 'best_valid_valid/diff': 1.124, 'best_valid_valid/acc_skew': 50.832, 'best_valid_valid/acc_align': 49.709, 'best_valid_test/acc': 55.223, 'best_valid_test/acc_unbiased': 50.493, 'best_valid_test/diff': 1.551, 'best_valid_test/acc_skew': 51.269, 'best_valid_test/acc_align': 49.717}
[5 / 20] best test accuracy: 50.493 at epoch 3 
 best_stats: {'best_test_epoch': 3, 'best_test_valid/acc': 54.365, 'best_test_valid/acc_unbiased': 50.271, 'best_test_valid/diff': 1.124, 'best_test_valid/acc_skew': 50.832, 'best_test_valid/acc_align': 49.709, 'best_test_test/acc': 55.223, 'best_test_test/acc_unbiased': 50.493, 'best_test_test/diff': 1.551, 'best_test_test/acc_skew': 51.269, 'best_test_test/acc_align': 49.717}
[6 / 20] Learning rate: 0.001 weight: 0.01
[6 / 20] Loss: 4.627795157830664 CE Loss: 0.506761345098814 Con Loss: 4.622727559417073
[6 / 20] tensor([[0.982, 0.949],
        [0.076, 0.139]]) {'epoch': 6, 'valid/acc': 56.834, 'valid/acc_unbiased': 53.98, 'valid/diff': 2.677, 'valid/acc_skew': 52.642, 'valid/acc_align': 55.319, 'test/acc': 57.206, 'test/acc_unbiased': 53.662, 'test/diff': 4.825, 'test/acc_skew': 51.249, 'test/acc_align': 56.074}
[6 / 20] best valid accuracy: 53.980 at epoch 6 
 best_stats: {'best_valid_epoch': 6, 'best_valid_valid/acc': 56.834, 'best_valid_valid/acc_unbiased': 53.98, 'best_valid_valid/diff': 2.677, 'best_valid_valid/acc_skew': 52.642, 'best_valid_valid/acc_align': 55.319, 'best_valid_test/acc': 57.206, 'best_valid_test/acc_unbiased': 53.662, 'best_valid_test/diff': 4.825, 'best_valid_test/acc_skew': 51.249, 'best_valid_test/acc_align': 56.074}
[6 / 20] best test accuracy: 53.662 at epoch 6 
 best_stats: {'best_test_epoch': 6, 'best_test_valid/acc': 56.834, 'best_test_valid/acc_unbiased': 53.98, 'best_test_valid/diff': 2.677, 'best_test_valid/acc_skew': 52.642, 'best_test_valid/acc_align': 55.319, 'best_test_test/acc': 57.206, 'best_test_test/acc_unbiased': 53.662, 'best_test_test/diff': 4.825, 'best_test_test/acc_skew': 51.249, 'best_test_test/acc_align': 56.074}
[7 / 20] Learning rate: 0.0001 weight: 0.01
[7 / 20] Loss: 4.643845556738313 CE Loss: 0.4967388930904513 Con Loss: 4.638878198385863
[7 / 20] tensor([[0.946, 0.909],
        [0.223, 0.212]]) {'epoch': 7, 'valid/acc': 61.905, 'valid/acc_unbiased': 58.204, 'valid/diff': 2.813, 'valid/acc_skew': 58.58, 'valid/acc_align': 57.828, 'test/acc': 61.349, 'test/acc_unbiased': 57.252, 'test/diff': 2.384, 'test/acc_skew': 56.585, 'test/acc_align': 57.92}
[7 / 20] best valid accuracy: 58.204 at epoch 7 
 best_stats: {'best_valid_epoch': 7, 'best_valid_valid/acc': 61.905, 'best_valid_valid/acc_unbiased': 58.204, 'best_valid_valid/diff': 2.813, 'best_valid_valid/acc_skew': 58.58, 'best_valid_valid/acc_align': 57.828, 'best_valid_test/acc': 61.349, 'best_valid_test/acc_unbiased': 57.252, 'best_valid_test/diff': 2.384, 'best_valid_test/acc_skew': 56.585, 'best_valid_test/acc_align': 57.92}
[7 / 20] best test accuracy: 57.252 at epoch 7 
 best_stats: {'best_test_epoch': 7, 'best_test_valid/acc': 61.905, 'best_test_valid/acc_unbiased': 58.204, 'best_test_valid/diff': 2.813, 'best_test_valid/acc_skew': 58.58, 'best_test_valid/acc_align': 57.828, 'best_test_test/acc': 61.349, 'best_test_test/acc_unbiased': 57.252, 'best_test_test/diff': 2.384, 'best_test_test/acc_skew': 56.585, 'best_test_test/acc_align': 57.92}
[8 / 20] Learning rate: 0.0001 weight: 0.01
[8 / 20] Loss: 4.596137266933851 CE Loss: 0.4976631691285351 Con Loss: 4.591160636053511
[8 / 20] tensor([[0.968, 0.938],
        [0.171, 0.164]]) {'epoch': 8, 'valid/acc': 60.979, 'valid/acc_unbiased': 57.481, 'valid/diff': 1.26, 'valid/acc_skew': 57.502, 'valid/acc_align': 57.459, 'test/acc': 60.247, 'test/acc_unbiased': 55.995, 'test/diff': 1.876, 'test/acc_skew': 55.41, 'test/acc_align': 56.58}
[8 / 20] best valid accuracy: 58.204 at epoch 7 
 best_stats: {'best_valid_epoch': 7, 'best_valid_valid/acc': 61.905, 'best_valid_valid/acc_unbiased': 58.204, 'best_valid_valid/diff': 2.813, 'best_valid_valid/acc_skew': 58.58, 'best_valid_valid/acc_align': 57.828, 'best_valid_test/acc': 61.349, 'best_valid_test/acc_unbiased': 57.252, 'best_valid_test/diff': 2.384, 'best_valid_test/acc_skew': 56.585, 'best_valid_test/acc_align': 57.92}
[8 / 20] best test accuracy: 57.252 at epoch 7 
 best_stats: {'best_test_epoch': 7, 'best_test_valid/acc': 61.905, 'best_test_valid/acc_unbiased': 58.204, 'best_test_valid/diff': 2.813, 'best_test_valid/acc_skew': 58.58, 'best_test_valid/acc_align': 57.828, 'best_test_test/acc': 61.349, 'best_test_test/acc_unbiased': 57.252, 'best_test_test/diff': 2.384, 'best_test_test/acc_skew': 56.585, 'best_test_test/acc_align': 57.92}
[9 / 20] Learning rate: 0.0001 weight: 0.01
[9 / 20] Loss: 4.603059417341854 CE Loss: 0.4866218709490443 Con Loss: 4.598193190777092
[9 / 20] tensor([[0.958, 0.892],
        [0.233, 0.273]]) {'epoch': 9, 'valid/acc': 63.272, 'valid/acc_unbiased': 60.618, 'valid/diff': 5.972, 'valid/acc_skew': 57.632, 'valid/acc_align': 63.604, 'test/acc': 62.583, 'test/acc_unbiased': 58.884, 'test/diff': 5.264, 'test/acc_skew': 56.252, 'test/acc_align': 61.516}
[9 / 20] best valid accuracy: 60.618 at epoch 9 
 best_stats: {'best_valid_epoch': 9, 'best_valid_valid/acc': 63.272, 'best_valid_valid/acc_unbiased': 60.618, 'best_valid_valid/diff': 5.972, 'best_valid_valid/acc_skew': 57.632, 'best_valid_valid/acc_align': 63.604, 'best_valid_test/acc': 62.583, 'best_valid_test/acc_unbiased': 58.884, 'best_valid_test/diff': 5.264, 'best_valid_test/acc_skew': 56.252, 'best_valid_test/acc_align': 61.516}
[9 / 20] best test accuracy: 58.884 at epoch 9 
 best_stats: {'best_test_epoch': 9, 'best_test_valid/acc': 63.272, 'best_test_valid/acc_unbiased': 60.618, 'best_test_valid/diff': 5.972, 'best_test_valid/acc_skew': 57.632, 'best_test_valid/acc_align': 63.604, 'best_test_test/acc': 62.583, 'best_test_test/acc_unbiased': 58.884, 'best_test_test/diff': 5.264, 'best_test_test/acc_skew': 56.252, 'best_test_test/acc_align': 61.516}
[10 / 20] Learning rate: 0.0001 weight: 0.01
[10 / 20] Loss: 4.565462289165352 CE Loss: 0.48269080591308894 Con Loss: 4.560635375690924
[10 / 20] tensor([[0.965, 0.892],
        [0.239, 0.279]]) {'epoch': 10, 'valid/acc': 63.977, 'valid/acc_unbiased': 60.598, 'valid/diff': 4.818, 'valid/acc_skew': 58.189, 'valid/acc_align': 63.007, 'test/acc': 63.2, 'test/acc_unbiased': 59.368, 'test/diff': 5.656, 'test/acc_skew': 56.54, 'test/acc_align': 62.196}
[10 / 20] best valid accuracy: 60.618 at epoch 9 
 best_stats: {'best_valid_epoch': 9, 'best_valid_valid/acc': 63.272, 'best_valid_valid/acc_unbiased': 60.618, 'best_valid_valid/diff': 5.972, 'best_valid_valid/acc_skew': 57.632, 'best_valid_valid/acc_align': 63.604, 'best_valid_test/acc': 62.583, 'best_valid_test/acc_unbiased': 58.884, 'best_valid_test/diff': 5.264, 'best_valid_test/acc_skew': 56.252, 'best_valid_test/acc_align': 61.516}
[10 / 20] best test accuracy: 59.368 at epoch 10 
 best_stats: {'best_test_epoch': 10, 'best_test_valid/acc': 63.977, 'best_test_valid/acc_unbiased': 60.598, 'best_test_valid/diff': 4.818, 'best_test_valid/acc_skew': 58.189, 'best_test_valid/acc_align': 63.007, 'best_test_test/acc': 63.2, 'best_test_test/acc_unbiased': 59.368, 'best_test_test/diff': 5.656, 'best_test_test/acc_skew': 56.54, 'best_test_test/acc_align': 62.196}
[11 / 20] Learning rate: 0.0001 weight: 0.01
[11 / 20] Loss: 4.5463636595405745 CE Loss: 0.47711439986926973 Con Loss: 4.541592515483415
[11 / 20] tensor([[0.963, 0.875],
        [0.261, 0.285]]) {'epoch': 11, 'valid/acc': 64.991, 'valid/acc_unbiased': 61.92, 'valid/diff': 6.823, 'valid/acc_skew': 58.509, 'valid/acc_align': 65.332, 'test/acc': 63.861, 'test/acc_unbiased': 59.594, 'test/diff': 5.621, 'test/acc_skew': 56.783, 'test/acc_align': 62.405}
[11 / 20] best valid accuracy: 61.920 at epoch 11 
 best_stats: {'best_valid_epoch': 11, 'best_valid_valid/acc': 64.991, 'best_valid_valid/acc_unbiased': 61.92, 'best_valid_valid/diff': 6.823, 'best_valid_valid/acc_skew': 58.509, 'best_valid_valid/acc_align': 65.332, 'best_valid_test/acc': 63.861, 'best_valid_test/acc_unbiased': 59.594, 'best_valid_test/diff': 5.621, 'best_valid_test/acc_skew': 56.783, 'best_valid_test/acc_align': 62.405}
[11 / 20] best test accuracy: 59.594 at epoch 11 
 best_stats: {'best_test_epoch': 11, 'best_test_valid/acc': 64.991, 'best_test_valid/acc_unbiased': 61.92, 'best_test_valid/diff': 6.823, 'best_test_valid/acc_skew': 58.509, 'best_test_valid/acc_align': 65.332, 'best_test_test/acc': 63.861, 'best_test_test/acc_unbiased': 59.594, 'best_test_test/diff': 5.621, 'best_test_test/acc_skew': 56.783, 'best_test_test/acc_align': 62.405}
[12 / 20] Learning rate: 0.0001 weight: 0.01
[12 / 20] Loss: 4.573188924557348 CE Loss: 0.4779605557971213 Con Loss: 4.568409329538977
[12 / 20] tensor([[0.966, 0.812],
        [0.295, 0.358]]) {'epoch': 12, 'valid/acc': 65.3, 'valid/acc_unbiased': 61.212, 'valid/diff': 10.015, 'valid/acc_skew': 56.205, 'valid/acc_align': 66.22, 'test/acc': 65.359, 'test/acc_unbiased': 60.785, 'test/diff': 10.794, 'test/acc_skew': 55.389, 'test/acc_align': 66.182}
[12 / 20] best valid accuracy: 61.920 at epoch 11 
 best_stats: {'best_valid_epoch': 11, 'best_valid_valid/acc': 64.991, 'best_valid_valid/acc_unbiased': 61.92, 'best_valid_valid/diff': 6.823, 'best_valid_valid/acc_skew': 58.509, 'best_valid_valid/acc_align': 65.332, 'best_valid_test/acc': 63.861, 'best_valid_test/acc_unbiased': 59.594, 'best_valid_test/diff': 5.621, 'best_valid_test/acc_skew': 56.783, 'best_valid_test/acc_align': 62.405}
[12 / 20] best test accuracy: 60.785 at epoch 12 
 best_stats: {'best_test_epoch': 12, 'best_test_valid/acc': 65.3, 'best_test_valid/acc_unbiased': 61.212, 'best_test_valid/diff': 10.015, 'best_test_valid/acc_skew': 56.205, 'best_test_valid/acc_align': 66.22, 'best_test_test/acc': 65.359, 'best_test_test/acc_unbiased': 60.785, 'best_test_test/diff': 10.794, 'best_test_test/acc_skew': 55.389, 'best_test_test/acc_align': 66.182}
[13 / 20] Learning rate: 0.0001 weight: 0.01
[13 / 20] Loss: 4.551832138220052 CE Loss: 0.4680584133653237 Con Loss: 4.547151538594659
[13 / 20] tensor([[0.969, 0.841],
        [0.286, 0.345]]) {'epoch': 13, 'valid/acc': 65.564, 'valid/acc_unbiased': 62.446, 'valid/diff': 10.12, 'valid/acc_skew': 57.387, 'valid/acc_align': 67.506, 'test/acc': 65.271, 'test/acc_unbiased': 61.033, 'test/diff': 9.37, 'test/acc_skew': 56.348, 'test/acc_align': 65.718}
[13 / 20] best valid accuracy: 62.446 at epoch 13 
 best_stats: {'best_valid_epoch': 13, 'best_valid_valid/acc': 65.564, 'best_valid_valid/acc_unbiased': 62.446, 'best_valid_valid/diff': 10.12, 'best_valid_valid/acc_skew': 57.387, 'best_valid_valid/acc_align': 67.506, 'best_valid_test/acc': 65.271, 'best_valid_test/acc_unbiased': 61.033, 'best_valid_test/diff': 9.37, 'best_valid_test/acc_skew': 56.348, 'best_valid_test/acc_align': 65.718}
[13 / 20] best test accuracy: 61.033 at epoch 13 
 best_stats: {'best_test_epoch': 13, 'best_test_valid/acc': 65.564, 'best_test_valid/acc_unbiased': 62.446, 'best_test_valid/diff': 10.12, 'best_test_valid/acc_skew': 57.387, 'best_test_valid/acc_align': 67.506, 'best_test_test/acc': 65.271, 'best_test_test/acc_unbiased': 61.033, 'best_test_test/diff': 9.37, 'best_test_test/acc_skew': 56.348, 'best_test_test/acc_align': 65.718}
[14 / 20] Learning rate: 1e-05 weight: 0.01
[14 / 20] Loss: 4.520828516998348 CE Loss: 0.4662088709170343 Con Loss: 4.516166408514539
[14 / 20] tensor([[0.969, 0.852],
        [0.276, 0.327]]) {'epoch': 14, 'valid/acc': 65.123, 'valid/acc_unbiased': 62.176, 'valid/diff': 7.69, 'valid/acc_skew': 58.33, 'valid/acc_align': 66.021, 'test/acc': 64.83, 'test/acc_unbiased': 60.603, 'test/diff': 8.412, 'test/acc_skew': 56.397, 'test/acc_align': 64.808}
[14 / 20] best valid accuracy: 62.446 at epoch 13 
 best_stats: {'best_valid_epoch': 13, 'best_valid_valid/acc': 65.564, 'best_valid_valid/acc_unbiased': 62.446, 'best_valid_valid/diff': 10.12, 'best_valid_valid/acc_skew': 57.387, 'best_valid_valid/acc_align': 67.506, 'best_valid_test/acc': 65.271, 'best_valid_test/acc_unbiased': 61.033, 'best_valid_test/diff': 9.37, 'best_valid_test/acc_skew': 56.348, 'best_valid_test/acc_align': 65.718}
[14 / 20] best test accuracy: 61.033 at epoch 13 
 best_stats: {'best_test_epoch': 13, 'best_test_valid/acc': 65.564, 'best_test_valid/acc_unbiased': 62.446, 'best_test_valid/diff': 10.12, 'best_test_valid/acc_skew': 57.387, 'best_test_valid/acc_align': 67.506, 'best_test_test/acc': 65.271, 'best_test_test/acc_unbiased': 61.033, 'best_test_test/diff': 9.37, 'best_test_test/acc_skew': 56.348, 'best_test_test/acc_align': 65.718}
[15 / 20] Learning rate: 1e-05 weight: 0.01
[15 / 20] Loss: 4.520156662725679 CE Loss: 0.47016060448282 Con Loss: 4.515455050666606
[15 / 20] tensor([[0.963, 0.847],
        [0.279, 0.345]]) {'epoch': 15, 'valid/acc': 65.564, 'valid/acc_unbiased': 62.555, 'valid/diff': 9.311, 'valid/acc_skew': 57.899, 'valid/acc_align': 67.21, 'test/acc': 64.786, 'test/acc_unbiased': 60.86, 'test/diff': 9.149, 'test/acc_skew': 56.286, 'test/acc_align': 65.435}
[15 / 20] best valid accuracy: 62.555 at epoch 15 
 best_stats: {'best_valid_epoch': 15, 'best_valid_valid/acc': 65.564, 'best_valid_valid/acc_unbiased': 62.555, 'best_valid_valid/diff': 9.311, 'best_valid_valid/acc_skew': 57.899, 'best_valid_valid/acc_align': 67.21, 'best_valid_test/acc': 64.786, 'best_valid_test/acc_unbiased': 60.86, 'best_valid_test/diff': 9.149, 'best_valid_test/acc_skew': 56.286, 'best_valid_test/acc_align': 65.435}
[15 / 20] best test accuracy: 61.033 at epoch 13 
 best_stats: {'best_test_epoch': 13, 'best_test_valid/acc': 65.564, 'best_test_valid/acc_unbiased': 62.446, 'best_test_valid/diff': 10.12, 'best_test_valid/acc_skew': 57.387, 'best_test_valid/acc_align': 67.506, 'best_test_test/acc': 65.271, 'best_test_test/acc_unbiased': 61.033, 'best_test_test/diff': 9.37, 'best_test_test/acc_skew': 56.348, 'best_test_test/acc_align': 65.718}
[16 / 20] Learning rate: 1e-05 weight: 0.01
[16 / 20] Loss: 4.470583816451198 CE Loss: 0.46930834306219193 Con Loss: 4.465890740152157
[16 / 20] tensor([[0.961, 0.847],
        [0.292, 0.352]]) {'epoch': 16, 'valid/acc': 65.873, 'valid/acc_unbiased': 62.786, 'valid/diff': 8.858, 'valid/acc_skew': 58.356, 'valid/acc_align': 67.215, 'test/acc': 65.227, 'test/acc_unbiased': 61.282, 'test/diff': 8.724, 'test/acc_skew': 56.92, 'test/acc_align': 65.644}
[16 / 20] best valid accuracy: 62.786 at epoch 16 
 best_stats: {'best_valid_epoch': 16, 'best_valid_valid/acc': 65.873, 'best_valid_valid/acc_unbiased': 62.786, 'best_valid_valid/diff': 8.858, 'best_valid_valid/acc_skew': 58.356, 'best_valid_valid/acc_align': 67.215, 'best_valid_test/acc': 65.227, 'best_valid_test/acc_unbiased': 61.282, 'best_valid_test/diff': 8.724, 'best_valid_test/acc_skew': 56.92, 'best_valid_test/acc_align': 65.644}
[16 / 20] best test accuracy: 61.282 at epoch 16 
 best_stats: {'best_test_epoch': 16, 'best_test_valid/acc': 65.873, 'best_test_valid/acc_unbiased': 62.786, 'best_test_valid/diff': 8.858, 'best_test_valid/acc_skew': 58.356, 'best_test_valid/acc_align': 67.215, 'best_test_test/acc': 65.227, 'best_test_test/acc_unbiased': 61.282, 'best_test_test/diff': 8.724, 'best_test_test/acc_skew': 56.92, 'best_test_test/acc_align': 65.644}
[17 / 20] Learning rate: 1e-05 weight: 0.01
[17 / 20] Loss: 4.496801191570606 CE Loss: 0.4678625322512945 Con Loss: 4.492122573738284
[17 / 20] tensor([[0.962, 0.847],
        [0.295, 0.364]]) {'epoch': 17, 'valid/acc': 65.961, 'valid/acc_unbiased': 62.632, 'valid/diff': 9.457, 'valid/acc_skew': 57.903, 'valid/acc_align': 67.36, 'test/acc': 65.491, 'test/acc_unbiased': 61.695, 'test/diff': 9.204, 'test/acc_skew': 57.093, 'test/acc_align': 66.297}
[17 / 20] best valid accuracy: 62.786 at epoch 16 
 best_stats: {'best_valid_epoch': 16, 'best_valid_valid/acc': 65.873, 'best_valid_valid/acc_unbiased': 62.786, 'best_valid_valid/diff': 8.858, 'best_valid_valid/acc_skew': 58.356, 'best_valid_valid/acc_align': 67.215, 'best_valid_test/acc': 65.227, 'best_valid_test/acc_unbiased': 61.282, 'best_valid_test/diff': 8.724, 'best_valid_test/acc_skew': 56.92, 'best_valid_test/acc_align': 65.644}
[17 / 20] best test accuracy: 61.695 at epoch 17 
 best_stats: {'best_test_epoch': 17, 'best_test_valid/acc': 65.961, 'best_test_valid/acc_unbiased': 62.632, 'best_test_valid/diff': 9.457, 'best_test_valid/acc_skew': 57.903, 'best_test_valid/acc_align': 67.36, 'best_test_test/acc': 65.491, 'best_test_test/acc_unbiased': 61.695, 'best_test_test/diff': 9.204, 'best_test_test/acc_skew': 57.093, 'best_test_test/acc_align': 66.297}
[18 / 20] Learning rate: 1e-05 weight: 0.01
[18 / 20] Loss: 4.498619195094764 CE Loss: 0.4658788758598879 Con Loss: 4.493960376269627
[18 / 20] tensor([[0.964, 0.847],
        [0.281, 0.352]]) {'epoch': 18, 'valid/acc': 65.432, 'valid/acc_unbiased': 61.874, 'valid/diff': 10.275, 'valid/acc_skew': 56.736, 'valid/acc_align': 67.011, 'test/acc': 64.963, 'test/acc_unbiased': 61.093, 'test/diff': 9.384, 'test/acc_skew': 56.401, 'test/acc_align': 65.785}
[18 / 20] best valid accuracy: 62.786 at epoch 16 
 best_stats: {'best_valid_epoch': 16, 'best_valid_valid/acc': 65.873, 'best_valid_valid/acc_unbiased': 62.786, 'best_valid_valid/diff': 8.858, 'best_valid_valid/acc_skew': 58.356, 'best_valid_valid/acc_align': 67.215, 'best_valid_test/acc': 65.227, 'best_valid_test/acc_unbiased': 61.282, 'best_valid_test/diff': 8.724, 'best_valid_test/acc_skew': 56.92, 'best_valid_test/acc_align': 65.644}
[18 / 20] best test accuracy: 61.695 at epoch 17 
 best_stats: {'best_test_epoch': 17, 'best_test_valid/acc': 65.961, 'best_test_valid/acc_unbiased': 62.632, 'best_test_valid/diff': 9.457, 'best_test_valid/acc_skew': 57.903, 'best_test_valid/acc_align': 67.36, 'best_test_test/acc': 65.491, 'best_test_test/acc_unbiased': 61.695, 'best_test_test/diff': 9.204, 'best_test_test/acc_skew': 57.093, 'best_test_test/acc_align': 66.297}
[19 / 20] Learning rate: 1e-05 weight: 0.01
[19 / 20] Loss: 4.521040596349638 CE Loss: 0.46310341463067567 Con Loss: 4.5164095392302155
[19 / 20] tensor([[0.960, 0.830],
        [0.307, 0.406]]) {'epoch': 19, 'valid/acc': 67.063, 'valid/acc_unbiased': 63.627, 'valid/diff': 12.815, 'valid/acc_skew': 57.219, 'valid/acc_align': 70.035, 'test/acc': 66.02, 'test/acc_unbiased': 62.571, 'test/diff': 11.506, 'test/acc_skew': 56.818, 'test/acc_align': 68.324}
[19 / 20] best valid accuracy: 63.627 at epoch 19 
 best_stats: {'best_valid_epoch': 19, 'best_valid_valid/acc': 67.063, 'best_valid_valid/acc_unbiased': 63.627, 'best_valid_valid/diff': 12.815, 'best_valid_valid/acc_skew': 57.219, 'best_valid_valid/acc_align': 70.035, 'best_valid_test/acc': 66.02, 'best_valid_test/acc_unbiased': 62.571, 'best_valid_test/diff': 11.506, 'best_valid_test/acc_skew': 56.818, 'best_valid_test/acc_align': 68.324}
[19 / 20] best test accuracy: 62.571 at epoch 19 
 best_stats: {'best_test_epoch': 19, 'best_test_valid/acc': 67.063, 'best_test_valid/acc_unbiased': 63.627, 'best_test_valid/diff': 12.815, 'best_test_valid/acc_skew': 57.219, 'best_test_valid/acc_align': 70.035, 'best_test_test/acc': 66.02, 'best_test_test/acc_unbiased': 62.571, 'best_test_test/diff': 11.506, 'best_test_test/acc_skew': 56.818, 'best_test_test/acc_align': 68.324}
[20 / 20] Learning rate: 1e-05 weight: 0.01
[20 / 20] Loss: 4.516153177399173 CE Loss: 0.4549860459104186 Con Loss: 4.51160331327609
[20 / 20] tensor([[0.967, 0.841],
        [0.286, 0.370]]) {'epoch': 20, 'valid/acc': 65.3, 'valid/acc_unbiased': 61.864, 'valid/diff': 11.876, 'valid/acc_skew': 55.926, 'valid/acc_align': 67.802, 'test/acc': 65.359, 'test/acc_unbiased': 61.592, 'test/diff': 10.488, 'test/acc_skew': 56.348, 'test/acc_align': 66.835}
[20 / 20] best valid accuracy: 63.627 at epoch 19 
 best_stats: {'best_valid_epoch': 19, 'best_valid_valid/acc': 67.063, 'best_valid_valid/acc_unbiased': 63.627, 'best_valid_valid/diff': 12.815, 'best_valid_valid/acc_skew': 57.219, 'best_valid_valid/acc_align': 70.035, 'best_valid_test/acc': 66.02, 'best_valid_test/acc_unbiased': 62.571, 'best_valid_test/diff': 11.506, 'best_valid_test/acc_skew': 56.818, 'best_valid_test/acc_align': 68.324}
[20 / 20] best test accuracy: 62.571 at epoch 19 
 best_stats: {'best_test_epoch': 19, 'best_test_valid/acc': 67.063, 'best_test_valid/acc_unbiased': 63.627, 'best_test_valid/diff': 12.815, 'best_test_valid/acc_skew': 57.219, 'best_test_valid/acc_align': 70.035, 'best_test_test/acc': 66.02, 'best_test_test/acc_unbiased': 62.571, 'best_test_test/diff': 11.506, 'best_test_test/acc_skew': 56.818, 'best_test_test/acc_align': 68.324}
Total training time: 0:16:30
