Log level set to: INFO
Set seed: 3
=======> Using Fixed Random Seed: 3 <========
save_path: exp_results/bc-bb0-celeba_blonde-crop_auto1-lr0.001-bs128-cbs64-w0.01-ratio30-aug1-seed3
get_celeba - split:train, aug: False, given_y: True, ratio: 0
use existing blonde indices from data/celeba/pickles/blonde
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [1628, 53486]
Target 1: [18293, 1105]
Binary Target 1
---------------------------
Target 0: [1628, 53486]
Target 1: [18293, 1105]
===================================
Normal Label Distribution: 
Target 0: [1628, 53486]
Target 1: [18293, 1105]
===================================
Use BiasedCelebASplit 
 target_attr: blonde split: train 
 tensor([[ 1628., 18293.],
        [53486.,  1105.]])
get_celeba - split:train, aug: 1, given_y: True, ratio: 30
use existing blonde indices from data/celeba/pickles/blonde
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [1599, 53508]
Target 1: [18327, 1078]
Binary Target 1
---------------------------
Target 0: [1599, 53508]
Target 1: [18327, 1078]
===================================
Normal Label Distribution: 
Target 0: [1599, 53508]
Target 1: [18327, 1078]
===================================
Use BiasedCelebASplit 
 target_attr: blonde split: train 
 tensor([[ 1599., 18327.],
        [53508.,  1078.]])
get_celeba - split:train_valid, aug: False, given_y: True, ratio: 0
use existing blonde indices from data/celeba/pickles/blonde
Use BiasedCelebASplit 
 target_attr: blonde split: train_valid 
 tensor([[  386.,  4517.],
        [13446.,   280.]])
get_celeba - split:valid, aug: False, given_y: True, ratio: 0
Use BiasedCelebASplit 
 target_attr: blonde split: valid 
 tensor([[8535., 2874.],
        [8276.,  182.]])
decay_epochs: [3, 6]
[1 / 10] Learning rate: 0.001 weight: 0.01
[1 / 10] Loss: 4.745051689508367 CE Loss: 0.2086248840486348 Con Loss: 4.74296543755346
[1 / 10] tensor([[0.881, 0.971],
        [0.873, 0.643]]) {'epoch': 1, 'valid/acc': 94.025, 'valid/acc_unbiased': 87.08, 'valid/diff': 10.832, 'valid/acc_skew': 81.664, 'valid/acc_align': 92.496, 'test/acc': 91.529, 'test/acc_unbiased': 84.21, 'test/diff': 16.039, 'test/acc_skew': 76.191, 'test/acc_align': 92.229}
[1 / 10] best valid accuracy: 87.080 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 94.025, 'best_valid_valid/acc_unbiased': 87.08, 'best_valid_valid/diff': 10.832, 'best_valid_valid/acc_skew': 81.664, 'best_valid_valid/acc_align': 92.496, 'best_valid_test/acc': 91.529, 'best_valid_test/acc_unbiased': 84.21, 'best_valid_test/diff': 16.039, 'best_valid_test/acc_skew': 76.191, 'best_valid_test/acc_align': 92.229}
[1 / 10] best test accuracy: 84.210 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 94.025, 'best_test_valid/acc_unbiased': 87.08, 'best_test_valid/diff': 10.832, 'best_test_valid/acc_skew': 81.664, 'best_test_valid/acc_align': 92.496, 'best_test_test/acc': 91.529, 'best_test_test/acc_unbiased': 84.21, 'best_test_test/diff': 16.039, 'best_test_test/acc_skew': 76.191, 'best_test_test/acc_align': 92.229}
[2 / 10] Learning rate: 0.001 weight: 0.01
[2 / 10] Loss: 4.702336764320274 CE Loss: 0.1869215203798301 Con Loss: 4.700467540543556
[2 / 10] tensor([[0.919, 0.970],
        [0.886, 0.714]]) {'epoch': 2, 'valid/acc': 94.364, 'valid/acc_unbiased': 90.269, 'valid/diff': 5.521, 'valid/acc_skew': 87.861, 'valid/acc_align': 92.677, 'test/acc': 93.326, 'test/acc_unbiased': 87.204, 'test/diff': 11.111, 'test/acc_skew': 81.649, 'test/acc_align': 92.76}
[2 / 10] best valid accuracy: 90.269 at epoch 2 
 best_stats: {'best_valid_epoch': 2, 'best_valid_valid/acc': 94.364, 'best_valid_valid/acc_unbiased': 90.269, 'best_valid_valid/diff': 5.521, 'best_valid_valid/acc_skew': 87.861, 'best_valid_valid/acc_align': 92.677, 'best_valid_test/acc': 93.326, 'best_valid_test/acc_unbiased': 87.204, 'best_valid_test/diff': 11.111, 'best_valid_test/acc_skew': 81.649, 'best_valid_test/acc_align': 92.76}
[2 / 10] best test accuracy: 87.204 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 94.364, 'best_test_valid/acc_unbiased': 90.269, 'best_test_valid/diff': 5.521, 'best_test_valid/acc_skew': 87.861, 'best_test_valid/acc_align': 92.677, 'best_test_test/acc': 93.326, 'best_test_test/acc_unbiased': 87.204, 'best_test_test/diff': 11.111, 'best_test_test/acc_skew': 81.649, 'best_test_test/acc_align': 92.76}
[3 / 10] Learning rate: 0.001 weight: 0.01
[3 / 10] Loss: 4.682607724478707 CE Loss: 0.17407976107546666 Con Loss: 4.680866920105858
[3 / 10] tensor([[0.955, 0.987],
        [0.797, 0.555]]) {'epoch': 3, 'valid/acc': 93.091, 'valid/acc_unbiased': 84.056, 'valid/diff': 9.317, 'valid/acc_skew': 79.531, 'valid/acc_align': 88.582, 'test/acc': 94.171, 'test/acc_unbiased': 82.34, 'test/diff': 13.684, 'test/acc_skew': 75.498, 'test/acc_align': 89.181}
[3 / 10] best valid accuracy: 90.269 at epoch 2 
 best_stats: {'best_valid_epoch': 2, 'best_valid_valid/acc': 94.364, 'best_valid_valid/acc_unbiased': 90.269, 'best_valid_valid/diff': 5.521, 'best_valid_valid/acc_skew': 87.861, 'best_valid_valid/acc_align': 92.677, 'best_valid_test/acc': 93.326, 'best_valid_test/acc_unbiased': 87.204, 'best_valid_test/diff': 11.111, 'best_valid_test/acc_skew': 81.649, 'best_valid_test/acc_align': 92.76}
[3 / 10] best test accuracy: 87.204 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 94.364, 'best_test_valid/acc_unbiased': 90.269, 'best_test_valid/diff': 5.521, 'best_test_valid/acc_skew': 87.861, 'best_test_valid/acc_align': 92.677, 'best_test_test/acc': 93.326, 'best_test_test/acc_unbiased': 87.204, 'best_test_test/diff': 11.111, 'best_test_test/acc_skew': 81.649, 'best_test_test/acc_align': 92.76}
[4 / 10] Learning rate: 0.0001 weight: 0.01
[4 / 10] Loss: 4.630068281676244 CE Loss: 0.15227533466210047 Con Loss: 4.628545526427109
[4 / 10] tensor([[0.921, 0.971],
        [0.904, 0.830]]) {'epoch': 4, 'valid/acc': 94.9, 'valid/acc_unbiased': 91.541, 'valid/diff': 5.067, 'valid/acc_skew': 89.548, 'valid/acc_align': 93.533, 'test/acc': 93.874, 'test/acc_unbiased': 90.659, 'test/diff': 6.213, 'test/acc_skew': 87.553, 'test/acc_align': 93.766}
[4 / 10] best valid accuracy: 91.541 at epoch 4 
 best_stats: {'best_valid_epoch': 4, 'best_valid_valid/acc': 94.9, 'best_valid_valid/acc_unbiased': 91.541, 'best_valid_valid/diff': 5.067, 'best_valid_valid/acc_skew': 89.548, 'best_valid_valid/acc_align': 93.533, 'best_valid_test/acc': 93.874, 'best_valid_test/acc_unbiased': 90.659, 'best_valid_test/diff': 6.213, 'best_valid_test/acc_skew': 87.553, 'best_valid_test/acc_align': 93.766}
[4 / 10] best test accuracy: 90.659 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 94.9, 'best_test_valid/acc_unbiased': 91.541, 'best_test_valid/diff': 5.067, 'best_test_valid/acc_skew': 89.548, 'best_test_valid/acc_align': 93.533, 'best_test_test/acc': 93.874, 'best_test_test/acc_unbiased': 90.659, 'best_test_test/diff': 6.213, 'best_test_test/acc_skew': 87.553, 'best_test_test/acc_align': 93.766}
[5 / 10] Learning rate: 0.0001 weight: 0.01
[5 / 10] Loss: 4.6131220158779085 CE Loss: 0.1419213816078789 Con Loss: 4.611702794907864
[5 / 10] tensor([[0.910, 0.972],
        [0.920, 0.791]]) {'epoch': 5, 'valid/acc': 95.212, 'valid/acc_unbiased': 92.398, 'valid/diff': 4.704, 'valid/acc_skew': 90.62, 'valid/acc_align': 94.175, 'test/acc': 93.607, 'test/acc_unbiased': 89.829, 'test/diff': 9.583, 'test/acc_skew': 85.038, 'test/acc_align': 94.62}
[5 / 10] best valid accuracy: 92.398 at epoch 5 
 best_stats: {'best_valid_epoch': 5, 'best_valid_valid/acc': 95.212, 'best_valid_valid/acc_unbiased': 92.398, 'best_valid_valid/diff': 4.704, 'best_valid_valid/acc_skew': 90.62, 'best_valid_valid/acc_align': 94.175, 'best_valid_test/acc': 93.607, 'best_valid_test/acc_unbiased': 89.829, 'best_valid_test/diff': 9.583, 'best_valid_test/acc_skew': 85.038, 'best_valid_test/acc_align': 94.62}
[5 / 10] best test accuracy: 90.659 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 94.9, 'best_test_valid/acc_unbiased': 91.541, 'best_test_valid/diff': 5.067, 'best_test_valid/acc_skew': 89.548, 'best_test_valid/acc_align': 93.533, 'best_test_test/acc': 93.874, 'best_test_test/acc_unbiased': 90.659, 'best_test_test/diff': 6.213, 'best_test_test/acc_skew': 87.553, 'best_test_test/acc_align': 93.766}
[6 / 10] Learning rate: 0.0001 weight: 0.01
[6 / 10] Loss: 4.599886513432131 CE Loss: 0.1408378838635269 Con Loss: 4.598478136232592
[6 / 10] tensor([[0.916, 0.973],
        [0.913, 0.813]]) {'epoch': 6, 'valid/acc': 95.244, 'valid/acc_unbiased': 92.385, 'valid/diff': 4.872, 'valid/acc_skew': 90.7, 'valid/acc_align': 94.069, 'test/acc': 93.809, 'test/acc_unbiased': 90.363, 'test/diff': 7.856, 'test/acc_skew': 86.436, 'test/acc_align': 94.291}
[6 / 10] best valid accuracy: 92.398 at epoch 5 
 best_stats: {'best_valid_epoch': 5, 'best_valid_valid/acc': 95.212, 'best_valid_valid/acc_unbiased': 92.398, 'best_valid_valid/diff': 4.704, 'best_valid_valid/acc_skew': 90.62, 'best_valid_valid/acc_align': 94.175, 'best_valid_test/acc': 93.607, 'best_valid_test/acc_unbiased': 89.829, 'best_valid_test/diff': 9.583, 'best_valid_test/acc_skew': 85.038, 'best_valid_test/acc_align': 94.62}
[6 / 10] best test accuracy: 90.659 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 94.9, 'best_test_valid/acc_unbiased': 91.541, 'best_test_valid/diff': 5.067, 'best_test_valid/acc_skew': 89.548, 'best_test_valid/acc_align': 93.533, 'best_test_test/acc': 93.874, 'best_test_test/acc_unbiased': 90.659, 'best_test_test/diff': 6.213, 'best_test_test/acc_skew': 87.553, 'best_test_test/acc_align': 93.766}
[7 / 10] Learning rate: 1e-05 weight: 0.01
[7 / 10] Loss: 4.591802693396288 CE Loss: 0.13494860852928742 Con Loss: 4.590453202770021
[7 / 10] tensor([[0.916, 0.972],
        [0.918, 0.791]]) {'epoch': 7, 'valid/acc': 95.282, 'valid/acc_unbiased': 92.684, 'valid/diff': 4.013, 'valid/acc_skew': 91.285, 'valid/acc_align': 94.084, 'test/acc': 93.864, 'test/acc_unbiased': 89.932, 'test/diff': 9.098, 'test/acc_skew': 85.384, 'test/acc_align': 94.481}
[7 / 10] best valid accuracy: 92.684 at epoch 7 
 best_stats: {'best_valid_epoch': 7, 'best_valid_valid/acc': 95.282, 'best_valid_valid/acc_unbiased': 92.684, 'best_valid_valid/diff': 4.013, 'best_valid_valid/acc_skew': 91.285, 'best_valid_valid/acc_align': 94.084, 'best_valid_test/acc': 93.864, 'best_valid_test/acc_unbiased': 89.932, 'best_valid_test/diff': 9.098, 'best_valid_test/acc_skew': 85.384, 'best_valid_test/acc_align': 94.481}
[7 / 10] best test accuracy: 90.659 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 94.9, 'best_test_valid/acc_unbiased': 91.541, 'best_test_valid/diff': 5.067, 'best_test_valid/acc_skew': 89.548, 'best_test_valid/acc_align': 93.533, 'best_test_test/acc': 93.874, 'best_test_test/acc_unbiased': 90.659, 'best_test_test/diff': 6.213, 'best_test_test/acc_skew': 87.553, 'best_test_test/acc_align': 93.766}
[8 / 10] Learning rate: 1e-05 weight: 0.01
[8 / 10] Loss: 4.590690938705074 CE Loss: 0.13375299504406338 Con Loss: 4.589353403820867
[8 / 10] tensor([[0.922, 0.976],
        [0.908, 0.775]]) {'epoch': 8, 'valid/acc': 95.206, 'valid/acc_unbiased': 91.794, 'valid/diff': 5.901, 'valid/acc_skew': 89.839, 'valid/acc_align': 93.749, 'test/acc': 94.101, 'test/acc_unbiased': 89.508, 'test/diff': 9.359, 'test/acc_skew': 84.829, 'test/acc_align': 94.187}
[8 / 10] best valid accuracy: 92.684 at epoch 7 
 best_stats: {'best_valid_epoch': 7, 'best_valid_valid/acc': 95.282, 'best_valid_valid/acc_unbiased': 92.684, 'best_valid_valid/diff': 4.013, 'best_valid_valid/acc_skew': 91.285, 'best_valid_valid/acc_align': 94.084, 'best_valid_test/acc': 93.864, 'best_valid_test/acc_unbiased': 89.932, 'best_valid_test/diff': 9.098, 'best_valid_test/acc_skew': 85.384, 'best_valid_test/acc_align': 94.481}
[8 / 10] best test accuracy: 90.659 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 94.9, 'best_test_valid/acc_unbiased': 91.541, 'best_test_valid/diff': 5.067, 'best_test_valid/acc_skew': 89.548, 'best_test_valid/acc_align': 93.533, 'best_test_test/acc': 93.874, 'best_test_test/acc_unbiased': 90.659, 'best_test_test/diff': 6.213, 'best_test_test/acc_skew': 87.553, 'best_test_test/acc_align': 93.766}
[9 / 10] Learning rate: 1e-05 weight: 0.01
[9 / 10] Loss: 4.582901113811982 CE Loss: 0.1331774126518328 Con Loss: 4.581569345513971
[9 / 10] tensor([[0.924, 0.974],
        [0.905, 0.786]]) {'epoch': 9, 'valid/acc': 95.212, 'valid/acc_unbiased': 92.118, 'valid/diff': 4.8, 'valid/acc_skew': 90.473, 'valid/acc_align': 93.763, 'test/acc': 94.086, 'test/acc_unbiased': 89.715, 'test/diff': 8.474, 'test/acc_skew': 85.478, 'test/acc_align': 93.952}
[9 / 10] best valid accuracy: 92.684 at epoch 7 
 best_stats: {'best_valid_epoch': 7, 'best_valid_valid/acc': 95.282, 'best_valid_valid/acc_unbiased': 92.684, 'best_valid_valid/diff': 4.013, 'best_valid_valid/acc_skew': 91.285, 'best_valid_valid/acc_align': 94.084, 'best_valid_test/acc': 93.864, 'best_valid_test/acc_unbiased': 89.932, 'best_valid_test/diff': 9.098, 'best_valid_test/acc_skew': 85.384, 'best_valid_test/acc_align': 94.481}
[9 / 10] best test accuracy: 90.659 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 94.9, 'best_test_valid/acc_unbiased': 91.541, 'best_test_valid/diff': 5.067, 'best_test_valid/acc_skew': 89.548, 'best_test_valid/acc_align': 93.533, 'best_test_test/acc': 93.874, 'best_test_test/acc_unbiased': 90.659, 'best_test_test/diff': 6.213, 'best_test_test/acc_skew': 87.553, 'best_test_test/acc_align': 93.766}
[10 / 10] Learning rate: 1e-05 weight: 0.01
[10 / 10] Loss: 4.582427555229215 CE Loss: 0.13240419819371907 Con Loss: 4.581103498750883
[10 / 10] tensor([[0.917, 0.972],
        [0.912, 0.802]]) {'epoch': 10, 'valid/acc': 95.18, 'valid/acc_unbiased': 92.284, 'valid/diff': 5.414, 'valid/acc_skew': 90.602, 'valid/acc_align': 93.965, 'test/acc': 93.829, 'test/acc_unbiased': 90.083, 'test/diff': 8.206, 'test/acc_skew': 85.98, 'test/acc_align': 94.185}
[10 / 10] best valid accuracy: 92.684 at epoch 7 
 best_stats: {'best_valid_epoch': 7, 'best_valid_valid/acc': 95.282, 'best_valid_valid/acc_unbiased': 92.684, 'best_valid_valid/diff': 4.013, 'best_valid_valid/acc_skew': 91.285, 'best_valid_valid/acc_align': 94.084, 'best_valid_test/acc': 93.864, 'best_valid_test/acc_unbiased': 89.932, 'best_valid_test/diff': 9.098, 'best_valid_test/acc_skew': 85.384, 'best_valid_test/acc_align': 94.481}
[10 / 10] best test accuracy: 90.659 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 94.9, 'best_test_valid/acc_unbiased': 91.541, 'best_test_valid/diff': 5.067, 'best_test_valid/acc_skew': 89.548, 'best_test_valid/acc_align': 93.533, 'best_test_test/acc': 93.874, 'best_test_test/acc_unbiased': 90.659, 'best_test_test/diff': 6.213, 'best_test_test/acc_skew': 87.553, 'best_test_test/acc_align': 93.766}
Total training time: 0:55:46
