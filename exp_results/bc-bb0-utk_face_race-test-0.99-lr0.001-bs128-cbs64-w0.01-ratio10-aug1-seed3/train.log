Log level set to: INFO
Set seed: 3
=======> Using Fixed Random Seed: 3 <========
save_path: exp_results/bc-bb0-utk_face_race-test-0.99-lr0.001-bs128-cbs64-w0.01-ratio10-aug1-seed3
get_utk_face - split: train, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_race-0.99
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [4407, 55]
Target 1: [44, 5529]
Binary Target 1
---------------------------
Target 0: [4407, 55]
Target 1: [44, 5529]
===================================
Normal Label Distribution: 
Target 0: [4407, 55]
Target 1: [44, 5529]
===================================
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [4407, 55]
Target 1: [44, 5529]
Binary Target 1
---------------------------
Target 0: [4407, 55]
Target 1: [44, 5529]
===================================
Normal Label Distribution: 
Target 0: [4407, 55]
Target 1: [44, 5529]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 10035, target_attr: gender, bias_attr: race bias_rate: 0.99
['[train] target_0-bias_0: 4407', '[train] target_0-bias_1: 55', '[train] target_1-bias_0: 44', '[train] target_1-bias_1: 5529']
confusion_matrix - 
 original: tensor([[4407.,   44.],
        [  55., 5529.]]), 
 normalized: tensor([[0.990, 0.010],
        [0.010, 0.990]]), 
 b|y: tensor([[0.988, 0.012],
        [0.008, 0.992]])
get_utk_face - split: train, aug: 1, given_y: True, ratio: 10
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_race-0.99
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [4407, 55]
Target 1: [44, 5529]
Binary Target 1
---------------------------
Target 0: [4407, 55]
Target 1: [44, 5529]
===================================
Normal Label Distribution: 
Target 0: [4407, 55]
Target 1: [44, 5529]
===================================
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [4407, 55]
Target 1: [44, 5529]
Binary Target 1
---------------------------
Target 0: [4407, 55]
Target 1: [44, 5529]
===================================
Normal Label Distribution: 
Target 0: [4407, 55]
Target 1: [44, 5529]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 10035, target_attr: gender, bias_attr: race bias_rate: 0.99
['[train] target_0-bias_0: 4407', '[train] target_0-bias_1: 55', '[train] target_1-bias_0: 44', '[train] target_1-bias_1: 5529']
get_utk_face - split: valid, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_race-0.99
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [583, 684]
Target 1: [457, 646]
Binary Target 1
---------------------------
Target 0: [583, 684]
Target 1: [457, 646]
===================================
Normal Label Distribution: 
Target 0: [583, 684]
Target 1: [457, 646]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 2370, target_attr: gender, bias_attr: race bias_rate: 0.99
['[valid] target_0-bias_0: 583', '[valid] target_0-bias_1: 684', '[valid] target_1-bias_0: 457', '[valid] target_1-bias_1: 646']
get_utk_face - split: test, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_race-0.99
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [558, 677]
Target 1: [462, 673]
Binary Target 1
---------------------------
Target 0: [558, 677]
Target 1: [462, 673]
===================================
Normal Label Distribution: 
Target 0: [558, 677]
Target 1: [462, 673]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 2370, target_attr: gender, bias_attr: race bias_rate: 0.99
['[test] target_0-bias_0: 558', '[test] target_0-bias_1: 677', '[test] target_1-bias_0: 462', '[test] target_1-bias_1: 673']
decay_epochs: [6, 13]
[1 / 20] Learning rate: 0.001 weight: 0.01
[1 / 20] Loss: 4.767119077455362 CE Loss: 0.6539782602096827 Con Loss: 4.760579301827454
[1 / 20] tensor([[0.900, 0.860],
        [0.249, 0.444]]) {'epoch': 1, 'valid/acc': 64.515, 'valid/acc_unbiased': 62.059, 'valid/diff': 7.072, 'valid/acc_skew': 58.523, 'valid/acc_align': 65.595, 'test/acc': 63.207, 'test/acc_unbiased': 61.313, 'test/diff': 11.766, 'test/acc_skew': 55.43, 'test/acc_align': 67.196}
[1 / 20] best valid accuracy: 62.059 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 64.515, 'best_valid_valid/acc_unbiased': 62.059, 'best_valid_valid/diff': 7.072, 'best_valid_valid/acc_skew': 58.523, 'best_valid_valid/acc_align': 65.595, 'best_valid_test/acc': 63.207, 'best_valid_test/acc_unbiased': 61.313, 'best_valid_test/diff': 11.766, 'best_valid_test/acc_skew': 55.43, 'best_valid_test/acc_align': 67.196}
[1 / 20] best test accuracy: 61.313 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 64.515, 'best_test_valid/acc_unbiased': 62.059, 'best_test_valid/diff': 7.072, 'best_test_valid/acc_skew': 58.523, 'best_test_valid/acc_align': 65.595, 'best_test_test/acc': 63.207, 'best_test_test/acc_unbiased': 61.313, 'best_test_test/diff': 11.766, 'best_test_test/acc_skew': 55.43, 'best_test_test/acc_align': 67.196}
[2 / 20] Learning rate: 0.001 weight: 0.01
[2 / 20] Loss: 4.520860182763809 CE Loss: 0.6020484603930304 Con Loss: 4.514839672246381
[2 / 20] tensor([[0.638, 0.498],
        [0.779, 0.807]]) {'epoch': 2, 'valid/acc': 68.65, 'valid/acc_unbiased': 69.166, 'valid/diff': 11.154, 'valid/acc_skew': 63.589, 'valid/acc_align': 74.743, 'test/acc': 67.342, 'test/acc_unbiased': 68.046, 'test/diff': 8.391, 'test/acc_skew': 63.85, 'test/acc_align': 72.241}
[2 / 20] best valid accuracy: 69.166 at epoch 2 
 best_stats: {'best_valid_epoch': 2, 'best_valid_valid/acc': 68.65, 'best_valid_valid/acc_unbiased': 69.166, 'best_valid_valid/diff': 11.154, 'best_valid_valid/acc_skew': 63.589, 'best_valid_valid/acc_align': 74.743, 'best_valid_test/acc': 67.342, 'best_valid_test/acc_unbiased': 68.046, 'best_valid_test/diff': 8.391, 'best_valid_test/acc_skew': 63.85, 'best_valid_test/acc_align': 72.241}
[2 / 20] best test accuracy: 68.046 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 68.65, 'best_test_valid/acc_unbiased': 69.166, 'best_test_valid/diff': 11.154, 'best_test_valid/acc_skew': 63.589, 'best_test_valid/acc_align': 74.743, 'best_test_test/acc': 67.342, 'best_test_test/acc_unbiased': 68.046, 'best_test_test/diff': 8.391, 'best_test_test/acc_skew': 63.85, 'best_test_test/acc_align': 72.241}
[3 / 20] Learning rate: 0.001 weight: 0.01
[3 / 20] Loss: 4.5479715135362415 CE Loss: 0.5907760927614194 Con Loss: 4.542063756884778
[3 / 20] tensor([[0.634, 0.564],
        [0.771, 0.865]]) {'epoch': 3, 'valid/acc': 69.958, 'valid/acc_unbiased': 70.529, 'valid/diff': 6.358, 'valid/acc_skew': 67.35, 'valid/acc_align': 73.708, 'test/acc': 70.633, 'test/acc_unbiased': 70.85, 'test/diff': 8.219, 'test/acc_skew': 66.741, 'test/acc_align': 74.96}
[3 / 20] best valid accuracy: 70.529 at epoch 3 
 best_stats: {'best_valid_epoch': 3, 'best_valid_valid/acc': 69.958, 'best_valid_valid/acc_unbiased': 70.529, 'best_valid_valid/diff': 6.358, 'best_valid_valid/acc_skew': 67.35, 'best_valid_valid/acc_align': 73.708, 'best_valid_test/acc': 70.633, 'best_valid_test/acc_unbiased': 70.85, 'best_valid_test/diff': 8.219, 'best_valid_test/acc_skew': 66.741, 'best_valid_test/acc_align': 74.96}
[3 / 20] best test accuracy: 70.850 at epoch 3 
 best_stats: {'best_test_epoch': 3, 'best_test_valid/acc': 69.958, 'best_test_valid/acc_unbiased': 70.529, 'best_test_valid/diff': 6.358, 'best_test_valid/acc_skew': 67.35, 'best_test_valid/acc_align': 73.708, 'best_test_test/acc': 70.633, 'best_test_test/acc_unbiased': 70.85, 'best_test_test/diff': 8.219, 'best_test_test/acc_skew': 66.741, 'best_test_test/acc_align': 74.96}
[4 / 20] Learning rate: 0.001 weight: 0.01
[4 / 20] Loss: 4.396745787061264 CE Loss: 0.555663892708433 Con Loss: 4.391189141931615
[4 / 20] tensor([[0.860, 0.733],
        [0.563, 0.692]]) {'epoch': 4, 'valid/acc': 72.363, 'valid/acc_unbiased': 71.483, 'valid/diff': 11.511, 'valid/acc_skew': 65.728, 'valid/acc_align': 77.239, 'test/acc': 71.814, 'test/acc_unbiased': 71.201, 'test/diff': 12.861, 'test/acc_skew': 64.771, 'test/acc_align': 77.632}
[4 / 20] best valid accuracy: 71.483 at epoch 4 
 best_stats: {'best_valid_epoch': 4, 'best_valid_valid/acc': 72.363, 'best_valid_valid/acc_unbiased': 71.483, 'best_valid_valid/diff': 11.511, 'best_valid_valid/acc_skew': 65.728, 'best_valid_valid/acc_align': 77.239, 'best_valid_test/acc': 71.814, 'best_valid_test/acc_unbiased': 71.201, 'best_valid_test/diff': 12.861, 'best_valid_test/acc_skew': 64.771, 'best_valid_test/acc_align': 77.632}
[4 / 20] best test accuracy: 71.201 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 72.363, 'best_test_valid/acc_unbiased': 71.483, 'best_test_valid/diff': 11.511, 'best_test_valid/acc_skew': 65.728, 'best_test_valid/acc_align': 77.239, 'best_test_test/acc': 71.814, 'best_test_test/acc_unbiased': 71.201, 'best_test_test/diff': 12.861, 'best_test_test/acc_skew': 64.771, 'best_test_test/acc_align': 77.632}
[5 / 20] Learning rate: 0.001 weight: 0.01
[5 / 20] Loss: 4.459560996047525 CE Loss: 0.5483706366855468 Con Loss: 4.454077269369296
[5 / 20] tensor([[0.701, 0.579],
        [0.755, 0.805]]) {'epoch': 5, 'valid/acc': 71.055, 'valid/acc_unbiased': 71.665, 'valid/diff': 8.85, 'valid/acc_skew': 67.24, 'valid/acc_align': 76.09, 'test/acc': 70.633, 'test/acc_unbiased': 71.013, 'test/diff': 8.581, 'test/acc_skew': 66.722, 'test/acc_align': 75.303}
[5 / 20] best valid accuracy: 71.665 at epoch 5 
 best_stats: {'best_valid_epoch': 5, 'best_valid_valid/acc': 71.055, 'best_valid_valid/acc_unbiased': 71.665, 'best_valid_valid/diff': 8.85, 'best_valid_valid/acc_skew': 67.24, 'best_valid_valid/acc_align': 76.09, 'best_valid_test/acc': 70.633, 'best_valid_test/acc_unbiased': 71.013, 'best_valid_test/diff': 8.581, 'best_valid_test/acc_skew': 66.722, 'best_valid_test/acc_align': 75.303}
[5 / 20] best test accuracy: 71.201 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 72.363, 'best_test_valid/acc_unbiased': 71.483, 'best_test_valid/diff': 11.511, 'best_test_valid/acc_skew': 65.728, 'best_test_valid/acc_align': 77.239, 'best_test_test/acc': 71.814, 'best_test_test/acc_unbiased': 71.201, 'best_test_test/diff': 12.861, 'best_test_test/acc_skew': 64.771, 'best_test_test/acc_align': 77.632}
[6 / 20] Learning rate: 0.001 weight: 0.01
[6 / 20] Loss: 4.590288982429372 CE Loss: 0.5531612730465781 Con Loss: 4.584757360915491
[6 / 20] tensor([[0.851, 0.765],
        [0.541, 0.578]]) {'epoch': 6, 'valid/acc': 70.844, 'valid/acc_unbiased': 70.143, 'valid/diff': 3.091, 'valid/acc_skew': 69.746, 'valid/acc_align': 70.54, 'test/acc': 68.861, 'test/acc_unbiased': 68.388, 'test/diff': 6.15, 'test/acc_skew': 65.313, 'test/acc_align': 71.463}
[6 / 20] best valid accuracy: 71.665 at epoch 5 
 best_stats: {'best_valid_epoch': 5, 'best_valid_valid/acc': 71.055, 'best_valid_valid/acc_unbiased': 71.665, 'best_valid_valid/diff': 8.85, 'best_valid_valid/acc_skew': 67.24, 'best_valid_valid/acc_align': 76.09, 'best_valid_test/acc': 70.633, 'best_valid_test/acc_unbiased': 71.013, 'best_valid_test/diff': 8.581, 'best_valid_test/acc_skew': 66.722, 'best_valid_test/acc_align': 75.303}
[6 / 20] best test accuracy: 71.201 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 72.363, 'best_test_valid/acc_unbiased': 71.483, 'best_test_valid/diff': 11.511, 'best_test_valid/acc_skew': 65.728, 'best_test_valid/acc_align': 77.239, 'best_test_test/acc': 71.814, 'best_test_test/acc_unbiased': 71.201, 'best_test_test/diff': 12.861, 'best_test_test/acc_skew': 64.771, 'best_test_test/acc_align': 77.632}
[7 / 20] Learning rate: 0.0001 weight: 0.01
[7 / 20] Loss: 4.463704436729366 CE Loss: 0.5579610784432754 Con Loss: 4.458124805862891
[7 / 20] tensor([[0.733, 0.614],
        [0.779, 0.834]]) {'epoch': 7, 'valid/acc': 72.911, 'valid/acc_unbiased': 73.374, 'valid/diff': 4.522, 'valid/acc_skew': 71.113, 'valid/acc_align': 75.634, 'test/acc': 73.671, 'test/acc_unbiased': 74.006, 'test/diff': 8.643, 'test/acc_skew': 69.685, 'test/acc_align': 78.328}
[7 / 20] best valid accuracy: 73.374 at epoch 7 
 best_stats: {'best_valid_epoch': 7, 'best_valid_valid/acc': 72.911, 'best_valid_valid/acc_unbiased': 73.374, 'best_valid_valid/diff': 4.522, 'best_valid_valid/acc_skew': 71.113, 'best_valid_valid/acc_align': 75.634, 'best_valid_test/acc': 73.671, 'best_valid_test/acc_unbiased': 74.006, 'best_valid_test/diff': 8.643, 'best_valid_test/acc_skew': 69.685, 'best_valid_test/acc_align': 78.328}
[7 / 20] best test accuracy: 74.006 at epoch 7 
 best_stats: {'best_test_epoch': 7, 'best_test_valid/acc': 72.911, 'best_test_valid/acc_unbiased': 73.374, 'best_test_valid/diff': 4.522, 'best_test_valid/acc_skew': 71.113, 'best_test_valid/acc_align': 75.634, 'best_test_test/acc': 73.671, 'best_test_test/acc_unbiased': 74.006, 'best_test_test/diff': 8.643, 'best_test_test/acc_skew': 69.685, 'best_test_test/acc_align': 78.328}
[8 / 20] Learning rate: 0.0001 weight: 0.01
[8 / 20] Loss: 4.431141578729437 CE Loss: 0.5052283846892465 Con Loss: 4.426089284523364
[8 / 20] tensor([[0.785, 0.665],
        [0.768, 0.842]]) {'epoch': 8, 'valid/acc': 76.076, 'valid/acc_unbiased': 76.41, 'valid/diff': 5.917, 'valid/acc_skew': 73.451, 'valid/acc_align': 79.368, 'test/acc': 76.371, 'test/acc_unbiased': 76.513, 'test/diff': 9.717, 'test/acc_skew': 71.655, 'test/acc_align': 81.372}
[8 / 20] best valid accuracy: 76.410 at epoch 8 
 best_stats: {'best_valid_epoch': 8, 'best_valid_valid/acc': 76.076, 'best_valid_valid/acc_unbiased': 76.41, 'best_valid_valid/diff': 5.917, 'best_valid_valid/acc_skew': 73.451, 'best_valid_valid/acc_align': 79.368, 'best_valid_test/acc': 76.371, 'best_valid_test/acc_unbiased': 76.513, 'best_valid_test/diff': 9.717, 'best_valid_test/acc_skew': 71.655, 'best_valid_test/acc_align': 81.372}
[8 / 20] best test accuracy: 76.513 at epoch 8 
 best_stats: {'best_test_epoch': 8, 'best_test_valid/acc': 76.076, 'best_test_valid/acc_unbiased': 76.41, 'best_test_valid/diff': 5.917, 'best_test_valid/acc_skew': 73.451, 'best_test_valid/acc_align': 79.368, 'best_test_test/acc': 76.371, 'best_test_test/acc_unbiased': 76.513, 'best_test_test/diff': 9.717, 'best_test_test/acc_skew': 71.655, 'best_test_test/acc_align': 81.372}
[9 / 20] Learning rate: 0.0001 weight: 0.01
[9 / 20] Loss: 4.300887488558569 CE Loss: 0.4994563501630782 Con Loss: 4.295892899536528
[9 / 20] tensor([[0.754, 0.632],
        [0.807, 0.854]]) {'epoch': 9, 'valid/acc': 76.287, 'valid/acc_unbiased': 76.956, 'valid/diff': 6.581, 'valid/acc_skew': 73.666, 'valid/acc_align': 80.247, 'test/acc': 75.823, 'test/acc_unbiased': 76.211, 'test/diff': 8.465, 'test/acc_skew': 71.978, 'test/acc_align': 80.443}
[9 / 20] best valid accuracy: 76.956 at epoch 9 
 best_stats: {'best_valid_epoch': 9, 'best_valid_valid/acc': 76.287, 'best_valid_valid/acc_unbiased': 76.956, 'best_valid_valid/diff': 6.581, 'best_valid_valid/acc_skew': 73.666, 'best_valid_valid/acc_align': 80.247, 'best_valid_test/acc': 75.823, 'best_valid_test/acc_unbiased': 76.211, 'best_valid_test/diff': 8.465, 'best_valid_test/acc_skew': 71.978, 'best_valid_test/acc_align': 80.443}
[9 / 20] best test accuracy: 76.513 at epoch 8 
 best_stats: {'best_test_epoch': 8, 'best_test_valid/acc': 76.076, 'best_test_valid/acc_unbiased': 76.41, 'best_test_valid/diff': 5.917, 'best_test_valid/acc_skew': 73.451, 'best_test_valid/acc_align': 79.368, 'best_test_test/acc': 76.371, 'best_test_test/acc_unbiased': 76.513, 'best_test_test/diff': 9.717, 'best_test_test/acc_skew': 71.655, 'best_test_test/acc_align': 81.372}
[10 / 20] Learning rate: 0.0001 weight: 0.01
[10 / 20] Loss: 4.130466797592988 CE Loss: 0.4767033866999692 Con Loss: 4.125699750427946
[10 / 20] tensor([[0.785, 0.651],
        [0.773, 0.845]]) {'epoch': 10, 'valid/acc': 76.962, 'valid/acc_unbiased': 77.413, 'valid/diff': 8.219, 'valid/acc_skew': 73.304, 'valid/acc_align': 81.523, 'test/acc': 76.16, 'test/acc_unbiased': 76.364, 'test/diff': 10.314, 'test/acc_skew': 71.207, 'test/acc_align': 81.521}
[10 / 20] best valid accuracy: 77.413 at epoch 10 
 best_stats: {'best_valid_epoch': 10, 'best_valid_valid/acc': 76.962, 'best_valid_valid/acc_unbiased': 77.413, 'best_valid_valid/diff': 8.219, 'best_valid_valid/acc_skew': 73.304, 'best_valid_valid/acc_align': 81.523, 'best_valid_test/acc': 76.16, 'best_valid_test/acc_unbiased': 76.364, 'best_valid_test/diff': 10.314, 'best_valid_test/acc_skew': 71.207, 'best_valid_test/acc_align': 81.521}
[10 / 20] best test accuracy: 76.513 at epoch 8 
 best_stats: {'best_test_epoch': 8, 'best_test_valid/acc': 76.076, 'best_test_valid/acc_unbiased': 76.41, 'best_test_valid/diff': 5.917, 'best_test_valid/acc_skew': 73.451, 'best_test_valid/acc_align': 79.368, 'best_test_test/acc': 76.371, 'best_test_test/acc_unbiased': 76.513, 'best_test_test/diff': 9.717, 'best_test_test/acc_skew': 71.655, 'best_test_test/acc_align': 81.372}
[11 / 20] Learning rate: 0.0001 weight: 0.01
[11 / 20] Loss: 4.154838637944532 CE Loss: 0.4752639381340266 Con Loss: 4.1500860210907184
[11 / 20] tensor([[0.737, 0.606],
        [0.792, 0.880]]) {'epoch': 11, 'valid/acc': 74.641, 'valid/acc_unbiased': 75.193, 'valid/diff': 9.116, 'valid/acc_skew': 70.636, 'valid/acc_align': 79.751, 'test/acc': 75.063, 'test/acc_unbiased': 75.351, 'test/diff': 10.919, 'test/acc_skew': 69.891, 'test/acc_align': 80.81}
[11 / 20] best valid accuracy: 77.413 at epoch 10 
 best_stats: {'best_valid_epoch': 10, 'best_valid_valid/acc': 76.962, 'best_valid_valid/acc_unbiased': 77.413, 'best_valid_valid/diff': 8.219, 'best_valid_valid/acc_skew': 73.304, 'best_valid_valid/acc_align': 81.523, 'best_valid_test/acc': 76.16, 'best_valid_test/acc_unbiased': 76.364, 'best_valid_test/diff': 10.314, 'best_valid_test/acc_skew': 71.207, 'best_valid_test/acc_align': 81.521}
[11 / 20] best test accuracy: 76.513 at epoch 8 
 best_stats: {'best_test_epoch': 8, 'best_test_valid/acc': 76.076, 'best_test_valid/acc_unbiased': 76.41, 'best_test_valid/diff': 5.917, 'best_test_valid/acc_skew': 73.451, 'best_test_valid/acc_align': 79.368, 'best_test_test/acc': 76.371, 'best_test_test/acc_unbiased': 76.513, 'best_test_test/diff': 9.717, 'best_test_test/acc_skew': 71.655, 'best_test_test/acc_align': 81.372}
[12 / 20] Learning rate: 0.0001 weight: 0.01
[12 / 20] Loss: 4.09768942598686 CE Loss: 0.4749445321224908 Con Loss: 4.0929399635759705
[12 / 20] tensor([[0.765, 0.592],
        [0.762, 0.895]]) {'epoch': 12, 'valid/acc': 74.219, 'valid/acc_unbiased': 74.604, 'valid/diff': 12.462, 'valid/acc_skew': 68.373, 'valid/acc_align': 80.835, 'test/acc': 75.19, 'test/acc_unbiased': 75.349, 'test/diff': 15.276, 'test/acc_skew': 67.711, 'test/acc_align': 82.987}
[12 / 20] best valid accuracy: 77.413 at epoch 10 
 best_stats: {'best_valid_epoch': 10, 'best_valid_valid/acc': 76.962, 'best_valid_valid/acc_unbiased': 77.413, 'best_valid_valid/diff': 8.219, 'best_valid_valid/acc_skew': 73.304, 'best_valid_valid/acc_align': 81.523, 'best_valid_test/acc': 76.16, 'best_valid_test/acc_unbiased': 76.364, 'best_valid_test/diff': 10.314, 'best_valid_test/acc_skew': 71.207, 'best_valid_test/acc_align': 81.521}
[12 / 20] best test accuracy: 76.513 at epoch 8 
 best_stats: {'best_test_epoch': 8, 'best_test_valid/acc': 76.076, 'best_test_valid/acc_unbiased': 76.41, 'best_test_valid/diff': 5.917, 'best_test_valid/acc_skew': 73.451, 'best_test_valid/acc_align': 79.368, 'best_test_test/acc': 76.371, 'best_test_test/acc_unbiased': 76.513, 'best_test_test/diff': 9.717, 'best_test_test/acc_skew': 71.655, 'best_test_test/acc_align': 81.372}
[13 / 20] Learning rate: 0.0001 weight: 0.01
[13 / 20] Loss: 4.025472545956401 CE Loss: 0.4764629330395108 Con Loss: 4.020707934759241
[13 / 20] tensor([[0.719, 0.575],
        [0.838, 0.912]]) {'epoch': 13, 'valid/acc': 75.401, 'valid/acc_unbiased': 76.309, 'valid/diff': 6.755, 'valid/acc_skew': 72.931, 'valid/acc_align': 79.686, 'test/acc': 75.57, 'test/acc_unbiased': 76.081, 'test/diff': 10.936, 'test/acc_skew': 70.613, 'test/acc_align': 81.549}
[13 / 20] best valid accuracy: 77.413 at epoch 10 
 best_stats: {'best_valid_epoch': 10, 'best_valid_valid/acc': 76.962, 'best_valid_valid/acc_unbiased': 77.413, 'best_valid_valid/diff': 8.219, 'best_valid_valid/acc_skew': 73.304, 'best_valid_valid/acc_align': 81.523, 'best_valid_test/acc': 76.16, 'best_valid_test/acc_unbiased': 76.364, 'best_valid_test/diff': 10.314, 'best_valid_test/acc_skew': 71.207, 'best_valid_test/acc_align': 81.521}
[13 / 20] best test accuracy: 76.513 at epoch 8 
 best_stats: {'best_test_epoch': 8, 'best_test_valid/acc': 76.076, 'best_test_valid/acc_unbiased': 76.41, 'best_test_valid/diff': 5.917, 'best_test_valid/acc_skew': 73.451, 'best_test_valid/acc_align': 79.368, 'best_test_test/acc': 76.371, 'best_test_test/acc_unbiased': 76.513, 'best_test_test/diff': 9.717, 'best_test_test/acc_skew': 71.655, 'best_test_test/acc_align': 81.372}
[14 / 20] Learning rate: 1e-05 weight: 0.01
[14 / 20] Loss: 3.8229562468355307 CE Loss: 0.48186601780514604 Con Loss: 3.818137570073727
[14 / 20] tensor([[0.754, 0.613],
        [0.818, 0.902]]) {'epoch': 14, 'valid/acc': 76.118, 'valid/acc_unbiased': 76.86, 'valid/diff': 6.318, 'valid/acc_skew': 73.701, 'valid/acc_align': 80.019, 'test/acc': 76.835, 'test/acc_unbiased': 77.19, 'test/diff': 11.262, 'test/acc_skew': 71.559, 'test/acc_align': 82.821}
[14 / 20] best valid accuracy: 77.413 at epoch 10 
 best_stats: {'best_valid_epoch': 10, 'best_valid_valid/acc': 76.962, 'best_valid_valid/acc_unbiased': 77.413, 'best_valid_valid/diff': 8.219, 'best_valid_valid/acc_skew': 73.304, 'best_valid_valid/acc_align': 81.523, 'best_valid_test/acc': 76.16, 'best_valid_test/acc_unbiased': 76.364, 'best_valid_test/diff': 10.314, 'best_valid_test/acc_skew': 71.207, 'best_valid_test/acc_align': 81.521}
[14 / 20] best test accuracy: 77.190 at epoch 14 
 best_stats: {'best_test_epoch': 14, 'best_test_valid/acc': 76.118, 'best_test_valid/acc_unbiased': 76.86, 'best_test_valid/diff': 6.318, 'best_test_valid/acc_skew': 73.701, 'best_test_valid/acc_align': 80.019, 'best_test_test/acc': 76.835, 'best_test_test/acc_unbiased': 77.19, 'best_test_test/diff': 11.262, 'best_test_test/acc_skew': 71.559, 'best_test_test/acc_align': 82.821}
[15 / 20] Learning rate: 1e-05 weight: 0.01
[15 / 20] Loss: 3.8456436765627537 CE Loss: 0.4741296666976404 Con Loss: 3.840902370425321
[15 / 20] tensor([[0.753, 0.629],
        [0.803, 0.906]]) {'epoch': 15, 'valid/acc': 76.076, 'valid/acc_unbiased': 76.835, 'valid/diff': 7.585, 'valid/acc_skew': 73.043, 'valid/acc_align': 80.628, 'test/acc': 77.089, 'test/acc_unbiased': 77.284, 'test/diff': 11.34, 'test/acc_skew': 71.614, 'test/acc_align': 82.954}
[15 / 20] best valid accuracy: 77.413 at epoch 10 
 best_stats: {'best_valid_epoch': 10, 'best_valid_valid/acc': 76.962, 'best_valid_valid/acc_unbiased': 77.413, 'best_valid_valid/diff': 8.219, 'best_valid_valid/acc_skew': 73.304, 'best_valid_valid/acc_align': 81.523, 'best_valid_test/acc': 76.16, 'best_valid_test/acc_unbiased': 76.364, 'best_valid_test/diff': 10.314, 'best_valid_test/acc_skew': 71.207, 'best_valid_test/acc_align': 81.521}
[15 / 20] best test accuracy: 77.284 at epoch 15 
 best_stats: {'best_test_epoch': 15, 'best_test_valid/acc': 76.076, 'best_test_valid/acc_unbiased': 76.835, 'best_test_valid/diff': 7.585, 'best_test_valid/acc_skew': 73.043, 'best_test_valid/acc_align': 80.628, 'best_test_test/acc': 77.089, 'best_test_test/acc_unbiased': 77.284, 'best_test_test/diff': 11.34, 'best_test_test/acc_skew': 71.614, 'best_test_test/acc_align': 82.954}
[16 / 20] Learning rate: 1e-05 weight: 0.01
[16 / 20] Loss: 3.80428666674087 CE Loss: 0.4706007843000947 Con Loss: 3.799580673061916
[16 / 20] tensor([[0.747, 0.604],
        [0.816, 0.918]]) {'epoch': 16, 'valid/acc': 75.443, 'valid/acc_unbiased': 76.249, 'valid/diff': 8.313, 'valid/acc_skew': 72.093, 'valid/acc_align': 80.406, 'test/acc': 76.835, 'test/acc_unbiased': 77.144, 'test/diff': 12.272, 'test/acc_skew': 71.008, 'test/acc_align': 83.279}
[16 / 20] best valid accuracy: 77.413 at epoch 10 
 best_stats: {'best_valid_epoch': 10, 'best_valid_valid/acc': 76.962, 'best_valid_valid/acc_unbiased': 77.413, 'best_valid_valid/diff': 8.219, 'best_valid_valid/acc_skew': 73.304, 'best_valid_valid/acc_align': 81.523, 'best_valid_test/acc': 76.16, 'best_valid_test/acc_unbiased': 76.364, 'best_valid_test/diff': 10.314, 'best_valid_test/acc_skew': 71.207, 'best_valid_test/acc_align': 81.521}
[16 / 20] best test accuracy: 77.284 at epoch 15 
 best_stats: {'best_test_epoch': 15, 'best_test_valid/acc': 76.076, 'best_test_valid/acc_unbiased': 76.835, 'best_test_valid/diff': 7.585, 'best_test_valid/acc_skew': 73.043, 'best_test_valid/acc_align': 80.628, 'best_test_test/acc': 77.089, 'best_test_test/acc_unbiased': 77.284, 'best_test_test/diff': 11.34, 'best_test_test/acc_skew': 71.614, 'best_test_test/acc_align': 82.954}
[17 / 20] Learning rate: 1e-05 weight: 0.01
[17 / 20] Loss: 3.819029118756958 CE Loss: 0.47032197211652355 Con Loss: 3.8143258890228955
[17 / 20] tensor([[0.749, 0.601],
        [0.818, 0.917]]) {'epoch': 17, 'valid/acc': 75.738, 'valid/acc_unbiased': 76.498, 'valid/diff': 8.298, 'valid/acc_skew': 72.349, 'valid/acc_align': 80.647, 'test/acc': 76.793, 'test/acc_unbiased': 77.131, 'test/diff': 12.327, 'test/acc_skew': 70.968, 'test/acc_align': 83.295}
[17 / 20] best valid accuracy: 77.413 at epoch 10 
 best_stats: {'best_valid_epoch': 10, 'best_valid_valid/acc': 76.962, 'best_valid_valid/acc_unbiased': 77.413, 'best_valid_valid/diff': 8.219, 'best_valid_valid/acc_skew': 73.304, 'best_valid_valid/acc_align': 81.523, 'best_valid_test/acc': 76.16, 'best_valid_test/acc_unbiased': 76.364, 'best_valid_test/diff': 10.314, 'best_valid_test/acc_skew': 71.207, 'best_valid_test/acc_align': 81.521}
[17 / 20] best test accuracy: 77.284 at epoch 15 
 best_stats: {'best_test_epoch': 15, 'best_test_valid/acc': 76.076, 'best_test_valid/acc_unbiased': 76.835, 'best_test_valid/diff': 7.585, 'best_test_valid/acc_skew': 73.043, 'best_test_valid/acc_align': 80.628, 'best_test_test/acc': 77.089, 'best_test_test/acc_unbiased': 77.284, 'best_test_test/diff': 11.34, 'best_test_test/acc_skew': 71.614, 'best_test_test/acc_align': 82.954}
[18 / 20] Learning rate: 1e-05 weight: 0.01
[18 / 20] Loss: 3.804729595484874 CE Loss: 0.4612499604399785 Con Loss: 3.8001170822441965
[18 / 20] tensor([[0.719, 0.570],
        [0.838, 0.933]]) {'epoch': 18, 'valid/acc': 74.557, 'valid/acc_unbiased': 75.521, 'valid/diff': 9.126, 'valid/acc_skew': 70.958, 'valid/acc_align': 80.084, 'test/acc': 76.034, 'test/acc_unbiased': 76.49, 'test/diff': 12.197, 'test/acc_skew': 70.391, 'test/acc_align': 82.589}
[18 / 20] best valid accuracy: 77.413 at epoch 10 
 best_stats: {'best_valid_epoch': 10, 'best_valid_valid/acc': 76.962, 'best_valid_valid/acc_unbiased': 77.413, 'best_valid_valid/diff': 8.219, 'best_valid_valid/acc_skew': 73.304, 'best_valid_valid/acc_align': 81.523, 'best_valid_test/acc': 76.16, 'best_valid_test/acc_unbiased': 76.364, 'best_valid_test/diff': 10.314, 'best_valid_test/acc_skew': 71.207, 'best_valid_test/acc_align': 81.521}
[18 / 20] best test accuracy: 77.284 at epoch 15 
 best_stats: {'best_test_epoch': 15, 'best_test_valid/acc': 76.076, 'best_test_valid/acc_unbiased': 76.835, 'best_test_valid/diff': 7.585, 'best_test_valid/acc_skew': 73.043, 'best_test_valid/acc_align': 80.628, 'best_test_test/acc': 77.089, 'best_test_test/acc_unbiased': 77.284, 'best_test_test/diff': 11.34, 'best_test_test/acc_skew': 71.614, 'best_test_test/acc_align': 82.954}
[19 / 20] Learning rate: 1e-05 weight: 0.01
[19 / 20] Loss: 3.923173055805611 CE Loss: 0.46092619496788856 Con Loss: 3.91856382167571
[19 / 20] tensor([[0.783, 0.620],
        [0.803, 0.903]]) {'epoch': 19, 'valid/acc': 76.118, 'valid/acc_unbiased': 76.767, 'valid/diff': 8.906, 'valid/acc_skew': 72.314, 'valid/acc_align': 81.22, 'test/acc': 77.468, 'test/acc_unbiased': 77.75, 'test/diff': 13.158, 'test/acc_skew': 71.171, 'test/acc_align': 84.329}
[19 / 20] best valid accuracy: 77.413 at epoch 10 
 best_stats: {'best_valid_epoch': 10, 'best_valid_valid/acc': 76.962, 'best_valid_valid/acc_unbiased': 77.413, 'best_valid_valid/diff': 8.219, 'best_valid_valid/acc_skew': 73.304, 'best_valid_valid/acc_align': 81.523, 'best_valid_test/acc': 76.16, 'best_valid_test/acc_unbiased': 76.364, 'best_valid_test/diff': 10.314, 'best_valid_test/acc_skew': 71.207, 'best_valid_test/acc_align': 81.521}
[19 / 20] best test accuracy: 77.750 at epoch 19 
 best_stats: {'best_test_epoch': 19, 'best_test_valid/acc': 76.118, 'best_test_valid/acc_unbiased': 76.767, 'best_test_valid/diff': 8.906, 'best_test_valid/acc_skew': 72.314, 'best_test_valid/acc_align': 81.22, 'best_test_test/acc': 77.468, 'best_test_test/acc_unbiased': 77.75, 'best_test_test/diff': 13.158, 'best_test_test/acc_skew': 71.171, 'best_test_test/acc_align': 84.329}
[20 / 20] Learning rate: 1e-05 weight: 0.01
[20 / 20] Loss: 3.9597907347410666 CE Loss: 0.46872275074323017 Con Loss: 3.955103503048093
[20 / 20] tensor([[0.735, 0.576],
        [0.835, 0.926]]) {'epoch': 20, 'valid/acc': 75.443, 'valid/acc_unbiased': 76.364, 'valid/diff': 8.912, 'valid/acc_skew': 71.908, 'valid/acc_align': 80.82, 'test/acc': 76.329, 'test/acc_unbiased': 76.801, 'test/diff': 12.445, 'test/acc_skew': 70.578, 'test/acc_align': 83.024}
[20 / 20] best valid accuracy: 77.413 at epoch 10 
 best_stats: {'best_valid_epoch': 10, 'best_valid_valid/acc': 76.962, 'best_valid_valid/acc_unbiased': 77.413, 'best_valid_valid/diff': 8.219, 'best_valid_valid/acc_skew': 73.304, 'best_valid_valid/acc_align': 81.523, 'best_valid_test/acc': 76.16, 'best_valid_test/acc_unbiased': 76.364, 'best_valid_test/diff': 10.314, 'best_valid_test/acc_skew': 71.207, 'best_valid_test/acc_align': 81.521}
[20 / 20] best test accuracy: 77.750 at epoch 19 
 best_stats: {'best_test_epoch': 19, 'best_test_valid/acc': 76.118, 'best_test_valid/acc_unbiased': 76.767, 'best_test_valid/diff': 8.906, 'best_test_valid/acc_skew': 72.314, 'best_test_valid/acc_align': 81.22, 'best_test_test/acc': 77.468, 'best_test_test/acc_unbiased': 77.75, 'best_test_test/diff': 13.158, 'best_test_test/acc_skew': 71.171, 'best_test_test/acc_align': 84.329}
Total training time: 0:52:02
