Log level set to: INFO
Set seed: 3
=======> Using Fixed Random Seed: 3 <========
save_path: exp_results/bc-bb0-celeba_smiling-crop_auto1-lr0.001-bs128-cbs64-w0.01-ratio30-aug1-seed3
get_celeba - split:train, aug: False, given_y: True, ratio: 0
use existing smiling indices from data/celeba/pickles/smiling
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [8009, 32847]
Target 1: [40621, 7981]
Binary Target 1
---------------------------
Target 0: [8009, 32847]
Target 1: [40621, 7981]
===================================
Normal Label Distribution: 
Target 0: [8009, 32847]
Target 1: [40621, 7981]
===================================
Use BiasedCelebASplit 
 target_attr: smiling split: train 
 tensor([[ 8009., 40621.],
        [32847.,  7981.]])
get_celeba - split:train, aug: 1, given_y: True, ratio: 30
use existing smiling indices from data/celeba/pickles/smiling
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [8017, 32729]
Target 1: [40802, 7910]
Binary Target 1
---------------------------
Target 0: [8017, 32729]
Target 1: [40802, 7910]
===================================
Normal Label Distribution: 
Target 0: [8017, 32729]
Target 1: [40802, 7910]
===================================
Use BiasedCelebASplit 
 target_attr: smiling split: train 
 tensor([[ 8017., 40802.],
        [32729.,  7910.]])
get_celeba - split:train_valid, aug: False, given_y: True, ratio: 0
use existing smiling indices from data/celeba/pickles/smiling
Use BiasedCelebASplit 
 target_attr: smiling split: train_valid 
 tensor([[ 1944., 10217.],
        [ 8222.,  1982.]])
get_celeba - split:valid, aug: False, given_y: True, ratio: 0
Use BiasedCelebASplit 
 target_attr: smiling split: valid 
 tensor([[5252., 6157.],
        [5013., 3445.]])
decay_epochs: [3, 6]
[1 / 10] Learning rate: 0.001 weight: 0.01
[1 / 10] Loss: 4.6872782172479575 CE Loss: 0.25696731306646303 Con Loss: 4.6847085355339795
[1 / 10] tensor([[0.949, 0.941],
        [0.891, 0.860]]) {'epoch': 1, 'valid/acc': 90.686, 'valid/acc_unbiased': 90.83, 'valid/diff': 1.867, 'valid/acc_skew': 90.647, 'valid/acc_align': 91.014, 'test/acc': 91.358, 'test/acc_unbiased': 91.03, 'test/diff': 1.926, 'test/acc_skew': 90.477, 'test/acc_align': 91.582}
[1 / 10] best valid accuracy: 90.830 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 90.686, 'best_valid_valid/acc_unbiased': 90.83, 'best_valid_valid/diff': 1.867, 'best_valid_valid/acc_skew': 90.647, 'best_valid_valid/acc_align': 91.014, 'best_valid_test/acc': 91.358, 'best_valid_test/acc_unbiased': 91.03, 'best_valid_test/diff': 1.926, 'best_valid_test/acc_skew': 90.477, 'best_valid_test/acc_align': 91.582}
[1 / 10] best test accuracy: 91.030 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 90.686, 'best_test_valid/acc_unbiased': 90.83, 'best_test_valid/diff': 1.867, 'best_test_valid/acc_skew': 90.647, 'best_test_valid/acc_align': 91.014, 'best_test_test/acc': 91.358, 'best_test_test/acc_unbiased': 91.03, 'best_test_test/diff': 1.926, 'best_test_test/acc_skew': 90.477, 'best_test_test/acc_align': 91.582}
[2 / 10] Learning rate: 0.001 weight: 0.01
[2 / 10] Loss: 4.645846935347182 CE Loss: 0.22072771178237943 Con Loss: 4.643639659382677
[2 / 10] tensor([[0.962, 0.945],
        [0.880, 0.882]]) {'epoch': 2, 'valid/acc': 90.843, 'valid/acc_unbiased': 91.479, 'valid/diff': 1.543, 'valid/acc_skew': 92.021, 'valid/acc_align': 90.936, 'test/acc': 91.851, 'test/acc_unbiased': 91.735, 'test/diff': 0.966, 'test/acc_skew': 92.218, 'test/acc_align': 91.252}
[2 / 10] best valid accuracy: 91.479 at epoch 2 
 best_stats: {'best_valid_epoch': 2, 'best_valid_valid/acc': 90.843, 'best_valid_valid/acc_unbiased': 91.479, 'best_valid_valid/diff': 1.543, 'best_valid_valid/acc_skew': 92.021, 'best_valid_valid/acc_align': 90.936, 'best_valid_test/acc': 91.851, 'best_valid_test/acc_unbiased': 91.735, 'best_valid_test/diff': 0.966, 'best_valid_test/acc_skew': 92.218, 'best_valid_test/acc_align': 91.252}
[2 / 10] best test accuracy: 91.735 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 90.843, 'best_test_valid/acc_unbiased': 91.479, 'best_test_valid/diff': 1.543, 'best_test_valid/acc_skew': 92.021, 'best_test_valid/acc_align': 90.936, 'best_test_test/acc': 91.851, 'best_test_test/acc_unbiased': 91.735, 'best_test_test/diff': 0.966, 'best_test_test/acc_skew': 92.218, 'best_test_test/acc_align': 91.252}
[3 / 10] Learning rate: 0.001 weight: 0.01
[3 / 10] Loss: 4.6430633761395645 CE Loss: 0.21669211820707082 Con Loss: 4.640896457939145
[3 / 10] tensor([[0.979, 0.973],
        [0.852, 0.810]]) {'epoch': 3, 'valid/acc': 90.284, 'valid/acc_unbiased': 90.518, 'valid/diff': 1.459, 'valid/acc_skew': 90.036, 'valid/acc_align': 90.999, 'test/acc': 90.879, 'test/acc_unbiased': 90.345, 'test/diff': 2.397, 'test/acc_skew': 89.427, 'test/acc_align': 91.264}
[3 / 10] best valid accuracy: 91.479 at epoch 2 
 best_stats: {'best_valid_epoch': 2, 'best_valid_valid/acc': 90.843, 'best_valid_valid/acc_unbiased': 91.479, 'best_valid_valid/diff': 1.543, 'best_valid_valid/acc_skew': 92.021, 'best_valid_valid/acc_align': 90.936, 'best_valid_test/acc': 91.851, 'best_valid_test/acc_unbiased': 91.735, 'best_valid_test/diff': 0.966, 'best_valid_test/acc_skew': 92.218, 'best_valid_test/acc_align': 91.252}
[3 / 10] best test accuracy: 91.735 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 90.843, 'best_test_valid/acc_unbiased': 91.479, 'best_test_valid/diff': 1.543, 'best_test_valid/acc_skew': 92.021, 'best_test_valid/acc_align': 90.936, 'best_test_test/acc': 91.851, 'best_test_test/acc_unbiased': 91.735, 'best_test_test/diff': 0.966, 'best_test_test/acc_skew': 92.218, 'best_test_test/acc_align': 91.252}
[4 / 10] Learning rate: 0.0001 weight: 0.01
[4 / 10] Loss: 4.6064920793738136 CE Loss: 0.19107114371019668 Con Loss: 4.604581359609218
[4 / 10] tensor([[0.929, 0.926],
        [0.933, 0.912]]) {'epoch': 4, 'valid/acc': 92.81, 'valid/acc_unbiased': 92.435, 'valid/diff': 1.439, 'valid/acc_skew': 91.934, 'valid/acc_align': 92.936, 'test/acc': 92.671, 'test/acc_unbiased': 92.516, 'test/diff': 1.188, 'test/acc_skew': 92.042, 'test/acc_align': 92.99}
[4 / 10] best valid accuracy: 92.435 at epoch 4 
 best_stats: {'best_valid_epoch': 4, 'best_valid_valid/acc': 92.81, 'best_valid_valid/acc_unbiased': 92.435, 'best_valid_valid/diff': 1.439, 'best_valid_valid/acc_skew': 91.934, 'best_valid_valid/acc_align': 92.936, 'best_valid_test/acc': 92.671, 'best_valid_test/acc_unbiased': 92.516, 'best_valid_test/diff': 1.188, 'best_valid_test/acc_skew': 92.042, 'best_valid_test/acc_align': 92.99}
[4 / 10] best test accuracy: 92.516 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 92.81, 'best_test_valid/acc_unbiased': 92.435, 'best_test_valid/diff': 1.439, 'best_test_valid/acc_skew': 91.934, 'best_test_valid/acc_align': 92.936, 'best_test_test/acc': 92.671, 'best_test_test/acc_unbiased': 92.516, 'best_test_test/diff': 1.188, 'best_test_test/acc_skew': 92.042, 'best_test_test/acc_align': 92.99}
[5 / 10] Learning rate: 0.0001 weight: 0.01
[5 / 10] Loss: 4.587536630758633 CE Loss: 0.18411718260453297 Con Loss: 4.585695460682256
[5 / 10] tensor([[0.915, 0.933],
        [0.939, 0.910]]) {'epoch': 5, 'valid/acc': 93.034, 'valid/acc_unbiased': 92.384, 'valid/diff': 1.874, 'valid/acc_skew': 91.447, 'valid/acc_align': 93.32, 'test/acc': 92.596, 'test/acc_unbiased': 92.41, 'test/diff': 2.339, 'test/acc_skew': 91.24, 'test/acc_align': 93.579}
[5 / 10] best valid accuracy: 92.435 at epoch 4 
 best_stats: {'best_valid_epoch': 4, 'best_valid_valid/acc': 92.81, 'best_valid_valid/acc_unbiased': 92.435, 'best_valid_valid/diff': 1.439, 'best_valid_valid/acc_skew': 91.934, 'best_valid_valid/acc_align': 92.936, 'best_valid_test/acc': 92.671, 'best_valid_test/acc_unbiased': 92.516, 'best_valid_test/diff': 1.188, 'best_valid_test/acc_skew': 92.042, 'best_valid_test/acc_align': 92.99}
[5 / 10] best test accuracy: 92.516 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 92.81, 'best_test_valid/acc_unbiased': 92.435, 'best_test_valid/diff': 1.439, 'best_test_valid/acc_skew': 91.934, 'best_test_valid/acc_align': 92.936, 'best_test_test/acc': 92.671, 'best_test_test/acc_unbiased': 92.516, 'best_test_test/diff': 1.188, 'best_test_test/acc_skew': 92.042, 'best_test_test/acc_align': 92.99}
[6 / 10] Learning rate: 0.0001 weight: 0.01
[6 / 10] Loss: 4.583862636828583 CE Loss: 0.1817581766084096 Con Loss: 4.58204505064536
[6 / 10] tensor([[0.933, 0.927],
        [0.933, 0.917]]) {'epoch': 6, 'valid/acc': 92.757, 'valid/acc_unbiased': 92.534, 'valid/diff': 1.419, 'valid/acc_skew': 92.217, 'valid/acc_align': 92.85, 'test/acc': 92.863, 'test/acc_unbiased': 92.743, 'test/diff': 1.109, 'test/acc_skew': 92.517, 'test/acc_align': 92.969}
[6 / 10] best valid accuracy: 92.534 at epoch 6 
 best_stats: {'best_valid_epoch': 6, 'best_valid_valid/acc': 92.757, 'best_valid_valid/acc_unbiased': 92.534, 'best_valid_valid/diff': 1.419, 'best_valid_valid/acc_skew': 92.217, 'best_valid_valid/acc_align': 92.85, 'best_valid_test/acc': 92.863, 'best_valid_test/acc_unbiased': 92.743, 'best_valid_test/diff': 1.109, 'best_valid_test/acc_skew': 92.517, 'best_valid_test/acc_align': 92.969}
[6 / 10] best test accuracy: 92.743 at epoch 6 
 best_stats: {'best_test_epoch': 6, 'best_test_valid/acc': 92.757, 'best_test_valid/acc_unbiased': 92.534, 'best_test_valid/diff': 1.419, 'best_test_valid/acc_skew': 92.217, 'best_test_valid/acc_align': 92.85, 'best_test_test/acc': 92.863, 'best_test_test/acc_unbiased': 92.743, 'best_test_test/diff': 1.109, 'best_test_test/acc_skew': 92.517, 'best_test_test/acc_align': 92.969}
[7 / 10] Learning rate: 1e-05 weight: 0.01
[7 / 10] Loss: 4.579773600548309 CE Loss: 0.1794641959443067 Con Loss: 4.577978955446486
[7 / 10] tensor([[0.924, 0.922],
        [0.943, 0.919]]) {'epoch': 7, 'valid/acc': 93.078, 'valid/acc_unbiased': 92.529, 'valid/diff': 1.459, 'valid/acc_skew': 91.799, 'valid/acc_align': 93.258, 'test/acc': 92.878, 'test/acc_unbiased': 92.726, 'test/diff': 1.302, 'test/acc_skew': 92.176, 'test/acc_align': 93.276}
[7 / 10] best valid accuracy: 92.534 at epoch 6 
 best_stats: {'best_valid_epoch': 6, 'best_valid_valid/acc': 92.757, 'best_valid_valid/acc_unbiased': 92.534, 'best_valid_valid/diff': 1.419, 'best_valid_valid/acc_skew': 92.217, 'best_valid_valid/acc_align': 92.85, 'best_valid_test/acc': 92.863, 'best_valid_test/acc_unbiased': 92.743, 'best_valid_test/diff': 1.109, 'best_valid_test/acc_skew': 92.517, 'best_valid_test/acc_align': 92.969}
[7 / 10] best test accuracy: 92.743 at epoch 6 
 best_stats: {'best_test_epoch': 6, 'best_test_valid/acc': 92.757, 'best_test_valid/acc_unbiased': 92.534, 'best_test_valid/diff': 1.419, 'best_test_valid/acc_skew': 92.217, 'best_test_valid/acc_align': 92.85, 'best_test_test/acc': 92.863, 'best_test_test/acc_unbiased': 92.743, 'best_test_test/diff': 1.109, 'best_test_test/acc_skew': 92.517, 'best_test_test/acc_align': 92.969}
[8 / 10] Learning rate: 1e-05 weight: 0.01
[8 / 10] Loss: 4.579625785741244 CE Loss: 0.17497287868887754 Con Loss: 4.577876053755346
[8 / 10] tensor([[0.926, 0.928],
        [0.941, 0.918]]) {'epoch': 8, 'valid/acc': 93.128, 'valid/acc_unbiased': 92.62, 'valid/diff': 1.432, 'valid/acc_skew': 91.904, 'valid/acc_align': 93.336, 'test/acc': 92.953, 'test/acc_unbiased': 92.801, 'test/diff': 1.272, 'test/acc_skew': 92.165, 'test/acc_align': 93.437}
[8 / 10] best valid accuracy: 92.620 at epoch 8 
 best_stats: {'best_valid_epoch': 8, 'best_valid_valid/acc': 93.128, 'best_valid_valid/acc_unbiased': 92.62, 'best_valid_valid/diff': 1.432, 'best_valid_valid/acc_skew': 91.904, 'best_valid_valid/acc_align': 93.336, 'best_valid_test/acc': 92.953, 'best_valid_test/acc_unbiased': 92.801, 'best_valid_test/diff': 1.272, 'best_valid_test/acc_skew': 92.165, 'best_valid_test/acc_align': 93.437}
[8 / 10] best test accuracy: 92.801 at epoch 8 
 best_stats: {'best_test_epoch': 8, 'best_test_valid/acc': 93.128, 'best_test_valid/acc_unbiased': 92.62, 'best_test_valid/diff': 1.432, 'best_test_valid/acc_skew': 91.904, 'best_test_valid/acc_align': 93.336, 'best_test_test/acc': 92.953, 'best_test_test/acc_unbiased': 92.801, 'best_test_test/diff': 1.272, 'best_test_test/acc_skew': 92.165, 'best_test_test/acc_align': 93.437}
[9 / 10] Learning rate: 1e-05 weight: 0.01
[9 / 10] Loss: 4.572663546434716 CE Loss: 0.17359068068313008 Con Loss: 4.570927641660347
[9 / 10] tensor([[0.927, 0.933],
        [0.940, 0.913]]) {'epoch': 9, 'valid/acc': 93.244, 'valid/acc_unbiased': 92.668, 'valid/diff': 1.677, 'valid/acc_skew': 91.83, 'valid/acc_align': 93.507, 'test/acc': 93.029, 'test/acc_unbiased': 92.836, 'test/diff': 1.664, 'test/acc_skew': 92.004, 'test/acc_align': 93.668}
[9 / 10] best valid accuracy: 92.668 at epoch 9 
 best_stats: {'best_valid_epoch': 9, 'best_valid_valid/acc': 93.244, 'best_valid_valid/acc_unbiased': 92.668, 'best_valid_valid/diff': 1.677, 'best_valid_valid/acc_skew': 91.83, 'best_valid_valid/acc_align': 93.507, 'best_valid_test/acc': 93.029, 'best_valid_test/acc_unbiased': 92.836, 'best_valid_test/diff': 1.664, 'best_valid_test/acc_skew': 92.004, 'best_valid_test/acc_align': 93.668}
[9 / 10] best test accuracy: 92.836 at epoch 9 
 best_stats: {'best_test_epoch': 9, 'best_test_valid/acc': 93.244, 'best_test_valid/acc_unbiased': 92.668, 'best_test_valid/diff': 1.677, 'best_test_valid/acc_skew': 91.83, 'best_test_valid/acc_align': 93.507, 'best_test_test/acc': 93.029, 'best_test_test/acc_unbiased': 92.836, 'best_test_test/diff': 1.664, 'best_test_test/acc_skew': 92.004, 'best_test_test/acc_align': 93.668}
[10 / 10] Learning rate: 1e-05 weight: 0.01
[10 / 10] Loss: 4.571756493485844 CE Loss: 0.17296425671364135 Con Loss: 4.5700268576665355
[10 / 10] tensor([[0.923, 0.929],
        [0.941, 0.918]]) {'epoch': 10, 'valid/acc': 93.11, 'valid/acc_unbiased': 92.649, 'valid/diff': 1.236, 'valid/acc_skew': 92.031, 'valid/acc_align': 93.267, 'test/acc': 92.923, 'test/acc_unbiased': 92.778, 'test/diff': 1.454, 'test/acc_skew': 92.051, 'test/acc_align': 93.505}
[10 / 10] best valid accuracy: 92.668 at epoch 9 
 best_stats: {'best_valid_epoch': 9, 'best_valid_valid/acc': 93.244, 'best_valid_valid/acc_unbiased': 92.668, 'best_valid_valid/diff': 1.677, 'best_valid_valid/acc_skew': 91.83, 'best_valid_valid/acc_align': 93.507, 'best_valid_test/acc': 93.029, 'best_valid_test/acc_unbiased': 92.836, 'best_valid_test/diff': 1.664, 'best_valid_test/acc_skew': 92.004, 'best_valid_test/acc_align': 93.668}
[10 / 10] best test accuracy: 92.836 at epoch 9 
 best_stats: {'best_test_epoch': 9, 'best_test_valid/acc': 93.244, 'best_test_valid/acc_unbiased': 92.668, 'best_test_valid/diff': 1.677, 'best_test_valid/acc_skew': 91.83, 'best_test_valid/acc_align': 93.507, 'best_test_test/acc': 93.029, 'best_test_test/acc_unbiased': 92.836, 'best_test_test/diff': 1.664, 'best_test_test/acc_skew': 92.004, 'best_test_test/acc_align': 93.668}
Total training time: 1:48:34
