Log level set to: INFO
Set seed: 3
=======> Using Fixed Random Seed: 3 <========
save_path: exp_results/bc-bb0-celeba_smiling-os_0.7-lr0.001-bs128-cbs64-w0.01-ratio30-aug1-seed3
get_celeba - split:train, aug: False, given_y: True, ratio: 0
use existing smiling indices from data/celeba/pickles/smiling
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [28434, 28434]
Target 1: [28434, 28434]
Binary Target 1
---------------------------
Target 0: [28434, 28434]
Target 1: [28434, 28434]
===================================
Normal Label Distribution: 
Target 0: [28434, 28434]
Target 1: [28434, 28434]
===================================
Use BiasedCelebASplit 
 target_attr: smiling split: train 
 tensor([[28434., 28434.],
        [28434., 28434.]])
get_celeba - split:train, aug: 1, given_y: True, ratio: 30
use existing smiling indices from data/celeba/pickles/smiling
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [28561, 28561]
Target 1: [28561, 28561]
Binary Target 1
---------------------------
Target 0: [28561, 28561]
Target 1: [28561, 28561]
===================================
Normal Label Distribution: 
Target 0: [28561, 28561]
Target 1: [28561, 28561]
===================================
Use BiasedCelebASplit 
 target_attr: smiling split: train 
 tensor([[28561., 28561.],
        [28561., 28561.]])
get_celeba - split:train_valid, aug: False, given_y: True, ratio: 0
use existing smiling indices from data/celeba/pickles/smiling
Use BiasedCelebASplit 
 target_attr: smiling split: train_valid 
 tensor([[ 1944., 10217.],
        [ 8222.,  1982.]])
get_celeba - split:valid, aug: False, given_y: True, ratio: 0
Use BiasedCelebASplit 
 target_attr: smiling split: valid 
 tensor([[5252., 6157.],
        [5013., 3445.]])
decay_epochs: [3, 6]
[1 / 10] Learning rate: 0.001 weight: 0.01
[1 / 10] Loss: 4.634672323996871 CE Loss: 0.25428613306576 Con Loss: 4.632129461443138
[1 / 10] tensor([[0.962, 0.927],
        [0.879, 0.885]]) {'epoch': 1, 'valid/acc': 90.507, 'valid/acc_unbiased': 91.224, 'valid/diff': 1.663, 'valid/acc_skew': 92.055, 'valid/acc_align': 90.392, 'test/acc': 91.423, 'test/acc_unbiased': 91.343, 'test/diff': 2.097, 'test/acc_skew': 92.05, 'test/acc_align': 90.636}
[1 / 10] best valid accuracy: 91.224 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 90.507, 'best_valid_valid/acc_unbiased': 91.224, 'best_valid_valid/diff': 1.663, 'best_valid_valid/acc_skew': 92.055, 'best_valid_valid/acc_align': 90.392, 'best_valid_test/acc': 91.423, 'best_valid_test/acc_unbiased': 91.343, 'best_valid_test/diff': 2.097, 'best_valid_test/acc_skew': 92.05, 'best_valid_test/acc_align': 90.636}
[1 / 10] best test accuracy: 91.343 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 90.507, 'best_test_valid/acc_unbiased': 91.224, 'best_test_valid/diff': 1.663, 'best_test_valid/acc_skew': 92.055, 'best_test_valid/acc_align': 90.392, 'best_test_test/acc': 91.423, 'best_test_test/acc_unbiased': 91.343, 'best_test_test/diff': 2.097, 'best_test_test/acc_skew': 92.05, 'best_test_test/acc_align': 90.636}
[2 / 10] Learning rate: 0.001 weight: 0.01
[2 / 10] Loss: 4.5984210720828305 CE Loss: 0.22600553467898057 Con Loss: 4.596161025112303
[2 / 10] tensor([[0.819, 0.799],
        [0.966, 0.957]]) {'epoch': 2, 'valid/acc': 89.332, 'valid/acc_unbiased': 88.778, 'valid/diff': 1.526, 'valid/acc_skew': 89.541, 'valid/acc_align': 88.015, 'test/acc': 88.353, 'test/acc_unbiased': 88.536, 'test/diff': 1.426, 'test/acc_skew': 89.249, 'test/acc_align': 87.823}
[2 / 10] best valid accuracy: 91.224 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 90.507, 'best_valid_valid/acc_unbiased': 91.224, 'best_valid_valid/diff': 1.663, 'best_valid_valid/acc_skew': 92.055, 'best_valid_valid/acc_align': 90.392, 'best_valid_test/acc': 91.423, 'best_valid_test/acc_unbiased': 91.343, 'best_valid_test/diff': 2.097, 'best_valid_test/acc_skew': 92.05, 'best_valid_test/acc_align': 90.636}
[2 / 10] best test accuracy: 91.343 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 90.507, 'best_test_valid/acc_unbiased': 91.224, 'best_test_valid/diff': 1.663, 'best_test_valid/acc_skew': 92.055, 'best_test_valid/acc_align': 90.392, 'best_test_test/acc': 91.423, 'best_test_test/acc_unbiased': 91.343, 'best_test_test/diff': 2.097, 'best_test_test/acc_skew': 92.05, 'best_test_test/acc_align': 90.636}
[3 / 10] Learning rate: 0.001 weight: 0.01
[3 / 10] Loss: 4.591000751846323 CE Loss: 0.22119818840393615 Con Loss: 4.588788767995283
[3 / 10] tensor([[0.933, 0.882],
        [0.906, 0.928]]) {'epoch': 3, 'valid/acc': 89.922, 'valid/acc_unbiased': 90.769, 'valid/diff': 2.888, 'valid/acc_skew': 91.651, 'valid/acc_align': 89.886, 'test/acc': 91.096, 'test/acc_unbiased': 91.227, 'test/diff': 3.578, 'test/acc_skew': 91.952, 'test/acc_align': 90.501}
[3 / 10] best valid accuracy: 91.224 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 90.507, 'best_valid_valid/acc_unbiased': 91.224, 'best_valid_valid/diff': 1.663, 'best_valid_valid/acc_skew': 92.055, 'best_valid_valid/acc_align': 90.392, 'best_valid_test/acc': 91.423, 'best_valid_test/acc_unbiased': 91.343, 'best_valid_test/diff': 2.097, 'best_valid_test/acc_skew': 92.05, 'best_valid_test/acc_align': 90.636}
[3 / 10] best test accuracy: 91.343 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 90.507, 'best_test_valid/acc_unbiased': 91.224, 'best_test_valid/diff': 1.663, 'best_test_valid/acc_skew': 92.055, 'best_test_valid/acc_align': 90.392, 'best_test_test/acc': 91.423, 'best_test_test/acc_unbiased': 91.343, 'best_test_test/diff': 2.097, 'best_test_test/acc_skew': 92.05, 'best_test_test/acc_align': 90.636}
[4 / 10] Learning rate: 0.0001 weight: 0.01
[4 / 10] Loss: 4.552561663219578 CE Loss: 0.197042109398489 Con Loss: 4.55059124228236
[4 / 10] tensor([[0.951, 0.923],
        [0.916, 0.917]]) {'epoch': 4, 'valid/acc': 91.983, 'valid/acc_unbiased': 92.406, 'valid/diff': 1.497, 'valid/acc_skew': 93.154, 'valid/acc_align': 91.658, 'test/acc': 92.701, 'test/acc_unbiased': 92.657, 'test/diff': 1.5, 'test/acc_skew': 93.35, 'test/acc_align': 91.965}
[4 / 10] best valid accuracy: 92.406 at epoch 4 
 best_stats: {'best_valid_epoch': 4, 'best_valid_valid/acc': 91.983, 'best_valid_valid/acc_unbiased': 92.406, 'best_valid_valid/diff': 1.497, 'best_valid_valid/acc_skew': 93.154, 'best_valid_valid/acc_align': 91.658, 'best_valid_test/acc': 92.701, 'best_valid_test/acc_unbiased': 92.657, 'best_valid_test/diff': 1.5, 'best_valid_test/acc_skew': 93.35, 'best_valid_test/acc_align': 91.965}
[4 / 10] best test accuracy: 92.657 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 91.983, 'best_test_valid/acc_unbiased': 92.406, 'best_test_valid/diff': 1.497, 'best_test_valid/acc_skew': 93.154, 'best_test_valid/acc_align': 91.658, 'best_test_test/acc': 92.701, 'best_test_test/acc_unbiased': 92.657, 'best_test_test/diff': 1.5, 'best_test_test/acc_skew': 93.35, 'best_test_test/acc_align': 91.965}
[5 / 10] Learning rate: 0.0001 weight: 0.01
[5 / 10] Loss: 4.538579996371559 CE Loss: 0.18902843389412502 Con Loss: 4.536689714095156
[5 / 10] tensor([[0.959, 0.936],
        [0.904, 0.906]]) {'epoch': 5, 'valid/acc': 92.005, 'valid/acc_unbiased': 92.634, 'valid/diff': 1.534, 'valid/acc_skew': 93.14, 'valid/acc_align': 92.128, 'test/acc': 92.712, 'test/acc_unbiased': 92.637, 'test/diff': 1.266, 'test/acc_skew': 93.197, 'test/acc_align': 92.076}
[5 / 10] best valid accuracy: 92.634 at epoch 5 
 best_stats: {'best_valid_epoch': 5, 'best_valid_valid/acc': 92.005, 'best_valid_valid/acc_unbiased': 92.634, 'best_valid_valid/diff': 1.534, 'best_valid_valid/acc_skew': 93.14, 'best_valid_valid/acc_align': 92.128, 'best_valid_test/acc': 92.712, 'best_valid_test/acc_unbiased': 92.637, 'best_valid_test/diff': 1.266, 'best_valid_test/acc_skew': 93.197, 'best_valid_test/acc_align': 92.076}
[5 / 10] best test accuracy: 92.657 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 91.983, 'best_test_valid/acc_unbiased': 92.406, 'best_test_valid/diff': 1.497, 'best_test_valid/acc_skew': 93.154, 'best_test_valid/acc_align': 91.658, 'best_test_test/acc': 92.701, 'best_test_test/acc_unbiased': 92.657, 'best_test_test/diff': 1.5, 'best_test_test/acc_skew': 93.35, 'best_test_test/acc_align': 91.965}
[6 / 10] Learning rate: 0.0001 weight: 0.01
[6 / 10] Loss: 4.525455712618066 CE Loss: 0.18702801891085785 Con Loss: 4.52358543295108
[6 / 10] tensor([[0.957, 0.941],
        [0.909, 0.902]]) {'epoch': 6, 'valid/acc': 92.309, 'valid/acc_unbiased': 92.685, 'valid/diff': 1.091, 'valid/acc_skew': 93.231, 'valid/acc_align': 92.139, 'test/acc': 92.873, 'test/acc_unbiased': 92.747, 'test/diff': 1.113, 'test/acc_skew': 93.304, 'test/acc_align': 92.191}
[6 / 10] best valid accuracy: 92.685 at epoch 6 
 best_stats: {'best_valid_epoch': 6, 'best_valid_valid/acc': 92.309, 'best_valid_valid/acc_unbiased': 92.685, 'best_valid_valid/diff': 1.091, 'best_valid_valid/acc_skew': 93.231, 'best_valid_valid/acc_align': 92.139, 'best_valid_test/acc': 92.873, 'best_valid_test/acc_unbiased': 92.747, 'best_valid_test/diff': 1.113, 'best_valid_test/acc_skew': 93.304, 'best_valid_test/acc_align': 92.191}
[6 / 10] best test accuracy: 92.747 at epoch 6 
 best_stats: {'best_test_epoch': 6, 'best_test_valid/acc': 92.309, 'best_test_valid/acc_unbiased': 92.685, 'best_test_valid/diff': 1.091, 'best_test_valid/acc_skew': 93.231, 'best_test_valid/acc_align': 92.139, 'best_test_test/acc': 92.873, 'best_test_test/acc_unbiased': 92.747, 'best_test_test/diff': 1.113, 'best_test_test/acc_skew': 93.304, 'best_test_test/acc_align': 92.191}
[7 / 10] Learning rate: 1e-05 weight: 0.01
[7 / 10] Loss: 4.52653487412715 CE Loss: 0.18192010431834027 Con Loss: 4.5247156712092735
[7 / 10] tensor([[0.947, 0.919],
        [0.924, 0.925]]) {'epoch': 7, 'valid/acc': 92.399, 'valid/acc_unbiased': 92.714, 'valid/diff': 1.336, 'valid/acc_skew': 93.382, 'valid/acc_align': 92.046, 'test/acc': 92.883, 'test/acc_unbiased': 92.854, 'test/diff': 1.432, 'test/acc_skew': 93.551, 'test/acc_align': 92.157}
[7 / 10] best valid accuracy: 92.714 at epoch 7 
 best_stats: {'best_valid_epoch': 7, 'best_valid_valid/acc': 92.399, 'best_valid_valid/acc_unbiased': 92.714, 'best_valid_valid/diff': 1.336, 'best_valid_valid/acc_skew': 93.382, 'best_valid_valid/acc_align': 92.046, 'best_valid_test/acc': 92.883, 'best_valid_test/acc_unbiased': 92.854, 'best_valid_test/diff': 1.432, 'best_valid_test/acc_skew': 93.551, 'best_valid_test/acc_align': 92.157}
[7 / 10] best test accuracy: 92.854 at epoch 7 
 best_stats: {'best_test_epoch': 7, 'best_test_valid/acc': 92.399, 'best_test_valid/acc_unbiased': 92.714, 'best_test_valid/diff': 1.336, 'best_test_valid/acc_skew': 93.382, 'best_test_valid/acc_align': 92.046, 'best_test_test/acc': 92.883, 'best_test_test/acc_unbiased': 92.854, 'best_test_test/diff': 1.432, 'best_test_test/acc_skew': 93.551, 'best_test_test/acc_align': 92.157}
[8 / 10] Learning rate: 1e-05 weight: 0.01
[8 / 10] Loss: 4.520230195035476 CE Loss: 0.18127577715767096 Con Loss: 4.5184174350036335
[8 / 10] tensor([[0.928, 0.911],
        [0.937, 0.931]]) {'epoch': 8, 'valid/acc': 92.542, 'valid/acc_unbiased': 92.682, 'valid/diff': 1.579, 'valid/acc_skew': 93.472, 'valid/acc_align': 91.892, 'test/acc': 92.722, 'test/acc_unbiased': 92.699, 'test/diff': 1.125, 'test/acc_skew': 93.261, 'test/acc_align': 92.136}
[8 / 10] best valid accuracy: 92.714 at epoch 7 
 best_stats: {'best_valid_epoch': 7, 'best_valid_valid/acc': 92.399, 'best_valid_valid/acc_unbiased': 92.714, 'best_valid_valid/diff': 1.336, 'best_valid_valid/acc_skew': 93.382, 'best_valid_valid/acc_align': 92.046, 'best_valid_test/acc': 92.883, 'best_valid_test/acc_unbiased': 92.854, 'best_valid_test/diff': 1.432, 'best_valid_test/acc_skew': 93.551, 'best_valid_test/acc_align': 92.157}
[8 / 10] best test accuracy: 92.854 at epoch 7 
 best_stats: {'best_test_epoch': 7, 'best_test_valid/acc': 92.399, 'best_test_valid/acc_unbiased': 92.714, 'best_test_valid/diff': 1.336, 'best_test_valid/acc_skew': 93.382, 'best_test_valid/acc_align': 92.046, 'best_test_test/acc': 92.883, 'best_test_test/acc_unbiased': 92.854, 'best_test_test/diff': 1.432, 'best_test_test/acc_skew': 93.551, 'best_test_test/acc_align': 92.157}
[9 / 10] Learning rate: 1e-05 weight: 0.01
[9 / 10] Loss: 4.516879323783735 CE Loss: 0.1811048694291916 Con Loss: 4.515068275831064
[9 / 10] tensor([[0.946, 0.918],
        [0.924, 0.925]]) {'epoch': 9, 'valid/acc': 92.461, 'valid/acc_unbiased': 92.759, 'valid/diff': 1.24, 'valid/acc_skew': 93.379, 'valid/acc_align': 92.14, 'test/acc': 92.852, 'test/acc_unbiased': 92.828, 'test/diff': 1.447, 'test/acc_skew': 93.52, 'test/acc_align': 92.136}
[9 / 10] best valid accuracy: 92.759 at epoch 9 
 best_stats: {'best_valid_epoch': 9, 'best_valid_valid/acc': 92.461, 'best_valid_valid/acc_unbiased': 92.759, 'best_valid_valid/diff': 1.24, 'best_valid_valid/acc_skew': 93.379, 'best_valid_valid/acc_align': 92.14, 'best_valid_test/acc': 92.852, 'best_valid_test/acc_unbiased': 92.828, 'best_valid_test/diff': 1.447, 'best_valid_test/acc_skew': 93.52, 'best_valid_test/acc_align': 92.136}
[9 / 10] best test accuracy: 92.854 at epoch 7 
 best_stats: {'best_test_epoch': 7, 'best_test_valid/acc': 92.399, 'best_test_valid/acc_unbiased': 92.714, 'best_test_valid/diff': 1.336, 'best_test_valid/acc_skew': 93.382, 'best_test_valid/acc_align': 92.046, 'best_test_test/acc': 92.883, 'best_test_test/acc_unbiased': 92.854, 'best_test_test/diff': 1.432, 'best_test_test/acc_skew': 93.551, 'best_test_test/acc_align': 92.157}
[10 / 10] Learning rate: 1e-05 weight: 0.01
[10 / 10] Loss: 4.518177809859157 CE Loss: 0.17962944215644283 Con Loss: 4.516381515248831
[10 / 10] tensor([[0.955, 0.936],
        [0.916, 0.909]]) {'epoch': 10, 'valid/acc': 92.627, 'valid/acc_unbiased': 92.969, 'valid/diff': 1.399, 'valid/acc_skew': 93.669, 'valid/acc_align': 92.27, 'test/acc': 93.014, 'test/acc_unbiased': 92.897, 'test/diff': 1.332, 'test/acc_skew': 93.563, 'test/acc_align': 92.231}
[10 / 10] best valid accuracy: 92.969 at epoch 10 
 best_stats: {'best_valid_epoch': 10, 'best_valid_valid/acc': 92.627, 'best_valid_valid/acc_unbiased': 92.969, 'best_valid_valid/diff': 1.399, 'best_valid_valid/acc_skew': 93.669, 'best_valid_valid/acc_align': 92.27, 'best_valid_test/acc': 93.014, 'best_valid_test/acc_unbiased': 92.897, 'best_valid_test/diff': 1.332, 'best_valid_test/acc_skew': 93.563, 'best_valid_test/acc_align': 92.231}
[10 / 10] best test accuracy: 92.897 at epoch 10 
 best_stats: {'best_test_epoch': 10, 'best_test_valid/acc': 92.627, 'best_test_valid/acc_unbiased': 92.969, 'best_test_valid/diff': 1.399, 'best_test_valid/acc_skew': 93.669, 'best_test_valid/acc_align': 92.27, 'best_test_test/acc': 93.014, 'best_test_test/acc_unbiased': 92.897, 'best_test_test/diff': 1.332, 'best_test_test/acc_skew': 93.563, 'best_test_test/acc_align': 92.231}
Total training time: 1:55:16
