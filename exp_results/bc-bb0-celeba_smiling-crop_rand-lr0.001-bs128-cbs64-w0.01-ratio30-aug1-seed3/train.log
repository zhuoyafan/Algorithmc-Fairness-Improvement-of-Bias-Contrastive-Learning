Log level set to: INFO
Set seed: 3
=======> Using Fixed Random Seed: 3 <========
save_path: exp_results/bc-bb0-celeba_smiling-crop_rand-lr0.001-bs128-cbs64-w0.01-ratio30-aug1-seed3
get_celeba - split:train, aug: False, given_y: True, ratio: 0
use existing smiling indices from data/celeba/pickles/smiling
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [8009, 32847]
Target 1: [40621, 7981]
Binary Target 1
---------------------------
Target 0: [8009, 32847]
Target 1: [40621, 7981]
===================================
Normal Label Distribution: 
Target 0: [8009, 32847]
Target 1: [40621, 7981]
===================================
Use BiasedCelebASplit 
 target_attr: smiling split: train 
 tensor([[ 8009., 40621.],
        [32847.,  7981.]])
get_celeba - split:train, aug: 1, given_y: True, ratio: 30
use existing smiling indices from data/celeba/pickles/smiling
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [8017, 32729]
Target 1: [40802, 7910]
Binary Target 1
---------------------------
Target 0: [8017, 32729]
Target 1: [40802, 7910]
===================================
Normal Label Distribution: 
Target 0: [8017, 32729]
Target 1: [40802, 7910]
===================================
Use BiasedCelebASplit 
 target_attr: smiling split: train 
 tensor([[ 8017., 40802.],
        [32729.,  7910.]])
get_celeba - split:train_valid, aug: False, given_y: True, ratio: 0
use existing smiling indices from data/celeba/pickles/smiling
Use BiasedCelebASplit 
 target_attr: smiling split: train_valid 
 tensor([[ 1944., 10217.],
        [ 8222.,  1982.]])
get_celeba - split:valid, aug: False, given_y: True, ratio: 0
Use BiasedCelebASplit 
 target_attr: smiling split: valid 
 tensor([[5252., 6157.],
        [5013., 3445.]])
decay_epochs: [3, 6]
[1 / 10] Learning rate: 0.001 weight: 0.01
[1 / 10] Loss: 4.6612942731287985 CE Loss: 0.25536428725243193 Con Loss: 4.65874062338389
[1 / 10] tensor([[0.964, 0.962],
        [0.849, 0.808]]) {'epoch': 1, 'valid/acc': 89.573, 'valid/acc_unbiased': 89.63, 'valid/diff': 1.436, 'valid/acc_skew': 88.912, 'valid/acc_align': 90.348, 'test/acc': 90.079, 'test/acc_unbiased': 89.574, 'test/diff': 2.154, 'test/acc_skew': 88.612, 'test/acc_align': 90.536}
[1 / 10] best valid accuracy: 89.630 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 89.573, 'best_valid_valid/acc_unbiased': 89.63, 'best_valid_valid/diff': 1.436, 'best_valid_valid/acc_skew': 88.912, 'best_valid_valid/acc_align': 90.348, 'best_valid_test/acc': 90.079, 'best_valid_test/acc_unbiased': 89.574, 'best_valid_test/diff': 2.154, 'best_valid_test/acc_skew': 88.612, 'best_valid_test/acc_align': 90.536}
[1 / 10] best test accuracy: 89.574 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 89.573, 'best_test_valid/acc_unbiased': 89.63, 'best_test_valid/diff': 1.436, 'best_test_valid/acc_skew': 88.912, 'best_test_valid/acc_align': 90.348, 'best_test_test/acc': 90.079, 'best_test_test/acc_unbiased': 89.574, 'best_test_test/diff': 2.154, 'best_test_test/acc_skew': 88.612, 'best_test_test/acc_align': 90.536}
[2 / 10] Learning rate: 0.001 weight: 0.01
[2 / 10] Loss: 4.6231165510800745 CE Loss: 0.21855117190794066 Con Loss: 4.620931050142544
[2 / 10] tensor([[0.927, 0.906],
        [0.919, 0.912]]) {'epoch': 2, 'valid/acc': 91.169, 'valid/acc_unbiased': 91.356, 'valid/diff': 1.771, 'valid/acc_skew': 91.756, 'valid/acc_align': 90.956, 'test/acc': 91.695, 'test/acc_unbiased': 91.63, 'test/diff': 1.411, 'test/acc_skew': 91.966, 'test/acc_align': 91.294}
[2 / 10] best valid accuracy: 91.356 at epoch 2 
 best_stats: {'best_valid_epoch': 2, 'best_valid_valid/acc': 91.169, 'best_valid_valid/acc_unbiased': 91.356, 'best_valid_valid/diff': 1.771, 'best_valid_valid/acc_skew': 91.756, 'best_valid_valid/acc_align': 90.956, 'best_valid_test/acc': 91.695, 'best_valid_test/acc_unbiased': 91.63, 'best_valid_test/diff': 1.411, 'best_valid_test/acc_skew': 91.966, 'best_valid_test/acc_align': 91.294}
[2 / 10] best test accuracy: 91.630 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 91.169, 'best_test_valid/acc_unbiased': 91.356, 'best_test_valid/diff': 1.771, 'best_test_valid/acc_skew': 91.756, 'best_test_valid/acc_align': 90.956, 'best_test_test/acc': 91.695, 'best_test_test/acc_unbiased': 91.63, 'best_test_test/diff': 1.411, 'best_test_test/acc_skew': 91.966, 'best_test_test/acc_align': 91.294}
[3 / 10] Learning rate: 0.001 weight: 0.01
[3 / 10] Loss: 4.61763016390671 CE Loss: 0.2156266824239515 Con Loss: 4.615473891213913
[3 / 10] tensor([[0.943, 0.940],
        [0.912, 0.883]]) {'epoch': 3, 'valid/acc': 91.961, 'valid/acc_unbiased': 91.818, 'valid/diff': 1.351, 'valid/acc_skew': 91.392, 'valid/acc_align': 92.244, 'test/acc': 92.218, 'test/acc_unbiased': 91.944, 'test/diff': 1.639, 'test/acc_skew': 91.309, 'test/acc_align': 92.578}
[3 / 10] best valid accuracy: 91.818 at epoch 3 
 best_stats: {'best_valid_epoch': 3, 'best_valid_valid/acc': 91.961, 'best_valid_valid/acc_unbiased': 91.818, 'best_valid_valid/diff': 1.351, 'best_valid_valid/acc_skew': 91.392, 'best_valid_valid/acc_align': 92.244, 'best_valid_test/acc': 92.218, 'best_valid_test/acc_unbiased': 91.944, 'best_valid_test/diff': 1.639, 'best_valid_test/acc_skew': 91.309, 'best_valid_test/acc_align': 92.578}
[3 / 10] best test accuracy: 91.944 at epoch 3 
 best_stats: {'best_test_epoch': 3, 'best_test_valid/acc': 91.961, 'best_test_valid/acc_unbiased': 91.818, 'best_test_valid/diff': 1.351, 'best_test_valid/acc_skew': 91.392, 'best_test_valid/acc_align': 92.244, 'best_test_test/acc': 92.218, 'best_test_test/acc_unbiased': 91.944, 'best_test_test/diff': 1.639, 'best_test_test/acc_skew': 91.309, 'best_test_test/acc_align': 92.578}
[4 / 10] Learning rate: 0.0001 weight: 0.01
[4 / 10] Loss: 4.57873043075526 CE Loss: 0.18803412622735866 Con Loss: 4.576850091345783
[4 / 10] tensor([[0.907, 0.907],
        [0.943, 0.930]]) {'epoch': 4, 'valid/acc': 92.555, 'valid/acc_unbiased': 92.34, 'valid/diff': 0.947, 'valid/acc_skew': 92.249, 'valid/acc_align': 92.431, 'test/acc': 92.228, 'test/acc_unbiased': 92.189, 'test/diff': 0.694, 'test/acc_skew': 91.842, 'test/acc_align': 92.536}
[4 / 10] best valid accuracy: 92.340 at epoch 4 
 best_stats: {'best_valid_epoch': 4, 'best_valid_valid/acc': 92.555, 'best_valid_valid/acc_unbiased': 92.34, 'best_valid_valid/diff': 0.947, 'best_valid_valid/acc_skew': 92.249, 'best_valid_valid/acc_align': 92.431, 'best_valid_test/acc': 92.228, 'best_valid_test/acc_unbiased': 92.189, 'best_valid_test/diff': 0.694, 'best_valid_test/acc_skew': 91.842, 'best_valid_test/acc_align': 92.536}
[4 / 10] best test accuracy: 92.189 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 92.555, 'best_test_valid/acc_unbiased': 92.34, 'best_test_valid/diff': 0.947, 'best_test_valid/acc_skew': 92.249, 'best_test_valid/acc_align': 92.431, 'best_test_test/acc': 92.228, 'best_test_test/acc_unbiased': 92.189, 'best_test_test/diff': 0.694, 'best_test_test/acc_skew': 91.842, 'best_test_test/acc_align': 92.536}
[5 / 10] Learning rate: 0.0001 weight: 0.01
[5 / 10] Loss: 4.5641744704859395 CE Loss: 0.1839834797744548 Con Loss: 4.562334630850157
[5 / 10] tensor([[0.905, 0.923],
        [0.946, 0.923]]) {'epoch': 5, 'valid/acc': 93.132, 'valid/acc_unbiased': 92.438, 'valid/diff': 1.846, 'valid/acc_skew': 91.516, 'valid/acc_align': 93.361, 'test/acc': 92.561, 'test/acc_unbiased': 92.449, 'test/diff': 2.062, 'test/acc_skew': 91.418, 'test/acc_align': 93.48}
[5 / 10] best valid accuracy: 92.438 at epoch 5 
 best_stats: {'best_valid_epoch': 5, 'best_valid_valid/acc': 93.132, 'best_valid_valid/acc_unbiased': 92.438, 'best_valid_valid/diff': 1.846, 'best_valid_valid/acc_skew': 91.516, 'best_valid_valid/acc_align': 93.361, 'best_valid_test/acc': 92.561, 'best_valid_test/acc_unbiased': 92.449, 'best_valid_test/diff': 2.062, 'best_valid_test/acc_skew': 91.418, 'best_valid_test/acc_align': 93.48}
[5 / 10] best test accuracy: 92.449 at epoch 5 
 best_stats: {'best_test_epoch': 5, 'best_test_valid/acc': 93.132, 'best_test_valid/acc_unbiased': 92.438, 'best_test_valid/diff': 1.846, 'best_test_valid/acc_skew': 91.516, 'best_test_valid/acc_align': 93.361, 'best_test_test/acc': 92.561, 'best_test_test/acc_unbiased': 92.449, 'best_test_test/diff': 2.062, 'best_test_test/acc_skew': 91.418, 'best_test_test/acc_align': 93.48}
[6 / 10] Learning rate: 0.0001 weight: 0.01
[6 / 10] Loss: 4.555629499764154 CE Loss: 0.17538365515586893 Con Loss: 4.553875667825146
[6 / 10] tensor([[0.915, 0.924],
        [0.945, 0.922]]) {'epoch': 6, 'valid/acc': 92.976, 'valid/acc_unbiased': 92.446, 'valid/diff': 1.392, 'valid/acc_skew': 91.75, 'valid/acc_align': 93.142, 'test/acc': 92.762, 'test/acc_unbiased': 92.637, 'test/diff': 1.603, 'test/acc_skew': 91.836, 'test/acc_align': 93.439}
[6 / 10] best valid accuracy: 92.446 at epoch 6 
 best_stats: {'best_valid_epoch': 6, 'best_valid_valid/acc': 92.976, 'best_valid_valid/acc_unbiased': 92.446, 'best_valid_valid/diff': 1.392, 'best_valid_valid/acc_skew': 91.75, 'best_valid_valid/acc_align': 93.142, 'best_valid_test/acc': 92.762, 'best_valid_test/acc_unbiased': 92.637, 'best_valid_test/diff': 1.603, 'best_valid_test/acc_skew': 91.836, 'best_valid_test/acc_align': 93.439}
[6 / 10] best test accuracy: 92.637 at epoch 6 
 best_stats: {'best_test_epoch': 6, 'best_test_valid/acc': 92.976, 'best_test_valid/acc_unbiased': 92.446, 'best_test_valid/diff': 1.392, 'best_test_valid/acc_skew': 91.75, 'best_test_valid/acc_align': 93.142, 'best_test_test/acc': 92.762, 'best_test_test/acc_unbiased': 92.637, 'best_test_test/diff': 1.603, 'best_test_test/acc_skew': 91.836, 'best_test_test/acc_align': 93.439}
[7 / 10] Learning rate: 1e-05 weight: 0.01
[7 / 10] Loss: 4.554307297230268 CE Loss: 0.173714899748138 Con Loss: 4.552570148547247
[7 / 10] tensor([[0.908, 0.919],
        [0.948, 0.925]]) {'epoch': 7, 'valid/acc': 93.168, 'valid/acc_unbiased': 92.48, 'valid/diff': 1.783, 'valid/acc_skew': 91.588, 'valid/acc_align': 93.371, 'test/acc': 92.606, 'test/acc_unbiased': 92.496, 'test/diff': 1.716, 'test/acc_skew': 91.638, 'test/acc_align': 93.354}
[7 / 10] best valid accuracy: 92.480 at epoch 7 
 best_stats: {'best_valid_epoch': 7, 'best_valid_valid/acc': 93.168, 'best_valid_valid/acc_unbiased': 92.48, 'best_valid_valid/diff': 1.783, 'best_valid_valid/acc_skew': 91.588, 'best_valid_valid/acc_align': 93.371, 'best_valid_test/acc': 92.606, 'best_valid_test/acc_unbiased': 92.496, 'best_valid_test/diff': 1.716, 'best_valid_test/acc_skew': 91.638, 'best_valid_test/acc_align': 93.354}
[7 / 10] best test accuracy: 92.637 at epoch 6 
 best_stats: {'best_test_epoch': 6, 'best_test_valid/acc': 92.976, 'best_test_valid/acc_unbiased': 92.446, 'best_test_valid/diff': 1.392, 'best_test_valid/acc_skew': 91.75, 'best_test_valid/acc_align': 93.142, 'best_test_test/acc': 92.762, 'best_test_test/acc_unbiased': 92.637, 'best_test_test/diff': 1.603, 'best_test_test/acc_skew': 91.836, 'best_test_test/acc_align': 93.439}
[8 / 10] Learning rate: 1e-05 weight: 0.01
[8 / 10] Loss: 4.556163419252185 CE Loss: 0.17094406739612544 Con Loss: 4.554453978870804
[8 / 10] tensor([[0.919, 0.925],
        [0.943, 0.921]]) {'epoch': 8, 'valid/acc': 93.163, 'valid/acc_unbiased': 92.798, 'valid/diff': 0.946, 'valid/acc_skew': 92.335, 'valid/acc_align': 93.26, 'test/acc': 92.812, 'test/acc_unbiased': 92.683, 'test/diff': 1.383, 'test/acc_skew': 91.992, 'test/acc_align': 93.375}
[8 / 10] best valid accuracy: 92.798 at epoch 8 
 best_stats: {'best_valid_epoch': 8, 'best_valid_valid/acc': 93.163, 'best_valid_valid/acc_unbiased': 92.798, 'best_valid_valid/diff': 0.946, 'best_valid_valid/acc_skew': 92.335, 'best_valid_valid/acc_align': 93.26, 'best_valid_test/acc': 92.812, 'best_valid_test/acc_unbiased': 92.683, 'best_valid_test/diff': 1.383, 'best_valid_test/acc_skew': 91.992, 'best_valid_test/acc_align': 93.375}
[8 / 10] best test accuracy: 92.683 at epoch 8 
 best_stats: {'best_test_epoch': 8, 'best_test_valid/acc': 93.163, 'best_test_valid/acc_unbiased': 92.798, 'best_test_valid/diff': 0.946, 'best_test_valid/acc_skew': 92.335, 'best_test_valid/acc_align': 93.26, 'best_test_test/acc': 92.812, 'best_test_test/acc_unbiased': 92.683, 'best_test_test/diff': 1.383, 'best_test_test/acc_skew': 91.992, 'best_test_test/acc_align': 93.375}
[9 / 10] Learning rate: 1e-05 weight: 0.01
[9 / 10] Loss: 4.545900977607459 CE Loss: 0.1711066705567749 Con Loss: 4.544189910943681
[9 / 10] tensor([[0.921, 0.931],
        [0.942, 0.912]]) {'epoch': 9, 'valid/acc': 93.235, 'valid/acc_unbiased': 92.748, 'valid/diff': 1.38, 'valid/acc_skew': 92.058, 'valid/acc_align': 93.439, 'test/acc': 92.837, 'test/acc_unbiased': 92.64, 'test/diff': 2.016, 'test/acc_skew': 91.632, 'test/acc_align': 93.648}
[9 / 10] best valid accuracy: 92.798 at epoch 8 
 best_stats: {'best_valid_epoch': 8, 'best_valid_valid/acc': 93.163, 'best_valid_valid/acc_unbiased': 92.798, 'best_valid_valid/diff': 0.946, 'best_valid_valid/acc_skew': 92.335, 'best_valid_valid/acc_align': 93.26, 'best_valid_test/acc': 92.812, 'best_valid_test/acc_unbiased': 92.683, 'best_valid_test/diff': 1.383, 'best_valid_test/acc_skew': 91.992, 'best_valid_test/acc_align': 93.375}
[9 / 10] best test accuracy: 92.683 at epoch 8 
 best_stats: {'best_test_epoch': 8, 'best_test_valid/acc': 93.163, 'best_test_valid/acc_unbiased': 92.798, 'best_test_valid/diff': 0.946, 'best_test_valid/acc_skew': 92.335, 'best_test_valid/acc_align': 93.26, 'best_test_test/acc': 92.812, 'best_test_test/acc_unbiased': 92.683, 'best_test_test/diff': 1.383, 'best_test_test/acc_skew': 91.992, 'best_test_test/acc_align': 93.375}
[10 / 10] Learning rate: 1e-05 weight: 0.01
[10 / 10] Loss: 4.546783068601764 CE Loss: 0.17092239852955451 Con Loss: 4.5450738496086815
[10 / 10] tensor([[0.916, 0.924],
        [0.945, 0.922]]) {'epoch': 10, 'valid/acc': 93.02, 'valid/acc_unbiased': 92.564, 'valid/diff': 1.124, 'valid/acc_skew': 92.002, 'valid/acc_align': 93.126, 'test/acc': 92.782, 'test/acc_unbiased': 92.65, 'test/diff': 1.554, 'test/acc_skew': 91.873, 'test/acc_align': 93.427}
[10 / 10] best valid accuracy: 92.798 at epoch 8 
 best_stats: {'best_valid_epoch': 8, 'best_valid_valid/acc': 93.163, 'best_valid_valid/acc_unbiased': 92.798, 'best_valid_valid/diff': 0.946, 'best_valid_valid/acc_skew': 92.335, 'best_valid_valid/acc_align': 93.26, 'best_valid_test/acc': 92.812, 'best_valid_test/acc_unbiased': 92.683, 'best_valid_test/diff': 1.383, 'best_valid_test/acc_skew': 91.992, 'best_valid_test/acc_align': 93.375}
[10 / 10] best test accuracy: 92.683 at epoch 8 
 best_stats: {'best_test_epoch': 8, 'best_test_valid/acc': 93.163, 'best_test_valid/acc_unbiased': 92.798, 'best_test_valid/diff': 0.946, 'best_test_valid/acc_skew': 92.335, 'best_test_valid/acc_align': 93.26, 'best_test_test/acc': 92.812, 'best_test_test/acc_unbiased': 92.683, 'best_test_test/diff': 1.383, 'best_test_test/acc_skew': 91.992, 'best_test_test/acc_align': 93.375}
Total training time: 1:30:26
