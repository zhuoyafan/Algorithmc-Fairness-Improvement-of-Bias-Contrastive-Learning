Log level set to: INFO
Set seed: 1
=======> Using Fixed Random Seed: 1 <========
save_path: exp_results/bc-bb0-celeba_blonde-crop_trival-lr0.001-bs128-cbs64-w0.01-ratio30-aug1-seed1
get_celeba - split:train, aug: False, given_y: True, ratio: 0
use existing blonde indices from data/celeba/pickles/blonde
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [1558, 53577]
Target 1: [18279, 1098]
Binary Target 1
---------------------------
Target 0: [1558, 53577]
Target 1: [18279, 1098]
===================================
Normal Label Distribution: 
Target 0: [1558, 53577]
Target 1: [18279, 1098]
===================================
Use BiasedCelebASplit 
 target_attr: blonde split: train 
 tensor([[ 1558., 18279.],
        [53577.,  1098.]])
get_celeba - split:train, aug: 1, given_y: True, ratio: 30
use existing blonde indices from data/celeba/pickles/blonde
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [1606, 53425]
Target 1: [18350, 1131]
Binary Target 1
---------------------------
Target 0: [1606, 53425]
Target 1: [18350, 1131]
===================================
Normal Label Distribution: 
Target 0: [1606, 53425]
Target 1: [18350, 1131]
===================================
Use BiasedCelebASplit 
 target_attr: blonde split: train 
 tensor([[ 1606., 18350.],
        [53425.,  1131.]])
get_celeba - split:train_valid, aug: False, given_y: True, ratio: 0
use existing blonde indices from data/celeba/pickles/blonde
Use BiasedCelebASplit 
 target_attr: blonde split: train_valid 
 tensor([[  390.,  4598.],
        [13361.,   280.]])
get_celeba - split:valid, aug: False, given_y: True, ratio: 0
Use BiasedCelebASplit 
 target_attr: blonde split: valid 
 tensor([[8535., 2874.],
        [8276.,  182.]])
decay_epochs: [3, 6]
[1 / 10] Learning rate: 0.001 weight: 0.01
[1 / 10] Loss: 4.72084857599915 CE Loss: 0.21444550728545775 Con Loss: 4.718704121241325
[1 / 10] tensor([[0.976, 0.991],
        [0.690, 0.429]]) {'epoch': 1, 'valid/acc': 90.214, 'valid/acc_unbiased': 77.129, 'valid/diff': 12.197, 'valid/acc_skew': 71.223, 'valid/acc_align': 83.036, 'test/acc': 93.607, 'test/acc_unbiased': 77.152, 'test/diff': 13.813, 'test/acc_skew': 70.245, 'test/acc_align': 84.058}
[1 / 10] best valid accuracy: 77.129 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 90.214, 'best_valid_valid/acc_unbiased': 77.129, 'best_valid_valid/diff': 12.197, 'best_valid_valid/acc_skew': 71.223, 'best_valid_valid/acc_align': 83.036, 'best_valid_test/acc': 93.607, 'best_valid_test/acc_unbiased': 77.152, 'best_valid_test/diff': 13.813, 'best_valid_test/acc_skew': 70.245, 'best_valid_test/acc_align': 84.058}
[1 / 10] best test accuracy: 77.152 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 90.214, 'best_test_valid/acc_unbiased': 77.129, 'best_test_valid/diff': 12.197, 'best_test_valid/acc_skew': 71.223, 'best_test_valid/acc_align': 83.036, 'best_test_test/acc': 93.607, 'best_test_test/acc_unbiased': 77.152, 'best_test_test/diff': 13.813, 'best_test_test/acc_skew': 70.245, 'best_test_test/acc_align': 84.058}
[2 / 10] Learning rate: 0.001 weight: 0.01
[2 / 10] Loss: 4.6894607775350075 CE Loss: 0.18317529388269643 Con Loss: 4.687629019417987
[2 / 10] tensor([[0.939, 0.975],
        [0.824, 0.703]]) {'epoch': 2, 'valid/acc': 92.759, 'valid/acc_unbiased': 87.165, 'valid/diff': 5.19, 'valid/acc_skew': 84.84, 'valid/acc_align': 89.49, 'test/acc': 93.507, 'test/acc_unbiased': 86.029, 'test/diff': 7.821, 'test/acc_skew': 82.119, 'test/acc_align': 89.94}
[2 / 10] best valid accuracy: 87.165 at epoch 2 
 best_stats: {'best_valid_epoch': 2, 'best_valid_valid/acc': 92.759, 'best_valid_valid/acc_unbiased': 87.165, 'best_valid_valid/diff': 5.19, 'best_valid_valid/acc_skew': 84.84, 'best_valid_valid/acc_align': 89.49, 'best_valid_test/acc': 93.507, 'best_valid_test/acc_unbiased': 86.029, 'best_valid_test/diff': 7.821, 'best_valid_test/acc_skew': 82.119, 'best_valid_test/acc_align': 89.94}
[2 / 10] best test accuracy: 86.029 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 92.759, 'best_test_valid/acc_unbiased': 87.165, 'best_test_valid/diff': 5.19, 'best_test_valid/acc_skew': 84.84, 'best_test_valid/acc_align': 89.49, 'best_test_test/acc': 93.507, 'best_test_test/acc_unbiased': 86.029, 'best_test_test/diff': 7.821, 'best_test_test/acc_skew': 82.119, 'best_test_test/acc_align': 89.94}
[3 / 10] Learning rate: 0.001 weight: 0.01
[3 / 10] Loss: 4.674375918844828 CE Loss: 0.17769187209507362 Con Loss: 4.672598995260346
[3 / 10] tensor([[0.878, 0.947],
        [0.947, 0.885]]) {'epoch': 3, 'valid/acc': 94.117, 'valid/acc_unbiased': 92.227, 'valid/diff': 4.234, 'valid/acc_skew': 90.11, 'valid/acc_align': 94.344, 'test/acc': 91.644, 'test/acc_unbiased': 91.391, 'test/diff': 6.553, 'test/acc_skew': 88.115, 'test/acc_align': 94.668}
[3 / 10] best valid accuracy: 92.227 at epoch 3 
 best_stats: {'best_valid_epoch': 3, 'best_valid_valid/acc': 94.117, 'best_valid_valid/acc_unbiased': 92.227, 'best_valid_valid/diff': 4.234, 'best_valid_valid/acc_skew': 90.11, 'best_valid_valid/acc_align': 94.344, 'best_valid_test/acc': 91.644, 'best_valid_test/acc_unbiased': 91.391, 'best_valid_test/diff': 6.553, 'best_valid_test/acc_skew': 88.115, 'best_valid_test/acc_align': 94.668}
[3 / 10] best test accuracy: 91.391 at epoch 3 
 best_stats: {'best_test_epoch': 3, 'best_test_valid/acc': 94.117, 'best_test_valid/acc_unbiased': 92.227, 'best_test_valid/diff': 4.234, 'best_test_valid/acc_skew': 90.11, 'best_test_valid/acc_align': 94.344, 'best_test_test/acc': 91.644, 'best_test_test/acc_unbiased': 91.391, 'best_test_test/diff': 6.553, 'best_test_test/acc_skew': 88.115, 'best_test_test/acc_align': 94.668}
[4 / 10] Learning rate: 0.0001 weight: 0.01
[4 / 10] Loss: 4.621897035180588 CE Loss: 0.14929842050268283 Con Loss: 4.620404049744543
[4 / 10] tensor([[0.929, 0.969],
        [0.895, 0.835]]) {'epoch': 4, 'valid/acc': 94.337, 'valid/acc_unbiased': 91.396, 'valid/diff': 4.822, 'valid/acc_skew': 89.995, 'valid/acc_align': 92.796, 'test/acc': 94.015, 'test/acc_unbiased': 90.724, 'test/diff': 4.997, 'test/acc_skew': 88.226, 'test/acc_align': 93.223}
[4 / 10] best valid accuracy: 92.227 at epoch 3 
 best_stats: {'best_valid_epoch': 3, 'best_valid_valid/acc': 94.117, 'best_valid_valid/acc_unbiased': 92.227, 'best_valid_valid/diff': 4.234, 'best_valid_valid/acc_skew': 90.11, 'best_valid_valid/acc_align': 94.344, 'best_valid_test/acc': 91.644, 'best_valid_test/acc_unbiased': 91.391, 'best_valid_test/diff': 6.553, 'best_valid_test/acc_skew': 88.115, 'best_valid_test/acc_align': 94.668}
[4 / 10] best test accuracy: 91.391 at epoch 3 
 best_stats: {'best_test_epoch': 3, 'best_test_valid/acc': 94.117, 'best_test_valid/acc_unbiased': 92.227, 'best_test_valid/diff': 4.234, 'best_test_valid/acc_skew': 90.11, 'best_test_valid/acc_align': 94.344, 'best_test_test/acc': 91.644, 'best_test_test/acc_unbiased': 91.391, 'best_test_test/diff': 6.553, 'best_test_test/acc_skew': 88.115, 'best_test_test/acc_align': 94.668}
[5 / 10] Learning rate: 0.0001 weight: 0.01
[5 / 10] Loss: 4.598103249254773 CE Loss: 0.14572907441101898 Con Loss: 4.596645960767868
[5 / 10] tensor([[0.933, 0.974],
        [0.895, 0.841]]) {'epoch': 5, 'valid/acc': 94.745, 'valid/acc_unbiased': 91.883, 'valid/diff': 4.642, 'valid/acc_skew': 90.609, 'valid/acc_align': 93.158, 'test/acc': 94.337, 'test/acc_unbiased': 91.038, 'test/diff': 4.735, 'test/acc_skew': 88.67, 'test/acc_align': 93.405}
[5 / 10] best valid accuracy: 92.227 at epoch 3 
 best_stats: {'best_valid_epoch': 3, 'best_valid_valid/acc': 94.117, 'best_valid_valid/acc_unbiased': 92.227, 'best_valid_valid/diff': 4.234, 'best_valid_valid/acc_skew': 90.11, 'best_valid_valid/acc_align': 94.344, 'best_valid_test/acc': 91.644, 'best_valid_test/acc_unbiased': 91.391, 'best_valid_test/diff': 6.553, 'best_valid_test/acc_skew': 88.115, 'best_valid_test/acc_align': 94.668}
[5 / 10] best test accuracy: 91.391 at epoch 3 
 best_stats: {'best_test_epoch': 3, 'best_test_valid/acc': 94.117, 'best_test_valid/acc_unbiased': 92.227, 'best_test_valid/diff': 4.234, 'best_test_valid/acc_skew': 90.11, 'best_test_valid/acc_align': 94.344, 'best_test_test/acc': 91.644, 'best_test_test/acc_unbiased': 91.391, 'best_test_test/diff': 6.553, 'best_test_test/acc_skew': 88.115, 'best_test_test/acc_align': 94.668}
[6 / 10] Learning rate: 0.0001 weight: 0.01
[6 / 10] Loss: 4.590092571759034 CE Loss: 0.14159884779768644 Con Loss: 4.588676587383916
[6 / 10] tensor([[0.935, 0.977],
        [0.896, 0.802]]) {'epoch': 6, 'valid/acc': 94.954, 'valid/acc_unbiased': 91.63, 'valid/diff': 4.758, 'valid/acc_skew': 90.073, 'valid/acc_align': 93.187, 'test/acc': 94.544, 'test/acc_unbiased': 90.242, 'test/diff': 6.779, 'test/acc_skew': 86.853, 'test/acc_align': 93.632}
[6 / 10] best valid accuracy: 92.227 at epoch 3 
 best_stats: {'best_valid_epoch': 3, 'best_valid_valid/acc': 94.117, 'best_valid_valid/acc_unbiased': 92.227, 'best_valid_valid/diff': 4.234, 'best_valid_valid/acc_skew': 90.11, 'best_valid_valid/acc_align': 94.344, 'best_valid_test/acc': 91.644, 'best_valid_test/acc_unbiased': 91.391, 'best_valid_test/diff': 6.553, 'best_valid_test/acc_skew': 88.115, 'best_valid_test/acc_align': 94.668}
[6 / 10] best test accuracy: 91.391 at epoch 3 
 best_stats: {'best_test_epoch': 3, 'best_test_valid/acc': 94.117, 'best_test_valid/acc_unbiased': 92.227, 'best_test_valid/diff': 4.234, 'best_test_valid/acc_skew': 90.11, 'best_test_valid/acc_align': 94.344, 'best_test_test/acc': 91.644, 'best_test_test/acc_unbiased': 91.391, 'best_test_test/diff': 6.553, 'best_test_test/acc_skew': 88.115, 'best_test_test/acc_align': 94.668}
[7 / 10] Learning rate: 1e-05 weight: 0.01
[7 / 10] Loss: 4.582791260544619 CE Loss: 0.13852864869590067 Con Loss: 4.581405983479053
[7 / 10] tensor([[0.929, 0.975],
        [0.900, 0.830]]) {'epoch': 7, 'valid/acc': 94.9, 'valid/acc_unbiased': 92.301, 'valid/diff': 5.12, 'valid/acc_skew': 91.172, 'valid/acc_align': 93.43, 'test/acc': 94.302, 'test/acc_unbiased': 90.842, 'test/diff': 5.793, 'test/acc_skew': 87.945, 'test/acc_align': 93.738}
[7 / 10] best valid accuracy: 92.301 at epoch 7 
 best_stats: {'best_valid_epoch': 7, 'best_valid_valid/acc': 94.9, 'best_valid_valid/acc_unbiased': 92.301, 'best_valid_valid/diff': 5.12, 'best_valid_valid/acc_skew': 91.172, 'best_valid_valid/acc_align': 93.43, 'best_valid_test/acc': 94.302, 'best_valid_test/acc_unbiased': 90.842, 'best_valid_test/diff': 5.793, 'best_valid_test/acc_skew': 87.945, 'best_valid_test/acc_align': 93.738}
[7 / 10] best test accuracy: 91.391 at epoch 3 
 best_stats: {'best_test_epoch': 3, 'best_test_valid/acc': 94.117, 'best_test_valid/acc_unbiased': 92.227, 'best_test_valid/diff': 4.234, 'best_test_valid/acc_skew': 90.11, 'best_test_valid/acc_align': 94.344, 'best_test_test/acc': 91.644, 'best_test_test/acc_unbiased': 91.391, 'best_test_test/diff': 6.553, 'best_test_test/acc_skew': 88.115, 'best_test_test/acc_align': 94.668}
[8 / 10] Learning rate: 1e-05 weight: 0.01
[8 / 10] Loss: 4.5779594608148795 CE Loss: 0.13539751274329234 Con Loss: 4.576605487796455
[8 / 10] tensor([[0.934, 0.979],
        [0.892, 0.786]]) {'epoch': 8, 'valid/acc': 95.002, 'valid/acc_unbiased': 91.719, 'valid/diff': 5.309, 'valid/acc_skew': 90.151, 'valid/acc_align': 93.288, 'test/acc': 94.519, 'test/acc_unbiased': 89.763, 'test/diff': 7.562, 'test/acc_skew': 85.982, 'test/acc_align': 93.544}
[8 / 10] best valid accuracy: 92.301 at epoch 7 
 best_stats: {'best_valid_epoch': 7, 'best_valid_valid/acc': 94.9, 'best_valid_valid/acc_unbiased': 92.301, 'best_valid_valid/diff': 5.12, 'best_valid_valid/acc_skew': 91.172, 'best_valid_valid/acc_align': 93.43, 'best_valid_test/acc': 94.302, 'best_valid_test/acc_unbiased': 90.842, 'best_valid_test/diff': 5.793, 'best_valid_test/acc_skew': 87.945, 'best_valid_test/acc_align': 93.738}
[8 / 10] best test accuracy: 91.391 at epoch 3 
 best_stats: {'best_test_epoch': 3, 'best_test_valid/acc': 94.117, 'best_test_valid/acc_unbiased': 92.227, 'best_test_valid/diff': 4.234, 'best_test_valid/acc_skew': 90.11, 'best_test_valid/acc_align': 94.344, 'best_test_test/acc': 91.644, 'best_test_test/acc_unbiased': 91.391, 'best_test_test/diff': 6.553, 'best_test_test/acc_skew': 88.115, 'best_test_test/acc_align': 94.668}
[9 / 10] Learning rate: 1e-05 weight: 0.01
[9 / 10] Loss: 4.575662855173299 CE Loss: 0.13524132155542698 Con Loss: 4.5743104399389685
[9 / 10] tensor([[0.911, 0.967],
        [0.929, 0.863]]) {'epoch': 9, 'valid/acc': 95.298, 'valid/acc_unbiased': 93.655, 'valid/diff': 4.453, 'valid/acc_skew': 92.624, 'valid/acc_align': 94.686, 'test/acc': 93.663, 'test/acc_unbiased': 91.756, 'test/diff': 6.175, 'test/acc_skew': 88.668, 'test/acc_align': 94.843}
[9 / 10] best valid accuracy: 93.655 at epoch 9 
 best_stats: {'best_valid_epoch': 9, 'best_valid_valid/acc': 95.298, 'best_valid_valid/acc_unbiased': 93.655, 'best_valid_valid/diff': 4.453, 'best_valid_valid/acc_skew': 92.624, 'best_valid_valid/acc_align': 94.686, 'best_valid_test/acc': 93.663, 'best_valid_test/acc_unbiased': 91.756, 'best_valid_test/diff': 6.175, 'best_valid_test/acc_skew': 88.668, 'best_valid_test/acc_align': 94.843}
[9 / 10] best test accuracy: 91.756 at epoch 9 
 best_stats: {'best_test_epoch': 9, 'best_test_valid/acc': 95.298, 'best_test_valid/acc_unbiased': 93.655, 'best_test_valid/diff': 4.453, 'best_test_valid/acc_skew': 92.624, 'best_test_valid/acc_align': 94.686, 'best_test_test/acc': 93.663, 'best_test_test/acc_unbiased': 91.756, 'best_test_test/diff': 6.175, 'best_test_test/acc_skew': 88.668, 'best_test_test/acc_align': 94.843}
[10 / 10] Learning rate: 1e-05 weight: 0.01
[10 / 10] Loss: 4.5730981139735345 CE Loss: 0.1323462965305665 Con Loss: 4.571774647372563
[10 / 10] tensor([[0.924, 0.973],
        [0.909, 0.830]]) {'epoch': 10, 'valid/acc': 95.169, 'valid/acc_unbiased': 92.769, 'valid/diff': 4.584, 'valid/acc_skew': 91.63, 'valid/acc_align': 93.909, 'test/acc': 94.166, 'test/acc_unbiased': 90.912, 'test/diff': 6.425, 'test/acc_skew': 87.699, 'test/acc_align': 94.124}
[10 / 10] best valid accuracy: 93.655 at epoch 9 
 best_stats: {'best_valid_epoch': 9, 'best_valid_valid/acc': 95.298, 'best_valid_valid/acc_unbiased': 93.655, 'best_valid_valid/diff': 4.453, 'best_valid_valid/acc_skew': 92.624, 'best_valid_valid/acc_align': 94.686, 'best_valid_test/acc': 93.663, 'best_valid_test/acc_unbiased': 91.756, 'best_valid_test/diff': 6.175, 'best_valid_test/acc_skew': 88.668, 'best_valid_test/acc_align': 94.843}
[10 / 10] best test accuracy: 91.756 at epoch 9 
 best_stats: {'best_test_epoch': 9, 'best_test_valid/acc': 95.298, 'best_test_valid/acc_unbiased': 93.655, 'best_test_valid/diff': 4.453, 'best_test_valid/acc_skew': 92.624, 'best_test_valid/acc_align': 94.686, 'best_test_test/acc': 93.663, 'best_test_test/acc_unbiased': 91.756, 'best_test_test/diff': 6.175, 'best_test_test/acc_skew': 88.668, 'best_test_test/acc_align': 94.843}
Total training time: 1:05:32
