Log level set to: INFO
Set seed: 3
=======> Using Fixed Random Seed: 3 <========
save_path: exp_results/bc-bb0-celeba_smiling-os-lr0.001-bs128-cbs64-w0.01-ratio30-aug1-seed3
get_celeba - split:train, aug: False, given_y: True, ratio: 0
use existing smiling indices from data/celeba/pickles/smiling
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [40621, 40621]
Target 1: [40621, 40621]
Binary Target 1
---------------------------
Target 0: [40621, 40621]
Target 1: [40621, 40621]
===================================
Normal Label Distribution: 
Target 0: [40621, 40621]
Target 1: [40621, 40621]
===================================
Use BiasedCelebASplit 
 target_attr: smiling split: train 
 tensor([[40621., 40621.],
        [40621., 40621.]])
get_celeba - split:train, aug: 1, given_y: True, ratio: 30
use existing smiling indices from data/celeba/pickles/smiling
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [40802, 40802]
Target 1: [40802, 40802]
Binary Target 1
---------------------------
Target 0: [40802, 40802]
Target 1: [40802, 40802]
===================================
Normal Label Distribution: 
Target 0: [40802, 40802]
Target 1: [40802, 40802]
===================================
Use BiasedCelebASplit 
 target_attr: smiling split: train 
 tensor([[40802., 40802.],
        [40802., 40802.]])
get_celeba - split:train_valid, aug: False, given_y: True, ratio: 0
use existing smiling indices from data/celeba/pickles/smiling
Use BiasedCelebASplit 
 target_attr: smiling split: train_valid 
 tensor([[ 1944., 10217.],
        [ 8222.,  1982.]])
get_celeba - split:valid, aug: False, given_y: True, ratio: 0
Use BiasedCelebASplit 
 target_attr: smiling split: valid 
 tensor([[5252., 6157.],
        [5013., 3445.]])
decay_epochs: [3, 6]
[1 / 10] Learning rate: 0.001 weight: 0.01
[1 / 10] Loss: 4.629437693998781 CE Loss: 0.24629626671301996 Con Loss: 4.6269747315773495
[1 / 10] tensor([[0.977, 0.964],
        [0.847, 0.821]]) {'epoch': 1, 'valid/acc': 89.765, 'valid/acc_unbiased': 90.136, 'valid/diff': 1.374, 'valid/acc_skew': 90.823, 'valid/acc_align': 89.449, 'test/acc': 90.643, 'test/acc_unbiased': 90.229, 'test/diff': 1.969, 'test/acc_skew': 91.213, 'test/acc_align': 89.244}
[1 / 10] best valid accuracy: 90.136 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 89.765, 'best_valid_valid/acc_unbiased': 90.136, 'best_valid_valid/diff': 1.374, 'best_valid_valid/acc_skew': 90.823, 'best_valid_valid/acc_align': 89.449, 'best_valid_test/acc': 90.643, 'best_valid_test/acc_unbiased': 90.229, 'best_valid_test/diff': 1.969, 'best_valid_test/acc_skew': 91.213, 'best_valid_test/acc_align': 89.244}
[1 / 10] best test accuracy: 90.229 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 89.765, 'best_test_valid/acc_unbiased': 90.136, 'best_test_valid/diff': 1.374, 'best_test_valid/acc_skew': 90.823, 'best_test_valid/acc_align': 89.449, 'best_test_test/acc': 90.643, 'best_test_test/acc_unbiased': 90.229, 'best_test_test/diff': 1.969, 'best_test_test/acc_skew': 91.213, 'best_test_test/acc_align': 89.244}
[2 / 10] Learning rate: 0.001 weight: 0.01
[2 / 10] Loss: 4.595019616186435 CE Loss: 0.2262082414027111 Con Loss: 4.5927575330832155
[2 / 10] tensor([[0.941, 0.915],
        [0.917, 0.900]]) {'epoch': 2, 'valid/acc': 91.567, 'valid/acc_unbiased': 91.569, 'valid/diff': 1.596, 'valid/acc_skew': 92.367, 'valid/acc_align': 90.771, 'test/acc': 92.012, 'test/acc_unbiased': 91.843, 'test/diff': 2.179, 'test/acc_skew': 92.933, 'test/acc_align': 90.754}
[2 / 10] best valid accuracy: 91.569 at epoch 2 
 best_stats: {'best_valid_epoch': 2, 'best_valid_valid/acc': 91.567, 'best_valid_valid/acc_unbiased': 91.569, 'best_valid_valid/diff': 1.596, 'best_valid_valid/acc_skew': 92.367, 'best_valid_valid/acc_align': 90.771, 'best_valid_test/acc': 92.012, 'best_valid_test/acc_unbiased': 91.843, 'best_valid_test/diff': 2.179, 'best_valid_test/acc_skew': 92.933, 'best_valid_test/acc_align': 90.754}
[2 / 10] best test accuracy: 91.843 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 91.567, 'best_test_valid/acc_unbiased': 91.569, 'best_test_valid/diff': 1.596, 'best_test_valid/acc_skew': 92.367, 'best_test_valid/acc_align': 90.771, 'best_test_test/acc': 92.012, 'best_test_test/acc_unbiased': 91.843, 'best_test_test/diff': 2.179, 'best_test_test/acc_skew': 92.933, 'best_test_test/acc_align': 90.754}
[3 / 10] Learning rate: 0.001 weight: 0.01
[3 / 10] Loss: 4.585576802441518 CE Loss: 0.2189730394606221 Con Loss: 4.583387073240658
[3 / 10] tensor([[0.930, 0.904],
        [0.917, 0.911]]) {'epoch': 3, 'valid/acc': 91.209, 'valid/acc_unbiased': 91.671, 'valid/diff': 1.776, 'valid/acc_skew': 92.559, 'valid/acc_align': 90.784, 'test/acc': 91.599, 'test/acc_unbiased': 91.54, 'test/diff': 1.578, 'test/acc_skew': 92.329, 'test/acc_align': 90.751}
[3 / 10] best valid accuracy: 91.671 at epoch 3 
 best_stats: {'best_valid_epoch': 3, 'best_valid_valid/acc': 91.209, 'best_valid_valid/acc_unbiased': 91.671, 'best_valid_valid/diff': 1.776, 'best_valid_valid/acc_skew': 92.559, 'best_valid_valid/acc_align': 90.784, 'best_valid_test/acc': 91.599, 'best_valid_test/acc_unbiased': 91.54, 'best_valid_test/diff': 1.578, 'best_valid_test/acc_skew': 92.329, 'best_valid_test/acc_align': 90.751}
[3 / 10] best test accuracy: 91.843 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 91.567, 'best_test_valid/acc_unbiased': 91.569, 'best_test_valid/diff': 1.596, 'best_test_valid/acc_skew': 92.367, 'best_test_valid/acc_align': 90.771, 'best_test_test/acc': 92.012, 'best_test_test/acc_unbiased': 91.843, 'best_test_test/diff': 2.179, 'best_test_test/acc_skew': 92.933, 'best_test_test/acc_align': 90.754}
[4 / 10] Learning rate: 0.0001 weight: 0.01
[4 / 10] Loss: 4.542869676982178 CE Loss: 0.19317094454199868 Con Loss: 4.5409379685688975
[4 / 10] tensor([[0.944, 0.923],
        [0.921, 0.914]]) {'epoch': 4, 'valid/acc': 92.372, 'valid/acc_unbiased': 92.722, 'valid/diff': 1.217, 'valid/acc_skew': 93.331, 'valid/acc_align': 92.113, 'test/acc': 92.651, 'test/acc_unbiased': 92.565, 'test/diff': 1.414, 'test/acc_skew': 93.272, 'test/acc_align': 91.858}
[4 / 10] best valid accuracy: 92.722 at epoch 4 
 best_stats: {'best_valid_epoch': 4, 'best_valid_valid/acc': 92.372, 'best_valid_valid/acc_unbiased': 92.722, 'best_valid_valid/diff': 1.217, 'best_valid_valid/acc_skew': 93.331, 'best_valid_valid/acc_align': 92.113, 'best_valid_test/acc': 92.651, 'best_valid_test/acc_unbiased': 92.565, 'best_valid_test/diff': 1.414, 'best_valid_test/acc_skew': 93.272, 'best_valid_test/acc_align': 91.858}
[4 / 10] best test accuracy: 92.565 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 92.372, 'best_test_valid/acc_unbiased': 92.722, 'best_test_valid/diff': 1.217, 'best_test_valid/acc_skew': 93.331, 'best_test_valid/acc_align': 92.113, 'best_test_test/acc': 92.651, 'best_test_test/acc_unbiased': 92.565, 'best_test_test/diff': 1.414, 'best_test_test/acc_skew': 93.272, 'best_test_test/acc_align': 91.858}
[5 / 10] Learning rate: 0.0001 weight: 0.01
[5 / 10] Loss: 4.531908977695237 CE Loss: 0.18758012952093142 Con Loss: 4.530033173529049
[5 / 10] tensor([[0.935, 0.935],
        [0.930, 0.900]]) {'epoch': 5, 'valid/acc': 92.949, 'valid/acc_unbiased': 92.865, 'valid/diff': 1.403, 'valid/acc_skew': 93.567, 'valid/acc_align': 92.163, 'test/acc': 92.732, 'test/acc_unbiased': 92.496, 'test/diff': 1.5, 'test/acc_skew': 93.245, 'test/acc_align': 91.746}
[5 / 10] best valid accuracy: 92.865 at epoch 5 
 best_stats: {'best_valid_epoch': 5, 'best_valid_valid/acc': 92.949, 'best_valid_valid/acc_unbiased': 92.865, 'best_valid_valid/diff': 1.403, 'best_valid_valid/acc_skew': 93.567, 'best_valid_valid/acc_align': 92.163, 'best_valid_test/acc': 92.732, 'best_valid_test/acc_unbiased': 92.496, 'best_valid_test/diff': 1.5, 'best_valid_test/acc_skew': 93.245, 'best_valid_test/acc_align': 91.746}
[5 / 10] best test accuracy: 92.565 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 92.372, 'best_test_valid/acc_unbiased': 92.722, 'best_test_valid/diff': 1.217, 'best_test_valid/acc_skew': 93.331, 'best_test_valid/acc_align': 92.113, 'best_test_test/acc': 92.651, 'best_test_test/acc_unbiased': 92.565, 'best_test_test/diff': 1.414, 'best_test_test/acc_skew': 93.272, 'best_test_test/acc_align': 91.858}
[6 / 10] Learning rate: 0.0001 weight: 0.01
[6 / 10] Loss: 4.522277521836476 CE Loss: 0.18520067335062848 Con Loss: 4.520425517785432
[6 / 10] tensor([[0.942, 0.928],
        [0.925, 0.912]]) {'epoch': 6, 'valid/acc': 92.493, 'valid/acc_unbiased': 92.76, 'valid/diff': 1.239, 'valid/acc_skew': 93.379, 'valid/acc_align': 92.14, 'test/acc': 92.777, 'test/acc_unbiased': 92.653, 'test/diff': 1.371, 'test/acc_skew': 93.338, 'test/acc_align': 91.967}
[6 / 10] best valid accuracy: 92.865 at epoch 5 
 best_stats: {'best_valid_epoch': 5, 'best_valid_valid/acc': 92.949, 'best_valid_valid/acc_unbiased': 92.865, 'best_valid_valid/diff': 1.403, 'best_valid_valid/acc_skew': 93.567, 'best_valid_valid/acc_align': 92.163, 'best_valid_test/acc': 92.732, 'best_valid_test/acc_unbiased': 92.496, 'best_valid_test/diff': 1.5, 'best_valid_test/acc_skew': 93.245, 'best_valid_test/acc_align': 91.746}
[6 / 10] best test accuracy: 92.653 at epoch 6 
 best_stats: {'best_test_epoch': 6, 'best_test_valid/acc': 92.493, 'best_test_valid/acc_unbiased': 92.76, 'best_test_valid/diff': 1.239, 'best_test_valid/acc_skew': 93.379, 'best_test_valid/acc_align': 92.14, 'best_test_test/acc': 92.777, 'best_test_test/acc_unbiased': 92.653, 'best_test_test/diff': 1.371, 'best_test_test/acc_skew': 93.338, 'best_test_test/acc_align': 91.967}
[7 / 10] Learning rate: 1e-05 weight: 0.01
[7 / 10] Loss: 4.518144685347955 CE Loss: 0.18026631807007884 Con Loss: 4.5163420241585905
[7 / 10] tensor([[0.946, 0.927],
        [0.922, 0.915]]) {'epoch': 7, 'valid/acc': 92.734, 'valid/acc_unbiased': 93.114, 'valid/diff': 1.493, 'valid/acc_skew': 93.861, 'valid/acc_align': 92.368, 'test/acc': 92.842, 'test/acc_unbiased': 92.753, 'test/diff': 1.272, 'test/acc_skew': 93.389, 'test/acc_align': 92.117}
[7 / 10] best valid accuracy: 93.114 at epoch 7 
 best_stats: {'best_valid_epoch': 7, 'best_valid_valid/acc': 92.734, 'best_valid_valid/acc_unbiased': 93.114, 'best_valid_valid/diff': 1.493, 'best_valid_valid/acc_skew': 93.861, 'best_valid_valid/acc_align': 92.368, 'best_valid_test/acc': 92.842, 'best_valid_test/acc_unbiased': 92.753, 'best_valid_test/diff': 1.272, 'best_valid_test/acc_skew': 93.389, 'best_valid_test/acc_align': 92.117}
[7 / 10] best test accuracy: 92.753 at epoch 7 
 best_stats: {'best_test_epoch': 7, 'best_test_valid/acc': 92.734, 'best_test_valid/acc_unbiased': 93.114, 'best_test_valid/diff': 1.493, 'best_test_valid/acc_skew': 93.861, 'best_test_valid/acc_align': 92.368, 'best_test_test/acc': 92.842, 'best_test_test/acc_unbiased': 92.753, 'best_test_test/diff': 1.272, 'best_test_test/acc_skew': 93.389, 'best_test_test/acc_align': 92.117}
[8 / 10] Learning rate: 1e-05 weight: 0.01
[8 / 10] Loss: 4.513602428054067 CE Loss: 0.17929971774999726 Con Loss: 4.511809435409832
[8 / 10] tensor([[0.945, 0.932],
        [0.923, 0.910]]) {'epoch': 8, 'valid/acc': 92.837, 'valid/acc_unbiased': 93.029, 'valid/diff': 1.295, 'valid/acc_skew': 93.677, 'valid/acc_align': 92.382, 'test/acc': 92.873, 'test/acc_unbiased': 92.741, 'test/diff': 1.294, 'test/acc_skew': 93.388, 'test/acc_align': 92.094}
[8 / 10] best valid accuracy: 93.114 at epoch 7 
 best_stats: {'best_valid_epoch': 7, 'best_valid_valid/acc': 92.734, 'best_valid_valid/acc_unbiased': 93.114, 'best_valid_valid/diff': 1.493, 'best_valid_valid/acc_skew': 93.861, 'best_valid_valid/acc_align': 92.368, 'best_valid_test/acc': 92.842, 'best_valid_test/acc_unbiased': 92.753, 'best_valid_test/diff': 1.272, 'best_valid_test/acc_skew': 93.389, 'best_valid_test/acc_align': 92.117}
[8 / 10] best test accuracy: 92.753 at epoch 7 
 best_stats: {'best_test_epoch': 7, 'best_test_valid/acc': 92.734, 'best_test_valid/acc_unbiased': 93.114, 'best_test_valid/diff': 1.493, 'best_test_valid/acc_skew': 93.861, 'best_test_valid/acc_align': 92.368, 'best_test_test/acc': 92.842, 'best_test_test/acc_unbiased': 92.753, 'best_test_test/diff': 1.272, 'best_test_test/acc_skew': 93.389, 'best_test_test/acc_align': 92.117}
[9 / 10] Learning rate: 1e-05 weight: 0.01
[9 / 10] Loss: 4.517958328709293 CE Loss: 0.17859607367514713 Con Loss: 4.516172365765343
[9 / 10] tensor([[0.936, 0.924],
        [0.931, 0.916]]) {'epoch': 9, 'valid/acc': 92.94, 'valid/acc_unbiased': 93.015, 'valid/diff': 1.127, 'valid/acc_skew': 93.579, 'valid/acc_align': 92.452, 'test/acc': 92.817, 'test/acc_unbiased': 92.699, 'test/diff': 1.339, 'test/acc_skew': 93.369, 'test/acc_align': 92.03}
[9 / 10] best valid accuracy: 93.114 at epoch 7 
 best_stats: {'best_valid_epoch': 7, 'best_valid_valid/acc': 92.734, 'best_valid_valid/acc_unbiased': 93.114, 'best_valid_valid/diff': 1.493, 'best_valid_valid/acc_skew': 93.861, 'best_valid_valid/acc_align': 92.368, 'best_valid_test/acc': 92.842, 'best_valid_test/acc_unbiased': 92.753, 'best_valid_test/diff': 1.272, 'best_valid_test/acc_skew': 93.389, 'best_valid_test/acc_align': 92.117}
[9 / 10] best test accuracy: 92.753 at epoch 7 
 best_stats: {'best_test_epoch': 7, 'best_test_valid/acc': 92.734, 'best_test_valid/acc_unbiased': 93.114, 'best_test_valid/diff': 1.493, 'best_test_valid/acc_skew': 93.861, 'best_test_valid/acc_align': 92.368, 'best_test_test/acc': 92.842, 'best_test_test/acc_unbiased': 92.753, 'best_test_test/diff': 1.272, 'best_test_test/acc_skew': 93.389, 'best_test_test/acc_align': 92.117}
[10 / 10] Learning rate: 1e-05 weight: 0.01
[10 / 10] Loss: 4.512819265991179 CE Loss: 0.1776895051451243 Con Loss: 4.511042364209275
[10 / 10] tensor([[0.945, 0.934],
        [0.924, 0.906]]) {'epoch': 10, 'valid/acc': 92.891, 'valid/acc_unbiased': 93.027, 'valid/diff': 1.153, 'valid/acc_skew': 93.604, 'valid/acc_align': 92.45, 'test/acc': 92.918, 'test/acc_unbiased': 92.748, 'test/diff': 1.435, 'test/acc_skew': 93.466, 'test/acc_align': 92.031}
[10 / 10] best valid accuracy: 93.114 at epoch 7 
 best_stats: {'best_valid_epoch': 7, 'best_valid_valid/acc': 92.734, 'best_valid_valid/acc_unbiased': 93.114, 'best_valid_valid/diff': 1.493, 'best_valid_valid/acc_skew': 93.861, 'best_valid_valid/acc_align': 92.368, 'best_valid_test/acc': 92.842, 'best_valid_test/acc_unbiased': 92.753, 'best_valid_test/diff': 1.272, 'best_valid_test/acc_skew': 93.389, 'best_valid_test/acc_align': 92.117}
[10 / 10] best test accuracy: 92.753 at epoch 7 
 best_stats: {'best_test_epoch': 7, 'best_test_valid/acc': 92.734, 'best_test_valid/acc_unbiased': 93.114, 'best_test_valid/diff': 1.493, 'best_test_valid/acc_skew': 93.861, 'best_test_valid/acc_align': 92.368, 'best_test_test/acc': 92.842, 'best_test_test/acc_unbiased': 92.753, 'best_test_test/diff': 1.272, 'best_test_test/acc_skew': 93.389, 'best_test_test/acc_align': 92.117}
Total training time: 2:24:50
