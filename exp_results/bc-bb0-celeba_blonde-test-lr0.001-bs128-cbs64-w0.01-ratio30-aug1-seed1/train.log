Log level set to: INFO
Set seed: 1
=======> Using Fixed Random Seed: 1 <========
save_path: exp_results/bc-bb0-celeba_blonde-test-lr0.001-bs128-cbs64-w0.01-ratio30-aug1-seed1
get_celeba - split:train, aug: False, given_y: True, ratio: 0
get_celeba - split:train, aug: 1, given_y: True, ratio: 30
get_celeba - split:train_valid, aug: False, given_y: True, ratio: 0
get_celeba - split:valid, aug: False, given_y: True, ratio: 0
decay_epochs: [3, 6]
[1 / 10] Learning rate: 0.001 weight: 0.01
[1 / 10] Loss: 4.709751584997294 CE Loss: 0.19843859081683507 Con Loss: 4.70776719915936
[1 / 10] tensor([[0.975, 0.985],
        [0.658, 0.495]]) {'epoch': 1, 'valid/acc': 89.559, 'valid/acc_unbiased': 78.648, 'valid/diff': 8.208, 'valid/acc_skew': 75.023, 'valid/acc_align': 82.273, 'test/acc': 92.903, 'test/acc_unbiased': 77.813, 'test/diff': 8.637, 'test/acc_skew': 73.495, 'test/acc_align': 82.132}
[1 / 10] best valid accuracy: 78.648 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 89.559, 'best_valid_valid/acc_unbiased': 78.648, 'best_valid_valid/diff': 8.208, 'best_valid_valid/acc_skew': 75.023, 'best_valid_valid/acc_align': 82.273, 'best_valid_test/acc': 92.903, 'best_valid_test/acc_unbiased': 77.813, 'best_valid_test/diff': 8.637, 'best_valid_test/acc_skew': 73.495, 'best_valid_test/acc_align': 82.132}
[1 / 10] best test accuracy: 77.813 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 89.559, 'best_test_valid/acc_unbiased': 78.648, 'best_test_valid/diff': 8.208, 'best_test_valid/acc_skew': 75.023, 'best_test_valid/acc_align': 82.273, 'best_test_test/acc': 92.903, 'best_test_test/acc_unbiased': 77.813, 'best_test_test/diff': 8.637, 'best_test_test/acc_skew': 73.495, 'best_test_test/acc_align': 82.132}
[2 / 10] Learning rate: 0.001 weight: 0.01
[2 / 10] Loss: 4.674226970766807 CE Loss: 0.173092751319198 Con Loss: 4.672496040005118
[2 / 10] tensor([[0.934, 0.983],
        [0.859, 0.681]]) {'epoch': 2, 'valid/acc': 94.208, 'valid/acc_unbiased': 87.23, 'valid/diff': 8.938, 'valid/acc_skew': 82.903, 'valid/acc_align': 91.558, 'test/acc': 94.131, 'test/acc_unbiased': 86.432, 'test/diff': 11.305, 'test/acc_skew': 80.779, 'test/acc_align': 92.085}
[2 / 10] best valid accuracy: 87.230 at epoch 2 
 best_stats: {'best_valid_epoch': 2, 'best_valid_valid/acc': 94.208, 'best_valid_valid/acc_unbiased': 87.23, 'best_valid_valid/diff': 8.938, 'best_valid_valid/acc_skew': 82.903, 'best_valid_valid/acc_align': 91.558, 'best_valid_test/acc': 94.131, 'best_valid_test/acc_unbiased': 86.432, 'best_valid_test/diff': 11.305, 'best_valid_test/acc_skew': 80.779, 'best_valid_test/acc_align': 92.085}
[2 / 10] best test accuracy: 86.432 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 94.208, 'best_test_valid/acc_unbiased': 87.23, 'best_test_valid/diff': 8.938, 'best_test_valid/acc_skew': 82.903, 'best_test_valid/acc_align': 91.558, 'best_test_test/acc': 94.131, 'best_test_test/acc_unbiased': 86.432, 'best_test_test/diff': 11.305, 'best_test_test/acc_skew': 80.779, 'best_test_test/acc_align': 92.085}
[3 / 10] Learning rate: 0.001 weight: 0.01
[3 / 10] Loss: 4.660262576392569 CE Loss: 0.16477352836394685 Con Loss: 4.658614846496385
[3 / 10] tensor([[0.925, 0.975],
        [0.877, 0.753]]) {'epoch': 3, 'valid/acc': 93.913, 'valid/acc_unbiased': 88.587, 'valid/diff': 6.843, 'valid/acc_skew': 85.504, 'valid/acc_align': 91.67, 'test/acc': 93.698, 'test/acc_unbiased': 88.222, 'test/diff': 8.702, 'test/acc_skew': 83.871, 'test/acc_align': 92.573}
[3 / 10] best valid accuracy: 88.587 at epoch 3 
 best_stats: {'best_valid_epoch': 3, 'best_valid_valid/acc': 93.913, 'best_valid_valid/acc_unbiased': 88.587, 'best_valid_valid/diff': 6.843, 'best_valid_valid/acc_skew': 85.504, 'best_valid_valid/acc_align': 91.67, 'best_valid_test/acc': 93.698, 'best_valid_test/acc_unbiased': 88.222, 'best_valid_test/diff': 8.702, 'best_valid_test/acc_skew': 83.871, 'best_valid_test/acc_align': 92.573}
[3 / 10] best test accuracy: 88.222 at epoch 3 
 best_stats: {'best_test_epoch': 3, 'best_test_valid/acc': 93.913, 'best_test_valid/acc_unbiased': 88.587, 'best_test_valid/diff': 6.843, 'best_test_valid/acc_skew': 85.504, 'best_test_valid/acc_align': 91.67, 'best_test_test/acc': 93.698, 'best_test_test/acc_unbiased': 88.222, 'best_test_test/diff': 8.702, 'best_test_test/acc_skew': 83.871, 'best_test_test/acc_align': 92.573}
[4 / 10] Learning rate: 0.0001 weight: 0.01
[4 / 10] Loss: 4.6049165403174825 CE Loss: 0.14079763587833807 Con Loss: 4.603508560396915
[4 / 10] tensor([[0.917, 0.977],
        [0.913, 0.747]]) {'epoch': 4, 'valid/acc': 95.233, 'valid/acc_unbiased': 90.265, 'valid/diff': 7.184, 'valid/acc_skew': 86.754, 'valid/acc_align': 93.777, 'test/acc': 93.975, 'test/acc_unbiased': 88.844, 'test/diff': 11.27, 'test/acc_skew': 83.209, 'test/acc_align': 94.479}
[4 / 10] best valid accuracy: 90.265 at epoch 4 
 best_stats: {'best_valid_epoch': 4, 'best_valid_valid/acc': 95.233, 'best_valid_valid/acc_unbiased': 90.265, 'best_valid_valid/diff': 7.184, 'best_valid_valid/acc_skew': 86.754, 'best_valid_valid/acc_align': 93.777, 'best_valid_test/acc': 93.975, 'best_valid_test/acc_unbiased': 88.844, 'best_valid_test/diff': 11.27, 'best_valid_test/acc_skew': 83.209, 'best_valid_test/acc_align': 94.479}
[4 / 10] best test accuracy: 88.844 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 95.233, 'best_test_valid/acc_unbiased': 90.265, 'best_test_valid/diff': 7.184, 'best_test_valid/acc_skew': 86.754, 'best_test_valid/acc_align': 93.777, 'best_test_test/acc': 93.975, 'best_test_test/acc_unbiased': 88.844, 'best_test_test/diff': 11.27, 'best_test_test/acc_skew': 83.209, 'best_test_test/acc_align': 94.479}
[5 / 10] Learning rate: 0.0001 weight: 0.01
[5 / 10] Loss: 4.576098940007442 CE Loss: 0.132919104251869 Con Loss: 4.57476974091664
[5 / 10] tensor([[0.933, 0.981],
        [0.887, 0.769]]) {'epoch': 5, 'valid/acc': 94.874, 'valid/acc_unbiased': 91.025, 'valid/diff': 4.87, 'valid/acc_skew': 89.437, 'valid/acc_align': 92.614, 'test/acc': 94.514, 'test/acc_unbiased': 89.277, 'test/diff': 8.287, 'test/acc_skew': 85.134, 'test/acc_align': 93.421}
[5 / 10] best valid accuracy: 91.025 at epoch 5 
 best_stats: {'best_valid_epoch': 5, 'best_valid_valid/acc': 94.874, 'best_valid_valid/acc_unbiased': 91.025, 'best_valid_valid/diff': 4.87, 'best_valid_valid/acc_skew': 89.437, 'best_valid_valid/acc_align': 92.614, 'best_valid_test/acc': 94.514, 'best_valid_test/acc_unbiased': 89.277, 'best_valid_test/diff': 8.287, 'best_valid_test/acc_skew': 85.134, 'best_valid_test/acc_align': 93.421}
[5 / 10] best test accuracy: 89.277 at epoch 5 
 best_stats: {'best_test_epoch': 5, 'best_test_valid/acc': 94.874, 'best_test_valid/acc_unbiased': 91.025, 'best_test_valid/diff': 4.87, 'best_test_valid/acc_skew': 89.437, 'best_test_valid/acc_align': 92.614, 'best_test_test/acc': 94.514, 'best_test_test/acc_unbiased': 89.277, 'best_test_test/diff': 8.287, 'best_test_test/acc_skew': 85.134, 'best_test_test/acc_align': 93.421}
[6 / 10] Learning rate: 0.0001 weight: 0.01
[6 / 10] Loss: 4.5697465115973745 CE Loss: 0.12952751315456618 Con Loss: 4.568451241564285
[6 / 10] tensor([[0.925, 0.980],
        [0.894, 0.714]]) {'epoch': 6, 'valid/acc': 95.308, 'valid/acc_unbiased': 91.262, 'valid/diff': 6.393, 'valid/acc_skew': 89.029, 'valid/acc_align': 93.495, 'test/acc': 94.191, 'test/acc_unbiased': 87.86, 'test/diff': 11.744, 'test/acc_skew': 81.988, 'test/acc_align': 93.732}
[6 / 10] best valid accuracy: 91.262 at epoch 6 
 best_stats: {'best_valid_epoch': 6, 'best_valid_valid/acc': 95.308, 'best_valid_valid/acc_unbiased': 91.262, 'best_valid_valid/diff': 6.393, 'best_valid_valid/acc_skew': 89.029, 'best_valid_valid/acc_align': 93.495, 'best_valid_test/acc': 94.191, 'best_valid_test/acc_unbiased': 87.86, 'best_valid_test/diff': 11.744, 'best_valid_test/acc_skew': 81.988, 'best_valid_test/acc_align': 93.732}
[6 / 10] best test accuracy: 89.277 at epoch 5 
 best_stats: {'best_test_epoch': 5, 'best_test_valid/acc': 94.874, 'best_test_valid/acc_unbiased': 91.025, 'best_test_valid/diff': 4.87, 'best_test_valid/acc_skew': 89.437, 'best_test_valid/acc_align': 92.614, 'best_test_test/acc': 94.514, 'best_test_test/acc_unbiased': 89.277, 'best_test_test/diff': 8.287, 'best_test_test/acc_skew': 85.134, 'best_test_test/acc_align': 93.421}
[7 / 10] Learning rate: 1e-05 weight: 0.01
[7 / 10] Loss: 4.560279813118956 CE Loss: 0.12653954079447066 Con Loss: 4.55901441365218
[7 / 10] tensor([[0.921, 0.978],
        [0.906, 0.764]]) {'epoch': 7, 'valid/acc': 95.26, 'valid/acc_unbiased': 91.185, 'valid/diff': 6.835, 'valid/acc_skew': 88.723, 'valid/acc_align': 93.647, 'test/acc': 94.146, 'test/acc_unbiased': 89.233, 'test/diff': 9.954, 'test/acc_skew': 84.256, 'test/acc_align': 94.21}
[7 / 10] best valid accuracy: 91.262 at epoch 6 
 best_stats: {'best_valid_epoch': 6, 'best_valid_valid/acc': 95.308, 'best_valid_valid/acc_unbiased': 91.262, 'best_valid_valid/diff': 6.393, 'best_valid_valid/acc_skew': 89.029, 'best_valid_valid/acc_align': 93.495, 'best_valid_test/acc': 94.191, 'best_valid_test/acc_unbiased': 87.86, 'best_valid_test/diff': 11.744, 'best_valid_test/acc_skew': 81.988, 'best_valid_test/acc_align': 93.732}
[7 / 10] best test accuracy: 89.277 at epoch 5 
 best_stats: {'best_test_epoch': 5, 'best_test_valid/acc': 94.874, 'best_test_valid/acc_unbiased': 91.025, 'best_test_valid/diff': 4.87, 'best_test_valid/acc_skew': 89.437, 'best_test_valid/acc_align': 92.614, 'best_test_test/acc': 94.514, 'best_test_test/acc_unbiased': 89.277, 'best_test_test/diff': 8.287, 'best_test_test/acc_skew': 85.134, 'best_test_test/acc_align': 93.421}
[8 / 10] Learning rate: 1e-05 weight: 0.01
[8 / 10] Loss: 4.556114344016303 CE Loss: 0.12331266269577351 Con Loss: 4.554881222032543
[8 / 10] tensor([[0.925, 0.981],
        [0.902, 0.747]]) {'epoch': 8, 'valid/acc': 95.512, 'valid/acc_unbiased': 91.419, 'valid/diff': 6.602, 'valid/acc_skew': 89.029, 'valid/acc_align': 93.808, 'test/acc': 94.347, 'test/acc_unbiased': 88.891, 'test/diff': 10.52, 'test/acc_skew': 83.631, 'test/acc_align': 94.151}
[8 / 10] best valid accuracy: 91.419 at epoch 8 
 best_stats: {'best_valid_epoch': 8, 'best_valid_valid/acc': 95.512, 'best_valid_valid/acc_unbiased': 91.419, 'best_valid_valid/diff': 6.602, 'best_valid_valid/acc_skew': 89.029, 'best_valid_valid/acc_align': 93.808, 'best_valid_test/acc': 94.347, 'best_valid_test/acc_unbiased': 88.891, 'best_valid_test/diff': 10.52, 'best_valid_test/acc_skew': 83.631, 'best_valid_test/acc_align': 94.151}
[8 / 10] best test accuracy: 89.277 at epoch 5 
 best_stats: {'best_test_epoch': 5, 'best_test_valid/acc': 94.874, 'best_test_valid/acc_unbiased': 91.025, 'best_test_valid/diff': 4.87, 'best_test_valid/acc_skew': 89.437, 'best_test_valid/acc_align': 92.614, 'best_test_test/acc': 94.514, 'best_test_test/acc_unbiased': 89.277, 'best_test_test/diff': 8.287, 'best_test_test/acc_skew': 85.134, 'best_test_test/acc_align': 93.421}
[9 / 10] Learning rate: 1e-05 weight: 0.01
[9 / 10] Loss: 4.548925765727451 CE Loss: 0.12406210771715638 Con Loss: 4.547685136399813
[9 / 10] tensor([[0.903, 0.974],
        [0.927, 0.797]]) {'epoch': 9, 'valid/acc': 95.62, 'valid/acc_unbiased': 93.239, 'valid/diff': 4.606, 'valid/acc_skew': 91.859, 'valid/acc_align': 94.619, 'test/acc': 93.522, 'test/acc_unbiased': 90.019, 'test/diff': 10.034, 'test/acc_skew': 85.002, 'test/acc_align': 95.036}
[9 / 10] best valid accuracy: 93.239 at epoch 9 
 best_stats: {'best_valid_epoch': 9, 'best_valid_valid/acc': 95.62, 'best_valid_valid/acc_unbiased': 93.239, 'best_valid_valid/diff': 4.606, 'best_valid_valid/acc_skew': 91.859, 'best_valid_valid/acc_align': 94.619, 'best_valid_test/acc': 93.522, 'best_valid_test/acc_unbiased': 90.019, 'best_valid_test/diff': 10.034, 'best_valid_test/acc_skew': 85.002, 'best_valid_test/acc_align': 95.036}
[9 / 10] best test accuracy: 90.019 at epoch 9 
 best_stats: {'best_test_epoch': 9, 'best_test_valid/acc': 95.62, 'best_test_valid/acc_unbiased': 93.239, 'best_test_valid/diff': 4.606, 'best_test_valid/acc_skew': 91.859, 'best_test_valid/acc_align': 94.619, 'best_test_test/acc': 93.522, 'best_test_test/acc_unbiased': 90.019, 'best_test_test/diff': 10.034, 'best_test_test/acc_skew': 85.002, 'best_test_test/acc_align': 95.036}
[10 / 10] Learning rate: 1e-05 weight: 0.01
[10 / 10] Loss: 4.5519425683147485 CE Loss: 0.12273111656573753 Con Loss: 4.550715251928342
[10 / 10] tensor([[0.917, 0.980],
        [0.908, 0.725]]) {'epoch': 10, 'valid/acc': 95.448, 'valid/acc_unbiased': 91.821, 'valid/diff': 6.254, 'valid/acc_skew': 89.744, 'valid/acc_align': 93.898, 'test/acc': 93.99, 'test/acc_unbiased': 88.237, 'test/diff': 12.264, 'test/acc_skew': 82.104, 'test/acc_align': 94.369}
[10 / 10] best valid accuracy: 93.239 at epoch 9 
 best_stats: {'best_valid_epoch': 9, 'best_valid_valid/acc': 95.62, 'best_valid_valid/acc_unbiased': 93.239, 'best_valid_valid/diff': 4.606, 'best_valid_valid/acc_skew': 91.859, 'best_valid_valid/acc_align': 94.619, 'best_valid_test/acc': 93.522, 'best_valid_test/acc_unbiased': 90.019, 'best_valid_test/diff': 10.034, 'best_valid_test/acc_skew': 85.002, 'best_valid_test/acc_align': 95.036}
[10 / 10] best test accuracy: 90.019 at epoch 9 
 best_stats: {'best_test_epoch': 9, 'best_test_valid/acc': 95.62, 'best_test_valid/acc_unbiased': 93.239, 'best_test_valid/diff': 4.606, 'best_test_valid/acc_skew': 91.859, 'best_test_valid/acc_align': 94.619, 'best_test_test/acc': 93.522, 'best_test_test/acc_unbiased': 90.019, 'best_test_test/diff': 10.034, 'best_test_test/acc_skew': 85.002, 'best_test_test/acc_align': 95.036}
Total training time: 1:07:40
