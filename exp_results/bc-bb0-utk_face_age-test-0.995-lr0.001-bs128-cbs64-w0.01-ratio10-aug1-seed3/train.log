Log level set to: INFO
Set seed: 3
=======> Using Fixed Random Seed: 3 <========
save_path: exp_results/bc-bb0-utk_face_age-test-0.995-lr0.001-bs128-cbs64-w0.01-ratio10-aug1-seed3
get_utk_face - split: train, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_age-0.995
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [8237, 7]
Target 1: [41, 1477]
Binary Target 1
---------------------------
Target 0: [8237, 7]
Target 1: [41, 1477]
===================================
Normal Label Distribution: 
Target 0: [8237, 7]
Target 1: [41, 1477]
===================================
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [8237, 7]
Target 1: [41, 1477]
Binary Target 1
---------------------------
Target 0: [8237, 7]
Target 1: [41, 1477]
===================================
Normal Label Distribution: 
Target 0: [8237, 7]
Target 1: [41, 1477]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 9762, target_attr: gender, bias_attr: age bias_rate: 0.995
['[train] target_0-bias_0: 8237', '[train] target_0-bias_1: 7', '[train] target_1-bias_0: 41', '[train] target_1-bias_1: 1477']
confusion_matrix - 
 original: tensor([[8.237e+03, 4.100e+01],
        [7.000e+00, 1.477e+03]]), 
 normalized: tensor([[0.995, 0.005],
        [0.005, 0.995]]), 
 b|y: tensor([[9.992e-01, 8.491e-04],
        [2.701e-02, 9.730e-01]])
get_utk_face - split: train, aug: 1, given_y: True, ratio: 10
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_age-0.995
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [8237, 7]
Target 1: [41, 1477]
Binary Target 1
---------------------------
Target 0: [8237, 7]
Target 1: [41, 1477]
===================================
Normal Label Distribution: 
Target 0: [8237, 7]
Target 1: [41, 1477]
===================================
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [8237, 7]
Target 1: [41, 1477]
Binary Target 1
---------------------------
Target 0: [8237, 7]
Target 1: [41, 1477]
===================================
Normal Label Distribution: 
Target 0: [8237, 7]
Target 1: [41, 1477]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 9762, target_attr: gender, bias_attr: age bias_rate: 0.995
['[train] target_0-bias_0: 8237', '[train] target_0-bias_1: 7', '[train] target_1-bias_0: 41', '[train] target_1-bias_1: 1477']
get_utk_face - split: valid, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_age-0.995
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [1030, 195]
Target 1: [841, 202]
Binary Target 1
---------------------------
Target 0: [1030, 195]
Target 1: [841, 202]
===================================
Normal Label Distribution: 
Target 0: [1030, 195]
Target 1: [841, 202]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 2268, target_attr: gender, bias_attr: age bias_rate: 0.995
['[valid] target_0-bias_0: 1030', '[valid] target_0-bias_1: 195', '[valid] target_1-bias_0: 841', '[valid] target_1-bias_1: 202']
get_utk_face - split: test, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_age-0.995
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [1061, 176]
Target 1: [867, 165]
Binary Target 1
---------------------------
Target 0: [1061, 176]
Target 1: [867, 165]
===================================
Normal Label Distribution: 
Target 0: [1061, 176]
Target 1: [867, 165]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 2269, target_attr: gender, bias_attr: age bias_rate: 0.995
['[test] target_0-bias_0: 1061', '[test] target_0-bias_1: 176', '[test] target_1-bias_0: 867', '[test] target_1-bias_1: 165']
decay_epochs: [6, 13]
[1 / 20] Learning rate: 0.001 weight: 0.01
[1 / 20] Loss: 2.3504861193561966 CE Loss: 0.5309444049713284 Con Loss: 2.345176666199587
[1 / 20] tensor([[1., 1.],
        [0., 0.]]) {'epoch': 1, 'valid/acc': 54.012, 'valid/acc_unbiased': 50.0, 'valid/diff': 0.0, 'valid/acc_skew': 50.0, 'valid/acc_align': 50.0, 'test/acc': 54.517, 'test/acc_unbiased': 50.0, 'test/diff': 0.0, 'test/acc_skew': 50.0, 'test/acc_align': 50.0}
[1 / 20] best valid accuracy: 50.000 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 54.012, 'best_valid_valid/acc_unbiased': 50.0, 'best_valid_valid/diff': 0.0, 'best_valid_valid/acc_skew': 50.0, 'best_valid_valid/acc_align': 50.0, 'best_valid_test/acc': 54.517, 'best_valid_test/acc_unbiased': 50.0, 'best_valid_test/diff': 0.0, 'best_valid_test/acc_skew': 50.0, 'best_valid_test/acc_align': 50.0}
[1 / 20] best test accuracy: 50.000 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 54.012, 'best_test_valid/acc_unbiased': 50.0, 'best_test_valid/diff': 0.0, 'best_test_valid/acc_skew': 50.0, 'best_test_valid/acc_align': 50.0, 'best_test_test/acc': 54.517, 'best_test_test/acc_unbiased': 50.0, 'best_test_test/diff': 0.0, 'best_test_test/acc_skew': 50.0, 'best_test_test/acc_align': 50.0}
[2 / 20] Learning rate: 0.001 weight: 0.01
[2 / 20] Loss: 1.8568916257361705 CE Loss: 0.46139556681174426 Con Loss: 1.852277669963278
[2 / 20] tensor([[1., 1.],
        [0., 0.]]) {'epoch': 2, 'valid/acc': 54.012, 'valid/acc_unbiased': 50.0, 'valid/diff': 0.0, 'valid/acc_skew': 50.0, 'valid/acc_align': 50.0, 'test/acc': 54.517, 'test/acc_unbiased': 50.0, 'test/diff': 0.0, 'test/acc_skew': 50.0, 'test/acc_align': 50.0}
[2 / 20] best valid accuracy: 50.000 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 54.012, 'best_valid_valid/acc_unbiased': 50.0, 'best_valid_valid/diff': 0.0, 'best_valid_valid/acc_skew': 50.0, 'best_valid_valid/acc_align': 50.0, 'best_valid_test/acc': 54.517, 'best_valid_test/acc_unbiased': 50.0, 'best_valid_test/diff': 0.0, 'best_valid_test/acc_skew': 50.0, 'best_valid_test/acc_align': 50.0}
[2 / 20] best test accuracy: 50.000 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 54.012, 'best_test_valid/acc_unbiased': 50.0, 'best_test_valid/diff': 0.0, 'best_test_valid/acc_skew': 50.0, 'best_test_valid/acc_align': 50.0, 'best_test_test/acc': 54.517, 'best_test_test/acc_unbiased': 50.0, 'best_test_test/diff': 0.0, 'best_test_test/acc_skew': 50.0, 'best_test_test/acc_align': 50.0}
[3 / 20] Learning rate: 0.001 weight: 0.01
[3 / 20] Loss: 1.8879258855276728 CE Loss: 0.45432804972757646 Con Loss: 1.8833826055684995
[3 / 20] tensor([[1., 1.],
        [0., 0.]]) {'epoch': 3, 'valid/acc': 54.012, 'valid/acc_unbiased': 50.0, 'valid/diff': 0.0, 'valid/acc_skew': 50.0, 'valid/acc_align': 50.0, 'test/acc': 54.517, 'test/acc_unbiased': 50.0, 'test/diff': 0.0, 'test/acc_skew': 50.0, 'test/acc_align': 50.0}
[3 / 20] best valid accuracy: 50.000 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 54.012, 'best_valid_valid/acc_unbiased': 50.0, 'best_valid_valid/diff': 0.0, 'best_valid_valid/acc_skew': 50.0, 'best_valid_valid/acc_align': 50.0, 'best_valid_test/acc': 54.517, 'best_valid_test/acc_unbiased': 50.0, 'best_valid_test/diff': 0.0, 'best_valid_test/acc_skew': 50.0, 'best_valid_test/acc_align': 50.0}
[3 / 20] best test accuracy: 50.000 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 54.012, 'best_test_valid/acc_unbiased': 50.0, 'best_test_valid/diff': 0.0, 'best_test_valid/acc_skew': 50.0, 'best_test_valid/acc_align': 50.0, 'best_test_test/acc': 54.517, 'best_test_test/acc_unbiased': 50.0, 'best_test_test/diff': 0.0, 'best_test_test/acc_skew': 50.0, 'best_test_test/acc_align': 50.0}
[4 / 20] Learning rate: 0.001 weight: 0.01
[4 / 20] Loss: 2.2571786277193047 CE Loss: 0.45735593160579646 Con Loss: 2.252605086612643
[4 / 20] tensor([[1., 1.],
        [0., 0.]]) {'epoch': 4, 'valid/acc': 54.012, 'valid/acc_unbiased': 50.0, 'valid/diff': 0.0, 'valid/acc_skew': 50.0, 'valid/acc_align': 50.0, 'test/acc': 54.517, 'test/acc_unbiased': 50.0, 'test/diff': 0.0, 'test/acc_skew': 50.0, 'test/acc_align': 50.0}
[4 / 20] best valid accuracy: 50.000 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 54.012, 'best_valid_valid/acc_unbiased': 50.0, 'best_valid_valid/diff': 0.0, 'best_valid_valid/acc_skew': 50.0, 'best_valid_valid/acc_align': 50.0, 'best_valid_test/acc': 54.517, 'best_valid_test/acc_unbiased': 50.0, 'best_valid_test/diff': 0.0, 'best_valid_test/acc_skew': 50.0, 'best_valid_test/acc_align': 50.0}
[4 / 20] best test accuracy: 50.000 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 54.012, 'best_test_valid/acc_unbiased': 50.0, 'best_test_valid/diff': 0.0, 'best_test_valid/acc_skew': 50.0, 'best_test_valid/acc_align': 50.0, 'best_test_test/acc': 54.517, 'best_test_test/acc_unbiased': 50.0, 'best_test_test/diff': 0.0, 'best_test_test/acc_skew': 50.0, 'best_test_test/acc_align': 50.0}
[5 / 20] Learning rate: 0.001 weight: 0.01
[5 / 20] Loss: 2.2651407178724137 CE Loss: 0.4575647624929624 Con Loss: 2.2605650778848405
[5 / 20] tensor([[1., 1.],
        [0., 0.]]) {'epoch': 5, 'valid/acc': 54.012, 'valid/acc_unbiased': 50.0, 'valid/diff': 0.0, 'valid/acc_skew': 50.0, 'valid/acc_align': 50.0, 'test/acc': 54.517, 'test/acc_unbiased': 50.0, 'test/diff': 0.0, 'test/acc_skew': 50.0, 'test/acc_align': 50.0}
[5 / 20] best valid accuracy: 50.000 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 54.012, 'best_valid_valid/acc_unbiased': 50.0, 'best_valid_valid/diff': 0.0, 'best_valid_valid/acc_skew': 50.0, 'best_valid_valid/acc_align': 50.0, 'best_valid_test/acc': 54.517, 'best_valid_test/acc_unbiased': 50.0, 'best_valid_test/diff': 0.0, 'best_valid_test/acc_skew': 50.0, 'best_valid_test/acc_align': 50.0}
[5 / 20] best test accuracy: 50.000 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 54.012, 'best_test_valid/acc_unbiased': 50.0, 'best_test_valid/diff': 0.0, 'best_test_valid/acc_skew': 50.0, 'best_test_valid/acc_align': 50.0, 'best_test_test/acc': 54.517, 'best_test_test/acc_unbiased': 50.0, 'best_test_test/diff': 0.0, 'best_test_test/acc_skew': 50.0, 'best_test_test/acc_align': 50.0}
[6 / 20] Learning rate: 0.001 weight: 0.01
[6 / 20] Loss: 2.031333160159823 CE Loss: 0.4351919715923746 Con Loss: 2.0269812386779846
[6 / 20] tensor([[0.977, 0.932],
        [0.060, 0.048]]) {'epoch': 6, 'valid/acc': 55.467, 'valid/acc_unbiased': 50.66, 'valid/diff': 3.495, 'valid/acc_skew': 50.509, 'valid/acc_align': 50.81, 'test/acc': 55.575, 'test/acc_unbiased': 50.441, 'test/diff': 2.853, 'test/acc_skew': 49.59, 'test/acc_align': 51.293}
[6 / 20] best valid accuracy: 50.660 at epoch 6 
 best_stats: {'best_valid_epoch': 6, 'best_valid_valid/acc': 55.467, 'best_valid_valid/acc_unbiased': 50.66, 'best_valid_valid/diff': 3.495, 'best_valid_valid/acc_skew': 50.509, 'best_valid_valid/acc_align': 50.81, 'best_valid_test/acc': 55.575, 'best_valid_test/acc_unbiased': 50.441, 'best_valid_test/diff': 2.853, 'best_valid_test/acc_skew': 49.59, 'best_valid_test/acc_align': 51.293}
[6 / 20] best test accuracy: 50.441 at epoch 6 
 best_stats: {'best_test_epoch': 6, 'best_test_valid/acc': 55.467, 'best_test_valid/acc_unbiased': 50.66, 'best_test_valid/diff': 3.495, 'best_test_valid/acc_skew': 50.509, 'best_test_valid/acc_align': 50.81, 'best_test_test/acc': 55.575, 'best_test_test/acc_unbiased': 50.441, 'best_test_test/diff': 2.853, 'best_test_test/acc_skew': 49.59, 'best_test_test/acc_align': 51.293}
[7 / 20] Learning rate: 0.0001 weight: 0.01
[7 / 20] Loss: 1.6525281537289844 CE Loss: 0.43741114146029014 Con Loss: 1.648154047077197
[7 / 20] tensor([[0.988, 0.926],
        [0.066, 0.061]]) {'epoch': 7, 'valid/acc': 56.217, 'valid/acc_unbiased': 51.675, 'valid/diff': 2.555, 'valid/acc_skew': 50.568, 'valid/acc_align': 52.781, 'test/acc': 56.324, 'test/acc_unbiased': 51.006, 'test/diff': 3.337, 'test/acc_skew': 49.594, 'test/acc_align': 52.418}
[7 / 20] best valid accuracy: 51.675 at epoch 7 
 best_stats: {'best_valid_epoch': 7, 'best_valid_valid/acc': 56.217, 'best_valid_valid/acc_unbiased': 51.675, 'best_valid_valid/diff': 2.555, 'best_valid_valid/acc_skew': 50.568, 'best_valid_valid/acc_align': 52.781, 'best_valid_test/acc': 56.324, 'best_valid_test/acc_unbiased': 51.006, 'best_valid_test/diff': 3.337, 'best_valid_test/acc_skew': 49.594, 'best_valid_test/acc_align': 52.418}
[7 / 20] best test accuracy: 51.006 at epoch 7 
 best_stats: {'best_test_epoch': 7, 'best_test_valid/acc': 56.217, 'best_test_valid/acc_unbiased': 51.675, 'best_test_valid/diff': 2.555, 'best_test_valid/acc_skew': 50.568, 'best_test_valid/acc_align': 52.781, 'best_test_test/acc': 56.324, 'best_test_test/acc_unbiased': 51.006, 'best_test_test/diff': 3.337, 'best_test_test/acc_skew': 49.594, 'best_test_test/acc_align': 52.418}
[8 / 20] Learning rate: 0.0001 weight: 0.01
[8 / 20] Loss: 1.8638476165829319 CE Loss: 0.41770494453757057 Con Loss: 1.859670562740233
[8 / 20] tensor([[0.974, 0.835],
        [0.202, 0.182]]) {'epoch': 8, 'valid/acc': 59.215, 'valid/acc_unbiased': 53.031, 'valid/diff': 9.195, 'valid/acc_skew': 49.55, 'valid/acc_align': 56.513, 'test/acc': 61.04, 'test/acc_unbiased': 54.813, 'test/diff': 7.92, 'test/acc_skew': 51.854, 'test/acc_align': 57.771}
[8 / 20] best valid accuracy: 53.031 at epoch 8 
 best_stats: {'best_valid_epoch': 8, 'best_valid_valid/acc': 59.215, 'best_valid_valid/acc_unbiased': 53.031, 'best_valid_valid/diff': 9.195, 'best_valid_valid/acc_skew': 49.55, 'best_valid_valid/acc_align': 56.513, 'best_valid_test/acc': 61.04, 'best_valid_test/acc_unbiased': 54.813, 'best_valid_test/diff': 7.92, 'best_valid_test/acc_skew': 51.854, 'best_valid_test/acc_align': 57.771}
[8 / 20] best test accuracy: 54.813 at epoch 8 
 best_stats: {'best_test_epoch': 8, 'best_test_valid/acc': 59.215, 'best_test_valid/acc_unbiased': 53.031, 'best_test_valid/diff': 9.195, 'best_test_valid/acc_skew': 49.55, 'best_test_valid/acc_align': 56.513, 'best_test_test/acc': 61.04, 'best_test_test/acc_unbiased': 54.813, 'best_test_test/diff': 7.92, 'best_test_test/acc_skew': 51.854, 'best_test_test/acc_align': 57.771}
[9 / 20] Learning rate: 0.0001 weight: 0.01
[9 / 20] Loss: 1.784907300790737 CE Loss: 0.41375350449031995 Con Loss: 1.7807697661952195
[9 / 20] tensor([[0.976, 0.824],
        [0.191, 0.261]]) {'epoch': 9, 'valid/acc': 61.023, 'valid/acc_unbiased': 55.28, 'valid/diff': 12.241, 'valid/acc_skew': 49.159, 'valid/acc_align': 61.401, 'test/acc': 61.26, 'test/acc_unbiased': 56.309, 'test/diff': 11.086, 'test/acc_skew': 50.766, 'test/acc_align': 61.852}
[9 / 20] best valid accuracy: 55.280 at epoch 9 
 best_stats: {'best_valid_epoch': 9, 'best_valid_valid/acc': 61.023, 'best_valid_valid/acc_unbiased': 55.28, 'best_valid_valid/diff': 12.241, 'best_valid_valid/acc_skew': 49.159, 'best_valid_valid/acc_align': 61.401, 'best_valid_test/acc': 61.26, 'best_valid_test/acc_unbiased': 56.309, 'best_valid_test/diff': 11.086, 'best_valid_test/acc_skew': 50.766, 'best_valid_test/acc_align': 61.852}
[9 / 20] best test accuracy: 56.309 at epoch 9 
 best_stats: {'best_test_epoch': 9, 'best_test_valid/acc': 61.023, 'best_test_valid/acc_unbiased': 55.28, 'best_test_valid/diff': 12.241, 'best_test_valid/acc_skew': 49.159, 'best_test_valid/acc_align': 61.401, 'best_test_test/acc': 61.26, 'best_test_test/acc_unbiased': 56.309, 'best_test_test/diff': 11.086, 'best_test_test/acc_skew': 50.766, 'best_test_test/acc_align': 61.852}
[10 / 20] Learning rate: 0.0001 weight: 0.01
[10 / 20] Loss: 1.5888709582570049 CE Loss: 0.4144685543650756 Con Loss: 1.5847262722062079
[10 / 20] tensor([[0.974, 0.784],
        [0.247, 0.261]]) {'epoch': 10, 'valid/acc': 61.949, 'valid/acc_unbiased': 55.484, 'valid/diff': 10.969, 'valid/acc_skew': 49.999, 'valid/acc_align': 60.968, 'test/acc': 62.935, 'test/acc_unbiased': 56.628, 'test/diff': 10.165, 'test/acc_skew': 51.546, 'test/acc_align': 61.711}
[10 / 20] best valid accuracy: 55.484 at epoch 10 
 best_stats: {'best_valid_epoch': 10, 'best_valid_valid/acc': 61.949, 'best_valid_valid/acc_unbiased': 55.484, 'best_valid_valid/diff': 10.969, 'best_valid_valid/acc_skew': 49.999, 'best_valid_valid/acc_align': 60.968, 'best_valid_test/acc': 62.935, 'best_valid_test/acc_unbiased': 56.628, 'best_valid_test/diff': 10.165, 'best_valid_test/acc_skew': 51.546, 'best_valid_test/acc_align': 61.711}
[10 / 20] best test accuracy: 56.628 at epoch 10 
 best_stats: {'best_test_epoch': 10, 'best_test_valid/acc': 61.949, 'best_test_valid/acc_unbiased': 55.484, 'best_test_valid/diff': 10.969, 'best_test_valid/acc_skew': 49.999, 'best_test_valid/acc_align': 60.968, 'best_test_test/acc': 62.935, 'best_test_test/acc_unbiased': 56.628, 'best_test_test/diff': 10.165, 'best_test_test/acc_skew': 51.546, 'best_test_test/acc_align': 61.711}
[11 / 20] Learning rate: 0.0001 weight: 0.01
[11 / 20] Loss: 1.7209687649843464 CE Loss: 0.38629279366723585 Con Loss: 1.7171058420933702
[11 / 20] tensor([[0.966, 0.835],
        [0.187, 0.242]]) {'epoch': 11, 'valid/acc': 59.7, 'valid/acc_unbiased': 53.392, 'valid/diff': 9.935, 'valid/acc_skew': 50.363, 'valid/acc_align': 56.421, 'test/acc': 60.555, 'test/acc_unbiased': 55.764, 'test/diff': 9.321, 'test/acc_skew': 51.104, 'test/acc_align': 60.425}
[11 / 20] best valid accuracy: 55.484 at epoch 10 
 best_stats: {'best_valid_epoch': 10, 'best_valid_valid/acc': 61.949, 'best_valid_valid/acc_unbiased': 55.484, 'best_valid_valid/diff': 10.969, 'best_valid_valid/acc_skew': 49.999, 'best_valid_valid/acc_align': 60.968, 'best_valid_test/acc': 62.935, 'best_valid_test/acc_unbiased': 56.628, 'best_valid_test/diff': 10.165, 'best_valid_test/acc_skew': 51.546, 'best_valid_test/acc_align': 61.711}
[11 / 20] best test accuracy: 56.628 at epoch 10 
 best_stats: {'best_test_epoch': 10, 'best_test_valid/acc': 61.949, 'best_test_valid/acc_unbiased': 55.484, 'best_test_valid/diff': 10.969, 'best_test_valid/acc_skew': 49.999, 'best_test_valid/acc_align': 60.968, 'best_test_test/acc': 62.935, 'best_test_test/acc_unbiased': 56.628, 'best_test_test/diff': 10.165, 'best_test_test/acc_skew': 51.546, 'best_test_test/acc_align': 61.711}
[12 / 20] Learning rate: 0.0001 weight: 0.01
[12 / 20] Loss: 1.8389439359707982 CE Loss: 0.4236181053536956 Con Loss: 1.834707754455954
[12 / 20] tensor([[0.954, 0.699],
        [0.366, 0.382]]) {'epoch': 12, 'valid/acc': 66.711, 'valid/acc_unbiased': 60.282, 'valid/diff': 16.642, 'valid/acc_skew': 51.961, 'valid/acc_align': 68.603, 'test/acc': 66.77, 'test/acc_unbiased': 60.003, 'test/diff': 13.557, 'test/acc_skew': 53.225, 'test/acc_align': 66.782}
[12 / 20] best valid accuracy: 60.282 at epoch 12 
 best_stats: {'best_valid_epoch': 12, 'best_valid_valid/acc': 66.711, 'best_valid_valid/acc_unbiased': 60.282, 'best_valid_valid/diff': 16.642, 'best_valid_valid/acc_skew': 51.961, 'best_valid_valid/acc_align': 68.603, 'best_valid_test/acc': 66.77, 'best_valid_test/acc_unbiased': 60.003, 'best_valid_test/diff': 13.557, 'best_valid_test/acc_skew': 53.225, 'best_valid_test/acc_align': 66.782}
[12 / 20] best test accuracy: 60.003 at epoch 12 
 best_stats: {'best_test_epoch': 12, 'best_test_valid/acc': 66.711, 'best_test_valid/acc_unbiased': 60.282, 'best_test_valid/diff': 16.642, 'best_test_valid/acc_skew': 51.961, 'best_test_valid/acc_align': 68.603, 'best_test_test/acc': 66.77, 'best_test_test/acc_unbiased': 60.003, 'best_test_test/diff': 13.557, 'best_test_test/acc_skew': 53.225, 'best_test_test/acc_align': 66.782}
[13 / 20] Learning rate: 0.0001 weight: 0.01
[13 / 20] Loss: 1.7064371543221482 CE Loss: 0.3761376715956885 Con Loss: 1.702675774946879
[13 / 20] tensor([[0.941, 0.568],
        [0.438, 0.539]]) {'epoch': 13, 'valid/acc': 67.46, 'valid/acc_unbiased': 60.07, 'valid/diff': 26.297, 'valid/acc_skew': 46.922, 'valid/acc_align': 73.218, 'test/acc': 69.061, 'test/acc_unbiased': 62.162, 'test/diff': 23.677, 'test/acc_skew': 50.324, 'test/acc_align': 74.001}
[13 / 20] best valid accuracy: 60.282 at epoch 12 
 best_stats: {'best_valid_epoch': 12, 'best_valid_valid/acc': 66.711, 'best_valid_valid/acc_unbiased': 60.282, 'best_valid_valid/diff': 16.642, 'best_valid_valid/acc_skew': 51.961, 'best_valid_valid/acc_align': 68.603, 'best_valid_test/acc': 66.77, 'best_valid_test/acc_unbiased': 60.003, 'best_valid_test/diff': 13.557, 'best_valid_test/acc_skew': 53.225, 'best_valid_test/acc_align': 66.782}
[13 / 20] best test accuracy: 62.162 at epoch 13 
 best_stats: {'best_test_epoch': 13, 'best_test_valid/acc': 67.46, 'best_test_valid/acc_unbiased': 60.07, 'best_test_valid/diff': 26.297, 'best_test_valid/acc_skew': 46.922, 'best_test_valid/acc_align': 73.218, 'best_test_test/acc': 69.061, 'best_test_test/acc_unbiased': 62.162, 'best_test_test/diff': 23.677, 'best_test_test/acc_skew': 50.324, 'best_test_test/acc_align': 74.001}
[14 / 20] Learning rate: 1e-05 weight: 0.01
[14 / 20] Loss: 1.7211394376489526 CE Loss: 0.3950785610109684 Con Loss: 1.7171886505540388
[14 / 20] tensor([[0.951, 0.614],
        [0.381, 0.473]]) {'epoch': 14, 'valid/acc': 66.138, 'valid/acc_unbiased': 59.765, 'valid/diff': 23.227, 'valid/acc_skew': 48.152, 'valid/acc_align': 71.379, 'test/acc': 67.21, 'test/acc_unbiased': 60.449, 'test/diff': 21.473, 'test/acc_skew': 49.713, 'test/acc_align': 71.186}
[14 / 20] best valid accuracy: 60.282 at epoch 12 
 best_stats: {'best_valid_epoch': 12, 'best_valid_valid/acc': 66.711, 'best_valid_valid/acc_unbiased': 60.282, 'best_valid_valid/diff': 16.642, 'best_valid_valid/acc_skew': 51.961, 'best_valid_valid/acc_align': 68.603, 'best_valid_test/acc': 66.77, 'best_valid_test/acc_unbiased': 60.003, 'best_valid_test/diff': 13.557, 'best_valid_test/acc_skew': 53.225, 'best_valid_test/acc_align': 66.782}
[14 / 20] best test accuracy: 62.162 at epoch 13 
 best_stats: {'best_test_epoch': 13, 'best_test_valid/acc': 67.46, 'best_test_valid/acc_unbiased': 60.07, 'best_test_valid/diff': 26.297, 'best_test_valid/acc_skew': 46.922, 'best_test_valid/acc_align': 73.218, 'best_test_test/acc': 69.061, 'best_test_test/acc_unbiased': 62.162, 'best_test_test/diff': 23.677, 'best_test_test/acc_skew': 50.324, 'best_test_test/acc_align': 74.001}
[15 / 20] Learning rate: 1e-05 weight: 0.01
[15 / 20] Loss: 1.7292579620362207 CE Loss: 0.3761456030615772 Con Loss: 1.7254965066470174
[15 / 20] tensor([[0.956, 0.614],
        [0.394, 0.461]]) {'epoch': 15, 'valid/acc': 66.049, 'valid/acc_unbiased': 59.237, 'valid/diff': 22.207, 'valid/acc_skew': 48.133, 'valid/acc_align': 70.34, 'test/acc': 67.871, 'test/acc_unbiased': 60.61, 'test/diff': 20.41, 'test/acc_skew': 50.405, 'test/acc_align': 70.815}
[15 / 20] best valid accuracy: 60.282 at epoch 12 
 best_stats: {'best_valid_epoch': 12, 'best_valid_valid/acc': 66.711, 'best_valid_valid/acc_unbiased': 60.282, 'best_valid_valid/diff': 16.642, 'best_valid_valid/acc_skew': 51.961, 'best_valid_valid/acc_align': 68.603, 'best_valid_test/acc': 66.77, 'best_valid_test/acc_unbiased': 60.003, 'best_valid_test/diff': 13.557, 'best_valid_test/acc_skew': 53.225, 'best_valid_test/acc_align': 66.782}
[15 / 20] best test accuracy: 62.162 at epoch 13 
 best_stats: {'best_test_epoch': 13, 'best_test_valid/acc': 67.46, 'best_test_valid/acc_unbiased': 60.07, 'best_test_valid/diff': 26.297, 'best_test_valid/acc_skew': 46.922, 'best_test_valid/acc_align': 73.218, 'best_test_test/acc': 69.061, 'best_test_test/acc_unbiased': 62.162, 'best_test_test/diff': 23.677, 'best_test_test/acc_skew': 50.324, 'best_test_test/acc_align': 74.001}
[16 / 20] Learning rate: 1e-05 weight: 0.01
[16 / 20] Loss: 1.7247036427316305 CE Loss: 0.38241814747010067 Con Loss: 1.720879459596027
[16 / 20] tensor([[0.958, 0.608],
        [0.393, 0.442]]) {'epoch': 16, 'valid/acc': 65.829, 'valid/acc_unbiased': 58.184, 'valid/diff': 21.721, 'valid/acc_skew': 47.323, 'valid/acc_align': 69.045, 'test/acc': 67.739, 'test/acc_unbiased': 60.032, 'test/diff': 19.937, 'test/acc_skew': 50.063, 'test/acc_align': 70.001}
[16 / 20] best valid accuracy: 60.282 at epoch 12 
 best_stats: {'best_valid_epoch': 12, 'best_valid_valid/acc': 66.711, 'best_valid_valid/acc_unbiased': 60.282, 'best_valid_valid/diff': 16.642, 'best_valid_valid/acc_skew': 51.961, 'best_valid_valid/acc_align': 68.603, 'best_valid_test/acc': 66.77, 'best_valid_test/acc_unbiased': 60.003, 'best_valid_test/diff': 13.557, 'best_valid_test/acc_skew': 53.225, 'best_valid_test/acc_align': 66.782}
[16 / 20] best test accuracy: 62.162 at epoch 13 
 best_stats: {'best_test_epoch': 13, 'best_test_valid/acc': 67.46, 'best_test_valid/acc_unbiased': 60.07, 'best_test_valid/diff': 26.297, 'best_test_valid/acc_skew': 46.922, 'best_test_valid/acc_align': 73.218, 'best_test_test/acc': 69.061, 'best_test_test/acc_unbiased': 62.162, 'best_test_test/diff': 23.677, 'best_test_test/acc_skew': 50.324, 'best_test_test/acc_align': 74.001}
[17 / 20] Learning rate: 1e-05 weight: 0.01
[17 / 20] Loss: 1.7366785437839487 CE Loss: 0.3857859803061826 Con Loss: 1.7328206814353864
[17 / 20] tensor([[0.962, 0.608],
        [0.388, 0.473]]) {'epoch': 17, 'valid/acc': 67.196, 'valid/acc_unbiased': 60.518, 'valid/diff': 23.187, 'valid/acc_skew': 48.925, 'valid/acc_align': 72.112, 'test/acc': 67.959, 'test/acc_unbiased': 60.763, 'test/diff': 21.976, 'test/acc_skew': 49.775, 'test/acc_align': 71.751}
[17 / 20] best valid accuracy: 60.518 at epoch 17 
 best_stats: {'best_valid_epoch': 17, 'best_valid_valid/acc': 67.196, 'best_valid_valid/acc_unbiased': 60.518, 'best_valid_valid/diff': 23.187, 'best_valid_valid/acc_skew': 48.925, 'best_valid_valid/acc_align': 72.112, 'best_valid_test/acc': 67.959, 'best_valid_test/acc_unbiased': 60.763, 'best_valid_test/diff': 21.976, 'best_valid_test/acc_skew': 49.775, 'best_valid_test/acc_align': 71.751}
[17 / 20] best test accuracy: 62.162 at epoch 13 
 best_stats: {'best_test_epoch': 13, 'best_test_valid/acc': 67.46, 'best_test_valid/acc_unbiased': 60.07, 'best_test_valid/diff': 26.297, 'best_test_valid/acc_skew': 46.922, 'best_test_valid/acc_align': 73.218, 'best_test_test/acc': 69.061, 'best_test_test/acc_unbiased': 62.162, 'best_test_test/diff': 23.677, 'best_test_test/acc_skew': 50.324, 'best_test_test/acc_align': 74.001}
[18 / 20] Learning rate: 1e-05 weight: 0.01
[18 / 20] Loss: 1.8496366443844805 CE Loss: 0.3829903194733854 Con Loss: 1.8458067305970696
[18 / 20] tensor([[0.963, 0.642],
        [0.361, 0.406]]) {'epoch': 18, 'valid/acc': 65.476, 'valid/acc_unbiased': 58.524, 'valid/diff': 20.439, 'valid/acc_skew': 48.304, 'valid/acc_align': 68.744, 'test/acc': 66.77, 'test/acc_unbiased': 59.309, 'test/diff': 18.312, 'test/acc_skew': 50.153, 'test/acc_align': 68.465}
[18 / 20] best valid accuracy: 60.518 at epoch 17 
 best_stats: {'best_valid_epoch': 17, 'best_valid_valid/acc': 67.196, 'best_valid_valid/acc_unbiased': 60.518, 'best_valid_valid/diff': 23.187, 'best_valid_valid/acc_skew': 48.925, 'best_valid_valid/acc_align': 72.112, 'best_valid_test/acc': 67.959, 'best_valid_test/acc_unbiased': 60.763, 'best_valid_test/diff': 21.976, 'best_valid_test/acc_skew': 49.775, 'best_valid_test/acc_align': 71.751}
[18 / 20] best test accuracy: 62.162 at epoch 13 
 best_stats: {'best_test_epoch': 13, 'best_test_valid/acc': 67.46, 'best_test_valid/acc_unbiased': 60.07, 'best_test_valid/diff': 26.297, 'best_test_valid/acc_skew': 46.922, 'best_test_valid/acc_align': 73.218, 'best_test_test/acc': 69.061, 'best_test_test/acc_unbiased': 62.162, 'best_test_test/diff': 23.677, 'best_test_test/acc_skew': 50.324, 'best_test_test/acc_align': 74.001}
[19 / 20] Learning rate: 1e-05 weight: 0.01
[19 / 20] Loss: 1.777432847883315 CE Loss: 0.3817144622203879 Con Loss: 1.7736157167399913
[19 / 20] tensor([[0.958, 0.619],
        [0.411, 0.473]]) {'epoch': 19, 'valid/acc': 67.196, 'valid/acc_unbiased': 60.251, 'valid/diff': 23.634, 'valid/acc_skew': 48.434, 'valid/acc_align': 72.068, 'test/acc': 68.709, 'test/acc_unbiased': 61.506, 'test/diff': 20.019, 'test/acc_skew': 51.496, 'test/acc_align': 71.516}
[19 / 20] best valid accuracy: 60.518 at epoch 17 
 best_stats: {'best_valid_epoch': 17, 'best_valid_valid/acc': 67.196, 'best_valid_valid/acc_unbiased': 60.518, 'best_valid_valid/diff': 23.187, 'best_valid_valid/acc_skew': 48.925, 'best_valid_valid/acc_align': 72.112, 'best_valid_test/acc': 67.959, 'best_valid_test/acc_unbiased': 60.763, 'best_valid_test/diff': 21.976, 'best_valid_test/acc_skew': 49.775, 'best_valid_test/acc_align': 71.751}
[19 / 20] best test accuracy: 62.162 at epoch 13 
 best_stats: {'best_test_epoch': 13, 'best_test_valid/acc': 67.46, 'best_test_valid/acc_unbiased': 60.07, 'best_test_valid/diff': 26.297, 'best_test_valid/acc_skew': 46.922, 'best_test_valid/acc_align': 73.218, 'best_test_test/acc': 69.061, 'best_test_test/acc_unbiased': 62.162, 'best_test_test/diff': 23.677, 'best_test_test/acc_skew': 50.324, 'best_test_test/acc_align': 74.001}
[20 / 20] Learning rate: 1e-05 weight: 0.01
[20 / 20] Loss: 1.920918886902952 CE Loss: 0.3775090037787261 Con Loss: 1.9171437946799055
[20 / 20] tensor([[0.962, 0.608],
        [0.405, 0.485]]) {'epoch': 20, 'valid/acc': 68.122, 'valid/acc_unbiased': 62.136, 'valid/diff': 21.049, 'valid/acc_skew': 51.611, 'valid/acc_align': 72.66, 'test/acc': 68.709, 'test/acc_unbiased': 61.499, 'test/diff': 21.717, 'test/acc_skew': 50.64, 'test/acc_align': 72.357}
[20 / 20] best valid accuracy: 62.136 at epoch 20 
 best_stats: {'best_valid_epoch': 20, 'best_valid_valid/acc': 68.122, 'best_valid_valid/acc_unbiased': 62.136, 'best_valid_valid/diff': 21.049, 'best_valid_valid/acc_skew': 51.611, 'best_valid_valid/acc_align': 72.66, 'best_valid_test/acc': 68.709, 'best_valid_test/acc_unbiased': 61.499, 'best_valid_test/diff': 21.717, 'best_valid_test/acc_skew': 50.64, 'best_valid_test/acc_align': 72.357}
[20 / 20] best test accuracy: 62.162 at epoch 13 
 best_stats: {'best_test_epoch': 13, 'best_test_valid/acc': 67.46, 'best_test_valid/acc_unbiased': 60.07, 'best_test_valid/diff': 26.297, 'best_test_valid/acc_skew': 46.922, 'best_test_valid/acc_align': 73.218, 'best_test_test/acc': 69.061, 'best_test_test/acc_unbiased': 62.162, 'best_test_test/diff': 23.677, 'best_test_test/acc_skew': 50.324, 'best_test_test/acc_align': 74.001}
Total training time: 0:40:05
