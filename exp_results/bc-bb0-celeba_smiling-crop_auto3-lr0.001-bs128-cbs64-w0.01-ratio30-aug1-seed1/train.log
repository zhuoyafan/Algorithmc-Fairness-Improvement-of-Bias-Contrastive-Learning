Log level set to: INFO
Set seed: 1
=======> Using Fixed Random Seed: 1 <========
save_path: exp_results/bc-bb0-celeba_smiling-crop_auto3-lr0.001-bs128-cbs64-w0.01-ratio30-aug1-seed1
get_celeba - split:train, aug: False, given_y: True, ratio: 0
use existing smiling indices from data/celeba/pickles/smiling
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [8007, 32831]
Target 1: [40613, 8007]
Binary Target 1
---------------------------
Target 0: [8007, 32831]
Target 1: [40613, 8007]
===================================
Normal Label Distribution: 
Target 0: [8007, 32831]
Target 1: [40613, 8007]
===================================
Use BiasedCelebASplit 
 target_attr: smiling split: train 
 tensor([[ 8007., 40613.],
        [32831.,  8007.]])
get_celeba - split:train, aug: 1, given_y: True, ratio: 30
use existing smiling indices from data/celeba/pickles/smiling
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [8056, 32674]
Target 1: [40701, 8027]
Binary Target 1
---------------------------
Target 0: [8056, 32674]
Target 1: [40701, 8027]
===================================
Normal Label Distribution: 
Target 0: [8056, 32674]
Target 1: [40701, 8027]
===================================
Use BiasedCelebASplit 
 target_attr: smiling split: train 
 tensor([[ 8056., 40701.],
        [32674.,  8027.]])
get_celeba - split:train_valid, aug: False, given_y: True, ratio: 0
use existing smiling indices from data/celeba/pickles/smiling
Use BiasedCelebASplit 
 target_attr: smiling split: train_valid 
 tensor([[ 2019., 10233.],
        [ 8156.,  1957.]])
get_celeba - split:valid, aug: False, given_y: True, ratio: 0
Use BiasedCelebASplit 
 target_attr: smiling split: valid 
 tensor([[5252., 6157.],
        [5013., 3445.]])
decay_epochs: [3, 6]
[1 / 10] Learning rate: 0.001 weight: 0.01
[1 / 10] Loss: 4.70398676235241 CE Loss: 0.2742816409192608 Con Loss: 4.701243937525909
[1 / 10] tensor([[0.849, 0.825],
        [0.955, 0.941]]) {'epoch': 1, 'valid/acc': 89.586, 'valid/acc_unbiased': 89.315, 'valid/diff': 1.538, 'valid/acc_skew': 89.76, 'valid/acc_align': 88.869, 'test/acc': 89.158, 'test/acc_unbiased': 89.236, 'test/diff': 1.879, 'test/acc_skew': 89.495, 'test/acc_align': 88.977}
[1 / 10] best valid accuracy: 89.315 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 89.586, 'best_valid_valid/acc_unbiased': 89.315, 'best_valid_valid/diff': 1.538, 'best_valid_valid/acc_skew': 89.76, 'best_valid_valid/acc_align': 88.869, 'best_valid_test/acc': 89.158, 'best_valid_test/acc_unbiased': 89.236, 'best_valid_test/diff': 1.879, 'best_valid_test/acc_skew': 89.495, 'best_valid_test/acc_align': 88.977}
[1 / 10] best test accuracy: 89.236 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 89.586, 'best_test_valid/acc_unbiased': 89.315, 'best_test_valid/diff': 1.538, 'best_test_valid/acc_skew': 89.76, 'best_test_valid/acc_align': 88.869, 'best_test_test/acc': 89.158, 'best_test_test/acc_unbiased': 89.236, 'best_test_test/diff': 1.879, 'best_test_test/acc_skew': 89.495, 'best_test_test/acc_align': 88.977}
[2 / 10] Learning rate: 0.001 weight: 0.01
[2 / 10] Loss: 4.652493929313423 CE Loss: 0.22741734989665557 Con Loss: 4.650219758081576
[2 / 10] tensor([[0.852, 0.883],
        [0.961, 0.931]]) {'epoch': 2, 'valid/acc': 91.54, 'valid/acc_unbiased': 90.227, 'valid/diff': 2.921, 'valid/acc_skew': 88.767, 'valid/acc_align': 91.688, 'test/acc': 90.723, 'test/acc_unbiased': 90.67, 'test/diff': 3.033, 'test/acc_skew': 89.154, 'test/acc_align': 92.186}
[2 / 10] best valid accuracy: 90.227 at epoch 2 
 best_stats: {'best_valid_epoch': 2, 'best_valid_valid/acc': 91.54, 'best_valid_valid/acc_unbiased': 90.227, 'best_valid_valid/diff': 2.921, 'best_valid_valid/acc_skew': 88.767, 'best_valid_valid/acc_align': 91.688, 'best_valid_test/acc': 90.723, 'best_valid_test/acc_unbiased': 90.67, 'best_valid_test/diff': 3.033, 'best_valid_test/acc_skew': 89.154, 'best_valid_test/acc_align': 92.186}
[2 / 10] best test accuracy: 90.670 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 91.54, 'best_test_valid/acc_unbiased': 90.227, 'best_test_valid/diff': 2.921, 'best_test_valid/acc_skew': 88.767, 'best_test_valid/acc_align': 91.688, 'best_test_test/acc': 90.723, 'best_test_test/acc_unbiased': 90.67, 'best_test_test/diff': 3.033, 'best_test_test/acc_skew': 89.154, 'best_test_test/acc_align': 92.186}
[3 / 10] Learning rate: 0.001 weight: 0.01
[3 / 10] Loss: 4.632777171344003 CE Loss: 0.21754135625742685 Con Loss: 4.630601763919836
[3 / 10] tensor([[0.937, 0.938],
        [0.914, 0.872]]) {'epoch': 3, 'valid/acc': 91.871, 'valid/acc_unbiased': 91.564, 'valid/diff': 1.9, 'valid/acc_skew': 90.922, 'valid/acc_align': 92.205, 'test/acc': 91.881, 'test/acc_unbiased': 91.519, 'test/diff': 2.17, 'test/acc_skew': 90.434, 'test/acc_align': 92.604}
[3 / 10] best valid accuracy: 91.564 at epoch 3 
 best_stats: {'best_valid_epoch': 3, 'best_valid_valid/acc': 91.871, 'best_valid_valid/acc_unbiased': 91.564, 'best_valid_valid/diff': 1.9, 'best_valid_valid/acc_skew': 90.922, 'best_valid_valid/acc_align': 92.205, 'best_valid_test/acc': 91.881, 'best_valid_test/acc_unbiased': 91.519, 'best_valid_test/diff': 2.17, 'best_valid_test/acc_skew': 90.434, 'best_valid_test/acc_align': 92.604}
[3 / 10] best test accuracy: 91.519 at epoch 3 
 best_stats: {'best_test_epoch': 3, 'best_test_valid/acc': 91.871, 'best_test_valid/acc_unbiased': 91.564, 'best_test_valid/diff': 1.9, 'best_test_valid/acc_skew': 90.922, 'best_test_valid/acc_align': 92.205, 'best_test_test/acc': 91.881, 'best_test_test/acc_unbiased': 91.519, 'best_test_test/diff': 2.17, 'best_test_test/acc_skew': 90.434, 'best_test_test/acc_align': 92.604}
[4 / 10] Learning rate: 0.0001 weight: 0.01
[4 / 10] Loss: 4.592216515163159 CE Loss: 0.1948122709920254 Con Loss: 4.590268395231636
[4 / 10] tensor([[0.908, 0.913],
        [0.945, 0.922]]) {'epoch': 4, 'valid/acc': 92.689, 'valid/acc_unbiased': 92.191, 'valid/diff': 1.264, 'valid/acc_skew': 91.628, 'valid/acc_align': 92.755, 'test/acc': 92.314, 'test/acc_unbiased': 92.197, 'test/diff': 1.39, 'test/acc_skew': 91.502, 'test/acc_align': 92.892}
[4 / 10] best valid accuracy: 92.191 at epoch 4 
 best_stats: {'best_valid_epoch': 4, 'best_valid_valid/acc': 92.689, 'best_valid_valid/acc_unbiased': 92.191, 'best_valid_valid/diff': 1.264, 'best_valid_valid/acc_skew': 91.628, 'best_valid_valid/acc_align': 92.755, 'best_valid_test/acc': 92.314, 'best_valid_test/acc_unbiased': 92.197, 'best_valid_test/diff': 1.39, 'best_valid_test/acc_skew': 91.502, 'best_valid_test/acc_align': 92.892}
[4 / 10] best test accuracy: 92.197 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 92.689, 'best_test_valid/acc_unbiased': 92.191, 'best_test_valid/diff': 1.264, 'best_test_valid/acc_skew': 91.628, 'best_test_valid/acc_align': 92.755, 'best_test_test/acc': 92.314, 'best_test_test/acc_unbiased': 92.197, 'best_test_test/diff': 1.39, 'best_test_test/acc_skew': 91.502, 'best_test_test/acc_align': 92.892}
[5 / 10] Learning rate: 0.0001 weight: 0.01
[5 / 10] Loss: 4.584313883175166 CE Loss: 0.18803326654106126 Con Loss: 4.582433558914374
[5 / 10] tensor([[0.931, 0.940],
        [0.929, 0.889]]) {'epoch': 5, 'valid/acc': 92.667, 'valid/acc_unbiased': 92.005, 'valid/diff': 2.249, 'valid/acc_skew': 90.881, 'valid/acc_align': 93.13, 'test/acc': 92.5, 'test/acc_unbiased': 92.188, 'test/diff': 2.453, 'test/acc_skew': 90.961, 'test/acc_align': 93.415}
[5 / 10] best valid accuracy: 92.191 at epoch 4 
 best_stats: {'best_valid_epoch': 4, 'best_valid_valid/acc': 92.689, 'best_valid_valid/acc_unbiased': 92.191, 'best_valid_valid/diff': 1.264, 'best_valid_valid/acc_skew': 91.628, 'best_valid_valid/acc_align': 92.755, 'best_valid_test/acc': 92.314, 'best_valid_test/acc_unbiased': 92.197, 'best_valid_test/diff': 1.39, 'best_valid_test/acc_skew': 91.502, 'best_valid_test/acc_align': 92.892}
[5 / 10] best test accuracy: 92.197 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 92.689, 'best_test_valid/acc_unbiased': 92.191, 'best_test_valid/diff': 1.264, 'best_test_valid/acc_skew': 91.628, 'best_test_valid/acc_align': 92.755, 'best_test_test/acc': 92.314, 'best_test_test/acc_unbiased': 92.197, 'best_test_test/diff': 1.39, 'best_test_test/acc_skew': 91.502, 'best_test_test/acc_align': 92.892}
[6 / 10] Learning rate: 0.0001 weight: 0.01
[6 / 10] Loss: 4.574891593615164 CE Loss: 0.18221438891679143 Con Loss: 4.573069450832815
[6 / 10] tensor([[0.905, 0.915],
        [0.948, 0.926]]) {'epoch': 6, 'valid/acc': 92.689, 'valid/acc_unbiased': 92.166, 'valid/diff': 1.103, 'valid/acc_skew': 91.614, 'valid/acc_align': 92.717, 'test/acc': 92.455, 'test/acc_unbiased': 92.357, 'test/diff': 1.579, 'test/acc_skew': 91.567, 'test/acc_align': 93.146}
[6 / 10] best valid accuracy: 92.191 at epoch 4 
 best_stats: {'best_valid_epoch': 4, 'best_valid_valid/acc': 92.689, 'best_valid_valid/acc_unbiased': 92.191, 'best_valid_valid/diff': 1.264, 'best_valid_valid/acc_skew': 91.628, 'best_valid_valid/acc_align': 92.755, 'best_valid_test/acc': 92.314, 'best_valid_test/acc_unbiased': 92.197, 'best_valid_test/diff': 1.39, 'best_valid_test/acc_skew': 91.502, 'best_valid_test/acc_align': 92.892}
[6 / 10] best test accuracy: 92.357 at epoch 6 
 best_stats: {'best_test_epoch': 6, 'best_test_valid/acc': 92.689, 'best_test_valid/acc_unbiased': 92.166, 'best_test_valid/diff': 1.103, 'best_test_valid/acc_skew': 91.614, 'best_test_valid/acc_align': 92.717, 'best_test_test/acc': 92.455, 'best_test_test/acc_unbiased': 92.357, 'best_test_test/diff': 1.579, 'best_test_test/acc_skew': 91.567, 'best_test_test/acc_align': 93.146}
[7 / 10] Learning rate: 1e-05 weight: 0.01
[7 / 10] Loss: 4.57377608864117 CE Loss: 0.18187650340701303 Con Loss: 4.5719573263186115
[7 / 10] tensor([[0.910, 0.919],
        [0.944, 0.921]]) {'epoch': 7, 'valid/acc': 92.788, 'valid/acc_unbiased': 92.248, 'valid/diff': 1.297, 'valid/acc_skew': 91.6, 'valid/acc_align': 92.897, 'test/acc': 92.455, 'test/acc_unbiased': 92.335, 'test/diff': 1.572, 'test/acc_skew': 91.549, 'test/acc_align': 93.121}
[7 / 10] best valid accuracy: 92.248 at epoch 7 
 best_stats: {'best_valid_epoch': 7, 'best_valid_valid/acc': 92.788, 'best_valid_valid/acc_unbiased': 92.248, 'best_valid_valid/diff': 1.297, 'best_valid_valid/acc_skew': 91.6, 'best_valid_valid/acc_align': 92.897, 'best_valid_test/acc': 92.455, 'best_valid_test/acc_unbiased': 92.335, 'best_valid_test/diff': 1.572, 'best_valid_test/acc_skew': 91.549, 'best_valid_test/acc_align': 93.121}
[7 / 10] best test accuracy: 92.357 at epoch 6 
 best_stats: {'best_test_epoch': 6, 'best_test_valid/acc': 92.689, 'best_test_valid/acc_unbiased': 92.166, 'best_test_valid/diff': 1.103, 'best_test_valid/acc_skew': 91.614, 'best_test_valid/acc_align': 92.717, 'best_test_test/acc': 92.455, 'best_test_test/acc_unbiased': 92.357, 'best_test_test/diff': 1.579, 'best_test_test/acc_skew': 91.567, 'best_test_test/acc_align': 93.146}
[8 / 10] Learning rate: 1e-05 weight: 0.01
[8 / 10] Loss: 4.5641629957449705 CE Loss: 0.18140859866825082 Con Loss: 4.562348911594813
[8 / 10] tensor([[0.926, 0.927],
        [0.937, 0.906]]) {'epoch': 8, 'valid/acc': 92.998, 'valid/acc_unbiased': 92.603, 'valid/diff': 1.362, 'valid/acc_skew': 92.035, 'valid/acc_align': 93.171, 'test/acc': 92.636, 'test/acc_unbiased': 92.414, 'test/diff': 1.658, 'test/acc_skew': 91.585, 'test/acc_align': 93.243}
[8 / 10] best valid accuracy: 92.603 at epoch 8 
 best_stats: {'best_valid_epoch': 8, 'best_valid_valid/acc': 92.998, 'best_valid_valid/acc_unbiased': 92.603, 'best_valid_valid/diff': 1.362, 'best_valid_valid/acc_skew': 92.035, 'best_valid_valid/acc_align': 93.171, 'best_valid_test/acc': 92.636, 'best_valid_test/acc_unbiased': 92.414, 'best_valid_test/diff': 1.658, 'best_valid_test/acc_skew': 91.585, 'best_valid_test/acc_align': 93.243}
[8 / 10] best test accuracy: 92.414 at epoch 8 
 best_stats: {'best_test_epoch': 8, 'best_test_valid/acc': 92.998, 'best_test_valid/acc_unbiased': 92.603, 'best_test_valid/diff': 1.362, 'best_test_valid/acc_skew': 92.035, 'best_test_valid/acc_align': 93.171, 'best_test_test/acc': 92.636, 'best_test_test/acc_unbiased': 92.414, 'best_test_test/diff': 1.658, 'best_test_test/acc_skew': 91.585, 'best_test_test/acc_align': 93.243}
[9 / 10] Learning rate: 1e-05 weight: 0.01
[9 / 10] Loss: 4.5657814146194236 CE Loss: 0.17988025112274855 Con Loss: 4.563982613788327
[9 / 10] tensor([[0.924, 0.926],
        [0.936, 0.909]]) {'epoch': 9, 'valid/acc': 92.971, 'valid/acc_unbiased': 92.561, 'valid/diff': 1.138, 'valid/acc_skew': 91.992, 'valid/acc_align': 93.13, 'test/acc': 92.576, 'test/acc_unbiased': 92.383, 'test/diff': 1.507, 'test/acc_skew': 91.63, 'test/acc_align': 93.136}
[9 / 10] best valid accuracy: 92.603 at epoch 8 
 best_stats: {'best_valid_epoch': 8, 'best_valid_valid/acc': 92.998, 'best_valid_valid/acc_unbiased': 92.603, 'best_valid_valid/diff': 1.362, 'best_valid_valid/acc_skew': 92.035, 'best_valid_valid/acc_align': 93.171, 'best_valid_test/acc': 92.636, 'best_valid_test/acc_unbiased': 92.414, 'best_valid_test/diff': 1.658, 'best_valid_test/acc_skew': 91.585, 'best_valid_test/acc_align': 93.243}
[9 / 10] best test accuracy: 92.414 at epoch 8 
 best_stats: {'best_test_epoch': 8, 'best_test_valid/acc': 92.998, 'best_test_valid/acc_unbiased': 92.603, 'best_test_valid/diff': 1.362, 'best_test_valid/acc_skew': 92.035, 'best_test_valid/acc_align': 93.171, 'best_test_test/acc': 92.636, 'best_test_test/acc_unbiased': 92.414, 'best_test_test/diff': 1.658, 'best_test_test/acc_skew': 91.585, 'best_test_test/acc_align': 93.243}
[10 / 10] Learning rate: 1e-05 weight: 0.01
[10 / 10] Loss: 4.5687588622396325 CE Loss: 0.1803899928989053 Con Loss: 4.566954963507714
[10 / 10] tensor([[0.929, 0.932],
        [0.933, 0.905]]) {'epoch': 10, 'valid/acc': 93.07, 'valid/acc_unbiased': 92.687, 'valid/diff': 1.661, 'valid/acc_skew': 92.102, 'valid/acc_align': 93.273, 'test/acc': 92.691, 'test/acc_unbiased': 92.486, 'test/diff': 1.537, 'test/acc_skew': 91.717, 'test/acc_align': 93.255}
[10 / 10] best valid accuracy: 92.687 at epoch 10 
 best_stats: {'best_valid_epoch': 10, 'best_valid_valid/acc': 93.07, 'best_valid_valid/acc_unbiased': 92.687, 'best_valid_valid/diff': 1.661, 'best_valid_valid/acc_skew': 92.102, 'best_valid_valid/acc_align': 93.273, 'best_valid_test/acc': 92.691, 'best_valid_test/acc_unbiased': 92.486, 'best_valid_test/diff': 1.537, 'best_valid_test/acc_skew': 91.717, 'best_valid_test/acc_align': 93.255}
[10 / 10] best test accuracy: 92.486 at epoch 10 
 best_stats: {'best_test_epoch': 10, 'best_test_valid/acc': 93.07, 'best_test_valid/acc_unbiased': 92.687, 'best_test_valid/diff': 1.661, 'best_test_valid/acc_skew': 92.102, 'best_test_valid/acc_align': 93.273, 'best_test_test/acc': 92.691, 'best_test_test/acc_unbiased': 92.486, 'best_test_test/diff': 1.537, 'best_test_test/acc_skew': 91.717, 'best_test_test/acc_align': 93.255}
Total training time: 1:38:46
