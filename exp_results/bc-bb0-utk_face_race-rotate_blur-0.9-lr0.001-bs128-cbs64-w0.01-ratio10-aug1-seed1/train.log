Log level set to: INFO
Set seed: 1
=======> Using Fixed Random Seed: 1 <========
save_path: exp_results/bc-bb0-utk_face_race-rotate_blur-0.9-lr0.001-bs128-cbs64-w0.01-ratio10-aug1-seed1
get_utk_face - split: train, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_race-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [4407, 552]
Target 1: [440, 5529]
Binary Target 1
---------------------------
Target 0: [4407, 552]
Target 1: [440, 5529]
===================================
Normal Label Distribution: 
Target 0: [4407, 552]
Target 1: [440, 5529]
===================================
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [4407, 552]
Target 1: [440, 5529]
Binary Target 1
---------------------------
Target 0: [4407, 552]
Target 1: [440, 5529]
===================================
Normal Label Distribution: 
Target 0: [4407, 552]
Target 1: [440, 5529]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 10928, target_attr: gender, bias_attr: race bias_rate: 0.9
['[train] target_0-bias_0: 4407', '[train] target_0-bias_1: 552', '[train] target_1-bias_0: 440', '[train] target_1-bias_1: 5529']
confusion_matrix - 
 original: tensor([[4407.,  440.],
        [ 552., 5529.]]), 
 normalized: tensor([[0.909, 0.091],
        [0.091, 0.909]]), 
 b|y: tensor([[0.889, 0.111],
        [0.074, 0.926]])
get_utk_face - split: train, aug: 1, given_y: True, ratio: 10
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_race-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [4407, 552]
Target 1: [440, 5529]
Binary Target 1
---------------------------
Target 0: [4407, 552]
Target 1: [440, 5529]
===================================
Normal Label Distribution: 
Target 0: [4407, 552]
Target 1: [440, 5529]
===================================
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [4407, 552]
Target 1: [440, 5529]
Binary Target 1
---------------------------
Target 0: [4407, 552]
Target 1: [440, 5529]
===================================
Normal Label Distribution: 
Target 0: [4407, 552]
Target 1: [440, 5529]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 10928, target_attr: gender, bias_attr: race bias_rate: 0.9
['[train] target_0-bias_0: 4407', '[train] target_0-bias_1: 552', '[train] target_1-bias_0: 440', '[train] target_1-bias_1: 5529']
get_utk_face - split: valid, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_race-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [583, 684]
Target 1: [457, 646]
Binary Target 1
---------------------------
Target 0: [583, 684]
Target 1: [457, 646]
===================================
Normal Label Distribution: 
Target 0: [583, 684]
Target 1: [457, 646]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 2370, target_attr: gender, bias_attr: race bias_rate: 0.9
['[valid] target_0-bias_0: 583', '[valid] target_0-bias_1: 684', '[valid] target_1-bias_0: 457', '[valid] target_1-bias_1: 646']
get_utk_face - split: test, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_race-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [558, 677]
Target 1: [462, 673]
Binary Target 1
---------------------------
Target 0: [558, 677]
Target 1: [462, 673]
===================================
Normal Label Distribution: 
Target 0: [558, 677]
Target 1: [462, 673]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 2370, target_attr: gender, bias_attr: race bias_rate: 0.9
['[test] target_0-bias_0: 558', '[test] target_0-bias_1: 677', '[test] target_1-bias_0: 462', '[test] target_1-bias_1: 673']
decay_epochs: [6, 13]
[1 / 20] Learning rate: 0.001 weight: 0.01
[1 / 20] Loss: 4.919600457433027 CE Loss: 0.6443108623059218 Con Loss: 4.913157358351075
[1 / 20] tensor([[0.568, 0.511],
        [0.703, 0.841]]) {'epoch': 1, 'valid/acc': 64.346, 'valid/acc_unbiased': 64.838, 'valid/diff': 6.077, 'valid/acc_skew': 61.799, 'valid/acc_align': 67.876, 'test/acc': 65.57, 'test/acc_unbiased': 65.591, 'test/diff': 9.728, 'test/acc_skew': 60.727, 'test/acc_align': 70.456}
[1 / 20] best valid accuracy: 64.838 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 64.346, 'best_valid_valid/acc_unbiased': 64.838, 'best_valid_valid/diff': 6.077, 'best_valid_valid/acc_skew': 61.799, 'best_valid_valid/acc_align': 67.876, 'best_valid_test/acc': 65.57, 'best_valid_test/acc_unbiased': 65.591, 'best_valid_test/diff': 9.728, 'best_valid_test/acc_skew': 60.727, 'best_valid_test/acc_align': 70.456}
[1 / 20] best test accuracy: 65.591 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 64.346, 'best_test_valid/acc_unbiased': 64.838, 'best_test_valid/diff': 6.077, 'best_test_valid/acc_skew': 61.799, 'best_test_valid/acc_align': 67.876, 'best_test_test/acc': 65.57, 'best_test_test/acc_unbiased': 65.591, 'best_test_test/diff': 9.728, 'best_test_test/acc_skew': 60.727, 'best_test_test/acc_align': 70.456}
[2 / 20] Learning rate: 0.001 weight: 0.01
[2 / 20] Loss: 4.812396404160238 CE Loss: 0.5796132113015494 Con Loss: 4.806600269077463
[2 / 20] tensor([[0.647, 0.589],
        [0.784, 0.868]]) {'epoch': 2, 'valid/acc': 72.658, 'valid/acc_unbiased': 73.226, 'valid/diff': 3.646, 'valid/acc_skew': 71.402, 'valid/acc_align': 75.049, 'test/acc': 71.983, 'test/acc_unbiased': 72.191, 'test/diff': 7.09, 'test/acc_skew': 68.646, 'test/acc_align': 75.735}
[2 / 20] best valid accuracy: 73.226 at epoch 2 
 best_stats: {'best_valid_epoch': 2, 'best_valid_valid/acc': 72.658, 'best_valid_valid/acc_unbiased': 73.226, 'best_valid_valid/diff': 3.646, 'best_valid_valid/acc_skew': 71.402, 'best_valid_valid/acc_align': 75.049, 'best_valid_test/acc': 71.983, 'best_valid_test/acc_unbiased': 72.191, 'best_valid_test/diff': 7.09, 'best_valid_test/acc_skew': 68.646, 'best_valid_test/acc_align': 75.735}
[2 / 20] best test accuracy: 72.191 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 72.658, 'best_test_valid/acc_unbiased': 73.226, 'best_test_valid/diff': 3.646, 'best_test_valid/acc_skew': 71.402, 'best_test_valid/acc_align': 75.049, 'best_test_test/acc': 71.983, 'best_test_test/acc_unbiased': 72.191, 'best_test_test/diff': 7.09, 'best_test_test/acc_skew': 68.646, 'best_test_test/acc_align': 75.735}
[3 / 20] Learning rate: 0.001 weight: 0.01
[3 / 20] Loss: 4.792118438340909 CE Loss: 0.564640692264758 Con Loss: 4.786472041296226
[3 / 20] tensor([[0.643, 0.530],
        [0.779, 0.832]]) {'epoch': 3, 'valid/acc': 69.578, 'valid/acc_unbiased': 70.186, 'valid/diff': 3.702, 'valid/acc_skew': 68.335, 'valid/acc_align': 72.037, 'test/acc': 69.114, 'test/acc_unbiased': 69.624, 'test/diff': 8.298, 'test/acc_skew': 65.475, 'test/acc_align': 73.773}
[3 / 20] best valid accuracy: 73.226 at epoch 2 
 best_stats: {'best_valid_epoch': 2, 'best_valid_valid/acc': 72.658, 'best_valid_valid/acc_unbiased': 73.226, 'best_valid_valid/diff': 3.646, 'best_valid_valid/acc_skew': 71.402, 'best_valid_valid/acc_align': 75.049, 'best_valid_test/acc': 71.983, 'best_valid_test/acc_unbiased': 72.191, 'best_valid_test/diff': 7.09, 'best_valid_test/acc_skew': 68.646, 'best_valid_test/acc_align': 75.735}
[3 / 20] best test accuracy: 72.191 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 72.658, 'best_test_valid/acc_unbiased': 73.226, 'best_test_valid/diff': 3.646, 'best_test_valid/acc_skew': 71.402, 'best_test_valid/acc_align': 75.049, 'best_test_test/acc': 71.983, 'best_test_test/acc_unbiased': 72.191, 'best_test_test/diff': 7.09, 'best_test_test/acc_skew': 68.646, 'best_test_test/acc_align': 75.735}
[4 / 20] Learning rate: 0.001 weight: 0.01
[4 / 20] Loss: 4.782479613626684 CE Loss: 0.565465976692747 Con Loss: 4.776824965134896
[4 / 20] tensor([[0.769, 0.702],
        [0.723, 0.793]]) {'epoch': 4, 'valid/acc': 74.304, 'valid/acc_unbiased': 74.268, 'valid/diff': 3.669, 'valid/acc_skew': 72.434, 'valid/acc_align': 76.103, 'test/acc': 74.768, 'test/acc_unbiased': 74.671, 'test/diff': 6.886, 'test/acc_skew': 71.228, 'test/acc_align': 78.114}
[4 / 20] best valid accuracy: 74.268 at epoch 4 
 best_stats: {'best_valid_epoch': 4, 'best_valid_valid/acc': 74.304, 'best_valid_valid/acc_unbiased': 74.268, 'best_valid_valid/diff': 3.669, 'best_valid_valid/acc_skew': 72.434, 'best_valid_valid/acc_align': 76.103, 'best_valid_test/acc': 74.768, 'best_valid_test/acc_unbiased': 74.671, 'best_valid_test/diff': 6.886, 'best_valid_test/acc_skew': 71.228, 'best_valid_test/acc_align': 78.114}
[4 / 20] best test accuracy: 74.671 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 74.304, 'best_test_valid/acc_unbiased': 74.268, 'best_test_valid/diff': 3.669, 'best_test_valid/acc_skew': 72.434, 'best_test_valid/acc_align': 76.103, 'best_test_test/acc': 74.768, 'best_test_test/acc_unbiased': 74.671, 'best_test_test/diff': 6.886, 'best_test_test/acc_skew': 71.228, 'best_test_test/acc_align': 78.114}
[5 / 20] Learning rate: 0.001 weight: 0.01
[5 / 20] Loss: 4.764304291626021 CE Loss: 0.55669390369823 Con Loss: 4.7587373490563945
[5 / 20] tensor([[0.841, 0.805],
        [0.634, 0.658]]) {'epoch': 5, 'valid/acc': 75.865, 'valid/acc_unbiased': 75.34, 'valid/diff': 0.827, 'valid/acc_skew': 74.926, 'valid/acc_align': 75.753, 'test/acc': 73.84, 'test/acc_unbiased': 73.449, 'test/diff': 2.976, 'test/acc_skew': 71.961, 'test/acc_align': 74.937}
[5 / 20] best valid accuracy: 75.340 at epoch 5 
 best_stats: {'best_valid_epoch': 5, 'best_valid_valid/acc': 75.865, 'best_valid_valid/acc_unbiased': 75.34, 'best_valid_valid/diff': 0.827, 'best_valid_valid/acc_skew': 74.926, 'best_valid_valid/acc_align': 75.753, 'best_valid_test/acc': 73.84, 'best_valid_test/acc_unbiased': 73.449, 'best_valid_test/diff': 2.976, 'best_valid_test/acc_skew': 71.961, 'best_valid_test/acc_align': 74.937}
[5 / 20] best test accuracy: 74.671 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 74.304, 'best_test_valid/acc_unbiased': 74.268, 'best_test_valid/diff': 3.669, 'best_test_valid/acc_skew': 72.434, 'best_test_valid/acc_align': 76.103, 'best_test_test/acc': 74.768, 'best_test_test/acc_unbiased': 74.671, 'best_test_test/diff': 6.886, 'best_test_test/acc_skew': 71.228, 'best_test_test/acc_align': 78.114}
[6 / 20] Learning rate: 0.001 weight: 0.01
[6 / 20] Loss: 4.751937533192893 CE Loss: 0.5451299766321308 Con Loss: 4.746486241436982
[6 / 20] tensor([[0.796, 0.761],
        [0.680, 0.779]]) {'epoch': 6, 'valid/acc': 76.076, 'valid/acc_unbiased': 75.673, 'valid/diff': 7.273, 'valid/acc_skew': 72.037, 'valid/acc_align': 79.31, 'test/acc': 75.823, 'test/acc_unbiased': 75.367, 'test/diff': 6.697, 'test/acc_skew': 72.018, 'test/acc_align': 78.715}
[6 / 20] best valid accuracy: 75.673 at epoch 6 
 best_stats: {'best_valid_epoch': 6, 'best_valid_valid/acc': 76.076, 'best_valid_valid/acc_unbiased': 75.673, 'best_valid_valid/diff': 7.273, 'best_valid_valid/acc_skew': 72.037, 'best_valid_valid/acc_align': 79.31, 'best_valid_test/acc': 75.823, 'best_valid_test/acc_unbiased': 75.367, 'best_valid_test/diff': 6.697, 'best_valid_test/acc_skew': 72.018, 'best_valid_test/acc_align': 78.715}
[6 / 20] best test accuracy: 75.367 at epoch 6 
 best_stats: {'best_test_epoch': 6, 'best_test_valid/acc': 76.076, 'best_test_valid/acc_unbiased': 75.673, 'best_test_valid/diff': 7.273, 'best_test_valid/acc_skew': 72.037, 'best_test_valid/acc_align': 79.31, 'best_test_test/acc': 75.823, 'best_test_test/acc_unbiased': 75.367, 'best_test_test/diff': 6.697, 'best_test_test/acc_skew': 72.018, 'best_test_test/acc_align': 78.715}
[7 / 20] Learning rate: 0.0001 weight: 0.01
[7 / 20] Loss: 4.705119248190527 CE Loss: 0.5230239847481338 Con Loss: 4.699888999430711
[7 / 20] tensor([[0.754, 0.703],
        [0.775, 0.837]]) {'epoch': 7, 'valid/acc': 76.92, 'valid/acc_unbiased': 77.108, 'valid/diff': 5.119, 'valid/acc_skew': 74.549, 'valid/acc_align': 79.667, 'test/acc': 76.709, 'test/acc_unbiased': 76.726, 'test/diff': 5.652, 'test/acc_skew': 73.9, 'test/acc_align': 79.552}
[7 / 20] best valid accuracy: 77.108 at epoch 7 
 best_stats: {'best_valid_epoch': 7, 'best_valid_valid/acc': 76.92, 'best_valid_valid/acc_unbiased': 77.108, 'best_valid_valid/diff': 5.119, 'best_valid_valid/acc_skew': 74.549, 'best_valid_valid/acc_align': 79.667, 'best_valid_test/acc': 76.709, 'best_valid_test/acc_unbiased': 76.726, 'best_valid_test/diff': 5.652, 'best_valid_test/acc_skew': 73.9, 'best_valid_test/acc_align': 79.552}
[7 / 20] best test accuracy: 76.726 at epoch 7 
 best_stats: {'best_test_epoch': 7, 'best_test_valid/acc': 76.92, 'best_test_valid/acc_unbiased': 77.108, 'best_test_valid/diff': 5.119, 'best_test_valid/acc_skew': 74.549, 'best_test_valid/acc_align': 79.667, 'best_test_test/acc': 76.709, 'best_test_test/acc_unbiased': 76.726, 'best_test_test/diff': 5.652, 'best_test_test/acc_skew': 73.9, 'best_test_test/acc_align': 79.552}
[8 / 20] Learning rate: 0.0001 weight: 0.01
[8 / 20] Loss: 4.662896941730952 CE Loss: 0.5108202120308296 Con Loss: 4.657788752811371
[8 / 20] tensor([[0.765, 0.685],
        [0.803, 0.863]]) {'epoch': 8, 'valid/acc': 77.257, 'valid/acc_unbiased': 77.642, 'valid/diff': 5.754, 'valid/acc_skew': 74.765, 'valid/acc_align': 80.519, 'test/acc': 77.764, 'test/acc_unbiased': 77.923, 'test/diff': 7.006, 'test/acc_skew': 74.42, 'test/acc_align': 81.427}
[8 / 20] best valid accuracy: 77.642 at epoch 8 
 best_stats: {'best_valid_epoch': 8, 'best_valid_valid/acc': 77.257, 'best_valid_valid/acc_unbiased': 77.642, 'best_valid_valid/diff': 5.754, 'best_valid_valid/acc_skew': 74.765, 'best_valid_valid/acc_align': 80.519, 'best_valid_test/acc': 77.764, 'best_valid_test/acc_unbiased': 77.923, 'best_valid_test/diff': 7.006, 'best_valid_test/acc_skew': 74.42, 'best_valid_test/acc_align': 81.427}
[8 / 20] best test accuracy: 77.923 at epoch 8 
 best_stats: {'best_test_epoch': 8, 'best_test_valid/acc': 77.257, 'best_test_valid/acc_unbiased': 77.642, 'best_test_valid/diff': 5.754, 'best_test_valid/acc_skew': 74.765, 'best_test_valid/acc_align': 80.519, 'best_test_test/acc': 77.764, 'best_test_test/acc_unbiased': 77.923, 'best_test_test/diff': 7.006, 'best_test_test/acc_skew': 74.42, 'best_test_test/acc_align': 81.427}
[9 / 20] Learning rate: 0.0001 weight: 0.01
[9 / 20] Loss: 4.645083868660654 CE Loss: 0.5032851688596549 Con Loss: 4.640051038862147
[9 / 20] tensor([[0.681, 0.607],
        [0.853, 0.905]]) {'epoch': 9, 'valid/acc': 75.949, 'valid/acc_unbiased': 76.634, 'valid/diff': 4.699, 'valid/acc_skew': 74.285, 'valid/acc_align': 78.984, 'test/acc': 75.696, 'test/acc_unbiased': 76.145, 'test/diff': 6.3, 'test/acc_skew': 72.995, 'test/acc_align': 79.295}
[9 / 20] best valid accuracy: 77.642 at epoch 8 
 best_stats: {'best_valid_epoch': 8, 'best_valid_valid/acc': 77.257, 'best_valid_valid/acc_unbiased': 77.642, 'best_valid_valid/diff': 5.754, 'best_valid_valid/acc_skew': 74.765, 'best_valid_valid/acc_align': 80.519, 'best_valid_test/acc': 77.764, 'best_valid_test/acc_unbiased': 77.923, 'best_valid_test/diff': 7.006, 'best_valid_test/acc_skew': 74.42, 'best_valid_test/acc_align': 81.427}
[9 / 20] best test accuracy: 77.923 at epoch 8 
 best_stats: {'best_test_epoch': 8, 'best_test_valid/acc': 77.257, 'best_test_valid/acc_unbiased': 77.642, 'best_test_valid/diff': 5.754, 'best_test_valid/acc_skew': 74.765, 'best_test_valid/acc_align': 80.519, 'best_test_test/acc': 77.764, 'best_test_test/acc_unbiased': 77.923, 'best_test_test/diff': 7.006, 'best_test_test/acc_skew': 74.42, 'best_test_test/acc_align': 81.427}
[10 / 20] Learning rate: 0.0001 weight: 0.01
[10 / 20] Loss: 4.640043174888868 CE Loss: 0.49180275869404416 Con Loss: 4.635125142763509
[10 / 20] tensor([[0.792, 0.710],
        [0.742, 0.841]]) {'epoch': 10, 'valid/acc': 76.92, 'valid/acc_unbiased': 76.79, 'valid/diff': 6.885, 'valid/acc_skew': 73.348, 'valid/acc_align': 80.232, 'test/acc': 77.3, 'test/acc_unbiased': 77.151, 'test/diff': 9.011, 'test/acc_skew': 72.646, 'test/acc_align': 81.656}
[10 / 20] best valid accuracy: 77.642 at epoch 8 
 best_stats: {'best_valid_epoch': 8, 'best_valid_valid/acc': 77.257, 'best_valid_valid/acc_unbiased': 77.642, 'best_valid_valid/diff': 5.754, 'best_valid_valid/acc_skew': 74.765, 'best_valid_valid/acc_align': 80.519, 'best_valid_test/acc': 77.764, 'best_valid_test/acc_unbiased': 77.923, 'best_valid_test/diff': 7.006, 'best_valid_test/acc_skew': 74.42, 'best_valid_test/acc_align': 81.427}
[10 / 20] best test accuracy: 77.923 at epoch 8 
 best_stats: {'best_test_epoch': 8, 'best_test_valid/acc': 77.257, 'best_test_valid/acc_unbiased': 77.642, 'best_test_valid/diff': 5.754, 'best_test_valid/acc_skew': 74.765, 'best_test_valid/acc_align': 80.519, 'best_test_test/acc': 77.764, 'best_test_test/acc_unbiased': 77.923, 'best_test_test/diff': 7.006, 'best_test_test/acc_skew': 74.42, 'best_test_test/acc_align': 81.427}
[11 / 20] Learning rate: 0.0001 weight: 0.01
[11 / 20] Loss: 4.604798342787155 CE Loss: 0.48026494670926567 Con Loss: 4.599995686404004
[11 / 20] tensor([[0.814, 0.722],
        [0.775, 0.837]]) {'epoch': 11, 'valid/acc': 78.987, 'valid/acc_unbiased': 79.033, 'valid/diff': 4.803, 'valid/acc_skew': 76.632, 'valid/acc_align': 81.435, 'test/acc': 78.65, 'test/acc_unbiased': 78.684, 'test/diff': 7.649, 'test/acc_skew': 74.86, 'test/acc_align': 82.509}
[11 / 20] best valid accuracy: 79.033 at epoch 11 
 best_stats: {'best_valid_epoch': 11, 'best_valid_valid/acc': 78.987, 'best_valid_valid/acc_unbiased': 79.033, 'best_valid_valid/diff': 4.803, 'best_valid_valid/acc_skew': 76.632, 'best_valid_valid/acc_align': 81.435, 'best_valid_test/acc': 78.65, 'best_valid_test/acc_unbiased': 78.684, 'best_valid_test/diff': 7.649, 'best_valid_test/acc_skew': 74.86, 'best_valid_test/acc_align': 82.509}
[11 / 20] best test accuracy: 78.684 at epoch 11 
 best_stats: {'best_test_epoch': 11, 'best_test_valid/acc': 78.987, 'best_test_valid/acc_unbiased': 79.033, 'best_test_valid/diff': 4.803, 'best_test_valid/acc_skew': 76.632, 'best_test_valid/acc_align': 81.435, 'best_test_test/acc': 78.65, 'best_test_test/acc_unbiased': 78.684, 'best_test_test/diff': 7.649, 'best_test_test/acc_skew': 74.86, 'best_test_test/acc_align': 82.509}
[12 / 20] Learning rate: 0.0001 weight: 0.01
[12 / 20] Loss: 4.596204384877776 CE Loss: 0.49108799441143497 Con Loss: 4.591293494837525
[12 / 20] tensor([[0.767, 0.654],
        [0.807, 0.878]]) {'epoch': 12, 'valid/acc': 77.3, 'valid/acc_unbiased': 77.681, 'valid/diff': 7.367, 'valid/acc_skew': 73.997, 'valid/acc_align': 81.364, 'test/acc': 77.426, 'test/acc_unbiased': 77.672, 'test/diff': 9.173, 'test/acc_skew': 73.086, 'test/acc_align': 82.259}
[12 / 20] best valid accuracy: 79.033 at epoch 11 
 best_stats: {'best_valid_epoch': 11, 'best_valid_valid/acc': 78.987, 'best_valid_valid/acc_unbiased': 79.033, 'best_valid_valid/diff': 4.803, 'best_valid_valid/acc_skew': 76.632, 'best_valid_valid/acc_align': 81.435, 'best_valid_test/acc': 78.65, 'best_valid_test/acc_unbiased': 78.684, 'best_valid_test/diff': 7.649, 'best_valid_test/acc_skew': 74.86, 'best_valid_test/acc_align': 82.509}
[12 / 20] best test accuracy: 78.684 at epoch 11 
 best_stats: {'best_test_epoch': 11, 'best_test_valid/acc': 78.987, 'best_test_valid/acc_unbiased': 79.033, 'best_test_valid/diff': 4.803, 'best_test_valid/acc_skew': 76.632, 'best_test_valid/acc_align': 81.435, 'best_test_test/acc': 78.65, 'best_test_test/acc_unbiased': 78.684, 'best_test_test/diff': 7.649, 'best_test_test/acc_skew': 74.86, 'best_test_test/acc_align': 82.509}
[13 / 20] Learning rate: 0.0001 weight: 0.01
[13 / 20] Loss: 4.582058123229713 CE Loss: 0.47992198795385627 Con Loss: 4.577258910127475
[13 / 20] tensor([[0.744, 0.635],
        [0.814, 0.889]]) {'epoch': 13, 'valid/acc': 77.131, 'valid/acc_unbiased': 77.639, 'valid/diff': 7.215, 'valid/acc_skew': 74.032, 'valid/acc_align': 81.247, 'test/acc': 76.751, 'test/acc_unbiased': 77.032, 'test/diff': 9.164, 'test/acc_skew': 72.45, 'test/acc_align': 81.614}
[13 / 20] best valid accuracy: 79.033 at epoch 11 
 best_stats: {'best_valid_epoch': 11, 'best_valid_valid/acc': 78.987, 'best_valid_valid/acc_unbiased': 79.033, 'best_valid_valid/diff': 4.803, 'best_valid_valid/acc_skew': 76.632, 'best_valid_valid/acc_align': 81.435, 'best_valid_test/acc': 78.65, 'best_valid_test/acc_unbiased': 78.684, 'best_valid_test/diff': 7.649, 'best_valid_test/acc_skew': 74.86, 'best_valid_test/acc_align': 82.509}
[13 / 20] best test accuracy: 78.684 at epoch 11 
 best_stats: {'best_test_epoch': 11, 'best_test_valid/acc': 78.987, 'best_test_valid/acc_unbiased': 79.033, 'best_test_valid/diff': 4.803, 'best_test_valid/acc_skew': 76.632, 'best_test_valid/acc_align': 81.435, 'best_test_test/acc': 78.65, 'best_test_test/acc_unbiased': 78.684, 'best_test_test/diff': 7.649, 'best_test_test/acc_skew': 74.86, 'best_test_test/acc_align': 82.509}
[14 / 20] Learning rate: 1e-05 weight: 0.01
[14 / 20] Loss: 4.555787820243556 CE Loss: 0.4673438530802552 Con Loss: 4.551114389522882
[14 / 20] tensor([[0.774, 0.665],
        [0.805, 0.872]]) {'epoch': 14, 'valid/acc': 77.975, 'valid/acc_unbiased': 78.216, 'valid/diff': 7.12, 'valid/acc_skew': 74.656, 'valid/acc_align': 81.776, 'test/acc': 77.679, 'test/acc_unbiased': 77.907, 'test/diff': 8.826, 'test/acc_skew': 73.495, 'test/acc_align': 82.32}
[14 / 20] best valid accuracy: 79.033 at epoch 11 
 best_stats: {'best_valid_epoch': 11, 'best_valid_valid/acc': 78.987, 'best_valid_valid/acc_unbiased': 79.033, 'best_valid_valid/diff': 4.803, 'best_valid_valid/acc_skew': 76.632, 'best_valid_valid/acc_align': 81.435, 'best_valid_test/acc': 78.65, 'best_valid_test/acc_unbiased': 78.684, 'best_valid_test/diff': 7.649, 'best_valid_test/acc_skew': 74.86, 'best_valid_test/acc_align': 82.509}
[14 / 20] best test accuracy: 78.684 at epoch 11 
 best_stats: {'best_test_epoch': 11, 'best_test_valid/acc': 78.987, 'best_test_valid/acc_unbiased': 79.033, 'best_test_valid/diff': 4.803, 'best_test_valid/acc_skew': 76.632, 'best_test_valid/acc_align': 81.435, 'best_test_test/acc': 78.65, 'best_test_test/acc_unbiased': 78.684, 'best_test_test/diff': 7.649, 'best_test_test/acc_skew': 74.86, 'best_test_test/acc_align': 82.509}
[15 / 20] Learning rate: 1e-05 weight: 0.01
[15 / 20] Loss: 4.561210156185211 CE Loss: 0.47568701161821625 Con Loss: 4.556453274772946
[15 / 20] tensor([[0.783, 0.675],
        [0.803, 0.872]]) {'epoch': 15, 'valid/acc': 78.101, 'valid/acc_unbiased': 78.256, 'valid/diff': 7.417, 'valid/acc_skew': 74.548, 'valid/acc_align': 81.964, 'test/acc': 78.143, 'test/acc_unbiased': 78.336, 'test/diff': 8.865, 'test/acc_skew': 73.903, 'test/acc_align': 82.768}
[15 / 20] best valid accuracy: 79.033 at epoch 11 
 best_stats: {'best_valid_epoch': 11, 'best_valid_valid/acc': 78.987, 'best_valid_valid/acc_unbiased': 79.033, 'best_valid_valid/diff': 4.803, 'best_valid_valid/acc_skew': 76.632, 'best_valid_valid/acc_align': 81.435, 'best_valid_test/acc': 78.65, 'best_valid_test/acc_unbiased': 78.684, 'best_valid_test/diff': 7.649, 'best_valid_test/acc_skew': 74.86, 'best_valid_test/acc_align': 82.509}
[15 / 20] best test accuracy: 78.684 at epoch 11 
 best_stats: {'best_test_epoch': 11, 'best_test_valid/acc': 78.987, 'best_test_valid/acc_unbiased': 79.033, 'best_test_valid/diff': 4.803, 'best_test_valid/acc_skew': 76.632, 'best_test_valid/acc_align': 81.435, 'best_test_test/acc': 78.65, 'best_test_test/acc_unbiased': 78.684, 'best_test_test/diff': 7.649, 'best_test_test/acc_skew': 74.86, 'best_test_test/acc_align': 82.509}
[16 / 20] Learning rate: 1e-05 weight: 0.01
[16 / 20] Loss: 4.547230429391037 CE Loss: 0.4688179657888622 Con Loss: 4.542542242550047
[16 / 20] tensor([[0.765, 0.669],
        [0.810, 0.878]]) {'epoch': 16, 'valid/acc': 78.439, 'valid/acc_unbiased': 78.741, 'valid/diff': 6.346, 'valid/acc_skew': 75.568, 'valid/acc_align': 81.914, 'test/acc': 77.848, 'test/acc_unbiased': 78.051, 'test/diff': 8.237, 'test/acc_skew': 73.933, 'test/acc_align': 82.17}
[16 / 20] best valid accuracy: 79.033 at epoch 11 
 best_stats: {'best_valid_epoch': 11, 'best_valid_valid/acc': 78.987, 'best_valid_valid/acc_unbiased': 79.033, 'best_valid_valid/diff': 4.803, 'best_valid_valid/acc_skew': 76.632, 'best_valid_valid/acc_align': 81.435, 'best_valid_test/acc': 78.65, 'best_valid_test/acc_unbiased': 78.684, 'best_valid_test/diff': 7.649, 'best_valid_test/acc_skew': 74.86, 'best_valid_test/acc_align': 82.509}
[16 / 20] best test accuracy: 78.684 at epoch 11 
 best_stats: {'best_test_epoch': 11, 'best_test_valid/acc': 78.987, 'best_test_valid/acc_unbiased': 79.033, 'best_test_valid/diff': 4.803, 'best_test_valid/acc_skew': 76.632, 'best_test_valid/acc_align': 81.435, 'best_test_test/acc': 78.65, 'best_test_test/acc_unbiased': 78.684, 'best_test_test/diff': 7.649, 'best_test_test/acc_skew': 74.86, 'best_test_test/acc_align': 82.509}
[17 / 20] Learning rate: 1e-05 weight: 0.01
[17 / 20] Loss: 4.544765007443519 CE Loss: 0.47262206451086486 Con Loss: 4.540038787428491
[17 / 20] tensor([[0.781, 0.684],
        [0.801, 0.871]]) {'epoch': 17, 'valid/acc': 78.354, 'valid/acc_unbiased': 78.532, 'valid/diff': 6.434, 'valid/acc_skew': 75.314, 'valid/acc_align': 81.749, 'test/acc': 78.27, 'test/acc_unbiased': 78.421, 'test/diff': 8.366, 'test/acc_skew': 74.238, 'test/acc_align': 82.605}
[17 / 20] best valid accuracy: 79.033 at epoch 11 
 best_stats: {'best_valid_epoch': 11, 'best_valid_valid/acc': 78.987, 'best_valid_valid/acc_unbiased': 79.033, 'best_valid_valid/diff': 4.803, 'best_valid_valid/acc_skew': 76.632, 'best_valid_valid/acc_align': 81.435, 'best_valid_test/acc': 78.65, 'best_valid_test/acc_unbiased': 78.684, 'best_valid_test/diff': 7.649, 'best_valid_test/acc_skew': 74.86, 'best_valid_test/acc_align': 82.509}
[17 / 20] best test accuracy: 78.684 at epoch 11 
 best_stats: {'best_test_epoch': 11, 'best_test_valid/acc': 78.987, 'best_test_valid/acc_unbiased': 79.033, 'best_test_valid/diff': 4.803, 'best_test_valid/acc_skew': 76.632, 'best_test_valid/acc_align': 81.435, 'best_test_test/acc': 78.65, 'best_test_test/acc_unbiased': 78.684, 'best_test_test/diff': 7.649, 'best_test_test/acc_skew': 74.86, 'best_test_test/acc_align': 82.509}
[18 / 20] Learning rate: 1e-05 weight: 0.01
[18 / 20] Loss: 4.53874677306213 CE Loss: 0.47064112888248216 Con Loss: 4.5340403449308475
[18 / 20] tensor([[0.794, 0.684],
        [0.801, 0.860]]) {'epoch': 18, 'valid/acc': 78.65, 'valid/acc_unbiased': 78.742, 'valid/diff': 6.561, 'valid/acc_skew': 75.462, 'valid/acc_align': 82.023, 'test/acc': 78.27, 'test/acc_unbiased': 78.475, 'test/diff': 8.473, 'test/acc_skew': 74.238, 'test/acc_align': 82.712}
[18 / 20] best valid accuracy: 79.033 at epoch 11 
 best_stats: {'best_valid_epoch': 11, 'best_valid_valid/acc': 78.987, 'best_valid_valid/acc_unbiased': 79.033, 'best_valid_valid/diff': 4.803, 'best_valid_valid/acc_skew': 76.632, 'best_valid_valid/acc_align': 81.435, 'best_valid_test/acc': 78.65, 'best_valid_test/acc_unbiased': 78.684, 'best_valid_test/diff': 7.649, 'best_valid_test/acc_skew': 74.86, 'best_valid_test/acc_align': 82.509}
[18 / 20] best test accuracy: 78.684 at epoch 11 
 best_stats: {'best_test_epoch': 11, 'best_test_valid/acc': 78.987, 'best_test_valid/acc_unbiased': 79.033, 'best_test_valid/diff': 4.803, 'best_test_valid/acc_skew': 76.632, 'best_test_valid/acc_align': 81.435, 'best_test_test/acc': 78.65, 'best_test_test/acc_unbiased': 78.684, 'best_test_test/diff': 7.649, 'best_test_test/acc_skew': 74.86, 'best_test_test/acc_align': 82.509}
[19 / 20] Learning rate: 1e-05 weight: 0.01
[19 / 20] Loss: 4.547261194114629 CE Loss: 0.4652065201437491 Con Loss: 4.5426091330990435
[19 / 20] tensor([[0.783, 0.684],
        [0.810, 0.869]]) {'epoch': 19, 'valid/acc': 78.481, 'valid/acc_unbiased': 78.585, 'valid/diff': 6.759, 'valid/acc_skew': 75.206, 'valid/acc_align': 81.964, 'test/acc': 78.439, 'test/acc_unbiased': 78.645, 'test/diff': 7.949, 'test/acc_skew': 74.671, 'test/acc_align': 82.62}
[19 / 20] best valid accuracy: 79.033 at epoch 11 
 best_stats: {'best_valid_epoch': 11, 'best_valid_valid/acc': 78.987, 'best_valid_valid/acc_unbiased': 79.033, 'best_valid_valid/diff': 4.803, 'best_valid_valid/acc_skew': 76.632, 'best_valid_valid/acc_align': 81.435, 'best_valid_test/acc': 78.65, 'best_valid_test/acc_unbiased': 78.684, 'best_valid_test/diff': 7.649, 'best_valid_test/acc_skew': 74.86, 'best_valid_test/acc_align': 82.509}
[19 / 20] best test accuracy: 78.684 at epoch 11 
 best_stats: {'best_test_epoch': 11, 'best_test_valid/acc': 78.987, 'best_test_valid/acc_unbiased': 79.033, 'best_test_valid/diff': 4.803, 'best_test_valid/acc_skew': 76.632, 'best_test_valid/acc_align': 81.435, 'best_test_test/acc': 78.65, 'best_test_test/acc_unbiased': 78.684, 'best_test_test/diff': 7.649, 'best_test_test/acc_skew': 74.86, 'best_test_test/acc_align': 82.509}
[20 / 20] Learning rate: 1e-05 weight: 0.01
[20 / 20] Loss: 4.538432502467321 CE Loss: 0.4637773610313326 Con Loss: 4.533794741679425
[20 / 20] tensor([[0.776, 0.669],
        [0.807, 0.875]]) {'epoch': 20, 'valid/acc': 78.608, 'valid/acc_unbiased': 78.846, 'valid/diff': 6.48, 'valid/acc_skew': 75.605, 'valid/acc_align': 82.086, 'test/acc': 77.975, 'test/acc_unbiased': 78.191, 'test/diff': 8.734, 'test/acc_skew': 73.824, 'test/acc_align': 82.559}
[20 / 20] best valid accuracy: 79.033 at epoch 11 
 best_stats: {'best_valid_epoch': 11, 'best_valid_valid/acc': 78.987, 'best_valid_valid/acc_unbiased': 79.033, 'best_valid_valid/diff': 4.803, 'best_valid_valid/acc_skew': 76.632, 'best_valid_valid/acc_align': 81.435, 'best_valid_test/acc': 78.65, 'best_valid_test/acc_unbiased': 78.684, 'best_valid_test/diff': 7.649, 'best_valid_test/acc_skew': 74.86, 'best_valid_test/acc_align': 82.509}
[20 / 20] best test accuracy: 78.684 at epoch 11 
 best_stats: {'best_test_epoch': 11, 'best_test_valid/acc': 78.987, 'best_test_valid/acc_unbiased': 79.033, 'best_test_valid/diff': 4.803, 'best_test_valid/acc_skew': 76.632, 'best_test_valid/acc_align': 81.435, 'best_test_test/acc': 78.65, 'best_test_test/acc_unbiased': 78.684, 'best_test_test/diff': 7.649, 'best_test_test/acc_skew': 74.86, 'best_test_test/acc_align': 82.509}
Total training time: 0:12:28
