Log level set to: INFO
Set seed: 2
=======> Using Fixed Random Seed: 2 <========
save_path: exp_results/ce-celeba_smiling-test-lr0.001-bs128-seed2
get_celeba - split:train, aug: False, given_y: True, ratio: 0
use existing smiling indices from data/celeba/pickles/smiling
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [8019, 32821]
Target 1: [40611, 8007]
Binary Target 1
---------------------------
Target 0: [8019, 32821]
Target 1: [40611, 8007]
===================================
Normal Label Distribution: 
Target 0: [8019, 32821]
Target 1: [40611, 8007]
===================================
Use BiasedCelebASplit 
 target_attr: smiling split: train 
 tensor([[ 8019., 40611.],
        [32821.,  8007.]])
get_celeba - split:train_valid, aug: False, given_y: True, ratio: 0
use existing smiling indices from data/celeba/pickles/smiling
Use BiasedCelebASplit 
 target_attr: smiling split: train_valid 
 tensor([[ 2014., 10052.],
        [ 8315.,  1984.]])
get_celeba - split:valid, aug: False, given_y: True, ratio: 0
Use BiasedCelebASplit 
 target_attr: smiling split: valid 
 tensor([[5252., 6157.],
        [5013., 3445.]])
decay_epochs: [3, 6]
[1 / 10] Learning rate: 0.001
[1 / 10] Loss: 0.1565
[1 / 10] tensor([[0.921, 0.991],
        [0.938, 0.726]]) {'epoch': 1, 'valid/acc': 93.655, 'valid/acc_unbiased': 89.459, 'valid/diff': 13.681, 'valid/acc_skew': 82.619, 'valid/acc_align': 96.3, 'test/acc': 91.015, 'test/acc_unbiased': 89.402, 'test/diff': 14.09, 'test/acc_skew': 82.358, 'test/acc_align': 96.447}
[1 / 10] best valid accuracy: 89.459 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 93.655, 'best_valid_valid/acc_unbiased': 89.459, 'best_valid_valid/diff': 13.681, 'best_valid_valid/acc_skew': 82.619, 'best_valid_valid/acc_align': 96.3, 'best_valid_test/acc': 91.015, 'best_valid_test/acc_unbiased': 89.402, 'best_valid_test/diff': 14.09, 'best_valid_test/acc_skew': 82.358, 'best_valid_test/acc_align': 96.447}
[1 / 10] best test accuracy: 89.402 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 93.655, 'best_test_valid/acc_unbiased': 89.459, 'best_test_valid/diff': 13.681, 'best_test_valid/acc_skew': 82.619, 'best_test_valid/acc_align': 96.3, 'best_test_test/acc': 91.015, 'best_test_test/acc_unbiased': 89.402, 'best_test_test/diff': 14.09, 'best_test_test/acc_skew': 82.358, 'best_test_test/acc_align': 96.447}
[2 / 10] Learning rate: 0.001
[2 / 10] Loss: 0.1445
[2 / 10] tensor([[0.911, 0.989],
        [0.943, 0.739]]) {'epoch': 2, 'valid/acc': 93.834, 'valid/acc_unbiased': 89.643, 'valid/diff': 13.587, 'valid/acc_skew': 82.849, 'valid/acc_align': 96.436, 'test/acc': 91.045, 'test/acc_unbiased': 89.521, 'test/diff': 14.087, 'test/acc_skew': 82.478, 'test/acc_align': 96.565}
[2 / 10] best valid accuracy: 89.643 at epoch 2 
 best_stats: {'best_valid_epoch': 2, 'best_valid_valid/acc': 93.834, 'best_valid_valid/acc_unbiased': 89.643, 'best_valid_valid/diff': 13.587, 'best_valid_valid/acc_skew': 82.849, 'best_valid_valid/acc_align': 96.436, 'best_valid_test/acc': 91.045, 'best_valid_test/acc_unbiased': 89.521, 'best_valid_test/diff': 14.087, 'best_valid_test/acc_skew': 82.478, 'best_valid_test/acc_align': 96.565}
[2 / 10] best test accuracy: 89.521 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 93.834, 'best_test_valid/acc_unbiased': 89.643, 'best_test_valid/diff': 13.587, 'best_test_valid/acc_skew': 82.849, 'best_test_valid/acc_align': 96.436, 'best_test_test/acc': 91.045, 'best_test_test/acc_unbiased': 89.521, 'best_test_test/diff': 14.087, 'best_test_test/acc_skew': 82.478, 'best_test_test/acc_align': 96.565}
[3 / 10] Learning rate: 0.001
[3 / 10] Loss: 0.1422
[3 / 10] tensor([[0.854, 0.982],
        [0.963, 0.792]]) {'epoch': 3, 'valid/acc': 94.751, 'valid/acc_unbiased': 90.148, 'valid/diff': 14.515, 'valid/acc_skew': 82.891, 'valid/acc_align': 97.406, 'test/acc': 90.945, 'test/acc_unbiased': 89.784, 'test/diff': 14.966, 'test/acc_skew': 82.301, 'test/acc_align': 97.267}
[3 / 10] best valid accuracy: 90.148 at epoch 3 
 best_stats: {'best_valid_epoch': 3, 'best_valid_valid/acc': 94.751, 'best_valid_valid/acc_unbiased': 90.148, 'best_valid_valid/diff': 14.515, 'best_valid_valid/acc_skew': 82.891, 'best_valid_valid/acc_align': 97.406, 'best_valid_test/acc': 90.945, 'best_valid_test/acc_unbiased': 89.784, 'best_valid_test/diff': 14.966, 'best_valid_test/acc_skew': 82.301, 'best_valid_test/acc_align': 97.267}
[3 / 10] best test accuracy: 89.784 at epoch 3 
 best_stats: {'best_test_epoch': 3, 'best_test_valid/acc': 94.751, 'best_test_valid/acc_unbiased': 90.148, 'best_test_valid/diff': 14.515, 'best_test_valid/acc_skew': 82.891, 'best_test_valid/acc_align': 97.406, 'best_test_test/acc': 90.945, 'best_test_test/acc_unbiased': 89.784, 'best_test_test/diff': 14.966, 'best_test_test/acc_skew': 82.301, 'best_test_test/acc_align': 97.267}
[4 / 10] Learning rate: 0.0001
[4 / 10] Loss: 0.1205
[4 / 10] tensor([[0.839, 0.976],
        [0.975, 0.839]]) {'epoch': 4, 'valid/acc': 95.439, 'valid/acc_unbiased': 91.377, 'valid/diff': 12.626, 'valid/acc_skew': 85.064, 'valid/acc_align': 97.69, 'test/acc': 91.594, 'test/acc_unbiased': 90.743, 'test/diff': 13.667, 'test/acc_skew': 83.91, 'test/acc_align': 97.577}
[4 / 10] best valid accuracy: 91.377 at epoch 4 
 best_stats: {'best_valid_epoch': 4, 'best_valid_valid/acc': 95.439, 'best_valid_valid/acc_unbiased': 91.377, 'best_valid_valid/diff': 12.626, 'best_valid_valid/acc_skew': 85.064, 'best_valid_valid/acc_align': 97.69, 'best_valid_test/acc': 91.594, 'best_valid_test/acc_unbiased': 90.743, 'best_valid_test/diff': 13.667, 'best_valid_test/acc_skew': 83.91, 'best_valid_test/acc_align': 97.577}
[4 / 10] best test accuracy: 90.743 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 95.439, 'best_test_valid/acc_unbiased': 91.377, 'best_test_valid/diff': 12.626, 'best_test_valid/acc_skew': 85.064, 'best_test_valid/acc_align': 97.69, 'best_test_test/acc': 91.594, 'best_test_test/acc_unbiased': 90.743, 'best_test_test/diff': 13.667, 'best_test_test/acc_skew': 83.91, 'best_test_test/acc_align': 97.577}
[5 / 10] Learning rate: 0.0001
[5 / 10] Loss: 0.1139
[5 / 10] tensor([[0.845, 0.979],
        [0.974, 0.828]]) {'epoch': 5, 'valid/acc': 95.69, 'valid/acc_unbiased': 91.694, 'valid/diff': 12.473, 'valid/acc_skew': 85.457, 'valid/acc_align': 97.931, 'test/acc': 91.579, 'test/acc_unbiased': 90.648, 'test/diff': 14.018, 'test/acc_skew': 83.639, 'test/acc_align': 97.657}
[5 / 10] best valid accuracy: 91.694 at epoch 5 
 best_stats: {'best_valid_epoch': 5, 'best_valid_valid/acc': 95.69, 'best_valid_valid/acc_unbiased': 91.694, 'best_valid_valid/diff': 12.473, 'best_valid_valid/acc_skew': 85.457, 'best_valid_valid/acc_align': 97.931, 'best_valid_test/acc': 91.579, 'best_valid_test/acc_unbiased': 90.648, 'best_valid_test/diff': 14.018, 'best_valid_test/acc_skew': 83.639, 'best_valid_test/acc_align': 97.657}
[5 / 10] best test accuracy: 90.743 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 95.439, 'best_test_valid/acc_unbiased': 91.377, 'best_test_valid/diff': 12.626, 'best_test_valid/acc_skew': 85.064, 'best_test_valid/acc_align': 97.69, 'best_test_test/acc': 91.594, 'best_test_test/acc_unbiased': 90.743, 'best_test_test/diff': 13.667, 'best_test_test/acc_skew': 83.91, 'best_test_test/acc_align': 97.577}
[6 / 10] Learning rate: 0.0001
[6 / 10] Loss: 0.1086
[6 / 10] tensor([[0.849, 0.975],
        [0.974, 0.842]]) {'epoch': 6, 'valid/acc': 95.976, 'valid/acc_unbiased': 92.563, 'valid/diff': 10.599, 'valid/acc_skew': 87.264, 'valid/acc_align': 97.863, 'test/acc': 91.816, 'test/acc_unbiased': 90.981, 'test/diff': 12.929, 'test/acc_skew': 84.516, 'test/acc_align': 97.446}
[6 / 10] best valid accuracy: 92.563 at epoch 6 
 best_stats: {'best_valid_epoch': 6, 'best_valid_valid/acc': 95.976, 'best_valid_valid/acc_unbiased': 92.563, 'best_valid_valid/diff': 10.599, 'best_valid_valid/acc_skew': 87.264, 'best_valid_valid/acc_align': 97.863, 'best_valid_test/acc': 91.816, 'best_valid_test/acc_unbiased': 90.981, 'best_valid_test/diff': 12.929, 'best_valid_test/acc_skew': 84.516, 'best_valid_test/acc_align': 97.446}
[6 / 10] best test accuracy: 90.981 at epoch 6 
 best_stats: {'best_test_epoch': 6, 'best_test_valid/acc': 95.976, 'best_test_valid/acc_unbiased': 92.563, 'best_test_valid/diff': 10.599, 'best_test_valid/acc_skew': 87.264, 'best_test_valid/acc_align': 97.863, 'best_test_test/acc': 91.816, 'best_test_test/acc_unbiased': 90.981, 'best_test_test/diff': 12.929, 'best_test_test/acc_skew': 84.516, 'best_test_test/acc_align': 97.446}
[7 / 10] Learning rate: 1e-05
[7 / 10] Loss: 0.0987
[7 / 10] tensor([[0.853, 0.979],
        [0.972, 0.829]]) {'epoch': 7, 'valid/acc': 96.106, 'valid/acc_unbiased': 92.558, 'valid/diff': 11.105, 'valid/acc_skew': 87.005, 'valid/acc_align': 98.11, 'test/acc': 91.735, 'test/acc_unbiased': 90.808, 'test/diff': 13.48, 'test/acc_skew': 84.068, 'test/acc_align': 97.548}
[7 / 10] best valid accuracy: 92.563 at epoch 6 
 best_stats: {'best_valid_epoch': 6, 'best_valid_valid/acc': 95.976, 'best_valid_valid/acc_unbiased': 92.563, 'best_valid_valid/diff': 10.599, 'best_valid_valid/acc_skew': 87.264, 'best_valid_valid/acc_align': 97.863, 'best_valid_test/acc': 91.816, 'best_valid_test/acc_unbiased': 90.981, 'best_valid_test/diff': 12.929, 'best_valid_test/acc_skew': 84.516, 'best_valid_test/acc_align': 97.446}
[7 / 10] best test accuracy: 90.981 at epoch 6 
 best_stats: {'best_test_epoch': 6, 'best_test_valid/acc': 95.976, 'best_test_valid/acc_unbiased': 92.563, 'best_test_valid/diff': 10.599, 'best_test_valid/acc_skew': 87.264, 'best_test_valid/acc_align': 97.863, 'best_test_test/acc': 91.816, 'best_test_test/acc_unbiased': 90.981, 'best_test_test/diff': 12.929, 'best_test_test/acc_skew': 84.516, 'best_test_test/acc_align': 97.446}
[8 / 10] Learning rate: 1e-05
[8 / 10] Loss: 0.0955
[8 / 10] tensor([[0.846, 0.976],
        [0.975, 0.838]]) {'epoch': 8, 'valid/acc': 96.258, 'valid/acc_unbiased': 92.828, 'valid/diff': 10.682, 'valid/acc_skew': 87.487, 'valid/acc_align': 98.169, 'test/acc': 91.735, 'test/acc_unbiased': 90.875, 'test/diff': 13.283, 'test/acc_skew': 84.233, 'test/acc_align': 97.516}
[8 / 10] best valid accuracy: 92.828 at epoch 8 
 best_stats: {'best_valid_epoch': 8, 'best_valid_valid/acc': 96.258, 'best_valid_valid/acc_unbiased': 92.828, 'best_valid_valid/diff': 10.682, 'best_valid_valid/acc_skew': 87.487, 'best_valid_valid/acc_align': 98.169, 'best_valid_test/acc': 91.735, 'best_valid_test/acc_unbiased': 90.875, 'best_valid_test/diff': 13.283, 'best_valid_test/acc_skew': 84.233, 'best_valid_test/acc_align': 97.516}
[8 / 10] best test accuracy: 90.981 at epoch 6 
 best_stats: {'best_test_epoch': 6, 'best_test_valid/acc': 95.976, 'best_test_valid/acc_unbiased': 92.563, 'best_test_valid/diff': 10.599, 'best_test_valid/acc_skew': 87.264, 'best_test_valid/acc_align': 97.863, 'best_test_test/acc': 91.816, 'best_test_test/acc_unbiased': 90.981, 'best_test_test/diff': 12.929, 'best_test_test/acc_skew': 84.516, 'best_test_test/acc_align': 97.446}
[9 / 10] Learning rate: 1e-05
[9 / 10] Loss: 0.0924
[9 / 10] tensor([[0.841, 0.975],
        [0.976, 0.844]]) {'epoch': 9, 'valid/acc': 96.213, 'valid/acc_unbiased': 92.793, 'valid/diff': 10.6, 'valid/acc_skew': 87.493, 'valid/acc_align': 98.093, 'test/acc': 91.72, 'test/acc_unbiased': 90.904, 'test/diff': 13.304, 'test/acc_skew': 84.252, 'test/acc_align': 97.556}
[9 / 10] best valid accuracy: 92.828 at epoch 8 
 best_stats: {'best_valid_epoch': 8, 'best_valid_valid/acc': 96.258, 'best_valid_valid/acc_unbiased': 92.828, 'best_valid_valid/diff': 10.682, 'best_valid_valid/acc_skew': 87.487, 'best_valid_valid/acc_align': 98.169, 'best_valid_test/acc': 91.735, 'best_valid_test/acc_unbiased': 90.875, 'best_valid_test/diff': 13.283, 'best_valid_test/acc_skew': 84.233, 'best_valid_test/acc_align': 97.516}
[9 / 10] best test accuracy: 90.981 at epoch 6 
 best_stats: {'best_test_epoch': 6, 'best_test_valid/acc': 95.976, 'best_test_valid/acc_unbiased': 92.563, 'best_test_valid/diff': 10.599, 'best_test_valid/acc_skew': 87.264, 'best_test_valid/acc_align': 97.863, 'best_test_test/acc': 91.816, 'best_test_test/acc_unbiased': 90.981, 'best_test_test/diff': 12.929, 'best_test_test/acc_skew': 84.516, 'best_test_test/acc_align': 97.446}
[10 / 10] Learning rate: 1e-05
[10 / 10] Loss: 0.0907
[10 / 10] tensor([[0.839, 0.974],
        [0.976, 0.842]]) {'epoch': 10, 'valid/acc': 96.329, 'valid/acc_unbiased': 92.806, 'valid/diff': 10.925, 'valid/acc_skew': 87.343, 'valid/acc_align': 98.268, 'test/acc': 91.609, 'test/acc_unbiased': 90.778, 'test/diff': 13.447, 'test/acc_skew': 84.055, 'test/acc_align': 97.501}
[10 / 10] best valid accuracy: 92.828 at epoch 8 
 best_stats: {'best_valid_epoch': 8, 'best_valid_valid/acc': 96.258, 'best_valid_valid/acc_unbiased': 92.828, 'best_valid_valid/diff': 10.682, 'best_valid_valid/acc_skew': 87.487, 'best_valid_valid/acc_align': 98.169, 'best_valid_test/acc': 91.735, 'best_valid_test/acc_unbiased': 90.875, 'best_valid_test/diff': 13.283, 'best_valid_test/acc_skew': 84.233, 'best_valid_test/acc_align': 97.516}
[10 / 10] best test accuracy: 90.981 at epoch 6 
 best_stats: {'best_test_epoch': 6, 'best_test_valid/acc': 95.976, 'best_test_valid/acc_unbiased': 92.563, 'best_test_valid/diff': 10.599, 'best_test_valid/acc_skew': 87.264, 'best_test_valid/acc_align': 97.863, 'best_test_test/acc': 91.816, 'best_test_test/acc_unbiased': 90.981, 'best_test_test/diff': 12.929, 'best_test_test/acc_skew': 84.516, 'best_test_test/acc_align': 97.446}
Total training time: 0:54:01
