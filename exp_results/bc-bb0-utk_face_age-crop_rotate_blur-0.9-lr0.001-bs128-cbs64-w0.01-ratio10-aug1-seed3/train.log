Log level set to: INFO
Set seed: 3
=======> Using Fixed Random Seed: 3 <========
save_path: exp_results/bc-bb0-utk_face_age-crop_rotate_blur-0.9-lr0.001-bs128-cbs64-w0.01-ratio10-aug1-seed3
get_utk_face - split: train, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_age-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
Binary Target 1
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Normal Label Distribution: 
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
Binary Target 1
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Normal Label Distribution: 
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 10684, target_attr: gender, bias_attr: age bias_rate: 0.9
['[train] target_0-bias_0: 8237', '[train] target_0-bias_1: 147', '[train] target_1-bias_0: 823', '[train] target_1-bias_1: 1477']
confusion_matrix - 
 original: tensor([[8237.,  823.],
        [ 147., 1477.]]), 
 normalized: tensor([[0.909, 0.091],
        [0.091, 0.909]]), 
 b|y: tensor([[0.982, 0.018],
        [0.358, 0.642]])
get_utk_face - split: train, aug: 1, given_y: True, ratio: 10
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_age-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
Binary Target 1
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Normal Label Distribution: 
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
Binary Target 1
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Normal Label Distribution: 
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 10684, target_attr: gender, bias_attr: age bias_rate: 0.9
['[train] target_0-bias_0: 8237', '[train] target_0-bias_1: 147', '[train] target_1-bias_0: 823', '[train] target_1-bias_1: 1477']
get_utk_face - split: valid, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_age-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [1030, 195]
Target 1: [841, 202]
Binary Target 1
---------------------------
Target 0: [1030, 195]
Target 1: [841, 202]
===================================
Normal Label Distribution: 
Target 0: [1030, 195]
Target 1: [841, 202]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 2268, target_attr: gender, bias_attr: age bias_rate: 0.9
['[valid] target_0-bias_0: 1030', '[valid] target_0-bias_1: 195', '[valid] target_1-bias_0: 841', '[valid] target_1-bias_1: 202']
get_utk_face - split: test, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_age-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [1061, 176]
Target 1: [867, 165]
Binary Target 1
---------------------------
Target 0: [1061, 176]
Target 1: [867, 165]
===================================
Normal Label Distribution: 
Target 0: [1061, 176]
Target 1: [867, 165]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 2269, target_attr: gender, bias_attr: age bias_rate: 0.9
['[test] target_0-bias_0: 1061', '[test] target_0-bias_1: 176', '[test] target_1-bias_0: 867', '[test] target_1-bias_1: 165']
decay_epochs: [6, 13]
[1 / 20] Learning rate: 0.001 weight: 0.01
[1 / 20] Loss: 4.851304844763787 CE Loss: 0.5976567737442954 Con Loss: 4.845328284577456
[1 / 20] tensor([[0.988, 1.000],
        [0.039, 0.018]]) {'epoch': 1, 'valid/acc': 54.762, 'valid/acc_unbiased': 50.594, 'valid/diff': 2.343, 'valid/acc_skew': 51.765, 'valid/acc_align': 49.422, 'test/acc': 55.575, 'test/acc_unbiased': 51.129, 'test/diff': 1.664, 'test/acc_skew': 51.961, 'test/acc_align': 50.296}
[1 / 20] best valid accuracy: 50.594 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 54.762, 'best_valid_valid/acc_unbiased': 50.594, 'best_valid_valid/diff': 2.343, 'best_valid_valid/acc_skew': 51.765, 'best_valid_valid/acc_align': 49.422, 'best_valid_test/acc': 55.575, 'best_valid_test/acc_unbiased': 51.129, 'best_valid_test/diff': 1.664, 'best_valid_test/acc_skew': 51.961, 'best_valid_test/acc_align': 50.296}
[1 / 20] best test accuracy: 51.129 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 54.762, 'best_test_valid/acc_unbiased': 50.594, 'best_test_valid/diff': 2.343, 'best_test_valid/acc_skew': 51.765, 'best_test_valid/acc_align': 49.422, 'best_test_test/acc': 55.575, 'best_test_test/acc_unbiased': 51.129, 'best_test_test/diff': 1.664, 'best_test_test/acc_skew': 51.961, 'best_test_test/acc_align': 50.296}
[2 / 20] Learning rate: 0.001 weight: 0.01
[2 / 20] Loss: 4.678762811348707 CE Loss: 0.5483233421895889 Con Loss: 4.673279584101281
[2 / 20] tensor([[0.979, 0.960],
        [0.137, 0.067]]) {'epoch': 2, 'valid/acc': 57.981, 'valid/acc_unbiased': 53.834, 'valid/diff': 2.766, 'valid/acc_skew': 55.217, 'valid/acc_align': 52.451, 'test/acc': 58.969, 'test/acc_unbiased': 53.585, 'test/diff': 4.481, 'test/acc_skew': 54.874, 'test/acc_align': 52.297}
[2 / 20] best valid accuracy: 53.834 at epoch 2 
 best_stats: {'best_valid_epoch': 2, 'best_valid_valid/acc': 57.981, 'best_valid_valid/acc_unbiased': 53.834, 'best_valid_valid/diff': 2.766, 'best_valid_valid/acc_skew': 55.217, 'best_valid_valid/acc_align': 52.451, 'best_valid_test/acc': 58.969, 'best_valid_test/acc_unbiased': 53.585, 'best_valid_test/diff': 4.481, 'best_valid_test/acc_skew': 54.874, 'best_valid_test/acc_align': 52.297}
[2 / 20] best test accuracy: 53.585 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 57.981, 'best_test_valid/acc_unbiased': 53.834, 'best_test_valid/diff': 2.766, 'best_test_valid/acc_skew': 55.217, 'best_test_valid/acc_align': 52.451, 'best_test_test/acc': 58.969, 'best_test_test/acc_unbiased': 53.585, 'best_test_test/diff': 4.481, 'best_test_test/acc_skew': 54.874, 'best_test_test/acc_align': 52.297}
[3 / 20] Learning rate: 0.001 weight: 0.01
[3 / 20] Loss: 4.640543798077468 CE Loss: 0.5371677914236155 Con Loss: 4.635172111271294
[3 / 20] tensor([[1.000, 0.989],
        [0.012, 0.042]]) {'epoch': 3, 'valid/acc': 54.321, 'valid/acc_unbiased': 50.582, 'valid/diff': 2.108, 'valid/acc_skew': 49.528, 'valid/acc_align': 51.636, 'test/acc': 55.178, 'test/acc_unbiased': 51.065, 'test/diff': 2.113, 'test/acc_skew': 50.009, 'test/acc_align': 52.121}
[3 / 20] best valid accuracy: 53.834 at epoch 2 
 best_stats: {'best_valid_epoch': 2, 'best_valid_valid/acc': 57.981, 'best_valid_valid/acc_unbiased': 53.834, 'best_valid_valid/diff': 2.766, 'best_valid_valid/acc_skew': 55.217, 'best_valid_valid/acc_align': 52.451, 'best_valid_test/acc': 58.969, 'best_valid_test/acc_unbiased': 53.585, 'best_valid_test/diff': 4.481, 'best_valid_test/acc_skew': 54.874, 'best_valid_test/acc_align': 52.297}
[3 / 20] best test accuracy: 53.585 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 57.981, 'best_test_valid/acc_unbiased': 53.834, 'best_test_valid/diff': 2.766, 'best_test_valid/acc_skew': 55.217, 'best_test_valid/acc_align': 52.451, 'best_test_test/acc': 58.969, 'best_test_test/acc_unbiased': 53.585, 'best_test_test/diff': 4.481, 'best_test_test/acc_skew': 54.874, 'best_test_test/acc_align': 52.297}
[4 / 20] Learning rate: 0.001 weight: 0.01
[4 / 20] Loss: 4.64616392471959 CE Loss: 0.5189362237155326 Con Loss: 4.6409745821565425
[4 / 20] tensor([[0.969, 0.960],
        [0.243, 0.061]]) {'epoch': 4, 'valid/acc': 60.538, 'valid/acc_unbiased': 56.378, 'valid/diff': 4.263, 'valid/acc_skew': 58.509, 'valid/acc_align': 54.246, 'test/acc': 62.494, 'test/acc_unbiased': 55.827, 'test/diff': 9.572, 'test/acc_skew': 60.18, 'test/acc_align': 51.475}
[4 / 20] best valid accuracy: 56.378 at epoch 4 
 best_stats: {'best_valid_epoch': 4, 'best_valid_valid/acc': 60.538, 'best_valid_valid/acc_unbiased': 56.378, 'best_valid_valid/diff': 4.263, 'best_valid_valid/acc_skew': 58.509, 'best_valid_valid/acc_align': 54.246, 'best_valid_test/acc': 62.494, 'best_valid_test/acc_unbiased': 55.827, 'best_valid_test/diff': 9.572, 'best_valid_test/acc_skew': 60.18, 'best_valid_test/acc_align': 51.475}
[4 / 20] best test accuracy: 55.827 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 60.538, 'best_test_valid/acc_unbiased': 56.378, 'best_test_valid/diff': 4.263, 'best_test_valid/acc_skew': 58.509, 'best_test_valid/acc_align': 54.246, 'best_test_test/acc': 62.494, 'best_test_test/acc_unbiased': 55.827, 'best_test_test/diff': 9.572, 'best_test_test/acc_skew': 60.18, 'best_test_test/acc_align': 51.475}
[5 / 20] Learning rate: 0.001 weight: 0.01
[5 / 20] Loss: 4.638562363839158 CE Loss: 0.5083023342288241 Con Loss: 4.633479364888582
[5 / 20] tensor([[0.963, 0.886],
        [0.156, 0.242]]) {'epoch': 5, 'valid/acc': 59.656, 'valid/acc_unbiased': 56.811, 'valid/diff': 6.674, 'valid/acc_skew': 53.474, 'valid/acc_align': 60.148, 'test/acc': 59.63, 'test/acc_unbiased': 56.193, 'test/diff': 8.18, 'test/acc_skew': 52.104, 'test/acc_align': 60.283}
[5 / 20] best valid accuracy: 56.811 at epoch 5 
 best_stats: {'best_valid_epoch': 5, 'best_valid_valid/acc': 59.656, 'best_valid_valid/acc_unbiased': 56.811, 'best_valid_valid/diff': 6.674, 'best_valid_valid/acc_skew': 53.474, 'best_valid_valid/acc_align': 60.148, 'best_valid_test/acc': 59.63, 'best_valid_test/acc_unbiased': 56.193, 'best_valid_test/diff': 8.18, 'best_valid_test/acc_skew': 52.104, 'best_valid_test/acc_align': 60.283}
[5 / 20] best test accuracy: 56.193 at epoch 5 
 best_stats: {'best_test_epoch': 5, 'best_test_valid/acc': 59.656, 'best_test_valid/acc_unbiased': 56.811, 'best_test_valid/diff': 6.674, 'best_test_valid/acc_skew': 53.474, 'best_test_valid/acc_align': 60.148, 'best_test_test/acc': 59.63, 'best_test_test/acc_unbiased': 56.193, 'best_test_test/diff': 8.18, 'best_test_test/acc_skew': 52.104, 'best_test_test/acc_align': 60.283}
[6 / 20] Learning rate: 0.001 weight: 0.01
[6 / 20] Loss: 4.664126490082736 CE Loss: 0.519501127048808 Con Loss: 4.658931490456465
[6 / 20] tensor([[0.926, 0.960],
        [0.361, 0.188]]) {'epoch': 6, 'valid/acc': 63.316, 'valid/acc_unbiased': 59.18, 'valid/diff': 5.733, 'valid/acc_skew': 62.046, 'valid/acc_align': 56.314, 'test/acc': 65.888, 'test/acc_unbiased': 60.867, 'test/diff': 10.391, 'test/acc_skew': 66.062, 'test/acc_align': 55.671}
[6 / 20] best valid accuracy: 59.180 at epoch 6 
 best_stats: {'best_valid_epoch': 6, 'best_valid_valid/acc': 63.316, 'best_valid_valid/acc_unbiased': 59.18, 'best_valid_valid/diff': 5.733, 'best_valid_valid/acc_skew': 62.046, 'best_valid_valid/acc_align': 56.314, 'best_valid_test/acc': 65.888, 'best_valid_test/acc_unbiased': 60.867, 'best_valid_test/diff': 10.391, 'best_valid_test/acc_skew': 66.062, 'best_valid_test/acc_align': 55.671}
[6 / 20] best test accuracy: 60.867 at epoch 6 
 best_stats: {'best_test_epoch': 6, 'best_test_valid/acc': 63.316, 'best_test_valid/acc_unbiased': 59.18, 'best_test_valid/diff': 5.733, 'best_test_valid/acc_skew': 62.046, 'best_test_valid/acc_align': 56.314, 'best_test_test/acc': 65.888, 'best_test_test/acc_unbiased': 60.867, 'best_test_test/diff': 10.391, 'best_test_test/acc_skew': 66.062, 'best_test_test/acc_align': 55.671}
[7 / 20] Learning rate: 0.0001 weight: 0.01
[7 / 20] Loss: 4.602772536325973 CE Loss: 0.5172294822358674 Con Loss: 4.597600230649364
[7 / 20] tensor([[0.971, 0.983],
        [0.219, 0.145]]) {'epoch': 7, 'valid/acc': 61.905, 'valid/acc_unbiased': 58.451, 'valid/diff': 1.167, 'valid/acc_skew': 58.806, 'valid/acc_align': 58.095, 'test/acc': 62.45, 'test/acc_unbiased': 57.958, 'test/diff': 4.293, 'test/acc_skew': 60.105, 'test/acc_align': 55.812}
[7 / 20] best valid accuracy: 59.180 at epoch 6 
 best_stats: {'best_valid_epoch': 6, 'best_valid_valid/acc': 63.316, 'best_valid_valid/acc_unbiased': 59.18, 'best_valid_valid/diff': 5.733, 'best_valid_valid/acc_skew': 62.046, 'best_valid_valid/acc_align': 56.314, 'best_valid_test/acc': 65.888, 'best_valid_test/acc_unbiased': 60.867, 'best_valid_test/diff': 10.391, 'best_valid_test/acc_skew': 66.062, 'best_valid_test/acc_align': 55.671}
[7 / 20] best test accuracy: 60.867 at epoch 6 
 best_stats: {'best_test_epoch': 6, 'best_test_valid/acc': 63.316, 'best_test_valid/acc_unbiased': 59.18, 'best_test_valid/diff': 5.733, 'best_test_valid/acc_skew': 62.046, 'best_test_valid/acc_align': 56.314, 'best_test_test/acc': 65.888, 'best_test_test/acc_unbiased': 60.867, 'best_test_test/diff': 10.391, 'best_test_test/acc_skew': 66.062, 'best_test_test/acc_align': 55.671}
[8 / 20] Learning rate: 0.0001 weight: 0.01
[8 / 20] Loss: 4.567007248341836 CE Loss: 0.502860017748461 Con Loss: 4.561978642389775
[8 / 20] tensor([[0.959, 0.960],
        [0.266, 0.218]]) {'epoch': 8, 'valid/acc': 63.624, 'valid/acc_unbiased': 61.194, 'valid/diff': 1.558, 'valid/acc_skew': 60.415, 'valid/acc_align': 61.973, 'test/acc': 64.037, 'test/acc_unbiased': 60.084, 'test/diff': 2.498, 'test/acc_skew': 61.333, 'test/acc_align': 58.836}
[8 / 20] best valid accuracy: 61.194 at epoch 8 
 best_stats: {'best_valid_epoch': 8, 'best_valid_valid/acc': 63.624, 'best_valid_valid/acc_unbiased': 61.194, 'best_valid_valid/diff': 1.558, 'best_valid_valid/acc_skew': 60.415, 'best_valid_valid/acc_align': 61.973, 'best_valid_test/acc': 64.037, 'best_valid_test/acc_unbiased': 60.084, 'best_valid_test/diff': 2.498, 'best_valid_test/acc_skew': 61.333, 'best_valid_test/acc_align': 58.836}
[8 / 20] best test accuracy: 60.867 at epoch 6 
 best_stats: {'best_test_epoch': 6, 'best_test_valid/acc': 63.316, 'best_test_valid/acc_unbiased': 59.18, 'best_test_valid/diff': 5.733, 'best_test_valid/acc_skew': 62.046, 'best_test_valid/acc_align': 56.314, 'best_test_test/acc': 65.888, 'best_test_test/acc_unbiased': 60.867, 'best_test_test/diff': 10.391, 'best_test_test/acc_skew': 66.062, 'best_test_test/acc_align': 55.671}
[9 / 20] Learning rate: 0.0001 weight: 0.01
[9 / 20] Loss: 4.539445540022198 CE Loss: 0.49514177209516 Con Loss: 4.534494136166189
[9 / 20] tensor([[0.956, 0.909],
        [0.295, 0.321]]) {'epoch': 9, 'valid/acc': 65.917, 'valid/acc_unbiased': 62.89, 'valid/diff': 4.407, 'valid/acc_skew': 60.686, 'valid/acc_align': 65.094, 'test/acc': 65.359, 'test/acc_unbiased': 62.032, 'test/diff': 3.628, 'test/acc_skew': 60.218, 'test/acc_align': 63.846}
[9 / 20] best valid accuracy: 62.890 at epoch 9 
 best_stats: {'best_valid_epoch': 9, 'best_valid_valid/acc': 65.917, 'best_valid_valid/acc_unbiased': 62.89, 'best_valid_valid/diff': 4.407, 'best_valid_valid/acc_skew': 60.686, 'best_valid_valid/acc_align': 65.094, 'best_valid_test/acc': 65.359, 'best_valid_test/acc_unbiased': 62.032, 'best_valid_test/diff': 3.628, 'best_valid_test/acc_skew': 60.218, 'best_valid_test/acc_align': 63.846}
[9 / 20] best test accuracy: 62.032 at epoch 9 
 best_stats: {'best_test_epoch': 9, 'best_test_valid/acc': 65.917, 'best_test_valid/acc_unbiased': 62.89, 'best_test_valid/diff': 4.407, 'best_test_valid/acc_skew': 60.686, 'best_test_valid/acc_align': 65.094, 'best_test_test/acc': 65.359, 'best_test_test/acc_unbiased': 62.032, 'best_test_test/diff': 3.628, 'best_test_test/acc_skew': 60.218, 'best_test_test/acc_align': 63.846}
[10 / 20] Learning rate: 0.0001 weight: 0.01
[10 / 20] Loss: 4.5319673296486735 CE Loss: 0.48641630582084644 Con Loss: 4.527103145575086
[10 / 20] tensor([[0.967, 0.920],
        [0.256, 0.297]]) {'epoch': 10, 'valid/acc': 64.242, 'valid/acc_unbiased': 62.161, 'valid/diff': 7.914, 'valid/acc_skew': 58.204, 'valid/acc_align': 66.118, 'test/acc': 64.301, 'test/acc_unbiased': 61.012, 'test/diff': 4.374, 'test/acc_skew': 58.825, 'test/acc_align': 63.199}
[10 / 20] best valid accuracy: 62.890 at epoch 9 
 best_stats: {'best_valid_epoch': 9, 'best_valid_valid/acc': 65.917, 'best_valid_valid/acc_unbiased': 62.89, 'best_valid_valid/diff': 4.407, 'best_valid_valid/acc_skew': 60.686, 'best_valid_valid/acc_align': 65.094, 'best_valid_test/acc': 65.359, 'best_valid_test/acc_unbiased': 62.032, 'best_valid_test/diff': 3.628, 'best_valid_test/acc_skew': 60.218, 'best_valid_test/acc_align': 63.846}
[10 / 20] best test accuracy: 62.032 at epoch 9 
 best_stats: {'best_test_epoch': 9, 'best_test_valid/acc': 65.917, 'best_test_valid/acc_unbiased': 62.89, 'best_test_valid/diff': 4.407, 'best_test_valid/acc_skew': 60.686, 'best_test_valid/acc_align': 65.094, 'best_test_test/acc': 65.359, 'best_test_test/acc_unbiased': 62.032, 'best_test_test/diff': 3.628, 'best_test_test/acc_skew': 60.218, 'best_test_test/acc_align': 63.846}
[11 / 20] Learning rate: 0.0001 weight: 0.01
[11 / 20] Loss: 4.519707116148794 CE Loss: 0.4758379941395453 Con Loss: 4.51494874904237
[11 / 20] tensor([[0.936, 0.801],
        [0.339, 0.436]]) {'epoch': 11, 'valid/acc': 66.534, 'valid/acc_unbiased': 64.202, 'valid/diff': 12.421, 'valid/acc_skew': 57.992, 'valid/acc_align': 70.413, 'test/acc': 66.108, 'test/acc_unbiased': 62.813, 'test/diff': 11.602, 'test/acc_skew': 57.012, 'test/acc_align': 68.614}
[11 / 20] best valid accuracy: 64.202 at epoch 11 
 best_stats: {'best_valid_epoch': 11, 'best_valid_valid/acc': 66.534, 'best_valid_valid/acc_unbiased': 64.202, 'best_valid_valid/diff': 12.421, 'best_valid_valid/acc_skew': 57.992, 'best_valid_valid/acc_align': 70.413, 'best_valid_test/acc': 66.108, 'best_valid_test/acc_unbiased': 62.813, 'best_valid_test/diff': 11.602, 'best_valid_test/acc_skew': 57.012, 'best_valid_test/acc_align': 68.614}
[11 / 20] best test accuracy: 62.813 at epoch 11 
 best_stats: {'best_test_epoch': 11, 'best_test_valid/acc': 66.534, 'best_test_valid/acc_unbiased': 64.202, 'best_test_valid/diff': 12.421, 'best_test_valid/acc_skew': 57.992, 'best_test_valid/acc_align': 70.413, 'best_test_test/acc': 66.108, 'best_test_test/acc_unbiased': 62.813, 'best_test_test/diff': 11.602, 'best_test_test/acc_skew': 57.012, 'best_test_test/acc_align': 68.614}
[12 / 20] Learning rate: 0.0001 weight: 0.01
[12 / 20] Loss: 4.46946121984901 CE Loss: 0.4699110624072526 Con Loss: 4.464762113907506
[12 / 20] tensor([[0.966, 0.869],
        [0.281, 0.370]]) {'epoch': 12, 'valid/acc': 65.653, 'valid/acc_unbiased': 63.383, 'valid/diff': 11.324, 'valid/acc_skew': 57.721, 'valid/acc_align': 69.045, 'test/acc': 65.359, 'test/acc_unbiased': 62.163, 'test/diff': 9.251, 'test/acc_skew': 57.537, 'test/acc_align': 66.788}
[12 / 20] best valid accuracy: 64.202 at epoch 11 
 best_stats: {'best_valid_epoch': 11, 'best_valid_valid/acc': 66.534, 'best_valid_valid/acc_unbiased': 64.202, 'best_valid_valid/diff': 12.421, 'best_valid_valid/acc_skew': 57.992, 'best_valid_valid/acc_align': 70.413, 'best_valid_test/acc': 66.108, 'best_valid_test/acc_unbiased': 62.813, 'best_valid_test/diff': 11.602, 'best_valid_test/acc_skew': 57.012, 'best_valid_test/acc_align': 68.614}
[12 / 20] best test accuracy: 62.813 at epoch 11 
 best_stats: {'best_test_epoch': 11, 'best_test_valid/acc': 66.534, 'best_test_valid/acc_unbiased': 64.202, 'best_test_valid/diff': 12.421, 'best_test_valid/acc_skew': 57.992, 'best_test_valid/acc_align': 70.413, 'best_test_test/acc': 66.108, 'best_test_test/acc_unbiased': 62.813, 'best_test_test/diff': 11.602, 'best_test_test/acc_skew': 57.012, 'best_test_test/acc_align': 68.614}
[13 / 20] Learning rate: 0.0001 weight: 0.01
[13 / 20] Loss: 4.504780668839227 CE Loss: 0.46044933364124435 Con Loss: 4.500176190526599
[13 / 20] tensor([[0.971, 0.830],
        [0.287, 0.406]]) {'epoch': 13, 'valid/acc': 66.093, 'valid/acc_unbiased': 63.82, 'valid/diff': 14.799, 'valid/acc_skew': 56.42, 'valid/acc_align': 71.219, 'test/acc': 65.756, 'test/acc_unbiased': 62.34, 'test/diff': 13.005, 'test/acc_skew': 55.837, 'test/acc_align': 68.842}
[13 / 20] best valid accuracy: 64.202 at epoch 11 
 best_stats: {'best_valid_epoch': 11, 'best_valid_valid/acc': 66.534, 'best_valid_valid/acc_unbiased': 64.202, 'best_valid_valid/diff': 12.421, 'best_valid_valid/acc_skew': 57.992, 'best_valid_valid/acc_align': 70.413, 'best_valid_test/acc': 66.108, 'best_valid_test/acc_unbiased': 62.813, 'best_valid_test/diff': 11.602, 'best_valid_test/acc_skew': 57.012, 'best_valid_test/acc_align': 68.614}
[13 / 20] best test accuracy: 62.813 at epoch 11 
 best_stats: {'best_test_epoch': 11, 'best_test_valid/acc': 66.534, 'best_test_valid/acc_unbiased': 64.202, 'best_test_valid/diff': 12.421, 'best_test_valid/acc_skew': 57.992, 'best_test_valid/acc_align': 70.413, 'best_test_test/acc': 66.108, 'best_test_test/acc_unbiased': 62.813, 'best_test_test/diff': 11.602, 'best_test_test/acc_skew': 57.012, 'best_test_test/acc_align': 68.614}
[14 / 20] Learning rate: 1e-05 weight: 0.01
[14 / 20] Loss: 4.462749462991741 CE Loss: 0.4663685770772986 Con Loss: 4.458085787782773
[14 / 20] tensor([[0.963, 0.812],
        [0.326, 0.442]]) {'epoch': 14, 'valid/acc': 66.623, 'valid/acc_unbiased': 64.174, 'valid/diff': 15.381, 'valid/acc_skew': 56.483, 'valid/acc_align': 71.864, 'test/acc': 67.034, 'test/acc_unbiased': 63.614, 'test/diff': 13.338, 'test/acc_skew': 56.946, 'test/acc_align': 70.283}
[14 / 20] best valid accuracy: 64.202 at epoch 11 
 best_stats: {'best_valid_epoch': 11, 'best_valid_valid/acc': 66.534, 'best_valid_valid/acc_unbiased': 64.202, 'best_valid_valid/diff': 12.421, 'best_valid_valid/acc_skew': 57.992, 'best_valid_valid/acc_align': 70.413, 'best_valid_test/acc': 66.108, 'best_valid_test/acc_unbiased': 62.813, 'best_valid_test/diff': 11.602, 'best_valid_test/acc_skew': 57.012, 'best_valid_test/acc_align': 68.614}
[14 / 20] best test accuracy: 63.614 at epoch 14 
 best_stats: {'best_test_epoch': 14, 'best_test_valid/acc': 66.623, 'best_test_valid/acc_unbiased': 64.174, 'best_test_valid/diff': 15.381, 'best_test_valid/acc_skew': 56.483, 'best_test_valid/acc_align': 71.864, 'best_test_test/acc': 67.034, 'best_test_test/acc_unbiased': 63.614, 'best_test_test/diff': 13.338, 'best_test_test/acc_skew': 56.946, 'best_test_test/acc_align': 70.283}
[15 / 20] Learning rate: 1e-05 weight: 0.01
[15 / 20] Loss: 4.4666070466807435 CE Loss: 0.4597477038247627 Con Loss: 4.462009568109087
[15 / 20] tensor([[0.964, 0.790],
        [0.318, 0.442]]) {'epoch': 15, 'valid/acc': 66.446, 'valid/acc_unbiased': 64.266, 'valid/diff': 16.197, 'valid/acc_skew': 56.168, 'valid/acc_align': 72.364, 'test/acc': 66.593, 'test/acc_unbiased': 62.868, 'test/diff': 14.925, 'test/acc_skew': 55.406, 'test/acc_align': 70.33}
[15 / 20] best valid accuracy: 64.266 at epoch 15 
 best_stats: {'best_valid_epoch': 15, 'best_valid_valid/acc': 66.446, 'best_valid_valid/acc_unbiased': 64.266, 'best_valid_valid/diff': 16.197, 'best_valid_valid/acc_skew': 56.168, 'best_valid_valid/acc_align': 72.364, 'best_valid_test/acc': 66.593, 'best_valid_test/acc_unbiased': 62.868, 'best_valid_test/diff': 14.925, 'best_valid_test/acc_skew': 55.406, 'best_valid_test/acc_align': 70.33}
[15 / 20] best test accuracy: 63.614 at epoch 14 
 best_stats: {'best_test_epoch': 14, 'best_test_valid/acc': 66.623, 'best_test_valid/acc_unbiased': 64.174, 'best_test_valid/diff': 15.381, 'best_test_valid/acc_skew': 56.483, 'best_test_valid/acc_align': 71.864, 'best_test_test/acc': 67.034, 'best_test_test/acc_unbiased': 63.614, 'best_test_test/diff': 13.338, 'best_test_test/acc_skew': 56.946, 'best_test_test/acc_align': 70.283}
[16 / 20] Learning rate: 1e-05 weight: 0.01
[16 / 20] Loss: 4.452469889656161 CE Loss: 0.45616407610423015 Con Loss: 4.447908241174856
[16 / 20] tensor([[0.970, 0.801],
        [0.307, 0.436]]) {'epoch': 16, 'valid/acc': 66.49, 'valid/acc_unbiased': 64.261, 'valid/diff': 15.993, 'valid/acc_skew': 56.264, 'valid/acc_align': 72.258, 'test/acc': 66.461, 'test/acc_unbiased': 62.854, 'test/diff': 14.913, 'test/acc_skew': 55.397, 'test/acc_align': 70.31}
[16 / 20] best valid accuracy: 64.266 at epoch 15 
 best_stats: {'best_valid_epoch': 15, 'best_valid_valid/acc': 66.446, 'best_valid_valid/acc_unbiased': 64.266, 'best_valid_valid/diff': 16.197, 'best_valid_valid/acc_skew': 56.168, 'best_valid_valid/acc_align': 72.364, 'best_valid_test/acc': 66.593, 'best_valid_test/acc_unbiased': 62.868, 'best_valid_test/diff': 14.925, 'best_valid_test/acc_skew': 55.406, 'best_valid_test/acc_align': 70.33}
[16 / 20] best test accuracy: 63.614 at epoch 14 
 best_stats: {'best_test_epoch': 14, 'best_test_valid/acc': 66.623, 'best_test_valid/acc_unbiased': 64.174, 'best_test_valid/diff': 15.381, 'best_test_valid/acc_skew': 56.483, 'best_test_valid/acc_align': 71.864, 'best_test_test/acc': 67.034, 'best_test_test/acc_unbiased': 63.614, 'best_test_test/diff': 13.338, 'best_test_test/acc_skew': 56.946, 'best_test_test/acc_align': 70.283}
[17 / 20] Learning rate: 1e-05 weight: 0.01
[17 / 20] Loss: 4.379253966582486 CE Loss: 0.4624175994372109 Con Loss: 4.374629795841401
[17 / 20] tensor([[0.970, 0.824],
        [0.290, 0.418]]) {'epoch': 17, 'valid/acc': 65.917, 'valid/acc_unbiased': 63.382, 'valid/diff': 15.663, 'valid/acc_skew': 55.551, 'valid/acc_align': 71.214, 'test/acc': 65.844, 'test/acc_unbiased': 62.535, 'test/diff': 13.733, 'test/acc_skew': 55.668, 'test/acc_align': 69.401}
[17 / 20] best valid accuracy: 64.266 at epoch 15 
 best_stats: {'best_valid_epoch': 15, 'best_valid_valid/acc': 66.446, 'best_valid_valid/acc_unbiased': 64.266, 'best_valid_valid/diff': 16.197, 'best_valid_valid/acc_skew': 56.168, 'best_valid_valid/acc_align': 72.364, 'best_valid_test/acc': 66.593, 'best_valid_test/acc_unbiased': 62.868, 'best_valid_test/diff': 14.925, 'best_valid_test/acc_skew': 55.406, 'best_valid_test/acc_align': 70.33}
[17 / 20] best test accuracy: 63.614 at epoch 14 
 best_stats: {'best_test_epoch': 14, 'best_test_valid/acc': 66.623, 'best_test_valid/acc_unbiased': 64.174, 'best_test_valid/diff': 15.381, 'best_test_valid/acc_skew': 56.483, 'best_test_valid/acc_align': 71.864, 'best_test_test/acc': 67.034, 'best_test_test/acc_unbiased': 63.614, 'best_test_test/diff': 13.338, 'best_test_test/acc_skew': 56.946, 'best_test_test/acc_align': 70.283}
[18 / 20] Learning rate: 1e-05 weight: 0.01
[18 / 20] Loss: 4.444903146457422 CE Loss: 0.4543790048269331 Con Loss: 4.440359369282953
[18 / 20] tensor([[0.972, 0.812],
        [0.290, 0.430]]) {'epoch': 18, 'valid/acc': 66.446, 'valid/acc_unbiased': 64.323, 'valid/diff': 15.568, 'valid/acc_skew': 56.539, 'valid/acc_align': 72.107, 'test/acc': 65.932, 'test/acc_unbiased': 62.601, 'test/diff': 15.001, 'test/acc_skew': 55.1, 'test/acc_align': 70.101}
[18 / 20] best valid accuracy: 64.323 at epoch 18 
 best_stats: {'best_valid_epoch': 18, 'best_valid_valid/acc': 66.446, 'best_valid_valid/acc_unbiased': 64.323, 'best_valid_valid/diff': 15.568, 'best_valid_valid/acc_skew': 56.539, 'best_valid_valid/acc_align': 72.107, 'best_valid_test/acc': 65.932, 'best_valid_test/acc_unbiased': 62.601, 'best_valid_test/diff': 15.001, 'best_valid_test/acc_skew': 55.1, 'best_valid_test/acc_align': 70.101}
[18 / 20] best test accuracy: 63.614 at epoch 14 
 best_stats: {'best_test_epoch': 14, 'best_test_valid/acc': 66.623, 'best_test_valid/acc_unbiased': 64.174, 'best_test_valid/diff': 15.381, 'best_test_valid/acc_skew': 56.483, 'best_test_valid/acc_align': 71.864, 'best_test_test/acc': 67.034, 'best_test_test/acc_unbiased': 63.614, 'best_test_test/diff': 13.338, 'best_test_test/acc_skew': 56.946, 'best_test_test/acc_align': 70.283}
[19 / 20] Learning rate: 1e-05 weight: 0.01
[19 / 20] Loss: 4.4436709017666125 CE Loss: 0.4549747034656292 Con Loss: 4.439121168144451
[19 / 20] tensor([[0.971, 0.824],
        [0.292, 0.406]]) {'epoch': 19, 'valid/acc': 66.446, 'valid/acc_unbiased': 64.223, 'valid/diff': 14.973, 'valid/acc_skew': 56.736, 'valid/acc_align': 71.709, 'test/acc': 65.888, 'test/acc_unbiased': 62.313, 'test/diff': 13.058, 'test/acc_skew': 55.784, 'test/acc_align': 68.842}
[19 / 20] best valid accuracy: 64.323 at epoch 18 
 best_stats: {'best_valid_epoch': 18, 'best_valid_valid/acc': 66.446, 'best_valid_valid/acc_unbiased': 64.323, 'best_valid_valid/diff': 15.568, 'best_valid_valid/acc_skew': 56.539, 'best_valid_valid/acc_align': 72.107, 'best_valid_test/acc': 65.932, 'best_valid_test/acc_unbiased': 62.601, 'best_valid_test/diff': 15.001, 'best_valid_test/acc_skew': 55.1, 'best_valid_test/acc_align': 70.101}
[19 / 20] best test accuracy: 63.614 at epoch 14 
 best_stats: {'best_test_epoch': 14, 'best_test_valid/acc': 66.623, 'best_test_valid/acc_unbiased': 64.174, 'best_test_valid/diff': 15.381, 'best_test_valid/acc_skew': 56.483, 'best_test_valid/acc_align': 71.864, 'best_test_test/acc': 67.034, 'best_test_test/acc_unbiased': 63.614, 'best_test_test/diff': 13.338, 'best_test_test/acc_skew': 56.946, 'best_test_test/acc_align': 70.283}
[20 / 20] Learning rate: 1e-05 weight: 0.01
[20 / 20] Loss: 4.4318403139046545 CE Loss: 0.4493208756744973 Con Loss: 4.427347106819338
[20 / 20] tensor([[0.965, 0.795],
        [0.318, 0.455]]) {'epoch': 20, 'valid/acc': 66.711, 'valid/acc_unbiased': 64.245, 'valid/diff': 15.442, 'valid/acc_skew': 56.524, 'valid/acc_align': 71.966, 'test/acc': 66.77, 'test/acc_unbiased': 63.337, 'test/diff': 15.294, 'test/acc_skew': 55.69, 'test/acc_align': 70.984}
[20 / 20] best valid accuracy: 64.323 at epoch 18 
 best_stats: {'best_valid_epoch': 18, 'best_valid_valid/acc': 66.446, 'best_valid_valid/acc_unbiased': 64.323, 'best_valid_valid/diff': 15.568, 'best_valid_valid/acc_skew': 56.539, 'best_valid_valid/acc_align': 72.107, 'best_valid_test/acc': 65.932, 'best_valid_test/acc_unbiased': 62.601, 'best_valid_test/diff': 15.001, 'best_valid_test/acc_skew': 55.1, 'best_valid_test/acc_align': 70.101}
[20 / 20] best test accuracy: 63.614 at epoch 14 
 best_stats: {'best_test_epoch': 14, 'best_test_valid/acc': 66.623, 'best_test_valid/acc_unbiased': 64.174, 'best_test_valid/diff': 15.381, 'best_test_valid/acc_skew': 56.483, 'best_test_valid/acc_align': 71.864, 'best_test_test/acc': 67.034, 'best_test_test/acc_unbiased': 63.614, 'best_test_test/diff': 13.338, 'best_test_test/acc_skew': 56.946, 'best_test_test/acc_align': 70.283}
Total training time: 0:15:09
