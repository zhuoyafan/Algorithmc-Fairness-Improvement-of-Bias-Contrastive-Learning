Log level set to: INFO
Set seed: 3
=======> Using Fixed Random Seed: 3 <========
save_path: exp_results/bc-bb0-utk_face_race-cutout_rotate-0.9-lr0.001-bs128-cbs64-w0.01-ratio10-aug1-seed3
get_utk_face - split: train, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_race-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [4407, 552]
Target 1: [440, 5529]
Binary Target 1
---------------------------
Target 0: [4407, 552]
Target 1: [440, 5529]
===================================
Normal Label Distribution: 
Target 0: [4407, 552]
Target 1: [440, 5529]
===================================
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [4407, 552]
Target 1: [440, 5529]
Binary Target 1
---------------------------
Target 0: [4407, 552]
Target 1: [440, 5529]
===================================
Normal Label Distribution: 
Target 0: [4407, 552]
Target 1: [440, 5529]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 10928, target_attr: gender, bias_attr: race bias_rate: 0.9
['[train] target_0-bias_0: 4407', '[train] target_0-bias_1: 552', '[train] target_1-bias_0: 440', '[train] target_1-bias_1: 5529']
confusion_matrix - 
 original: tensor([[4407.,  440.],
        [ 552., 5529.]]), 
 normalized: tensor([[0.909, 0.091],
        [0.091, 0.909]]), 
 b|y: tensor([[0.889, 0.111],
        [0.074, 0.926]])
get_utk_face - split: train, aug: 1, given_y: True, ratio: 10
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_race-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [4407, 552]
Target 1: [440, 5529]
Binary Target 1
---------------------------
Target 0: [4407, 552]
Target 1: [440, 5529]
===================================
Normal Label Distribution: 
Target 0: [4407, 552]
Target 1: [440, 5529]
===================================
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [4407, 552]
Target 1: [440, 5529]
Binary Target 1
---------------------------
Target 0: [4407, 552]
Target 1: [440, 5529]
===================================
Normal Label Distribution: 
Target 0: [4407, 552]
Target 1: [440, 5529]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 10928, target_attr: gender, bias_attr: race bias_rate: 0.9
['[train] target_0-bias_0: 4407', '[train] target_0-bias_1: 552', '[train] target_1-bias_0: 440', '[train] target_1-bias_1: 5529']
get_utk_face - split: valid, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_race-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [583, 684]
Target 1: [457, 646]
Binary Target 1
---------------------------
Target 0: [583, 684]
Target 1: [457, 646]
===================================
Normal Label Distribution: 
Target 0: [583, 684]
Target 1: [457, 646]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 2370, target_attr: gender, bias_attr: race bias_rate: 0.9
['[valid] target_0-bias_0: 583', '[valid] target_0-bias_1: 684', '[valid] target_1-bias_0: 457', '[valid] target_1-bias_1: 646']
get_utk_face - split: test, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_race-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [558, 677]
Target 1: [462, 673]
Binary Target 1
---------------------------
Target 0: [558, 677]
Target 1: [462, 673]
===================================
Normal Label Distribution: 
Target 0: [558, 677]
Target 1: [462, 673]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 2370, target_attr: gender, bias_attr: race bias_rate: 0.9
['[test] target_0-bias_0: 558', '[test] target_0-bias_1: 677', '[test] target_1-bias_0: 462', '[test] target_1-bias_1: 673']
decay_epochs: [6, 13]
[1 / 20] Learning rate: 0.001 weight: 0.01
[1 / 20] Loss: 4.911479043052975 CE Loss: 0.6501725035041876 Con Loss: 4.9049773139450945
[1 / 20] tensor([[0.738, 0.660],
        [0.755, 0.740]]) {'epoch': 1, 'valid/acc': 71.519, 'valid/acc_unbiased': 71.532, 'valid/diff': 3.163, 'valid/acc_skew': 69.951, 'valid/acc_align': 73.114, 'test/acc': 71.983, 'test/acc_unbiased': 72.35, 'test/diff': 4.676, 'test/acc_skew': 70.784, 'test/acc_align': 73.916}
[1 / 20] best valid accuracy: 71.532 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 71.519, 'best_valid_valid/acc_unbiased': 71.532, 'best_valid_valid/diff': 3.163, 'best_valid_valid/acc_skew': 69.951, 'best_valid_valid/acc_align': 73.114, 'best_valid_test/acc': 71.983, 'best_valid_test/acc_unbiased': 72.35, 'best_valid_test/diff': 4.676, 'best_valid_test/acc_skew': 70.784, 'best_valid_test/acc_align': 73.916}
[1 / 20] best test accuracy: 72.350 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 71.519, 'best_test_valid/acc_unbiased': 71.532, 'best_test_valid/diff': 3.163, 'best_test_valid/acc_skew': 69.951, 'best_test_valid/acc_align': 73.114, 'best_test_test/acc': 71.983, 'best_test_test/acc_unbiased': 72.35, 'best_test_test/diff': 4.676, 'best_test_test/acc_skew': 70.784, 'best_test_test/acc_align': 73.916}
[2 / 20] Learning rate: 0.001 weight: 0.01
[2 / 20] Loss: 4.819748479834762 CE Loss: 0.5843922635472187 Con Loss: 4.8139045667857765
[2 / 20] tensor([[0.792, 0.742],
        [0.656, 0.669]]) {'epoch': 2, 'valid/acc': 72.152, 'valid/acc_unbiased': 71.821, 'valid/diff': 3.802, 'valid/acc_skew': 69.92, 'valid/acc_align': 73.722, 'test/acc': 71.603, 'test/acc_unbiased': 71.453, 'test/diff': 3.171, 'test/acc_skew': 69.868, 'test/acc_align': 73.038}
[2 / 20] best valid accuracy: 71.821 at epoch 2 
 best_stats: {'best_valid_epoch': 2, 'best_valid_valid/acc': 72.152, 'best_valid_valid/acc_unbiased': 71.821, 'best_valid_valid/diff': 3.802, 'best_valid_valid/acc_skew': 69.92, 'best_valid_valid/acc_align': 73.722, 'best_valid_test/acc': 71.603, 'best_valid_test/acc_unbiased': 71.453, 'best_valid_test/diff': 3.171, 'best_valid_test/acc_skew': 69.868, 'best_valid_test/acc_align': 73.038}
[2 / 20] best test accuracy: 72.350 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 71.519, 'best_test_valid/acc_unbiased': 71.532, 'best_test_valid/diff': 3.163, 'best_test_valid/acc_skew': 69.951, 'best_test_valid/acc_align': 73.114, 'best_test_test/acc': 71.983, 'best_test_test/acc_unbiased': 72.35, 'best_test_test/diff': 4.676, 'best_test_test/acc_skew': 70.784, 'best_test_test/acc_align': 73.916}
[3 / 20] Learning rate: 0.001 weight: 0.01
[3 / 20] Loss: 4.80815217575252 CE Loss: 0.5809325465433419 Con Loss: 4.802342829557673
[3 / 20] tensor([[0.643, 0.677],
        [0.807, 0.819]]) {'epoch': 3, 'valid/acc': 73.587, 'valid/acc_unbiased': 73.853, 'valid/diff': 5.261, 'valid/acc_skew': 76.484, 'valid/acc_align': 71.223, 'test/acc': 73.46, 'test/acc_unbiased': 73.649, 'test/diff': 2.225, 'test/acc_skew': 74.194, 'test/acc_align': 73.105}
[3 / 20] best valid accuracy: 73.853 at epoch 3 
 best_stats: {'best_valid_epoch': 3, 'best_valid_valid/acc': 73.587, 'best_valid_valid/acc_unbiased': 73.853, 'best_valid_valid/diff': 5.261, 'best_valid_valid/acc_skew': 76.484, 'best_valid_valid/acc_align': 71.223, 'best_valid_test/acc': 73.46, 'best_valid_test/acc_unbiased': 73.649, 'best_valid_test/diff': 2.225, 'best_valid_test/acc_skew': 74.194, 'best_valid_test/acc_align': 73.105}
[3 / 20] best test accuracy: 73.649 at epoch 3 
 best_stats: {'best_test_epoch': 3, 'best_test_valid/acc': 73.587, 'best_test_valid/acc_unbiased': 73.853, 'best_test_valid/diff': 5.261, 'best_test_valid/acc_skew': 76.484, 'best_test_valid/acc_align': 71.223, 'best_test_test/acc': 73.46, 'best_test_test/acc_unbiased': 73.649, 'best_test_test/diff': 2.225, 'best_test_test/acc_skew': 74.194, 'best_test_test/acc_align': 73.105}
[4 / 20] Learning rate: 0.001 weight: 0.01
[4 / 20] Loss: 4.799381413187499 CE Loss: 0.5712270636335124 Con Loss: 4.793669151875844
[4 / 20] tensor([[0.806, 0.767],
        [0.613, 0.689]]) {'epoch': 4, 'valid/acc': 73.291, 'valid/acc_unbiased': 72.674, 'valid/diff': 2.578, 'valid/acc_skew': 71.384, 'valid/acc_align': 73.963, 'test/acc': 72.405, 'test/acc_unbiased': 71.877, 'test/diff': 5.837, 'test/acc_skew': 68.959, 'test/acc_align': 74.795}
[4 / 20] best valid accuracy: 73.853 at epoch 3 
 best_stats: {'best_valid_epoch': 3, 'best_valid_valid/acc': 73.587, 'best_valid_valid/acc_unbiased': 73.853, 'best_valid_valid/diff': 5.261, 'best_valid_valid/acc_skew': 76.484, 'best_valid_valid/acc_align': 71.223, 'best_valid_test/acc': 73.46, 'best_valid_test/acc_unbiased': 73.649, 'best_valid_test/diff': 2.225, 'best_valid_test/acc_skew': 74.194, 'best_valid_test/acc_align': 73.105}
[4 / 20] best test accuracy: 73.649 at epoch 3 
 best_stats: {'best_test_epoch': 3, 'best_test_valid/acc': 73.587, 'best_test_valid/acc_unbiased': 73.853, 'best_test_valid/diff': 5.261, 'best_test_valid/acc_skew': 76.484, 'best_test_valid/acc_align': 71.223, 'best_test_test/acc': 73.46, 'best_test_test/acc_unbiased': 73.649, 'best_test_test/diff': 2.225, 'best_test_test/acc_skew': 74.194, 'best_test_test/acc_align': 73.105}
[5 / 20] Learning rate: 0.001 weight: 0.01
[5 / 20] Loss: 4.776364535224211 CE Loss: 0.5558112871070906 Con Loss: 4.770806396339159
[5 / 20] tensor([[0.213, 0.195],
        [0.974, 0.987]]) {'epoch': 5, 'valid/acc': 55.612, 'valid/acc_unbiased': 58.262, 'valid/diff': 2.121, 'valid/acc_skew': 58.738, 'valid/acc_align': 57.786, 'test/acc': 57.595, 'test/acc_unbiased': 59.222, 'test/diff': 1.544, 'test/acc_skew': 58.45, 'test/acc_align': 59.994}
[5 / 20] best valid accuracy: 73.853 at epoch 3 
 best_stats: {'best_valid_epoch': 3, 'best_valid_valid/acc': 73.587, 'best_valid_valid/acc_unbiased': 73.853, 'best_valid_valid/diff': 5.261, 'best_valid_valid/acc_skew': 76.484, 'best_valid_valid/acc_align': 71.223, 'best_valid_test/acc': 73.46, 'best_valid_test/acc_unbiased': 73.649, 'best_valid_test/diff': 2.225, 'best_valid_test/acc_skew': 74.194, 'best_valid_test/acc_align': 73.105}
[5 / 20] best test accuracy: 73.649 at epoch 3 
 best_stats: {'best_test_epoch': 3, 'best_test_valid/acc': 73.587, 'best_test_valid/acc_unbiased': 73.853, 'best_test_valid/diff': 5.261, 'best_test_valid/acc_skew': 76.484, 'best_test_valid/acc_align': 71.223, 'best_test_test/acc': 73.46, 'best_test_test/acc_unbiased': 73.649, 'best_test_test/diff': 2.225, 'best_test_test/acc_skew': 74.194, 'best_test_test/acc_align': 73.105}
[6 / 20] Learning rate: 0.001 weight: 0.01
[6 / 20] Loss: 4.772865454588593 CE Loss: 0.5704814654667242 Con Loss: 4.767160653020767
[6 / 20] tensor([[0.780, 0.737],
        [0.725, 0.765]]) {'epoch': 6, 'valid/acc': 74.684, 'valid/acc_unbiased': 74.61, 'valid/diff': 1.42, 'valid/acc_skew': 75.321, 'valid/acc_align': 73.9, 'test/acc': 75.274, 'test/acc_unbiased': 75.175, 'test/diff': 4.131, 'test/acc_skew': 73.109, 'test/acc_align': 77.24}
[6 / 20] best valid accuracy: 74.610 at epoch 6 
 best_stats: {'best_valid_epoch': 6, 'best_valid_valid/acc': 74.684, 'best_valid_valid/acc_unbiased': 74.61, 'best_valid_valid/diff': 1.42, 'best_valid_valid/acc_skew': 75.321, 'best_valid_valid/acc_align': 73.9, 'best_valid_test/acc': 75.274, 'best_valid_test/acc_unbiased': 75.175, 'best_valid_test/diff': 4.131, 'best_valid_test/acc_skew': 73.109, 'best_valid_test/acc_align': 77.24}
[6 / 20] best test accuracy: 75.175 at epoch 6 
 best_stats: {'best_test_epoch': 6, 'best_test_valid/acc': 74.684, 'best_test_valid/acc_unbiased': 74.61, 'best_test_valid/diff': 1.42, 'best_test_valid/acc_skew': 75.321, 'best_test_valid/acc_align': 73.9, 'best_test_test/acc': 75.274, 'best_test_test/acc_unbiased': 75.175, 'best_test_test/diff': 4.131, 'best_test_test/acc_skew': 73.109, 'best_test_test/acc_align': 77.24}
[7 / 20] Learning rate: 0.0001 weight: 0.01
[7 / 20] Loss: 4.73480147184425 CE Loss: 0.5349561479569878 Con Loss: 4.729451909770379
[7 / 20] tensor([[0.724, 0.660],
        [0.842, 0.868]]) {'epoch': 7, 'valid/acc': 75.696, 'valid/acc_unbiased': 76.359, 'valid/diff': 0.765, 'valid/acc_skew': 76.185, 'valid/acc_align': 76.532, 'test/acc': 76.962, 'test/acc_unbiased': 77.351, 'test/diff': 4.476, 'test/acc_skew': 75.113, 'test/acc_align': 79.589}
[7 / 20] best valid accuracy: 76.359 at epoch 7 
 best_stats: {'best_valid_epoch': 7, 'best_valid_valid/acc': 75.696, 'best_valid_valid/acc_unbiased': 76.359, 'best_valid_valid/diff': 0.765, 'best_valid_valid/acc_skew': 76.185, 'best_valid_valid/acc_align': 76.532, 'best_valid_test/acc': 76.962, 'best_valid_test/acc_unbiased': 77.351, 'best_valid_test/diff': 4.476, 'best_valid_test/acc_skew': 75.113, 'best_valid_test/acc_align': 79.589}
[7 / 20] best test accuracy: 77.351 at epoch 7 
 best_stats: {'best_test_epoch': 7, 'best_test_valid/acc': 75.696, 'best_test_valid/acc_unbiased': 76.359, 'best_test_valid/diff': 0.765, 'best_test_valid/acc_skew': 76.185, 'best_test_valid/acc_align': 76.532, 'best_test_test/acc': 76.962, 'best_test_test/acc_unbiased': 77.351, 'best_test_test/diff': 4.476, 'best_test_test/acc_skew': 75.113, 'best_test_test/acc_align': 79.589}
[8 / 20] Learning rate: 0.0001 weight: 0.01
[8 / 20] Loss: 4.704732337074782 CE Loss: 0.5131954538961804 Con Loss: 4.699600387282811
[8 / 20] tensor([[0.771, 0.716],
        [0.818, 0.853]]) {'epoch': 8, 'valid/acc': 78.523, 'valid/acc_unbiased': 78.879, 'valid/diff': 1.55, 'valid/acc_skew': 78.271, 'valid/acc_align': 79.488, 'test/acc': 78.776, 'test/acc_unbiased': 78.952, 'test/diff': 4.446, 'test/acc_skew': 76.729, 'test/acc_align': 81.175}
[8 / 20] best valid accuracy: 78.879 at epoch 8 
 best_stats: {'best_valid_epoch': 8, 'best_valid_valid/acc': 78.523, 'best_valid_valid/acc_unbiased': 78.879, 'best_valid_valid/diff': 1.55, 'best_valid_valid/acc_skew': 78.271, 'best_valid_valid/acc_align': 79.488, 'best_valid_test/acc': 78.776, 'best_valid_test/acc_unbiased': 78.952, 'best_valid_test/diff': 4.446, 'best_valid_test/acc_skew': 76.729, 'best_valid_test/acc_align': 81.175}
[8 / 20] best test accuracy: 78.952 at epoch 8 
 best_stats: {'best_test_epoch': 8, 'best_test_valid/acc': 78.523, 'best_test_valid/acc_unbiased': 78.879, 'best_test_valid/diff': 1.55, 'best_test_valid/acc_skew': 78.271, 'best_test_valid/acc_align': 79.488, 'best_test_test/acc': 78.776, 'best_test_test/acc_unbiased': 78.952, 'best_test_test/diff': 4.446, 'best_test_test/acc_skew': 76.729, 'best_test_test/acc_align': 81.175}
[9 / 20] Learning rate: 0.0001 weight: 0.01
[9 / 20] Loss: 4.692522428046209 CE Loss: 0.5051064288808172 Con Loss: 4.687471380694545
[9 / 20] tensor([[0.737, 0.645],
        [0.835, 0.869]]) {'epoch': 9, 'valid/acc': 76.667, 'valid/acc_unbiased': 77.241, 'valid/diff': 3.426, 'valid/acc_skew': 75.528, 'valid/acc_align': 78.954, 'test/acc': 76.751, 'test/acc_unbiased': 77.17, 'test/diff': 6.24, 'test/acc_skew': 74.05, 'test/acc_align': 80.29}
[9 / 20] best valid accuracy: 78.879 at epoch 8 
 best_stats: {'best_valid_epoch': 8, 'best_valid_valid/acc': 78.523, 'best_valid_valid/acc_unbiased': 78.879, 'best_valid_valid/diff': 1.55, 'best_valid_valid/acc_skew': 78.271, 'best_valid_valid/acc_align': 79.488, 'best_valid_test/acc': 78.776, 'best_valid_test/acc_unbiased': 78.952, 'best_valid_test/diff': 4.446, 'best_valid_test/acc_skew': 76.729, 'best_valid_test/acc_align': 81.175}
[9 / 20] best test accuracy: 78.952 at epoch 8 
 best_stats: {'best_test_epoch': 8, 'best_test_valid/acc': 78.523, 'best_test_valid/acc_unbiased': 78.879, 'best_test_valid/diff': 1.55, 'best_test_valid/acc_skew': 78.271, 'best_test_valid/acc_align': 79.488, 'best_test_test/acc': 78.776, 'best_test_test/acc_unbiased': 78.952, 'best_test_test/diff': 4.446, 'best_test_test/acc_skew': 76.729, 'best_test_test/acc_align': 81.175}
[10 / 20] Learning rate: 0.0001 weight: 0.01
[10 / 20] Loss: 4.6853257168089835 CE Loss: 0.48990290523622604 Con Loss: 4.680426678580735
[10 / 20] tensor([[0.794, 0.715],
        [0.792, 0.841]]) {'epoch': 10, 'valid/acc': 79.072, 'valid/acc_unbiased': 79.358, 'valid/diff': 3.488, 'valid/acc_skew': 77.614, 'valid/acc_align': 81.102, 'test/acc': 78.439, 'test/acc_unbiased': 78.551, 'test/diff': 6.39, 'test/acc_skew': 75.356, 'test/acc_align': 81.746}
[10 / 20] best valid accuracy: 79.358 at epoch 10 
 best_stats: {'best_valid_epoch': 10, 'best_valid_valid/acc': 79.072, 'best_valid_valid/acc_unbiased': 79.358, 'best_valid_valid/diff': 3.488, 'best_valid_valid/acc_skew': 77.614, 'best_valid_valid/acc_align': 81.102, 'best_valid_test/acc': 78.439, 'best_valid_test/acc_unbiased': 78.551, 'best_valid_test/diff': 6.39, 'best_valid_test/acc_skew': 75.356, 'best_valid_test/acc_align': 81.746}
[10 / 20] best test accuracy: 78.952 at epoch 8 
 best_stats: {'best_test_epoch': 8, 'best_test_valid/acc': 78.523, 'best_test_valid/acc_unbiased': 78.879, 'best_test_valid/diff': 1.55, 'best_test_valid/acc_skew': 78.271, 'best_test_valid/acc_align': 79.488, 'best_test_test/acc': 78.776, 'best_test_test/acc_unbiased': 78.952, 'best_test_test/diff': 4.446, 'best_test_test/acc_skew': 76.729, 'best_test_test/acc_align': 81.175}
[11 / 20] Learning rate: 0.0001 weight: 0.01
[11 / 20] Loss: 4.665913287926558 CE Loss: 0.48571039358833 Con Loss: 4.661056202990419
[11 / 20] tensor([[0.789, 0.694],
        [0.792, 0.844]]) {'epoch': 11, 'valid/acc': 78.397, 'valid/acc_unbiased': 78.585, 'valid/diff': 3.474, 'valid/acc_skew': 76.849, 'valid/acc_align': 80.322, 'test/acc': 77.806, 'test/acc_unbiased': 77.974, 'test/diff': 7.303, 'test/acc_skew': 74.322, 'test/acc_align': 81.626}
[11 / 20] best valid accuracy: 79.358 at epoch 10 
 best_stats: {'best_valid_epoch': 10, 'best_valid_valid/acc': 79.072, 'best_valid_valid/acc_unbiased': 79.358, 'best_valid_valid/diff': 3.488, 'best_valid_valid/acc_skew': 77.614, 'best_valid_valid/acc_align': 81.102, 'best_valid_test/acc': 78.439, 'best_valid_test/acc_unbiased': 78.551, 'best_valid_test/diff': 6.39, 'best_valid_test/acc_skew': 75.356, 'best_valid_test/acc_align': 81.746}
[11 / 20] best test accuracy: 78.952 at epoch 8 
 best_stats: {'best_test_epoch': 8, 'best_test_valid/acc': 78.523, 'best_test_valid/acc_unbiased': 78.879, 'best_test_valid/diff': 1.55, 'best_test_valid/acc_skew': 78.271, 'best_test_valid/acc_align': 79.488, 'best_test_test/acc': 78.776, 'best_test_test/acc_unbiased': 78.952, 'best_test_test/diff': 4.446, 'best_test_test/acc_skew': 76.729, 'best_test_test/acc_align': 81.175}
[12 / 20] Learning rate: 0.0001 weight: 0.01
[12 / 20] Loss: 4.658101557289001 CE Loss: 0.4851193513999397 Con Loss: 4.653250361955009
[12 / 20] tensor([[0.729, 0.679],
        [0.833, 0.871]]) {'epoch': 12, 'valid/acc': 77.173, 'valid/acc_unbiased': 77.756, 'valid/diff': 4.748, 'valid/acc_skew': 75.382, 'valid/acc_align': 80.13, 'test/acc': 77.553, 'test/acc_unbiased': 77.823, 'test/diff': 4.366, 'test/acc_skew': 75.64, 'test/acc_align': 80.006}
[12 / 20] best valid accuracy: 79.358 at epoch 10 
 best_stats: {'best_valid_epoch': 10, 'best_valid_valid/acc': 79.072, 'best_valid_valid/acc_unbiased': 79.358, 'best_valid_valid/diff': 3.488, 'best_valid_valid/acc_skew': 77.614, 'best_valid_valid/acc_align': 81.102, 'best_valid_test/acc': 78.439, 'best_valid_test/acc_unbiased': 78.551, 'best_valid_test/diff': 6.39, 'best_valid_test/acc_skew': 75.356, 'best_valid_test/acc_align': 81.746}
[12 / 20] best test accuracy: 78.952 at epoch 8 
 best_stats: {'best_test_epoch': 8, 'best_test_valid/acc': 78.523, 'best_test_valid/acc_unbiased': 78.879, 'best_test_valid/diff': 1.55, 'best_test_valid/acc_skew': 78.271, 'best_test_valid/acc_align': 79.488, 'best_test_test/acc': 78.776, 'best_test_test/acc_unbiased': 78.952, 'best_test_test/diff': 4.446, 'best_test_test/acc_skew': 76.729, 'best_test_test/acc_align': 81.175}
[13 / 20] Learning rate: 0.0001 weight: 0.01
[13 / 20] Loss: 4.637773791658058 CE Loss: 0.478802976592568 Con Loss: 4.632985797842983
[13 / 20] tensor([[0.780, 0.722],
        [0.799, 0.834]]) {'epoch': 13, 'valid/acc': 78.734, 'valid/acc_unbiased': 78.971, 'valid/diff': 2.858, 'valid/acc_skew': 77.542, 'valid/acc_align': 80.4, 'test/acc': 78.228, 'test/acc_unbiased': 78.354, 'test/diff': 4.607, 'test/acc_skew': 76.05, 'test/acc_align': 80.658}
[13 / 20] best valid accuracy: 79.358 at epoch 10 
 best_stats: {'best_valid_epoch': 10, 'best_valid_valid/acc': 79.072, 'best_valid_valid/acc_unbiased': 79.358, 'best_valid_valid/diff': 3.488, 'best_valid_valid/acc_skew': 77.614, 'best_valid_valid/acc_align': 81.102, 'best_valid_test/acc': 78.439, 'best_valid_test/acc_unbiased': 78.551, 'best_valid_test/diff': 6.39, 'best_valid_test/acc_skew': 75.356, 'best_valid_test/acc_align': 81.746}
[13 / 20] best test accuracy: 78.952 at epoch 8 
 best_stats: {'best_test_epoch': 8, 'best_test_valid/acc': 78.523, 'best_test_valid/acc_unbiased': 78.879, 'best_test_valid/diff': 1.55, 'best_test_valid/acc_skew': 78.271, 'best_test_valid/acc_align': 79.488, 'best_test_test/acc': 78.776, 'best_test_test/acc_unbiased': 78.952, 'best_test_test/diff': 4.446, 'best_test_test/acc_skew': 76.729, 'best_test_test/acc_align': 81.175}
[14 / 20] Learning rate: 1e-05 weight: 0.01
[14 / 20] Loss: 4.62832935523149 CE Loss: 0.477444075211599 Con Loss: 4.623554929283667
[14 / 20] tensor([[0.719, 0.668],
        [0.857, 0.874]]) {'epoch': 14, 'valid/acc': 77.722, 'valid/acc_unbiased': 78.324, 'valid/diff': 5.227, 'valid/acc_skew': 75.711, 'valid/acc_align': 80.937, 'test/acc': 77.511, 'test/acc_unbiased': 77.928, 'test/diff': 3.377, 'test/acc_skew': 76.24, 'test/acc_align': 79.617}
[14 / 20] best valid accuracy: 79.358 at epoch 10 
 best_stats: {'best_valid_epoch': 10, 'best_valid_valid/acc': 79.072, 'best_valid_valid/acc_unbiased': 79.358, 'best_valid_valid/diff': 3.488, 'best_valid_valid/acc_skew': 77.614, 'best_valid_valid/acc_align': 81.102, 'best_valid_test/acc': 78.439, 'best_valid_test/acc_unbiased': 78.551, 'best_valid_test/diff': 6.39, 'best_valid_test/acc_skew': 75.356, 'best_valid_test/acc_align': 81.746}
[14 / 20] best test accuracy: 78.952 at epoch 8 
 best_stats: {'best_test_epoch': 8, 'best_test_valid/acc': 78.523, 'best_test_valid/acc_unbiased': 78.879, 'best_test_valid/diff': 1.55, 'best_test_valid/acc_skew': 78.271, 'best_test_valid/acc_align': 79.488, 'best_test_test/acc': 78.776, 'best_test_test/acc_unbiased': 78.952, 'best_test_test/diff': 4.446, 'best_test_test/acc_skew': 76.729, 'best_test_test/acc_align': 81.175}
[15 / 20] Learning rate: 1e-05 weight: 0.01
[15 / 20] Loss: 4.628565853895241 CE Loss: 0.47353613049359133 Con Loss: 4.6238304818182705
[15 / 20] tensor([[0.728, 0.668],
        [0.853, 0.875]]) {'epoch': 15, 'valid/acc': 77.764, 'valid/acc_unbiased': 78.359, 'valid/diff': 5.516, 'valid/acc_skew': 75.601, 'valid/acc_align': 81.117, 'test/acc': 77.679, 'test/acc_unbiased': 78.081, 'test/diff': 4.116, 'test/acc_skew': 76.023, 'test/acc_align': 80.139}
[15 / 20] best valid accuracy: 79.358 at epoch 10 
 best_stats: {'best_valid_epoch': 10, 'best_valid_valid/acc': 79.072, 'best_valid_valid/acc_unbiased': 79.358, 'best_valid_valid/diff': 3.488, 'best_valid_valid/acc_skew': 77.614, 'best_valid_valid/acc_align': 81.102, 'best_valid_test/acc': 78.439, 'best_valid_test/acc_unbiased': 78.551, 'best_valid_test/diff': 6.39, 'best_valid_test/acc_skew': 75.356, 'best_valid_test/acc_align': 81.746}
[15 / 20] best test accuracy: 78.952 at epoch 8 
 best_stats: {'best_test_epoch': 8, 'best_test_valid/acc': 78.523, 'best_test_valid/acc_unbiased': 78.879, 'best_test_valid/diff': 1.55, 'best_test_valid/acc_skew': 78.271, 'best_test_valid/acc_align': 79.488, 'best_test_test/acc': 78.776, 'best_test_test/acc_unbiased': 78.952, 'best_test_test/diff': 4.446, 'best_test_test/acc_skew': 76.729, 'best_test_test/acc_align': 81.175}
[16 / 20] Learning rate: 1e-05 weight: 0.01
[16 / 20] Loss: 4.612275186429785 CE Loss: 0.4744128059939445 Con Loss: 4.607531039292432
[16 / 20] tensor([[0.717, 0.647],
        [0.853, 0.887]]) {'epoch': 16, 'valid/acc': 77.468, 'valid/acc_unbiased': 78.131, 'valid/diff': 5.718, 'valid/acc_skew': 75.271, 'valid/acc_align': 80.99, 'test/acc': 77.173, 'test/acc_unbiased': 77.593, 'test/diff': 5.207, 'test/acc_skew': 74.989, 'test/acc_align': 80.196}
[16 / 20] best valid accuracy: 79.358 at epoch 10 
 best_stats: {'best_valid_epoch': 10, 'best_valid_valid/acc': 79.072, 'best_valid_valid/acc_unbiased': 79.358, 'best_valid_valid/diff': 3.488, 'best_valid_valid/acc_skew': 77.614, 'best_valid_valid/acc_align': 81.102, 'best_valid_test/acc': 78.439, 'best_valid_test/acc_unbiased': 78.551, 'best_valid_test/diff': 6.39, 'best_valid_test/acc_skew': 75.356, 'best_valid_test/acc_align': 81.746}
[16 / 20] best test accuracy: 78.952 at epoch 8 
 best_stats: {'best_test_epoch': 8, 'best_test_valid/acc': 78.523, 'best_test_valid/acc_unbiased': 78.879, 'best_test_valid/diff': 1.55, 'best_test_valid/acc_skew': 78.271, 'best_test_valid/acc_align': 79.488, 'best_test_test/acc': 78.776, 'best_test_test/acc_unbiased': 78.952, 'best_test_test/diff': 4.446, 'best_test_test/acc_skew': 76.729, 'best_test_test/acc_align': 81.175}
[17 / 20] Learning rate: 1e-05 weight: 0.01
[17 / 20] Loss: 4.617159348455739 CE Loss: 0.47092016427443634 Con Loss: 4.612450129116612
[17 / 20] tensor([[0.771, 0.685],
        [0.835, 0.875]]) {'epoch': 17, 'valid/acc': 78.65, 'valid/acc_unbiased': 79.159, 'valid/diff': 4.41, 'valid/acc_skew': 76.954, 'valid/acc_align': 81.364, 'test/acc': 78.861, 'test/acc_unbiased': 79.167, 'test/diff': 6.246, 'test/acc_skew': 76.044, 'test/acc_align': 82.29}
[17 / 20] best valid accuracy: 79.358 at epoch 10 
 best_stats: {'best_valid_epoch': 10, 'best_valid_valid/acc': 79.072, 'best_valid_valid/acc_unbiased': 79.358, 'best_valid_valid/diff': 3.488, 'best_valid_valid/acc_skew': 77.614, 'best_valid_valid/acc_align': 81.102, 'best_valid_test/acc': 78.439, 'best_valid_test/acc_unbiased': 78.551, 'best_valid_test/diff': 6.39, 'best_valid_test/acc_skew': 75.356, 'best_valid_test/acc_align': 81.746}
[17 / 20] best test accuracy: 79.167 at epoch 17 
 best_stats: {'best_test_epoch': 17, 'best_test_valid/acc': 78.65, 'best_test_valid/acc_unbiased': 79.159, 'best_test_valid/diff': 4.41, 'best_test_valid/acc_skew': 76.954, 'best_test_valid/acc_align': 81.364, 'best_test_test/acc': 78.861, 'best_test_test/acc_unbiased': 79.167, 'best_test_test/diff': 6.246, 'best_test_test/acc_skew': 76.044, 'best_test_test/acc_align': 82.29}
[18 / 20] Learning rate: 1e-05 weight: 0.01
[18 / 20] Loss: 4.629941096243013 CE Loss: 0.47348941829857333 Con Loss: 4.625206189832785
[18 / 20] tensor([[0.783, 0.710],
        [0.823, 0.857]]) {'epoch': 18, 'valid/acc': 78.903, 'valid/acc_unbiased': 79.253, 'valid/diff': 4.666, 'valid/acc_skew': 76.919, 'valid/acc_align': 81.586, 'test/acc': 79.114, 'test/acc_unbiased': 79.338, 'test/diff': 5.376, 'test/acc_skew': 76.65, 'test/acc_align': 82.025}
[18 / 20] best valid accuracy: 79.358 at epoch 10 
 best_stats: {'best_valid_epoch': 10, 'best_valid_valid/acc': 79.072, 'best_valid_valid/acc_unbiased': 79.358, 'best_valid_valid/diff': 3.488, 'best_valid_valid/acc_skew': 77.614, 'best_valid_valid/acc_align': 81.102, 'best_valid_test/acc': 78.439, 'best_valid_test/acc_unbiased': 78.551, 'best_valid_test/diff': 6.39, 'best_valid_test/acc_skew': 75.356, 'best_valid_test/acc_align': 81.746}
[18 / 20] best test accuracy: 79.338 at epoch 18 
 best_stats: {'best_test_epoch': 18, 'best_test_valid/acc': 78.903, 'best_test_valid/acc_unbiased': 79.253, 'best_test_valid/diff': 4.666, 'best_test_valid/acc_skew': 76.919, 'best_test_valid/acc_align': 81.586, 'best_test_test/acc': 79.114, 'best_test_test/acc_unbiased': 79.338, 'best_test_test/diff': 5.376, 'best_test_test/acc_skew': 76.65, 'best_test_test/acc_align': 82.025}
[19 / 20] Learning rate: 1e-05 weight: 0.01
[19 / 20] Loss: 4.625335163462738 CE Loss: 0.4597211184299184 Con Loss: 4.620737962457481
[19 / 20] tensor([[0.783, 0.702],
        [0.829, 0.869]]) {'epoch': 19, 'valid/acc': 78.861, 'valid/acc_unbiased': 79.232, 'valid/diff': 5.138, 'valid/acc_skew': 76.663, 'valid/acc_align': 81.801, 'test/acc': 79.325, 'test/acc_unbiased': 79.576, 'test/diff': 6.088, 'test/acc_skew': 76.531, 'test/acc_align': 82.62}
[19 / 20] best valid accuracy: 79.358 at epoch 10 
 best_stats: {'best_valid_epoch': 10, 'best_valid_valid/acc': 79.072, 'best_valid_valid/acc_unbiased': 79.358, 'best_valid_valid/diff': 3.488, 'best_valid_valid/acc_skew': 77.614, 'best_valid_valid/acc_align': 81.102, 'best_valid_test/acc': 78.439, 'best_valid_test/acc_unbiased': 78.551, 'best_valid_test/diff': 6.39, 'best_valid_test/acc_skew': 75.356, 'best_valid_test/acc_align': 81.746}
[19 / 20] best test accuracy: 79.576 at epoch 19 
 best_stats: {'best_test_epoch': 19, 'best_test_valid/acc': 78.861, 'best_test_valid/acc_unbiased': 79.232, 'best_test_valid/diff': 5.138, 'best_test_valid/acc_skew': 76.663, 'best_test_valid/acc_align': 81.801, 'best_test_test/acc': 79.325, 'best_test_test/acc_unbiased': 79.576, 'best_test_test/diff': 6.088, 'best_test_test/acc_skew': 76.531, 'best_test_test/acc_align': 82.62}
[20 / 20] Learning rate: 1e-05 weight: 0.01
[20 / 20] Loss: 4.612565978205222 CE Loss: 0.46088880252523967 Con Loss: 4.607957085264549
[20 / 20] tensor([[0.772, 0.697],
        [0.833, 0.875]]) {'epoch': 20, 'valid/acc': 78.608, 'valid/acc_unbiased': 79.103, 'valid/diff': 5.175, 'valid/acc_skew': 76.516, 'valid/acc_align': 81.69, 'test/acc': 79.198, 'test/acc_unbiased': 79.453, 'test/diff': 5.853, 'test/acc_skew': 76.526, 'test/acc_align': 82.379}
[20 / 20] best valid accuracy: 79.358 at epoch 10 
 best_stats: {'best_valid_epoch': 10, 'best_valid_valid/acc': 79.072, 'best_valid_valid/acc_unbiased': 79.358, 'best_valid_valid/diff': 3.488, 'best_valid_valid/acc_skew': 77.614, 'best_valid_valid/acc_align': 81.102, 'best_valid_test/acc': 78.439, 'best_valid_test/acc_unbiased': 78.551, 'best_valid_test/diff': 6.39, 'best_valid_test/acc_skew': 75.356, 'best_valid_test/acc_align': 81.746}
[20 / 20] best test accuracy: 79.576 at epoch 19 
 best_stats: {'best_test_epoch': 19, 'best_test_valid/acc': 78.861, 'best_test_valid/acc_unbiased': 79.232, 'best_test_valid/diff': 5.138, 'best_test_valid/acc_skew': 76.663, 'best_test_valid/acc_align': 81.801, 'best_test_test/acc': 79.325, 'best_test_test/acc_unbiased': 79.576, 'best_test_test/diff': 6.088, 'best_test_test/acc_skew': 76.531, 'best_test_test/acc_align': 82.62}
Total training time: 0:17:04
