Log level set to: INFO
Set seed: 1
=======> Using Fixed Random Seed: 1 <========
save_path: exp_results/dro-celeba_smiling-test-lr0.001-bs128-seed1
get_celeba - split:train, aug: False, given_y: True, ratio: 0
get_celeba - split:train_valid, aug: False, given_y: True, ratio: 0
get_celeba - split:valid, aug: False, given_y: True, ratio: 0
decay_epochs: [3, 6]
[1 / 10] Learning rate: 0.001
[1 / 10] Loss: 0.1602
[1 / 10] tensor([[0.854, 0.961],
        [0.965, 0.844]]) {'epoch': 1, 'valid/acc': 94.563, 'valid/acc_unbiased': 90.98, 'valid/diff': 10.949, 'valid/acc_skew': 85.506, 'valid/acc_align': 96.455, 'test/acc': 91.368, 'test/acc_unbiased': 90.598, 'test/diff': 11.409, 'test/acc_skew': 84.894, 'test/acc_align': 96.303}
[1 / 10] best valid accuracy: 85.506 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 94.563, 'best_valid_valid/acc_unbiased': 90.98, 'best_valid_valid/diff': 10.949, 'best_valid_valid/acc_skew': 85.506, 'best_valid_valid/acc_align': 96.455, 'best_valid_test/acc': 91.368, 'best_valid_test/acc_unbiased': 90.598, 'best_valid_test/diff': 11.409, 'best_valid_test/acc_skew': 84.894, 'best_valid_test/acc_align': 96.303}
[1 / 10] best test accuracy: 84.894 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 94.563, 'best_test_valid/acc_unbiased': 90.98, 'best_test_valid/diff': 10.949, 'best_test_valid/acc_skew': 85.506, 'best_test_valid/acc_align': 96.455, 'best_test_test/acc': 91.368, 'best_test_test/acc_unbiased': 90.598, 'best_test_test/diff': 11.409, 'best_test_test/acc_skew': 84.894, 'best_test_test/acc_align': 96.303}
[2 / 10] Learning rate: 0.001
[2 / 10] Loss: 0.1446
[2 / 10] tensor([[0.845, 0.978],
        [0.966, 0.780]]) {'epoch': 2, 'valid/acc': 94.643, 'valid/acc_unbiased': 89.83, 'valid/diff': 14.93, 'valid/acc_skew': 82.365, 'valid/acc_align': 97.295, 'test/acc': 90.472, 'test/acc_unbiased': 89.216, 'test/diff': 16.002, 'test/acc_skew': 81.216, 'test/acc_align': 97.217}
[2 / 10] best valid accuracy: 85.506 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 94.563, 'best_valid_valid/acc_unbiased': 90.98, 'best_valid_valid/diff': 10.949, 'best_valid_valid/acc_skew': 85.506, 'best_valid_valid/acc_align': 96.455, 'best_valid_test/acc': 91.368, 'best_valid_test/acc_unbiased': 90.598, 'best_valid_test/diff': 11.409, 'best_valid_test/acc_skew': 84.894, 'best_valid_test/acc_align': 96.303}
[2 / 10] best test accuracy: 84.894 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 94.563, 'best_test_valid/acc_unbiased': 90.98, 'best_test_valid/diff': 10.949, 'best_test_valid/acc_skew': 85.506, 'best_test_valid/acc_align': 96.455, 'best_test_test/acc': 91.368, 'best_test_test/acc_unbiased': 90.598, 'best_test_test/diff': 11.409, 'best_test_test/acc_skew': 84.894, 'best_test_test/acc_align': 96.303}
[3 / 10] Learning rate: 0.001
[3 / 10] Loss: 0.1429
[3 / 10] tensor([[0.759, 0.959],
        [0.984, 0.853]]) {'epoch': 3, 'valid/acc': 94.478, 'valid/acc_unbiased': 89.362, 'valid/diff': 15.344, 'valid/acc_skew': 81.69, 'valid/acc_align': 97.034, 'test/acc': 89.571, 'test/acc_unbiased': 88.897, 'test/diff': 16.521, 'test/acc_skew': 80.637, 'test/acc_align': 97.158}
[3 / 10] best valid accuracy: 85.506 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 94.563, 'best_valid_valid/acc_unbiased': 90.98, 'best_valid_valid/diff': 10.949, 'best_valid_valid/acc_skew': 85.506, 'best_valid_valid/acc_align': 96.455, 'best_valid_test/acc': 91.368, 'best_valid_test/acc_unbiased': 90.598, 'best_valid_test/diff': 11.409, 'best_valid_test/acc_skew': 84.894, 'best_valid_test/acc_align': 96.303}
[3 / 10] best test accuracy: 84.894 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 94.563, 'best_test_valid/acc_unbiased': 90.98, 'best_test_valid/diff': 10.949, 'best_test_valid/acc_skew': 85.506, 'best_test_valid/acc_align': 96.455, 'best_test_test/acc': 91.368, 'best_test_test/acc_unbiased': 90.598, 'best_test_test/diff': 11.409, 'best_test_test/acc_skew': 84.894, 'best_test_test/acc_align': 96.303}
[4 / 10] Learning rate: 0.0001
[4 / 10] Loss: 0.1213
[4 / 10] tensor([[0.883, 0.982],
        [0.966, 0.819]]) {'epoch': 4, 'valid/acc': 95.596, 'valid/acc_unbiased': 92.023, 'valid/diff': 11.205, 'valid/acc_skew': 86.42, 'valid/acc_align': 97.625, 'test/acc': 92.253, 'test/acc_unbiased': 91.242, 'test/diff': 12.317, 'test/acc_skew': 85.083, 'test/acc_align': 97.401}
[4 / 10] best valid accuracy: 86.420 at epoch 4 
 best_stats: {'best_valid_epoch': 4, 'best_valid_valid/acc': 95.596, 'best_valid_valid/acc_unbiased': 92.023, 'best_valid_valid/diff': 11.205, 'best_valid_valid/acc_skew': 86.42, 'best_valid_valid/acc_align': 97.625, 'best_valid_test/acc': 92.253, 'best_valid_test/acc_unbiased': 91.242, 'best_valid_test/diff': 12.317, 'best_valid_test/acc_skew': 85.083, 'best_valid_test/acc_align': 97.401}
[4 / 10] best test accuracy: 85.083 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 95.596, 'best_test_valid/acc_unbiased': 92.023, 'best_test_valid/diff': 11.205, 'best_test_valid/acc_skew': 86.42, 'best_test_valid/acc_align': 97.625, 'best_test_test/acc': 92.253, 'best_test_test/acc_unbiased': 91.242, 'best_test_test/diff': 12.317, 'best_test_test/acc_skew': 85.083, 'best_test_test/acc_align': 97.401}
[5 / 10] Learning rate: 0.0001
[5 / 10] Loss: 0.1149
[5 / 10] tensor([[0.856, 0.976],
        [0.972, 0.844]]) {'epoch': 5, 'valid/acc': 95.766, 'valid/acc_unbiased': 92.034, 'valid/diff': 11.519, 'valid/acc_skew': 86.274, 'valid/acc_align': 97.793, 'test/acc': 92.022, 'test/acc_unbiased': 91.207, 'test/diff': 12.396, 'test/acc_skew': 85.009, 'test/acc_align': 97.404}
[5 / 10] best valid accuracy: 86.420 at epoch 4 
 best_stats: {'best_valid_epoch': 4, 'best_valid_valid/acc': 95.596, 'best_valid_valid/acc_unbiased': 92.023, 'best_valid_valid/diff': 11.205, 'best_valid_valid/acc_skew': 86.42, 'best_valid_valid/acc_align': 97.625, 'best_valid_test/acc': 92.253, 'best_valid_test/acc_unbiased': 91.242, 'best_valid_test/diff': 12.317, 'best_valid_test/acc_skew': 85.083, 'best_valid_test/acc_align': 97.401}
[5 / 10] best test accuracy: 85.083 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 95.596, 'best_test_valid/acc_unbiased': 92.023, 'best_test_valid/diff': 11.205, 'best_test_valid/acc_skew': 86.42, 'best_test_valid/acc_align': 97.625, 'best_test_test/acc': 92.253, 'best_test_test/acc_unbiased': 91.242, 'best_test_test/diff': 12.317, 'best_test_test/acc_skew': 85.083, 'best_test_test/acc_align': 97.401}
[6 / 10] Learning rate: 0.0001
[6 / 10] Loss: 0.1090
[6 / 10] tensor([[0.888, 0.979],
        [0.962, 0.820]]) {'epoch': 6, 'valid/acc': 95.784, 'valid/acc_unbiased': 92.647, 'valid/diff': 9.895, 'valid/acc_skew': 87.7, 'valid/acc_align': 97.594, 'test/acc': 92.198, 'test/acc_unbiased': 91.213, 'test/diff': 11.638, 'test/acc_skew': 85.394, 'test/acc_align': 97.032}
[6 / 10] best valid accuracy: 87.700 at epoch 6 
 best_stats: {'best_valid_epoch': 6, 'best_valid_valid/acc': 95.784, 'best_valid_valid/acc_unbiased': 92.647, 'best_valid_valid/diff': 9.895, 'best_valid_valid/acc_skew': 87.7, 'best_valid_valid/acc_align': 97.594, 'best_valid_test/acc': 92.198, 'best_valid_test/acc_unbiased': 91.213, 'best_valid_test/diff': 11.638, 'best_valid_test/acc_skew': 85.394, 'best_valid_test/acc_align': 97.032}
[6 / 10] best test accuracy: 85.394 at epoch 6 
 best_stats: {'best_test_epoch': 6, 'best_test_valid/acc': 95.784, 'best_test_valid/acc_unbiased': 92.647, 'best_test_valid/diff': 9.895, 'best_test_valid/acc_skew': 87.7, 'best_test_valid/acc_align': 97.594, 'best_test_test/acc': 92.198, 'best_test_test/acc_unbiased': 91.213, 'best_test_test/diff': 11.638, 'best_test_test/acc_skew': 85.394, 'best_test_test/acc_align': 97.032}
[7 / 10] Learning rate: 1e-05
[7 / 10] Loss: 0.0994
[7 / 10] tensor([[0.851, 0.974],
        [0.975, 0.847]]) {'epoch': 7, 'valid/acc': 96.047, 'valid/acc_unbiased': 92.457, 'valid/diff': 11.044, 'valid/acc_skew': 86.935, 'valid/acc_align': 97.979, 'test/acc': 91.967, 'test/acc_unbiased': 91.161, 'test/diff': 12.596, 'test/acc_skew': 84.863, 'test/acc_align': 97.459}
[7 / 10] best valid accuracy: 87.700 at epoch 6 
 best_stats: {'best_valid_epoch': 6, 'best_valid_valid/acc': 95.784, 'best_valid_valid/acc_unbiased': 92.647, 'best_valid_valid/diff': 9.895, 'best_valid_valid/acc_skew': 87.7, 'best_valid_valid/acc_align': 97.594, 'best_valid_test/acc': 92.198, 'best_valid_test/acc_unbiased': 91.213, 'best_valid_test/diff': 11.638, 'best_valid_test/acc_skew': 85.394, 'best_valid_test/acc_align': 97.032}
[7 / 10] best test accuracy: 85.394 at epoch 6 
 best_stats: {'best_test_epoch': 6, 'best_test_valid/acc': 95.784, 'best_test_valid/acc_unbiased': 92.647, 'best_test_valid/diff': 9.895, 'best_test_valid/acc_skew': 87.7, 'best_test_valid/acc_align': 97.594, 'best_test_test/acc': 92.198, 'best_test_test/acc_unbiased': 91.213, 'best_test_test/diff': 11.638, 'best_test_test/acc_skew': 85.394, 'best_test_test/acc_align': 97.032}
[8 / 10] Learning rate: 1e-05
[8 / 10] Loss: 0.0963
[8 / 10] tensor([[0.847, 0.976],
        [0.975, 0.842]]) {'epoch': 8, 'valid/acc': 96.119, 'valid/acc_unbiased': 92.482, 'valid/diff': 11.196, 'valid/acc_skew': 86.884, 'valid/acc_align': 98.08, 'test/acc': 91.841, 'test/acc_unbiased': 91.011, 'test/diff': 13.054, 'test/acc_skew': 84.484, 'test/acc_align': 97.538}
[8 / 10] best valid accuracy: 87.700 at epoch 6 
 best_stats: {'best_valid_epoch': 6, 'best_valid_valid/acc': 95.784, 'best_valid_valid/acc_unbiased': 92.647, 'best_valid_valid/diff': 9.895, 'best_valid_valid/acc_skew': 87.7, 'best_valid_valid/acc_align': 97.594, 'best_valid_test/acc': 92.198, 'best_valid_test/acc_unbiased': 91.213, 'best_valid_test/diff': 11.638, 'best_valid_test/acc_skew': 85.394, 'best_valid_test/acc_align': 97.032}
[8 / 10] best test accuracy: 85.394 at epoch 6 
 best_stats: {'best_test_epoch': 6, 'best_test_valid/acc': 95.784, 'best_test_valid/acc_unbiased': 92.647, 'best_test_valid/diff': 9.895, 'best_test_valid/acc_skew': 87.7, 'best_test_valid/acc_align': 97.594, 'best_test_test/acc': 92.198, 'best_test_test/acc_unbiased': 91.213, 'best_test_test/diff': 11.638, 'best_test_test/acc_skew': 85.394, 'best_test_test/acc_align': 97.032}
[9 / 10] Learning rate: 1e-05
[9 / 10] Loss: 0.0947
[9 / 10] tensor([[0.847, 0.975],
        [0.972, 0.840]]) {'epoch': 9, 'valid/acc': 96.208, 'valid/acc_unbiased': 92.541, 'valid/diff': 11.311, 'valid/acc_skew': 86.885, 'valid/acc_align': 98.197, 'test/acc': 91.695, 'test/acc_unbiased': 90.861, 'test/diff': 13.044, 'test/acc_skew': 84.339, 'test/acc_align': 97.383}
[9 / 10] best valid accuracy: 87.700 at epoch 6 
 best_stats: {'best_valid_epoch': 6, 'best_valid_valid/acc': 95.784, 'best_valid_valid/acc_unbiased': 92.647, 'best_valid_valid/diff': 9.895, 'best_valid_valid/acc_skew': 87.7, 'best_valid_valid/acc_align': 97.594, 'best_valid_test/acc': 92.198, 'best_valid_test/acc_unbiased': 91.213, 'best_valid_test/diff': 11.638, 'best_valid_test/acc_skew': 85.394, 'best_valid_test/acc_align': 97.032}
[9 / 10] best test accuracy: 85.394 at epoch 6 
 best_stats: {'best_test_epoch': 6, 'best_test_valid/acc': 95.784, 'best_test_valid/acc_unbiased': 92.647, 'best_test_valid/diff': 9.895, 'best_test_valid/acc_skew': 87.7, 'best_test_valid/acc_align': 97.594, 'best_test_test/acc': 92.198, 'best_test_test/acc_unbiased': 91.213, 'best_test_test/diff': 11.638, 'best_test_test/acc_skew': 85.394, 'best_test_test/acc_align': 97.032}
[10 / 10] Learning rate: 1e-05
[10 / 10] Loss: 0.0931
[10 / 10] tensor([[0.839, 0.974],
        [0.976, 0.846]]) {'epoch': 10, 'valid/acc': 96.289, 'valid/acc_unbiased': 92.641, 'valid/diff': 11.171, 'valid/acc_skew': 87.055, 'valid/acc_align': 98.227, 'test/acc': 91.69, 'test/acc_unbiased': 90.887, 'test/diff': 13.268, 'test/acc_skew': 84.253, 'test/acc_align': 97.521}
[10 / 10] best valid accuracy: 87.700 at epoch 6 
 best_stats: {'best_valid_epoch': 6, 'best_valid_valid/acc': 95.784, 'best_valid_valid/acc_unbiased': 92.647, 'best_valid_valid/diff': 9.895, 'best_valid_valid/acc_skew': 87.7, 'best_valid_valid/acc_align': 97.594, 'best_valid_test/acc': 92.198, 'best_valid_test/acc_unbiased': 91.213, 'best_valid_test/diff': 11.638, 'best_valid_test/acc_skew': 85.394, 'best_valid_test/acc_align': 97.032}
[10 / 10] best test accuracy: 85.394 at epoch 6 
 best_stats: {'best_test_epoch': 6, 'best_test_valid/acc': 95.784, 'best_test_valid/acc_unbiased': 92.647, 'best_test_valid/diff': 9.895, 'best_test_valid/acc_skew': 87.7, 'best_test_valid/acc_align': 97.594, 'best_test_test/acc': 92.198, 'best_test_test/acc_unbiased': 91.213, 'best_test_test/diff': 11.638, 'best_test_test/acc_skew': 85.394, 'best_test_test/acc_align': 97.032}
Total training time: 0:32:48
