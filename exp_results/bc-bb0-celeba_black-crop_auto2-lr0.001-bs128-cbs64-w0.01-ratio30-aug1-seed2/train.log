Log level set to: INFO
Set seed: 2
=======> Using Fixed Random Seed: 2 <========
save_path: exp_results/bc-bb0-celeba_black-crop_auto2-lr0.001-bs128-cbs64-w0.01-ratio30-aug1-seed2
get_celeba - split:train, aug: False, given_y: True, ratio: 0
use existing black indices from data/celeba/pickles/black
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [60774, 38396]
Target 1: [8027, 15991]
Binary Target 1
---------------------------
Target 0: [60774, 38396]
Target 1: [8027, 15991]
===================================
Normal Label Distribution: 
Target 0: [60774, 38396]
Target 1: [8027, 15991]
===================================
Use BiasedCelebASplit 
 target_attr: black split: train 
 tensor([[60774.,  8027.],
        [38396., 15991.]])
get_celeba - split:train, aug: 1, given_y: True, ratio: 30
use existing black indices from data/celeba/pickles/black
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [60435, 38588]
Target 1: [7963, 16202]
Binary Target 1
---------------------------
Target 0: [60435, 38588]
Target 1: [7963, 16202]
===================================
Normal Label Distribution: 
Target 0: [60435, 38588]
Target 1: [7963, 16202]
===================================
Use BiasedCelebASplit 
 target_attr: black split: train 
 tensor([[60435.,  7963.],
        [38588., 16202.]])
get_celeba - split:train_valid, aug: False, given_y: True, ratio: 0
use existing black indices from data/celeba/pickles/black
Use BiasedCelebASplit 
 target_attr: black split: train_valid 
 tensor([[15020.,  1991.],
        [ 9642.,  4145.]])
get_celeba - split:valid, aug: False, given_y: True, ratio: 0
Use BiasedCelebASplit 
 target_attr: black split: valid 
 tensor([[9752., 1657.],
        [5971., 2487.]])
decay_epochs: [3, 6]
[1 / 10] Learning rate: 0.001 weight: 0.01
[1 / 10] Loss: 4.835662263962582 CE Loss: 0.3471233766286115 Con Loss: 4.832191030317325
[1 / 10] tensor([[0.990, 0.985],
        [0.315, 0.320]]) {'epoch': 1, 'valid/acc': 84.885, 'valid/acc_unbiased': 63.93, 'valid/diff': 0.442, 'valid/acc_skew': 64.151, 'valid/acc_align': 63.709, 'test/acc': 84.839, 'test/acc_unbiased': 65.244, 'test/diff': 0.525, 'test/acc_skew': 64.981, 'test/acc_align': 65.506}
[1 / 10] best valid accuracy: 63.930 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 84.885, 'best_valid_valid/acc_unbiased': 63.93, 'best_valid_valid/diff': 0.442, 'best_valid_valid/acc_skew': 64.151, 'best_valid_valid/acc_align': 63.709, 'best_valid_test/acc': 84.839, 'best_valid_test/acc_unbiased': 65.244, 'best_valid_test/diff': 0.525, 'best_valid_test/acc_skew': 64.981, 'best_valid_test/acc_align': 65.506}
[1 / 10] best test accuracy: 65.244 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 84.885, 'best_test_valid/acc_unbiased': 63.93, 'best_test_valid/diff': 0.442, 'best_test_valid/acc_skew': 64.151, 'best_test_valid/acc_align': 63.709, 'best_test_test/acc': 84.839, 'best_test_test/acc_unbiased': 65.244, 'best_test_test/diff': 0.525, 'best_test_test/acc_skew': 64.981, 'best_test_test/acc_align': 65.506}
[2 / 10] Learning rate: 0.001 weight: 0.01
[2 / 10] Loss: 4.8224899913984665 CE Loss: 0.30572263633830943 Con Loss: 4.819432768437887
[2 / 10] tensor([[0.968, 0.964],
        [0.488, 0.378]]) {'epoch': 2, 'valid/acc': 85.311, 'valid/acc_unbiased': 69.082, 'valid/diff': 4.953, 'valid/acc_skew': 71.523, 'valid/acc_align': 66.64, 'test/acc': 85.287, 'test/acc_unbiased': 69.934, 'test/diff': 5.696, 'test/acc_skew': 72.589, 'test/acc_align': 67.278}
[2 / 10] best valid accuracy: 69.082 at epoch 2 
 best_stats: {'best_valid_epoch': 2, 'best_valid_valid/acc': 85.311, 'best_valid_valid/acc_unbiased': 69.082, 'best_valid_valid/diff': 4.953, 'best_valid_valid/acc_skew': 71.523, 'best_valid_valid/acc_align': 66.64, 'best_valid_test/acc': 85.287, 'best_valid_test/acc_unbiased': 69.934, 'best_valid_test/diff': 5.696, 'best_valid_test/acc_skew': 72.589, 'best_valid_test/acc_align': 67.278}
[2 / 10] best test accuracy: 69.934 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 85.311, 'best_test_valid/acc_unbiased': 69.082, 'best_test_valid/diff': 4.953, 'best_test_valid/acc_skew': 71.523, 'best_test_valid/acc_align': 66.64, 'best_test_test/acc': 85.287, 'best_test_test/acc_unbiased': 69.934, 'best_test_test/diff': 5.696, 'best_test_test/acc_skew': 72.589, 'best_test_test/acc_align': 67.278}
[3 / 10] Learning rate: 0.001 weight: 0.01
[3 / 10] Loss: 4.817214244038392 CE Loss: 0.3001072149805176 Con Loss: 4.814213170081519
[3 / 10] tensor([[0.935, 0.904],
        [0.757, 0.678]]) {'epoch': 3, 'valid/acc': 87.366, 'valid/acc_unbiased': 80.742, 'valid/diff': 5.92, 'valid/acc_skew': 82.645, 'valid/acc_align': 78.839, 'test/acc': 87.889, 'test/acc_unbiased': 81.88, 'test/diff': 5.489, 'test/acc_skew': 83.088, 'test/acc_align': 80.671}
[3 / 10] best valid accuracy: 80.742 at epoch 3 
 best_stats: {'best_valid_epoch': 3, 'best_valid_valid/acc': 87.366, 'best_valid_valid/acc_unbiased': 80.742, 'best_valid_valid/diff': 5.92, 'best_valid_valid/acc_skew': 82.645, 'best_valid_valid/acc_align': 78.839, 'best_valid_test/acc': 87.889, 'best_valid_test/acc_unbiased': 81.88, 'best_valid_test/diff': 5.489, 'best_valid_test/acc_skew': 83.088, 'best_valid_test/acc_align': 80.671}
[3 / 10] best test accuracy: 81.880 at epoch 3 
 best_stats: {'best_test_epoch': 3, 'best_test_valid/acc': 87.366, 'best_test_valid/acc_unbiased': 80.742, 'best_test_valid/diff': 5.92, 'best_test_valid/acc_skew': 82.645, 'best_test_valid/acc_align': 78.839, 'best_test_test/acc': 87.889, 'best_test_test/acc_unbiased': 81.88, 'best_test_test/diff': 5.489, 'best_test_test/acc_skew': 83.088, 'best_test_test/acc_align': 80.671}
[4 / 10] Learning rate: 0.0001 weight: 0.01
[4 / 10] Loss: 4.79249128979646 CE Loss: 0.261171045595823 Con Loss: 4.789879580931675
[4 / 10] tensor([[0.968, 0.943],
        [0.615, 0.652]]) {'epoch': 4, 'valid/acc': 89.09, 'valid/acc_unbiased': 78.275, 'valid/diff': 1.084, 'valid/acc_skew': 77.755, 'valid/acc_align': 78.795, 'test/acc': 89.138, 'test/acc_unbiased': 79.443, 'test/diff': 3.134, 'test/acc_skew': 77.876, 'test/acc_align': 81.01}
[4 / 10] best valid accuracy: 80.742 at epoch 3 
 best_stats: {'best_valid_epoch': 3, 'best_valid_valid/acc': 87.366, 'best_valid_valid/acc_unbiased': 80.742, 'best_valid_valid/diff': 5.92, 'best_valid_valid/acc_skew': 82.645, 'best_valid_valid/acc_align': 78.839, 'best_valid_test/acc': 87.889, 'best_valid_test/acc_unbiased': 81.88, 'best_valid_test/diff': 5.489, 'best_valid_test/acc_skew': 83.088, 'best_valid_test/acc_align': 80.671}
[4 / 10] best test accuracy: 81.880 at epoch 3 
 best_stats: {'best_test_epoch': 3, 'best_test_valid/acc': 87.366, 'best_test_valid/acc_unbiased': 80.742, 'best_test_valid/diff': 5.92, 'best_test_valid/acc_skew': 82.645, 'best_test_valid/acc_align': 78.839, 'best_test_test/acc': 87.889, 'best_test_test/acc_unbiased': 81.88, 'best_test_test/diff': 5.489, 'best_test_test/acc_skew': 83.088, 'best_test_test/acc_align': 80.671}
[5 / 10] Learning rate: 0.0001 weight: 0.01
[5 / 10] Loss: 4.781714354636867 CE Loss: 0.2531460553942808 Con Loss: 4.779182892974121
[5 / 10] tensor([[0.967, 0.927],
        [0.634, 0.710]]) {'epoch': 5, 'valid/acc': 89.629, 'valid/acc_unbiased': 80.623, 'valid/diff': 2.535, 'valid/acc_skew': 79.355, 'valid/acc_align': 81.89, 'test/acc': 89.485, 'test/acc_unbiased': 80.942, 'test/diff': 5.742, 'test/acc_skew': 78.071, 'test/acc_align': 83.813}
[5 / 10] best valid accuracy: 80.742 at epoch 3 
 best_stats: {'best_valid_epoch': 3, 'best_valid_valid/acc': 87.366, 'best_valid_valid/acc_unbiased': 80.742, 'best_valid_valid/diff': 5.92, 'best_valid_valid/acc_skew': 82.645, 'best_valid_valid/acc_align': 78.839, 'best_valid_test/acc': 87.889, 'best_valid_test/acc_unbiased': 81.88, 'best_valid_test/diff': 5.489, 'best_valid_test/acc_skew': 83.088, 'best_valid_test/acc_align': 80.671}
[5 / 10] best test accuracy: 81.880 at epoch 3 
 best_stats: {'best_test_epoch': 3, 'best_test_valid/acc': 87.366, 'best_test_valid/acc_unbiased': 80.742, 'best_test_valid/diff': 5.92, 'best_test_valid/acc_skew': 82.645, 'best_test_valid/acc_align': 78.839, 'best_test_test/acc': 87.889, 'best_test_test/acc_unbiased': 81.88, 'best_test_test/diff': 5.489, 'best_test_test/acc_skew': 83.088, 'best_test_test/acc_align': 80.671}
[6 / 10] Learning rate: 0.0001 weight: 0.01
[6 / 10] Loss: 4.777274047623526 CE Loss: 0.24777380172070712 Con Loss: 4.774796310026824
[6 / 10] tensor([[0.962, 0.938],
        [0.707, 0.714]]) {'epoch': 6, 'valid/acc': 90.132, 'valid/acc_unbiased': 82.374, 'valid/diff': 2.195, 'valid/acc_skew': 82.464, 'valid/acc_align': 82.285, 'test/acc': 90.255, 'test/acc_unbiased': 83.018, 'test/diff': 1.562, 'test/acc_skew': 82.237, 'test/acc_align': 83.799}
[6 / 10] best valid accuracy: 82.374 at epoch 6 
 best_stats: {'best_valid_epoch': 6, 'best_valid_valid/acc': 90.132, 'best_valid_valid/acc_unbiased': 82.374, 'best_valid_valid/diff': 2.195, 'best_valid_valid/acc_skew': 82.464, 'best_valid_valid/acc_align': 82.285, 'best_valid_test/acc': 90.255, 'best_valid_test/acc_unbiased': 83.018, 'best_valid_test/diff': 1.562, 'best_valid_test/acc_skew': 82.237, 'best_valid_test/acc_align': 83.799}
[6 / 10] best test accuracy: 83.018 at epoch 6 
 best_stats: {'best_test_epoch': 6, 'best_test_valid/acc': 90.132, 'best_test_valid/acc_unbiased': 82.374, 'best_test_valid/diff': 2.195, 'best_test_valid/acc_skew': 82.464, 'best_test_valid/acc_align': 82.285, 'best_test_test/acc': 90.255, 'best_test_test/acc_unbiased': 83.018, 'best_test_test/diff': 1.562, 'best_test_test/acc_skew': 82.237, 'best_test_test/acc_align': 83.799}
[7 / 10] Learning rate: 1e-05 weight: 0.01
[7 / 10] Loss: 4.772867303570126 CE Loss: 0.24202621167471033 Con Loss: 4.770447040930326
[7 / 10] tensor([[0.958, 0.931],
        [0.723, 0.723]]) {'epoch': 7, 'valid/acc': 90.197, 'valid/acc_unbiased': 83.114, 'valid/diff': 2.425, 'valid/acc_skew': 83.225, 'valid/acc_align': 83.003, 'test/acc': 90.069, 'test/acc_unbiased': 83.371, 'test/diff': 1.359, 'test/acc_skew': 82.691, 'test/acc_align': 84.051}
[7 / 10] best valid accuracy: 83.114 at epoch 7 
 best_stats: {'best_valid_epoch': 7, 'best_valid_valid/acc': 90.197, 'best_valid_valid/acc_unbiased': 83.114, 'best_valid_valid/diff': 2.425, 'best_valid_valid/acc_skew': 83.225, 'best_valid_valid/acc_align': 83.003, 'best_valid_test/acc': 90.069, 'best_valid_test/acc_unbiased': 83.371, 'best_valid_test/diff': 1.359, 'best_valid_test/acc_skew': 82.691, 'best_valid_test/acc_align': 84.051}
[7 / 10] best test accuracy: 83.371 at epoch 7 
 best_stats: {'best_test_epoch': 7, 'best_test_valid/acc': 90.197, 'best_test_valid/acc_unbiased': 83.114, 'best_test_valid/diff': 2.425, 'best_test_valid/acc_skew': 83.225, 'best_test_valid/acc_align': 83.003, 'best_test_test/acc': 90.069, 'best_test_test/acc_unbiased': 83.371, 'best_test_test/diff': 1.359, 'best_test_test/acc_skew': 82.691, 'best_test_test/acc_align': 84.051}
[8 / 10] Learning rate: 1e-05 weight: 0.01
[8 / 10] Loss: 4.768749180020313 CE Loss: 0.23985720315211648 Con Loss: 4.766350602625206
[8 / 10] tensor([[0.960, 0.936],
        [0.709, 0.705]]) {'epoch': 8, 'valid/acc': 90.106, 'valid/acc_unbiased': 82.486, 'valid/diff': 3.225, 'valid/acc_skew': 83.184, 'valid/acc_align': 81.787, 'test/acc': 89.993, 'test/acc_unbiased': 82.733, 'test/diff': 1.427, 'test/acc_skew': 82.202, 'test/acc_align': 83.264}
[8 / 10] best valid accuracy: 83.114 at epoch 7 
 best_stats: {'best_valid_epoch': 7, 'best_valid_valid/acc': 90.197, 'best_valid_valid/acc_unbiased': 83.114, 'best_valid_valid/diff': 2.425, 'best_valid_valid/acc_skew': 83.225, 'best_valid_valid/acc_align': 83.003, 'best_valid_test/acc': 90.069, 'best_valid_test/acc_unbiased': 83.371, 'best_valid_test/diff': 1.359, 'best_valid_test/acc_skew': 82.691, 'best_valid_test/acc_align': 84.051}
[8 / 10] best test accuracy: 83.371 at epoch 7 
 best_stats: {'best_test_epoch': 7, 'best_test_valid/acc': 90.197, 'best_test_valid/acc_unbiased': 83.114, 'best_test_valid/diff': 2.425, 'best_test_valid/acc_skew': 83.225, 'best_test_valid/acc_align': 83.003, 'best_test_test/acc': 90.069, 'best_test_test/acc_unbiased': 83.371, 'best_test_test/diff': 1.359, 'best_test_test/acc_skew': 82.691, 'best_test_test/acc_align': 84.051}
[9 / 10] Learning rate: 1e-05 weight: 0.01
[9 / 10] Loss: 4.7660863338733925 CE Loss: 0.23730154799270053 Con Loss: 4.7637133249490375
[9 / 10] tensor([[0.962, 0.934],
        [0.712, 0.708]]) {'epoch': 9, 'valid/acc': 90.22, 'valid/acc_unbiased': 82.475, 'valid/diff': 2.596, 'valid/acc_skew': 82.808, 'valid/acc_align': 82.141, 'test/acc': 90.099, 'test/acc_unbiased': 82.91, 'test/diff': 1.578, 'test/acc_skew': 82.324, 'test/acc_align': 83.497}
[9 / 10] best valid accuracy: 83.114 at epoch 7 
 best_stats: {'best_valid_epoch': 7, 'best_valid_valid/acc': 90.197, 'best_valid_valid/acc_unbiased': 83.114, 'best_valid_valid/diff': 2.425, 'best_valid_valid/acc_skew': 83.225, 'best_valid_valid/acc_align': 83.003, 'best_valid_test/acc': 90.069, 'best_valid_test/acc_unbiased': 83.371, 'best_valid_test/diff': 1.359, 'best_valid_test/acc_skew': 82.691, 'best_valid_test/acc_align': 84.051}
[9 / 10] best test accuracy: 83.371 at epoch 7 
 best_stats: {'best_test_epoch': 7, 'best_test_valid/acc': 90.197, 'best_test_valid/acc_unbiased': 83.114, 'best_test_valid/diff': 2.425, 'best_test_valid/acc_skew': 83.225, 'best_test_valid/acc_align': 83.003, 'best_test_test/acc': 90.069, 'best_test_test/acc_unbiased': 83.371, 'best_test_test/diff': 1.359, 'best_test_test/acc_skew': 82.691, 'best_test_test/acc_align': 84.051}
[10 / 10] Learning rate: 1e-05 weight: 0.01
[10 / 10] Loss: 4.769178528535961 CE Loss: 0.23653651346447183 Con Loss: 4.7668131601231
[10 / 10] tensor([[0.961, 0.927],
        [0.714, 0.732]]) {'epoch': 10, 'valid/acc': 90.347, 'valid/acc_unbiased': 83.223, 'valid/diff': 2.216, 'valid/acc_skew': 83.047, 'valid/acc_align': 83.398, 'test/acc': 90.139, 'test/acc_unbiased': 83.343, 'test/diff': 2.628, 'test/acc_skew': 82.029, 'test/acc_align': 84.657}
[10 / 10] best valid accuracy: 83.223 at epoch 10 
 best_stats: {'best_valid_epoch': 10, 'best_valid_valid/acc': 90.347, 'best_valid_valid/acc_unbiased': 83.223, 'best_valid_valid/diff': 2.216, 'best_valid_valid/acc_skew': 83.047, 'best_valid_valid/acc_align': 83.398, 'best_valid_test/acc': 90.139, 'best_valid_test/acc_unbiased': 83.343, 'best_valid_test/diff': 2.628, 'best_valid_test/acc_skew': 82.029, 'best_valid_test/acc_align': 84.657}
[10 / 10] best test accuracy: 83.371 at epoch 7 
 best_stats: {'best_test_epoch': 7, 'best_test_valid/acc': 90.197, 'best_test_valid/acc_unbiased': 83.114, 'best_test_valid/diff': 2.425, 'best_test_valid/acc_skew': 83.225, 'best_test_valid/acc_align': 83.003, 'best_test_test/acc': 90.069, 'best_test_test/acc_unbiased': 83.371, 'best_test_test/diff': 1.359, 'best_test_test/acc_skew': 82.691, 'best_test_test/acc_align': 84.051}
Total training time: 1:10:34
