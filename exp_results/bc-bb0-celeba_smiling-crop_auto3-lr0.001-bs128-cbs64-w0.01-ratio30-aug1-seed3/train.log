Log level set to: INFO
Set seed: 3
=======> Using Fixed Random Seed: 3 <========
save_path: exp_results/bc-bb0-celeba_smiling-crop_auto3-lr0.001-bs128-cbs64-w0.01-ratio30-aug1-seed3
get_celeba - split:train, aug: False, given_y: True, ratio: 0
use existing smiling indices from data/celeba/pickles/smiling
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [8009, 32847]
Target 1: [40621, 7981]
Binary Target 1
---------------------------
Target 0: [8009, 32847]
Target 1: [40621, 7981]
===================================
Normal Label Distribution: 
Target 0: [8009, 32847]
Target 1: [40621, 7981]
===================================
Use BiasedCelebASplit 
 target_attr: smiling split: train 
 tensor([[ 8009., 40621.],
        [32847.,  7981.]])
get_celeba - split:train, aug: 1, given_y: True, ratio: 30
use existing smiling indices from data/celeba/pickles/smiling
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [8017, 32729]
Target 1: [40802, 7910]
Binary Target 1
---------------------------
Target 0: [8017, 32729]
Target 1: [40802, 7910]
===================================
Normal Label Distribution: 
Target 0: [8017, 32729]
Target 1: [40802, 7910]
===================================
Use BiasedCelebASplit 
 target_attr: smiling split: train 
 tensor([[ 8017., 40802.],
        [32729.,  7910.]])
get_celeba - split:train_valid, aug: False, given_y: True, ratio: 0
use existing smiling indices from data/celeba/pickles/smiling
Use BiasedCelebASplit 
 target_attr: smiling split: train_valid 
 tensor([[ 1944., 10217.],
        [ 8222.,  1982.]])
get_celeba - split:valid, aug: False, given_y: True, ratio: 0
Use BiasedCelebASplit 
 target_attr: smiling split: valid 
 tensor([[5252., 6157.],
        [5013., 3445.]])
decay_epochs: [3, 6]
[1 / 10] Learning rate: 0.001 weight: 0.01
[1 / 10] Loss: 4.688377815152257 CE Loss: 0.26478394071376576 Con Loss: 4.685729973155591
[1 / 10] tensor([[0.956, 0.956],
        [0.882, 0.833]]) {'epoch': 1, 'valid/acc': 90.749, 'valid/acc_unbiased': 90.676, 'valid/diff': 1.323, 'valid/acc_skew': 90.014, 'valid/acc_align': 91.337, 'test/acc': 91.141, 'test/acc_unbiased': 90.641, 'test/diff': 2.479, 'test/acc_skew': 89.426, 'test/acc_align': 91.856}
[1 / 10] best valid accuracy: 90.676 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 90.749, 'best_valid_valid/acc_unbiased': 90.676, 'best_valid_valid/diff': 1.323, 'best_valid_valid/acc_skew': 90.014, 'best_valid_valid/acc_align': 91.337, 'best_valid_test/acc': 91.141, 'best_valid_test/acc_unbiased': 90.641, 'best_valid_test/diff': 2.479, 'best_valid_test/acc_skew': 89.426, 'best_valid_test/acc_align': 91.856}
[1 / 10] best test accuracy: 90.641 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 90.749, 'best_test_valid/acc_unbiased': 90.676, 'best_test_valid/diff': 1.323, 'best_test_valid/acc_skew': 90.014, 'best_test_valid/acc_align': 91.337, 'best_test_test/acc': 91.141, 'best_test_test/acc_unbiased': 90.641, 'best_test_test/diff': 2.479, 'best_test_test/acc_skew': 89.426, 'best_test_test/acc_align': 91.856}
[2 / 10] Learning rate: 0.001 weight: 0.01
[2 / 10] Loss: 4.640479774424353 CE Loss: 0.2158219773723698 Con Loss: 4.638321561313799
[2 / 10] tensor([[0.915, 0.916],
        [0.922, 0.903]]) {'epoch': 2, 'valid/acc': 91.491, 'valid/acc_unbiased': 91.415, 'valid/diff': 1.374, 'valid/acc_skew': 91.373, 'valid/acc_align': 91.457, 'test/acc': 91.534, 'test/acc_unbiased': 91.396, 'test/diff': 1.009, 'test/acc_skew': 90.892, 'test/acc_align': 91.901}
[2 / 10] best valid accuracy: 91.415 at epoch 2 
 best_stats: {'best_valid_epoch': 2, 'best_valid_valid/acc': 91.491, 'best_valid_valid/acc_unbiased': 91.415, 'best_valid_valid/diff': 1.374, 'best_valid_valid/acc_skew': 91.373, 'best_valid_valid/acc_align': 91.457, 'best_valid_test/acc': 91.534, 'best_valid_test/acc_unbiased': 91.396, 'best_valid_test/diff': 1.009, 'best_valid_test/acc_skew': 90.892, 'best_valid_test/acc_align': 91.901}
[2 / 10] best test accuracy: 91.396 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 91.491, 'best_test_valid/acc_unbiased': 91.415, 'best_test_valid/diff': 1.374, 'best_test_valid/acc_skew': 91.373, 'best_test_valid/acc_align': 91.457, 'best_test_test/acc': 91.534, 'best_test_test/acc_unbiased': 91.396, 'best_test_test/diff': 1.009, 'best_test_test/acc_skew': 90.892, 'best_test_test/acc_align': 91.901}
[3 / 10] Learning rate: 0.001 weight: 0.01
[3 / 10] Loss: 4.633866844044202 CE Loss: 0.21908560073757619 Con Loss: 4.631675983851029
[3 / 10] tensor([[0.980, 0.969],
        [0.847, 0.823]]) {'epoch': 3, 'valid/acc': 90.172, 'valid/acc_unbiased': 90.48, 'valid/diff': 1.214, 'valid/acc_skew': 90.111, 'valid/acc_align': 90.849, 'test/acc': 90.894, 'test/acc_unbiased': 90.488, 'test/diff': 1.735, 'test/acc_skew': 90.128, 'test/acc_align': 90.849}
[3 / 10] best valid accuracy: 91.415 at epoch 2 
 best_stats: {'best_valid_epoch': 2, 'best_valid_valid/acc': 91.491, 'best_valid_valid/acc_unbiased': 91.415, 'best_valid_valid/diff': 1.374, 'best_valid_valid/acc_skew': 91.373, 'best_valid_valid/acc_align': 91.457, 'best_valid_test/acc': 91.534, 'best_valid_test/acc_unbiased': 91.396, 'best_valid_test/diff': 1.009, 'best_valid_test/acc_skew': 90.892, 'best_valid_test/acc_align': 91.901}
[3 / 10] best test accuracy: 91.396 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 91.491, 'best_test_valid/acc_unbiased': 91.415, 'best_test_valid/diff': 1.374, 'best_test_valid/acc_skew': 91.373, 'best_test_valid/acc_align': 91.457, 'best_test_test/acc': 91.534, 'best_test_test/acc_unbiased': 91.396, 'best_test_test/diff': 1.009, 'best_test_test/acc_skew': 90.892, 'best_test_test/acc_align': 91.901}
[4 / 10] Learning rate: 0.0001 weight: 0.01
[4 / 10] Loss: 4.598208823565754 CE Loss: 0.1892521748828436 Con Loss: 4.596316304750857
[4 / 10] tensor([[0.918, 0.921],
        [0.940, 0.905]]) {'epoch': 4, 'valid/acc': 92.761, 'valid/acc_unbiased': 92.082, 'valid/diff': 1.886, 'valid/acc_skew': 91.139, 'valid/acc_align': 93.025, 'test/acc': 92.314, 'test/acc_unbiased': 92.085, 'test/diff': 1.869, 'test/acc_skew': 91.151, 'test/acc_align': 93.019}
[4 / 10] best valid accuracy: 92.082 at epoch 4 
 best_stats: {'best_valid_epoch': 4, 'best_valid_valid/acc': 92.761, 'best_valid_valid/acc_unbiased': 92.082, 'best_valid_valid/diff': 1.886, 'best_valid_valid/acc_skew': 91.139, 'best_valid_valid/acc_align': 93.025, 'best_valid_test/acc': 92.314, 'best_valid_test/acc_unbiased': 92.085, 'best_valid_test/diff': 1.869, 'best_valid_test/acc_skew': 91.151, 'best_valid_test/acc_align': 93.019}
[4 / 10] best test accuracy: 92.085 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 92.761, 'best_test_valid/acc_unbiased': 92.082, 'best_test_valid/diff': 1.886, 'best_test_valid/acc_skew': 91.139, 'best_test_valid/acc_align': 93.025, 'best_test_test/acc': 92.314, 'best_test_test/acc_unbiased': 92.085, 'best_test_test/diff': 1.869, 'best_test_test/acc_skew': 91.151, 'best_test_test/acc_align': 93.019}
[5 / 10] Learning rate: 0.0001 weight: 0.01
[5 / 10] Loss: 4.580853564134399 CE Loss: 0.18009807055935528 Con Loss: 4.579052586050063
[5 / 10] tensor([[0.911, 0.935],
        [0.942, 0.905]]) {'epoch': 5, 'valid/acc': 93.137, 'valid/acc_unbiased': 92.328, 'valid/diff': 2.322, 'valid/acc_skew': 91.167, 'valid/acc_align': 93.489, 'test/acc': 92.581, 'test/acc_unbiased': 92.342, 'test/diff': 3.03, 'test/acc_skew': 90.827, 'test/acc_align': 93.857}
[5 / 10] best valid accuracy: 92.328 at epoch 5 
 best_stats: {'best_valid_epoch': 5, 'best_valid_valid/acc': 93.137, 'best_valid_valid/acc_unbiased': 92.328, 'best_valid_valid/diff': 2.322, 'best_valid_valid/acc_skew': 91.167, 'best_valid_valid/acc_align': 93.489, 'best_valid_test/acc': 92.581, 'best_valid_test/acc_unbiased': 92.342, 'best_valid_test/diff': 3.03, 'best_valid_test/acc_skew': 90.827, 'best_valid_test/acc_align': 93.857}
[5 / 10] best test accuracy: 92.342 at epoch 5 
 best_stats: {'best_test_epoch': 5, 'best_test_valid/acc': 93.137, 'best_test_valid/acc_unbiased': 92.328, 'best_test_valid/diff': 2.322, 'best_test_valid/acc_skew': 91.167, 'best_test_valid/acc_align': 93.489, 'best_test_test/acc': 92.581, 'best_test_test/acc_unbiased': 92.342, 'best_test_test/diff': 3.03, 'best_test_test/acc_skew': 90.827, 'best_test_test/acc_align': 93.857}
[6 / 10] Learning rate: 0.0001 weight: 0.01
[6 / 10] Loss: 4.575900188636571 CE Loss: 0.17884031567889047 Con Loss: 4.5741117826615
[6 / 10] tensor([[0.924, 0.930],
        [0.935, 0.908]]) {'epoch': 6, 'valid/acc': 92.819, 'valid/acc_unbiased': 92.378, 'valid/diff': 1.553, 'valid/acc_skew': 91.734, 'valid/acc_align': 93.022, 'test/acc': 92.621, 'test/acc_unbiased': 92.433, 'test/diff': 1.655, 'test/acc_skew': 91.606, 'test/acc_align': 93.261}
[6 / 10] best valid accuracy: 92.378 at epoch 6 
 best_stats: {'best_valid_epoch': 6, 'best_valid_valid/acc': 92.819, 'best_valid_valid/acc_unbiased': 92.378, 'best_valid_valid/diff': 1.553, 'best_valid_valid/acc_skew': 91.734, 'best_valid_valid/acc_align': 93.022, 'best_valid_test/acc': 92.621, 'best_valid_test/acc_unbiased': 92.433, 'best_valid_test/diff': 1.655, 'best_valid_test/acc_skew': 91.606, 'best_valid_test/acc_align': 93.261}
[6 / 10] best test accuracy: 92.433 at epoch 6 
 best_stats: {'best_test_epoch': 6, 'best_test_valid/acc': 92.819, 'best_test_valid/acc_unbiased': 92.378, 'best_test_valid/diff': 1.553, 'best_test_valid/acc_skew': 91.734, 'best_test_valid/acc_align': 93.022, 'best_test_test/acc': 92.621, 'best_test_test/acc_unbiased': 92.433, 'best_test_test/diff': 1.655, 'best_test_test/acc_skew': 91.606, 'best_test_test/acc_align': 93.261}
[7 / 10] Learning rate: 1e-05 weight: 0.01
[7 / 10] Loss: 4.572511109593872 CE Loss: 0.17768252893701672 Con Loss: 4.570734283547731
[7 / 10] tensor([[0.919, 0.927],
        [0.942, 0.910]]) {'epoch': 7, 'valid/acc': 92.976, 'valid/acc_unbiased': 92.319, 'valid/diff': 1.8, 'valid/acc_skew': 91.419, 'valid/acc_align': 93.219, 'test/acc': 92.661, 'test/acc_unbiased': 92.453, 'test/diff': 2.015, 'test/acc_skew': 91.445, 'test/acc_align': 93.46}
[7 / 10] best valid accuracy: 92.378 at epoch 6 
 best_stats: {'best_valid_epoch': 6, 'best_valid_valid/acc': 92.819, 'best_valid_valid/acc_unbiased': 92.378, 'best_valid_valid/diff': 1.553, 'best_valid_valid/acc_skew': 91.734, 'best_valid_valid/acc_align': 93.022, 'best_valid_test/acc': 92.621, 'best_valid_test/acc_unbiased': 92.433, 'best_valid_test/diff': 1.655, 'best_valid_test/acc_skew': 91.606, 'best_valid_test/acc_align': 93.261}
[7 / 10] best test accuracy: 92.453 at epoch 7 
 best_stats: {'best_test_epoch': 7, 'best_test_valid/acc': 92.976, 'best_test_valid/acc_unbiased': 92.319, 'best_test_valid/diff': 1.8, 'best_test_valid/acc_skew': 91.419, 'best_test_valid/acc_align': 93.219, 'best_test_test/acc': 92.661, 'best_test_test/acc_unbiased': 92.453, 'best_test_test/diff': 2.015, 'best_test_test/acc_skew': 91.445, 'best_test_test/acc_align': 93.46}
[8 / 10] Learning rate: 1e-05 weight: 0.01
[8 / 10] Loss: 4.571601576407368 CE Loss: 0.17460589446526353 Con Loss: 4.569855519625025
[8 / 10] tensor([[0.919, 0.931],
        [0.942, 0.910]]) {'epoch': 8, 'valid/acc': 93.016, 'valid/acc_unbiased': 92.467, 'valid/diff': 1.576, 'valid/acc_skew': 91.679, 'valid/acc_align': 93.256, 'test/acc': 92.767, 'test/acc_unbiased': 92.553, 'test/diff': 2.206, 'test/acc_skew': 91.45, 'test/acc_align': 93.656}
[8 / 10] best valid accuracy: 92.467 at epoch 8 
 best_stats: {'best_valid_epoch': 8, 'best_valid_valid/acc': 93.016, 'best_valid_valid/acc_unbiased': 92.467, 'best_valid_valid/diff': 1.576, 'best_valid_valid/acc_skew': 91.679, 'best_valid_valid/acc_align': 93.256, 'best_valid_test/acc': 92.767, 'best_valid_test/acc_unbiased': 92.553, 'best_valid_test/diff': 2.206, 'best_valid_test/acc_skew': 91.45, 'best_valid_test/acc_align': 93.656}
[8 / 10] best test accuracy: 92.553 at epoch 8 
 best_stats: {'best_test_epoch': 8, 'best_test_valid/acc': 93.016, 'best_test_valid/acc_unbiased': 92.467, 'best_test_valid/diff': 1.576, 'best_test_valid/acc_skew': 91.679, 'best_test_valid/acc_align': 93.256, 'best_test_test/acc': 92.767, 'best_test_test/acc_unbiased': 92.553, 'best_test_test/diff': 2.206, 'best_test_test/acc_skew': 91.45, 'best_test_test/acc_align': 93.656}
[9 / 10] Learning rate: 1e-05 weight: 0.01
[9 / 10] Loss: 4.563175619705259 CE Loss: 0.17480205134070026 Con Loss: 4.561427596759854
[9 / 10] tensor([[0.924, 0.931],
        [0.938, 0.907]]) {'epoch': 9, 'valid/acc': 93.181, 'valid/acc_unbiased': 92.471, 'valid/diff': 2.094, 'valid/acc_skew': 91.424, 'valid/acc_align': 93.518, 'test/acc': 92.717, 'test/acc_unbiased': 92.496, 'test/diff': 1.917, 'test/acc_skew': 91.538, 'test/acc_align': 93.455}
[9 / 10] best valid accuracy: 92.471 at epoch 9 
 best_stats: {'best_valid_epoch': 9, 'best_valid_valid/acc': 93.181, 'best_valid_valid/acc_unbiased': 92.471, 'best_valid_valid/diff': 2.094, 'best_valid_valid/acc_skew': 91.424, 'best_valid_valid/acc_align': 93.518, 'best_valid_test/acc': 92.717, 'best_valid_test/acc_unbiased': 92.496, 'best_valid_test/diff': 1.917, 'best_valid_test/acc_skew': 91.538, 'best_valid_test/acc_align': 93.455}
[9 / 10] best test accuracy: 92.553 at epoch 8 
 best_stats: {'best_test_epoch': 8, 'best_test_valid/acc': 93.016, 'best_test_valid/acc_unbiased': 92.467, 'best_test_valid/diff': 1.576, 'best_test_valid/acc_skew': 91.679, 'best_test_valid/acc_align': 93.256, 'best_test_test/acc': 92.767, 'best_test_test/acc_unbiased': 92.553, 'best_test_test/diff': 2.206, 'best_test_test/acc_skew': 91.45, 'best_test_test/acc_align': 93.656}
[10 / 10] Learning rate: 1e-05 weight: 0.01
[10 / 10] Loss: 4.564983292432343 CE Loss: 0.17376939018190063 Con Loss: 4.563245590507775
[10 / 10] tensor([[0.914, 0.923],
        [0.946, 0.914]]) {'epoch': 10, 'valid/acc': 93.092, 'valid/acc_unbiased': 92.421, 'valid/diff': 1.803, 'valid/acc_skew': 91.52, 'valid/acc_align': 93.323, 'test/acc': 92.611, 'test/acc_unbiased': 92.419, 'test/diff': 2.037, 'test/acc_skew': 91.401, 'test/acc_align': 93.438}
[10 / 10] best valid accuracy: 92.471 at epoch 9 
 best_stats: {'best_valid_epoch': 9, 'best_valid_valid/acc': 93.181, 'best_valid_valid/acc_unbiased': 92.471, 'best_valid_valid/diff': 2.094, 'best_valid_valid/acc_skew': 91.424, 'best_valid_valid/acc_align': 93.518, 'best_valid_test/acc': 92.717, 'best_valid_test/acc_unbiased': 92.496, 'best_valid_test/diff': 1.917, 'best_valid_test/acc_skew': 91.538, 'best_valid_test/acc_align': 93.455}
[10 / 10] best test accuracy: 92.553 at epoch 8 
 best_stats: {'best_test_epoch': 8, 'best_test_valid/acc': 93.016, 'best_test_valid/acc_unbiased': 92.467, 'best_test_valid/diff': 1.576, 'best_test_valid/acc_skew': 91.679, 'best_test_valid/acc_align': 93.256, 'best_test_test/acc': 92.767, 'best_test_test/acc_unbiased': 92.553, 'best_test_test/diff': 2.206, 'best_test_test/acc_skew': 91.45, 'best_test_test/acc_align': 93.656}
Total training time: 1:39:07
