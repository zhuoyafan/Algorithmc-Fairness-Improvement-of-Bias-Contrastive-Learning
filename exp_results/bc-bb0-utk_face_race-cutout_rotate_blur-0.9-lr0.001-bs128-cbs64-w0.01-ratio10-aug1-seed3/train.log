Log level set to: INFO
Set seed: 3
=======> Using Fixed Random Seed: 3 <========
save_path: exp_results/bc-bb0-utk_face_race-cutout_rotate_blur-0.9-lr0.001-bs128-cbs64-w0.01-ratio10-aug1-seed3
get_utk_face - split: train, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_race-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [4407, 552]
Target 1: [440, 5529]
Binary Target 1
---------------------------
Target 0: [4407, 552]
Target 1: [440, 5529]
===================================
Normal Label Distribution: 
Target 0: [4407, 552]
Target 1: [440, 5529]
===================================
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [4407, 552]
Target 1: [440, 5529]
Binary Target 1
---------------------------
Target 0: [4407, 552]
Target 1: [440, 5529]
===================================
Normal Label Distribution: 
Target 0: [4407, 552]
Target 1: [440, 5529]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 10928, target_attr: gender, bias_attr: race bias_rate: 0.9
['[train] target_0-bias_0: 4407', '[train] target_0-bias_1: 552', '[train] target_1-bias_0: 440', '[train] target_1-bias_1: 5529']
confusion_matrix - 
 original: tensor([[4407.,  440.],
        [ 552., 5529.]]), 
 normalized: tensor([[0.909, 0.091],
        [0.091, 0.909]]), 
 b|y: tensor([[0.889, 0.111],
        [0.074, 0.926]])
get_utk_face - split: train, aug: 1, given_y: True, ratio: 10
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_race-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [4407, 552]
Target 1: [440, 5529]
Binary Target 1
---------------------------
Target 0: [4407, 552]
Target 1: [440, 5529]
===================================
Normal Label Distribution: 
Target 0: [4407, 552]
Target 1: [440, 5529]
===================================
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [4407, 552]
Target 1: [440, 5529]
Binary Target 1
---------------------------
Target 0: [4407, 552]
Target 1: [440, 5529]
===================================
Normal Label Distribution: 
Target 0: [4407, 552]
Target 1: [440, 5529]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 10928, target_attr: gender, bias_attr: race bias_rate: 0.9
['[train] target_0-bias_0: 4407', '[train] target_0-bias_1: 552', '[train] target_1-bias_0: 440', '[train] target_1-bias_1: 5529']
get_utk_face - split: valid, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_race-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [583, 684]
Target 1: [457, 646]
Binary Target 1
---------------------------
Target 0: [583, 684]
Target 1: [457, 646]
===================================
Normal Label Distribution: 
Target 0: [583, 684]
Target 1: [457, 646]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 2370, target_attr: gender, bias_attr: race bias_rate: 0.9
['[valid] target_0-bias_0: 583', '[valid] target_0-bias_1: 684', '[valid] target_1-bias_0: 457', '[valid] target_1-bias_1: 646']
get_utk_face - split: test, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_race-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [558, 677]
Target 1: [462, 673]
Binary Target 1
---------------------------
Target 0: [558, 677]
Target 1: [462, 673]
===================================
Normal Label Distribution: 
Target 0: [558, 677]
Target 1: [462, 673]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 2370, target_attr: gender, bias_attr: race bias_rate: 0.9
['[test] target_0-bias_0: 558', '[test] target_0-bias_1: 677', '[test] target_1-bias_0: 462', '[test] target_1-bias_1: 673']
decay_epochs: [6, 13]
[1 / 20] Learning rate: 0.001 weight: 0.01
[1 / 20] Loss: 4.910460451860554 CE Loss: 0.6438898601259704 Con Loss: 4.90402155355339
[1 / 20] tensor([[0.532, 0.514],
        [0.851, 0.859]]) {'epoch': 1, 'valid/acc': 67.384, 'valid/acc_unbiased': 68.401, 'valid/diff': 1.749, 'valid/acc_skew': 67.526, 'valid/acc_align': 69.275, 'test/acc': 68.186, 'test/acc_unbiased': 68.895, 'test/diff': 1.321, 'test/acc_skew': 68.234, 'test/acc_align': 69.555}
[1 / 20] best valid accuracy: 68.401 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 67.384, 'best_valid_valid/acc_unbiased': 68.401, 'best_valid_valid/diff': 1.749, 'best_valid_valid/acc_skew': 67.526, 'best_valid_valid/acc_align': 69.275, 'best_valid_test/acc': 68.186, 'best_valid_test/acc_unbiased': 68.895, 'best_valid_test/diff': 1.321, 'best_valid_test/acc_skew': 68.234, 'best_valid_test/acc_align': 69.555}
[1 / 20] best test accuracy: 68.895 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 67.384, 'best_test_valid/acc_unbiased': 68.401, 'best_test_valid/diff': 1.749, 'best_test_valid/acc_skew': 67.526, 'best_test_valid/acc_align': 69.275, 'best_test_test/acc': 68.186, 'best_test_test/acc_unbiased': 68.895, 'best_test_test/diff': 1.321, 'best_test_test/acc_skew': 68.234, 'best_test_test/acc_align': 69.555}
[2 / 20] Learning rate: 0.001 weight: 0.01
[2 / 20] Loss: 4.83682348298817 CE Loss: 0.5813176437317888 Con Loss: 4.831010322794209
[2 / 20] tensor([[0.670, 0.631],
        [0.755, 0.825]]) {'epoch': 2, 'valid/acc': 71.772, 'valid/acc_unbiased': 71.741, 'valid/diff': 5.628, 'valid/acc_skew': 68.927, 'valid/acc_align': 74.555, 'test/acc': 71.941, 'test/acc_unbiased': 72.026, 'test/diff': 5.439, 'test/acc_skew': 69.307, 'test/acc_align': 74.746}
[2 / 20] best valid accuracy: 71.741 at epoch 2 
 best_stats: {'best_valid_epoch': 2, 'best_valid_valid/acc': 71.772, 'best_valid_valid/acc_unbiased': 71.741, 'best_valid_valid/diff': 5.628, 'best_valid_valid/acc_skew': 68.927, 'best_valid_valid/acc_align': 74.555, 'best_valid_test/acc': 71.941, 'best_valid_test/acc_unbiased': 72.026, 'best_valid_test/diff': 5.439, 'best_valid_test/acc_skew': 69.307, 'best_valid_test/acc_align': 74.746}
[2 / 20] best test accuracy: 72.026 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 71.772, 'best_test_valid/acc_unbiased': 71.741, 'best_test_valid/diff': 5.628, 'best_test_valid/acc_skew': 68.927, 'best_test_valid/acc_align': 74.555, 'best_test_test/acc': 71.941, 'best_test_test/acc_unbiased': 72.026, 'best_test_test/diff': 5.439, 'best_test_test/acc_skew': 69.307, 'best_test_test/acc_align': 74.746}
[3 / 20] Learning rate: 0.001 weight: 0.01
[3 / 20] Loss: 4.830115293863053 CE Loss: 0.5670877580761385 Con Loss: 4.8244444035855425
[3 / 20] tensor([[0.801, 0.737],
        [0.615, 0.749]]) {'epoch': 3, 'valid/acc': 74.051, 'valid/acc_unbiased': 73.213, 'valid/diff': 7.013, 'valid/acc_skew': 69.706, 'valid/acc_align': 76.72, 'test/acc': 73.165, 'test/acc_unbiased': 72.544, 'test/diff': 9.908, 'test/acc_skew': 67.59, 'test/acc_align': 77.498}
[3 / 20] best valid accuracy: 73.213 at epoch 3 
 best_stats: {'best_valid_epoch': 3, 'best_valid_valid/acc': 74.051, 'best_valid_valid/acc_unbiased': 73.213, 'best_valid_valid/diff': 7.013, 'best_valid_valid/acc_skew': 69.706, 'best_valid_valid/acc_align': 76.72, 'best_valid_test/acc': 73.165, 'best_valid_test/acc_unbiased': 72.544, 'best_valid_test/diff': 9.908, 'best_valid_test/acc_skew': 67.59, 'best_valid_test/acc_align': 77.498}
[3 / 20] best test accuracy: 72.544 at epoch 3 
 best_stats: {'best_test_epoch': 3, 'best_test_valid/acc': 74.051, 'best_test_valid/acc_unbiased': 73.213, 'best_test_valid/diff': 7.013, 'best_test_valid/acc_skew': 69.706, 'best_test_valid/acc_align': 76.72, 'best_test_test/acc': 73.165, 'best_test_test/acc_unbiased': 72.544, 'best_test_test/diff': 9.908, 'best_test_test/acc_skew': 67.59, 'best_test_test/acc_align': 77.498}
[4 / 20] Learning rate: 0.001 weight: 0.01
[4 / 20] Loss: 4.820271896931996 CE Loss: 0.5746076795576607 Con Loss: 4.814525826260077
[4 / 20] tensor([[0.726, 0.657],
        [0.753, 0.825]]) {'epoch': 4, 'valid/acc': 74.599, 'valid/acc_unbiased': 74.479, 'valid/diff': 6.427, 'valid/acc_skew': 71.266, 'valid/acc_align': 77.693, 'test/acc': 73.966, 'test/acc_unbiased': 74.026, 'test/diff': 6.996, 'test/acc_skew': 70.528, 'test/acc_align': 77.524}
[4 / 20] best valid accuracy: 74.479 at epoch 4 
 best_stats: {'best_valid_epoch': 4, 'best_valid_valid/acc': 74.599, 'best_valid_valid/acc_unbiased': 74.479, 'best_valid_valid/diff': 6.427, 'best_valid_valid/acc_skew': 71.266, 'best_valid_valid/acc_align': 77.693, 'best_valid_test/acc': 73.966, 'best_valid_test/acc_unbiased': 74.026, 'best_valid_test/diff': 6.996, 'best_valid_test/acc_skew': 70.528, 'best_valid_test/acc_align': 77.524}
[4 / 20] best test accuracy: 74.026 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 74.599, 'best_test_valid/acc_unbiased': 74.479, 'best_test_valid/diff': 6.427, 'best_test_valid/acc_skew': 71.266, 'best_test_valid/acc_align': 77.693, 'best_test_test/acc': 73.966, 'best_test_test/acc_unbiased': 74.026, 'best_test_test/diff': 6.996, 'best_test_test/acc_skew': 70.528, 'best_test_test/acc_align': 77.524}
[5 / 20] Learning rate: 0.001 weight: 0.01
[5 / 20] Loss: 4.806825974326182 CE Loss: 0.5713857242163941 Con Loss: 4.801112128909825
[5 / 20] tensor([[0.692, 0.693],
        [0.762, 0.795]]) {'epoch': 5, 'valid/acc': 72.869, 'valid/acc_unbiased': 73.101, 'valid/diff': 1.845, 'valid/acc_skew': 73.745, 'valid/acc_align': 72.457, 'test/acc': 73.502, 'test/acc_unbiased': 73.534, 'test/diff': 1.702, 'test/acc_skew': 72.733, 'test/acc_align': 74.335}
[5 / 20] best valid accuracy: 74.479 at epoch 4 
 best_stats: {'best_valid_epoch': 4, 'best_valid_valid/acc': 74.599, 'best_valid_valid/acc_unbiased': 74.479, 'best_valid_valid/diff': 6.427, 'best_valid_valid/acc_skew': 71.266, 'best_valid_valid/acc_align': 77.693, 'best_valid_test/acc': 73.966, 'best_valid_test/acc_unbiased': 74.026, 'best_valid_test/diff': 6.996, 'best_valid_test/acc_skew': 70.528, 'best_valid_test/acc_align': 77.524}
[5 / 20] best test accuracy: 74.026 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 74.599, 'best_test_valid/acc_unbiased': 74.479, 'best_test_valid/diff': 6.427, 'best_test_valid/acc_skew': 71.266, 'best_test_valid/acc_align': 77.693, 'best_test_test/acc': 73.966, 'best_test_test/acc_unbiased': 74.026, 'best_test_test/diff': 6.996, 'best_test_test/acc_skew': 70.528, 'best_test_test/acc_align': 77.524}
[6 / 20] Learning rate: 0.001 weight: 0.01
[6 / 20] Loss: 4.803255320642563 CE Loss: 0.5692967497586855 Con Loss: 4.797562377170099
[6 / 20] tensor([[0.875, 0.846],
        [0.481, 0.572]]) {'epoch': 6, 'valid/acc': 71.392, 'valid/acc_unbiased': 69.848, 'valid/diff': 6.978, 'valid/acc_skew': 66.359, 'valid/acc_align': 73.337, 'test/acc': 70.38, 'test/acc_unbiased': 69.338, 'test/diff': 5.986, 'test/acc_skew': 66.345, 'test/acc_align': 72.331}
[6 / 20] best valid accuracy: 74.479 at epoch 4 
 best_stats: {'best_valid_epoch': 4, 'best_valid_valid/acc': 74.599, 'best_valid_valid/acc_unbiased': 74.479, 'best_valid_valid/diff': 6.427, 'best_valid_valid/acc_skew': 71.266, 'best_valid_valid/acc_align': 77.693, 'best_valid_test/acc': 73.966, 'best_valid_test/acc_unbiased': 74.026, 'best_valid_test/diff': 6.996, 'best_valid_test/acc_skew': 70.528, 'best_valid_test/acc_align': 77.524}
[6 / 20] best test accuracy: 74.026 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 74.599, 'best_test_valid/acc_unbiased': 74.479, 'best_test_valid/diff': 6.427, 'best_test_valid/acc_skew': 71.266, 'best_test_valid/acc_align': 77.693, 'best_test_test/acc': 73.966, 'best_test_test/acc_unbiased': 74.026, 'best_test_test/diff': 6.996, 'best_test_test/acc_skew': 70.528, 'best_test_test/acc_align': 77.524}
[7 / 20] Learning rate: 0.0001 weight: 0.01
[7 / 20] Loss: 4.776107297983909 CE Loss: 0.5428390828442609 Con Loss: 4.770678865089249
[7 / 20] tensor([[0.801, 0.747],
        [0.699, 0.773]]) {'epoch': 7, 'valid/acc': 76.962, 'valid/acc_unbiased': 76.655, 'valid/diff': 4.126, 'valid/acc_skew': 74.592, 'valid/acc_align': 78.718, 'test/acc': 75.781, 'test/acc_unbiased': 75.507, 'test/diff': 6.359, 'test/acc_skew': 72.327, 'test/acc_align': 78.687}
[7 / 20] best valid accuracy: 76.655 at epoch 7 
 best_stats: {'best_valid_epoch': 7, 'best_valid_valid/acc': 76.962, 'best_valid_valid/acc_unbiased': 76.655, 'best_valid_valid/diff': 4.126, 'best_valid_valid/acc_skew': 74.592, 'best_valid_valid/acc_align': 78.718, 'best_valid_test/acc': 75.781, 'best_valid_test/acc_unbiased': 75.507, 'best_valid_test/diff': 6.359, 'best_valid_test/acc_skew': 72.327, 'best_valid_test/acc_align': 78.687}
[7 / 20] best test accuracy: 75.507 at epoch 7 
 best_stats: {'best_test_epoch': 7, 'best_test_valid/acc': 76.962, 'best_test_valid/acc_unbiased': 76.655, 'best_test_valid/diff': 4.126, 'best_test_valid/acc_skew': 74.592, 'best_test_valid/acc_align': 78.718, 'best_test_test/acc': 75.781, 'best_test_test/acc_unbiased': 75.507, 'best_test_test/diff': 6.359, 'best_test_test/acc_skew': 72.327, 'best_test_test/acc_align': 78.687}
[8 / 20] Learning rate: 0.0001 weight: 0.01
[8 / 20] Loss: 4.754678451822931 CE Loss: 0.5195267058221696 Con Loss: 4.749483201374596
[8 / 20] tensor([[0.737, 0.668],
        [0.786, 0.857]]) {'epoch': 8, 'valid/acc': 77.046, 'valid/acc_unbiased': 77.416, 'valid/diff': 5.303, 'valid/acc_skew': 74.765, 'valid/acc_align': 80.067, 'test/acc': 76.076, 'test/acc_unbiased': 76.182, 'test/diff': 7.027, 'test/acc_skew': 72.668, 'test/acc_align': 79.696}
[8 / 20] best valid accuracy: 77.416 at epoch 8 
 best_stats: {'best_valid_epoch': 8, 'best_valid_valid/acc': 77.046, 'best_valid_valid/acc_unbiased': 77.416, 'best_valid_valid/diff': 5.303, 'best_valid_valid/acc_skew': 74.765, 'best_valid_valid/acc_align': 80.067, 'best_valid_test/acc': 76.076, 'best_valid_test/acc_unbiased': 76.182, 'best_valid_test/diff': 7.027, 'best_valid_test/acc_skew': 72.668, 'best_valid_test/acc_align': 79.696}
[8 / 20] best test accuracy: 76.182 at epoch 8 
 best_stats: {'best_test_epoch': 8, 'best_test_valid/acc': 77.046, 'best_test_valid/acc_unbiased': 77.416, 'best_test_valid/diff': 5.303, 'best_test_valid/acc_skew': 74.765, 'best_test_valid/acc_align': 80.067, 'best_test_test/acc': 76.076, 'best_test_test/acc_unbiased': 76.182, 'best_test_test/diff': 7.027, 'best_test_test/acc_skew': 72.668, 'best_test_test/acc_align': 79.696}
[9 / 20] Learning rate: 0.0001 weight: 0.01
[9 / 20] Loss: 4.735423369428599 CE Loss: 0.5061117330372421 Con Loss: 4.7303622582297375
[9 / 20] tensor([[0.713, 0.663],
        [0.781, 0.871]]) {'epoch': 9, 'valid/acc': 76.287, 'valid/acc_unbiased': 76.659, 'valid/diff': 4.227, 'valid/acc_skew': 74.545, 'valid/acc_align': 78.772, 'test/acc': 75.696, 'test/acc_unbiased': 75.715, 'test/diff': 6.969, 'test/acc_skew': 72.23, 'test/acc_align': 79.199}
[9 / 20] best valid accuracy: 77.416 at epoch 8 
 best_stats: {'best_valid_epoch': 8, 'best_valid_valid/acc': 77.046, 'best_valid_valid/acc_unbiased': 77.416, 'best_valid_valid/diff': 5.303, 'best_valid_valid/acc_skew': 74.765, 'best_valid_valid/acc_align': 80.067, 'best_valid_test/acc': 76.076, 'best_valid_test/acc_unbiased': 76.182, 'best_valid_test/diff': 7.027, 'best_valid_test/acc_skew': 72.668, 'best_valid_test/acc_align': 79.696}
[9 / 20] best test accuracy: 76.182 at epoch 8 
 best_stats: {'best_test_epoch': 8, 'best_test_valid/acc': 77.046, 'best_test_valid/acc_unbiased': 77.416, 'best_test_valid/diff': 5.303, 'best_test_valid/acc_skew': 74.765, 'best_test_valid/acc_align': 80.067, 'best_test_test/acc': 76.076, 'best_test_test/acc_unbiased': 76.182, 'best_test_test/diff': 7.027, 'best_test_test/acc_skew': 72.668, 'best_test_test/acc_align': 79.696}
[10 / 20] Learning rate: 0.0001 weight: 0.01
[10 / 20] Loss: 4.723277841794194 CE Loss: 0.5000842952798087 Con Loss: 4.718276988709479
[10 / 20] tensor([[0.776, 0.731],
        [0.762, 0.825]]) {'epoch': 10, 'valid/acc': 78.312, 'valid/acc_unbiased': 78.243, 'valid/diff': 3.657, 'valid/acc_skew': 76.414, 'valid/acc_align': 80.071, 'test/acc': 77.426, 'test/acc_unbiased': 77.343, 'test/diff': 5.379, 'test/acc_skew': 74.654, 'test/acc_align': 80.033}
[10 / 20] best valid accuracy: 78.243 at epoch 10 
 best_stats: {'best_valid_epoch': 10, 'best_valid_valid/acc': 78.312, 'best_valid_valid/acc_unbiased': 78.243, 'best_valid_valid/diff': 3.657, 'best_valid_valid/acc_skew': 76.414, 'best_valid_valid/acc_align': 80.071, 'best_valid_test/acc': 77.426, 'best_valid_test/acc_unbiased': 77.343, 'best_valid_test/diff': 5.379, 'best_valid_test/acc_skew': 74.654, 'best_valid_test/acc_align': 80.033}
[10 / 20] best test accuracy: 77.343 at epoch 10 
 best_stats: {'best_test_epoch': 10, 'best_test_valid/acc': 78.312, 'best_test_valid/acc_unbiased': 78.243, 'best_test_valid/diff': 3.657, 'best_test_valid/acc_skew': 76.414, 'best_test_valid/acc_align': 80.071, 'best_test_test/acc': 77.426, 'best_test_test/acc_unbiased': 77.343, 'best_test_test/diff': 5.379, 'best_test_test/acc_skew': 74.654, 'best_test_test/acc_align': 80.033}
[11 / 20] Learning rate: 0.0001 weight: 0.01
[11 / 20] Loss: 4.71039504432399 CE Loss: 0.49421482615031054 Con Loss: 4.705452904345176
[11 / 20] tensor([[0.733, 0.665],
        [0.814, 0.857]]) {'epoch': 11, 'valid/acc': 77.468, 'valid/acc_unbiased': 77.853, 'valid/diff': 4.499, 'valid/acc_skew': 75.604, 'valid/acc_align': 80.103, 'test/acc': 76.456, 'test/acc_unbiased': 76.722, 'test/diff': 5.589, 'test/acc_skew': 73.927, 'test/acc_align': 79.517}
[11 / 20] best valid accuracy: 78.243 at epoch 10 
 best_stats: {'best_valid_epoch': 10, 'best_valid_valid/acc': 78.312, 'best_valid_valid/acc_unbiased': 78.243, 'best_valid_valid/diff': 3.657, 'best_valid_valid/acc_skew': 76.414, 'best_valid_valid/acc_align': 80.071, 'best_valid_test/acc': 77.426, 'best_valid_test/acc_unbiased': 77.343, 'best_valid_test/diff': 5.379, 'best_valid_test/acc_skew': 74.654, 'best_valid_test/acc_align': 80.033}
[11 / 20] best test accuracy: 77.343 at epoch 10 
 best_stats: {'best_test_epoch': 10, 'best_test_valid/acc': 78.312, 'best_test_valid/acc_unbiased': 78.243, 'best_test_valid/diff': 3.657, 'best_test_valid/acc_skew': 76.414, 'best_test_valid/acc_align': 80.071, 'best_test_test/acc': 77.426, 'best_test_test/acc_unbiased': 77.343, 'best_test_test/diff': 5.379, 'best_test_test/acc_skew': 74.654, 'best_test_test/acc_align': 80.033}
[12 / 20] Learning rate: 0.0001 weight: 0.01
[12 / 20] Loss: 4.708009768719205 CE Loss: 0.5002768281438166 Con Loss: 4.703006994322837
[12 / 20] tensor([[0.733, 0.648],
        [0.825, 0.874]]) {'epoch': 12, 'valid/acc': 77.679, 'valid/acc_unbiased': 78.166, 'valid/diff': 4.032, 'valid/acc_skew': 76.15, 'valid/acc_align': 80.182, 'test/acc': 76.667, 'test/acc_unbiased': 76.995, 'test/diff': 6.678, 'test/acc_skew': 73.656, 'test/acc_align': 80.334}
[12 / 20] best valid accuracy: 78.243 at epoch 10 
 best_stats: {'best_valid_epoch': 10, 'best_valid_valid/acc': 78.312, 'best_valid_valid/acc_unbiased': 78.243, 'best_valid_valid/diff': 3.657, 'best_valid_valid/acc_skew': 76.414, 'best_valid_valid/acc_align': 80.071, 'best_valid_test/acc': 77.426, 'best_valid_test/acc_unbiased': 77.343, 'best_valid_test/diff': 5.379, 'best_valid_test/acc_skew': 74.654, 'best_valid_test/acc_align': 80.033}
[12 / 20] best test accuracy: 77.343 at epoch 10 
 best_stats: {'best_test_epoch': 10, 'best_test_valid/acc': 78.312, 'best_test_valid/acc_unbiased': 78.243, 'best_test_valid/diff': 3.657, 'best_test_valid/acc_skew': 76.414, 'best_test_valid/acc_align': 80.071, 'best_test_test/acc': 77.426, 'best_test_test/acc_unbiased': 77.343, 'best_test_test/diff': 5.379, 'best_test_test/acc_skew': 74.654, 'best_test_test/acc_align': 80.033}
[13 / 20] Learning rate: 0.0001 weight: 0.01
[13 / 20] Loss: 4.688906638199903 CE Loss: 0.49274387056796126 Con Loss: 4.6839791949985665
[13 / 20] tensor([[0.747, 0.685],
        [0.777, 0.850]]) {'epoch': 13, 'valid/acc': 78.692, 'valid/acc_unbiased': 78.874, 'valid/diff': 3.759, 'valid/acc_skew': 76.994, 'valid/acc_align': 80.753, 'test/acc': 76.456, 'test/acc_unbiased': 76.492, 'test/diff': 6.74, 'test/acc_skew': 73.122, 'test/acc_align': 79.862}
[13 / 20] best valid accuracy: 78.874 at epoch 13 
 best_stats: {'best_valid_epoch': 13, 'best_valid_valid/acc': 78.692, 'best_valid_valid/acc_unbiased': 78.874, 'best_valid_valid/diff': 3.759, 'best_valid_valid/acc_skew': 76.994, 'best_valid_valid/acc_align': 80.753, 'best_valid_test/acc': 76.456, 'best_valid_test/acc_unbiased': 76.492, 'best_valid_test/diff': 6.74, 'best_valid_test/acc_skew': 73.122, 'best_valid_test/acc_align': 79.862}
[13 / 20] best test accuracy: 77.343 at epoch 10 
 best_stats: {'best_test_epoch': 10, 'best_test_valid/acc': 78.312, 'best_test_valid/acc_unbiased': 78.243, 'best_test_valid/diff': 3.657, 'best_test_valid/acc_skew': 76.414, 'best_test_valid/acc_align': 80.071, 'best_test_test/acc': 77.426, 'best_test_test/acc_unbiased': 77.343, 'best_test_test/diff': 5.379, 'best_test_test/acc_skew': 74.654, 'best_test_test/acc_align': 80.033}
[14 / 20] Learning rate: 1e-05 weight: 0.01
[14 / 20] Loss: 4.687397107198333 CE Loss: 0.4885664403351299 Con Loss: 4.682511420410513
[14 / 20] tensor([[0.742, 0.684],
        [0.790, 0.856]]) {'epoch': 14, 'valid/acc': 78.608, 'valid/acc_unbiased': 78.816, 'valid/diff': 3.791, 'valid/acc_skew': 76.921, 'valid/acc_align': 80.711, 'test/acc': 76.709, 'test/acc_unbiased': 76.794, 'test/diff': 6.193, 'test/acc_skew': 73.697, 'test/acc_align': 79.89}
[14 / 20] best valid accuracy: 78.874 at epoch 13 
 best_stats: {'best_valid_epoch': 13, 'best_valid_valid/acc': 78.692, 'best_valid_valid/acc_unbiased': 78.874, 'best_valid_valid/diff': 3.759, 'best_valid_valid/acc_skew': 76.994, 'best_valid_valid/acc_align': 80.753, 'best_valid_test/acc': 76.456, 'best_valid_test/acc_unbiased': 76.492, 'best_valid_test/diff': 6.74, 'best_valid_test/acc_skew': 73.122, 'best_valid_test/acc_align': 79.862}
[14 / 20] best test accuracy: 77.343 at epoch 10 
 best_stats: {'best_test_epoch': 10, 'best_test_valid/acc': 78.312, 'best_test_valid/acc_unbiased': 78.243, 'best_test_valid/diff': 3.657, 'best_test_valid/acc_skew': 76.414, 'best_test_valid/acc_align': 80.071, 'best_test_test/acc': 77.426, 'best_test_test/acc_unbiased': 77.343, 'best_test_test/diff': 5.379, 'best_test_test/acc_skew': 74.654, 'best_test_test/acc_align': 80.033}
[15 / 20] Learning rate: 1e-05 weight: 0.01
[15 / 20] Loss: 4.671918383803584 CE Loss: 0.4879846451572234 Con Loss: 4.667038561484475
[15 / 20] tensor([[0.758, 0.697],
        [0.777, 0.845]]) {'epoch': 15, 'valid/acc': 78.692, 'valid/acc_unbiased': 78.776, 'valid/diff': 4.657, 'valid/acc_skew': 76.448, 'valid/acc_align': 81.105, 'test/acc': 76.92, 'test/acc_unbiased': 76.945, 'test/diff': 6.464, 'test/acc_skew': 73.712, 'test/acc_align': 80.177}
[15 / 20] best valid accuracy: 78.874 at epoch 13 
 best_stats: {'best_valid_epoch': 13, 'best_valid_valid/acc': 78.692, 'best_valid_valid/acc_unbiased': 78.874, 'best_valid_valid/diff': 3.759, 'best_valid_valid/acc_skew': 76.994, 'best_valid_valid/acc_align': 80.753, 'best_valid_test/acc': 76.456, 'best_valid_test/acc_unbiased': 76.492, 'best_valid_test/diff': 6.74, 'best_valid_test/acc_skew': 73.122, 'best_valid_test/acc_align': 79.862}
[15 / 20] best test accuracy: 77.343 at epoch 10 
 best_stats: {'best_test_epoch': 10, 'best_test_valid/acc': 78.312, 'best_test_valid/acc_unbiased': 78.243, 'best_test_valid/diff': 3.657, 'best_test_valid/acc_skew': 76.414, 'best_test_valid/acc_align': 80.071, 'best_test_test/acc': 77.426, 'best_test_test/acc_unbiased': 77.343, 'best_test_test/diff': 5.379, 'best_test_test/acc_skew': 74.654, 'best_test_test/acc_align': 80.033}
[16 / 20] Learning rate: 1e-05 weight: 0.01
[16 / 20] Loss: 4.661813066435069 CE Loss: 0.4875582930895106 Con Loss: 4.656937477005697
[16 / 20] tensor([[0.747, 0.690],
        [0.784, 0.851]]) {'epoch': 16, 'valid/acc': 78.945, 'valid/acc_unbiased': 79.113, 'valid/diff': 4.31, 'valid/acc_skew': 76.958, 'valid/acc_align': 81.268, 'test/acc': 76.751, 'test/acc_unbiased': 76.802, 'test/diff': 6.268, 'test/acc_skew': 73.668, 'test/acc_align': 79.936}
[16 / 20] best valid accuracy: 79.113 at epoch 16 
 best_stats: {'best_valid_epoch': 16, 'best_valid_valid/acc': 78.945, 'best_valid_valid/acc_unbiased': 79.113, 'best_valid_valid/diff': 4.31, 'best_valid_valid/acc_skew': 76.958, 'best_valid_valid/acc_align': 81.268, 'best_valid_test/acc': 76.751, 'best_valid_test/acc_unbiased': 76.802, 'best_valid_test/diff': 6.268, 'best_valid_test/acc_skew': 73.668, 'best_valid_test/acc_align': 79.936}
[16 / 20] best test accuracy: 77.343 at epoch 10 
 best_stats: {'best_test_epoch': 10, 'best_test_valid/acc': 78.312, 'best_test_valid/acc_unbiased': 78.243, 'best_test_valid/diff': 3.657, 'best_test_valid/acc_skew': 76.414, 'best_test_valid/acc_align': 80.071, 'best_test_test/acc': 77.426, 'best_test_test/acc_unbiased': 77.343, 'best_test_test/diff': 5.379, 'best_test_test/acc_skew': 74.654, 'best_test_test/acc_align': 80.033}
[17 / 20] Learning rate: 1e-05 weight: 0.01
[17 / 20] Loss: 4.673444284352517 CE Loss: 0.48272877918504514 Con Loss: 4.668616999993387
[17 / 20] tensor([[0.769, 0.700],
        [0.781, 0.847]]) {'epoch': 17, 'valid/acc': 78.987, 'valid/acc_unbiased': 79.119, 'valid/diff': 3.883, 'valid/acc_skew': 77.178, 'valid/acc_align': 81.061, 'test/acc': 77.384, 'test/acc_unbiased': 77.433, 'test/diff': 6.712, 'test/acc_skew': 74.077, 'test/acc_align': 80.789}
[17 / 20] best valid accuracy: 79.119 at epoch 17 
 best_stats: {'best_valid_epoch': 17, 'best_valid_valid/acc': 78.987, 'best_valid_valid/acc_unbiased': 79.119, 'best_valid_valid/diff': 3.883, 'best_valid_valid/acc_skew': 77.178, 'best_valid_valid/acc_align': 81.061, 'best_valid_test/acc': 77.384, 'best_valid_test/acc_unbiased': 77.433, 'best_valid_test/diff': 6.712, 'best_valid_test/acc_skew': 74.077, 'best_valid_test/acc_align': 80.789}
[17 / 20] best test accuracy: 77.433 at epoch 17 
 best_stats: {'best_test_epoch': 17, 'best_test_valid/acc': 78.987, 'best_test_valid/acc_unbiased': 79.119, 'best_test_valid/diff': 3.883, 'best_test_valid/acc_skew': 77.178, 'best_test_valid/acc_align': 81.061, 'best_test_test/acc': 77.384, 'best_test_test/acc_unbiased': 77.433, 'best_test_test/diff': 6.712, 'best_test_test/acc_skew': 74.077, 'best_test_test/acc_align': 80.789}
[18 / 20] Learning rate: 1e-05 weight: 0.01
[18 / 20] Loss: 4.675061633611318 CE Loss: 0.48751054527469817 Con Loss: 4.670186529396918
[18 / 20] tensor([[0.765, 0.702],
        [0.775, 0.841]]) {'epoch': 18, 'valid/acc': 78.987, 'valid/acc_unbiased': 79.118, 'valid/diff': 4.538, 'valid/acc_skew': 76.849, 'valid/acc_align': 81.387, 'test/acc': 77.046, 'test/acc_unbiased': 77.069, 'test/diff': 6.486, 'test/acc_skew': 73.826, 'test/acc_align': 80.312}
[18 / 20] best valid accuracy: 79.119 at epoch 17 
 best_stats: {'best_valid_epoch': 17, 'best_valid_valid/acc': 78.987, 'best_valid_valid/acc_unbiased': 79.119, 'best_valid_valid/diff': 3.883, 'best_valid_valid/acc_skew': 77.178, 'best_valid_valid/acc_align': 81.061, 'best_valid_test/acc': 77.384, 'best_valid_test/acc_unbiased': 77.433, 'best_valid_test/diff': 6.712, 'best_valid_test/acc_skew': 74.077, 'best_valid_test/acc_align': 80.789}
[18 / 20] best test accuracy: 77.433 at epoch 17 
 best_stats: {'best_test_epoch': 17, 'best_test_valid/acc': 78.987, 'best_test_valid/acc_unbiased': 79.119, 'best_test_valid/diff': 3.883, 'best_test_valid/acc_skew': 77.178, 'best_test_valid/acc_align': 81.061, 'best_test_test/acc': 77.384, 'best_test_test/acc_unbiased': 77.433, 'best_test_test/diff': 6.712, 'best_test_test/acc_skew': 74.077, 'best_test_test/acc_align': 80.789}
[19 / 20] Learning rate: 1e-05 weight: 0.01
[19 / 20] Loss: 4.675059714394118 CE Loss: 0.4820360769115465 Con Loss: 4.670239350806218
[19 / 20] tensor([[0.744, 0.681],
        [0.790, 0.856]]) {'epoch': 19, 'valid/acc': 78.861, 'valid/acc_unbiased': 79.102, 'valid/diff': 4.143, 'valid/acc_skew': 77.03, 'valid/acc_align': 81.174, 'test/acc': 76.667, 'test/acc_unbiased': 76.765, 'test/diff': 6.43, 'test/acc_skew': 73.549, 'test/acc_align': 79.98}
[19 / 20] best valid accuracy: 79.119 at epoch 17 
 best_stats: {'best_valid_epoch': 17, 'best_valid_valid/acc': 78.987, 'best_valid_valid/acc_unbiased': 79.119, 'best_valid_valid/diff': 3.883, 'best_valid_valid/acc_skew': 77.178, 'best_valid_valid/acc_align': 81.061, 'best_valid_test/acc': 77.384, 'best_valid_test/acc_unbiased': 77.433, 'best_valid_test/diff': 6.712, 'best_valid_test/acc_skew': 74.077, 'best_valid_test/acc_align': 80.789}
[19 / 20] best test accuracy: 77.433 at epoch 17 
 best_stats: {'best_test_epoch': 17, 'best_test_valid/acc': 78.987, 'best_test_valid/acc_unbiased': 79.119, 'best_test_valid/diff': 3.883, 'best_test_valid/acc_skew': 77.178, 'best_test_valid/acc_align': 81.061, 'best_test_test/acc': 77.384, 'best_test_test/acc_unbiased': 77.433, 'best_test_test/diff': 6.712, 'best_test_test/acc_skew': 74.077, 'best_test_test/acc_align': 80.789}
[20 / 20] Learning rate: 1e-05 weight: 0.01
[20 / 20] Loss: 4.660399047382405 CE Loss: 0.47616355646930714 Con Loss: 4.65563741993939
[20 / 20] tensor([[0.756, 0.688],
        [0.784, 0.854]]) {'epoch': 20, 'valid/acc': 79.072, 'valid/acc_unbiased': 79.269, 'valid/diff': 4.257, 'valid/acc_skew': 77.14, 'valid/acc_align': 81.397, 'test/acc': 77.004, 'test/acc_unbiased': 77.063, 'test/diff': 6.939, 'test/acc_skew': 73.594, 'test/acc_align': 80.533}
[20 / 20] best valid accuracy: 79.269 at epoch 20 
 best_stats: {'best_valid_epoch': 20, 'best_valid_valid/acc': 79.072, 'best_valid_valid/acc_unbiased': 79.269, 'best_valid_valid/diff': 4.257, 'best_valid_valid/acc_skew': 77.14, 'best_valid_valid/acc_align': 81.397, 'best_valid_test/acc': 77.004, 'best_valid_test/acc_unbiased': 77.063, 'best_valid_test/diff': 6.939, 'best_valid_test/acc_skew': 73.594, 'best_valid_test/acc_align': 80.533}
[20 / 20] best test accuracy: 77.433 at epoch 17 
 best_stats: {'best_test_epoch': 17, 'best_test_valid/acc': 78.987, 'best_test_valid/acc_unbiased': 79.119, 'best_test_valid/diff': 3.883, 'best_test_valid/acc_skew': 77.178, 'best_test_valid/acc_align': 81.061, 'best_test_test/acc': 77.384, 'best_test_test/acc_unbiased': 77.433, 'best_test_test/diff': 6.712, 'best_test_test/acc_skew': 74.077, 'best_test_test/acc_align': 80.789}
Total training time: 0:18:06
