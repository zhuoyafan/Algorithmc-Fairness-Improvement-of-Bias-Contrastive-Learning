Log level set to: INFO
Set seed: 1
=======> Using Fixed Random Seed: 1 <========
save_path: exp_results/bc-bb0-utk_face_race-us-0.1-lr0.001-bs128-cbs64-w0.01-ratio10-aug1-seed1
get_utk_face - split: train, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_race-0.1
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [4407, 4976]
Target 1: [3755, 5529]
Binary Target 1
---------------------------
Target 0: [4407, 4976]
Target 1: [3755, 5529]
===================================
Normal Label Distribution: 
Target 0: [4407, 4976]
Target 1: [3755, 5529]
===================================
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [3755, 3755]
Target 1: [3755, 3755]
Binary Target 1
---------------------------
Target 0: [3755, 3755]
Target 1: [3755, 3755]
===================================
Normal Label Distribution: 
Target 0: [3755, 3755]
Target 1: [3755, 3755]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 15020, target_attr: gender, bias_attr: race bias_rate: 0.1
['[train] target_0-bias_0: 3755', '[train] target_0-bias_1: 3755', '[train] target_1-bias_0: 3755', '[train] target_1-bias_1: 3755']
confusion_matrix - 
 original: tensor([[3755., 3755.],
        [3755., 3755.]]), 
 normalized: tensor([[0.500, 0.500],
        [0.500, 0.500]]), 
 b|y: tensor([[0.500, 0.500],
        [0.500, 0.500]])
get_utk_face - split: train, aug: 1, given_y: True, ratio: 10
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_race-0.1
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [4407, 4976]
Target 1: [3755, 5529]
Binary Target 1
---------------------------
Target 0: [4407, 4976]
Target 1: [3755, 5529]
===================================
Normal Label Distribution: 
Target 0: [4407, 4976]
Target 1: [3755, 5529]
===================================
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [3755, 3755]
Target 1: [3755, 3755]
Binary Target 1
---------------------------
Target 0: [3755, 3755]
Target 1: [3755, 3755]
===================================
Normal Label Distribution: 
Target 0: [3755, 3755]
Target 1: [3755, 3755]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 15020, target_attr: gender, bias_attr: race bias_rate: 0.1
['[train] target_0-bias_0: 3755', '[train] target_0-bias_1: 3755', '[train] target_1-bias_0: 3755', '[train] target_1-bias_1: 3755']
get_utk_face - split: valid, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_race-0.1
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [583, 684]
Target 1: [457, 646]
Binary Target 1
---------------------------
Target 0: [583, 684]
Target 1: [457, 646]
===================================
Normal Label Distribution: 
Target 0: [583, 684]
Target 1: [457, 646]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 2370, target_attr: gender, bias_attr: race bias_rate: 0.1
['[valid] target_0-bias_0: 583', '[valid] target_0-bias_1: 684', '[valid] target_1-bias_0: 457', '[valid] target_1-bias_1: 646']
get_utk_face - split: test, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_race-0.1
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [558, 677]
Target 1: [462, 673]
Binary Target 1
---------------------------
Target 0: [558, 677]
Target 1: [462, 673]
===================================
Normal Label Distribution: 
Target 0: [558, 677]
Target 1: [462, 673]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 2370, target_attr: gender, bias_attr: race bias_rate: 0.1
['[test] target_0-bias_0: 558', '[test] target_0-bias_1: 677', '[test] target_1-bias_0: 462', '[test] target_1-bias_1: 673']
decay_epochs: [6, 13]
[1 / 20] Learning rate: 0.001 weight: 0.01
[1 / 20] Loss: 4.874572157574081 CE Loss: 0.5594884409091762 Con Loss: 4.8689772777328795
[1 / 20] tensor([[0.833, 0.820],
        [0.745, 0.773]]) {'epoch': 1, 'valid/acc': 81.646, 'valid/acc_unbiased': 81.594, 'valid/diff': 2.205, 'valid/acc_skew': 82.396, 'valid/acc_align': 80.792, 'test/acc': 79.494, 'test/acc_unbiased': 79.259, 'test/diff': 2.081, 'test/acc_skew': 78.896, 'test/acc_align': 79.623}
[1 / 20] best valid accuracy: 81.594 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 81.646, 'best_valid_valid/acc_unbiased': 81.594, 'best_valid_valid/diff': 2.205, 'best_valid_valid/acc_skew': 82.396, 'best_valid_valid/acc_align': 80.792, 'best_valid_test/acc': 79.494, 'best_valid_test/acc_unbiased': 79.259, 'best_valid_test/diff': 2.081, 'best_valid_test/acc_skew': 78.896, 'best_valid_test/acc_align': 79.623}
[1 / 20] best test accuracy: 79.259 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 81.646, 'best_test_valid/acc_unbiased': 81.594, 'best_test_valid/diff': 2.205, 'best_test_valid/acc_skew': 82.396, 'best_test_valid/acc_align': 80.792, 'best_test_test/acc': 79.494, 'best_test_test/acc_unbiased': 79.259, 'best_test_test/diff': 2.081, 'best_test_test/acc_skew': 78.896, 'best_test_test/acc_align': 79.623}
[2 / 20] Learning rate: 0.001 weight: 0.01
[2 / 20] Loss: 4.768716564635621 CE Loss: 0.45736739541814425 Con Loss: 4.764142865156842
[2 / 20] tensor([[0.927, 0.895],
        [0.712, 0.722]]) {'epoch': 2, 'valid/acc': 81.519, 'valid/acc_unbiased': 81.181, 'valid/diff': 5.955, 'valid/acc_skew': 84.159, 'valid/acc_align': 78.203, 'test/acc': 81.772, 'test/acc_unbiased': 81.398, 'test/diff': 2.071, 'test/acc_skew': 81.932, 'test/acc_align': 80.863}
[2 / 20] best valid accuracy: 81.594 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 81.646, 'best_valid_valid/acc_unbiased': 81.594, 'best_valid_valid/diff': 2.205, 'best_valid_valid/acc_skew': 82.396, 'best_valid_valid/acc_align': 80.792, 'best_valid_test/acc': 79.494, 'best_valid_test/acc_unbiased': 79.259, 'best_valid_test/diff': 2.081, 'best_valid_test/acc_skew': 78.896, 'best_valid_test/acc_align': 79.623}
[2 / 20] best test accuracy: 81.398 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 81.519, 'best_test_valid/acc_unbiased': 81.181, 'best_test_valid/diff': 5.955, 'best_test_valid/acc_skew': 84.159, 'best_test_valid/acc_align': 78.203, 'best_test_test/acc': 81.772, 'best_test_test/acc_unbiased': 81.398, 'best_test_test/diff': 2.071, 'best_test_test/acc_skew': 81.932, 'best_test_test/acc_align': 80.863}
[3 / 20] Learning rate: 0.001 weight: 0.01
[3 / 20] Loss: 4.741120526381085 CE Loss: 0.43576705538321747 Con Loss: 4.736762842262157
[3 / 20] tensor([[0.884, 0.843],
        [0.758, 0.793]]) {'epoch': 3, 'valid/acc': 82.954, 'valid/acc_unbiased': 82.775, 'valid/diff': 3.277, 'valid/acc_skew': 84.413, 'valid/acc_align': 81.136, 'test/acc': 82.194, 'test/acc_unbiased': 81.949, 'test/diff': 3.799, 'test/acc_skew': 82.054, 'test/acc_align': 81.844}
[3 / 20] best valid accuracy: 82.775 at epoch 3 
 best_stats: {'best_valid_epoch': 3, 'best_valid_valid/acc': 82.954, 'best_valid_valid/acc_unbiased': 82.775, 'best_valid_valid/diff': 3.277, 'best_valid_valid/acc_skew': 84.413, 'best_valid_valid/acc_align': 81.136, 'best_valid_test/acc': 82.194, 'best_valid_test/acc_unbiased': 81.949, 'best_valid_test/diff': 3.799, 'best_valid_test/acc_skew': 82.054, 'best_valid_test/acc_align': 81.844}
[3 / 20] best test accuracy: 81.949 at epoch 3 
 best_stats: {'best_test_epoch': 3, 'best_test_valid/acc': 82.954, 'best_test_valid/acc_unbiased': 82.775, 'best_test_valid/diff': 3.277, 'best_test_valid/acc_skew': 84.413, 'best_test_valid/acc_align': 81.136, 'best_test_test/acc': 82.194, 'best_test_test/acc_unbiased': 81.949, 'best_test_test/diff': 3.799, 'best_test_test/acc_skew': 82.054, 'best_test_test/acc_align': 81.844}
[4 / 20] Learning rate: 0.001 weight: 0.01
[4 / 20] Loss: 4.720553836238368 CE Loss: 0.41320436496074286 Con Loss: 4.716421794256421
[4 / 20] tensor([[0.878, 0.861],
        [0.831, 0.808]]) {'epoch': 4, 'valid/acc': 83.249, 'valid/acc_unbiased': 83.036, 'valid/diff': 2.115, 'valid/acc_skew': 84.094, 'valid/acc_align': 81.979, 'test/acc': 84.43, 'test/acc_unbiased': 84.469, 'test/diff': 1.992, 'test/acc_skew': 85.465, 'test/acc_align': 83.474}
[4 / 20] best valid accuracy: 83.036 at epoch 4 
 best_stats: {'best_valid_epoch': 4, 'best_valid_valid/acc': 83.249, 'best_valid_valid/acc_unbiased': 83.036, 'best_valid_valid/diff': 2.115, 'best_valid_valid/acc_skew': 84.094, 'best_valid_valid/acc_align': 81.979, 'best_valid_test/acc': 84.43, 'best_valid_test/acc_unbiased': 84.469, 'best_valid_test/diff': 1.992, 'best_valid_test/acc_skew': 85.465, 'best_valid_test/acc_align': 83.474}
[4 / 20] best test accuracy: 84.469 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 83.249, 'best_test_valid/acc_unbiased': 83.036, 'best_test_valid/diff': 2.115, 'best_test_valid/acc_skew': 84.094, 'best_test_valid/acc_align': 81.979, 'best_test_test/acc': 84.43, 'best_test_test/acc_unbiased': 84.469, 'best_test_test/diff': 1.992, 'best_test_test/acc_skew': 85.465, 'best_test_test/acc_align': 83.474}
[5 / 20] Learning rate: 0.001 weight: 0.01
[5 / 20] Loss: 4.709282138661919 CE Loss: 0.3998002341599979 Con Loss: 4.705284140748127
[5 / 20] tensor([[0.740, 0.696],
        [0.944, 0.948]]) {'epoch': 5, 'valid/acc': 81.392, 'valid/acc_unbiased': 82.327, 'valid/diff': 1.668, 'valid/acc_skew': 83.161, 'valid/acc_align': 81.493, 'test/acc': 82.616, 'test/acc_unbiased': 83.189, 'test/diff': 2.435, 'test/acc_skew': 84.193, 'test/acc_align': 82.186}
[5 / 20] best valid accuracy: 83.036 at epoch 4 
 best_stats: {'best_valid_epoch': 4, 'best_valid_valid/acc': 83.249, 'best_valid_valid/acc_unbiased': 83.036, 'best_valid_valid/diff': 2.115, 'best_valid_valid/acc_skew': 84.094, 'best_valid_valid/acc_align': 81.979, 'best_valid_test/acc': 84.43, 'best_valid_test/acc_unbiased': 84.469, 'best_valid_test/diff': 1.992, 'best_valid_test/acc_skew': 85.465, 'best_valid_test/acc_align': 83.474}
[5 / 20] best test accuracy: 84.469 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 83.249, 'best_test_valid/acc_unbiased': 83.036, 'best_test_valid/diff': 2.115, 'best_test_valid/acc_skew': 84.094, 'best_test_valid/acc_align': 81.979, 'best_test_test/acc': 84.43, 'best_test_test/acc_unbiased': 84.469, 'best_test_test/diff': 1.992, 'best_test_test/acc_skew': 85.465, 'best_test_test/acc_align': 83.474}
[6 / 20] Learning rate: 0.001 weight: 0.01
[6 / 20] Loss: 4.694725077510991 CE Loss: 0.3933337042557098 Con Loss: 4.69079172995373
[6 / 20] tensor([[0.892, 0.877],
        [0.816, 0.828]]) {'epoch': 6, 'valid/acc': 84.641, 'valid/acc_unbiased': 84.488, 'valid/diff': 1.493, 'valid/acc_skew': 85.235, 'valid/acc_align': 83.742, 'test/acc': 85.485, 'test/acc_unbiased': 85.338, 'test/diff': 1.335, 'test/acc_skew': 85.425, 'test/acc_align': 85.252}
[6 / 20] best valid accuracy: 84.488 at epoch 6 
 best_stats: {'best_valid_epoch': 6, 'best_valid_valid/acc': 84.641, 'best_valid_valid/acc_unbiased': 84.488, 'best_valid_valid/diff': 1.493, 'best_valid_valid/acc_skew': 85.235, 'best_valid_valid/acc_align': 83.742, 'best_valid_test/acc': 85.485, 'best_valid_test/acc_unbiased': 85.338, 'best_valid_test/diff': 1.335, 'best_valid_test/acc_skew': 85.425, 'best_valid_test/acc_align': 85.252}
[6 / 20] best test accuracy: 85.338 at epoch 6 
 best_stats: {'best_test_epoch': 6, 'best_test_valid/acc': 84.641, 'best_test_valid/acc_unbiased': 84.488, 'best_test_valid/diff': 1.493, 'best_test_valid/acc_skew': 85.235, 'best_test_valid/acc_align': 83.742, 'best_test_test/acc': 85.485, 'best_test_test/acc_unbiased': 85.338, 'best_test_test/diff': 1.335, 'best_test_test/acc_skew': 85.425, 'best_test_test/acc_align': 85.252}
[7 / 20] Learning rate: 0.0001 weight: 0.01
[7 / 20] Loss: 4.655744290764576 CE Loss: 0.3563334907577454 Con Loss: 4.652180955127457
[7 / 20] tensor([[0.892, 0.904],
        [0.842, 0.837]]) {'epoch': 7, 'valid/acc': 86.835, 'valid/acc_unbiased': 86.78, 'valid/diff': 2.688, 'valid/acc_skew': 88.124, 'valid/acc_align': 85.436, 'test/acc': 87.004, 'test/acc_unbiased': 86.875, 'test/diff': 0.848, 'test/acc_skew': 86.723, 'test/acc_align': 87.027}
[7 / 20] best valid accuracy: 86.780 at epoch 7 
 best_stats: {'best_valid_epoch': 7, 'best_valid_valid/acc': 86.835, 'best_valid_valid/acc_unbiased': 86.78, 'best_valid_valid/diff': 2.688, 'best_valid_valid/acc_skew': 88.124, 'best_valid_valid/acc_align': 85.436, 'best_valid_test/acc': 87.004, 'best_valid_test/acc_unbiased': 86.875, 'best_valid_test/diff': 0.848, 'best_valid_test/acc_skew': 86.723, 'best_valid_test/acc_align': 87.027}
[7 / 20] best test accuracy: 86.875 at epoch 7 
 best_stats: {'best_test_epoch': 7, 'best_test_valid/acc': 86.835, 'best_test_valid/acc_unbiased': 86.78, 'best_test_valid/diff': 2.688, 'best_test_valid/acc_skew': 88.124, 'best_test_valid/acc_align': 85.436, 'best_test_test/acc': 87.004, 'best_test_test/acc_unbiased': 86.875, 'best_test_test/diff': 0.848, 'best_test_test/acc_skew': 86.723, 'best_test_test/acc_align': 87.027}
[8 / 20] Learning rate: 0.0001 weight: 0.01
[8 / 20] Loss: 4.65448799031711 CE Loss: 0.3364408703126539 Con Loss: 4.651123576792832
[8 / 20] tensor([[0.844, 0.829],
        [0.892, 0.900]]) {'epoch': 8, 'valid/acc': 87.806, 'valid/acc_unbiased': 88.074, 'valid/diff': 2.016, 'valid/acc_skew': 89.082, 'valid/acc_align': 87.066, 'test/acc': 86.498, 'test/acc_unbiased': 86.624, 'test/diff': 1.205, 'test/acc_skew': 86.793, 'test/acc_align': 86.455}
[8 / 20] best valid accuracy: 88.074 at epoch 8 
 best_stats: {'best_valid_epoch': 8, 'best_valid_valid/acc': 87.806, 'best_valid_valid/acc_unbiased': 88.074, 'best_valid_valid/diff': 2.016, 'best_valid_valid/acc_skew': 89.082, 'best_valid_valid/acc_align': 87.066, 'best_valid_test/acc': 86.498, 'best_valid_test/acc_unbiased': 86.624, 'best_valid_test/diff': 1.205, 'best_valid_test/acc_skew': 86.793, 'best_valid_test/acc_align': 86.455}
[8 / 20] best test accuracy: 86.875 at epoch 7 
 best_stats: {'best_test_epoch': 7, 'best_test_valid/acc': 86.835, 'best_test_valid/acc_unbiased': 86.78, 'best_test_valid/diff': 2.688, 'best_test_valid/acc_skew': 88.124, 'best_test_valid/acc_align': 85.436, 'best_test_test/acc': 87.004, 'best_test_test/acc_unbiased': 86.875, 'best_test_test/diff': 0.848, 'best_test_test/acc_skew': 86.723, 'best_test_test/acc_align': 87.027}
[9 / 20] Learning rate: 0.0001 weight: 0.01
[9 / 20] Loss: 4.630332551339019 CE Loss: 0.3272801510821011 Con Loss: 4.627059754677682
[9 / 20] tensor([[0.867, 0.861],
        [0.874, 0.881]]) {'epoch': 9, 'valid/acc': 88.397, 'valid/acc_unbiased': 88.498, 'valid/diff': 1.695, 'valid/acc_skew': 89.345, 'valid/acc_align': 87.651, 'test/acc': 87.089, 'test/acc_unbiased': 87.103, 'test/diff': 0.645, 'test/acc_skew': 87.092, 'test/acc_align': 87.114}
[9 / 20] best valid accuracy: 88.498 at epoch 9 
 best_stats: {'best_valid_epoch': 9, 'best_valid_valid/acc': 88.397, 'best_valid_valid/acc_unbiased': 88.498, 'best_valid_valid/diff': 1.695, 'best_valid_valid/acc_skew': 89.345, 'best_valid_valid/acc_align': 87.651, 'best_valid_test/acc': 87.089, 'best_valid_test/acc_unbiased': 87.103, 'best_valid_test/diff': 0.645, 'best_valid_test/acc_skew': 87.092, 'best_valid_test/acc_align': 87.114}
[9 / 20] best test accuracy: 87.103 at epoch 9 
 best_stats: {'best_test_epoch': 9, 'best_test_valid/acc': 88.397, 'best_test_valid/acc_unbiased': 88.498, 'best_test_valid/diff': 1.695, 'best_test_valid/acc_skew': 89.345, 'best_test_valid/acc_align': 87.651, 'best_test_test/acc': 87.089, 'best_test_test/acc_unbiased': 87.103, 'best_test_test/diff': 0.645, 'best_test_test/acc_skew': 87.092, 'best_test_test/acc_align': 87.114}
[10 / 20] Learning rate: 0.0001 weight: 0.01
[10 / 20] Loss: 4.62422771707832 CE Loss: 0.3199086222762909 Con Loss: 4.62102863906068
[10 / 20] tensor([[0.869, 0.886],
        [0.885, 0.881]]) {'epoch': 10, 'valid/acc': 88.481, 'valid/acc_unbiased': 88.59, 'valid/diff': 2.025, 'valid/acc_skew': 89.603, 'valid/acc_align': 87.577, 'test/acc': 88.059, 'test/acc_unbiased': 88.046, 'test/diff': 1.062, 'test/acc_skew': 87.723, 'test/acc_align': 88.37}
[10 / 20] best valid accuracy: 88.590 at epoch 10 
 best_stats: {'best_valid_epoch': 10, 'best_valid_valid/acc': 88.481, 'best_valid_valid/acc_unbiased': 88.59, 'best_valid_valid/diff': 2.025, 'best_valid_valid/acc_skew': 89.603, 'best_valid_valid/acc_align': 87.577, 'best_valid_test/acc': 88.059, 'best_valid_test/acc_unbiased': 88.046, 'best_valid_test/diff': 1.062, 'best_valid_test/acc_skew': 87.723, 'best_valid_test/acc_align': 88.37}
[10 / 20] best test accuracy: 88.046 at epoch 10 
 best_stats: {'best_test_epoch': 10, 'best_test_valid/acc': 88.481, 'best_test_valid/acc_unbiased': 88.59, 'best_test_valid/diff': 2.025, 'best_test_valid/acc_skew': 89.603, 'best_test_valid/acc_align': 87.577, 'best_test_test/acc': 88.059, 'best_test_test/acc_unbiased': 88.046, 'best_test_test/diff': 1.062, 'best_test_test/acc_skew': 87.723, 'best_test_test/acc_align': 88.37}
[11 / 20] Learning rate: 0.0001 weight: 0.01
[11 / 20] Loss: 4.624954634944545 CE Loss: 0.31853819399000644 Con Loss: 4.621769250597998
[11 / 20] tensor([[0.837, 0.808],
        [0.922, 0.914]]) {'epoch': 11, 'valid/acc': 87.764, 'valid/acc_unbiased': 88.253, 'valid/diff': 3.131, 'valid/acc_skew': 89.818, 'valid/acc_align': 86.687, 'test/acc': 86.709, 'test/acc_unbiased': 87.02, 'test/diff': 1.86, 'test/acc_skew': 87.95, 'test/acc_align': 86.09}
[11 / 20] best valid accuracy: 88.590 at epoch 10 
 best_stats: {'best_valid_epoch': 10, 'best_valid_valid/acc': 88.481, 'best_valid_valid/acc_unbiased': 88.59, 'best_valid_valid/diff': 2.025, 'best_valid_valid/acc_skew': 89.603, 'best_valid_valid/acc_align': 87.577, 'best_valid_test/acc': 88.059, 'best_valid_test/acc_unbiased': 88.046, 'best_valid_test/diff': 1.062, 'best_valid_test/acc_skew': 87.723, 'best_valid_test/acc_align': 88.37}
[11 / 20] best test accuracy: 88.046 at epoch 10 
 best_stats: {'best_test_epoch': 10, 'best_test_valid/acc': 88.481, 'best_test_valid/acc_unbiased': 88.59, 'best_test_valid/diff': 2.025, 'best_test_valid/acc_skew': 89.603, 'best_test_valid/acc_align': 87.577, 'best_test_test/acc': 88.059, 'best_test_test/acc_unbiased': 88.046, 'best_test_test/diff': 1.062, 'best_test_test/acc_skew': 87.723, 'best_test_test/acc_align': 88.37}
[12 / 20] Learning rate: 0.0001 weight: 0.01
[12 / 20] Loss: 4.614650368468263 CE Loss: 0.31506068394599995 Con Loss: 4.61149976059854
[12 / 20] tensor([[0.889, 0.882],
        [0.879, 0.881]]) {'epoch': 12, 'valid/acc': 88.987, 'valid/acc_unbiased': 89.134, 'valid/diff': 2.966, 'valid/acc_skew': 90.617, 'valid/acc_align': 87.651, 'test/acc': 88.27, 'test/acc_unbiased': 88.266, 'test/diff': 0.47, 'test/acc_skew': 88.384, 'test/acc_align': 88.148}
[12 / 20] best valid accuracy: 89.134 at epoch 12 
 best_stats: {'best_valid_epoch': 12, 'best_valid_valid/acc': 88.987, 'best_valid_valid/acc_unbiased': 89.134, 'best_valid_valid/diff': 2.966, 'best_valid_valid/acc_skew': 90.617, 'best_valid_valid/acc_align': 87.651, 'best_valid_test/acc': 88.27, 'best_valid_test/acc_unbiased': 88.266, 'best_valid_test/diff': 0.47, 'best_valid_test/acc_skew': 88.384, 'best_valid_test/acc_align': 88.148}
[12 / 20] best test accuracy: 88.266 at epoch 12 
 best_stats: {'best_test_epoch': 12, 'best_test_valid/acc': 88.987, 'best_test_valid/acc_unbiased': 89.134, 'best_test_valid/diff': 2.966, 'best_test_valid/acc_skew': 90.617, 'best_test_valid/acc_align': 87.651, 'best_test_test/acc': 88.27, 'best_test_test/acc_unbiased': 88.266, 'best_test_test/diff': 0.47, 'best_test_test/acc_skew': 88.384, 'best_test_test/acc_align': 88.148}
[13 / 20] Learning rate: 0.0001 weight: 0.01
[13 / 20] Loss: 4.613297406969947 CE Loss: 0.30558286565597775 Con Loss: 4.610241588993809
[13 / 20] tensor([[0.864, 0.835],
        [0.903, 0.921]]) {'epoch': 13, 'valid/acc': 88.186, 'valid/acc_unbiased': 88.504, 'valid/diff': 1.784, 'valid/acc_skew': 89.395, 'valid/acc_align': 87.612, 'test/acc': 87.932, 'test/acc_unbiased': 88.055, 'test/diff': 2.394, 'test/acc_skew': 88.32, 'test/acc_align': 87.791}
[13 / 20] best valid accuracy: 89.134 at epoch 12 
 best_stats: {'best_valid_epoch': 12, 'best_valid_valid/acc': 88.987, 'best_valid_valid/acc_unbiased': 89.134, 'best_valid_valid/diff': 2.966, 'best_valid_valid/acc_skew': 90.617, 'best_valid_valid/acc_align': 87.651, 'best_valid_test/acc': 88.27, 'best_valid_test/acc_unbiased': 88.266, 'best_valid_test/diff': 0.47, 'best_valid_test/acc_skew': 88.384, 'best_valid_test/acc_align': 88.148}
[13 / 20] best test accuracy: 88.266 at epoch 12 
 best_stats: {'best_test_epoch': 12, 'best_test_valid/acc': 88.987, 'best_test_valid/acc_unbiased': 89.134, 'best_test_valid/diff': 2.966, 'best_test_valid/acc_skew': 90.617, 'best_test_valid/acc_align': 87.651, 'best_test_test/acc': 88.27, 'best_test_test/acc_unbiased': 88.266, 'best_test_test/diff': 0.47, 'best_test_test/acc_skew': 88.384, 'best_test_test/acc_align': 88.148}
[14 / 20] Learning rate: 1e-05 weight: 0.01
[14 / 20] Loss: 4.605954472964677 CE Loss: 0.30306455279475997 Con Loss: 4.602923843038384
[14 / 20] tensor([[0.864, 0.845],
        [0.894, 0.912]]) {'epoch': 14, 'valid/acc': 88.608, 'valid/acc_unbiased': 88.836, 'valid/diff': 1.443, 'valid/acc_skew': 89.558, 'valid/acc_align': 88.115, 'test/acc': 87.806, 'test/acc_unbiased': 87.874, 'test/diff': 1.864, 'test/acc_skew': 87.887, 'test/acc_align': 87.862}
[14 / 20] best valid accuracy: 89.134 at epoch 12 
 best_stats: {'best_valid_epoch': 12, 'best_valid_valid/acc': 88.987, 'best_valid_valid/acc_unbiased': 89.134, 'best_valid_valid/diff': 2.966, 'best_valid_valid/acc_skew': 90.617, 'best_valid_valid/acc_align': 87.651, 'best_valid_test/acc': 88.27, 'best_valid_test/acc_unbiased': 88.266, 'best_valid_test/diff': 0.47, 'best_valid_test/acc_skew': 88.384, 'best_valid_test/acc_align': 88.148}
[14 / 20] best test accuracy: 88.266 at epoch 12 
 best_stats: {'best_test_epoch': 12, 'best_test_valid/acc': 88.987, 'best_test_valid/acc_unbiased': 89.134, 'best_test_valid/diff': 2.966, 'best_test_valid/acc_skew': 90.617, 'best_test_valid/acc_align': 87.651, 'best_test_test/acc': 88.27, 'best_test_test/acc_unbiased': 88.266, 'best_test_test/diff': 0.47, 'best_test_test/acc_skew': 88.384, 'best_test_test/acc_align': 88.148}
[15 / 20] Learning rate: 1e-05 weight: 0.01
[15 / 20] Loss: 4.5964708800639675 CE Loss: 0.29910079012221885 Con Loss: 4.593479880575493
[15 / 20] tensor([[0.884, 0.869],
        [0.892, 0.897]]) {'epoch': 15, 'valid/acc': 88.734, 'valid/acc_unbiased': 88.889, 'valid/diff': 1.96, 'valid/acc_skew': 89.869, 'valid/acc_align': 87.908, 'test/acc': 88.481, 'test/acc_unbiased': 88.532, 'test/diff': 1.034, 'test/acc_skew': 88.764, 'test/acc_align': 88.301}
[15 / 20] best valid accuracy: 89.134 at epoch 12 
 best_stats: {'best_valid_epoch': 12, 'best_valid_valid/acc': 88.987, 'best_valid_valid/acc_unbiased': 89.134, 'best_valid_valid/diff': 2.966, 'best_valid_valid/acc_skew': 90.617, 'best_valid_valid/acc_align': 87.651, 'best_valid_test/acc': 88.27, 'best_valid_test/acc_unbiased': 88.266, 'best_valid_test/diff': 0.47, 'best_valid_test/acc_skew': 88.384, 'best_valid_test/acc_align': 88.148}
[15 / 20] best test accuracy: 88.532 at epoch 15 
 best_stats: {'best_test_epoch': 15, 'best_test_valid/acc': 88.734, 'best_test_valid/acc_unbiased': 88.889, 'best_test_valid/diff': 1.96, 'best_test_valid/acc_skew': 89.869, 'best_test_valid/acc_align': 87.908, 'best_test_test/acc': 88.481, 'best_test_test/acc_unbiased': 88.532, 'best_test_test/diff': 1.034, 'best_test_test/acc_skew': 88.764, 'best_test_test/acc_align': 88.301}
[16 / 20] Learning rate: 1e-05 weight: 0.01
[16 / 20] Loss: 4.599941619004454 CE Loss: 0.29900683971759323 Con Loss: 4.596951534586169
[16 / 20] tensor([[0.885, 0.874],
        [0.885, 0.892]]) {'epoch': 16, 'valid/acc': 88.861, 'valid/acc_unbiased': 88.962, 'valid/diff': 1.719, 'valid/acc_skew': 89.821, 'valid/acc_align': 88.102, 'test/acc': 88.397, 'test/acc_unbiased': 88.414, 'test/diff': 0.855, 'test/acc_skew': 88.529, 'test/acc_align': 88.299}
[16 / 20] best valid accuracy: 89.134 at epoch 12 
 best_stats: {'best_valid_epoch': 12, 'best_valid_valid/acc': 88.987, 'best_valid_valid/acc_unbiased': 89.134, 'best_valid_valid/diff': 2.966, 'best_valid_valid/acc_skew': 90.617, 'best_valid_valid/acc_align': 87.651, 'best_valid_test/acc': 88.27, 'best_valid_test/acc_unbiased': 88.266, 'best_valid_test/diff': 0.47, 'best_valid_test/acc_skew': 88.384, 'best_valid_test/acc_align': 88.148}
[16 / 20] best test accuracy: 88.532 at epoch 15 
 best_stats: {'best_test_epoch': 15, 'best_test_valid/acc': 88.734, 'best_test_valid/acc_unbiased': 88.889, 'best_test_valid/diff': 1.96, 'best_test_valid/acc_skew': 89.869, 'best_test_valid/acc_align': 87.908, 'best_test_test/acc': 88.481, 'best_test_test/acc_unbiased': 88.532, 'best_test_test/diff': 1.034, 'best_test_test/acc_skew': 88.764, 'best_test_test/acc_align': 88.301}
[17 / 20] Learning rate: 1e-05 weight: 0.01
[17 / 20] Loss: 4.592038000185544 CE Loss: 0.2994610746833837 Con Loss: 4.589043392989035
[17 / 20] tensor([[0.878, 0.864],
        [0.894, 0.905]]) {'epoch': 17, 'valid/acc': 88.945, 'valid/acc_unbiased': 89.106, 'valid/diff': 1.792, 'valid/acc_skew': 90.002, 'valid/acc_align': 88.209, 'test/acc': 88.481, 'test/acc_unbiased': 88.527, 'test/diff': 1.25, 'test/acc_skew': 88.604, 'test/acc_align': 88.45}
[17 / 20] best valid accuracy: 89.134 at epoch 12 
 best_stats: {'best_valid_epoch': 12, 'best_valid_valid/acc': 88.987, 'best_valid_valid/acc_unbiased': 89.134, 'best_valid_valid/diff': 2.966, 'best_valid_valid/acc_skew': 90.617, 'best_valid_valid/acc_align': 87.651, 'best_valid_test/acc': 88.27, 'best_valid_test/acc_unbiased': 88.266, 'best_valid_test/diff': 0.47, 'best_valid_test/acc_skew': 88.384, 'best_valid_test/acc_align': 88.148}
[17 / 20] best test accuracy: 88.532 at epoch 15 
 best_stats: {'best_test_epoch': 15, 'best_test_valid/acc': 88.734, 'best_test_valid/acc_unbiased': 88.889, 'best_test_valid/diff': 1.96, 'best_test_valid/acc_skew': 89.869, 'best_test_valid/acc_align': 87.908, 'best_test_test/acc': 88.481, 'best_test_test/acc_unbiased': 88.532, 'best_test_test/diff': 1.034, 'best_test_test/acc_skew': 88.764, 'best_test_test/acc_align': 88.301}
[18 / 20] Learning rate: 1e-05 weight: 0.01
[18 / 20] Loss: 4.598523564599008 CE Loss: 0.3008279093929359 Con Loss: 4.595515279985776
[18 / 20] tensor([[0.885, 0.879],
        [0.881, 0.889]]) {'epoch': 18, 'valid/acc': 88.819, 'valid/acc_unbiased': 88.94, 'valid/diff': 2.449, 'valid/acc_skew': 90.164, 'valid/acc_align': 87.715, 'test/acc': 88.354, 'test/acc_unbiased': 88.342, 'test/diff': 0.702, 'test/acc_skew': 88.313, 'test/acc_align': 88.372}
[18 / 20] best valid accuracy: 89.134 at epoch 12 
 best_stats: {'best_valid_epoch': 12, 'best_valid_valid/acc': 88.987, 'best_valid_valid/acc_unbiased': 89.134, 'best_valid_valid/diff': 2.966, 'best_valid_valid/acc_skew': 90.617, 'best_valid_valid/acc_align': 87.651, 'best_valid_test/acc': 88.27, 'best_valid_test/acc_unbiased': 88.266, 'best_valid_test/diff': 0.47, 'best_valid_test/acc_skew': 88.384, 'best_valid_test/acc_align': 88.148}
[18 / 20] best test accuracy: 88.532 at epoch 15 
 best_stats: {'best_test_epoch': 15, 'best_test_valid/acc': 88.734, 'best_test_valid/acc_unbiased': 88.889, 'best_test_valid/diff': 1.96, 'best_test_valid/acc_skew': 89.869, 'best_test_valid/acc_align': 87.908, 'best_test_test/acc': 88.481, 'best_test_test/acc_unbiased': 88.532, 'best_test_test/diff': 1.034, 'best_test_test/acc_skew': 88.764, 'best_test_test/acc_align': 88.301}
[19 / 20] Learning rate: 1e-05 weight: 0.01
[19 / 20] Loss: 4.6072355851987385 CE Loss: 0.2954235671601505 Con Loss: 4.604281342045445
[19 / 20] tensor([[0.869, 0.849],
        [0.900, 0.909]]) {'epoch': 19, 'valid/acc': 89.03, 'valid/acc_unbiased': 89.239, 'valid/diff': 1.715, 'valid/acc_skew': 90.096, 'valid/acc_align': 88.381, 'test/acc': 88.101, 'test/acc_unbiased': 88.208, 'test/diff': 1.438, 'test/acc_skew': 88.48, 'test/acc_align': 87.935}
[19 / 20] best valid accuracy: 89.239 at epoch 19 
 best_stats: {'best_valid_epoch': 19, 'best_valid_valid/acc': 89.03, 'best_valid_valid/acc_unbiased': 89.239, 'best_valid_valid/diff': 1.715, 'best_valid_valid/acc_skew': 90.096, 'best_valid_valid/acc_align': 88.381, 'best_valid_test/acc': 88.101, 'best_valid_test/acc_unbiased': 88.208, 'best_valid_test/diff': 1.438, 'best_valid_test/acc_skew': 88.48, 'best_valid_test/acc_align': 87.935}
[19 / 20] best test accuracy: 88.532 at epoch 15 
 best_stats: {'best_test_epoch': 15, 'best_test_valid/acc': 88.734, 'best_test_valid/acc_unbiased': 88.889, 'best_test_valid/diff': 1.96, 'best_test_valid/acc_skew': 89.869, 'best_test_valid/acc_align': 87.908, 'best_test_test/acc': 88.481, 'best_test_test/acc_unbiased': 88.532, 'best_test_test/diff': 1.034, 'best_test_test/acc_skew': 88.764, 'best_test_test/acc_align': 88.301}
[20 / 20] Learning rate: 1e-05 weight: 0.01
[20 / 20] Loss: 4.595879047561422 CE Loss: 0.28907432037091924 Con Loss: 4.592988320260486
[20 / 20] tensor([[0.871, 0.854],
        [0.896, 0.905]]) {'epoch': 20, 'valid/acc': 88.945, 'valid/acc_unbiased': 89.175, 'valid/diff': 2.061, 'valid/acc_skew': 90.206, 'valid/acc_align': 88.145, 'test/acc': 88.059, 'test/acc_unbiased': 88.144, 'test/diff': 1.3, 'test/acc_skew': 88.354, 'test/acc_align': 87.934}
[20 / 20] best valid accuracy: 89.239 at epoch 19 
 best_stats: {'best_valid_epoch': 19, 'best_valid_valid/acc': 89.03, 'best_valid_valid/acc_unbiased': 89.239, 'best_valid_valid/diff': 1.715, 'best_valid_valid/acc_skew': 90.096, 'best_valid_valid/acc_align': 88.381, 'best_valid_test/acc': 88.101, 'best_valid_test/acc_unbiased': 88.208, 'best_valid_test/diff': 1.438, 'best_valid_test/acc_skew': 88.48, 'best_valid_test/acc_align': 87.935}
[20 / 20] best test accuracy: 88.532 at epoch 15 
 best_stats: {'best_test_epoch': 15, 'best_test_valid/acc': 88.734, 'best_test_valid/acc_unbiased': 88.889, 'best_test_valid/diff': 1.96, 'best_test_valid/acc_skew': 89.869, 'best_test_valid/acc_align': 87.908, 'best_test_test/acc': 88.481, 'best_test_test/acc_unbiased': 88.532, 'best_test_test/diff': 1.034, 'best_test_test/acc_skew': 88.764, 'best_test_test/acc_align': 88.301}
Total training time: 0:52:37
