Log level set to: INFO
Set seed: 2
=======> Using Fixed Random Seed: 2 <========
save_path: exp_results/bc-bb0-celeba_blonde-os_0.7-lr0.001-bs128-cbs64-w0.01-ratio30-aug1-seed2
get_celeba - split:train, aug: False, given_y: True, ratio: 0
use existing blonde indices from data/celeba/pickles/blonde
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [37487, 37487]
Target 1: [37487, 37487]
Binary Target 1
---------------------------
Target 0: [37487, 37487]
Target 1: [37487, 37487]
===================================
Normal Label Distribution: 
Target 0: [37487, 37487]
Target 1: [37487, 37487]
===================================
Use BiasedCelebASplit 
 target_attr: blonde split: train 
 tensor([[37487., 37487.],
        [37487., 37487.]])
get_celeba - split:train, aug: 1, given_y: True, ratio: 30
use existing blonde indices from data/celeba/pickles/blonde
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [37431, 37431]
Target 1: [37431, 37431]
Binary Target 1
---------------------------
Target 0: [37431, 37431]
Target 1: [37431, 37431]
===================================
Normal Label Distribution: 
Target 0: [37431, 37431]
Target 1: [37431, 37431]
===================================
Use BiasedCelebASplit 
 target_attr: blonde split: train 
 tensor([[37431., 37431.],
        [37431., 37431.]])
get_celeba - split:train_valid, aug: False, given_y: True, ratio: 0
use existing blonde indices from data/celeba/pickles/blonde
Use BiasedCelebASplit 
 target_attr: blonde split: train_valid 
 tensor([[  403.,  4597.],
        [13344.,   285.]])
get_celeba - split:valid, aug: False, given_y: True, ratio: 0
Use BiasedCelebASplit 
 target_attr: blonde split: valid 
 tensor([[8535., 2874.],
        [8276.,  182.]])
decay_epochs: [3, 6]
[1 / 10] Learning rate: 0.001 weight: 0.01
[1 / 10] Loss: 4.626693774011233 CE Loss: 0.24627666840287085 Con Loss: 4.624231013159818
[1 / 10] tensor([[0.870, 0.919],
        [0.940, 0.912]]) {'epoch': 1, 'valid/acc': 92.104, 'valid/acc_unbiased': 92.53, 'valid/diff': 3.577, 'valid/acc_skew': 94.318, 'valid/acc_align': 90.741, 'test/acc': 90.079, 'test/acc_unbiased': 91.016, 'test/diff': 3.829, 'test/acc_skew': 90.488, 'test/acc_align': 91.544}
[1 / 10] best valid accuracy: 92.530 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 92.104, 'best_valid_valid/acc_unbiased': 92.53, 'best_valid_valid/diff': 3.577, 'best_valid_valid/acc_skew': 94.318, 'best_valid_valid/acc_align': 90.741, 'best_valid_test/acc': 90.079, 'best_valid_test/acc_unbiased': 91.016, 'best_valid_test/diff': 3.829, 'best_valid_test/acc_skew': 90.488, 'best_valid_test/acc_align': 91.544}
[1 / 10] best test accuracy: 91.016 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 92.104, 'best_test_valid/acc_unbiased': 92.53, 'best_test_valid/diff': 3.577, 'best_test_valid/acc_skew': 94.318, 'best_test_valid/acc_align': 90.741, 'best_test_test/acc': 90.079, 'best_test_test/acc_unbiased': 91.016, 'best_test_test/diff': 3.829, 'best_test_test/acc_skew': 90.488, 'best_test_test/acc_align': 91.544}
[2 / 10] Learning rate: 0.001 weight: 0.01
[2 / 10] Loss: 4.569436693584579 CE Loss: 0.21062265244213532 Con Loss: 4.567330466968601
[2 / 10] tensor([[0.870, 0.941],
        [0.943, 0.890]]) {'epoch': 2, 'valid/acc': 93.537, 'valid/acc_unbiased': 93.015, 'valid/diff': 2.398, 'valid/acc_skew': 94.214, 'valid/acc_align': 91.817, 'test/acc': 91.03, 'test/acc_unbiased': 91.101, 'test/diff': 6.172, 'test/acc_skew': 90.656, 'test/acc_align': 91.545}
[2 / 10] best valid accuracy: 93.015 at epoch 2 
 best_stats: {'best_valid_epoch': 2, 'best_valid_valid/acc': 93.537, 'best_valid_valid/acc_unbiased': 93.015, 'best_valid_valid/diff': 2.398, 'best_valid_valid/acc_skew': 94.214, 'best_valid_valid/acc_align': 91.817, 'best_valid_test/acc': 91.03, 'best_valid_test/acc_unbiased': 91.101, 'best_valid_test/diff': 6.172, 'best_valid_test/acc_skew': 90.656, 'best_valid_test/acc_align': 91.545}
[2 / 10] best test accuracy: 91.101 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 93.537, 'best_test_valid/acc_unbiased': 93.015, 'best_test_valid/diff': 2.398, 'best_test_valid/acc_skew': 94.214, 'best_test_valid/acc_align': 91.817, 'best_test_test/acc': 91.03, 'best_test_test/acc_unbiased': 91.101, 'best_test_test/diff': 6.172, 'best_test_test/acc_skew': 90.656, 'best_test_test/acc_align': 91.545}
[3 / 10] Learning rate: 0.001 weight: 0.01
[3 / 10] Loss: 4.551590774409543 CE Loss: 0.19573216883161906 Con Loss: 4.549633449256081
[3 / 10] tensor([[0.827, 0.929],
        [0.965, 0.901]]) {'epoch': 3, 'valid/acc': 93.328, 'valid/acc_unbiased': 93.172, 'valid/diff': 2.461, 'valid/acc_skew': 94.403, 'valid/acc_align': 91.941, 'test/acc': 89.007, 'test/acc_unbiased': 90.547, 'test/diff': 8.324, 'test/acc_skew': 89.573, 'test/acc_align': 91.521}
[3 / 10] best valid accuracy: 93.172 at epoch 3 
 best_stats: {'best_valid_epoch': 3, 'best_valid_valid/acc': 93.328, 'best_valid_valid/acc_unbiased': 93.172, 'best_valid_valid/diff': 2.461, 'best_valid_valid/acc_skew': 94.403, 'best_valid_valid/acc_align': 91.941, 'best_valid_test/acc': 89.007, 'best_valid_test/acc_unbiased': 90.547, 'best_valid_test/diff': 8.324, 'best_valid_test/acc_skew': 89.573, 'best_valid_test/acc_align': 91.521}
[3 / 10] best test accuracy: 91.101 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 93.537, 'best_test_valid/acc_unbiased': 93.015, 'best_test_valid/diff': 2.398, 'best_test_valid/acc_skew': 94.214, 'best_test_valid/acc_align': 91.817, 'best_test_test/acc': 91.03, 'best_test_test/acc_unbiased': 91.101, 'best_test_test/diff': 6.172, 'best_test_test/acc_skew': 90.656, 'best_test_test/acc_align': 91.545}
[4 / 10] Learning rate: 0.0001 weight: 0.01
[4 / 10] Loss: 4.4724981475150525 CE Loss: 0.15370640149749212 Con Loss: 4.470961080584678
[4 / 10] tensor([[0.880, 0.957],
        [0.952, 0.841]]) {'epoch': 4, 'valid/acc': 95.067, 'valid/acc_unbiased': 95.531, 'valid/diff': 1.056, 'valid/acc_skew': 96.059, 'valid/acc_align': 95.003, 'test/acc': 92.213, 'test/acc_unbiased': 90.741, 'test/diff': 9.379, 'test/acc_skew': 91.618, 'test/acc_align': 89.864}
[4 / 10] best valid accuracy: 95.531 at epoch 4 
 best_stats: {'best_valid_epoch': 4, 'best_valid_valid/acc': 95.067, 'best_valid_valid/acc_unbiased': 95.531, 'best_valid_valid/diff': 1.056, 'best_valid_valid/acc_skew': 96.059, 'best_valid_valid/acc_align': 95.003, 'best_valid_test/acc': 92.213, 'best_valid_test/acc_unbiased': 90.741, 'best_valid_test/diff': 9.379, 'best_valid_test/acc_skew': 91.618, 'best_valid_test/acc_align': 89.864}
[4 / 10] best test accuracy: 91.101 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 93.537, 'best_test_valid/acc_unbiased': 93.015, 'best_test_valid/diff': 2.398, 'best_test_valid/acc_skew': 94.214, 'best_test_valid/acc_align': 91.817, 'best_test_test/acc': 91.03, 'best_test_test/acc_unbiased': 91.101, 'best_test_test/diff': 6.172, 'best_test_test/acc_skew': 90.656, 'best_test_test/acc_align': 91.545}
[5 / 10] Learning rate: 0.0001 weight: 0.01
[5 / 10] Loss: 4.436488311619618 CE Loss: 0.13917211341683644 Con Loss: 4.435096584990874
[5 / 10] tensor([[0.864, 0.957],
        [0.957, 0.846]]) {'epoch': 5, 'valid/acc': 95.464, 'valid/acc_unbiased': 96.018, 'valid/diff': 1.729, 'valid/acc_skew': 96.882, 'valid/acc_align': 95.153, 'test/acc': 91.589, 'test/acc_unbiased': 90.587, 'test/diff': 10.127, 'test/acc_skew': 91.041, 'test/acc_align': 90.133}
[5 / 10] best valid accuracy: 96.018 at epoch 5 
 best_stats: {'best_valid_epoch': 5, 'best_valid_valid/acc': 95.464, 'best_valid_valid/acc_unbiased': 96.018, 'best_valid_valid/diff': 1.729, 'best_valid_valid/acc_skew': 96.882, 'best_valid_valid/acc_align': 95.153, 'best_valid_test/acc': 91.589, 'best_valid_test/acc_unbiased': 90.587, 'best_valid_test/diff': 10.127, 'best_valid_test/acc_skew': 91.041, 'best_valid_test/acc_align': 90.133}
[5 / 10] best test accuracy: 91.101 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 93.537, 'best_test_valid/acc_unbiased': 93.015, 'best_test_valid/diff': 2.398, 'best_test_valid/acc_skew': 94.214, 'best_test_valid/acc_align': 91.817, 'best_test_test/acc': 91.03, 'best_test_test/acc_unbiased': 91.101, 'best_test_test/diff': 6.172, 'best_test_test/acc_skew': 90.656, 'best_test_test/acc_align': 91.545}
[6 / 10] Learning rate: 0.0001 weight: 0.01
[6 / 10] Loss: 4.42073945972179 CE Loss: 0.1321489938348989 Con Loss: 4.419417971663099
[6 / 10] tensor([[0.844, 0.944],
        [0.966, 0.896]]) {'epoch': 6, 'valid/acc': 94.804, 'valid/acc_unbiased': 96.532, 'valid/diff': 2.101, 'valid/acc_skew': 97.178, 'valid/acc_align': 95.886, 'test/acc': 90.386, 'test/acc_unbiased': 91.249, 'test/diff': 8.532, 'test/acc_skew': 90.515, 'test/acc_align': 91.983}
[6 / 10] best valid accuracy: 96.532 at epoch 6 
 best_stats: {'best_valid_epoch': 6, 'best_valid_valid/acc': 94.804, 'best_valid_valid/acc_unbiased': 96.532, 'best_valid_valid/diff': 2.101, 'best_valid_valid/acc_skew': 97.178, 'best_valid_valid/acc_align': 95.886, 'best_valid_test/acc': 90.386, 'best_valid_test/acc_unbiased': 91.249, 'best_valid_test/diff': 8.532, 'best_valid_test/acc_skew': 90.515, 'best_valid_test/acc_align': 91.983}
[6 / 10] best test accuracy: 91.249 at epoch 6 
 best_stats: {'best_test_epoch': 6, 'best_test_valid/acc': 94.804, 'best_test_valid/acc_unbiased': 96.532, 'best_test_valid/diff': 2.101, 'best_test_valid/acc_skew': 97.178, 'best_test_valid/acc_align': 95.886, 'best_test_test/acc': 90.386, 'best_test_test/acc_unbiased': 91.249, 'best_test_test/diff': 8.532, 'best_test_test/acc_skew': 90.515, 'best_test_test/acc_align': 91.983}
[7 / 10] Learning rate: 1e-05 weight: 0.01
[7 / 10] Loss: 4.400932021841546 CE Loss: 0.1224604262018743 Con Loss: 4.399707414037525
[7 / 10] tensor([[0.858, 0.960],
        [0.962, 0.846]]) {'epoch': 7, 'valid/acc': 95.904, 'valid/acc_unbiased': 96.525, 'valid/diff': 1.301, 'valid/acc_skew': 97.176, 'valid/acc_align': 95.874, 'test/acc': 91.534, 'test/acc_unbiased': 90.65, 'test/diff': 10.884, 'test/acc_skew': 91.004, 'test/acc_align': 90.296}
[7 / 10] best valid accuracy: 96.532 at epoch 6 
 best_stats: {'best_valid_epoch': 6, 'best_valid_valid/acc': 94.804, 'best_valid_valid/acc_unbiased': 96.532, 'best_valid_valid/diff': 2.101, 'best_valid_valid/acc_skew': 97.178, 'best_valid_valid/acc_align': 95.886, 'best_valid_test/acc': 90.386, 'best_valid_test/acc_unbiased': 91.249, 'best_valid_test/diff': 8.532, 'best_valid_test/acc_skew': 90.515, 'best_valid_test/acc_align': 91.983}
[7 / 10] best test accuracy: 91.249 at epoch 6 
 best_stats: {'best_test_epoch': 6, 'best_test_valid/acc': 94.804, 'best_test_valid/acc_unbiased': 96.532, 'best_test_valid/diff': 2.101, 'best_test_valid/acc_skew': 97.178, 'best_test_valid/acc_align': 95.886, 'best_test_test/acc': 90.386, 'best_test_test/acc_unbiased': 91.249, 'best_test_test/diff': 8.532, 'best_test_test/acc_skew': 90.515, 'best_test_test/acc_align': 91.983}
[8 / 10] Learning rate: 1e-05 weight: 0.01
[8 / 10] Loss: 4.3916027003481695 CE Loss: 0.12135419408406259 Con Loss: 4.390389155288331
[8 / 10] tensor([[0.856, 0.960],
        [0.961, 0.824]]) {'epoch': 8, 'valid/acc': 95.829, 'valid/acc_unbiased': 96.775, 'valid/diff': 1.89, 'valid/acc_skew': 97.72, 'valid/acc_align': 95.829, 'test/acc': 91.408, 'test/acc_unbiased': 90.021, 'test/diff': 12.025, 'test/acc_skew': 90.852, 'test/acc_align': 89.191}
[8 / 10] best valid accuracy: 96.775 at epoch 8 
 best_stats: {'best_valid_epoch': 8, 'best_valid_valid/acc': 95.829, 'best_valid_valid/acc_unbiased': 96.775, 'best_valid_valid/diff': 1.89, 'best_valid_valid/acc_skew': 97.72, 'best_valid_valid/acc_align': 95.829, 'best_valid_test/acc': 91.408, 'best_valid_test/acc_unbiased': 90.021, 'best_valid_test/diff': 12.025, 'best_valid_test/acc_skew': 90.852, 'best_valid_test/acc_align': 89.191}
[8 / 10] best test accuracy: 91.249 at epoch 6 
 best_stats: {'best_test_epoch': 6, 'best_test_valid/acc': 94.804, 'best_test_valid/acc_unbiased': 96.532, 'best_test_valid/diff': 2.101, 'best_test_valid/acc_skew': 97.178, 'best_test_valid/acc_align': 95.886, 'best_test_test/acc': 90.386, 'best_test_test/acc_unbiased': 91.249, 'best_test_test/diff': 8.532, 'best_test_test/acc_skew': 90.515, 'best_test_test/acc_align': 91.983}
[9 / 10] Learning rate: 1e-05 weight: 0.01
[9 / 10] Loss: 4.390777337839545 CE Loss: 0.12055440612711112 Con Loss: 4.389571790585544
[9 / 10] tensor([[0.839, 0.952],
        [0.969, 0.863]]) {'epoch': 9, 'valid/acc': 95.416, 'valid/acc_unbiased': 96.496, 'valid/diff': 1.128, 'valid/acc_skew': 97.06, 'valid/acc_align': 95.932, 'test/acc': 90.492, 'test/acc_unbiased': 90.55, 'test/diff': 10.947, 'test/acc_skew': 90.379, 'test/acc_align': 90.721}
[9 / 10] best valid accuracy: 96.775 at epoch 8 
 best_stats: {'best_valid_epoch': 8, 'best_valid_valid/acc': 95.829, 'best_valid_valid/acc_unbiased': 96.775, 'best_valid_valid/diff': 1.89, 'best_valid_valid/acc_skew': 97.72, 'best_valid_valid/acc_align': 95.829, 'best_valid_test/acc': 91.408, 'best_valid_test/acc_unbiased': 90.021, 'best_valid_test/diff': 12.025, 'best_valid_test/acc_skew': 90.852, 'best_valid_test/acc_align': 89.191}
[9 / 10] best test accuracy: 91.249 at epoch 6 
 best_stats: {'best_test_epoch': 6, 'best_test_valid/acc': 94.804, 'best_test_valid/acc_unbiased': 96.532, 'best_test_valid/diff': 2.101, 'best_test_valid/acc_skew': 97.178, 'best_test_valid/acc_align': 95.886, 'best_test_test/acc': 90.386, 'best_test_test/acc_unbiased': 91.249, 'best_test_test/diff': 8.532, 'best_test_test/acc_skew': 90.515, 'best_test_test/acc_align': 91.983}
[10 / 10] Learning rate: 1e-05 weight: 0.01
[10 / 10] Loss: 4.3841455744880395 CE Loss: 0.11961067300917426 Con Loss: 4.38294946688493
[10 / 10] tensor([[0.839, 0.953],
        [0.967, 0.857]]) {'epoch': 10, 'valid/acc': 95.502, 'valid/acc_unbiased': 96.607, 'valid/diff': 1.249, 'valid/acc_skew': 97.189, 'valid/acc_align': 96.026, 'test/acc': 90.512, 'test/acc_unbiased': 90.394, 'test/diff': 11.184, 'test/acc_skew': 90.275, 'test/acc_align': 90.513}
[10 / 10] best valid accuracy: 96.775 at epoch 8 
 best_stats: {'best_valid_epoch': 8, 'best_valid_valid/acc': 95.829, 'best_valid_valid/acc_unbiased': 96.775, 'best_valid_valid/diff': 1.89, 'best_valid_valid/acc_skew': 97.72, 'best_valid_valid/acc_align': 95.829, 'best_valid_test/acc': 91.408, 'best_valid_test/acc_unbiased': 90.021, 'best_valid_test/diff': 12.025, 'best_valid_test/acc_skew': 90.852, 'best_valid_test/acc_align': 89.191}
[10 / 10] best test accuracy: 91.249 at epoch 6 
 best_stats: {'best_test_epoch': 6, 'best_test_valid/acc': 94.804, 'best_test_valid/acc_unbiased': 96.532, 'best_test_valid/diff': 2.101, 'best_test_valid/acc_skew': 97.178, 'best_test_valid/acc_align': 95.886, 'best_test_test/acc': 90.386, 'best_test_test/acc_unbiased': 91.249, 'best_test_test/diff': 8.532, 'best_test_test/acc_skew': 90.515, 'best_test_test/acc_align': 91.983}
Total training time: 2:06:32
