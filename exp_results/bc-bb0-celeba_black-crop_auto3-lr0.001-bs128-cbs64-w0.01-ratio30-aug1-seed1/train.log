Log level set to: INFO
Set seed: 1
=======> Using Fixed Random Seed: 1 <========
save_path: exp_results/bc-bb0-celeba_black-crop_auto3-lr0.001-bs128-cbs64-w0.01-ratio30-aug1-seed1
get_celeba - split:train, aug: False, given_y: True, ratio: 0
use existing black indices from data/celeba/pickles/black
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [60539, 38593]
Target 1: [8008, 16048]
Binary Target 1
---------------------------
Target 0: [60539, 38593]
Target 1: [8008, 16048]
===================================
Normal Label Distribution: 
Target 0: [60539, 38593]
Target 1: [8008, 16048]
===================================
Use BiasedCelebASplit 
 target_attr: black split: train 
 tensor([[60539.,  8008.],
        [38593., 16048.]])
get_celeba - split:train, aug: 1, given_y: True, ratio: 30
use existing black indices from data/celeba/pickles/black
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [60508, 38612]
Target 1: [8008, 16060]
Binary Target 1
---------------------------
Target 0: [60508, 38612]
Target 1: [8008, 16060]
===================================
Normal Label Distribution: 
Target 0: [60508, 38612]
Target 1: [8008, 16060]
===================================
Use BiasedCelebASplit 
 target_attr: black split: train 
 tensor([[60508.,  8008.],
        [38612., 16060.]])
get_celeba - split:train_valid, aug: False, given_y: True, ratio: 0
use existing black indices from data/celeba/pickles/black
Use BiasedCelebASplit 
 target_attr: black split: train_valid 
 tensor([[15227.,  1970.],
        [ 9563.,  4038.]])
get_celeba - split:valid, aug: False, given_y: True, ratio: 0
Use BiasedCelebASplit 
 target_attr: black split: valid 
 tensor([[9752., 1657.],
        [5971., 2487.]])
decay_epochs: [3, 6]
[1 / 10] Learning rate: 0.001 weight: 0.01
[1 / 10] Loss: 4.8251213333755905 CE Loss: 0.3437161306065352 Con Loss: 4.821684166514712
[1 / 10] tensor([[0.911, 0.862],
        [0.800, 0.776]]) {'epoch': 1, 'valid/acc': 86.847, 'valid/acc_unbiased': 82.993, 'valid/diff': 3.568, 'valid/acc_skew': 82.359, 'valid/acc_align': 83.627, 'test/acc': 87.014, 'test/acc_unbiased': 83.712, 'test/diff': 3.66, 'test/acc_skew': 83.082, 'test/acc_align': 84.342}
[1 / 10] best valid accuracy: 82.993 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 86.847, 'best_valid_valid/acc_unbiased': 82.993, 'best_valid_valid/diff': 3.568, 'best_valid_valid/acc_skew': 82.359, 'best_valid_valid/acc_align': 83.627, 'best_valid_test/acc': 87.014, 'best_valid_test/acc_unbiased': 83.712, 'best_valid_test/diff': 3.66, 'best_valid_test/acc_skew': 83.082, 'best_valid_test/acc_align': 84.342}
[1 / 10] best test accuracy: 83.712 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 86.847, 'best_test_valid/acc_unbiased': 82.993, 'best_test_valid/diff': 3.568, 'best_test_valid/acc_skew': 82.359, 'best_test_valid/acc_align': 83.627, 'best_test_test/acc': 87.014, 'best_test_test/acc_unbiased': 83.712, 'best_test_test/diff': 3.66, 'best_test_test/acc_skew': 83.082, 'best_test_test/acc_align': 84.342}
[2 / 10] Learning rate: 0.001 weight: 0.01
[2 / 10] Loss: 4.810358221114338 CE Loss: 0.31541193620927976 Con Loss: 4.807204109680174
[2 / 10] tensor([[0.869, 0.790],
        [0.891, 0.861]]) {'epoch': 2, 'valid/acc': 84.411, 'valid/acc_unbiased': 84.771, 'valid/diff': 5.722, 'valid/acc_skew': 84.62, 'valid/acc_align': 84.921, 'test/acc': 84.603, 'test/acc_unbiased': 85.274, 'test/diff': 5.495, 'test/acc_skew': 84.051, 'test/acc_align': 86.496}
[2 / 10] best valid accuracy: 84.771 at epoch 2 
 best_stats: {'best_valid_epoch': 2, 'best_valid_valid/acc': 84.411, 'best_valid_valid/acc_unbiased': 84.771, 'best_valid_valid/diff': 5.722, 'best_valid_valid/acc_skew': 84.62, 'best_valid_valid/acc_align': 84.921, 'best_valid_test/acc': 84.603, 'best_valid_test/acc_unbiased': 85.274, 'best_valid_test/diff': 5.495, 'best_valid_test/acc_skew': 84.051, 'best_valid_test/acc_align': 86.496}
[2 / 10] best test accuracy: 85.274 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 84.411, 'best_test_valid/acc_unbiased': 84.771, 'best_test_valid/diff': 5.722, 'best_test_valid/acc_skew': 84.62, 'best_test_valid/acc_align': 84.921, 'best_test_test/acc': 84.603, 'best_test_test/acc_unbiased': 85.274, 'best_test_test/diff': 5.495, 'best_test_test/acc_skew': 84.051, 'best_test_test/acc_align': 86.496}
[3 / 10] Learning rate: 0.001 weight: 0.01
[3 / 10] Loss: 4.80242858760004 CE Loss: 0.30294560559400474 Con Loss: 4.799399129917905
[3 / 10] tensor([[0.975, 0.959],
        [0.484, 0.554]]) {'epoch': 3, 'valid/acc': 87.746, 'valid/acc_unbiased': 72.94, 'valid/diff': 4.901, 'valid/acc_skew': 70.489, 'valid/acc_align': 75.39, 'test/acc': 87.653, 'test/acc_unbiased': 74.293, 'test/diff': 4.289, 'test/acc_skew': 72.149, 'test/acc_align': 76.438}
[3 / 10] best valid accuracy: 84.771 at epoch 2 
 best_stats: {'best_valid_epoch': 2, 'best_valid_valid/acc': 84.411, 'best_valid_valid/acc_unbiased': 84.771, 'best_valid_valid/diff': 5.722, 'best_valid_valid/acc_skew': 84.62, 'best_valid_valid/acc_align': 84.921, 'best_valid_test/acc': 84.603, 'best_valid_test/acc_unbiased': 85.274, 'best_valid_test/diff': 5.495, 'best_valid_test/acc_skew': 84.051, 'best_valid_test/acc_align': 86.496}
[3 / 10] best test accuracy: 85.274 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 84.411, 'best_test_valid/acc_unbiased': 84.771, 'best_test_valid/diff': 5.722, 'best_test_valid/acc_skew': 84.62, 'best_test_valid/acc_align': 84.921, 'best_test_test/acc': 84.603, 'best_test_test/acc_unbiased': 85.274, 'best_test_test/diff': 5.495, 'best_test_test/acc_skew': 84.051, 'best_test_test/acc_align': 86.496}
[4 / 10] Learning rate: 0.0001 weight: 0.01
[4 / 10] Loss: 4.775999075484577 CE Loss: 0.2702618551095763 Con Loss: 4.773296442814383
[4 / 10] tensor([[0.932, 0.885],
        [0.787, 0.803]]) {'epoch': 4, 'valid/acc': 88.964, 'valid/acc_unbiased': 84.553, 'valid/diff': 2.204, 'valid/acc_skew': 83.451, 'valid/acc_align': 85.655, 'test/acc': 88.946, 'test/acc_unbiased': 85.165, 'test/diff': 3.139, 'test/acc_skew': 83.595, 'test/acc_align': 86.734}
[4 / 10] best valid accuracy: 84.771 at epoch 2 
 best_stats: {'best_valid_epoch': 2, 'best_valid_valid/acc': 84.411, 'best_valid_valid/acc_unbiased': 84.771, 'best_valid_valid/diff': 5.722, 'best_valid_valid/acc_skew': 84.62, 'best_valid_valid/acc_align': 84.921, 'best_valid_test/acc': 84.603, 'best_valid_test/acc_unbiased': 85.274, 'best_valid_test/diff': 5.495, 'best_valid_test/acc_skew': 84.051, 'best_valid_test/acc_align': 86.496}
[4 / 10] best test accuracy: 85.274 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 84.411, 'best_test_valid/acc_unbiased': 84.771, 'best_test_valid/diff': 5.722, 'best_test_valid/acc_skew': 84.62, 'best_test_valid/acc_align': 84.921, 'best_test_test/acc': 84.603, 'best_test_test/acc_unbiased': 85.274, 'best_test_test/diff': 5.495, 'best_test_test/acc_skew': 84.051, 'best_test_test/acc_align': 86.496}
[5 / 10] Learning rate: 0.0001 weight: 0.01
[5 / 10] Loss: 4.7701222931335785 CE Loss: 0.2568979321580686 Con Loss: 4.767553316430891
[5 / 10] tensor([[0.938, 0.890],
        [0.795, 0.801]]) {'epoch': 5, 'valid/acc': 89.59, 'valid/acc_unbiased': 85.394, 'valid/diff': 2.85, 'valid/acc_skew': 84.603, 'valid/acc_align': 86.186, 'test/acc': 89.465, 'test/acc_unbiased': 85.617, 'test/diff': 2.679, 'test/acc_skew': 84.277, 'test/acc_align': 86.957}
[5 / 10] best valid accuracy: 85.394 at epoch 5 
 best_stats: {'best_valid_epoch': 5, 'best_valid_valid/acc': 89.59, 'best_valid_valid/acc_unbiased': 85.394, 'best_valid_valid/diff': 2.85, 'best_valid_valid/acc_skew': 84.603, 'best_valid_valid/acc_align': 86.186, 'best_valid_test/acc': 89.465, 'best_valid_test/acc_unbiased': 85.617, 'best_valid_test/diff': 2.679, 'best_valid_test/acc_skew': 84.277, 'best_valid_test/acc_align': 86.957}
[5 / 10] best test accuracy: 85.617 at epoch 5 
 best_stats: {'best_test_epoch': 5, 'best_test_valid/acc': 89.59, 'best_test_valid/acc_unbiased': 85.394, 'best_test_valid/diff': 2.85, 'best_test_valid/acc_skew': 84.603, 'best_test_valid/acc_align': 86.186, 'best_test_test/acc': 89.465, 'best_test_test/acc_unbiased': 85.617, 'best_test_test/diff': 2.679, 'best_test_test/acc_skew': 84.277, 'best_test_test/acc_align': 86.957}
[6 / 10] Learning rate: 0.0001 weight: 0.01
[6 / 10] Loss: 4.76387986999969 CE Loss: 0.24690526752699218 Con Loss: 4.761410816964435
[6 / 10] tensor([[0.952, 0.939],
        [0.733, 0.721]]) {'epoch': 6, 'valid/acc': 90.142, 'valid/acc_unbiased': 83.379, 'valid/diff': 3.548, 'valid/acc_skew': 84.609, 'valid/acc_align': 82.149, 'test/acc': 90.094, 'test/acc_unbiased': 83.628, 'test/diff': 1.2, 'test/acc_skew': 83.593, 'test/acc_align': 83.663}
[6 / 10] best valid accuracy: 85.394 at epoch 5 
 best_stats: {'best_valid_epoch': 5, 'best_valid_valid/acc': 89.59, 'best_valid_valid/acc_unbiased': 85.394, 'best_valid_valid/diff': 2.85, 'best_valid_valid/acc_skew': 84.603, 'best_valid_valid/acc_align': 86.186, 'best_valid_test/acc': 89.465, 'best_valid_test/acc_unbiased': 85.617, 'best_valid_test/diff': 2.679, 'best_valid_test/acc_skew': 84.277, 'best_valid_test/acc_align': 86.957}
[6 / 10] best test accuracy: 85.617 at epoch 5 
 best_stats: {'best_test_epoch': 5, 'best_test_valid/acc': 89.59, 'best_test_valid/acc_unbiased': 85.394, 'best_test_valid/diff': 2.85, 'best_test_valid/acc_skew': 84.603, 'best_test_valid/acc_align': 86.186, 'best_test_test/acc': 89.465, 'best_test_test/acc_unbiased': 85.617, 'best_test_test/diff': 2.679, 'best_test_test/acc_skew': 84.277, 'best_test_test/acc_align': 86.957}
[7 / 10] Learning rate: 1e-05 weight: 0.01
[7 / 10] Loss: 4.759432309617639 CE Loss: 0.2407870823622377 Con Loss: 4.757024440517029
[7 / 10] tensor([[0.957, 0.937],
        [0.727, 0.732]]) {'epoch': 7, 'valid/acc': 90.542, 'valid/acc_unbiased': 83.669, 'valid/diff': 2.359, 'valid/acc_skew': 83.931, 'valid/acc_align': 83.406, 'test/acc': 90.366, 'test/acc_unbiased': 83.822, 'test/diff': 1.27, 'test/acc_skew': 83.187, 'test/acc_align': 84.457}
[7 / 10] best valid accuracy: 85.394 at epoch 5 
 best_stats: {'best_valid_epoch': 5, 'best_valid_valid/acc': 89.59, 'best_valid_valid/acc_unbiased': 85.394, 'best_valid_valid/diff': 2.85, 'best_valid_valid/acc_skew': 84.603, 'best_valid_valid/acc_align': 86.186, 'best_valid_test/acc': 89.465, 'best_valid_test/acc_unbiased': 85.617, 'best_valid_test/diff': 2.679, 'best_valid_test/acc_skew': 84.277, 'best_valid_test/acc_align': 86.957}
[7 / 10] best test accuracy: 85.617 at epoch 5 
 best_stats: {'best_test_epoch': 5, 'best_test_valid/acc': 89.59, 'best_test_valid/acc_unbiased': 85.394, 'best_test_valid/diff': 2.85, 'best_test_valid/acc_skew': 84.603, 'best_test_valid/acc_align': 86.186, 'best_test_test/acc': 89.465, 'best_test_test/acc_unbiased': 85.617, 'best_test_test/diff': 2.679, 'best_test_test/acc_skew': 84.277, 'best_test_test/acc_align': 86.957}
[8 / 10] Learning rate: 1e-05 weight: 0.01
[8 / 10] Loss: 4.756493517496054 CE Loss: 0.23681571233499768 Con Loss: 4.754125360041797
[8 / 10] tensor([[0.954, 0.928],
        [0.743, 0.755]]) {'epoch': 8, 'valid/acc': 90.636, 'valid/acc_unbiased': 84.435, 'valid/diff': 2.075, 'valid/acc_skew': 84.4, 'valid/acc_align': 84.469, 'test/acc': 90.356, 'test/acc_unbiased': 84.496, 'test/diff': 1.886, 'test/acc_skew': 83.553, 'test/acc_align': 85.439}
[8 / 10] best valid accuracy: 85.394 at epoch 5 
 best_stats: {'best_valid_epoch': 5, 'best_valid_valid/acc': 89.59, 'best_valid_valid/acc_unbiased': 85.394, 'best_valid_valid/diff': 2.85, 'best_valid_valid/acc_skew': 84.603, 'best_valid_valid/acc_align': 86.186, 'best_valid_test/acc': 89.465, 'best_valid_test/acc_unbiased': 85.617, 'best_valid_test/diff': 2.679, 'best_valid_test/acc_skew': 84.277, 'best_valid_test/acc_align': 86.957}
[8 / 10] best test accuracy: 85.617 at epoch 5 
 best_stats: {'best_test_epoch': 5, 'best_test_valid/acc': 89.59, 'best_test_valid/acc_unbiased': 85.394, 'best_test_valid/diff': 2.85, 'best_test_valid/acc_skew': 84.603, 'best_test_valid/acc_align': 86.186, 'best_test_test/acc': 89.465, 'best_test_test/acc_unbiased': 85.617, 'best_test_test/diff': 2.679, 'best_test_test/acc_skew': 84.277, 'best_test_test/acc_align': 86.957}
[9 / 10] Learning rate: 1e-05 weight: 0.01
[9 / 10] Loss: 4.755130905715948 CE Loss: 0.23612640585245806 Con Loss: 4.752769648736532
[9 / 10] tensor([[0.958, 0.929],
        [0.710, 0.745]]) {'epoch': 9, 'valid/acc': 90.529, 'valid/acc_unbiased': 83.495, 'valid/diff': 1.616, 'valid/acc_skew': 83.098, 'valid/acc_align': 83.891, 'test/acc': 90.22, 'test/acc_unbiased': 83.564, 'test/diff': 3.207, 'test/acc_skew': 81.96, 'test/acc_align': 85.167}
[9 / 10] best valid accuracy: 85.394 at epoch 5 
 best_stats: {'best_valid_epoch': 5, 'best_valid_valid/acc': 89.59, 'best_valid_valid/acc_unbiased': 85.394, 'best_valid_valid/diff': 2.85, 'best_valid_valid/acc_skew': 84.603, 'best_valid_valid/acc_align': 86.186, 'best_valid_test/acc': 89.465, 'best_valid_test/acc_unbiased': 85.617, 'best_valid_test/diff': 2.679, 'best_valid_test/acc_skew': 84.277, 'best_valid_test/acc_align': 86.957}
[9 / 10] best test accuracy: 85.617 at epoch 5 
 best_stats: {'best_test_epoch': 5, 'best_test_valid/acc': 89.59, 'best_test_valid/acc_unbiased': 85.394, 'best_test_valid/diff': 2.85, 'best_test_valid/acc_skew': 84.603, 'best_test_valid/acc_align': 86.186, 'best_test_test/acc': 89.465, 'best_test_test/acc_unbiased': 85.617, 'best_test_test/diff': 2.679, 'best_test_test/acc_skew': 84.277, 'best_test_test/acc_align': 86.957}
[10 / 10] Learning rate: 1e-05 weight: 0.01
[10 / 10] Loss: 4.7548448629540605 CE Loss: 0.2344387176647687 Con Loss: 4.752500475840657
[10 / 10] tensor([[0.964, 0.946],
        [0.684, 0.709]]) {'epoch': 10, 'valid/acc': 90.642, 'valid/acc_unbiased': 82.494, 'valid/diff': 1.531, 'valid/acc_skew': 82.417, 'valid/acc_align': 82.571, 'test/acc': 90.311, 'test/acc_unbiased': 82.569, 'test/diff': 2.11, 'test/acc_skew': 81.514, 'test/acc_align': 83.624}
[10 / 10] best valid accuracy: 85.394 at epoch 5 
 best_stats: {'best_valid_epoch': 5, 'best_valid_valid/acc': 89.59, 'best_valid_valid/acc_unbiased': 85.394, 'best_valid_valid/diff': 2.85, 'best_valid_valid/acc_skew': 84.603, 'best_valid_valid/acc_align': 86.186, 'best_valid_test/acc': 89.465, 'best_valid_test/acc_unbiased': 85.617, 'best_valid_test/diff': 2.679, 'best_valid_test/acc_skew': 84.277, 'best_valid_test/acc_align': 86.957}
[10 / 10] best test accuracy: 85.617 at epoch 5 
 best_stats: {'best_test_epoch': 5, 'best_test_valid/acc': 89.59, 'best_test_valid/acc_unbiased': 85.394, 'best_test_valid/diff': 2.85, 'best_test_valid/acc_skew': 84.603, 'best_test_valid/acc_align': 86.186, 'best_test_test/acc': 89.465, 'best_test_test/acc_unbiased': 85.617, 'best_test_test/diff': 2.679, 'best_test_test/acc_skew': 84.277, 'best_test_test/acc_align': 86.957}
Total training time: 2:09:07
