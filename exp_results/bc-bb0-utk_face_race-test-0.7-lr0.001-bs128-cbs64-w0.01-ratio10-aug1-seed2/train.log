Log level set to: INFO
Set seed: 2
=======> Using Fixed Random Seed: 2 <========
save_path: exp_results/bc-bb0-utk_face_race-test-0.7-lr0.001-bs128-cbs64-w0.01-ratio10-aug1-seed2
get_utk_face - split: train, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_race-0.7
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [4407, 1658]
Target 1: [1322, 5529]
Binary Target 1
---------------------------
Target 0: [4407, 1658]
Target 1: [1322, 5529]
===================================
Normal Label Distribution: 
Target 0: [4407, 1658]
Target 1: [1322, 5529]
===================================
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [4407, 1658]
Target 1: [1322, 5529]
Binary Target 1
---------------------------
Target 0: [4407, 1658]
Target 1: [1322, 5529]
===================================
Normal Label Distribution: 
Target 0: [4407, 1658]
Target 1: [1322, 5529]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 12916, target_attr: gender, bias_attr: race bias_rate: 0.7
['[train] target_0-bias_0: 4407', '[train] target_0-bias_1: 1658', '[train] target_1-bias_0: 1322', '[train] target_1-bias_1: 5529']
confusion_matrix - 
 original: tensor([[4407., 1322.],
        [1658., 5529.]]), 
 normalized: tensor([[0.769, 0.231],
        [0.231, 0.769]]), 
 b|y: tensor([[0.727, 0.273],
        [0.193, 0.807]])
get_utk_face - split: train, aug: 1, given_y: True, ratio: 10
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_race-0.7
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [4407, 1658]
Target 1: [1322, 5529]
Binary Target 1
---------------------------
Target 0: [4407, 1658]
Target 1: [1322, 5529]
===================================
Normal Label Distribution: 
Target 0: [4407, 1658]
Target 1: [1322, 5529]
===================================
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [4407, 1658]
Target 1: [1322, 5529]
Binary Target 1
---------------------------
Target 0: [4407, 1658]
Target 1: [1322, 5529]
===================================
Normal Label Distribution: 
Target 0: [4407, 1658]
Target 1: [1322, 5529]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 12916, target_attr: gender, bias_attr: race bias_rate: 0.7
['[train] target_0-bias_0: 4407', '[train] target_0-bias_1: 1658', '[train] target_1-bias_0: 1322', '[train] target_1-bias_1: 5529']
get_utk_face - split: valid, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_race-0.7
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [583, 684]
Target 1: [457, 646]
Binary Target 1
---------------------------
Target 0: [583, 684]
Target 1: [457, 646]
===================================
Normal Label Distribution: 
Target 0: [583, 684]
Target 1: [457, 646]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 2370, target_attr: gender, bias_attr: race bias_rate: 0.7
['[valid] target_0-bias_0: 583', '[valid] target_0-bias_1: 684', '[valid] target_1-bias_0: 457', '[valid] target_1-bias_1: 646']
get_utk_face - split: test, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_race-0.7
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [558, 677]
Target 1: [462, 673]
Binary Target 1
---------------------------
Target 0: [558, 677]
Target 1: [462, 673]
===================================
Normal Label Distribution: 
Target 0: [558, 677]
Target 1: [462, 673]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 2370, target_attr: gender, bias_attr: race bias_rate: 0.7
['[test] target_0-bias_0: 558', '[test] target_0-bias_1: 677', '[test] target_1-bias_0: 462', '[test] target_1-bias_1: 673']
decay_epochs: [6, 13]
[1 / 20] Learning rate: 0.001 weight: 0.01
[1 / 20] Loss: 4.879763992329654 CE Loss: 0.5735043418521887 Con Loss: 4.874028945419581
[1 / 20] tensor([[0.763, 0.710],
        [0.820, 0.866]]) {'epoch': 1, 'valid/acc': 78.65, 'valid/acc_unbiased': 79.111, 'valid/diff': 2.34, 'valid/acc_skew': 77.941, 'valid/acc_align': 80.28, 'test/acc': 78.861, 'test/acc_unbiased': 79.014, 'test/diff': 4.944, 'test/acc_skew': 76.542, 'test/acc_align': 81.486}
[1 / 20] best valid accuracy: 79.111 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 78.65, 'best_valid_valid/acc_unbiased': 79.111, 'best_valid_valid/diff': 2.34, 'best_valid_valid/acc_skew': 77.941, 'best_valid_valid/acc_align': 80.28, 'best_valid_test/acc': 78.861, 'best_valid_test/acc_unbiased': 79.014, 'best_valid_test/diff': 4.944, 'best_valid_test/acc_skew': 76.542, 'best_valid_test/acc_align': 81.486}
[1 / 20] best test accuracy: 79.014 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 78.65, 'best_test_valid/acc_unbiased': 79.111, 'best_test_valid/diff': 2.34, 'best_test_valid/acc_skew': 77.941, 'best_test_valid/acc_align': 80.28, 'best_test_test/acc': 78.861, 'best_test_test/acc_unbiased': 79.014, 'best_test_test/diff': 4.944, 'best_test_test/acc_skew': 76.542, 'best_test_test/acc_align': 81.486}
[2 / 20] Learning rate: 0.001 weight: 0.01
[2 / 20] Loss: 4.761172973027943 CE Loss: 0.45732716480878605 Con Loss: 4.756599712608104
[2 / 20] tensor([[0.643, 0.548],
        [0.946, 0.958]]) {'epoch': 2, 'valid/acc': 76.371, 'valid/acc_unbiased': 77.578, 'valid/diff': 2.657, 'valid/acc_skew': 76.249, 'valid/acc_align': 78.906, 'test/acc': 76.456, 'test/acc_unbiased': 77.391, 'test/diff': 5.394, 'test/acc_skew': 74.695, 'test/acc_align': 80.088}
[2 / 20] best valid accuracy: 79.111 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 78.65, 'best_valid_valid/acc_unbiased': 79.111, 'best_valid_valid/diff': 2.34, 'best_valid_valid/acc_skew': 77.941, 'best_valid_valid/acc_align': 80.28, 'best_valid_test/acc': 78.861, 'best_valid_test/acc_unbiased': 79.014, 'best_valid_test/diff': 4.944, 'best_valid_test/acc_skew': 76.542, 'best_valid_test/acc_align': 81.486}
[2 / 20] best test accuracy: 79.014 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 78.65, 'best_test_valid/acc_unbiased': 79.111, 'best_test_valid/diff': 2.34, 'best_test_valid/acc_skew': 77.941, 'best_test_valid/acc_align': 80.28, 'best_test_test/acc': 78.861, 'best_test_test/acc_unbiased': 79.014, 'best_test_test/diff': 4.944, 'best_test_test/acc_skew': 76.542, 'best_test_test/acc_align': 81.486}
[3 / 20] Learning rate: 0.001 weight: 0.01
[3 / 20] Loss: 4.733755819787917 CE Loss: 0.42683136091213103 Con Loss: 4.729487514525384
[3 / 20] tensor([[0.828, 0.783],
        [0.846, 0.865]]) {'epoch': 3, 'valid/acc': 82.278, 'valid/acc_unbiased': 82.377, 'valid/diff': 1.072, 'valid/acc_skew': 81.853, 'valid/acc_align': 82.901, 'test/acc': 82.911, 'test/acc_unbiased': 83.048, 'test/diff': 3.178, 'test/acc_skew': 81.459, 'test/acc_align': 84.637}
[3 / 20] best valid accuracy: 82.377 at epoch 3 
 best_stats: {'best_valid_epoch': 3, 'best_valid_valid/acc': 82.278, 'best_valid_valid/acc_unbiased': 82.377, 'best_valid_valid/diff': 1.072, 'best_valid_valid/acc_skew': 81.853, 'best_valid_valid/acc_align': 82.901, 'best_valid_test/acc': 82.911, 'best_valid_test/acc_unbiased': 83.048, 'best_valid_test/diff': 3.178, 'best_valid_test/acc_skew': 81.459, 'best_valid_test/acc_align': 84.637}
[3 / 20] best test accuracy: 83.048 at epoch 3 
 best_stats: {'best_test_epoch': 3, 'best_test_valid/acc': 82.278, 'best_test_valid/acc_unbiased': 82.377, 'best_test_valid/diff': 1.072, 'best_test_valid/acc_skew': 81.853, 'best_test_valid/acc_align': 82.901, 'best_test_test/acc': 82.911, 'best_test_test/acc_unbiased': 83.048, 'best_test_test/diff': 3.178, 'best_test_test/acc_skew': 81.459, 'best_test_test/acc_align': 84.637}
[4 / 20] Learning rate: 0.001 weight: 0.01
[4 / 20] Loss: 4.711835503688941 CE Loss: 0.39982319906349334 Con Loss: 4.707837263989205
[4 / 20] tensor([[0.844, 0.820],
        [0.818, 0.877]]) {'epoch': 4, 'valid/acc': 84.599, 'valid/acc_unbiased': 84.691, 'valid/diff': 1.952, 'valid/acc_skew': 83.715, 'valid/acc_align': 85.667, 'test/acc': 84.135, 'test/acc_unbiased': 83.968, 'test/diff': 4.139, 'test/acc_skew': 81.899, 'test/acc_align': 86.038}
[4 / 20] best valid accuracy: 84.691 at epoch 4 
 best_stats: {'best_valid_epoch': 4, 'best_valid_valid/acc': 84.599, 'best_valid_valid/acc_unbiased': 84.691, 'best_valid_valid/diff': 1.952, 'best_valid_valid/acc_skew': 83.715, 'best_valid_valid/acc_align': 85.667, 'best_valid_test/acc': 84.135, 'best_valid_test/acc_unbiased': 83.968, 'best_valid_test/diff': 4.139, 'best_valid_test/acc_skew': 81.899, 'best_valid_test/acc_align': 86.038}
[4 / 20] best test accuracy: 83.968 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 84.599, 'best_test_valid/acc_unbiased': 84.691, 'best_test_valid/diff': 1.952, 'best_test_valid/acc_skew': 83.715, 'best_test_valid/acc_align': 85.667, 'best_test_test/acc': 84.135, 'best_test_test/acc_unbiased': 83.968, 'best_test_test/diff': 4.139, 'best_test_test/acc_skew': 81.899, 'best_test_test/acc_align': 86.038}
[5 / 20] Learning rate: 0.001 weight: 0.01
[5 / 20] Loss: 4.709540264345833 CE Loss: 0.39427210218436065 Con Loss: 4.705597555131578
[5 / 20] tensor([[0.903, 0.867],
        [0.777, 0.823]]) {'epoch': 5, 'valid/acc': 85.274, 'valid/acc_unbiased': 85.127, 'valid/diff': 1.653, 'valid/acc_skew': 85.874, 'valid/acc_align': 84.38, 'test/acc': 84.557, 'test/acc_unbiased': 84.263, 'test/diff': 4.114, 'test/acc_skew': 82.206, 'test/acc_align': 86.32}
[5 / 20] best valid accuracy: 85.127 at epoch 5 
 best_stats: {'best_valid_epoch': 5, 'best_valid_valid/acc': 85.274, 'best_valid_valid/acc_unbiased': 85.127, 'best_valid_valid/diff': 1.653, 'best_valid_valid/acc_skew': 85.874, 'best_valid_valid/acc_align': 84.38, 'best_valid_test/acc': 84.557, 'best_valid_test/acc_unbiased': 84.263, 'best_valid_test/diff': 4.114, 'best_valid_test/acc_skew': 82.206, 'best_valid_test/acc_align': 86.32}
[5 / 20] best test accuracy: 84.263 at epoch 5 
 best_stats: {'best_test_epoch': 5, 'best_test_valid/acc': 85.274, 'best_test_valid/acc_unbiased': 85.127, 'best_test_valid/diff': 1.653, 'best_test_valid/acc_skew': 85.874, 'best_test_valid/acc_align': 84.38, 'best_test_test/acc': 84.557, 'best_test_test/acc_unbiased': 84.263, 'best_test_test/diff': 4.114, 'best_test_test/acc_skew': 82.206, 'best_test_test/acc_align': 86.32}
[6 / 20] Learning rate: 0.001 weight: 0.01
[6 / 20] Loss: 4.702458513377436 CE Loss: 0.38397436820895875 Con Loss: 4.69861876746751
[6 / 20] tensor([[0.887, 0.840],
        [0.848, 0.845]]) {'epoch': 6, 'valid/acc': 84.979, 'valid/acc_unbiased': 85.086, 'valid/diff': 3.255, 'valid/acc_skew': 85.944, 'valid/acc_align': 84.228, 'test/acc': 85.443, 'test/acc_unbiased': 85.538, 'test/diff': 2.482, 'test/acc_skew': 84.448, 'test/acc_align': 86.628}
[6 / 20] best valid accuracy: 85.127 at epoch 5 
 best_stats: {'best_valid_epoch': 5, 'best_valid_valid/acc': 85.274, 'best_valid_valid/acc_unbiased': 85.127, 'best_valid_valid/diff': 1.653, 'best_valid_valid/acc_skew': 85.874, 'best_valid_valid/acc_align': 84.38, 'best_valid_test/acc': 84.557, 'best_valid_test/acc_unbiased': 84.263, 'best_valid_test/diff': 4.114, 'best_valid_test/acc_skew': 82.206, 'best_valid_test/acc_align': 86.32}
[6 / 20] best test accuracy: 85.538 at epoch 6 
 best_stats: {'best_test_epoch': 6, 'best_test_valid/acc': 84.979, 'best_test_valid/acc_unbiased': 85.086, 'best_test_valid/diff': 3.255, 'best_test_valid/acc_skew': 85.944, 'best_test_valid/acc_align': 84.228, 'best_test_test/acc': 85.443, 'best_test_test/acc_unbiased': 85.538, 'best_test_test/diff': 2.482, 'best_test_test/acc_skew': 84.448, 'best_test_test/acc_align': 86.628}
[7 / 20] Learning rate: 0.0001 weight: 0.01
[7 / 20] Loss: 4.661148388048339 CE Loss: 0.3621490058163513 Con Loss: 4.657526893710234
[7 / 20] tensor([[0.853, 0.826],
        [0.890, 0.884]]) {'epoch': 7, 'valid/acc': 86.329, 'valid/acc_unbiased': 86.563, 'valid/diff': 0.981, 'valid/acc_skew': 86.89, 'valid/acc_align': 86.236, 'test/acc': 86.118, 'test/acc_unbiased': 86.311, 'test/diff': 1.643, 'test/acc_skew': 85.766, 'test/acc_align': 86.857}
[7 / 20] best valid accuracy: 86.563 at epoch 7 
 best_stats: {'best_valid_epoch': 7, 'best_valid_valid/acc': 86.329, 'best_valid_valid/acc_unbiased': 86.563, 'best_valid_valid/diff': 0.981, 'best_valid_valid/acc_skew': 86.89, 'best_valid_valid/acc_align': 86.236, 'best_valid_test/acc': 86.118, 'best_valid_test/acc_unbiased': 86.311, 'best_valid_test/diff': 1.643, 'best_valid_test/acc_skew': 85.766, 'best_valid_test/acc_align': 86.857}
[7 / 20] best test accuracy: 86.311 at epoch 7 
 best_stats: {'best_test_epoch': 7, 'best_test_valid/acc': 86.329, 'best_test_valid/acc_unbiased': 86.563, 'best_test_valid/diff': 0.981, 'best_test_valid/acc_skew': 86.89, 'best_test_valid/acc_align': 86.236, 'best_test_test/acc': 86.118, 'best_test_test/acc_unbiased': 86.311, 'best_test_test/diff': 1.643, 'best_test_test/acc_skew': 85.766, 'best_test_test/acc_align': 86.857}
[8 / 20] Learning rate: 0.0001 weight: 0.01
[8 / 20] Loss: 4.646177436737647 CE Loss: 0.33830286952392646 Con Loss: 4.642794394352813
[8 / 20] tensor([[0.864, 0.829],
        [0.879, 0.889]]) {'epoch': 8, 'valid/acc': 87.257, 'valid/acc_unbiased': 87.392, 'valid/diff': 0.459, 'valid/acc_skew': 87.621, 'valid/acc_align': 87.162, 'test/acc': 86.371, 'test/acc_unbiased': 86.495, 'test/diff': 2.246, 'test/acc_skew': 85.372, 'test/acc_align': 87.618}
[8 / 20] best valid accuracy: 87.392 at epoch 8 
 best_stats: {'best_valid_epoch': 8, 'best_valid_valid/acc': 87.257, 'best_valid_valid/acc_unbiased': 87.392, 'best_valid_valid/diff': 0.459, 'best_valid_valid/acc_skew': 87.621, 'best_valid_valid/acc_align': 87.162, 'best_valid_test/acc': 86.371, 'best_valid_test/acc_unbiased': 86.495, 'best_valid_test/diff': 2.246, 'best_valid_test/acc_skew': 85.372, 'best_valid_test/acc_align': 87.618}
[8 / 20] best test accuracy: 86.495 at epoch 8 
 best_stats: {'best_test_epoch': 8, 'best_test_valid/acc': 87.257, 'best_test_valid/acc_unbiased': 87.392, 'best_test_valid/diff': 0.459, 'best_test_valid/acc_skew': 87.621, 'best_test_valid/acc_align': 87.162, 'best_test_test/acc': 86.371, 'best_test_test/acc_unbiased': 86.495, 'best_test_test/diff': 2.246, 'best_test_test/acc_skew': 85.372, 'best_test_test/acc_align': 87.618}
[9 / 20] Learning rate: 0.0001 weight: 0.01
[9 / 20] Loss: 4.626971500582206 CE Loss: 0.3255731887531635 Con Loss: 4.623715769288413
[9 / 20] tensor([[0.894, 0.866],
        [0.844, 0.872]]) {'epoch': 9, 'valid/acc': 87.637, 'valid/acc_unbiased': 87.638, 'valid/diff': 0.629, 'valid/acc_skew': 87.952, 'valid/acc_align': 87.323, 'test/acc': 87.004, 'test/acc_unbiased': 86.905, 'test/diff': 2.837, 'test/acc_skew': 85.487, 'test/acc_align': 88.324}
[9 / 20] best valid accuracy: 87.638 at epoch 9 
 best_stats: {'best_valid_epoch': 9, 'best_valid_valid/acc': 87.637, 'best_valid_valid/acc_unbiased': 87.638, 'best_valid_valid/diff': 0.629, 'best_valid_valid/acc_skew': 87.952, 'best_valid_valid/acc_align': 87.323, 'best_valid_test/acc': 87.004, 'best_valid_test/acc_unbiased': 86.905, 'best_valid_test/diff': 2.837, 'best_valid_test/acc_skew': 85.487, 'best_valid_test/acc_align': 88.324}
[9 / 20] best test accuracy: 86.905 at epoch 9 
 best_stats: {'best_test_epoch': 9, 'best_test_valid/acc': 87.637, 'best_test_valid/acc_unbiased': 87.638, 'best_test_valid/diff': 0.629, 'best_test_valid/acc_skew': 87.952, 'best_test_valid/acc_align': 87.323, 'best_test_test/acc': 87.004, 'best_test_test/acc_unbiased': 86.905, 'best_test_test/diff': 2.837, 'best_test_test/acc_skew': 85.487, 'best_test_test/acc_align': 88.324}
[10 / 20] Learning rate: 0.0001 weight: 0.01
[10 / 20] Loss: 4.632541970742971 CE Loss: 0.3183429555540005 Con Loss: 4.6293585716145955
[10 / 20] tensor([[0.884, 0.843],
        [0.874, 0.892]]) {'epoch': 10, 'valid/acc': 87.975, 'valid/acc_unbiased': 88.12, 'valid/diff': 1.195, 'valid/acc_skew': 88.717, 'valid/acc_align': 87.522, 'test/acc': 87.257, 'test/acc_unbiased': 87.323, 'test/diff': 2.858, 'test/acc_skew': 85.894, 'test/acc_align': 88.752}
[10 / 20] best valid accuracy: 88.120 at epoch 10 
 best_stats: {'best_valid_epoch': 10, 'best_valid_valid/acc': 87.975, 'best_valid_valid/acc_unbiased': 88.12, 'best_valid_valid/diff': 1.195, 'best_valid_valid/acc_skew': 88.717, 'best_valid_valid/acc_align': 87.522, 'best_valid_test/acc': 87.257, 'best_valid_test/acc_unbiased': 87.323, 'best_valid_test/diff': 2.858, 'best_valid_test/acc_skew': 85.894, 'best_valid_test/acc_align': 88.752}
[10 / 20] best test accuracy: 87.323 at epoch 10 
 best_stats: {'best_test_epoch': 10, 'best_test_valid/acc': 87.975, 'best_test_valid/acc_unbiased': 88.12, 'best_test_valid/diff': 1.195, 'best_test_valid/acc_skew': 88.717, 'best_test_valid/acc_align': 87.522, 'best_test_test/acc': 87.257, 'best_test_test/acc_unbiased': 87.323, 'best_test_test/diff': 2.858, 'best_test_test/acc_skew': 85.894, 'best_test_test/acc_align': 88.752}
[11 / 20] Learning rate: 0.0001 weight: 0.01
[11 / 20] Loss: 4.632107975683038 CE Loss: 0.3142631126976707 Con Loss: 4.6289653693902375
[11 / 20] tensor([[0.848, 0.793],
        [0.900, 0.918]]) {'epoch': 11, 'valid/acc': 87.426, 'valid/acc_unbiased': 87.846, 'valid/diff': 1.449, 'valid/acc_skew': 88.019, 'valid/acc_align': 87.673, 'test/acc': 86.245, 'test/acc_unbiased': 86.49, 'test/diff': 3.615, 'test/acc_skew': 84.682, 'test/acc_align': 88.297}
[11 / 20] best valid accuracy: 88.120 at epoch 10 
 best_stats: {'best_valid_epoch': 10, 'best_valid_valid/acc': 87.975, 'best_valid_valid/acc_unbiased': 88.12, 'best_valid_valid/diff': 1.195, 'best_valid_valid/acc_skew': 88.717, 'best_valid_valid/acc_align': 87.522, 'best_valid_test/acc': 87.257, 'best_valid_test/acc_unbiased': 87.323, 'best_valid_test/diff': 2.858, 'best_valid_test/acc_skew': 85.894, 'best_valid_test/acc_align': 88.752}
[11 / 20] best test accuracy: 87.323 at epoch 10 
 best_stats: {'best_test_epoch': 10, 'best_test_valid/acc': 87.975, 'best_test_valid/acc_unbiased': 88.12, 'best_test_valid/diff': 1.195, 'best_test_valid/acc_skew': 88.717, 'best_test_valid/acc_align': 87.522, 'best_test_test/acc': 87.257, 'best_test_test/acc_unbiased': 87.323, 'best_test_test/diff': 2.858, 'best_test_test/acc_skew': 85.894, 'best_test_test/acc_align': 88.752}
[12 / 20] Learning rate: 0.0001 weight: 0.01
[12 / 20] Loss: 4.612614424171814 CE Loss: 0.3091227450065105 Con Loss: 4.609523186487249
[12 / 20] tensor([[0.891, 0.854],
        [0.846, 0.875]]) {'epoch': 12, 'valid/acc': 88.228, 'valid/acc_unbiased': 88.251, 'valid/diff': 0.875, 'valid/acc_skew': 88.098, 'valid/acc_align': 88.405, 'test/acc': 86.709, 'test/acc_unbiased': 86.649, 'test/diff': 3.289, 'test/acc_skew': 85.004, 'test/acc_align': 88.293}
[12 / 20] best valid accuracy: 88.251 at epoch 12 
 best_stats: {'best_valid_epoch': 12, 'best_valid_valid/acc': 88.228, 'best_valid_valid/acc_unbiased': 88.251, 'best_valid_valid/diff': 0.875, 'best_valid_valid/acc_skew': 88.098, 'best_valid_valid/acc_align': 88.405, 'best_valid_test/acc': 86.709, 'best_valid_test/acc_unbiased': 86.649, 'best_valid_test/diff': 3.289, 'best_valid_test/acc_skew': 85.004, 'best_valid_test/acc_align': 88.293}
[12 / 20] best test accuracy: 87.323 at epoch 10 
 best_stats: {'best_test_epoch': 10, 'best_test_valid/acc': 87.975, 'best_test_valid/acc_unbiased': 88.12, 'best_test_valid/diff': 1.195, 'best_test_valid/acc_skew': 88.717, 'best_test_valid/acc_align': 87.522, 'best_test_test/acc': 87.257, 'best_test_test/acc_unbiased': 87.323, 'best_test_test/diff': 2.858, 'best_test_test/acc_skew': 85.894, 'best_test_test/acc_align': 88.752}
[13 / 20] Learning rate: 0.0001 weight: 0.01
[13 / 20] Loss: 4.621189182850922 CE Loss: 0.30619409590839564 Con Loss: 4.618127251675565
[13 / 20] tensor([[0.851, 0.827],
        [0.905, 0.911]]) {'epoch': 13, 'valid/acc': 88.692, 'valid/acc_unbiased': 89.054, 'valid/diff': 2.463, 'valid/acc_skew': 89.262, 'valid/acc_align': 88.846, 'test/acc': 87.173, 'test/acc_unbiased': 87.351, 'test/diff': 1.508, 'test/acc_skew': 86.597, 'test/acc_align': 88.105}
[13 / 20] best valid accuracy: 89.054 at epoch 13 
 best_stats: {'best_valid_epoch': 13, 'best_valid_valid/acc': 88.692, 'best_valid_valid/acc_unbiased': 89.054, 'best_valid_valid/diff': 2.463, 'best_valid_valid/acc_skew': 89.262, 'best_valid_valid/acc_align': 88.846, 'best_valid_test/acc': 87.173, 'best_valid_test/acc_unbiased': 87.351, 'best_valid_test/diff': 1.508, 'best_valid_test/acc_skew': 86.597, 'best_valid_test/acc_align': 88.105}
[13 / 20] best test accuracy: 87.351 at epoch 13 
 best_stats: {'best_test_epoch': 13, 'best_test_valid/acc': 88.692, 'best_test_valid/acc_unbiased': 89.054, 'best_test_valid/diff': 2.463, 'best_test_valid/acc_skew': 89.262, 'best_test_valid/acc_align': 88.846, 'best_test_test/acc': 87.173, 'best_test_test/acc_unbiased': 87.351, 'best_test_test/diff': 1.508, 'best_test_test/acc_skew': 86.597, 'best_test_test/acc_align': 88.105}
[14 / 20] Learning rate: 1e-05 weight: 0.01
[14 / 20] Loss: 4.619787356623853 CE Loss: 0.3005213937769737 Con Loss: 4.616782143818184
[14 / 20] tensor([[0.851, 0.821],
        [0.905, 0.923]]) {'epoch': 14, 'valid/acc': 88.481, 'valid/acc_unbiased': 88.889, 'valid/diff': 2.545, 'valid/acc_skew': 89.042, 'valid/acc_align': 88.736, 'test/acc': 87.342, 'test/acc_unbiased': 87.501, 'test/diff': 2.398, 'test/acc_skew': 86.302, 'test/acc_align': 88.699}
[14 / 20] best valid accuracy: 89.054 at epoch 13 
 best_stats: {'best_valid_epoch': 13, 'best_valid_valid/acc': 88.692, 'best_valid_valid/acc_unbiased': 89.054, 'best_valid_valid/diff': 2.463, 'best_valid_valid/acc_skew': 89.262, 'best_valid_valid/acc_align': 88.846, 'best_valid_test/acc': 87.173, 'best_valid_test/acc_unbiased': 87.351, 'best_valid_test/diff': 1.508, 'best_valid_test/acc_skew': 86.597, 'best_valid_test/acc_align': 88.105}
[14 / 20] best test accuracy: 87.501 at epoch 14 
 best_stats: {'best_test_epoch': 14, 'best_test_valid/acc': 88.481, 'best_test_valid/acc_unbiased': 88.889, 'best_test_valid/diff': 2.545, 'best_test_valid/acc_skew': 89.042, 'best_test_valid/acc_align': 88.736, 'best_test_test/acc': 87.342, 'best_test_test/acc_unbiased': 87.501, 'best_test_test/diff': 2.398, 'best_test_test/acc_skew': 86.302, 'best_test_test/acc_align': 88.699}
[15 / 20] Learning rate: 1e-05 weight: 0.01
[15 / 20] Loss: 4.605000299209779 CE Loss: 0.2947913447597441 Con Loss: 4.602052395024068
[15 / 20] tensor([[0.869, 0.835],
        [0.885, 0.908]]) {'epoch': 15, 'valid/acc': 88.439, 'valid/acc_unbiased': 88.735, 'valid/diff': 2.006, 'valid/acc_skew': 88.934, 'valid/acc_align': 88.537, 'test/acc': 87.342, 'test/acc_unbiased': 87.422, 'test/diff': 2.86, 'test/acc_skew': 85.992, 'test/acc_align': 88.853}
[15 / 20] best valid accuracy: 89.054 at epoch 13 
 best_stats: {'best_valid_epoch': 13, 'best_valid_valid/acc': 88.692, 'best_valid_valid/acc_unbiased': 89.054, 'best_valid_valid/diff': 2.463, 'best_valid_valid/acc_skew': 89.262, 'best_valid_valid/acc_align': 88.846, 'best_valid_test/acc': 87.173, 'best_valid_test/acc_unbiased': 87.351, 'best_valid_test/diff': 1.508, 'best_valid_test/acc_skew': 86.597, 'best_valid_test/acc_align': 88.105}
[15 / 20] best test accuracy: 87.501 at epoch 14 
 best_stats: {'best_test_epoch': 14, 'best_test_valid/acc': 88.481, 'best_test_valid/acc_unbiased': 88.889, 'best_test_valid/diff': 2.545, 'best_test_valid/acc_skew': 89.042, 'best_test_valid/acc_align': 88.736, 'best_test_test/acc': 87.342, 'best_test_test/acc_unbiased': 87.501, 'best_test_test/diff': 2.398, 'best_test_test/acc_skew': 86.302, 'best_test_test/acc_align': 88.699}
[16 / 20] Learning rate: 1e-05 weight: 0.01
[16 / 20] Loss: 4.595436594884216 CE Loss: 0.2962634936505776 Con Loss: 4.592473967520583
[16 / 20] tensor([[0.867, 0.840],
        [0.883, 0.905]]) {'epoch': 16, 'valid/acc': 88.523, 'valid/acc_unbiased': 88.82, 'valid/diff': 2.055, 'valid/acc_skew': 89.336, 'valid/acc_align': 88.305, 'test/acc': 87.342, 'test/acc_unbiased': 87.397, 'test/diff': 2.435, 'test/acc_skew': 86.179, 'test/acc_align': 88.614}
[16 / 20] best valid accuracy: 89.054 at epoch 13 
 best_stats: {'best_valid_epoch': 13, 'best_valid_valid/acc': 88.692, 'best_valid_valid/acc_unbiased': 89.054, 'best_valid_valid/diff': 2.463, 'best_valid_valid/acc_skew': 89.262, 'best_valid_valid/acc_align': 88.846, 'best_valid_test/acc': 87.173, 'best_valid_test/acc_unbiased': 87.351, 'best_valid_test/diff': 1.508, 'best_valid_test/acc_skew': 86.597, 'best_valid_test/acc_align': 88.105}
[16 / 20] best test accuracy: 87.501 at epoch 14 
 best_stats: {'best_test_epoch': 14, 'best_test_valid/acc': 88.481, 'best_test_valid/acc_unbiased': 88.889, 'best_test_valid/diff': 2.545, 'best_test_valid/acc_skew': 89.042, 'best_test_valid/acc_align': 88.736, 'best_test_test/acc': 87.342, 'best_test_test/acc_unbiased': 87.501, 'best_test_test/diff': 2.398, 'best_test_test/acc_skew': 86.302, 'best_test_test/acc_align': 88.699}
[17 / 20] Learning rate: 1e-05 weight: 0.01
[17 / 20] Loss: 4.5927516958520815 CE Loss: 0.2888051166313652 Con Loss: 4.589863630668709
[17 / 20] tensor([[0.871, 0.838],
        [0.883, 0.906]]) {'epoch': 17, 'valid/acc': 88.608, 'valid/acc_unbiased': 88.873, 'valid/diff': 1.559, 'valid/acc_skew': 89.372, 'valid/acc_align': 88.374, 'test/acc': 87.384, 'test/acc_unbiased': 87.45, 'test/diff': 2.836, 'test/acc_skew': 86.032, 'test/acc_align': 88.868}
[17 / 20] best valid accuracy: 89.054 at epoch 13 
 best_stats: {'best_valid_epoch': 13, 'best_valid_valid/acc': 88.692, 'best_valid_valid/acc_unbiased': 89.054, 'best_valid_valid/diff': 2.463, 'best_valid_valid/acc_skew': 89.262, 'best_valid_valid/acc_align': 88.846, 'best_valid_test/acc': 87.173, 'best_valid_test/acc_unbiased': 87.351, 'best_valid_test/diff': 1.508, 'best_valid_test/acc_skew': 86.597, 'best_valid_test/acc_align': 88.105}
[17 / 20] best test accuracy: 87.501 at epoch 14 
 best_stats: {'best_test_epoch': 14, 'best_test_valid/acc': 88.481, 'best_test_valid/acc_unbiased': 88.889, 'best_test_valid/diff': 2.545, 'best_test_valid/acc_skew': 89.042, 'best_test_valid/acc_align': 88.736, 'best_test_test/acc': 87.342, 'best_test_test/acc_unbiased': 87.501, 'best_test_test/diff': 2.398, 'best_test_test/acc_skew': 86.302, 'best_test_test/acc_align': 88.699}
[18 / 20] Learning rate: 1e-05 weight: 0.01
[18 / 20] Loss: 4.59792848695133 CE Loss: 0.2955571042749305 Con Loss: 4.5949729344689025
[18 / 20] tensor([[0.864, 0.835],
        [0.892, 0.914]]) {'epoch': 18, 'valid/acc': 88.734, 'valid/acc_unbiased': 89.039, 'valid/diff': 1.711, 'valid/acc_skew': 89.481, 'valid/acc_align': 88.597, 'test/acc': 87.511, 'test/acc_unbiased': 87.599, 'test/diff': 2.564, 'test/acc_skew': 86.317, 'test/acc_align': 88.881}
[18 / 20] best valid accuracy: 89.054 at epoch 13 
 best_stats: {'best_valid_epoch': 13, 'best_valid_valid/acc': 88.692, 'best_valid_valid/acc_unbiased': 89.054, 'best_valid_valid/diff': 2.463, 'best_valid_valid/acc_skew': 89.262, 'best_valid_valid/acc_align': 88.846, 'best_valid_test/acc': 87.173, 'best_valid_test/acc_unbiased': 87.351, 'best_valid_test/diff': 1.508, 'best_valid_test/acc_skew': 86.597, 'best_valid_test/acc_align': 88.105}
[18 / 20] best test accuracy: 87.599 at epoch 18 
 best_stats: {'best_test_epoch': 18, 'best_test_valid/acc': 88.734, 'best_test_valid/acc_unbiased': 89.039, 'best_test_valid/diff': 1.711, 'best_test_valid/acc_skew': 89.481, 'best_test_valid/acc_align': 88.597, 'best_test_test/acc': 87.511, 'best_test_test/acc_unbiased': 87.599, 'best_test_test/diff': 2.564, 'best_test_test/acc_skew': 86.317, 'best_test_test/acc_align': 88.881}
[19 / 20] Learning rate: 1e-05 weight: 0.01
[19 / 20] Loss: 4.598037427333384 CE Loss: 0.29149040576104 Con Loss: 4.595122513958602
[19 / 20] tensor([[0.858, 0.821],
        [0.900, 0.917]]) {'epoch': 19, 'valid/acc': 88.439, 'valid/acc_unbiased': 88.813, 'valid/diff': 1.963, 'valid/acc_skew': 89.225, 'valid/acc_align': 88.401, 'test/acc': 87.257, 'test/acc_unbiased': 87.423, 'test/diff': 2.676, 'test/acc_skew': 86.085, 'test/acc_align': 88.761}
[19 / 20] best valid accuracy: 89.054 at epoch 13 
 best_stats: {'best_valid_epoch': 13, 'best_valid_valid/acc': 88.692, 'best_valid_valid/acc_unbiased': 89.054, 'best_valid_valid/diff': 2.463, 'best_valid_valid/acc_skew': 89.262, 'best_valid_valid/acc_align': 88.846, 'best_valid_test/acc': 87.173, 'best_valid_test/acc_unbiased': 87.351, 'best_valid_test/diff': 1.508, 'best_valid_test/acc_skew': 86.597, 'best_valid_test/acc_align': 88.105}
[19 / 20] best test accuracy: 87.599 at epoch 18 
 best_stats: {'best_test_epoch': 18, 'best_test_valid/acc': 88.734, 'best_test_valid/acc_unbiased': 89.039, 'best_test_valid/diff': 1.711, 'best_test_valid/acc_skew': 89.481, 'best_test_valid/acc_align': 88.597, 'best_test_test/acc': 87.511, 'best_test_test/acc_unbiased': 87.599, 'best_test_test/diff': 2.564, 'best_test_test/acc_skew': 86.317, 'best_test_test/acc_align': 88.881}
[20 / 20] Learning rate: 1e-05 weight: 0.01
[20 / 20] Loss: 4.565086621254655 CE Loss: 0.2973498564436178 Con Loss: 4.562113149943607
[20 / 20] tensor([[0.871, 0.838],
        [0.887, 0.909]]) {'epoch': 20, 'valid/acc': 88.608, 'valid/acc_unbiased': 88.93, 'valid/diff': 2.274, 'valid/acc_skew': 89.554, 'valid/acc_align': 88.305, 'test/acc': 87.553, 'test/acc_unbiased': 87.632, 'test/diff': 2.768, 'test/acc_skew': 86.248, 'test/acc_align': 89.016}
[20 / 20] best valid accuracy: 89.054 at epoch 13 
 best_stats: {'best_valid_epoch': 13, 'best_valid_valid/acc': 88.692, 'best_valid_valid/acc_unbiased': 89.054, 'best_valid_valid/diff': 2.463, 'best_valid_valid/acc_skew': 89.262, 'best_valid_valid/acc_align': 88.846, 'best_valid_test/acc': 87.173, 'best_valid_test/acc_unbiased': 87.351, 'best_valid_test/diff': 1.508, 'best_valid_test/acc_skew': 86.597, 'best_valid_test/acc_align': 88.105}
[20 / 20] best test accuracy: 87.632 at epoch 20 
 best_stats: {'best_test_epoch': 20, 'best_test_valid/acc': 88.608, 'best_test_valid/acc_unbiased': 88.93, 'best_test_valid/diff': 2.274, 'best_test_valid/acc_skew': 89.554, 'best_test_valid/acc_align': 88.305, 'best_test_test/acc': 87.553, 'best_test_test/acc_unbiased': 87.632, 'best_test_test/diff': 2.768, 'best_test_test/acc_skew': 86.248, 'best_test_test/acc_align': 89.016}
Total training time: 0:40:11
