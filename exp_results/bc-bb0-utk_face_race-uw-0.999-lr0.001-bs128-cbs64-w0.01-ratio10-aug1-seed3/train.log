Log level set to: INFO
Set seed: 3
=======> Using Fixed Random Seed: 3 <========
save_path: exp_results/bc-bb0-utk_face_race-uw-0.999-lr0.001-bs128-cbs64-w0.01-ratio10-aug1-seed3
get_utk_face - split: train, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_race-0.999
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [4407, 5]
Target 1: [4, 5529]
Binary Target 1
---------------------------
Target 0: [4407, 5]
Target 1: [4, 5529]
===================================
Normal Label Distribution: 
Target 0: [4407, 5]
Target 1: [4, 5529]
===================================
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [4407, 5]
Target 1: [4, 5529]
Binary Target 1
---------------------------
Target 0: [4407, 5]
Target 1: [4, 5529]
===================================
Normal Label Distribution: 
Target 0: [4407, 5]
Target 1: [4, 5529]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 9945, target_attr: gender, bias_attr: race bias_rate: 0.999
['[train] target_0-bias_0: 4407', '[train] target_0-bias_1: 5', '[train] target_1-bias_0: 4', '[train] target_1-bias_1: 5529']
confusion_matrix - 
 original: tensor([[4.407e+03, 4.000e+00],
        [5.000e+00, 5.529e+03]]), 
 normalized: tensor([[9.991e-01, 9.068e-04],
        [9.035e-04, 9.991e-01]]), 
 b|y: tensor([[9.989e-01, 1.133e-03],
        [7.229e-04, 9.993e-01]])
get_utk_face - split: train, aug: 1, given_y: True, ratio: 10
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_race-0.999
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [4407, 5]
Target 1: [4, 5529]
Binary Target 1
---------------------------
Target 0: [4407, 5]
Target 1: [4, 5529]
===================================
Normal Label Distribution: 
Target 0: [4407, 5]
Target 1: [4, 5529]
===================================
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [4407, 5]
Target 1: [4, 5529]
Binary Target 1
---------------------------
Target 0: [4407, 5]
Target 1: [4, 5529]
===================================
Normal Label Distribution: 
Target 0: [4407, 5]
Target 1: [4, 5529]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 9945, target_attr: gender, bias_attr: race bias_rate: 0.999
['[train] target_0-bias_0: 4407', '[train] target_0-bias_1: 5', '[train] target_1-bias_0: 4', '[train] target_1-bias_1: 5529']
get_utk_face - split: valid, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_race-0.999
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [583, 684]
Target 1: [457, 646]
Binary Target 1
---------------------------
Target 0: [583, 684]
Target 1: [457, 646]
===================================
Normal Label Distribution: 
Target 0: [583, 684]
Target 1: [457, 646]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 2370, target_attr: gender, bias_attr: race bias_rate: 0.999
['[valid] target_0-bias_0: 583', '[valid] target_0-bias_1: 684', '[valid] target_1-bias_0: 457', '[valid] target_1-bias_1: 646']
get_utk_face - split: test, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_race-0.999
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [558, 677]
Target 1: [462, 673]
Binary Target 1
---------------------------
Target 0: [558, 677]
Target 1: [462, 673]
===================================
Normal Label Distribution: 
Target 0: [558, 677]
Target 1: [462, 673]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 2370, target_attr: gender, bias_attr: race bias_rate: 0.999
['[test] target_0-bias_0: 558', '[test] target_0-bias_1: 677', '[test] target_1-bias_0: 462', '[test] target_1-bias_1: 673']
decay_epochs: [6, 13]
[1 / 20] Learning rate: 0.001 weight: 0.01
[1 / 20] Loss: 1.516701797626317 CE Loss: 2.9224006849056874 Con Loss: 1.4874777870360423
[1 / 20] tensor([[0., 0.],
        [1., 1.]]) {'epoch': 1, 'valid/acc': 46.54, 'valid/acc_unbiased': 50.0, 'valid/diff': 0.0, 'valid/acc_skew': 50.0, 'valid/acc_align': 50.0, 'test/acc': 47.89, 'test/acc_unbiased': 50.0, 'test/diff': 0.0, 'test/acc_skew': 50.0, 'test/acc_align': 50.0}
[1 / 20] best valid accuracy: 50.000 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 46.54, 'best_valid_valid/acc_unbiased': 50.0, 'best_valid_valid/diff': 0.0, 'best_valid_valid/acc_skew': 50.0, 'best_valid_valid/acc_align': 50.0, 'best_valid_test/acc': 47.89, 'best_valid_test/acc_unbiased': 50.0, 'best_valid_test/diff': 0.0, 'best_valid_test/acc_skew': 50.0, 'best_valid_test/acc_align': 50.0}
[1 / 20] best test accuracy: 50.000 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 46.54, 'best_test_valid/acc_unbiased': 50.0, 'best_test_valid/diff': 0.0, 'best_test_valid/acc_skew': 50.0, 'best_test_valid/acc_align': 50.0, 'best_test_test/acc': 47.89, 'best_test_test/acc_unbiased': 50.0, 'best_test_test/diff': 0.0, 'best_test_test/acc_skew': 50.0, 'best_test_test/acc_align': 50.0}
[2 / 20] Learning rate: 0.001 weight: 0.01
[2 / 20] Loss: 1.2200525079879585 CE Loss: 3.0115307719219624 Con Loss: 1.1899372006853122
[2 / 20] tensor([[1.000, 0.999],
        [0.000, 0.001]]) {'epoch': 2, 'valid/acc': 53.376, 'valid/acc_unbiased': 49.927, 'valid/diff': 0.146, 'valid/acc_skew': 49.854, 'valid/acc_align': 50.0, 'test/acc': 52.11, 'test/acc_unbiased': 50.0, 'test/diff': 0.148, 'test/acc_skew': 49.926, 'test/acc_align': 50.074}
[2 / 20] best valid accuracy: 50.000 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 46.54, 'best_valid_valid/acc_unbiased': 50.0, 'best_valid_valid/diff': 0.0, 'best_valid_valid/acc_skew': 50.0, 'best_valid_valid/acc_align': 50.0, 'best_valid_test/acc': 47.89, 'best_valid_test/acc_unbiased': 50.0, 'best_valid_test/diff': 0.0, 'best_valid_test/acc_skew': 50.0, 'best_valid_test/acc_align': 50.0}
[2 / 20] best test accuracy: 50.000 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 53.376, 'best_test_valid/acc_unbiased': 49.927, 'best_test_valid/diff': 0.146, 'best_test_valid/acc_skew': 49.854, 'best_test_valid/acc_align': 50.0, 'best_test_test/acc': 52.11, 'best_test_test/acc_unbiased': 50.0, 'best_test_test/diff': 0.148, 'best_test_test/acc_skew': 49.926, 'best_test_test/acc_align': 50.074}
[3 / 20] Learning rate: 0.001 weight: 0.01
[3 / 20] Loss: 0.9160459621660992 CE Loss: 3.1476940279093264 Con Loss: 0.8845690160015829
[3 / 20] tensor([[0., 0.],
        [1., 1.]]) {'epoch': 3, 'valid/acc': 46.54, 'valid/acc_unbiased': 50.0, 'valid/diff': 0.0, 'valid/acc_skew': 50.0, 'valid/acc_align': 50.0, 'test/acc': 47.89, 'test/acc_unbiased': 50.0, 'test/diff': 0.0, 'test/acc_skew': 50.0, 'test/acc_align': 50.0}
[3 / 20] best valid accuracy: 50.000 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 46.54, 'best_valid_valid/acc_unbiased': 50.0, 'best_valid_valid/diff': 0.0, 'best_valid_valid/acc_skew': 50.0, 'best_valid_valid/acc_align': 50.0, 'best_valid_test/acc': 47.89, 'best_valid_test/acc_unbiased': 50.0, 'best_valid_test/diff': 0.0, 'best_valid_test/acc_skew': 50.0, 'best_valid_test/acc_align': 50.0}
[3 / 20] best test accuracy: 50.000 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 53.376, 'best_test_valid/acc_unbiased': 49.927, 'best_test_valid/diff': 0.146, 'best_test_valid/acc_skew': 49.854, 'best_test_valid/acc_align': 50.0, 'best_test_test/acc': 52.11, 'best_test_test/acc_unbiased': 50.0, 'best_test_test/diff': 0.148, 'best_test_test/acc_skew': 49.926, 'best_test_test/acc_align': 50.074}
[4 / 20] Learning rate: 0.001 weight: 0.01
[4 / 20] Loss: 1.3578960635138853 CE Loss: 3.4471392391194287 Con Loss: 1.3234246761730533
[4 / 20] tensor([[0.986, 0.972],
        [0.030, 0.039]]) {'epoch': 4, 'valid/acc': 53.966, 'valid/acc_unbiased': 50.594, 'valid/diff': 2.068, 'valid/acc_skew': 49.559, 'valid/acc_align': 51.628, 'test/acc': 52.658, 'test/acc_unbiased': 50.663, 'test/diff': 1.103, 'test/acc_skew': 50.112, 'test/acc_align': 51.215}
[4 / 20] best valid accuracy: 50.594 at epoch 4 
 best_stats: {'best_valid_epoch': 4, 'best_valid_valid/acc': 53.966, 'best_valid_valid/acc_unbiased': 50.594, 'best_valid_valid/diff': 2.068, 'best_valid_valid/acc_skew': 49.559, 'best_valid_valid/acc_align': 51.628, 'best_valid_test/acc': 52.658, 'best_valid_test/acc_unbiased': 50.663, 'best_valid_test/diff': 1.103, 'best_valid_test/acc_skew': 50.112, 'best_valid_test/acc_align': 51.215}
[4 / 20] best test accuracy: 50.663 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 53.966, 'best_test_valid/acc_unbiased': 50.594, 'best_test_valid/diff': 2.068, 'best_test_valid/acc_skew': 49.559, 'best_test_valid/acc_align': 51.628, 'best_test_test/acc': 52.658, 'best_test_test/acc_unbiased': 50.663, 'best_test_test/diff': 1.103, 'best_test_test/acc_skew': 50.112, 'best_test_test/acc_align': 51.215}
[5 / 20] Learning rate: 0.001 weight: 0.01
[5 / 20] Loss: 1.4789099574408389 CE Loss: 3.1061124716169455 Con Loss: 1.4478488298802594
[5 / 20] tensor([[0., 0.],
        [1., 1.]]) {'epoch': 5, 'valid/acc': 46.54, 'valid/acc_unbiased': 50.0, 'valid/diff': 0.0, 'valid/acc_skew': 50.0, 'valid/acc_align': 50.0, 'test/acc': 47.89, 'test/acc_unbiased': 50.0, 'test/diff': 0.0, 'test/acc_skew': 50.0, 'test/acc_align': 50.0}
[5 / 20] best valid accuracy: 50.594 at epoch 4 
 best_stats: {'best_valid_epoch': 4, 'best_valid_valid/acc': 53.966, 'best_valid_valid/acc_unbiased': 50.594, 'best_valid_valid/diff': 2.068, 'best_valid_valid/acc_skew': 49.559, 'best_valid_valid/acc_align': 51.628, 'best_valid_test/acc': 52.658, 'best_valid_test/acc_unbiased': 50.663, 'best_valid_test/diff': 1.103, 'best_valid_test/acc_skew': 50.112, 'best_valid_test/acc_align': 51.215}
[5 / 20] best test accuracy: 50.663 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 53.966, 'best_test_valid/acc_unbiased': 50.594, 'best_test_valid/diff': 2.068, 'best_test_valid/acc_skew': 49.559, 'best_test_valid/acc_align': 51.628, 'best_test_test/acc': 52.658, 'best_test_test/acc_unbiased': 50.663, 'best_test_test/diff': 1.103, 'best_test_test/acc_skew': 50.112, 'best_test_test/acc_align': 51.215}
[6 / 20] Learning rate: 0.001 weight: 0.01
[6 / 20] Loss: 1.614751431807059 CE Loss: 2.9586497910961307 Con Loss: 1.5851649480467769
[6 / 20] tensor([[0.086, 0.117],
        [0.883, 0.895]]) {'epoch': 6, 'valid/acc': 47.046, 'valid/acc_unbiased': 49.811, 'valid/diff': 1.933, 'valid/acc_skew': 50.778, 'valid/acc_align': 48.845, 'test/acc': 47.975, 'test/acc_unbiased': 49.508, 'test/diff': 2.103, 'test/acc_skew': 49.99, 'test/acc_align': 49.026}
[6 / 20] best valid accuracy: 50.594 at epoch 4 
 best_stats: {'best_valid_epoch': 4, 'best_valid_valid/acc': 53.966, 'best_valid_valid/acc_unbiased': 50.594, 'best_valid_valid/diff': 2.068, 'best_valid_valid/acc_skew': 49.559, 'best_valid_valid/acc_align': 51.628, 'best_valid_test/acc': 52.658, 'best_valid_test/acc_unbiased': 50.663, 'best_valid_test/diff': 1.103, 'best_valid_test/acc_skew': 50.112, 'best_valid_test/acc_align': 51.215}
[6 / 20] best test accuracy: 50.663 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 53.966, 'best_test_valid/acc_unbiased': 50.594, 'best_test_valid/diff': 2.068, 'best_test_valid/acc_skew': 49.559, 'best_test_valid/acc_align': 51.628, 'best_test_test/acc': 52.658, 'best_test_test/acc_unbiased': 50.663, 'best_test_test/diff': 1.103, 'best_test_test/acc_skew': 50.112, 'best_test_test/acc_align': 51.215}
[7 / 20] Learning rate: 0.0001 weight: 0.01
[7 / 20] Loss: 0.9615234853811244 CE Loss: 2.799289945863251 Con Loss: 0.9335305867451648
[7 / 20] tensor([[0.041, 0.053],
        [0.933, 0.947]]) {'epoch': 7, 'valid/acc': 46.16, 'valid/acc_unbiased': 49.365, 'valid/diff': 1.645, 'valid/acc_skew': 50.187, 'valid/acc_align': 48.542, 'test/acc': 47.553, 'test/acc_unbiased': 49.345, 'test/diff': 1.278, 'test/acc_skew': 49.304, 'test/acc_align': 49.386}
[7 / 20] best valid accuracy: 50.594 at epoch 4 
 best_stats: {'best_valid_epoch': 4, 'best_valid_valid/acc': 53.966, 'best_valid_valid/acc_unbiased': 50.594, 'best_valid_valid/diff': 2.068, 'best_valid_valid/acc_skew': 49.559, 'best_valid_valid/acc_align': 51.628, 'best_valid_test/acc': 52.658, 'best_valid_test/acc_unbiased': 50.663, 'best_valid_test/diff': 1.103, 'best_valid_test/acc_skew': 50.112, 'best_valid_test/acc_align': 51.215}
[7 / 20] best test accuracy: 50.663 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 53.966, 'best_test_valid/acc_unbiased': 50.594, 'best_test_valid/diff': 2.068, 'best_test_valid/acc_skew': 49.559, 'best_test_valid/acc_align': 51.628, 'best_test_test/acc': 52.658, 'best_test_test/acc_unbiased': 50.663, 'best_test_test/diff': 1.103, 'best_test_test/acc_skew': 50.112, 'best_test_test/acc_align': 51.215}
[8 / 20] Learning rate: 0.0001 weight: 0.01
[8 / 20] Loss: 0.939616001729632 CE Loss: 2.830216038101219 Con Loss: 0.9113138343653767
[8 / 20] tensor([[0.038, 0.068],
        [0.918, 0.944]]) {'epoch': 8, 'valid/acc': 46.118, 'valid/acc_unbiased': 49.221, 'valid/diff': 1.789, 'valid/acc_skew': 50.116, 'valid/acc_align': 48.326, 'test/acc': 47.511, 'test/acc_unbiased': 49.172, 'test/diff': 2.805, 'test/acc_skew': 49.285, 'test/acc_align': 49.059}
[8 / 20] best valid accuracy: 50.594 at epoch 4 
 best_stats: {'best_valid_epoch': 4, 'best_valid_valid/acc': 53.966, 'best_valid_valid/acc_unbiased': 50.594, 'best_valid_valid/diff': 2.068, 'best_valid_valid/acc_skew': 49.559, 'best_valid_valid/acc_align': 51.628, 'best_valid_test/acc': 52.658, 'best_valid_test/acc_unbiased': 50.663, 'best_valid_test/diff': 1.103, 'best_valid_test/acc_skew': 50.112, 'best_valid_test/acc_align': 51.215}
[8 / 20] best test accuracy: 50.663 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 53.966, 'best_test_valid/acc_unbiased': 50.594, 'best_test_valid/diff': 2.068, 'best_test_valid/acc_skew': 49.559, 'best_test_valid/acc_align': 51.628, 'best_test_test/acc': 52.658, 'best_test_test/acc_unbiased': 50.663, 'best_test_test/diff': 1.103, 'best_test_test/acc_skew': 50.112, 'best_test_test/acc_align': 51.215}
[9 / 20] Learning rate: 0.0001 weight: 0.01
[9 / 20] Loss: 1.3379922205444599 CE Loss: 2.811443991850464 Con Loss: 1.309877777483189
[9 / 20] tensor([[0.989, 0.987],
        [0.017, 0.024]]) {'epoch': 9, 'valid/acc': 53.629, 'valid/acc_unbiased': 50.207, 'valid/diff': 1.0, 'valid/acc_skew': 49.707, 'valid/acc_align': 50.707, 'test/acc': 52.489, 'test/acc_unbiased': 50.426, 'test/diff': 0.45, 'test/acc_skew': 50.201, 'test/acc_align': 50.651}
[9 / 20] best valid accuracy: 50.594 at epoch 4 
 best_stats: {'best_valid_epoch': 4, 'best_valid_valid/acc': 53.966, 'best_valid_valid/acc_unbiased': 50.594, 'best_valid_valid/diff': 2.068, 'best_valid_valid/acc_skew': 49.559, 'best_valid_valid/acc_align': 51.628, 'best_valid_test/acc': 52.658, 'best_valid_test/acc_unbiased': 50.663, 'best_valid_test/diff': 1.103, 'best_valid_test/acc_skew': 50.112, 'best_valid_test/acc_align': 51.215}
[9 / 20] best test accuracy: 50.663 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 53.966, 'best_test_valid/acc_unbiased': 50.594, 'best_test_valid/diff': 2.068, 'best_test_valid/acc_skew': 49.559, 'best_test_valid/acc_align': 51.628, 'best_test_test/acc': 52.658, 'best_test_test/acc_unbiased': 50.663, 'best_test_test/diff': 1.103, 'best_test_test/acc_skew': 50.112, 'best_test_test/acc_align': 51.215}
[10 / 20] Learning rate: 0.0001 weight: 0.01
[10 / 20] Loss: 1.3456329108483231 CE Loss: 2.826499976651521 Con Loss: 1.3173679159297722
[10 / 20] tensor([[0.986, 0.985],
        [0.017, 0.025]]) {'epoch': 10, 'valid/acc': 53.586, 'valid/acc_unbiased': 50.17, 'valid/diff': 1.366, 'valid/acc_skew': 49.487, 'valid/acc_align': 50.854, 'test/acc': 52.405, 'test/acc_unbiased': 50.337, 'test/diff': 0.419, 'test/acc_skew': 50.127, 'test/acc_align': 50.546}
[10 / 20] best valid accuracy: 50.594 at epoch 4 
 best_stats: {'best_valid_epoch': 4, 'best_valid_valid/acc': 53.966, 'best_valid_valid/acc_unbiased': 50.594, 'best_valid_valid/diff': 2.068, 'best_valid_valid/acc_skew': 49.559, 'best_valid_valid/acc_align': 51.628, 'best_valid_test/acc': 52.658, 'best_valid_test/acc_unbiased': 50.663, 'best_valid_test/diff': 1.103, 'best_valid_test/acc_skew': 50.112, 'best_valid_test/acc_align': 51.215}
[10 / 20] best test accuracy: 50.663 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 53.966, 'best_test_valid/acc_unbiased': 50.594, 'best_test_valid/diff': 2.068, 'best_test_valid/acc_skew': 49.559, 'best_test_valid/acc_align': 51.628, 'best_test_test/acc': 52.658, 'best_test_test/acc_unbiased': 50.663, 'best_test_test/diff': 1.103, 'best_test_test/acc_skew': 50.112, 'best_test_test/acc_align': 51.215}
[11 / 20] Learning rate: 0.0001 weight: 0.01
[11 / 20] Loss: 1.1575590939663234 CE Loss: 2.8088572389579647 Con Loss: 1.1294705150713569
[11 / 20] tensor([[0.018, 0.034],
        [0.959, 0.966]]) {'epoch': 11, 'valid/acc': 46.245, 'valid/acc_unbiased': 49.526, 'valid/diff': 1.173, 'valid/acc_skew': 50.113, 'valid/acc_align': 48.939, 'test/acc': 47.511, 'test/acc_unbiased': 49.415, 'test/diff': 1.15, 'test/acc_skew': 49.642, 'test/acc_align': 49.187}
[11 / 20] best valid accuracy: 50.594 at epoch 4 
 best_stats: {'best_valid_epoch': 4, 'best_valid_valid/acc': 53.966, 'best_valid_valid/acc_unbiased': 50.594, 'best_valid_valid/diff': 2.068, 'best_valid_valid/acc_skew': 49.559, 'best_valid_valid/acc_align': 51.628, 'best_valid_test/acc': 52.658, 'best_valid_test/acc_unbiased': 50.663, 'best_valid_test/diff': 1.103, 'best_valid_test/acc_skew': 50.112, 'best_valid_test/acc_align': 51.215}
[11 / 20] best test accuracy: 50.663 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 53.966, 'best_test_valid/acc_unbiased': 50.594, 'best_test_valid/diff': 2.068, 'best_test_valid/acc_skew': 49.559, 'best_test_valid/acc_align': 51.628, 'best_test_test/acc': 52.658, 'best_test_test/acc_unbiased': 50.663, 'best_test_test/diff': 1.103, 'best_test_test/acc_skew': 50.112, 'best_test_test/acc_align': 51.215}
[12 / 20] Learning rate: 0.0001 weight: 0.01
[12 / 20] Loss: 1.2364377733331235 CE Loss: 2.801052311618703 Con Loss: 1.2084272473825768
[12 / 20] tensor([[0.407, 0.412],
        [0.617, 0.646]]) {'epoch': 12, 'valid/acc': 50.97, 'valid/acc_unbiased': 52.116, 'valid/diff': 2.366, 'valid/acc_skew': 52.265, 'valid/acc_align': 51.968, 'test/acc': 51.73, 'test/acc_unbiased': 52.054, 'test/diff': 1.739, 'test/acc_skew': 51.45, 'test/acc_align': 52.658}
[12 / 20] best valid accuracy: 52.116 at epoch 12 
 best_stats: {'best_valid_epoch': 12, 'best_valid_valid/acc': 50.97, 'best_valid_valid/acc_unbiased': 52.116, 'best_valid_valid/diff': 2.366, 'best_valid_valid/acc_skew': 52.265, 'best_valid_valid/acc_align': 51.968, 'best_valid_test/acc': 51.73, 'best_valid_test/acc_unbiased': 52.054, 'best_valid_test/diff': 1.739, 'best_valid_test/acc_skew': 51.45, 'best_valid_test/acc_align': 52.658}
[12 / 20] best test accuracy: 52.054 at epoch 12 
 best_stats: {'best_test_epoch': 12, 'best_test_valid/acc': 50.97, 'best_test_valid/acc_unbiased': 52.116, 'best_test_valid/diff': 2.366, 'best_test_valid/acc_skew': 52.265, 'best_test_valid/acc_align': 51.968, 'best_test_test/acc': 51.73, 'best_test_test/acc_unbiased': 52.054, 'best_test_test/diff': 1.739, 'best_test_test/acc_skew': 51.45, 'best_test_test/acc_align': 52.658}
[13 / 20] Learning rate: 0.0001 weight: 0.01
[13 / 20] Loss: 1.4767560853497834 CE Loss: 2.8587973292956343 Con Loss: 1.4481681112190656
[13 / 20] tensor([[0.991, 0.994],
        [0.009, 0.013]]) {'epoch': 13, 'valid/acc': 53.207, 'valid/acc_unbiased': 49.792, 'valid/diff': 0.608, 'valid/acc_skew': 49.488, 'valid/acc_align': 50.096, 'test/acc': 52.278, 'test/acc_unbiased': 50.179, 'test/diff': 0.388, 'test/acc_skew': 50.137, 'test/acc_align': 50.221}
[13 / 20] best valid accuracy: 52.116 at epoch 12 
 best_stats: {'best_valid_epoch': 12, 'best_valid_valid/acc': 50.97, 'best_valid_valid/acc_unbiased': 52.116, 'best_valid_valid/diff': 2.366, 'best_valid_valid/acc_skew': 52.265, 'best_valid_valid/acc_align': 51.968, 'best_valid_test/acc': 51.73, 'best_valid_test/acc_unbiased': 52.054, 'best_valid_test/diff': 1.739, 'best_valid_test/acc_skew': 51.45, 'best_valid_test/acc_align': 52.658}
[13 / 20] best test accuracy: 52.054 at epoch 12 
 best_stats: {'best_test_epoch': 12, 'best_test_valid/acc': 50.97, 'best_test_valid/acc_unbiased': 52.116, 'best_test_valid/diff': 2.366, 'best_test_valid/acc_skew': 52.265, 'best_test_valid/acc_align': 51.968, 'best_test_test/acc': 51.73, 'best_test_test/acc_unbiased': 52.054, 'best_test_test/diff': 1.739, 'best_test_test/acc_skew': 51.45, 'best_test_test/acc_align': 52.658}
[14 / 20] Learning rate: 1e-05 weight: 0.01
[14 / 20] Loss: 0.9971857562626522 CE Loss: 2.7806322527627 Con Loss: 0.9693794292682016
[14 / 20] tensor([[0.987, 0.990],
        [0.015, 0.024]]) {'epoch': 14, 'valid/acc': 53.46, 'valid/acc_unbiased': 50.038, 'valid/diff': 1.028, 'valid/acc_skew': 49.524, 'valid/acc_align': 50.552, 'test/acc': 52.489, 'test/acc_unbiased': 50.401, 'test/diff': 0.541, 'test/acc_skew': 50.241, 'test/acc_align': 50.561}
[14 / 20] best valid accuracy: 52.116 at epoch 12 
 best_stats: {'best_valid_epoch': 12, 'best_valid_valid/acc': 50.97, 'best_valid_valid/acc_unbiased': 52.116, 'best_valid_valid/diff': 2.366, 'best_valid_valid/acc_skew': 52.265, 'best_valid_valid/acc_align': 51.968, 'best_valid_test/acc': 51.73, 'best_valid_test/acc_unbiased': 52.054, 'best_valid_test/diff': 1.739, 'best_valid_test/acc_skew': 51.45, 'best_valid_test/acc_align': 52.658}
[14 / 20] best test accuracy: 52.054 at epoch 12 
 best_stats: {'best_test_epoch': 12, 'best_test_valid/acc': 50.97, 'best_test_valid/acc_unbiased': 52.116, 'best_test_valid/diff': 2.366, 'best_test_valid/acc_skew': 52.265, 'best_test_valid/acc_align': 51.968, 'best_test_test/acc': 51.73, 'best_test_test/acc_unbiased': 52.054, 'best_test_test/diff': 1.739, 'best_test_test/acc_skew': 51.45, 'best_test_test/acc_align': 52.658}
[15 / 20] Learning rate: 1e-05 weight: 0.01
[15 / 20] Loss: 1.2715236101035439 CE Loss: 2.784200862342236 Con Loss: 1.2436816054172046
[15 / 20] tensor([[0.987, 0.993],
        [0.013, 0.019]]) {'epoch': 15, 'valid/acc': 53.207, 'valid/acc_unbiased': 49.788, 'valid/diff': 0.6, 'valid/acc_skew': 49.488, 'valid/acc_align': 50.088, 'test/acc': 52.405, 'test/acc_unbiased': 50.309, 'test/diff': 0.574, 'test/acc_skew': 50.28, 'test/acc_align': 50.339}
[15 / 20] best valid accuracy: 52.116 at epoch 12 
 best_stats: {'best_valid_epoch': 12, 'best_valid_valid/acc': 50.97, 'best_valid_valid/acc_unbiased': 52.116, 'best_valid_valid/diff': 2.366, 'best_valid_valid/acc_skew': 52.265, 'best_valid_valid/acc_align': 51.968, 'best_valid_test/acc': 51.73, 'best_valid_test/acc_unbiased': 52.054, 'best_valid_test/diff': 1.739, 'best_valid_test/acc_skew': 51.45, 'best_valid_test/acc_align': 52.658}
[15 / 20] best test accuracy: 52.054 at epoch 12 
 best_stats: {'best_test_epoch': 12, 'best_test_valid/acc': 50.97, 'best_test_valid/acc_unbiased': 52.116, 'best_test_valid/diff': 2.366, 'best_test_valid/acc_skew': 52.265, 'best_test_valid/acc_align': 51.968, 'best_test_test/acc': 51.73, 'best_test_test/acc_unbiased': 52.054, 'best_test_test/diff': 1.739, 'best_test_test/acc_skew': 51.45, 'best_test_test/acc_align': 52.658}
[16 / 20] Learning rate: 1e-05 weight: 0.01
[16 / 20] Loss: 0.938366368668816 CE Loss: 2.766290404366272 Con Loss: 0.9107034643910649
[16 / 20] tensor([[0.987, 0.993],
        [0.013, 0.019]]) {'epoch': 16, 'valid/acc': 53.291, 'valid/acc_unbiased': 49.865, 'valid/diff': 0.755, 'valid/acc_skew': 49.488, 'valid/acc_align': 50.243, 'test/acc': 52.405, 'test/acc_unbiased': 50.309, 'test/diff': 0.574, 'test/acc_skew': 50.28, 'test/acc_align': 50.339}
[16 / 20] best valid accuracy: 52.116 at epoch 12 
 best_stats: {'best_valid_epoch': 12, 'best_valid_valid/acc': 50.97, 'best_valid_valid/acc_unbiased': 52.116, 'best_valid_valid/diff': 2.366, 'best_valid_valid/acc_skew': 52.265, 'best_valid_valid/acc_align': 51.968, 'best_valid_test/acc': 51.73, 'best_valid_test/acc_unbiased': 52.054, 'best_valid_test/diff': 1.739, 'best_valid_test/acc_skew': 51.45, 'best_valid_test/acc_align': 52.658}
[16 / 20] best test accuracy: 52.054 at epoch 12 
 best_stats: {'best_test_epoch': 12, 'best_test_valid/acc': 50.97, 'best_test_valid/acc_unbiased': 52.116, 'best_test_valid/diff': 2.366, 'best_test_valid/acc_skew': 52.265, 'best_test_valid/acc_align': 51.968, 'best_test_test/acc': 51.73, 'best_test_test/acc_unbiased': 52.054, 'best_test_test/diff': 1.739, 'best_test_test/acc_skew': 51.45, 'best_test_test/acc_align': 52.658}
[17 / 20] Learning rate: 1e-05 weight: 0.01
[17 / 20] Loss: 1.1588873182533448 CE Loss: 2.773116916624849 Con Loss: 1.1311561473234626
[17 / 20] tensor([[0.987, 0.993],
        [0.013, 0.019]]) {'epoch': 17, 'valid/acc': 53.333, 'valid/acc_unbiased': 49.904, 'valid/diff': 0.832, 'valid/acc_skew': 49.488, 'valid/acc_align': 50.32, 'test/acc': 52.405, 'test/acc_unbiased': 50.309, 'test/diff': 0.574, 'test/acc_skew': 50.28, 'test/acc_align': 50.339}
[17 / 20] best valid accuracy: 52.116 at epoch 12 
 best_stats: {'best_valid_epoch': 12, 'best_valid_valid/acc': 50.97, 'best_valid_valid/acc_unbiased': 52.116, 'best_valid_valid/diff': 2.366, 'best_valid_valid/acc_skew': 52.265, 'best_valid_valid/acc_align': 51.968, 'best_valid_test/acc': 51.73, 'best_valid_test/acc_unbiased': 52.054, 'best_valid_test/diff': 1.739, 'best_valid_test/acc_skew': 51.45, 'best_valid_test/acc_align': 52.658}
[17 / 20] best test accuracy: 52.054 at epoch 12 
 best_stats: {'best_test_epoch': 12, 'best_test_valid/acc': 50.97, 'best_test_valid/acc_unbiased': 52.116, 'best_test_valid/diff': 2.366, 'best_test_valid/acc_skew': 52.265, 'best_test_valid/acc_align': 51.968, 'best_test_test/acc': 51.73, 'best_test_test/acc_unbiased': 52.054, 'best_test_test/diff': 1.739, 'best_test_test/acc_skew': 51.45, 'best_test_test/acc_align': 52.658}
[18 / 20] Learning rate: 1e-05 weight: 0.01
[18 / 20] Loss: 1.3678590008575993 CE Loss: 2.7722560745198983 Con Loss: 1.340136439168555
[18 / 20] tensor([[0.987, 0.994],
        [0.013, 0.019]]) {'epoch': 18, 'valid/acc': 53.207, 'valid/acc_unbiased': 49.788, 'valid/diff': 0.6, 'valid/acc_skew': 49.488, 'valid/acc_align': 50.088, 'test/acc': 52.447, 'test/acc_unbiased': 50.346, 'test/diff': 0.648, 'test/acc_skew': 50.354, 'test/acc_align': 50.339}
[18 / 20] best valid accuracy: 52.116 at epoch 12 
 best_stats: {'best_valid_epoch': 12, 'best_valid_valid/acc': 50.97, 'best_valid_valid/acc_unbiased': 52.116, 'best_valid_valid/diff': 2.366, 'best_valid_valid/acc_skew': 52.265, 'best_valid_valid/acc_align': 51.968, 'best_valid_test/acc': 51.73, 'best_valid_test/acc_unbiased': 52.054, 'best_valid_test/diff': 1.739, 'best_valid_test/acc_skew': 51.45, 'best_valid_test/acc_align': 52.658}
[18 / 20] best test accuracy: 52.054 at epoch 12 
 best_stats: {'best_test_epoch': 12, 'best_test_valid/acc': 50.97, 'best_test_valid/acc_unbiased': 52.116, 'best_test_valid/diff': 2.366, 'best_test_valid/acc_skew': 52.265, 'best_test_valid/acc_align': 51.968, 'best_test_test/acc': 51.73, 'best_test_test/acc_unbiased': 52.054, 'best_test_test/diff': 1.739, 'best_test_test/acc_skew': 51.45, 'best_test_test/acc_align': 52.658}
[19 / 20] Learning rate: 1e-05 weight: 0.01
[19 / 20] Loss: 1.1813486957846724 CE Loss: 2.7745860081092983 Con Loss: 1.153602835615416
[19 / 20] tensor([[0.987, 0.990],
        [0.015, 0.024]]) {'epoch': 19, 'valid/acc': 53.376, 'valid/acc_unbiased': 49.943, 'valid/diff': 0.91, 'valid/acc_skew': 49.488, 'valid/acc_align': 50.397, 'test/acc': 52.489, 'test/acc_unbiased': 50.401, 'test/diff': 0.541, 'test/acc_skew': 50.241, 'test/acc_align': 50.561}
[19 / 20] best valid accuracy: 52.116 at epoch 12 
 best_stats: {'best_valid_epoch': 12, 'best_valid_valid/acc': 50.97, 'best_valid_valid/acc_unbiased': 52.116, 'best_valid_valid/diff': 2.366, 'best_valid_valid/acc_skew': 52.265, 'best_valid_valid/acc_align': 51.968, 'best_valid_test/acc': 51.73, 'best_valid_test/acc_unbiased': 52.054, 'best_valid_test/diff': 1.739, 'best_valid_test/acc_skew': 51.45, 'best_valid_test/acc_align': 52.658}
[19 / 20] best test accuracy: 52.054 at epoch 12 
 best_stats: {'best_test_epoch': 12, 'best_test_valid/acc': 50.97, 'best_test_valid/acc_unbiased': 52.116, 'best_test_valid/diff': 2.366, 'best_test_valid/acc_skew': 52.265, 'best_test_valid/acc_align': 51.968, 'best_test_test/acc': 51.73, 'best_test_test/acc_unbiased': 52.054, 'best_test_test/diff': 1.739, 'best_test_test/acc_skew': 51.45, 'best_test_test/acc_align': 52.658}
[20 / 20] Learning rate: 1e-05 weight: 0.01
[20 / 20] Loss: 1.1575807487584608 CE Loss: 2.781216116428615 Con Loss: 1.1297685886879791
[20 / 20] tensor([[0.986, 0.988],
        [0.019, 0.027]]) {'epoch': 20, 'valid/acc': 53.797, 'valid/acc_unbiased': 50.394, 'valid/diff': 1.229, 'valid/acc_skew': 49.779, 'valid/acc_align': 51.008, 'test/acc': 52.574, 'test/acc_unbiased': 50.502, 'test/diff': 0.489, 'test/acc_skew': 50.383, 'test/acc_align': 50.62}
[20 / 20] best valid accuracy: 52.116 at epoch 12 
 best_stats: {'best_valid_epoch': 12, 'best_valid_valid/acc': 50.97, 'best_valid_valid/acc_unbiased': 52.116, 'best_valid_valid/diff': 2.366, 'best_valid_valid/acc_skew': 52.265, 'best_valid_valid/acc_align': 51.968, 'best_valid_test/acc': 51.73, 'best_valid_test/acc_unbiased': 52.054, 'best_valid_test/diff': 1.739, 'best_valid_test/acc_skew': 51.45, 'best_valid_test/acc_align': 52.658}
[20 / 20] best test accuracy: 52.054 at epoch 12 
 best_stats: {'best_test_epoch': 12, 'best_test_valid/acc': 50.97, 'best_test_valid/acc_unbiased': 52.116, 'best_test_valid/diff': 2.366, 'best_test_valid/acc_skew': 52.265, 'best_test_valid/acc_align': 51.968, 'best_test_test/acc': 51.73, 'best_test_test/acc_unbiased': 52.054, 'best_test_test/diff': 1.739, 'best_test_test/acc_skew': 51.45, 'best_test_test/acc_align': 52.658}
Total training time: 1:00:44
