Log level set to: INFO
Set seed: 2
=======> Using Fixed Random Seed: 2 <========
save_path: exp_results/bc-bb0-utk_face_race-cutout_rotate_blur-0.9-lr0.001-bs128-cbs64-w0.01-ratio10-aug1-seed2
get_utk_face - split: train, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_race-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [4407, 552]
Target 1: [440, 5529]
Binary Target 1
---------------------------
Target 0: [4407, 552]
Target 1: [440, 5529]
===================================
Normal Label Distribution: 
Target 0: [4407, 552]
Target 1: [440, 5529]
===================================
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [4407, 552]
Target 1: [440, 5529]
Binary Target 1
---------------------------
Target 0: [4407, 552]
Target 1: [440, 5529]
===================================
Normal Label Distribution: 
Target 0: [4407, 552]
Target 1: [440, 5529]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 10928, target_attr: gender, bias_attr: race bias_rate: 0.9
['[train] target_0-bias_0: 4407', '[train] target_0-bias_1: 552', '[train] target_1-bias_0: 440', '[train] target_1-bias_1: 5529']
confusion_matrix - 
 original: tensor([[4407.,  440.],
        [ 552., 5529.]]), 
 normalized: tensor([[0.909, 0.091],
        [0.091, 0.909]]), 
 b|y: tensor([[0.889, 0.111],
        [0.074, 0.926]])
get_utk_face - split: train, aug: 1, given_y: True, ratio: 10
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_race-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [4407, 552]
Target 1: [440, 5529]
Binary Target 1
---------------------------
Target 0: [4407, 552]
Target 1: [440, 5529]
===================================
Normal Label Distribution: 
Target 0: [4407, 552]
Target 1: [440, 5529]
===================================
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [4407, 552]
Target 1: [440, 5529]
Binary Target 1
---------------------------
Target 0: [4407, 552]
Target 1: [440, 5529]
===================================
Normal Label Distribution: 
Target 0: [4407, 552]
Target 1: [440, 5529]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 10928, target_attr: gender, bias_attr: race bias_rate: 0.9
['[train] target_0-bias_0: 4407', '[train] target_0-bias_1: 552', '[train] target_1-bias_0: 440', '[train] target_1-bias_1: 5529']
get_utk_face - split: valid, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_race-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [583, 684]
Target 1: [457, 646]
Binary Target 1
---------------------------
Target 0: [583, 684]
Target 1: [457, 646]
===================================
Normal Label Distribution: 
Target 0: [583, 684]
Target 1: [457, 646]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 2370, target_attr: gender, bias_attr: race bias_rate: 0.9
['[valid] target_0-bias_0: 583', '[valid] target_0-bias_1: 684', '[valid] target_1-bias_0: 457', '[valid] target_1-bias_1: 646']
get_utk_face - split: test, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_race-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [558, 677]
Target 1: [462, 673]
Binary Target 1
---------------------------
Target 0: [558, 677]
Target 1: [462, 673]
===================================
Normal Label Distribution: 
Target 0: [558, 677]
Target 1: [462, 673]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 2370, target_attr: gender, bias_attr: race bias_rate: 0.9
['[test] target_0-bias_0: 558', '[test] target_0-bias_1: 677', '[test] target_1-bias_0: 462', '[test] target_1-bias_1: 673']
decay_epochs: [6, 13]
[1 / 20] Learning rate: 0.001 weight: 0.01
[1 / 20] Loss: 4.912884743636035 CE Loss: 0.6533659662544117 Con Loss: 4.906351069231159
[1 / 20] tensor([[0.772, 0.719],
        [0.543, 0.658]]) {'epoch': 1, 'valid/acc': 69.114, 'valid/acc_unbiased': 68.241, 'valid/diff': 6.558, 'valid/acc_skew': 64.962, 'valid/acc_align': 71.52, 'test/acc': 68.017, 'test/acc_unbiased': 67.332, 'test/diff': 8.4, 'test/acc_skew': 63.132, 'test/acc_align': 71.532}
[1 / 20] best valid accuracy: 68.241 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 69.114, 'best_valid_valid/acc_unbiased': 68.241, 'best_valid_valid/diff': 6.558, 'best_valid_valid/acc_skew': 64.962, 'best_valid_valid/acc_align': 71.52, 'best_valid_test/acc': 68.017, 'best_valid_test/acc_unbiased': 67.332, 'best_valid_test/diff': 8.4, 'best_valid_test/acc_skew': 63.132, 'best_valid_test/acc_align': 71.532}
[1 / 20] best test accuracy: 67.332 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 69.114, 'best_test_valid/acc_unbiased': 68.241, 'best_test_valid/diff': 6.558, 'best_test_valid/acc_skew': 64.962, 'best_test_valid/acc_align': 71.52, 'best_test_test/acc': 68.017, 'best_test_test/acc_unbiased': 67.332, 'best_test_test/diff': 8.4, 'best_test_test/acc_skew': 63.132, 'best_test_test/acc_align': 71.532}
[2 / 20] Learning rate: 0.001 weight: 0.01
[2 / 20] Loss: 4.832628440019152 CE Loss: 0.5913137612021685 Con Loss: 4.826715278066968
[2 / 20] tensor([[0.747, 0.685],
        [0.639, 0.752]]) {'epoch': 2, 'valid/acc': 72.7, 'valid/acc_unbiased': 72.437, 'valid/diff': 3.283, 'valid/acc_skew': 70.795, 'valid/acc_align': 74.078, 'test/acc': 70.97, 'test/acc_unbiased': 70.577, 'test/diff': 8.763, 'test/acc_skew': 66.195, 'test/acc_align': 74.958}
[2 / 20] best valid accuracy: 72.437 at epoch 2 
 best_stats: {'best_valid_epoch': 2, 'best_valid_valid/acc': 72.7, 'best_valid_valid/acc_unbiased': 72.437, 'best_valid_valid/diff': 3.283, 'best_valid_valid/acc_skew': 70.795, 'best_valid_valid/acc_align': 74.078, 'best_valid_test/acc': 70.97, 'best_valid_test/acc_unbiased': 70.577, 'best_valid_test/diff': 8.763, 'best_valid_test/acc_skew': 66.195, 'best_valid_test/acc_align': 74.958}
[2 / 20] best test accuracy: 70.577 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 72.7, 'best_test_valid/acc_unbiased': 72.437, 'best_test_valid/diff': 3.283, 'best_test_valid/acc_skew': 70.795, 'best_test_valid/acc_align': 74.078, 'best_test_test/acc': 70.97, 'best_test_test/acc_unbiased': 70.577, 'best_test_test/diff': 8.763, 'best_test_test/acc_skew': 66.195, 'best_test_test/acc_align': 74.958}
[3 / 20] Learning rate: 0.001 weight: 0.01
[3 / 20] Loss: 4.824452756264549 CE Loss: 0.5801246589919659 Con Loss: 4.8186514953568595
[3 / 20] tensor([[0.919, 0.857],
        [0.418, 0.562]]) {'epoch': 3, 'valid/acc': 71.139, 'valid/acc_unbiased': 69.134, 'valid/diff': 9.264, 'valid/acc_skew': 64.502, 'valid/acc_align': 73.766, 'test/acc': 70.211, 'test/acc_unbiased': 68.887, 'test/diff': 10.327, 'test/acc_skew': 63.723, 'test/acc_align': 74.051}
[3 / 20] best valid accuracy: 72.437 at epoch 2 
 best_stats: {'best_valid_epoch': 2, 'best_valid_valid/acc': 72.7, 'best_valid_valid/acc_unbiased': 72.437, 'best_valid_valid/diff': 3.283, 'best_valid_valid/acc_skew': 70.795, 'best_valid_valid/acc_align': 74.078, 'best_valid_test/acc': 70.97, 'best_valid_test/acc_unbiased': 70.577, 'best_valid_test/diff': 8.763, 'best_valid_test/acc_skew': 66.195, 'best_valid_test/acc_align': 74.958}
[3 / 20] best test accuracy: 70.577 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 72.7, 'best_test_valid/acc_unbiased': 72.437, 'best_test_valid/diff': 3.283, 'best_test_valid/acc_skew': 70.795, 'best_test_valid/acc_align': 74.078, 'best_test_test/acc': 70.97, 'best_test_test/acc_unbiased': 70.577, 'best_test_test/diff': 8.763, 'best_test_test/acc_skew': 66.195, 'best_test_test/acc_align': 74.958}
[4 / 20] Learning rate: 0.001 weight: 0.01
[4 / 20] Loss: 4.814240385114187 CE Loss: 0.5588870816052746 Con Loss: 4.808651524790908
[4 / 20] tensor([[0.679, 0.583],
        [0.799, 0.857]]) {'epoch': 4, 'valid/acc': 73.544, 'valid/acc_unbiased': 74.258, 'valid/diff': 2.938, 'valid/acc_skew': 72.788, 'valid/acc_align': 75.727, 'test/acc': 72.574, 'test/acc_unbiased': 72.968, 'test/diff': 7.72, 'test/acc_skew': 69.108, 'test/acc_align': 76.828}
[4 / 20] best valid accuracy: 74.258 at epoch 4 
 best_stats: {'best_valid_epoch': 4, 'best_valid_valid/acc': 73.544, 'best_valid_valid/acc_unbiased': 74.258, 'best_valid_valid/diff': 2.938, 'best_valid_valid/acc_skew': 72.788, 'best_valid_valid/acc_align': 75.727, 'best_valid_test/acc': 72.574, 'best_valid_test/acc_unbiased': 72.968, 'best_valid_test/diff': 7.72, 'best_valid_test/acc_skew': 69.108, 'best_valid_test/acc_align': 76.828}
[4 / 20] best test accuracy: 72.968 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 73.544, 'best_test_valid/acc_unbiased': 74.258, 'best_test_valid/diff': 2.938, 'best_test_valid/acc_skew': 72.788, 'best_test_valid/acc_align': 75.727, 'best_test_test/acc': 72.574, 'best_test_test/acc_unbiased': 72.968, 'best_test_test/diff': 7.72, 'best_test_test/acc_skew': 69.108, 'best_test_test/acc_align': 76.828}
[5 / 20] Learning rate: 0.001 weight: 0.01
[5 / 20] Loss: 4.81233227968565 CE Loss: 0.5686916694110519 Con Loss: 4.806645350784369
[5 / 20] tensor([[0.683, 0.588],
        [0.805, 0.850]]) {'epoch': 5, 'valid/acc': 71.477, 'valid/acc_unbiased': 72.351, 'valid/diff': 2.648, 'valid/acc_skew': 71.071, 'valid/acc_align': 73.631, 'test/acc': 72.7, 'test/acc_unbiased': 73.145, 'test/diff': 6.982, 'test/acc_skew': 69.654, 'test/acc_align': 76.636}
[5 / 20] best valid accuracy: 74.258 at epoch 4 
 best_stats: {'best_valid_epoch': 4, 'best_valid_valid/acc': 73.544, 'best_valid_valid/acc_unbiased': 74.258, 'best_valid_valid/diff': 2.938, 'best_valid_valid/acc_skew': 72.788, 'best_valid_valid/acc_align': 75.727, 'best_valid_test/acc': 72.574, 'best_valid_test/acc_unbiased': 72.968, 'best_valid_test/diff': 7.72, 'best_valid_test/acc_skew': 69.108, 'best_valid_test/acc_align': 76.828}
[5 / 20] best test accuracy: 73.145 at epoch 5 
 best_stats: {'best_test_epoch': 5, 'best_test_valid/acc': 71.477, 'best_test_valid/acc_unbiased': 72.351, 'best_test_valid/diff': 2.648, 'best_test_valid/acc_skew': 71.071, 'best_test_valid/acc_align': 73.631, 'best_test_test/acc': 72.7, 'best_test_test/acc_unbiased': 73.145, 'best_test_test/diff': 6.982, 'best_test_test/acc_skew': 69.654, 'best_test_test/acc_align': 76.636}
[6 / 20] Learning rate: 0.001 weight: 0.01
[6 / 20] Loss: 4.807386846528395 CE Loss: 0.5592094521484123 Con Loss: 4.801794774012196
[6 / 20] tensor([[0.656, 0.470],
        [0.853, 0.908]]) {'epoch': 6, 'valid/acc': 70.38, 'valid/acc_unbiased': 71.659, 'valid/diff': 6.959, 'valid/acc_skew': 68.18, 'valid/acc_align': 75.139, 'test/acc': 71.266, 'test/acc_unbiased': 72.158, 'test/diff': 12.063, 'test/acc_skew': 66.127, 'test/acc_align': 78.189}
[6 / 20] best valid accuracy: 74.258 at epoch 4 
 best_stats: {'best_valid_epoch': 4, 'best_valid_valid/acc': 73.544, 'best_valid_valid/acc_unbiased': 74.258, 'best_valid_valid/diff': 2.938, 'best_valid_valid/acc_skew': 72.788, 'best_valid_valid/acc_align': 75.727, 'best_valid_test/acc': 72.574, 'best_valid_test/acc_unbiased': 72.968, 'best_valid_test/diff': 7.72, 'best_valid_test/acc_skew': 69.108, 'best_valid_test/acc_align': 76.828}
[6 / 20] best test accuracy: 73.145 at epoch 5 
 best_stats: {'best_test_epoch': 5, 'best_test_valid/acc': 71.477, 'best_test_valid/acc_unbiased': 72.351, 'best_test_valid/diff': 2.648, 'best_test_valid/acc_skew': 71.071, 'best_test_valid/acc_align': 73.631, 'best_test_test/acc': 72.7, 'best_test_test/acc_unbiased': 73.145, 'best_test_test/diff': 6.982, 'best_test_test/acc_skew': 69.654, 'best_test_test/acc_align': 76.636}
[7 / 20] Learning rate: 0.0001 weight: 0.01
[7 / 20] Loss: 4.7620135791828835 CE Loss: 0.51889504852267 Con Loss: 4.756824645605129
[7 / 20] tensor([[0.740, 0.654],
        [0.790, 0.838]]) {'epoch': 7, 'valid/acc': 76.245, 'valid/acc_unbiased': 76.551, 'valid/diff': 2.547, 'valid/acc_skew': 75.277, 'valid/acc_align': 77.825, 'test/acc': 75.316, 'test/acc_unbiased': 75.565, 'test/diff': 6.689, 'test/acc_skew': 72.22, 'test/acc_align': 78.909}
[7 / 20] best valid accuracy: 76.551 at epoch 7 
 best_stats: {'best_valid_epoch': 7, 'best_valid_valid/acc': 76.245, 'best_valid_valid/acc_unbiased': 76.551, 'best_valid_valid/diff': 2.547, 'best_valid_valid/acc_skew': 75.277, 'best_valid_valid/acc_align': 77.825, 'best_valid_test/acc': 75.316, 'best_valid_test/acc_unbiased': 75.565, 'best_valid_test/diff': 6.689, 'best_valid_test/acc_skew': 72.22, 'best_valid_test/acc_align': 78.909}
[7 / 20] best test accuracy: 75.565 at epoch 7 
 best_stats: {'best_test_epoch': 7, 'best_test_valid/acc': 76.245, 'best_test_valid/acc_unbiased': 76.551, 'best_test_valid/diff': 2.547, 'best_test_valid/acc_skew': 75.277, 'best_test_valid/acc_align': 77.825, 'best_test_test/acc': 75.316, 'best_test_test/acc_unbiased': 75.565, 'best_test_test/diff': 6.689, 'best_test_test/acc_skew': 72.22, 'best_test_test/acc_align': 78.909}
[8 / 20] Learning rate: 0.0001 weight: 0.01
[8 / 20] Loss: 4.752571622588799 CE Loss: 0.5018958541432377 Con Loss: 4.747552679014415
[8 / 20] tensor([[0.747, 0.616],
        [0.814, 0.862]]) {'epoch': 8, 'valid/acc': 76.371, 'valid/acc_unbiased': 76.853, 'valid/diff': 5.056, 'valid/acc_skew': 74.325, 'valid/acc_align': 79.381, 'test/acc': 75.527, 'test/acc_unbiased': 75.973, 'test/diff': 8.966, 'test/acc_skew': 71.49, 'test/acc_align': 80.456}
[8 / 20] best valid accuracy: 76.853 at epoch 8 
 best_stats: {'best_valid_epoch': 8, 'best_valid_valid/acc': 76.371, 'best_valid_valid/acc_unbiased': 76.853, 'best_valid_valid/diff': 5.056, 'best_valid_valid/acc_skew': 74.325, 'best_valid_valid/acc_align': 79.381, 'best_valid_test/acc': 75.527, 'best_valid_test/acc_unbiased': 75.973, 'best_valid_test/diff': 8.966, 'best_valid_test/acc_skew': 71.49, 'best_valid_test/acc_align': 80.456}
[8 / 20] best test accuracy: 75.973 at epoch 8 
 best_stats: {'best_test_epoch': 8, 'best_test_valid/acc': 76.371, 'best_test_valid/acc_unbiased': 76.853, 'best_test_valid/diff': 5.056, 'best_test_valid/acc_skew': 74.325, 'best_test_valid/acc_align': 79.381, 'best_test_test/acc': 75.527, 'best_test_test/acc_unbiased': 75.973, 'best_test_test/diff': 8.966, 'best_test_test/acc_skew': 71.49, 'best_test_test/acc_align': 80.456}
[9 / 20] Learning rate: 0.0001 weight: 0.01
[9 / 20] Loss: 4.724784528528439 CE Loss: 0.49605203940264475 Con Loss: 4.719824003440221
[9 / 20] tensor([[0.806, 0.702],
        [0.749, 0.831]]) {'epoch': 9, 'valid/acc': 77.806, 'valid/acc_unbiased': 77.763, 'valid/diff': 4.524, 'valid/acc_skew': 75.501, 'valid/acc_align': 80.025, 'test/acc': 77.215, 'test/acc_unbiased': 77.19, 'test/diff': 9.326, 'test/acc_skew': 72.527, 'test/acc_align': 81.853}
[9 / 20] best valid accuracy: 77.763 at epoch 9 
 best_stats: {'best_valid_epoch': 9, 'best_valid_valid/acc': 77.806, 'best_valid_valid/acc_unbiased': 77.763, 'best_valid_valid/diff': 4.524, 'best_valid_valid/acc_skew': 75.501, 'best_valid_valid/acc_align': 80.025, 'best_valid_test/acc': 77.215, 'best_valid_test/acc_unbiased': 77.19, 'best_valid_test/diff': 9.326, 'best_valid_test/acc_skew': 72.527, 'best_valid_test/acc_align': 81.853}
[9 / 20] best test accuracy: 77.190 at epoch 9 
 best_stats: {'best_test_epoch': 9, 'best_test_valid/acc': 77.806, 'best_test_valid/acc_unbiased': 77.763, 'best_test_valid/diff': 4.524, 'best_test_valid/acc_skew': 75.501, 'best_test_valid/acc_align': 80.025, 'best_test_test/acc': 77.215, 'best_test_test/acc_unbiased': 77.19, 'best_test_test/diff': 9.326, 'best_test_test/acc_skew': 72.527, 'best_test_test/acc_align': 81.853}
[10 / 20] Learning rate: 0.0001 weight: 0.01
[10 / 20] Loss: 4.717641569335848 CE Loss: 0.4888979307379939 Con Loss: 4.712752596351098
[10 / 20] tensor([[0.797, 0.700],
        [0.758, 0.831]]) {'epoch': 10, 'valid/acc': 78.186, 'valid/acc_unbiased': 78.17, 'valid/diff': 5.192, 'valid/acc_skew': 75.573, 'valid/acc_align': 80.766, 'test/acc': 77.131, 'test/acc_unbiased': 77.146, 'test/diff': 8.519, 'test/acc_skew': 72.886, 'test/acc_align': 81.405}
[10 / 20] best valid accuracy: 78.170 at epoch 10 
 best_stats: {'best_valid_epoch': 10, 'best_valid_valid/acc': 78.186, 'best_valid_valid/acc_unbiased': 78.17, 'best_valid_valid/diff': 5.192, 'best_valid_valid/acc_skew': 75.573, 'best_valid_valid/acc_align': 80.766, 'best_valid_test/acc': 77.131, 'best_valid_test/acc_unbiased': 77.146, 'best_valid_test/diff': 8.519, 'best_valid_test/acc_skew': 72.886, 'best_valid_test/acc_align': 81.405}
[10 / 20] best test accuracy: 77.190 at epoch 9 
 best_stats: {'best_test_epoch': 9, 'best_test_valid/acc': 77.806, 'best_test_valid/acc_unbiased': 77.763, 'best_test_valid/diff': 4.524, 'best_test_valid/acc_skew': 75.501, 'best_test_valid/acc_align': 80.025, 'best_test_test/acc': 77.215, 'best_test_test/acc_unbiased': 77.19, 'best_test_test/diff': 9.326, 'best_test_test/acc_skew': 72.527, 'best_test_test/acc_align': 81.853}
[11 / 20] Learning rate: 0.0001 weight: 0.01
[11 / 20] Loss: 4.716288605685813 CE Loss: 0.48598521629329305 Con Loss: 4.711428746995605
[11 / 20] tensor([[0.830, 0.731],
        [0.732, 0.829]]) {'epoch': 11, 'valid/acc': 78.861, 'valid/acc_unbiased': 78.71, 'valid/diff': 6.562, 'valid/acc_skew': 75.429, 'valid/acc_align': 81.991, 'test/acc': 78.228, 'test/acc_unbiased': 78.041, 'test/diff': 9.805, 'test/acc_skew': 73.138, 'test/acc_align': 82.944}
[11 / 20] best valid accuracy: 78.710 at epoch 11 
 best_stats: {'best_valid_epoch': 11, 'best_valid_valid/acc': 78.861, 'best_valid_valid/acc_unbiased': 78.71, 'best_valid_valid/diff': 6.562, 'best_valid_valid/acc_skew': 75.429, 'best_valid_valid/acc_align': 81.991, 'best_valid_test/acc': 78.228, 'best_valid_test/acc_unbiased': 78.041, 'best_valid_test/diff': 9.805, 'best_valid_test/acc_skew': 73.138, 'best_valid_test/acc_align': 82.944}
[11 / 20] best test accuracy: 78.041 at epoch 11 
 best_stats: {'best_test_epoch': 11, 'best_test_valid/acc': 78.861, 'best_test_valid/acc_unbiased': 78.71, 'best_test_valid/diff': 6.562, 'best_test_valid/acc_skew': 75.429, 'best_test_valid/acc_align': 81.991, 'best_test_test/acc': 78.228, 'best_test_test/acc_unbiased': 78.041, 'best_test_test/diff': 9.805, 'best_test_test/acc_skew': 73.138, 'best_test_test/acc_align': 82.944}
[12 / 20] Learning rate: 0.0001 weight: 0.01
[12 / 20] Loss: 4.7005795608676895 CE Loss: 0.4787049351115527 Con Loss: 4.69579251304727
[12 / 20] tensor([[0.828, 0.713],
        [0.721, 0.834]]) {'epoch': 12, 'valid/acc': 78.523, 'valid/acc_unbiased': 78.47, 'valid/diff': 5.499, 'valid/acc_skew': 75.72, 'valid/acc_align': 81.22, 'test/acc': 77.595, 'test/acc_unbiased': 77.394, 'test/diff': 11.366, 'test/acc_skew': 71.711, 'test/acc_align': 83.077}
[12 / 20] best valid accuracy: 78.710 at epoch 11 
 best_stats: {'best_valid_epoch': 11, 'best_valid_valid/acc': 78.861, 'best_valid_valid/acc_unbiased': 78.71, 'best_valid_valid/diff': 6.562, 'best_valid_valid/acc_skew': 75.429, 'best_valid_valid/acc_align': 81.991, 'best_valid_test/acc': 78.228, 'best_valid_test/acc_unbiased': 78.041, 'best_valid_test/diff': 9.805, 'best_valid_test/acc_skew': 73.138, 'best_valid_test/acc_align': 82.944}
[12 / 20] best test accuracy: 78.041 at epoch 11 
 best_stats: {'best_test_epoch': 11, 'best_test_valid/acc': 78.861, 'best_test_valid/acc_unbiased': 78.71, 'best_test_valid/diff': 6.562, 'best_test_valid/acc_skew': 75.429, 'best_test_valid/acc_align': 81.991, 'best_test_test/acc': 78.228, 'best_test_test/acc_unbiased': 78.041, 'best_test_test/diff': 9.805, 'best_test_test/acc_skew': 73.138, 'best_test_test/acc_align': 82.944}
[13 / 20] Learning rate: 0.0001 weight: 0.01
[13 / 20] Loss: 4.6874642525724575 CE Loss: 0.48333237194735695 Con Loss: 4.682630943868031
[13 / 20] tensor([[0.849, 0.758],
        [0.693, 0.793]]) {'epoch': 13, 'valid/acc': 79.873, 'valid/acc_unbiased': 79.465, 'valid/diff': 3.755, 'valid/acc_skew': 77.588, 'valid/acc_align': 81.343, 'test/acc': 77.679, 'test/acc_unbiased': 77.333, 'test/diff': 9.626, 'test/acc_skew': 72.52, 'test/acc_align': 82.146}
[13 / 20] best valid accuracy: 79.465 at epoch 13 
 best_stats: {'best_valid_epoch': 13, 'best_valid_valid/acc': 79.873, 'best_valid_valid/acc_unbiased': 79.465, 'best_valid_valid/diff': 3.755, 'best_valid_valid/acc_skew': 77.588, 'best_valid_valid/acc_align': 81.343, 'best_valid_test/acc': 77.679, 'best_valid_test/acc_unbiased': 77.333, 'best_valid_test/diff': 9.626, 'best_valid_test/acc_skew': 72.52, 'best_valid_test/acc_align': 82.146}
[13 / 20] best test accuracy: 78.041 at epoch 11 
 best_stats: {'best_test_epoch': 11, 'best_test_valid/acc': 78.861, 'best_test_valid/acc_unbiased': 78.71, 'best_test_valid/diff': 6.562, 'best_test_valid/acc_skew': 75.429, 'best_test_valid/acc_align': 81.991, 'best_test_test/acc': 78.228, 'best_test_test/acc_unbiased': 78.041, 'best_test_test/diff': 9.805, 'best_test_test/acc_skew': 73.138, 'best_test_test/acc_align': 82.944}
[14 / 20] Learning rate: 1e-05 weight: 0.01
[14 / 20] Loss: 4.682370985933139 CE Loss: 0.48614972437108767 Con Loss: 4.6775095103251285
[14 / 20] tensor([[0.801, 0.691],
        [0.749, 0.834]]) {'epoch': 14, 'valid/acc': 78.987, 'valid/acc_unbiased': 79.031, 'valid/diff': 5.238, 'valid/acc_skew': 76.412, 'valid/acc_align': 81.651, 'test/acc': 76.878, 'test/acc_unbiased': 76.871, 'test/diff': 9.723, 'test/acc_skew': 72.01, 'test/acc_align': 81.733}
[14 / 20] best valid accuracy: 79.465 at epoch 13 
 best_stats: {'best_valid_epoch': 13, 'best_valid_valid/acc': 79.873, 'best_valid_valid/acc_unbiased': 79.465, 'best_valid_valid/diff': 3.755, 'best_valid_valid/acc_skew': 77.588, 'best_valid_valid/acc_align': 81.343, 'best_valid_test/acc': 77.679, 'best_valid_test/acc_unbiased': 77.333, 'best_valid_test/diff': 9.626, 'best_valid_test/acc_skew': 72.52, 'best_valid_test/acc_align': 82.146}
[14 / 20] best test accuracy: 78.041 at epoch 11 
 best_stats: {'best_test_epoch': 11, 'best_test_valid/acc': 78.861, 'best_test_valid/acc_unbiased': 78.71, 'best_test_valid/diff': 6.562, 'best_test_valid/acc_skew': 75.429, 'best_test_valid/acc_align': 81.991, 'best_test_test/acc': 78.228, 'best_test_test/acc_unbiased': 78.041, 'best_test_test/diff': 9.805, 'best_test_test/acc_skew': 73.138, 'best_test_test/acc_align': 82.944}
[15 / 20] Learning rate: 1e-05 weight: 0.01
[15 / 20] Loss: 4.670371841022944 CE Loss: 0.47539313414609974 Con Loss: 4.6656178876561265
[15 / 20] tensor([[0.785, 0.679],
        [0.768, 0.848]]) {'epoch': 15, 'valid/acc': 78.734, 'valid/acc_unbiased': 78.847, 'valid/diff': 5.749, 'valid/acc_skew': 75.973, 'valid/acc_align': 81.722, 'test/acc': 76.962, 'test/acc_unbiased': 77.031, 'test/diff': 9.276, 'test/acc_skew': 72.393, 'test/acc_align': 81.669}
[15 / 20] best valid accuracy: 79.465 at epoch 13 
 best_stats: {'best_valid_epoch': 13, 'best_valid_valid/acc': 79.873, 'best_valid_valid/acc_unbiased': 79.465, 'best_valid_valid/diff': 3.755, 'best_valid_valid/acc_skew': 77.588, 'best_valid_valid/acc_align': 81.343, 'best_valid_test/acc': 77.679, 'best_valid_test/acc_unbiased': 77.333, 'best_valid_test/diff': 9.626, 'best_valid_test/acc_skew': 72.52, 'best_valid_test/acc_align': 82.146}
[15 / 20] best test accuracy: 78.041 at epoch 11 
 best_stats: {'best_test_epoch': 11, 'best_test_valid/acc': 78.861, 'best_test_valid/acc_unbiased': 78.71, 'best_test_valid/diff': 6.562, 'best_test_valid/acc_skew': 75.429, 'best_test_valid/acc_align': 81.991, 'best_test_test/acc': 78.228, 'best_test_test/acc_unbiased': 78.041, 'best_test_test/diff': 9.805, 'best_test_test/acc_skew': 73.138, 'best_test_test/acc_align': 82.944}
[16 / 20] Learning rate: 1e-05 weight: 0.01
[16 / 20] Loss: 4.679420692505285 CE Loss: 0.475498263692786 Con Loss: 4.674665677250741
[16 / 20] tensor([[0.799, 0.690],
        [0.758, 0.844]]) {'epoch': 16, 'valid/acc': 79.241, 'valid/acc_unbiased': 79.301, 'valid/diff': 5.267, 'valid/acc_skew': 76.668, 'valid/acc_align': 81.935, 'test/acc': 77.257, 'test/acc_unbiased': 77.266, 'test/diff': 9.794, 'test/acc_skew': 72.369, 'test/acc_align': 82.163}
[16 / 20] best valid accuracy: 79.465 at epoch 13 
 best_stats: {'best_valid_epoch': 13, 'best_valid_valid/acc': 79.873, 'best_valid_valid/acc_unbiased': 79.465, 'best_valid_valid/diff': 3.755, 'best_valid_valid/acc_skew': 77.588, 'best_valid_valid/acc_align': 81.343, 'best_valid_test/acc': 77.679, 'best_valid_test/acc_unbiased': 77.333, 'best_valid_test/diff': 9.626, 'best_valid_test/acc_skew': 72.52, 'best_valid_test/acc_align': 82.146}
[16 / 20] best test accuracy: 78.041 at epoch 11 
 best_stats: {'best_test_epoch': 11, 'best_test_valid/acc': 78.861, 'best_test_valid/acc_unbiased': 78.71, 'best_test_valid/diff': 6.562, 'best_test_valid/acc_skew': 75.429, 'best_test_valid/acc_align': 81.991, 'best_test_test/acc': 78.228, 'best_test_test/acc_unbiased': 78.041, 'best_test_test/diff': 9.805, 'best_test_test/acc_skew': 73.138, 'best_test_test/acc_align': 82.944}
[17 / 20] Learning rate: 1e-05 weight: 0.01
[17 / 20] Loss: 4.668394400818631 CE Loss: 0.47410770033323923 Con Loss: 4.663653312280971
[17 / 20] tensor([[0.799, 0.688],
        [0.762, 0.853]]) {'epoch': 17, 'valid/acc': 78.987, 'valid/acc_unbiased': 79.088, 'valid/diff': 5.645, 'valid/acc_skew': 76.265, 'valid/acc_align': 81.91, 'test/acc': 77.553, 'test/acc_unbiased': 77.56, 'test/diff': 10.097, 'test/acc_skew': 72.512, 'test/acc_align': 82.609}
[17 / 20] best valid accuracy: 79.465 at epoch 13 
 best_stats: {'best_valid_epoch': 13, 'best_valid_valid/acc': 79.873, 'best_valid_valid/acc_unbiased': 79.465, 'best_valid_valid/diff': 3.755, 'best_valid_valid/acc_skew': 77.588, 'best_valid_valid/acc_align': 81.343, 'best_valid_test/acc': 77.679, 'best_valid_test/acc_unbiased': 77.333, 'best_valid_test/diff': 9.626, 'best_valid_test/acc_skew': 72.52, 'best_valid_test/acc_align': 82.146}
[17 / 20] best test accuracy: 78.041 at epoch 11 
 best_stats: {'best_test_epoch': 11, 'best_test_valid/acc': 78.861, 'best_test_valid/acc_unbiased': 78.71, 'best_test_valid/diff': 6.562, 'best_test_valid/acc_skew': 75.429, 'best_test_valid/acc_align': 81.991, 'best_test_test/acc': 78.228, 'best_test_test/acc_unbiased': 78.041, 'best_test_test/diff': 9.805, 'best_test_test/acc_skew': 73.138, 'best_test_test/acc_align': 82.944}
[18 / 20] Learning rate: 1e-05 weight: 0.01
[18 / 20] Loss: 4.660028297765014 CE Loss: 0.46844856683192104 Con Loss: 4.655343793670744
[18 / 20] tensor([[0.806, 0.702],
        [0.742, 0.838]]) {'epoch': 18, 'valid/acc': 79.114, 'valid/acc_unbiased': 79.095, 'valid/diff': 6.02, 'valid/acc_skew': 76.085, 'valid/acc_align': 82.104, 'test/acc': 77.3, 'test/acc_unbiased': 77.213, 'test/diff': 10.022, 'test/acc_skew': 72.202, 'test/acc_align': 82.225}
[18 / 20] best valid accuracy: 79.465 at epoch 13 
 best_stats: {'best_valid_epoch': 13, 'best_valid_valid/acc': 79.873, 'best_valid_valid/acc_unbiased': 79.465, 'best_valid_valid/diff': 3.755, 'best_valid_valid/acc_skew': 77.588, 'best_valid_valid/acc_align': 81.343, 'best_valid_test/acc': 77.679, 'best_valid_test/acc_unbiased': 77.333, 'best_valid_test/diff': 9.626, 'best_valid_test/acc_skew': 72.52, 'best_valid_test/acc_align': 82.146}
[18 / 20] best test accuracy: 78.041 at epoch 11 
 best_stats: {'best_test_epoch': 11, 'best_test_valid/acc': 78.861, 'best_test_valid/acc_unbiased': 78.71, 'best_test_valid/diff': 6.562, 'best_test_valid/acc_skew': 75.429, 'best_test_valid/acc_align': 81.991, 'best_test_test/acc': 78.228, 'best_test_test/acc_unbiased': 78.041, 'best_test_test/diff': 9.805, 'best_test_test/acc_skew': 73.138, 'best_test_test/acc_align': 82.944}
[19 / 20] Learning rate: 1e-05 weight: 0.01
[19 / 20] Loss: 4.676907263598016 CE Loss: 0.4755788720369688 Con Loss: 4.672151461527253
[19 / 20] tensor([[0.796, 0.690],
        [0.753, 0.847]]) {'epoch': 19, 'valid/acc': 79.241, 'valid/acc_unbiased': 79.34, 'valid/diff': 5.566, 'valid/acc_skew': 76.558, 'valid/acc_align': 82.123, 'test/acc': 77.173, 'test/acc_unbiased': 77.143, 'test/diff': 9.98, 'test/acc_skew': 72.153, 'test/acc_align': 82.133}
[19 / 20] best valid accuracy: 79.465 at epoch 13 
 best_stats: {'best_valid_epoch': 13, 'best_valid_valid/acc': 79.873, 'best_valid_valid/acc_unbiased': 79.465, 'best_valid_valid/diff': 3.755, 'best_valid_valid/acc_skew': 77.588, 'best_valid_valid/acc_align': 81.343, 'best_valid_test/acc': 77.679, 'best_valid_test/acc_unbiased': 77.333, 'best_valid_test/diff': 9.626, 'best_valid_test/acc_skew': 72.52, 'best_valid_test/acc_align': 82.146}
[19 / 20] best test accuracy: 78.041 at epoch 11 
 best_stats: {'best_test_epoch': 11, 'best_test_valid/acc': 78.861, 'best_test_valid/acc_unbiased': 78.71, 'best_test_valid/diff': 6.562, 'best_test_valid/acc_skew': 75.429, 'best_test_valid/acc_align': 81.991, 'best_test_test/acc': 78.228, 'best_test_test/acc_unbiased': 78.041, 'best_test_test/diff': 9.805, 'best_test_test/acc_skew': 73.138, 'best_test_test/acc_align': 82.944}
[20 / 20] Learning rate: 1e-05 weight: 0.01
[20 / 20] Loss: 4.671913220278515 CE Loss: 0.47381028061729924 Con Loss: 4.6671751142420845
[20 / 20] tensor([[0.789, 0.675],
        [0.773, 0.856]]) {'epoch': 20, 'valid/acc': 78.692, 'valid/acc_unbiased': 78.868, 'valid/diff': 6.376, 'valid/acc_skew': 75.68, 'valid/acc_align': 82.056, 'test/acc': 77.215, 'test/acc_unbiased': 77.304, 'test/diff': 9.832, 'test/acc_skew': 72.388, 'test/acc_align': 82.22}
[20 / 20] best valid accuracy: 79.465 at epoch 13 
 best_stats: {'best_valid_epoch': 13, 'best_valid_valid/acc': 79.873, 'best_valid_valid/acc_unbiased': 79.465, 'best_valid_valid/diff': 3.755, 'best_valid_valid/acc_skew': 77.588, 'best_valid_valid/acc_align': 81.343, 'best_valid_test/acc': 77.679, 'best_valid_test/acc_unbiased': 77.333, 'best_valid_test/diff': 9.626, 'best_valid_test/acc_skew': 72.52, 'best_valid_test/acc_align': 82.146}
[20 / 20] best test accuracy: 78.041 at epoch 11 
 best_stats: {'best_test_epoch': 11, 'best_test_valid/acc': 78.861, 'best_test_valid/acc_unbiased': 78.71, 'best_test_valid/diff': 6.562, 'best_test_valid/acc_skew': 75.429, 'best_test_valid/acc_align': 81.991, 'best_test_test/acc': 78.228, 'best_test_test/acc_unbiased': 78.041, 'best_test_test/diff': 9.805, 'best_test_test/acc_skew': 73.138, 'best_test_test/acc_align': 82.944}
Total training time: 0:18:17
