Log level set to: INFO
Set seed: 1
=======> Using Fixed Random Seed: 1 <========
save_path: exp_results/bc-bb0-utk_face_age-os-0.95-lr0.001-bs128-cbs64-w0.01-ratio10-aug1-seed1
get_utk_face - split: train, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_age-0.95
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [8237, 73]
Target 1: [411, 1477]
Binary Target 1
---------------------------
Target 0: [8237, 73]
Target 1: [411, 1477]
===================================
Normal Label Distribution: 
Target 0: [8237, 73]
Target 1: [411, 1477]
===================================
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [8237, 8237]
Target 1: [8237, 8237]
Binary Target 1
---------------------------
Target 0: [8237, 8237]
Target 1: [8237, 8237]
===================================
Normal Label Distribution: 
Target 0: [8237, 8237]
Target 1: [8237, 8237]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 32948, target_attr: gender, bias_attr: age bias_rate: 0.95
['[train] target_0-bias_0: 8237', '[train] target_0-bias_1: 8237', '[train] target_1-bias_0: 8237', '[train] target_1-bias_1: 8237']
confusion_matrix - 
 original: tensor([[8237., 8237.],
        [8237., 8237.]]), 
 normalized: tensor([[0.500, 0.500],
        [0.500, 0.500]]), 
 b|y: tensor([[0.500, 0.500],
        [0.500, 0.500]])
get_utk_face - split: train, aug: 1, given_y: True, ratio: 10
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_age-0.95
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [8237, 73]
Target 1: [411, 1477]
Binary Target 1
---------------------------
Target 0: [8237, 73]
Target 1: [411, 1477]
===================================
Normal Label Distribution: 
Target 0: [8237, 73]
Target 1: [411, 1477]
===================================
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [8237, 8237]
Target 1: [8237, 8237]
Binary Target 1
---------------------------
Target 0: [8237, 8237]
Target 1: [8237, 8237]
===================================
Normal Label Distribution: 
Target 0: [8237, 8237]
Target 1: [8237, 8237]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 32948, target_attr: gender, bias_attr: age bias_rate: 0.95
['[train] target_0-bias_0: 8237', '[train] target_0-bias_1: 8237', '[train] target_1-bias_0: 8237', '[train] target_1-bias_1: 8237']
get_utk_face - split: valid, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_age-0.95
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [1030, 195]
Target 1: [841, 202]
Binary Target 1
---------------------------
Target 0: [1030, 195]
Target 1: [841, 202]
===================================
Normal Label Distribution: 
Target 0: [1030, 195]
Target 1: [841, 202]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 2268, target_attr: gender, bias_attr: age bias_rate: 0.95
['[valid] target_0-bias_0: 1030', '[valid] target_0-bias_1: 195', '[valid] target_1-bias_0: 841', '[valid] target_1-bias_1: 202']
get_utk_face - split: test, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_age-0.95
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [1061, 176]
Target 1: [867, 165]
Binary Target 1
---------------------------
Target 0: [1061, 176]
Target 1: [867, 165]
===================================
Normal Label Distribution: 
Target 0: [1061, 176]
Target 1: [867, 165]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 2269, target_attr: gender, bias_attr: age bias_rate: 0.95
['[test] target_0-bias_0: 1061', '[test] target_0-bias_1: 176', '[test] target_1-bias_0: 867', '[test] target_1-bias_1: 165']
decay_epochs: [6, 13]
[1 / 20] Learning rate: 0.001 weight: 0.01
[1 / 20] Loss: 4.811154378275277 CE Loss: 0.5124756773872486 Con Loss: 4.8060296422086095
[1 / 20] tensor([[0.834, 0.472],
        [0.834, 0.812]]) {'epoch': 1, 'valid/acc': 79.674, 'valid/acc_unbiased': 73.035, 'valid/diff': 21.661, 'valid/acc_skew': 82.947, 'valid/acc_align': 63.123, 'test/acc': 80.432, 'test/acc_unbiased': 73.794, 'test/diff': 19.216, 'test/acc_skew': 83.401, 'test/acc_align': 64.186}
[1 / 20] best valid accuracy: 73.035 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 79.674, 'best_valid_valid/acc_unbiased': 73.035, 'best_valid_valid/diff': 21.661, 'best_valid_valid/acc_skew': 82.947, 'best_valid_valid/acc_align': 63.123, 'best_valid_test/acc': 80.432, 'best_valid_test/acc_unbiased': 73.794, 'best_valid_test/diff': 19.216, 'best_valid_test/acc_skew': 83.401, 'best_valid_test/acc_align': 64.186}
[1 / 20] best test accuracy: 73.794 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 79.674, 'best_test_valid/acc_unbiased': 73.035, 'best_test_valid/diff': 21.661, 'best_test_valid/acc_skew': 82.947, 'best_test_valid/acc_align': 63.123, 'best_test_test/acc': 80.432, 'best_test_test/acc_unbiased': 73.794, 'best_test_test/diff': 19.216, 'best_test_test/acc_skew': 83.401, 'best_test_test/acc_align': 64.186}
[2 / 20] Learning rate: 0.001 weight: 0.01
[2 / 20] Loss: 4.69368284293079 CE Loss: 0.3790399040450195 Con Loss: 4.6898924408570295
[2 / 20] tensor([[0.851, 0.324],
        [0.857, 0.915]]) {'epoch': 2, 'valid/acc': 78.66, 'valid/acc_unbiased': 70.838, 'valid/diff': 30.355, 'valid/acc_skew': 82.771, 'valid/acc_align': 58.905, 'test/acc': 81.71, 'test/acc_unbiased': 73.677, 'test/diff': 29.27, 'test/acc_skew': 85.403, 'test/acc_align': 61.951}
[2 / 20] best valid accuracy: 73.035 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 79.674, 'best_valid_valid/acc_unbiased': 73.035, 'best_valid_valid/diff': 21.661, 'best_valid_valid/acc_skew': 82.947, 'best_valid_valid/acc_align': 63.123, 'best_valid_test/acc': 80.432, 'best_valid_test/acc_unbiased': 73.794, 'best_valid_test/diff': 19.216, 'best_valid_test/acc_skew': 83.401, 'best_valid_test/acc_align': 64.186}
[2 / 20] best test accuracy: 73.794 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 79.674, 'best_test_valid/acc_unbiased': 73.035, 'best_test_valid/diff': 21.661, 'best_test_valid/acc_skew': 82.947, 'best_test_valid/acc_align': 63.123, 'best_test_test/acc': 80.432, 'best_test_test/acc_unbiased': 73.794, 'best_test_test/diff': 19.216, 'best_test_test/acc_skew': 83.401, 'best_test_test/acc_align': 64.186}
[3 / 20] Learning rate: 0.001 weight: 0.01
[3 / 20] Loss: 4.62418465025581 CE Loss: 0.3439343056770527 Con Loss: 4.6207453057475645
[3 / 20] tensor([[0.919, 0.511],
        [0.727, 0.842]]) {'epoch': 3, 'valid/acc': 80.908, 'valid/acc_unbiased': 74.548, 'valid/diff': 26.218, 'valid/acc_skew': 83.162, 'valid/acc_align': 65.934, 'test/acc': 80.829, 'test/acc_unbiased': 74.984, 'test/diff': 26.168, 'test/acc_skew': 82.279, 'test/acc_align': 67.689}
[3 / 20] best valid accuracy: 74.548 at epoch 3 
 best_stats: {'best_valid_epoch': 3, 'best_valid_valid/acc': 80.908, 'best_valid_valid/acc_unbiased': 74.548, 'best_valid_valid/diff': 26.218, 'best_valid_valid/acc_skew': 83.162, 'best_valid_valid/acc_align': 65.934, 'best_valid_test/acc': 80.829, 'best_valid_test/acc_unbiased': 74.984, 'best_valid_test/diff': 26.168, 'best_valid_test/acc_skew': 82.279, 'best_valid_test/acc_align': 67.689}
[3 / 20] best test accuracy: 74.984 at epoch 3 
 best_stats: {'best_test_epoch': 3, 'best_test_valid/acc': 80.908, 'best_test_valid/acc_unbiased': 74.548, 'best_test_valid/diff': 26.218, 'best_test_valid/acc_skew': 83.162, 'best_test_valid/acc_align': 65.934, 'best_test_test/acc': 80.829, 'best_test_test/acc_unbiased': 74.984, 'best_test_test/diff': 26.168, 'best_test_test/acc_skew': 82.279, 'best_test_test/acc_align': 67.689}
[4 / 20] Learning rate: 0.001 weight: 0.01
[4 / 20] Loss: 4.5842927719936855 CE Loss: 0.30279178786070815 Con Loss: 4.581264858644131
[4 / 20] tensor([[0.948, 0.381],
        [0.750, 0.842]]) {'epoch': 4, 'valid/acc': 79.541, 'valid/acc_unbiased': 71.417, 'valid/diff': 35.005, 'valid/acc_skew': 82.284, 'valid/acc_align': 60.55, 'test/acc': 82.063, 'test/acc_unbiased': 73.024, 'test/diff': 33.01, 'test/acc_skew': 84.894, 'test/acc_align': 61.155}
[4 / 20] best valid accuracy: 74.548 at epoch 3 
 best_stats: {'best_valid_epoch': 3, 'best_valid_valid/acc': 80.908, 'best_valid_valid/acc_unbiased': 74.548, 'best_valid_valid/diff': 26.218, 'best_valid_valid/acc_skew': 83.162, 'best_valid_valid/acc_align': 65.934, 'best_valid_test/acc': 80.829, 'best_valid_test/acc_unbiased': 74.984, 'best_valid_test/diff': 26.168, 'best_valid_test/acc_skew': 82.279, 'best_valid_test/acc_align': 67.689}
[4 / 20] best test accuracy: 74.984 at epoch 3 
 best_stats: {'best_test_epoch': 3, 'best_test_valid/acc': 80.908, 'best_test_valid/acc_unbiased': 74.548, 'best_test_valid/diff': 26.218, 'best_test_valid/acc_skew': 83.162, 'best_test_valid/acc_align': 65.934, 'best_test_test/acc': 80.829, 'best_test_test/acc_unbiased': 74.984, 'best_test_test/diff': 26.168, 'best_test_test/acc_skew': 82.279, 'best_test_test/acc_align': 67.689}
[5 / 20] Learning rate: 0.001 weight: 0.01
[5 / 20] Loss: 4.544477448238249 CE Loss: 0.274568958538343 Con Loss: 4.541731763438894
[5 / 20] tensor([[0.907, 0.330],
        [0.832, 0.915]]) {'epoch': 5, 'valid/acc': 81.481, 'valid/acc_unbiased': 73.263, 'valid/diff': 36.64, 'valid/acc_skew': 85.12, 'valid/acc_align': 61.406, 'test/acc': 83.385, 'test/acc_unbiased': 74.575, 'test/diff': 33.035, 'test/acc_skew': 86.915, 'test/acc_align': 62.235}
[5 / 20] best valid accuracy: 74.548 at epoch 3 
 best_stats: {'best_valid_epoch': 3, 'best_valid_valid/acc': 80.908, 'best_valid_valid/acc_unbiased': 74.548, 'best_valid_valid/diff': 26.218, 'best_valid_valid/acc_skew': 83.162, 'best_valid_valid/acc_align': 65.934, 'best_valid_test/acc': 80.829, 'best_valid_test/acc_unbiased': 74.984, 'best_valid_test/diff': 26.168, 'best_valid_test/acc_skew': 82.279, 'best_valid_test/acc_align': 67.689}
[5 / 20] best test accuracy: 74.984 at epoch 3 
 best_stats: {'best_test_epoch': 3, 'best_test_valid/acc': 80.908, 'best_test_valid/acc_unbiased': 74.548, 'best_test_valid/diff': 26.218, 'best_test_valid/acc_skew': 83.162, 'best_test_valid/acc_align': 65.934, 'best_test_test/acc': 80.829, 'best_test_test/acc_unbiased': 74.984, 'best_test_test/diff': 26.168, 'best_test_test/acc_skew': 82.279, 'best_test_test/acc_align': 67.689}
[6 / 20] Learning rate: 0.001 weight: 0.01
[6 / 20] Loss: 4.5186998942269705 CE Loss: 0.26173651420304506 Con Loss: 4.516082529276628
[6 / 20] tensor([[0.945, 0.409],
        [0.734, 0.879]]) {'epoch': 6, 'valid/acc': 79.586, 'valid/acc_unbiased': 71.405, 'valid/diff': 39.085, 'valid/acc_skew': 82.332, 'valid/acc_align': 60.479, 'test/acc': 81.798, 'test/acc_unbiased': 74.169, 'test/diff': 34.073, 'test/acc_skew': 83.945, 'test/acc_align': 64.394}
[6 / 20] best valid accuracy: 74.548 at epoch 3 
 best_stats: {'best_valid_epoch': 3, 'best_valid_valid/acc': 80.908, 'best_valid_valid/acc_unbiased': 74.548, 'best_valid_valid/diff': 26.218, 'best_valid_valid/acc_skew': 83.162, 'best_valid_valid/acc_align': 65.934, 'best_valid_test/acc': 80.829, 'best_valid_test/acc_unbiased': 74.984, 'best_valid_test/diff': 26.168, 'best_valid_test/acc_skew': 82.279, 'best_valid_test/acc_align': 67.689}
[6 / 20] best test accuracy: 74.984 at epoch 3 
 best_stats: {'best_test_epoch': 3, 'best_test_valid/acc': 80.908, 'best_test_valid/acc_unbiased': 74.548, 'best_test_valid/diff': 26.218, 'best_test_valid/acc_skew': 83.162, 'best_test_valid/acc_align': 65.934, 'best_test_test/acc': 80.829, 'best_test_test/acc_unbiased': 74.984, 'best_test_test/diff': 26.168, 'best_test_test/acc_skew': 82.279, 'best_test_test/acc_align': 67.689}
[7 / 20] Learning rate: 0.0001 weight: 0.01
[7 / 20] Loss: 4.4347251674656265 CE Loss: 0.2112035147092275 Con Loss: 4.432613130129265
[7 / 20] tensor([[0.919, 0.261],
        [0.843, 0.958]]) {'epoch': 7, 'valid/acc': 82.496, 'valid/acc_unbiased': 73.336, 'valid/diff': 41.513, 'valid/acc_skew': 86.61, 'valid/acc_align': 60.062, 'test/acc': 84.178, 'test/acc_unbiased': 74.526, 'test/diff': 38.601, 'test/acc_skew': 88.104, 'test/acc_align': 60.947}
[7 / 20] best valid accuracy: 74.548 at epoch 3 
 best_stats: {'best_valid_epoch': 3, 'best_valid_valid/acc': 80.908, 'best_valid_valid/acc_unbiased': 74.548, 'best_valid_valid/diff': 26.218, 'best_valid_valid/acc_skew': 83.162, 'best_valid_valid/acc_align': 65.934, 'best_valid_test/acc': 80.829, 'best_valid_test/acc_unbiased': 74.984, 'best_valid_test/diff': 26.168, 'best_valid_test/acc_skew': 82.279, 'best_valid_test/acc_align': 67.689}
[7 / 20] best test accuracy: 74.984 at epoch 3 
 best_stats: {'best_test_epoch': 3, 'best_test_valid/acc': 80.908, 'best_test_valid/acc_unbiased': 74.548, 'best_test_valid/diff': 26.218, 'best_test_valid/acc_skew': 83.162, 'best_test_valid/acc_align': 65.934, 'best_test_test/acc': 80.829, 'best_test_test/acc_unbiased': 74.984, 'best_test_test/diff': 26.168, 'best_test_test/acc_skew': 82.279, 'best_test_test/acc_align': 67.689}
[8 / 20] Learning rate: 0.0001 weight: 0.01
[8 / 20] Loss: 4.395769213564957 CE Loss: 0.1911882786850219 Con Loss: 4.393857329682238
[8 / 20] tensor([[0.932, 0.244],
        [0.839, 0.952]]) {'epoch': 8, 'valid/acc': 82.187, 'valid/acc_unbiased': 72.18, 'valid/diff': 44.098, 'valid/acc_skew': 86.587, 'valid/acc_align': 57.772, 'test/acc': 84.442, 'test/acc_unbiased': 74.162, 'test/diff': 40.041, 'test/acc_skew': 88.533, 'test/acc_align': 59.792}
[8 / 20] best valid accuracy: 74.548 at epoch 3 
 best_stats: {'best_valid_epoch': 3, 'best_valid_valid/acc': 80.908, 'best_valid_valid/acc_unbiased': 74.548, 'best_valid_valid/diff': 26.218, 'best_valid_valid/acc_skew': 83.162, 'best_valid_valid/acc_align': 65.934, 'best_valid_test/acc': 80.829, 'best_valid_test/acc_unbiased': 74.984, 'best_valid_test/diff': 26.168, 'best_valid_test/acc_skew': 82.279, 'best_valid_test/acc_align': 67.689}
[8 / 20] best test accuracy: 74.984 at epoch 3 
 best_stats: {'best_test_epoch': 3, 'best_test_valid/acc': 80.908, 'best_test_valid/acc_unbiased': 74.548, 'best_test_valid/diff': 26.218, 'best_test_valid/acc_skew': 83.162, 'best_test_valid/acc_align': 65.934, 'best_test_test/acc': 80.829, 'best_test_test/acc_unbiased': 74.984, 'best_test_test/diff': 26.168, 'best_test_test/acc_skew': 82.279, 'best_test_test/acc_align': 67.689}
[9 / 20] Learning rate: 0.0001 weight: 0.01
[9 / 20] Loss: 4.3819500567829985 CE Loss: 0.1806057536067988 Con Loss: 4.380144000588885
[9 / 20] tensor([[0.943, 0.273],
        [0.822, 0.952]]) {'epoch': 9, 'valid/acc': 81.834, 'valid/acc_unbiased': 72.906, 'valid/diff': 43.432, 'valid/acc_skew': 85.484, 'valid/acc_align': 60.327, 'test/acc': 84.531, 'test/acc_unbiased': 74.728, 'test/diff': 39.946, 'test/acc_skew': 88.244, 'test/acc_align': 61.212}
[9 / 20] best valid accuracy: 74.548 at epoch 3 
 best_stats: {'best_valid_epoch': 3, 'best_valid_valid/acc': 80.908, 'best_valid_valid/acc_unbiased': 74.548, 'best_valid_valid/diff': 26.218, 'best_valid_valid/acc_skew': 83.162, 'best_valid_valid/acc_align': 65.934, 'best_valid_test/acc': 80.829, 'best_valid_test/acc_unbiased': 74.984, 'best_valid_test/diff': 26.168, 'best_valid_test/acc_skew': 82.279, 'best_valid_test/acc_align': 67.689}
[9 / 20] best test accuracy: 74.984 at epoch 3 
 best_stats: {'best_test_epoch': 3, 'best_test_valid/acc': 80.908, 'best_test_valid/acc_unbiased': 74.548, 'best_test_valid/diff': 26.218, 'best_test_valid/acc_skew': 83.162, 'best_test_valid/acc_align': 65.934, 'best_test_test/acc': 80.829, 'best_test_test/acc_unbiased': 74.984, 'best_test_test/diff': 26.168, 'best_test_test/acc_skew': 82.279, 'best_test_test/acc_align': 67.689}
[10 / 20] Learning rate: 0.0001 weight: 0.01
[10 / 20] Loss: 4.37001967126194 CE Loss: 0.1705282420214843 Con Loss: 4.368314392346411
[10 / 20] tensor([[0.944, 0.278],
        [0.822, 0.958]]) {'epoch': 10, 'valid/acc': 82.804, 'valid/acc_unbiased': 73.889, 'valid/diff': 43.028, 'valid/acc_skew': 86.434, 'valid/acc_align': 61.344, 'test/acc': 84.707, 'test/acc_unbiased': 75.069, 'test/diff': 40.059, 'test/acc_skew': 88.338, 'test/acc_align': 61.799}
[10 / 20] best valid accuracy: 74.548 at epoch 3 
 best_stats: {'best_valid_epoch': 3, 'best_valid_valid/acc': 80.908, 'best_valid_valid/acc_unbiased': 74.548, 'best_valid_valid/diff': 26.218, 'best_valid_valid/acc_skew': 83.162, 'best_valid_valid/acc_align': 65.934, 'best_valid_test/acc': 80.829, 'best_valid_test/acc_unbiased': 74.984, 'best_valid_test/diff': 26.168, 'best_valid_test/acc_skew': 82.279, 'best_valid_test/acc_align': 67.689}
[10 / 20] best test accuracy: 75.069 at epoch 10 
 best_stats: {'best_test_epoch': 10, 'best_test_valid/acc': 82.804, 'best_test_valid/acc_unbiased': 73.889, 'best_test_valid/diff': 43.028, 'best_test_valid/acc_skew': 86.434, 'best_test_valid/acc_align': 61.344, 'best_test_test/acc': 84.707, 'best_test_test/acc_unbiased': 75.069, 'best_test_test/diff': 40.059, 'best_test_test/acc_skew': 88.338, 'best_test_test/acc_align': 61.799}
[11 / 20] Learning rate: 0.0001 weight: 0.01
[11 / 20] Loss: 4.351093755816754 CE Loss: 0.1692021801313382 Con Loss: 4.349401730623902
[11 / 20] tensor([[0.940, 0.227],
        [0.824, 0.964]]) {'epoch': 11, 'valid/acc': 82.451, 'valid/acc_unbiased': 73.356, 'valid/diff': 44.094, 'valid/acc_skew': 86.137, 'valid/acc_align': 60.575, 'test/acc': 84.178, 'test/acc_unbiased': 73.853, 'test/diff': 42.626, 'test/acc_skew': 88.16, 'test/acc_align': 59.545}
[11 / 20] best valid accuracy: 74.548 at epoch 3 
 best_stats: {'best_valid_epoch': 3, 'best_valid_valid/acc': 80.908, 'best_valid_valid/acc_unbiased': 74.548, 'best_valid_valid/diff': 26.218, 'best_valid_valid/acc_skew': 83.162, 'best_valid_valid/acc_align': 65.934, 'best_valid_test/acc': 80.829, 'best_valid_test/acc_unbiased': 74.984, 'best_valid_test/diff': 26.168, 'best_valid_test/acc_skew': 82.279, 'best_valid_test/acc_align': 67.689}
[11 / 20] best test accuracy: 75.069 at epoch 10 
 best_stats: {'best_test_epoch': 10, 'best_test_valid/acc': 82.804, 'best_test_valid/acc_unbiased': 73.889, 'best_test_valid/diff': 43.028, 'best_test_valid/acc_skew': 86.434, 'best_test_valid/acc_align': 61.344, 'best_test_test/acc': 84.707, 'best_test_test/acc_unbiased': 75.069, 'best_test_test/diff': 40.059, 'best_test_test/acc_skew': 88.338, 'best_test_test/acc_align': 61.799}
[12 / 20] Learning rate: 0.0001 weight: 0.01
[12 / 20] Loss: 4.3470160344336755 CE Loss: 0.16691997949035334 Con Loss: 4.3453468115161575
[12 / 20] tensor([[0.936, 0.244],
        [0.837, 0.970]]) {'epoch': 12, 'valid/acc': 82.319, 'valid/acc_unbiased': 72.925, 'valid/diff': 45.276, 'valid/acc_skew': 86.327, 'valid/acc_align': 59.523, 'test/acc': 84.707, 'test/acc_unbiased': 74.682, 'test/diff': 41.196, 'test/acc_skew': 88.664, 'test/acc_align': 60.701}
[12 / 20] best valid accuracy: 74.548 at epoch 3 
 best_stats: {'best_valid_epoch': 3, 'best_valid_valid/acc': 80.908, 'best_valid_valid/acc_unbiased': 74.548, 'best_valid_valid/diff': 26.218, 'best_valid_valid/acc_skew': 83.162, 'best_valid_valid/acc_align': 65.934, 'best_valid_test/acc': 80.829, 'best_valid_test/acc_unbiased': 74.984, 'best_valid_test/diff': 26.168, 'best_valid_test/acc_skew': 82.279, 'best_valid_test/acc_align': 67.689}
[12 / 20] best test accuracy: 75.069 at epoch 10 
 best_stats: {'best_test_epoch': 10, 'best_test_valid/acc': 82.804, 'best_test_valid/acc_unbiased': 73.889, 'best_test_valid/diff': 43.028, 'best_test_valid/acc_skew': 86.434, 'best_test_valid/acc_align': 61.344, 'best_test_test/acc': 84.707, 'best_test_test/acc_unbiased': 75.069, 'best_test_test/diff': 40.059, 'best_test_test/acc_skew': 88.338, 'best_test_test/acc_align': 61.799}
[13 / 20] Learning rate: 0.0001 weight: 0.01
[13 / 20] Loss: 4.341191822541517 CE Loss: 0.15871539525981665 Con Loss: 4.339604656195863
[13 / 20] tensor([[0.936, 0.244],
        [0.842, 0.970]]) {'epoch': 13, 'valid/acc': 82.804, 'valid/acc_unbiased': 73.017, 'valid/diff': 45.772, 'valid/acc_skew': 87.024, 'valid/acc_align': 59.01, 'test/acc': 84.883, 'test/acc_unbiased': 74.798, 'test/diff': 40.965, 'test/acc_skew': 88.895, 'test/acc_align': 60.701}
[13 / 20] best valid accuracy: 74.548 at epoch 3 
 best_stats: {'best_valid_epoch': 3, 'best_valid_valid/acc': 80.908, 'best_valid_valid/acc_unbiased': 74.548, 'best_valid_valid/diff': 26.218, 'best_valid_valid/acc_skew': 83.162, 'best_valid_valid/acc_align': 65.934, 'best_valid_test/acc': 80.829, 'best_valid_test/acc_unbiased': 74.984, 'best_valid_test/diff': 26.168, 'best_valid_test/acc_skew': 82.279, 'best_valid_test/acc_align': 67.689}
[13 / 20] best test accuracy: 75.069 at epoch 10 
 best_stats: {'best_test_epoch': 10, 'best_test_valid/acc': 82.804, 'best_test_valid/acc_unbiased': 73.889, 'best_test_valid/diff': 43.028, 'best_test_valid/acc_skew': 86.434, 'best_test_valid/acc_align': 61.344, 'best_test_test/acc': 84.707, 'best_test_test/acc_unbiased': 75.069, 'best_test_test/diff': 40.059, 'best_test_test/acc_skew': 88.338, 'best_test_test/acc_align': 61.799}
[14 / 20] Learning rate: 1e-05 weight: 0.01
[14 / 20] Loss: 4.327736828444984 CE Loss: 0.15364891859068805 Con Loss: 4.326200325222462
[14 / 20] tensor([[0.940, 0.233],
        [0.826, 0.970]]) {'epoch': 14, 'valid/acc': 82.54, 'valid/acc_unbiased': 72.718, 'valid/diff': 46.758, 'valid/acc_skew': 86.683, 'valid/acc_align': 58.753, 'test/acc': 84.354, 'test/acc_unbiased': 74.204, 'test/diff': 42.529, 'test/acc_skew': 88.276, 'test/acc_align': 60.133}
[14 / 20] best valid accuracy: 74.548 at epoch 3 
 best_stats: {'best_valid_epoch': 3, 'best_valid_valid/acc': 80.908, 'best_valid_valid/acc_unbiased': 74.548, 'best_valid_valid/diff': 26.218, 'best_valid_valid/acc_skew': 83.162, 'best_valid_valid/acc_align': 65.934, 'best_valid_test/acc': 80.829, 'best_valid_test/acc_unbiased': 74.984, 'best_valid_test/diff': 26.168, 'best_valid_test/acc_skew': 82.279, 'best_valid_test/acc_align': 67.689}
[14 / 20] best test accuracy: 75.069 at epoch 10 
 best_stats: {'best_test_epoch': 10, 'best_test_valid/acc': 82.804, 'best_test_valid/acc_unbiased': 73.889, 'best_test_valid/diff': 43.028, 'best_test_valid/acc_skew': 86.434, 'best_test_valid/acc_align': 61.344, 'best_test_test/acc': 84.707, 'best_test_test/acc_unbiased': 75.069, 'best_test_test/diff': 40.059, 'best_test_test/acc_skew': 88.338, 'best_test_test/acc_align': 61.799}
[15 / 20] Learning rate: 1e-05 weight: 0.01
[15 / 20] Loss: 4.3349461884294245 CE Loss: 0.15410245649984222 Con Loss: 4.333405158466776
[15 / 20] tensor([[0.955, 0.284],
        [0.814, 0.958]]) {'epoch': 15, 'valid/acc': 82.099, 'valid/acc_unbiased': 72.779, 'valid/diff': 46.025, 'valid/acc_skew': 85.753, 'valid/acc_align': 59.806, 'test/acc': 84.927, 'test/acc_unbiased': 75.268, 'test/diff': 40.697, 'test/acc_skew': 88.453, 'test/acc_align': 62.083}
[15 / 20] best valid accuracy: 74.548 at epoch 3 
 best_stats: {'best_valid_epoch': 3, 'best_valid_valid/acc': 80.908, 'best_valid_valid/acc_unbiased': 74.548, 'best_valid_valid/diff': 26.218, 'best_valid_valid/acc_skew': 83.162, 'best_valid_valid/acc_align': 65.934, 'best_valid_test/acc': 80.829, 'best_valid_test/acc_unbiased': 74.984, 'best_valid_test/diff': 26.168, 'best_valid_test/acc_skew': 82.279, 'best_valid_test/acc_align': 67.689}
[15 / 20] best test accuracy: 75.268 at epoch 15 
 best_stats: {'best_test_epoch': 15, 'best_test_valid/acc': 82.099, 'best_test_valid/acc_unbiased': 72.779, 'best_test_valid/diff': 46.025, 'best_test_valid/acc_skew': 85.753, 'best_test_valid/acc_align': 59.806, 'best_test_test/acc': 84.927, 'best_test_test/acc_unbiased': 75.268, 'best_test_test/diff': 40.697, 'best_test_test/acc_skew': 88.453, 'best_test_test/acc_align': 62.083}
[16 / 20] Learning rate: 1e-05 weight: 0.01
[16 / 20] Loss: 4.329263082418364 CE Loss: 0.15256869238282894 Con Loss: 4.327737372260484
[16 / 20] tensor([[0.956, 0.284],
        [0.810, 0.952]]) {'epoch': 16, 'valid/acc': 82.187, 'valid/acc_unbiased': 73.233, 'valid/diff': 45.118, 'valid/acc_skew': 85.634, 'valid/acc_align': 60.831, 'test/acc': 84.751, 'test/acc_unbiased': 75.025, 'test/diff': 40.672, 'test/acc_skew': 88.27, 'test/acc_align': 61.78}
[16 / 20] best valid accuracy: 74.548 at epoch 3 
 best_stats: {'best_valid_epoch': 3, 'best_valid_valid/acc': 80.908, 'best_valid_valid/acc_unbiased': 74.548, 'best_valid_valid/diff': 26.218, 'best_valid_valid/acc_skew': 83.162, 'best_valid_valid/acc_align': 65.934, 'best_valid_test/acc': 80.829, 'best_valid_test/acc_unbiased': 74.984, 'best_valid_test/diff': 26.168, 'best_valid_test/acc_skew': 82.279, 'best_valid_test/acc_align': 67.689}
[16 / 20] best test accuracy: 75.268 at epoch 15 
 best_stats: {'best_test_epoch': 15, 'best_test_valid/acc': 82.099, 'best_test_valid/acc_unbiased': 72.779, 'best_test_valid/diff': 46.025, 'best_test_valid/acc_skew': 85.753, 'best_test_valid/acc_align': 59.806, 'best_test_test/acc': 84.927, 'best_test_test/acc_unbiased': 75.268, 'best_test_test/diff': 40.697, 'best_test_test/acc_skew': 88.453, 'best_test_test/acc_align': 62.083}
[17 / 20] Learning rate: 1e-05 weight: 0.01
[17 / 20] Loss: 4.319775951332702 CE Loss: 0.14851340669964477 Con Loss: 4.318290808166971
[17 / 20] tensor([[0.955, 0.250],
        [0.818, 0.964]]) {'epoch': 17, 'valid/acc': 82.319, 'valid/acc_unbiased': 72.837, 'valid/diff': 46.608, 'valid/acc_skew': 86.142, 'valid/acc_align': 59.532, 'test/acc': 84.839, 'test/acc_unbiased': 74.654, 'test/diff': 42.532, 'test/acc_skew': 88.626, 'test/acc_align': 60.682}
[17 / 20] best valid accuracy: 74.548 at epoch 3 
 best_stats: {'best_valid_epoch': 3, 'best_valid_valid/acc': 80.908, 'best_valid_valid/acc_unbiased': 74.548, 'best_valid_valid/diff': 26.218, 'best_valid_valid/acc_skew': 83.162, 'best_valid_valid/acc_align': 65.934, 'best_valid_test/acc': 80.829, 'best_valid_test/acc_unbiased': 74.984, 'best_valid_test/diff': 26.168, 'best_valid_test/acc_skew': 82.279, 'best_valid_test/acc_align': 67.689}
[17 / 20] best test accuracy: 75.268 at epoch 15 
 best_stats: {'best_test_epoch': 15, 'best_test_valid/acc': 82.099, 'best_test_valid/acc_unbiased': 72.779, 'best_test_valid/diff': 46.025, 'best_test_valid/acc_skew': 85.753, 'best_test_valid/acc_align': 59.806, 'best_test_test/acc': 84.927, 'best_test_test/acc_unbiased': 75.268, 'best_test_test/diff': 40.697, 'best_test_test/acc_skew': 88.453, 'best_test_test/acc_align': 62.083}
[18 / 20] Learning rate: 1e-05 weight: 0.01
[18 / 20] Loss: 4.321390124827287 CE Loss: 0.15023574968344294 Con Loss: 4.319887768170115
[18 / 20] tensor([[0.956, 0.284],
        [0.812, 0.958]]) {'epoch': 18, 'valid/acc': 82.319, 'valid/acc_unbiased': 73.228, 'valid/diff': 44.633, 'valid/acc_skew': 85.871, 'valid/acc_align': 60.584, 'test/acc': 84.883, 'test/acc_unbiased': 75.234, 'test/diff': 40.86, 'test/acc_skew': 88.385, 'test/acc_align': 62.083}
[18 / 20] best valid accuracy: 74.548 at epoch 3 
 best_stats: {'best_valid_epoch': 3, 'best_valid_valid/acc': 80.908, 'best_valid_valid/acc_unbiased': 74.548, 'best_valid_valid/diff': 26.218, 'best_valid_valid/acc_skew': 83.162, 'best_valid_valid/acc_align': 65.934, 'best_valid_test/acc': 80.829, 'best_valid_test/acc_unbiased': 74.984, 'best_valid_test/diff': 26.168, 'best_valid_test/acc_skew': 82.279, 'best_valid_test/acc_align': 67.689}
[18 / 20] best test accuracy: 75.268 at epoch 15 
 best_stats: {'best_test_epoch': 15, 'best_test_valid/acc': 82.099, 'best_test_valid/acc_unbiased': 72.779, 'best_test_valid/diff': 46.025, 'best_test_valid/acc_skew': 85.753, 'best_test_valid/acc_align': 59.806, 'best_test_test/acc': 84.927, 'best_test_test/acc_unbiased': 75.268, 'best_test_test/diff': 40.697, 'best_test_test/acc_skew': 88.453, 'best_test_test/acc_align': 62.083}
[19 / 20] Learning rate: 1e-05 weight: 0.01
[19 / 20] Loss: 4.319478650861274 CE Loss: 0.14702104994998014 Con Loss: 4.3180084451969725
[19 / 20] tensor([[0.955, 0.256],
        [0.818, 0.958]]) {'epoch': 19, 'valid/acc': 82.319, 'valid/acc_unbiased': 73.127, 'valid/diff': 46.126, 'valid/acc_skew': 85.953, 'valid/acc_align': 60.301, 'test/acc': 84.839, 'test/acc_unbiased': 74.644, 'test/diff': 41.945, 'test/acc_skew': 88.626, 'test/acc_align': 60.663}
[19 / 20] best valid accuracy: 74.548 at epoch 3 
 best_stats: {'best_valid_epoch': 3, 'best_valid_valid/acc': 80.908, 'best_valid_valid/acc_unbiased': 74.548, 'best_valid_valid/diff': 26.218, 'best_valid_valid/acc_skew': 83.162, 'best_valid_valid/acc_align': 65.934, 'best_valid_test/acc': 80.829, 'best_valid_test/acc_unbiased': 74.984, 'best_valid_test/diff': 26.168, 'best_valid_test/acc_skew': 82.279, 'best_valid_test/acc_align': 67.689}
[19 / 20] best test accuracy: 75.268 at epoch 15 
 best_stats: {'best_test_epoch': 15, 'best_test_valid/acc': 82.099, 'best_test_valid/acc_unbiased': 72.779, 'best_test_valid/diff': 46.025, 'best_test_valid/acc_skew': 85.753, 'best_test_valid/acc_align': 59.806, 'best_test_test/acc': 84.927, 'best_test_test/acc_unbiased': 75.268, 'best_test_test/diff': 40.697, 'best_test_test/acc_skew': 88.453, 'best_test_test/acc_align': 62.083}
[20 / 20] Learning rate: 1e-05 weight: 0.01
[20 / 20] Loss: 4.325064565626846 CE Loss: 0.14722258005057404 Con Loss: 4.323592332955977
[20 / 20] tensor([[0.959, 0.273],
        [0.806, 0.952]]) {'epoch': 20, 'valid/acc': 82.275, 'valid/acc_unbiased': 72.965, 'valid/diff': 46.634, 'valid/acc_skew': 85.876, 'valid/acc_align': 60.053, 'test/acc': 84.663, 'test/acc_unbiased': 74.725, 'test/diff': 41.554, 'test/acc_skew': 88.238, 'test/acc_align': 61.212}
[20 / 20] best valid accuracy: 74.548 at epoch 3 
 best_stats: {'best_valid_epoch': 3, 'best_valid_valid/acc': 80.908, 'best_valid_valid/acc_unbiased': 74.548, 'best_valid_valid/diff': 26.218, 'best_valid_valid/acc_skew': 83.162, 'best_valid_valid/acc_align': 65.934, 'best_valid_test/acc': 80.829, 'best_valid_test/acc_unbiased': 74.984, 'best_valid_test/diff': 26.168, 'best_valid_test/acc_skew': 82.279, 'best_valid_test/acc_align': 67.689}
[20 / 20] best test accuracy: 75.268 at epoch 15 
 best_stats: {'best_test_epoch': 15, 'best_test_valid/acc': 82.099, 'best_test_valid/acc_unbiased': 72.779, 'best_test_valid/diff': 46.025, 'best_test_valid/acc_skew': 85.753, 'best_test_valid/acc_align': 59.806, 'best_test_test/acc': 84.927, 'best_test_test/acc_unbiased': 75.268, 'best_test_test/diff': 40.697, 'best_test_test/acc_skew': 88.453, 'best_test_test/acc_align': 62.083}
Total training time: 1:30:09
