Log level set to: INFO
Set seed: 1
=======> Using Fixed Random Seed: 1 <========
save_path: exp_results/bc-bb0-utk_face_race-cutout_rotate_blur-0.9-lr0.001-bs128-cbs64-w0.01-ratio10-aug1-seed1
get_utk_face - split: train, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_race-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [4407, 552]
Target 1: [440, 5529]
Binary Target 1
---------------------------
Target 0: [4407, 552]
Target 1: [440, 5529]
===================================
Normal Label Distribution: 
Target 0: [4407, 552]
Target 1: [440, 5529]
===================================
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [4407, 552]
Target 1: [440, 5529]
Binary Target 1
---------------------------
Target 0: [4407, 552]
Target 1: [440, 5529]
===================================
Normal Label Distribution: 
Target 0: [4407, 552]
Target 1: [440, 5529]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 10928, target_attr: gender, bias_attr: race bias_rate: 0.9
['[train] target_0-bias_0: 4407', '[train] target_0-bias_1: 552', '[train] target_1-bias_0: 440', '[train] target_1-bias_1: 5529']
confusion_matrix - 
 original: tensor([[4407.,  440.],
        [ 552., 5529.]]), 
 normalized: tensor([[0.909, 0.091],
        [0.091, 0.909]]), 
 b|y: tensor([[0.889, 0.111],
        [0.074, 0.926]])
get_utk_face - split: train, aug: 1, given_y: True, ratio: 10
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_race-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [4407, 552]
Target 1: [440, 5529]
Binary Target 1
---------------------------
Target 0: [4407, 552]
Target 1: [440, 5529]
===================================
Normal Label Distribution: 
Target 0: [4407, 552]
Target 1: [440, 5529]
===================================
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [4407, 552]
Target 1: [440, 5529]
Binary Target 1
---------------------------
Target 0: [4407, 552]
Target 1: [440, 5529]
===================================
Normal Label Distribution: 
Target 0: [4407, 552]
Target 1: [440, 5529]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 10928, target_attr: gender, bias_attr: race bias_rate: 0.9
['[train] target_0-bias_0: 4407', '[train] target_0-bias_1: 552', '[train] target_1-bias_0: 440', '[train] target_1-bias_1: 5529']
get_utk_face - split: valid, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_race-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [583, 684]
Target 1: [457, 646]
Binary Target 1
---------------------------
Target 0: [583, 684]
Target 1: [457, 646]
===================================
Normal Label Distribution: 
Target 0: [583, 684]
Target 1: [457, 646]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 2370, target_attr: gender, bias_attr: race bias_rate: 0.9
['[valid] target_0-bias_0: 583', '[valid] target_0-bias_1: 684', '[valid] target_1-bias_0: 457', '[valid] target_1-bias_1: 646']
get_utk_face - split: test, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_race-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [558, 677]
Target 1: [462, 673]
Binary Target 1
---------------------------
Target 0: [558, 677]
Target 1: [462, 673]
===================================
Normal Label Distribution: 
Target 0: [558, 677]
Target 1: [462, 673]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 2370, target_attr: gender, bias_attr: race bias_rate: 0.9
['[test] target_0-bias_0: 558', '[test] target_0-bias_1: 677', '[test] target_1-bias_0: 462', '[test] target_1-bias_1: 673']
decay_epochs: [6, 13]
[1 / 20] Learning rate: 0.001 weight: 0.01
[1 / 20] Loss: 4.9161483337380005 CE Loss: 0.6447510415603616 Con Loss: 4.909700843286026
[1 / 20] tensor([[0.604, 0.530],
        [0.725, 0.829]]) {'epoch': 1, 'valid/acc': 67.722, 'valid/acc_unbiased': 68.159, 'valid/diff': 4.099, 'valid/acc_skew': 66.109, 'valid/acc_align': 70.208, 'test/acc': 67.046, 'test/acc_unbiased': 67.211, 'test/diff': 8.884, 'test/acc_skew': 62.769, 'test/acc_align': 71.653}
[1 / 20] best valid accuracy: 68.159 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 67.722, 'best_valid_valid/acc_unbiased': 68.159, 'best_valid_valid/diff': 4.099, 'best_valid_valid/acc_skew': 66.109, 'best_valid_valid/acc_align': 70.208, 'best_valid_test/acc': 67.046, 'best_valid_test/acc_unbiased': 67.211, 'best_valid_test/diff': 8.884, 'best_valid_test/acc_skew': 62.769, 'best_valid_test/acc_align': 71.653}
[1 / 20] best test accuracy: 67.211 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 67.722, 'best_test_valid/acc_unbiased': 68.159, 'best_test_valid/diff': 4.099, 'best_test_valid/acc_skew': 66.109, 'best_test_valid/acc_align': 70.208, 'best_test_test/acc': 67.046, 'best_test_test/acc_unbiased': 67.211, 'best_test_test/diff': 8.884, 'best_test_test/acc_skew': 62.769, 'best_test_test/acc_align': 71.653}
[2 / 20] Learning rate: 0.001 weight: 0.01
[2 / 20] Loss: 4.837612455795311 CE Loss: 0.5872969666215022 Con Loss: 4.831739464755637
[2 / 20] tensor([[0.706, 0.629],
        [0.760, 0.816]]) {'epoch': 2, 'valid/acc': 73.122, 'valid/acc_unbiased': 73.199, 'valid/diff': 4.236, 'valid/acc_skew': 71.081, 'valid/acc_align': 75.317, 'test/acc': 72.574, 'test/acc_unbiased': 72.771, 'test/diff': 6.643, 'test/acc_skew': 69.449, 'test/acc_align': 76.092}
[2 / 20] best valid accuracy: 73.199 at epoch 2 
 best_stats: {'best_valid_epoch': 2, 'best_valid_valid/acc': 73.122, 'best_valid_valid/acc_unbiased': 73.199, 'best_valid_valid/diff': 4.236, 'best_valid_valid/acc_skew': 71.081, 'best_valid_valid/acc_align': 75.317, 'best_valid_test/acc': 72.574, 'best_valid_test/acc_unbiased': 72.771, 'best_valid_test/diff': 6.643, 'best_valid_test/acc_skew': 69.449, 'best_valid_test/acc_align': 76.092}
[2 / 20] best test accuracy: 72.771 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 73.122, 'best_test_valid/acc_unbiased': 73.199, 'best_test_valid/diff': 4.236, 'best_test_valid/acc_skew': 71.081, 'best_test_valid/acc_align': 75.317, 'best_test_test/acc': 72.574, 'best_test_test/acc_unbiased': 72.771, 'best_test_test/diff': 6.643, 'best_test_test/acc_skew': 69.449, 'best_test_test/acc_align': 76.092}
[3 / 20] Learning rate: 0.001 weight: 0.01
[3 / 20] Loss: 4.825837122050071 CE Loss: 0.564224531325903 Con Loss: 4.820194865739189
[3 / 20] tensor([[0.668, 0.617],
        [0.764, 0.831]]) {'epoch': 3, 'valid/acc': 74.599, 'valid/acc_unbiased': 74.779, 'valid/diff': 3.602, 'valid/acc_skew': 72.978, 'valid/acc_align': 76.58, 'test/acc': 71.857, 'test/acc_unbiased': 72.014, 'test/diff': 5.878, 'test/acc_skew': 69.075, 'test/acc_align': 74.953}
[3 / 20] best valid accuracy: 74.779 at epoch 3 
 best_stats: {'best_valid_epoch': 3, 'best_valid_valid/acc': 74.599, 'best_valid_valid/acc_unbiased': 74.779, 'best_valid_valid/diff': 3.602, 'best_valid_valid/acc_skew': 72.978, 'best_valid_valid/acc_align': 76.58, 'best_valid_test/acc': 71.857, 'best_valid_test/acc_unbiased': 72.014, 'best_valid_test/diff': 5.878, 'best_valid_test/acc_skew': 69.075, 'best_valid_test/acc_align': 74.953}
[3 / 20] best test accuracy: 72.771 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 73.122, 'best_test_valid/acc_unbiased': 73.199, 'best_test_valid/diff': 4.236, 'best_test_valid/acc_skew': 71.081, 'best_test_valid/acc_align': 75.317, 'best_test_test/acc': 72.574, 'best_test_test/acc_unbiased': 72.771, 'best_test_test/diff': 6.643, 'best_test_test/acc_skew': 69.449, 'best_test_test/acc_align': 76.092}
[4 / 20] Learning rate: 0.001 weight: 0.01
[4 / 20] Loss: 4.815485806276648 CE Loss: 0.564201828937754 Con Loss: 4.809843785940815
[4 / 20] tensor([[0.778, 0.758],
        [0.669, 0.752]]) {'epoch': 4, 'valid/acc': 74.093, 'valid/acc_unbiased': 73.732, 'valid/diff': 2.877, 'valid/acc_skew': 72.293, 'valid/acc_align': 75.17, 'test/acc': 74.346, 'test/acc_unbiased': 73.906, 'test/diff': 5.152, 'test/acc_skew': 71.329, 'test/acc_align': 76.482}
[4 / 20] best valid accuracy: 74.779 at epoch 3 
 best_stats: {'best_valid_epoch': 3, 'best_valid_valid/acc': 74.599, 'best_valid_valid/acc_unbiased': 74.779, 'best_valid_valid/diff': 3.602, 'best_valid_valid/acc_skew': 72.978, 'best_valid_valid/acc_align': 76.58, 'best_valid_test/acc': 71.857, 'best_valid_test/acc_unbiased': 72.014, 'best_valid_test/diff': 5.878, 'best_valid_test/acc_skew': 69.075, 'best_valid_test/acc_align': 74.953}
[4 / 20] best test accuracy: 73.906 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 74.093, 'best_test_valid/acc_unbiased': 73.732, 'best_test_valid/diff': 2.877, 'best_test_valid/acc_skew': 72.293, 'best_test_valid/acc_align': 75.17, 'best_test_test/acc': 74.346, 'best_test_test/acc_unbiased': 73.906, 'best_test_test/diff': 5.152, 'best_test_test/acc_skew': 71.329, 'best_test_test/acc_align': 76.482}
[5 / 20] Learning rate: 0.001 weight: 0.01
[5 / 20] Loss: 4.8155407018926795 CE Loss: 0.560735587581534 Con Loss: 4.8099333391706205
[5 / 20] tensor([[0.885, 0.824],
        [0.565, 0.637]]) {'epoch': 5, 'valid/acc': 74.684, 'valid/acc_unbiased': 73.566, 'valid/diff': 3.179, 'valid/acc_skew': 71.976, 'valid/acc_align': 75.155, 'test/acc': 73.502, 'test/acc_unbiased': 72.798, 'test/diff': 6.679, 'test/acc_skew': 69.458, 'test/acc_align': 76.137}
[5 / 20] best valid accuracy: 74.779 at epoch 3 
 best_stats: {'best_valid_epoch': 3, 'best_valid_valid/acc': 74.599, 'best_valid_valid/acc_unbiased': 74.779, 'best_valid_valid/diff': 3.602, 'best_valid_valid/acc_skew': 72.978, 'best_valid_valid/acc_align': 76.58, 'best_valid_test/acc': 71.857, 'best_valid_test/acc_unbiased': 72.014, 'best_valid_test/diff': 5.878, 'best_valid_test/acc_skew': 69.075, 'best_valid_test/acc_align': 74.953}
[5 / 20] best test accuracy: 73.906 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 74.093, 'best_test_valid/acc_unbiased': 73.732, 'best_test_valid/diff': 2.877, 'best_test_valid/acc_skew': 72.293, 'best_test_valid/acc_align': 75.17, 'best_test_test/acc': 74.346, 'best_test_test/acc_unbiased': 73.906, 'best_test_test/diff': 5.152, 'best_test_test/acc_skew': 71.329, 'best_test_test/acc_align': 76.482}
[6 / 20] Learning rate: 0.001 weight: 0.01
[6 / 20] Loss: 4.801512939514562 CE Loss: 0.5587247668562313 Con Loss: 4.795925686334971
[6 / 20] tensor([[0.862, 0.787],
        [0.643, 0.750]]) {'epoch': 6, 'valid/acc': 75.401, 'valid/acc_unbiased': 74.669, 'valid/diff': 7.226, 'valid/acc_skew': 71.056, 'valid/acc_align': 78.282, 'test/acc': 76.624, 'test/acc_unbiased': 76.063, 'test/diff': 9.111, 'test/acc_skew': 71.508, 'test/acc_align': 80.619}
[6 / 20] best valid accuracy: 74.779 at epoch 3 
 best_stats: {'best_valid_epoch': 3, 'best_valid_valid/acc': 74.599, 'best_valid_valid/acc_unbiased': 74.779, 'best_valid_valid/diff': 3.602, 'best_valid_valid/acc_skew': 72.978, 'best_valid_valid/acc_align': 76.58, 'best_valid_test/acc': 71.857, 'best_valid_test/acc_unbiased': 72.014, 'best_valid_test/diff': 5.878, 'best_valid_test/acc_skew': 69.075, 'best_valid_test/acc_align': 74.953}
[6 / 20] best test accuracy: 76.063 at epoch 6 
 best_stats: {'best_test_epoch': 6, 'best_test_valid/acc': 75.401, 'best_test_valid/acc_unbiased': 74.669, 'best_test_valid/diff': 7.226, 'best_test_valid/acc_skew': 71.056, 'best_test_valid/acc_align': 78.282, 'best_test_test/acc': 76.624, 'best_test_test/acc_unbiased': 76.063, 'best_test_test/diff': 9.111, 'best_test_test/acc_skew': 71.508, 'best_test_test/acc_align': 80.619}
[7 / 20] Learning rate: 0.0001 weight: 0.01
[7 / 20] Loss: 4.789006413338299 CE Loss: 0.5417580204861754 Con Loss: 4.783588855542341
[7 / 20] tensor([[0.754, 0.677],
        [0.786, 0.844]]) {'epoch': 7, 'valid/acc': 75.19, 'valid/acc_unbiased': 75.553, 'valid/diff': 5.008, 'valid/acc_skew': 73.049, 'valid/acc_align': 78.057, 'test/acc': 76.371, 'test/acc_unbiased': 76.517, 'test/diff': 6.812, 'test/acc_skew': 73.111, 'test/acc_align': 79.923}
[7 / 20] best valid accuracy: 75.553 at epoch 7 
 best_stats: {'best_valid_epoch': 7, 'best_valid_valid/acc': 75.19, 'best_valid_valid/acc_unbiased': 75.553, 'best_valid_valid/diff': 5.008, 'best_valid_valid/acc_skew': 73.049, 'best_valid_valid/acc_align': 78.057, 'best_valid_test/acc': 76.371, 'best_valid_test/acc_unbiased': 76.517, 'best_valid_test/diff': 6.812, 'best_valid_test/acc_skew': 73.111, 'best_valid_test/acc_align': 79.923}
[7 / 20] best test accuracy: 76.517 at epoch 7 
 best_stats: {'best_test_epoch': 7, 'best_test_valid/acc': 75.19, 'best_test_valid/acc_unbiased': 75.553, 'best_test_valid/diff': 5.008, 'best_test_valid/acc_skew': 73.049, 'best_test_valid/acc_align': 78.057, 'best_test_test/acc': 76.371, 'best_test_test/acc_unbiased': 76.517, 'best_test_test/diff': 6.812, 'best_test_test/acc_skew': 73.111, 'best_test_test/acc_align': 79.923}
[8 / 20] Learning rate: 0.0001 weight: 0.01
[8 / 20] Loss: 4.758193897817006 CE Loss: 0.5209943018144605 Con Loss: 4.752983932439265
[8 / 20] tensor([[0.787, 0.645],
        [0.779, 0.854]]) {'epoch': 8, 'valid/acc': 76.371, 'valid/acc_unbiased': 76.651, 'valid/diff': 5.523, 'valid/acc_skew': 73.89, 'valid/acc_align': 79.412, 'test/acc': 76.414, 'test/acc_unbiased': 76.646, 'test/diff': 10.82, 'test/acc_skew': 71.236, 'test/acc_align': 82.056}
[8 / 20] best valid accuracy: 76.651 at epoch 8 
 best_stats: {'best_valid_epoch': 8, 'best_valid_valid/acc': 76.371, 'best_valid_valid/acc_unbiased': 76.651, 'best_valid_valid/diff': 5.523, 'best_valid_valid/acc_skew': 73.89, 'best_valid_valid/acc_align': 79.412, 'best_valid_test/acc': 76.414, 'best_valid_test/acc_unbiased': 76.646, 'best_valid_test/diff': 10.82, 'best_valid_test/acc_skew': 71.236, 'best_valid_test/acc_align': 82.056}
[8 / 20] best test accuracy: 76.646 at epoch 8 
 best_stats: {'best_test_epoch': 8, 'best_test_valid/acc': 76.371, 'best_test_valid/acc_unbiased': 76.651, 'best_test_valid/diff': 5.523, 'best_test_valid/acc_skew': 73.89, 'best_test_valid/acc_align': 79.412, 'best_test_test/acc': 76.414, 'best_test_test/acc_unbiased': 76.646, 'best_test_test/diff': 10.82, 'best_test_test/acc_skew': 71.236, 'best_test_test/acc_align': 82.056}
[9 / 20] Learning rate: 0.0001 weight: 0.01
[9 / 20] Loss: 4.744923597897129 CE Loss: 0.5073174153990487 Con Loss: 4.739850417063142
[9 / 20] tensor([[0.787, 0.690],
        [0.799, 0.850]]) {'epoch': 9, 'valid/acc': 77.553, 'valid/acc_unbiased': 77.869, 'valid/diff': 3.723, 'valid/acc_skew': 76.007, 'valid/acc_align': 79.73, 'test/acc': 77.932, 'test/acc_unbiased': 78.129, 'test/diff': 7.408, 'test/acc_skew': 74.425, 'test/acc_align': 81.833}
[9 / 20] best valid accuracy: 77.869 at epoch 9 
 best_stats: {'best_valid_epoch': 9, 'best_valid_valid/acc': 77.553, 'best_valid_valid/acc_unbiased': 77.869, 'best_valid_valid/diff': 3.723, 'best_valid_valid/acc_skew': 76.007, 'best_valid_valid/acc_align': 79.73, 'best_valid_test/acc': 77.932, 'best_valid_test/acc_unbiased': 78.129, 'best_valid_test/diff': 7.408, 'best_valid_test/acc_skew': 74.425, 'best_valid_test/acc_align': 81.833}
[9 / 20] best test accuracy: 78.129 at epoch 9 
 best_stats: {'best_test_epoch': 9, 'best_test_valid/acc': 77.553, 'best_test_valid/acc_unbiased': 77.869, 'best_test_valid/diff': 3.723, 'best_test_valid/acc_skew': 76.007, 'best_test_valid/acc_align': 79.73, 'best_test_test/acc': 77.932, 'best_test_test/acc_unbiased': 78.129, 'best_test_test/diff': 7.408, 'best_test_test/acc_skew': 74.425, 'best_test_test/acc_align': 81.833}
[10 / 20] Learning rate: 0.0001 weight: 0.01
[10 / 20] Loss: 4.73494815128265 CE Loss: 0.4986303461767395 Con Loss: 4.729961850458148
[10 / 20] tensor([[0.789, 0.679],
        [0.790, 0.845]]) {'epoch': 10, 'valid/acc': 77.3, 'valid/acc_unbiased': 77.659, 'valid/diff': 4.984, 'valid/acc_skew': 75.167, 'valid/acc_align': 80.151, 'test/acc': 77.384, 'test/acc_unbiased': 77.588, 'test/diff': 8.224, 'test/acc_skew': 73.476, 'test/acc_align': 81.7}
[10 / 20] best valid accuracy: 77.869 at epoch 9 
 best_stats: {'best_valid_epoch': 9, 'best_valid_valid/acc': 77.553, 'best_valid_valid/acc_unbiased': 77.869, 'best_valid_valid/diff': 3.723, 'best_valid_valid/acc_skew': 76.007, 'best_valid_valid/acc_align': 79.73, 'best_valid_test/acc': 77.932, 'best_valid_test/acc_unbiased': 78.129, 'best_valid_test/diff': 7.408, 'best_valid_test/acc_skew': 74.425, 'best_valid_test/acc_align': 81.833}
[10 / 20] best test accuracy: 78.129 at epoch 9 
 best_stats: {'best_test_epoch': 9, 'best_test_valid/acc': 77.553, 'best_test_valid/acc_unbiased': 77.869, 'best_test_valid/diff': 3.723, 'best_test_valid/acc_skew': 76.007, 'best_test_valid/acc_align': 79.73, 'best_test_test/acc': 77.932, 'best_test_test/acc_unbiased': 78.129, 'best_test_test/diff': 7.408, 'best_test_test/acc_skew': 74.425, 'best_test_test/acc_align': 81.833}
[11 / 20] Learning rate: 0.0001 weight: 0.01
[11 / 20] Loss: 4.71474577706869 CE Loss: 0.4995266848392403 Con Loss: 4.709750523853442
[11 / 20] tensor([[0.797, 0.719],
        [0.768, 0.850]]) {'epoch': 11, 'valid/acc': 78.861, 'valid/acc_unbiased': 79.12, 'valid/diff': 5.785, 'valid/acc_skew': 76.227, 'valid/acc_align': 82.012, 'test/acc': 78.439, 'test/acc_unbiased': 78.379, 'test/diff': 7.983, 'test/acc_skew': 74.387, 'test/acc_align': 82.371}
[11 / 20] best valid accuracy: 79.120 at epoch 11 
 best_stats: {'best_valid_epoch': 11, 'best_valid_valid/acc': 78.861, 'best_valid_valid/acc_unbiased': 79.12, 'best_valid_valid/diff': 5.785, 'best_valid_valid/acc_skew': 76.227, 'best_valid_valid/acc_align': 82.012, 'best_valid_test/acc': 78.439, 'best_valid_test/acc_unbiased': 78.379, 'best_valid_test/diff': 7.983, 'best_valid_test/acc_skew': 74.387, 'best_valid_test/acc_align': 82.371}
[11 / 20] best test accuracy: 78.379 at epoch 11 
 best_stats: {'best_test_epoch': 11, 'best_test_valid/acc': 78.861, 'best_test_valid/acc_unbiased': 79.12, 'best_test_valid/diff': 5.785, 'best_test_valid/acc_skew': 76.227, 'best_test_valid/acc_align': 82.012, 'best_test_test/acc': 78.439, 'best_test_test/acc_unbiased': 78.379, 'best_test_test/diff': 7.983, 'best_test_test/acc_skew': 74.387, 'best_test_test/acc_align': 82.371}
[12 / 20] Learning rate: 0.0001 weight: 0.01
[12 / 20] Loss: 4.703734327374929 CE Loss: 0.49910307951587884 Con Loss: 4.698743290991944
[12 / 20] tensor([[0.790, 0.644],
        [0.829, 0.863]]) {'epoch': 12, 'valid/acc': 78.228, 'valid/acc_unbiased': 78.643, 'valid/diff': 6.006, 'valid/acc_skew': 75.64, 'valid/acc_align': 81.646, 'test/acc': 77.679, 'test/acc_unbiased': 78.166, 'test/diff': 9.03, 'test/acc_skew': 73.651, 'test/acc_align': 82.681}
[12 / 20] best valid accuracy: 79.120 at epoch 11 
 best_stats: {'best_valid_epoch': 11, 'best_valid_valid/acc': 78.861, 'best_valid_valid/acc_unbiased': 79.12, 'best_valid_valid/diff': 5.785, 'best_valid_valid/acc_skew': 76.227, 'best_valid_valid/acc_align': 82.012, 'best_valid_test/acc': 78.439, 'best_valid_test/acc_unbiased': 78.379, 'best_valid_test/diff': 7.983, 'best_valid_test/acc_skew': 74.387, 'best_valid_test/acc_align': 82.371}
[12 / 20] best test accuracy: 78.379 at epoch 11 
 best_stats: {'best_test_epoch': 11, 'best_test_valid/acc': 78.861, 'best_test_valid/acc_unbiased': 79.12, 'best_test_valid/diff': 5.785, 'best_test_valid/acc_skew': 76.227, 'best_test_valid/acc_align': 82.012, 'best_test_test/acc': 78.439, 'best_test_test/acc_unbiased': 78.379, 'best_test_test/diff': 7.983, 'best_test_test/acc_skew': 74.387, 'best_test_test/acc_align': 82.371}
[13 / 20] Learning rate: 0.0001 weight: 0.01
[13 / 20] Loss: 4.6922690990554115 CE Loss: 0.48993231502319323 Con Loss: 4.687369773887087
[13 / 20] tensor([[0.780, 0.629],
        [0.829, 0.881]]) {'epoch': 13, 'valid/acc': 77.89, 'valid/acc_unbiased': 78.411, 'valid/diff': 6.713, 'valid/acc_skew': 75.055, 'valid/acc_align': 81.768, 'test/acc': 77.511, 'test/acc_unbiased': 77.974, 'test/diff': 10.122, 'test/acc_skew': 72.913, 'test/acc_align': 83.035}
[13 / 20] best valid accuracy: 79.120 at epoch 11 
 best_stats: {'best_valid_epoch': 11, 'best_valid_valid/acc': 78.861, 'best_valid_valid/acc_unbiased': 79.12, 'best_valid_valid/diff': 5.785, 'best_valid_valid/acc_skew': 76.227, 'best_valid_valid/acc_align': 82.012, 'best_valid_test/acc': 78.439, 'best_valid_test/acc_unbiased': 78.379, 'best_valid_test/diff': 7.983, 'best_valid_test/acc_skew': 74.387, 'best_valid_test/acc_align': 82.371}
[13 / 20] best test accuracy: 78.379 at epoch 11 
 best_stats: {'best_test_epoch': 11, 'best_test_valid/acc': 78.861, 'best_test_valid/acc_unbiased': 79.12, 'best_test_valid/diff': 5.785, 'best_test_valid/acc_skew': 76.227, 'best_test_valid/acc_align': 82.012, 'best_test_test/acc': 78.439, 'best_test_test/acc_unbiased': 78.379, 'best_test_test/diff': 7.983, 'best_test_test/acc_skew': 74.387, 'best_test_test/acc_align': 82.371}
[14 / 20] Learning rate: 1e-05 weight: 0.01
[14 / 20] Loss: 4.690283547732352 CE Loss: 0.47847106380832666 Con Loss: 4.685498836623453
[14 / 20] tensor([[0.787, 0.635],
        [0.818, 0.871]]) {'epoch': 14, 'valid/acc': 78.228, 'valid/acc_unbiased': 78.717, 'valid/diff': 6.666, 'valid/acc_skew': 75.384, 'valid/acc_align': 82.05, 'test/acc': 77.342, 'test/acc_unbiased': 77.77, 'test/diff': 10.206, 'test/acc_skew': 72.667, 'test/acc_align': 82.873}
[14 / 20] best valid accuracy: 79.120 at epoch 11 
 best_stats: {'best_valid_epoch': 11, 'best_valid_valid/acc': 78.861, 'best_valid_valid/acc_unbiased': 79.12, 'best_valid_valid/diff': 5.785, 'best_valid_valid/acc_skew': 76.227, 'best_valid_valid/acc_align': 82.012, 'best_valid_test/acc': 78.439, 'best_valid_test/acc_unbiased': 78.379, 'best_valid_test/diff': 7.983, 'best_valid_test/acc_skew': 74.387, 'best_valid_test/acc_align': 82.371}
[14 / 20] best test accuracy: 78.379 at epoch 11 
 best_stats: {'best_test_epoch': 11, 'best_test_valid/acc': 78.861, 'best_test_valid/acc_unbiased': 79.12, 'best_test_valid/diff': 5.785, 'best_test_valid/acc_skew': 76.227, 'best_test_valid/acc_align': 82.012, 'best_test_test/acc': 78.439, 'best_test_test/acc_unbiased': 78.379, 'best_test_test/diff': 7.983, 'best_test_test/acc_skew': 74.387, 'best_test_test/acc_align': 82.371}
[15 / 20] Learning rate: 1e-05 weight: 0.01
[15 / 20] Loss: 4.681347489531532 CE Loss: 0.4812397450688643 Con Loss: 4.676535120471156
[15 / 20] tensor([[0.781, 0.644],
        [0.816, 0.871]]) {'epoch': 15, 'valid/acc': 78.65, 'valid/acc_unbiased': 79.192, 'valid/diff': 7.106, 'valid/acc_skew': 75.639, 'valid/acc_align': 82.745, 'test/acc': 77.426, 'test/acc_unbiased': 77.803, 'test/diff': 9.603, 'test/acc_skew': 73.002, 'test/acc_align': 82.605}
[15 / 20] best valid accuracy: 79.192 at epoch 15 
 best_stats: {'best_valid_epoch': 15, 'best_valid_valid/acc': 78.65, 'best_valid_valid/acc_unbiased': 79.192, 'best_valid_valid/diff': 7.106, 'best_valid_valid/acc_skew': 75.639, 'best_valid_valid/acc_align': 82.745, 'best_valid_test/acc': 77.426, 'best_valid_test/acc_unbiased': 77.803, 'best_valid_test/diff': 9.603, 'best_valid_test/acc_skew': 73.002, 'best_valid_test/acc_align': 82.605}
[15 / 20] best test accuracy: 78.379 at epoch 11 
 best_stats: {'best_test_epoch': 11, 'best_test_valid/acc': 78.861, 'best_test_valid/acc_unbiased': 79.12, 'best_test_valid/diff': 5.785, 'best_test_valid/acc_skew': 76.227, 'best_test_valid/acc_align': 82.012, 'best_test_test/acc': 78.439, 'best_test_test/acc_unbiased': 78.379, 'best_test_test/diff': 7.983, 'best_test_test/acc_skew': 74.387, 'best_test_test/acc_align': 82.371}
[16 / 20] Learning rate: 1e-05 weight: 0.01
[16 / 20] Loss: 4.676641851009073 CE Loss: 0.47471745035135204 Con Loss: 4.671894674594371
[16 / 20] tensor([[0.785, 0.660],
        [0.803, 0.866]]) {'epoch': 16, 'valid/acc': 78.734, 'valid/acc_unbiased': 79.161, 'valid/diff': 6.238, 'valid/acc_skew': 76.042, 'valid/acc_align': 82.28, 'test/acc': 77.595, 'test/acc_unbiased': 77.863, 'test/diff': 9.396, 'test/acc_skew': 73.165, 'test/acc_align': 82.561}
[16 / 20] best valid accuracy: 79.192 at epoch 15 
 best_stats: {'best_valid_epoch': 15, 'best_valid_valid/acc': 78.65, 'best_valid_valid/acc_unbiased': 79.192, 'best_valid_valid/diff': 7.106, 'best_valid_valid/acc_skew': 75.639, 'best_valid_valid/acc_align': 82.745, 'best_valid_test/acc': 77.426, 'best_valid_test/acc_unbiased': 77.803, 'best_valid_test/diff': 9.603, 'best_valid_test/acc_skew': 73.002, 'best_valid_test/acc_align': 82.605}
[16 / 20] best test accuracy: 78.379 at epoch 11 
 best_stats: {'best_test_epoch': 11, 'best_test_valid/acc': 78.861, 'best_test_valid/acc_unbiased': 79.12, 'best_test_valid/diff': 5.785, 'best_test_valid/acc_skew': 76.227, 'best_test_valid/acc_align': 82.012, 'best_test_test/acc': 78.439, 'best_test_test/acc_unbiased': 78.379, 'best_test_test/diff': 7.983, 'best_test_test/acc_skew': 74.387, 'best_test_test/acc_align': 82.371}
[17 / 20] Learning rate: 1e-05 weight: 0.01
[17 / 20] Loss: 4.672627957289599 CE Loss: 0.478666539466224 Con Loss: 4.667841279489229
[17 / 20] tensor([[0.787, 0.648],
        [0.818, 0.868]]) {'epoch': 17, 'valid/acc': 78.608, 'valid/acc_unbiased': 79.04, 'valid/diff': 6.07, 'valid/acc_skew': 76.005, 'valid/acc_align': 82.075, 'test/acc': 77.637, 'test/acc_unbiased': 78.028, 'test/diff': 9.393, 'test/acc_skew': 73.332, 'test/acc_align': 82.725}
[17 / 20] best valid accuracy: 79.192 at epoch 15 
 best_stats: {'best_valid_epoch': 15, 'best_valid_valid/acc': 78.65, 'best_valid_valid/acc_unbiased': 79.192, 'best_valid_valid/diff': 7.106, 'best_valid_valid/acc_skew': 75.639, 'best_valid_valid/acc_align': 82.745, 'best_valid_test/acc': 77.426, 'best_valid_test/acc_unbiased': 77.803, 'best_valid_test/diff': 9.603, 'best_valid_test/acc_skew': 73.002, 'best_valid_test/acc_align': 82.605}
[17 / 20] best test accuracy: 78.379 at epoch 11 
 best_stats: {'best_test_epoch': 11, 'best_test_valid/acc': 78.861, 'best_test_valid/acc_unbiased': 79.12, 'best_test_valid/diff': 5.785, 'best_test_valid/acc_skew': 76.227, 'best_test_valid/acc_align': 82.012, 'best_test_test/acc': 78.439, 'best_test_test/acc_unbiased': 78.379, 'best_test_test/diff': 7.983, 'best_test_test/acc_skew': 74.387, 'best_test_test/acc_align': 82.371}
[18 / 20] Learning rate: 1e-05 weight: 0.01
[18 / 20] Loss: 4.663340326284071 CE Loss: 0.47900044534077235 Con Loss: 4.658550323888463
[18 / 20] tensor([[0.805, 0.675],
        [0.805, 0.863]]) {'epoch': 18, 'valid/acc': 79.283, 'valid/acc_unbiased': 79.632, 'valid/diff': 6.668, 'valid/acc_skew': 76.299, 'valid/acc_align': 82.966, 'test/acc': 78.439, 'test/acc_unbiased': 78.705, 'test/diff': 9.386, 'test/acc_skew': 74.012, 'test/acc_align': 83.398}
[18 / 20] best valid accuracy: 79.632 at epoch 18 
 best_stats: {'best_valid_epoch': 18, 'best_valid_valid/acc': 79.283, 'best_valid_valid/acc_unbiased': 79.632, 'best_valid_valid/diff': 6.668, 'best_valid_valid/acc_skew': 76.299, 'best_valid_valid/acc_align': 82.966, 'best_valid_test/acc': 78.439, 'best_valid_test/acc_unbiased': 78.705, 'best_valid_test/diff': 9.386, 'best_valid_test/acc_skew': 74.012, 'best_valid_test/acc_align': 83.398}
[18 / 20] best test accuracy: 78.705 at epoch 18 
 best_stats: {'best_test_epoch': 18, 'best_test_valid/acc': 79.283, 'best_test_valid/acc_unbiased': 79.632, 'best_test_valid/diff': 6.668, 'best_test_valid/acc_skew': 76.299, 'best_test_valid/acc_align': 82.966, 'best_test_test/acc': 78.439, 'best_test_test/acc_unbiased': 78.705, 'best_test_test/diff': 9.386, 'best_test_test/acc_skew': 74.012, 'best_test_test/acc_align': 83.398}
[19 / 20] Learning rate: 1e-05 weight: 0.01
[19 / 20] Loss: 4.67023356173782 CE Loss: 0.47566609976930463 Con Loss: 4.665476916300604
[19 / 20] tensor([[0.796, 0.659],
        [0.814, 0.869]]) {'epoch': 19, 'valid/acc': 79.072, 'valid/acc_unbiased': 79.519, 'valid/diff': 6.004, 'valid/acc_skew': 76.517, 'valid/acc_align': 82.521, 'test/acc': 78.101, 'test/acc_unbiased': 78.44, 'test/diff': 9.615, 'test/acc_skew': 73.632, 'test/acc_align': 83.247}
[19 / 20] best valid accuracy: 79.632 at epoch 18 
 best_stats: {'best_valid_epoch': 18, 'best_valid_valid/acc': 79.283, 'best_valid_valid/acc_unbiased': 79.632, 'best_valid_valid/diff': 6.668, 'best_valid_valid/acc_skew': 76.299, 'best_valid_valid/acc_align': 82.966, 'best_valid_test/acc': 78.439, 'best_valid_test/acc_unbiased': 78.705, 'best_valid_test/diff': 9.386, 'best_valid_test/acc_skew': 74.012, 'best_valid_test/acc_align': 83.398}
[19 / 20] best test accuracy: 78.705 at epoch 18 
 best_stats: {'best_test_epoch': 18, 'best_test_valid/acc': 79.283, 'best_test_valid/acc_unbiased': 79.632, 'best_test_valid/diff': 6.668, 'best_test_valid/acc_skew': 76.299, 'best_test_valid/acc_align': 82.966, 'best_test_test/acc': 78.439, 'best_test_test/acc_unbiased': 78.705, 'best_test_test/diff': 9.386, 'best_test_test/acc_skew': 74.012, 'best_test_test/acc_align': 83.398}
[20 / 20] Learning rate: 1e-05 weight: 0.01
[20 / 20] Loss: 4.669646798604404 CE Loss: 0.4727495989897241 Con Loss: 4.664919330993474
[20 / 20] tensor([[0.799, 0.671],
        [0.805, 0.862]]) {'epoch': 20, 'valid/acc': 78.987, 'valid/acc_unbiased': 79.341, 'valid/diff': 6.377, 'valid/acc_skew': 76.152, 'valid/acc_align': 82.529, 'test/acc': 78.143, 'test/acc_unbiased': 78.422, 'test/diff': 9.265, 'test/acc_skew': 73.79, 'test/acc_align': 83.055}
[20 / 20] best valid accuracy: 79.632 at epoch 18 
 best_stats: {'best_valid_epoch': 18, 'best_valid_valid/acc': 79.283, 'best_valid_valid/acc_unbiased': 79.632, 'best_valid_valid/diff': 6.668, 'best_valid_valid/acc_skew': 76.299, 'best_valid_valid/acc_align': 82.966, 'best_valid_test/acc': 78.439, 'best_valid_test/acc_unbiased': 78.705, 'best_valid_test/diff': 9.386, 'best_valid_test/acc_skew': 74.012, 'best_valid_test/acc_align': 83.398}
[20 / 20] best test accuracy: 78.705 at epoch 18 
 best_stats: {'best_test_epoch': 18, 'best_test_valid/acc': 79.283, 'best_test_valid/acc_unbiased': 79.632, 'best_test_valid/diff': 6.668, 'best_test_valid/acc_skew': 76.299, 'best_test_valid/acc_align': 82.966, 'best_test_test/acc': 78.439, 'best_test_test/acc_unbiased': 78.705, 'best_test_test/diff': 9.386, 'best_test_test/acc_skew': 74.012, 'best_test_test/acc_align': 83.398}
Total training time: 0:17:44
