Log level set to: INFO
Set seed: 2
=======> Using Fixed Random Seed: 2 <========
save_path: exp_results/bc-bb0-utk_face_age-uw-0.995-lr0.001-bs128-cbs64-w0.01-ratio10-aug1-seed2
get_utk_face - split: train, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_age-0.995
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [8237, 7]
Target 1: [41, 1477]
Binary Target 1
---------------------------
Target 0: [8237, 7]
Target 1: [41, 1477]
===================================
Normal Label Distribution: 
Target 0: [8237, 7]
Target 1: [41, 1477]
===================================
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [8237, 7]
Target 1: [41, 1477]
Binary Target 1
---------------------------
Target 0: [8237, 7]
Target 1: [41, 1477]
===================================
Normal Label Distribution: 
Target 0: [8237, 7]
Target 1: [41, 1477]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 9762, target_attr: gender, bias_attr: age bias_rate: 0.995
['[train] target_0-bias_0: 8237', '[train] target_0-bias_1: 7', '[train] target_1-bias_0: 41', '[train] target_1-bias_1: 1477']
confusion_matrix - 
 original: tensor([[8.237e+03, 4.100e+01],
        [7.000e+00, 1.477e+03]]), 
 normalized: tensor([[0.995, 0.005],
        [0.005, 0.995]]), 
 b|y: tensor([[9.992e-01, 8.491e-04],
        [2.701e-02, 9.730e-01]])
get_utk_face - split: train, aug: 1, given_y: True, ratio: 10
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_age-0.995
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [8237, 7]
Target 1: [41, 1477]
Binary Target 1
---------------------------
Target 0: [8237, 7]
Target 1: [41, 1477]
===================================
Normal Label Distribution: 
Target 0: [8237, 7]
Target 1: [41, 1477]
===================================
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [8237, 7]
Target 1: [41, 1477]
Binary Target 1
---------------------------
Target 0: [8237, 7]
Target 1: [41, 1477]
===================================
Normal Label Distribution: 
Target 0: [8237, 7]
Target 1: [41, 1477]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 9762, target_attr: gender, bias_attr: age bias_rate: 0.995
['[train] target_0-bias_0: 8237', '[train] target_0-bias_1: 7', '[train] target_1-bias_0: 41', '[train] target_1-bias_1: 1477']
get_utk_face - split: valid, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_age-0.995
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [1030, 195]
Target 1: [841, 202]
Binary Target 1
---------------------------
Target 0: [1030, 195]
Target 1: [841, 202]
===================================
Normal Label Distribution: 
Target 0: [1030, 195]
Target 1: [841, 202]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 2268, target_attr: gender, bias_attr: age bias_rate: 0.995
['[valid] target_0-bias_0: 1030', '[valid] target_0-bias_1: 195', '[valid] target_1-bias_0: 841', '[valid] target_1-bias_1: 202']
get_utk_face - split: test, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_age-0.995
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [1061, 176]
Target 1: [867, 165]
Binary Target 1
---------------------------
Target 0: [1061, 176]
Target 1: [867, 165]
===================================
Normal Label Distribution: 
Target 0: [1061, 176]
Target 1: [867, 165]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 2269, target_attr: gender, bias_attr: age bias_rate: 0.995
['[test] target_0-bias_0: 1061', '[test] target_0-bias_1: 176', '[test] target_1-bias_0: 867', '[test] target_1-bias_1: 165']
decay_epochs: [6, 13]
[1 / 20] Learning rate: 0.001 weight: 0.01
[1 / 20] Loss: 2.493681324576042 CE Loss: 4.088331207465109 Con Loss: 2.452798019738208
[1 / 20] tensor([[0.377, 0.562],
        [0.619, 0.406]]) {'epoch': 1, 'valid/acc': 48.06, 'valid/acc_unbiased': 50.816, 'valid/diff': 17.339, 'valid/acc_skew': 59.485, 'valid/acc_align': 42.146, 'test/acc': 48.612, 'test/acc_unbiased': 49.124, 'test/diff': 19.941, 'test/acc_skew': 59.094, 'test/acc_align': 39.153}
[1 / 20] best valid accuracy: 50.816 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 48.06, 'best_valid_valid/acc_unbiased': 50.816, 'best_valid_valid/diff': 17.339, 'best_valid_valid/acc_skew': 59.485, 'best_valid_valid/acc_align': 42.146, 'best_valid_test/acc': 48.612, 'best_valid_test/acc_unbiased': 49.124, 'best_valid_test/diff': 19.941, 'best_valid_test/acc_skew': 59.094, 'best_valid_test/acc_align': 39.153}
[1 / 20] best test accuracy: 49.124 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 48.06, 'best_test_valid/acc_unbiased': 50.816, 'best_test_valid/diff': 17.339, 'best_test_valid/acc_skew': 59.485, 'best_test_valid/acc_align': 42.146, 'best_test_test/acc': 48.612, 'best_test_test/acc_unbiased': 49.124, 'best_test_test/diff': 19.941, 'best_test_test/acc_skew': 59.094, 'best_test_test/acc_align': 39.153}
[2 / 20] Learning rate: 0.001 weight: 0.01
[2 / 20] Loss: 1.9075582602111514 CE Loss: 3.890113517095554 Con Loss: 1.8686571226967965
[2 / 20] tensor([[0.319, 0.085],
        [0.956, 0.958]]) {'epoch': 2, 'valid/acc': 61.067, 'valid/acc_unbiased': 58.814, 'valid/diff': 15.8, 'valid/acc_skew': 50.914, 'valid/acc_align': 66.714, 'test/acc': 59.057, 'test/acc_unbiased': 57.939, 'test/diff': 11.737, 'test/acc_skew': 52.07, 'test/acc_align': 63.807}
[2 / 20] best valid accuracy: 58.814 at epoch 2 
 best_stats: {'best_valid_epoch': 2, 'best_valid_valid/acc': 61.067, 'best_valid_valid/acc_unbiased': 58.814, 'best_valid_valid/diff': 15.8, 'best_valid_valid/acc_skew': 50.914, 'best_valid_valid/acc_align': 66.714, 'best_valid_test/acc': 59.057, 'best_valid_test/acc_unbiased': 57.939, 'best_valid_test/diff': 11.737, 'best_valid_test/acc_skew': 52.07, 'best_valid_test/acc_align': 63.807}
[2 / 20] best test accuracy: 57.939 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 61.067, 'best_test_valid/acc_unbiased': 58.814, 'best_test_valid/diff': 15.8, 'best_test_valid/acc_skew': 50.914, 'best_test_valid/acc_align': 66.714, 'best_test_test/acc': 59.057, 'best_test_test/acc_unbiased': 57.939, 'best_test_test/diff': 11.737, 'best_test_test/acc_skew': 52.07, 'best_test_test/acc_align': 63.807}
[3 / 20] Learning rate: 0.001 weight: 0.01
[3 / 20] Loss: 1.6998633013302076 CE Loss: 3.1372731223601686 Con Loss: 1.6684905595648512
[3 / 20] tensor([[0.748, 0.494],
        [0.469, 0.582]]) {'epoch': 3, 'valid/acc': 60.494, 'valid/acc_unbiased': 55.443, 'valid/diff': 13.774, 'valid/acc_skew': 48.556, 'valid/acc_align': 62.33, 'test/acc': 60.996, 'test/acc_unbiased': 57.348, 'test/diff': 18.321, 'test/acc_skew': 48.188, 'test/acc_align': 66.508}
[3 / 20] best valid accuracy: 58.814 at epoch 2 
 best_stats: {'best_valid_epoch': 2, 'best_valid_valid/acc': 61.067, 'best_valid_valid/acc_unbiased': 58.814, 'best_valid_valid/diff': 15.8, 'best_valid_valid/acc_skew': 50.914, 'best_valid_valid/acc_align': 66.714, 'best_valid_test/acc': 59.057, 'best_valid_test/acc_unbiased': 57.939, 'best_valid_test/diff': 11.737, 'best_valid_test/acc_skew': 52.07, 'best_valid_test/acc_align': 63.807}
[3 / 20] best test accuracy: 57.939 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 61.067, 'best_test_valid/acc_unbiased': 58.814, 'best_test_valid/diff': 15.8, 'best_test_valid/acc_skew': 50.914, 'best_test_valid/acc_align': 66.714, 'best_test_test/acc': 59.057, 'best_test_test/acc_unbiased': 57.939, 'best_test_test/diff': 11.737, 'best_test_test/acc_skew': 52.07, 'best_test_test/acc_align': 63.807}
[4 / 20] Learning rate: 0.001 weight: 0.01
[4 / 20] Loss: 1.886574987626618 CE Loss: 2.813693437584109 Con Loss: 1.8584380605088422
[4 / 20] tensor([[0.899, 0.722],
        [0.285, 0.400]]) {'epoch': 4, 'valid/acc': 62.213, 'valid/acc_unbiased': 58.194, 'valid/diff': 14.109, 'valid/acc_skew': 51.14, 'valid/acc_align': 65.248, 'test/acc': 61.437, 'test/acc_unbiased': 57.641, 'test/diff': 14.634, 'test/acc_skew': 50.324, 'test/acc_align': 64.958}
[4 / 20] best valid accuracy: 58.814 at epoch 2 
 best_stats: {'best_valid_epoch': 2, 'best_valid_valid/acc': 61.067, 'best_valid_valid/acc_unbiased': 58.814, 'best_valid_valid/diff': 15.8, 'best_valid_valid/acc_skew': 50.914, 'best_valid_valid/acc_align': 66.714, 'best_valid_test/acc': 59.057, 'best_valid_test/acc_unbiased': 57.939, 'best_valid_test/diff': 11.737, 'best_valid_test/acc_skew': 52.07, 'best_valid_test/acc_align': 63.807}
[4 / 20] best test accuracy: 57.939 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 61.067, 'best_test_valid/acc_unbiased': 58.814, 'best_test_valid/diff': 15.8, 'best_test_valid/acc_skew': 50.914, 'best_test_valid/acc_align': 66.714, 'best_test_test/acc': 59.057, 'best_test_test/acc_unbiased': 57.939, 'best_test_test/diff': 11.737, 'best_test_test/acc_skew': 52.07, 'best_test_test/acc_align': 63.807}
[5 / 20] Learning rate: 0.001 weight: 0.01
[5 / 20] Loss: 2.1350125048375963 CE Loss: 2.878084826435229 Con Loss: 2.106231663332589
[5 / 20] tensor([[0.911, 0.818],
        [0.219, 0.164]]) {'epoch': 5, 'valid/acc': 57.848, 'valid/acc_unbiased': 53.105, 'valid/diff': 6.372, 'valid/acc_skew': 52.047, 'valid/acc_align': 54.163, 'test/acc': 58.528, 'test/acc_unbiased': 52.809, 'test/diff': 7.437, 'test/acc_skew': 51.866, 'test/acc_align': 53.752}
[5 / 20] best valid accuracy: 58.814 at epoch 2 
 best_stats: {'best_valid_epoch': 2, 'best_valid_valid/acc': 61.067, 'best_valid_valid/acc_unbiased': 58.814, 'best_valid_valid/diff': 15.8, 'best_valid_valid/acc_skew': 50.914, 'best_valid_valid/acc_align': 66.714, 'best_valid_test/acc': 59.057, 'best_valid_test/acc_unbiased': 57.939, 'best_valid_test/diff': 11.737, 'best_valid_test/acc_skew': 52.07, 'best_valid_test/acc_align': 63.807}
[5 / 20] best test accuracy: 57.939 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 61.067, 'best_test_valid/acc_unbiased': 58.814, 'best_test_valid/diff': 15.8, 'best_test_valid/acc_skew': 50.914, 'best_test_valid/acc_align': 66.714, 'best_test_test/acc': 59.057, 'best_test_test/acc_unbiased': 57.939, 'best_test_test/diff': 11.737, 'best_test_test/acc_skew': 52.07, 'best_test_test/acc_align': 63.807}
[6 / 20] Learning rate: 0.001 weight: 0.01
[6 / 20] Loss: 2.092023275067537 CE Loss: 3.005951623182955 Con Loss: 2.061963766453037
[6 / 20] tensor([[0.928, 0.733],
        [0.332, 0.424]]) {'epoch': 6, 'valid/acc': 63.272, 'valid/acc_unbiased': 57.583, 'valid/diff': 15.37, 'valid/acc_skew': 49.898, 'valid/acc_align': 65.268, 'test/acc': 64.874, 'test/acc_unbiased': 60.444, 'test/diff': 14.374, 'test/acc_skew': 53.257, 'test/acc_align': 67.631}
[6 / 20] best valid accuracy: 58.814 at epoch 2 
 best_stats: {'best_valid_epoch': 2, 'best_valid_valid/acc': 61.067, 'best_valid_valid/acc_unbiased': 58.814, 'best_valid_valid/diff': 15.8, 'best_valid_valid/acc_skew': 50.914, 'best_valid_valid/acc_align': 66.714, 'best_valid_test/acc': 59.057, 'best_valid_test/acc_unbiased': 57.939, 'best_valid_test/diff': 11.737, 'best_valid_test/acc_skew': 52.07, 'best_valid_test/acc_align': 63.807}
[6 / 20] best test accuracy: 60.444 at epoch 6 
 best_stats: {'best_test_epoch': 6, 'best_test_valid/acc': 63.272, 'best_test_valid/acc_unbiased': 57.583, 'best_test_valid/diff': 15.37, 'best_test_valid/acc_skew': 49.898, 'best_test_valid/acc_align': 65.268, 'best_test_test/acc': 64.874, 'best_test_test/acc_unbiased': 60.444, 'best_test_test/diff': 14.374, 'best_test_test/acc_skew': 53.257, 'best_test_test/acc_align': 67.631}
[7 / 20] Learning rate: 0.0001 weight: 0.01
[7 / 20] Loss: 1.9797379097545813 CE Loss: 2.1154329666127145 Con Loss: 1.95858358345274
[7 / 20] tensor([[0.737, 0.307],
        [0.717, 0.818]]) {'epoch': 7, 'valid/acc': 71.076, 'valid/acc_unbiased': 63.359, 'valid/diff': 27.035, 'valid/acc_skew': 49.841, 'valid/acc_align': 76.876, 'test/acc': 70.207, 'test/acc_unbiased': 64.486, 'test/diff': 26.549, 'test/acc_skew': 51.212, 'test/acc_align': 77.761}
[7 / 20] best valid accuracy: 63.359 at epoch 7 
 best_stats: {'best_valid_epoch': 7, 'best_valid_valid/acc': 71.076, 'best_valid_valid/acc_unbiased': 63.359, 'best_valid_valid/diff': 27.035, 'best_valid_valid/acc_skew': 49.841, 'best_valid_valid/acc_align': 76.876, 'best_valid_test/acc': 70.207, 'best_valid_test/acc_unbiased': 64.486, 'best_valid_test/diff': 26.549, 'best_valid_test/acc_skew': 51.212, 'best_valid_test/acc_align': 77.761}
[7 / 20] best test accuracy: 64.486 at epoch 7 
 best_stats: {'best_test_epoch': 7, 'best_test_valid/acc': 71.076, 'best_test_valid/acc_unbiased': 63.359, 'best_test_valid/diff': 27.035, 'best_test_valid/acc_skew': 49.841, 'best_test_valid/acc_align': 76.876, 'best_test_test/acc': 70.207, 'best_test_test/acc_unbiased': 64.486, 'best_test_test/diff': 26.549, 'best_test_test/acc_skew': 51.212, 'best_test_test/acc_align': 77.761}
[8 / 20] Learning rate: 0.0001 weight: 0.01
[8 / 20] Loss: 1.5814553327038747 CE Loss: 2.196624109830995 Con Loss: 1.559489085717759
[8 / 20] tensor([[0.736, 0.227],
        [0.764, 0.891]]) {'epoch': 8, 'valid/acc': 73.104, 'valid/acc_unbiased': 65.512, 'valid/diff': 32.822, 'valid/acc_skew': 49.101, 'valid/acc_align': 81.923, 'test/acc': 71.838, 'test/acc_unbiased': 65.446, 'test/diff': 31.809, 'test/acc_skew': 49.541, 'test/acc_align': 81.35}
[8 / 20] best valid accuracy: 65.512 at epoch 8 
 best_stats: {'best_valid_epoch': 8, 'best_valid_valid/acc': 73.104, 'best_valid_valid/acc_unbiased': 65.512, 'best_valid_valid/diff': 32.822, 'best_valid_valid/acc_skew': 49.101, 'best_valid_valid/acc_align': 81.923, 'best_valid_test/acc': 71.838, 'best_valid_test/acc_unbiased': 65.446, 'best_valid_test/diff': 31.809, 'best_valid_test/acc_skew': 49.541, 'best_valid_test/acc_align': 81.35}
[8 / 20] best test accuracy: 65.446 at epoch 8 
 best_stats: {'best_test_epoch': 8, 'best_test_valid/acc': 73.104, 'best_test_valid/acc_unbiased': 65.512, 'best_test_valid/diff': 32.822, 'best_test_valid/acc_skew': 49.101, 'best_test_valid/acc_align': 81.923, 'best_test_test/acc': 71.838, 'best_test_test/acc_unbiased': 65.446, 'best_test_test/diff': 31.809, 'best_test_test/acc_skew': 49.541, 'best_test_test/acc_align': 81.35}
[9 / 20] Learning rate: 0.0001 weight: 0.01
[9 / 20] Loss: 1.403297842183921 CE Loss: 2.1322888626570684 Con Loss: 1.3819749428707664
[9 / 20] tensor([[0.779, 0.278],
        [0.708, 0.794]]) {'epoch': 9, 'valid/acc': 71.164, 'valid/acc_unbiased': 63.27, 'valid/diff': 27.348, 'valid/acc_skew': 49.596, 'valid/acc_align': 76.944, 'test/acc': 71.441, 'test/acc_unbiased': 64.0, 'test/diff': 29.34, 'test/acc_skew': 49.33, 'test/acc_align': 78.67}
[9 / 20] best valid accuracy: 65.512 at epoch 8 
 best_stats: {'best_valid_epoch': 8, 'best_valid_valid/acc': 73.104, 'best_valid_valid/acc_unbiased': 65.512, 'best_valid_valid/diff': 32.822, 'best_valid_valid/acc_skew': 49.101, 'best_valid_valid/acc_align': 81.923, 'best_valid_test/acc': 71.838, 'best_valid_test/acc_unbiased': 65.446, 'best_valid_test/diff': 31.809, 'best_valid_test/acc_skew': 49.541, 'best_valid_test/acc_align': 81.35}
[9 / 20] best test accuracy: 65.446 at epoch 8 
 best_stats: {'best_test_epoch': 8, 'best_test_valid/acc': 73.104, 'best_test_valid/acc_unbiased': 65.512, 'best_test_valid/diff': 32.822, 'best_test_valid/acc_skew': 49.101, 'best_test_valid/acc_align': 81.923, 'best_test_test/acc': 71.838, 'best_test_test/acc_unbiased': 65.446, 'best_test_test/diff': 31.809, 'best_test_test/acc_skew': 49.541, 'best_test_test/acc_align': 81.35}
[10 / 20] Learning rate: 0.0001 weight: 0.01
[10 / 20] Loss: 1.6864366851437167 CE Loss: 2.0655748069200865 Con Loss: 1.6657809407172255
[10 / 20] tensor([[0.859, 0.443],
        [0.582, 0.673]]) {'epoch': 10, 'valid/acc': 71.164, 'valid/acc_unbiased': 63.801, 'valid/diff': 23.453, 'valid/acc_skew': 52.075, 'valid/acc_align': 75.528, 'test/acc': 70.736, 'test/acc_unbiased': 63.925, 'test/diff': 25.285, 'test/acc_skew': 51.283, 'test/acc_align': 76.568}
[10 / 20] best valid accuracy: 65.512 at epoch 8 
 best_stats: {'best_valid_epoch': 8, 'best_valid_valid/acc': 73.104, 'best_valid_valid/acc_unbiased': 65.512, 'best_valid_valid/diff': 32.822, 'best_valid_valid/acc_skew': 49.101, 'best_valid_valid/acc_align': 81.923, 'best_valid_test/acc': 71.838, 'best_valid_test/acc_unbiased': 65.446, 'best_valid_test/diff': 31.809, 'best_valid_test/acc_skew': 49.541, 'best_valid_test/acc_align': 81.35}
[10 / 20] best test accuracy: 65.446 at epoch 8 
 best_stats: {'best_test_epoch': 8, 'best_test_valid/acc': 73.104, 'best_test_valid/acc_unbiased': 65.512, 'best_test_valid/diff': 32.822, 'best_test_valid/acc_skew': 49.101, 'best_test_valid/acc_align': 81.923, 'best_test_test/acc': 71.838, 'best_test_test/acc_unbiased': 65.446, 'best_test_test/diff': 31.809, 'best_test_test/acc_skew': 49.541, 'best_test_test/acc_align': 81.35}
[11 / 20] Learning rate: 0.0001 weight: 0.01
[11 / 20] Loss: 1.805439431668305 CE Loss: 1.9594885097910844 Con Loss: 1.7858445457053267
[11 / 20] tensor([[0.876, 0.341],
        [0.632, 0.776]]) {'epoch': 11, 'valid/acc': 73.721, 'valid/acc_unbiased': 67.231, 'valid/diff': 33.775, 'valid/acc_skew': 50.343, 'valid/acc_align': 84.119, 'test/acc': 73.38, 'test/acc_unbiased': 65.608, 'test/diff': 33.919, 'test/acc_skew': 48.649, 'test/acc_align': 82.567}
[11 / 20] best valid accuracy: 67.231 at epoch 11 
 best_stats: {'best_valid_epoch': 11, 'best_valid_valid/acc': 73.721, 'best_valid_valid/acc_unbiased': 67.231, 'best_valid_valid/diff': 33.775, 'best_valid_valid/acc_skew': 50.343, 'best_valid_valid/acc_align': 84.119, 'best_valid_test/acc': 73.38, 'best_valid_test/acc_unbiased': 65.608, 'best_valid_test/diff': 33.919, 'best_valid_test/acc_skew': 48.649, 'best_valid_test/acc_align': 82.567}
[11 / 20] best test accuracy: 65.608 at epoch 11 
 best_stats: {'best_test_epoch': 11, 'best_test_valid/acc': 73.721, 'best_test_valid/acc_unbiased': 67.231, 'best_test_valid/diff': 33.775, 'best_test_valid/acc_skew': 50.343, 'best_test_valid/acc_align': 84.119, 'best_test_test/acc': 73.38, 'best_test_test/acc_unbiased': 65.608, 'best_test_test/diff': 33.919, 'best_test_test/acc_skew': 48.649, 'best_test_test/acc_align': 82.567}
[12 / 20] Learning rate: 0.0001 weight: 0.01
[12 / 20] Loss: 1.3849935452973738 CE Loss: 2.59545977436551 Con Loss: 1.3590389442746695
[12 / 20] tensor([[0.848, 0.324],
        [0.700, 0.812]]) {'epoch': 12, 'valid/acc': 74.295, 'valid/acc_unbiased': 67.214, 'valid/diff': 33.392, 'valid/acc_skew': 50.518, 'valid/acc_align': 83.909, 'test/acc': 74.835, 'test/acc_unbiased': 67.109, 'test/diff': 31.82, 'test/acc_skew': 51.199, 'test/acc_align': 83.019}
[12 / 20] best valid accuracy: 67.231 at epoch 11 
 best_stats: {'best_valid_epoch': 11, 'best_valid_valid/acc': 73.721, 'best_valid_valid/acc_unbiased': 67.231, 'best_valid_valid/diff': 33.775, 'best_valid_valid/acc_skew': 50.343, 'best_valid_valid/acc_align': 84.119, 'best_valid_test/acc': 73.38, 'best_valid_test/acc_unbiased': 65.608, 'best_valid_test/diff': 33.919, 'best_valid_test/acc_skew': 48.649, 'best_valid_test/acc_align': 82.567}
[12 / 20] best test accuracy: 67.109 at epoch 12 
 best_stats: {'best_test_epoch': 12, 'best_test_valid/acc': 74.295, 'best_test_valid/acc_unbiased': 67.214, 'best_test_valid/diff': 33.392, 'best_test_valid/acc_skew': 50.518, 'best_test_valid/acc_align': 83.909, 'best_test_test/acc': 74.835, 'best_test_test/acc_unbiased': 67.109, 'best_test_test/diff': 31.82, 'best_test_test/acc_skew': 51.199, 'best_test_test/acc_align': 83.019}
[13 / 20] Learning rate: 0.0001 weight: 0.01
[13 / 20] Loss: 1.6231336690099287 CE Loss: 1.5712720194548717 Con Loss: 1.6074209516836322
[13 / 20] tensor([[0.787, 0.233],
        [0.724, 0.867]]) {'epoch': 13, 'valid/acc': 74.78, 'valid/acc_unbiased': 67.777, 'valid/diff': 32.72, 'valid/acc_skew': 51.417, 'valid/acc_align': 84.137, 'test/acc': 72.587, 'test/acc_unbiased': 65.274, 'test/diff': 34.818, 'test/acc_skew': 47.865, 'test/acc_align': 82.683}
[13 / 20] best valid accuracy: 67.777 at epoch 13 
 best_stats: {'best_valid_epoch': 13, 'best_valid_valid/acc': 74.78, 'best_valid_valid/acc_unbiased': 67.777, 'best_valid_valid/diff': 32.72, 'best_valid_valid/acc_skew': 51.417, 'best_valid_valid/acc_align': 84.137, 'best_valid_test/acc': 72.587, 'best_valid_test/acc_unbiased': 65.274, 'best_valid_test/diff': 34.818, 'best_valid_test/acc_skew': 47.865, 'best_valid_test/acc_align': 82.683}
[13 / 20] best test accuracy: 67.109 at epoch 12 
 best_stats: {'best_test_epoch': 12, 'best_test_valid/acc': 74.295, 'best_test_valid/acc_unbiased': 67.214, 'best_test_valid/diff': 33.392, 'best_test_valid/acc_skew': 50.518, 'best_test_valid/acc_align': 83.909, 'best_test_test/acc': 74.835, 'best_test_test/acc_unbiased': 67.109, 'best_test_test/diff': 31.82, 'best_test_test/acc_skew': 51.199, 'best_test_test/acc_align': 83.019}
[14 / 20] Learning rate: 1e-05 weight: 0.01
[14 / 20] Loss: 1.5829883361175348 CE Loss: 1.557559444935589 Con Loss: 1.567412740992269
[14 / 20] tensor([[0.822, 0.250],
        [0.704, 0.873]]) {'epoch': 14, 'valid/acc': 74.735, 'valid/acc_unbiased': 67.633, 'valid/diff': 35.048, 'valid/acc_skew': 50.109, 'valid/acc_align': 85.157, 'test/acc': 73.601, 'test/acc_unbiased': 66.204, 'test/diff': 37.051, 'test/acc_skew': 47.679, 'test/acc_align': 84.73}
[14 / 20] best valid accuracy: 67.777 at epoch 13 
 best_stats: {'best_valid_epoch': 13, 'best_valid_valid/acc': 74.78, 'best_valid_valid/acc_unbiased': 67.777, 'best_valid_valid/diff': 32.72, 'best_valid_valid/acc_skew': 51.417, 'best_valid_valid/acc_align': 84.137, 'best_valid_test/acc': 72.587, 'best_valid_test/acc_unbiased': 65.274, 'best_valid_test/diff': 34.818, 'best_valid_test/acc_skew': 47.865, 'best_valid_test/acc_align': 82.683}
[14 / 20] best test accuracy: 67.109 at epoch 12 
 best_stats: {'best_test_epoch': 12, 'best_test_valid/acc': 74.295, 'best_test_valid/acc_unbiased': 67.214, 'best_test_valid/diff': 33.392, 'best_test_valid/acc_skew': 50.518, 'best_test_valid/acc_align': 83.909, 'best_test_test/acc': 74.835, 'best_test_test/acc_unbiased': 67.109, 'best_test_test/diff': 31.82, 'best_test_test/acc_skew': 51.199, 'best_test_test/acc_align': 83.019}
[15 / 20] Learning rate: 1e-05 weight: 0.01
[15 / 20] Loss: 1.6557092274390535 CE Loss: 1.2588937067882957 Con Loss: 1.643120291706383
[15 / 20] tensor([[0.824, 0.244],
        [0.714, 0.861]]) {'epoch': 15, 'valid/acc': 75.044, 'valid/acc_unbiased': 68.518, 'valid/diff': 35.161, 'valid/acc_skew': 50.938, 'valid/acc_align': 86.098, 'test/acc': 73.953, 'test/acc_unbiased': 66.066, 'test/diff': 36.304, 'test/acc_skew': 47.914, 'test/acc_align': 84.218}
[15 / 20] best valid accuracy: 68.518 at epoch 15 
 best_stats: {'best_valid_epoch': 15, 'best_valid_valid/acc': 75.044, 'best_valid_valid/acc_unbiased': 68.518, 'best_valid_valid/diff': 35.161, 'best_valid_valid/acc_skew': 50.938, 'best_valid_valid/acc_align': 86.098, 'best_valid_test/acc': 73.953, 'best_valid_test/acc_unbiased': 66.066, 'best_valid_test/diff': 36.304, 'best_valid_test/acc_skew': 47.914, 'best_valid_test/acc_align': 84.218}
[15 / 20] best test accuracy: 67.109 at epoch 12 
 best_stats: {'best_test_epoch': 12, 'best_test_valid/acc': 74.295, 'best_test_valid/acc_unbiased': 67.214, 'best_test_valid/diff': 33.392, 'best_test_valid/acc_skew': 50.518, 'best_test_valid/acc_align': 83.909, 'best_test_test/acc': 74.835, 'best_test_test/acc_unbiased': 67.109, 'best_test_test/diff': 31.82, 'best_test_test/acc_skew': 51.199, 'best_test_test/acc_align': 83.019}
[16 / 20] Learning rate: 1e-05 weight: 0.01
[16 / 20] Loss: 1.6350075289426929 CE Loss: 1.4184164188846509 Con Loss: 1.6208233623274084
[16 / 20] tensor([[0.841, 0.244],
        [0.700, 0.879]]) {'epoch': 16, 'valid/acc': 74.868, 'valid/acc_unbiased': 67.921, 'valid/diff': 37.014, 'valid/acc_skew': 49.414, 'valid/acc_align': 86.428, 'test/acc': 74.35, 'test/acc_unbiased': 66.598, 'test/diff': 38.754, 'test/acc_skew': 47.222, 'test/acc_align': 85.975}
[16 / 20] best valid accuracy: 68.518 at epoch 15 
 best_stats: {'best_valid_epoch': 15, 'best_valid_valid/acc': 75.044, 'best_valid_valid/acc_unbiased': 68.518, 'best_valid_valid/diff': 35.161, 'best_valid_valid/acc_skew': 50.938, 'best_valid_valid/acc_align': 86.098, 'best_valid_test/acc': 73.953, 'best_valid_test/acc_unbiased': 66.066, 'best_valid_test/diff': 36.304, 'best_valid_test/acc_skew': 47.914, 'best_valid_test/acc_align': 84.218}
[16 / 20] best test accuracy: 67.109 at epoch 12 
 best_stats: {'best_test_epoch': 12, 'best_test_valid/acc': 74.295, 'best_test_valid/acc_unbiased': 67.214, 'best_test_valid/diff': 33.392, 'best_test_valid/acc_skew': 50.518, 'best_test_valid/acc_align': 83.909, 'best_test_test/acc': 74.835, 'best_test_test/acc_unbiased': 67.109, 'best_test_test/diff': 31.82, 'best_test_test/acc_skew': 51.199, 'best_test_test/acc_align': 83.019}
[17 / 20] Learning rate: 1e-05 weight: 0.01
[17 / 20] Loss: 1.3938812808628038 CE Loss: 1.5316546412917147 Con Loss: 1.3785647349727859
[17 / 20] tensor([[0.846, 0.256],
        [0.694, 0.861]]) {'epoch': 17, 'valid/acc': 74.956, 'valid/acc_unbiased': 68.489, 'valid/diff': 35.587, 'valid/acc_skew': 50.696, 'valid/acc_align': 86.283, 'test/acc': 74.35, 'test/acc_unbiased': 66.425, 'test/diff': 37.847, 'test/acc_skew': 47.502, 'test/acc_align': 85.349}
[17 / 20] best valid accuracy: 68.518 at epoch 15 
 best_stats: {'best_valid_epoch': 15, 'best_valid_valid/acc': 75.044, 'best_valid_valid/acc_unbiased': 68.518, 'best_valid_valid/diff': 35.161, 'best_valid_valid/acc_skew': 50.938, 'best_valid_valid/acc_align': 86.098, 'best_valid_test/acc': 73.953, 'best_valid_test/acc_unbiased': 66.066, 'best_valid_test/diff': 36.304, 'best_valid_test/acc_skew': 47.914, 'best_valid_test/acc_align': 84.218}
[17 / 20] best test accuracy: 67.109 at epoch 12 
 best_stats: {'best_test_epoch': 12, 'best_test_valid/acc': 74.295, 'best_test_valid/acc_unbiased': 67.214, 'best_test_valid/diff': 33.392, 'best_test_valid/acc_skew': 50.518, 'best_test_valid/acc_align': 83.909, 'best_test_test/acc': 74.835, 'best_test_test/acc_unbiased': 67.109, 'best_test_test/diff': 31.82, 'best_test_test/acc_skew': 51.199, 'best_test_test/acc_align': 83.019}
[18 / 20] Learning rate: 1e-05 weight: 0.01
[18 / 20] Loss: 1.5727577518669462 CE Loss: 1.2157687191053679 Con Loss: 1.560600065984728
[18 / 20] tensor([[0.828, 0.233],
        [0.728, 0.879]]) {'epoch': 18, 'valid/acc': 75.132, 'valid/acc_unbiased': 68.752, 'valid/diff': 37.168, 'valid/acc_skew': 50.168, 'valid/acc_align': 87.336, 'test/acc': 74.747, 'test/acc_unbiased': 66.7, 'test/diff': 37.325, 'test/acc_skew': 48.038, 'test/acc_align': 85.363}
[18 / 20] best valid accuracy: 68.752 at epoch 18 
 best_stats: {'best_valid_epoch': 18, 'best_valid_valid/acc': 75.132, 'best_valid_valid/acc_unbiased': 68.752, 'best_valid_valid/diff': 37.168, 'best_valid_valid/acc_skew': 50.168, 'best_valid_valid/acc_align': 87.336, 'best_valid_test/acc': 74.747, 'best_valid_test/acc_unbiased': 66.7, 'best_valid_test/diff': 37.325, 'best_valid_test/acc_skew': 48.038, 'best_valid_test/acc_align': 85.363}
[18 / 20] best test accuracy: 67.109 at epoch 12 
 best_stats: {'best_test_epoch': 12, 'best_test_valid/acc': 74.295, 'best_test_valid/acc_unbiased': 67.214, 'best_test_valid/diff': 33.392, 'best_test_valid/acc_skew': 50.518, 'best_test_valid/acc_align': 83.909, 'best_test_test/acc': 74.835, 'best_test_test/acc_unbiased': 67.109, 'best_test_test/diff': 31.82, 'best_test_test/acc_skew': 51.199, 'best_test_test/acc_align': 83.019}
[19 / 20] Learning rate: 1e-05 weight: 0.01
[19 / 20] Loss: 1.6799150031747645 CE Loss: 1.2247387496229811 Con Loss: 1.6676676177851515
[19 / 20] tensor([[0.851, 0.256],
        [0.707, 0.879]]) {'epoch': 19, 'valid/acc': 75.088, 'valid/acc_unbiased': 68.27, 'valid/diff': 37.511, 'valid/acc_skew': 49.514, 'valid/acc_align': 87.025, 'test/acc': 75.187, 'test/acc_unbiased': 67.315, 'test/diff': 38.358, 'test/acc_skew': 48.136, 'test/acc_align': 86.494}
[19 / 20] best valid accuracy: 68.752 at epoch 18 
 best_stats: {'best_valid_epoch': 18, 'best_valid_valid/acc': 75.132, 'best_valid_valid/acc_unbiased': 68.752, 'best_valid_valid/diff': 37.168, 'best_valid_valid/acc_skew': 50.168, 'best_valid_valid/acc_align': 87.336, 'best_valid_test/acc': 74.747, 'best_valid_test/acc_unbiased': 66.7, 'best_valid_test/diff': 37.325, 'best_valid_test/acc_skew': 48.038, 'best_valid_test/acc_align': 85.363}
[19 / 20] best test accuracy: 67.315 at epoch 19 
 best_stats: {'best_test_epoch': 19, 'best_test_valid/acc': 75.088, 'best_test_valid/acc_unbiased': 68.27, 'best_test_valid/diff': 37.511, 'best_test_valid/acc_skew': 49.514, 'best_test_valid/acc_align': 87.025, 'best_test_test/acc': 75.187, 'best_test_test/acc_unbiased': 67.315, 'best_test_test/diff': 38.358, 'best_test_test/acc_skew': 48.136, 'best_test_test/acc_align': 86.494}
[20 / 20] Learning rate: 1e-05 weight: 0.01
[20 / 20] Loss: 1.9121521845310347 CE Loss: 1.1417340433663508 Con Loss: 1.9007348447665648
[20 / 20] tensor([[0.839, 0.239],
        [0.723, 0.885]]) {'epoch': 20, 'valid/acc': 75.22, 'valid/acc_unbiased': 68.267, 'valid/diff': 37.818, 'valid/acc_skew': 49.358, 'valid/acc_align': 87.176, 'test/acc': 75.143, 'test/acc_unbiased': 67.137, 'test/diff': 38.093, 'test/acc_skew': 48.091, 'test/acc_align': 86.184}
[20 / 20] best valid accuracy: 68.752 at epoch 18 
 best_stats: {'best_valid_epoch': 18, 'best_valid_valid/acc': 75.132, 'best_valid_valid/acc_unbiased': 68.752, 'best_valid_valid/diff': 37.168, 'best_valid_valid/acc_skew': 50.168, 'best_valid_valid/acc_align': 87.336, 'best_valid_test/acc': 74.747, 'best_valid_test/acc_unbiased': 66.7, 'best_valid_test/diff': 37.325, 'best_valid_test/acc_skew': 48.038, 'best_valid_test/acc_align': 85.363}
[20 / 20] best test accuracy: 67.315 at epoch 19 
 best_stats: {'best_test_epoch': 19, 'best_test_valid/acc': 75.088, 'best_test_valid/acc_unbiased': 68.27, 'best_test_valid/diff': 37.511, 'best_test_valid/acc_skew': 49.514, 'best_test_valid/acc_align': 87.025, 'best_test_test/acc': 75.187, 'best_test_test/acc_unbiased': 67.315, 'best_test_test/diff': 38.358, 'best_test_test/acc_skew': 48.136, 'best_test_test/acc_align': 86.494}
Total training time: 0:49:28
