Log level set to: INFO
Set seed: 3
=======> Using Fixed Random Seed: 3 <========
save_path: exp_results/bc-bb0-utk_face_race-uw-0.997-lr0.001-bs128-cbs64-w0.01-ratio10-aug1-seed3
get_utk_face - split: train, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_race-0.997
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [4407, 16]
Target 1: [13, 5529]
Binary Target 1
---------------------------
Target 0: [4407, 16]
Target 1: [13, 5529]
===================================
Normal Label Distribution: 
Target 0: [4407, 16]
Target 1: [13, 5529]
===================================
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [4407, 16]
Target 1: [13, 5529]
Binary Target 1
---------------------------
Target 0: [4407, 16]
Target 1: [13, 5529]
===================================
Normal Label Distribution: 
Target 0: [4407, 16]
Target 1: [13, 5529]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 9965, target_attr: gender, bias_attr: race bias_rate: 0.997
['[train] target_0-bias_0: 4407', '[train] target_0-bias_1: 16', '[train] target_1-bias_0: 13', '[train] target_1-bias_1: 5529']
confusion_matrix - 
 original: tensor([[4407.,   13.],
        [  16., 5529.]]), 
 normalized: tensor([[0.997, 0.003],
        [0.003, 0.997]]), 
 b|y: tensor([[0.996, 0.004],
        [0.002, 0.998]])
get_utk_face - split: train, aug: 1, given_y: True, ratio: 10
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_race-0.997
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [4407, 16]
Target 1: [13, 5529]
Binary Target 1
---------------------------
Target 0: [4407, 16]
Target 1: [13, 5529]
===================================
Normal Label Distribution: 
Target 0: [4407, 16]
Target 1: [13, 5529]
===================================
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [4407, 16]
Target 1: [13, 5529]
Binary Target 1
---------------------------
Target 0: [4407, 16]
Target 1: [13, 5529]
===================================
Normal Label Distribution: 
Target 0: [4407, 16]
Target 1: [13, 5529]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 9965, target_attr: gender, bias_attr: race bias_rate: 0.997
['[train] target_0-bias_0: 4407', '[train] target_0-bias_1: 16', '[train] target_1-bias_0: 13', '[train] target_1-bias_1: 5529']
get_utk_face - split: valid, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_race-0.997
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [583, 684]
Target 1: [457, 646]
Binary Target 1
---------------------------
Target 0: [583, 684]
Target 1: [457, 646]
===================================
Normal Label Distribution: 
Target 0: [583, 684]
Target 1: [457, 646]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 2370, target_attr: gender, bias_attr: race bias_rate: 0.997
['[valid] target_0-bias_0: 583', '[valid] target_0-bias_1: 684', '[valid] target_1-bias_0: 457', '[valid] target_1-bias_1: 646']
get_utk_face - split: test, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_race-0.997
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [558, 677]
Target 1: [462, 673]
Binary Target 1
---------------------------
Target 0: [558, 677]
Target 1: [462, 673]
===================================
Normal Label Distribution: 
Target 0: [558, 677]
Target 1: [462, 673]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 2370, target_attr: gender, bias_attr: race bias_rate: 0.997
['[test] target_0-bias_0: 558', '[test] target_0-bias_1: 677', '[test] target_1-bias_0: 462', '[test] target_1-bias_1: 673']
decay_epochs: [6, 13]
[1 / 20] Learning rate: 0.001 weight: 0.01
[1 / 20] Loss: 3.017861117840531 CE Loss: 2.8135235427673653 Con Loss: 2.989725881405231
[1 / 20] tensor([[0.013, 0.016],
        [1.000, 0.991]]) {'epoch': 1, 'valid/acc': 46.962, 'valid/acc_unbiased': 50.321, 'valid/diff': 0.785, 'valid/acc_skew': 50.695, 'valid/acc_align': 49.948, 'test/acc': 48.397, 'test/acc_unbiased': 50.497, 'test/diff': 0.631, 'test/acc_skew': 50.812, 'test/acc_align': 50.181}
[1 / 20] best valid accuracy: 50.321 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 46.962, 'best_valid_valid/acc_unbiased': 50.321, 'best_valid_valid/diff': 0.785, 'best_valid_valid/acc_skew': 50.695, 'best_valid_valid/acc_align': 49.948, 'best_valid_test/acc': 48.397, 'best_valid_test/acc_unbiased': 50.497, 'best_valid_test/diff': 0.631, 'best_valid_test/acc_skew': 50.812, 'best_valid_test/acc_align': 50.181}
[1 / 20] best test accuracy: 50.497 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 46.962, 'best_test_valid/acc_unbiased': 50.321, 'best_test_valid/diff': 0.785, 'best_test_valid/acc_skew': 50.695, 'best_test_valid/acc_align': 49.948, 'best_test_test/acc': 48.397, 'best_test_test/acc_unbiased': 50.497, 'best_test_test/diff': 0.631, 'best_test_test/acc_skew': 50.812, 'best_test_test/acc_align': 50.181}
[2 / 20] Learning rate: 0.001 weight: 0.01
[2 / 20] Loss: 2.895574303868199 CE Loss: 2.89701241889433 Con Loss: 2.8666042069484408
[2 / 20] tensor([[0.971, 0.969],
        [0.104, 0.172]]) {'epoch': 2, 'valid/acc': 57.468, 'valid/acc_unbiased': 54.167, 'valid/diff': 3.816, 'valid/acc_skew': 52.258, 'valid/acc_align': 56.075, 'test/acc': 57.468, 'test/acc_unbiased': 55.414, 'test/diff': 3.541, 'test/acc_skew': 53.644, 'test/acc_align': 57.184}
[2 / 20] best valid accuracy: 54.167 at epoch 2 
 best_stats: {'best_valid_epoch': 2, 'best_valid_valid/acc': 57.468, 'best_valid_valid/acc_unbiased': 54.167, 'best_valid_valid/diff': 3.816, 'best_valid_valid/acc_skew': 52.258, 'best_valid_valid/acc_align': 56.075, 'best_valid_test/acc': 57.468, 'best_valid_test/acc_unbiased': 55.414, 'best_valid_test/diff': 3.541, 'best_valid_test/acc_skew': 53.644, 'best_valid_test/acc_align': 57.184}
[2 / 20] best test accuracy: 55.414 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 57.468, 'best_test_valid/acc_unbiased': 54.167, 'best_test_valid/diff': 3.816, 'best_test_valid/acc_skew': 52.258, 'best_test_valid/acc_align': 56.075, 'best_test_test/acc': 57.468, 'best_test_test/acc_unbiased': 55.414, 'best_test_test/diff': 3.541, 'best_test_test/acc_skew': 53.644, 'best_test_test/acc_align': 57.184}
[3 / 20] Learning rate: 0.001 weight: 0.01
[3 / 20] Loss: 2.534944139349957 CE Loss: 2.927076062758963 Con Loss: 2.505673367164868
[3 / 20] tensor([[0.860, 0.882],
        [0.210, 0.285]]) {'epoch': 3, 'valid/acc': 57.553, 'valid/acc_unbiased': 55.032, 'valid/diff': 3.626, 'valid/acc_skew': 53.889, 'valid/acc_align': 56.175, 'test/acc': 57.637, 'test/acc_unbiased': 55.932, 'test/diff': 4.847, 'test/acc_skew': 54.589, 'test/acc_align': 57.275}
[3 / 20] best valid accuracy: 55.032 at epoch 3 
 best_stats: {'best_valid_epoch': 3, 'best_valid_valid/acc': 57.553, 'best_valid_valid/acc_unbiased': 55.032, 'best_valid_valid/diff': 3.626, 'best_valid_valid/acc_skew': 53.889, 'best_valid_valid/acc_align': 56.175, 'best_valid_test/acc': 57.637, 'best_valid_test/acc_unbiased': 55.932, 'best_valid_test/diff': 4.847, 'best_valid_test/acc_skew': 54.589, 'best_valid_test/acc_align': 57.275}
[3 / 20] best test accuracy: 55.932 at epoch 3 
 best_stats: {'best_test_epoch': 3, 'best_test_valid/acc': 57.553, 'best_test_valid/acc_unbiased': 55.032, 'best_test_valid/diff': 3.626, 'best_test_valid/acc_skew': 53.889, 'best_test_valid/acc_align': 56.175, 'best_test_test/acc': 57.637, 'best_test_test/acc_unbiased': 55.932, 'best_test_test/diff': 4.847, 'best_test_test/acc_skew': 54.589, 'best_test_test/acc_align': 57.275}
[4 / 20] Learning rate: 0.001 weight: 0.01
[4 / 20] Loss: 2.6303045917736023 CE Loss: 2.8274796632205907 Con Loss: 2.602029797161158
[4 / 20] tensor([[0.812, 0.787],
        [0.177, 0.467]]) {'epoch': 4, 'valid/acc': 57.089, 'valid/acc_unbiased': 54.523, 'valid/diff': 11.354, 'valid/acc_skew': 48.847, 'valid/acc_align': 60.2, 'test/acc': 58.312, 'test/acc_unbiased': 56.08, 'test/diff': 15.68, 'test/acc_skew': 48.239, 'test/acc_align': 63.92}
[4 / 20] best valid accuracy: 55.032 at epoch 3 
 best_stats: {'best_valid_epoch': 3, 'best_valid_valid/acc': 57.553, 'best_valid_valid/acc_unbiased': 55.032, 'best_valid_valid/diff': 3.626, 'best_valid_valid/acc_skew': 53.889, 'best_valid_valid/acc_align': 56.175, 'best_valid_test/acc': 57.637, 'best_valid_test/acc_unbiased': 55.932, 'best_valid_test/diff': 4.847, 'best_valid_test/acc_skew': 54.589, 'best_valid_test/acc_align': 57.275}
[4 / 20] best test accuracy: 56.080 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 57.089, 'best_test_valid/acc_unbiased': 54.523, 'best_test_valid/diff': 11.354, 'best_test_valid/acc_skew': 48.847, 'best_test_valid/acc_align': 60.2, 'best_test_test/acc': 58.312, 'best_test_test/acc_unbiased': 56.08, 'best_test_test/diff': 15.68, 'best_test_test/acc_skew': 48.239, 'best_test_test/acc_align': 63.92}
[5 / 20] Learning rate: 0.001 weight: 0.01
[5 / 20] Loss: 3.116294892625 CE Loss: 3.272344438095399 Con Loss: 3.0835714529700695
[5 / 20] tensor([[0.950, 0.934],
        [0.110, 0.245]]) {'epoch': 5, 'valid/acc': 58.819, 'valid/acc_unbiased': 55.691, 'valid/diff': 8.115, 'valid/acc_skew': 51.633, 'valid/acc_align': 59.748, 'test/acc': 58.143, 'test/acc_unbiased': 55.973, 'test/diff': 7.554, 'test/acc_skew': 52.196, 'test/acc_align': 59.75}
[5 / 20] best valid accuracy: 55.691 at epoch 5 
 best_stats: {'best_valid_epoch': 5, 'best_valid_valid/acc': 58.819, 'best_valid_valid/acc_unbiased': 55.691, 'best_valid_valid/diff': 8.115, 'best_valid_valid/acc_skew': 51.633, 'best_valid_valid/acc_align': 59.748, 'best_valid_test/acc': 58.143, 'best_valid_test/acc_unbiased': 55.973, 'best_valid_test/diff': 7.554, 'best_valid_test/acc_skew': 52.196, 'best_valid_test/acc_align': 59.75}
[5 / 20] best test accuracy: 56.080 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 57.089, 'best_test_valid/acc_unbiased': 54.523, 'best_test_valid/diff': 11.354, 'best_test_valid/acc_skew': 48.847, 'best_test_valid/acc_align': 60.2, 'best_test_test/acc': 58.312, 'best_test_test/acc_unbiased': 56.08, 'best_test_test/diff': 15.68, 'best_test_test/acc_skew': 48.239, 'best_test_test/acc_align': 63.92}
[6 / 20] Learning rate: 0.001 weight: 0.01
[6 / 20] Loss: 3.068894193199969 CE Loss: 3.517936397232844 Con Loss: 3.033714829170698
[6 / 20] tensor([[0.004, 0.006],
        [0.996, 0.996]]) {'epoch': 6, 'valid/acc': 46.667, 'valid/acc_unbiased': 50.108, 'valid/diff': 0.143, 'valid/acc_skew': 50.037, 'valid/acc_align': 50.18, 'test/acc': 47.932, 'test/acc_unbiased': 50.018, 'test/diff': 0.123, 'test/acc_skew': 50.079, 'test/acc_align': 49.956}
[6 / 20] best valid accuracy: 55.691 at epoch 5 
 best_stats: {'best_valid_epoch': 5, 'best_valid_valid/acc': 58.819, 'best_valid_valid/acc_unbiased': 55.691, 'best_valid_valid/diff': 8.115, 'best_valid_valid/acc_skew': 51.633, 'best_valid_valid/acc_align': 59.748, 'best_valid_test/acc': 58.143, 'best_valid_test/acc_unbiased': 55.973, 'best_valid_test/diff': 7.554, 'best_valid_test/acc_skew': 52.196, 'best_valid_test/acc_align': 59.75}
[6 / 20] best test accuracy: 56.080 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 57.089, 'best_test_valid/acc_unbiased': 54.523, 'best_test_valid/diff': 11.354, 'best_test_valid/acc_skew': 48.847, 'best_test_valid/acc_align': 60.2, 'best_test_test/acc': 58.312, 'best_test_test/acc_unbiased': 56.08, 'best_test_test/diff': 15.68, 'best_test_test/acc_skew': 48.239, 'best_test_test/acc_align': 63.92}
[7 / 20] Learning rate: 0.0001 weight: 0.01
[7 / 20] Loss: 2.7999396251184643 CE Loss: 2.8582151288311506 Con Loss: 2.7713574859286094
[7 / 20] tensor([[0.005, 0.007],
        [0.994, 0.996]]) {'epoch': 7, 'valid/acc': 46.793, 'valid/acc_unbiased': 50.231, 'valid/diff': 0.242, 'valid/acc_skew': 50.11, 'valid/acc_align': 50.351, 'test/acc': 47.975, 'test/acc_unbiased': 50.045, 'test/diff': 0.202, 'test/acc_skew': 50.045, 'test/acc_align': 50.046}
[7 / 20] best valid accuracy: 55.691 at epoch 5 
 best_stats: {'best_valid_epoch': 5, 'best_valid_valid/acc': 58.819, 'best_valid_valid/acc_unbiased': 55.691, 'best_valid_valid/diff': 8.115, 'best_valid_valid/acc_skew': 51.633, 'best_valid_valid/acc_align': 59.748, 'best_valid_test/acc': 58.143, 'best_valid_test/acc_unbiased': 55.973, 'best_valid_test/diff': 7.554, 'best_valid_test/acc_skew': 52.196, 'best_valid_test/acc_align': 59.75}
[7 / 20] best test accuracy: 56.080 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 57.089, 'best_test_valid/acc_unbiased': 54.523, 'best_test_valid/diff': 11.354, 'best_test_valid/acc_skew': 48.847, 'best_test_valid/acc_align': 60.2, 'best_test_test/acc': 58.312, 'best_test_test/acc_unbiased': 56.08, 'best_test_test/diff': 15.68, 'best_test_test/acc_skew': 48.239, 'best_test_test/acc_align': 63.92}
[8 / 20] Learning rate: 0.0001 weight: 0.01
[8 / 20] Loss: 2.98322685743419 CE Loss: 2.7078489655175524 Con Loss: 2.9561483598748346
[8 / 20] tensor([[0.749, 0.749],
        [0.392, 0.495]]) {'epoch': 8, 'valid/acc': 61.519, 'valid/acc_unbiased': 60.092, 'valid/diff': 5.212, 'valid/acc_skew': 58.435, 'valid/acc_align': 61.749, 'test/acc': 60.717, 'test/acc_unbiased': 59.614, 'test/diff': 5.162, 'test/acc_skew': 57.033, 'test/acc_align': 62.195}
[8 / 20] best valid accuracy: 60.092 at epoch 8 
 best_stats: {'best_valid_epoch': 8, 'best_valid_valid/acc': 61.519, 'best_valid_valid/acc_unbiased': 60.092, 'best_valid_valid/diff': 5.212, 'best_valid_valid/acc_skew': 58.435, 'best_valid_valid/acc_align': 61.749, 'best_valid_test/acc': 60.717, 'best_valid_test/acc_unbiased': 59.614, 'best_valid_test/diff': 5.162, 'best_valid_test/acc_skew': 57.033, 'best_valid_test/acc_align': 62.195}
[8 / 20] best test accuracy: 59.614 at epoch 8 
 best_stats: {'best_test_epoch': 8, 'best_test_valid/acc': 61.519, 'best_test_valid/acc_unbiased': 60.092, 'best_test_valid/diff': 5.212, 'best_test_valid/acc_skew': 58.435, 'best_test_valid/acc_align': 61.749, 'best_test_test/acc': 60.717, 'best_test_test/acc_unbiased': 59.614, 'best_test_test/diff': 5.162, 'best_test_test/acc_skew': 57.033, 'best_test_test/acc_align': 62.195}
[9 / 20] Learning rate: 0.0001 weight: 0.01
[9 / 20] Loss: 2.9234109183381802 CE Loss: 2.7099330480889465 Con Loss: 2.896311584717654
[9 / 20] tensor([[0.640, 0.657],
        [0.576, 0.588]]) {'epoch': 9, 'valid/acc': 62.869, 'valid/acc_unbiased': 62.491, 'valid/diff': 1.566, 'valid/acc_skew': 62.327, 'valid/acc_align': 62.654, 'test/acc': 61.772, 'test/acc_unbiased': 61.532, 'test/diff': 1.509, 'test/acc_skew': 61.653, 'test/acc_align': 61.41}
[9 / 20] best valid accuracy: 62.491 at epoch 9 
 best_stats: {'best_valid_epoch': 9, 'best_valid_valid/acc': 62.869, 'best_valid_valid/acc_unbiased': 62.491, 'best_valid_valid/diff': 1.566, 'best_valid_valid/acc_skew': 62.327, 'best_valid_valid/acc_align': 62.654, 'best_valid_test/acc': 61.772, 'best_valid_test/acc_unbiased': 61.532, 'best_valid_test/diff': 1.509, 'best_valid_test/acc_skew': 61.653, 'best_valid_test/acc_align': 61.41}
[9 / 20] best test accuracy: 61.532 at epoch 9 
 best_stats: {'best_test_epoch': 9, 'best_test_valid/acc': 62.869, 'best_test_valid/acc_unbiased': 62.491, 'best_test_valid/diff': 1.566, 'best_test_valid/acc_skew': 62.327, 'best_test_valid/acc_align': 62.654, 'best_test_test/acc': 61.772, 'best_test_test/acc_unbiased': 61.532, 'best_test_test/diff': 1.509, 'best_test_test/acc_skew': 61.653, 'best_test_test/acc_align': 61.41}
[10 / 20] Learning rate: 0.0001 weight: 0.01
[10 / 20] Loss: 2.858437173927602 CE Loss: 2.667521276907052 Con Loss: 2.831761951609227
[10 / 20] tensor([[0.659, 0.690],
        [0.556, 0.563]]) {'epoch': 10, 'valid/acc': 63.249, 'valid/acc_unbiased': 62.885, 'valid/diff': 1.183, 'valid/acc_skew': 63.167, 'valid/acc_align': 62.602, 'test/acc': 62.068, 'test/acc_unbiased': 61.718, 'test/diff': 1.859, 'test/acc_skew': 62.304, 'test/acc_align': 61.132}
[10 / 20] best valid accuracy: 62.885 at epoch 10 
 best_stats: {'best_valid_epoch': 10, 'best_valid_valid/acc': 63.249, 'best_valid_valid/acc_unbiased': 62.885, 'best_valid_valid/diff': 1.183, 'best_valid_valid/acc_skew': 63.167, 'best_valid_valid/acc_align': 62.602, 'best_valid_test/acc': 62.068, 'best_valid_test/acc_unbiased': 61.718, 'best_valid_test/diff': 1.859, 'best_valid_test/acc_skew': 62.304, 'best_valid_test/acc_align': 61.132}
[10 / 20] best test accuracy: 61.718 at epoch 10 
 best_stats: {'best_test_epoch': 10, 'best_test_valid/acc': 63.249, 'best_test_valid/acc_unbiased': 62.885, 'best_test_valid/diff': 1.183, 'best_test_valid/acc_skew': 63.167, 'best_test_valid/acc_align': 62.602, 'best_test_test/acc': 62.068, 'best_test_test/acc_unbiased': 61.718, 'best_test_test/diff': 1.859, 'best_test_test/acc_skew': 62.304, 'best_test_test/acc_align': 61.132}
[11 / 20] Learning rate: 0.0001 weight: 0.01
[11 / 20] Loss: 2.885027520499873 CE Loss: 2.6588306216456696 Con Loss: 2.858439207148803
[11 / 20] tensor([[0.738, 0.753],
        [0.444, 0.527]]) {'epoch': 11, 'valid/acc': 64.135, 'valid/acc_unbiased': 63.113, 'valid/diff': 3.065, 'valid/acc_skew': 62.483, 'valid/acc_align': 63.744, 'test/acc': 62.532, 'test/acc_unbiased': 61.572, 'test/diff': 4.937, 'test/acc_skew': 59.852, 'test/acc_align': 63.292}
[11 / 20] best valid accuracy: 63.113 at epoch 11 
 best_stats: {'best_valid_epoch': 11, 'best_valid_valid/acc': 64.135, 'best_valid_valid/acc_unbiased': 63.113, 'best_valid_valid/diff': 3.065, 'best_valid_valid/acc_skew': 62.483, 'best_valid_valid/acc_align': 63.744, 'best_valid_test/acc': 62.532, 'best_valid_test/acc_unbiased': 61.572, 'best_valid_test/diff': 4.937, 'best_valid_test/acc_skew': 59.852, 'best_valid_test/acc_align': 63.292}
[11 / 20] best test accuracy: 61.718 at epoch 10 
 best_stats: {'best_test_epoch': 10, 'best_test_valid/acc': 63.249, 'best_test_valid/acc_unbiased': 62.885, 'best_test_valid/diff': 1.183, 'best_test_valid/acc_skew': 63.167, 'best_test_valid/acc_align': 62.602, 'best_test_test/acc': 62.068, 'best_test_test/acc_unbiased': 61.718, 'best_test_test/diff': 1.859, 'best_test_test/acc_skew': 62.304, 'best_test_test/acc_align': 61.132}
[12 / 20] Learning rate: 0.0001 weight: 0.01
[12 / 20] Loss: 2.4154057431089417 CE Loss: 2.6019542244170935 Con Loss: 2.3893862159181585
[12 / 20] tensor([[0.591, 0.591],
        [0.623, 0.706]]) {'epoch': 12, 'valid/acc': 62.574, 'valid/acc_unbiased': 62.629, 'valid/diff': 3.044, 'valid/acc_skew': 61.114, 'valid/acc_align': 64.144, 'test/acc': 62.996, 'test/acc_unbiased': 62.785, 'test/diff': 4.149, 'test/acc_skew': 60.711, 'test/acc_align': 64.86}
[12 / 20] best valid accuracy: 63.113 at epoch 11 
 best_stats: {'best_valid_epoch': 11, 'best_valid_valid/acc': 64.135, 'best_valid_valid/acc_unbiased': 63.113, 'best_valid_valid/diff': 3.065, 'best_valid_valid/acc_skew': 62.483, 'best_valid_valid/acc_align': 63.744, 'best_valid_test/acc': 62.532, 'best_valid_test/acc_unbiased': 61.572, 'best_valid_test/diff': 4.937, 'best_valid_test/acc_skew': 59.852, 'best_valid_test/acc_align': 63.292}
[12 / 20] best test accuracy: 62.785 at epoch 12 
 best_stats: {'best_test_epoch': 12, 'best_test_valid/acc': 62.574, 'best_test_valid/acc_unbiased': 62.629, 'best_test_valid/diff': 3.044, 'best_test_valid/acc_skew': 61.114, 'best_test_valid/acc_align': 64.144, 'best_test_test/acc': 62.996, 'best_test_test/acc_unbiased': 62.785, 'best_test_test/diff': 4.149, 'best_test_test/acc_skew': 60.711, 'best_test_test/acc_align': 64.86}
[13 / 20] Learning rate: 0.0001 weight: 0.01
[13 / 20] Loss: 2.990379253237677 CE Loss: 2.5466825977139775 Con Loss: 2.9649124452712483
[13 / 20] tensor([[0.590, 0.517],
        [0.647, 0.709]]) {'epoch': 13, 'valid/acc': 61.055, 'valid/acc_unbiased': 61.582, 'valid/diff': 5.914, 'valid/acc_skew': 58.625, 'valid/acc_align': 64.539, 'test/acc': 61.392, 'test/acc_unbiased': 61.564, 'test/diff': 6.71, 'test/acc_skew': 58.209, 'test/acc_align': 64.919}
[13 / 20] best valid accuracy: 63.113 at epoch 11 
 best_stats: {'best_valid_epoch': 11, 'best_valid_valid/acc': 64.135, 'best_valid_valid/acc_unbiased': 63.113, 'best_valid_valid/diff': 3.065, 'best_valid_valid/acc_skew': 62.483, 'best_valid_valid/acc_align': 63.744, 'best_valid_test/acc': 62.532, 'best_valid_test/acc_unbiased': 61.572, 'best_valid_test/diff': 4.937, 'best_valid_test/acc_skew': 59.852, 'best_valid_test/acc_align': 63.292}
[13 / 20] best test accuracy: 62.785 at epoch 12 
 best_stats: {'best_test_epoch': 12, 'best_test_valid/acc': 62.574, 'best_test_valid/acc_unbiased': 62.629, 'best_test_valid/diff': 3.044, 'best_test_valid/acc_skew': 61.114, 'best_test_valid/acc_align': 64.144, 'best_test_test/acc': 62.996, 'best_test_test/acc_unbiased': 62.785, 'best_test_test/diff': 4.149, 'best_test_test/acc_skew': 60.711, 'best_test_test/acc_align': 64.86}
[14 / 20] Learning rate: 1e-05 weight: 0.01
[14 / 20] Loss: 2.635884163754105 CE Loss: 2.525044333366551 Con Loss: 2.610633722191412
[14 / 20] tensor([[0.649, 0.604],
        [0.580, 0.709]]) {'epoch': 14, 'valid/acc': 64.979, 'valid/acc_unbiased': 64.869, 'valid/diff': 6.629, 'valid/acc_skew': 61.555, 'valid/acc_align': 68.183, 'test/acc': 63.966, 'test/acc_unbiased': 63.543, 'test/diff': 8.664, 'test/acc_skew': 59.211, 'test/acc_align': 67.876}
[14 / 20] best valid accuracy: 64.869 at epoch 14 
 best_stats: {'best_valid_epoch': 14, 'best_valid_valid/acc': 64.979, 'best_valid_valid/acc_unbiased': 64.869, 'best_valid_valid/diff': 6.629, 'best_valid_valid/acc_skew': 61.555, 'best_valid_valid/acc_align': 68.183, 'best_valid_test/acc': 63.966, 'best_valid_test/acc_unbiased': 63.543, 'best_valid_test/diff': 8.664, 'best_valid_test/acc_skew': 59.211, 'best_valid_test/acc_align': 67.876}
[14 / 20] best test accuracy: 63.543 at epoch 14 
 best_stats: {'best_test_epoch': 14, 'best_test_valid/acc': 64.979, 'best_test_valid/acc_unbiased': 64.869, 'best_test_valid/diff': 6.629, 'best_test_valid/acc_skew': 61.555, 'best_test_valid/acc_align': 68.183, 'best_test_test/acc': 63.966, 'best_test_test/acc_unbiased': 63.543, 'best_test_test/diff': 8.664, 'best_test_test/acc_skew': 59.211, 'best_test_test/acc_align': 67.876}
[15 / 20] Learning rate: 1e-05 weight: 0.01
[15 / 20] Loss: 2.6407340620530837 CE Loss: 2.4413053895263173 Con Loss: 2.6163210228107947
[15 / 20] tensor([[0.674, 0.631],
        [0.554, 0.694]]) {'epoch': 15, 'valid/acc': 65.612, 'valid/acc_unbiased': 65.171, 'valid/diff': 8.1, 'valid/acc_skew': 61.12, 'valid/acc_align': 69.221, 'test/acc': 64.388, 'test/acc_unbiased': 63.814, 'test/diff': 9.145, 'test/acc_skew': 59.242, 'test/acc_align': 68.387}
[15 / 20] best valid accuracy: 65.171 at epoch 15 
 best_stats: {'best_valid_epoch': 15, 'best_valid_valid/acc': 65.612, 'best_valid_valid/acc_unbiased': 65.171, 'best_valid_valid/diff': 8.1, 'best_valid_valid/acc_skew': 61.12, 'best_valid_valid/acc_align': 69.221, 'best_valid_test/acc': 64.388, 'best_valid_test/acc_unbiased': 63.814, 'best_valid_test/diff': 9.145, 'best_valid_test/acc_skew': 59.242, 'best_valid_test/acc_align': 68.387}
[15 / 20] best test accuracy: 63.814 at epoch 15 
 best_stats: {'best_test_epoch': 15, 'best_test_valid/acc': 65.612, 'best_test_valid/acc_unbiased': 65.171, 'best_test_valid/diff': 8.1, 'best_test_valid/acc_skew': 61.12, 'best_test_valid/acc_align': 69.221, 'best_test_test/acc': 64.388, 'best_test_test/acc_unbiased': 63.814, 'best_test_test/diff': 9.145, 'best_test_test/acc_skew': 59.242, 'best_test_test/acc_align': 68.387}
[16 / 20] Learning rate: 1e-05 weight: 0.01
[16 / 20] Loss: 2.6444720675941693 CE Loss: 2.446210763039328 Con Loss: 2.6200099611665157
[16 / 20] tensor([[0.633, 0.600],
        [0.591, 0.709]]) {'epoch': 16, 'valid/acc': 64.473, 'valid/acc_unbiased': 64.247, 'valid/diff': 6.04, 'valid/acc_skew': 61.227, 'valid/acc_align': 67.267, 'test/acc': 63.671, 'test/acc_unbiased': 63.3, 'test/diff': 7.538, 'test/acc_skew': 59.531, 'test/acc_align': 67.069}
[16 / 20] best valid accuracy: 65.171 at epoch 15 
 best_stats: {'best_valid_epoch': 15, 'best_valid_valid/acc': 65.612, 'best_valid_valid/acc_unbiased': 65.171, 'best_valid_valid/diff': 8.1, 'best_valid_valid/acc_skew': 61.12, 'best_valid_valid/acc_align': 69.221, 'best_valid_test/acc': 64.388, 'best_valid_test/acc_unbiased': 63.814, 'best_valid_test/diff': 9.145, 'best_valid_test/acc_skew': 59.242, 'best_valid_test/acc_align': 68.387}
[16 / 20] best test accuracy: 63.814 at epoch 15 
 best_stats: {'best_test_epoch': 15, 'best_test_valid/acc': 65.612, 'best_test_valid/acc_unbiased': 65.171, 'best_test_valid/diff': 8.1, 'best_test_valid/acc_skew': 61.12, 'best_test_valid/acc_align': 69.221, 'best_test_test/acc': 64.388, 'best_test_test/acc_unbiased': 63.814, 'best_test_test/diff': 9.145, 'best_test_test/acc_skew': 59.242, 'best_test_test/acc_align': 68.387}
[17 / 20] Learning rate: 1e-05 weight: 0.01
[17 / 20] Loss: 2.394031498974074 CE Loss: 2.466107214340539 Con Loss: 2.3693704226838843
[17 / 20] tensor([[0.663, 0.617],
        [0.593, 0.707]]) {'epoch': 17, 'valid/acc': 65.485, 'valid/acc_unbiased': 65.277, 'valid/diff': 7.223, 'valid/acc_skew': 61.665, 'valid/acc_align': 68.888, 'test/acc': 64.895, 'test/acc_unbiased': 64.522, 'test/diff': 7.993, 'test/acc_skew': 60.525, 'test/acc_align': 68.518}
[17 / 20] best valid accuracy: 65.277 at epoch 17 
 best_stats: {'best_valid_epoch': 17, 'best_valid_valid/acc': 65.485, 'best_valid_valid/acc_unbiased': 65.277, 'best_valid_valid/diff': 7.223, 'best_valid_valid/acc_skew': 61.665, 'best_valid_valid/acc_align': 68.888, 'best_valid_test/acc': 64.895, 'best_valid_test/acc_unbiased': 64.522, 'best_valid_test/diff': 7.993, 'best_valid_test/acc_skew': 60.525, 'best_valid_test/acc_align': 68.518}
[17 / 20] best test accuracy: 64.522 at epoch 17 
 best_stats: {'best_test_epoch': 17, 'best_test_valid/acc': 65.485, 'best_test_valid/acc_unbiased': 65.277, 'best_test_valid/diff': 7.223, 'best_test_valid/acc_skew': 61.665, 'best_test_valid/acc_align': 68.888, 'best_test_test/acc': 64.895, 'best_test_test/acc_unbiased': 64.522, 'best_test_test/diff': 7.993, 'best_test_test/acc_skew': 60.525, 'best_test_test/acc_align': 68.518}
[18 / 20] Learning rate: 1e-05 weight: 0.01
[18 / 20] Loss: 2.6082857544435307 CE Loss: 2.4628446034911406 Con Loss: 2.583657319355537
[18 / 20] tensor([[0.609, 0.591],
        [0.610, 0.738]]) {'epoch': 18, 'valid/acc': 64.937, 'valid/acc_unbiased': 64.862, 'valid/diff': 8.663, 'valid/acc_skew': 60.53, 'valid/acc_align': 69.194, 'test/acc': 64.093, 'test/acc_unbiased': 63.726, 'test/diff': 7.329, 'test/acc_skew': 60.062, 'test/acc_align': 67.39}
[18 / 20] best valid accuracy: 65.277 at epoch 17 
 best_stats: {'best_valid_epoch': 17, 'best_valid_valid/acc': 65.485, 'best_valid_valid/acc_unbiased': 65.277, 'best_valid_valid/diff': 7.223, 'best_valid_valid/acc_skew': 61.665, 'best_valid_valid/acc_align': 68.888, 'best_valid_test/acc': 64.895, 'best_valid_test/acc_unbiased': 64.522, 'best_valid_test/diff': 7.993, 'best_valid_test/acc_skew': 60.525, 'best_valid_test/acc_align': 68.518}
[18 / 20] best test accuracy: 64.522 at epoch 17 
 best_stats: {'best_test_epoch': 17, 'best_test_valid/acc': 65.485, 'best_test_valid/acc_unbiased': 65.277, 'best_test_valid/diff': 7.223, 'best_test_valid/acc_skew': 61.665, 'best_test_valid/acc_align': 68.888, 'best_test_test/acc': 64.895, 'best_test_test/acc_unbiased': 64.522, 'best_test_test/diff': 7.993, 'best_test_test/acc_skew': 60.525, 'best_test_test/acc_align': 68.518}
[19 / 20] Learning rate: 1e-05 weight: 0.01
[19 / 20] Loss: 2.2956110400287457 CE Loss: 2.464205312968138 Con Loss: 2.2709690010733063
[19 / 20] tensor([[0.613, 0.583],
        [0.615, 0.750]]) {'epoch': 19, 'valid/acc': 65.105, 'valid/acc_unbiased': 65.002, 'valid/diff': 8.212, 'valid/acc_skew': 60.896, 'valid/acc_align': 69.108, 'test/acc': 64.388, 'test/acc_unbiased': 64.036, 'test/diff': 8.255, 'test/acc_skew': 59.909, 'test/acc_align': 68.164}
[19 / 20] best valid accuracy: 65.277 at epoch 17 
 best_stats: {'best_valid_epoch': 17, 'best_valid_valid/acc': 65.485, 'best_valid_valid/acc_unbiased': 65.277, 'best_valid_valid/diff': 7.223, 'best_valid_valid/acc_skew': 61.665, 'best_valid_valid/acc_align': 68.888, 'best_valid_test/acc': 64.895, 'best_valid_test/acc_unbiased': 64.522, 'best_valid_test/diff': 7.993, 'best_valid_test/acc_skew': 60.525, 'best_valid_test/acc_align': 68.518}
[19 / 20] best test accuracy: 64.522 at epoch 17 
 best_stats: {'best_test_epoch': 17, 'best_test_valid/acc': 65.485, 'best_test_valid/acc_unbiased': 65.277, 'best_test_valid/diff': 7.223, 'best_test_valid/acc_skew': 61.665, 'best_test_valid/acc_align': 68.888, 'best_test_test/acc': 64.895, 'best_test_test/acc_unbiased': 64.522, 'best_test_test/diff': 7.993, 'best_test_test/acc_skew': 60.525, 'best_test_test/acc_align': 68.518}
[20 / 20] Learning rate: 1e-05 weight: 0.01
[20 / 20] Loss: 2.513487184065643 CE Loss: 2.4361940776889073 Con Loss: 2.489125241816971
[20 / 20] tensor([[0.604, 0.573],
        [0.643, 0.752]]) {'epoch': 20, 'valid/acc': 64.557, 'valid/acc_unbiased': 64.607, 'valid/diff': 7.425, 'valid/acc_skew': 60.894, 'valid/acc_align': 68.319, 'test/acc': 64.473, 'test/acc_unbiased': 64.294, 'test/diff': 6.991, 'test/acc_skew': 60.799, 'test/acc_align': 67.79}
[20 / 20] best valid accuracy: 65.277 at epoch 17 
 best_stats: {'best_valid_epoch': 17, 'best_valid_valid/acc': 65.485, 'best_valid_valid/acc_unbiased': 65.277, 'best_valid_valid/diff': 7.223, 'best_valid_valid/acc_skew': 61.665, 'best_valid_valid/acc_align': 68.888, 'best_valid_test/acc': 64.895, 'best_valid_test/acc_unbiased': 64.522, 'best_valid_test/diff': 7.993, 'best_valid_test/acc_skew': 60.525, 'best_valid_test/acc_align': 68.518}
[20 / 20] best test accuracy: 64.522 at epoch 17 
 best_stats: {'best_test_epoch': 17, 'best_test_valid/acc': 65.485, 'best_test_valid/acc_unbiased': 65.277, 'best_test_valid/diff': 7.223, 'best_test_valid/acc_skew': 61.665, 'best_test_valid/acc_align': 68.888, 'best_test_test/acc': 64.895, 'best_test_test/acc_unbiased': 64.522, 'best_test_test/diff': 7.993, 'best_test_test/acc_skew': 60.525, 'best_test_test/acc_align': 68.518}
Total training time: 0:54:03
