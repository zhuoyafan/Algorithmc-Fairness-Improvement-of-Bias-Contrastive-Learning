Log level set to: INFO
Set seed: 1
=======> Using Fixed Random Seed: 1 <========
save_path: exp_results/bm-celeba_black-test-lr0.001-bs128-seed1
get_celeba - split:train, aug: False, given_y: True, ratio: 0
get_celeba - split:train_valid, aug: False, given_y: True, ratio: 0
get_celeba - split:valid, aug: False, given_y: True, ratio: 0
decay_epochs: [3, 6]
[1 / 10] Learning rate: 0.001
[1 / 10] Loss: 0.2299
[1 / 10] tensor([[0.997, 0.994],
        [0.239, 0.266]]) {'epoch': 1, 'valid/acc': 84.944, 'valid/acc_unbiased': 62.329, 'valid/diff': 0.218, 'valid/acc_skew': 62.426, 'valid/acc_align': 62.233, 'test/acc': 84.109, 'test/acc_unbiased': 62.381, 'test/diff': 1.467, 'test/acc_skew': 61.648, 'test/acc_align': 63.115}
[1 / 10] best valid accuracy: 62.329 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 84.944, 'best_valid_valid/acc_unbiased': 62.329, 'best_valid_valid/diff': 0.218, 'best_valid_valid/acc_skew': 62.426, 'best_valid_valid/acc_align': 62.233, 'best_valid_test/acc': 84.109, 'best_valid_test/acc_unbiased': 62.381, 'best_valid_test/diff': 1.467, 'best_valid_test/acc_skew': 61.648, 'best_valid_test/acc_align': 63.115}
[1 / 10] best test accuracy: 62.381 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 84.944, 'best_test_valid/acc_unbiased': 62.329, 'best_test_valid/diff': 0.218, 'best_test_valid/acc_skew': 62.426, 'best_test_valid/acc_align': 62.233, 'best_test_test/acc': 84.109, 'best_test_test/acc_unbiased': 62.381, 'best_test_test/diff': 1.467, 'best_test_test/acc_skew': 61.648, 'best_test_test/acc_align': 63.115}
[2 / 10] Learning rate: 0.001
[2 / 10] Loss: 0.2146
[2 / 10] tensor([[0.974, 0.970],
        [0.597, 0.510]]) {'epoch': 2, 'valid/acc': 88.756, 'valid/acc_unbiased': 77.379, 'valid/diff': 8.406, 'valid/acc_skew': 81.582, 'valid/acc_align': 73.176, 'test/acc': 88.307, 'test/acc_unbiased': 76.275, 'test/diff': 4.572, 'test/acc_skew': 78.349, 'test/acc_align': 74.2}
[2 / 10] best valid accuracy: 77.379 at epoch 2 
 best_stats: {'best_valid_epoch': 2, 'best_valid_valid/acc': 88.756, 'best_valid_valid/acc_unbiased': 77.379, 'best_valid_valid/diff': 8.406, 'best_valid_valid/acc_skew': 81.582, 'best_valid_valid/acc_align': 73.176, 'best_valid_test/acc': 88.307, 'best_valid_test/acc_unbiased': 76.275, 'best_valid_test/diff': 4.572, 'best_valid_test/acc_skew': 78.349, 'best_valid_test/acc_align': 74.2}
[2 / 10] best test accuracy: 76.275 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 88.756, 'best_test_valid/acc_unbiased': 77.379, 'best_test_valid/diff': 8.406, 'best_test_valid/acc_skew': 81.582, 'best_test_valid/acc_align': 73.176, 'best_test_test/acc': 88.307, 'best_test_test/acc_unbiased': 76.275, 'best_test_test/diff': 4.572, 'best_test_test/acc_skew': 78.349, 'best_test_test/acc_align': 74.2}
[3 / 10] Learning rate: 0.001
[3 / 10] Loss: 0.2102
[3 / 10] tensor([[0.985, 0.964],
        [0.533, 0.505]]) {'epoch': 3, 'valid/acc': 88.743, 'valid/acc_unbiased': 74.452, 'valid/diff': 1.6, 'valid/acc_skew': 74.879, 'valid/acc_align': 74.026, 'test/acc': 88.116, 'test/acc_unbiased': 74.695, 'test/diff': 2.494, 'test/acc_skew': 74.891, 'test/acc_align': 74.498}
[3 / 10] best valid accuracy: 77.379 at epoch 2 
 best_stats: {'best_valid_epoch': 2, 'best_valid_valid/acc': 88.756, 'best_valid_valid/acc_unbiased': 77.379, 'best_valid_valid/diff': 8.406, 'best_valid_valid/acc_skew': 81.582, 'best_valid_valid/acc_align': 73.176, 'best_valid_test/acc': 88.307, 'best_valid_test/acc_unbiased': 76.275, 'best_valid_test/diff': 4.572, 'best_valid_test/acc_skew': 78.349, 'best_valid_test/acc_align': 74.2}
[3 / 10] best test accuracy: 76.275 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 88.756, 'best_test_valid/acc_unbiased': 77.379, 'best_test_valid/diff': 8.406, 'best_test_valid/acc_skew': 81.582, 'best_test_valid/acc_align': 73.176, 'best_test_test/acc': 88.307, 'best_test_test/acc_unbiased': 76.275, 'best_test_test/diff': 4.572, 'best_test_test/acc_skew': 78.349, 'best_test_test/acc_align': 74.2}
[4 / 10] Learning rate: 0.0001
[4 / 10] Loss: 0.1839
[4 / 10] tensor([[0.949, 0.926],
        [0.824, 0.815]]) {'epoch': 4, 'valid/acc': 91.879, 'valid/acc_unbiased': 88.62, 'valid/diff': 4.099, 'valid/acc_skew': 90.419, 'valid/acc_align': 86.821, 'test/acc': 91.493, 'test/acc_unbiased': 87.85, 'test/diff': 1.582, 'test/acc_skew': 87.496, 'test/acc_align': 88.204}
[4 / 10] best valid accuracy: 88.620 at epoch 4 
 best_stats: {'best_valid_epoch': 4, 'best_valid_valid/acc': 91.879, 'best_valid_valid/acc_unbiased': 88.62, 'best_valid_valid/diff': 4.099, 'best_valid_valid/acc_skew': 90.419, 'best_valid_valid/acc_align': 86.821, 'best_valid_test/acc': 91.493, 'best_valid_test/acc_unbiased': 87.85, 'best_valid_test/diff': 1.582, 'best_valid_test/acc_skew': 87.496, 'best_valid_test/acc_align': 88.204}
[4 / 10] best test accuracy: 87.850 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 91.879, 'best_test_valid/acc_unbiased': 88.62, 'best_test_valid/diff': 4.099, 'best_test_valid/acc_skew': 90.419, 'best_test_valid/acc_align': 86.821, 'best_test_test/acc': 91.493, 'best_test_test/acc_unbiased': 87.85, 'best_test_test/diff': 1.582, 'best_test_test/acc_skew': 87.496, 'best_test_test/acc_align': 88.204}
[5 / 10] Learning rate: 0.0001
[5 / 10] Loss: 0.1731
[5 / 10] tensor([[0.945, 0.914],
        [0.837, 0.825]]) {'epoch': 5, 'valid/acc': 92.074, 'valid/acc_unbiased': 90.169, 'valid/diff': 4.715, 'valid/acc_skew': 92.169, 'valid/acc_align': 88.169, 'test/acc': 91.166, 'test/acc_unbiased': 88.04, 'test/diff': 2.088, 'test/acc_skew': 87.574, 'test/acc_align': 88.506}
[5 / 10] best valid accuracy: 90.169 at epoch 5 
 best_stats: {'best_valid_epoch': 5, 'best_valid_valid/acc': 92.074, 'best_valid_valid/acc_unbiased': 90.169, 'best_valid_valid/diff': 4.715, 'best_valid_valid/acc_skew': 92.169, 'best_valid_valid/acc_align': 88.169, 'best_valid_test/acc': 91.166, 'best_valid_test/acc_unbiased': 88.04, 'best_valid_test/diff': 2.088, 'best_valid_test/acc_skew': 87.574, 'best_valid_test/acc_align': 88.506}
[5 / 10] best test accuracy: 88.040 at epoch 5 
 best_stats: {'best_test_epoch': 5, 'best_test_valid/acc': 92.074, 'best_test_valid/acc_unbiased': 90.169, 'best_test_valid/diff': 4.715, 'best_test_valid/acc_skew': 92.169, 'best_test_valid/acc_align': 88.169, 'best_test_test/acc': 91.166, 'best_test_test/acc_unbiased': 88.04, 'best_test_test/diff': 2.088, 'best_test_test/acc_skew': 87.574, 'best_test_test/acc_align': 88.506}
[6 / 10] Learning rate: 0.0001
[6 / 10] Loss: 0.1649
[6 / 10] tensor([[0.963, 0.938],
        [0.756, 0.784]]) {'epoch': 6, 'valid/acc': 92.85, 'valid/acc_unbiased': 89.057, 'valid/diff': 4.955, 'valid/acc_skew': 91.169, 'valid/acc_align': 86.944, 'test/acc': 91.549, 'test/acc_unbiased': 85.997, 'test/diff': 2.682, 'test/acc_skew': 84.656, 'test/acc_align': 87.338}
[6 / 10] best valid accuracy: 90.169 at epoch 5 
 best_stats: {'best_valid_epoch': 5, 'best_valid_valid/acc': 92.074, 'best_valid_valid/acc_unbiased': 90.169, 'best_valid_valid/diff': 4.715, 'best_valid_valid/acc_skew': 92.169, 'best_valid_valid/acc_align': 88.169, 'best_valid_test/acc': 91.166, 'best_valid_test/acc_unbiased': 88.04, 'best_valid_test/diff': 2.088, 'best_valid_test/acc_skew': 87.574, 'best_valid_test/acc_align': 88.506}
[6 / 10] best test accuracy: 88.040 at epoch 5 
 best_stats: {'best_test_epoch': 5, 'best_test_valid/acc': 92.074, 'best_test_valid/acc_unbiased': 90.169, 'best_test_valid/diff': 4.715, 'best_test_valid/acc_skew': 92.169, 'best_test_valid/acc_align': 88.169, 'best_test_test/acc': 91.166, 'best_test_test/acc_unbiased': 88.04, 'best_test_test/diff': 2.088, 'best_test_test/acc_skew': 87.574, 'best_test_test/acc_align': 88.506}
[7 / 10] Learning rate: 1e-05
[7 / 10] Loss: 0.1494
[7 / 10] tensor([[0.946, 0.917],
        [0.821, 0.825]]) {'epoch': 7, 'valid/acc': 92.853, 'valid/acc_unbiased': 91.204, 'valid/diff': 4.848, 'valid/acc_skew': 93.412, 'valid/acc_align': 88.996, 'test/acc': 91.176, 'test/acc_unbiased': 87.718, 'test/diff': 1.65, 'test/acc_skew': 86.893, 'test/acc_align': 88.543}
[7 / 10] best valid accuracy: 91.204 at epoch 7 
 best_stats: {'best_valid_epoch': 7, 'best_valid_valid/acc': 92.853, 'best_valid_valid/acc_unbiased': 91.204, 'best_valid_valid/diff': 4.848, 'best_valid_valid/acc_skew': 93.412, 'best_valid_valid/acc_align': 88.996, 'best_valid_test/acc': 91.176, 'best_valid_test/acc_unbiased': 87.718, 'best_valid_test/diff': 1.65, 'best_valid_test/acc_skew': 86.893, 'best_valid_test/acc_align': 88.543}
[7 / 10] best test accuracy: 88.040 at epoch 5 
 best_stats: {'best_test_epoch': 5, 'best_test_valid/acc': 92.074, 'best_test_valid/acc_unbiased': 90.169, 'best_test_valid/diff': 4.715, 'best_test_valid/acc_skew': 92.169, 'best_test_valid/acc_align': 88.169, 'best_test_test/acc': 91.166, 'best_test_test/acc_unbiased': 88.04, 'best_test_test/diff': 2.088, 'best_test_test/acc_skew': 87.574, 'best_test_test/acc_align': 88.506}
[8 / 10] Learning rate: 1e-05
[8 / 10] Loss: 0.1448
[8 / 10] tensor([[0.952, 0.916],
        [0.809, 0.820]]) {'epoch': 8, 'valid/acc': 93.246, 'valid/acc_unbiased': 91.44, 'valid/diff': 4.853, 'valid/acc_skew': 93.509, 'valid/acc_align': 89.371, 'test/acc': 91.277, 'test/acc_unbiased': 87.428, 'test/diff': 2.351, 'test/acc_skew': 86.253, 'test/acc_align': 88.604}
[8 / 10] best valid accuracy: 91.440 at epoch 8 
 best_stats: {'best_valid_epoch': 8, 'best_valid_valid/acc': 93.246, 'best_valid_valid/acc_unbiased': 91.44, 'best_valid_valid/diff': 4.853, 'best_valid_valid/acc_skew': 93.509, 'best_valid_valid/acc_align': 89.371, 'best_valid_test/acc': 91.277, 'best_valid_test/acc_unbiased': 87.428, 'best_valid_test/diff': 2.351, 'best_valid_test/acc_skew': 86.253, 'best_valid_test/acc_align': 88.604}
[8 / 10] best test accuracy: 88.040 at epoch 5 
 best_stats: {'best_test_epoch': 5, 'best_test_valid/acc': 92.074, 'best_test_valid/acc_unbiased': 90.169, 'best_test_valid/diff': 4.715, 'best_test_valid/acc_skew': 92.169, 'best_test_valid/acc_align': 88.169, 'best_test_test/acc': 91.166, 'best_test_test/acc_unbiased': 88.04, 'best_test_test/diff': 2.088, 'best_test_test/acc_skew': 87.574, 'best_test_test/acc_align': 88.506}
[9 / 10] Learning rate: 1e-05
[9 / 10] Loss: 0.1409
[9 / 10] tensor([[0.952, 0.913],
        [0.797, 0.823]]) {'epoch': 9, 'valid/acc': 93.383, 'valid/acc_unbiased': 91.528, 'valid/diff': 4.161, 'valid/acc_skew': 93.26, 'valid/acc_align': 89.796, 'test/acc': 91.101, 'test/acc_unbiased': 87.115, 'test/diff': 3.199, 'test/acc_skew': 85.515, 'test/acc_align': 88.714}
[9 / 10] best valid accuracy: 91.528 at epoch 9 
 best_stats: {'best_valid_epoch': 9, 'best_valid_valid/acc': 93.383, 'best_valid_valid/acc_unbiased': 91.528, 'best_valid_valid/diff': 4.161, 'best_valid_valid/acc_skew': 93.26, 'best_valid_valid/acc_align': 89.796, 'best_valid_test/acc': 91.101, 'best_valid_test/acc_unbiased': 87.115, 'best_valid_test/diff': 3.199, 'best_valid_test/acc_skew': 85.515, 'best_valid_test/acc_align': 88.714}
[9 / 10] best test accuracy: 88.040 at epoch 5 
 best_stats: {'best_test_epoch': 5, 'best_test_valid/acc': 92.074, 'best_test_valid/acc_unbiased': 90.169, 'best_test_valid/diff': 4.715, 'best_test_valid/acc_skew': 92.169, 'best_test_valid/acc_align': 88.169, 'best_test_test/acc': 91.166, 'best_test_test/acc_unbiased': 88.04, 'best_test_test/diff': 2.088, 'best_test_test/acc_skew': 87.574, 'best_test_test/acc_align': 88.506}
[10 / 10] Learning rate: 1e-05
[10 / 10] Loss: 0.1363
[10 / 10] tensor([[0.957, 0.924],
        [0.769, 0.797]]) {'epoch': 10, 'valid/acc': 93.571, 'valid/acc_unbiased': 91.135, 'valid/diff': 5.0, 'valid/acc_skew': 93.378, 'valid/acc_align': 88.892, 'test/acc': 91.156, 'test/acc_unbiased': 86.204, 'test/diff': 3.031, 'test/acc_skew': 84.688, 'test/acc_align': 87.719}
[10 / 10] best valid accuracy: 91.528 at epoch 9 
 best_stats: {'best_valid_epoch': 9, 'best_valid_valid/acc': 93.383, 'best_valid_valid/acc_unbiased': 91.528, 'best_valid_valid/diff': 4.161, 'best_valid_valid/acc_skew': 93.26, 'best_valid_valid/acc_align': 89.796, 'best_valid_test/acc': 91.101, 'best_valid_test/acc_unbiased': 87.115, 'best_valid_test/diff': 3.199, 'best_valid_test/acc_skew': 85.515, 'best_valid_test/acc_align': 88.714}
[10 / 10] best test accuracy: 88.040 at epoch 5 
 best_stats: {'best_test_epoch': 5, 'best_test_valid/acc': 92.074, 'best_test_valid/acc_unbiased': 90.169, 'best_test_valid/diff': 4.715, 'best_test_valid/acc_skew': 92.169, 'best_test_valid/acc_align': 88.169, 'best_test_test/acc': 91.166, 'best_test_test/acc_unbiased': 88.04, 'best_test_test/diff': 2.088, 'best_test_test/acc_skew': 87.574, 'best_test_test/acc_align': 88.506}
Total training time: 1:01:57
