Log level set to: INFO
Set seed: 3
=======> Using Fixed Random Seed: 3 <========
save_path: exp_results/bc-bb0-celeba_smiling-crop_trival-lr0.001-bs128-cbs64-w0.01-ratio30-aug1-seed3
get_celeba - split:train, aug: False, given_y: True, ratio: 0
use existing smiling indices from data/celeba/pickles/smiling
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [8009, 32847]
Target 1: [40621, 7981]
Binary Target 1
---------------------------
Target 0: [8009, 32847]
Target 1: [40621, 7981]
===================================
Normal Label Distribution: 
Target 0: [8009, 32847]
Target 1: [40621, 7981]
===================================
Use BiasedCelebASplit 
 target_attr: smiling split: train 
 tensor([[ 8009., 40621.],
        [32847.,  7981.]])
get_celeba - split:train, aug: 1, given_y: True, ratio: 30
use existing smiling indices from data/celeba/pickles/smiling
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [8017, 32729]
Target 1: [40802, 7910]
Binary Target 1
---------------------------
Target 0: [8017, 32729]
Target 1: [40802, 7910]
===================================
Normal Label Distribution: 
Target 0: [8017, 32729]
Target 1: [40802, 7910]
===================================
Use BiasedCelebASplit 
 target_attr: smiling split: train 
 tensor([[ 8017., 40802.],
        [32729.,  7910.]])
get_celeba - split:train_valid, aug: False, given_y: True, ratio: 0
use existing smiling indices from data/celeba/pickles/smiling
Use BiasedCelebASplit 
 target_attr: smiling split: train_valid 
 tensor([[ 1944., 10217.],
        [ 8222.,  1982.]])
get_celeba - split:valid, aug: False, given_y: True, ratio: 0
Use BiasedCelebASplit 
 target_attr: smiling split: valid 
 tensor([[5252., 6157.],
        [5013., 3445.]])
decay_epochs: [3, 6]
[1 / 10] Learning rate: 0.001 weight: 0.01
[1 / 10] Loss: 4.713899854986973 CE Loss: 0.26506153093465 Con Loss: 4.711249245098199
[1 / 10] tensor([[0.985, 0.988],
        [0.782, 0.701]]) {'epoch': 1, 'valid/acc': 86.533, 'valid/acc_unbiased': 86.244, 'valid/diff': 3.8, 'valid/acc_skew': 84.344, 'valid/acc_align': 88.144, 'test/acc': 87.331, 'test/acc_unbiased': 86.37, 'test/diff': 4.21, 'test/acc_skew': 84.265, 'test/acc_align': 88.475}
[1 / 10] best valid accuracy: 86.244 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 86.533, 'best_valid_valid/acc_unbiased': 86.244, 'best_valid_valid/diff': 3.8, 'best_valid_valid/acc_skew': 84.344, 'best_valid_valid/acc_align': 88.144, 'best_valid_test/acc': 87.331, 'best_valid_test/acc_unbiased': 86.37, 'best_valid_test/diff': 4.21, 'best_valid_test/acc_skew': 84.265, 'best_valid_test/acc_align': 88.475}
[1 / 10] best test accuracy: 86.370 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 86.533, 'best_test_valid/acc_unbiased': 86.244, 'best_test_valid/diff': 3.8, 'best_test_valid/acc_skew': 84.344, 'best_test_valid/acc_align': 88.144, 'best_test_test/acc': 87.331, 'best_test_test/acc_unbiased': 86.37, 'best_test_test/diff': 4.21, 'best_test_test/acc_skew': 84.265, 'best_test_test/acc_align': 88.475}
[2 / 10] Learning rate: 0.001 weight: 0.01
[2 / 10] Loss: 4.670303826030504 CE Loss: 0.227750258315654 Con Loss: 4.668026319198593
[2 / 10] tensor([[0.915, 0.910],
        [0.929, 0.911]]) {'epoch': 2, 'valid/acc': 91.451, 'valid/acc_unbiased': 91.34, 'valid/diff': 1.492, 'valid/acc_skew': 91.318, 'valid/acc_align': 91.362, 'test/acc': 91.725, 'test/acc_unbiased': 91.618, 'test/diff': 1.087, 'test/acc_skew': 91.308, 'test/acc_align': 91.929}
[2 / 10] best valid accuracy: 91.340 at epoch 2 
 best_stats: {'best_valid_epoch': 2, 'best_valid_valid/acc': 91.451, 'best_valid_valid/acc_unbiased': 91.34, 'best_valid_valid/diff': 1.492, 'best_valid_valid/acc_skew': 91.318, 'best_valid_valid/acc_align': 91.362, 'best_valid_test/acc': 91.725, 'best_valid_test/acc_unbiased': 91.618, 'best_valid_test/diff': 1.087, 'best_valid_test/acc_skew': 91.308, 'best_valid_test/acc_align': 91.929}
[2 / 10] best test accuracy: 91.618 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 91.451, 'best_test_valid/acc_unbiased': 91.34, 'best_test_valid/diff': 1.492, 'best_test_valid/acc_skew': 91.318, 'best_test_valid/acc_align': 91.362, 'best_test_test/acc': 91.725, 'best_test_test/acc_unbiased': 91.618, 'best_test_test/diff': 1.087, 'best_test_test/acc_skew': 91.308, 'best_test_test/acc_align': 91.929}
[3 / 10] Learning rate: 0.001 weight: 0.01
[3 / 10] Loss: 4.660750363961469 CE Loss: 0.21693819358572772 Con Loss: 4.658580983092057
[3 / 10] tensor([[0.972, 0.961],
        [0.866, 0.835]]) {'epoch': 3, 'valid/acc': 90.445, 'valid/acc_unbiased': 90.867, 'valid/diff': 1.165, 'valid/acc_skew': 90.79, 'valid/acc_align': 90.943, 'test/acc': 91.272, 'test/acc_unbiased': 90.863, 'test/diff': 2.095, 'test/acc_skew': 90.381, 'test/acc_align': 91.345}
[3 / 10] best valid accuracy: 91.340 at epoch 2 
 best_stats: {'best_valid_epoch': 2, 'best_valid_valid/acc': 91.451, 'best_valid_valid/acc_unbiased': 91.34, 'best_valid_valid/diff': 1.492, 'best_valid_valid/acc_skew': 91.318, 'best_valid_valid/acc_align': 91.362, 'best_valid_test/acc': 91.725, 'best_valid_test/acc_unbiased': 91.618, 'best_valid_test/diff': 1.087, 'best_valid_test/acc_skew': 91.308, 'best_valid_test/acc_align': 91.929}
[3 / 10] best test accuracy: 91.618 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 91.451, 'best_test_valid/acc_unbiased': 91.34, 'best_test_valid/diff': 1.492, 'best_test_valid/acc_skew': 91.318, 'best_test_valid/acc_align': 91.362, 'best_test_test/acc': 91.725, 'best_test_test/acc_unbiased': 91.618, 'best_test_test/diff': 1.087, 'best_test_test/acc_skew': 91.308, 'best_test_test/acc_align': 91.929}
[4 / 10] Learning rate: 0.0001 weight: 0.01
[4 / 10] Loss: 4.6179958155367915 CE Loss: 0.19019147998609065 Con Loss: 4.616093892319192
[4 / 10] tensor([[0.913, 0.899],
        [0.947, 0.936]]) {'epoch': 4, 'valid/acc': 92.345, 'valid/acc_unbiased': 92.132, 'valid/diff': 1.927, 'valid/acc_skew': 92.149, 'valid/acc_align': 92.114, 'test/acc': 92.389, 'test/acc_unbiased': 92.361, 'test/diff': 1.3, 'test/acc_skew': 92.437, 'test/acc_align': 92.286}
[4 / 10] best valid accuracy: 92.132 at epoch 4 
 best_stats: {'best_valid_epoch': 4, 'best_valid_valid/acc': 92.345, 'best_valid_valid/acc_unbiased': 92.132, 'best_valid_valid/diff': 1.927, 'best_valid_valid/acc_skew': 92.149, 'best_valid_valid/acc_align': 92.114, 'best_valid_test/acc': 92.389, 'best_valid_test/acc_unbiased': 92.361, 'best_valid_test/diff': 1.3, 'best_valid_test/acc_skew': 92.437, 'best_valid_test/acc_align': 92.286}
[4 / 10] best test accuracy: 92.361 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 92.345, 'best_test_valid/acc_unbiased': 92.132, 'best_test_valid/diff': 1.927, 'best_test_valid/acc_skew': 92.149, 'best_test_valid/acc_align': 92.114, 'best_test_test/acc': 92.389, 'best_test_test/acc_unbiased': 92.361, 'best_test_test/diff': 1.3, 'best_test_test/acc_skew': 92.437, 'best_test_test/acc_align': 92.286}
[5 / 10] Learning rate: 0.0001 weight: 0.01
[5 / 10] Loss: 4.599363329499623 CE Loss: 0.184076644785221 Con Loss: 4.597522572360877
[5 / 10] tensor([[0.920, 0.934],
        [0.943, 0.904]]) {'epoch': 5, 'valid/acc': 93.181, 'valid/acc_unbiased': 92.534, 'valid/diff': 1.909, 'valid/acc_skew': 91.579, 'valid/acc_align': 93.488, 'test/acc': 92.762, 'test/acc_unbiased': 92.497, 'test/diff': 2.629, 'test/acc_skew': 91.183, 'test/acc_align': 93.812}
[5 / 10] best valid accuracy: 92.534 at epoch 5 
 best_stats: {'best_valid_epoch': 5, 'best_valid_valid/acc': 93.181, 'best_valid_valid/acc_unbiased': 92.534, 'best_valid_valid/diff': 1.909, 'best_valid_valid/acc_skew': 91.579, 'best_valid_valid/acc_align': 93.488, 'best_valid_test/acc': 92.762, 'best_valid_test/acc_unbiased': 92.497, 'best_valid_test/diff': 2.629, 'best_valid_test/acc_skew': 91.183, 'best_valid_test/acc_align': 93.812}
[5 / 10] best test accuracy: 92.497 at epoch 5 
 best_stats: {'best_test_epoch': 5, 'best_test_valid/acc': 93.181, 'best_test_valid/acc_unbiased': 92.534, 'best_test_valid/diff': 1.909, 'best_test_valid/acc_skew': 91.579, 'best_test_valid/acc_align': 93.488, 'best_test_test/acc': 92.762, 'best_test_test/acc_unbiased': 92.497, 'best_test_test/diff': 2.629, 'best_test_test/acc_skew': 91.183, 'best_test_test/acc_align': 93.812}
[6 / 10] Learning rate: 0.0001 weight: 0.01
[6 / 10] Loss: 4.590346812466324 CE Loss: 0.1807217831837931 Con Loss: 4.588539593048495
[6 / 10] tensor([[0.938, 0.935],
        [0.933, 0.903]]) {'epoch': 6, 'valid/acc': 92.703, 'valid/acc_unbiased': 92.374, 'valid/diff': 1.733, 'valid/acc_skew': 91.842, 'valid/acc_align': 92.906, 'test/acc': 92.968, 'test/acc_unbiased': 92.729, 'test/diff': 1.695, 'test/acc_skew': 92.058, 'test/acc_align': 93.399}
[6 / 10] best valid accuracy: 92.534 at epoch 5 
 best_stats: {'best_valid_epoch': 5, 'best_valid_valid/acc': 93.181, 'best_valid_valid/acc_unbiased': 92.534, 'best_valid_valid/diff': 1.909, 'best_valid_valid/acc_skew': 91.579, 'best_valid_valid/acc_align': 93.488, 'best_valid_test/acc': 92.762, 'best_valid_test/acc_unbiased': 92.497, 'best_valid_test/diff': 2.629, 'best_valid_test/acc_skew': 91.183, 'best_valid_test/acc_align': 93.812}
[6 / 10] best test accuracy: 92.729 at epoch 6 
 best_stats: {'best_test_epoch': 6, 'best_test_valid/acc': 92.703, 'best_test_valid/acc_unbiased': 92.374, 'best_test_valid/diff': 1.733, 'best_test_valid/acc_skew': 91.842, 'best_test_valid/acc_align': 92.906, 'best_test_test/acc': 92.968, 'best_test_test/acc_unbiased': 92.729, 'best_test_test/diff': 1.695, 'best_test_test/acc_skew': 92.058, 'best_test_test/acc_align': 93.399}
[7 / 10] Learning rate: 1e-05 weight: 0.01
[7 / 10] Loss: 4.591256548726249 CE Loss: 0.17876725053027132 Con Loss: 4.589468874163027
[7 / 10] tensor([[0.926, 0.933],
        [0.939, 0.905]]) {'epoch': 7, 'valid/acc': 93.141, 'valid/acc_unbiased': 92.52, 'valid/diff': 1.829, 'valid/acc_skew': 91.606, 'valid/acc_align': 93.435, 'test/acc': 92.812, 'test/acc_unbiased': 92.576, 'test/diff': 2.059, 'test/acc_skew': 91.546, 'test/acc_align': 93.605}
[7 / 10] best valid accuracy: 92.534 at epoch 5 
 best_stats: {'best_valid_epoch': 5, 'best_valid_valid/acc': 93.181, 'best_valid_valid/acc_unbiased': 92.534, 'best_valid_valid/diff': 1.909, 'best_valid_valid/acc_skew': 91.579, 'best_valid_valid/acc_align': 93.488, 'best_valid_test/acc': 92.762, 'best_valid_test/acc_unbiased': 92.497, 'best_valid_test/diff': 2.629, 'best_valid_test/acc_skew': 91.183, 'best_valid_test/acc_align': 93.812}
[7 / 10] best test accuracy: 92.729 at epoch 6 
 best_stats: {'best_test_epoch': 6, 'best_test_valid/acc': 92.703, 'best_test_valid/acc_unbiased': 92.374, 'best_test_valid/diff': 1.733, 'best_test_valid/acc_skew': 91.842, 'best_test_valid/acc_align': 92.906, 'best_test_test/acc': 92.968, 'best_test_test/acc_unbiased': 92.729, 'best_test_test/diff': 1.695, 'best_test_test/acc_skew': 92.058, 'best_test_test/acc_align': 93.399}
[8 / 10] Learning rate: 1e-05 weight: 0.01
[8 / 10] Loss: 4.5876963733494085 CE Loss: 0.17422863217645995 Con Loss: 4.585954084507019
[8 / 10] tensor([[0.927, 0.931],
        [0.940, 0.910]]) {'epoch': 8, 'valid/acc': 93.213, 'valid/acc_unbiased': 92.776, 'valid/diff': 1.229, 'valid/acc_skew': 92.162, 'valid/acc_align': 93.391, 'test/acc': 92.918, 'test/acc_unbiased': 92.709, 'test/diff': 1.68, 'test/acc_skew': 91.869, 'test/acc_align': 93.549}
[8 / 10] best valid accuracy: 92.776 at epoch 8 
 best_stats: {'best_valid_epoch': 8, 'best_valid_valid/acc': 93.213, 'best_valid_valid/acc_unbiased': 92.776, 'best_valid_valid/diff': 1.229, 'best_valid_valid/acc_skew': 92.162, 'best_valid_valid/acc_align': 93.391, 'best_valid_test/acc': 92.918, 'best_valid_test/acc_unbiased': 92.709, 'best_valid_test/diff': 1.68, 'best_valid_test/acc_skew': 91.869, 'best_valid_test/acc_align': 93.549}
[8 / 10] best test accuracy: 92.729 at epoch 6 
 best_stats: {'best_test_epoch': 6, 'best_test_valid/acc': 92.703, 'best_test_valid/acc_unbiased': 92.374, 'best_test_valid/diff': 1.733, 'best_test_valid/acc_skew': 91.842, 'best_test_valid/acc_align': 92.906, 'best_test_test/acc': 92.968, 'best_test_test/acc_unbiased': 92.729, 'best_test_test/diff': 1.695, 'best_test_test/acc_skew': 92.058, 'best_test_test/acc_align': 93.399}
[9 / 10] Learning rate: 1e-05 weight: 0.01
[9 / 10] Loss: 4.578484610310422 CE Loss: 0.17319516910921706 Con Loss: 4.576752643075203
[9 / 10] tensor([[0.926, 0.937],
        [0.941, 0.905]]) {'epoch': 9, 'valid/acc': 93.351, 'valid/acc_unbiased': 92.654, 'valid/diff': 2.104, 'valid/acc_skew': 91.602, 'valid/acc_align': 93.706, 'test/acc': 92.968, 'test/acc_unbiased': 92.716, 'test/diff': 2.332, 'test/acc_skew': 91.551, 'test/acc_align': 93.882}
[9 / 10] best valid accuracy: 92.776 at epoch 8 
 best_stats: {'best_valid_epoch': 8, 'best_valid_valid/acc': 93.213, 'best_valid_valid/acc_unbiased': 92.776, 'best_valid_valid/diff': 1.229, 'best_valid_valid/acc_skew': 92.162, 'best_valid_valid/acc_align': 93.391, 'best_valid_test/acc': 92.918, 'best_valid_test/acc_unbiased': 92.709, 'best_valid_test/diff': 1.68, 'best_valid_test/acc_skew': 91.869, 'best_valid_test/acc_align': 93.549}
[9 / 10] best test accuracy: 92.729 at epoch 6 
 best_stats: {'best_test_epoch': 6, 'best_test_valid/acc': 92.703, 'best_test_valid/acc_unbiased': 92.374, 'best_test_valid/diff': 1.733, 'best_test_valid/acc_skew': 91.842, 'best_test_valid/acc_align': 92.906, 'best_test_test/acc': 92.968, 'best_test_test/acc_unbiased': 92.729, 'best_test_test/diff': 1.695, 'best_test_test/acc_skew': 92.058, 'best_test_test/acc_align': 93.399}
[10 / 10] Learning rate: 1e-05 weight: 0.01
[10 / 10] Loss: 4.579971432949701 CE Loss: 0.172317957226618 Con Loss: 4.578248249586046
[10 / 10] tensor([[0.918, 0.928],
        [0.944, 0.915]]) {'epoch': 10, 'valid/acc': 93.28, 'valid/acc_unbiased': 92.677, 'valid/diff': 1.602, 'valid/acc_skew': 91.876, 'valid/acc_align': 93.478, 'test/acc': 92.797, 'test/acc_unbiased': 92.612, 'test/diff': 1.964, 'test/acc_skew': 91.63, 'test/acc_align': 93.594}
[10 / 10] best valid accuracy: 92.776 at epoch 8 
 best_stats: {'best_valid_epoch': 8, 'best_valid_valid/acc': 93.213, 'best_valid_valid/acc_unbiased': 92.776, 'best_valid_valid/diff': 1.229, 'best_valid_valid/acc_skew': 92.162, 'best_valid_valid/acc_align': 93.391, 'best_valid_test/acc': 92.918, 'best_valid_test/acc_unbiased': 92.709, 'best_valid_test/diff': 1.68, 'best_valid_test/acc_skew': 91.869, 'best_valid_test/acc_align': 93.549}
[10 / 10] best test accuracy: 92.729 at epoch 6 
 best_stats: {'best_test_epoch': 6, 'best_test_valid/acc': 92.703, 'best_test_valid/acc_unbiased': 92.374, 'best_test_valid/diff': 1.733, 'best_test_valid/acc_skew': 91.842, 'best_test_valid/acc_align': 92.906, 'best_test_test/acc': 92.968, 'best_test_test/acc_unbiased': 92.729, 'best_test_test/diff': 1.695, 'best_test_test/acc_skew': 92.058, 'best_test_test/acc_align': 93.399}
Total training time: 1:22:28
