Log level set to: INFO
Set seed: 3
=======> Using Fixed Random Seed: 3 <========
save_path: exp_results/bc-bb0-celeba_blonde-os_0.3-lr0.001-bs128-cbs64-w0.01-ratio30-aug1-seed3
get_celeba - split:train, aug: False, given_y: True, ratio: 0
use existing blonde indices from data/celeba/pickles/blonde
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [16045, 16045]
Target 1: [16045, 16045]
Binary Target 1
---------------------------
Target 0: [16045, 16045]
Target 1: [16045, 16045]
===================================
Normal Label Distribution: 
Target 0: [16045, 16045]
Target 1: [16045, 16045]
===================================
Use BiasedCelebASplit 
 target_attr: blonde split: train 
 tensor([[16045., 16045.],
        [16045., 16045.]])
get_celeba - split:train, aug: 1, given_y: True, ratio: 30
use existing blonde indices from data/celeba/pickles/blonde
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [16052, 16052]
Target 1: [16052, 16052]
Binary Target 1
---------------------------
Target 0: [16052, 16052]
Target 1: [16052, 16052]
===================================
Normal Label Distribution: 
Target 0: [16052, 16052]
Target 1: [16052, 16052]
===================================
Use BiasedCelebASplit 
 target_attr: blonde split: train 
 tensor([[16052., 16052.],
        [16052., 16052.]])
get_celeba - split:train_valid, aug: False, given_y: True, ratio: 0
use existing blonde indices from data/celeba/pickles/blonde
Use BiasedCelebASplit 
 target_attr: blonde split: train_valid 
 tensor([[  386.,  4517.],
        [13446.,   280.]])
get_celeba - split:valid, aug: False, given_y: True, ratio: 0
Use BiasedCelebASplit 
 target_attr: blonde split: valid 
 tensor([[8535., 2874.],
        [8276.,  182.]])
decay_epochs: [3, 6]
[1 / 10] Learning rate: 0.001 weight: 0.01
[1 / 10] Loss: 4.645563927629945 CE Loss: 0.2648412121460422 Con Loss: 4.64291551339734
[1 / 10] tensor([[0.851, 0.897],
        [0.956, 0.934]]) {'epoch': 1, 'valid/acc': 90.789, 'valid/acc_unbiased': 91.758, 'valid/diff': 1.956, 'valid/acc_skew': 92.736, 'valid/acc_align': 90.78, 'test/acc': 88.599, 'test/acc_unbiased': 90.941, 'test/diff': 3.368, 'test/acc_skew': 90.345, 'test/acc_align': 91.538}
[1 / 10] best valid accuracy: 91.758 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 90.789, 'best_valid_valid/acc_unbiased': 91.758, 'best_valid_valid/diff': 1.956, 'best_valid_valid/acc_skew': 92.736, 'best_valid_valid/acc_align': 90.78, 'best_valid_test/acc': 88.599, 'best_valid_test/acc_unbiased': 90.941, 'best_valid_test/diff': 3.368, 'best_valid_test/acc_skew': 90.345, 'best_valid_test/acc_align': 91.538}
[1 / 10] best test accuracy: 90.941 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 90.789, 'best_test_valid/acc_unbiased': 91.758, 'best_test_valid/diff': 1.956, 'best_test_valid/acc_skew': 92.736, 'best_test_valid/acc_align': 90.78, 'best_test_test/acc': 88.599, 'best_test_test/acc_unbiased': 90.941, 'best_test_test/diff': 3.368, 'best_test_test/acc_skew': 90.345, 'best_test_test/acc_align': 91.538}
[2 / 10] Learning rate: 0.001 weight: 0.01
[2 / 10] Loss: 4.6014245314700615 CE Loss: 0.23474426363702502 Con Loss: 4.599077087074249
[2 / 10] tensor([[0.869, 0.945],
        [0.929, 0.846]]) {'epoch': 2, 'valid/acc': 93.306, 'valid/acc_unbiased': 91.223, 'valid/diff': 4.578, 'valid/acc_skew': 93.512, 'valid/acc_align': 88.934, 'test/acc': 90.905, 'test/acc_unbiased': 89.718, 'test/diff': 7.897, 'test/acc_skew': 89.896, 'test/acc_align': 89.541}
[2 / 10] best valid accuracy: 91.758 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 90.789, 'best_valid_valid/acc_unbiased': 91.758, 'best_valid_valid/diff': 1.956, 'best_valid_valid/acc_skew': 92.736, 'best_valid_valid/acc_align': 90.78, 'best_valid_test/acc': 88.599, 'best_valid_test/acc_unbiased': 90.941, 'best_valid_test/diff': 3.368, 'best_valid_test/acc_skew': 90.345, 'best_valid_test/acc_align': 91.538}
[2 / 10] best test accuracy: 90.941 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 90.789, 'best_test_valid/acc_unbiased': 91.758, 'best_test_valid/diff': 1.956, 'best_test_valid/acc_skew': 92.736, 'best_test_valid/acc_align': 90.78, 'best_test_test/acc': 88.599, 'best_test_test/acc_unbiased': 90.941, 'best_test_test/diff': 3.368, 'best_test_test/acc_skew': 90.345, 'best_test_test/acc_align': 91.538}
[3 / 10] Learning rate: 0.001 weight: 0.01
[3 / 10] Loss: 4.584017634607245 CE Loss: 0.21916052151428422 Con Loss: 4.5818260290051365
[3 / 10] tensor([[0.812, 0.929],
        [0.974, 0.918]]) {'epoch': 3, 'valid/acc': 92.925, 'valid/acc_unbiased': 91.842, 'valid/diff': 5.182, 'valid/acc_skew': 93.024, 'valid/acc_align': 90.66, 'test/acc': 88.524, 'test/acc_unbiased': 90.813, 'test/diff': 8.649, 'test/acc_skew': 89.287, 'test/acc_align': 92.339}
[3 / 10] best valid accuracy: 91.842 at epoch 3 
 best_stats: {'best_valid_epoch': 3, 'best_valid_valid/acc': 92.925, 'best_valid_valid/acc_unbiased': 91.842, 'best_valid_valid/diff': 5.182, 'best_valid_valid/acc_skew': 93.024, 'best_valid_valid/acc_align': 90.66, 'best_valid_test/acc': 88.524, 'best_valid_test/acc_unbiased': 90.813, 'best_valid_test/diff': 8.649, 'best_valid_test/acc_skew': 89.287, 'best_valid_test/acc_align': 92.339}
[3 / 10] best test accuracy: 90.941 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 90.789, 'best_test_valid/acc_unbiased': 91.758, 'best_test_valid/diff': 1.956, 'best_test_valid/acc_skew': 92.736, 'best_test_valid/acc_align': 90.78, 'best_test_test/acc': 88.599, 'best_test_test/acc_unbiased': 90.941, 'best_test_test/diff': 3.368, 'best_test_test/acc_skew': 90.345, 'best_test_test/acc_align': 91.538}
[4 / 10] Learning rate: 0.0001 weight: 0.01
[4 / 10] Loss: 4.510616810740099 CE Loss: 0.176974531689159 Con Loss: 4.508847063105587
[4 / 10] tensor([[0.866, 0.939],
        [0.953, 0.923]]) {'epoch': 4, 'valid/acc': 93.779, 'valid/acc_unbiased': 94.56, 'valid/diff': 2.897, 'valid/acc_skew': 96.009, 'valid/acc_align': 93.112, 'test/acc': 90.965, 'test/acc_unbiased': 92.035, 'test/diff': 5.143, 'test/acc_skew': 90.961, 'test/acc_align': 93.109}
[4 / 10] best valid accuracy: 94.560 at epoch 4 
 best_stats: {'best_valid_epoch': 4, 'best_valid_valid/acc': 93.779, 'best_valid_valid/acc_unbiased': 94.56, 'best_valid_valid/diff': 2.897, 'best_valid_valid/acc_skew': 96.009, 'best_valid_valid/acc_align': 93.112, 'best_valid_test/acc': 90.965, 'best_valid_test/acc_unbiased': 92.035, 'best_valid_test/diff': 5.143, 'best_valid_test/acc_skew': 90.961, 'best_valid_test/acc_align': 93.109}
[4 / 10] best test accuracy: 92.035 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 93.779, 'best_test_valid/acc_unbiased': 94.56, 'best_test_valid/diff': 2.897, 'best_test_valid/acc_skew': 96.009, 'best_test_valid/acc_align': 93.112, 'best_test_test/acc': 90.965, 'best_test_test/acc_unbiased': 92.035, 'best_test_test/diff': 5.143, 'best_test_test/acc_skew': 90.961, 'best_test_test/acc_align': 93.109}
[5 / 10] Learning rate: 0.0001 weight: 0.01
[5 / 10] Loss: 4.480376124775792 CE Loss: 0.16463996411930107 Con Loss: 4.478729725329814
[5 / 10] tensor([[0.851, 0.938],
        [0.961, 0.934]]) {'epoch': 5, 'valid/acc': 93.832, 'valid/acc_unbiased': 95.077, 'valid/diff': 3.736, 'valid/acc_skew': 96.945, 'valid/acc_align': 93.208, 'test/acc': 90.406, 'test/acc_unbiased': 92.111, 'test/diff': 5.671, 'test/acc_skew': 90.623, 'test/acc_align': 93.598}
[5 / 10] best valid accuracy: 95.077 at epoch 5 
 best_stats: {'best_valid_epoch': 5, 'best_valid_valid/acc': 93.832, 'best_valid_valid/acc_unbiased': 95.077, 'best_valid_valid/diff': 3.736, 'best_valid_valid/acc_skew': 96.945, 'best_valid_valid/acc_align': 93.208, 'best_valid_test/acc': 90.406, 'best_valid_test/acc_unbiased': 92.111, 'best_valid_test/diff': 5.671, 'best_valid_test/acc_skew': 90.623, 'best_valid_test/acc_align': 93.598}
[5 / 10] best test accuracy: 92.111 at epoch 5 
 best_stats: {'best_test_epoch': 5, 'best_test_valid/acc': 93.832, 'best_test_valid/acc_unbiased': 95.077, 'best_test_valid/diff': 3.736, 'best_test_valid/acc_skew': 96.945, 'best_test_valid/acc_align': 93.208, 'best_test_test/acc': 90.406, 'best_test_test/acc_unbiased': 92.111, 'best_test_test/diff': 5.671, 'best_test_test/acc_skew': 90.623, 'best_test_test/acc_align': 93.598}
[6 / 10] Learning rate: 0.0001 weight: 0.01
[6 / 10] Loss: 4.465448145927318 CE Loss: 0.15664090517990759 Con Loss: 4.4638817292650605
[6 / 10] tensor([[0.869, 0.941],
        [0.955, 0.929]]) {'epoch': 6, 'valid/acc': 94.181, 'valid/acc_unbiased': 95.545, 'valid/diff': 3.074, 'valid/acc_skew': 97.082, 'valid/acc_align': 94.008, 'test/acc': 91.201, 'test/acc_unbiased': 92.349, 'test/diff': 4.928, 'test/acc_skew': 91.229, 'test/acc_align': 93.468}
[6 / 10] best valid accuracy: 95.545 at epoch 6 
 best_stats: {'best_valid_epoch': 6, 'best_valid_valid/acc': 94.181, 'best_valid_valid/acc_unbiased': 95.545, 'best_valid_valid/diff': 3.074, 'best_valid_valid/acc_skew': 97.082, 'best_valid_valid/acc_align': 94.008, 'best_valid_test/acc': 91.201, 'best_valid_test/acc_unbiased': 92.349, 'best_valid_test/diff': 4.928, 'best_valid_test/acc_skew': 91.229, 'best_valid_test/acc_align': 93.468}
[6 / 10] best test accuracy: 92.349 at epoch 6 
 best_stats: {'best_test_epoch': 6, 'best_test_valid/acc': 94.181, 'best_test_valid/acc_unbiased': 95.545, 'best_test_valid/diff': 3.074, 'best_test_valid/acc_skew': 97.082, 'best_test_valid/acc_align': 94.008, 'best_test_test/acc': 91.201, 'best_test_test/acc_unbiased': 92.349, 'best_test_test/diff': 4.928, 'best_test_test/acc_skew': 91.229, 'best_test_test/acc_align': 93.468}
[7 / 10] Learning rate: 1e-05 weight: 0.01
[7 / 10] Loss: 4.449527952491995 CE Loss: 0.14658156248937332 Con Loss: 4.448062135750499
[7 / 10] tensor([[0.855, 0.941],
        [0.965, 0.918]]) {'epoch': 7, 'valid/acc': 94.401, 'valid/acc_unbiased': 95.247, 'valid/diff': 3.475, 'valid/acc_skew': 96.984, 'valid/acc_align': 93.51, 'test/acc': 90.748, 'test/acc_unbiased': 91.972, 'test/diff': 6.645, 'test/acc_skew': 91.014, 'test/acc_align': 92.931}
[7 / 10] best valid accuracy: 95.545 at epoch 6 
 best_stats: {'best_valid_epoch': 6, 'best_valid_valid/acc': 94.181, 'best_valid_valid/acc_unbiased': 95.545, 'best_valid_valid/diff': 3.074, 'best_valid_valid/acc_skew': 97.082, 'best_valid_valid/acc_align': 94.008, 'best_valid_test/acc': 91.201, 'best_valid_test/acc_unbiased': 92.349, 'best_valid_test/diff': 4.928, 'best_valid_test/acc_skew': 91.229, 'best_valid_test/acc_align': 93.468}
[7 / 10] best test accuracy: 92.349 at epoch 6 
 best_stats: {'best_test_epoch': 6, 'best_test_valid/acc': 94.181, 'best_test_valid/acc_unbiased': 95.545, 'best_test_valid/diff': 3.074, 'best_test_valid/acc_skew': 97.082, 'best_test_valid/acc_align': 94.008, 'best_test_test/acc': 91.201, 'best_test_test/acc_unbiased': 92.349, 'best_test_test/diff': 4.928, 'best_test_test/acc_skew': 91.229, 'best_test_test/acc_align': 93.468}
[8 / 10] Learning rate: 1e-05 weight: 0.01
[8 / 10] Loss: 4.442909458442134 CE Loss: 0.1445591436494136 Con Loss: 4.441463858347959
[8 / 10] tensor([[0.847, 0.942],
        [0.966, 0.934]]) {'epoch': 8, 'valid/acc': 94.557, 'valid/acc_unbiased': 95.447, 'valid/diff': 3.429, 'valid/acc_skew': 97.162, 'valid/acc_align': 93.733, 'test/acc': 90.436, 'test/acc_unbiased': 92.218, 'test/diff': 6.354, 'test/acc_skew': 90.65, 'test/acc_align': 93.785}
[8 / 10] best valid accuracy: 95.545 at epoch 6 
 best_stats: {'best_valid_epoch': 6, 'best_valid_valid/acc': 94.181, 'best_valid_valid/acc_unbiased': 95.545, 'best_valid_valid/diff': 3.074, 'best_valid_valid/acc_skew': 97.082, 'best_valid_valid/acc_align': 94.008, 'best_valid_test/acc': 91.201, 'best_valid_test/acc_unbiased': 92.349, 'best_valid_test/diff': 4.928, 'best_valid_test/acc_skew': 91.229, 'best_valid_test/acc_align': 93.468}
[8 / 10] best test accuracy: 92.349 at epoch 6 
 best_stats: {'best_test_epoch': 6, 'best_test_valid/acc': 94.181, 'best_test_valid/acc_unbiased': 95.545, 'best_test_valid/diff': 3.074, 'best_test_valid/acc_skew': 97.082, 'best_test_valid/acc_align': 94.008, 'best_test_test/acc': 91.201, 'best_test_test/acc_unbiased': 92.349, 'best_test_test/diff': 4.928, 'best_test_test/acc_skew': 91.229, 'best_test_test/acc_align': 93.468}
[9 / 10] Learning rate: 1e-05 weight: 0.01
[9 / 10] Loss: 4.440509880365483 CE Loss: 0.1447726451122861 Con Loss: 4.439062147446606
[9 / 10] tensor([[0.846, 0.939],
        [0.965, 0.912]]) {'epoch': 9, 'valid/acc': 94.331, 'valid/acc_unbiased': 95.659, 'valid/diff': 3.457, 'valid/acc_skew': 97.387, 'valid/acc_align': 93.93, 'test/acc': 90.265, 'test/acc_unbiased': 91.561, 'test/diff': 7.297, 'test/acc_skew': 90.568, 'test/acc_align': 92.553}
[9 / 10] best valid accuracy: 95.659 at epoch 9 
 best_stats: {'best_valid_epoch': 9, 'best_valid_valid/acc': 94.331, 'best_valid_valid/acc_unbiased': 95.659, 'best_valid_valid/diff': 3.457, 'best_valid_valid/acc_skew': 97.387, 'best_valid_valid/acc_align': 93.93, 'best_valid_test/acc': 90.265, 'best_valid_test/acc_unbiased': 91.561, 'best_valid_test/diff': 7.297, 'best_valid_test/acc_skew': 90.568, 'best_valid_test/acc_align': 92.553}
[9 / 10] best test accuracy: 92.349 at epoch 6 
 best_stats: {'best_test_epoch': 6, 'best_test_valid/acc': 94.181, 'best_test_valid/acc_unbiased': 95.545, 'best_test_valid/diff': 3.074, 'best_test_valid/acc_skew': 97.082, 'best_test_valid/acc_align': 94.008, 'best_test_test/acc': 91.201, 'best_test_test/acc_unbiased': 92.349, 'best_test_test/diff': 4.928, 'best_test_test/acc_skew': 91.229, 'best_test_test/acc_align': 93.468}
[10 / 10] Learning rate: 1e-05 weight: 0.01
[10 / 10] Loss: 4.431106638024254 CE Loss: 0.1419904243476148 Con Loss: 4.429686735634047
[10 / 10] tensor([[0.842, 0.938],
        [0.965, 0.940]]) {'epoch': 10, 'valid/acc': 94.278, 'valid/acc_unbiased': 95.75, 'valid/diff': 3.408, 'valid/acc_skew': 97.454, 'valid/acc_align': 94.045, 'test/acc': 90.044, 'test/acc_unbiased': 92.103, 'test/diff': 6.079, 'test/acc_skew': 90.346, 'test/acc_align': 93.861}
[10 / 10] best valid accuracy: 95.750 at epoch 10 
 best_stats: {'best_valid_epoch': 10, 'best_valid_valid/acc': 94.278, 'best_valid_valid/acc_unbiased': 95.75, 'best_valid_valid/diff': 3.408, 'best_valid_valid/acc_skew': 97.454, 'best_valid_valid/acc_align': 94.045, 'best_valid_test/acc': 90.044, 'best_valid_test/acc_unbiased': 92.103, 'best_valid_test/diff': 6.079, 'best_valid_test/acc_skew': 90.346, 'best_valid_test/acc_align': 93.861}
[10 / 10] best test accuracy: 92.349 at epoch 6 
 best_stats: {'best_test_epoch': 6, 'best_test_valid/acc': 94.181, 'best_test_valid/acc_unbiased': 95.545, 'best_test_valid/diff': 3.074, 'best_test_valid/acc_skew': 97.082, 'best_test_valid/acc_align': 94.008, 'best_test_test/acc': 91.201, 'best_test_test/acc_unbiased': 92.349, 'best_test_test/diff': 4.928, 'best_test_test/acc_skew': 91.229, 'best_test_test/acc_align': 93.468}
Total training time: 0:58:43
