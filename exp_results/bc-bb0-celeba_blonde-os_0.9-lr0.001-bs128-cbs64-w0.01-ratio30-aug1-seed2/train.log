Log level set to: INFO
Set seed: 2
=======> Using Fixed Random Seed: 2 <========
save_path: exp_results/bc-bb0-celeba_blonde-os_0.9-lr0.001-bs128-cbs64-w0.01-ratio30-aug1-seed2
get_celeba - split:train, aug: False, given_y: True, ratio: 0
use existing blonde indices from data/celeba/pickles/blonde
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [48198, 48198]
Target 1: [48198, 48198]
Binary Target 1
---------------------------
Target 0: [48198, 48198]
Target 1: [48198, 48198]
===================================
Normal Label Distribution: 
Target 0: [48198, 48198]
Target 1: [48198, 48198]
===================================
Use BiasedCelebASplit 
 target_attr: blonde split: train 
 tensor([[48198., 48198.],
        [48198., 48198.]])
get_celeba - split:train, aug: 1, given_y: True, ratio: 30
use existing blonde indices from data/celeba/pickles/blonde
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [48126, 48126]
Target 1: [48126, 48126]
Binary Target 1
---------------------------
Target 0: [48126, 48126]
Target 1: [48126, 48126]
===================================
Normal Label Distribution: 
Target 0: [48126, 48126]
Target 1: [48126, 48126]
===================================
Use BiasedCelebASplit 
 target_attr: blonde split: train 
 tensor([[48126., 48126.],
        [48126., 48126.]])
get_celeba - split:train_valid, aug: False, given_y: True, ratio: 0
use existing blonde indices from data/celeba/pickles/blonde
Use BiasedCelebASplit 
 target_attr: blonde split: train_valid 
 tensor([[  403.,  4597.],
        [13344.,   285.]])
get_celeba - split:valid, aug: False, given_y: True, ratio: 0
Use BiasedCelebASplit 
 target_attr: blonde split: valid 
 tensor([[8535., 2874.],
        [8276.,  182.]])
decay_epochs: [3, 6]
[1 / 10] Learning rate: 0.001 weight: 0.01
[1 / 10] Loss: 4.610730471306903 CE Loss: 0.235650513187138 Con Loss: 4.608373970583547
[1 / 10] tensor([[0.785, 0.879],
        [0.980, 0.940]]) {'epoch': 1, 'valid/acc': 89.951, 'valid/acc_unbiased': 91.828, 'valid/diff': 1.206, 'valid/acc_skew': 91.575, 'valid/acc_align': 92.081, 'test/acc': 85.368, 'test/acc_unbiased': 89.585, 'test/diff': 6.703, 'test/acc_skew': 88.264, 'test/acc_align': 90.906}
[1 / 10] best valid accuracy: 91.828 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 89.951, 'best_valid_valid/acc_unbiased': 91.828, 'best_valid_valid/diff': 1.206, 'best_valid_valid/acc_skew': 91.575, 'best_valid_valid/acc_align': 92.081, 'best_valid_test/acc': 85.368, 'best_valid_test/acc_unbiased': 89.585, 'best_valid_test/diff': 6.703, 'best_valid_test/acc_skew': 88.264, 'best_valid_test/acc_align': 90.906}
[1 / 10] best test accuracy: 89.585 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 89.951, 'best_test_valid/acc_unbiased': 91.828, 'best_test_valid/diff': 1.206, 'best_test_valid/acc_skew': 91.575, 'best_test_valid/acc_align': 92.081, 'best_test_test/acc': 85.368, 'best_test_test/acc_unbiased': 89.585, 'best_test_test/diff': 6.703, 'best_test_test/acc_skew': 88.264, 'best_test_test/acc_align': 90.906}
[2 / 10] Learning rate: 0.001 weight: 0.01
[2 / 10] Loss: 4.55857268129277 CE Loss: 0.1960540808698014 Con Loss: 4.556612139426058
[2 / 10] tensor([[0.876, 0.946],
        [0.949, 0.907]]) {'epoch': 2, 'valid/acc': 94.144, 'valid/acc_unbiased': 94.534, 'valid/diff': 0.692, 'valid/acc_skew': 94.88, 'valid/acc_align': 94.188, 'test/acc': 91.609, 'test/acc_unbiased': 91.937, 'test/diff': 5.575, 'test/acc_skew': 91.245, 'test/acc_align': 92.629}
[2 / 10] best valid accuracy: 94.534 at epoch 2 
 best_stats: {'best_valid_epoch': 2, 'best_valid_valid/acc': 94.144, 'best_valid_valid/acc_unbiased': 94.534, 'best_valid_valid/diff': 0.692, 'best_valid_valid/acc_skew': 94.88, 'best_valid_valid/acc_align': 94.188, 'best_valid_test/acc': 91.609, 'best_valid_test/acc_unbiased': 91.937, 'best_valid_test/diff': 5.575, 'best_valid_test/acc_skew': 91.245, 'best_valid_test/acc_align': 92.629}
[2 / 10] best test accuracy: 91.937 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 94.144, 'best_test_valid/acc_unbiased': 94.534, 'best_test_valid/diff': 0.692, 'best_test_valid/acc_skew': 94.88, 'best_test_valid/acc_align': 94.188, 'best_test_test/acc': 91.609, 'best_test_test/acc_unbiased': 91.937, 'best_test_test/diff': 5.575, 'best_test_test/acc_skew': 91.245, 'best_test_test/acc_align': 92.629}
[3 / 10] Learning rate: 0.001 weight: 0.01
[3 / 10] Loss: 4.526431921641507 CE Loss: 0.18026407695374572 Con Loss: 4.524629285372245
[3 / 10] tensor([[0.750, 0.901],
        [0.983, 0.912]]) {'epoch': 3, 'valid/acc': 92.131, 'valid/acc_unbiased': 92.311, 'valid/diff': 3.806, 'valid/acc_skew': 90.941, 'valid/acc_align': 93.68, 'test/acc': 84.819, 'test/acc_unbiased': 88.652, 'test/diff': 11.097, 'test/acc_skew': 86.629, 'test/acc_align': 90.674}
[3 / 10] best valid accuracy: 94.534 at epoch 2 
 best_stats: {'best_valid_epoch': 2, 'best_valid_valid/acc': 94.144, 'best_valid_valid/acc_unbiased': 94.534, 'best_valid_valid/diff': 0.692, 'best_valid_valid/acc_skew': 94.88, 'best_valid_valid/acc_align': 94.188, 'best_valid_test/acc': 91.609, 'best_valid_test/acc_unbiased': 91.937, 'best_valid_test/diff': 5.575, 'best_valid_test/acc_skew': 91.245, 'best_valid_test/acc_align': 92.629}
[3 / 10] best test accuracy: 91.937 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 94.144, 'best_test_valid/acc_unbiased': 94.534, 'best_test_valid/diff': 0.692, 'best_test_valid/acc_skew': 94.88, 'best_test_valid/acc_align': 94.188, 'best_test_test/acc': 91.609, 'best_test_test/acc_unbiased': 91.937, 'best_test_test/diff': 5.575, 'best_test_test/acc_skew': 91.245, 'best_test_test/acc_align': 92.629}
[4 / 10] Learning rate: 0.0001 weight: 0.01
[4 / 10] Loss: 4.441142241219435 CE Loss: 0.13871249346618034 Con Loss: 4.439755110865515
[4 / 10] tensor([[0.826, 0.944],
        [0.975, 0.885]]) {'epoch': 4, 'valid/acc': 94.772, 'valid/acc_unbiased': 96.002, 'valid/diff': 1.351, 'valid/acc_skew': 96.677, 'valid/acc_align': 95.326, 'test/acc': 89.727, 'test/acc_unbiased': 90.747, 'test/diff': 10.466, 'test/acc_skew': 90.048, 'test/acc_align': 91.446}
[4 / 10] best valid accuracy: 96.002 at epoch 4 
 best_stats: {'best_valid_epoch': 4, 'best_valid_valid/acc': 94.772, 'best_valid_valid/acc_unbiased': 96.002, 'best_valid_valid/diff': 1.351, 'best_valid_valid/acc_skew': 96.677, 'best_valid_valid/acc_align': 95.326, 'best_valid_test/acc': 89.727, 'best_valid_test/acc_unbiased': 90.747, 'best_valid_test/diff': 10.466, 'best_valid_test/acc_skew': 90.048, 'best_valid_test/acc_align': 91.446}
[4 / 10] best test accuracy: 91.937 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 94.144, 'best_test_valid/acc_unbiased': 94.534, 'best_test_valid/diff': 0.692, 'best_test_valid/acc_skew': 94.88, 'best_test_valid/acc_align': 94.188, 'best_test_test/acc': 91.609, 'best_test_test/acc_unbiased': 91.937, 'best_test_test/diff': 5.575, 'best_test_test/acc_skew': 91.245, 'best_test_test/acc_align': 92.629}
[5 / 10] Learning rate: 0.0001 weight: 0.01
[5 / 10] Loss: 4.411635617308757 CE Loss: 0.12628370978668116 Con Loss: 4.41037277581954
[5 / 10] tensor([[0.862, 0.956],
        [0.960, 0.857]]) {'epoch': 5, 'valid/acc': 95.432, 'valid/acc_unbiased': 96.638, 'valid/diff': 2.078, 'valid/acc_skew': 97.32, 'valid/acc_align': 95.956, 'test/acc': 91.534, 'test/acc_unbiased': 90.881, 'test/diff': 9.802, 'test/acc_skew': 91.122, 'test/acc_align': 90.64}
[5 / 10] best valid accuracy: 96.638 at epoch 5 
 best_stats: {'best_valid_epoch': 5, 'best_valid_valid/acc': 95.432, 'best_valid_valid/acc_unbiased': 96.638, 'best_valid_valid/diff': 2.078, 'best_valid_valid/acc_skew': 97.32, 'best_valid_valid/acc_align': 95.956, 'best_valid_test/acc': 91.534, 'best_valid_test/acc_unbiased': 90.881, 'best_valid_test/diff': 9.802, 'best_valid_test/acc_skew': 91.122, 'best_valid_test/acc_align': 90.64}
[5 / 10] best test accuracy: 91.937 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 94.144, 'best_test_valid/acc_unbiased': 94.534, 'best_test_valid/diff': 0.692, 'best_test_valid/acc_skew': 94.88, 'best_test_valid/acc_align': 94.188, 'best_test_test/acc': 91.609, 'best_test_test/acc_unbiased': 91.937, 'best_test_test/diff': 5.575, 'best_test_test/acc_skew': 91.245, 'best_test_test/acc_align': 92.629}
[6 / 10] Learning rate: 0.0001 weight: 0.01
[6 / 10] Loss: 4.394725139222505 CE Loss: 0.11910529578628419 Con Loss: 4.393534090465627
[6 / 10] tensor([[0.839, 0.958],
        [0.968, 0.852]]) {'epoch': 6, 'valid/acc': 95.711, 'valid/acc_unbiased': 96.873, 'valid/diff': 2.141, 'valid/acc_skew': 97.944, 'valid/acc_align': 95.803, 'test/acc': 90.738, 'test/acc_unbiased': 90.424, 'test/diff': 11.757, 'test/acc_skew': 90.379, 'test/acc_align': 90.468}
[6 / 10] best valid accuracy: 96.873 at epoch 6 
 best_stats: {'best_valid_epoch': 6, 'best_valid_valid/acc': 95.711, 'best_valid_valid/acc_unbiased': 96.873, 'best_valid_valid/diff': 2.141, 'best_valid_valid/acc_skew': 97.944, 'best_valid_valid/acc_align': 95.803, 'best_valid_test/acc': 90.738, 'best_valid_test/acc_unbiased': 90.424, 'best_valid_test/diff': 11.757, 'best_valid_test/acc_skew': 90.379, 'best_valid_test/acc_align': 90.468}
[6 / 10] best test accuracy: 91.937 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 94.144, 'best_test_valid/acc_unbiased': 94.534, 'best_test_valid/diff': 0.692, 'best_test_valid/acc_skew': 94.88, 'best_test_valid/acc_align': 94.188, 'best_test_test/acc': 91.609, 'best_test_test/acc_unbiased': 91.937, 'best_test_test/diff': 5.575, 'best_test_test/acc_skew': 91.245, 'best_test_test/acc_align': 92.629}
[7 / 10] Learning rate: 1e-05 weight: 0.01
[7 / 10] Loss: 4.375123933952544 CE Loss: 0.1113011620203273 Con Loss: 4.374010928493648
[7 / 10] tensor([[0.830, 0.958],
        [0.973, 0.846]]) {'epoch': 7, 'valid/acc': 95.851, 'valid/acc_unbiased': 96.872, 'valid/diff': 2.362, 'valid/acc_skew': 98.053, 'valid/acc_align': 95.691, 'test/acc': 90.421, 'test/acc_unbiased': 90.18, 'test/diff': 12.769, 'test/acc_skew': 90.131, 'test/acc_align': 90.229}
[7 / 10] best valid accuracy: 96.873 at epoch 6 
 best_stats: {'best_valid_epoch': 6, 'best_valid_valid/acc': 95.711, 'best_valid_valid/acc_unbiased': 96.873, 'best_valid_valid/diff': 2.141, 'best_valid_valid/acc_skew': 97.944, 'best_valid_valid/acc_align': 95.803, 'best_valid_test/acc': 90.738, 'best_valid_test/acc_unbiased': 90.424, 'best_valid_test/diff': 11.757, 'best_valid_test/acc_skew': 90.379, 'best_valid_test/acc_align': 90.468}
[7 / 10] best test accuracy: 91.937 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 94.144, 'best_test_valid/acc_unbiased': 94.534, 'best_test_valid/diff': 0.692, 'best_test_valid/acc_skew': 94.88, 'best_test_valid/acc_align': 94.188, 'best_test_test/acc': 91.609, 'best_test_test/acc_unbiased': 91.937, 'best_test_test/diff': 5.575, 'best_test_test/acc_skew': 91.245, 'best_test_test/acc_align': 92.629}
[8 / 10] Learning rate: 1e-05 weight: 0.01
[8 / 10] Loss: 4.371502373563714 CE Loss: 0.10968922439513872 Con Loss: 4.370405483811746
[8 / 10] tensor([[0.821, 0.955],
        [0.977, 0.874]]) {'epoch': 8, 'valid/acc': 95.969, 'valid/acc_unbiased': 97.056, 'valid/diff': 2.342, 'valid/acc_skew': 98.227, 'valid/acc_align': 95.885, 'test/acc': 89.958, 'test/acc_unbiased': 90.649, 'test/diff': 11.874, 'test/acc_skew': 89.883, 'test/acc_align': 91.416}
[8 / 10] best valid accuracy: 97.056 at epoch 8 
 best_stats: {'best_valid_epoch': 8, 'best_valid_valid/acc': 95.969, 'best_valid_valid/acc_unbiased': 97.056, 'best_valid_valid/diff': 2.342, 'best_valid_valid/acc_skew': 98.227, 'best_valid_valid/acc_align': 95.885, 'best_valid_test/acc': 89.958, 'best_valid_test/acc_unbiased': 90.649, 'best_valid_test/diff': 11.874, 'best_valid_test/acc_skew': 89.883, 'best_valid_test/acc_align': 91.416}
[8 / 10] best test accuracy: 91.937 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 94.144, 'best_test_valid/acc_unbiased': 94.534, 'best_test_valid/diff': 0.692, 'best_test_valid/acc_skew': 94.88, 'best_test_valid/acc_align': 94.188, 'best_test_test/acc': 91.609, 'best_test_test/acc_unbiased': 91.937, 'best_test_test/diff': 5.575, 'best_test_test/acc_skew': 91.245, 'best_test_test/acc_align': 92.629}
[9 / 10] Learning rate: 1e-05 weight: 0.01
[9 / 10] Loss: 4.371483794029949 CE Loss: 0.10968351658585013 Con Loss: 4.370386957503922
[9 / 10] tensor([[0.809, 0.953],
        [0.979, 0.879]]) {'epoch': 9, 'valid/acc': 95.679, 'valid/acc_unbiased': 97.074, 'valid/diff': 1.7, 'valid/acc_skew': 97.924, 'valid/acc_align': 96.224, 'test/acc': 89.45, 'test/acc_unbiased': 90.516, 'test/diff': 12.194, 'test/acc_skew': 89.402, 'test/acc_align': 91.63}
[9 / 10] best valid accuracy: 97.074 at epoch 9 
 best_stats: {'best_valid_epoch': 9, 'best_valid_valid/acc': 95.679, 'best_valid_valid/acc_unbiased': 97.074, 'best_valid_valid/diff': 1.7, 'best_valid_valid/acc_skew': 97.924, 'best_valid_valid/acc_align': 96.224, 'best_valid_test/acc': 89.45, 'best_valid_test/acc_unbiased': 90.516, 'best_valid_test/diff': 12.194, 'best_valid_test/acc_skew': 89.402, 'best_valid_test/acc_align': 91.63}
[9 / 10] best test accuracy: 91.937 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 94.144, 'best_test_valid/acc_unbiased': 94.534, 'best_test_valid/diff': 0.692, 'best_test_valid/acc_skew': 94.88, 'best_test_valid/acc_align': 94.188, 'best_test_test/acc': 91.609, 'best_test_test/acc_unbiased': 91.937, 'best_test_test/diff': 5.575, 'best_test_test/acc_skew': 91.245, 'best_test_test/acc_align': 92.629}
[10 / 10] Learning rate: 1e-05 weight: 0.01
[10 / 10] Loss: 4.361451985564062 CE Loss: 0.1079257836324149 Con Loss: 4.360372728121973
[10 / 10] tensor([[0.830, 0.962],
        [0.971, 0.857]]) {'epoch': 10, 'valid/acc': 96.259, 'valid/acc_unbiased': 96.996, 'valid/diff': 2.406, 'valid/acc_skew': 98.199, 'valid/acc_align': 95.793, 'test/acc': 90.577, 'test/acc_unbiased': 90.508, 'test/diff': 12.267, 'test/acc_skew': 90.056, 'test/acc_align': 90.96}
[10 / 10] best valid accuracy: 97.074 at epoch 9 
 best_stats: {'best_valid_epoch': 9, 'best_valid_valid/acc': 95.679, 'best_valid_valid/acc_unbiased': 97.074, 'best_valid_valid/diff': 1.7, 'best_valid_valid/acc_skew': 97.924, 'best_valid_valid/acc_align': 96.224, 'best_valid_test/acc': 89.45, 'best_valid_test/acc_unbiased': 90.516, 'best_valid_test/diff': 12.194, 'best_valid_test/acc_skew': 89.402, 'best_valid_test/acc_align': 91.63}
[10 / 10] best test accuracy: 91.937 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 94.144, 'best_test_valid/acc_unbiased': 94.534, 'best_test_valid/diff': 0.692, 'best_test_valid/acc_skew': 94.88, 'best_test_valid/acc_align': 94.188, 'best_test_test/acc': 91.609, 'best_test_test/acc_unbiased': 91.937, 'best_test_test/diff': 5.575, 'best_test_test/acc_skew': 91.245, 'best_test_test/acc_align': 92.629}
Total training time: 2:26:00
