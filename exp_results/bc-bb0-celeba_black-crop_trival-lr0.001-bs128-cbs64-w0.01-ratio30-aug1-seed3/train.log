Log level set to: INFO
Set seed: 3
=======> Using Fixed Random Seed: 3 <========
save_path: exp_results/bc-bb0-celeba_black-crop_trival-lr0.001-bs128-cbs64-w0.01-ratio30-aug1-seed3
get_celeba - split:train, aug: False, given_y: True, ratio: 0
use existing black indices from data/celeba/pickles/black
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [60544, 38546]
Target 1: [8005, 16093]
Binary Target 1
---------------------------
Target 0: [60544, 38546]
Target 1: [8005, 16093]
===================================
Normal Label Distribution: 
Target 0: [60544, 38546]
Target 1: [8005, 16093]
===================================
Use BiasedCelebASplit 
 target_attr: black split: train 
 tensor([[60544.,  8005.],
        [38546., 16093.]])
get_celeba - split:train, aug: 1, given_y: True, ratio: 30
use existing black indices from data/celeba/pickles/black
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [60623, 38503]
Target 1: [7983, 16079]
Binary Target 1
---------------------------
Target 0: [60623, 38503]
Target 1: [7983, 16079]
===================================
Normal Label Distribution: 
Target 0: [60623, 38503]
Target 1: [7983, 16079]
===================================
Use BiasedCelebASplit 
 target_attr: black split: train 
 tensor([[60623.,  7983.],
        [38503., 16079.]])
get_celeba - split:train_valid, aug: False, given_y: True, ratio: 0
use existing black indices from data/celeba/pickles/black
Use BiasedCelebASplit 
 target_attr: black split: train_valid 
 tensor([[15141.,  1962.],
        [ 9689.,  4006.]])
get_celeba - split:valid, aug: False, given_y: True, ratio: 0
Use BiasedCelebASplit 
 target_attr: black split: valid 
 tensor([[9752., 1657.],
        [5971., 2487.]])
decay_epochs: [3, 6]
[1 / 10] Learning rate: 0.001 weight: 0.01
[1 / 10] Loss: 4.815874181250672 CE Loss: 0.310813774597135 Con Loss: 4.812766043889111
[1 / 10] tensor([[0.946, 0.948],
        [0.613, 0.411]]) {'epoch': 1, 'valid/acc': 85.522, 'valid/acc_unbiased': 72.199, 'valid/diff': 7.797, 'valid/acc_skew': 76.002, 'valid/acc_align': 68.396, 'test/acc': 85.186, 'test/acc_unbiased': 72.955, 'test/diff': 10.231, 'test/acc_skew': 78.07, 'test/acc_align': 67.84}
[1 / 10] best valid accuracy: 72.199 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 85.522, 'best_valid_valid/acc_unbiased': 72.199, 'best_valid_valid/diff': 7.797, 'best_valid_valid/acc_skew': 76.002, 'best_valid_valid/acc_align': 68.396, 'best_valid_test/acc': 85.186, 'best_valid_test/acc_unbiased': 72.955, 'best_valid_test/diff': 10.231, 'best_valid_test/acc_skew': 78.07, 'best_valid_test/acc_align': 67.84}
[1 / 10] best test accuracy: 72.955 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 85.522, 'best_test_valid/acc_unbiased': 72.199, 'best_test_valid/diff': 7.797, 'best_test_valid/acc_skew': 76.002, 'best_test_valid/acc_align': 68.396, 'best_test_test/acc': 85.186, 'best_test_test/acc_unbiased': 72.955, 'best_test_test/diff': 10.231, 'best_test_test/acc_skew': 78.07, 'best_test_test/acc_align': 67.84}
[2 / 10] Learning rate: 0.001 weight: 0.01
[2 / 10] Loss: 4.80325022530942 CE Loss: 0.2828738888120885 Con Loss: 4.800421484082528
[2 / 10] tensor([[0.924, 0.934],
        [0.616, 0.456]]) {'epoch': 2, 'valid/acc': 84.259, 'valid/acc_unbiased': 72.392, 'valid/diff': 9.217, 'valid/acc_skew': 77.0, 'valid/acc_align': 67.783, 'test/acc': 84.26, 'test/acc_unbiased': 73.227, 'test/diff': 8.505, 'test/acc_skew': 77.479, 'test/acc_align': 68.974}
[2 / 10] best valid accuracy: 72.392 at epoch 2 
 best_stats: {'best_valid_epoch': 2, 'best_valid_valid/acc': 84.259, 'best_valid_valid/acc_unbiased': 72.392, 'best_valid_valid/diff': 9.217, 'best_valid_valid/acc_skew': 77.0, 'best_valid_valid/acc_align': 67.783, 'best_valid_test/acc': 84.26, 'best_valid_test/acc_unbiased': 73.227, 'best_valid_test/diff': 8.505, 'best_valid_test/acc_skew': 77.479, 'best_valid_test/acc_align': 68.974}
[2 / 10] best test accuracy: 73.227 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 84.259, 'best_test_valid/acc_unbiased': 72.392, 'best_test_valid/diff': 9.217, 'best_test_valid/acc_skew': 77.0, 'best_test_valid/acc_align': 67.783, 'best_test_test/acc': 84.26, 'best_test_test/acc_unbiased': 73.227, 'best_test_test/diff': 8.505, 'best_test_test/acc_skew': 77.479, 'best_test_test/acc_align': 68.974}
[3 / 10] Learning rate: 0.001 weight: 0.01
[3 / 10] Loss: 4.800841353839724 CE Loss: 0.27448456132435567 Con Loss: 4.798096511597548
[3 / 10] tensor([[0.985, 0.971],
        [0.480, 0.491]]) {'epoch': 3, 'valid/acc': 87.986, 'valid/acc_unbiased': 72.413, 'valid/diff': 0.791, 'valid/acc_skew': 72.328, 'valid/acc_align': 72.498, 'test/acc': 87.713, 'test/acc_unbiased': 73.194, 'test/diff': 1.291, 'test/acc_skew': 72.549, 'test/acc_align': 73.84}
[3 / 10] best valid accuracy: 72.413 at epoch 3 
 best_stats: {'best_valid_epoch': 3, 'best_valid_valid/acc': 87.986, 'best_valid_valid/acc_unbiased': 72.413, 'best_valid_valid/diff': 0.791, 'best_valid_valid/acc_skew': 72.328, 'best_valid_valid/acc_align': 72.498, 'best_valid_test/acc': 87.713, 'best_valid_test/acc_unbiased': 73.194, 'best_valid_test/diff': 1.291, 'best_valid_test/acc_skew': 72.549, 'best_valid_test/acc_align': 73.84}
[3 / 10] best test accuracy: 73.227 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 84.259, 'best_test_valid/acc_unbiased': 72.392, 'best_test_valid/diff': 9.217, 'best_test_valid/acc_skew': 77.0, 'best_test_valid/acc_align': 67.783, 'best_test_test/acc': 84.26, 'best_test_test/acc_unbiased': 73.227, 'best_test_test/diff': 8.505, 'best_test_test/acc_skew': 77.479, 'best_test_test/acc_align': 68.974}
[4 / 10] Learning rate: 0.0001 weight: 0.01
[4 / 10] Loss: 4.774318484295095 CE Loss: 0.2407360137700183 Con Loss: 4.771911127890814
[4 / 10] tensor([[0.970, 0.939],
        [0.660, 0.696]]) {'epoch': 4, 'valid/acc': 89.769, 'valid/acc_unbiased': 80.587, 'valid/diff': 1.719, 'valid/acc_skew': 79.727, 'valid/acc_align': 81.447, 'test/acc': 90.064, 'test/acc_unbiased': 81.619, 'test/diff': 3.339, 'test/acc_skew': 79.95, 'test/acc_align': 83.289}
[4 / 10] best valid accuracy: 80.587 at epoch 4 
 best_stats: {'best_valid_epoch': 4, 'best_valid_valid/acc': 89.769, 'best_valid_valid/acc_unbiased': 80.587, 'best_valid_valid/diff': 1.719, 'best_valid_valid/acc_skew': 79.727, 'best_valid_valid/acc_align': 81.447, 'best_valid_test/acc': 90.064, 'best_valid_test/acc_unbiased': 81.619, 'best_valid_test/diff': 3.339, 'best_valid_test/acc_skew': 79.95, 'best_valid_test/acc_align': 83.289}
[4 / 10] best test accuracy: 81.619 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 89.769, 'best_test_valid/acc_unbiased': 80.587, 'best_test_valid/diff': 1.719, 'best_test_valid/acc_skew': 79.727, 'best_test_valid/acc_align': 81.447, 'best_test_test/acc': 90.064, 'best_test_test/acc_unbiased': 81.619, 'best_test_test/diff': 3.339, 'best_test_test/acc_skew': 79.95, 'best_test_test/acc_align': 83.289}
[5 / 10] Learning rate: 0.0001 weight: 0.01
[5 / 10] Loss: 4.763078859163057 CE Loss: 0.2342943690314898 Con Loss: 4.760735909962115
[5 / 10] tensor([[0.960, 0.929],
        [0.731, 0.757]]) {'epoch': 5, 'valid/acc': 90.282, 'valid/acc_unbiased': 83.655, 'valid/diff': 1.897, 'valid/acc_skew': 82.707, 'valid/acc_align': 84.604, 'test/acc': 90.628, 'test/acc_unbiased': 84.439, 'test/diff': 2.868, 'test/acc_skew': 83.005, 'test/acc_align': 85.873}
[5 / 10] best valid accuracy: 83.655 at epoch 5 
 best_stats: {'best_valid_epoch': 5, 'best_valid_valid/acc': 90.282, 'best_valid_valid/acc_unbiased': 83.655, 'best_valid_valid/diff': 1.897, 'best_valid_valid/acc_skew': 82.707, 'best_valid_valid/acc_align': 84.604, 'best_valid_test/acc': 90.628, 'best_valid_test/acc_unbiased': 84.439, 'best_valid_test/diff': 2.868, 'best_valid_test/acc_skew': 83.005, 'best_valid_test/acc_align': 85.873}
[5 / 10] best test accuracy: 84.439 at epoch 5 
 best_stats: {'best_test_epoch': 5, 'best_test_valid/acc': 90.282, 'best_test_valid/acc_unbiased': 83.655, 'best_test_valid/diff': 1.897, 'best_test_valid/acc_skew': 82.707, 'best_test_valid/acc_align': 84.604, 'best_test_test/acc': 90.628, 'best_test_test/acc_unbiased': 84.439, 'best_test_test/diff': 2.868, 'best_test_test/acc_skew': 83.005, 'best_test_test/acc_align': 85.873}
[6 / 10] Learning rate: 0.0001 weight: 0.01
[6 / 10] Loss: 4.764276482747174 CE Loss: 0.22927576674886133 Con Loss: 4.761983729292906
[6 / 10] tensor([[0.962, 0.932],
        [0.703, 0.728]]) {'epoch': 6, 'valid/acc': 90.038, 'valid/acc_unbiased': 82.476, 'valid/diff': 1.306, 'valid/acc_skew': 81.823, 'valid/acc_align': 83.13, 'test/acc': 90.205, 'test/acc_unbiased': 83.123, 'test/diff': 2.788, 'test/acc_skew': 81.729, 'test/acc_align': 84.517}
[6 / 10] best valid accuracy: 83.655 at epoch 5 
 best_stats: {'best_valid_epoch': 5, 'best_valid_valid/acc': 90.282, 'best_valid_valid/acc_unbiased': 83.655, 'best_valid_valid/diff': 1.897, 'best_valid_valid/acc_skew': 82.707, 'best_valid_valid/acc_align': 84.604, 'best_valid_test/acc': 90.628, 'best_valid_test/acc_unbiased': 84.439, 'best_valid_test/diff': 2.868, 'best_valid_test/acc_skew': 83.005, 'best_valid_test/acc_align': 85.873}
[6 / 10] best test accuracy: 84.439 at epoch 5 
 best_stats: {'best_test_epoch': 5, 'best_test_valid/acc': 90.282, 'best_test_valid/acc_unbiased': 83.655, 'best_test_valid/diff': 1.897, 'best_test_valid/acc_skew': 82.707, 'best_test_valid/acc_align': 84.604, 'best_test_test/acc': 90.628, 'best_test_test/acc_unbiased': 84.439, 'best_test_test/diff': 2.868, 'best_test_test/acc_skew': 83.005, 'best_test_test/acc_align': 85.873}
[7 / 10] Learning rate: 1e-05 weight: 0.01
[7 / 10] Loss: 4.758301374490111 CE Loss: 0.22559468611752123 Con Loss: 4.75604543188282
[7 / 10] tensor([[0.961, 0.936],
        [0.730, 0.728]]) {'epoch': 7, 'valid/acc': 90.285, 'valid/acc_unbiased': 83.093, 'valid/diff': 1.736, 'valid/acc_skew': 82.839, 'valid/acc_align': 83.347, 'test/acc': 90.507, 'test/acc_unbiased': 83.87, 'test/diff': 1.336, 'test/acc_skew': 83.274, 'test/acc_align': 84.466}
[7 / 10] best valid accuracy: 83.655 at epoch 5 
 best_stats: {'best_valid_epoch': 5, 'best_valid_valid/acc': 90.282, 'best_valid_valid/acc_unbiased': 83.655, 'best_valid_valid/diff': 1.897, 'best_valid_valid/acc_skew': 82.707, 'best_valid_valid/acc_align': 84.604, 'best_valid_test/acc': 90.628, 'best_valid_test/acc_unbiased': 84.439, 'best_valid_test/diff': 2.868, 'best_valid_test/acc_skew': 83.005, 'best_valid_test/acc_align': 85.873}
[7 / 10] best test accuracy: 84.439 at epoch 5 
 best_stats: {'best_test_epoch': 5, 'best_test_valid/acc': 90.282, 'best_test_valid/acc_unbiased': 83.655, 'best_test_valid/diff': 1.897, 'best_test_valid/acc_skew': 82.707, 'best_test_valid/acc_align': 84.604, 'best_test_test/acc': 90.628, 'best_test_test/acc_unbiased': 84.439, 'best_test_test/diff': 2.868, 'best_test_test/acc_skew': 83.005, 'best_test_test/acc_align': 85.873}
[8 / 10] Learning rate: 1e-05 weight: 0.01
[8 / 10] Loss: 4.756438540263497 CE Loss: 0.22473062471270921 Con Loss: 4.754191233538364
[8 / 10] tensor([[0.969, 0.948],
        [0.687, 0.691]]) {'epoch': 8, 'valid/acc': 90.285, 'valid/acc_unbiased': 81.643, 'valid/diff': 1.328, 'valid/acc_skew': 81.528, 'valid/acc_align': 81.758, 'test/acc': 90.426, 'test/acc_unbiased': 82.377, 'test/diff': 1.258, 'test/acc_skew': 81.748, 'test/acc_align': 83.006}
[8 / 10] best valid accuracy: 83.655 at epoch 5 
 best_stats: {'best_valid_epoch': 5, 'best_valid_valid/acc': 90.282, 'best_valid_valid/acc_unbiased': 83.655, 'best_valid_valid/diff': 1.897, 'best_valid_valid/acc_skew': 82.707, 'best_valid_valid/acc_align': 84.604, 'best_valid_test/acc': 90.628, 'best_valid_test/acc_unbiased': 84.439, 'best_valid_test/diff': 2.868, 'best_valid_test/acc_skew': 83.005, 'best_valid_test/acc_align': 85.873}
[8 / 10] best test accuracy: 84.439 at epoch 5 
 best_stats: {'best_test_epoch': 5, 'best_test_valid/acc': 90.282, 'best_test_valid/acc_unbiased': 83.655, 'best_test_valid/diff': 1.897, 'best_test_valid/acc_skew': 82.707, 'best_test_valid/acc_align': 84.604, 'best_test_test/acc': 90.628, 'best_test_test/acc_unbiased': 84.439, 'best_test_test/diff': 2.868, 'best_test_test/acc_skew': 83.005, 'best_test_test/acc_align': 85.873}
[9 / 10] Learning rate: 1e-05 weight: 0.01
[9 / 10] Loss: 4.7567702237594425 CE Loss: 0.2220970563462064 Con Loss: 4.75454925127485
[9 / 10] tensor([[0.971, 0.946],
        [0.684, 0.703]]) {'epoch': 9, 'valid/acc': 90.597, 'valid/acc_unbiased': 82.413, 'valid/diff': 0.942, 'valid/acc_skew': 82.016, 'valid/acc_align': 82.811, 'test/acc': 90.603, 'test/acc_unbiased': 82.614, 'test/diff': 2.185, 'test/acc_skew': 81.522, 'test/acc_align': 83.707}
[9 / 10] best valid accuracy: 83.655 at epoch 5 
 best_stats: {'best_valid_epoch': 5, 'best_valid_valid/acc': 90.282, 'best_valid_valid/acc_unbiased': 83.655, 'best_valid_valid/diff': 1.897, 'best_valid_valid/acc_skew': 82.707, 'best_valid_valid/acc_align': 84.604, 'best_valid_test/acc': 90.628, 'best_valid_test/acc_unbiased': 84.439, 'best_valid_test/diff': 2.868, 'best_valid_test/acc_skew': 83.005, 'best_valid_test/acc_align': 85.873}
[9 / 10] best test accuracy: 84.439 at epoch 5 
 best_stats: {'best_test_epoch': 5, 'best_test_valid/acc': 90.282, 'best_test_valid/acc_unbiased': 83.655, 'best_test_valid/diff': 1.897, 'best_test_valid/acc_skew': 82.707, 'best_test_valid/acc_align': 84.604, 'best_test_test/acc': 90.628, 'best_test_test/acc_unbiased': 84.439, 'best_test_test/diff': 2.868, 'best_test_test/acc_skew': 83.005, 'best_test_test/acc_align': 85.873}
[10 / 10] Learning rate: 1e-05 weight: 0.01
[10 / 10] Loss: 4.756510190570161 CE Loss: 0.22207672586320115 Con Loss: 4.754289424508045
[10 / 10] tensor([[0.968, 0.941],
        [0.689, 0.717]]) {'epoch': 10, 'valid/acc': 90.434, 'valid/acc_unbiased': 82.226, 'valid/diff': 1.425, 'valid/acc_skew': 81.513, 'valid/acc_align': 82.938, 'test/acc': 90.497, 'test/acc_unbiased': 82.842, 'test/diff': 2.77, 'test/acc_skew': 81.457, 'test/acc_align': 84.227}
[10 / 10] best valid accuracy: 83.655 at epoch 5 
 best_stats: {'best_valid_epoch': 5, 'best_valid_valid/acc': 90.282, 'best_valid_valid/acc_unbiased': 83.655, 'best_valid_valid/diff': 1.897, 'best_valid_valid/acc_skew': 82.707, 'best_valid_valid/acc_align': 84.604, 'best_valid_test/acc': 90.628, 'best_valid_test/acc_unbiased': 84.439, 'best_valid_test/diff': 2.868, 'best_valid_test/acc_skew': 83.005, 'best_valid_test/acc_align': 85.873}
[10 / 10] best test accuracy: 84.439 at epoch 5 
 best_stats: {'best_test_epoch': 5, 'best_test_valid/acc': 90.282, 'best_test_valid/acc_unbiased': 83.655, 'best_test_valid/diff': 1.897, 'best_test_valid/acc_skew': 82.707, 'best_test_valid/acc_align': 84.604, 'best_test_test/acc': 90.628, 'best_test_test/acc_unbiased': 84.439, 'best_test_test/diff': 2.868, 'best_test_test/acc_skew': 83.005, 'best_test_test/acc_align': 85.873}
Total training time: 1:47:06
