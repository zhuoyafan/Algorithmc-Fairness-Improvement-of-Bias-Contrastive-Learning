Log level set to: INFO
Set seed: 1
=======> Using Fixed Random Seed: 1 <========
save_path: exp_results/bc-bb0-utk_face_age-test-0.9-lr0.001-bs128-cbs64-w0.01-ratio10-aug1-seed1
get_utk_face - split: train, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_age-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
Binary Target 1
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Normal Label Distribution: 
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
Binary Target 1
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Normal Label Distribution: 
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 10684, target_attr: gender, bias_attr: age bias_rate: 0.9
['[train] target_0-bias_0: 8237', '[train] target_0-bias_1: 147', '[train] target_1-bias_0: 823', '[train] target_1-bias_1: 1477']
confusion_matrix - 
 original: tensor([[8237.,  823.],
        [ 147., 1477.]]), 
 normalized: tensor([[0.909, 0.091],
        [0.091, 0.909]]), 
 b|y: tensor([[0.982, 0.018],
        [0.358, 0.642]])
get_utk_face - split: train, aug: 1, given_y: True, ratio: 10
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_age-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
Binary Target 1
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Normal Label Distribution: 
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
Binary Target 1
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Normal Label Distribution: 
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 10684, target_attr: gender, bias_attr: age bias_rate: 0.9
['[train] target_0-bias_0: 8237', '[train] target_0-bias_1: 147', '[train] target_1-bias_0: 823', '[train] target_1-bias_1: 1477']
get_utk_face - split: valid, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_age-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [1030, 195]
Target 1: [841, 202]
Binary Target 1
---------------------------
Target 0: [1030, 195]
Target 1: [841, 202]
===================================
Normal Label Distribution: 
Target 0: [1030, 195]
Target 1: [841, 202]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 2268, target_attr: gender, bias_attr: age bias_rate: 0.9
['[valid] target_0-bias_0: 1030', '[valid] target_0-bias_1: 195', '[valid] target_1-bias_0: 841', '[valid] target_1-bias_1: 202']
get_utk_face - split: test, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_age-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [1061, 176]
Target 1: [867, 165]
Binary Target 1
---------------------------
Target 0: [1061, 176]
Target 1: [867, 165]
===================================
Normal Label Distribution: 
Target 0: [1061, 176]
Target 1: [867, 165]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 2269, target_attr: gender, bias_attr: age bias_rate: 0.9
['[test] target_0-bias_0: 1061', '[test] target_0-bias_1: 176', '[test] target_1-bias_0: 867', '[test] target_1-bias_1: 165']
decay_epochs: [6, 13]
[1 / 20] Learning rate: 0.001 weight: 0.01
[1 / 20] Loss: 4.768913157108526 CE Loss: 0.5828417763197659 Con Loss: 4.763084735463327
[1 / 20] tensor([[0.910, 0.892],
        [0.593, 0.339]]) {'epoch': 1, 'valid/acc': 72.884, 'valid/acc_unbiased': 67.576, 'valid/diff': 12.507, 'valid/acc_skew': 70.098, 'valid/acc_align': 65.054, 'test/acc': 74.57, 'test/acc_unbiased': 68.345, 'test/diff': 13.546, 'test/acc_skew': 74.245, 'test/acc_align': 62.446}
[1 / 20] best valid accuracy: 67.576 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 72.884, 'best_valid_valid/acc_unbiased': 67.576, 'best_valid_valid/diff': 12.507, 'best_valid_valid/acc_skew': 70.098, 'best_valid_valid/acc_align': 65.054, 'best_valid_test/acc': 74.57, 'best_valid_test/acc_unbiased': 68.345, 'best_valid_test/diff': 13.546, 'best_valid_test/acc_skew': 74.245, 'best_valid_test/acc_align': 62.446}
[1 / 20] best test accuracy: 68.345 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 72.884, 'best_test_valid/acc_unbiased': 67.576, 'best_test_valid/diff': 12.507, 'best_test_valid/acc_skew': 70.098, 'best_test_valid/acc_align': 65.054, 'best_test_test/acc': 74.57, 'best_test_test/acc_unbiased': 68.345, 'best_test_test/diff': 13.546, 'best_test_test/acc_skew': 74.245, 'best_test_test/acc_align': 62.446}
[2 / 20] Learning rate: 0.001 weight: 0.01
[2 / 20] Loss: 4.5921340724226685 CE Loss: 0.5350635012898362 Con Loss: 4.586783458569754
[2 / 20] tensor([[0.992, 0.966],
        [0.309, 0.164]]) {'epoch': 2, 'valid/acc': 66.358, 'valid/acc_unbiased': 61.198, 'valid/diff': 7.615, 'valid/acc_skew': 64.611, 'valid/acc_align': 57.785, 'test/acc': 66.858, 'test/acc_unbiased': 60.754, 'test/diff': 8.554, 'test/acc_skew': 63.751, 'test/acc_align': 57.758}
[2 / 20] best valid accuracy: 67.576 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 72.884, 'best_valid_valid/acc_unbiased': 67.576, 'best_valid_valid/diff': 12.507, 'best_valid_valid/acc_skew': 70.098, 'best_valid_valid/acc_align': 65.054, 'best_valid_test/acc': 74.57, 'best_valid_test/acc_unbiased': 68.345, 'best_valid_test/diff': 13.546, 'best_valid_test/acc_skew': 74.245, 'best_valid_test/acc_align': 62.446}
[2 / 20] best test accuracy: 68.345 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 72.884, 'best_test_valid/acc_unbiased': 67.576, 'best_test_valid/diff': 12.507, 'best_test_valid/acc_skew': 70.098, 'best_test_valid/acc_align': 65.054, 'best_test_test/acc': 74.57, 'best_test_test/acc_unbiased': 68.345, 'best_test_test/diff': 13.546, 'best_test_test/acc_skew': 74.245, 'best_test_test/acc_align': 62.446}
[3 / 20] Learning rate: 0.001 weight: 0.01
[3 / 20] Loss: 4.492354079160473 CE Loss: 0.5123561409273115 Con Loss: 4.4872304912097265
[3 / 20] tensor([[0.753, 0.631],
        [0.832, 0.673]]) {'epoch': 3, 'valid/acc': 75.661, 'valid/acc_unbiased': 69.953, 'valid/diff': 18.344, 'valid/acc_skew': 66.645, 'valid/acc_align': 73.26, 'test/acc': 76.774, 'test/acc_unbiased': 72.202, 'test/diff': 14.063, 'test/acc_skew': 73.114, 'test/acc_align': 71.29}
[3 / 20] best valid accuracy: 69.953 at epoch 3 
 best_stats: {'best_valid_epoch': 3, 'best_valid_valid/acc': 75.661, 'best_valid_valid/acc_unbiased': 69.953, 'best_valid_valid/diff': 18.344, 'best_valid_valid/acc_skew': 66.645, 'best_valid_valid/acc_align': 73.26, 'best_valid_test/acc': 76.774, 'best_valid_test/acc_unbiased': 72.202, 'best_valid_test/diff': 14.063, 'best_valid_test/acc_skew': 73.114, 'best_valid_test/acc_align': 71.29}
[3 / 20] best test accuracy: 72.202 at epoch 3 
 best_stats: {'best_test_epoch': 3, 'best_test_valid/acc': 75.661, 'best_test_valid/acc_unbiased': 69.953, 'best_test_valid/diff': 18.344, 'best_test_valid/acc_skew': 66.645, 'best_test_valid/acc_align': 73.26, 'best_test_test/acc': 76.774, 'best_test_test/acc_unbiased': 72.202, 'best_test_test/diff': 14.063, 'best_test_test/acc_skew': 73.114, 'best_test_test/acc_align': 71.29}
[4 / 20] Learning rate: 0.001 weight: 0.01
[4 / 20] Loss: 4.497323896857247 CE Loss: 0.48505710827996334 Con Loss: 4.492473327903791
[4 / 20] tensor([[0.989, 0.949],
        [0.308, 0.200]]) {'epoch': 4, 'valid/acc': 66.799, 'valid/acc_unbiased': 62.196, 'valid/diff': 5.812, 'valid/acc_skew': 62.303, 'valid/acc_align': 62.09, 'test/acc': 66.814, 'test/acc_unbiased': 61.138, 'test/diff': 7.389, 'test/acc_skew': 62.841, 'test/acc_align': 59.434}
[4 / 20] best valid accuracy: 69.953 at epoch 3 
 best_stats: {'best_valid_epoch': 3, 'best_valid_valid/acc': 75.661, 'best_valid_valid/acc_unbiased': 69.953, 'best_valid_valid/diff': 18.344, 'best_valid_valid/acc_skew': 66.645, 'best_valid_valid/acc_align': 73.26, 'best_valid_test/acc': 76.774, 'best_valid_test/acc_unbiased': 72.202, 'best_valid_test/diff': 14.063, 'best_valid_test/acc_skew': 73.114, 'best_valid_test/acc_align': 71.29}
[4 / 20] best test accuracy: 72.202 at epoch 3 
 best_stats: {'best_test_epoch': 3, 'best_test_valid/acc': 75.661, 'best_test_valid/acc_unbiased': 69.953, 'best_test_valid/diff': 18.344, 'best_test_valid/acc_skew': 66.645, 'best_test_valid/acc_align': 73.26, 'best_test_test/acc': 76.774, 'best_test_test/acc_unbiased': 72.202, 'best_test_test/diff': 14.063, 'best_test_test/acc_skew': 73.114, 'best_test_test/acc_align': 71.29}
[5 / 20] Learning rate: 0.001 weight: 0.01
[5 / 20] Loss: 4.5581534107898065 CE Loss: 0.46321260119055774 Con Loss: 4.553521283420005
[5 / 20] tensor([[0.980, 0.926],
        [0.435, 0.303]]) {'epoch': 5, 'valid/acc': 70.635, 'valid/acc_unbiased': 65.869, 'valid/diff': 7.765, 'valid/acc_skew': 66.765, 'valid/acc_align': 64.973, 'test/acc': 71.838, 'test/acc_unbiased': 66.105, 'test/diff': 9.294, 'test/acc_skew': 68.048, 'test/acc_align': 64.162}
[5 / 20] best valid accuracy: 69.953 at epoch 3 
 best_stats: {'best_valid_epoch': 3, 'best_valid_valid/acc': 75.661, 'best_valid_valid/acc_unbiased': 69.953, 'best_valid_valid/diff': 18.344, 'best_valid_valid/acc_skew': 66.645, 'best_valid_valid/acc_align': 73.26, 'best_valid_test/acc': 76.774, 'best_valid_test/acc_unbiased': 72.202, 'best_valid_test/diff': 14.063, 'best_valid_test/acc_skew': 73.114, 'best_valid_test/acc_align': 71.29}
[5 / 20] best test accuracy: 72.202 at epoch 3 
 best_stats: {'best_test_epoch': 3, 'best_test_valid/acc': 75.661, 'best_test_valid/acc_unbiased': 69.953, 'best_test_valid/diff': 18.344, 'best_test_valid/acc_skew': 66.645, 'best_test_valid/acc_align': 73.26, 'best_test_test/acc': 76.774, 'best_test_test/acc_unbiased': 72.202, 'best_test_test/diff': 14.063, 'best_test_test/acc_skew': 73.114, 'best_test_test/acc_align': 71.29}
[6 / 20] Learning rate: 0.001 weight: 0.01
[6 / 20] Loss: 4.465956948393519 CE Loss: 0.4657152968816925 Con Loss: 4.461299775558123
[6 / 20] tensor([[0.975, 0.932],
        [0.604, 0.333]]) {'epoch': 6, 'valid/acc': 77.205, 'valid/acc_unbiased': 71.642, 'valid/diff': 12.38, 'valid/acc_skew': 75.089, 'valid/acc_align': 68.195, 'test/acc': 78.316, 'test/acc_unbiased': 71.102, 'test/diff': 15.689, 'test/acc_skew': 76.81, 'test/acc_align': 65.394}
[6 / 20] best valid accuracy: 71.642 at epoch 6 
 best_stats: {'best_valid_epoch': 6, 'best_valid_valid/acc': 77.205, 'best_valid_valid/acc_unbiased': 71.642, 'best_valid_valid/diff': 12.38, 'best_valid_valid/acc_skew': 75.089, 'best_valid_valid/acc_align': 68.195, 'best_valid_test/acc': 78.316, 'best_valid_test/acc_unbiased': 71.102, 'best_valid_test/diff': 15.689, 'best_valid_test/acc_skew': 76.81, 'best_valid_test/acc_align': 65.394}
[6 / 20] best test accuracy: 72.202 at epoch 3 
 best_stats: {'best_test_epoch': 3, 'best_test_valid/acc': 75.661, 'best_test_valid/acc_unbiased': 69.953, 'best_test_valid/diff': 18.344, 'best_test_valid/acc_skew': 66.645, 'best_test_valid/acc_align': 73.26, 'best_test_test/acc': 76.774, 'best_test_test/acc_unbiased': 72.202, 'best_test_test/diff': 14.063, 'best_test_test/acc_skew': 73.114, 'best_test_test/acc_align': 71.29}
[7 / 20] Learning rate: 0.0001 weight: 0.01
[7 / 20] Loss: 4.417731429699519 CE Loss: 0.43110532124182654 Con Loss: 4.413420361911969
[7 / 20] tensor([[0.974, 0.830],
        [0.627, 0.509]]) {'epoch': 7, 'valid/acc': 77.954, 'valid/acc_unbiased': 72.417, 'valid/diff': 12.376, 'valid/acc_skew': 69.708, 'valid/acc_align': 75.126, 'test/acc': 79.639, 'test/acc_unbiased': 73.492, 'test/diff': 13.121, 'test/acc_skew': 72.85, 'test/acc_align': 74.135}
[7 / 20] best valid accuracy: 72.417 at epoch 7 
 best_stats: {'best_valid_epoch': 7, 'best_valid_valid/acc': 77.954, 'best_valid_valid/acc_unbiased': 72.417, 'best_valid_valid/diff': 12.376, 'best_valid_valid/acc_skew': 69.708, 'best_valid_valid/acc_align': 75.126, 'best_valid_test/acc': 79.639, 'best_valid_test/acc_unbiased': 73.492, 'best_valid_test/diff': 13.121, 'best_valid_test/acc_skew': 72.85, 'best_valid_test/acc_align': 74.135}
[7 / 20] best test accuracy: 73.492 at epoch 7 
 best_stats: {'best_test_epoch': 7, 'best_test_valid/acc': 77.954, 'best_test_valid/acc_unbiased': 72.417, 'best_test_valid/diff': 12.376, 'best_test_valid/acc_skew': 69.708, 'best_test_valid/acc_align': 75.126, 'best_test_test/acc': 79.639, 'best_test_test/acc_unbiased': 73.492, 'best_test_test/diff': 13.121, 'best_test_test/acc_skew': 72.85, 'best_test_test/acc_align': 74.135}
[8 / 20] Learning rate: 0.0001 weight: 0.01
[8 / 20] Loss: 4.37104631264707 CE Loss: 0.42207156937919454 Con Loss: 4.366825615230548
[8 / 20] tensor([[0.978, 0.807],
        [0.616, 0.539]]) {'epoch': 8, 'valid/acc': 77.072, 'valid/acc_unbiased': 72.361, 'valid/diff': 11.868, 'valid/acc_skew': 66.427, 'valid/acc_align': 78.295, 'test/acc': 79.462, 'test/acc_unbiased': 73.511, 'test/diff': 12.401, 'test/acc_skew': 71.137, 'test/acc_align': 75.886}
[8 / 20] best valid accuracy: 72.417 at epoch 7 
 best_stats: {'best_valid_epoch': 7, 'best_valid_valid/acc': 77.954, 'best_valid_valid/acc_unbiased': 72.417, 'best_valid_valid/diff': 12.376, 'best_valid_valid/acc_skew': 69.708, 'best_valid_valid/acc_align': 75.126, 'best_valid_test/acc': 79.639, 'best_valid_test/acc_unbiased': 73.492, 'best_valid_test/diff': 13.121, 'best_valid_test/acc_skew': 72.85, 'best_valid_test/acc_align': 74.135}
[8 / 20] best test accuracy: 73.511 at epoch 8 
 best_stats: {'best_test_epoch': 8, 'best_test_valid/acc': 77.072, 'best_test_valid/acc_unbiased': 72.361, 'best_test_valid/diff': 11.868, 'best_test_valid/acc_skew': 66.427, 'best_test_valid/acc_align': 78.295, 'best_test_test/acc': 79.462, 'best_test_test/acc_unbiased': 73.511, 'best_test_test/diff': 12.401, 'best_test_test/acc_skew': 71.137, 'best_test_test/acc_align': 75.886}
[9 / 20] Learning rate: 0.0001 weight: 0.01
[9 / 20] Loss: 4.3550285762814 CE Loss: 0.4071574873667181 Con Loss: 4.35095700892738
[9 / 20] tensor([[0.974, 0.744],
        [0.659, 0.588]]) {'epoch': 9, 'valid/acc': 80.071, 'valid/acc_unbiased': 74.925, 'valid/diff': 12.583, 'valid/acc_skew': 68.634, 'valid/acc_align': 81.217, 'test/acc': 80.74, 'test/acc_unbiased': 74.11, 'test/diff': 15.0, 'test/acc_skew': 70.146, 'test/acc_align': 78.074}
[9 / 20] best valid accuracy: 74.925 at epoch 9 
 best_stats: {'best_valid_epoch': 9, 'best_valid_valid/acc': 80.071, 'best_valid_valid/acc_unbiased': 74.925, 'best_valid_valid/diff': 12.583, 'best_valid_valid/acc_skew': 68.634, 'best_valid_valid/acc_align': 81.217, 'best_valid_test/acc': 80.74, 'best_valid_test/acc_unbiased': 74.11, 'best_valid_test/diff': 15.0, 'best_valid_test/acc_skew': 70.146, 'best_valid_test/acc_align': 78.074}
[9 / 20] best test accuracy: 74.110 at epoch 9 
 best_stats: {'best_test_epoch': 9, 'best_test_valid/acc': 80.071, 'best_test_valid/acc_unbiased': 74.925, 'best_test_valid/diff': 12.583, 'best_test_valid/acc_skew': 68.634, 'best_test_valid/acc_align': 81.217, 'best_test_test/acc': 80.74, 'best_test_test/acc_unbiased': 74.11, 'best_test_test/diff': 15.0, 'best_test_test/acc_skew': 70.146, 'best_test_test/acc_align': 78.074}
[10 / 20] Learning rate: 0.0001 weight: 0.01
[10 / 20] Loss: 4.288223995157326 CE Loss: 0.4008071969417721 Con Loss: 4.284215921411261
[10 / 20] tensor([[0.976, 0.739],
        [0.651, 0.600]]) {'epoch': 10, 'valid/acc': 78.924, 'valid/acc_unbiased': 73.51, 'valid/diff': 12.3, 'valid/acc_skew': 67.88, 'valid/acc_align': 79.14, 'test/acc': 80.608, 'test/acc_unbiased': 74.14, 'test/diff': 14.416, 'test/acc_skew': 69.458, 'test/acc_align': 78.822}
[10 / 20] best valid accuracy: 74.925 at epoch 9 
 best_stats: {'best_valid_epoch': 9, 'best_valid_valid/acc': 80.071, 'best_valid_valid/acc_unbiased': 74.925, 'best_valid_valid/diff': 12.583, 'best_valid_valid/acc_skew': 68.634, 'best_valid_valid/acc_align': 81.217, 'best_valid_test/acc': 80.74, 'best_valid_test/acc_unbiased': 74.11, 'best_valid_test/diff': 15.0, 'best_valid_test/acc_skew': 70.146, 'best_valid_test/acc_align': 78.074}
[10 / 20] best test accuracy: 74.140 at epoch 10 
 best_stats: {'best_test_epoch': 10, 'best_test_valid/acc': 78.924, 'best_test_valid/acc_unbiased': 73.51, 'best_test_valid/diff': 12.3, 'best_test_valid/acc_skew': 67.88, 'best_test_valid/acc_align': 79.14, 'best_test_test/acc': 80.608, 'best_test_test/acc_unbiased': 74.14, 'best_test_test/diff': 14.416, 'best_test_test/acc_skew': 69.458, 'best_test_test/acc_align': 78.822}
[11 / 20] Learning rate: 0.0001 weight: 0.01
[11 / 20] Loss: 4.236349749591903 CE Loss: 0.3933997832403251 Con Loss: 4.232415747705001
[11 / 20] tensor([[0.974, 0.705],
        [0.691, 0.715]]) {'epoch': 11, 'valid/acc': 80.423, 'valid/acc_unbiased': 74.539, 'valid/diff': 20.596, 'valid/acc_skew': 64.241, 'valid/acc_align': 84.838, 'test/acc': 82.591, 'test/acc_unbiased': 77.105, 'test/diff': 14.666, 'test/acc_skew': 69.772, 'test/acc_align': 84.438}
[11 / 20] best valid accuracy: 74.925 at epoch 9 
 best_stats: {'best_valid_epoch': 9, 'best_valid_valid/acc': 80.071, 'best_valid_valid/acc_unbiased': 74.925, 'best_valid_valid/diff': 12.583, 'best_valid_valid/acc_skew': 68.634, 'best_valid_valid/acc_align': 81.217, 'best_valid_test/acc': 80.74, 'best_valid_test/acc_unbiased': 74.11, 'best_valid_test/diff': 15.0, 'best_valid_test/acc_skew': 70.146, 'best_valid_test/acc_align': 78.074}
[11 / 20] best test accuracy: 77.105 at epoch 11 
 best_stats: {'best_test_epoch': 11, 'best_test_valid/acc': 80.423, 'best_test_valid/acc_unbiased': 74.539, 'best_test_valid/diff': 20.596, 'best_test_valid/acc_skew': 64.241, 'best_test_valid/acc_align': 84.838, 'best_test_test/acc': 82.591, 'best_test_test/acc_unbiased': 77.105, 'best_test_test/diff': 14.666, 'best_test_test/acc_skew': 69.772, 'best_test_test/acc_align': 84.438}
[12 / 20] Learning rate: 0.0001 weight: 0.01
[12 / 20] Loss: 4.276130407055591 CE Loss: 0.38948851624083225 Con Loss: 4.272235542948618
[12 / 20] tensor([[0.975, 0.670],
        [0.684, 0.758]]) {'epoch': 12, 'valid/acc': 80.335, 'valid/acc_unbiased': 74.633, 'valid/diff': 23.273, 'valid/acc_skew': 62.996, 'valid/acc_align': 86.269, 'test/acc': 82.459, 'test/acc_unbiased': 77.187, 'test/diff': 18.932, 'test/acc_skew': 67.721, 'test/acc_align': 86.654}
[12 / 20] best valid accuracy: 74.925 at epoch 9 
 best_stats: {'best_valid_epoch': 9, 'best_valid_valid/acc': 80.071, 'best_valid_valid/acc_unbiased': 74.925, 'best_valid_valid/diff': 12.583, 'best_valid_valid/acc_skew': 68.634, 'best_valid_valid/acc_align': 81.217, 'best_valid_test/acc': 80.74, 'best_valid_test/acc_unbiased': 74.11, 'best_valid_test/diff': 15.0, 'best_valid_test/acc_skew': 70.146, 'best_valid_test/acc_align': 78.074}
[12 / 20] best test accuracy: 77.187 at epoch 12 
 best_stats: {'best_test_epoch': 12, 'best_test_valid/acc': 80.335, 'best_test_valid/acc_unbiased': 74.633, 'best_test_valid/diff': 23.273, 'best_test_valid/acc_skew': 62.996, 'best_test_valid/acc_align': 86.269, 'best_test_test/acc': 82.459, 'best_test_test/acc_unbiased': 77.187, 'best_test_test/diff': 18.932, 'best_test_test/acc_skew': 67.721, 'best_test_test/acc_align': 86.654}
[13 / 20] Learning rate: 0.0001 weight: 0.01
[13 / 20] Loss: 4.262823953917748 CE Loss: 0.37427528969628315 Con Loss: 4.259081203542101
[13 / 20] tensor([[0.975, 0.693],
        [0.669, 0.691]]) {'epoch': 13, 'valid/acc': 80.026, 'valid/acc_unbiased': 75.031, 'valid/diff': 19.7, 'valid/acc_skew': 65.182, 'valid/acc_align': 84.881, 'test/acc': 81.534, 'test/acc_unbiased': 75.69, 'test/diff': 15.165, 'test/acc_skew': 68.108, 'test/acc_align': 83.273}
[13 / 20] best valid accuracy: 75.031 at epoch 13 
 best_stats: {'best_valid_epoch': 13, 'best_valid_valid/acc': 80.026, 'best_valid_valid/acc_unbiased': 75.031, 'best_valid_valid/diff': 19.7, 'best_valid_valid/acc_skew': 65.182, 'best_valid_valid/acc_align': 84.881, 'best_valid_test/acc': 81.534, 'best_valid_test/acc_unbiased': 75.69, 'best_valid_test/diff': 15.165, 'best_valid_test/acc_skew': 68.108, 'best_valid_test/acc_align': 83.273}
[13 / 20] best test accuracy: 77.187 at epoch 12 
 best_stats: {'best_test_epoch': 12, 'best_test_valid/acc': 80.335, 'best_test_valid/acc_unbiased': 74.633, 'best_test_valid/diff': 23.273, 'best_test_valid/acc_skew': 62.996, 'best_test_valid/acc_align': 86.269, 'best_test_test/acc': 82.459, 'best_test_test/acc_unbiased': 77.187, 'best_test_test/diff': 18.932, 'best_test_test/acc_skew': 67.721, 'best_test_test/acc_align': 86.654}
[14 / 20] Learning rate: 1e-05 weight: 0.01
[14 / 20] Loss: 4.220194967441994 CE Loss: 0.37597266368453575 Con Loss: 4.216435256409582
[14 / 20] tensor([[0.975, 0.688],
        [0.667, 0.703]]) {'epoch': 14, 'valid/acc': 79.718, 'valid/acc_unbiased': 74.043, 'valid/diff': 20.288, 'valid/acc_skew': 63.9, 'valid/acc_align': 84.187, 'test/acc': 81.49, 'test/acc_unbiased': 75.794, 'test/diff': 16.171, 'test/acc_skew': 67.708, 'test/acc_align': 83.879}
[14 / 20] best valid accuracy: 75.031 at epoch 13 
 best_stats: {'best_valid_epoch': 13, 'best_valid_valid/acc': 80.026, 'best_valid_valid/acc_unbiased': 75.031, 'best_valid_valid/diff': 19.7, 'best_valid_valid/acc_skew': 65.182, 'best_valid_valid/acc_align': 84.881, 'best_valid_test/acc': 81.534, 'best_valid_test/acc_unbiased': 75.69, 'best_valid_test/diff': 15.165, 'best_valid_test/acc_skew': 68.108, 'best_valid_test/acc_align': 83.273}
[14 / 20] best test accuracy: 77.187 at epoch 12 
 best_stats: {'best_test_epoch': 12, 'best_test_valid/acc': 80.335, 'best_test_valid/acc_unbiased': 74.633, 'best_test_valid/diff': 23.273, 'best_test_valid/acc_skew': 62.996, 'best_test_valid/acc_align': 86.269, 'best_test_test/acc': 82.459, 'best_test_test/acc_unbiased': 77.187, 'best_test_test/diff': 18.932, 'best_test_test/acc_skew': 67.721, 'best_test_test/acc_align': 86.654}
[15 / 20] Learning rate: 1e-05 weight: 0.01
[15 / 20] Loss: 4.196853955467735 CE Loss: 0.3690631671797154 Con Loss: 4.19316333262316
[15 / 20] tensor([[0.974, 0.693],
        [0.672, 0.721]]) {'epoch': 15, 'valid/acc': 80.026, 'valid/acc_unbiased': 74.537, 'valid/diff': 19.893, 'valid/acc_skew': 64.591, 'valid/acc_align': 84.483, 'test/acc': 81.842, 'test/acc_unbiased': 76.511, 'test/diff': 16.46, 'test/acc_skew': 68.281, 'test/acc_align': 84.741}
[15 / 20] best valid accuracy: 75.031 at epoch 13 
 best_stats: {'best_valid_epoch': 13, 'best_valid_valid/acc': 80.026, 'best_valid_valid/acc_unbiased': 75.031, 'best_valid_valid/diff': 19.7, 'best_valid_valid/acc_skew': 65.182, 'best_valid_valid/acc_align': 84.881, 'best_valid_test/acc': 81.534, 'best_valid_test/acc_unbiased': 75.69, 'best_valid_test/diff': 15.165, 'best_valid_test/acc_skew': 68.108, 'best_valid_test/acc_align': 83.273}
[15 / 20] best test accuracy: 77.187 at epoch 12 
 best_stats: {'best_test_epoch': 12, 'best_test_valid/acc': 80.335, 'best_test_valid/acc_unbiased': 74.633, 'best_test_valid/diff': 23.273, 'best_test_valid/acc_skew': 62.996, 'best_test_valid/acc_align': 86.269, 'best_test_test/acc': 82.459, 'best_test_test/acc_unbiased': 77.187, 'best_test_test/diff': 18.932, 'best_test_test/acc_skew': 67.721, 'best_test_test/acc_align': 86.654}
[16 / 20] Learning rate: 1e-05 weight: 0.01
[16 / 20] Loss: 4.140855499351127 CE Loss: 0.36875736880775517 Con Loss: 4.137167915428502
[16 / 20] tensor([[0.973, 0.693],
        [0.690, 0.715]]) {'epoch': 16, 'valid/acc': 80.379, 'valid/acc_unbiased': 74.7, 'valid/diff': 19.974, 'valid/acc_skew': 64.713, 'valid/acc_align': 84.687, 'test/acc': 82.415, 'test/acc_unbiased': 76.768, 'test/diff': 15.245, 'test/acc_skew': 69.146, 'test/acc_align': 84.391}
[16 / 20] best valid accuracy: 75.031 at epoch 13 
 best_stats: {'best_valid_epoch': 13, 'best_valid_valid/acc': 80.026, 'best_valid_valid/acc_unbiased': 75.031, 'best_valid_valid/diff': 19.7, 'best_valid_valid/acc_skew': 65.182, 'best_valid_valid/acc_align': 84.881, 'best_valid_test/acc': 81.534, 'best_valid_test/acc_unbiased': 75.69, 'best_valid_test/diff': 15.165, 'best_valid_test/acc_skew': 68.108, 'best_valid_test/acc_align': 83.273}
[16 / 20] best test accuracy: 77.187 at epoch 12 
 best_stats: {'best_test_epoch': 12, 'best_test_valid/acc': 80.335, 'best_test_valid/acc_unbiased': 74.633, 'best_test_valid/diff': 23.273, 'best_test_valid/acc_skew': 62.996, 'best_test_valid/acc_align': 86.269, 'best_test_test/acc': 82.459, 'best_test_test/acc_unbiased': 77.187, 'best_test_test/diff': 18.932, 'best_test_test/acc_skew': 67.721, 'best_test_test/acc_align': 86.654}
[17 / 20] Learning rate: 1e-05 weight: 0.01
[17 / 20] Loss: 4.165359311227002 CE Loss: 0.3647467335905756 Con Loss: 4.16171183027341
[17 / 20] tensor([[0.974, 0.676],
        [0.689, 0.764]]) {'epoch': 17, 'valid/acc': 80.556, 'valid/acc_unbiased': 74.987, 'valid/diff': 21.574, 'valid/acc_skew': 64.2, 'valid/acc_align': 85.774, 'test/acc': 82.636, 'test/acc_unbiased': 77.549, 'test/diff': 18.626, 'test/acc_skew': 68.236, 'test/acc_align': 86.862}
[17 / 20] best valid accuracy: 75.031 at epoch 13 
 best_stats: {'best_valid_epoch': 13, 'best_valid_valid/acc': 80.026, 'best_valid_valid/acc_unbiased': 75.031, 'best_valid_valid/diff': 19.7, 'best_valid_valid/acc_skew': 65.182, 'best_valid_valid/acc_align': 84.881, 'best_valid_test/acc': 81.534, 'best_valid_test/acc_unbiased': 75.69, 'best_valid_test/diff': 15.165, 'best_valid_test/acc_skew': 68.108, 'best_valid_test/acc_align': 83.273}
[17 / 20] best test accuracy: 77.549 at epoch 17 
 best_stats: {'best_test_epoch': 17, 'best_test_valid/acc': 80.556, 'best_test_valid/acc_unbiased': 74.987, 'best_test_valid/diff': 21.574, 'best_test_valid/acc_skew': 64.2, 'best_test_valid/acc_align': 85.774, 'best_test_test/acc': 82.636, 'best_test_test/acc_unbiased': 77.549, 'best_test_test/diff': 18.626, 'best_test_test/acc_skew': 68.236, 'best_test_test/acc_align': 86.862}
[18 / 20] Learning rate: 1e-05 weight: 0.01
[18 / 20] Loss: 4.167314529954517 CE Loss: 0.3712775500603536 Con Loss: 4.163601746053921
[18 / 20] tensor([[0.975, 0.710],
        [0.679, 0.721]]) {'epoch': 18, 'valid/acc': 80.291, 'valid/acc_unbiased': 74.807, 'valid/diff': 21.139, 'valid/acc_skew': 64.238, 'valid/acc_align': 85.376, 'test/acc': 82.283, 'test/acc_unbiased': 77.134, 'test/diff': 15.309, 'test/acc_skew': 69.479, 'test/acc_align': 84.788}
[18 / 20] best valid accuracy: 75.031 at epoch 13 
 best_stats: {'best_valid_epoch': 13, 'best_valid_valid/acc': 80.026, 'best_valid_valid/acc_unbiased': 75.031, 'best_valid_valid/diff': 19.7, 'best_valid_valid/acc_skew': 65.182, 'best_valid_valid/acc_align': 84.881, 'best_valid_test/acc': 81.534, 'best_valid_test/acc_unbiased': 75.69, 'best_valid_test/diff': 15.165, 'best_valid_test/acc_skew': 68.108, 'best_valid_test/acc_align': 83.273}
[18 / 20] best test accuracy: 77.549 at epoch 17 
 best_stats: {'best_test_epoch': 17, 'best_test_valid/acc': 80.556, 'best_test_valid/acc_unbiased': 74.987, 'best_test_valid/diff': 21.574, 'best_test_valid/acc_skew': 64.2, 'best_test_valid/acc_align': 85.774, 'best_test_test/acc': 82.636, 'best_test_test/acc_unbiased': 77.549, 'best_test_test/diff': 18.626, 'best_test_test/acc_skew': 68.236, 'best_test_test/acc_align': 86.862}
[19 / 20] Learning rate: 1e-05 weight: 0.01
[19 / 20] Loss: 4.197759189127269 CE Loss: 0.3692554486395937 Con Loss: 4.194066620372913
[19 / 20] tensor([[0.974, 0.659],
        [0.690, 0.800]]) {'epoch': 19, 'valid/acc': 80.82, 'valid/acc_unbiased': 75.027, 'valid/diff': 25.95, 'valid/acc_skew': 62.053, 'valid/acc_align': 88.002, 'test/acc': 82.812, 'test/acc_unbiased': 78.061, 'test/diff': 21.239, 'test/acc_skew': 67.441, 'test/acc_align': 88.68}
[19 / 20] best valid accuracy: 75.031 at epoch 13 
 best_stats: {'best_valid_epoch': 13, 'best_valid_valid/acc': 80.026, 'best_valid_valid/acc_unbiased': 75.031, 'best_valid_valid/diff': 19.7, 'best_valid_valid/acc_skew': 65.182, 'best_valid_valid/acc_align': 84.881, 'best_valid_test/acc': 81.534, 'best_valid_test/acc_unbiased': 75.69, 'best_valid_test/diff': 15.165, 'best_valid_test/acc_skew': 68.108, 'best_valid_test/acc_align': 83.273}
[19 / 20] best test accuracy: 78.061 at epoch 19 
 best_stats: {'best_test_epoch': 19, 'best_test_valid/acc': 80.82, 'best_test_valid/acc_unbiased': 75.027, 'best_test_valid/diff': 25.95, 'best_test_valid/acc_skew': 62.053, 'best_test_valid/acc_align': 88.002, 'best_test_test/acc': 82.812, 'best_test_test/acc_unbiased': 78.061, 'best_test_test/diff': 21.239, 'best_test_test/acc_skew': 67.441, 'best_test_test/acc_align': 88.68}
[20 / 20] Learning rate: 1e-05 weight: 0.01
[20 / 20] Loss: 4.196107154569122 CE Loss: 0.3656644361691277 Con Loss: 4.192450524447608
[20 / 20] tensor([[0.975, 0.670],
        [0.693, 0.782]]) {'epoch': 20, 'valid/acc': 80.467, 'valid/acc_unbiased': 74.521, 'valid/diff': 23.992, 'valid/acc_skew': 62.524, 'valid/acc_align': 86.517, 'test/acc': 82.944, 'test/acc_unbiased': 78.0, 'test/diff': 19.636, 'test/acc_skew': 68.182, 'test/acc_align': 87.819}
[20 / 20] best valid accuracy: 75.031 at epoch 13 
 best_stats: {'best_valid_epoch': 13, 'best_valid_valid/acc': 80.026, 'best_valid_valid/acc_unbiased': 75.031, 'best_valid_valid/diff': 19.7, 'best_valid_valid/acc_skew': 65.182, 'best_valid_valid/acc_align': 84.881, 'best_valid_test/acc': 81.534, 'best_valid_test/acc_unbiased': 75.69, 'best_valid_test/diff': 15.165, 'best_valid_test/acc_skew': 68.108, 'best_valid_test/acc_align': 83.273}
[20 / 20] best test accuracy: 78.061 at epoch 19 
 best_stats: {'best_test_epoch': 19, 'best_test_valid/acc': 80.82, 'best_test_valid/acc_unbiased': 75.027, 'best_test_valid/diff': 25.95, 'best_test_valid/acc_skew': 62.053, 'best_test_valid/acc_align': 88.002, 'best_test_test/acc': 82.812, 'best_test_test/acc_unbiased': 78.061, 'best_test_test/diff': 21.239, 'best_test_test/acc_skew': 67.441, 'best_test_test/acc_align': 88.68}
Total training time: 0:50:05
