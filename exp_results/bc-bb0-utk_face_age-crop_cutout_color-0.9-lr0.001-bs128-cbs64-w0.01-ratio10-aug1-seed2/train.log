Log level set to: INFO
Set seed: 2
=======> Using Fixed Random Seed: 2 <========
save_path: exp_results/bc-bb0-utk_face_age-crop_cutout_color-0.9-lr0.001-bs128-cbs64-w0.01-ratio10-aug1-seed2
get_utk_face - split: train, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_age-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
Binary Target 1
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Normal Label Distribution: 
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
Binary Target 1
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Normal Label Distribution: 
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 10684, target_attr: gender, bias_attr: age bias_rate: 0.9
['[train] target_0-bias_0: 8237', '[train] target_0-bias_1: 147', '[train] target_1-bias_0: 823', '[train] target_1-bias_1: 1477']
confusion_matrix - 
 original: tensor([[8237.,  823.],
        [ 147., 1477.]]), 
 normalized: tensor([[0.909, 0.091],
        [0.091, 0.909]]), 
 b|y: tensor([[0.982, 0.018],
        [0.358, 0.642]])
get_utk_face - split: train, aug: 1, given_y: True, ratio: 10
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_age-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
Binary Target 1
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Normal Label Distribution: 
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
Binary Target 1
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Normal Label Distribution: 
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 10684, target_attr: gender, bias_attr: age bias_rate: 0.9
['[train] target_0-bias_0: 8237', '[train] target_0-bias_1: 147', '[train] target_1-bias_0: 823', '[train] target_1-bias_1: 1477']
get_utk_face - split: valid, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_age-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [1030, 195]
Target 1: [841, 202]
Binary Target 1
---------------------------
Target 0: [1030, 195]
Target 1: [841, 202]
===================================
Normal Label Distribution: 
Target 0: [1030, 195]
Target 1: [841, 202]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 2268, target_attr: gender, bias_attr: age bias_rate: 0.9
['[valid] target_0-bias_0: 1030', '[valid] target_0-bias_1: 195', '[valid] target_1-bias_0: 841', '[valid] target_1-bias_1: 202']
get_utk_face - split: test, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_age-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [1061, 176]
Target 1: [867, 165]
Binary Target 1
---------------------------
Target 0: [1061, 176]
Target 1: [867, 165]
===================================
Normal Label Distribution: 
Target 0: [1061, 176]
Target 1: [867, 165]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 2269, target_attr: gender, bias_attr: age bias_rate: 0.9
['[test] target_0-bias_0: 1061', '[test] target_0-bias_1: 176', '[test] target_1-bias_0: 867', '[test] target_1-bias_1: 165']
decay_epochs: [6, 13]
[1 / 20] Learning rate: 0.001 weight: 0.01
[1 / 20] Loss: 4.848001437078295 CE Loss: 0.5721172403637633 Con Loss: 4.842280273980212
[1 / 20] tensor([[1., 1.],
        [0., 0.]]) {'epoch': 1, 'valid/acc': 54.012, 'valid/acc_unbiased': 50.0, 'valid/diff': 0.0, 'valid/acc_skew': 50.0, 'valid/acc_align': 50.0, 'test/acc': 54.517, 'test/acc_unbiased': 50.0, 'test/diff': 0.0, 'test/acc_skew': 50.0, 'test/acc_align': 50.0}
[1 / 20] best valid accuracy: 50.000 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 54.012, 'best_valid_valid/acc_unbiased': 50.0, 'best_valid_valid/diff': 0.0, 'best_valid_valid/acc_skew': 50.0, 'best_valid_valid/acc_align': 50.0, 'best_valid_test/acc': 54.517, 'best_valid_test/acc_unbiased': 50.0, 'best_valid_test/diff': 0.0, 'best_valid_test/acc_skew': 50.0, 'best_valid_test/acc_align': 50.0}
[1 / 20] best test accuracy: 50.000 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 54.012, 'best_test_valid/acc_unbiased': 50.0, 'best_test_valid/diff': 0.0, 'best_test_valid/acc_skew': 50.0, 'best_test_valid/acc_align': 50.0, 'best_test_test/acc': 54.517, 'best_test_test/acc_unbiased': 50.0, 'best_test_test/diff': 0.0, 'best_test_test/acc_skew': 50.0, 'best_test_test/acc_align': 50.0}
[2 / 20] Learning rate: 0.001 weight: 0.01
[2 / 20] Loss: 4.673243515146042 CE Loss: 0.5330298611038591 Con Loss: 4.667913226053002
[2 / 20] tensor([[0.879, 0.903],
        [0.576, 0.176]]) {'epoch': 2, 'valid/acc': 67.328, 'valid/acc_unbiased': 61.261, 'valid/diff': 15.905, 'valid/acc_skew': 69.214, 'valid/acc_align': 53.309, 'test/acc': 71.397, 'test/acc_unbiased': 63.352, 'test/diff': 21.192, 'test/acc_skew': 73.948, 'test/acc_align': 52.756}
[2 / 20] best valid accuracy: 61.261 at epoch 2 
 best_stats: {'best_valid_epoch': 2, 'best_valid_valid/acc': 67.328, 'best_valid_valid/acc_unbiased': 61.261, 'best_valid_valid/diff': 15.905, 'best_valid_valid/acc_skew': 69.214, 'best_valid_valid/acc_align': 53.309, 'best_valid_test/acc': 71.397, 'best_valid_test/acc_unbiased': 63.352, 'best_valid_test/diff': 21.192, 'best_valid_test/acc_skew': 73.948, 'best_valid_test/acc_align': 52.756}
[2 / 20] best test accuracy: 63.352 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 67.328, 'best_test_valid/acc_unbiased': 61.261, 'best_test_valid/diff': 15.905, 'best_test_valid/acc_skew': 69.214, 'best_test_valid/acc_align': 53.309, 'best_test_test/acc': 71.397, 'best_test_test/acc_unbiased': 63.352, 'best_test_test/diff': 21.192, 'best_test_test/acc_skew': 73.948, 'best_test_test/acc_align': 52.756}
[3 / 20] Learning rate: 0.001 weight: 0.01
[3 / 20] Loss: 4.6491254408767455 CE Loss: 0.5179193537362905 Con Loss: 4.643946258462087
[3 / 20] tensor([[0.894, 0.898],
        [0.594, 0.327]]) {'epoch': 3, 'valid/acc': 71.737, 'valid/acc_unbiased': 66.348, 'valid/diff': 12.489, 'valid/acc_skew': 69.422, 'valid/acc_align': 63.273, 'test/acc': 73.865, 'test/acc_unbiased': 67.836, 'test/diff': 13.501, 'test/acc_skew': 74.586, 'test/acc_align': 61.086}
[3 / 20] best valid accuracy: 66.348 at epoch 3 
 best_stats: {'best_valid_epoch': 3, 'best_valid_valid/acc': 71.737, 'best_valid_valid/acc_unbiased': 66.348, 'best_valid_valid/diff': 12.489, 'best_valid_valid/acc_skew': 69.422, 'best_valid_valid/acc_align': 63.273, 'best_valid_test/acc': 73.865, 'best_valid_test/acc_unbiased': 67.836, 'best_valid_test/diff': 13.501, 'best_valid_test/acc_skew': 74.586, 'best_valid_test/acc_align': 61.086}
[3 / 20] best test accuracy: 67.836 at epoch 3 
 best_stats: {'best_test_epoch': 3, 'best_test_valid/acc': 71.737, 'best_test_valid/acc_unbiased': 66.348, 'best_test_valid/diff': 12.489, 'best_test_valid/acc_skew': 69.422, 'best_test_valid/acc_align': 63.273, 'best_test_test/acc': 73.865, 'best_test_test/acc_unbiased': 67.836, 'best_test_test/diff': 13.501, 'best_test_test/acc_skew': 74.586, 'best_test_test/acc_align': 61.086}
[4 / 20] Learning rate: 0.001 weight: 0.01
[4 / 20] Loss: 4.637311119392364 CE Loss: 0.5030405096617677 Con Loss: 4.632280704636826
[4 / 20] tensor([[0.979, 0.960],
        [0.373, 0.158]]) {'epoch': 4, 'valid/acc': 66.314, 'valid/acc_unbiased': 60.986, 'valid/diff': 8.288, 'valid/acc_skew': 63.488, 'valid/acc_align': 58.484, 'test/acc': 68.621, 'test/acc_unbiased': 61.74, 'test/diff': 11.701, 'test/acc_skew': 66.639, 'test/acc_align': 56.842}
[4 / 20] best valid accuracy: 66.348 at epoch 3 
 best_stats: {'best_valid_epoch': 3, 'best_valid_valid/acc': 71.737, 'best_valid_valid/acc_unbiased': 66.348, 'best_valid_valid/diff': 12.489, 'best_valid_valid/acc_skew': 69.422, 'best_valid_valid/acc_align': 63.273, 'best_valid_test/acc': 73.865, 'best_valid_test/acc_unbiased': 67.836, 'best_valid_test/diff': 13.501, 'best_valid_test/acc_skew': 74.586, 'best_valid_test/acc_align': 61.086}
[4 / 20] best test accuracy: 67.836 at epoch 3 
 best_stats: {'best_test_epoch': 3, 'best_test_valid/acc': 71.737, 'best_test_valid/acc_unbiased': 66.348, 'best_test_valid/diff': 12.489, 'best_test_valid/acc_skew': 69.422, 'best_test_valid/acc_align': 63.273, 'best_test_test/acc': 73.865, 'best_test_test/acc_unbiased': 67.836, 'best_test_test/diff': 13.501, 'best_test_test/acc_skew': 74.586, 'best_test_test/acc_align': 61.086}
[5 / 20] Learning rate: 0.001 weight: 0.01
[5 / 20] Loss: 4.630765262590906 CE Loss: 0.4897570577577365 Con Loss: 4.625867665104097
[5 / 20] tensor([[0.936, 0.909],
        [0.540, 0.285]]) {'epoch': 5, 'valid/acc': 71.473, 'valid/acc_unbiased': 66.885, 'valid/diff': 8.4, 'valid/acc_skew': 68.516, 'valid/acc_align': 65.254, 'test/acc': 73.513, 'test/acc_unbiased': 66.741, 'test/diff': 14.088, 'test/acc_skew': 72.444, 'test/acc_align': 61.038}
[5 / 20] best valid accuracy: 66.885 at epoch 5 
 best_stats: {'best_valid_epoch': 5, 'best_valid_valid/acc': 71.473, 'best_valid_valid/acc_unbiased': 66.885, 'best_valid_valid/diff': 8.4, 'best_valid_valid/acc_skew': 68.516, 'best_valid_valid/acc_align': 65.254, 'best_valid_test/acc': 73.513, 'best_valid_test/acc_unbiased': 66.741, 'best_valid_test/diff': 14.088, 'best_valid_test/acc_skew': 72.444, 'best_valid_test/acc_align': 61.038}
[5 / 20] best test accuracy: 67.836 at epoch 3 
 best_stats: {'best_test_epoch': 3, 'best_test_valid/acc': 71.737, 'best_test_valid/acc_unbiased': 66.348, 'best_test_valid/diff': 12.489, 'best_test_valid/acc_skew': 69.422, 'best_test_valid/acc_align': 63.273, 'best_test_test/acc': 73.865, 'best_test_test/acc_unbiased': 67.836, 'best_test_test/diff': 13.501, 'best_test_test/acc_skew': 74.586, 'best_test_test/acc_align': 61.086}
[6 / 20] Learning rate: 0.001 weight: 0.01
[6 / 20] Loss: 4.608916442611163 CE Loss: 0.46554271460070407 Con Loss: 4.604261016274427
[6 / 20] tensor([[0.971, 0.881],
        [0.524, 0.309]]) {'epoch': 6, 'valid/acc': 71.076, 'valid/acc_unbiased': 65.843, 'valid/diff': 9.429, 'valid/acc_skew': 64.383, 'valid/acc_align': 67.302, 'test/acc': 74.482, 'test/acc_unbiased': 67.105, 'test/diff': 15.233, 'test/acc_skew': 70.216, 'test/acc_align': 63.994}
[6 / 20] best valid accuracy: 66.885 at epoch 5 
 best_stats: {'best_valid_epoch': 5, 'best_valid_valid/acc': 71.473, 'best_valid_valid/acc_unbiased': 66.885, 'best_valid_valid/diff': 8.4, 'best_valid_valid/acc_skew': 68.516, 'best_valid_valid/acc_align': 65.254, 'best_valid_test/acc': 73.513, 'best_valid_test/acc_unbiased': 66.741, 'best_valid_test/diff': 14.088, 'best_valid_test/acc_skew': 72.444, 'best_valid_test/acc_align': 61.038}
[6 / 20] best test accuracy: 67.836 at epoch 3 
 best_stats: {'best_test_epoch': 3, 'best_test_valid/acc': 71.737, 'best_test_valid/acc_unbiased': 66.348, 'best_test_valid/diff': 12.489, 'best_test_valid/acc_skew': 69.422, 'best_test_valid/acc_align': 63.273, 'best_test_test/acc': 73.865, 'best_test_test/acc_unbiased': 67.836, 'best_test_test/diff': 13.501, 'best_test_test/acc_skew': 74.586, 'best_test_test/acc_align': 61.086}
[7 / 20] Learning rate: 0.0001 weight: 0.01
[7 / 20] Loss: 4.530115978586589 CE Loss: 0.43376378579471764 Con Loss: 4.52577832020967
[7 / 20] tensor([[0.953, 0.693],
        [0.638, 0.624]]) {'epoch': 7, 'valid/acc': 75.926, 'valid/acc_unbiased': 70.877, 'valid/diff': 13.478, 'valid/acc_skew': 64.138, 'valid/acc_align': 77.616, 'test/acc': 78.845, 'test/acc_unbiased': 72.703, 'test/diff': 13.664, 'test/acc_skew': 66.551, 'test/acc_align': 78.856}
[7 / 20] best valid accuracy: 70.877 at epoch 7 
 best_stats: {'best_valid_epoch': 7, 'best_valid_valid/acc': 75.926, 'best_valid_valid/acc_unbiased': 70.877, 'best_valid_valid/diff': 13.478, 'best_valid_valid/acc_skew': 64.138, 'best_valid_valid/acc_align': 77.616, 'best_valid_test/acc': 78.845, 'best_valid_test/acc_unbiased': 72.703, 'best_valid_test/diff': 13.664, 'best_valid_test/acc_skew': 66.551, 'best_valid_test/acc_align': 78.856}
[7 / 20] best test accuracy: 72.703 at epoch 7 
 best_stats: {'best_test_epoch': 7, 'best_test_valid/acc': 75.926, 'best_test_valid/acc_unbiased': 70.877, 'best_test_valid/diff': 13.478, 'best_test_valid/acc_skew': 64.138, 'best_test_valid/acc_align': 77.616, 'best_test_test/acc': 78.845, 'best_test_test/acc_unbiased': 72.703, 'best_test_test/diff': 13.664, 'best_test_test/acc_skew': 66.551, 'best_test_test/acc_align': 78.856}
[8 / 20] Learning rate: 0.0001 weight: 0.01
[8 / 20] Loss: 4.4899140004136955 CE Loss: 0.4308126300227459 Con Loss: 4.485605896478822
[8 / 20] tensor([[0.945, 0.625],
        [0.684, 0.685]]) {'epoch': 8, 'valid/acc': 77.16, 'valid/acc_unbiased': 71.068, 'valid/diff': 18.483, 'valid/acc_skew': 61.826, 'valid/acc_align': 80.309, 'test/acc': 80.167, 'test/acc_unbiased': 73.479, 'test/diff': 16.061, 'test/acc_skew': 65.448, 'test/acc_align': 81.509}
[8 / 20] best valid accuracy: 71.068 at epoch 8 
 best_stats: {'best_valid_epoch': 8, 'best_valid_valid/acc': 77.16, 'best_valid_valid/acc_unbiased': 71.068, 'best_valid_valid/diff': 18.483, 'best_valid_valid/acc_skew': 61.826, 'best_valid_valid/acc_align': 80.309, 'best_valid_test/acc': 80.167, 'best_valid_test/acc_unbiased': 73.479, 'best_valid_test/diff': 16.061, 'best_valid_test/acc_skew': 65.448, 'best_valid_test/acc_align': 81.509}
[8 / 20] best test accuracy: 73.479 at epoch 8 
 best_stats: {'best_test_epoch': 8, 'best_test_valid/acc': 77.16, 'best_test_valid/acc_unbiased': 71.068, 'best_test_valid/diff': 18.483, 'best_test_valid/acc_skew': 61.826, 'best_test_valid/acc_align': 80.309, 'best_test_test/acc': 80.167, 'best_test_test/acc_unbiased': 73.479, 'best_test_test/diff': 16.061, 'best_test_test/acc_skew': 65.448, 'best_test_test/acc_align': 81.509}
[9 / 20] Learning rate: 0.0001 weight: 0.01
[9 / 20] Loss: 4.464524733980065 CE Loss: 0.4173117923584827 Con Loss: 4.460351604060349
[9 / 20] tensor([[0.966, 0.625],
        [0.626, 0.715]]) {'epoch': 9, 'valid/acc': 76.499, 'valid/acc_unbiased': 70.821, 'valid/diff': 25.354, 'valid/acc_skew': 58.144, 'valid/acc_align': 83.498, 'test/acc': 79.154, 'test/acc_unbiased': 73.313, 'test/diff': 21.496, 'test/acc_skew': 62.565, 'test/acc_align': 84.061}
[9 / 20] best valid accuracy: 71.068 at epoch 8 
 best_stats: {'best_valid_epoch': 8, 'best_valid_valid/acc': 77.16, 'best_valid_valid/acc_unbiased': 71.068, 'best_valid_valid/diff': 18.483, 'best_valid_valid/acc_skew': 61.826, 'best_valid_valid/acc_align': 80.309, 'best_valid_test/acc': 80.167, 'best_valid_test/acc_unbiased': 73.479, 'best_valid_test/diff': 16.061, 'best_valid_test/acc_skew': 65.448, 'best_valid_test/acc_align': 81.509}
[9 / 20] best test accuracy: 73.479 at epoch 8 
 best_stats: {'best_test_epoch': 8, 'best_test_valid/acc': 77.16, 'best_test_valid/acc_unbiased': 71.068, 'best_test_valid/diff': 18.483, 'best_test_valid/acc_skew': 61.826, 'best_test_valid/acc_align': 80.309, 'best_test_test/acc': 80.167, 'best_test_test/acc_unbiased': 73.479, 'best_test_test/diff': 16.061, 'best_test_test/acc_skew': 65.448, 'best_test_test/acc_align': 81.509}
[10 / 20] Learning rate: 0.0001 weight: 0.01
[10 / 20] Loss: 4.440715222089133 CE Loss: 0.4118786917023782 Con Loss: 4.436596427861781
[10 / 20] tensor([[0.960, 0.682],
        [0.640, 0.648]]) {'epoch': 10, 'valid/acc': 76.279, 'valid/acc_unbiased': 70.541, 'valid/diff': 20.574, 'valid/acc_skew': 60.254, 'valid/acc_align': 80.829, 'test/acc': 79.374, 'test/acc_unbiased': 73.271, 'test/diff': 14.347, 'test/acc_skew': 66.098, 'test/acc_align': 80.445}
[10 / 20] best valid accuracy: 71.068 at epoch 8 
 best_stats: {'best_valid_epoch': 8, 'best_valid_valid/acc': 77.16, 'best_valid_valid/acc_unbiased': 71.068, 'best_valid_valid/diff': 18.483, 'best_valid_valid/acc_skew': 61.826, 'best_valid_valid/acc_align': 80.309, 'best_valid_test/acc': 80.167, 'best_valid_test/acc_unbiased': 73.479, 'best_valid_test/diff': 16.061, 'best_valid_test/acc_skew': 65.448, 'best_valid_test/acc_align': 81.509}
[10 / 20] best test accuracy: 73.479 at epoch 8 
 best_stats: {'best_test_epoch': 8, 'best_test_valid/acc': 77.16, 'best_test_valid/acc_unbiased': 71.068, 'best_test_valid/diff': 18.483, 'best_test_valid/acc_skew': 61.826, 'best_test_valid/acc_align': 80.309, 'best_test_test/acc': 80.167, 'best_test_test/acc_unbiased': 73.479, 'best_test_test/diff': 16.061, 'best_test_test/acc_skew': 65.448, 'best_test_test/acc_align': 81.509}
[11 / 20] Learning rate: 0.0001 weight: 0.01
[11 / 20] Loss: 4.387161319151392 CE Loss: 0.4087333186361862 Con Loss: 4.383073974575098
[11 / 20] tensor([[0.967, 0.636],
        [0.629, 0.715]]) {'epoch': 11, 'valid/acc': 76.764, 'valid/acc_unbiased': 70.616, 'valid/diff': 23.086, 'valid/acc_skew': 59.073, 'valid/acc_align': 82.159, 'test/acc': 79.374, 'test/acc_unbiased': 73.678, 'test/diff': 20.86, 'test/acc_skew': 63.248, 'test/acc_align': 84.108}
[11 / 20] best valid accuracy: 71.068 at epoch 8 
 best_stats: {'best_valid_epoch': 8, 'best_valid_valid/acc': 77.16, 'best_valid_valid/acc_unbiased': 71.068, 'best_valid_valid/diff': 18.483, 'best_valid_valid/acc_skew': 61.826, 'best_valid_valid/acc_align': 80.309, 'best_valid_test/acc': 80.167, 'best_valid_test/acc_unbiased': 73.479, 'best_valid_test/diff': 16.061, 'best_valid_test/acc_skew': 65.448, 'best_valid_test/acc_align': 81.509}
[11 / 20] best test accuracy: 73.678 at epoch 11 
 best_stats: {'best_test_epoch': 11, 'best_test_valid/acc': 76.764, 'best_test_valid/acc_unbiased': 70.616, 'best_test_valid/diff': 23.086, 'best_test_valid/acc_skew': 59.073, 'best_test_valid/acc_align': 82.159, 'best_test_test/acc': 79.374, 'best_test_test/acc_unbiased': 73.678, 'best_test_test/diff': 20.86, 'best_test_test/acc_skew': 63.248, 'best_test_test/acc_align': 84.108}
[12 / 20] Learning rate: 0.0001 weight: 0.01
[12 / 20] Loss: 4.443170871327585 CE Loss: 0.3966742068897334 Con Loss: 4.439204118529405
[12 / 20] tensor([[0.964, 0.585],
        [0.652, 0.800]]) {'epoch': 12, 'valid/acc': 77.425, 'valid/acc_unbiased': 70.212, 'valid/diff': 33.309, 'valid/acc_skew': 53.558, 'valid/acc_align': 86.866, 'test/acc': 80.344, 'test/acc_unbiased': 75.027, 'test/diff': 26.364, 'test/acc_skew': 61.845, 'test/acc_align': 88.209}
[12 / 20] best valid accuracy: 71.068 at epoch 8 
 best_stats: {'best_valid_epoch': 8, 'best_valid_valid/acc': 77.16, 'best_valid_valid/acc_unbiased': 71.068, 'best_valid_valid/diff': 18.483, 'best_valid_valid/acc_skew': 61.826, 'best_valid_valid/acc_align': 80.309, 'best_valid_test/acc': 80.167, 'best_valid_test/acc_unbiased': 73.479, 'best_valid_test/diff': 16.061, 'best_valid_test/acc_skew': 65.448, 'best_valid_test/acc_align': 81.509}
[12 / 20] best test accuracy: 75.027 at epoch 12 
 best_stats: {'best_test_epoch': 12, 'best_test_valid/acc': 77.425, 'best_test_valid/acc_unbiased': 70.212, 'best_test_valid/diff': 33.309, 'best_test_valid/acc_skew': 53.558, 'best_test_valid/acc_align': 86.866, 'best_test_test/acc': 80.344, 'best_test_test/acc_unbiased': 75.027, 'best_test_test/diff': 26.364, 'best_test_test/acc_skew': 61.845, 'best_test_test/acc_align': 88.209}
[13 / 20] Learning rate: 0.0001 weight: 0.01
[13 / 20] Loss: 4.383138703210931 CE Loss: 0.40377379782589934 Con Loss: 4.379100978441428
[13 / 20] tensor([[0.957, 0.494],
        [0.684, 0.812]]) {'epoch': 13, 'valid/acc': 78.616, 'valid/acc_unbiased': 71.898, 'valid/diff': 35.402, 'valid/acc_skew': 54.197, 'valid/acc_align': 89.599, 'test/acc': 80.608, 'test/acc_unbiased': 73.676, 'test/diff': 29.524, 'test/acc_skew': 58.914, 'test/acc_align': 88.438}
[13 / 20] best valid accuracy: 71.898 at epoch 13 
 best_stats: {'best_valid_epoch': 13, 'best_valid_valid/acc': 78.616, 'best_valid_valid/acc_unbiased': 71.898, 'best_valid_valid/diff': 35.402, 'best_valid_valid/acc_skew': 54.197, 'best_valid_valid/acc_align': 89.599, 'best_valid_test/acc': 80.608, 'best_valid_test/acc_unbiased': 73.676, 'best_valid_test/diff': 29.524, 'best_valid_test/acc_skew': 58.914, 'best_valid_test/acc_align': 88.438}
[13 / 20] best test accuracy: 75.027 at epoch 12 
 best_stats: {'best_test_epoch': 12, 'best_test_valid/acc': 77.425, 'best_test_valid/acc_unbiased': 70.212, 'best_test_valid/diff': 33.309, 'best_test_valid/acc_skew': 53.558, 'best_test_valid/acc_align': 86.866, 'best_test_test/acc': 80.344, 'best_test_test/acc_unbiased': 75.027, 'best_test_test/diff': 26.364, 'best_test_test/acc_skew': 61.845, 'best_test_test/acc_align': 88.209}
[14 / 20] Learning rate: 1e-05 weight: 0.01
[14 / 20] Loss: 4.388085200517912 CE Loss: 0.38805384260578935 Con Loss: 4.384204665090832
[14 / 20] tensor([[0.967, 0.642],
        [0.651, 0.752]]) {'epoch': 14, 'valid/acc': 77.646, 'valid/acc_unbiased': 71.76, 'valid/diff': 26.942, 'valid/acc_skew': 58.288, 'valid/acc_align': 85.231, 'test/acc': 80.52, 'test/acc_unbiased': 75.277, 'test/diff': 21.298, 'test/acc_skew': 64.628, 'test/acc_align': 85.926}
[14 / 20] best valid accuracy: 71.898 at epoch 13 
 best_stats: {'best_valid_epoch': 13, 'best_valid_valid/acc': 78.616, 'best_valid_valid/acc_unbiased': 71.898, 'best_valid_valid/diff': 35.402, 'best_valid_valid/acc_skew': 54.197, 'best_valid_valid/acc_align': 89.599, 'best_valid_test/acc': 80.608, 'best_valid_test/acc_unbiased': 73.676, 'best_valid_test/diff': 29.524, 'best_valid_test/acc_skew': 58.914, 'best_valid_test/acc_align': 88.438}
[14 / 20] best test accuracy: 75.277 at epoch 14 
 best_stats: {'best_test_epoch': 14, 'best_test_valid/acc': 77.646, 'best_test_valid/acc_unbiased': 71.76, 'best_test_valid/diff': 26.942, 'best_test_valid/acc_skew': 58.288, 'best_test_valid/acc_align': 85.231, 'best_test_test/acc': 80.52, 'best_test_test/acc_unbiased': 75.277, 'best_test_test/diff': 21.298, 'best_test_test/acc_skew': 64.628, 'best_test_test/acc_align': 85.926}
[15 / 20] Learning rate: 1e-05 weight: 0.01
[15 / 20] Loss: 4.370261168399583 CE Loss: 0.3918496575394805 Con Loss: 4.366342658810917
[15 / 20] tensor([[0.965, 0.631],
        [0.660, 0.758]]) {'epoch': 15, 'valid/acc': 77.998, 'valid/acc_unbiased': 72.317, 'valid/diff': 26.236, 'valid/acc_skew': 59.199, 'valid/acc_align': 85.434, 'test/acc': 80.74, 'test/acc_unbiased': 75.328, 'test/diff': 21.614, 'test/acc_skew': 64.521, 'test/acc_align': 86.135}
[15 / 20] best valid accuracy: 72.317 at epoch 15 
 best_stats: {'best_valid_epoch': 15, 'best_valid_valid/acc': 77.998, 'best_valid_valid/acc_unbiased': 72.317, 'best_valid_valid/diff': 26.236, 'best_valid_valid/acc_skew': 59.199, 'best_valid_valid/acc_align': 85.434, 'best_valid_test/acc': 80.74, 'best_valid_test/acc_unbiased': 75.328, 'best_valid_test/diff': 21.614, 'best_valid_test/acc_skew': 64.521, 'best_valid_test/acc_align': 86.135}
[15 / 20] best test accuracy: 75.328 at epoch 15 
 best_stats: {'best_test_epoch': 15, 'best_test_valid/acc': 77.998, 'best_test_valid/acc_unbiased': 72.317, 'best_test_valid/diff': 26.236, 'best_test_valid/acc_skew': 59.199, 'best_test_valid/acc_align': 85.434, 'best_test_test/acc': 80.74, 'best_test_test/acc_unbiased': 75.328, 'best_test_test/diff': 21.614, 'best_test_test/acc_skew': 64.521, 'best_test_test/acc_align': 86.135}
[16 / 20] Learning rate: 1e-05 weight: 0.01
[16 / 20] Loss: 4.341995250504814 CE Loss: 0.3937446028942564 Con Loss: 4.3380577986448365
[16 / 20] tensor([[0.970, 0.648],
        [0.649, 0.758]]) {'epoch': 16, 'valid/acc': 77.69, 'valid/acc_unbiased': 71.99, 'valid/diff': 25.589, 'valid/acc_skew': 59.195, 'valid/acc_align': 84.784, 'test/acc': 80.696, 'test/acc_unbiased': 75.613, 'test/diff': 21.516, 'test/acc_skew': 64.855, 'test/acc_align': 86.371}
[16 / 20] best valid accuracy: 72.317 at epoch 15 
 best_stats: {'best_valid_epoch': 15, 'best_valid_valid/acc': 77.998, 'best_valid_valid/acc_unbiased': 72.317, 'best_valid_valid/diff': 26.236, 'best_valid_valid/acc_skew': 59.199, 'best_valid_valid/acc_align': 85.434, 'best_valid_test/acc': 80.74, 'best_valid_test/acc_unbiased': 75.328, 'best_valid_test/diff': 21.614, 'best_valid_test/acc_skew': 64.521, 'best_valid_test/acc_align': 86.135}
[16 / 20] best test accuracy: 75.613 at epoch 16 
 best_stats: {'best_test_epoch': 16, 'best_test_valid/acc': 77.69, 'best_test_valid/acc_unbiased': 71.99, 'best_test_valid/diff': 25.589, 'best_test_valid/acc_skew': 59.195, 'best_test_valid/acc_align': 84.784, 'best_test_test/acc': 80.696, 'best_test_test/acc_unbiased': 75.613, 'best_test_test/diff': 21.516, 'best_test_test/acc_skew': 64.855, 'best_test_test/acc_align': 86.371}
[17 / 20] Learning rate: 1e-05 weight: 0.01
[17 / 20] Loss: 4.398829338569312 CE Loss: 0.39602047975971116 Con Loss: 4.394869143844142
[17 / 20] tensor([[0.969, 0.653],
        [0.639, 0.727]]) {'epoch': 17, 'valid/acc': 77.734, 'valid/acc_unbiased': 72.391, 'valid/diff': 25.174, 'valid/acc_skew': 59.805, 'valid/acc_align': 84.978, 'test/acc': 80.079, 'test/acc_unbiased': 74.714, 'test/diff': 20.189, 'test/acc_skew': 64.62, 'test/acc_align': 84.809}
[17 / 20] best valid accuracy: 72.391 at epoch 17 
 best_stats: {'best_valid_epoch': 17, 'best_valid_valid/acc': 77.734, 'best_valid_valid/acc_unbiased': 72.391, 'best_valid_valid/diff': 25.174, 'best_valid_valid/acc_skew': 59.805, 'best_valid_valid/acc_align': 84.978, 'best_valid_test/acc': 80.079, 'best_valid_test/acc_unbiased': 74.714, 'best_valid_test/diff': 20.189, 'best_valid_test/acc_skew': 64.62, 'best_valid_test/acc_align': 84.809}
[17 / 20] best test accuracy: 75.613 at epoch 16 
 best_stats: {'best_test_epoch': 16, 'best_test_valid/acc': 77.69, 'best_test_valid/acc_unbiased': 71.99, 'best_test_valid/diff': 25.589, 'best_test_valid/acc_skew': 59.195, 'best_test_valid/acc_align': 84.784, 'best_test_test/acc': 80.696, 'best_test_test/acc_unbiased': 75.613, 'best_test_test/diff': 21.516, 'best_test_test/acc_skew': 64.855, 'best_test_test/acc_align': 86.371}
[18 / 20] Learning rate: 1e-05 weight: 0.01
[18 / 20] Loss: 4.342258463902047 CE Loss: 0.3843108027314301 Con Loss: 4.33841534689186
[18 / 20] tensor([[0.967, 0.585],
        [0.664, 0.806]]) {'epoch': 18, 'valid/acc': 78.042, 'valid/acc_unbiased': 71.7, 'valid/diff': 30.13, 'valid/acc_skew': 56.635, 'valid/acc_align': 86.764, 'test/acc': 81.005, 'test/acc_unbiased': 75.566, 'test/diff': 26.174, 'test/acc_skew': 62.479, 'test/acc_align': 88.654}
[18 / 20] best valid accuracy: 72.391 at epoch 17 
 best_stats: {'best_valid_epoch': 17, 'best_valid_valid/acc': 77.734, 'best_valid_valid/acc_unbiased': 72.391, 'best_valid_valid/diff': 25.174, 'best_valid_valid/acc_skew': 59.805, 'best_valid_valid/acc_align': 84.978, 'best_valid_test/acc': 80.079, 'best_valid_test/acc_unbiased': 74.714, 'best_valid_test/diff': 20.189, 'best_valid_test/acc_skew': 64.62, 'best_valid_test/acc_align': 84.809}
[18 / 20] best test accuracy: 75.613 at epoch 16 
 best_stats: {'best_test_epoch': 16, 'best_test_valid/acc': 77.69, 'best_test_valid/acc_unbiased': 71.99, 'best_test_valid/diff': 25.589, 'best_test_valid/acc_skew': 59.195, 'best_test_valid/acc_align': 84.784, 'best_test_test/acc': 80.696, 'best_test_test/acc_unbiased': 75.613, 'best_test_test/diff': 21.516, 'best_test_test/acc_skew': 64.855, 'best_test_test/acc_align': 86.371}
[19 / 20] Learning rate: 1e-05 weight: 0.01
[19 / 20] Loss: 4.343694821318095 CE Loss: 0.38592958575284064 Con Loss: 4.339835521658009
[19 / 20] tensor([[0.969, 0.568],
        [0.672, 0.812]]) {'epoch': 19, 'valid/acc': 78.263, 'valid/acc_unbiased': 72.242, 'valid/diff': 31.132, 'valid/acc_skew': 56.676, 'valid/acc_align': 87.808, 'test/acc': 81.313, 'test/acc_unbiased': 75.541, 'test/diff': 27.02, 'test/acc_skew': 62.031, 'test/acc_align': 89.051}
[19 / 20] best valid accuracy: 72.391 at epoch 17 
 best_stats: {'best_valid_epoch': 17, 'best_valid_valid/acc': 77.734, 'best_valid_valid/acc_unbiased': 72.391, 'best_valid_valid/diff': 25.174, 'best_valid_valid/acc_skew': 59.805, 'best_valid_valid/acc_align': 84.978, 'best_valid_test/acc': 80.079, 'best_valid_test/acc_unbiased': 74.714, 'best_valid_test/diff': 20.189, 'best_valid_test/acc_skew': 64.62, 'best_valid_test/acc_align': 84.809}
[19 / 20] best test accuracy: 75.613 at epoch 16 
 best_stats: {'best_test_epoch': 16, 'best_test_valid/acc': 77.69, 'best_test_valid/acc_unbiased': 71.99, 'best_test_valid/diff': 25.589, 'best_test_valid/acc_skew': 59.195, 'best_test_valid/acc_align': 84.784, 'best_test_test/acc': 80.696, 'best_test_test/acc_unbiased': 75.613, 'best_test_test/diff': 21.516, 'best_test_test/acc_skew': 64.855, 'best_test_test/acc_align': 86.371}
[20 / 20] Learning rate: 1e-05 weight: 0.01
[20 / 20] Loss: 4.316779121304665 CE Loss: 0.3883074218416339 Con Loss: 4.312896040484772
[20 / 20] tensor([[0.969, 0.625],
        [0.660, 0.776]]) {'epoch': 20, 'valid/acc': 78.395, 'valid/acc_unbiased': 72.22, 'valid/diff': 28.487, 'valid/acc_skew': 57.976, 'valid/acc_align': 86.464, 'test/acc': 81.005, 'test/acc_unbiased': 75.735, 'test/diff': 22.995, 'test/acc_skew': 64.237, 'test/acc_align': 87.233}
[20 / 20] best valid accuracy: 72.391 at epoch 17 
 best_stats: {'best_valid_epoch': 17, 'best_valid_valid/acc': 77.734, 'best_valid_valid/acc_unbiased': 72.391, 'best_valid_valid/diff': 25.174, 'best_valid_valid/acc_skew': 59.805, 'best_valid_valid/acc_align': 84.978, 'best_valid_test/acc': 80.079, 'best_valid_test/acc_unbiased': 74.714, 'best_valid_test/diff': 20.189, 'best_valid_test/acc_skew': 64.62, 'best_valid_test/acc_align': 84.809}
[20 / 20] best test accuracy: 75.735 at epoch 20 
 best_stats: {'best_test_epoch': 20, 'best_test_valid/acc': 78.395, 'best_test_valid/acc_unbiased': 72.22, 'best_test_valid/diff': 28.487, 'best_test_valid/acc_skew': 57.976, 'best_test_valid/acc_align': 86.464, 'best_test_test/acc': 81.005, 'best_test_test/acc_unbiased': 75.735, 'best_test_test/diff': 22.995, 'best_test_test/acc_skew': 64.237, 'best_test_test/acc_align': 87.233}
Total training time: 0:16:27
