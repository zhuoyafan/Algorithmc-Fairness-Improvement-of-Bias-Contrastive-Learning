Log level set to: INFO
Set seed: 2
=======> Using Fixed Random Seed: 2 <========
save_path: exp_results/bc-bb0-utk_face_age-crop-0.9-lr0.001-bs128-cbs64-w0.01-ratio10-aug1-seed2
get_utk_face - split: train, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_age-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
Binary Target 1
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Normal Label Distribution: 
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
Binary Target 1
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Normal Label Distribution: 
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 10684, target_attr: gender, bias_attr: age bias_rate: 0.9
['[train] target_0-bias_0: 8237', '[train] target_0-bias_1: 147', '[train] target_1-bias_0: 823', '[train] target_1-bias_1: 1477']
confusion_matrix - 
 original: tensor([[8237.,  823.],
        [ 147., 1477.]]), 
 normalized: tensor([[0.909, 0.091],
        [0.091, 0.909]]), 
 b|y: tensor([[0.982, 0.018],
        [0.358, 0.642]])
get_utk_face - split: train, aug: 1, given_y: True, ratio: 10
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_age-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
Binary Target 1
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Normal Label Distribution: 
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
Binary Target 1
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Normal Label Distribution: 
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 10684, target_attr: gender, bias_attr: age bias_rate: 0.9
['[train] target_0-bias_0: 8237', '[train] target_0-bias_1: 147', '[train] target_1-bias_0: 823', '[train] target_1-bias_1: 1477']
get_utk_face - split: valid, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_age-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [1030, 195]
Target 1: [841, 202]
Binary Target 1
---------------------------
Target 0: [1030, 195]
Target 1: [841, 202]
===================================
Normal Label Distribution: 
Target 0: [1030, 195]
Target 1: [841, 202]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 2268, target_attr: gender, bias_attr: age bias_rate: 0.9
['[valid] target_0-bias_0: 1030', '[valid] target_0-bias_1: 195', '[valid] target_1-bias_0: 841', '[valid] target_1-bias_1: 202']
get_utk_face - split: test, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_age-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [1061, 176]
Target 1: [867, 165]
Binary Target 1
---------------------------
Target 0: [1061, 176]
Target 1: [867, 165]
===================================
Normal Label Distribution: 
Target 0: [1061, 176]
Target 1: [867, 165]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 2269, target_attr: gender, bias_attr: age bias_rate: 0.9
['[test] target_0-bias_0: 1061', '[test] target_0-bias_1: 176', '[test] target_1-bias_0: 867', '[test] target_1-bias_1: 165']
decay_epochs: [6, 13]
[1 / 20] Learning rate: 0.001 weight: 0.01
[1 / 20] Loss: 4.752718453816107 CE Loss: 0.5751969095965264 Con Loss: 4.746966487323243
[1 / 20] tensor([[0.991, 0.966],
        [0.211, 0.133]]) {'epoch': 1, 'valid/acc': 62.037, 'valid/acc_unbiased': 57.098, 'valid/diff': 5.48, 'valid/acc_skew': 57.405, 'valid/acc_align': 56.79, 'test/acc': 62.847, 'test/acc_unbiased': 57.522, 'test/diff': 5.12, 'test/acc_skew': 58.849, 'test/acc_align': 56.195}
[1 / 20] best valid accuracy: 57.098 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 62.037, 'best_valid_valid/acc_unbiased': 57.098, 'best_valid_valid/diff': 5.48, 'best_valid_valid/acc_skew': 57.405, 'best_valid_valid/acc_align': 56.79, 'best_valid_test/acc': 62.847, 'best_valid_test/acc_unbiased': 57.522, 'best_valid_test/diff': 5.12, 'best_valid_test/acc_skew': 58.849, 'best_valid_test/acc_align': 56.195}
[1 / 20] best test accuracy: 57.522 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 62.037, 'best_test_valid/acc_unbiased': 57.098, 'best_test_valid/diff': 5.48, 'best_test_valid/acc_skew': 57.405, 'best_test_valid/acc_align': 56.79, 'best_test_test/acc': 62.847, 'best_test_test/acc_unbiased': 57.522, 'best_test_test/diff': 5.12, 'best_test_test/acc_skew': 58.849, 'best_test_test/acc_align': 56.195}
[2 / 20] Learning rate: 0.001 weight: 0.01
[2 / 20] Loss: 4.550950975464507 CE Loss: 0.5285538342149907 Con Loss: 4.5456654562212835
[2 / 20] tensor([[0.923, 0.864],
        [0.536, 0.309]]) {'epoch': 2, 'valid/acc': 70.326, 'valid/acc_unbiased': 66.006, 'valid/diff': 7.74, 'valid/acc_skew': 66.739, 'valid/acc_align': 65.273, 'test/acc': 72.587, 'test/acc_unbiased': 65.794, 'test/diff': 14.316, 'test/acc_skew': 69.998, 'test/acc_align': 61.59}
[2 / 20] best valid accuracy: 66.006 at epoch 2 
 best_stats: {'best_valid_epoch': 2, 'best_valid_valid/acc': 70.326, 'best_valid_valid/acc_unbiased': 66.006, 'best_valid_valid/diff': 7.74, 'best_valid_valid/acc_skew': 66.739, 'best_valid_valid/acc_align': 65.273, 'best_valid_test/acc': 72.587, 'best_valid_test/acc_unbiased': 65.794, 'best_valid_test/diff': 14.316, 'best_valid_test/acc_skew': 69.998, 'best_valid_test/acc_align': 61.59}
[2 / 20] best test accuracy: 65.794 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 70.326, 'best_test_valid/acc_unbiased': 66.006, 'best_test_valid/diff': 7.74, 'best_test_valid/acc_skew': 66.739, 'best_test_valid/acc_align': 65.273, 'best_test_test/acc': 72.587, 'best_test_test/acc_unbiased': 65.794, 'best_test_test/diff': 14.316, 'best_test_test/acc_skew': 69.998, 'best_test_test/acc_align': 61.59}
[3 / 20] Learning rate: 0.001 weight: 0.01
[3 / 20] Loss: 4.544469048761777 CE Loss: 0.518465406749187 Con Loss: 4.539284389414442
[3 / 20] tensor([[0.946, 0.830],
        [0.539, 0.515]]) {'epoch': 3, 'valid/acc': 73.325, 'valid/acc_unbiased': 68.251, 'valid/diff': 10.109, 'valid/acc_skew': 63.632, 'valid/acc_align': 72.869, 'test/acc': 75.011, 'test/acc_unbiased': 70.74, 'test/diff': 7.011, 'test/acc_skew': 68.409, 'test/acc_align': 73.071}
[3 / 20] best valid accuracy: 68.251 at epoch 3 
 best_stats: {'best_valid_epoch': 3, 'best_valid_valid/acc': 73.325, 'best_valid_valid/acc_unbiased': 68.251, 'best_valid_valid/diff': 10.109, 'best_valid_valid/acc_skew': 63.632, 'best_valid_valid/acc_align': 72.869, 'best_valid_test/acc': 75.011, 'best_valid_test/acc_unbiased': 70.74, 'best_valid_test/diff': 7.011, 'best_valid_test/acc_skew': 68.409, 'best_valid_test/acc_align': 73.071}
[3 / 20] best test accuracy: 70.740 at epoch 3 
 best_stats: {'best_test_epoch': 3, 'best_test_valid/acc': 73.325, 'best_test_valid/acc_unbiased': 68.251, 'best_test_valid/diff': 10.109, 'best_test_valid/acc_skew': 63.632, 'best_test_valid/acc_align': 72.869, 'best_test_test/acc': 75.011, 'best_test_test/acc_unbiased': 70.74, 'best_test_test/diff': 7.011, 'best_test_test/acc_skew': 68.409, 'best_test_test/acc_align': 73.071}
[4 / 20] Learning rate: 0.001 weight: 0.01
[4 / 20] Loss: 4.469233614458479 CE Loss: 0.48360376631843155 Con Loss: 4.464397565919511
[4 / 20] tensor([[0.970, 0.818],
        [0.531, 0.497]]) {'epoch': 4, 'valid/acc': 73.236, 'valid/acc_unbiased': 67.05, 'valid/diff': 13.296, 'valid/acc_skew': 61.343, 'valid/acc_align': 72.757, 'test/acc': 75.584, 'test/acc_unbiased': 70.389, 'test/diff': 9.263, 'test/acc_skew': 67.437, 'test/acc_align': 73.34}
[4 / 20] best valid accuracy: 68.251 at epoch 3 
 best_stats: {'best_valid_epoch': 3, 'best_valid_valid/acc': 73.325, 'best_valid_valid/acc_unbiased': 68.251, 'best_valid_valid/diff': 10.109, 'best_valid_valid/acc_skew': 63.632, 'best_valid_valid/acc_align': 72.869, 'best_valid_test/acc': 75.011, 'best_valid_test/acc_unbiased': 70.74, 'best_valid_test/diff': 7.011, 'best_valid_test/acc_skew': 68.409, 'best_valid_test/acc_align': 73.071}
[4 / 20] best test accuracy: 70.740 at epoch 3 
 best_stats: {'best_test_epoch': 3, 'best_test_valid/acc': 73.325, 'best_test_valid/acc_unbiased': 68.251, 'best_test_valid/diff': 10.109, 'best_test_valid/acc_skew': 63.632, 'best_test_valid/acc_align': 72.869, 'best_test_test/acc': 75.011, 'best_test_test/acc_unbiased': 70.74, 'best_test_test/diff': 7.011, 'best_test_test/acc_skew': 68.409, 'best_test_test/acc_align': 73.071}
[5 / 20] Learning rate: 0.001 weight: 0.01
[5 / 20] Loss: 4.444777324645093 CE Loss: 0.46554810210409703 Con Loss: 4.440121837431731
[5 / 20] tensor([[0.966, 0.807],
        [0.489, 0.521]]) {'epoch': 5, 'valid/acc': 72.795, 'valid/acc_unbiased': 68.415, 'valid/diff': 16.886, 'valid/acc_skew': 59.972, 'valid/acc_align': 76.859, 'test/acc': 73.909, 'test/acc_unbiased': 69.579, 'test/diff': 9.571, 'test/acc_skew': 64.793, 'test/acc_align': 74.364}
[5 / 20] best valid accuracy: 68.415 at epoch 5 
 best_stats: {'best_valid_epoch': 5, 'best_valid_valid/acc': 72.795, 'best_valid_valid/acc_unbiased': 68.415, 'best_valid_valid/diff': 16.886, 'best_valid_valid/acc_skew': 59.972, 'best_valid_valid/acc_align': 76.859, 'best_valid_test/acc': 73.909, 'best_valid_test/acc_unbiased': 69.579, 'best_valid_test/diff': 9.571, 'best_valid_test/acc_skew': 64.793, 'best_valid_test/acc_align': 74.364}
[5 / 20] best test accuracy: 70.740 at epoch 3 
 best_stats: {'best_test_epoch': 3, 'best_test_valid/acc': 73.325, 'best_test_valid/acc_unbiased': 68.251, 'best_test_valid/diff': 10.109, 'best_test_valid/acc_skew': 63.632, 'best_test_valid/acc_align': 72.869, 'best_test_test/acc': 75.011, 'best_test_test/acc_unbiased': 70.74, 'best_test_test/diff': 7.011, 'best_test_test/acc_skew': 68.409, 'best_test_test/acc_align': 73.071}
[6 / 20] Learning rate: 0.001 weight: 0.01
[6 / 20] Loss: 4.44489424275977 CE Loss: 0.4375046431817441 Con Loss: 4.440519219344584
[6 / 20] tensor([[0.980, 0.767],
        [0.390, 0.570]]) {'epoch': 6, 'valid/acc': 69.533, 'valid/acc_unbiased': 66.607, 'valid/diff': 25.629, 'valid/acc_skew': 53.793, 'valid/acc_align': 79.421, 'test/acc': 70.824, 'test/acc_unbiased': 67.67, 'test/diff': 19.65, 'test/acc_skew': 57.845, 'test/acc_align': 77.495}
[6 / 20] best valid accuracy: 68.415 at epoch 5 
 best_stats: {'best_valid_epoch': 5, 'best_valid_valid/acc': 72.795, 'best_valid_valid/acc_unbiased': 68.415, 'best_valid_valid/diff': 16.886, 'best_valid_valid/acc_skew': 59.972, 'best_valid_valid/acc_align': 76.859, 'best_valid_test/acc': 73.909, 'best_valid_test/acc_unbiased': 69.579, 'best_valid_test/diff': 9.571, 'best_valid_test/acc_skew': 64.793, 'best_valid_test/acc_align': 74.364}
[6 / 20] best test accuracy: 70.740 at epoch 3 
 best_stats: {'best_test_epoch': 3, 'best_test_valid/acc': 73.325, 'best_test_valid/acc_unbiased': 68.251, 'best_test_valid/diff': 10.109, 'best_test_valid/acc_skew': 63.632, 'best_test_valid/acc_align': 72.869, 'best_test_test/acc': 75.011, 'best_test_test/acc_unbiased': 70.74, 'best_test_test/diff': 7.011, 'best_test_test/acc_skew': 68.409, 'best_test_test/acc_align': 73.071}
[7 / 20] Learning rate: 0.0001 weight: 0.01
[7 / 20] Loss: 4.3161039734457995 CE Loss: 0.40757864558576246 Con Loss: 4.312028206675653
[7 / 20] tensor([[0.974, 0.688],
        [0.617, 0.703]]) {'epoch': 7, 'valid/acc': 76.367, 'valid/acc_unbiased': 70.91, 'valid/diff': 24.671, 'valid/acc_skew': 58.575, 'valid/acc_align': 83.246, 'test/acc': 79.55, 'test/acc_unbiased': 74.53, 'test/diff': 18.603, 'test/acc_skew': 65.229, 'test/acc_align': 83.832}
[7 / 20] best valid accuracy: 70.910 at epoch 7 
 best_stats: {'best_valid_epoch': 7, 'best_valid_valid/acc': 76.367, 'best_valid_valid/acc_unbiased': 70.91, 'best_valid_valid/diff': 24.671, 'best_valid_valid/acc_skew': 58.575, 'best_valid_valid/acc_align': 83.246, 'best_valid_test/acc': 79.55, 'best_valid_test/acc_unbiased': 74.53, 'best_valid_test/diff': 18.603, 'best_valid_test/acc_skew': 65.229, 'best_valid_test/acc_align': 83.832}
[7 / 20] best test accuracy: 74.530 at epoch 7 
 best_stats: {'best_test_epoch': 7, 'best_test_valid/acc': 76.367, 'best_test_valid/acc_unbiased': 70.91, 'best_test_valid/diff': 24.671, 'best_test_valid/acc_skew': 58.575, 'best_test_valid/acc_align': 83.246, 'best_test_test/acc': 79.55, 'best_test_test/acc_unbiased': 74.53, 'best_test_test/diff': 18.603, 'best_test_test/acc_skew': 65.229, 'best_test_test/acc_align': 83.832}
[8 / 20] Learning rate: 0.0001 weight: 0.01
[8 / 20] Loss: 4.246805392593447 CE Loss: 0.39260851774533473 Con Loss: 4.242879334303021
[8 / 20] tensor([[0.948, 0.557],
        [0.725, 0.794]]) {'epoch': 8, 'valid/acc': 80.115, 'valid/acc_unbiased': 72.344, 'valid/diff': 29.055, 'valid/acc_skew': 57.816, 'valid/acc_align': 86.871, 'test/acc': 82.151, 'test/acc_unbiased': 75.61, 'test/diff': 22.99, 'test/acc_skew': 64.115, 'test/acc_align': 87.105}
[8 / 20] best valid accuracy: 72.344 at epoch 8 
 best_stats: {'best_valid_epoch': 8, 'best_valid_valid/acc': 80.115, 'best_valid_valid/acc_unbiased': 72.344, 'best_valid_valid/diff': 29.055, 'best_valid_valid/acc_skew': 57.816, 'best_valid_valid/acc_align': 86.871, 'best_valid_test/acc': 82.151, 'best_valid_test/acc_unbiased': 75.61, 'best_valid_test/diff': 22.99, 'best_valid_test/acc_skew': 64.115, 'best_valid_test/acc_align': 87.105}
[8 / 20] best test accuracy: 75.610 at epoch 8 
 best_stats: {'best_test_epoch': 8, 'best_test_valid/acc': 80.115, 'best_test_valid/acc_unbiased': 72.344, 'best_test_valid/diff': 29.055, 'best_test_valid/acc_skew': 57.816, 'best_test_valid/acc_align': 86.871, 'best_test_test/acc': 82.151, 'best_test_test/acc_unbiased': 75.61, 'best_test_test/diff': 22.99, 'best_test_test/acc_skew': 64.115, 'best_test_test/acc_align': 87.105}
[9 / 20] Learning rate: 0.0001 weight: 0.01
[9 / 20] Loss: 4.173187777684539 CE Loss: 0.37851578709071426 Con Loss: 4.169402646286485
[9 / 20] tensor([[0.981, 0.636],
        [0.617, 0.703]]) {'epoch': 9, 'valid/acc': 76.675, 'valid/acc_unbiased': 71.355, 'valid/diff': 25.248, 'valid/acc_skew': 58.731, 'valid/acc_align': 83.979, 'test/acc': 79.506, 'test/acc_unbiased': 73.44, 'test/diff': 21.537, 'test/acc_skew': 62.672, 'test/acc_align': 84.209}
[9 / 20] best valid accuracy: 72.344 at epoch 8 
 best_stats: {'best_valid_epoch': 8, 'best_valid_valid/acc': 80.115, 'best_valid_valid/acc_unbiased': 72.344, 'best_valid_valid/diff': 29.055, 'best_valid_valid/acc_skew': 57.816, 'best_valid_valid/acc_align': 86.871, 'best_valid_test/acc': 82.151, 'best_valid_test/acc_unbiased': 75.61, 'best_valid_test/diff': 22.99, 'best_valid_test/acc_skew': 64.115, 'best_valid_test/acc_align': 87.105}
[9 / 20] best test accuracy: 75.610 at epoch 8 
 best_stats: {'best_test_epoch': 8, 'best_test_valid/acc': 80.115, 'best_test_valid/acc_unbiased': 72.344, 'best_test_valid/diff': 29.055, 'best_test_valid/acc_skew': 57.816, 'best_test_valid/acc_align': 86.871, 'best_test_test/acc': 82.151, 'best_test_test/acc_unbiased': 75.61, 'best_test_test/diff': 22.99, 'best_test_test/acc_skew': 64.115, 'best_test_test/acc_align': 87.105}
[10 / 20] Learning rate: 0.0001 weight: 0.01
[10 / 20] Loss: 4.131391415476397 CE Loss: 0.3734133821196968 Con Loss: 4.127657309403271
[10 / 20] tensor([[0.977, 0.591],
        [0.656, 0.697]]) {'epoch': 10, 'valid/acc': 78.748, 'valid/acc_unbiased': 72.451, 'valid/diff': 25.24, 'valid/acc_skew': 59.83, 'valid/acc_align': 85.071, 'test/acc': 80.432, 'test/acc_unbiased': 73.039, 'test/diff': 21.358, 'test/acc_skew': 62.36, 'test/acc_align': 83.717}
[10 / 20] best valid accuracy: 72.451 at epoch 10 
 best_stats: {'best_valid_epoch': 10, 'best_valid_valid/acc': 78.748, 'best_valid_valid/acc_unbiased': 72.451, 'best_valid_valid/diff': 25.24, 'best_valid_valid/acc_skew': 59.83, 'best_valid_valid/acc_align': 85.071, 'best_valid_test/acc': 80.432, 'best_valid_test/acc_unbiased': 73.039, 'best_valid_test/diff': 21.358, 'best_valid_test/acc_skew': 62.36, 'best_valid_test/acc_align': 83.717}
[10 / 20] best test accuracy: 75.610 at epoch 8 
 best_stats: {'best_test_epoch': 8, 'best_test_valid/acc': 80.115, 'best_test_valid/acc_unbiased': 72.344, 'best_test_valid/diff': 29.055, 'best_test_valid/acc_skew': 57.816, 'best_test_valid/acc_align': 86.871, 'best_test_test/acc': 82.151, 'best_test_test/acc_unbiased': 75.61, 'best_test_test/diff': 22.99, 'best_test_test/acc_skew': 64.115, 'best_test_test/acc_align': 87.105}
[11 / 20] Learning rate: 0.0001 weight: 0.01
[11 / 20] Loss: 4.0877395531337655 CE Loss: 0.368859434051935 Con Loss: 4.084050953678315
[11 / 20] tensor([[0.968, 0.562],
        [0.671, 0.770]]) {'epoch': 11, 'valid/acc': 78.836, 'valid/acc_unbiased': 72.298, 'valid/diff': 30.806, 'valid/acc_skew': 56.895, 'valid/acc_align': 87.701, 'test/acc': 80.873, 'test/acc_unbiased': 74.286, 'test/diff': 25.194, 'test/acc_skew': 61.689, 'test/acc_align': 86.883}
[11 / 20] best valid accuracy: 72.451 at epoch 10 
 best_stats: {'best_valid_epoch': 10, 'best_valid_valid/acc': 78.748, 'best_valid_valid/acc_unbiased': 72.451, 'best_valid_valid/diff': 25.24, 'best_valid_valid/acc_skew': 59.83, 'best_valid_valid/acc_align': 85.071, 'best_valid_test/acc': 80.432, 'best_valid_test/acc_unbiased': 73.039, 'best_valid_test/diff': 21.358, 'best_valid_test/acc_skew': 62.36, 'best_valid_test/acc_align': 83.717}
[11 / 20] best test accuracy: 75.610 at epoch 8 
 best_stats: {'best_test_epoch': 8, 'best_test_valid/acc': 80.115, 'best_test_valid/acc_unbiased': 72.344, 'best_test_valid/diff': 29.055, 'best_test_valid/acc_skew': 57.816, 'best_test_valid/acc_align': 86.871, 'best_test_test/acc': 82.151, 'best_test_test/acc_unbiased': 75.61, 'best_test_test/diff': 22.99, 'best_test_test/acc_skew': 64.115, 'best_test_test/acc_align': 87.105}
[12 / 20] Learning rate: 0.0001 weight: 0.01
[12 / 20] Loss: 4.1661182664744825 CE Loss: 0.36288518773532014 Con Loss: 4.1624893961841805
[12 / 20] tensor([[0.978, 0.614],
        [0.648, 0.733]]) {'epoch': 12, 'valid/acc': 78.88, 'valid/acc_unbiased': 73.072, 'valid/diff': 27.948, 'valid/acc_skew': 59.098, 'valid/acc_align': 87.046, 'test/acc': 80.608, 'test/acc_unbiased': 74.338, 'test/diff': 22.49, 'test/acc_skew': 63.092, 'test/acc_align': 85.583}
[12 / 20] best valid accuracy: 73.072 at epoch 12 
 best_stats: {'best_valid_epoch': 12, 'best_valid_valid/acc': 78.88, 'best_valid_valid/acc_unbiased': 73.072, 'best_valid_valid/diff': 27.948, 'best_valid_valid/acc_skew': 59.098, 'best_valid_valid/acc_align': 87.046, 'best_valid_test/acc': 80.608, 'best_valid_test/acc_unbiased': 74.338, 'best_valid_test/diff': 22.49, 'best_valid_test/acc_skew': 63.092, 'best_valid_test/acc_align': 85.583}
[12 / 20] best test accuracy: 75.610 at epoch 8 
 best_stats: {'best_test_epoch': 8, 'best_test_valid/acc': 80.115, 'best_test_valid/acc_unbiased': 72.344, 'best_test_valid/diff': 29.055, 'best_test_valid/acc_skew': 57.816, 'best_test_valid/acc_align': 86.871, 'best_test_test/acc': 82.151, 'best_test_test/acc_unbiased': 75.61, 'best_test_test/diff': 22.99, 'best_test_test/acc_skew': 64.115, 'best_test_test/acc_align': 87.105}
[13 / 20] Learning rate: 0.0001 weight: 0.01
[13 / 20] Loss: 4.088980395889425 CE Loss: 0.36500251772965175 Con Loss: 4.085330373292021
[13 / 20] tensor([[0.967, 0.557],
        [0.699, 0.806]]) {'epoch': 13, 'valid/acc': 80.379, 'valid/acc_unbiased': 74.636, 'valid/diff': 32.555, 'valid/acc_skew': 58.359, 'valid/acc_align': 90.914, 'test/acc': 82.107, 'test/acc_unbiased': 75.721, 'test/diff': 25.865, 'test/acc_skew': 62.789, 'test/acc_align': 88.654}
[13 / 20] best valid accuracy: 74.636 at epoch 13 
 best_stats: {'best_valid_epoch': 13, 'best_valid_valid/acc': 80.379, 'best_valid_valid/acc_unbiased': 74.636, 'best_valid_valid/diff': 32.555, 'best_valid_valid/acc_skew': 58.359, 'best_valid_valid/acc_align': 90.914, 'best_valid_test/acc': 82.107, 'best_valid_test/acc_unbiased': 75.721, 'best_valid_test/diff': 25.865, 'best_valid_test/acc_skew': 62.789, 'best_valid_test/acc_align': 88.654}
[13 / 20] best test accuracy: 75.721 at epoch 13 
 best_stats: {'best_test_epoch': 13, 'best_test_valid/acc': 80.379, 'best_test_valid/acc_unbiased': 74.636, 'best_test_valid/diff': 32.555, 'best_test_valid/acc_skew': 58.359, 'best_test_valid/acc_align': 90.914, 'best_test_test/acc': 82.107, 'best_test_test/acc_unbiased': 75.721, 'best_test_test/diff': 25.865, 'best_test_test/acc_skew': 62.789, 'best_test_test/acc_align': 88.654}
[14 / 20] Learning rate: 1e-05 weight: 0.01
[14 / 20] Loss: 4.085211495164181 CE Loss: 0.354837538809064 Con Loss: 4.081663123144724
[14 / 20] tensor([[0.971, 0.580],
        [0.686, 0.794]]) {'epoch': 14, 'valid/acc': 79.541, 'valid/acc_unbiased': 73.489, 'valid/diff': 33.463, 'valid/acc_skew': 56.757, 'valid/acc_align': 90.22, 'test/acc': 81.886, 'test/acc_unbiased': 75.764, 'test/diff': 24.945, 'test/acc_skew': 63.291, 'test/acc_align': 88.236}
[14 / 20] best valid accuracy: 74.636 at epoch 13 
 best_stats: {'best_valid_epoch': 13, 'best_valid_valid/acc': 80.379, 'best_valid_valid/acc_unbiased': 74.636, 'best_valid_valid/diff': 32.555, 'best_valid_valid/acc_skew': 58.359, 'best_valid_valid/acc_align': 90.914, 'best_valid_test/acc': 82.107, 'best_valid_test/acc_unbiased': 75.721, 'best_valid_test/diff': 25.865, 'best_valid_test/acc_skew': 62.789, 'best_valid_test/acc_align': 88.654}
[14 / 20] best test accuracy: 75.764 at epoch 14 
 best_stats: {'best_test_epoch': 14, 'best_test_valid/acc': 79.541, 'best_test_valid/acc_unbiased': 73.489, 'best_test_valid/diff': 33.463, 'best_test_valid/acc_skew': 56.757, 'best_test_valid/acc_align': 90.22, 'best_test_test/acc': 81.886, 'best_test_test/acc_unbiased': 75.764, 'best_test_test/diff': 24.945, 'best_test_test/acc_skew': 63.291, 'best_test_test/acc_align': 88.236}
[15 / 20] Learning rate: 1e-05 weight: 0.01
[15 / 20] Loss: 4.061014704202632 CE Loss: 0.35957873858391504 Con Loss: 4.057418911432961
[15 / 20] tensor([[0.967, 0.574],
        [0.691, 0.794]]) {'epoch': 15, 'valid/acc': 79.674, 'valid/acc_unbiased': 73.469, 'valid/diff': 34.093, 'valid/acc_skew': 56.423, 'valid/acc_align': 90.516, 'test/acc': 81.842, 'test/acc_unbiased': 75.643, 'test/diff': 24.81, 'test/acc_skew': 63.238, 'test/acc_align': 88.048}
[15 / 20] best valid accuracy: 74.636 at epoch 13 
 best_stats: {'best_valid_epoch': 13, 'best_valid_valid/acc': 80.379, 'best_valid_valid/acc_unbiased': 74.636, 'best_valid_valid/diff': 32.555, 'best_valid_valid/acc_skew': 58.359, 'best_valid_valid/acc_align': 90.914, 'best_valid_test/acc': 82.107, 'best_valid_test/acc_unbiased': 75.721, 'best_valid_test/diff': 25.865, 'best_valid_test/acc_skew': 62.789, 'best_valid_test/acc_align': 88.654}
[15 / 20] best test accuracy: 75.764 at epoch 14 
 best_stats: {'best_test_epoch': 14, 'best_test_valid/acc': 79.541, 'best_test_valid/acc_unbiased': 73.489, 'best_test_valid/diff': 33.463, 'best_test_valid/acc_skew': 56.757, 'best_test_valid/acc_align': 90.22, 'best_test_test/acc': 81.886, 'best_test_test/acc_unbiased': 75.764, 'best_test_test/diff': 24.945, 'best_test_test/acc_skew': 63.291, 'best_test_test/acc_align': 88.236}
[16 / 20] Learning rate: 1e-05 weight: 0.01
[16 / 20] Loss: 4.002296961991807 CE Loss: 0.353496673311557 Con Loss: 3.99876200523505
[16 / 20] tensor([[0.969, 0.557],
        [0.692, 0.800]]) {'epoch': 16, 'valid/acc': 79.762, 'valid/acc_unbiased': 73.628, 'valid/diff': 34.174, 'valid/acc_skew': 56.542, 'valid/acc_align': 90.715, 'test/acc': 81.886, 'test/acc_unbiased': 75.444, 'test/diff': 26.002, 'test/acc_skew': 62.443, 'test/acc_align': 88.445}
[16 / 20] best valid accuracy: 74.636 at epoch 13 
 best_stats: {'best_valid_epoch': 13, 'best_valid_valid/acc': 80.379, 'best_valid_valid/acc_unbiased': 74.636, 'best_valid_valid/diff': 32.555, 'best_valid_valid/acc_skew': 58.359, 'best_valid_valid/acc_align': 90.914, 'best_valid_test/acc': 82.107, 'best_valid_test/acc_unbiased': 75.721, 'best_valid_test/diff': 25.865, 'best_valid_test/acc_skew': 62.789, 'best_valid_test/acc_align': 88.654}
[16 / 20] best test accuracy: 75.764 at epoch 14 
 best_stats: {'best_test_epoch': 14, 'best_test_valid/acc': 79.541, 'best_test_valid/acc_unbiased': 73.489, 'best_test_valid/diff': 33.463, 'best_test_valid/acc_skew': 56.757, 'best_test_valid/acc_align': 90.22, 'best_test_test/acc': 81.886, 'best_test_test/acc_unbiased': 75.764, 'best_test_test/diff': 24.945, 'best_test_test/acc_skew': 63.291, 'best_test_test/acc_align': 88.236}
[17 / 20] Learning rate: 1e-05 weight: 0.01
[17 / 20] Loss: 4.083104373720513 CE Loss: 0.3537662624420186 Con Loss: 4.079566705097468
[17 / 20] tensor([[0.969, 0.568],
        [0.686, 0.788]]) {'epoch': 17, 'valid/acc': 79.674, 'valid/acc_unbiased': 73.768, 'valid/diff': 32.603, 'valid/acc_skew': 57.467, 'valid/acc_align': 90.07, 'test/acc': 81.666, 'test/acc_unbiased': 75.281, 'test/diff': 25.116, 'test/acc_skew': 62.723, 'test/acc_align': 87.839}
[17 / 20] best valid accuracy: 74.636 at epoch 13 
 best_stats: {'best_valid_epoch': 13, 'best_valid_valid/acc': 80.379, 'best_valid_valid/acc_unbiased': 74.636, 'best_valid_valid/diff': 32.555, 'best_valid_valid/acc_skew': 58.359, 'best_valid_valid/acc_align': 90.914, 'best_valid_test/acc': 82.107, 'best_valid_test/acc_unbiased': 75.721, 'best_valid_test/diff': 25.865, 'best_valid_test/acc_skew': 62.789, 'best_valid_test/acc_align': 88.654}
[17 / 20] best test accuracy: 75.764 at epoch 14 
 best_stats: {'best_test_epoch': 14, 'best_test_valid/acc': 79.541, 'best_test_valid/acc_unbiased': 73.489, 'best_test_valid/diff': 33.463, 'best_test_valid/acc_skew': 56.757, 'best_test_valid/acc_align': 90.22, 'best_test_test/acc': 81.886, 'best_test_test/acc_unbiased': 75.764, 'best_test_test/diff': 24.945, 'best_test_test/acc_skew': 63.291, 'best_test_test/acc_align': 88.236}
[18 / 20] Learning rate: 1e-05 weight: 0.01
[18 / 20] Loss: 4.018775042859145 CE Loss: 0.3491546835893997 Con Loss: 4.015283491048238
[18 / 20] tensor([[0.967, 0.545],
        [0.713, 0.842]]) {'epoch': 18, 'valid/acc': 80.291, 'valid/acc_unbiased': 74.276, 'valid/diff': 33.373, 'valid/acc_skew': 57.59, 'valid/acc_align': 90.963, 'test/acc': 82.812, 'test/acc_unbiased': 76.692, 'test/diff': 27.559, 'test/acc_skew': 62.913, 'test/acc_align': 90.472}
[18 / 20] best valid accuracy: 74.636 at epoch 13 
 best_stats: {'best_valid_epoch': 13, 'best_valid_valid/acc': 80.379, 'best_valid_valid/acc_unbiased': 74.636, 'best_valid_valid/diff': 32.555, 'best_valid_valid/acc_skew': 58.359, 'best_valid_valid/acc_align': 90.914, 'best_valid_test/acc': 82.107, 'best_valid_test/acc_unbiased': 75.721, 'best_valid_test/diff': 25.865, 'best_valid_test/acc_skew': 62.789, 'best_valid_test/acc_align': 88.654}
[18 / 20] best test accuracy: 76.692 at epoch 18 
 best_stats: {'best_test_epoch': 18, 'best_test_valid/acc': 80.291, 'best_test_valid/acc_unbiased': 74.276, 'best_test_valid/diff': 33.373, 'best_test_valid/acc_skew': 57.59, 'best_test_valid/acc_align': 90.963, 'best_test_test/acc': 82.812, 'best_test_test/acc_unbiased': 76.692, 'best_test_test/diff': 27.559, 'best_test_test/acc_skew': 62.913, 'best_test_test/acc_align': 90.472}
[19 / 20] Learning rate: 1e-05 weight: 0.01
[19 / 20] Loss: 4.007163265232556 CE Loss: 0.3455422028246465 Con Loss: 4.003707834773633
[19 / 20] tensor([[0.968, 0.528],
        [0.714, 0.848]]) {'epoch': 19, 'valid/acc': 79.85, 'valid/acc_unbiased': 73.483, 'valid/diff': 35.852, 'valid/acc_skew': 55.557, 'valid/acc_align': 91.409, 'test/acc': 82.812, 'test/acc_unbiased': 76.47, 'test/diff': 28.704, 'test/acc_skew': 62.118, 'test/acc_align': 90.822}
[19 / 20] best valid accuracy: 74.636 at epoch 13 
 best_stats: {'best_valid_epoch': 13, 'best_valid_valid/acc': 80.379, 'best_valid_valid/acc_unbiased': 74.636, 'best_valid_valid/diff': 32.555, 'best_valid_valid/acc_skew': 58.359, 'best_valid_valid/acc_align': 90.914, 'best_valid_test/acc': 82.107, 'best_valid_test/acc_unbiased': 75.721, 'best_valid_test/diff': 25.865, 'best_valid_test/acc_skew': 62.789, 'best_valid_test/acc_align': 88.654}
[19 / 20] best test accuracy: 76.692 at epoch 18 
 best_stats: {'best_test_epoch': 18, 'best_test_valid/acc': 80.291, 'best_test_valid/acc_unbiased': 74.276, 'best_test_valid/diff': 33.373, 'best_test_valid/acc_skew': 57.59, 'best_test_valid/acc_align': 90.963, 'best_test_test/acc': 82.812, 'best_test_test/acc_unbiased': 76.692, 'best_test_test/diff': 27.559, 'best_test_test/acc_skew': 62.913, 'best_test_test/acc_align': 90.472}
[20 / 20] Learning rate: 1e-05 weight: 0.01
[20 / 20] Loss: 3.9883460680762735 CE Loss: 0.3490887791398133 Con Loss: 3.984855178767311
[20 / 20] tensor([[0.971, 0.534],
        [0.690, 0.836]]) {'epoch': 20, 'valid/acc': 79.497, 'valid/acc_unbiased': 73.627, 'valid/diff': 35.36, 'valid/acc_skew': 55.947, 'valid/acc_align': 91.307, 'test/acc': 81.974, 'test/acc_unbiased': 75.774, 'test/diff': 29.166, 'test/acc_skew': 61.191, 'test/acc_align': 90.357}
[20 / 20] best valid accuracy: 74.636 at epoch 13 
 best_stats: {'best_valid_epoch': 13, 'best_valid_valid/acc': 80.379, 'best_valid_valid/acc_unbiased': 74.636, 'best_valid_valid/diff': 32.555, 'best_valid_valid/acc_skew': 58.359, 'best_valid_valid/acc_align': 90.914, 'best_valid_test/acc': 82.107, 'best_valid_test/acc_unbiased': 75.721, 'best_valid_test/diff': 25.865, 'best_valid_test/acc_skew': 62.789, 'best_valid_test/acc_align': 88.654}
[20 / 20] best test accuracy: 76.692 at epoch 18 
 best_stats: {'best_test_epoch': 18, 'best_test_valid/acc': 80.291, 'best_test_valid/acc_unbiased': 74.276, 'best_test_valid/diff': 33.373, 'best_test_valid/acc_skew': 57.59, 'best_test_valid/acc_align': 90.963, 'best_test_test/acc': 82.812, 'best_test_test/acc_unbiased': 76.692, 'best_test_test/diff': 27.559, 'best_test_test/acc_skew': 62.913, 'best_test_test/acc_align': 90.472}
Total training time: 0:16:13
