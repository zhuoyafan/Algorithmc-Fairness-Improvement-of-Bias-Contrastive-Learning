Log level set to: INFO
Set seed: 2
=======> Using Fixed Random Seed: 2 <========
save_path: exp_results/bc-bb0-utk_face_age-cutout_color_blur-0.9-lr0.001-bs128-cbs64-w0.01-ratio10-aug1-seed2
get_utk_face - split: train, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_age-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
Binary Target 1
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Normal Label Distribution: 
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
Binary Target 1
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Normal Label Distribution: 
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 10684, target_attr: gender, bias_attr: age bias_rate: 0.9
['[train] target_0-bias_0: 8237', '[train] target_0-bias_1: 147', '[train] target_1-bias_0: 823', '[train] target_1-bias_1: 1477']
confusion_matrix - 
 original: tensor([[8237.,  823.],
        [ 147., 1477.]]), 
 normalized: tensor([[0.909, 0.091],
        [0.091, 0.909]]), 
 b|y: tensor([[0.982, 0.018],
        [0.358, 0.642]])
get_utk_face - split: train, aug: 1, given_y: True, ratio: 10
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_age-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
Binary Target 1
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Normal Label Distribution: 
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
Binary Target 1
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Normal Label Distribution: 
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 10684, target_attr: gender, bias_attr: age bias_rate: 0.9
['[train] target_0-bias_0: 8237', '[train] target_0-bias_1: 147', '[train] target_1-bias_0: 823', '[train] target_1-bias_1: 1477']
get_utk_face - split: valid, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_age-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [1030, 195]
Target 1: [841, 202]
Binary Target 1
---------------------------
Target 0: [1030, 195]
Target 1: [841, 202]
===================================
Normal Label Distribution: 
Target 0: [1030, 195]
Target 1: [841, 202]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 2268, target_attr: gender, bias_attr: age bias_rate: 0.9
['[valid] target_0-bias_0: 1030', '[valid] target_0-bias_1: 195', '[valid] target_1-bias_0: 841', '[valid] target_1-bias_1: 202']
get_utk_face - split: test, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_age-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [1061, 176]
Target 1: [867, 165]
Binary Target 1
---------------------------
Target 0: [1061, 176]
Target 1: [867, 165]
===================================
Normal Label Distribution: 
Target 0: [1061, 176]
Target 1: [867, 165]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 2269, target_attr: gender, bias_attr: age bias_rate: 0.9
['[test] target_0-bias_0: 1061', '[test] target_0-bias_1: 176', '[test] target_1-bias_0: 867', '[test] target_1-bias_1: 165']
decay_epochs: [6, 13]
[1 / 20] Learning rate: 0.001 weight: 0.01
[1 / 20] Loss: 4.8413240071407015 CE Loss: 0.5675748179731901 Con Loss: 4.8356482719312845
[1 / 20] tensor([[1., 1.],
        [0., 0.]]) {'epoch': 1, 'valid/acc': 54.012, 'valid/acc_unbiased': 50.0, 'valid/diff': 0.0, 'valid/acc_skew': 50.0, 'valid/acc_align': 50.0, 'test/acc': 54.517, 'test/acc_unbiased': 50.0, 'test/diff': 0.0, 'test/acc_skew': 50.0, 'test/acc_align': 50.0}
[1 / 20] best valid accuracy: 50.000 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 54.012, 'best_valid_valid/acc_unbiased': 50.0, 'best_valid_valid/diff': 0.0, 'best_valid_valid/acc_skew': 50.0, 'best_valid_valid/acc_align': 50.0, 'best_valid_test/acc': 54.517, 'best_valid_test/acc_unbiased': 50.0, 'best_valid_test/diff': 0.0, 'best_valid_test/acc_skew': 50.0, 'best_valid_test/acc_align': 50.0}
[1 / 20] best test accuracy: 50.000 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 54.012, 'best_test_valid/acc_unbiased': 50.0, 'best_test_valid/diff': 0.0, 'best_test_valid/acc_skew': 50.0, 'best_test_valid/acc_align': 50.0, 'best_test_test/acc': 54.517, 'best_test_test/acc_unbiased': 50.0, 'best_test_test/diff': 0.0, 'best_test_test/acc_skew': 50.0, 'best_test_test/acc_align': 50.0}
[2 / 20] Learning rate: 0.001 weight: 0.01
[2 / 20] Loss: 4.618239770351568 CE Loss: 0.5236605322124448 Con Loss: 4.613003147000992
[2 / 20] tensor([[0.909, 0.812],
        [0.498, 0.236]]) {'epoch': 2, 'valid/acc': 67.372, 'valid/acc_unbiased': 61.227, 'valid/diff': 13.247, 'valid/acc_skew': 62.414, 'valid/acc_align': 60.041, 'test/acc': 69.546, 'test/acc_unbiased': 61.393, 'test/diff': 17.899, 'test/acc_skew': 65.538, 'test/acc_align': 57.247}
[2 / 20] best valid accuracy: 61.227 at epoch 2 
 best_stats: {'best_valid_epoch': 2, 'best_valid_valid/acc': 67.372, 'best_valid_valid/acc_unbiased': 61.227, 'best_valid_valid/diff': 13.247, 'best_valid_valid/acc_skew': 62.414, 'best_valid_valid/acc_align': 60.041, 'best_valid_test/acc': 69.546, 'best_valid_test/acc_unbiased': 61.393, 'best_valid_test/diff': 17.899, 'best_valid_test/acc_skew': 65.538, 'best_valid_test/acc_align': 57.247}
[2 / 20] best test accuracy: 61.393 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 67.372, 'best_test_valid/acc_unbiased': 61.227, 'best_test_valid/diff': 13.247, 'best_test_valid/acc_skew': 62.414, 'best_test_valid/acc_align': 60.041, 'best_test_test/acc': 69.546, 'best_test_test/acc_unbiased': 61.393, 'best_test_test/diff': 17.899, 'best_test_test/acc_skew': 65.538, 'best_test_test/acc_align': 57.247}
[3 / 20] Learning rate: 0.001 weight: 0.01
[3 / 20] Loss: 4.561515844167283 CE Loss: 0.5110101249725887 Con Loss: 4.556405750654557
[3 / 20] tensor([[0.903, 0.722],
        [0.652, 0.467]]) {'epoch': 3, 'valid/acc': 75.661, 'valid/acc_unbiased': 70.484, 'valid/diff': 12.756, 'valid/acc_skew': 67.746, 'valid/acc_align': 73.223, 'test/acc': 76.113, 'test/acc_unbiased': 68.571, 'test/diff': 18.317, 'test/acc_skew': 68.663, 'test/acc_align': 68.479}
[3 / 20] best valid accuracy: 70.484 at epoch 3 
 best_stats: {'best_valid_epoch': 3, 'best_valid_valid/acc': 75.661, 'best_valid_valid/acc_unbiased': 70.484, 'best_valid_valid/diff': 12.756, 'best_valid_valid/acc_skew': 67.746, 'best_valid_valid/acc_align': 73.223, 'best_valid_test/acc': 76.113, 'best_valid_test/acc_unbiased': 68.571, 'best_valid_test/diff': 18.317, 'best_valid_test/acc_skew': 68.663, 'best_valid_test/acc_align': 68.479}
[3 / 20] best test accuracy: 68.571 at epoch 3 
 best_stats: {'best_test_epoch': 3, 'best_test_valid/acc': 75.661, 'best_test_valid/acc_unbiased': 70.484, 'best_test_valid/diff': 12.756, 'best_test_valid/acc_skew': 67.746, 'best_test_valid/acc_align': 73.223, 'best_test_test/acc': 76.113, 'best_test_test/acc_unbiased': 68.571, 'best_test_test/diff': 18.317, 'best_test_test/acc_skew': 68.663, 'best_test_test/acc_align': 68.479}
[4 / 20] Learning rate: 0.001 weight: 0.01
[4 / 20] Loss: 4.489288162265722 CE Loss: 0.48949991482913563 Con Loss: 4.484393143734206
[4 / 20] tensor([[0.950, 0.875],
        [0.401, 0.279]]) {'epoch': 4, 'valid/acc': 67.681, 'valid/acc_unbiased': 61.443, 'valid/diff': 12.581, 'valid/acc_skew': 61.99, 'valid/acc_align': 60.895, 'test/acc': 68.576, 'test/acc_unbiased': 62.63, 'test/diff': 9.882, 'test/acc_skew': 63.819, 'test/acc_align': 61.442}
[4 / 20] best valid accuracy: 70.484 at epoch 3 
 best_stats: {'best_valid_epoch': 3, 'best_valid_valid/acc': 75.661, 'best_valid_valid/acc_unbiased': 70.484, 'best_valid_valid/diff': 12.756, 'best_valid_valid/acc_skew': 67.746, 'best_valid_valid/acc_align': 73.223, 'best_valid_test/acc': 76.113, 'best_valid_test/acc_unbiased': 68.571, 'best_valid_test/diff': 18.317, 'best_valid_test/acc_skew': 68.663, 'best_valid_test/acc_align': 68.479}
[4 / 20] best test accuracy: 68.571 at epoch 3 
 best_stats: {'best_test_epoch': 3, 'best_test_valid/acc': 75.661, 'best_test_valid/acc_unbiased': 70.484, 'best_test_valid/diff': 12.756, 'best_test_valid/acc_skew': 67.746, 'best_test_valid/acc_align': 73.223, 'best_test_test/acc': 76.113, 'best_test_test/acc_unbiased': 68.571, 'best_test_test/diff': 18.317, 'best_test_test/acc_skew': 68.663, 'best_test_test/acc_align': 68.479}
[5 / 20] Learning rate: 0.001 weight: 0.01
[5 / 20] Loss: 4.452417986172498 CE Loss: 0.484557858648393 Con Loss: 4.447572418564225
[5 / 20] tensor([[0.987, 0.716],
        [0.351, 0.442]]) {'epoch': 5, 'valid/acc': 67.152, 'valid/acc_unbiased': 62.777, 'valid/diff': 20.428, 'valid/acc_skew': 52.563, 'valid/acc_align': 72.99, 'test/acc': 68.312, 'test/acc_unbiased': 62.394, 'test/diff': 18.134, 'test/acc_skew': 53.327, 'test/acc_align': 71.461}
[5 / 20] best valid accuracy: 70.484 at epoch 3 
 best_stats: {'best_valid_epoch': 3, 'best_valid_valid/acc': 75.661, 'best_valid_valid/acc_unbiased': 70.484, 'best_valid_valid/diff': 12.756, 'best_valid_valid/acc_skew': 67.746, 'best_valid_valid/acc_align': 73.223, 'best_valid_test/acc': 76.113, 'best_valid_test/acc_unbiased': 68.571, 'best_valid_test/diff': 18.317, 'best_valid_test/acc_skew': 68.663, 'best_valid_test/acc_align': 68.479}
[5 / 20] best test accuracy: 68.571 at epoch 3 
 best_stats: {'best_test_epoch': 3, 'best_test_valid/acc': 75.661, 'best_test_valid/acc_unbiased': 70.484, 'best_test_valid/diff': 12.756, 'best_test_valid/acc_skew': 67.746, 'best_test_valid/acc_align': 73.223, 'best_test_test/acc': 76.113, 'best_test_test/acc_unbiased': 68.571, 'best_test_test/diff': 18.317, 'best_test_test/acc_skew': 68.663, 'best_test_test/acc_align': 68.479}
[6 / 20] Learning rate: 0.001 weight: 0.01
[6 / 20] Loss: 4.437206056759805 CE Loss: 0.47383201819642656 Con Loss: 4.4324677348449315
[6 / 20] tensor([[0.775, 0.330],
        [0.799, 0.812]]) {'epoch': 6, 'valid/acc': 73.016, 'valid/acc_unbiased': 66.792, 'valid/diff': 20.391, 'valid/acc_skew': 56.597, 'valid/acc_align': 76.987, 'test/acc': 75.231, 'test/acc_unbiased': 67.893, 'test/diff': 22.9, 'test/acc_skew': 56.443, 'test/acc_align': 79.343}
[6 / 20] best valid accuracy: 70.484 at epoch 3 
 best_stats: {'best_valid_epoch': 3, 'best_valid_valid/acc': 75.661, 'best_valid_valid/acc_unbiased': 70.484, 'best_valid_valid/diff': 12.756, 'best_valid_valid/acc_skew': 67.746, 'best_valid_valid/acc_align': 73.223, 'best_valid_test/acc': 76.113, 'best_valid_test/acc_unbiased': 68.571, 'best_valid_test/diff': 18.317, 'best_valid_test/acc_skew': 68.663, 'best_valid_test/acc_align': 68.479}
[6 / 20] best test accuracy: 68.571 at epoch 3 
 best_stats: {'best_test_epoch': 3, 'best_test_valid/acc': 75.661, 'best_test_valid/acc_unbiased': 70.484, 'best_test_valid/diff': 12.756, 'best_test_valid/acc_skew': 67.746, 'best_test_valid/acc_align': 73.223, 'best_test_test/acc': 76.113, 'best_test_test/acc_unbiased': 68.571, 'best_test_test/diff': 18.317, 'best_test_test/acc_skew': 68.663, 'best_test_test/acc_align': 68.479}
[7 / 20] Learning rate: 0.0001 weight: 0.01
[7 / 20] Loss: 4.256567419981162 CE Loss: 0.44487251001589756 Con Loss: 4.252118709425674
[7 / 20] tensor([[0.959, 0.562],
        [0.592, 0.703]]) {'epoch': 7, 'valid/acc': 73.854, 'valid/acc_unbiased': 67.009, 'valid/diff': 33.094, 'valid/acc_skew': 50.463, 'valid/acc_align': 83.556, 'test/acc': 76.906, 'test/acc_unbiased': 70.394, 'test/diff': 25.368, 'test/acc_skew': 57.71, 'test/acc_align': 83.078}
[7 / 20] best valid accuracy: 70.484 at epoch 3 
 best_stats: {'best_valid_epoch': 3, 'best_valid_valid/acc': 75.661, 'best_valid_valid/acc_unbiased': 70.484, 'best_valid_valid/diff': 12.756, 'best_valid_valid/acc_skew': 67.746, 'best_valid_valid/acc_align': 73.223, 'best_valid_test/acc': 76.113, 'best_valid_test/acc_unbiased': 68.571, 'best_valid_test/diff': 18.317, 'best_valid_test/acc_skew': 68.663, 'best_valid_test/acc_align': 68.479}
[7 / 20] best test accuracy: 70.394 at epoch 7 
 best_stats: {'best_test_epoch': 7, 'best_test_valid/acc': 73.854, 'best_test_valid/acc_unbiased': 67.009, 'best_test_valid/diff': 33.094, 'best_test_valid/acc_skew': 50.463, 'best_test_valid/acc_align': 83.556, 'best_test_test/acc': 76.906, 'best_test_test/acc_unbiased': 70.394, 'best_test_test/diff': 25.368, 'best_test_test/acc_skew': 57.71, 'best_test_test/acc_align': 83.078}
[8 / 20] Learning rate: 0.0001 weight: 0.01
[8 / 20] Loss: 4.162685078121401 CE Loss: 0.41583437661426603 Con Loss: 4.158526732117351
[8 / 20] tensor([[0.948, 0.483],
        [0.648, 0.812]]) {'epoch': 8, 'valid/acc': 76.235, 'valid/acc_unbiased': 68.913, 'valid/diff': 37.139, 'valid/acc_skew': 50.343, 'valid/acc_align': 87.482, 'test/acc': 78.757, 'test/acc_unbiased': 72.286, 'test/diff': 31.456, 'test/acc_skew': 56.558, 'test/acc_align': 88.014}
[8 / 20] best valid accuracy: 70.484 at epoch 3 
 best_stats: {'best_valid_epoch': 3, 'best_valid_valid/acc': 75.661, 'best_valid_valid/acc_unbiased': 70.484, 'best_valid_valid/diff': 12.756, 'best_valid_valid/acc_skew': 67.746, 'best_valid_valid/acc_align': 73.223, 'best_valid_test/acc': 76.113, 'best_valid_test/acc_unbiased': 68.571, 'best_valid_test/diff': 18.317, 'best_valid_test/acc_skew': 68.663, 'best_valid_test/acc_align': 68.479}
[8 / 20] best test accuracy: 72.286 at epoch 8 
 best_stats: {'best_test_epoch': 8, 'best_test_valid/acc': 76.235, 'best_test_valid/acc_unbiased': 68.913, 'best_test_valid/diff': 37.139, 'best_test_valid/acc_skew': 50.343, 'best_test_valid/acc_align': 87.482, 'best_test_test/acc': 78.757, 'best_test_test/acc_unbiased': 72.286, 'best_test_test/diff': 31.456, 'best_test_test/acc_skew': 56.558, 'best_test_test/acc_align': 88.014}
[9 / 20] Learning rate: 0.0001 weight: 0.01
[9 / 20] Loss: 4.079314919546364 CE Loss: 0.4001773541806477 Con Loss: 4.075313150012417
[9 / 20] tensor([[0.968, 0.455],
        [0.599, 0.782]]) {'epoch': 9, 'valid/acc': 74.78, 'valid/acc_unbiased': 68.15, 'valid/diff': 37.539, 'valid/acc_skew': 49.381, 'valid/acc_align': 86.92, 'test/acc': 77.347, 'test/acc_unbiased': 70.073, 'test/diff': 34.831, 'test/acc_skew': 52.658, 'test/acc_align': 87.489}
[9 / 20] best valid accuracy: 70.484 at epoch 3 
 best_stats: {'best_valid_epoch': 3, 'best_valid_valid/acc': 75.661, 'best_valid_valid/acc_unbiased': 70.484, 'best_valid_valid/diff': 12.756, 'best_valid_valid/acc_skew': 67.746, 'best_valid_valid/acc_align': 73.223, 'best_valid_test/acc': 76.113, 'best_valid_test/acc_unbiased': 68.571, 'best_valid_test/diff': 18.317, 'best_valid_test/acc_skew': 68.663, 'best_valid_test/acc_align': 68.479}
[9 / 20] best test accuracy: 72.286 at epoch 8 
 best_stats: {'best_test_epoch': 8, 'best_test_valid/acc': 76.235, 'best_test_valid/acc_unbiased': 68.913, 'best_test_valid/diff': 37.139, 'best_test_valid/acc_skew': 50.343, 'best_test_valid/acc_align': 87.482, 'best_test_test/acc': 78.757, 'best_test_test/acc_unbiased': 72.286, 'best_test_test/diff': 31.456, 'best_test_test/acc_skew': 56.558, 'best_test_test/acc_align': 88.014}
[10 / 20] Learning rate: 0.0001 weight: 0.01
[10 / 20] Loss: 4.035014602763963 CE Loss: 0.3864533503775916 Con Loss: 4.031150080210615
[10 / 20] tensor([[0.956, 0.466],
        [0.616, 0.788]]) {'epoch': 10, 'valid/acc': 75.265, 'valid/acc_unbiased': 68.394, 'valid/diff': 36.362, 'valid/acc_skew': 50.213, 'valid/acc_align': 86.575, 'test/acc': 77.567, 'test/acc_unbiased': 70.635, 'test/diff': 33.088, 'test/acc_skew': 54.091, 'test/acc_align': 87.179}
[10 / 20] best valid accuracy: 70.484 at epoch 3 
 best_stats: {'best_valid_epoch': 3, 'best_valid_valid/acc': 75.661, 'best_valid_valid/acc_unbiased': 70.484, 'best_valid_valid/diff': 12.756, 'best_valid_valid/acc_skew': 67.746, 'best_valid_valid/acc_align': 73.223, 'best_valid_test/acc': 76.113, 'best_valid_test/acc_unbiased': 68.571, 'best_valid_test/diff': 18.317, 'best_valid_test/acc_skew': 68.663, 'best_valid_test/acc_align': 68.479}
[10 / 20] best test accuracy: 72.286 at epoch 8 
 best_stats: {'best_test_epoch': 8, 'best_test_valid/acc': 76.235, 'best_test_valid/acc_unbiased': 68.913, 'best_test_valid/diff': 37.139, 'best_test_valid/acc_skew': 50.343, 'best_test_valid/acc_align': 87.482, 'best_test_test/acc': 78.757, 'best_test_test/acc_unbiased': 72.286, 'best_test_test/diff': 31.456, 'best_test_test/acc_skew': 56.558, 'best_test_test/acc_align': 88.014}
[11 / 20] Learning rate: 0.0001 weight: 0.01
[11 / 20] Loss: 4.005089078401189 CE Loss: 0.3804567443190867 Con Loss: 4.001284497902662
[11 / 20] tensor([[0.964, 0.432],
        [0.579, 0.782]]) {'epoch': 11, 'valid/acc': 74.206, 'valid/acc_unbiased': 67.536, 'valid/diff': 40.145, 'valid/acc_skew': 47.464, 'valid/acc_align': 87.609, 'test/acc': 76.245, 'test/acc_unbiased': 68.921, 'test/diff': 36.759, 'test/acc_skew': 50.541, 'test/acc_align': 87.3}
[11 / 20] best valid accuracy: 70.484 at epoch 3 
 best_stats: {'best_valid_epoch': 3, 'best_valid_valid/acc': 75.661, 'best_valid_valid/acc_unbiased': 70.484, 'best_valid_valid/diff': 12.756, 'best_valid_valid/acc_skew': 67.746, 'best_valid_valid/acc_align': 73.223, 'best_valid_test/acc': 76.113, 'best_valid_test/acc_unbiased': 68.571, 'best_valid_test/diff': 18.317, 'best_valid_test/acc_skew': 68.663, 'best_valid_test/acc_align': 68.479}
[11 / 20] best test accuracy: 72.286 at epoch 8 
 best_stats: {'best_test_epoch': 8, 'best_test_valid/acc': 76.235, 'best_test_valid/acc_unbiased': 68.913, 'best_test_valid/diff': 37.139, 'best_test_valid/acc_skew': 50.343, 'best_test_valid/acc_align': 87.482, 'best_test_test/acc': 78.757, 'best_test_test/acc_unbiased': 72.286, 'best_test_test/diff': 31.456, 'best_test_test/acc_skew': 56.558, 'best_test_test/acc_align': 88.014}
[12 / 20] Learning rate: 0.0001 weight: 0.01
[12 / 20] Loss: 4.044507580096246 CE Loss: 0.3780498210855389 Con Loss: 4.040727076125208
[12 / 20] tensor([[0.966, 0.449],
        [0.595, 0.800]]) {'epoch': 12, 'valid/acc': 74.162, 'valid/acc_unbiased': 67.609, 'valid/diff': 39.504, 'valid/acc_skew': 47.858, 'valid/acc_align': 87.361, 'test/acc': 77.215, 'test/acc_unbiased': 70.252, 'test/diff': 36.103, 'test/acc_skew': 52.201, 'test/acc_align': 88.303}
[12 / 20] best valid accuracy: 70.484 at epoch 3 
 best_stats: {'best_valid_epoch': 3, 'best_valid_valid/acc': 75.661, 'best_valid_valid/acc_unbiased': 70.484, 'best_valid_valid/diff': 12.756, 'best_valid_valid/acc_skew': 67.746, 'best_valid_valid/acc_align': 73.223, 'best_valid_test/acc': 76.113, 'best_valid_test/acc_unbiased': 68.571, 'best_valid_test/diff': 18.317, 'best_valid_test/acc_skew': 68.663, 'best_valid_test/acc_align': 68.479}
[12 / 20] best test accuracy: 72.286 at epoch 8 
 best_stats: {'best_test_epoch': 8, 'best_test_valid/acc': 76.235, 'best_test_valid/acc_unbiased': 68.913, 'best_test_valid/diff': 37.139, 'best_test_valid/acc_skew': 50.343, 'best_test_valid/acc_align': 87.482, 'best_test_test/acc': 78.757, 'best_test_test/acc_unbiased': 72.286, 'best_test_test/diff': 31.456, 'best_test_test/acc_skew': 56.558, 'best_test_test/acc_align': 88.014}
[13 / 20] Learning rate: 0.0001 weight: 0.01
[13 / 20] Loss: 3.9571809754394853 CE Loss: 0.3672517900083539 Con Loss: 3.953508467586779
[13 / 20] tensor([[0.935, 0.364],
        [0.692, 0.855]]) {'epoch': 13, 'valid/acc': 77.469, 'valid/acc_unbiased': 69.041, 'valid/diff': 40.057, 'valid/acc_skew': 49.013, 'valid/acc_align': 89.069, 'test/acc': 79.198, 'test/acc_unbiased': 71.13, 'test/diff': 36.692, 'test/acc_skew': 52.784, 'test/acc_align': 89.476}
[13 / 20] best valid accuracy: 70.484 at epoch 3 
 best_stats: {'best_valid_epoch': 3, 'best_valid_valid/acc': 75.661, 'best_valid_valid/acc_unbiased': 70.484, 'best_valid_valid/diff': 12.756, 'best_valid_valid/acc_skew': 67.746, 'best_valid_valid/acc_align': 73.223, 'best_valid_test/acc': 76.113, 'best_valid_test/acc_unbiased': 68.571, 'best_valid_test/diff': 18.317, 'best_valid_test/acc_skew': 68.663, 'best_valid_test/acc_align': 68.479}
[13 / 20] best test accuracy: 72.286 at epoch 8 
 best_stats: {'best_test_epoch': 8, 'best_test_valid/acc': 76.235, 'best_test_valid/acc_unbiased': 68.913, 'best_test_valid/diff': 37.139, 'best_test_valid/acc_skew': 50.343, 'best_test_valid/acc_align': 87.482, 'best_test_test/acc': 78.757, 'best_test_test/acc_unbiased': 72.286, 'best_test_test/diff': 31.456, 'best_test_test/acc_skew': 56.558, 'best_test_test/acc_align': 88.014}
[14 / 20] Learning rate: 1e-05 weight: 0.01
[14 / 20] Loss: 3.950022583550525 CE Loss: 0.3755672433902065 Con Loss: 3.9462669044788834
[14 / 20] tensor([[0.957, 0.415],
        [0.638, 0.824]]) {'epoch': 14, 'valid/acc': 75.573, 'valid/acc_unbiased': 67.899, 'valid/diff': 40.924, 'valid/acc_skew': 47.437, 'valid/acc_align': 88.361, 'test/acc': 78.316, 'test/acc_unbiased': 70.837, 'test/diff': 36.414, 'test/acc_skew': 52.63, 'test/acc_align': 89.044}
[14 / 20] best valid accuracy: 70.484 at epoch 3 
 best_stats: {'best_valid_epoch': 3, 'best_valid_valid/acc': 75.661, 'best_valid_valid/acc_unbiased': 70.484, 'best_valid_valid/diff': 12.756, 'best_valid_valid/acc_skew': 67.746, 'best_valid_valid/acc_align': 73.223, 'best_valid_test/acc': 76.113, 'best_valid_test/acc_unbiased': 68.571, 'best_valid_test/diff': 18.317, 'best_valid_test/acc_skew': 68.663, 'best_valid_test/acc_align': 68.479}
[14 / 20] best test accuracy: 72.286 at epoch 8 
 best_stats: {'best_test_epoch': 8, 'best_test_valid/acc': 76.235, 'best_test_valid/acc_unbiased': 68.913, 'best_test_valid/diff': 37.139, 'best_test_valid/acc_skew': 50.343, 'best_test_valid/acc_align': 87.482, 'best_test_test/acc': 78.757, 'best_test_test/acc_unbiased': 72.286, 'best_test_test/diff': 31.456, 'best_test_test/acc_skew': 56.558, 'best_test_test/acc_align': 88.014}
[15 / 20] Learning rate: 1e-05 weight: 0.01
[15 / 20] Loss: 3.9300120615057623 CE Loss: 0.370395006724218 Con Loss: 3.9263081214973337
[15 / 20] tensor([[0.961, 0.415],
        [0.616, 0.824]]) {'epoch': 15, 'valid/acc': 74.824, 'valid/acc_unbiased': 67.282, 'valid/diff': 41.555, 'valid/acc_skew': 46.505, 'valid/acc_align': 88.06, 'test/acc': 77.699, 'test/acc_unbiased': 70.407, 'test/diff': 37.745, 'test/acc_skew': 51.534, 'test/acc_align': 89.28}
[15 / 20] best valid accuracy: 70.484 at epoch 3 
 best_stats: {'best_valid_epoch': 3, 'best_valid_valid/acc': 75.661, 'best_valid_valid/acc_unbiased': 70.484, 'best_valid_valid/diff': 12.756, 'best_valid_valid/acc_skew': 67.746, 'best_valid_valid/acc_align': 73.223, 'best_valid_test/acc': 76.113, 'best_valid_test/acc_unbiased': 68.571, 'best_valid_test/diff': 18.317, 'best_valid_test/acc_skew': 68.663, 'best_valid_test/acc_align': 68.479}
[15 / 20] best test accuracy: 72.286 at epoch 8 
 best_stats: {'best_test_epoch': 8, 'best_test_valid/acc': 76.235, 'best_test_valid/acc_unbiased': 68.913, 'best_test_valid/diff': 37.139, 'best_test_valid/acc_skew': 50.343, 'best_test_valid/acc_align': 87.482, 'best_test_test/acc': 78.757, 'best_test_test/acc_unbiased': 72.286, 'best_test_test/diff': 31.456, 'best_test_test/acc_skew': 56.558, 'best_test_test/acc_align': 88.014}
[16 / 20] Learning rate: 1e-05 weight: 0.01
[16 / 20] Loss: 3.879942567461843 CE Loss: 0.3672634907560552 Con Loss: 3.8762699239310234
[16 / 20] tensor([[0.963, 0.415],
        [0.621, 0.830]]) {'epoch': 16, 'valid/acc': 75.176, 'valid/acc_unbiased': 67.817, 'valid/diff': 40.885, 'valid/acc_skew': 47.374, 'valid/acc_align': 88.259, 'test/acc': 78.008, 'test/acc_unbiased': 70.721, 'test/diff': 37.912, 'test/acc_skew': 51.765, 'test/acc_align': 89.677}
[16 / 20] best valid accuracy: 70.484 at epoch 3 
 best_stats: {'best_valid_epoch': 3, 'best_valid_valid/acc': 75.661, 'best_valid_valid/acc_unbiased': 70.484, 'best_valid_valid/diff': 12.756, 'best_valid_valid/acc_skew': 67.746, 'best_valid_valid/acc_align': 73.223, 'best_valid_test/acc': 76.113, 'best_valid_test/acc_unbiased': 68.571, 'best_valid_test/diff': 18.317, 'best_valid_test/acc_skew': 68.663, 'best_valid_test/acc_align': 68.479}
[16 / 20] best test accuracy: 72.286 at epoch 8 
 best_stats: {'best_test_epoch': 8, 'best_test_valid/acc': 76.235, 'best_test_valid/acc_unbiased': 68.913, 'best_test_valid/diff': 37.139, 'best_test_valid/acc_skew': 50.343, 'best_test_valid/acc_align': 87.482, 'best_test_test/acc': 78.757, 'best_test_test/acc_unbiased': 72.286, 'best_test_test/diff': 31.456, 'best_test_test/acc_skew': 56.558, 'best_test_test/acc_align': 88.014}
[17 / 20] Learning rate: 1e-05 weight: 0.01
[17 / 20] Loss: 3.9797258627008563 CE Loss: 0.35824544788611956 Con Loss: 3.976143414230661
[17 / 20] tensor([[0.969, 0.420],
        [0.582, 0.812]]) {'epoch': 17, 'valid/acc': 73.765, 'valid/acc_unbiased': 66.275, 'valid/diff': 39.794, 'valid/acc_skew': 46.379, 'valid/acc_align': 86.172, 'test/acc': 76.73, 'test/acc_unbiased': 69.599, 'test/diff': 38.905, 'test/acc_skew': 50.146, 'test/acc_align': 89.051}
[17 / 20] best valid accuracy: 70.484 at epoch 3 
 best_stats: {'best_valid_epoch': 3, 'best_valid_valid/acc': 75.661, 'best_valid_valid/acc_unbiased': 70.484, 'best_valid_valid/diff': 12.756, 'best_valid_valid/acc_skew': 67.746, 'best_valid_valid/acc_align': 73.223, 'best_valid_test/acc': 76.113, 'best_valid_test/acc_unbiased': 68.571, 'best_valid_test/diff': 18.317, 'best_valid_test/acc_skew': 68.663, 'best_valid_test/acc_align': 68.479}
[17 / 20] best test accuracy: 72.286 at epoch 8 
 best_stats: {'best_test_epoch': 8, 'best_test_valid/acc': 76.235, 'best_test_valid/acc_unbiased': 68.913, 'best_test_valid/diff': 37.139, 'best_test_valid/acc_skew': 50.343, 'best_test_valid/acc_align': 87.482, 'best_test_test/acc': 78.757, 'best_test_test/acc_unbiased': 72.286, 'best_test_test/diff': 31.456, 'best_test_test/acc_skew': 56.558, 'best_test_test/acc_align': 88.014}
[18 / 20] Learning rate: 1e-05 weight: 0.01
[18 / 20] Loss: 3.8775086900974562 CE Loss: 0.36790628980626244 Con Loss: 3.8738296330979325
[18 / 20] tensor([[0.963, 0.415],
        [0.622, 0.824]]) {'epoch': 18, 'valid/acc': 74.647, 'valid/acc_unbiased': 67.065, 'valid/diff': 41.99, 'valid/acc_skew': 46.07, 'valid/acc_align': 88.06, 'test/acc': 78.008, 'test/acc_unbiased': 70.599, 'test/diff': 37.551, 'test/acc_skew': 51.823, 'test/acc_align': 89.374}
[18 / 20] best valid accuracy: 70.484 at epoch 3 
 best_stats: {'best_valid_epoch': 3, 'best_valid_valid/acc': 75.661, 'best_valid_valid/acc_unbiased': 70.484, 'best_valid_valid/diff': 12.756, 'best_valid_valid/acc_skew': 67.746, 'best_valid_valid/acc_align': 73.223, 'best_valid_test/acc': 76.113, 'best_valid_test/acc_unbiased': 68.571, 'best_valid_test/diff': 18.317, 'best_valid_test/acc_skew': 68.663, 'best_valid_test/acc_align': 68.479}
[18 / 20] best test accuracy: 72.286 at epoch 8 
 best_stats: {'best_test_epoch': 8, 'best_test_valid/acc': 76.235, 'best_test_valid/acc_unbiased': 68.913, 'best_test_valid/diff': 37.139, 'best_test_valid/acc_skew': 50.343, 'best_test_valid/acc_align': 87.482, 'best_test_test/acc': 78.757, 'best_test_test/acc_unbiased': 72.286, 'best_test_test/diff': 31.456, 'best_test_test/acc_skew': 56.558, 'best_test_test/acc_align': 88.014}
[19 / 20] Learning rate: 1e-05 weight: 0.01
[19 / 20] Loss: 3.905873672741712 CE Loss: 0.3555153956666773 Con Loss: 3.9023185197622396
[19 / 20] tensor([[0.959, 0.398],
        [0.630, 0.830]]) {'epoch': 19, 'valid/acc': 75.044, 'valid/acc_unbiased': 67.345, 'valid/diff': 41.635, 'valid/acc_skew': 46.527, 'valid/acc_align': 88.162, 'test/acc': 78.052, 'test/acc_unbiased': 70.432, 'test/diff': 38.115, 'test/acc_skew': 51.374, 'test/acc_align': 89.489}
[19 / 20] best valid accuracy: 70.484 at epoch 3 
 best_stats: {'best_valid_epoch': 3, 'best_valid_valid/acc': 75.661, 'best_valid_valid/acc_unbiased': 70.484, 'best_valid_valid/diff': 12.756, 'best_valid_valid/acc_skew': 67.746, 'best_valid_valid/acc_align': 73.223, 'best_valid_test/acc': 76.113, 'best_valid_test/acc_unbiased': 68.571, 'best_valid_test/diff': 18.317, 'best_valid_test/acc_skew': 68.663, 'best_valid_test/acc_align': 68.479}
[19 / 20] best test accuracy: 72.286 at epoch 8 
 best_stats: {'best_test_epoch': 8, 'best_test_valid/acc': 76.235, 'best_test_valid/acc_unbiased': 68.913, 'best_test_valid/diff': 37.139, 'best_test_valid/acc_skew': 50.343, 'best_test_valid/acc_align': 87.482, 'best_test_test/acc': 78.757, 'best_test_test/acc_unbiased': 72.286, 'best_test_test/diff': 31.456, 'best_test_test/acc_skew': 56.558, 'best_test_test/acc_align': 88.014}
[20 / 20] Learning rate: 1e-05 weight: 0.01
[20 / 20] Loss: 3.855798006325525 CE Loss: 0.35490924177969585 Con Loss: 3.8522488965563273
[20 / 20] tensor([[0.963, 0.409],
        [0.604, 0.824]]) {'epoch': 20, 'valid/acc': 74.383, 'valid/acc_unbiased': 66.879, 'valid/diff': 41.663, 'valid/acc_skew': 46.048, 'valid/acc_align': 87.711, 'test/acc': 77.303, 'test/acc_unbiased': 70.024, 'test/diff': 38.701, 'test/acc_skew': 50.674, 'test/acc_align': 89.374}
[20 / 20] best valid accuracy: 70.484 at epoch 3 
 best_stats: {'best_valid_epoch': 3, 'best_valid_valid/acc': 75.661, 'best_valid_valid/acc_unbiased': 70.484, 'best_valid_valid/diff': 12.756, 'best_valid_valid/acc_skew': 67.746, 'best_valid_valid/acc_align': 73.223, 'best_valid_test/acc': 76.113, 'best_valid_test/acc_unbiased': 68.571, 'best_valid_test/diff': 18.317, 'best_valid_test/acc_skew': 68.663, 'best_valid_test/acc_align': 68.479}
[20 / 20] best test accuracy: 72.286 at epoch 8 
 best_stats: {'best_test_epoch': 8, 'best_test_valid/acc': 76.235, 'best_test_valid/acc_unbiased': 68.913, 'best_test_valid/diff': 37.139, 'best_test_valid/acc_skew': 50.343, 'best_test_valid/acc_align': 87.482, 'best_test_test/acc': 78.757, 'best_test_test/acc_unbiased': 72.286, 'best_test_test/diff': 31.456, 'best_test_test/acc_skew': 56.558, 'best_test_test/acc_align': 88.014}
Total training time: 0:17:48
