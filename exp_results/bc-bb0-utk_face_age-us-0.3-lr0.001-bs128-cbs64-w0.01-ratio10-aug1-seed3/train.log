Log level set to: INFO
Set seed: 3
=======> Using Fixed Random Seed: 3 <========
save_path: exp_results/bc-bb0-utk_face_age-us-0.3-lr0.001-bs128-cbs64-w0.01-ratio10-aug1-seed3
get_utk_face - split: train, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_age-0.3
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [8237, 1033]
Target 1: [5765, 1477]
Binary Target 1
---------------------------
Target 0: [8237, 1033]
Target 1: [5765, 1477]
===================================
Normal Label Distribution: 
Target 0: [8237, 1033]
Target 1: [5765, 1477]
===================================
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [1033, 1033]
Target 1: [1033, 1033]
Binary Target 1
---------------------------
Target 0: [1033, 1033]
Target 1: [1033, 1033]
===================================
Normal Label Distribution: 
Target 0: [1033, 1033]
Target 1: [1033, 1033]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 4132, target_attr: gender, bias_attr: age bias_rate: 0.3
['[train] target_0-bias_0: 1033', '[train] target_0-bias_1: 1033', '[train] target_1-bias_0: 1033', '[train] target_1-bias_1: 1033']
confusion_matrix - 
 original: tensor([[1033., 1033.],
        [1033., 1033.]]), 
 normalized: tensor([[0.500, 0.500],
        [0.500, 0.500]]), 
 b|y: tensor([[0.500, 0.500],
        [0.500, 0.500]])
get_utk_face - split: train, aug: 1, given_y: True, ratio: 10
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_age-0.3
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [8237, 1033]
Target 1: [5765, 1477]
Binary Target 1
---------------------------
Target 0: [8237, 1033]
Target 1: [5765, 1477]
===================================
Normal Label Distribution: 
Target 0: [8237, 1033]
Target 1: [5765, 1477]
===================================
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [1033, 1033]
Target 1: [1033, 1033]
Binary Target 1
---------------------------
Target 0: [1033, 1033]
Target 1: [1033, 1033]
===================================
Normal Label Distribution: 
Target 0: [1033, 1033]
Target 1: [1033, 1033]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 4132, target_attr: gender, bias_attr: age bias_rate: 0.3
['[train] target_0-bias_0: 1033', '[train] target_0-bias_1: 1033', '[train] target_1-bias_0: 1033', '[train] target_1-bias_1: 1033']
get_utk_face - split: valid, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_age-0.3
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [1030, 195]
Target 1: [841, 202]
Binary Target 1
---------------------------
Target 0: [1030, 195]
Target 1: [841, 202]
===================================
Normal Label Distribution: 
Target 0: [1030, 195]
Target 1: [841, 202]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 2268, target_attr: gender, bias_attr: age bias_rate: 0.3
['[valid] target_0-bias_0: 1030', '[valid] target_0-bias_1: 195', '[valid] target_1-bias_0: 841', '[valid] target_1-bias_1: 202']
get_utk_face - split: test, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_age-0.3
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [1061, 176]
Target 1: [867, 165]
Binary Target 1
---------------------------
Target 0: [1061, 176]
Target 1: [867, 165]
===================================
Normal Label Distribution: 
Target 0: [1061, 176]
Target 1: [867, 165]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 2269, target_attr: gender, bias_attr: age bias_rate: 0.3
['[test] target_0-bias_0: 1061', '[test] target_0-bias_1: 176', '[test] target_1-bias_0: 867', '[test] target_1-bias_1: 165']
decay_epochs: [6, 13]
[1 / 20] Learning rate: 0.001 weight: 0.01
[1 / 20] Loss: 5.052909146204576 CE Loss: 0.7038356179997166 Con Loss: 5.045870775405573
[1 / 20] tensor([[0.599, 0.665],
        [0.749, 0.473]]) {'epoch': 1, 'valid/acc': 66.534, 'valid/acc_unbiased': 64.206, 'valid/diff': 9.88, 'valid/acc_skew': 68.365, 'valid/acc_align': 60.048, 'test/acc': 65.227, 'test/acc_unbiased': 62.137, 'test/diff': 17.058, 'test/acc_skew': 67.4, 'test/acc_align': 56.875}
[1 / 20] best valid accuracy: 64.206 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 66.534, 'best_valid_valid/acc_unbiased': 64.206, 'best_valid_valid/diff': 9.88, 'best_valid_valid/acc_skew': 68.365, 'best_valid_valid/acc_align': 60.048, 'best_valid_test/acc': 65.227, 'best_valid_test/acc_unbiased': 62.137, 'best_valid_test/diff': 17.058, 'best_valid_test/acc_skew': 67.4, 'best_valid_test/acc_align': 56.875}
[1 / 20] best test accuracy: 62.137 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 66.534, 'best_test_valid/acc_unbiased': 64.206, 'best_test_valid/diff': 9.88, 'best_test_valid/acc_skew': 68.365, 'best_test_valid/acc_align': 60.048, 'best_test_test/acc': 65.227, 'best_test_test/acc_unbiased': 62.137, 'best_test_test/diff': 17.058, 'best_test_test/acc_skew': 67.4, 'best_test_test/acc_align': 56.875}
[2 / 20] Learning rate: 0.001 weight: 0.01
[2 / 20] Loss: 4.849535915766197 CE Loss: 0.6379593577297243 Con Loss: 4.843156316965847
[2 / 20] tensor([[0.882, 0.812],
        [0.550, 0.491]]) {'epoch': 2, 'valid/acc': 73.148, 'valid/acc_unbiased': 70.094, 'valid/diff': 5.256, 'valid/acc_skew': 72.722, 'valid/acc_align': 67.466, 'test/acc': 72.146, 'test/acc_unbiased': 68.394, 'test/diff': 6.448, 'test/acc_skew': 71.618, 'test/acc_align': 65.17}
[2 / 20] best valid accuracy: 70.094 at epoch 2 
 best_stats: {'best_valid_epoch': 2, 'best_valid_valid/acc': 73.148, 'best_valid_valid/acc_unbiased': 70.094, 'best_valid_valid/diff': 5.256, 'best_valid_valid/acc_skew': 72.722, 'best_valid_valid/acc_align': 67.466, 'best_valid_test/acc': 72.146, 'best_valid_test/acc_unbiased': 68.394, 'best_valid_test/diff': 6.448, 'best_valid_test/acc_skew': 71.618, 'best_valid_test/acc_align': 65.17}
[2 / 20] best test accuracy: 68.394 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 73.148, 'best_test_valid/acc_unbiased': 70.094, 'best_test_valid/diff': 5.256, 'best_test_valid/acc_skew': 72.722, 'best_test_valid/acc_align': 67.466, 'best_test_test/acc': 72.146, 'best_test_test/acc_unbiased': 68.394, 'best_test_test/diff': 6.448, 'best_test_test/acc_skew': 71.618, 'best_test_test/acc_align': 65.17}
[3 / 20] Learning rate: 0.001 weight: 0.01
[3 / 20] Loss: 4.84166242261593 CE Loss: 0.6119660156971026 Con Loss: 4.835542778539519
[3 / 20] tensor([[0.794, 0.648],
        [0.758, 0.594]]) {'epoch': 3, 'valid/acc': 75.441, 'valid/acc_unbiased': 72.62, 'valid/diff': 8.346, 'valid/acc_skew': 76.793, 'valid/acc_align': 68.446, 'test/acc': 75.408, 'test/acc_unbiased': 69.826, 'test/diff': 15.485, 'test/acc_skew': 77.569, 'test/acc_align': 62.083}
[3 / 20] best valid accuracy: 72.620 at epoch 3 
 best_stats: {'best_valid_epoch': 3, 'best_valid_valid/acc': 75.441, 'best_valid_valid/acc_unbiased': 72.62, 'best_valid_valid/diff': 8.346, 'best_valid_valid/acc_skew': 76.793, 'best_valid_valid/acc_align': 68.446, 'best_valid_test/acc': 75.408, 'best_valid_test/acc_unbiased': 69.826, 'best_valid_test/diff': 15.485, 'best_valid_test/acc_skew': 77.569, 'best_valid_test/acc_align': 62.083}
[3 / 20] best test accuracy: 69.826 at epoch 3 
 best_stats: {'best_test_epoch': 3, 'best_test_valid/acc': 75.441, 'best_test_valid/acc_unbiased': 72.62, 'best_test_valid/diff': 8.346, 'best_test_valid/acc_skew': 76.793, 'best_test_valid/acc_align': 68.446, 'best_test_test/acc': 75.408, 'best_test_test/acc_unbiased': 69.826, 'best_test_test/diff': 15.485, 'best_test_test/acc_skew': 77.569, 'best_test_test/acc_align': 62.083}
[4 / 20] Learning rate: 0.001 weight: 0.01
[4 / 20] Loss: 4.826263125845216 CE Loss: 0.5745323777256492 Con Loss: 4.820517821556601
[4 / 20] tensor([[0.614, 0.557],
        [0.886, 0.782]]) {'epoch': 4, 'valid/acc': 73.104, 'valid/acc_unbiased': 69.454, 'valid/diff': 14.677, 'valid/acc_skew': 76.792, 'valid/acc_align': 62.115, 'test/acc': 72.543, 'test/acc_unbiased': 70.951, 'test/diff': 8.037, 'test/acc_skew': 74.969, 'test/acc_align': 66.932}
[4 / 20] best valid accuracy: 72.620 at epoch 3 
 best_stats: {'best_valid_epoch': 3, 'best_valid_valid/acc': 75.441, 'best_valid_valid/acc_unbiased': 72.62, 'best_valid_valid/diff': 8.346, 'best_valid_valid/acc_skew': 76.793, 'best_valid_valid/acc_align': 68.446, 'best_valid_test/acc': 75.408, 'best_valid_test/acc_unbiased': 69.826, 'best_valid_test/diff': 15.485, 'best_valid_test/acc_skew': 77.569, 'best_valid_test/acc_align': 62.083}
[4 / 20] best test accuracy: 70.951 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 73.104, 'best_test_valid/acc_unbiased': 69.454, 'best_test_valid/diff': 14.677, 'best_test_valid/acc_skew': 76.792, 'best_test_valid/acc_align': 62.115, 'best_test_test/acc': 72.543, 'best_test_test/acc_unbiased': 70.951, 'best_test_test/diff': 8.037, 'best_test_test/acc_skew': 74.969, 'best_test_test/acc_align': 66.932}
[5 / 20] Learning rate: 0.001 weight: 0.01
[5 / 20] Loss: 4.833765933728287 CE Loss: 0.5883343011458176 Con Loss: 4.827882617163866
[5 / 20] tensor([[0.809, 0.750],
        [0.772, 0.582]]) {'epoch': 5, 'valid/acc': 76.72, 'valid/acc_unbiased': 72.01, 'valid/diff': 13.827, 'valid/acc_skew': 78.924, 'valid/acc_align': 65.096, 'test/acc': 77.347, 'test/acc_unbiased': 72.803, 'test/diff': 12.424, 'test/acc_skew': 79.015, 'test/acc_align': 66.591}
[5 / 20] best valid accuracy: 72.620 at epoch 3 
 best_stats: {'best_valid_epoch': 3, 'best_valid_valid/acc': 75.441, 'best_valid_valid/acc_unbiased': 72.62, 'best_valid_valid/diff': 8.346, 'best_valid_valid/acc_skew': 76.793, 'best_valid_valid/acc_align': 68.446, 'best_valid_test/acc': 75.408, 'best_valid_test/acc_unbiased': 69.826, 'best_valid_test/diff': 15.485, 'best_valid_test/acc_skew': 77.569, 'best_valid_test/acc_align': 62.083}
[5 / 20] best test accuracy: 72.803 at epoch 5 
 best_stats: {'best_test_epoch': 5, 'best_test_valid/acc': 76.72, 'best_test_valid/acc_unbiased': 72.01, 'best_test_valid/diff': 13.827, 'best_test_valid/acc_skew': 78.924, 'best_test_valid/acc_align': 65.096, 'best_test_test/acc': 77.347, 'best_test_test/acc_unbiased': 72.803, 'best_test_test/diff': 12.424, 'best_test_test/acc_skew': 79.015, 'best_test_test/acc_align': 66.591}
[6 / 20] Learning rate: 0.001 weight: 0.01
[6 / 20] Loss: 4.815250173312074 CE Loss: 0.5765682862781255 Con Loss: 4.809484496582859
[6 / 20] tensor([[0.667, 0.403],
        [0.874, 0.897]]) {'epoch': 6, 'valid/acc': 72.795, 'valid/acc_unbiased': 68.484, 'valid/diff': 18.452, 'valid/acc_skew': 76.259, 'valid/acc_align': 60.708, 'test/acc': 74.262, 'test/acc_unbiased': 71.049, 'test/diff': 14.329, 'test/acc_skew': 77.079, 'test/acc_align': 65.019}
[6 / 20] best valid accuracy: 72.620 at epoch 3 
 best_stats: {'best_valid_epoch': 3, 'best_valid_valid/acc': 75.441, 'best_valid_valid/acc_unbiased': 72.62, 'best_valid_valid/diff': 8.346, 'best_valid_valid/acc_skew': 76.793, 'best_valid_valid/acc_align': 68.446, 'best_valid_test/acc': 75.408, 'best_valid_test/acc_unbiased': 69.826, 'best_valid_test/diff': 15.485, 'best_valid_test/acc_skew': 77.569, 'best_valid_test/acc_align': 62.083}
[6 / 20] best test accuracy: 72.803 at epoch 5 
 best_stats: {'best_test_epoch': 5, 'best_test_valid/acc': 76.72, 'best_test_valid/acc_unbiased': 72.01, 'best_test_valid/diff': 13.827, 'best_test_valid/acc_skew': 78.924, 'best_test_valid/acc_align': 65.096, 'best_test_test/acc': 77.347, 'best_test_test/acc_unbiased': 72.803, 'best_test_test/diff': 12.424, 'best_test_test/acc_skew': 79.015, 'best_test_test/acc_align': 66.591}
[7 / 20] Learning rate: 0.0001 weight: 0.01
[7 / 20] Loss: 4.82273796059386 CE Loss: 0.5534215979169899 Con Loss: 4.817203751607416
[7 / 20] tensor([[0.873, 0.739],
        [0.759, 0.679]]) {'epoch': 7, 'valid/acc': 79.63, 'valid/acc_unbiased': 74.579, 'valid/diff': 14.104, 'valid/acc_skew': 81.631, 'valid/acc_align': 67.527, 'test/acc': 80.476, 'test/acc_unbiased': 76.228, 'test/diff': 10.714, 'test/acc_skew': 81.585, 'test/acc_align': 70.871}
[7 / 20] best valid accuracy: 74.579 at epoch 7 
 best_stats: {'best_valid_epoch': 7, 'best_valid_valid/acc': 79.63, 'best_valid_valid/acc_unbiased': 74.579, 'best_valid_valid/diff': 14.104, 'best_valid_valid/acc_skew': 81.631, 'best_valid_valid/acc_align': 67.527, 'best_valid_test/acc': 80.476, 'best_valid_test/acc_unbiased': 76.228, 'best_valid_test/diff': 10.714, 'best_valid_test/acc_skew': 81.585, 'best_valid_test/acc_align': 70.871}
[7 / 20] best test accuracy: 76.228 at epoch 7 
 best_stats: {'best_test_epoch': 7, 'best_test_valid/acc': 79.63, 'best_test_valid/acc_unbiased': 74.579, 'best_test_valid/diff': 14.104, 'best_test_valid/acc_skew': 81.631, 'best_test_valid/acc_align': 67.527, 'best_test_test/acc': 80.476, 'best_test_test/acc_unbiased': 76.228, 'best_test_test/diff': 10.714, 'best_test_test/acc_skew': 81.585, 'best_test_test/acc_align': 70.871}
[8 / 20] Learning rate: 0.0001 weight: 0.01
[8 / 20] Loss: 4.8144100610192035 CE Loss: 0.5306405292360503 Con Loss: 4.8091036324810315
[8 / 20] tensor([[0.877, 0.801],
        [0.761, 0.594]]) {'epoch': 8, 'valid/acc': 80.379, 'valid/acc_unbiased': 75.894, 'valid/diff': 12.011, 'valid/acc_skew': 81.9, 'valid/acc_align': 69.888, 'test/acc': 80.608, 'test/acc_unbiased': 75.821, 'test/diff': 12.135, 'test/acc_skew': 81.889, 'test/acc_align': 69.754}
[8 / 20] best valid accuracy: 75.894 at epoch 8 
 best_stats: {'best_valid_epoch': 8, 'best_valid_valid/acc': 80.379, 'best_valid_valid/acc_unbiased': 75.894, 'best_valid_valid/diff': 12.011, 'best_valid_valid/acc_skew': 81.9, 'best_valid_valid/acc_align': 69.888, 'best_valid_test/acc': 80.608, 'best_valid_test/acc_unbiased': 75.821, 'best_valid_test/diff': 12.135, 'best_valid_test/acc_skew': 81.889, 'best_valid_test/acc_align': 69.754}
[8 / 20] best test accuracy: 76.228 at epoch 7 
 best_stats: {'best_test_epoch': 7, 'best_test_valid/acc': 79.63, 'best_test_valid/acc_unbiased': 74.579, 'best_test_valid/diff': 14.104, 'best_test_valid/acc_skew': 81.631, 'best_test_valid/acc_align': 67.527, 'best_test_test/acc': 80.476, 'best_test_test/acc_unbiased': 76.228, 'best_test_test/diff': 10.714, 'best_test_test/acc_skew': 81.585, 'best_test_test/acc_align': 70.871}
[9 / 20] Learning rate: 0.0001 weight: 0.01
[9 / 20] Loss: 4.797529102410374 CE Loss: 0.5096206051105451 Con Loss: 4.792432894895984
[9 / 20] tensor([[0.859, 0.767],
        [0.790, 0.600]]) {'epoch': 9, 'valid/acc': 81.261, 'valid/acc_unbiased': 76.738, 'valid/diff': 12.834, 'valid/acc_skew': 83.155, 'valid/acc_align': 70.321, 'test/acc': 80.652, 'test/acc_unbiased': 75.394, 'test/diff': 14.083, 'test/acc_skew': 82.435, 'test/acc_align': 68.352}
[9 / 20] best valid accuracy: 76.738 at epoch 9 
 best_stats: {'best_valid_epoch': 9, 'best_valid_valid/acc': 81.261, 'best_valid_valid/acc_unbiased': 76.738, 'best_valid_valid/diff': 12.834, 'best_valid_valid/acc_skew': 83.155, 'best_valid_valid/acc_align': 70.321, 'best_valid_test/acc': 80.652, 'best_valid_test/acc_unbiased': 75.394, 'best_valid_test/diff': 14.083, 'best_valid_test/acc_skew': 82.435, 'best_valid_test/acc_align': 68.352}
[9 / 20] best test accuracy: 76.228 at epoch 7 
 best_stats: {'best_test_epoch': 7, 'best_test_valid/acc': 79.63, 'best_test_valid/acc_unbiased': 74.579, 'best_test_valid/diff': 14.104, 'best_test_valid/acc_skew': 81.631, 'best_test_valid/acc_align': 67.527, 'best_test_test/acc': 80.476, 'best_test_test/acc_unbiased': 76.228, 'best_test_test/diff': 10.714, 'best_test_test/acc_skew': 81.585, 'best_test_test/acc_align': 70.871}
[10 / 20] Learning rate: 0.0001 weight: 0.01
[10 / 20] Loss: 4.788194917640058 CE Loss: 0.5005785429062248 Con Loss: 4.783189129160081
[10 / 20] tensor([[0.836, 0.676],
        [0.824, 0.709]]) {'epoch': 10, 'valid/acc': 81.129, 'valid/acc_unbiased': 75.703, 'valid/diff': 16.511, 'valid/acc_skew': 83.958, 'valid/acc_align': 67.447, 'test/acc': 80.961, 'test/acc_unbiased': 76.119, 'test/diff': 13.715, 'test/acc_skew': 82.977, 'test/acc_align': 69.261}
[10 / 20] best valid accuracy: 76.738 at epoch 9 
 best_stats: {'best_valid_epoch': 9, 'best_valid_valid/acc': 81.261, 'best_valid_valid/acc_unbiased': 76.738, 'best_valid_valid/diff': 12.834, 'best_valid_valid/acc_skew': 83.155, 'best_valid_valid/acc_align': 70.321, 'best_valid_test/acc': 80.652, 'best_valid_test/acc_unbiased': 75.394, 'best_valid_test/diff': 14.083, 'best_valid_test/acc_skew': 82.435, 'best_valid_test/acc_align': 68.352}
[10 / 20] best test accuracy: 76.228 at epoch 7 
 best_stats: {'best_test_epoch': 7, 'best_test_valid/acc': 79.63, 'best_test_valid/acc_unbiased': 74.579, 'best_test_valid/diff': 14.104, 'best_test_valid/acc_skew': 81.631, 'best_test_valid/acc_align': 67.527, 'best_test_test/acc': 80.476, 'best_test_test/acc_unbiased': 76.228, 'best_test_test/diff': 10.714, 'best_test_test/acc_skew': 81.585, 'best_test_test/acc_align': 70.871}
[11 / 20] Learning rate: 0.0001 weight: 0.01
[11 / 20] Loss: 4.787941152567092 CE Loss: 0.5113329681110751 Con Loss: 4.78282782969147
[11 / 20] tensor([[0.882, 0.750],
        [0.782, 0.667]]) {'epoch': 11, 'valid/acc': 81.834, 'valid/acc_unbiased': 76.263, 'valid/diff': 15.933, 'valid/acc_skew': 84.229, 'valid/acc_align': 68.297, 'test/acc': 81.798, 'test/acc_unbiased': 77.022, 'test/diff': 12.376, 'test/acc_skew': 83.21, 'test/acc_align': 70.833}
[11 / 20] best valid accuracy: 76.738 at epoch 9 
 best_stats: {'best_valid_epoch': 9, 'best_valid_valid/acc': 81.261, 'best_valid_valid/acc_unbiased': 76.738, 'best_valid_valid/diff': 12.834, 'best_valid_valid/acc_skew': 83.155, 'best_valid_valid/acc_align': 70.321, 'best_valid_test/acc': 80.652, 'best_valid_test/acc_unbiased': 75.394, 'best_valid_test/diff': 14.083, 'best_valid_test/acc_skew': 82.435, 'best_valid_test/acc_align': 68.352}
[11 / 20] best test accuracy: 77.022 at epoch 11 
 best_stats: {'best_test_epoch': 11, 'best_test_valid/acc': 81.834, 'best_test_valid/acc_unbiased': 76.263, 'best_test_valid/diff': 15.933, 'best_test_valid/acc_skew': 84.229, 'best_test_valid/acc_align': 68.297, 'best_test_test/acc': 81.798, 'best_test_test/acc_unbiased': 77.022, 'best_test_test/diff': 12.376, 'best_test_test/acc_skew': 83.21, 'best_test_test/acc_align': 70.833}
[12 / 20] Learning rate: 0.0001 weight: 0.01
[12 / 20] Loss: 4.783343509921492 CE Loss: 0.49987924162439085 Con Loss: 4.778344704128535
[12 / 20] tensor([[0.842, 0.733],
        [0.835, 0.697]]) {'epoch': 12, 'valid/acc': 81.041, 'valid/acc_unbiased': 76.361, 'valid/diff': 14.343, 'valid/acc_skew': 83.532, 'valid/acc_align': 69.189, 'test/acc': 82.019, 'test/acc_unbiased': 77.666, 'test/diff': 12.34, 'test/acc_skew': 83.836, 'test/acc_align': 71.496}
[12 / 20] best valid accuracy: 76.738 at epoch 9 
 best_stats: {'best_valid_epoch': 9, 'best_valid_valid/acc': 81.261, 'best_valid_valid/acc_unbiased': 76.738, 'best_valid_valid/diff': 12.834, 'best_valid_valid/acc_skew': 83.155, 'best_valid_valid/acc_align': 70.321, 'best_valid_test/acc': 80.652, 'best_valid_test/acc_unbiased': 75.394, 'best_valid_test/diff': 14.083, 'best_valid_test/acc_skew': 82.435, 'best_valid_test/acc_align': 68.352}
[12 / 20] best test accuracy: 77.666 at epoch 12 
 best_stats: {'best_test_epoch': 12, 'best_test_valid/acc': 81.041, 'best_test_valid/acc_unbiased': 76.361, 'best_test_valid/diff': 14.343, 'best_test_valid/acc_skew': 83.532, 'best_test_valid/acc_align': 69.189, 'best_test_test/acc': 82.019, 'best_test_test/acc_unbiased': 77.666, 'best_test_test/diff': 12.34, 'best_test_test/acc_skew': 83.836, 'best_test_test/acc_align': 71.496}
[13 / 20] Learning rate: 0.0001 weight: 0.01
[13 / 20] Loss: 4.7873346840192825 CE Loss: 0.49146569750315916 Con Loss: 4.78242001390411
[13 / 20] tensor([[0.882, 0.761],
        [0.798, 0.648]]) {'epoch': 13, 'valid/acc': 81.834, 'valid/acc_unbiased': 76.899, 'valid/diff': 14.164, 'valid/acc_skew': 83.982, 'valid/acc_align': 69.817, 'test/acc': 82.371, 'test/acc_unbiased': 77.255, 'test/diff': 13.525, 'test/acc_skew': 84.017, 'test/acc_align': 70.492}
[13 / 20] best valid accuracy: 76.899 at epoch 13 
 best_stats: {'best_valid_epoch': 13, 'best_valid_valid/acc': 81.834, 'best_valid_valid/acc_unbiased': 76.899, 'best_valid_valid/diff': 14.164, 'best_valid_valid/acc_skew': 83.982, 'best_valid_valid/acc_align': 69.817, 'best_valid_test/acc': 82.371, 'best_valid_test/acc_unbiased': 77.255, 'best_valid_test/diff': 13.525, 'best_valid_test/acc_skew': 84.017, 'best_valid_test/acc_align': 70.492}
[13 / 20] best test accuracy: 77.666 at epoch 12 
 best_stats: {'best_test_epoch': 12, 'best_test_valid/acc': 81.041, 'best_test_valid/acc_unbiased': 76.361, 'best_test_valid/diff': 14.343, 'best_test_valid/acc_skew': 83.532, 'best_test_valid/acc_align': 69.189, 'best_test_test/acc': 82.019, 'best_test_test/acc_unbiased': 77.666, 'best_test_test/diff': 12.34, 'best_test_test/acc_skew': 83.836, 'best_test_test/acc_align': 71.496}
[14 / 20] Learning rate: 1e-05 weight: 0.01
[14 / 20] Loss: 4.767541411770048 CE Loss: 0.48055989055065773 Con Loss: 4.7627358385808005
[14 / 20] tensor([[0.883, 0.761],
        [0.791, 0.655]]) {'epoch': 14, 'valid/acc': 81.614, 'valid/acc_unbiased': 76.421, 'valid/diff': 14.71, 'valid/acc_skew': 83.775, 'valid/acc_align': 69.066, 'test/acc': 82.195, 'test/acc_unbiased': 77.257, 'test/diff': 12.923, 'test/acc_skew': 83.718, 'test/acc_align': 70.795}
[14 / 20] best valid accuracy: 76.899 at epoch 13 
 best_stats: {'best_valid_epoch': 13, 'best_valid_valid/acc': 81.834, 'best_valid_valid/acc_unbiased': 76.899, 'best_valid_valid/diff': 14.164, 'best_valid_valid/acc_skew': 83.982, 'best_valid_valid/acc_align': 69.817, 'best_valid_test/acc': 82.371, 'best_valid_test/acc_unbiased': 77.255, 'best_valid_test/diff': 13.525, 'best_valid_test/acc_skew': 84.017, 'best_valid_test/acc_align': 70.492}
[14 / 20] best test accuracy: 77.666 at epoch 12 
 best_stats: {'best_test_epoch': 12, 'best_test_valid/acc': 81.041, 'best_test_valid/acc_unbiased': 76.361, 'best_test_valid/diff': 14.343, 'best_test_valid/acc_skew': 83.532, 'best_test_valid/acc_align': 69.189, 'best_test_test/acc': 82.019, 'best_test_test/acc_unbiased': 77.666, 'best_test_test/diff': 12.34, 'best_test_test/acc_skew': 83.836, 'best_test_test/acc_align': 71.496}
[15 / 20] Learning rate: 1e-05 weight: 0.01
[15 / 20] Loss: 4.7541735987003175 CE Loss: 0.494364911392836 Con Loss: 4.749229952765111
[15 / 20] tensor([[0.864, 0.744],
        [0.827, 0.655]]) {'epoch': 15, 'valid/acc': 81.614, 'valid/acc_unbiased': 76.438, 'valid/diff': 15.382, 'valid/acc_skew': 84.129, 'valid/acc_align': 68.747, 'test/acc': 82.547, 'test/acc_unbiased': 77.253, 'test/diff': 14.62, 'test/acc_skew': 84.563, 'test/acc_align': 69.943}
[15 / 20] best valid accuracy: 76.899 at epoch 13 
 best_stats: {'best_valid_epoch': 13, 'best_valid_valid/acc': 81.834, 'best_valid_valid/acc_unbiased': 76.899, 'best_valid_valid/diff': 14.164, 'best_valid_valid/acc_skew': 83.982, 'best_valid_valid/acc_align': 69.817, 'best_valid_test/acc': 82.371, 'best_valid_test/acc_unbiased': 77.255, 'best_valid_test/diff': 13.525, 'best_valid_test/acc_skew': 84.017, 'best_valid_test/acc_align': 70.492}
[15 / 20] best test accuracy: 77.666 at epoch 12 
 best_stats: {'best_test_epoch': 12, 'best_test_valid/acc': 81.041, 'best_test_valid/acc_unbiased': 76.361, 'best_test_valid/diff': 14.343, 'best_test_valid/acc_skew': 83.532, 'best_test_valid/acc_align': 69.189, 'best_test_test/acc': 82.019, 'best_test_test/acc_unbiased': 77.666, 'best_test_test/diff': 12.34, 'best_test_test/acc_skew': 83.836, 'best_test_test/acc_align': 71.496}
[16 / 20] Learning rate: 1e-05 weight: 0.01
[16 / 20] Loss: 4.75727030522364 CE Loss: 0.4744293753775369 Con Loss: 4.752526022919381
[16 / 20] tensor([[0.877, 0.756],
        [0.814, 0.655]]) {'epoch': 16, 'valid/acc': 81.878, 'valid/acc_unbiased': 76.824, 'valid/diff': 14.597, 'valid/acc_skew': 84.122, 'valid/acc_align': 69.525, 'test/acc': 82.724, 'test/acc_unbiased': 77.527, 'test/diff': 14.03, 'test/acc_skew': 84.542, 'test/acc_align': 70.511}
[16 / 20] best valid accuracy: 76.899 at epoch 13 
 best_stats: {'best_valid_epoch': 13, 'best_valid_valid/acc': 81.834, 'best_valid_valid/acc_unbiased': 76.899, 'best_valid_valid/diff': 14.164, 'best_valid_valid/acc_skew': 83.982, 'best_valid_valid/acc_align': 69.817, 'best_valid_test/acc': 82.371, 'best_valid_test/acc_unbiased': 77.255, 'best_valid_test/diff': 13.525, 'best_valid_test/acc_skew': 84.017, 'best_valid_test/acc_align': 70.492}
[16 / 20] best test accuracy: 77.666 at epoch 12 
 best_stats: {'best_test_epoch': 12, 'best_test_valid/acc': 81.041, 'best_test_valid/acc_unbiased': 76.361, 'best_test_valid/diff': 14.343, 'best_test_valid/acc_skew': 83.532, 'best_test_valid/acc_align': 69.189, 'best_test_test/acc': 82.019, 'best_test_test/acc_unbiased': 77.666, 'best_test_test/diff': 12.34, 'best_test_test/acc_skew': 83.836, 'best_test_test/acc_align': 71.496}
[17 / 20] Learning rate: 1e-05 weight: 0.01
[17 / 20] Loss: 4.7721855439613545 CE Loss: 0.477554443123726 Con Loss: 4.767409985663238
[17 / 20] tensor([[0.864, 0.716],
        [0.829, 0.685]]) {'epoch': 17, 'valid/acc': 82.011, 'valid/acc_unbiased': 77.059, 'valid/diff': 14.714, 'valid/acc_skew': 84.416, 'valid/acc_align': 69.702, 'test/acc': 82.636, 'test/acc_unbiased': 77.358, 'test/diff': 14.641, 'test/acc_skew': 84.679, 'test/acc_align': 70.038}
[17 / 20] best valid accuracy: 77.059 at epoch 17 
 best_stats: {'best_valid_epoch': 17, 'best_valid_valid/acc': 82.011, 'best_valid_valid/acc_unbiased': 77.059, 'best_valid_valid/diff': 14.714, 'best_valid_valid/acc_skew': 84.416, 'best_valid_valid/acc_align': 69.702, 'best_valid_test/acc': 82.636, 'best_valid_test/acc_unbiased': 77.358, 'best_valid_test/diff': 14.641, 'best_valid_test/acc_skew': 84.679, 'best_valid_test/acc_align': 70.038}
[17 / 20] best test accuracy: 77.666 at epoch 12 
 best_stats: {'best_test_epoch': 12, 'best_test_valid/acc': 81.041, 'best_test_valid/acc_unbiased': 76.361, 'best_test_valid/diff': 14.343, 'best_test_valid/acc_skew': 83.532, 'best_test_valid/acc_align': 69.189, 'best_test_test/acc': 82.019, 'best_test_test/acc_unbiased': 77.666, 'best_test_test/diff': 12.34, 'best_test_test/acc_skew': 83.836, 'best_test_test/acc_align': 71.496}
[18 / 20] Learning rate: 1e-05 weight: 0.01
[18 / 20] Loss: 4.775824604052888 CE Loss: 0.48779419904064464 Con Loss: 4.770946689173651
[18 / 20] tensor([[0.877, 0.739],
        [0.814, 0.655]]) {'epoch': 18, 'valid/acc': 81.79, 'valid/acc_unbiased': 76.479, 'valid/diff': 15.428, 'valid/acc_skew': 84.193, 'valid/acc_align': 68.765, 'test/acc': 82.591, 'test/acc_unbiased': 77.1, 'test/diff': 14.883, 'test/acc_skew': 84.542, 'test/acc_align': 69.659}
[18 / 20] best valid accuracy: 77.059 at epoch 17 
 best_stats: {'best_valid_epoch': 17, 'best_valid_valid/acc': 82.011, 'best_valid_valid/acc_unbiased': 77.059, 'best_valid_valid/diff': 14.714, 'best_valid_valid/acc_skew': 84.416, 'best_valid_valid/acc_align': 69.702, 'best_valid_test/acc': 82.636, 'best_valid_test/acc_unbiased': 77.358, 'best_valid_test/diff': 14.641, 'best_valid_test/acc_skew': 84.679, 'best_valid_test/acc_align': 70.038}
[18 / 20] best test accuracy: 77.666 at epoch 12 
 best_stats: {'best_test_epoch': 12, 'best_test_valid/acc': 81.041, 'best_test_valid/acc_unbiased': 76.361, 'best_test_valid/diff': 14.343, 'best_test_valid/acc_skew': 83.532, 'best_test_valid/acc_align': 69.189, 'best_test_test/acc': 82.019, 'best_test_test/acc_unbiased': 77.666, 'best_test_test/diff': 12.34, 'best_test_test/acc_skew': 83.836, 'best_test_test/acc_align': 71.496}
[19 / 20] Learning rate: 1e-05 weight: 0.01
[19 / 20] Loss: 4.756266154485889 CE Loss: 0.47384704495099483 Con Loss: 4.751527674085057
[19 / 20] tensor([[0.882, 0.761],
        [0.812, 0.648]]) {'epoch': 19, 'valid/acc': 81.746, 'valid/acc_unbiased': 76.351, 'valid/diff': 15.596, 'valid/acc_skew': 84.149, 'valid/acc_align': 68.553, 'test/acc': 82.9, 'test/acc_unbiased': 77.601, 'test/diff': 14.217, 'test/acc_skew': 84.709, 'test/acc_align': 70.492}
[19 / 20] best valid accuracy: 77.059 at epoch 17 
 best_stats: {'best_valid_epoch': 17, 'best_valid_valid/acc': 82.011, 'best_valid_valid/acc_unbiased': 77.059, 'best_valid_valid/diff': 14.714, 'best_valid_valid/acc_skew': 84.416, 'best_valid_valid/acc_align': 69.702, 'best_valid_test/acc': 82.636, 'best_valid_test/acc_unbiased': 77.358, 'best_valid_test/diff': 14.641, 'best_valid_test/acc_skew': 84.679, 'best_valid_test/acc_align': 70.038}
[19 / 20] best test accuracy: 77.666 at epoch 12 
 best_stats: {'best_test_epoch': 12, 'best_test_valid/acc': 81.041, 'best_test_valid/acc_unbiased': 76.361, 'best_test_valid/diff': 14.343, 'best_test_valid/acc_skew': 83.532, 'best_test_valid/acc_align': 69.189, 'best_test_test/acc': 82.019, 'best_test_test/acc_unbiased': 77.666, 'best_test_test/diff': 12.34, 'best_test_test/acc_skew': 83.836, 'best_test_test/acc_align': 71.496}
[20 / 20] Learning rate: 1e-05 weight: 0.01
[20 / 20] Loss: 4.760465772431218 CE Loss: 0.47282126015061215 Con Loss: 4.75573754102886
[20 / 20] tensor([[0.876, 0.744],
        [0.820, 0.661]]) {'epoch': 20, 'valid/acc': 81.834, 'valid/acc_unbiased': 76.348, 'valid/diff': 16.156, 'valid/acc_skew': 84.426, 'valid/acc_align': 68.27, 'test/acc': 82.856, 'test/acc_unbiased': 77.515, 'test/diff': 14.537, 'test/acc_skew': 84.783, 'test/acc_align': 70.246}
[20 / 20] best valid accuracy: 77.059 at epoch 17 
 best_stats: {'best_valid_epoch': 17, 'best_valid_valid/acc': 82.011, 'best_valid_valid/acc_unbiased': 77.059, 'best_valid_valid/diff': 14.714, 'best_valid_valid/acc_skew': 84.416, 'best_valid_valid/acc_align': 69.702, 'best_valid_test/acc': 82.636, 'best_valid_test/acc_unbiased': 77.358, 'best_valid_test/diff': 14.641, 'best_valid_test/acc_skew': 84.679, 'best_valid_test/acc_align': 70.038}
[20 / 20] best test accuracy: 77.666 at epoch 12 
 best_stats: {'best_test_epoch': 12, 'best_test_valid/acc': 81.041, 'best_test_valid/acc_unbiased': 76.361, 'best_test_valid/diff': 14.343, 'best_test_valid/acc_skew': 83.532, 'best_test_valid/acc_align': 69.189, 'best_test_test/acc': 82.019, 'best_test_test/acc_unbiased': 77.666, 'best_test_test/diff': 12.34, 'best_test_test/acc_skew': 83.836, 'best_test_test/acc_align': 71.496}
Total training time: 0:11:28
