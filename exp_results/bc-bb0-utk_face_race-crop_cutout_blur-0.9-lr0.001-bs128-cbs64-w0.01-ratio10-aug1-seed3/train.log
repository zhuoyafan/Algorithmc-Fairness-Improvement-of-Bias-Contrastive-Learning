Log level set to: INFO
Set seed: 3
=======> Using Fixed Random Seed: 3 <========
save_path: exp_results/bc-bb0-utk_face_race-crop_cutout_blur-0.9-lr0.001-bs128-cbs64-w0.01-ratio10-aug1-seed3
get_utk_face - split: train, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_race-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [4407, 552]
Target 1: [440, 5529]
Binary Target 1
---------------------------
Target 0: [4407, 552]
Target 1: [440, 5529]
===================================
Normal Label Distribution: 
Target 0: [4407, 552]
Target 1: [440, 5529]
===================================
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [4407, 552]
Target 1: [440, 5529]
Binary Target 1
---------------------------
Target 0: [4407, 552]
Target 1: [440, 5529]
===================================
Normal Label Distribution: 
Target 0: [4407, 552]
Target 1: [440, 5529]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 10928, target_attr: gender, bias_attr: race bias_rate: 0.9
['[train] target_0-bias_0: 4407', '[train] target_0-bias_1: 552', '[train] target_1-bias_0: 440', '[train] target_1-bias_1: 5529']
confusion_matrix - 
 original: tensor([[4407.,  440.],
        [ 552., 5529.]]), 
 normalized: tensor([[0.909, 0.091],
        [0.091, 0.909]]), 
 b|y: tensor([[0.889, 0.111],
        [0.074, 0.926]])
get_utk_face - split: train, aug: 1, given_y: True, ratio: 10
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_race-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [4407, 552]
Target 1: [440, 5529]
Binary Target 1
---------------------------
Target 0: [4407, 552]
Target 1: [440, 5529]
===================================
Normal Label Distribution: 
Target 0: [4407, 552]
Target 1: [440, 5529]
===================================
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [4407, 552]
Target 1: [440, 5529]
Binary Target 1
---------------------------
Target 0: [4407, 552]
Target 1: [440, 5529]
===================================
Normal Label Distribution: 
Target 0: [4407, 552]
Target 1: [440, 5529]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 10928, target_attr: gender, bias_attr: race bias_rate: 0.9
['[train] target_0-bias_0: 4407', '[train] target_0-bias_1: 552', '[train] target_1-bias_0: 440', '[train] target_1-bias_1: 5529']
get_utk_face - split: valid, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_race-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [583, 684]
Target 1: [457, 646]
Binary Target 1
---------------------------
Target 0: [583, 684]
Target 1: [457, 646]
===================================
Normal Label Distribution: 
Target 0: [583, 684]
Target 1: [457, 646]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 2370, target_attr: gender, bias_attr: race bias_rate: 0.9
['[valid] target_0-bias_0: 583', '[valid] target_0-bias_1: 684', '[valid] target_1-bias_0: 457', '[valid] target_1-bias_1: 646']
get_utk_face - split: test, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_race-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [558, 677]
Target 1: [462, 673]
Binary Target 1
---------------------------
Target 0: [558, 677]
Target 1: [462, 673]
===================================
Normal Label Distribution: 
Target 0: [558, 677]
Target 1: [462, 673]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 2370, target_attr: gender, bias_attr: race bias_rate: 0.9
['[test] target_0-bias_0: 558', '[test] target_0-bias_1: 677', '[test] target_1-bias_0: 462', '[test] target_1-bias_1: 673']
decay_epochs: [6, 13]
[1 / 20] Learning rate: 0.001 weight: 0.01
[1 / 20] Loss: 4.903208641147194 CE Loss: 0.5955241770206747 Con Loss: 4.897253410707979
[1 / 20] tensor([[0.837, 0.773],
        [0.684, 0.725]]) {'epoch': 1, 'valid/acc': 75.19, 'valid/acc_unbiased': 74.565, 'valid/diff': 5.85, 'valid/acc_skew': 71.64, 'valid/acc_align': 77.49, 'test/acc': 75.696, 'test/acc_unbiased': 75.463, 'test/diff': 5.276, 'test/acc_skew': 72.825, 'test/acc_align': 78.101}
[1 / 20] best valid accuracy: 74.565 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 75.19, 'best_valid_valid/acc_unbiased': 74.565, 'best_valid_valid/diff': 5.85, 'best_valid_valid/acc_skew': 71.64, 'best_valid_valid/acc_align': 77.49, 'best_valid_test/acc': 75.696, 'best_valid_test/acc_unbiased': 75.463, 'best_valid_test/diff': 5.276, 'best_valid_test/acc_skew': 72.825, 'best_valid_test/acc_align': 78.101}
[1 / 20] best test accuracy: 75.463 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 75.19, 'best_test_valid/acc_unbiased': 74.565, 'best_test_valid/diff': 5.85, 'best_test_valid/acc_skew': 71.64, 'best_test_valid/acc_align': 77.49, 'best_test_test/acc': 75.696, 'best_test_test/acc_unbiased': 75.463, 'best_test_test/diff': 5.276, 'best_test_test/acc_skew': 72.825, 'best_test_test/acc_align': 78.101}
[2 / 20] Learning rate: 0.001 weight: 0.01
[2 / 20] Loss: 4.805247795529456 CE Loss: 0.4976859531674867 Con Loss: 4.80027090438463
[2 / 20] tensor([[0.799, 0.762],
        [0.801, 0.790]]) {'epoch': 2, 'valid/acc': 78.565, 'valid/acc_unbiased': 78.648, 'valid/diff': 3.297, 'valid/acc_skew': 79.08, 'valid/acc_align': 78.216, 'test/acc': 78.65, 'test/acc_unbiased': 78.821, 'test/diff': 2.374, 'test/acc_skew': 78.153, 'test/acc_align': 79.489}
[2 / 20] best valid accuracy: 78.648 at epoch 2 
 best_stats: {'best_valid_epoch': 2, 'best_valid_valid/acc': 78.565, 'best_valid_valid/acc_unbiased': 78.648, 'best_valid_valid/diff': 3.297, 'best_valid_valid/acc_skew': 79.08, 'best_valid_valid/acc_align': 78.216, 'best_valid_test/acc': 78.65, 'best_valid_test/acc_unbiased': 78.821, 'best_valid_test/diff': 2.374, 'best_valid_test/acc_skew': 78.153, 'best_valid_test/acc_align': 79.489}
[2 / 20] best test accuracy: 78.821 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 78.565, 'best_test_valid/acc_unbiased': 78.648, 'best_test_valid/diff': 3.297, 'best_test_valid/acc_skew': 79.08, 'best_test_valid/acc_align': 78.216, 'best_test_test/acc': 78.65, 'best_test_test/acc_unbiased': 78.821, 'best_test_test/diff': 2.374, 'best_test_test/acc_skew': 78.153, 'best_test_test/acc_align': 79.489}
[3 / 20] Learning rate: 0.001 weight: 0.01
[3 / 20] Loss: 4.78779043739397 CE Loss: 0.47286810545935287 Con Loss: 4.783061774548465
[3 / 20] tensor([[0.706, 0.656],
        [0.881, 0.903]]) {'epoch': 3, 'valid/acc': 78.312, 'valid/acc_unbiased': 78.945, 'valid/diff': 0.616, 'valid/acc_skew': 79.253, 'valid/acc_align': 78.636, 'test/acc': 78.186, 'test/acc_unbiased': 78.657, 'test/diff': 3.636, 'test/acc_skew': 76.839, 'test/acc_align': 80.476}
[3 / 20] best valid accuracy: 78.945 at epoch 3 
 best_stats: {'best_valid_epoch': 3, 'best_valid_valid/acc': 78.312, 'best_valid_valid/acc_unbiased': 78.945, 'best_valid_valid/diff': 0.616, 'best_valid_valid/acc_skew': 79.253, 'best_valid_valid/acc_align': 78.636, 'best_valid_test/acc': 78.186, 'best_valid_test/acc_unbiased': 78.657, 'best_valid_test/diff': 3.636, 'best_valid_test/acc_skew': 76.839, 'best_valid_test/acc_align': 80.476}
[3 / 20] best test accuracy: 78.821 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 78.565, 'best_test_valid/acc_unbiased': 78.648, 'best_test_valid/diff': 3.297, 'best_test_valid/acc_skew': 79.08, 'best_test_valid/acc_align': 78.216, 'best_test_test/acc': 78.65, 'best_test_test/acc_unbiased': 78.821, 'best_test_test/diff': 2.374, 'best_test_test/acc_skew': 78.153, 'best_test_test/acc_align': 79.489}
[4 / 20] Learning rate: 0.001 weight: 0.01
[4 / 20] Loss: 4.782552023757778 CE Loss: 0.45203702577211147 Con Loss: 4.778031644500017
[4 / 20] tensor([[0.778, 0.694],
        [0.794, 0.860]]) {'epoch': 4, 'valid/acc': 79.03, 'valid/acc_unbiased': 79.418, 'valid/diff': 3.098, 'valid/acc_skew': 77.869, 'valid/acc_align': 80.967, 'test/acc': 78.059, 'test/acc_unbiased': 78.168, 'test/diff': 7.475, 'test/acc_skew': 74.431, 'test/acc_align': 81.905}
[4 / 20] best valid accuracy: 79.418 at epoch 4 
 best_stats: {'best_valid_epoch': 4, 'best_valid_valid/acc': 79.03, 'best_valid_valid/acc_unbiased': 79.418, 'best_valid_valid/diff': 3.098, 'best_valid_valid/acc_skew': 77.869, 'best_valid_valid/acc_align': 80.967, 'best_valid_test/acc': 78.059, 'best_valid_test/acc_unbiased': 78.168, 'best_valid_test/diff': 7.475, 'best_valid_test/acc_skew': 74.431, 'best_valid_test/acc_align': 81.905}
[4 / 20] best test accuracy: 78.821 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 78.565, 'best_test_valid/acc_unbiased': 78.648, 'best_test_valid/diff': 3.297, 'best_test_valid/acc_skew': 79.08, 'best_test_valid/acc_align': 78.216, 'best_test_test/acc': 78.65, 'best_test_test/acc_unbiased': 78.821, 'best_test_test/diff': 2.374, 'best_test_test/acc_skew': 78.153, 'best_test_test/acc_align': 79.489}
[5 / 20] Learning rate: 0.001 weight: 0.01
[5 / 20] Loss: 4.766118390319288 CE Loss: 0.45111556667534536 Con Loss: 4.761607252486803
[5 / 20] tensor([[0.717, 0.682],
        [0.896, 0.912]]) {'epoch': 5, 'valid/acc': 79.198, 'valid/acc_unbiased': 80.112, 'valid/diff': 2.709, 'valid/acc_skew': 81.185, 'valid/acc_align': 79.04, 'test/acc': 79.747, 'test/acc_unbiased': 80.193, 'test/diff': 2.533, 'test/acc_skew': 78.926, 'test/acc_align': 81.459}
[5 / 20] best valid accuracy: 80.112 at epoch 5 
 best_stats: {'best_valid_epoch': 5, 'best_valid_valid/acc': 79.198, 'best_valid_valid/acc_unbiased': 80.112, 'best_valid_valid/diff': 2.709, 'best_valid_valid/acc_skew': 81.185, 'best_valid_valid/acc_align': 79.04, 'best_valid_test/acc': 79.747, 'best_valid_test/acc_unbiased': 80.193, 'best_valid_test/diff': 2.533, 'best_valid_test/acc_skew': 78.926, 'best_valid_test/acc_align': 81.459}
[5 / 20] best test accuracy: 80.193 at epoch 5 
 best_stats: {'best_test_epoch': 5, 'best_test_valid/acc': 79.198, 'best_test_valid/acc_unbiased': 80.112, 'best_test_valid/diff': 2.709, 'best_test_valid/acc_skew': 81.185, 'best_test_valid/acc_align': 79.04, 'best_test_test/acc': 79.747, 'best_test_test/acc_unbiased': 80.193, 'best_test_test/diff': 2.533, 'best_test_test/acc_skew': 78.926, 'best_test_test/acc_align': 81.459}
[6 / 20] Learning rate: 0.001 weight: 0.01
[6 / 20] Loss: 4.755109567069728 CE Loss: 0.4299167448744767 Con Loss: 4.750810414421785
[6 / 20] tensor([[0.726, 0.674],
        [0.905, 0.918]]) {'epoch': 6, 'valid/acc': 79.747, 'valid/acc_unbiased': 80.528, 'valid/diff': 0.736, 'valid/acc_skew': 80.382, 'valid/acc_align': 80.674, 'test/acc': 80.042, 'test/acc_unbiased': 80.56, 'test/diff': 3.288, 'test/acc_skew': 78.916, 'test/acc_align': 82.204}
[6 / 20] best valid accuracy: 80.528 at epoch 6 
 best_stats: {'best_valid_epoch': 6, 'best_valid_valid/acc': 79.747, 'best_valid_valid/acc_unbiased': 80.528, 'best_valid_valid/diff': 0.736, 'best_valid_valid/acc_skew': 80.382, 'best_valid_valid/acc_align': 80.674, 'best_valid_test/acc': 80.042, 'best_valid_test/acc_unbiased': 80.56, 'best_valid_test/diff': 3.288, 'best_valid_test/acc_skew': 78.916, 'best_valid_test/acc_align': 82.204}
[6 / 20] best test accuracy: 80.560 at epoch 6 
 best_stats: {'best_test_epoch': 6, 'best_test_valid/acc': 79.747, 'best_test_valid/acc_unbiased': 80.528, 'best_test_valid/diff': 0.736, 'best_test_valid/acc_skew': 80.382, 'best_test_valid/acc_align': 80.674, 'best_test_test/acc': 80.042, 'best_test_test/acc_unbiased': 80.56, 'best_test_test/diff': 3.288, 'best_test_test/acc_skew': 78.916, 'best_test_test/acc_align': 82.204}
[7 / 20] Learning rate: 0.0001 weight: 0.01
[7 / 20] Loss: 4.724546220257202 CE Loss: 0.391424061962312 Con Loss: 4.720631962464808
[7 / 20] tensor([[0.817, 0.764],
        [0.842, 0.881]]) {'epoch': 7, 'valid/acc': 82.574, 'valid/acc_unbiased': 82.926, 'valid/diff': 1.138, 'valid/acc_skew': 83.274, 'valid/acc_align': 82.579, 'test/acc': 82.489, 'test/acc_unbiased': 82.6, 'test/diff': 4.634, 'test/acc_skew': 80.283, 'test/acc_align': 84.917}
[7 / 20] best valid accuracy: 82.926 at epoch 7 
 best_stats: {'best_valid_epoch': 7, 'best_valid_valid/acc': 82.574, 'best_valid_valid/acc_unbiased': 82.926, 'best_valid_valid/diff': 1.138, 'best_valid_valid/acc_skew': 83.274, 'best_valid_valid/acc_align': 82.579, 'best_valid_test/acc': 82.489, 'best_valid_test/acc_unbiased': 82.6, 'best_valid_test/diff': 4.634, 'best_valid_test/acc_skew': 80.283, 'best_valid_test/acc_align': 84.917}
[7 / 20] best test accuracy: 82.600 at epoch 7 
 best_stats: {'best_test_epoch': 7, 'best_test_valid/acc': 82.574, 'best_test_valid/acc_unbiased': 82.926, 'best_test_valid/diff': 1.138, 'best_test_valid/acc_skew': 83.274, 'best_test_valid/acc_align': 82.579, 'best_test_test/acc': 82.489, 'best_test_test/acc_unbiased': 82.6, 'best_test_test/diff': 4.634, 'best_test_test/acc_skew': 80.283, 'best_test_test/acc_align': 84.917}
[8 / 20] Learning rate: 0.0001 weight: 0.01
[8 / 20] Loss: 4.694507933989451 CE Loss: 0.37830445519478045 Con Loss: 4.690724865758401
[8 / 20] tensor([[0.817, 0.746],
        [0.853, 0.905]]) {'epoch': 8, 'valid/acc': 82.996, 'valid/acc_unbiased': 83.296, 'valid/diff': 0.701, 'valid/acc_skew': 82.945, 'valid/acc_align': 83.646, 'test/acc': 82.869, 'test/acc_unbiased': 83.021, 'test/diff': 6.168, 'test/acc_skew': 79.938, 'test/acc_align': 86.105}
[8 / 20] best valid accuracy: 83.296 at epoch 8 
 best_stats: {'best_valid_epoch': 8, 'best_valid_valid/acc': 82.996, 'best_valid_valid/acc_unbiased': 83.296, 'best_valid_valid/diff': 0.701, 'best_valid_valid/acc_skew': 82.945, 'best_valid_valid/acc_align': 83.646, 'best_valid_test/acc': 82.869, 'best_valid_test/acc_unbiased': 83.021, 'best_valid_test/diff': 6.168, 'best_valid_test/acc_skew': 79.938, 'best_valid_test/acc_align': 86.105}
[8 / 20] best test accuracy: 83.021 at epoch 8 
 best_stats: {'best_test_epoch': 8, 'best_test_valid/acc': 82.996, 'best_test_valid/acc_unbiased': 83.296, 'best_test_valid/diff': 0.701, 'best_test_valid/acc_skew': 82.945, 'best_test_valid/acc_align': 83.646, 'best_test_test/acc': 82.869, 'best_test_test/acc_unbiased': 83.021, 'best_test_test/diff': 6.168, 'best_test_test/acc_skew': 79.938, 'best_test_test/acc_align': 86.105}
[9 / 20] Learning rate: 0.0001 weight: 0.01
[9 / 20] Loss: 4.68353912456842 CE Loss: 0.360832030741746 Con Loss: 4.679930814712323
[9 / 20] tensor([[0.794, 0.718],
        [0.864, 0.917]]) {'epoch': 9, 'valid/acc': 82.743, 'valid/acc_unbiased': 83.259, 'valid/diff': 1.072, 'valid/acc_skew': 82.723, 'valid/acc_align': 83.795, 'test/acc': 82.068, 'test/acc_unbiased': 82.305, 'test/diff': 6.459, 'test/acc_skew': 79.075, 'test/acc_align': 85.535}
[9 / 20] best valid accuracy: 83.296 at epoch 8 
 best_stats: {'best_valid_epoch': 8, 'best_valid_valid/acc': 82.996, 'best_valid_valid/acc_unbiased': 83.296, 'best_valid_valid/diff': 0.701, 'best_valid_valid/acc_skew': 82.945, 'best_valid_valid/acc_align': 83.646, 'best_valid_test/acc': 82.869, 'best_valid_test/acc_unbiased': 83.021, 'best_valid_test/diff': 6.168, 'best_valid_test/acc_skew': 79.938, 'best_valid_test/acc_align': 86.105}
[9 / 20] best test accuracy: 83.021 at epoch 8 
 best_stats: {'best_test_epoch': 8, 'best_test_valid/acc': 82.996, 'best_test_valid/acc_unbiased': 83.296, 'best_test_valid/diff': 0.701, 'best_test_valid/acc_skew': 82.945, 'best_test_valid/acc_align': 83.646, 'best_test_test/acc': 82.869, 'best_test_test/acc_unbiased': 83.021, 'best_test_test/diff': 6.168, 'best_test_test/acc_skew': 79.938, 'best_test_test/acc_align': 86.105}
[10 / 20] Learning rate: 0.0001 weight: 0.01
[10 / 20] Loss: 4.67534123821454 CE Loss: 0.3612293323957379 Con Loss: 4.6717289454067785
[10 / 20] tensor([[0.808, 0.767],
        [0.870, 0.900]]) {'epoch': 10, 'valid/acc': 83.249, 'valid/acc_unbiased': 83.608, 'valid/diff': 0.946, 'valid/acc_skew': 83.529, 'valid/acc_align': 83.688, 'test/acc': 83.46, 'test/acc_unbiased': 83.636, 'test/diff': 3.597, 'test/acc_skew': 81.837, 'test/acc_align': 85.434}
[10 / 20] best valid accuracy: 83.608 at epoch 10 
 best_stats: {'best_valid_epoch': 10, 'best_valid_valid/acc': 83.249, 'best_valid_valid/acc_unbiased': 83.608, 'best_valid_valid/diff': 0.946, 'best_valid_valid/acc_skew': 83.529, 'best_valid_valid/acc_align': 83.688, 'best_valid_test/acc': 83.46, 'best_valid_test/acc_unbiased': 83.636, 'best_valid_test/diff': 3.597, 'best_valid_test/acc_skew': 81.837, 'best_valid_test/acc_align': 85.434}
[10 / 20] best test accuracy: 83.636 at epoch 10 
 best_stats: {'best_test_epoch': 10, 'best_test_valid/acc': 83.249, 'best_test_valid/acc_unbiased': 83.608, 'best_test_valid/diff': 0.946, 'best_test_valid/acc_skew': 83.529, 'best_test_valid/acc_align': 83.688, 'best_test_test/acc': 83.46, 'best_test_test/acc_unbiased': 83.636, 'best_test_test/diff': 3.597, 'best_test_test/acc_skew': 81.837, 'best_test_test/acc_align': 85.434}
[11 / 20] Learning rate: 0.0001 weight: 0.01
[11 / 20] Loss: 4.666153780014239 CE Loss: 0.3588699692775704 Con Loss: 4.66256508820228
[11 / 20] tensor([[0.787, 0.710],
        [0.887, 0.930]]) {'epoch': 11, 'valid/acc': 82.954, 'valid/acc_unbiased': 83.452, 'valid/diff': 0.187, 'valid/acc_skew': 83.453, 'valid/acc_align': 83.452, 'test/acc': 82.532, 'test/acc_unbiased': 82.871, 'test/diff': 5.948, 'test/acc_skew': 79.897, 'test/acc_align': 85.845}
[11 / 20] best valid accuracy: 83.608 at epoch 10 
 best_stats: {'best_valid_epoch': 10, 'best_valid_valid/acc': 83.249, 'best_valid_valid/acc_unbiased': 83.608, 'best_valid_valid/diff': 0.946, 'best_valid_valid/acc_skew': 83.529, 'best_valid_valid/acc_align': 83.688, 'best_valid_test/acc': 83.46, 'best_valid_test/acc_unbiased': 83.636, 'best_valid_test/diff': 3.597, 'best_valid_test/acc_skew': 81.837, 'best_valid_test/acc_align': 85.434}
[11 / 20] best test accuracy: 83.636 at epoch 10 
 best_stats: {'best_test_epoch': 10, 'best_test_valid/acc': 83.249, 'best_test_valid/acc_unbiased': 83.608, 'best_test_valid/diff': 0.946, 'best_test_valid/acc_skew': 83.529, 'best_test_valid/acc_align': 83.688, 'best_test_test/acc': 83.46, 'best_test_test/acc_unbiased': 83.636, 'best_test_test/diff': 3.597, 'best_test_test/acc_skew': 81.837, 'best_test_test/acc_align': 85.434}
[12 / 20] Learning rate: 0.0001 weight: 0.01
[12 / 20] Loss: 4.66716977199035 CE Loss: 0.3561150654604983 Con Loss: 4.663608610368229
[12 / 20] tensor([[0.842, 0.761],
        [0.848, 0.897]]) {'epoch': 12, 'valid/acc': 84.473, 'valid/acc_unbiased': 84.778, 'valid/diff': 1.522, 'valid/acc_skew': 84.333, 'valid/acc_align': 85.223, 'test/acc': 83.587, 'test/acc_unbiased': 83.724, 'test/diff': 6.529, 'test/acc_skew': 80.46, 'test/acc_align': 86.988}
[12 / 20] best valid accuracy: 84.778 at epoch 12 
 best_stats: {'best_valid_epoch': 12, 'best_valid_valid/acc': 84.473, 'best_valid_valid/acc_unbiased': 84.778, 'best_valid_valid/diff': 1.522, 'best_valid_valid/acc_skew': 84.333, 'best_valid_valid/acc_align': 85.223, 'best_valid_test/acc': 83.587, 'best_valid_test/acc_unbiased': 83.724, 'best_valid_test/diff': 6.529, 'best_valid_test/acc_skew': 80.46, 'best_valid_test/acc_align': 86.988}
[12 / 20] best test accuracy: 83.724 at epoch 12 
 best_stats: {'best_test_epoch': 12, 'best_test_valid/acc': 84.473, 'best_test_valid/acc_unbiased': 84.778, 'best_test_valid/diff': 1.522, 'best_test_valid/acc_skew': 84.333, 'best_test_valid/acc_align': 85.223, 'best_test_test/acc': 83.587, 'best_test_test/acc_unbiased': 83.724, 'best_test_test/diff': 6.529, 'best_test_test/acc_skew': 80.46, 'best_test_test/acc_align': 86.988}
[13 / 20] Learning rate: 0.0001 weight: 0.01
[13 / 20] Loss: 4.638792764040946 CE Loss: 0.3390860141719941 Con Loss: 4.635401897514198
[13 / 20] tensor([[0.853, 0.787],
        [0.842, 0.874]]) {'epoch': 13, 'valid/acc': 84.81, 'valid/acc_unbiased': 84.943, 'valid/diff': 1.233, 'valid/acc_skew': 84.555, 'valid/acc_align': 85.332, 'test/acc': 83.797, 'test/acc_unbiased': 83.901, 'test/diff': 4.873, 'test/acc_skew': 81.464, 'test/acc_align': 86.337}
[13 / 20] best valid accuracy: 84.943 at epoch 13 
 best_stats: {'best_valid_epoch': 13, 'best_valid_valid/acc': 84.81, 'best_valid_valid/acc_unbiased': 84.943, 'best_valid_valid/diff': 1.233, 'best_valid_valid/acc_skew': 84.555, 'best_valid_valid/acc_align': 85.332, 'best_valid_test/acc': 83.797, 'best_valid_test/acc_unbiased': 83.901, 'best_valid_test/diff': 4.873, 'best_valid_test/acc_skew': 81.464, 'best_valid_test/acc_align': 86.337}
[13 / 20] best test accuracy: 83.901 at epoch 13 
 best_stats: {'best_test_epoch': 13, 'best_test_valid/acc': 84.81, 'best_test_valid/acc_unbiased': 84.943, 'best_test_valid/diff': 1.233, 'best_test_valid/acc_skew': 84.555, 'best_test_valid/acc_align': 85.332, 'best_test_test/acc': 83.797, 'best_test_test/acc_unbiased': 83.901, 'best_test_test/diff': 4.873, 'best_test_test/acc_skew': 81.464, 'best_test_test/acc_align': 86.337}
[14 / 20] Learning rate: 1e-05 weight: 0.01
[14 / 20] Loss: 4.6277496643680776 CE Loss: 0.3414711592661689 Con Loss: 4.624334980418706
[14 / 20] tensor([[0.823, 0.756],
        [0.859, 0.893]]) {'epoch': 14, 'valid/acc': 83.84, 'valid/acc_unbiased': 84.199, 'valid/diff': 1.232, 'valid/acc_skew': 84.04, 'valid/acc_align': 84.357, 'test/acc': 83.08, 'test/acc_unbiased': 83.28, 'test/diff': 5.001, 'test/acc_skew': 80.779, 'test/acc_align': 85.78}
[14 / 20] best valid accuracy: 84.943 at epoch 13 
 best_stats: {'best_valid_epoch': 13, 'best_valid_valid/acc': 84.81, 'best_valid_valid/acc_unbiased': 84.943, 'best_valid_valid/diff': 1.233, 'best_valid_valid/acc_skew': 84.555, 'best_valid_valid/acc_align': 85.332, 'best_valid_test/acc': 83.797, 'best_valid_test/acc_unbiased': 83.901, 'best_valid_test/diff': 4.873, 'best_valid_test/acc_skew': 81.464, 'best_valid_test/acc_align': 86.337}
[14 / 20] best test accuracy: 83.901 at epoch 13 
 best_stats: {'best_test_epoch': 13, 'best_test_valid/acc': 84.81, 'best_test_valid/acc_unbiased': 84.943, 'best_test_valid/diff': 1.233, 'best_test_valid/acc_skew': 84.555, 'best_test_valid/acc_align': 85.332, 'best_test_test/acc': 83.797, 'best_test_test/acc_unbiased': 83.901, 'best_test_test/diff': 4.873, 'best_test_test/acc_skew': 81.464, 'best_test_test/acc_align': 86.337}
[15 / 20] Learning rate: 1e-05 weight: 0.01
[15 / 20] Loss: 4.635236316334625 CE Loss: 0.34139079915831416 Con Loss: 4.631822428277436
[15 / 20] tensor([[0.832, 0.762],
        [0.853, 0.886]]) {'epoch': 15, 'valid/acc': 84.093, 'valid/acc_unbiased': 84.379, 'valid/diff': 1.025, 'valid/acc_skew': 84.041, 'valid/acc_align': 84.717, 'test/acc': 83.122, 'test/acc_unbiased': 83.303, 'test/diff': 5.106, 'test/acc_skew': 80.75, 'test/acc_align': 85.856}
[15 / 20] best valid accuracy: 84.943 at epoch 13 
 best_stats: {'best_valid_epoch': 13, 'best_valid_valid/acc': 84.81, 'best_valid_valid/acc_unbiased': 84.943, 'best_valid_valid/diff': 1.233, 'best_valid_valid/acc_skew': 84.555, 'best_valid_valid/acc_align': 85.332, 'best_valid_test/acc': 83.797, 'best_valid_test/acc_unbiased': 83.901, 'best_valid_test/diff': 4.873, 'best_valid_test/acc_skew': 81.464, 'best_valid_test/acc_align': 86.337}
[15 / 20] best test accuracy: 83.901 at epoch 13 
 best_stats: {'best_test_epoch': 13, 'best_test_valid/acc': 84.81, 'best_test_valid/acc_unbiased': 84.943, 'best_test_valid/diff': 1.233, 'best_test_valid/acc_skew': 84.555, 'best_test_valid/acc_align': 85.332, 'best_test_test/acc': 83.797, 'best_test_test/acc_unbiased': 83.901, 'best_test_test/diff': 4.873, 'best_test_test/acc_skew': 81.464, 'best_test_test/acc_align': 86.337}
[16 / 20] Learning rate: 1e-05 weight: 0.01
[16 / 20] Loss: 4.629268940161821 CE Loss: 0.3380911341523356 Con Loss: 4.625888036948521
[16 / 20] tensor([[0.814, 0.739],
        [0.864, 0.902]]) {'epoch': 16, 'valid/acc': 83.966, 'valid/acc_unbiased': 84.338, 'valid/diff': 1.692, 'valid/acc_skew': 83.492, 'valid/acc_align': 85.184, 'test/acc': 82.7, 'test/acc_unbiased': 82.944, 'test/diff': 5.668, 'test/acc_skew': 80.109, 'test/acc_align': 85.778}
[16 / 20] best valid accuracy: 84.943 at epoch 13 
 best_stats: {'best_valid_epoch': 13, 'best_valid_valid/acc': 84.81, 'best_valid_valid/acc_unbiased': 84.943, 'best_valid_valid/diff': 1.233, 'best_valid_valid/acc_skew': 84.555, 'best_valid_valid/acc_align': 85.332, 'best_valid_test/acc': 83.797, 'best_valid_test/acc_unbiased': 83.901, 'best_valid_test/diff': 4.873, 'best_valid_test/acc_skew': 81.464, 'best_valid_test/acc_align': 86.337}
[16 / 20] best test accuracy: 83.901 at epoch 13 
 best_stats: {'best_test_epoch': 13, 'best_test_valid/acc': 84.81, 'best_test_valid/acc_unbiased': 84.943, 'best_test_valid/diff': 1.233, 'best_test_valid/acc_skew': 84.555, 'best_test_valid/acc_align': 85.332, 'best_test_test/acc': 83.797, 'best_test_test/acc_unbiased': 83.901, 'best_test_test/diff': 4.873, 'best_test_test/acc_skew': 81.464, 'best_test_test/acc_align': 86.337}
[17 / 20] Learning rate: 1e-05 weight: 0.01
[17 / 20] Loss: 4.635694099554729 CE Loss: 0.33118015950979285 Con Loss: 4.632382316086686
[17 / 20] tensor([[0.823, 0.744],
        [0.866, 0.903]]) {'epoch': 17, 'valid/acc': 83.882, 'valid/acc_unbiased': 84.273, 'valid/diff': 1.562, 'valid/acc_skew': 83.492, 'valid/acc_align': 85.054, 'test/acc': 83.165, 'test/acc_unbiased': 83.406, 'test/diff': 5.787, 'test/acc_skew': 80.513, 'test/acc_align': 86.3}
[17 / 20] best valid accuracy: 84.943 at epoch 13 
 best_stats: {'best_valid_epoch': 13, 'best_valid_valid/acc': 84.81, 'best_valid_valid/acc_unbiased': 84.943, 'best_valid_valid/diff': 1.233, 'best_valid_valid/acc_skew': 84.555, 'best_valid_valid/acc_align': 85.332, 'best_valid_test/acc': 83.797, 'best_valid_test/acc_unbiased': 83.901, 'best_valid_test/diff': 4.873, 'best_valid_test/acc_skew': 81.464, 'best_valid_test/acc_align': 86.337}
[17 / 20] best test accuracy: 83.901 at epoch 13 
 best_stats: {'best_test_epoch': 13, 'best_test_valid/acc': 84.81, 'best_test_valid/acc_unbiased': 84.943, 'best_test_valid/diff': 1.233, 'best_test_valid/acc_skew': 84.555, 'best_test_valid/acc_align': 85.332, 'best_test_test/acc': 83.797, 'best_test_test/acc_unbiased': 83.901, 'best_test_test/diff': 4.873, 'best_test_test/acc_skew': 81.464, 'best_test_test/acc_align': 86.337}
[18 / 20] Learning rate: 1e-05 weight: 0.01
[18 / 20] Loss: 4.635122658043969 CE Loss: 0.33647720072838433 Con Loss: 4.631757888402981
[18 / 20] tensor([[0.830, 0.750],
        [0.855, 0.895]]) {'epoch': 18, 'valid/acc': 83.924, 'valid/acc_unbiased': 84.294, 'valid/diff': 1.68, 'valid/acc_skew': 83.492, 'valid/acc_align': 85.096, 'test/acc': 83.038, 'test/acc_unbiased': 83.24, 'test/diff': 5.945, 'test/acc_skew': 80.267, 'test/acc_align': 86.213}
[18 / 20] best valid accuracy: 84.943 at epoch 13 
 best_stats: {'best_valid_epoch': 13, 'best_valid_valid/acc': 84.81, 'best_valid_valid/acc_unbiased': 84.943, 'best_valid_valid/diff': 1.233, 'best_valid_valid/acc_skew': 84.555, 'best_valid_valid/acc_align': 85.332, 'best_valid_test/acc': 83.797, 'best_valid_test/acc_unbiased': 83.901, 'best_valid_test/diff': 4.873, 'best_valid_test/acc_skew': 81.464, 'best_valid_test/acc_align': 86.337}
[18 / 20] best test accuracy: 83.901 at epoch 13 
 best_stats: {'best_test_epoch': 13, 'best_test_valid/acc': 84.81, 'best_test_valid/acc_unbiased': 84.943, 'best_test_valid/diff': 1.233, 'best_test_valid/acc_skew': 84.555, 'best_test_valid/acc_align': 85.332, 'best_test_test/acc': 83.797, 'best_test_test/acc_unbiased': 83.901, 'best_test_test/diff': 4.873, 'best_test_test/acc_skew': 81.464, 'best_test_test/acc_align': 86.337}
[19 / 20] Learning rate: 1e-05 weight: 0.01
[19 / 20] Loss: 4.636814668272809 CE Loss: 0.3310389595534407 Con Loss: 4.6335042664456685
[19 / 20] tensor([[0.823, 0.752],
        [0.857, 0.893]]) {'epoch': 19, 'valid/acc': 84.093, 'valid/acc_unbiased': 84.438, 'valid/diff': 1.392, 'valid/acc_skew': 83.858, 'valid/acc_align': 85.018, 'test/acc': 82.911, 'test/acc_unbiased': 83.115, 'test/diff': 5.33, 'test/acc_skew': 80.449, 'test/acc_align': 85.78}
[19 / 20] best valid accuracy: 84.943 at epoch 13 
 best_stats: {'best_valid_epoch': 13, 'best_valid_valid/acc': 84.81, 'best_valid_valid/acc_unbiased': 84.943, 'best_valid_valid/diff': 1.233, 'best_valid_valid/acc_skew': 84.555, 'best_valid_valid/acc_align': 85.332, 'best_valid_test/acc': 83.797, 'best_valid_test/acc_unbiased': 83.901, 'best_valid_test/diff': 4.873, 'best_valid_test/acc_skew': 81.464, 'best_valid_test/acc_align': 86.337}
[19 / 20] best test accuracy: 83.901 at epoch 13 
 best_stats: {'best_test_epoch': 13, 'best_test_valid/acc': 84.81, 'best_test_valid/acc_unbiased': 84.943, 'best_test_valid/diff': 1.233, 'best_test_valid/acc_skew': 84.555, 'best_test_valid/acc_align': 85.332, 'best_test_test/acc': 83.797, 'best_test_test/acc_unbiased': 83.901, 'best_test_test/diff': 4.873, 'best_test_test/acc_skew': 81.464, 'best_test_test/acc_align': 86.337}
[20 / 20] Learning rate: 1e-05 weight: 0.01
[20 / 20] Loss: 4.6241151501109625 CE Loss: 0.3238019059858071 Con Loss: 4.620877116525854
[20 / 20] tensor([[0.826, 0.756],
        [0.848, 0.893]]) {'epoch': 20, 'valid/acc': 84.219, 'valid/acc_unbiased': 84.544, 'valid/diff': 1.226, 'valid/acc_skew': 83.931, 'valid/acc_align': 85.156, 'test/acc': 82.954, 'test/acc_unbiased': 83.099, 'test/diff': 5.721, 'test/acc_skew': 80.238, 'test/acc_align': 85.959}
[20 / 20] best valid accuracy: 84.943 at epoch 13 
 best_stats: {'best_valid_epoch': 13, 'best_valid_valid/acc': 84.81, 'best_valid_valid/acc_unbiased': 84.943, 'best_valid_valid/diff': 1.233, 'best_valid_valid/acc_skew': 84.555, 'best_valid_valid/acc_align': 85.332, 'best_valid_test/acc': 83.797, 'best_valid_test/acc_unbiased': 83.901, 'best_valid_test/diff': 4.873, 'best_valid_test/acc_skew': 81.464, 'best_valid_test/acc_align': 86.337}
[20 / 20] best test accuracy: 83.901 at epoch 13 
 best_stats: {'best_test_epoch': 13, 'best_test_valid/acc': 84.81, 'best_test_valid/acc_unbiased': 84.943, 'best_test_valid/diff': 1.233, 'best_test_valid/acc_skew': 84.555, 'best_test_valid/acc_align': 85.332, 'best_test_test/acc': 83.797, 'best_test_test/acc_unbiased': 83.901, 'best_test_test/diff': 4.873, 'best_test_test/acc_skew': 81.464, 'best_test_test/acc_align': 86.337}
Total training time: 0:17:32
