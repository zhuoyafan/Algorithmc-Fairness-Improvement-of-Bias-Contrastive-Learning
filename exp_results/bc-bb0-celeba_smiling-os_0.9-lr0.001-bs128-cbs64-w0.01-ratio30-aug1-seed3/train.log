Log level set to: INFO
Set seed: 3
=======> Using Fixed Random Seed: 3 <========
save_path: exp_results/bc-bb0-celeba_smiling-os_0.9-lr0.001-bs128-cbs64-w0.01-ratio30-aug1-seed3
get_celeba - split:train, aug: False, given_y: True, ratio: 0
use existing smiling indices from data/celeba/pickles/smiling
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [36558, 36558]
Target 1: [36558, 36558]
Binary Target 1
---------------------------
Target 0: [36558, 36558]
Target 1: [36558, 36558]
===================================
Normal Label Distribution: 
Target 0: [36558, 36558]
Target 1: [36558, 36558]
===================================
Use BiasedCelebASplit 
 target_attr: smiling split: train 
 tensor([[36558., 36558.],
        [36558., 36558.]])
get_celeba - split:train, aug: 1, given_y: True, ratio: 30
use existing smiling indices from data/celeba/pickles/smiling
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [36721, 36721]
Target 1: [36721, 36721]
Binary Target 1
---------------------------
Target 0: [36721, 36721]
Target 1: [36721, 36721]
===================================
Normal Label Distribution: 
Target 0: [36721, 36721]
Target 1: [36721, 36721]
===================================
Use BiasedCelebASplit 
 target_attr: smiling split: train 
 tensor([[36721., 36721.],
        [36721., 36721.]])
get_celeba - split:train_valid, aug: False, given_y: True, ratio: 0
use existing smiling indices from data/celeba/pickles/smiling
Use BiasedCelebASplit 
 target_attr: smiling split: train_valid 
 tensor([[ 1944., 10217.],
        [ 8222.,  1982.]])
get_celeba - split:valid, aug: False, given_y: True, ratio: 0
Use BiasedCelebASplit 
 target_attr: smiling split: valid 
 tensor([[5252., 6157.],
        [5013., 3445.]])
decay_epochs: [3, 6]
[1 / 10] Learning rate: 0.001 weight: 0.01
[1 / 10] Loss: 4.635575216913049 CE Loss: 0.24782806975170182 Con Loss: 4.633096931577935
[1 / 10] tensor([[0.929, 0.910],
        [0.918, 0.911]]) {'epoch': 1, 'valid/acc': 91.236, 'valid/acc_unbiased': 91.683, 'valid/diff': 1.86, 'valid/acc_skew': 92.613, 'valid/acc_align': 90.753, 'test/acc': 91.775, 'test/acc_unbiased': 91.703, 'test/diff': 1.342, 'test/acc_skew': 92.374, 'test/acc_align': 91.031}
[1 / 10] best valid accuracy: 91.683 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 91.236, 'best_valid_valid/acc_unbiased': 91.683, 'best_valid_valid/diff': 1.86, 'best_valid_valid/acc_skew': 92.613, 'best_valid_valid/acc_align': 90.753, 'best_valid_test/acc': 91.775, 'best_valid_test/acc_unbiased': 91.703, 'best_valid_test/diff': 1.342, 'best_valid_test/acc_skew': 92.374, 'best_valid_test/acc_align': 91.031}
[1 / 10] best test accuracy: 91.703 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 91.236, 'best_test_valid/acc_unbiased': 91.683, 'best_test_valid/diff': 1.86, 'best_test_valid/acc_skew': 92.613, 'best_test_valid/acc_align': 90.753, 'best_test_test/acc': 91.775, 'best_test_test/acc_unbiased': 91.703, 'best_test_test/diff': 1.342, 'best_test_test/acc_skew': 92.374, 'best_test_test/acc_align': 91.031}
[2 / 10] Learning rate: 0.001 weight: 0.01
[2 / 10] Loss: 4.599267766397287 CE Loss: 0.22603013559868562 Con Loss: 4.597007468816416
[2 / 10] tensor([[0.921, 0.890],
        [0.927, 0.927]]) {'epoch': 2, 'valid/acc': 91.205, 'valid/acc_unbiased': 91.662, 'valid/diff': 1.848, 'valid/acc_skew': 92.362, 'valid/acc_align': 90.962, 'test/acc': 91.599, 'test/acc_unbiased': 91.618, 'test/diff': 1.539, 'test/acc_skew': 92.384, 'test/acc_align': 90.851}
[2 / 10] best valid accuracy: 91.683 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 91.236, 'best_valid_valid/acc_unbiased': 91.683, 'best_valid_valid/diff': 1.86, 'best_valid_valid/acc_skew': 92.613, 'best_valid_valid/acc_align': 90.753, 'best_valid_test/acc': 91.775, 'best_valid_test/acc_unbiased': 91.703, 'best_valid_test/diff': 1.342, 'best_valid_test/acc_skew': 92.374, 'best_valid_test/acc_align': 91.031}
[2 / 10] best test accuracy: 91.703 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 91.236, 'best_test_valid/acc_unbiased': 91.683, 'best_test_valid/diff': 1.86, 'best_test_valid/acc_skew': 92.613, 'best_test_valid/acc_align': 90.753, 'best_test_test/acc': 91.775, 'best_test_test/acc_unbiased': 91.703, 'best_test_test/diff': 1.342, 'best_test_test/acc_skew': 92.374, 'best_test_test/acc_align': 91.031}
[3 / 10] Learning rate: 0.001 weight: 0.01
[3 / 10] Loss: 4.588752355335043 CE Loss: 0.21987952197890645 Con Loss: 4.586553559547715
[3 / 10] tensor([[0.943, 0.901],
        [0.902, 0.916]]) {'epoch': 3, 'valid/acc': 90.557, 'valid/acc_unbiased': 91.74, 'valid/diff': 3.615, 'valid/acc_skew': 92.585, 'valid/acc_align': 90.895, 'test/acc': 91.493, 'test/acc_unbiased': 91.545, 'test/diff': 2.827, 'test/acc_skew': 92.232, 'test/acc_align': 90.858}
[3 / 10] best valid accuracy: 91.740 at epoch 3 
 best_stats: {'best_valid_epoch': 3, 'best_valid_valid/acc': 90.557, 'best_valid_valid/acc_unbiased': 91.74, 'best_valid_valid/diff': 3.615, 'best_valid_valid/acc_skew': 92.585, 'best_valid_valid/acc_align': 90.895, 'best_valid_test/acc': 91.493, 'best_valid_test/acc_unbiased': 91.545, 'best_valid_test/diff': 2.827, 'best_valid_test/acc_skew': 92.232, 'best_valid_test/acc_align': 90.858}
[3 / 10] best test accuracy: 91.703 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 91.236, 'best_test_valid/acc_unbiased': 91.683, 'best_test_valid/diff': 1.86, 'best_test_valid/acc_skew': 92.613, 'best_test_valid/acc_align': 90.753, 'best_test_test/acc': 91.775, 'best_test_test/acc_unbiased': 91.703, 'best_test_test/diff': 1.342, 'best_test_test/acc_skew': 92.374, 'best_test_test/acc_align': 91.031}
[4 / 10] Learning rate: 0.0001 weight: 0.01
[4 / 10] Loss: 4.546620572485256 CE Loss: 0.19209241930733065 Con Loss: 4.544699645354155
[4 / 10] tensor([[0.951, 0.929],
        [0.917, 0.907]]) {'epoch': 4, 'valid/acc': 92.216, 'valid/acc_unbiased': 92.52, 'valid/diff': 1.374, 'valid/acc_skew': 93.207, 'valid/acc_align': 91.833, 'test/acc': 92.747, 'test/acc_unbiased': 92.617, 'test/diff': 1.625, 'test/acc_skew': 93.429, 'test/acc_align': 91.805}
[4 / 10] best valid accuracy: 92.520 at epoch 4 
 best_stats: {'best_valid_epoch': 4, 'best_valid_valid/acc': 92.216, 'best_valid_valid/acc_unbiased': 92.52, 'best_valid_valid/diff': 1.374, 'best_valid_valid/acc_skew': 93.207, 'best_valid_valid/acc_align': 91.833, 'best_valid_test/acc': 92.747, 'best_valid_test/acc_unbiased': 92.617, 'best_valid_test/diff': 1.625, 'best_valid_test/acc_skew': 93.429, 'best_valid_test/acc_align': 91.805}
[4 / 10] best test accuracy: 92.617 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 92.216, 'best_test_valid/acc_unbiased': 92.52, 'best_test_valid/diff': 1.374, 'best_test_valid/acc_skew': 93.207, 'best_test_valid/acc_align': 91.833, 'best_test_test/acc': 92.747, 'best_test_test/acc_unbiased': 92.617, 'best_test_test/diff': 1.625, 'best_test_test/acc_skew': 93.429, 'best_test_test/acc_align': 91.805}
[5 / 10] Learning rate: 0.0001 weight: 0.01
[5 / 10] Loss: 4.536754616032454 CE Loss: 0.18641669688486182 Con Loss: 4.534890448775136
[5 / 10] tensor([[0.958, 0.940],
        [0.910, 0.900]]) {'epoch': 5, 'valid/acc': 92.26, 'valid/acc_unbiased': 92.615, 'valid/diff': 1.267, 'valid/acc_skew': 93.249, 'valid/acc_align': 91.982, 'test/acc': 92.868, 'test/acc_unbiased': 92.716, 'test/diff': 1.394, 'test/acc_skew': 93.413, 'test/acc_align': 92.02}
[5 / 10] best valid accuracy: 92.615 at epoch 5 
 best_stats: {'best_valid_epoch': 5, 'best_valid_valid/acc': 92.26, 'best_valid_valid/acc_unbiased': 92.615, 'best_valid_valid/diff': 1.267, 'best_valid_valid/acc_skew': 93.249, 'best_valid_valid/acc_align': 91.982, 'best_valid_test/acc': 92.868, 'best_valid_test/acc_unbiased': 92.716, 'best_valid_test/diff': 1.394, 'best_valid_test/acc_skew': 93.413, 'best_valid_test/acc_align': 92.02}
[5 / 10] best test accuracy: 92.716 at epoch 5 
 best_stats: {'best_test_epoch': 5, 'best_test_valid/acc': 92.26, 'best_test_valid/acc_unbiased': 92.615, 'best_test_valid/diff': 1.267, 'best_test_valid/acc_skew': 93.249, 'best_test_valid/acc_align': 91.982, 'best_test_test/acc': 92.868, 'best_test_test/acc_unbiased': 92.716, 'best_test_test/diff': 1.394, 'best_test_test/acc_skew': 93.413, 'best_test_test/acc_align': 92.02}
[6 / 10] Learning rate: 0.0001 weight: 0.01
[6 / 10] Loss: 4.531703505189187 CE Loss: 0.1837140395964279 Con Loss: 4.5298663621997735
[6 / 10] tensor([[0.944, 0.923],
        [0.924, 0.918]]) {'epoch': 6, 'valid/acc': 92.533, 'valid/acc_unbiased': 92.881, 'valid/diff': 1.357, 'valid/acc_skew': 93.559, 'valid/acc_align': 92.202, 'test/acc': 92.782, 'test/acc_unbiased': 92.711, 'test/diff': 1.348, 'test/acc_skew': 93.386, 'test/acc_align': 92.037}
[6 / 10] best valid accuracy: 92.881 at epoch 6 
 best_stats: {'best_valid_epoch': 6, 'best_valid_valid/acc': 92.533, 'best_valid_valid/acc_unbiased': 92.881, 'best_valid_valid/diff': 1.357, 'best_valid_valid/acc_skew': 93.559, 'best_valid_valid/acc_align': 92.202, 'best_valid_test/acc': 92.782, 'best_valid_test/acc_unbiased': 92.711, 'best_valid_test/diff': 1.348, 'best_valid_test/acc_skew': 93.386, 'best_valid_test/acc_align': 92.037}
[6 / 10] best test accuracy: 92.716 at epoch 5 
 best_stats: {'best_test_epoch': 5, 'best_test_valid/acc': 92.26, 'best_test_valid/acc_unbiased': 92.615, 'best_test_valid/diff': 1.267, 'best_test_valid/acc_skew': 93.249, 'best_test_valid/acc_align': 91.982, 'best_test_test/acc': 92.868, 'best_test_test/acc_unbiased': 92.716, 'best_test_test/diff': 1.394, 'best_test_test/acc_skew': 93.413, 'best_test_test/acc_align': 92.02}
[7 / 10] Learning rate: 1e-05 weight: 0.01
[7 / 10] Loss: 4.520359766079617 CE Loss: 0.17948395693609975 Con Loss: 4.518564929364253
[7 / 10] tensor([[0.951, 0.931],
        [0.918, 0.913]]) {'epoch': 7, 'valid/acc': 92.466, 'valid/acc_unbiased': 92.794, 'valid/diff': 1.628, 'valid/acc_skew': 93.608, 'valid/acc_align': 91.98, 'test/acc': 92.898, 'test/acc_unbiased': 92.811, 'test/diff': 1.212, 'test/acc_skew': 93.417, 'test/acc_align': 92.205}
[7 / 10] best valid accuracy: 92.881 at epoch 6 
 best_stats: {'best_valid_epoch': 6, 'best_valid_valid/acc': 92.533, 'best_valid_valid/acc_unbiased': 92.881, 'best_valid_valid/diff': 1.357, 'best_valid_valid/acc_skew': 93.559, 'best_valid_valid/acc_align': 92.202, 'best_valid_test/acc': 92.782, 'best_valid_test/acc_unbiased': 92.711, 'best_valid_test/diff': 1.348, 'best_valid_test/acc_skew': 93.386, 'best_valid_test/acc_align': 92.037}
[7 / 10] best test accuracy: 92.811 at epoch 7 
 best_stats: {'best_test_epoch': 7, 'best_test_valid/acc': 92.466, 'best_test_valid/acc_unbiased': 92.794, 'best_test_valid/diff': 1.628, 'best_test_valid/acc_skew': 93.608, 'best_test_valid/acc_align': 91.98, 'best_test_test/acc': 92.898, 'best_test_test/acc_unbiased': 92.811, 'best_test_test/diff': 1.212, 'best_test_test/acc_skew': 93.417, 'best_test_test/acc_align': 92.205}
[8 / 10] Learning rate: 1e-05 weight: 0.01
[8 / 10] Loss: 4.523551857519074 CE Loss: 0.17852847713846054 Con Loss: 4.521766571711904
[8 / 10] tensor([[0.950, 0.931],
        [0.918, 0.917]]) {'epoch': 8, 'valid/acc': 92.6, 'valid/acc_unbiased': 92.943, 'valid/diff': 1.578, 'valid/acc_skew': 93.732, 'valid/acc_align': 92.155, 'test/acc': 92.958, 'test/acc_unbiased': 92.899, 'test/diff': 1.022, 'test/acc_skew': 93.41, 'test/acc_align': 92.388}
[8 / 10] best valid accuracy: 92.943 at epoch 8 
 best_stats: {'best_valid_epoch': 8, 'best_valid_valid/acc': 92.6, 'best_valid_valid/acc_unbiased': 92.943, 'best_valid_valid/diff': 1.578, 'best_valid_valid/acc_skew': 93.732, 'best_valid_valid/acc_align': 92.155, 'best_valid_test/acc': 92.958, 'best_valid_test/acc_unbiased': 92.899, 'best_valid_test/diff': 1.022, 'best_valid_test/acc_skew': 93.41, 'best_valid_test/acc_align': 92.388}
[8 / 10] best test accuracy: 92.899 at epoch 8 
 best_stats: {'best_test_epoch': 8, 'best_test_valid/acc': 92.6, 'best_test_valid/acc_unbiased': 92.943, 'best_test_valid/diff': 1.578, 'best_test_valid/acc_skew': 93.732, 'best_test_valid/acc_align': 92.155, 'best_test_test/acc': 92.958, 'best_test_test/acc_unbiased': 92.899, 'best_test_test/diff': 1.022, 'best_test_test/acc_skew': 93.41, 'best_test_test/acc_align': 92.388}
[9 / 10] Learning rate: 1e-05 weight: 0.01
[9 / 10] Loss: 4.517300531453172 CE Loss: 0.17754445523895876 Con Loss: 4.515525092037236
[9 / 10] tensor([[0.950, 0.934],
        [0.917, 0.915]]) {'epoch': 9, 'valid/acc': 92.533, 'valid/acc_unbiased': 92.937, 'valid/diff': 1.25, 'valid/acc_skew': 93.562, 'valid/acc_align': 92.312, 'test/acc': 92.963, 'test/acc_unbiased': 92.895, 'test/diff': 0.938, 'test/acc_skew': 93.364, 'test/acc_align': 92.426}
[9 / 10] best valid accuracy: 92.943 at epoch 8 
 best_stats: {'best_valid_epoch': 8, 'best_valid_valid/acc': 92.6, 'best_valid_valid/acc_unbiased': 92.943, 'best_valid_valid/diff': 1.578, 'best_valid_valid/acc_skew': 93.732, 'best_valid_valid/acc_align': 92.155, 'best_valid_test/acc': 92.958, 'best_valid_test/acc_unbiased': 92.899, 'best_valid_test/diff': 1.022, 'best_valid_test/acc_skew': 93.41, 'best_valid_test/acc_align': 92.388}
[9 / 10] best test accuracy: 92.899 at epoch 8 
 best_stats: {'best_test_epoch': 8, 'best_test_valid/acc': 92.6, 'best_test_valid/acc_unbiased': 92.943, 'best_test_valid/diff': 1.578, 'best_test_valid/acc_skew': 93.732, 'best_test_valid/acc_align': 92.155, 'best_test_test/acc': 92.958, 'best_test_test/acc_unbiased': 92.899, 'best_test_test/diff': 1.022, 'best_test_test/acc_skew': 93.41, 'best_test_test/acc_align': 92.388}
[10 / 10] Learning rate: 1e-05 weight: 0.01
[10 / 10] Loss: 4.5180484408446375 CE Loss: 0.17712232221222216 Con Loss: 4.516277223024922
[10 / 10] tensor([[0.955, 0.936],
        [0.913, 0.911]]) {'epoch': 10, 'valid/acc': 92.573, 'valid/acc_unbiased': 93.043, 'valid/diff': 1.206, 'valid/acc_skew': 93.646, 'valid/acc_align': 92.439, 'test/acc': 92.938, 'test/acc_unbiased': 92.862, 'test/diff': 1.022, 'test/acc_skew': 93.373, 'test/acc_align': 92.352}
[10 / 10] best valid accuracy: 93.043 at epoch 10 
 best_stats: {'best_valid_epoch': 10, 'best_valid_valid/acc': 92.573, 'best_valid_valid/acc_unbiased': 93.043, 'best_valid_valid/diff': 1.206, 'best_valid_valid/acc_skew': 93.646, 'best_valid_valid/acc_align': 92.439, 'best_valid_test/acc': 92.938, 'best_valid_test/acc_unbiased': 92.862, 'best_valid_test/diff': 1.022, 'best_valid_test/acc_skew': 93.373, 'best_valid_test/acc_align': 92.352}
[10 / 10] best test accuracy: 92.899 at epoch 8 
 best_stats: {'best_test_epoch': 8, 'best_test_valid/acc': 92.6, 'best_test_valid/acc_unbiased': 92.943, 'best_test_valid/diff': 1.578, 'best_test_valid/acc_skew': 93.732, 'best_test_valid/acc_align': 92.155, 'best_test_test/acc': 92.958, 'best_test_test/acc_unbiased': 92.899, 'best_test_test/diff': 1.022, 'best_test_test/acc_skew': 93.41, 'best_test_test/acc_align': 92.388}
Total training time: 2:52:14
