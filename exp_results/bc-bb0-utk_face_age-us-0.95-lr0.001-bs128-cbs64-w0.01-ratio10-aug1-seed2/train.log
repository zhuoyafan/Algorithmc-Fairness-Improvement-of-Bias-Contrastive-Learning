Log level set to: INFO
Set seed: 2
=======> Using Fixed Random Seed: 2 <========
save_path: exp_results/bc-bb0-utk_face_age-us-0.95-lr0.001-bs128-cbs64-w0.01-ratio10-aug1-seed2
get_utk_face - split: train, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_age-0.95
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [8237, 73]
Target 1: [411, 1477]
Binary Target 1
---------------------------
Target 0: [8237, 73]
Target 1: [411, 1477]
===================================
Normal Label Distribution: 
Target 0: [8237, 73]
Target 1: [411, 1477]
===================================
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [73, 73]
Target 1: [73, 73]
Binary Target 1
---------------------------
Target 0: [73, 73]
Target 1: [73, 73]
===================================
Normal Label Distribution: 
Target 0: [73, 73]
Target 1: [73, 73]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 292, target_attr: gender, bias_attr: age bias_rate: 0.95
['[train] target_0-bias_0: 73', '[train] target_0-bias_1: 73', '[train] target_1-bias_0: 73', '[train] target_1-bias_1: 73']
confusion_matrix - 
 original: tensor([[73., 73.],
        [73., 73.]]), 
 normalized: tensor([[0.500, 0.500],
        [0.500, 0.500]]), 
 b|y: tensor([[0.500, 0.500],
        [0.500, 0.500]])
get_utk_face - split: train, aug: 1, given_y: True, ratio: 10
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_age-0.95
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [8237, 73]
Target 1: [411, 1477]
Binary Target 1
---------------------------
Target 0: [8237, 73]
Target 1: [411, 1477]
===================================
Normal Label Distribution: 
Target 0: [8237, 73]
Target 1: [411, 1477]
===================================
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [73, 73]
Target 1: [73, 73]
Binary Target 1
---------------------------
Target 0: [73, 73]
Target 1: [73, 73]
===================================
Normal Label Distribution: 
Target 0: [73, 73]
Target 1: [73, 73]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 292, target_attr: gender, bias_attr: age bias_rate: 0.95
['[train] target_0-bias_0: 73', '[train] target_0-bias_1: 73', '[train] target_1-bias_0: 73', '[train] target_1-bias_1: 73']
get_utk_face - split: valid, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_age-0.95
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [1030, 195]
Target 1: [841, 202]
Binary Target 1
---------------------------
Target 0: [1030, 195]
Target 1: [841, 202]
===================================
Normal Label Distribution: 
Target 0: [1030, 195]
Target 1: [841, 202]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 2268, target_attr: gender, bias_attr: age bias_rate: 0.95
['[valid] target_0-bias_0: 1030', '[valid] target_0-bias_1: 195', '[valid] target_1-bias_0: 841', '[valid] target_1-bias_1: 202']
get_utk_face - split: test, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_age-0.95
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [1061, 176]
Target 1: [867, 165]
Binary Target 1
---------------------------
Target 0: [1061, 176]
Target 1: [867, 165]
===================================
Normal Label Distribution: 
Target 0: [1061, 176]
Target 1: [867, 165]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 2269, target_attr: gender, bias_attr: age bias_rate: 0.95
['[test] target_0-bias_0: 1061', '[test] target_0-bias_1: 176', '[test] target_1-bias_0: 867', '[test] target_1-bias_1: 165']
decay_epochs: [6, 13]
[1 / 20] Learning rate: 0.001 weight: 0.01
[1 / 20] Loss: 5.361330149924918 CE Loss: 0.7669822345041248 Con Loss: 5.35366028955538
[1 / 20] tensor([[0.584, 0.426],
        [0.569, 0.673]]) {'epoch': 1, 'valid/acc': 59.524, 'valid/acc_unbiased': 58.029, 'valid/diff': 14.91, 'valid/acc_skew': 60.131, 'valid/acc_align': 55.927, 'test/acc': 57.25, 'test/acc_unbiased': 56.296, 'test/diff': 13.116, 'test/acc_skew': 57.649, 'test/acc_align': 54.943}
[1 / 20] best valid accuracy: 58.029 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 59.524, 'best_valid_valid/acc_unbiased': 58.029, 'best_valid_valid/diff': 14.91, 'best_valid_valid/acc_skew': 60.131, 'best_valid_valid/acc_align': 55.927, 'best_valid_test/acc': 57.25, 'best_valid_test/acc_unbiased': 56.296, 'best_valid_test/diff': 13.116, 'best_valid_test/acc_skew': 57.649, 'best_valid_test/acc_align': 54.943}
[1 / 20] best test accuracy: 56.296 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 59.524, 'best_test_valid/acc_unbiased': 58.029, 'best_test_valid/diff': 14.91, 'best_test_valid/acc_skew': 60.131, 'best_test_valid/acc_align': 55.927, 'best_test_test/acc': 57.25, 'best_test_test/acc_unbiased': 56.296, 'best_test_test/diff': 13.116, 'best_test_test/acc_skew': 57.649, 'best_test_test/acc_align': 54.943}
[2 / 20] Learning rate: 0.001 weight: 0.01
[2 / 20] Loss: 5.223443828216971 CE Loss: 0.7325944214651029 Con Loss: 5.216117950334941
[2 / 20] tensor([[0.534, 0.267],
        [0.572, 0.752]]) {'epoch': 2, 'valid/acc': 55.291, 'valid/acc_unbiased': 54.905, 'valid/diff': 24.174, 'valid/acc_skew': 55.609, 'valid/acc_align': 54.202, 'test/acc': 54.385, 'test/acc_unbiased': 53.126, 'test/diff': 22.339, 'test/acc_skew': 55.324, 'test/acc_align': 50.928}
[2 / 20] best valid accuracy: 58.029 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 59.524, 'best_valid_valid/acc_unbiased': 58.029, 'best_valid_valid/diff': 14.91, 'best_valid_valid/acc_skew': 60.131, 'best_valid_valid/acc_align': 55.927, 'best_valid_test/acc': 57.25, 'best_valid_test/acc_unbiased': 56.296, 'best_valid_test/diff': 13.116, 'best_valid_test/acc_skew': 57.649, 'best_valid_test/acc_align': 54.943}
[2 / 20] best test accuracy: 56.296 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 59.524, 'best_test_valid/acc_unbiased': 58.029, 'best_test_valid/diff': 14.91, 'best_test_valid/acc_skew': 60.131, 'best_test_valid/acc_align': 55.927, 'best_test_test/acc': 57.25, 'best_test_test/acc_unbiased': 56.296, 'best_test_test/diff': 13.116, 'best_test_test/acc_skew': 57.649, 'best_test_test/acc_align': 54.943}
[3 / 20] Learning rate: 0.001 weight: 0.01
[3 / 20] Loss: 5.262639163291618 CE Loss: 0.7284565404669879 Con Loss: 5.255354437109542
[3 / 20] tensor([[0.554, 0.415],
        [0.622, 0.709]]) {'epoch': 3, 'valid/acc': 56.57, 'valid/acc_unbiased': 55.633, 'valid/diff': 9.13, 'valid/acc_skew': 57.31, 'valid/acc_align': 53.955, 'test/acc': 58.043, 'test/acc_unbiased': 57.494, 'test/diff': 11.341, 'test/acc_skew': 58.794, 'test/acc_align': 56.193}
[3 / 20] best valid accuracy: 58.029 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 59.524, 'best_valid_valid/acc_unbiased': 58.029, 'best_valid_valid/diff': 14.91, 'best_valid_valid/acc_skew': 60.131, 'best_valid_valid/acc_align': 55.927, 'best_valid_test/acc': 57.25, 'best_valid_test/acc_unbiased': 56.296, 'best_valid_test/diff': 13.116, 'best_valid_test/acc_skew': 57.649, 'best_valid_test/acc_align': 54.943}
[3 / 20] best test accuracy: 57.494 at epoch 3 
 best_stats: {'best_test_epoch': 3, 'best_test_valid/acc': 56.57, 'best_test_valid/acc_unbiased': 55.633, 'best_test_valid/diff': 9.13, 'best_test_valid/acc_skew': 57.31, 'best_test_valid/acc_align': 53.955, 'best_test_test/acc': 58.043, 'best_test_test/acc_unbiased': 57.494, 'best_test_test/diff': 11.341, 'best_test_test/acc_skew': 58.794, 'best_test_test/acc_align': 56.193}
[4 / 20] Learning rate: 0.001 weight: 0.01
[4 / 20] Loss: 5.150889083130719 CE Loss: 0.6607803767674589 Con Loss: 5.144281406925149
[4 / 20] tensor([[0.426, 0.392],
        [0.727, 0.770]]) {'epoch': 4, 'valid/acc': 54.85, 'valid/acc_unbiased': 56.117, 'valid/diff': 2.674, 'valid/acc_skew': 55.848, 'valid/acc_align': 56.386, 'test/acc': 56.324, 'test/acc_unbiased': 57.86, 'test/diff': 3.851, 'test/acc_skew': 57.633, 'test/acc_align': 58.087}
[4 / 20] best valid accuracy: 58.029 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 59.524, 'best_valid_valid/acc_unbiased': 58.029, 'best_valid_valid/diff': 14.91, 'best_valid_valid/acc_skew': 60.131, 'best_valid_valid/acc_align': 55.927, 'best_valid_test/acc': 57.25, 'best_valid_test/acc_unbiased': 56.296, 'best_valid_test/diff': 13.116, 'best_valid_test/acc_skew': 57.649, 'best_valid_test/acc_align': 54.943}
[4 / 20] best test accuracy: 57.860 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 54.85, 'best_test_valid/acc_unbiased': 56.117, 'best_test_valid/diff': 2.674, 'best_test_valid/acc_skew': 55.848, 'best_test_valid/acc_align': 56.386, 'best_test_test/acc': 56.324, 'best_test_test/acc_unbiased': 57.86, 'best_test_test/diff': 3.851, 'best_test_test/acc_skew': 57.633, 'best_test_test/acc_align': 58.087}
[5 / 20] Learning rate: 0.001 weight: 0.01
[5 / 20] Loss: 5.100047921481198 CE Loss: 0.6991820874279493 Con Loss: 5.093055973314259
[5 / 20] tensor([[0.700, 0.688],
        [0.501, 0.503]]) {'epoch': 5, 'valid/acc': 57.584, 'valid/acc_unbiased': 56.377, 'valid/diff': 7.177, 'valid/acc_skew': 56.756, 'valid/acc_align': 55.999, 'test/acc': 60.864, 'test/acc_unbiased': 59.785, 'test/diff': 0.762, 'test/acc_skew': 60.043, 'test/acc_align': 59.527}
[5 / 20] best valid accuracy: 58.029 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 59.524, 'best_valid_valid/acc_unbiased': 58.029, 'best_valid_valid/diff': 14.91, 'best_valid_valid/acc_skew': 60.131, 'best_valid_valid/acc_align': 55.927, 'best_valid_test/acc': 57.25, 'best_valid_test/acc_unbiased': 56.296, 'best_valid_test/diff': 13.116, 'best_valid_test/acc_skew': 57.649, 'best_valid_test/acc_align': 54.943}
[5 / 20] best test accuracy: 59.785 at epoch 5 
 best_stats: {'best_test_epoch': 5, 'best_test_valid/acc': 57.584, 'best_test_valid/acc_unbiased': 56.377, 'best_test_valid/diff': 7.177, 'best_test_valid/acc_skew': 56.756, 'best_test_valid/acc_align': 55.999, 'best_test_test/acc': 60.864, 'best_test_test/acc_unbiased': 59.785, 'best_test_test/diff': 0.762, 'best_test_test/acc_skew': 60.043, 'best_test_test/acc_align': 59.527}
[6 / 20] Learning rate: 0.001 weight: 0.01
[6 / 20] Loss: 5.046615306645224 CE Loss: 0.6568724072142823 Con Loss: 5.0400466788305
[6 / 20] tensor([[0.734, 0.733],
        [0.474, 0.455]]) {'epoch': 6, 'valid/acc': 59.612, 'valid/acc_unbiased': 56.214, 'valid/diff': 7.236, 'valid/acc_skew': 59.832, 'valid/acc_align': 52.596, 'test/acc': 61.437, 'test/acc_unbiased': 59.894, 'test/diff': 1.038, 'test/acc_skew': 60.413, 'test/acc_align': 59.375}
[6 / 20] best valid accuracy: 58.029 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 59.524, 'best_valid_valid/acc_unbiased': 58.029, 'best_valid_valid/diff': 14.91, 'best_valid_valid/acc_skew': 60.131, 'best_valid_valid/acc_align': 55.927, 'best_valid_test/acc': 57.25, 'best_valid_test/acc_unbiased': 56.296, 'best_valid_test/diff': 13.116, 'best_valid_test/acc_skew': 57.649, 'best_valid_test/acc_align': 54.943}
[6 / 20] best test accuracy: 59.894 at epoch 6 
 best_stats: {'best_test_epoch': 6, 'best_test_valid/acc': 59.612, 'best_test_valid/acc_unbiased': 56.214, 'best_test_valid/diff': 7.236, 'best_test_valid/acc_skew': 59.832, 'best_test_valid/acc_align': 52.596, 'best_test_test/acc': 61.437, 'best_test_test/acc_unbiased': 59.894, 'best_test_test/diff': 1.038, 'best_test_test/acc_skew': 60.413, 'best_test_test/acc_align': 59.375}
[7 / 20] Learning rate: 0.0001 weight: 0.01
[7 / 20] Loss: 4.998496133987218 CE Loss: 0.6383741751109084 Con Loss: 4.992112270773274
[7 / 20] tensor([[0.733, 0.670],
        [0.536, 0.521]]) {'epoch': 7, 'valid/acc': 60.362, 'valid/acc_unbiased': 57.343, 'valid/diff': 7.037, 'valid/acc_skew': 60.862, 'valid/acc_align': 53.825, 'test/acc': 63.773, 'test/acc_unbiased': 61.532, 'test/diff': 3.897, 'test/acc_skew': 63.48, 'test/acc_align': 59.583}
[7 / 20] best valid accuracy: 58.029 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 59.524, 'best_valid_valid/acc_unbiased': 58.029, 'best_valid_valid/diff': 14.91, 'best_valid_valid/acc_skew': 60.131, 'best_valid_valid/acc_align': 55.927, 'best_valid_test/acc': 57.25, 'best_valid_test/acc_unbiased': 56.296, 'best_valid_test/diff': 13.116, 'best_valid_test/acc_skew': 57.649, 'best_valid_test/acc_align': 54.943}
[7 / 20] best test accuracy: 61.532 at epoch 7 
 best_stats: {'best_test_epoch': 7, 'best_test_valid/acc': 60.362, 'best_test_valid/acc_unbiased': 57.343, 'best_test_valid/diff': 7.037, 'best_test_valid/acc_skew': 60.862, 'best_test_valid/acc_align': 53.825, 'best_test_test/acc': 63.773, 'best_test_test/acc_unbiased': 61.532, 'best_test_test/diff': 3.897, 'best_test_test/acc_skew': 63.48, 'best_test_test/acc_align': 59.583}
[8 / 20] Learning rate: 0.0001 weight: 0.01
[8 / 20] Loss: 4.996798763536427 CE Loss: 0.6383827051071271 Con Loss: 4.990414926450547
[8 / 20] tensor([[0.746, 0.676],
        [0.540, 0.527]]) {'epoch': 8, 'valid/acc': 61.155, 'valid/acc_unbiased': 58.302, 'valid/diff': 6.426, 'valid/acc_skew': 61.515, 'valid/acc_align': 55.089, 'test/acc': 64.566, 'test/acc_unbiased': 62.218, 'test/diff': 4.095, 'test/acc_skew': 64.266, 'test/acc_align': 60.17}
[8 / 20] best valid accuracy: 58.302 at epoch 8 
 best_stats: {'best_valid_epoch': 8, 'best_valid_valid/acc': 61.155, 'best_valid_valid/acc_unbiased': 58.302, 'best_valid_valid/diff': 6.426, 'best_valid_valid/acc_skew': 61.515, 'best_valid_valid/acc_align': 55.089, 'best_valid_test/acc': 64.566, 'best_valid_test/acc_unbiased': 62.218, 'best_valid_test/diff': 4.095, 'best_valid_test/acc_skew': 64.266, 'best_valid_test/acc_align': 60.17}
[8 / 20] best test accuracy: 62.218 at epoch 8 
 best_stats: {'best_test_epoch': 8, 'best_test_valid/acc': 61.155, 'best_test_valid/acc_unbiased': 58.302, 'best_test_valid/diff': 6.426, 'best_test_valid/acc_skew': 61.515, 'best_test_valid/acc_align': 55.089, 'best_test_test/acc': 64.566, 'best_test_test/acc_unbiased': 62.218, 'best_test_test/diff': 4.095, 'best_test_test/acc_skew': 64.266, 'best_test_test/acc_align': 60.17}
[9 / 20] Learning rate: 0.0001 weight: 0.01
[9 / 20] Loss: 4.957502626392939 CE Loss: 0.6512373016305166 Con Loss: 4.950990369875137
[9 / 20] tensor([[0.766, 0.676],
        [0.535, 0.527]]) {'epoch': 9, 'valid/acc': 62.39, 'valid/acc_unbiased': 59.556, 'valid/diff': 5.945, 'valid/acc_skew': 62.528, 'valid/acc_align': 56.583, 'test/acc': 65.359, 'test/acc_unbiased': 62.621, 'test/diff': 4.901, 'test/acc_skew': 65.072, 'test/acc_align': 60.17}
[9 / 20] best valid accuracy: 59.556 at epoch 9 
 best_stats: {'best_valid_epoch': 9, 'best_valid_valid/acc': 62.39, 'best_valid_valid/acc_unbiased': 59.556, 'best_valid_valid/diff': 5.945, 'best_valid_valid/acc_skew': 62.528, 'best_valid_valid/acc_align': 56.583, 'best_valid_test/acc': 65.359, 'best_valid_test/acc_unbiased': 62.621, 'best_valid_test/diff': 4.901, 'best_valid_test/acc_skew': 65.072, 'best_valid_test/acc_align': 60.17}
[9 / 20] best test accuracy: 62.621 at epoch 9 
 best_stats: {'best_test_epoch': 9, 'best_test_valid/acc': 62.39, 'best_test_valid/acc_unbiased': 59.556, 'best_test_valid/diff': 5.945, 'best_test_valid/acc_skew': 62.528, 'best_test_valid/acc_align': 56.583, 'best_test_test/acc': 65.359, 'best_test_test/acc_unbiased': 62.621, 'best_test_test/diff': 4.901, 'best_test_test/acc_skew': 65.072, 'best_test_test/acc_align': 60.17}
[10 / 20] Learning rate: 0.0001 weight: 0.01
[10 / 20] Loss: 4.937832891124568 CE Loss: 0.6467246192775361 Con Loss: 4.9313657773684145
[10 / 20] tensor([[0.753, 0.636],
        [0.567, 0.558]]) {'epoch': 10, 'valid/acc': 63.139, 'valid/acc_unbiased': 59.695, 'valid/diff': 8.294, 'valid/acc_skew': 63.842, 'valid/acc_align': 55.548, 'test/acc': 65.888, 'test/acc_unbiased': 62.862, 'test/diff': 6.33, 'test/acc_skew': 66.027, 'test/acc_align': 59.697}
[10 / 20] best valid accuracy: 59.695 at epoch 10 
 best_stats: {'best_valid_epoch': 10, 'best_valid_valid/acc': 63.139, 'best_valid_valid/acc_unbiased': 59.695, 'best_valid_valid/diff': 8.294, 'best_valid_valid/acc_skew': 63.842, 'best_valid_valid/acc_align': 55.548, 'best_valid_test/acc': 65.888, 'best_valid_test/acc_unbiased': 62.862, 'best_valid_test/diff': 6.33, 'best_valid_test/acc_skew': 66.027, 'best_valid_test/acc_align': 59.697}
[10 / 20] best test accuracy: 62.862 at epoch 10 
 best_stats: {'best_test_epoch': 10, 'best_test_valid/acc': 63.139, 'best_test_valid/acc_unbiased': 59.695, 'best_test_valid/diff': 8.294, 'best_test_valid/acc_skew': 63.842, 'best_test_valid/acc_align': 55.548, 'best_test_test/acc': 65.888, 'best_test_test/acc_unbiased': 62.862, 'best_test_test/diff': 6.33, 'best_test_test/acc_skew': 66.027, 'best_test_test/acc_align': 59.697}
[11 / 20] Learning rate: 0.0001 weight: 0.01
[11 / 20] Loss: 4.892985487637454 CE Loss: 0.6374678342309716 Con Loss: 4.886610854161929
[11 / 20] tensor([[0.746, 0.614],
        [0.608, 0.600]]) {'epoch': 11, 'valid/acc': 64.109, 'valid/acc_unbiased': 61.287, 'valid/diff': 7.005, 'valid/acc_skew': 64.79, 'valid/acc_align': 57.785, 'test/acc': 67.254, 'test/acc_unbiased': 64.199, 'test/diff': 7.034, 'test/acc_skew': 67.715, 'test/acc_align': 60.682}
[11 / 20] best valid accuracy: 61.287 at epoch 11 
 best_stats: {'best_valid_epoch': 11, 'best_valid_valid/acc': 64.109, 'best_valid_valid/acc_unbiased': 61.287, 'best_valid_valid/diff': 7.005, 'best_valid_valid/acc_skew': 64.79, 'best_valid_valid/acc_align': 57.785, 'best_valid_test/acc': 67.254, 'best_valid_test/acc_unbiased': 64.199, 'best_valid_test/diff': 7.034, 'best_valid_test/acc_skew': 67.715, 'best_valid_test/acc_align': 60.682}
[11 / 20] best test accuracy: 64.199 at epoch 11 
 best_stats: {'best_test_epoch': 11, 'best_test_valid/acc': 64.109, 'best_test_valid/acc_unbiased': 61.287, 'best_test_valid/diff': 7.005, 'best_test_valid/acc_skew': 64.79, 'best_test_valid/acc_align': 57.785, 'best_test_test/acc': 67.254, 'best_test_test/acc_unbiased': 64.199, 'best_test_test/diff': 7.034, 'best_test_test/acc_skew': 67.715, 'best_test_test/acc_align': 60.682}
[12 / 20] Learning rate: 0.0001 weight: 0.01
[12 / 20] Loss: 4.9179798282989085 CE Loss: 0.6490502782063942 Con Loss: 4.911489316861924
[12 / 20] tensor([[0.724, 0.585],
        [0.654, 0.612]]) {'epoch': 12, 'valid/acc': 64.771, 'valid/acc_unbiased': 62.122, 'valid/diff': 7.438, 'valid/acc_skew': 65.841, 'valid/acc_align': 58.403, 'test/acc': 67.827, 'test/acc_unbiased': 64.379, 'test/diff': 9.024, 'test/acc_skew': 68.891, 'test/acc_align': 59.867}
[12 / 20] best valid accuracy: 62.122 at epoch 12 
 best_stats: {'best_valid_epoch': 12, 'best_valid_valid/acc': 64.771, 'best_valid_valid/acc_unbiased': 62.122, 'best_valid_valid/diff': 7.438, 'best_valid_valid/acc_skew': 65.841, 'best_valid_valid/acc_align': 58.403, 'best_valid_test/acc': 67.827, 'best_valid_test/acc_unbiased': 64.379, 'best_valid_test/diff': 9.024, 'best_valid_test/acc_skew': 68.891, 'best_valid_test/acc_align': 59.867}
[12 / 20] best test accuracy: 64.379 at epoch 12 
 best_stats: {'best_test_epoch': 12, 'best_test_valid/acc': 64.771, 'best_test_valid/acc_unbiased': 62.122, 'best_test_valid/diff': 7.438, 'best_test_valid/acc_skew': 65.841, 'best_test_valid/acc_align': 58.403, 'best_test_test/acc': 67.827, 'best_test_test/acc_unbiased': 64.379, 'best_test_test/diff': 9.024, 'best_test_test/acc_skew': 68.891, 'best_test_test/acc_align': 59.867}
[13 / 20] Learning rate: 0.0001 weight: 0.01
[13 / 20] Loss: 4.912786163695871 CE Loss: 0.6213356109514628 Con Loss: 4.906572655455707
[13 / 20] tensor([[0.691, 0.551],
        [0.701, 0.685]]) {'epoch': 13, 'valid/acc': 65.653, 'valid/acc_unbiased': 62.997, 'valid/diff': 8.375, 'valid/acc_skew': 67.184, 'valid/acc_align': 58.809, 'test/acc': 68.356, 'test/acc_unbiased': 65.703, 'test/diff': 7.807, 'test/acc_skew': 69.606, 'test/acc_align': 61.799}
[13 / 20] best valid accuracy: 62.997 at epoch 13 
 best_stats: {'best_valid_epoch': 13, 'best_valid_valid/acc': 65.653, 'best_valid_valid/acc_unbiased': 62.997, 'best_valid_valid/diff': 8.375, 'best_valid_valid/acc_skew': 67.184, 'best_valid_valid/acc_align': 58.809, 'best_valid_test/acc': 68.356, 'best_valid_test/acc_unbiased': 65.703, 'best_valid_test/diff': 7.807, 'best_valid_test/acc_skew': 69.606, 'best_valid_test/acc_align': 61.799}
[13 / 20] best test accuracy: 65.703 at epoch 13 
 best_stats: {'best_test_epoch': 13, 'best_test_valid/acc': 65.653, 'best_test_valid/acc_unbiased': 62.997, 'best_test_valid/diff': 8.375, 'best_test_valid/acc_skew': 67.184, 'best_test_valid/acc_align': 58.809, 'best_test_test/acc': 68.356, 'best_test_test/acc_unbiased': 65.703, 'best_test_test/diff': 7.807, 'best_test_test/acc_skew': 69.606, 'best_test_test/acc_align': 61.799}
[14 / 20] Learning rate: 1e-05 weight: 0.01
[14 / 20] Loss: 4.886135486707295 CE Loss: 0.6332024727782158 Con Loss: 4.879803566083516
[14 / 20] tensor([[0.697, 0.545],
        [0.693, 0.667]]) {'epoch': 14, 'valid/acc': 66.093, 'valid/acc_unbiased': 63.743, 'valid/diff': 7.303, 'valid/acc_skew': 67.394, 'valid/acc_align': 60.091, 'test/acc': 68.18, 'test/acc_unbiased': 65.069, 'test/diff': 8.926, 'test/acc_skew': 69.533, 'test/acc_align': 60.606}
[14 / 20] best valid accuracy: 63.743 at epoch 14 
 best_stats: {'best_valid_epoch': 14, 'best_valid_valid/acc': 66.093, 'best_valid_valid/acc_unbiased': 63.743, 'best_valid_valid/diff': 7.303, 'best_valid_valid/acc_skew': 67.394, 'best_valid_valid/acc_align': 60.091, 'best_valid_test/acc': 68.18, 'best_valid_test/acc_unbiased': 65.069, 'best_valid_test/diff': 8.926, 'best_valid_test/acc_skew': 69.533, 'best_valid_test/acc_align': 60.606}
[14 / 20] best test accuracy: 65.703 at epoch 13 
 best_stats: {'best_test_epoch': 13, 'best_test_valid/acc': 65.653, 'best_test_valid/acc_unbiased': 62.997, 'best_test_valid/diff': 8.375, 'best_test_valid/acc_skew': 67.184, 'best_test_valid/acc_align': 58.809, 'best_test_test/acc': 68.356, 'best_test_test/acc_unbiased': 65.703, 'best_test_test/diff': 7.807, 'best_test_test/acc_skew': 69.606, 'best_test_test/acc_align': 61.799}
[15 / 20] Learning rate: 1e-05 weight: 0.01
[15 / 20] Loss: 4.891158149666982 CE Loss: 0.6385102957895358 Con Loss: 4.884773006177928
[15 / 20] tensor([[0.689, 0.540],
        [0.702, 0.691]]) {'epoch': 15, 'valid/acc': 66.093, 'valid/acc_unbiased': 63.282, 'valid/diff': 8.928, 'valid/acc_skew': 67.746, 'valid/acc_align': 58.818, 'test/acc': 68.268, 'test/acc_unbiased': 65.552, 'test/diff': 8.036, 'test/acc_skew': 69.57, 'test/acc_align': 61.534}
[15 / 20] best valid accuracy: 63.743 at epoch 14 
 best_stats: {'best_valid_epoch': 14, 'best_valid_valid/acc': 66.093, 'best_valid_valid/acc_unbiased': 63.743, 'best_valid_valid/diff': 7.303, 'best_valid_valid/acc_skew': 67.394, 'best_valid_valid/acc_align': 60.091, 'best_valid_test/acc': 68.18, 'best_valid_test/acc_unbiased': 65.069, 'best_valid_test/diff': 8.926, 'best_valid_test/acc_skew': 69.533, 'best_valid_test/acc_align': 60.606}
[15 / 20] best test accuracy: 65.703 at epoch 13 
 best_stats: {'best_test_epoch': 13, 'best_test_valid/acc': 65.653, 'best_test_valid/acc_unbiased': 62.997, 'best_test_valid/diff': 8.375, 'best_test_valid/acc_skew': 67.184, 'best_test_valid/acc_align': 58.809, 'best_test_test/acc': 68.356, 'best_test_test/acc_unbiased': 65.703, 'best_test_test/diff': 7.807, 'best_test_test/acc_skew': 69.606, 'best_test_test/acc_align': 61.799}
[16 / 20] Learning rate: 1e-05 weight: 0.01
[16 / 20] Loss: 4.885078946205034 CE Loss: 0.6150813657943517 Con Loss: 4.878928027740897
[16 / 20] tensor([[0.680, 0.534],
        [0.714, 0.703]]) {'epoch': 16, 'valid/acc': 66.093, 'valid/acc_unbiased': 63.193, 'valid/diff': 9.334, 'valid/acc_skew': 67.86, 'valid/acc_align': 58.526, 'test/acc': 68.312, 'test/acc_unbiased': 65.766, 'test/diff': 7.819, 'test/acc_skew': 69.675, 'test/acc_align': 61.856}
[16 / 20] best valid accuracy: 63.743 at epoch 14 
 best_stats: {'best_valid_epoch': 14, 'best_valid_valid/acc': 66.093, 'best_valid_valid/acc_unbiased': 63.743, 'best_valid_valid/diff': 7.303, 'best_valid_valid/acc_skew': 67.394, 'best_valid_valid/acc_align': 60.091, 'best_valid_test/acc': 68.18, 'best_valid_test/acc_unbiased': 65.069, 'best_valid_test/diff': 8.926, 'best_valid_test/acc_skew': 69.533, 'best_valid_test/acc_align': 60.606}
[16 / 20] best test accuracy: 65.766 at epoch 16 
 best_stats: {'best_test_epoch': 16, 'best_test_valid/acc': 66.093, 'best_test_valid/acc_unbiased': 63.193, 'best_test_valid/diff': 9.334, 'best_test_valid/acc_skew': 67.86, 'best_test_valid/acc_align': 58.526, 'best_test_test/acc': 68.312, 'best_test_test/acc_unbiased': 65.766, 'best_test_test/diff': 7.819, 'best_test_test/acc_skew': 69.675, 'best_test_test/acc_align': 61.856}
[17 / 20] Learning rate: 1e-05 weight: 0.01
[17 / 20] Loss: 4.862486963402735 CE Loss: 0.6205194437340514 Con Loss: 4.856281757354736
[17 / 20] tensor([[0.664, 0.523],
        [0.728, 0.709]]) {'epoch': 17, 'valid/acc': 65.873, 'valid/acc_unbiased': 62.861, 'valid/diff': 10.262, 'valid/acc_skew': 67.992, 'valid/acc_align': 57.73, 'test/acc': 68.048, 'test/acc_unbiased': 65.579, 'test/diff': 7.975, 'test/acc_skew': 69.566, 'test/acc_align': 61.591}
[17 / 20] best valid accuracy: 63.743 at epoch 14 
 best_stats: {'best_valid_epoch': 14, 'best_valid_valid/acc': 66.093, 'best_valid_valid/acc_unbiased': 63.743, 'best_valid_valid/diff': 7.303, 'best_valid_valid/acc_skew': 67.394, 'best_valid_valid/acc_align': 60.091, 'best_valid_test/acc': 68.18, 'best_valid_test/acc_unbiased': 65.069, 'best_valid_test/diff': 8.926, 'best_valid_test/acc_skew': 69.533, 'best_valid_test/acc_align': 60.606}
[17 / 20] best test accuracy: 65.766 at epoch 16 
 best_stats: {'best_test_epoch': 16, 'best_test_valid/acc': 66.093, 'best_test_valid/acc_unbiased': 63.193, 'best_test_valid/diff': 9.334, 'best_test_valid/acc_skew': 67.86, 'best_test_valid/acc_align': 58.526, 'best_test_test/acc': 68.312, 'best_test_test/acc_unbiased': 65.766, 'best_test_test/diff': 7.819, 'best_test_test/acc_skew': 69.675, 'best_test_test/acc_align': 61.856}
[18 / 20] Learning rate: 1e-05 weight: 0.01
[18 / 20] Loss: 4.879769756369395 CE Loss: 0.6380126941693972 Con Loss: 4.873389531488288
[18 / 20] tensor([[0.666, 0.511],
        [0.731, 0.721]]) {'epoch': 18, 'valid/acc': 65.785, 'valid/acc_unbiased': 63.059, 'valid/diff': 9.631, 'valid/acc_skew': 67.874, 'valid/acc_align': 58.243, 'test/acc': 68.312, 'test/acc_unbiased': 65.755, 'test/diff': 8.252, 'test/acc_skew': 69.88, 'test/acc_align': 61.629}
[18 / 20] best valid accuracy: 63.743 at epoch 14 
 best_stats: {'best_valid_epoch': 14, 'best_valid_valid/acc': 66.093, 'best_valid_valid/acc_unbiased': 63.743, 'best_valid_valid/diff': 7.303, 'best_valid_valid/acc_skew': 67.394, 'best_valid_valid/acc_align': 60.091, 'best_valid_test/acc': 68.18, 'best_valid_test/acc_unbiased': 65.069, 'best_valid_test/diff': 8.926, 'best_valid_test/acc_skew': 69.533, 'best_valid_test/acc_align': 60.606}
[18 / 20] best test accuracy: 65.766 at epoch 16 
 best_stats: {'best_test_epoch': 16, 'best_test_valid/acc': 66.093, 'best_test_valid/acc_unbiased': 63.193, 'best_test_valid/diff': 9.334, 'best_test_valid/acc_skew': 67.86, 'best_test_valid/acc_align': 58.526, 'best_test_test/acc': 68.312, 'best_test_test/acc_unbiased': 65.766, 'best_test_test/diff': 7.819, 'best_test_test/acc_skew': 69.675, 'best_test_test/acc_align': 61.856}
[19 / 20] Learning rate: 1e-05 weight: 0.01
[19 / 20] Loss: 4.854816351851372 CE Loss: 0.6373431266170658 Con Loss: 4.848443005182972
[19 / 20] tensor([[0.660, 0.511],
        [0.737, 0.727]]) {'epoch': 19, 'valid/acc': 66.138, 'valid/acc_unbiased': 63.1, 'valid/diff': 10.738, 'valid/acc_skew': 68.469, 'valid/acc_align': 57.73, 'test/acc': 68.268, 'test/acc_unbiased': 65.885, 'test/diff': 7.907, 'test/acc_skew': 69.839, 'test/acc_align': 61.932}
[19 / 20] best valid accuracy: 63.743 at epoch 14 
 best_stats: {'best_valid_epoch': 14, 'best_valid_valid/acc': 66.093, 'best_valid_valid/acc_unbiased': 63.743, 'best_valid_valid/diff': 7.303, 'best_valid_valid/acc_skew': 67.394, 'best_valid_valid/acc_align': 60.091, 'best_valid_test/acc': 68.18, 'best_valid_test/acc_unbiased': 65.069, 'best_valid_test/diff': 8.926, 'best_valid_test/acc_skew': 69.533, 'best_valid_test/acc_align': 60.606}
[19 / 20] best test accuracy: 65.885 at epoch 19 
 best_stats: {'best_test_epoch': 19, 'best_test_valid/acc': 66.138, 'best_test_valid/acc_unbiased': 63.1, 'best_test_valid/diff': 10.738, 'best_test_valid/acc_skew': 68.469, 'best_test_valid/acc_align': 57.73, 'best_test_test/acc': 68.268, 'best_test_test/acc_unbiased': 65.885, 'best_test_test/diff': 7.907, 'best_test_test/acc_skew': 69.839, 'best_test_test/acc_align': 61.932}
[20 / 20] Learning rate: 1e-05 weight: 0.01
[20 / 20] Loss: 4.85629083685679 CE Loss: 0.6465801245545688 Con Loss: 4.849825022971793
[20 / 20] tensor([[0.658, 0.517],
        [0.743, 0.727]]) {'epoch': 20, 'valid/acc': 65.917, 'valid/acc_unbiased': 63.265, 'valid/diff': 9.566, 'valid/acc_skew': 68.048, 'valid/acc_align': 58.482, 'test/acc': 68.444, 'test/acc_unbiased': 66.124, 'test/diff': 7.817, 'test/acc_skew': 70.033, 'test/acc_align': 62.216}
[20 / 20] best valid accuracy: 63.743 at epoch 14 
 best_stats: {'best_valid_epoch': 14, 'best_valid_valid/acc': 66.093, 'best_valid_valid/acc_unbiased': 63.743, 'best_valid_valid/diff': 7.303, 'best_valid_valid/acc_skew': 67.394, 'best_valid_valid/acc_align': 60.091, 'best_valid_test/acc': 68.18, 'best_valid_test/acc_unbiased': 65.069, 'best_valid_test/diff': 8.926, 'best_valid_test/acc_skew': 69.533, 'best_valid_test/acc_align': 60.606}
[20 / 20] best test accuracy: 66.124 at epoch 20 
 best_stats: {'best_test_epoch': 20, 'best_test_valid/acc': 65.917, 'best_test_valid/acc_unbiased': 63.265, 'best_test_valid/diff': 9.566, 'best_test_valid/acc_skew': 68.048, 'best_test_valid/acc_align': 58.482, 'best_test_test/acc': 68.444, 'best_test_test/acc_unbiased': 66.124, 'best_test_test/diff': 7.817, 'best_test_test/acc_skew': 70.033, 'best_test_test/acc_align': 62.216}
Total training time: 0:07:14
