Log level set to: INFO
Set seed: 3
=======> Using Fixed Random Seed: 3 <========
save_path: exp_results/bc-bb0-utk_face_race-crop_rotate_color-0.9-lr0.001-bs128-cbs64-w0.01-ratio10-aug1-seed3
get_utk_face - split: train, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_race-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [4407, 552]
Target 1: [440, 5529]
Binary Target 1
---------------------------
Target 0: [4407, 552]
Target 1: [440, 5529]
===================================
Normal Label Distribution: 
Target 0: [4407, 552]
Target 1: [440, 5529]
===================================
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [4407, 552]
Target 1: [440, 5529]
Binary Target 1
---------------------------
Target 0: [4407, 552]
Target 1: [440, 5529]
===================================
Normal Label Distribution: 
Target 0: [4407, 552]
Target 1: [440, 5529]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 10928, target_attr: gender, bias_attr: race bias_rate: 0.9
['[train] target_0-bias_0: 4407', '[train] target_0-bias_1: 552', '[train] target_1-bias_0: 440', '[train] target_1-bias_1: 5529']
confusion_matrix - 
 original: tensor([[4407.,  440.],
        [ 552., 5529.]]), 
 normalized: tensor([[0.909, 0.091],
        [0.091, 0.909]]), 
 b|y: tensor([[0.889, 0.111],
        [0.074, 0.926]])
get_utk_face - split: train, aug: 1, given_y: True, ratio: 10
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_race-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [4407, 552]
Target 1: [440, 5529]
Binary Target 1
---------------------------
Target 0: [4407, 552]
Target 1: [440, 5529]
===================================
Normal Label Distribution: 
Target 0: [4407, 552]
Target 1: [440, 5529]
===================================
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [4407, 552]
Target 1: [440, 5529]
Binary Target 1
---------------------------
Target 0: [4407, 552]
Target 1: [440, 5529]
===================================
Normal Label Distribution: 
Target 0: [4407, 552]
Target 1: [440, 5529]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 10928, target_attr: gender, bias_attr: race bias_rate: 0.9
['[train] target_0-bias_0: 4407', '[train] target_0-bias_1: 552', '[train] target_1-bias_0: 440', '[train] target_1-bias_1: 5529']
get_utk_face - split: valid, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_race-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [583, 684]
Target 1: [457, 646]
Binary Target 1
---------------------------
Target 0: [583, 684]
Target 1: [457, 646]
===================================
Normal Label Distribution: 
Target 0: [583, 684]
Target 1: [457, 646]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 2370, target_attr: gender, bias_attr: race bias_rate: 0.9
['[valid] target_0-bias_0: 583', '[valid] target_0-bias_1: 684', '[valid] target_1-bias_0: 457', '[valid] target_1-bias_1: 646']
get_utk_face - split: test, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_race-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [558, 677]
Target 1: [462, 673]
Binary Target 1
---------------------------
Target 0: [558, 677]
Target 1: [462, 673]
===================================
Normal Label Distribution: 
Target 0: [558, 677]
Target 1: [462, 673]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 2370, target_attr: gender, bias_attr: race bias_rate: 0.9
['[test] target_0-bias_0: 558', '[test] target_0-bias_1: 677', '[test] target_1-bias_0: 462', '[test] target_1-bias_1: 673']
decay_epochs: [6, 13]
[1 / 20] Learning rate: 0.001 weight: 0.01
[1 / 20] Loss: 4.9182303807047765 CE Loss: 0.670326147561192 Con Loss: 4.911527121224131
[1 / 20] tensor([[0.656, 0.585],
        [0.649, 0.756]]) {'epoch': 1, 'valid/acc': 65.823, 'valid/acc_unbiased': 65.684, 'valid/diff': 10.378, 'valid/acc_skew': 60.495, 'valid/acc_align': 70.873, 'test/acc': 66.287, 'test/acc_unbiased': 66.163, 'test/diff': 8.897, 'test/acc_skew': 61.714, 'test/acc_align': 70.611}
[1 / 20] best valid accuracy: 65.684 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 65.823, 'best_valid_valid/acc_unbiased': 65.684, 'best_valid_valid/diff': 10.378, 'best_valid_valid/acc_skew': 60.495, 'best_valid_valid/acc_align': 70.873, 'best_valid_test/acc': 66.287, 'best_valid_test/acc_unbiased': 66.163, 'best_valid_test/diff': 8.897, 'best_valid_test/acc_skew': 61.714, 'best_valid_test/acc_align': 70.611}
[1 / 20] best test accuracy: 66.163 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 65.823, 'best_test_valid/acc_unbiased': 65.684, 'best_test_valid/diff': 10.378, 'best_test_valid/acc_skew': 60.495, 'best_test_valid/acc_align': 70.873, 'best_test_test/acc': 66.287, 'best_test_test/acc_unbiased': 66.163, 'best_test_test/diff': 8.897, 'best_test_test/acc_skew': 61.714, 'best_test_test/acc_align': 70.611}
[2 / 20] Learning rate: 0.001 weight: 0.01
[2 / 20] Loss: 4.847307453043814 CE Loss: 0.5977634299726472 Con Loss: 4.8413298454675635
[2 / 20] tensor([[0.394, 0.270],
        [0.937, 0.964]]) {'epoch': 2, 'valid/acc': 60.549, 'valid/acc_unbiased': 62.851, 'valid/diff': 9.382, 'valid/acc_skew': 58.159, 'valid/acc_align': 67.542, 'test/acc': 62.658, 'test/acc_unbiased': 64.154, 'test/diff': 7.553, 'test/acc_skew': 60.377, 'test/acc_align': 67.93}
[2 / 20] best valid accuracy: 65.684 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 65.823, 'best_valid_valid/acc_unbiased': 65.684, 'best_valid_valid/diff': 10.378, 'best_valid_valid/acc_skew': 60.495, 'best_valid_valid/acc_align': 70.873, 'best_valid_test/acc': 66.287, 'best_valid_test/acc_unbiased': 66.163, 'best_valid_test/diff': 8.897, 'best_valid_test/acc_skew': 61.714, 'best_valid_test/acc_align': 70.611}
[2 / 20] best test accuracy: 66.163 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 65.823, 'best_test_valid/acc_unbiased': 65.684, 'best_test_valid/diff': 10.378, 'best_test_valid/acc_skew': 60.495, 'best_test_valid/acc_align': 70.873, 'best_test_test/acc': 66.287, 'best_test_test/acc_unbiased': 66.163, 'best_test_test/diff': 8.897, 'best_test_test/acc_skew': 61.714, 'best_test_test/acc_align': 70.611}
[3 / 20] Learning rate: 0.001 weight: 0.01
[3 / 20] Loss: 4.842471393624302 CE Loss: 0.5681033472627358 Con Loss: 4.83679033617324
[3 / 20] tensor([[0.821, 0.744],
        [0.597, 0.654]]) {'epoch': 3, 'valid/acc': 70.675, 'valid/acc_unbiased': 70.046, 'valid/diff': 8.13, 'valid/acc_skew': 65.981, 'valid/acc_align': 74.111, 'test/acc': 70.802, 'test/acc_unbiased': 70.411, 'test/diff': 6.636, 'test/acc_skew': 67.093, 'test/acc_align': 73.729}
[3 / 20] best valid accuracy: 70.046 at epoch 3 
 best_stats: {'best_valid_epoch': 3, 'best_valid_valid/acc': 70.675, 'best_valid_valid/acc_unbiased': 70.046, 'best_valid_valid/diff': 8.13, 'best_valid_valid/acc_skew': 65.981, 'best_valid_valid/acc_align': 74.111, 'best_valid_test/acc': 70.802, 'best_valid_test/acc_unbiased': 70.411, 'best_valid_test/diff': 6.636, 'best_valid_test/acc_skew': 67.093, 'best_valid_test/acc_align': 73.729}
[3 / 20] best test accuracy: 70.411 at epoch 3 
 best_stats: {'best_test_epoch': 3, 'best_test_valid/acc': 70.675, 'best_test_valid/acc_unbiased': 70.046, 'best_test_valid/diff': 8.13, 'best_test_valid/acc_skew': 65.981, 'best_test_valid/acc_align': 74.111, 'best_test_test/acc': 70.802, 'best_test_test/acc_unbiased': 70.411, 'best_test_test/diff': 6.636, 'best_test_test/acc_skew': 67.093, 'best_test_test/acc_align': 73.729}
[4 / 20] Learning rate: 0.001 weight: 0.01
[4 / 20] Loss: 4.836637468324049 CE Loss: 0.557358809131829 Con Loss: 4.831063875167645
[4 / 20] tensor([[0.522, 0.449],
        [0.844, 0.908]]) {'epoch': 4, 'valid/acc': 67.342, 'valid/acc_unbiased': 68.614, 'valid/diff': 3.206, 'valid/acc_skew': 67.011, 'valid/acc_align': 70.217, 'test/acc': 67.342, 'test/acc_unbiased': 68.064, 'test/diff': 6.809, 'test/acc_skew': 64.66, 'test/acc_align': 71.469}
[4 / 20] best valid accuracy: 70.046 at epoch 3 
 best_stats: {'best_valid_epoch': 3, 'best_valid_valid/acc': 70.675, 'best_valid_valid/acc_unbiased': 70.046, 'best_valid_valid/diff': 8.13, 'best_valid_valid/acc_skew': 65.981, 'best_valid_valid/acc_align': 74.111, 'best_valid_test/acc': 70.802, 'best_valid_test/acc_unbiased': 70.411, 'best_valid_test/diff': 6.636, 'best_valid_test/acc_skew': 67.093, 'best_valid_test/acc_align': 73.729}
[4 / 20] best test accuracy: 70.411 at epoch 3 
 best_stats: {'best_test_epoch': 3, 'best_test_valid/acc': 70.675, 'best_test_valid/acc_unbiased': 70.046, 'best_test_valid/diff': 8.13, 'best_test_valid/acc_skew': 65.981, 'best_test_valid/acc_align': 74.111, 'best_test_test/acc': 70.802, 'best_test_test/acc_unbiased': 70.411, 'best_test_test/diff': 6.636, 'best_test_test/acc_skew': 67.093, 'best_test_test/acc_align': 73.729}
[5 / 20] Learning rate: 0.001 weight: 0.01
[5 / 20] Loss: 4.8280164354193085 CE Loss: 0.5525335127577775 Con Loss: 4.822491078216196
[5 / 20] tensor([[0.330, 0.297],
        [0.965, 0.941]]) {'epoch': 5, 'valid/acc': 60.759, 'valid/acc_unbiased': 63.206, 'valid/diff': 3.286, 'valid/acc_skew': 62.43, 'valid/acc_align': 63.981, 'test/acc': 61.772, 'test/acc_unbiased': 63.314, 'test/diff': 2.883, 'test/acc_skew': 63.113, 'test/acc_align': 63.516}
[5 / 20] best valid accuracy: 70.046 at epoch 3 
 best_stats: {'best_valid_epoch': 3, 'best_valid_valid/acc': 70.675, 'best_valid_valid/acc_unbiased': 70.046, 'best_valid_valid/diff': 8.13, 'best_valid_valid/acc_skew': 65.981, 'best_valid_valid/acc_align': 74.111, 'best_valid_test/acc': 70.802, 'best_valid_test/acc_unbiased': 70.411, 'best_valid_test/diff': 6.636, 'best_valid_test/acc_skew': 67.093, 'best_valid_test/acc_align': 73.729}
[5 / 20] best test accuracy: 70.411 at epoch 3 
 best_stats: {'best_test_epoch': 3, 'best_test_valid/acc': 70.675, 'best_test_valid/acc_unbiased': 70.046, 'best_test_valid/diff': 8.13, 'best_test_valid/acc_skew': 65.981, 'best_test_valid/acc_align': 74.111, 'best_test_test/acc': 70.802, 'best_test_test/acc_unbiased': 70.411, 'best_test_test/diff': 6.636, 'best_test_test/acc_skew': 67.093, 'best_test_test/acc_align': 73.729}
[6 / 20] Learning rate: 0.001 weight: 0.01
[6 / 20] Loss: 4.828680726829071 CE Loss: 0.560195981932594 Con Loss: 4.823078765701585
[6 / 20] tensor([[0.668, 0.598],
        [0.838, 0.842]]) {'epoch': 6, 'valid/acc': 72.785, 'valid/acc_unbiased': 73.658, 'valid/diff': 3.861, 'valid/acc_skew': 71.728, 'valid/acc_align': 75.589, 'test/acc': 73.08, 'test/acc_unbiased': 73.671, 'test/diff': 3.753, 'test/acc_skew': 71.794, 'test/acc_align': 75.548}
[6 / 20] best valid accuracy: 73.658 at epoch 6 
 best_stats: {'best_valid_epoch': 6, 'best_valid_valid/acc': 72.785, 'best_valid_valid/acc_unbiased': 73.658, 'best_valid_valid/diff': 3.861, 'best_valid_valid/acc_skew': 71.728, 'best_valid_valid/acc_align': 75.589, 'best_valid_test/acc': 73.08, 'best_valid_test/acc_unbiased': 73.671, 'best_valid_test/diff': 3.753, 'best_valid_test/acc_skew': 71.794, 'best_valid_test/acc_align': 75.548}
[6 / 20] best test accuracy: 73.671 at epoch 6 
 best_stats: {'best_test_epoch': 6, 'best_test_valid/acc': 72.785, 'best_test_valid/acc_unbiased': 73.658, 'best_test_valid/diff': 3.861, 'best_test_valid/acc_skew': 71.728, 'best_test_valid/acc_align': 75.589, 'best_test_test/acc': 73.08, 'best_test_test/acc_unbiased': 73.671, 'best_test_test/diff': 3.753, 'best_test_test/acc_skew': 71.794, 'best_test_test/acc_align': 75.548}
[7 / 20] Learning rate: 0.0001 weight: 0.01
[7 / 20] Loss: 4.811183083284303 CE Loss: 0.5198198533337427 Con Loss: 4.805984869882966
[7 / 20] tensor([[0.821, 0.727],
        [0.760, 0.798]]) {'epoch': 7, 'valid/acc': 75.781, 'valid/acc_unbiased': 75.751, 'valid/diff': 5.026, 'valid/acc_skew': 73.238, 'valid/acc_align': 78.264, 'test/acc': 77.553, 'test/acc_unbiased': 77.63, 'test/diff': 6.612, 'test/acc_skew': 74.324, 'test/acc_align': 80.935}
[7 / 20] best valid accuracy: 75.751 at epoch 7 
 best_stats: {'best_valid_epoch': 7, 'best_valid_valid/acc': 75.781, 'best_valid_valid/acc_unbiased': 75.751, 'best_valid_valid/diff': 5.026, 'best_valid_valid/acc_skew': 73.238, 'best_valid_valid/acc_align': 78.264, 'best_valid_test/acc': 77.553, 'best_valid_test/acc_unbiased': 77.63, 'best_valid_test/diff': 6.612, 'best_valid_test/acc_skew': 74.324, 'best_valid_test/acc_align': 80.935}
[7 / 20] best test accuracy: 77.630 at epoch 7 
 best_stats: {'best_test_epoch': 7, 'best_test_valid/acc': 75.781, 'best_test_valid/acc_unbiased': 75.751, 'best_test_valid/diff': 5.026, 'best_test_valid/acc_skew': 73.238, 'best_test_valid/acc_align': 78.264, 'best_test_test/acc': 77.553, 'best_test_test/acc_unbiased': 77.63, 'best_test_test/diff': 6.612, 'best_test_test/acc_skew': 74.324, 'best_test_test/acc_align': 80.935}
[8 / 20] Learning rate: 0.0001 weight: 0.01
[8 / 20] Loss: 4.79307301815921 CE Loss: 0.492479926234283 Con Loss: 4.788148223044757
[8 / 20] tensor([[0.799, 0.697],
        [0.794, 0.822]]) {'epoch': 8, 'valid/acc': 76.54, 'valid/acc_unbiased': 76.657, 'valid/diff': 6.26, 'valid/acc_skew': 73.527, 'valid/acc_align': 79.787, 'test/acc': 77.553, 'test/acc_unbiased': 77.814, 'test/diff': 6.471, 'test/acc_skew': 74.578, 'test/acc_align': 81.049}
[8 / 20] best valid accuracy: 76.657 at epoch 8 
 best_stats: {'best_valid_epoch': 8, 'best_valid_valid/acc': 76.54, 'best_valid_valid/acc_unbiased': 76.657, 'best_valid_valid/diff': 6.26, 'best_valid_valid/acc_skew': 73.527, 'best_valid_valid/acc_align': 79.787, 'best_valid_test/acc': 77.553, 'best_valid_test/acc_unbiased': 77.814, 'best_valid_test/diff': 6.471, 'best_valid_test/acc_skew': 74.578, 'best_valid_test/acc_align': 81.049}
[8 / 20] best test accuracy: 77.814 at epoch 8 
 best_stats: {'best_test_epoch': 8, 'best_test_valid/acc': 76.54, 'best_test_valid/acc_unbiased': 76.657, 'best_test_valid/diff': 6.26, 'best_test_valid/acc_skew': 73.527, 'best_test_valid/acc_align': 79.787, 'best_test_test/acc': 77.553, 'best_test_test/acc_unbiased': 77.814, 'best_test_test/diff': 6.471, 'best_test_test/acc_skew': 74.578, 'best_test_test/acc_align': 81.049}
[9 / 20] Learning rate: 0.0001 weight: 0.01
[9 / 20] Loss: 4.78908517734198 CE Loss: 0.47469281216491543 Con Loss: 4.784338255752407
[9 / 20] tensor([[0.762, 0.634],
        [0.844, 0.869]]) {'epoch': 9, 'valid/acc': 76.751, 'valid/acc_unbiased': 77.515, 'valid/diff': 6.459, 'valid/acc_skew': 74.285, 'valid/acc_align': 80.745, 'test/acc': 77.173, 'test/acc_unbiased': 77.718, 'test/diff': 7.653, 'test/acc_skew': 73.892, 'test/acc_align': 81.545}
[9 / 20] best valid accuracy: 77.515 at epoch 9 
 best_stats: {'best_valid_epoch': 9, 'best_valid_valid/acc': 76.751, 'best_valid_valid/acc_unbiased': 77.515, 'best_valid_valid/diff': 6.459, 'best_valid_valid/acc_skew': 74.285, 'best_valid_valid/acc_align': 80.745, 'best_valid_test/acc': 77.173, 'best_valid_test/acc_unbiased': 77.718, 'best_valid_test/diff': 7.653, 'best_valid_test/acc_skew': 73.892, 'best_valid_test/acc_align': 81.545}
[9 / 20] best test accuracy: 77.814 at epoch 8 
 best_stats: {'best_test_epoch': 8, 'best_test_valid/acc': 76.54, 'best_test_valid/acc_unbiased': 76.657, 'best_test_valid/diff': 6.26, 'best_test_valid/acc_skew': 73.527, 'best_test_valid/acc_align': 79.787, 'best_test_test/acc': 77.553, 'best_test_test/acc_unbiased': 77.814, 'best_test_test/diff': 6.471, 'best_test_test/acc_skew': 74.578, 'best_test_test/acc_align': 81.049}
[10 / 20] Learning rate: 0.0001 weight: 0.01
[10 / 20] Loss: 4.763869290470553 CE Loss: 0.46779074440239815 Con Loss: 4.759191377620223
[10 / 20] tensor([[0.781, 0.684],
        [0.825, 0.859]]) {'epoch': 10, 'valid/acc': 76.793, 'valid/acc_unbiased': 77.223, 'valid/diff': 7.107, 'valid/acc_skew': 73.669, 'valid/acc_align': 80.776, 'test/acc': 78.397, 'test/acc_unbiased': 78.719, 'test/diff': 6.581, 'test/acc_skew': 75.429, 'test/acc_align': 82.01}
[10 / 20] best valid accuracy: 77.515 at epoch 9 
 best_stats: {'best_valid_epoch': 9, 'best_valid_valid/acc': 76.751, 'best_valid_valid/acc_unbiased': 77.515, 'best_valid_valid/diff': 6.459, 'best_valid_valid/acc_skew': 74.285, 'best_valid_valid/acc_align': 80.745, 'best_valid_test/acc': 77.173, 'best_valid_test/acc_unbiased': 77.718, 'best_valid_test/diff': 7.653, 'best_valid_test/acc_skew': 73.892, 'best_valid_test/acc_align': 81.545}
[10 / 20] best test accuracy: 78.719 at epoch 10 
 best_stats: {'best_test_epoch': 10, 'best_test_valid/acc': 76.793, 'best_test_valid/acc_unbiased': 77.223, 'best_test_valid/diff': 7.107, 'best_test_valid/acc_skew': 73.669, 'best_test_valid/acc_align': 80.776, 'best_test_test/acc': 78.397, 'best_test_test/acc_unbiased': 78.719, 'best_test_test/diff': 6.581, 'best_test_test/acc_skew': 75.429, 'best_test_test/acc_align': 82.01}
[11 / 20] Learning rate: 0.0001 weight: 0.01
[11 / 20] Loss: 4.7677501375469244 CE Loss: 0.46140040123445225 Con Loss: 4.76313613204621
[11 / 20] tensor([[0.749, 0.665],
        [0.844, 0.874]]) {'epoch': 11, 'valid/acc': 76.16, 'valid/acc_unbiased': 76.839, 'valid/diff': 7.079, 'valid/acc_skew': 73.3, 'valid/acc_align': 80.379, 'test/acc': 77.89, 'test/acc_unbiased': 78.291, 'test/diff': 5.698, 'test/acc_skew': 75.443, 'test/acc_align': 81.14}
[11 / 20] best valid accuracy: 77.515 at epoch 9 
 best_stats: {'best_valid_epoch': 9, 'best_valid_valid/acc': 76.751, 'best_valid_valid/acc_unbiased': 77.515, 'best_valid_valid/diff': 6.459, 'best_valid_valid/acc_skew': 74.285, 'best_valid_valid/acc_align': 80.745, 'best_valid_test/acc': 77.173, 'best_valid_test/acc_unbiased': 77.718, 'best_valid_test/diff': 7.653, 'best_valid_test/acc_skew': 73.892, 'best_valid_test/acc_align': 81.545}
[11 / 20] best test accuracy: 78.719 at epoch 10 
 best_stats: {'best_test_epoch': 10, 'best_test_valid/acc': 76.793, 'best_test_valid/acc_unbiased': 77.223, 'best_test_valid/diff': 7.107, 'best_test_valid/acc_skew': 73.669, 'best_test_valid/acc_align': 80.776, 'best_test_test/acc': 78.397, 'best_test_test/acc_unbiased': 78.719, 'best_test_test/diff': 6.581, 'best_test_test/acc_skew': 75.429, 'best_test_test/acc_align': 82.01}
[12 / 20] Learning rate: 0.0001 weight: 0.01
[12 / 20] Loss: 4.759560952947569 CE Loss: 0.4587503946979433 Con Loss: 4.75497339899334
[12 / 20] tensor([[0.801, 0.724],
        [0.810, 0.847]]) {'epoch': 12, 'valid/acc': 77.131, 'valid/acc_unbiased': 77.319, 'valid/diff': 8.098, 'valid/acc_skew': 73.27, 'valid/acc_align': 81.368, 'test/acc': 79.367, 'test/acc_unbiased': 79.533, 'test/diff': 5.736, 'test/acc_skew': 76.665, 'test/acc_align': 82.401}
[12 / 20] best valid accuracy: 77.515 at epoch 9 
 best_stats: {'best_valid_epoch': 9, 'best_valid_valid/acc': 76.751, 'best_valid_valid/acc_unbiased': 77.515, 'best_valid_valid/diff': 6.459, 'best_valid_valid/acc_skew': 74.285, 'best_valid_valid/acc_align': 80.745, 'best_valid_test/acc': 77.173, 'best_valid_test/acc_unbiased': 77.718, 'best_valid_test/diff': 7.653, 'best_valid_test/acc_skew': 73.892, 'best_valid_test/acc_align': 81.545}
[12 / 20] best test accuracy: 79.533 at epoch 12 
 best_stats: {'best_test_epoch': 12, 'best_test_valid/acc': 77.131, 'best_test_valid/acc_unbiased': 77.319, 'best_test_valid/diff': 8.098, 'best_test_valid/acc_skew': 73.27, 'best_test_valid/acc_align': 81.368, 'best_test_test/acc': 79.367, 'best_test_test/acc_unbiased': 79.533, 'best_test_test/diff': 5.736, 'best_test_test/acc_skew': 76.665, 'best_test_test/acc_align': 82.401}
[13 / 20] Learning rate: 0.0001 weight: 0.01
[13 / 20] Loss: 4.753918177212315 CE Loss: 0.45011420742135444 Con Loss: 4.749417026430412
[13 / 20] tensor([[0.776, 0.648],
        [0.857, 0.887]]) {'epoch': 13, 'valid/acc': 77.046, 'valid/acc_unbiased': 77.635, 'valid/diff': 9.471, 'valid/acc_skew': 72.899, 'valid/acc_align': 82.37, 'test/acc': 78.692, 'test/acc_unbiased': 79.216, 'test/diff': 7.873, 'test/acc_skew': 75.28, 'test/acc_align': 83.153}
[13 / 20] best valid accuracy: 77.635 at epoch 13 
 best_stats: {'best_valid_epoch': 13, 'best_valid_valid/acc': 77.046, 'best_valid_valid/acc_unbiased': 77.635, 'best_valid_valid/diff': 9.471, 'best_valid_valid/acc_skew': 72.899, 'best_valid_valid/acc_align': 82.37, 'best_valid_test/acc': 78.692, 'best_valid_test/acc_unbiased': 79.216, 'best_valid_test/diff': 7.873, 'best_valid_test/acc_skew': 75.28, 'best_valid_test/acc_align': 83.153}
[13 / 20] best test accuracy: 79.533 at epoch 12 
 best_stats: {'best_test_epoch': 12, 'best_test_valid/acc': 77.131, 'best_test_valid/acc_unbiased': 77.319, 'best_test_valid/diff': 8.098, 'best_test_valid/acc_skew': 73.27, 'best_test_valid/acc_align': 81.368, 'best_test_test/acc': 79.367, 'best_test_test/acc_unbiased': 79.533, 'best_test_test/diff': 5.736, 'best_test_test/acc_skew': 76.665, 'best_test_test/acc_align': 82.401}
[14 / 20] Learning rate: 1e-05 weight: 0.01
[14 / 20] Loss: 4.748168950897708 CE Loss: 0.4451482998504471 Con Loss: 4.743717457504608
[14 / 20] tensor([[0.797, 0.694],
        [0.835, 0.868]]) {'epoch': 14, 'valid/acc': 77.384, 'valid/acc_unbiased': 77.749, 'valid/diff': 9.476, 'valid/acc_skew': 73.012, 'valid/acc_align': 82.487, 'test/acc': 79.536, 'test/acc_unbiased': 79.875, 'test/diff': 6.776, 'test/acc_skew': 76.487, 'test/acc_align': 83.262}
[14 / 20] best valid accuracy: 77.749 at epoch 14 
 best_stats: {'best_valid_epoch': 14, 'best_valid_valid/acc': 77.384, 'best_valid_valid/acc_unbiased': 77.749, 'best_valid_valid/diff': 9.476, 'best_valid_valid/acc_skew': 73.012, 'best_valid_valid/acc_align': 82.487, 'best_valid_test/acc': 79.536, 'best_valid_test/acc_unbiased': 79.875, 'best_valid_test/diff': 6.776, 'best_valid_test/acc_skew': 76.487, 'best_valid_test/acc_align': 83.262}
[14 / 20] best test accuracy: 79.875 at epoch 14 
 best_stats: {'best_test_epoch': 14, 'best_test_valid/acc': 77.384, 'best_test_valid/acc_unbiased': 77.749, 'best_test_valid/diff': 9.476, 'best_test_valid/acc_skew': 73.012, 'best_test_valid/acc_align': 82.487, 'best_test_test/acc': 79.536, 'best_test_test/acc_unbiased': 79.875, 'best_test_test/diff': 6.776, 'best_test_test/acc_skew': 76.487, 'best_test_test/acc_align': 83.262}
[15 / 20] Learning rate: 1e-05 weight: 0.01
[15 / 20] Loss: 4.749072448400941 CE Loss: 0.4378638077270932 Con Loss: 4.744693809162994
[15 / 20] tensor([[0.801, 0.699],
        [0.829, 0.868]]) {'epoch': 15, 'valid/acc': 77.553, 'valid/acc_unbiased': 77.875, 'valid/diff': 9.069, 'valid/acc_skew': 73.341, 'valid/acc_align': 82.41, 'test/acc': 79.62, 'test/acc_unbiased': 79.913, 'test/diff': 7.058, 'test/acc_skew': 76.384, 'test/acc_align': 83.442}
[15 / 20] best valid accuracy: 77.875 at epoch 15 
 best_stats: {'best_valid_epoch': 15, 'best_valid_valid/acc': 77.553, 'best_valid_valid/acc_unbiased': 77.875, 'best_valid_valid/diff': 9.069, 'best_valid_valid/acc_skew': 73.341, 'best_valid_valid/acc_align': 82.41, 'best_valid_test/acc': 79.62, 'best_valid_test/acc_unbiased': 79.913, 'best_valid_test/diff': 7.058, 'best_valid_test/acc_skew': 76.384, 'best_valid_test/acc_align': 83.442}
[15 / 20] best test accuracy: 79.913 at epoch 15 
 best_stats: {'best_test_epoch': 15, 'best_test_valid/acc': 77.553, 'best_test_valid/acc_unbiased': 77.875, 'best_test_valid/diff': 9.069, 'best_test_valid/acc_skew': 73.341, 'best_test_valid/acc_align': 82.41, 'best_test_test/acc': 79.62, 'best_test_test/acc_unbiased': 79.913, 'best_test_test/diff': 7.058, 'best_test_test/acc_skew': 76.384, 'best_test_test/acc_align': 83.442}
[16 / 20] Learning rate: 1e-05 weight: 0.01
[16 / 20] Loss: 4.740302497087425 CE Loss: 0.4428486471469371 Con Loss: 4.7358740098654435
[16 / 20] tensor([[0.796, 0.688],
        [0.833, 0.875]]) {'epoch': 16, 'valid/acc': 77.468, 'valid/acc_unbiased': 77.862, 'valid/diff': 9.338, 'valid/acc_skew': 73.194, 'valid/acc_align': 82.531, 'test/acc': 79.494, 'test/acc_unbiased': 79.814, 'test/diff': 7.461, 'test/acc_skew': 76.083, 'test/acc_align': 83.544}
[16 / 20] best valid accuracy: 77.875 at epoch 15 
 best_stats: {'best_valid_epoch': 15, 'best_valid_valid/acc': 77.553, 'best_valid_valid/acc_unbiased': 77.875, 'best_valid_valid/diff': 9.069, 'best_valid_valid/acc_skew': 73.341, 'best_valid_valid/acc_align': 82.41, 'best_valid_test/acc': 79.62, 'best_valid_test/acc_unbiased': 79.913, 'best_valid_test/diff': 7.058, 'best_valid_test/acc_skew': 76.384, 'best_valid_test/acc_align': 83.442}
[16 / 20] best test accuracy: 79.913 at epoch 15 
 best_stats: {'best_test_epoch': 15, 'best_test_valid/acc': 77.553, 'best_test_valid/acc_unbiased': 77.875, 'best_test_valid/diff': 9.069, 'best_test_valid/acc_skew': 73.341, 'best_test_valid/acc_align': 82.41, 'best_test_test/acc': 79.62, 'best_test_test/acc_unbiased': 79.913, 'best_test_test/diff': 7.058, 'best_test_test/acc_skew': 76.384, 'best_test_test/acc_align': 83.442}
[17 / 20] Learning rate: 1e-05 weight: 0.01
[17 / 20] Loss: 4.74032220100414 CE Loss: 0.43760362049322005 Con Loss: 4.735946139339822
[17 / 20] tensor([[0.801, 0.699],
        [0.840, 0.880]]) {'epoch': 17, 'valid/acc': 78.059, 'valid/acc_unbiased': 78.427, 'valid/diff': 8.275, 'valid/acc_skew': 74.29, 'valid/acc_align': 82.565, 'test/acc': 80.169, 'test/acc_unbiased': 80.48, 'test/diff': 7.111, 'test/acc_skew': 76.925, 'test/acc_align': 84.036}
[17 / 20] best valid accuracy: 78.427 at epoch 17 
 best_stats: {'best_valid_epoch': 17, 'best_valid_valid/acc': 78.059, 'best_valid_valid/acc_unbiased': 78.427, 'best_valid_valid/diff': 8.275, 'best_valid_valid/acc_skew': 74.29, 'best_valid_valid/acc_align': 82.565, 'best_valid_test/acc': 80.169, 'best_valid_test/acc_unbiased': 80.48, 'best_valid_test/diff': 7.111, 'best_valid_test/acc_skew': 76.925, 'best_valid_test/acc_align': 84.036}
[17 / 20] best test accuracy: 80.480 at epoch 17 
 best_stats: {'best_test_epoch': 17, 'best_test_valid/acc': 78.059, 'best_test_valid/acc_unbiased': 78.427, 'best_test_valid/diff': 8.275, 'best_test_valid/acc_skew': 74.29, 'best_test_valid/acc_align': 82.565, 'best_test_test/acc': 80.169, 'best_test_test/acc_unbiased': 80.48, 'best_test_test/diff': 7.111, 'best_test_test/acc_skew': 76.925, 'best_test_test/acc_align': 84.036}
[18 / 20] Learning rate: 1e-05 weight: 0.01
[18 / 20] Loss: 4.743226856996863 CE Loss: 0.44510781529358157 Con Loss: 4.738775800646311
[18 / 20] tensor([[0.808, 0.709],
        [0.840, 0.865]]) {'epoch': 18, 'valid/acc': 78.481, 'valid/acc_unbiased': 78.816, 'valid/diff': 8.029, 'valid/acc_skew': 74.801, 'valid/acc_align': 82.83, 'test/acc': 80.211, 'test/acc_unbiased': 80.547, 'test/diff': 6.21, 'test/acc_skew': 77.442, 'test/acc_align': 83.651}
[18 / 20] best valid accuracy: 78.816 at epoch 18 
 best_stats: {'best_valid_epoch': 18, 'best_valid_valid/acc': 78.481, 'best_valid_valid/acc_unbiased': 78.816, 'best_valid_valid/diff': 8.029, 'best_valid_valid/acc_skew': 74.801, 'best_valid_valid/acc_align': 82.83, 'best_valid_test/acc': 80.211, 'best_valid_test/acc_unbiased': 80.547, 'best_valid_test/diff': 6.21, 'best_valid_test/acc_skew': 77.442, 'best_valid_test/acc_align': 83.651}
[18 / 20] best test accuracy: 80.547 at epoch 18 
 best_stats: {'best_test_epoch': 18, 'best_test_valid/acc': 78.481, 'best_test_valid/acc_unbiased': 78.816, 'best_test_valid/diff': 8.029, 'best_test_valid/acc_skew': 74.801, 'best_test_valid/acc_align': 82.83, 'best_test_test/acc': 80.211, 'best_test_test/acc_unbiased': 80.547, 'best_test_test/diff': 6.21, 'best_test_test/acc_skew': 77.442, 'best_test_test/acc_align': 83.651}
[19 / 20] Learning rate: 1e-05 weight: 0.01
[19 / 20] Loss: 4.7446887007918574 CE Loss: 0.43505598523955397 Con Loss: 4.740338160736844
[19 / 20] tensor([[0.799, 0.705],
        [0.838, 0.877]]) {'epoch': 19, 'valid/acc': 77.764, 'valid/acc_unbiased': 78.108, 'valid/diff': 8.586, 'valid/acc_skew': 73.815, 'valid/acc_align': 82.402, 'test/acc': 80.169, 'test/acc_unbiased': 80.455, 'test/diff': 6.686, 'test/acc_skew': 77.112, 'test/acc_align': 83.798}
[19 / 20] best valid accuracy: 78.816 at epoch 18 
 best_stats: {'best_valid_epoch': 18, 'best_valid_valid/acc': 78.481, 'best_valid_valid/acc_unbiased': 78.816, 'best_valid_valid/diff': 8.029, 'best_valid_valid/acc_skew': 74.801, 'best_valid_valid/acc_align': 82.83, 'best_valid_test/acc': 80.211, 'best_valid_test/acc_unbiased': 80.547, 'best_valid_test/diff': 6.21, 'best_valid_test/acc_skew': 77.442, 'best_valid_test/acc_align': 83.651}
[19 / 20] best test accuracy: 80.547 at epoch 18 
 best_stats: {'best_test_epoch': 18, 'best_test_valid/acc': 78.481, 'best_test_valid/acc_unbiased': 78.816, 'best_test_valid/diff': 8.029, 'best_test_valid/acc_skew': 74.801, 'best_test_valid/acc_align': 82.83, 'best_test_test/acc': 80.211, 'best_test_test/acc_unbiased': 80.547, 'best_test_test/diff': 6.21, 'best_test_test/acc_skew': 77.442, 'best_test_test/acc_align': 83.651}
[20 / 20] Learning rate: 1e-05 weight: 0.01
[20 / 20] Loss: 4.735945651332247 CE Loss: 0.4357906169371235 Con Loss: 4.731587759048663
[20 / 20] tensor([[0.790, 0.702],
        [0.840, 0.877]]) {'epoch': 20, 'valid/acc': 78.059, 'valid/acc_unbiased': 78.435, 'valid/diff': 8.072, 'valid/acc_skew': 74.399, 'valid/acc_align': 82.471, 'test/acc': 79.916, 'test/acc_unbiased': 80.211, 'test/diff': 6.277, 'test/acc_skew': 77.073, 'test/acc_align': 83.35}
[20 / 20] best valid accuracy: 78.816 at epoch 18 
 best_stats: {'best_valid_epoch': 18, 'best_valid_valid/acc': 78.481, 'best_valid_valid/acc_unbiased': 78.816, 'best_valid_valid/diff': 8.029, 'best_valid_valid/acc_skew': 74.801, 'best_valid_valid/acc_align': 82.83, 'best_valid_test/acc': 80.211, 'best_valid_test/acc_unbiased': 80.547, 'best_valid_test/diff': 6.21, 'best_valid_test/acc_skew': 77.442, 'best_valid_test/acc_align': 83.651}
[20 / 20] best test accuracy: 80.547 at epoch 18 
 best_stats: {'best_test_epoch': 18, 'best_test_valid/acc': 78.481, 'best_test_valid/acc_unbiased': 78.816, 'best_test_valid/diff': 8.029, 'best_test_valid/acc_skew': 74.801, 'best_test_valid/acc_align': 82.83, 'best_test_test/acc': 80.211, 'best_test_test/acc_unbiased': 80.547, 'best_test_test/diff': 6.21, 'best_test_test/acc_skew': 77.442, 'best_test_test/acc_align': 83.651}
Total training time: 0:17:17
