Log level set to: INFO
Set seed: 2
=======> Using Fixed Random Seed: 2 <========
save_path: exp_results/bc-bb0-celeba_black-crop_trival-lr0.001-bs128-cbs64-w0.01-ratio30-aug1-seed2
get_celeba - split:train, aug: False, given_y: True, ratio: 0
use existing black indices from data/celeba/pickles/black
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [60774, 38396]
Target 1: [8027, 15991]
Binary Target 1
---------------------------
Target 0: [60774, 38396]
Target 1: [8027, 15991]
===================================
Normal Label Distribution: 
Target 0: [60774, 38396]
Target 1: [8027, 15991]
===================================
Use BiasedCelebASplit 
 target_attr: black split: train 
 tensor([[60774.,  8027.],
        [38396., 15991.]])
get_celeba - split:train, aug: 1, given_y: True, ratio: 30
use existing black indices from data/celeba/pickles/black
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [60435, 38588]
Target 1: [7963, 16202]
Binary Target 1
---------------------------
Target 0: [60435, 38588]
Target 1: [7963, 16202]
===================================
Normal Label Distribution: 
Target 0: [60435, 38588]
Target 1: [7963, 16202]
===================================
Use BiasedCelebASplit 
 target_attr: black split: train 
 tensor([[60435.,  7963.],
        [38588., 16202.]])
get_celeba - split:train_valid, aug: False, given_y: True, ratio: 0
use existing black indices from data/celeba/pickles/black
Use BiasedCelebASplit 
 target_attr: black split: train_valid 
 tensor([[15020.,  1991.],
        [ 9642.,  4145.]])
get_celeba - split:valid, aug: False, given_y: True, ratio: 0
Use BiasedCelebASplit 
 target_attr: black split: valid 
 tensor([[9752., 1657.],
        [5971., 2487.]])
decay_epochs: [3, 6]
[1 / 10] Learning rate: 0.001 weight: 0.01
[1 / 10] Loss: 4.821196094179988 CE Loss: 0.3193478344347809 Con Loss: 4.818002612148666
[1 / 10] tensor([[0.957, 0.953],
        [0.431, 0.465]]) {'epoch': 1, 'valid/acc': 84.947, 'valid/acc_unbiased': 68.038, 'valid/diff': 0.627, 'valid/acc_skew': 67.898, 'valid/acc_align': 68.179, 'test/acc': 85.035, 'test/acc_unbiased': 70.152, 'test/diff': 1.921, 'test/acc_skew': 69.192, 'test/acc_align': 71.113}
[1 / 10] best valid accuracy: 68.038 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 84.947, 'best_valid_valid/acc_unbiased': 68.038, 'best_valid_valid/diff': 0.627, 'best_valid_valid/acc_skew': 67.898, 'best_valid_valid/acc_align': 68.179, 'best_valid_test/acc': 85.035, 'best_valid_test/acc_unbiased': 70.152, 'best_valid_test/diff': 1.921, 'best_valid_test/acc_skew': 69.192, 'best_valid_test/acc_align': 71.113}
[1 / 10] best test accuracy: 70.152 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 84.947, 'best_test_valid/acc_unbiased': 68.038, 'best_test_valid/diff': 0.627, 'best_test_valid/acc_skew': 67.898, 'best_test_valid/acc_align': 68.179, 'best_test_test/acc': 85.035, 'best_test_test/acc_unbiased': 70.152, 'best_test_test/diff': 1.921, 'best_test_test/acc_skew': 69.192, 'best_test_test/acc_align': 71.113}
[2 / 10] Learning rate: 0.001 weight: 0.01
[2 / 10] Loss: 4.808913197792842 CE Loss: 0.2849525927086405 Con Loss: 4.806063668636601
[2 / 10] tensor([[0.876, 0.813],
        [0.890, 0.874]]) {'epoch': 2, 'valid/acc': 85.32, 'valid/acc_unbiased': 85.629, 'valid/diff': 4.028, 'valid/acc_skew': 84.937, 'valid/acc_align': 86.321, 'test/acc': 85.765, 'test/acc_unbiased': 86.31, 'test/diff': 3.947, 'test/acc_skew': 85.138, 'test/acc_align': 87.483}
[2 / 10] best valid accuracy: 85.629 at epoch 2 
 best_stats: {'best_valid_epoch': 2, 'best_valid_valid/acc': 85.32, 'best_valid_valid/acc_unbiased': 85.629, 'best_valid_valid/diff': 4.028, 'best_valid_valid/acc_skew': 84.937, 'best_valid_valid/acc_align': 86.321, 'best_valid_test/acc': 85.765, 'best_valid_test/acc_unbiased': 86.31, 'best_valid_test/diff': 3.947, 'best_valid_test/acc_skew': 85.138, 'best_valid_test/acc_align': 87.483}
[2 / 10] best test accuracy: 86.310 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 85.32, 'best_test_valid/acc_unbiased': 85.629, 'best_test_valid/diff': 4.028, 'best_test_valid/acc_skew': 84.937, 'best_test_valid/acc_align': 86.321, 'best_test_test/acc': 85.765, 'best_test_test/acc_unbiased': 86.31, 'best_test_test/diff': 3.947, 'best_test_test/acc_skew': 85.138, 'best_test_test/acc_align': 87.483}
[3 / 10] Learning rate: 0.001 weight: 0.01
[3 / 10] Loss: 4.801646728223302 CE Loss: 0.27627807836155266 Con Loss: 4.798883947230053
[3 / 10] tensor([[0.925, 0.897],
        [0.826, 0.755]]) {'epoch': 3, 'valid/acc': 88.054, 'valid/acc_unbiased': 83.639, 'valid/diff': 5.339, 'valid/acc_skew': 85.459, 'valid/acc_align': 81.818, 'test/acc': 88.715, 'test/acc_unbiased': 85.072, 'test/diff': 4.949, 'test/acc_skew': 86.121, 'test/acc_align': 84.024}
[3 / 10] best valid accuracy: 85.629 at epoch 2 
 best_stats: {'best_valid_epoch': 2, 'best_valid_valid/acc': 85.32, 'best_valid_valid/acc_unbiased': 85.629, 'best_valid_valid/diff': 4.028, 'best_valid_valid/acc_skew': 84.937, 'best_valid_valid/acc_align': 86.321, 'best_valid_test/acc': 85.765, 'best_valid_test/acc_unbiased': 86.31, 'best_valid_test/diff': 3.947, 'best_valid_test/acc_skew': 85.138, 'best_valid_test/acc_align': 87.483}
[3 / 10] best test accuracy: 86.310 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 85.32, 'best_test_valid/acc_unbiased': 85.629, 'best_test_valid/diff': 4.028, 'best_test_valid/acc_skew': 84.937, 'best_test_valid/acc_align': 86.321, 'best_test_test/acc': 85.765, 'best_test_test/acc_unbiased': 86.31, 'best_test_test/diff': 3.947, 'best_test_test/acc_skew': 85.138, 'best_test_test/acc_align': 87.483}
[4 / 10] Learning rate: 0.0001 weight: 0.01
[4 / 10] Loss: 4.775712211275192 CE Loss: 0.242485132911869 Con Loss: 4.7732873578410215
[4 / 10] tensor([[0.967, 0.940],
        [0.680, 0.693]]) {'epoch': 4, 'valid/acc': 89.675, 'valid/acc_unbiased': 80.349, 'valid/diff': 1.756, 'valid/acc_skew': 80.381, 'valid/acc_align': 80.318, 'test/acc': 90.034, 'test/acc_unbiased': 81.968, 'test/diff': 2.011, 'test/acc_skew': 80.962, 'test/acc_align': 82.974}
[4 / 10] best valid accuracy: 85.629 at epoch 2 
 best_stats: {'best_valid_epoch': 2, 'best_valid_valid/acc': 85.32, 'best_valid_valid/acc_unbiased': 85.629, 'best_valid_valid/diff': 4.028, 'best_valid_valid/acc_skew': 84.937, 'best_valid_valid/acc_align': 86.321, 'best_valid_test/acc': 85.765, 'best_valid_test/acc_unbiased': 86.31, 'best_valid_test/diff': 3.947, 'best_valid_test/acc_skew': 85.138, 'best_valid_test/acc_align': 87.483}
[4 / 10] best test accuracy: 86.310 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 85.32, 'best_test_valid/acc_unbiased': 85.629, 'best_test_valid/diff': 4.028, 'best_test_valid/acc_skew': 84.937, 'best_test_valid/acc_align': 86.321, 'best_test_test/acc': 85.765, 'best_test_test/acc_unbiased': 86.31, 'best_test_test/diff': 3.947, 'best_test_test/acc_skew': 85.138, 'best_test_test/acc_align': 87.483}
[5 / 10] Learning rate: 0.0001 weight: 0.01
[5 / 10] Loss: 4.769749284746678 CE Loss: 0.23460143059322763 Con Loss: 4.767403262588279
[5 / 10] tensor([[0.948, 0.904],
        [0.753, 0.766]]) {'epoch': 5, 'valid/acc': 89.895, 'valid/acc_unbiased': 83.968, 'valid/diff': 2.139, 'valid/acc_skew': 82.899, 'valid/acc_align': 85.038, 'test/acc': 89.566, 'test/acc_unbiased': 84.282, 'test/diff': 2.844, 'test/acc_skew': 82.86, 'test/acc_align': 85.704}
[5 / 10] best valid accuracy: 85.629 at epoch 2 
 best_stats: {'best_valid_epoch': 2, 'best_valid_valid/acc': 85.32, 'best_valid_valid/acc_unbiased': 85.629, 'best_valid_valid/diff': 4.028, 'best_valid_valid/acc_skew': 84.937, 'best_valid_valid/acc_align': 86.321, 'best_valid_test/acc': 85.765, 'best_valid_test/acc_unbiased': 86.31, 'best_valid_test/diff': 3.947, 'best_valid_test/acc_skew': 85.138, 'best_valid_test/acc_align': 87.483}
[5 / 10] best test accuracy: 86.310 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 85.32, 'best_test_valid/acc_unbiased': 85.629, 'best_test_valid/diff': 4.028, 'best_test_valid/acc_skew': 84.937, 'best_test_valid/acc_align': 86.321, 'best_test_test/acc': 85.765, 'best_test_test/acc_unbiased': 86.31, 'best_test_test/diff': 3.947, 'best_test_test/acc_skew': 85.138, 'best_test_test/acc_align': 87.483}
[6 / 10] Learning rate: 0.0001 weight: 0.01
[6 / 10] Loss: 4.765459261734223 CE Loss: 0.23122732565457718 Con Loss: 4.7631469899293455
[6 / 10] tensor([[0.951, 0.926],
        [0.778, 0.745]]) {'epoch': 6, 'valid/acc': 90.334, 'valid/acc_unbiased': 84.235, 'valid/diff': 3.327, 'valid/acc_skew': 85.237, 'valid/acc_align': 83.234, 'test/acc': 90.306, 'test/acc_unbiased': 84.985, 'test/diff': 2.899, 'test/acc_skew': 85.178, 'test/acc_align': 84.793}
[6 / 10] best valid accuracy: 85.629 at epoch 2 
 best_stats: {'best_valid_epoch': 2, 'best_valid_valid/acc': 85.32, 'best_valid_valid/acc_unbiased': 85.629, 'best_valid_valid/diff': 4.028, 'best_valid_valid/acc_skew': 84.937, 'best_valid_valid/acc_align': 86.321, 'best_valid_test/acc': 85.765, 'best_valid_test/acc_unbiased': 86.31, 'best_valid_test/diff': 3.947, 'best_valid_test/acc_skew': 85.138, 'best_valid_test/acc_align': 87.483}
[6 / 10] best test accuracy: 86.310 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 85.32, 'best_test_valid/acc_unbiased': 85.629, 'best_test_valid/diff': 4.028, 'best_test_valid/acc_skew': 84.937, 'best_test_valid/acc_align': 86.321, 'best_test_test/acc': 85.765, 'best_test_test/acc_unbiased': 86.31, 'best_test_test/diff': 3.947, 'best_test_test/acc_skew': 85.138, 'best_test_test/acc_align': 87.483}
[7 / 10] Learning rate: 1e-05 weight: 0.01
[7 / 10] Loss: 4.7637069202783175 CE Loss: 0.227926938565601 Con Loss: 4.761427649933901
[7 / 10] tensor([[0.964, 0.938],
        [0.716, 0.712]]) {'epoch': 7, 'valid/acc': 90.551, 'valid/acc_unbiased': 82.913, 'valid/diff': 2.211, 'valid/acc_skew': 83.181, 'valid/acc_align': 82.646, 'test/acc': 90.396, 'test/acc_unbiased': 83.24, 'test/diff': 1.506, 'test/acc_skew': 82.689, 'test/acc_align': 83.791}
[7 / 10] best valid accuracy: 85.629 at epoch 2 
 best_stats: {'best_valid_epoch': 2, 'best_valid_valid/acc': 85.32, 'best_valid_valid/acc_unbiased': 85.629, 'best_valid_valid/diff': 4.028, 'best_valid_valid/acc_skew': 84.937, 'best_valid_valid/acc_align': 86.321, 'best_valid_test/acc': 85.765, 'best_valid_test/acc_unbiased': 86.31, 'best_valid_test/diff': 3.947, 'best_valid_test/acc_skew': 85.138, 'best_valid_test/acc_align': 87.483}
[7 / 10] best test accuracy: 86.310 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 85.32, 'best_test_valid/acc_unbiased': 85.629, 'best_test_valid/diff': 4.028, 'best_test_valid/acc_skew': 84.937, 'best_test_valid/acc_align': 86.321, 'best_test_test/acc': 85.765, 'best_test_test/acc_unbiased': 86.31, 'best_test_test/diff': 3.947, 'best_test_test/acc_skew': 85.138, 'best_test_test/acc_align': 87.483}
[8 / 10] Learning rate: 1e-05 weight: 0.01
[8 / 10] Loss: 4.757557340127661 CE Loss: 0.2262172077196962 Con Loss: 4.75529516424905
[8 / 10] tensor([[0.964, 0.944],
        [0.701, 0.702]]) {'epoch': 8, 'valid/acc': 90.607, 'valid/acc_unbiased': 82.763, 'valid/diff': 2.796, 'valid/acc_skew': 83.537, 'valid/acc_align': 81.988, 'test/acc': 90.311, 'test/acc_unbiased': 82.774, 'test/diff': 1.016, 'test/acc_skew': 82.267, 'test/acc_align': 83.282}
[8 / 10] best valid accuracy: 85.629 at epoch 2 
 best_stats: {'best_valid_epoch': 2, 'best_valid_valid/acc': 85.32, 'best_valid_valid/acc_unbiased': 85.629, 'best_valid_valid/diff': 4.028, 'best_valid_valid/acc_skew': 84.937, 'best_valid_valid/acc_align': 86.321, 'best_valid_test/acc': 85.765, 'best_valid_test/acc_unbiased': 86.31, 'best_valid_test/diff': 3.947, 'best_valid_test/acc_skew': 85.138, 'best_valid_test/acc_align': 87.483}
[8 / 10] best test accuracy: 86.310 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 85.32, 'best_test_valid/acc_unbiased': 85.629, 'best_test_valid/diff': 4.028, 'best_test_valid/acc_skew': 84.937, 'best_test_valid/acc_align': 86.321, 'best_test_test/acc': 85.765, 'best_test_test/acc_unbiased': 86.31, 'best_test_test/diff': 3.947, 'best_test_test/acc_skew': 85.138, 'best_test_test/acc_align': 87.483}
[9 / 10] Learning rate: 1e-05 weight: 0.01
[9 / 10] Loss: 4.7524767537455626 CE Loss: 0.22460058276814393 Con Loss: 4.750230744902521
[9 / 10] tensor([[0.965, 0.945],
        [0.692, 0.699]]) {'epoch': 9, 'valid/acc': 90.629, 'valid/acc_unbiased': 82.583, 'valid/diff': 2.334, 'valid/acc_skew': 83.075, 'valid/acc_align': 82.091, 'test/acc': 90.27, 'test/acc_unbiased': 82.503, 'test/diff': 1.339, 'test/acc_skew': 81.834, 'test/acc_align': 83.173}
[9 / 10] best valid accuracy: 85.629 at epoch 2 
 best_stats: {'best_valid_epoch': 2, 'best_valid_valid/acc': 85.32, 'best_valid_valid/acc_unbiased': 85.629, 'best_valid_valid/diff': 4.028, 'best_valid_valid/acc_skew': 84.937, 'best_valid_valid/acc_align': 86.321, 'best_valid_test/acc': 85.765, 'best_valid_test/acc_unbiased': 86.31, 'best_valid_test/diff': 3.947, 'best_valid_test/acc_skew': 85.138, 'best_valid_test/acc_align': 87.483}
[9 / 10] best test accuracy: 86.310 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 85.32, 'best_test_valid/acc_unbiased': 85.629, 'best_test_valid/diff': 4.028, 'best_test_valid/acc_skew': 84.937, 'best_test_valid/acc_align': 86.321, 'best_test_test/acc': 85.765, 'best_test_test/acc_unbiased': 86.31, 'best_test_test/diff': 3.947, 'best_test_test/acc_skew': 85.138, 'best_test_test/acc_align': 87.483}
[10 / 10] Learning rate: 1e-05 weight: 0.01
[10 / 10] Loss: 4.758536296552407 CE Loss: 0.22439234476780495 Con Loss: 4.756292375933138
[10 / 10] tensor([[0.960, 0.932],
        [0.733, 0.734]]) {'epoch': 10, 'valid/acc': 90.74, 'valid/acc_unbiased': 83.922, 'valid/diff': 2.003, 'valid/acc_skew': 84.12, 'valid/acc_align': 83.725, 'test/acc': 90.431, 'test/acc_unbiased': 83.964, 'test/diff': 1.445, 'test/acc_skew': 83.241, 'test/acc_align': 84.686}
[10 / 10] best valid accuracy: 85.629 at epoch 2 
 best_stats: {'best_valid_epoch': 2, 'best_valid_valid/acc': 85.32, 'best_valid_valid/acc_unbiased': 85.629, 'best_valid_valid/diff': 4.028, 'best_valid_valid/acc_skew': 84.937, 'best_valid_valid/acc_align': 86.321, 'best_valid_test/acc': 85.765, 'best_valid_test/acc_unbiased': 86.31, 'best_valid_test/diff': 3.947, 'best_valid_test/acc_skew': 85.138, 'best_valid_test/acc_align': 87.483}
[10 / 10] best test accuracy: 86.310 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 85.32, 'best_test_valid/acc_unbiased': 85.629, 'best_test_valid/diff': 4.028, 'best_test_valid/acc_skew': 84.937, 'best_test_valid/acc_align': 86.321, 'best_test_test/acc': 85.765, 'best_test_test/acc_unbiased': 86.31, 'best_test_test/diff': 3.947, 'best_test_test/acc_skew': 85.138, 'best_test_test/acc_align': 87.483}
Total training time: 1:50:57
