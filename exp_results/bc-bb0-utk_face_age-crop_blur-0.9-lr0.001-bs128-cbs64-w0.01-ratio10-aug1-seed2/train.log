Log level set to: INFO
Set seed: 2
=======> Using Fixed Random Seed: 2 <========
save_path: exp_results/bc-bb0-utk_face_age-crop_blur-0.9-lr0.001-bs128-cbs64-w0.01-ratio10-aug1-seed2
get_utk_face - split: train, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_age-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
Binary Target 1
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Normal Label Distribution: 
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
Binary Target 1
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Normal Label Distribution: 
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 10684, target_attr: gender, bias_attr: age bias_rate: 0.9
['[train] target_0-bias_0: 8237', '[train] target_0-bias_1: 147', '[train] target_1-bias_0: 823', '[train] target_1-bias_1: 1477']
confusion_matrix - 
 original: tensor([[8237.,  823.],
        [ 147., 1477.]]), 
 normalized: tensor([[0.909, 0.091],
        [0.091, 0.909]]), 
 b|y: tensor([[0.982, 0.018],
        [0.358, 0.642]])
get_utk_face - split: train, aug: 1, given_y: True, ratio: 10
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_age-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
Binary Target 1
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Normal Label Distribution: 
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
Binary Target 1
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Normal Label Distribution: 
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 10684, target_attr: gender, bias_attr: age bias_rate: 0.9
['[train] target_0-bias_0: 8237', '[train] target_0-bias_1: 147', '[train] target_1-bias_0: 823', '[train] target_1-bias_1: 1477']
get_utk_face - split: valid, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_age-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [1030, 195]
Target 1: [841, 202]
Binary Target 1
---------------------------
Target 0: [1030, 195]
Target 1: [841, 202]
===================================
Normal Label Distribution: 
Target 0: [1030, 195]
Target 1: [841, 202]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 2268, target_attr: gender, bias_attr: age bias_rate: 0.9
['[valid] target_0-bias_0: 1030', '[valid] target_0-bias_1: 195', '[valid] target_1-bias_0: 841', '[valid] target_1-bias_1: 202']
get_utk_face - split: test, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_age-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [1061, 176]
Target 1: [867, 165]
Binary Target 1
---------------------------
Target 0: [1061, 176]
Target 1: [867, 165]
===================================
Normal Label Distribution: 
Target 0: [1061, 176]
Target 1: [867, 165]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 2269, target_attr: gender, bias_attr: age bias_rate: 0.9
['[test] target_0-bias_0: 1061', '[test] target_0-bias_1: 176', '[test] target_1-bias_0: 867', '[test] target_1-bias_1: 165']
decay_epochs: [6, 13]
[1 / 20] Learning rate: 0.001 weight: 0.01
[1 / 20] Loss: 4.785495963002001 CE Loss: 0.5689007629285097 Con Loss: 4.779806947404639
[1 / 20] tensor([[0.997, 0.972],
        [0.052, 0.067]]) {'epoch': 1, 'valid/acc': 56.481, 'valid/acc_unbiased': 52.882, 'valid/diff': 3.253, 'valid/acc_skew': 51.256, 'valid/acc_align': 54.509, 'test/acc': 56.633, 'test/acc_unbiased': 52.183, 'test/diff': 2.017, 'test/acc_skew': 51.175, 'test/acc_align': 53.192}
[1 / 20] best valid accuracy: 52.882 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 56.481, 'best_valid_valid/acc_unbiased': 52.882, 'best_valid_valid/diff': 3.253, 'best_valid_valid/acc_skew': 51.256, 'best_valid_valid/acc_align': 54.509, 'best_valid_test/acc': 56.633, 'best_valid_test/acc_unbiased': 52.183, 'best_valid_test/diff': 2.017, 'best_valid_test/acc_skew': 51.175, 'best_valid_test/acc_align': 53.192}
[1 / 20] best test accuracy: 52.183 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 56.481, 'best_test_valid/acc_unbiased': 52.882, 'best_test_valid/diff': 3.253, 'best_test_valid/acc_skew': 51.256, 'best_test_valid/acc_align': 54.509, 'best_test_test/acc': 56.633, 'best_test_test/acc_unbiased': 52.183, 'best_test_test/diff': 2.017, 'best_test_test/acc_skew': 51.175, 'best_test_test/acc_align': 53.192}
[2 / 20] Learning rate: 0.001 weight: 0.01
[2 / 20] Loss: 4.585733352105566 CE Loss: 0.526071564529059 Con Loss: 4.580472609292519
[2 / 20] tensor([[0.948, 0.903],
        [0.493, 0.255]]) {'epoch': 2, 'valid/acc': 69.974, 'valid/acc_unbiased': 64.142, 'valid/diff': 12.004, 'valid/acc_skew': 65.06, 'valid/acc_align': 63.225, 'test/acc': 72.014, 'test/acc_unbiased': 64.965, 'test/diff': 14.136, 'test/acc_skew': 69.796, 'test/acc_align': 60.135}
[2 / 20] best valid accuracy: 64.142 at epoch 2 
 best_stats: {'best_valid_epoch': 2, 'best_valid_valid/acc': 69.974, 'best_valid_valid/acc_unbiased': 64.142, 'best_valid_valid/diff': 12.004, 'best_valid_valid/acc_skew': 65.06, 'best_valid_valid/acc_align': 63.225, 'best_valid_test/acc': 72.014, 'best_valid_test/acc_unbiased': 64.965, 'best_valid_test/diff': 14.136, 'best_valid_test/acc_skew': 69.796, 'best_valid_test/acc_align': 60.135}
[2 / 20] best test accuracy: 64.965 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 69.974, 'best_test_valid/acc_unbiased': 64.142, 'best_test_valid/diff': 12.004, 'best_test_valid/acc_skew': 65.06, 'best_test_valid/acc_align': 63.225, 'best_test_test/acc': 72.014, 'best_test_test/acc_unbiased': 64.965, 'best_test_test/diff': 14.136, 'best_test_test/acc_skew': 69.796, 'best_test_test/acc_align': 60.135}
[3 / 20] Learning rate: 0.001 weight: 0.01
[3 / 20] Loss: 4.5813624800835955 CE Loss: 0.50457384114585 Con Loss: 4.576316752089226
[3 / 20] tensor([[0.939, 0.909],
        [0.292, 0.164]]) {'epoch': 3, 'valid/acc': 64.594, 'valid/acc_unbiased': 60.009, 'valid/diff': 6.369, 'valid/acc_skew': 62.738, 'valid/acc_align': 57.28, 'test/acc': 63.288, 'test/acc_unbiased': 57.582, 'test/diff': 7.891, 'test/acc_skew': 60.045, 'test/acc_align': 55.119}
[3 / 20] best valid accuracy: 64.142 at epoch 2 
 best_stats: {'best_valid_epoch': 2, 'best_valid_valid/acc': 69.974, 'best_valid_valid/acc_unbiased': 64.142, 'best_valid_valid/diff': 12.004, 'best_valid_valid/acc_skew': 65.06, 'best_valid_valid/acc_align': 63.225, 'best_valid_test/acc': 72.014, 'best_valid_test/acc_unbiased': 64.965, 'best_valid_test/diff': 14.136, 'best_valid_test/acc_skew': 69.796, 'best_valid_test/acc_align': 60.135}
[3 / 20] best test accuracy: 64.965 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 69.974, 'best_test_valid/acc_unbiased': 64.142, 'best_test_valid/diff': 12.004, 'best_test_valid/acc_skew': 65.06, 'best_test_valid/acc_align': 63.225, 'best_test_test/acc': 72.014, 'best_test_test/acc_unbiased': 64.965, 'best_test_test/diff': 14.136, 'best_test_test/acc_skew': 69.796, 'best_test_test/acc_align': 60.135}
[4 / 20] Learning rate: 0.001 weight: 0.01
[4 / 20] Loss: 4.527312280889845 CE Loss: 0.49300442167945857 Con Loss: 4.522382230626559
[4 / 20] tensor([[0.952, 0.767],
        [0.533, 0.406]]) {'epoch': 4, 'valid/acc': 72.707, 'valid/acc_unbiased': 67.919, 'valid/diff': 8.791, 'valid/acc_skew': 64.513, 'valid/acc_align': 71.326, 'test/acc': 73.777, 'test/acc_unbiased': 66.448, 'test/diff': 15.585, 'test/acc_skew': 64.996, 'test/acc_align': 67.9}
[4 / 20] best valid accuracy: 67.919 at epoch 4 
 best_stats: {'best_valid_epoch': 4, 'best_valid_valid/acc': 72.707, 'best_valid_valid/acc_unbiased': 67.919, 'best_valid_valid/diff': 8.791, 'best_valid_valid/acc_skew': 64.513, 'best_valid_valid/acc_align': 71.326, 'best_valid_test/acc': 73.777, 'best_valid_test/acc_unbiased': 66.448, 'best_valid_test/diff': 15.585, 'best_valid_test/acc_skew': 64.996, 'best_valid_test/acc_align': 67.9}
[4 / 20] best test accuracy: 66.448 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 72.707, 'best_test_valid/acc_unbiased': 67.919, 'best_test_valid/diff': 8.791, 'best_test_valid/acc_skew': 64.513, 'best_test_valid/acc_align': 71.326, 'best_test_test/acc': 73.777, 'best_test_test/acc_unbiased': 66.448, 'best_test_test/diff': 15.585, 'best_test_test/acc_skew': 64.996, 'best_test_test/acc_align': 67.9}
[5 / 20] Learning rate: 0.001 weight: 0.01
[5 / 20] Loss: 4.49157993822944 CE Loss: 0.4640740422732104 Con Loss: 4.486939183159832
[5 / 20] tensor([[0.967, 0.710],
        [0.484, 0.491]]) {'epoch': 5, 'valid/acc': 71.869, 'valid/acc_unbiased': 67.23, 'valid/diff': 15.393, 'valid/acc_skew': 59.534, 'valid/acc_align': 74.927, 'test/acc': 72.807, 'test/acc_unbiased': 66.314, 'test/diff': 13.163, 'test/acc_skew': 59.733, 'test/acc_align': 72.896}
[5 / 20] best valid accuracy: 67.919 at epoch 4 
 best_stats: {'best_valid_epoch': 4, 'best_valid_valid/acc': 72.707, 'best_valid_valid/acc_unbiased': 67.919, 'best_valid_valid/diff': 8.791, 'best_valid_valid/acc_skew': 64.513, 'best_valid_valid/acc_align': 71.326, 'best_valid_test/acc': 73.777, 'best_valid_test/acc_unbiased': 66.448, 'best_valid_test/diff': 15.585, 'best_valid_test/acc_skew': 64.996, 'best_valid_test/acc_align': 67.9}
[5 / 20] best test accuracy: 66.448 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 72.707, 'best_test_valid/acc_unbiased': 67.919, 'best_test_valid/diff': 8.791, 'best_test_valid/acc_skew': 64.513, 'best_test_valid/acc_align': 71.326, 'best_test_test/acc': 73.777, 'best_test_test/acc_unbiased': 66.448, 'best_test_test/diff': 15.585, 'best_test_test/acc_skew': 64.996, 'best_test_test/acc_align': 67.9}
[6 / 20] Learning rate: 0.001 weight: 0.01
[6 / 20] Loss: 4.487850267402424 CE Loss: 0.4581272219482409 Con Loss: 4.4832690020082415
[6 / 20] tensor([[0.992, 0.926],
        [0.294, 0.261]]) {'epoch': 6, 'valid/acc': 65.476, 'valid/acc_unbiased': 60.987, 'valid/diff': 4.932, 'valid/acc_skew': 59.691, 'valid/acc_align': 62.284, 'test/acc': 66.725, 'test/acc_unbiased': 61.833, 'test/diff': 4.992, 'test/acc_skew': 61.013, 'test/acc_align': 62.653}
[6 / 20] best valid accuracy: 67.919 at epoch 4 
 best_stats: {'best_valid_epoch': 4, 'best_valid_valid/acc': 72.707, 'best_valid_valid/acc_unbiased': 67.919, 'best_valid_valid/diff': 8.791, 'best_valid_valid/acc_skew': 64.513, 'best_valid_valid/acc_align': 71.326, 'best_valid_test/acc': 73.777, 'best_valid_test/acc_unbiased': 66.448, 'best_valid_test/diff': 15.585, 'best_valid_test/acc_skew': 64.996, 'best_valid_test/acc_align': 67.9}
[6 / 20] best test accuracy: 66.448 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 72.707, 'best_test_valid/acc_unbiased': 67.919, 'best_test_valid/diff': 8.791, 'best_test_valid/acc_skew': 64.513, 'best_test_valid/acc_align': 71.326, 'best_test_test/acc': 73.777, 'best_test_test/acc_unbiased': 66.448, 'best_test_test/diff': 15.585, 'best_test_test/acc_skew': 64.996, 'best_test_test/acc_align': 67.9}
[7 / 20] Learning rate: 0.0001 weight: 0.01
[7 / 20] Loss: 4.427091216291216 CE Loss: 0.43656766781731965 Con Loss: 4.42272551896107
[7 / 20] tensor([[0.953, 0.756],
        [0.654, 0.539]]) {'epoch': 7, 'valid/acc': 77.866, 'valid/acc_unbiased': 72.167, 'valid/diff': 13.116, 'valid/acc_skew': 66.772, 'valid/acc_align': 77.562, 'test/acc': 79.33, 'test/acc_unbiased': 72.548, 'test/diff': 15.589, 'test/acc_skew': 70.483, 'test/acc_align': 74.613}
[7 / 20] best valid accuracy: 72.167 at epoch 7 
 best_stats: {'best_valid_epoch': 7, 'best_valid_valid/acc': 77.866, 'best_valid_valid/acc_unbiased': 72.167, 'best_valid_valid/diff': 13.116, 'best_valid_valid/acc_skew': 66.772, 'best_valid_valid/acc_align': 77.562, 'best_valid_test/acc': 79.33, 'best_valid_test/acc_unbiased': 72.548, 'best_valid_test/diff': 15.589, 'best_valid_test/acc_skew': 70.483, 'best_valid_test/acc_align': 74.613}
[7 / 20] best test accuracy: 72.548 at epoch 7 
 best_stats: {'best_test_epoch': 7, 'best_test_valid/acc': 77.866, 'best_test_valid/acc_unbiased': 72.167, 'best_test_valid/diff': 13.116, 'best_test_valid/acc_skew': 66.772, 'best_test_valid/acc_align': 77.562, 'best_test_test/acc': 79.33, 'best_test_test/acc_unbiased': 72.548, 'best_test_test/diff': 15.589, 'best_test_test/acc_skew': 70.483, 'best_test_test/acc_align': 74.613}
[8 / 20] Learning rate: 0.0001 weight: 0.01
[8 / 20] Loss: 4.327882089225686 CE Loss: 0.4201895563132037 Con Loss: 4.323680192511075
[8 / 20] tensor([[0.944, 0.693],
        [0.682, 0.612]]) {'epoch': 8, 'valid/acc': 79.277, 'valid/acc_unbiased': 73.87, 'valid/diff': 13.431, 'valid/acc_skew': 67.155, 'valid/acc_align': 80.586, 'test/acc': 80.035, 'test/acc_unbiased': 73.284, 'test/diff': 16.037, 'test/acc_skew': 68.742, 'test/acc_align': 77.826}
[8 / 20] best valid accuracy: 73.870 at epoch 8 
 best_stats: {'best_valid_epoch': 8, 'best_valid_valid/acc': 79.277, 'best_valid_valid/acc_unbiased': 73.87, 'best_valid_valid/diff': 13.431, 'best_valid_valid/acc_skew': 67.155, 'best_valid_valid/acc_align': 80.586, 'best_valid_test/acc': 80.035, 'best_valid_test/acc_unbiased': 73.284, 'best_valid_test/diff': 16.037, 'best_valid_test/acc_skew': 68.742, 'best_valid_test/acc_align': 77.826}
[8 / 20] best test accuracy: 73.284 at epoch 8 
 best_stats: {'best_test_epoch': 8, 'best_test_valid/acc': 79.277, 'best_test_valid/acc_unbiased': 73.87, 'best_test_valid/diff': 13.431, 'best_test_valid/acc_skew': 67.155, 'best_test_valid/acc_align': 80.586, 'best_test_test/acc': 80.035, 'best_test_test/acc_unbiased': 73.284, 'best_test_test/diff': 16.037, 'best_test_test/acc_skew': 68.742, 'best_test_test/acc_align': 77.826}
[9 / 20] Learning rate: 0.0001 weight: 0.01
[9 / 20] Loss: 4.270593246329995 CE Loss: 0.40650804623688086 Con Loss: 4.266528159926688
[9 / 20] tensor([[0.968, 0.670],
        [0.621, 0.600]]) {'epoch': 9, 'valid/acc': 75.97, 'valid/acc_unbiased': 70.303, 'valid/diff': 18.255, 'valid/acc_skew': 61.176, 'valid/acc_align': 79.431, 'test/acc': 78.537, 'test/acc_unbiased': 71.474, 'test/diff': 15.902, 'test/acc_skew': 64.549, 'test/acc_align': 78.398}
[9 / 20] best valid accuracy: 73.870 at epoch 8 
 best_stats: {'best_valid_epoch': 8, 'best_valid_valid/acc': 79.277, 'best_valid_valid/acc_unbiased': 73.87, 'best_valid_valid/diff': 13.431, 'best_valid_valid/acc_skew': 67.155, 'best_valid_valid/acc_align': 80.586, 'best_valid_test/acc': 80.035, 'best_valid_test/acc_unbiased': 73.284, 'best_valid_test/diff': 16.037, 'best_valid_test/acc_skew': 68.742, 'best_valid_test/acc_align': 77.826}
[9 / 20] best test accuracy: 73.284 at epoch 8 
 best_stats: {'best_test_epoch': 8, 'best_test_valid/acc': 79.277, 'best_test_valid/acc_unbiased': 73.87, 'best_test_valid/diff': 13.431, 'best_test_valid/acc_skew': 67.155, 'best_test_valid/acc_align': 80.586, 'best_test_test/acc': 80.035, 'best_test_test/acc_unbiased': 73.284, 'best_test_test/diff': 16.037, 'best_test_test/acc_skew': 68.742, 'best_test_test/acc_align': 77.826}
[10 / 20] Learning rate: 0.0001 weight: 0.01
[10 / 20] Loss: 4.242696746374864 CE Loss: 0.40133871487890993 Con Loss: 4.238683374219956
[10 / 20] tensor([[0.965, 0.676],
        [0.656, 0.624]]) {'epoch': 10, 'valid/acc': 77.822, 'valid/acc_unbiased': 71.919, 'valid/diff': 20.081, 'valid/acc_skew': 61.878, 'valid/acc_align': 81.96, 'test/acc': 79.991, 'test/acc_unbiased': 73.045, 'test/diff': 16.052, 'test/acc_skew': 66.621, 'test/acc_align': 79.468}
[10 / 20] best valid accuracy: 73.870 at epoch 8 
 best_stats: {'best_valid_epoch': 8, 'best_valid_valid/acc': 79.277, 'best_valid_valid/acc_unbiased': 73.87, 'best_valid_valid/diff': 13.431, 'best_valid_valid/acc_skew': 67.155, 'best_valid_valid/acc_align': 80.586, 'best_valid_test/acc': 80.035, 'best_valid_test/acc_unbiased': 73.284, 'best_valid_test/diff': 16.037, 'best_valid_test/acc_skew': 68.742, 'best_valid_test/acc_align': 77.826}
[10 / 20] best test accuracy: 73.284 at epoch 8 
 best_stats: {'best_test_epoch': 8, 'best_test_valid/acc': 79.277, 'best_test_valid/acc_unbiased': 73.87, 'best_test_valid/diff': 13.431, 'best_test_valid/acc_skew': 67.155, 'best_test_valid/acc_align': 80.586, 'best_test_test/acc': 80.035, 'best_test_test/acc_unbiased': 73.284, 'best_test_test/diff': 16.037, 'best_test_test/acc_skew': 68.742, 'best_test_test/acc_align': 77.826}
[11 / 20] Learning rate: 0.0001 weight: 0.01
[11 / 20] Loss: 4.207710731881962 CE Loss: 0.3935204845539687 Con Loss: 4.203775508713517
[11 / 20] tensor([[0.975, 0.750],
        [0.592, 0.558]]) {'epoch': 11, 'valid/acc': 75.705, 'valid/acc_unbiased': 70.137, 'valid/diff': 14.22, 'valid/acc_skew': 63.027, 'valid/acc_align': 77.247, 'test/acc': 78.096, 'test/acc_unbiased': 71.869, 'test/diff': 12.981, 'test/acc_skew': 67.085, 'test/acc_align': 76.654}
[11 / 20] best valid accuracy: 73.870 at epoch 8 
 best_stats: {'best_valid_epoch': 8, 'best_valid_valid/acc': 79.277, 'best_valid_valid/acc_unbiased': 73.87, 'best_valid_valid/diff': 13.431, 'best_valid_valid/acc_skew': 67.155, 'best_valid_valid/acc_align': 80.586, 'best_valid_test/acc': 80.035, 'best_valid_test/acc_unbiased': 73.284, 'best_valid_test/diff': 16.037, 'best_valid_test/acc_skew': 68.742, 'best_valid_test/acc_align': 77.826}
[11 / 20] best test accuracy: 73.284 at epoch 8 
 best_stats: {'best_test_epoch': 8, 'best_test_valid/acc': 79.277, 'best_test_valid/acc_unbiased': 73.87, 'best_test_valid/diff': 13.431, 'best_test_valid/acc_skew': 67.155, 'best_test_valid/acc_align': 80.586, 'best_test_test/acc': 80.035, 'best_test_test/acc_unbiased': 73.284, 'best_test_test/diff': 16.037, 'best_test_test/acc_skew': 68.742, 'best_test_test/acc_align': 77.826}
[12 / 20] Learning rate: 0.0001 weight: 0.01
[12 / 20] Loss: 4.247360810230217 CE Loss: 0.38567329015414037 Con Loss: 4.2435040784569455
[12 / 20] tensor([[0.973, 0.727],
        [0.614, 0.576]]) {'epoch': 12, 'valid/acc': 76.72, 'valid/acc_unbiased': 70.802, 'valid/diff': 16.956, 'valid/acc_skew': 62.324, 'valid/acc_align': 79.28, 'test/acc': 78.757, 'test/acc_unbiased': 72.233, 'test/diff': 14.162, 'test/acc_skew': 67.044, 'test/acc_align': 77.421}
[12 / 20] best valid accuracy: 73.870 at epoch 8 
 best_stats: {'best_valid_epoch': 8, 'best_valid_valid/acc': 79.277, 'best_valid_valid/acc_unbiased': 73.87, 'best_valid_valid/diff': 13.431, 'best_valid_valid/acc_skew': 67.155, 'best_valid_valid/acc_align': 80.586, 'best_valid_test/acc': 80.035, 'best_valid_test/acc_unbiased': 73.284, 'best_valid_test/diff': 16.037, 'best_valid_test/acc_skew': 68.742, 'best_valid_test/acc_align': 77.826}
[12 / 20] best test accuracy: 73.284 at epoch 8 
 best_stats: {'best_test_epoch': 8, 'best_test_valid/acc': 79.277, 'best_test_valid/acc_unbiased': 73.87, 'best_test_valid/diff': 13.431, 'best_test_valid/acc_skew': 67.155, 'best_test_valid/acc_align': 80.586, 'best_test_test/acc': 80.035, 'best_test_test/acc_unbiased': 73.284, 'best_test_test/diff': 16.037, 'best_test_test/acc_skew': 68.742, 'best_test_test/acc_align': 77.826}
[13 / 20] Learning rate: 0.0001 weight: 0.01
[13 / 20] Loss: 4.197704091673708 CE Loss: 0.3829518863878996 Con Loss: 4.1938745815715555
[13 / 20] tensor([[0.961, 0.494],
        [0.682, 0.715]]) {'epoch': 13, 'valid/acc': 77.557, 'valid/acc_unbiased': 69.549, 'valid/diff': 30.674, 'valid/acc_skew': 54.212, 'valid/acc_align': 84.886, 'test/acc': 80.035, 'test/acc_unbiased': 71.312, 'test/diff': 25.026, 'test/acc_skew': 58.799, 'test/acc_align': 83.825}
[13 / 20] best valid accuracy: 73.870 at epoch 8 
 best_stats: {'best_valid_epoch': 8, 'best_valid_valid/acc': 79.277, 'best_valid_valid/acc_unbiased': 73.87, 'best_valid_valid/diff': 13.431, 'best_valid_valid/acc_skew': 67.155, 'best_valid_valid/acc_align': 80.586, 'best_valid_test/acc': 80.035, 'best_valid_test/acc_unbiased': 73.284, 'best_valid_test/diff': 16.037, 'best_valid_test/acc_skew': 68.742, 'best_valid_test/acc_align': 77.826}
[13 / 20] best test accuracy: 73.284 at epoch 8 
 best_stats: {'best_test_epoch': 8, 'best_test_valid/acc': 79.277, 'best_test_valid/acc_unbiased': 73.87, 'best_test_valid/diff': 13.431, 'best_test_valid/acc_skew': 67.155, 'best_test_valid/acc_align': 80.586, 'best_test_test/acc': 80.035, 'best_test_test/acc_unbiased': 73.284, 'best_test_test/diff': 16.037, 'best_test_test/acc_skew': 68.742, 'best_test_test/acc_align': 77.826}
[14 / 20] Learning rate: 1e-05 weight: 0.01
[14 / 20] Loss: 4.196496222805593 CE Loss: 0.3631260514884172 Con Loss: 4.19286496038519
[14 / 20] tensor([[0.969, 0.574],
        [0.659, 0.703]]) {'epoch': 14, 'valid/acc': 76.94, 'valid/acc_unbiased': 69.707, 'valid/diff': 28.165, 'valid/acc_skew': 55.624, 'valid/acc_align': 83.789, 'test/acc': 80.035, 'test/acc_unbiased': 72.61, 'test/diff': 21.974, 'test/acc_skew': 61.623, 'test/acc_align': 83.596}
[14 / 20] best valid accuracy: 73.870 at epoch 8 
 best_stats: {'best_valid_epoch': 8, 'best_valid_valid/acc': 79.277, 'best_valid_valid/acc_unbiased': 73.87, 'best_valid_valid/diff': 13.431, 'best_valid_valid/acc_skew': 67.155, 'best_valid_valid/acc_align': 80.586, 'best_valid_test/acc': 80.035, 'best_valid_test/acc_unbiased': 73.284, 'best_valid_test/diff': 16.037, 'best_valid_test/acc_skew': 68.742, 'best_valid_test/acc_align': 77.826}
[14 / 20] best test accuracy: 73.284 at epoch 8 
 best_stats: {'best_test_epoch': 8, 'best_test_valid/acc': 79.277, 'best_test_valid/acc_unbiased': 73.87, 'best_test_valid/diff': 13.431, 'best_test_valid/acc_skew': 67.155, 'best_test_valid/acc_align': 80.586, 'best_test_test/acc': 80.035, 'best_test_test/acc_unbiased': 73.284, 'best_test_test/diff': 16.037, 'best_test_test/acc_skew': 68.742, 'best_test_test/acc_align': 77.826}
[15 / 20] Learning rate: 1e-05 weight: 0.01
[15 / 20] Loss: 4.170638863846676 CE Loss: 0.3645932187372627 Con Loss: 4.166992903916142
[15 / 20] tensor([[0.969, 0.602],
        [0.651, 0.703]]) {'epoch': 15, 'valid/acc': 77.381, 'valid/acc_unbiased': 70.711, 'valid/diff': 24.176, 'valid/acc_skew': 58.623, 'valid/acc_align': 82.799, 'test/acc': 79.947, 'test/acc_unbiased': 73.118, 'test/diff': 20.957, 'test/acc_skew': 62.64, 'test/acc_align': 83.596}
[15 / 20] best valid accuracy: 73.870 at epoch 8 
 best_stats: {'best_valid_epoch': 8, 'best_valid_valid/acc': 79.277, 'best_valid_valid/acc_unbiased': 73.87, 'best_valid_valid/diff': 13.431, 'best_valid_valid/acc_skew': 67.155, 'best_valid_valid/acc_align': 80.586, 'best_valid_test/acc': 80.035, 'best_valid_test/acc_unbiased': 73.284, 'best_valid_test/diff': 16.037, 'best_valid_test/acc_skew': 68.742, 'best_valid_test/acc_align': 77.826}
[15 / 20] best test accuracy: 73.284 at epoch 8 
 best_stats: {'best_test_epoch': 8, 'best_test_valid/acc': 79.277, 'best_test_valid/acc_unbiased': 73.87, 'best_test_valid/diff': 13.431, 'best_test_valid/acc_skew': 67.155, 'best_test_valid/acc_align': 80.586, 'best_test_test/acc': 80.035, 'best_test_test/acc_unbiased': 73.284, 'best_test_test/diff': 16.037, 'best_test_test/acc_skew': 68.742, 'best_test_test/acc_align': 77.826}
[16 / 20] Learning rate: 1e-05 weight: 0.01
[16 / 20] Loss: 4.127101174993311 CE Loss: 0.3663177308028488 Con Loss: 4.123437992333027
[16 / 20] tensor([[0.968, 0.597],
        [0.657, 0.709]]) {'epoch': 16, 'valid/acc': 77.866, 'valid/acc_unbiased': 71.103, 'valid/diff': 26.061, 'valid/acc_skew': 58.073, 'valid/acc_align': 84.134, 'test/acc': 80.167, 'test/acc_unbiased': 73.277, 'test/diff': 21.151, 'test/acc_skew': 62.702, 'test/acc_align': 83.852}
[16 / 20] best valid accuracy: 73.870 at epoch 8 
 best_stats: {'best_valid_epoch': 8, 'best_valid_valid/acc': 79.277, 'best_valid_valid/acc_unbiased': 73.87, 'best_valid_valid/diff': 13.431, 'best_valid_valid/acc_skew': 67.155, 'best_valid_valid/acc_align': 80.586, 'best_valid_test/acc': 80.035, 'best_valid_test/acc_unbiased': 73.284, 'best_valid_test/diff': 16.037, 'best_valid_test/acc_skew': 68.742, 'best_valid_test/acc_align': 77.826}
[16 / 20] best test accuracy: 73.284 at epoch 8 
 best_stats: {'best_test_epoch': 8, 'best_test_valid/acc': 79.277, 'best_test_valid/acc_unbiased': 73.87, 'best_test_valid/diff': 13.431, 'best_test_valid/acc_skew': 67.155, 'best_test_valid/acc_align': 80.586, 'best_test_test/acc': 80.035, 'best_test_test/acc_unbiased': 73.284, 'best_test_test/diff': 16.037, 'best_test_test/acc_skew': 68.742, 'best_test_test/acc_align': 77.826}
[17 / 20] Learning rate: 1e-05 weight: 0.01
[17 / 20] Loss: 4.16825373812768 CE Loss: 0.36828266408326515 Con Loss: 4.164570928021613
[17 / 20] tensor([[0.967, 0.608],
        [0.669, 0.709]]) {'epoch': 17, 'valid/acc': 78.527, 'valid/acc_unbiased': 72.173, 'valid/diff': 23.34, 'valid/acc_skew': 60.503, 'valid/acc_align': 83.843, 'test/acc': 80.652, 'test/acc_unbiased': 73.826, 'test/diff': 19.959, 'test/acc_skew': 63.846, 'test/acc_align': 83.805}
[17 / 20] best valid accuracy: 73.870 at epoch 8 
 best_stats: {'best_valid_epoch': 8, 'best_valid_valid/acc': 79.277, 'best_valid_valid/acc_unbiased': 73.87, 'best_valid_valid/diff': 13.431, 'best_valid_valid/acc_skew': 67.155, 'best_valid_valid/acc_align': 80.586, 'best_valid_test/acc': 80.035, 'best_valid_test/acc_unbiased': 73.284, 'best_valid_test/diff': 16.037, 'best_valid_test/acc_skew': 68.742, 'best_valid_test/acc_align': 77.826}
[17 / 20] best test accuracy: 73.826 at epoch 17 
 best_stats: {'best_test_epoch': 17, 'best_test_valid/acc': 78.527, 'best_test_valid/acc_unbiased': 72.173, 'best_test_valid/diff': 23.34, 'best_test_valid/acc_skew': 60.503, 'best_test_valid/acc_align': 83.843, 'best_test_test/acc': 80.652, 'best_test_test/acc_unbiased': 73.826, 'best_test_test/diff': 19.959, 'best_test_test/acc_skew': 63.846, 'best_test_test/acc_align': 83.805}
[18 / 20] Learning rate: 1e-05 weight: 0.01
[18 / 20] Loss: 4.1023546848704155 CE Loss: 0.36159366967302276 Con Loss: 4.098738753541228
[18 / 20] tensor([[0.967, 0.574],
        [0.677, 0.703]]) {'epoch': 18, 'valid/acc': 78.307, 'valid/acc_unbiased': 71.33, 'valid/diff': 25.519, 'valid/acc_skew': 58.571, 'valid/acc_align': 84.09, 'test/acc': 80.652, 'test/acc_unbiased': 73.024, 'test/diff': 20.957, 'test/acc_skew': 62.546, 'test/acc_align': 83.502}
[18 / 20] best valid accuracy: 73.870 at epoch 8 
 best_stats: {'best_valid_epoch': 8, 'best_valid_valid/acc': 79.277, 'best_valid_valid/acc_unbiased': 73.87, 'best_valid_valid/diff': 13.431, 'best_valid_valid/acc_skew': 67.155, 'best_valid_valid/acc_align': 80.586, 'best_valid_test/acc': 80.035, 'best_valid_test/acc_unbiased': 73.284, 'best_valid_test/diff': 16.037, 'best_valid_test/acc_skew': 68.742, 'best_valid_test/acc_align': 77.826}
[18 / 20] best test accuracy: 73.826 at epoch 17 
 best_stats: {'best_test_epoch': 17, 'best_test_valid/acc': 78.527, 'best_test_valid/acc_unbiased': 72.173, 'best_test_valid/diff': 23.34, 'best_test_valid/acc_skew': 60.503, 'best_test_valid/acc_align': 83.843, 'best_test_test/acc': 80.652, 'best_test_test/acc_unbiased': 73.826, 'best_test_test/diff': 19.959, 'best_test_test/acc_skew': 63.846, 'best_test_test/acc_align': 83.805}
[19 / 20] Learning rate: 1e-05 weight: 0.01
[19 / 20] Loss: 4.12566220041787 CE Loss: 0.35948554741358857 Con Loss: 4.122067348022489
[19 / 20] tensor([[0.966, 0.534],
        [0.677, 0.752]]) {'epoch': 19, 'valid/acc': 78.351, 'valid/acc_unbiased': 70.766, 'valid/diff': 27.542, 'valid/acc_skew': 56.995, 'valid/acc_align': 84.537, 'test/acc': 80.652, 'test/acc_unbiased': 73.218, 'test/diff': 25.322, 'test/acc_skew': 60.557, 'test/acc_align': 85.879}
[19 / 20] best valid accuracy: 73.870 at epoch 8 
 best_stats: {'best_valid_epoch': 8, 'best_valid_valid/acc': 79.277, 'best_valid_valid/acc_unbiased': 73.87, 'best_valid_valid/diff': 13.431, 'best_valid_valid/acc_skew': 67.155, 'best_valid_valid/acc_align': 80.586, 'best_valid_test/acc': 80.035, 'best_valid_test/acc_unbiased': 73.284, 'best_valid_test/diff': 16.037, 'best_valid_test/acc_skew': 68.742, 'best_valid_test/acc_align': 77.826}
[19 / 20] best test accuracy: 73.826 at epoch 17 
 best_stats: {'best_test_epoch': 17, 'best_test_valid/acc': 78.527, 'best_test_valid/acc_unbiased': 72.173, 'best_test_valid/diff': 23.34, 'best_test_valid/acc_skew': 60.503, 'best_test_valid/acc_align': 83.843, 'best_test_test/acc': 80.652, 'best_test_test/acc_unbiased': 73.826, 'best_test_test/diff': 19.959, 'best_test_test/acc_skew': 63.846, 'best_test_test/acc_align': 83.805}
[20 / 20] Learning rate: 1e-05 weight: 0.01
[20 / 20] Loss: 4.092762490418554 CE Loss: 0.3600510757699614 Con Loss: 4.08916198140626
[20 / 20] tensor([[0.968, 0.591],
        [0.668, 0.721]]) {'epoch': 20, 'valid/acc': 78.086, 'valid/acc_unbiased': 71.088, 'valid/diff': 25.51, 'valid/acc_skew': 58.333, 'valid/acc_align': 83.843, 'test/acc': 80.608, 'test/acc_unbiased': 73.697, 'test/diff': 21.522, 'test/acc_skew': 62.936, 'test/acc_align': 84.458}
[20 / 20] best valid accuracy: 73.870 at epoch 8 
 best_stats: {'best_valid_epoch': 8, 'best_valid_valid/acc': 79.277, 'best_valid_valid/acc_unbiased': 73.87, 'best_valid_valid/diff': 13.431, 'best_valid_valid/acc_skew': 67.155, 'best_valid_valid/acc_align': 80.586, 'best_valid_test/acc': 80.035, 'best_valid_test/acc_unbiased': 73.284, 'best_valid_test/diff': 16.037, 'best_valid_test/acc_skew': 68.742, 'best_valid_test/acc_align': 77.826}
[20 / 20] best test accuracy: 73.826 at epoch 17 
 best_stats: {'best_test_epoch': 17, 'best_test_valid/acc': 78.527, 'best_test_valid/acc_unbiased': 72.173, 'best_test_valid/diff': 23.34, 'best_test_valid/acc_skew': 60.503, 'best_test_valid/acc_align': 83.843, 'best_test_test/acc': 80.652, 'best_test_test/acc_unbiased': 73.826, 'best_test_test/diff': 19.959, 'best_test_test/acc_skew': 63.846, 'best_test_test/acc_align': 83.805}
Total training time: 0:16:30
