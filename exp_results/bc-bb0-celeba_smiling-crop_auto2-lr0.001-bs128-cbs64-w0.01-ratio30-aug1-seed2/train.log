Log level set to: INFO
Set seed: 2
=======> Using Fixed Random Seed: 2 <========
save_path: exp_results/bc-bb0-celeba_smiling-crop_auto2-lr0.001-bs128-cbs64-w0.01-ratio30-aug1-seed2
get_celeba - split:train, aug: False, given_y: True, ratio: 0
use existing smiling indices from data/celeba/pickles/smiling
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [8019, 32821]
Target 1: [40611, 8007]
Binary Target 1
---------------------------
Target 0: [8019, 32821]
Target 1: [40611, 8007]
===================================
Normal Label Distribution: 
Target 0: [8019, 32821]
Target 1: [40611, 8007]
===================================
Use BiasedCelebASplit 
 target_attr: smiling split: train 
 tensor([[ 8019., 40611.],
        [32821.,  8007.]])
get_celeba - split:train, aug: 1, given_y: True, ratio: 30
use existing smiling indices from data/celeba/pickles/smiling
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [7986, 32687]
Target 1: [40769, 8016]
Binary Target 1
---------------------------
Target 0: [7986, 32687]
Target 1: [40769, 8016]
===================================
Normal Label Distribution: 
Target 0: [7986, 32687]
Target 1: [40769, 8016]
===================================
Use BiasedCelebASplit 
 target_attr: smiling split: train 
 tensor([[ 7986., 40769.],
        [32687.,  8016.]])
get_celeba - split:train_valid, aug: False, given_y: True, ratio: 0
use existing smiling indices from data/celeba/pickles/smiling
Use BiasedCelebASplit 
 target_attr: smiling split: train_valid 
 tensor([[ 1973., 10114.],
        [ 8289.,  1989.]])
get_celeba - split:valid, aug: False, given_y: True, ratio: 0
Use BiasedCelebASplit 
 target_attr: smiling split: valid 
 tensor([[5252., 6157.],
        [5013., 3445.]])
decay_epochs: [3, 6]
[1 / 10] Learning rate: 0.001 weight: 0.01
[1 / 10] Loss: 4.706389037849955 CE Loss: 0.2731680844054327 Con Loss: 4.703657356252314
[1 / 10] tensor([[0.944, 0.949],
        [0.902, 0.847]]) {'epoch': 1, 'valid/acc': 91.572, 'valid/acc_unbiased': 90.895, 'valid/diff': 2.702, 'valid/acc_skew': 89.544, 'valid/acc_align': 92.246, 'test/acc': 91.534, 'test/acc_unbiased': 91.04, 'test/diff': 2.967, 'test/acc_skew': 89.557, 'test/acc_align': 92.524}
[1 / 10] best valid accuracy: 90.895 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 91.572, 'best_valid_valid/acc_unbiased': 90.895, 'best_valid_valid/diff': 2.702, 'best_valid_valid/acc_skew': 89.544, 'best_valid_valid/acc_align': 92.246, 'best_valid_test/acc': 91.534, 'best_valid_test/acc_unbiased': 91.04, 'best_valid_test/diff': 2.967, 'best_valid_test/acc_skew': 89.557, 'best_valid_test/acc_align': 92.524}
[1 / 10] best test accuracy: 91.040 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 91.572, 'best_test_valid/acc_unbiased': 90.895, 'best_test_valid/diff': 2.702, 'best_test_valid/acc_skew': 89.544, 'best_test_valid/acc_align': 92.246, 'best_test_test/acc': 91.534, 'best_test_test/acc_unbiased': 91.04, 'best_test_test/diff': 2.967, 'best_test_test/acc_skew': 89.557, 'best_test_test/acc_align': 92.524}
[2 / 10] Learning rate: 0.001 weight: 0.01
[2 / 10] Loss: 4.6475579973203045 CE Loss: 0.22530759321319768 Con Loss: 4.645304911994111
[2 / 10] tensor([[0.942, 0.937],
        [0.910, 0.884]]) {'epoch': 2, 'valid/acc': 92.104, 'valid/acc_unbiased': 91.865, 'valid/diff': 2.398, 'valid/acc_skew': 91.357, 'valid/acc_align': 92.374, 'test/acc': 92.092, 'test/acc_unbiased': 91.839, 'test/diff': 1.573, 'test/acc_skew': 91.319, 'test/acc_align': 92.359}
[2 / 10] best valid accuracy: 91.865 at epoch 2 
 best_stats: {'best_valid_epoch': 2, 'best_valid_valid/acc': 92.104, 'best_valid_valid/acc_unbiased': 91.865, 'best_valid_valid/diff': 2.398, 'best_valid_valid/acc_skew': 91.357, 'best_valid_valid/acc_align': 92.374, 'best_valid_test/acc': 92.092, 'best_valid_test/acc_unbiased': 91.839, 'best_valid_test/diff': 1.573, 'best_valid_test/acc_skew': 91.319, 'best_valid_test/acc_align': 92.359}
[2 / 10] best test accuracy: 91.839 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 92.104, 'best_test_valid/acc_unbiased': 91.865, 'best_test_valid/diff': 2.398, 'best_test_valid/acc_skew': 91.357, 'best_test_valid/acc_align': 92.374, 'best_test_test/acc': 92.092, 'best_test_test/acc_unbiased': 91.839, 'best_test_test/diff': 1.573, 'best_test_test/acc_skew': 91.319, 'best_test_test/acc_align': 92.359}
[3 / 10] Learning rate: 0.001 weight: 0.01
[3 / 10] Loss: 4.63260100353662 CE Loss: 0.2157632093870354 Con Loss: 4.630443373495921
[3 / 10] tensor([[0.941, 0.953],
        [0.888, 0.847]]) {'epoch': 3, 'valid/acc': 91.165, 'valid/acc_unbiased': 90.626, 'valid/diff': 2.465, 'valid/acc_skew': 89.394, 'valid/acc_align': 91.859, 'test/acc': 91.126, 'test/acc_unbiased': 90.723, 'test/diff': 2.646, 'test/acc_skew': 89.4, 'test/acc_align': 92.046}
[3 / 10] best valid accuracy: 91.865 at epoch 2 
 best_stats: {'best_valid_epoch': 2, 'best_valid_valid/acc': 92.104, 'best_valid_valid/acc_unbiased': 91.865, 'best_valid_valid/diff': 2.398, 'best_valid_valid/acc_skew': 91.357, 'best_valid_valid/acc_align': 92.374, 'best_valid_test/acc': 92.092, 'best_valid_test/acc_unbiased': 91.839, 'best_valid_test/diff': 1.573, 'best_valid_test/acc_skew': 91.319, 'best_valid_test/acc_align': 92.359}
[3 / 10] best test accuracy: 91.839 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 92.104, 'best_test_valid/acc_unbiased': 91.865, 'best_test_valid/diff': 2.398, 'best_test_valid/acc_skew': 91.357, 'best_test_valid/acc_align': 92.374, 'best_test_test/acc': 92.092, 'best_test_test/acc_unbiased': 91.839, 'best_test_test/diff': 1.573, 'best_test_test/acc_skew': 91.319, 'best_test_test/acc_align': 92.359}
[4 / 10] Learning rate: 0.0001 weight: 0.01
[4 / 10] Loss: 4.588460740254421 CE Loss: 0.19310908996485063 Con Loss: 4.586529649322871
[4 / 10] tensor([[0.928, 0.938],
        [0.928, 0.894]]) {'epoch': 4, 'valid/acc': 92.77, 'valid/acc_unbiased': 92.08, 'valid/diff': 2.22, 'valid/acc_skew': 90.97, 'valid/acc_align': 93.19, 'test/acc': 92.485, 'test/acc_unbiased': 92.218, 'test/diff': 2.22, 'test/acc_skew': 91.108, 'test/acc_align': 93.329}
[4 / 10] best valid accuracy: 92.080 at epoch 4 
 best_stats: {'best_valid_epoch': 4, 'best_valid_valid/acc': 92.77, 'best_valid_valid/acc_unbiased': 92.08, 'best_valid_valid/diff': 2.22, 'best_valid_valid/acc_skew': 90.97, 'best_valid_valid/acc_align': 93.19, 'best_valid_test/acc': 92.485, 'best_valid_test/acc_unbiased': 92.218, 'best_valid_test/diff': 2.22, 'best_valid_test/acc_skew': 91.108, 'best_valid_test/acc_align': 93.329}
[4 / 10] best test accuracy: 92.218 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 92.77, 'best_test_valid/acc_unbiased': 92.08, 'best_test_valid/diff': 2.22, 'best_test_valid/acc_skew': 90.97, 'best_test_valid/acc_align': 93.19, 'best_test_test/acc': 92.485, 'best_test_test/acc_unbiased': 92.218, 'best_test_test/diff': 2.22, 'best_test_test/acc_skew': 91.108, 'best_test_test/acc_align': 93.329}
[5 / 10] Learning rate: 0.0001 weight: 0.01
[5 / 10] Loss: 4.577051930814637 CE Loss: 0.1839624984737597 Con Loss: 4.575212301736003
[5 / 10] tensor([[0.916, 0.927],
        [0.943, 0.904]]) {'epoch': 5, 'valid/acc': 93.222, 'valid/acc_unbiased': 92.418, 'valid/diff': 2.3, 'valid/acc_skew': 91.269, 'valid/acc_align': 93.568, 'test/acc': 92.525, 'test/acc_unbiased': 92.27, 'test/diff': 2.497, 'test/acc_skew': 91.022, 'test/acc_align': 93.519}
[5 / 10] best valid accuracy: 92.418 at epoch 5 
 best_stats: {'best_valid_epoch': 5, 'best_valid_valid/acc': 93.222, 'best_valid_valid/acc_unbiased': 92.418, 'best_valid_valid/diff': 2.3, 'best_valid_valid/acc_skew': 91.269, 'best_valid_valid/acc_align': 93.568, 'best_valid_test/acc': 92.525, 'best_valid_test/acc_unbiased': 92.27, 'best_valid_test/diff': 2.497, 'best_valid_test/acc_skew': 91.022, 'best_valid_test/acc_align': 93.519}
[5 / 10] best test accuracy: 92.270 at epoch 5 
 best_stats: {'best_test_epoch': 5, 'best_test_valid/acc': 93.222, 'best_test_valid/acc_unbiased': 92.418, 'best_test_valid/diff': 2.3, 'best_test_valid/acc_skew': 91.269, 'best_test_valid/acc_align': 93.568, 'best_test_test/acc': 92.525, 'best_test_test/acc_unbiased': 92.27, 'best_test_test/diff': 2.497, 'best_test_test/acc_skew': 91.022, 'best_test_test/acc_align': 93.519}
[6 / 10] Learning rate: 0.0001 weight: 0.01
[6 / 10] Loss: 4.575156560816509 CE Loss: 0.18405012846320856 Con Loss: 4.573316057293001
[6 / 10] tensor([[0.910, 0.924],
        [0.946, 0.907]]) {'epoch': 6, 'valid/acc': 93.257, 'valid/acc_unbiased': 92.324, 'valid/diff': 2.621, 'valid/acc_skew': 91.014, 'valid/acc_align': 93.634, 'test/acc': 92.415, 'test/acc_unbiased': 92.175, 'test/diff': 2.625, 'test/acc_skew': 90.862, 'test/acc_align': 93.488}
[6 / 10] best valid accuracy: 92.418 at epoch 5 
 best_stats: {'best_valid_epoch': 5, 'best_valid_valid/acc': 93.222, 'best_valid_valid/acc_unbiased': 92.418, 'best_valid_valid/diff': 2.3, 'best_valid_valid/acc_skew': 91.269, 'best_valid_valid/acc_align': 93.568, 'best_valid_test/acc': 92.525, 'best_valid_test/acc_unbiased': 92.27, 'best_valid_test/diff': 2.497, 'best_valid_test/acc_skew': 91.022, 'best_valid_test/acc_align': 93.519}
[6 / 10] best test accuracy: 92.270 at epoch 5 
 best_stats: {'best_test_epoch': 5, 'best_test_valid/acc': 93.222, 'best_test_valid/acc_unbiased': 92.418, 'best_test_valid/diff': 2.3, 'best_test_valid/acc_skew': 91.269, 'best_test_valid/acc_align': 93.568, 'best_test_test/acc': 92.525, 'best_test_test/acc_unbiased': 92.27, 'best_test_test/diff': 2.497, 'best_test_test/acc_skew': 91.022, 'best_test_test/acc_align': 93.519}
[7 / 10] Learning rate: 1e-05 weight: 0.01
[7 / 10] Loss: 4.560965003119556 CE Loss: 0.17863103888453993 Con Loss: 4.559178685989521
[7 / 10] tensor([[0.921, 0.931],
        [0.942, 0.908]]) {'epoch': 7, 'valid/acc': 93.208, 'valid/acc_unbiased': 92.476, 'valid/diff': 2.113, 'valid/acc_skew': 91.419, 'valid/acc_align': 93.533, 'test/acc': 92.757, 'test/acc_unbiased': 92.532, 'test/diff': 2.167, 'test/acc_skew': 91.448, 'test/acc_align': 93.615}
[7 / 10] best valid accuracy: 92.476 at epoch 7 
 best_stats: {'best_valid_epoch': 7, 'best_valid_valid/acc': 93.208, 'best_valid_valid/acc_unbiased': 92.476, 'best_valid_valid/diff': 2.113, 'best_valid_valid/acc_skew': 91.419, 'best_valid_valid/acc_align': 93.533, 'best_valid_test/acc': 92.757, 'best_valid_test/acc_unbiased': 92.532, 'best_valid_test/diff': 2.167, 'best_valid_test/acc_skew': 91.448, 'best_valid_test/acc_align': 93.615}
[7 / 10] best test accuracy: 92.532 at epoch 7 
 best_stats: {'best_test_epoch': 7, 'best_test_valid/acc': 93.208, 'best_test_valid/acc_unbiased': 92.476, 'best_test_valid/diff': 2.113, 'best_test_valid/acc_skew': 91.419, 'best_test_valid/acc_align': 93.533, 'best_test_test/acc': 92.757, 'best_test_test/acc_unbiased': 92.532, 'best_test_test/diff': 2.167, 'best_test_test/acc_skew': 91.448, 'best_test_test/acc_align': 93.615}
[8 / 10] Learning rate: 1e-05 weight: 0.01
[8 / 10] Loss: 4.564251199894693 CE Loss: 0.17778679664444563 Con Loss: 4.562473333898147
[8 / 10] tensor([[0.915, 0.926],
        [0.943, 0.907]]) {'epoch': 8, 'valid/acc': 93.293, 'valid/acc_unbiased': 92.511, 'valid/diff': 2.234, 'valid/acc_skew': 91.394, 'valid/acc_align': 93.628, 'test/acc': 92.49, 'test/acc_unbiased': 92.261, 'test/diff': 2.341, 'test/acc_skew': 91.091, 'test/acc_align': 93.431}
[8 / 10] best valid accuracy: 92.511 at epoch 8 
 best_stats: {'best_valid_epoch': 8, 'best_valid_valid/acc': 93.293, 'best_valid_valid/acc_unbiased': 92.511, 'best_valid_valid/diff': 2.234, 'best_valid_valid/acc_skew': 91.394, 'best_valid_valid/acc_align': 93.628, 'best_valid_test/acc': 92.49, 'best_valid_test/acc_unbiased': 92.261, 'best_valid_test/diff': 2.341, 'best_valid_test/acc_skew': 91.091, 'best_valid_test/acc_align': 93.431}
[8 / 10] best test accuracy: 92.532 at epoch 7 
 best_stats: {'best_test_epoch': 7, 'best_test_valid/acc': 93.208, 'best_test_valid/acc_unbiased': 92.476, 'best_test_valid/diff': 2.113, 'best_test_valid/acc_skew': 91.419, 'best_test_valid/acc_align': 93.533, 'best_test_test/acc': 92.757, 'best_test_test/acc_unbiased': 92.532, 'best_test_test/diff': 2.167, 'best_test_test/acc_skew': 91.448, 'best_test_test/acc_align': 93.615}
[9 / 10] Learning rate: 1e-05 weight: 0.01
[9 / 10] Loss: 4.558855804016169 CE Loss: 0.17679313108641156 Con Loss: 4.557087866528503
[9 / 10] tensor([[0.927, 0.939],
        [0.936, 0.900]]) {'epoch': 9, 'valid/acc': 93.208, 'valid/acc_unbiased': 92.488, 'valid/diff': 2.229, 'valid/acc_skew': 91.373, 'valid/acc_align': 93.602, 'test/acc': 92.822, 'test/acc_unbiased': 92.564, 'test/diff': 2.376, 'test/acc_skew': 91.376, 'test/acc_align': 93.752}
[9 / 10] best valid accuracy: 92.511 at epoch 8 
 best_stats: {'best_valid_epoch': 8, 'best_valid_valid/acc': 93.293, 'best_valid_valid/acc_unbiased': 92.511, 'best_valid_valid/diff': 2.234, 'best_valid_valid/acc_skew': 91.394, 'best_valid_valid/acc_align': 93.628, 'best_valid_test/acc': 92.49, 'best_valid_test/acc_unbiased': 92.261, 'best_valid_test/diff': 2.341, 'best_valid_test/acc_skew': 91.091, 'best_valid_test/acc_align': 93.431}
[9 / 10] best test accuracy: 92.564 at epoch 9 
 best_stats: {'best_test_epoch': 9, 'best_test_valid/acc': 93.208, 'best_test_valid/acc_unbiased': 92.488, 'best_test_valid/diff': 2.229, 'best_test_valid/acc_skew': 91.373, 'best_test_valid/acc_align': 93.602, 'best_test_test/acc': 92.822, 'best_test_test/acc_unbiased': 92.564, 'best_test_test/diff': 2.376, 'best_test_test/acc_skew': 91.376, 'best_test_test/acc_align': 93.752}
[10 / 10] Learning rate: 1e-05 weight: 0.01
[10 / 10] Loss: 4.556534204186882 CE Loss: 0.1761045848225366 Con Loss: 4.554773156846371
[10 / 10] tensor([[0.921, 0.930],
        [0.940, 0.907]]) {'epoch': 10, 'valid/acc': 93.15, 'valid/acc_unbiased': 92.518, 'valid/diff': 1.79, 'valid/acc_skew': 91.623, 'valid/acc_align': 93.413, 'test/acc': 92.671, 'test/acc_unbiased': 92.446, 'test/diff': 2.149, 'test/acc_skew': 91.371, 'test/acc_align': 93.521}
[10 / 10] best valid accuracy: 92.518 at epoch 10 
 best_stats: {'best_valid_epoch': 10, 'best_valid_valid/acc': 93.15, 'best_valid_valid/acc_unbiased': 92.518, 'best_valid_valid/diff': 1.79, 'best_valid_valid/acc_skew': 91.623, 'best_valid_valid/acc_align': 93.413, 'best_valid_test/acc': 92.671, 'best_valid_test/acc_unbiased': 92.446, 'best_valid_test/diff': 2.149, 'best_valid_test/acc_skew': 91.371, 'best_valid_test/acc_align': 93.521}
[10 / 10] best test accuracy: 92.564 at epoch 9 
 best_stats: {'best_test_epoch': 9, 'best_test_valid/acc': 93.208, 'best_test_valid/acc_unbiased': 92.488, 'best_test_valid/diff': 2.229, 'best_test_valid/acc_skew': 91.373, 'best_test_valid/acc_align': 93.602, 'best_test_test/acc': 92.822, 'best_test_test/acc_unbiased': 92.564, 'best_test_test/diff': 2.376, 'best_test_test/acc_skew': 91.376, 'best_test_test/acc_align': 93.752}
Total training time: 1:07:31
