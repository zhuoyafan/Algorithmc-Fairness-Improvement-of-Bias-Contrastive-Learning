Log level set to: INFO
Set seed: 1
=======> Using Fixed Random Seed: 1 <========
save_path: exp_results/bc-bb0-utk_face_race-us-0.6-lr0.001-bs128-cbs64-w0.01-ratio10-aug1-seed1
get_utk_face - split: train, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_race-0.6
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [4407, 2211]
Target 1: [1762, 5529]
Binary Target 1
---------------------------
Target 0: [4407, 2211]
Target 1: [1762, 5529]
===================================
Normal Label Distribution: 
Target 0: [4407, 2211]
Target 1: [1762, 5529]
===================================
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [1762, 1762]
Target 1: [1762, 1762]
Binary Target 1
---------------------------
Target 0: [1762, 1762]
Target 1: [1762, 1762]
===================================
Normal Label Distribution: 
Target 0: [1762, 1762]
Target 1: [1762, 1762]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 7048, target_attr: gender, bias_attr: race bias_rate: 0.6
['[train] target_0-bias_0: 1762', '[train] target_0-bias_1: 1762', '[train] target_1-bias_0: 1762', '[train] target_1-bias_1: 1762']
confusion_matrix - 
 original: tensor([[1762., 1762.],
        [1762., 1762.]]), 
 normalized: tensor([[0.500, 0.500],
        [0.500, 0.500]]), 
 b|y: tensor([[0.500, 0.500],
        [0.500, 0.500]])
get_utk_face - split: train, aug: 1, given_y: True, ratio: 10
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_race-0.6
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [4407, 2211]
Target 1: [1762, 5529]
Binary Target 1
---------------------------
Target 0: [4407, 2211]
Target 1: [1762, 5529]
===================================
Normal Label Distribution: 
Target 0: [4407, 2211]
Target 1: [1762, 5529]
===================================
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [1762, 1762]
Target 1: [1762, 1762]
Binary Target 1
---------------------------
Target 0: [1762, 1762]
Target 1: [1762, 1762]
===================================
Normal Label Distribution: 
Target 0: [1762, 1762]
Target 1: [1762, 1762]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 7048, target_attr: gender, bias_attr: race bias_rate: 0.6
['[train] target_0-bias_0: 1762', '[train] target_0-bias_1: 1762', '[train] target_1-bias_0: 1762', '[train] target_1-bias_1: 1762']
get_utk_face - split: valid, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_race-0.6
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [583, 684]
Target 1: [457, 646]
Binary Target 1
---------------------------
Target 0: [583, 684]
Target 1: [457, 646]
===================================
Normal Label Distribution: 
Target 0: [583, 684]
Target 1: [457, 646]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 2370, target_attr: gender, bias_attr: race bias_rate: 0.6
['[valid] target_0-bias_0: 583', '[valid] target_0-bias_1: 684', '[valid] target_1-bias_0: 457', '[valid] target_1-bias_1: 646']
get_utk_face - split: test, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_race-0.6
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [558, 677]
Target 1: [462, 673]
Binary Target 1
---------------------------
Target 0: [558, 677]
Target 1: [462, 673]
===================================
Normal Label Distribution: 
Target 0: [558, 677]
Target 1: [462, 673]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 2370, target_attr: gender, bias_attr: race bias_rate: 0.6
['[test] target_0-bias_0: 558', '[test] target_0-bias_1: 677', '[test] target_1-bias_0: 462', '[test] target_1-bias_1: 673']
decay_epochs: [6, 13]
[1 / 20] Learning rate: 0.001 weight: 0.01
[1 / 20] Loss: 4.942723305081942 CE Loss: 0.6078426465138403 Con Loss: 4.9366448951227575
[1 / 20] tensor([[0.729, 0.706],
        [0.844, 0.851]]) {'epoch': 1, 'valid/acc': 77.131, 'valid/acc_unbiased': 77.625, 'valid/diff': 0.851, 'valid/acc_skew': 77.699, 'valid/acc_align': 77.55, 'test/acc': 77.975, 'test/acc_unbiased': 78.275, 'test/diff': 1.53, 'test/acc_skew': 78.677, 'test/acc_align': 77.873}
[1 / 20] best valid accuracy: 77.625 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 77.131, 'best_valid_valid/acc_unbiased': 77.625, 'best_valid_valid/diff': 0.851, 'best_valid_valid/acc_skew': 77.699, 'best_valid_valid/acc_align': 77.55, 'best_valid_test/acc': 77.975, 'best_valid_test/acc_unbiased': 78.275, 'best_valid_test/diff': 1.53, 'best_valid_test/acc_skew': 78.677, 'best_valid_test/acc_align': 77.873}
[1 / 20] best test accuracy: 78.275 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 77.131, 'best_test_valid/acc_unbiased': 77.625, 'best_test_valid/diff': 0.851, 'best_test_valid/acc_skew': 77.699, 'best_test_valid/acc_align': 77.55, 'best_test_test/acc': 77.975, 'best_test_test/acc_unbiased': 78.275, 'best_test_test/diff': 1.53, 'best_test_test/acc_skew': 78.677, 'best_test_test/acc_align': 77.873}
[2 / 20] Learning rate: 0.001 weight: 0.01
[2 / 20] Loss: 4.786958024396258 CE Loss: 0.48522640962606123 Con Loss: 4.782105778186465
[2 / 20] tensor([[0.826, 0.802],
        [0.823, 0.804]]) {'epoch': 2, 'valid/acc': 80.38, 'valid/acc_unbiased': 80.644, 'valid/diff': 3.48, 'valid/acc_skew': 82.384, 'valid/acc_align': 78.904, 'test/acc': 81.224, 'test/acc_unbiased': 81.365, 'test/diff': 2.137, 'test/acc_skew': 82.434, 'test/acc_align': 80.297}
[2 / 20] best valid accuracy: 80.644 at epoch 2 
 best_stats: {'best_valid_epoch': 2, 'best_valid_valid/acc': 80.38, 'best_valid_valid/acc_unbiased': 80.644, 'best_valid_valid/diff': 3.48, 'best_valid_valid/acc_skew': 82.384, 'best_valid_valid/acc_align': 78.904, 'best_valid_test/acc': 81.224, 'best_valid_test/acc_unbiased': 81.365, 'best_valid_test/diff': 2.137, 'best_valid_test/acc_skew': 82.434, 'best_valid_test/acc_align': 80.297}
[2 / 20] best test accuracy: 81.365 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 80.38, 'best_test_valid/acc_unbiased': 80.644, 'best_test_valid/diff': 3.48, 'best_test_valid/acc_skew': 82.384, 'best_test_valid/acc_align': 78.904, 'best_test_test/acc': 81.224, 'best_test_test/acc_unbiased': 81.365, 'best_test_test/diff': 2.137, 'best_test_test/acc_skew': 82.434, 'best_test_test/acc_align': 80.297}
[3 / 20] Learning rate: 0.001 weight: 0.01
[3 / 20] Loss: 4.753902369270801 CE Loss: 0.4659716823856081 Con Loss: 4.7492426369977725
[3 / 20] tensor([[0.858, 0.811],
        [0.797, 0.801]]) {'epoch': 3, 'valid/acc': 82.574, 'valid/acc_unbiased': 82.645, 'valid/diff': 2.89, 'valid/acc_skew': 84.09, 'valid/acc_align': 81.201, 'test/acc': 81.646, 'test/acc_unbiased': 81.67, 'test/diff': 2.592, 'test/acc_skew': 82.748, 'test/acc_align': 80.591}
[3 / 20] best valid accuracy: 82.645 at epoch 3 
 best_stats: {'best_valid_epoch': 3, 'best_valid_valid/acc': 82.574, 'best_valid_valid/acc_unbiased': 82.645, 'best_valid_valid/diff': 2.89, 'best_valid_valid/acc_skew': 84.09, 'best_valid_valid/acc_align': 81.201, 'best_valid_test/acc': 81.646, 'best_valid_test/acc_unbiased': 81.67, 'best_valid_test/diff': 2.592, 'best_valid_test/acc_skew': 82.748, 'best_valid_test/acc_align': 80.591}
[3 / 20] best test accuracy: 81.670 at epoch 3 
 best_stats: {'best_test_epoch': 3, 'best_test_valid/acc': 82.574, 'best_test_valid/acc_unbiased': 82.645, 'best_test_valid/diff': 2.89, 'best_test_valid/acc_skew': 84.09, 'best_test_valid/acc_align': 81.201, 'best_test_test/acc': 81.646, 'best_test_test/acc_unbiased': 81.67, 'best_test_test/diff': 2.592, 'best_test_test/acc_skew': 82.748, 'best_test_test/acc_align': 80.591}
[4 / 20] Learning rate: 0.001 weight: 0.01
[4 / 20] Loss: 4.7357561038923315 CE Loss: 0.4425854149795688 Con Loss: 4.731330228582549
[4 / 20] tensor([[0.729, 0.659],
        [0.907, 0.918]]) {'epoch': 4, 'valid/acc': 79.283, 'valid/acc_unbiased': 80.048, 'valid/diff': 4.151, 'valid/acc_skew': 81.174, 'valid/acc_align': 78.922, 'test/acc': 79.747, 'test/acc_unbiased': 80.335, 'test/diff': 4.098, 'test/acc_skew': 81.816, 'test/acc_align': 78.853}
[4 / 20] best valid accuracy: 82.645 at epoch 3 
 best_stats: {'best_valid_epoch': 3, 'best_valid_valid/acc': 82.574, 'best_valid_valid/acc_unbiased': 82.645, 'best_valid_valid/diff': 2.89, 'best_valid_valid/acc_skew': 84.09, 'best_valid_valid/acc_align': 81.201, 'best_valid_test/acc': 81.646, 'best_valid_test/acc_unbiased': 81.67, 'best_valid_test/diff': 2.592, 'best_valid_test/acc_skew': 82.748, 'best_valid_test/acc_align': 80.591}
[4 / 20] best test accuracy: 81.670 at epoch 3 
 best_stats: {'best_test_epoch': 3, 'best_test_valid/acc': 82.574, 'best_test_valid/acc_unbiased': 82.645, 'best_test_valid/diff': 2.89, 'best_test_valid/acc_skew': 84.09, 'best_test_valid/acc_align': 81.201, 'best_test_test/acc': 81.646, 'best_test_test/acc_unbiased': 81.67, 'best_test_test/diff': 2.592, 'best_test_test/acc_skew': 82.748, 'best_test_test/acc_align': 80.591}
[5 / 20] Learning rate: 0.001 weight: 0.01
[5 / 20] Loss: 4.739568259469768 CE Loss: 0.41491472430180476 Con Loss: 4.7354190812343635
[5 / 20] tensor([[0.901, 0.886],
        [0.732, 0.768]]) {'epoch': 5, 'valid/acc': 82.321, 'valid/acc_unbiased': 81.9, 'valid/diff': 1.821, 'valid/acc_skew': 82.81, 'valid/acc_align': 80.99, 'test/acc': 82.616, 'test/acc_unbiased': 82.188, 'test/diff': 2.589, 'test/acc_skew': 81.652, 'test/acc_align': 82.723}
[5 / 20] best valid accuracy: 82.645 at epoch 3 
 best_stats: {'best_valid_epoch': 3, 'best_valid_valid/acc': 82.574, 'best_valid_valid/acc_unbiased': 82.645, 'best_valid_valid/diff': 2.89, 'best_valid_valid/acc_skew': 84.09, 'best_valid_valid/acc_align': 81.201, 'best_valid_test/acc': 81.646, 'best_valid_test/acc_unbiased': 81.67, 'best_valid_test/diff': 2.592, 'best_valid_test/acc_skew': 82.748, 'best_valid_test/acc_align': 80.591}
[5 / 20] best test accuracy: 82.188 at epoch 5 
 best_stats: {'best_test_epoch': 5, 'best_test_valid/acc': 82.321, 'best_test_valid/acc_unbiased': 81.9, 'best_test_valid/diff': 1.821, 'best_test_valid/acc_skew': 82.81, 'best_test_valid/acc_align': 80.99, 'best_test_test/acc': 82.616, 'best_test_test/acc_unbiased': 82.188, 'best_test_test/diff': 2.589, 'best_test_test/acc_skew': 81.652, 'best_test_test/acc_align': 82.723}
[6 / 20] Learning rate: 0.001 weight: 0.01
[6 / 20] Loss: 4.725776800638431 CE Loss: 0.42166684518877956 Con Loss: 4.721560135060894
[6 / 20] tensor([[0.828, 0.762],
        [0.805, 0.865]]) {'epoch': 6, 'valid/acc': 82.236, 'valid/acc_unbiased': 82.451, 'valid/diff': 1.133, 'valid/acc_skew': 83.017, 'valid/acc_align': 81.884, 'test/acc': 81.519, 'test/acc_unbiased': 81.503, 'test/diff': 6.268, 'test/acc_skew': 81.658, 'test/acc_align': 81.349}
[6 / 20] best valid accuracy: 82.645 at epoch 3 
 best_stats: {'best_valid_epoch': 3, 'best_valid_valid/acc': 82.574, 'best_valid_valid/acc_unbiased': 82.645, 'best_valid_valid/diff': 2.89, 'best_valid_valid/acc_skew': 84.09, 'best_valid_valid/acc_align': 81.201, 'best_valid_test/acc': 81.646, 'best_valid_test/acc_unbiased': 81.67, 'best_valid_test/diff': 2.592, 'best_valid_test/acc_skew': 82.748, 'best_valid_test/acc_align': 80.591}
[6 / 20] best test accuracy: 82.188 at epoch 5 
 best_stats: {'best_test_epoch': 5, 'best_test_valid/acc': 82.321, 'best_test_valid/acc_unbiased': 81.9, 'best_test_valid/diff': 1.821, 'best_test_valid/acc_skew': 82.81, 'best_test_valid/acc_align': 80.99, 'best_test_test/acc': 82.616, 'best_test_test/acc_unbiased': 82.188, 'best_test_test/diff': 2.589, 'best_test_test/acc_skew': 81.652, 'best_test_test/acc_align': 82.723}
[7 / 20] Learning rate: 0.0001 weight: 0.01
[7 / 20] Loss: 4.717939630133881 CE Loss: 0.40711216894099983 Con Loss: 4.713868520587311
[7 / 20] tensor([[0.815, 0.792],
        [0.868, 0.880]]) {'epoch': 7, 'valid/acc': 84.852, 'valid/acc_unbiased': 85.187, 'valid/diff': 2.965, 'valid/acc_skew': 85.347, 'valid/acc_align': 85.028, 'test/acc': 83.713, 'test/acc_unbiased': 83.869, 'test/diff': 1.768, 'test/acc_skew': 84.169, 'test/acc_align': 83.569}
[7 / 20] best valid accuracy: 85.187 at epoch 7 
 best_stats: {'best_valid_epoch': 7, 'best_valid_valid/acc': 84.852, 'best_valid_valid/acc_unbiased': 85.187, 'best_valid_valid/diff': 2.965, 'best_valid_valid/acc_skew': 85.347, 'best_valid_valid/acc_align': 85.028, 'best_valid_test/acc': 83.713, 'best_valid_test/acc_unbiased': 83.869, 'best_valid_test/diff': 1.768, 'best_valid_test/acc_skew': 84.169, 'best_valid_test/acc_align': 83.569}
[7 / 20] best test accuracy: 83.869 at epoch 7 
 best_stats: {'best_test_epoch': 7, 'best_test_valid/acc': 84.852, 'best_test_valid/acc_unbiased': 85.187, 'best_test_valid/diff': 2.965, 'best_test_valid/acc_skew': 85.347, 'best_test_valid/acc_align': 85.028, 'best_test_test/acc': 83.713, 'best_test_test/acc_unbiased': 83.869, 'best_test_test/diff': 1.768, 'best_test_test/acc_skew': 84.169, 'best_test_test/acc_align': 83.569}
[8 / 20] Learning rate: 0.0001 weight: 0.01
[8 / 20] Loss: 4.697127931099068 CE Loss: 0.371968769052919 Con Loss: 4.693408242419413
[8 / 20] tensor([[0.880, 0.860],
        [0.831, 0.832]]) {'epoch': 8, 'valid/acc': 85.696, 'valid/acc_unbiased': 85.827, 'valid/diff': 3.885, 'valid/acc_skew': 87.246, 'valid/acc_align': 84.408, 'test/acc': 85.105, 'test/acc_unbiased': 85.072, 'test/diff': 1.059, 'test/acc_skew': 85.555, 'test/acc_align': 84.589}
[8 / 20] best valid accuracy: 85.827 at epoch 8 
 best_stats: {'best_valid_epoch': 8, 'best_valid_valid/acc': 85.696, 'best_valid_valid/acc_unbiased': 85.827, 'best_valid_valid/diff': 3.885, 'best_valid_valid/acc_skew': 87.246, 'best_valid_valid/acc_align': 84.408, 'best_valid_test/acc': 85.105, 'best_valid_test/acc_unbiased': 85.072, 'best_valid_test/diff': 1.059, 'best_valid_test/acc_skew': 85.555, 'best_valid_test/acc_align': 84.589}
[8 / 20] best test accuracy: 85.072 at epoch 8 
 best_stats: {'best_test_epoch': 8, 'best_test_valid/acc': 85.696, 'best_test_valid/acc_unbiased': 85.827, 'best_test_valid/diff': 3.885, 'best_test_valid/acc_skew': 87.246, 'best_test_valid/acc_align': 84.408, 'best_test_test/acc': 85.105, 'best_test_test/acc_unbiased': 85.072, 'best_test_test/diff': 1.059, 'best_test_test/acc_skew': 85.555, 'best_test_test/acc_align': 84.589}
[9 / 20] Learning rate: 0.0001 weight: 0.01
[9 / 20] Loss: 4.664658131312566 CE Loss: 0.35132232210287034 Con Loss: 4.661144879565201
[9 / 20] tensor([[0.849, 0.839],
        [0.859, 0.862]]) {'epoch': 9, 'valid/acc': 86.498, 'valid/acc_unbiased': 86.793, 'valid/diff': 3.043, 'valid/acc_skew': 88.029, 'valid/acc_align': 85.556, 'test/acc': 85.19, 'test/acc_unbiased': 85.239, 'test/diff': 0.649, 'test/acc_skew': 85.438, 'test/acc_align': 85.04}
[9 / 20] best valid accuracy: 86.793 at epoch 9 
 best_stats: {'best_valid_epoch': 9, 'best_valid_valid/acc': 86.498, 'best_valid_valid/acc_unbiased': 86.793, 'best_valid_valid/diff': 3.043, 'best_valid_valid/acc_skew': 88.029, 'best_valid_valid/acc_align': 85.556, 'best_valid_test/acc': 85.19, 'best_valid_test/acc_unbiased': 85.239, 'best_valid_test/diff': 0.649, 'best_valid_test/acc_skew': 85.438, 'best_valid_test/acc_align': 85.04}
[9 / 20] best test accuracy: 85.239 at epoch 9 
 best_stats: {'best_test_epoch': 9, 'best_test_valid/acc': 86.498, 'best_test_valid/acc_unbiased': 86.793, 'best_test_valid/diff': 3.043, 'best_test_valid/acc_skew': 88.029, 'best_test_valid/acc_align': 85.556, 'best_test_test/acc': 85.19, 'best_test_test/acc_unbiased': 85.239, 'best_test_test/diff': 0.649, 'best_test_test/acc_skew': 85.438, 'best_test_test/acc_align': 85.04}
[10 / 20] Learning rate: 0.0001 weight: 0.01
[10 / 20] Loss: 4.661532051852829 CE Loss: 0.3528137149523931 Con Loss: 4.658003910445734
[10 / 20] tensor([[0.846, 0.817],
        [0.896, 0.892]]) {'epoch': 10, 'valid/acc': 86.329, 'valid/acc_unbiased': 86.698, 'valid/diff': 1.402, 'valid/acc_skew': 87.29, 'valid/acc_align': 86.107, 'test/acc': 86.034, 'test/acc_unbiased': 86.259, 'test/diff': 1.681, 'test/acc_skew': 87.099, 'test/acc_align': 85.418}
[10 / 20] best valid accuracy: 86.793 at epoch 9 
 best_stats: {'best_valid_epoch': 9, 'best_valid_valid/acc': 86.498, 'best_valid_valid/acc_unbiased': 86.793, 'best_valid_valid/diff': 3.043, 'best_valid_valid/acc_skew': 88.029, 'best_valid_valid/acc_align': 85.556, 'best_valid_test/acc': 85.19, 'best_valid_test/acc_unbiased': 85.239, 'best_valid_test/diff': 0.649, 'best_valid_test/acc_skew': 85.438, 'best_valid_test/acc_align': 85.04}
[10 / 20] best test accuracy: 86.259 at epoch 10 
 best_stats: {'best_test_epoch': 10, 'best_test_valid/acc': 86.329, 'best_test_valid/acc_unbiased': 86.698, 'best_test_valid/diff': 1.402, 'best_test_valid/acc_skew': 87.29, 'best_test_valid/acc_align': 86.107, 'best_test_test/acc': 86.034, 'best_test_test/acc_unbiased': 86.259, 'best_test_test/diff': 1.681, 'best_test_test/acc_skew': 87.099, 'best_test_test/acc_align': 85.418}
[11 / 20] Learning rate: 0.0001 weight: 0.01
[11 / 20] Loss: 4.645213336056938 CE Loss: 0.34486705460559225 Con Loss: 4.6417646305244435
[11 / 20] tensor([[0.878, 0.857],
        [0.853, 0.863]]) {'epoch': 11, 'valid/acc': 86.793, 'valid/acc_unbiased': 86.807, 'valid/diff': 0.687, 'valid/acc_skew': 87.151, 'valid/acc_align': 86.464, 'test/acc': 86.287, 'test/acc_unbiased': 86.274, 'test/diff': 1.595, 'test/acc_skew': 86.548, 'test/acc_align': 86.001}
[11 / 20] best valid accuracy: 86.807 at epoch 11 
 best_stats: {'best_valid_epoch': 11, 'best_valid_valid/acc': 86.793, 'best_valid_valid/acc_unbiased': 86.807, 'best_valid_valid/diff': 0.687, 'best_valid_valid/acc_skew': 87.151, 'best_valid_valid/acc_align': 86.464, 'best_valid_test/acc': 86.287, 'best_valid_test/acc_unbiased': 86.274, 'best_valid_test/diff': 1.595, 'best_valid_test/acc_skew': 86.548, 'best_valid_test/acc_align': 86.001}
[11 / 20] best test accuracy: 86.274 at epoch 11 
 best_stats: {'best_test_epoch': 11, 'best_test_valid/acc': 86.793, 'best_test_valid/acc_unbiased': 86.807, 'best_test_valid/diff': 0.687, 'best_test_valid/acc_skew': 87.151, 'best_test_valid/acc_align': 86.464, 'best_test_test/acc': 86.287, 'best_test_test/acc_unbiased': 86.274, 'best_test_test/diff': 1.595, 'best_test_test/acc_skew': 86.548, 'best_test_test/acc_align': 86.001}
[12 / 20] Learning rate: 0.0001 weight: 0.01
[12 / 20] Loss: 4.645627662624052 CE Loss: 0.33655309825966495 Con Loss: 4.6422621113217515
[12 / 20] tensor([[0.880, 0.858],
        [0.842, 0.857]]) {'epoch': 12, 'valid/acc': 86.751, 'valid/acc_unbiased': 86.869, 'valid/diff': 2.165, 'valid/acc_skew': 87.45, 'valid/acc_align': 86.287, 'test/acc': 85.992, 'test/acc_unbiased': 85.937, 'test/diff': 1.855, 'test/acc_skew': 86.096, 'test/acc_align': 85.778}
[12 / 20] best valid accuracy: 86.869 at epoch 12 
 best_stats: {'best_valid_epoch': 12, 'best_valid_valid/acc': 86.751, 'best_valid_valid/acc_unbiased': 86.869, 'best_valid_valid/diff': 2.165, 'best_valid_valid/acc_skew': 87.45, 'best_valid_valid/acc_align': 86.287, 'best_valid_test/acc': 85.992, 'best_valid_test/acc_unbiased': 85.937, 'best_valid_test/diff': 1.855, 'best_valid_test/acc_skew': 86.096, 'best_valid_test/acc_align': 85.778}
[12 / 20] best test accuracy: 86.274 at epoch 11 
 best_stats: {'best_test_epoch': 11, 'best_test_valid/acc': 86.793, 'best_test_valid/acc_unbiased': 86.807, 'best_test_valid/diff': 0.687, 'best_test_valid/acc_skew': 87.151, 'best_test_valid/acc_align': 86.464, 'best_test_test/acc': 86.287, 'best_test_test/acc_unbiased': 86.274, 'best_test_test/diff': 1.595, 'best_test_test/acc_skew': 86.548, 'best_test_test/acc_align': 86.001}
[13 / 20] Learning rate: 0.0001 weight: 0.01
[13 / 20] Loss: 4.641520867147457 CE Loss: 0.33983576493961454 Con Loss: 4.638122517459103
[13 / 20] tensor([[0.885, 0.839],
        [0.866, 0.877]]) {'epoch': 13, 'valid/acc': 86.962, 'valid/acc_unbiased': 87.143, 'valid/diff': 1.249, 'valid/acc_skew': 87.568, 'valid/acc_align': 86.717, 'test/acc': 86.582, 'test/acc_unbiased': 86.669, 'test/diff': 2.859, 'test/acc_skew': 87.555, 'test/acc_align': 85.783}
[13 / 20] best valid accuracy: 87.143 at epoch 13 
 best_stats: {'best_valid_epoch': 13, 'best_valid_valid/acc': 86.962, 'best_valid_valid/acc_unbiased': 87.143, 'best_valid_valid/diff': 1.249, 'best_valid_valid/acc_skew': 87.568, 'best_valid_valid/acc_align': 86.717, 'best_valid_test/acc': 86.582, 'best_valid_test/acc_unbiased': 86.669, 'best_valid_test/diff': 2.859, 'best_valid_test/acc_skew': 87.555, 'best_valid_test/acc_align': 85.783}
[13 / 20] best test accuracy: 86.669 at epoch 13 
 best_stats: {'best_test_epoch': 13, 'best_test_valid/acc': 86.962, 'best_test_valid/acc_unbiased': 87.143, 'best_test_valid/diff': 1.249, 'best_test_valid/acc_skew': 87.568, 'best_test_valid/acc_align': 86.717, 'best_test_test/acc': 86.582, 'best_test_test/acc_unbiased': 86.669, 'best_test_test/diff': 2.859, 'best_test_test/acc_skew': 87.555, 'best_test_test/acc_align': 85.783}
[14 / 20] Learning rate: 1e-05 weight: 0.01
[14 / 20] Loss: 4.616129277648233 CE Loss: 0.329785709517768 Con Loss: 4.612831433974925
[14 / 20] tensor([[0.900, 0.871],
        [0.833, 0.841]]) {'epoch': 14, 'valid/acc': 87.089, 'valid/acc_unbiased': 87.075, 'valid/diff': 1.18, 'valid/acc_skew': 87.666, 'valid/acc_align': 86.485, 'test/acc': 86.203, 'test/acc_unbiased': 86.137, 'test/diff': 1.791, 'test/acc_skew': 86.649, 'test/acc_align': 85.625}
[14 / 20] best valid accuracy: 87.143 at epoch 13 
 best_stats: {'best_valid_epoch': 13, 'best_valid_valid/acc': 86.962, 'best_valid_valid/acc_unbiased': 87.143, 'best_valid_valid/diff': 1.249, 'best_valid_valid/acc_skew': 87.568, 'best_valid_valid/acc_align': 86.717, 'best_valid_test/acc': 86.582, 'best_valid_test/acc_unbiased': 86.669, 'best_valid_test/diff': 2.859, 'best_valid_test/acc_skew': 87.555, 'best_valid_test/acc_align': 85.783}
[14 / 20] best test accuracy: 86.669 at epoch 13 
 best_stats: {'best_test_epoch': 13, 'best_test_valid/acc': 86.962, 'best_test_valid/acc_unbiased': 87.143, 'best_test_valid/diff': 1.249, 'best_test_valid/acc_skew': 87.568, 'best_test_valid/acc_align': 86.717, 'best_test_test/acc': 86.582, 'best_test_test/acc_unbiased': 86.669, 'best_test_test/diff': 2.859, 'best_test_test/acc_skew': 87.555, 'best_test_test/acc_align': 85.783}
[15 / 20] Learning rate: 1e-05 weight: 0.01
[15 / 20] Loss: 4.626765301495486 CE Loss: 0.3304211888356593 Con Loss: 4.623461083034381
[15 / 20] tensor([[0.876, 0.835],
        [0.870, 0.886]]) {'epoch': 15, 'valid/acc': 87.004, 'valid/acc_unbiased': 87.28, 'valid/diff': 2.432, 'valid/acc_skew': 87.757, 'valid/acc_align': 86.803, 'test/acc': 86.582, 'test/acc_unbiased': 86.666, 'test/diff': 2.862, 'test/acc_skew': 87.324, 'test/acc_align': 86.008}
[15 / 20] best valid accuracy: 87.280 at epoch 15 
 best_stats: {'best_valid_epoch': 15, 'best_valid_valid/acc': 87.004, 'best_valid_valid/acc_unbiased': 87.28, 'best_valid_valid/diff': 2.432, 'best_valid_valid/acc_skew': 87.757, 'best_valid_valid/acc_align': 86.803, 'best_valid_test/acc': 86.582, 'best_valid_test/acc_unbiased': 86.666, 'best_valid_test/diff': 2.862, 'best_valid_test/acc_skew': 87.324, 'best_valid_test/acc_align': 86.008}
[15 / 20] best test accuracy: 86.669 at epoch 13 
 best_stats: {'best_test_epoch': 13, 'best_test_valid/acc': 86.962, 'best_test_valid/acc_unbiased': 87.143, 'best_test_valid/diff': 1.249, 'best_test_valid/acc_skew': 87.568, 'best_test_valid/acc_align': 86.717, 'best_test_test/acc': 86.582, 'best_test_test/acc_unbiased': 86.669, 'best_test_test/diff': 2.859, 'best_test_test/acc_skew': 87.555, 'best_test_test/acc_align': 85.783}
[16 / 20] Learning rate: 1e-05 weight: 0.01
[16 / 20] Loss: 4.627404834301328 CE Loss: 0.32122731337347044 Con Loss: 4.62419256693118
[16 / 20] tensor([[0.884, 0.848],
        [0.855, 0.866]]) {'epoch': 16, 'valid/acc': 87.173, 'valid/acc_unbiased': 87.286, 'valid/diff': 1.11, 'valid/acc_skew': 87.731, 'valid/acc_align': 86.842, 'test/acc': 86.287, 'test/acc_unbiased': 86.315, 'test/diff': 2.347, 'test/acc_skew': 86.925, 'test/acc_align': 85.706}
[16 / 20] best valid accuracy: 87.286 at epoch 16 
 best_stats: {'best_valid_epoch': 16, 'best_valid_valid/acc': 87.173, 'best_valid_valid/acc_unbiased': 87.286, 'best_valid_valid/diff': 1.11, 'best_valid_valid/acc_skew': 87.731, 'best_valid_valid/acc_align': 86.842, 'best_valid_test/acc': 86.287, 'best_valid_test/acc_unbiased': 86.315, 'best_valid_test/diff': 2.347, 'best_valid_test/acc_skew': 86.925, 'best_valid_test/acc_align': 85.706}
[16 / 20] best test accuracy: 86.669 at epoch 13 
 best_stats: {'best_test_epoch': 13, 'best_test_valid/acc': 86.962, 'best_test_valid/acc_unbiased': 87.143, 'best_test_valid/diff': 1.249, 'best_test_valid/acc_skew': 87.568, 'best_test_valid/acc_align': 86.717, 'best_test_test/acc': 86.582, 'best_test_test/acc_unbiased': 86.669, 'best_test_test/diff': 2.859, 'best_test_test/acc_skew': 87.555, 'best_test_test/acc_align': 85.783}
[17 / 20] Learning rate: 1e-05 weight: 0.01
[17 / 20] Loss: 4.6335248822657125 CE Loss: 0.32393754167941047 Con Loss: 4.630285500126989
[17 / 20] tensor([[0.894, 0.861],
        [0.842, 0.854]]) {'epoch': 17, 'valid/acc': 86.878, 'valid/acc_unbiased': 86.871, 'valid/diff': 1.141, 'valid/acc_skew': 87.089, 'valid/acc_align': 86.653, 'test/acc': 86.329, 'test/acc_unbiased': 86.295, 'test/diff': 2.275, 'test/acc_skew': 86.813, 'test/acc_align': 85.777}
[17 / 20] best valid accuracy: 87.286 at epoch 16 
 best_stats: {'best_valid_epoch': 16, 'best_valid_valid/acc': 87.173, 'best_valid_valid/acc_unbiased': 87.286, 'best_valid_valid/diff': 1.11, 'best_valid_valid/acc_skew': 87.731, 'best_valid_valid/acc_align': 86.842, 'best_valid_test/acc': 86.287, 'best_valid_test/acc_unbiased': 86.315, 'best_valid_test/diff': 2.347, 'best_valid_test/acc_skew': 86.925, 'best_valid_test/acc_align': 85.706}
[17 / 20] best test accuracy: 86.669 at epoch 13 
 best_stats: {'best_test_epoch': 13, 'best_test_valid/acc': 86.962, 'best_test_valid/acc_unbiased': 87.143, 'best_test_valid/diff': 1.249, 'best_test_valid/acc_skew': 87.568, 'best_test_valid/acc_align': 86.717, 'best_test_test/acc': 86.582, 'best_test_test/acc_unbiased': 86.669, 'best_test_test/diff': 2.859, 'best_test_test/acc_skew': 87.555, 'best_test_test/acc_align': 85.783}
[18 / 20] Learning rate: 1e-05 weight: 0.01
[18 / 20] Loss: 4.6137222361483445 CE Loss: 0.32578050816235016 Con Loss: 4.610464466281159
[18 / 20] tensor([[0.869, 0.835],
        [0.872, 0.883]]) {'epoch': 18, 'valid/acc': 87.046, 'valid/acc_unbiased': 87.336, 'valid/diff': 1.736, 'valid/acc_skew': 87.929, 'valid/acc_align': 86.743, 'test/acc': 86.371, 'test/acc_unbiased': 86.466, 'test/diff': 2.247, 'test/acc_skew': 87.073, 'test/acc_align': 85.859}
[18 / 20] best valid accuracy: 87.336 at epoch 18 
 best_stats: {'best_valid_epoch': 18, 'best_valid_valid/acc': 87.046, 'best_valid_valid/acc_unbiased': 87.336, 'best_valid_valid/diff': 1.736, 'best_valid_valid/acc_skew': 87.929, 'best_valid_valid/acc_align': 86.743, 'best_valid_test/acc': 86.371, 'best_valid_test/acc_unbiased': 86.466, 'best_valid_test/diff': 2.247, 'best_valid_test/acc_skew': 87.073, 'best_valid_test/acc_align': 85.859}
[18 / 20] best test accuracy: 86.669 at epoch 13 
 best_stats: {'best_test_epoch': 13, 'best_test_valid/acc': 86.962, 'best_test_valid/acc_unbiased': 87.143, 'best_test_valid/diff': 1.249, 'best_test_valid/acc_skew': 87.568, 'best_test_valid/acc_align': 86.717, 'best_test_test/acc': 86.582, 'best_test_test/acc_unbiased': 86.669, 'best_test_test/diff': 2.859, 'best_test_test/acc_skew': 87.555, 'best_test_test/acc_align': 85.783}
[19 / 20] Learning rate: 1e-05 weight: 0.01
[19 / 20] Loss: 4.615436290909836 CE Loss: 0.3315296311113269 Con Loss: 4.612120988285095
[19 / 20] tensor([[0.891, 0.857],
        [0.853, 0.865]]) {'epoch': 19, 'valid/acc': 87.426, 'valid/acc_unbiased': 87.477, 'valid/diff': 0.804, 'valid/acc_skew': 87.745, 'valid/acc_align': 87.208, 'test/acc': 86.624, 'test/acc_unbiased': 86.625, 'test/diff': 2.297, 'test/acc_skew': 87.175, 'test/acc_align': 86.075}
[19 / 20] best valid accuracy: 87.477 at epoch 19 
 best_stats: {'best_valid_epoch': 19, 'best_valid_valid/acc': 87.426, 'best_valid_valid/acc_unbiased': 87.477, 'best_valid_valid/diff': 0.804, 'best_valid_valid/acc_skew': 87.745, 'best_valid_valid/acc_align': 87.208, 'best_valid_test/acc': 86.624, 'best_valid_test/acc_unbiased': 86.625, 'best_valid_test/diff': 2.297, 'best_valid_test/acc_skew': 87.175, 'best_valid_test/acc_align': 86.075}
[19 / 20] best test accuracy: 86.669 at epoch 13 
 best_stats: {'best_test_epoch': 13, 'best_test_valid/acc': 86.962, 'best_test_valid/acc_unbiased': 87.143, 'best_test_valid/diff': 1.249, 'best_test_valid/acc_skew': 87.568, 'best_test_valid/acc_align': 86.717, 'best_test_test/acc': 86.582, 'best_test_test/acc_unbiased': 86.669, 'best_test_test/diff': 2.859, 'best_test_test/acc_skew': 87.555, 'best_test_test/acc_align': 85.783}
[20 / 20] Learning rate: 1e-05 weight: 0.01
[20 / 20] Loss: 4.612700112696809 CE Loss: 0.32358541905406385 Con Loss: 4.609464254606595
[20 / 20] tensor([[0.873, 0.836],
        [0.874, 0.892]]) {'epoch': 20, 'valid/acc': 87.215, 'valid/acc_unbiased': 87.486, 'valid/diff': 1.727, 'valid/acc_skew': 87.929, 'valid/acc_align': 87.044, 'test/acc': 86.793, 'test/acc_unbiased': 86.87, 'test/diff': 2.69, 'test/acc_skew': 87.361, 'test/acc_align': 86.379}
[20 / 20] best valid accuracy: 87.486 at epoch 20 
 best_stats: {'best_valid_epoch': 20, 'best_valid_valid/acc': 87.215, 'best_valid_valid/acc_unbiased': 87.486, 'best_valid_valid/diff': 1.727, 'best_valid_valid/acc_skew': 87.929, 'best_valid_valid/acc_align': 87.044, 'best_valid_test/acc': 86.793, 'best_valid_test/acc_unbiased': 86.87, 'best_valid_test/diff': 2.69, 'best_valid_test/acc_skew': 87.361, 'best_valid_test/acc_align': 86.379}
[20 / 20] best test accuracy: 86.870 at epoch 20 
 best_stats: {'best_test_epoch': 20, 'best_test_valid/acc': 87.215, 'best_test_valid/acc_unbiased': 87.486, 'best_test_valid/diff': 1.727, 'best_test_valid/acc_skew': 87.929, 'best_test_valid/acc_align': 87.044, 'best_test_test/acc': 86.793, 'best_test_test/acc_unbiased': 86.87, 'best_test_test/diff': 2.69, 'best_test_test/acc_skew': 87.361, 'best_test_test/acc_align': 86.379}
Total training time: 0:41:55
