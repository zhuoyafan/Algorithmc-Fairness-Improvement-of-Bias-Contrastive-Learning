Log level set to: INFO
Set seed: 1
=======> Using Fixed Random Seed: 1 <========
save_path: exp_results/bc-bb0-utk_face_race-cutout_blur-0.9-lr0.001-bs128-cbs64-w0.01-ratio10-aug1-seed1
get_utk_face - split: train, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_race-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [4407, 552]
Target 1: [440, 5529]
Binary Target 1
---------------------------
Target 0: [4407, 552]
Target 1: [440, 5529]
===================================
Normal Label Distribution: 
Target 0: [4407, 552]
Target 1: [440, 5529]
===================================
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [4407, 552]
Target 1: [440, 5529]
Binary Target 1
---------------------------
Target 0: [4407, 552]
Target 1: [440, 5529]
===================================
Normal Label Distribution: 
Target 0: [4407, 552]
Target 1: [440, 5529]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 10928, target_attr: gender, bias_attr: race bias_rate: 0.9
['[train] target_0-bias_0: 4407', '[train] target_0-bias_1: 552', '[train] target_1-bias_0: 440', '[train] target_1-bias_1: 5529']
confusion_matrix - 
 original: tensor([[4407.,  440.],
        [ 552., 5529.]]), 
 normalized: tensor([[0.909, 0.091],
        [0.091, 0.909]]), 
 b|y: tensor([[0.889, 0.111],
        [0.074, 0.926]])
get_utk_face - split: train, aug: 1, given_y: True, ratio: 10
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_race-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [4407, 552]
Target 1: [440, 5529]
Binary Target 1
---------------------------
Target 0: [4407, 552]
Target 1: [440, 5529]
===================================
Normal Label Distribution: 
Target 0: [4407, 552]
Target 1: [440, 5529]
===================================
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [4407, 552]
Target 1: [440, 5529]
Binary Target 1
---------------------------
Target 0: [4407, 552]
Target 1: [440, 5529]
===================================
Normal Label Distribution: 
Target 0: [4407, 552]
Target 1: [440, 5529]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 10928, target_attr: gender, bias_attr: race bias_rate: 0.9
['[train] target_0-bias_0: 4407', '[train] target_0-bias_1: 552', '[train] target_1-bias_0: 440', '[train] target_1-bias_1: 5529']
get_utk_face - split: valid, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_race-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [583, 684]
Target 1: [457, 646]
Binary Target 1
---------------------------
Target 0: [583, 684]
Target 1: [457, 646]
===================================
Normal Label Distribution: 
Target 0: [583, 684]
Target 1: [457, 646]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 2370, target_attr: gender, bias_attr: race bias_rate: 0.9
['[valid] target_0-bias_0: 583', '[valid] target_0-bias_1: 684', '[valid] target_1-bias_0: 457', '[valid] target_1-bias_1: 646']
get_utk_face - split: test, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_race-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [558, 677]
Target 1: [462, 673]
Binary Target 1
---------------------------
Target 0: [558, 677]
Target 1: [462, 673]
===================================
Normal Label Distribution: 
Target 0: [558, 677]
Target 1: [462, 673]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 2370, target_attr: gender, bias_attr: race bias_rate: 0.9
['[test] target_0-bias_0: 558', '[test] target_0-bias_1: 677', '[test] target_1-bias_0: 462', '[test] target_1-bias_1: 673']
decay_epochs: [6, 13]
[1 / 20] Learning rate: 0.001 weight: 0.01
[1 / 20] Loss: 4.907983487381942 CE Loss: 0.5903618119297056 Con Loss: 4.902079866361827
[1 / 20] tensor([[0.425, 0.360],
        [0.900, 0.954]]) {'epoch': 1, 'valid/acc': 62.7, 'valid/acc_unbiased': 64.609, 'valid/diff': 1.058, 'valid/acc_skew': 64.08, 'valid/acc_align': 65.138, 'test/acc': 64.937, 'test/acc_unbiased': 65.988, 'test/diff': 5.891, 'test/acc_skew': 63.042, 'test/acc_align': 68.933}
[1 / 20] best valid accuracy: 64.609 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 62.7, 'best_valid_valid/acc_unbiased': 64.609, 'best_valid_valid/diff': 1.058, 'best_valid_valid/acc_skew': 64.08, 'best_valid_valid/acc_align': 65.138, 'best_valid_test/acc': 64.937, 'best_valid_test/acc_unbiased': 65.988, 'best_valid_test/diff': 5.891, 'best_valid_test/acc_skew': 63.042, 'best_valid_test/acc_align': 68.933}
[1 / 20] best test accuracy: 65.988 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 62.7, 'best_test_valid/acc_unbiased': 64.609, 'best_test_valid/diff': 1.058, 'best_test_valid/acc_skew': 64.08, 'best_test_valid/acc_align': 65.138, 'best_test_test/acc': 64.937, 'best_test_test/acc_unbiased': 65.988, 'best_test_test/diff': 5.891, 'best_test_test/acc_skew': 63.042, 'best_test_test/acc_align': 68.933}
[2 / 20] Learning rate: 0.001 weight: 0.01
[2 / 20] Loss: 4.756327503422169 CE Loss: 0.520330364847253 Con Loss: 4.751124219349851
[2 / 20] tensor([[0.726, 0.663],
        [0.887, 0.881]]) {'epoch': 2, 'valid/acc': 77.215, 'valid/acc_unbiased': 77.891, 'valid/diff': 1.148, 'valid/acc_skew': 77.317, 'valid/acc_align': 78.465, 'test/acc': 78.354, 'test/acc_unbiased': 78.94, 'test/diff': 3.445, 'test/acc_skew': 77.533, 'test/acc_align': 80.347}
[2 / 20] best valid accuracy: 77.891 at epoch 2 
 best_stats: {'best_valid_epoch': 2, 'best_valid_valid/acc': 77.215, 'best_valid_valid/acc_unbiased': 77.891, 'best_valid_valid/diff': 1.148, 'best_valid_valid/acc_skew': 77.317, 'best_valid_valid/acc_align': 78.465, 'best_valid_test/acc': 78.354, 'best_valid_test/acc_unbiased': 78.94, 'best_valid_test/diff': 3.445, 'best_valid_test/acc_skew': 77.533, 'best_valid_test/acc_align': 80.347}
[2 / 20] best test accuracy: 78.940 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 77.215, 'best_test_valid/acc_unbiased': 77.891, 'best_test_valid/diff': 1.148, 'best_test_valid/acc_skew': 77.317, 'best_test_valid/acc_align': 78.465, 'best_test_test/acc': 78.354, 'best_test_test/acc_unbiased': 78.94, 'best_test_test/diff': 3.445, 'best_test_test/acc_skew': 77.533, 'best_test_test/acc_align': 80.347}
[3 / 20] Learning rate: 0.001 weight: 0.01
[3 / 20] Loss: 4.720140190459624 CE Loss: 0.5213472813498747 Con Loss: 4.714926712684017
[3 / 20] tensor([[0.595, 0.520],
        [0.922, 0.942]]) {'epoch': 3, 'valid/acc': 73.671, 'valid/acc_unbiased': 74.985, 'valid/diff': 5.726, 'valid/acc_skew': 72.122, 'valid/acc_align': 77.848, 'test/acc': 73.587, 'test/acc_unbiased': 74.476, 'test/diff': 4.751, 'test/acc_skew': 72.101, 'test/acc_align': 76.852}
[3 / 20] best valid accuracy: 77.891 at epoch 2 
 best_stats: {'best_valid_epoch': 2, 'best_valid_valid/acc': 77.215, 'best_valid_valid/acc_unbiased': 77.891, 'best_valid_valid/diff': 1.148, 'best_valid_valid/acc_skew': 77.317, 'best_valid_valid/acc_align': 78.465, 'best_valid_test/acc': 78.354, 'best_valid_test/acc_unbiased': 78.94, 'best_valid_test/diff': 3.445, 'best_valid_test/acc_skew': 77.533, 'best_valid_test/acc_align': 80.347}
[3 / 20] best test accuracy: 78.940 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 77.215, 'best_test_valid/acc_unbiased': 77.891, 'best_test_valid/diff': 1.148, 'best_test_valid/acc_skew': 77.317, 'best_test_valid/acc_align': 78.465, 'best_test_test/acc': 78.354, 'best_test_test/acc_unbiased': 78.94, 'best_test_test/diff': 3.445, 'best_test_test/acc_skew': 77.533, 'best_test_test/acc_align': 80.347}
[4 / 20] Learning rate: 0.001 weight: 0.01
[4 / 20] Loss: 4.677176078276962 CE Loss: 0.4905789543821382 Con Loss: 4.672270300098604
[4 / 20] tensor([[0.921, 0.886],
        [0.578, 0.685]]) {'epoch': 4, 'valid/acc': 78.27, 'valid/acc_unbiased': 77.033, 'valid/diff': 2.661, 'valid/acc_skew': 75.703, 'valid/acc_align': 78.364, 'test/acc': 77.722, 'test/acc_unbiased': 76.758, 'test/diff': 7.098, 'test/acc_skew': 73.209, 'test/acc_align': 80.307}
[4 / 20] best valid accuracy: 77.891 at epoch 2 
 best_stats: {'best_valid_epoch': 2, 'best_valid_valid/acc': 77.215, 'best_valid_valid/acc_unbiased': 77.891, 'best_valid_valid/diff': 1.148, 'best_valid_valid/acc_skew': 77.317, 'best_valid_valid/acc_align': 78.465, 'best_valid_test/acc': 78.354, 'best_valid_test/acc_unbiased': 78.94, 'best_valid_test/diff': 3.445, 'best_valid_test/acc_skew': 77.533, 'best_valid_test/acc_align': 80.347}
[4 / 20] best test accuracy: 78.940 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 77.215, 'best_test_valid/acc_unbiased': 77.891, 'best_test_valid/diff': 1.148, 'best_test_valid/acc_skew': 77.317, 'best_test_valid/acc_align': 78.465, 'best_test_test/acc': 78.354, 'best_test_test/acc_unbiased': 78.94, 'best_test_test/diff': 3.445, 'best_test_test/acc_skew': 77.533, 'best_test_test/acc_align': 80.347}
[5 / 20] Learning rate: 0.001 weight: 0.01
[5 / 20] Loss: 4.651217335663288 CE Loss: 0.48703652755582316 Con Loss: 4.646346970498126
[5 / 20] tensor([[0.785, 0.731],
        [0.835, 0.893]]) {'epoch': 5, 'valid/acc': 80.253, 'valid/acc_unbiased': 80.544, 'valid/diff': 5.276, 'valid/acc_skew': 77.906, 'valid/acc_align': 83.182, 'test/acc': 81.013, 'test/acc_unbiased': 81.116, 'test/diff': 5.565, 'test/acc_skew': 78.333, 'test/acc_align': 83.898}
[5 / 20] best valid accuracy: 80.544 at epoch 5 
 best_stats: {'best_valid_epoch': 5, 'best_valid_valid/acc': 80.253, 'best_valid_valid/acc_unbiased': 80.544, 'best_valid_valid/diff': 5.276, 'best_valid_valid/acc_skew': 77.906, 'best_valid_valid/acc_align': 83.182, 'best_valid_test/acc': 81.013, 'best_valid_test/acc_unbiased': 81.116, 'best_valid_test/diff': 5.565, 'best_valid_test/acc_skew': 78.333, 'best_valid_test/acc_align': 83.898}
[5 / 20] best test accuracy: 81.116 at epoch 5 
 best_stats: {'best_test_epoch': 5, 'best_test_valid/acc': 80.253, 'best_test_valid/acc_unbiased': 80.544, 'best_test_valid/diff': 5.276, 'best_test_valid/acc_skew': 77.906, 'best_test_valid/acc_align': 83.182, 'best_test_test/acc': 81.013, 'best_test_test/acc_unbiased': 81.116, 'best_test_test/diff': 5.565, 'best_test_test/acc_skew': 78.333, 'best_test_test/acc_align': 83.898}
[6 / 20] Learning rate: 0.001 weight: 0.01
[6 / 20] Loss: 4.635165973428752 CE Loss: 0.47371810879749227 Con Loss: 4.630428779177575
[6 / 20] tensor([[0.744, 0.619],
        [0.866, 0.915]]) {'epoch': 6, 'valid/acc': 78.228, 'valid/acc_unbiased': 79.111, 'valid/diff': 4.326, 'valid/acc_skew': 76.948, 'valid/acc_align': 81.274, 'test/acc': 78.059, 'test/acc_unbiased': 78.594, 'test/diff': 8.716, 'test/acc_skew': 74.235, 'test/acc_align': 82.952}
[6 / 20] best valid accuracy: 80.544 at epoch 5 
 best_stats: {'best_valid_epoch': 5, 'best_valid_valid/acc': 80.253, 'best_valid_valid/acc_unbiased': 80.544, 'best_valid_valid/diff': 5.276, 'best_valid_valid/acc_skew': 77.906, 'best_valid_valid/acc_align': 83.182, 'best_valid_test/acc': 81.013, 'best_valid_test/acc_unbiased': 81.116, 'best_valid_test/diff': 5.565, 'best_valid_test/acc_skew': 78.333, 'best_valid_test/acc_align': 83.898}
[6 / 20] best test accuracy: 81.116 at epoch 5 
 best_stats: {'best_test_epoch': 5, 'best_test_valid/acc': 80.253, 'best_test_valid/acc_unbiased': 80.544, 'best_test_valid/diff': 5.276, 'best_test_valid/acc_skew': 77.906, 'best_test_valid/acc_align': 83.182, 'best_test_test/acc': 81.013, 'best_test_test/acc_unbiased': 81.116, 'best_test_test/diff': 5.565, 'best_test_test/acc_skew': 78.333, 'best_test_test/acc_align': 83.898}
[7 / 20] Learning rate: 0.0001 weight: 0.01
[7 / 20] Loss: 4.555117040218057 CE Loss: 0.4458196117797673 Con Loss: 4.550658873199195
[7 / 20] tensor([[0.815, 0.719],
        [0.812, 0.883]]) {'epoch': 7, 'valid/acc': 81.646, 'valid/acc_unbiased': 82.05, 'valid/diff': 7.414, 'valid/acc_skew': 78.343, 'valid/acc_align': 85.757, 'test/acc': 80.633, 'test/acc_unbiased': 80.727, 'test/diff': 8.349, 'test/acc_skew': 76.552, 'test/acc_align': 84.901}
[7 / 20] best valid accuracy: 82.050 at epoch 7 
 best_stats: {'best_valid_epoch': 7, 'best_valid_valid/acc': 81.646, 'best_valid_valid/acc_unbiased': 82.05, 'best_valid_valid/diff': 7.414, 'best_valid_valid/acc_skew': 78.343, 'best_valid_valid/acc_align': 85.757, 'best_valid_test/acc': 80.633, 'best_valid_test/acc_unbiased': 80.727, 'best_valid_test/diff': 8.349, 'best_valid_test/acc_skew': 76.552, 'best_valid_test/acc_align': 84.901}
[7 / 20] best test accuracy: 81.116 at epoch 5 
 best_stats: {'best_test_epoch': 5, 'best_test_valid/acc': 80.253, 'best_test_valid/acc_unbiased': 80.544, 'best_test_valid/diff': 5.276, 'best_test_valid/acc_skew': 77.906, 'best_test_valid/acc_align': 83.182, 'best_test_test/acc': 81.013, 'best_test_test/acc_unbiased': 81.116, 'best_test_test/diff': 5.565, 'best_test_test/acc_skew': 78.333, 'best_test_test/acc_align': 83.898}
[8 / 20] Learning rate: 0.0001 weight: 0.01
[8 / 20] Loss: 4.503994472553929 CE Loss: 0.43108711152788837 Con Loss: 4.499683611913097
[8 / 20] tensor([[0.814, 0.716],
        [0.810, 0.892]]) {'epoch': 8, 'valid/acc': 81.73, 'valid/acc_unbiased': 82.082, 'valid/diff': 7.332, 'valid/acc_skew': 78.416, 'valid/acc_align': 85.748, 'test/acc': 80.717, 'test/acc_unbiased': 80.777, 'test/diff': 8.962, 'test/acc_skew': 76.296, 'test/acc_align': 85.258}
[8 / 20] best valid accuracy: 82.082 at epoch 8 
 best_stats: {'best_valid_epoch': 8, 'best_valid_valid/acc': 81.73, 'best_valid_valid/acc_unbiased': 82.082, 'best_valid_valid/diff': 7.332, 'best_valid_valid/acc_skew': 78.416, 'best_valid_valid/acc_align': 85.748, 'best_valid_test/acc': 80.717, 'best_valid_test/acc_unbiased': 80.777, 'best_valid_test/diff': 8.962, 'best_valid_test/acc_skew': 76.296, 'best_valid_test/acc_align': 85.258}
[8 / 20] best test accuracy: 81.116 at epoch 5 
 best_stats: {'best_test_epoch': 5, 'best_test_valid/acc': 80.253, 'best_test_valid/acc_unbiased': 80.544, 'best_test_valid/diff': 5.276, 'best_test_valid/acc_skew': 77.906, 'best_test_valid/acc_align': 83.182, 'best_test_test/acc': 81.013, 'best_test_test/acc_unbiased': 81.116, 'best_test_test/diff': 5.565, 'best_test_test/acc_skew': 78.333, 'best_test_test/acc_align': 83.898}
[9 / 20] Learning rate: 0.0001 weight: 0.01
[9 / 20] Loss: 4.46756093568369 CE Loss: 0.42771353959862696 Con Loss: 4.463283809700962
[9 / 20] tensor([[0.815, 0.709],
        [0.812, 0.895]]) {'epoch': 9, 'valid/acc': 82.321, 'valid/acc_unbiased': 82.613, 'valid/diff': 7.956, 'valid/acc_skew': 78.635, 'valid/acc_align': 86.591, 'test/acc': 80.675, 'test/acc_unbiased': 80.765, 'test/diff': 9.461, 'test/acc_skew': 76.035, 'test/acc_align': 85.496}
[9 / 20] best valid accuracy: 82.613 at epoch 9 
 best_stats: {'best_valid_epoch': 9, 'best_valid_valid/acc': 82.321, 'best_valid_valid/acc_unbiased': 82.613, 'best_valid_valid/diff': 7.956, 'best_valid_valid/acc_skew': 78.635, 'best_valid_valid/acc_align': 86.591, 'best_valid_test/acc': 80.675, 'best_valid_test/acc_unbiased': 80.765, 'best_valid_test/diff': 9.461, 'best_valid_test/acc_skew': 76.035, 'best_valid_test/acc_align': 85.496}
[9 / 20] best test accuracy: 81.116 at epoch 5 
 best_stats: {'best_test_epoch': 5, 'best_test_valid/acc': 80.253, 'best_test_valid/acc_unbiased': 80.544, 'best_test_valid/diff': 5.276, 'best_test_valid/acc_skew': 77.906, 'best_test_valid/acc_align': 83.182, 'best_test_test/acc': 81.013, 'best_test_test/acc_unbiased': 81.116, 'best_test_test/diff': 5.565, 'best_test_test/acc_skew': 78.333, 'best_test_test/acc_align': 83.898}
[10 / 20] Learning rate: 0.0001 weight: 0.01
[10 / 20] Loss: 4.433967358545887 CE Loss: 0.4240213217620096 Con Loss: 4.429727159167802
[10 / 20] tensor([[0.815, 0.691],
        [0.803, 0.893]]) {'epoch': 10, 'valid/acc': 82.025, 'valid/acc_unbiased': 82.362, 'valid/diff': 7.308, 'valid/acc_skew': 78.708, 'valid/acc_align': 86.016, 'test/acc': 79.958, 'test/acc_unbiased': 80.069, 'test/diff': 10.706, 'test/acc_skew': 74.716, 'test/acc_align': 85.421}
[10 / 20] best valid accuracy: 82.613 at epoch 9 
 best_stats: {'best_valid_epoch': 9, 'best_valid_valid/acc': 82.321, 'best_valid_valid/acc_unbiased': 82.613, 'best_valid_valid/diff': 7.956, 'best_valid_valid/acc_skew': 78.635, 'best_valid_valid/acc_align': 86.591, 'best_valid_test/acc': 80.675, 'best_valid_test/acc_unbiased': 80.765, 'best_valid_test/diff': 9.461, 'best_valid_test/acc_skew': 76.035, 'best_valid_test/acc_align': 85.496}
[10 / 20] best test accuracy: 81.116 at epoch 5 
 best_stats: {'best_test_epoch': 5, 'best_test_valid/acc': 80.253, 'best_test_valid/acc_unbiased': 80.544, 'best_test_valid/diff': 5.276, 'best_test_valid/acc_skew': 77.906, 'best_test_valid/acc_align': 83.182, 'best_test_test/acc': 81.013, 'best_test_test/acc_unbiased': 81.116, 'best_test_test/diff': 5.565, 'best_test_test/acc_skew': 78.333, 'best_test_test/acc_align': 83.898}
[11 / 20] Learning rate: 0.0001 weight: 0.01
[11 / 20] Loss: 4.427062216824354 CE Loss: 0.4125107684735847 Con Loss: 4.42293707902051
[11 / 20] tensor([[0.815, 0.697],
        [0.823, 0.906]]) {'epoch': 11, 'valid/acc': 82.363, 'valid/acc_unbiased': 82.749, 'valid/diff': 9.471, 'valid/acc_skew': 78.013, 'valid/acc_align': 87.485, 'test/acc': 80.886, 'test/acc_unbiased': 81.038, 'test/diff': 10.105, 'test/acc_skew': 75.985, 'test/acc_align': 86.09}
[11 / 20] best valid accuracy: 82.749 at epoch 11 
 best_stats: {'best_valid_epoch': 11, 'best_valid_valid/acc': 82.363, 'best_valid_valid/acc_unbiased': 82.749, 'best_valid_valid/diff': 9.471, 'best_valid_valid/acc_skew': 78.013, 'best_valid_valid/acc_align': 87.485, 'best_valid_test/acc': 80.886, 'best_valid_test/acc_unbiased': 81.038, 'best_valid_test/diff': 10.105, 'best_valid_test/acc_skew': 75.985, 'best_valid_test/acc_align': 86.09}
[11 / 20] best test accuracy: 81.116 at epoch 5 
 best_stats: {'best_test_epoch': 5, 'best_test_valid/acc': 80.253, 'best_test_valid/acc_unbiased': 80.544, 'best_test_valid/diff': 5.276, 'best_test_valid/acc_skew': 77.906, 'best_test_valid/acc_align': 83.182, 'best_test_test/acc': 81.013, 'best_test_test/acc_unbiased': 81.116, 'best_test_test/diff': 5.565, 'best_test_test/acc_skew': 78.333, 'best_test_test/acc_align': 83.898}
[12 / 20] Learning rate: 0.0001 weight: 0.01
[12 / 20] Loss: 4.417298168947546 CE Loss: 0.4160795045108432 Con Loss: 4.413137396816628
[12 / 20] tensor([[0.832, 0.699],
        [0.814, 0.895]]) {'epoch': 12, 'valid/acc': 82.532, 'valid/acc_unbiased': 82.833, 'valid/diff': 8.613, 'valid/acc_skew': 78.526, 'valid/acc_align': 87.139, 'test/acc': 80.802, 'test/acc_unbiased': 80.964, 'test/diff': 10.676, 'test/acc_skew': 75.626, 'test/acc_align': 86.302}
[12 / 20] best valid accuracy: 82.833 at epoch 12 
 best_stats: {'best_valid_epoch': 12, 'best_valid_valid/acc': 82.532, 'best_valid_valid/acc_unbiased': 82.833, 'best_valid_valid/diff': 8.613, 'best_valid_valid/acc_skew': 78.526, 'best_valid_valid/acc_align': 87.139, 'best_valid_test/acc': 80.802, 'best_valid_test/acc_unbiased': 80.964, 'best_valid_test/diff': 10.676, 'best_valid_test/acc_skew': 75.626, 'best_valid_test/acc_align': 86.302}
[12 / 20] best test accuracy: 81.116 at epoch 5 
 best_stats: {'best_test_epoch': 5, 'best_test_valid/acc': 80.253, 'best_test_valid/acc_unbiased': 80.544, 'best_test_valid/diff': 5.276, 'best_test_valid/acc_skew': 77.906, 'best_test_valid/acc_align': 83.182, 'best_test_test/acc': 81.013, 'best_test_test/acc_unbiased': 81.116, 'best_test_test/diff': 5.565, 'best_test_test/acc_skew': 78.333, 'best_test_test/acc_align': 83.898}
[13 / 20] Learning rate: 0.0001 weight: 0.01
[13 / 20] Loss: 4.387015120002221 CE Loss: 0.40878152568029624 Con Loss: 4.382927312334321
[13 / 20] tensor([[0.819, 0.671],
        [0.833, 0.906]]) {'epoch': 13, 'valid/acc': 80.886, 'valid/acc_unbiased': 81.262, 'valid/diff': 10.659, 'valid/acc_skew': 75.932, 'valid/acc_align': 86.591, 'test/acc': 80.422, 'test/acc_unbiased': 80.733, 'test/diff': 11.072, 'test/acc_skew': 75.197, 'test/acc_align': 86.269}
[13 / 20] best valid accuracy: 82.833 at epoch 12 
 best_stats: {'best_valid_epoch': 12, 'best_valid_valid/acc': 82.532, 'best_valid_valid/acc_unbiased': 82.833, 'best_valid_valid/diff': 8.613, 'best_valid_valid/acc_skew': 78.526, 'best_valid_valid/acc_align': 87.139, 'best_valid_test/acc': 80.802, 'best_valid_test/acc_unbiased': 80.964, 'best_valid_test/diff': 10.676, 'best_valid_test/acc_skew': 75.626, 'best_valid_test/acc_align': 86.302}
[13 / 20] best test accuracy: 81.116 at epoch 5 
 best_stats: {'best_test_epoch': 5, 'best_test_valid/acc': 80.253, 'best_test_valid/acc_unbiased': 80.544, 'best_test_valid/diff': 5.276, 'best_test_valid/acc_skew': 77.906, 'best_test_valid/acc_align': 83.182, 'best_test_test/acc': 81.013, 'best_test_test/acc_unbiased': 81.116, 'best_test_test/diff': 5.565, 'best_test_test/acc_skew': 78.333, 'best_test_test/acc_align': 83.898}
[14 / 20] Learning rate: 1e-05 weight: 0.01
[14 / 20] Loss: 4.388380280350871 CE Loss: 0.40555155329613524 Con Loss: 4.384324783811109
[14 / 20] tensor([[0.826, 0.678],
        [0.801, 0.897]]) {'epoch': 14, 'valid/acc': 80.97, 'valid/acc_unbiased': 81.297, 'valid/diff': 10.655, 'valid/acc_skew': 75.969, 'valid/acc_align': 86.625, 'test/acc': 79.916, 'test/acc_unbiased': 80.062, 'test/diff': 12.239, 'test/acc_skew': 73.943, 'test/acc_align': 86.182}
[14 / 20] best valid accuracy: 82.833 at epoch 12 
 best_stats: {'best_valid_epoch': 12, 'best_valid_valid/acc': 82.532, 'best_valid_valid/acc_unbiased': 82.833, 'best_valid_valid/diff': 8.613, 'best_valid_valid/acc_skew': 78.526, 'best_valid_valid/acc_align': 87.139, 'best_valid_test/acc': 80.802, 'best_valid_test/acc_unbiased': 80.964, 'best_valid_test/diff': 10.676, 'best_valid_test/acc_skew': 75.626, 'best_valid_test/acc_align': 86.302}
[14 / 20] best test accuracy: 81.116 at epoch 5 
 best_stats: {'best_test_epoch': 5, 'best_test_valid/acc': 80.253, 'best_test_valid/acc_unbiased': 80.544, 'best_test_valid/diff': 5.276, 'best_test_valid/acc_skew': 77.906, 'best_test_valid/acc_align': 83.182, 'best_test_test/acc': 81.013, 'best_test_test/acc_unbiased': 81.116, 'best_test_test/diff': 5.565, 'best_test_test/acc_skew': 78.333, 'best_test_test/acc_align': 83.898}
[15 / 20] Learning rate: 1e-05 weight: 0.01
[15 / 20] Loss: 4.397544984412577 CE Loss: 0.40801507732005976 Con Loss: 4.393464834065249
[15 / 20] tensor([[0.823, 0.666],
        [0.825, 0.905]]) {'epoch': 15, 'valid/acc': 81.013, 'valid/acc_unbiased': 81.46, 'valid/diff': 10.401, 'valid/acc_skew': 76.26, 'valid/acc_align': 86.66, 'test/acc': 80.169, 'test/acc_unbiased': 80.458, 'test/diff': 11.832, 'test/acc_skew': 74.542, 'test/acc_align': 86.374}
[15 / 20] best valid accuracy: 82.833 at epoch 12 
 best_stats: {'best_valid_epoch': 12, 'best_valid_valid/acc': 82.532, 'best_valid_valid/acc_unbiased': 82.833, 'best_valid_valid/diff': 8.613, 'best_valid_valid/acc_skew': 78.526, 'best_valid_valid/acc_align': 87.139, 'best_valid_test/acc': 80.802, 'best_valid_test/acc_unbiased': 80.964, 'best_valid_test/diff': 10.676, 'best_valid_test/acc_skew': 75.626, 'best_valid_test/acc_align': 86.302}
[15 / 20] best test accuracy: 81.116 at epoch 5 
 best_stats: {'best_test_epoch': 5, 'best_test_valid/acc': 80.253, 'best_test_valid/acc_unbiased': 80.544, 'best_test_valid/diff': 5.276, 'best_test_valid/acc_skew': 77.906, 'best_test_valid/acc_align': 83.182, 'best_test_test/acc': 81.013, 'best_test_test/acc_unbiased': 81.116, 'best_test_test/diff': 5.565, 'best_test_test/acc_skew': 78.333, 'best_test_test/acc_align': 83.898}
[16 / 20] Learning rate: 1e-05 weight: 0.01
[16 / 20] Loss: 4.367484836243257 CE Loss: 0.4031054160256337 Con Loss: 4.363453780574994
[16 / 20] tensor([[0.823, 0.678],
        [0.825, 0.903]]) {'epoch': 16, 'valid/acc': 81.013, 'valid/acc_unbiased': 81.458, 'valid/diff': 9.957, 'valid/acc_skew': 76.479, 'valid/acc_align': 86.437, 'test/acc': 80.464, 'test/acc_unbiased': 80.717, 'test/diff': 11.167, 'test/acc_skew': 75.133, 'test/acc_align': 86.3}
[16 / 20] best valid accuracy: 82.833 at epoch 12 
 best_stats: {'best_valid_epoch': 12, 'best_valid_valid/acc': 82.532, 'best_valid_valid/acc_unbiased': 82.833, 'best_valid_valid/diff': 8.613, 'best_valid_valid/acc_skew': 78.526, 'best_valid_valid/acc_align': 87.139, 'best_valid_test/acc': 80.802, 'best_valid_test/acc_unbiased': 80.964, 'best_valid_test/diff': 10.676, 'best_valid_test/acc_skew': 75.626, 'best_valid_test/acc_align': 86.302}
[16 / 20] best test accuracy: 81.116 at epoch 5 
 best_stats: {'best_test_epoch': 5, 'best_test_valid/acc': 80.253, 'best_test_valid/acc_unbiased': 80.544, 'best_test_valid/diff': 5.276, 'best_test_valid/acc_skew': 77.906, 'best_test_valid/acc_align': 83.182, 'best_test_test/acc': 81.013, 'best_test_test/acc_unbiased': 81.116, 'best_test_test/diff': 5.565, 'best_test_test/acc_skew': 78.333, 'best_test_test/acc_align': 83.898}
[17 / 20] Learning rate: 1e-05 weight: 0.01
[17 / 20] Loss: 4.369869048564012 CE Loss: 0.40996258285872933 Con Loss: 4.365769426784264
[17 / 20] tensor([[0.817, 0.668],
        [0.833, 0.911]]) {'epoch': 17, 'valid/acc': 81.055, 'valid/acc_unbiased': 81.567, 'valid/diff': 9.811, 'valid/acc_skew': 76.661, 'valid/acc_align': 86.472, 'test/acc': 80.422, 'test/acc_unbiased': 80.726, 'test/diff': 11.353, 'test/acc_skew': 75.049, 'test/acc_align': 86.403}
[17 / 20] best valid accuracy: 82.833 at epoch 12 
 best_stats: {'best_valid_epoch': 12, 'best_valid_valid/acc': 82.532, 'best_valid_valid/acc_unbiased': 82.833, 'best_valid_valid/diff': 8.613, 'best_valid_valid/acc_skew': 78.526, 'best_valid_valid/acc_align': 87.139, 'best_valid_test/acc': 80.802, 'best_valid_test/acc_unbiased': 80.964, 'best_valid_test/diff': 10.676, 'best_valid_test/acc_skew': 75.626, 'best_valid_test/acc_align': 86.302}
[17 / 20] best test accuracy: 81.116 at epoch 5 
 best_stats: {'best_test_epoch': 5, 'best_test_valid/acc': 80.253, 'best_test_valid/acc_unbiased': 80.544, 'best_test_valid/diff': 5.276, 'best_test_valid/acc_skew': 77.906, 'best_test_valid/acc_align': 83.182, 'best_test_test/acc': 81.013, 'best_test_test/acc_unbiased': 81.116, 'best_test_test/diff': 5.565, 'best_test_test/acc_skew': 78.333, 'best_test_test/acc_align': 83.898}
[18 / 20] Learning rate: 1e-05 weight: 0.01
[18 / 20] Loss: 4.36792614309889 CE Loss: 0.4073808124264372 Con Loss: 4.363852352907507
[18 / 20] tensor([[0.837, 0.687],
        [0.810, 0.897]]) {'epoch': 18, 'valid/acc': 82.11, 'valid/acc_unbiased': 82.458, 'valid/diff': 8.815, 'valid/acc_skew': 78.051, 'valid/acc_align': 86.865, 'test/acc': 80.591, 'test/acc_unbiased': 80.769, 'test/diff': 11.901, 'test/acc_skew': 74.819, 'test/acc_align': 86.72}
[18 / 20] best valid accuracy: 82.833 at epoch 12 
 best_stats: {'best_valid_epoch': 12, 'best_valid_valid/acc': 82.532, 'best_valid_valid/acc_unbiased': 82.833, 'best_valid_valid/diff': 8.613, 'best_valid_valid/acc_skew': 78.526, 'best_valid_valid/acc_align': 87.139, 'best_valid_test/acc': 80.802, 'best_valid_test/acc_unbiased': 80.964, 'best_valid_test/diff': 10.676, 'best_valid_test/acc_skew': 75.626, 'best_valid_test/acc_align': 86.302}
[18 / 20] best test accuracy: 81.116 at epoch 5 
 best_stats: {'best_test_epoch': 5, 'best_test_valid/acc': 80.253, 'best_test_valid/acc_unbiased': 80.544, 'best_test_valid/diff': 5.276, 'best_test_valid/acc_skew': 77.906, 'best_test_valid/acc_align': 83.182, 'best_test_test/acc': 81.013, 'best_test_test/acc_unbiased': 81.116, 'best_test_test/diff': 5.565, 'best_test_test/acc_skew': 78.333, 'best_test_test/acc_align': 83.898}
[19 / 20] Learning rate: 1e-05 weight: 0.01
[19 / 20] Loss: 4.371745339249797 CE Loss: 0.40975112242196 Con Loss: 4.367647807036103
[19 / 20] tensor([[0.841, 0.697],
        [0.803, 0.890]]) {'epoch': 19, 'valid/acc': 82.363, 'valid/acc_unbiased': 82.618, 'valid/diff': 9.352, 'valid/acc_skew': 77.942, 'valid/acc_align': 87.294, 'test/acc': 80.633, 'test/acc_unbiased': 80.769, 'test/diff': 11.516, 'test/acc_skew': 75.011, 'test/acc_align': 86.527}
[19 / 20] best valid accuracy: 82.833 at epoch 12 
 best_stats: {'best_valid_epoch': 12, 'best_valid_valid/acc': 82.532, 'best_valid_valid/acc_unbiased': 82.833, 'best_valid_valid/diff': 8.613, 'best_valid_valid/acc_skew': 78.526, 'best_valid_valid/acc_align': 87.139, 'best_valid_test/acc': 80.802, 'best_valid_test/acc_unbiased': 80.964, 'best_valid_test/diff': 10.676, 'best_valid_test/acc_skew': 75.626, 'best_valid_test/acc_align': 86.302}
[19 / 20] best test accuracy: 81.116 at epoch 5 
 best_stats: {'best_test_epoch': 5, 'best_test_valid/acc': 80.253, 'best_test_valid/acc_unbiased': 80.544, 'best_test_valid/diff': 5.276, 'best_test_valid/acc_skew': 77.906, 'best_test_valid/acc_align': 83.182, 'best_test_test/acc': 81.013, 'best_test_test/acc_unbiased': 81.116, 'best_test_test/diff': 5.565, 'best_test_test/acc_skew': 78.333, 'best_test_test/acc_align': 83.898}
[20 / 20] Learning rate: 1e-05 weight: 0.01
[20 / 20] Loss: 4.368193365993472 CE Loss: 0.40262007621685547 Con Loss: 4.364167155493405
[20 / 20] tensor([[0.837, 0.687],
        [0.825, 0.897]]) {'epoch': 20, 'valid/acc': 81.899, 'valid/acc_unbiased': 82.267, 'valid/diff': 8.871, 'valid/acc_skew': 77.831, 'valid/acc_align': 86.702, 'test/acc': 80.886, 'test/acc_unbiased': 81.148, 'test/diff': 11.143, 'test/acc_skew': 75.576, 'test/acc_align': 86.72}
[20 / 20] best valid accuracy: 82.833 at epoch 12 
 best_stats: {'best_valid_epoch': 12, 'best_valid_valid/acc': 82.532, 'best_valid_valid/acc_unbiased': 82.833, 'best_valid_valid/diff': 8.613, 'best_valid_valid/acc_skew': 78.526, 'best_valid_valid/acc_align': 87.139, 'best_valid_test/acc': 80.802, 'best_valid_test/acc_unbiased': 80.964, 'best_valid_test/diff': 10.676, 'best_valid_test/acc_skew': 75.626, 'best_valid_test/acc_align': 86.302}
[20 / 20] best test accuracy: 81.148 at epoch 20 
 best_stats: {'best_test_epoch': 20, 'best_test_valid/acc': 81.899, 'best_test_valid/acc_unbiased': 82.267, 'best_test_valid/diff': 8.871, 'best_test_valid/acc_skew': 77.831, 'best_test_valid/acc_align': 86.702, 'best_test_test/acc': 80.886, 'best_test_test/acc_unbiased': 81.148, 'best_test_test/diff': 11.143, 'best_test_test/acc_skew': 75.576, 'best_test_test/acc_align': 86.72}
Total training time: 0:12:23
