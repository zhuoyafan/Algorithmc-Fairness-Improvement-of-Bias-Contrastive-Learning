Log level set to: INFO
Set seed: 1
=======> Using Fixed Random Seed: 1 <========
save_path: exp_results/bc-bb0-celeba_blonde-crop_auto2-lr0.001-bs128-cbs64-w0.01-ratio30-aug1-seed1
get_celeba - split:train, aug: False, given_y: True, ratio: 0
use existing blonde indices from data/celeba/pickles/blonde
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [1558, 53577]
Target 1: [18279, 1098]
Binary Target 1
---------------------------
Target 0: [1558, 53577]
Target 1: [18279, 1098]
===================================
Normal Label Distribution: 
Target 0: [1558, 53577]
Target 1: [18279, 1098]
===================================
Use BiasedCelebASplit 
 target_attr: blonde split: train 
 tensor([[ 1558., 18279.],
        [53577.,  1098.]])
get_celeba - split:train, aug: 1, given_y: True, ratio: 30
use existing blonde indices from data/celeba/pickles/blonde
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [1606, 53425]
Target 1: [18350, 1131]
Binary Target 1
---------------------------
Target 0: [1606, 53425]
Target 1: [18350, 1131]
===================================
Normal Label Distribution: 
Target 0: [1606, 53425]
Target 1: [18350, 1131]
===================================
Use BiasedCelebASplit 
 target_attr: blonde split: train 
 tensor([[ 1606., 18350.],
        [53425.,  1131.]])
get_celeba - split:train_valid, aug: False, given_y: True, ratio: 0
use existing blonde indices from data/celeba/pickles/blonde
Use BiasedCelebASplit 
 target_attr: blonde split: train_valid 
 tensor([[  390.,  4598.],
        [13361.,   280.]])
get_celeba - split:valid, aug: False, given_y: True, ratio: 0
Use BiasedCelebASplit 
 target_attr: blonde split: valid 
 tensor([[8535., 2874.],
        [8276.,  182.]])
decay_epochs: [3, 6]
[1 / 10] Learning rate: 0.001 weight: 0.01
[1 / 10] Loss: 4.7570184586205295 CE Loss: 0.2172999429759074 Con Loss: 4.75484545537528
[1 / 10] tensor([[0.896, 0.958],
        [0.835, 0.753]]) {'epoch': 1, 'valid/acc': 92.018, 'valid/acc_unbiased': 86.527, 'valid/diff': 6.203, 'valid/acc_skew': 83.425, 'valid/acc_align': 89.628, 'test/acc': 91.151, 'test/acc_unbiased': 86.034, 'test/diff': 7.21, 'test/acc_skew': 82.429, 'test/acc_align': 89.639}
[1 / 10] best valid accuracy: 86.527 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 92.018, 'best_valid_valid/acc_unbiased': 86.527, 'best_valid_valid/diff': 6.203, 'best_valid_valid/acc_skew': 83.425, 'best_valid_valid/acc_align': 89.628, 'best_valid_test/acc': 91.151, 'best_valid_test/acc_unbiased': 86.034, 'best_valid_test/diff': 7.21, 'best_valid_test/acc_skew': 82.429, 'best_valid_test/acc_align': 89.639}
[1 / 10] best test accuracy: 86.034 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 92.018, 'best_test_valid/acc_unbiased': 86.527, 'best_test_valid/diff': 6.203, 'best_test_valid/acc_skew': 83.425, 'best_test_valid/acc_align': 89.628, 'best_test_test/acc': 91.151, 'best_test_test/acc_unbiased': 86.034, 'best_test_test/diff': 7.21, 'best_test_test/acc_skew': 82.429, 'best_test_test/acc_align': 89.639}
[2 / 10] Learning rate: 0.001 weight: 0.01
[2 / 10] Loss: 4.719508615255816 CE Loss: 0.18421301539424972 Con Loss: 4.717666489079144
[2 / 10] tensor([[0.921, 0.976],
        [0.865, 0.687]]) {'epoch': 2, 'valid/acc': 93.558, 'valid/acc_unbiased': 86.752, 'valid/diff': 8.422, 'valid/acc_skew': 82.541, 'valid/acc_align': 90.963, 'test/acc': 93.376, 'test/acc_unbiased': 86.232, 'test/diff': 11.667, 'test/acc_skew': 80.398, 'test/acc_align': 92.065}
[2 / 10] best valid accuracy: 86.752 at epoch 2 
 best_stats: {'best_valid_epoch': 2, 'best_valid_valid/acc': 93.558, 'best_valid_valid/acc_unbiased': 86.752, 'best_valid_valid/diff': 8.422, 'best_valid_valid/acc_skew': 82.541, 'best_valid_valid/acc_align': 90.963, 'best_valid_test/acc': 93.376, 'best_valid_test/acc_unbiased': 86.232, 'best_valid_test/diff': 11.667, 'best_valid_test/acc_skew': 80.398, 'best_valid_test/acc_align': 92.065}
[2 / 10] best test accuracy: 86.232 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 93.558, 'best_test_valid/acc_unbiased': 86.752, 'best_test_valid/diff': 8.422, 'best_test_valid/acc_skew': 82.541, 'best_test_valid/acc_align': 90.963, 'best_test_test/acc': 93.376, 'best_test_test/acc_unbiased': 86.232, 'best_test_test/diff': 11.667, 'best_test_test/acc_skew': 80.398, 'best_test_test/acc_align': 92.065}
[3 / 10] Learning rate: 0.001 weight: 0.01
[3 / 10] Loss: 4.704031776967211 CE Loss: 0.1747246347951715 Con Loss: 4.702284525411948
[3 / 10] tensor([[0.946, 0.977],
        [0.805, 0.687]]) {'epoch': 3, 'valid/acc': 92.63, 'valid/acc_unbiased': 85.639, 'valid/diff': 7.493, 'valid/acc_skew': 82.239, 'valid/acc_align': 89.039, 'test/acc': 93.592, 'test/acc_unbiased': 85.36, 'test/diff': 7.463, 'test/acc_skew': 81.628, 'test/acc_align': 89.091}
[3 / 10] best valid accuracy: 86.752 at epoch 2 
 best_stats: {'best_valid_epoch': 2, 'best_valid_valid/acc': 93.558, 'best_valid_valid/acc_unbiased': 86.752, 'best_valid_valid/diff': 8.422, 'best_valid_valid/acc_skew': 82.541, 'best_valid_valid/acc_align': 90.963, 'best_valid_test/acc': 93.376, 'best_valid_test/acc_unbiased': 86.232, 'best_valid_test/diff': 11.667, 'best_valid_test/acc_skew': 80.398, 'best_valid_test/acc_align': 92.065}
[3 / 10] best test accuracy: 86.232 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 93.558, 'best_test_valid/acc_unbiased': 86.752, 'best_test_valid/diff': 8.422, 'best_test_valid/acc_skew': 82.541, 'best_test_valid/acc_align': 90.963, 'best_test_test/acc': 93.376, 'best_test_test/acc_unbiased': 86.232, 'best_test_test/diff': 11.667, 'best_test_test/acc_skew': 80.398, 'best_test_test/acc_align': 92.065}
[4 / 10] Learning rate: 0.0001 weight: 0.01
[4 / 10] Loss: 4.646164713280637 CE Loss: 0.15489009225815822 Con Loss: 4.644615814105774
[4 / 10] tensor([[0.923, 0.973],
        [0.894, 0.802]]) {'epoch': 4, 'valid/acc': 94.471, 'valid/acc_unbiased': 90.043, 'valid/diff': 6.415, 'valid/acc_skew': 87.161, 'valid/acc_align': 92.924, 'test/acc': 93.859, 'test/acc_unbiased': 89.812, 'test/diff': 7.067, 'test/acc_skew': 86.279, 'test/acc_align': 93.346}
[4 / 10] best valid accuracy: 90.043 at epoch 4 
 best_stats: {'best_valid_epoch': 4, 'best_valid_valid/acc': 94.471, 'best_valid_valid/acc_unbiased': 90.043, 'best_valid_valid/diff': 6.415, 'best_valid_valid/acc_skew': 87.161, 'best_valid_valid/acc_align': 92.924, 'best_valid_test/acc': 93.859, 'best_valid_test/acc_unbiased': 89.812, 'best_valid_test/diff': 7.067, 'best_valid_test/acc_skew': 86.279, 'best_valid_test/acc_align': 93.346}
[4 / 10] best test accuracy: 89.812 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 94.471, 'best_test_valid/acc_unbiased': 90.043, 'best_test_valid/diff': 6.415, 'best_test_valid/acc_skew': 87.161, 'best_test_valid/acc_align': 92.924, 'best_test_test/acc': 93.859, 'best_test_test/acc_unbiased': 89.812, 'best_test_test/diff': 7.067, 'best_test_test/acc_skew': 86.279, 'best_test_test/acc_align': 93.346}
[5 / 10] Learning rate: 0.0001 weight: 0.01
[5 / 10] Loss: 4.623378798100015 CE Loss: 0.14494572898874167 Con Loss: 4.621929348705407
[5 / 10] tensor([[0.932, 0.974],
        [0.883, 0.802]]) {'epoch': 5, 'valid/acc': 94.315, 'valid/acc_unbiased': 90.513, 'valid/diff': 4.818, 'valid/acc_skew': 88.539, 'valid/acc_align': 92.486, 'test/acc': 94.131, 'test/acc_unbiased': 89.787, 'test/diff': 6.126, 'test/acc_skew': 86.724, 'test/acc_align': 92.85}
[5 / 10] best valid accuracy: 90.513 at epoch 5 
 best_stats: {'best_valid_epoch': 5, 'best_valid_valid/acc': 94.315, 'best_valid_valid/acc_unbiased': 90.513, 'best_valid_valid/diff': 4.818, 'best_valid_valid/acc_skew': 88.539, 'best_valid_valid/acc_align': 92.486, 'best_valid_test/acc': 94.131, 'best_valid_test/acc_unbiased': 89.787, 'best_valid_test/diff': 6.126, 'best_valid_test/acc_skew': 86.724, 'best_valid_test/acc_align': 92.85}
[5 / 10] best test accuracy: 89.812 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 94.471, 'best_test_valid/acc_unbiased': 90.043, 'best_test_valid/diff': 6.415, 'best_test_valid/acc_skew': 87.161, 'best_test_valid/acc_align': 92.924, 'best_test_test/acc': 93.859, 'best_test_test/acc_unbiased': 89.812, 'best_test_test/diff': 7.067, 'best_test_test/acc_skew': 86.279, 'best_test_test/acc_align': 93.346}
[6 / 10] Learning rate: 0.0001 weight: 0.01
[6 / 10] Loss: 4.616909106555404 CE Loss: 0.13799963864948403 Con Loss: 4.61552911135473
[6 / 10] tensor([[0.920, 0.973],
        [0.911, 0.835]]) {'epoch': 6, 'valid/acc': 94.911, 'valid/acc_unbiased': 91.069, 'valid/diff': 5.543, 'valid/acc_skew': 88.462, 'valid/acc_align': 93.676, 'test/acc': 94.035, 'test/acc_unbiased': 91.004, 'test/diff': 6.448, 'test/acc_skew': 87.78, 'test/acc_align': 94.228}
[6 / 10] best valid accuracy: 91.069 at epoch 6 
 best_stats: {'best_valid_epoch': 6, 'best_valid_valid/acc': 94.911, 'best_valid_valid/acc_unbiased': 91.069, 'best_valid_valid/diff': 5.543, 'best_valid_valid/acc_skew': 88.462, 'best_valid_valid/acc_align': 93.676, 'best_valid_test/acc': 94.035, 'best_valid_test/acc_unbiased': 91.004, 'best_valid_test/diff': 6.448, 'best_valid_test/acc_skew': 87.78, 'best_valid_test/acc_align': 94.228}
[6 / 10] best test accuracy: 91.004 at epoch 6 
 best_stats: {'best_test_epoch': 6, 'best_test_valid/acc': 94.911, 'best_test_valid/acc_unbiased': 91.069, 'best_test_valid/diff': 5.543, 'best_test_valid/acc_skew': 88.462, 'best_test_valid/acc_align': 93.676, 'best_test_test/acc': 94.035, 'best_test_test/acc_unbiased': 91.004, 'best_test_test/diff': 6.448, 'best_test_test/acc_skew': 87.78, 'best_test_test/acc_align': 94.228}
[7 / 10] Learning rate: 1e-05 weight: 0.01
[7 / 10] Loss: 4.608366320669228 CE Loss: 0.13449274943907527 Con Loss: 4.607021390764606
[7 / 10] tensor([[0.913, 0.972],
        [0.909, 0.824]]) {'epoch': 7, 'valid/acc': 94.917, 'valid/acc_unbiased': 91.243, 'valid/diff': 6.124, 'valid/acc_skew': 88.59, 'valid/acc_align': 93.897, 'test/acc': 93.638, 'test/acc_unbiased': 90.469, 'test/diff': 7.202, 'test/acc_skew': 86.868, 'test/acc_align': 94.07}
[7 / 10] best valid accuracy: 91.243 at epoch 7 
 best_stats: {'best_valid_epoch': 7, 'best_valid_valid/acc': 94.917, 'best_valid_valid/acc_unbiased': 91.243, 'best_valid_valid/diff': 6.124, 'best_valid_valid/acc_skew': 88.59, 'best_valid_valid/acc_align': 93.897, 'best_valid_test/acc': 93.638, 'best_valid_test/acc_unbiased': 90.469, 'best_valid_test/diff': 7.202, 'best_valid_test/acc_skew': 86.868, 'best_valid_test/acc_align': 94.07}
[7 / 10] best test accuracy: 91.004 at epoch 6 
 best_stats: {'best_test_epoch': 6, 'best_test_valid/acc': 94.911, 'best_test_valid/acc_unbiased': 91.069, 'best_test_valid/diff': 5.543, 'best_test_valid/acc_skew': 88.462, 'best_test_valid/acc_align': 93.676, 'best_test_test/acc': 94.035, 'best_test_test/acc_unbiased': 91.004, 'best_test_test/diff': 6.448, 'best_test_test/acc_skew': 87.78, 'best_test_test/acc_align': 94.228}
[8 / 10] Learning rate: 1e-05 weight: 0.01
[8 / 10] Loss: 4.598843315268679 CE Loss: 0.132478866894946 Con Loss: 4.59751851911424
[8 / 10] tensor([[0.923, 0.977],
        [0.899, 0.758]]) {'epoch': 8, 'valid/acc': 94.981, 'valid/acc_unbiased': 90.459, 'valid/diff': 6.792, 'valid/acc_skew': 87.418, 'valid/acc_align': 93.501, 'test/acc': 94.04, 'test/acc_unbiased': 88.92, 'test/diff': 9.69, 'test/acc_skew': 84.075, 'test/acc_align': 93.765}
[8 / 10] best valid accuracy: 91.243 at epoch 7 
 best_stats: {'best_valid_epoch': 7, 'best_valid_valid/acc': 94.917, 'best_valid_valid/acc_unbiased': 91.243, 'best_valid_valid/diff': 6.124, 'best_valid_valid/acc_skew': 88.59, 'best_valid_valid/acc_align': 93.897, 'best_valid_test/acc': 93.638, 'best_valid_test/acc_unbiased': 90.469, 'best_valid_test/diff': 7.202, 'best_valid_test/acc_skew': 86.868, 'best_valid_test/acc_align': 94.07}
[8 / 10] best test accuracy: 91.004 at epoch 6 
 best_stats: {'best_test_epoch': 6, 'best_test_valid/acc': 94.911, 'best_test_valid/acc_unbiased': 91.069, 'best_test_valid/diff': 5.543, 'best_test_valid/acc_skew': 88.462, 'best_test_valid/acc_align': 93.676, 'best_test_test/acc': 94.035, 'best_test_test/acc_unbiased': 91.004, 'best_test_test/diff': 6.448, 'best_test_test/acc_skew': 87.78, 'best_test_test/acc_align': 94.228}
[9 / 10] Learning rate: 1e-05 weight: 0.01
[9 / 10] Loss: 4.597727621064975 CE Loss: 0.13400425820013268 Con Loss: 4.596387579534759
[9 / 10] tensor([[0.901, 0.967],
        [0.932, 0.852]]) {'epoch': 9, 'valid/acc': 95.072, 'valid/acc_unbiased': 92.347, 'valid/diff': 5.231, 'valid/acc_skew': 90.119, 'valid/acc_align': 94.574, 'test/acc': 93.225, 'test/acc_unbiased': 91.283, 'test/diff': 7.337, 'test/acc_skew': 87.615, 'test/acc_align': 94.951}
[9 / 10] best valid accuracy: 92.347 at epoch 9 
 best_stats: {'best_valid_epoch': 9, 'best_valid_valid/acc': 95.072, 'best_valid_valid/acc_unbiased': 92.347, 'best_valid_valid/diff': 5.231, 'best_valid_valid/acc_skew': 90.119, 'best_valid_valid/acc_align': 94.574, 'best_valid_test/acc': 93.225, 'best_valid_test/acc_unbiased': 91.283, 'best_valid_test/diff': 7.337, 'best_valid_test/acc_skew': 87.615, 'best_valid_test/acc_align': 94.951}
[9 / 10] best test accuracy: 91.283 at epoch 9 
 best_stats: {'best_test_epoch': 9, 'best_test_valid/acc': 95.072, 'best_test_valid/acc_unbiased': 92.347, 'best_test_valid/diff': 5.231, 'best_test_valid/acc_skew': 90.119, 'best_test_valid/acc_align': 94.574, 'best_test_test/acc': 93.225, 'best_test_test/acc_unbiased': 91.283, 'best_test_test/diff': 7.337, 'best_test_test/acc_skew': 87.615, 'best_test_test/acc_align': 94.951}
[10 / 10] Learning rate: 1e-05 weight: 0.01
[10 / 10] Loss: 4.599065953169305 CE Loss: 0.13237241873010075 Con Loss: 4.597742231408747
[10 / 10] tensor([[0.914, 0.973],
        [0.915, 0.808]]) {'epoch': 10, 'valid/acc': 95.067, 'valid/acc_unbiased': 91.063, 'valid/diff': 6.953, 'valid/acc_skew': 88.132, 'valid/acc_align': 93.995, 'test/acc': 93.753, 'test/acc_unbiased': 90.237, 'test/diff': 8.34, 'test/acc_skew': 86.067, 'test/acc_align': 94.407}
[10 / 10] best valid accuracy: 92.347 at epoch 9 
 best_stats: {'best_valid_epoch': 9, 'best_valid_valid/acc': 95.072, 'best_valid_valid/acc_unbiased': 92.347, 'best_valid_valid/diff': 5.231, 'best_valid_valid/acc_skew': 90.119, 'best_valid_valid/acc_align': 94.574, 'best_valid_test/acc': 93.225, 'best_valid_test/acc_unbiased': 91.283, 'best_valid_test/diff': 7.337, 'best_valid_test/acc_skew': 87.615, 'best_valid_test/acc_align': 94.951}
[10 / 10] best test accuracy: 91.283 at epoch 9 
 best_stats: {'best_test_epoch': 9, 'best_test_valid/acc': 95.072, 'best_test_valid/acc_unbiased': 92.347, 'best_test_valid/diff': 5.231, 'best_test_valid/acc_skew': 90.119, 'best_test_valid/acc_align': 94.574, 'best_test_test/acc': 93.225, 'best_test_test/acc_unbiased': 91.283, 'best_test_test/diff': 7.337, 'best_test_test/acc_skew': 87.615, 'best_test_test/acc_align': 94.951}
Total training time: 1:27:27
