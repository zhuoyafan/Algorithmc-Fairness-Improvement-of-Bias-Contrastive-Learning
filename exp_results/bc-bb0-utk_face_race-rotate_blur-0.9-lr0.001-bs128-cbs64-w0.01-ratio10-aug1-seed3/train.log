Log level set to: INFO
Set seed: 3
=======> Using Fixed Random Seed: 3 <========
save_path: exp_results/bc-bb0-utk_face_race-rotate_blur-0.9-lr0.001-bs128-cbs64-w0.01-ratio10-aug1-seed3
get_utk_face - split: train, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_race-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [4407, 552]
Target 1: [440, 5529]
Binary Target 1
---------------------------
Target 0: [4407, 552]
Target 1: [440, 5529]
===================================
Normal Label Distribution: 
Target 0: [4407, 552]
Target 1: [440, 5529]
===================================
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [4407, 552]
Target 1: [440, 5529]
Binary Target 1
---------------------------
Target 0: [4407, 552]
Target 1: [440, 5529]
===================================
Normal Label Distribution: 
Target 0: [4407, 552]
Target 1: [440, 5529]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 10928, target_attr: gender, bias_attr: race bias_rate: 0.9
['[train] target_0-bias_0: 4407', '[train] target_0-bias_1: 552', '[train] target_1-bias_0: 440', '[train] target_1-bias_1: 5529']
confusion_matrix - 
 original: tensor([[4407.,  440.],
        [ 552., 5529.]]), 
 normalized: tensor([[0.909, 0.091],
        [0.091, 0.909]]), 
 b|y: tensor([[0.889, 0.111],
        [0.074, 0.926]])
get_utk_face - split: train, aug: 1, given_y: True, ratio: 10
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_race-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [4407, 552]
Target 1: [440, 5529]
Binary Target 1
---------------------------
Target 0: [4407, 552]
Target 1: [440, 5529]
===================================
Normal Label Distribution: 
Target 0: [4407, 552]
Target 1: [440, 5529]
===================================
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [4407, 552]
Target 1: [440, 5529]
Binary Target 1
---------------------------
Target 0: [4407, 552]
Target 1: [440, 5529]
===================================
Normal Label Distribution: 
Target 0: [4407, 552]
Target 1: [440, 5529]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 10928, target_attr: gender, bias_attr: race bias_rate: 0.9
['[train] target_0-bias_0: 4407', '[train] target_0-bias_1: 552', '[train] target_1-bias_0: 440', '[train] target_1-bias_1: 5529']
get_utk_face - split: valid, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_race-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [583, 684]
Target 1: [457, 646]
Binary Target 1
---------------------------
Target 0: [583, 684]
Target 1: [457, 646]
===================================
Normal Label Distribution: 
Target 0: [583, 684]
Target 1: [457, 646]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 2370, target_attr: gender, bias_attr: race bias_rate: 0.9
['[valid] target_0-bias_0: 583', '[valid] target_0-bias_1: 684', '[valid] target_1-bias_0: 457', '[valid] target_1-bias_1: 646']
get_utk_face - split: test, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_race-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [558, 677]
Target 1: [462, 673]
Binary Target 1
---------------------------
Target 0: [558, 677]
Target 1: [462, 673]
===================================
Normal Label Distribution: 
Target 0: [558, 677]
Target 1: [462, 673]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 2370, target_attr: gender, bias_attr: race bias_rate: 0.9
['[test] target_0-bias_0: 558', '[test] target_0-bias_1: 677', '[test] target_1-bias_0: 462', '[test] target_1-bias_1: 673']
decay_epochs: [6, 13]
[1 / 20] Learning rate: 0.001 weight: 0.01
[1 / 20] Loss: 4.92161222921458 CE Loss: 0.6612829277141901 Con Loss: 4.914999375406157
[1 / 20] tensor([[0.514, 0.465],
        [0.853, 0.862]]) {'epoch': 1, 'valid/acc': 66.498, 'valid/acc_unbiased': 67.56, 'valid/diff': 2.35, 'valid/acc_skew': 66.612, 'valid/acc_align': 68.508, 'test/acc': 66.498, 'test/acc_unbiased': 67.356, 'test/diff': 2.902, 'test/acc_skew': 65.905, 'test/acc_align': 68.807}
[1 / 20] best valid accuracy: 67.560 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 66.498, 'best_valid_valid/acc_unbiased': 67.56, 'best_valid_valid/diff': 2.35, 'best_valid_valid/acc_skew': 66.612, 'best_valid_valid/acc_align': 68.508, 'best_valid_test/acc': 66.498, 'best_valid_test/acc_unbiased': 67.356, 'best_valid_test/diff': 2.902, 'best_valid_test/acc_skew': 65.905, 'best_valid_test/acc_align': 68.807}
[1 / 20] best test accuracy: 67.356 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 66.498, 'best_test_valid/acc_unbiased': 67.56, 'best_test_valid/diff': 2.35, 'best_test_valid/acc_skew': 66.612, 'best_test_valid/acc_align': 68.508, 'best_test_test/acc': 66.498, 'best_test_test/acc_unbiased': 67.356, 'best_test_test/diff': 2.902, 'best_test_test/acc_skew': 65.905, 'best_test_test/acc_align': 68.807}
[2 / 20] Learning rate: 0.001 weight: 0.01
[2 / 20] Loss: 4.812034491040522 CE Loss: 0.5863829274303218 Con Loss: 4.806170660440604
[2 / 20] tensor([[0.724, 0.678],
        [0.771, 0.789]]) {'epoch': 2, 'valid/acc': 73.755, 'valid/acc_unbiased': 74.085, 'valid/diff': 1.989, 'valid/acc_skew': 74.147, 'valid/acc_align': 74.024, 'test/acc': 73.84, 'test/acc_unbiased': 74.039, 'test/diff': 3.223, 'test/acc_skew': 72.428, 'test/acc_align': 75.651}
[2 / 20] best valid accuracy: 74.085 at epoch 2 
 best_stats: {'best_valid_epoch': 2, 'best_valid_valid/acc': 73.755, 'best_valid_valid/acc_unbiased': 74.085, 'best_valid_valid/diff': 1.989, 'best_valid_valid/acc_skew': 74.147, 'best_valid_valid/acc_align': 74.024, 'best_valid_test/acc': 73.84, 'best_valid_test/acc_unbiased': 74.039, 'best_valid_test/diff': 3.223, 'best_valid_test/acc_skew': 72.428, 'best_valid_test/acc_align': 75.651}
[2 / 20] best test accuracy: 74.039 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 73.755, 'best_test_valid/acc_unbiased': 74.085, 'best_test_valid/diff': 1.989, 'best_test_valid/acc_skew': 74.147, 'best_test_valid/acc_align': 74.024, 'best_test_test/acc': 73.84, 'best_test_test/acc_unbiased': 74.039, 'best_test_test/diff': 3.223, 'best_test_test/acc_skew': 72.428, 'best_test_test/acc_align': 75.651}
[3 / 20] Learning rate: 0.001 weight: 0.01
[3 / 20] Loss: 4.7844238721085155 CE Loss: 0.5735534027240636 Con Loss: 4.778688296741134
[3 / 20] tensor([[0.668, 0.623],
        [0.777, 0.829]]) {'epoch': 3, 'valid/acc': 73.544, 'valid/acc_unbiased': 73.915, 'valid/diff': 2.536, 'valid/acc_skew': 72.647, 'valid/acc_align': 75.183, 'test/acc': 72.236, 'test/acc_unbiased': 72.449, 'test/diff': 4.859, 'test/acc_skew': 70.02, 'test/acc_align': 74.879}
[3 / 20] best valid accuracy: 74.085 at epoch 2 
 best_stats: {'best_valid_epoch': 2, 'best_valid_valid/acc': 73.755, 'best_valid_valid/acc_unbiased': 74.085, 'best_valid_valid/diff': 1.989, 'best_valid_valid/acc_skew': 74.147, 'best_valid_valid/acc_align': 74.024, 'best_valid_test/acc': 73.84, 'best_valid_test/acc_unbiased': 74.039, 'best_valid_test/diff': 3.223, 'best_valid_test/acc_skew': 72.428, 'best_valid_test/acc_align': 75.651}
[3 / 20] best test accuracy: 74.039 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 73.755, 'best_test_valid/acc_unbiased': 74.085, 'best_test_valid/diff': 1.989, 'best_test_valid/acc_skew': 74.147, 'best_test_valid/acc_align': 74.024, 'best_test_test/acc': 73.84, 'best_test_test/acc_unbiased': 74.039, 'best_test_test/diff': 3.223, 'best_test_test/acc_skew': 72.428, 'best_test_test/acc_align': 75.651}
[4 / 20] Learning rate: 0.001 weight: 0.01
[4 / 20] Loss: 4.774767826800814 CE Loss: 0.5574741013577184 Con Loss: 4.769193085185955
[4 / 20] tensor([[0.694, 0.578],
        [0.801, 0.872]]) {'epoch': 4, 'valid/acc': 73.797, 'valid/acc_unbiased': 74.308, 'valid/diff': 6.322, 'valid/acc_skew': 71.147, 'valid/acc_align': 77.469, 'test/acc': 73.207, 'test/acc_unbiased': 73.604, 'test/diff': 9.367, 'test/acc_skew': 68.921, 'test/acc_align': 78.288}
[4 / 20] best valid accuracy: 74.308 at epoch 4 
 best_stats: {'best_valid_epoch': 4, 'best_valid_valid/acc': 73.797, 'best_valid_valid/acc_unbiased': 74.308, 'best_valid_valid/diff': 6.322, 'best_valid_valid/acc_skew': 71.147, 'best_valid_valid/acc_align': 77.469, 'best_valid_test/acc': 73.207, 'best_valid_test/acc_unbiased': 73.604, 'best_valid_test/diff': 9.367, 'best_valid_test/acc_skew': 68.921, 'best_valid_test/acc_align': 78.288}
[4 / 20] best test accuracy: 74.039 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 73.755, 'best_test_valid/acc_unbiased': 74.085, 'best_test_valid/diff': 1.989, 'best_test_valid/acc_skew': 74.147, 'best_test_valid/acc_align': 74.024, 'best_test_test/acc': 73.84, 'best_test_test/acc_unbiased': 74.039, 'best_test_test/diff': 3.223, 'best_test_test/acc_skew': 72.428, 'best_test_test/acc_align': 75.651}
[5 / 20] Learning rate: 0.001 weight: 0.01
[5 / 20] Loss: 4.743104428532881 CE Loss: 0.570689622078249 Con Loss: 4.737397512265564
[5 / 20] tensor([[0.579, 0.521],
        [0.855, 0.884]]) {'epoch': 5, 'valid/acc': 70.844, 'valid/acc_unbiased': 71.783, 'valid/diff': 2.892, 'valid/acc_skew': 70.337, 'valid/acc_align': 73.229, 'test/acc': 70.295, 'test/acc_unbiased': 70.984, 'test/diff': 4.328, 'test/acc_skew': 68.82, 'test/acc_align': 73.148}
[5 / 20] best valid accuracy: 74.308 at epoch 4 
 best_stats: {'best_valid_epoch': 4, 'best_valid_valid/acc': 73.797, 'best_valid_valid/acc_unbiased': 74.308, 'best_valid_valid/diff': 6.322, 'best_valid_valid/acc_skew': 71.147, 'best_valid_valid/acc_align': 77.469, 'best_valid_test/acc': 73.207, 'best_valid_test/acc_unbiased': 73.604, 'best_valid_test/diff': 9.367, 'best_valid_test/acc_skew': 68.921, 'best_valid_test/acc_align': 78.288}
[5 / 20] best test accuracy: 74.039 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 73.755, 'best_test_valid/acc_unbiased': 74.085, 'best_test_valid/diff': 1.989, 'best_test_valid/acc_skew': 74.147, 'best_test_valid/acc_align': 74.024, 'best_test_test/acc': 73.84, 'best_test_test/acc_unbiased': 74.039, 'best_test_test/diff': 3.223, 'best_test_test/acc_skew': 72.428, 'best_test_test/acc_align': 75.651}
[6 / 20] Learning rate: 0.001 weight: 0.01
[6 / 20] Loss: 4.740280742002965 CE Loss: 0.5483327123116958 Con Loss: 4.734797422568236
[6 / 20] tensor([[0.763, 0.679],
        [0.790, 0.802]]) {'epoch': 6, 'valid/acc': 76.329, 'valid/acc_unbiased': 76.603, 'valid/diff': 1.222, 'valid/acc_skew': 77.214, 'valid/acc_align': 75.992, 'test/acc': 75.57, 'test/acc_unbiased': 75.883, 'test/diff': 4.815, 'test/acc_skew': 73.476, 'test/acc_align': 78.291}
[6 / 20] best valid accuracy: 76.603 at epoch 6 
 best_stats: {'best_valid_epoch': 6, 'best_valid_valid/acc': 76.329, 'best_valid_valid/acc_unbiased': 76.603, 'best_valid_valid/diff': 1.222, 'best_valid_valid/acc_skew': 77.214, 'best_valid_valid/acc_align': 75.992, 'best_valid_test/acc': 75.57, 'best_valid_test/acc_unbiased': 75.883, 'best_valid_test/diff': 4.815, 'best_valid_test/acc_skew': 73.476, 'best_valid_test/acc_align': 78.291}
[6 / 20] best test accuracy: 75.883 at epoch 6 
 best_stats: {'best_test_epoch': 6, 'best_test_valid/acc': 76.329, 'best_test_valid/acc_unbiased': 76.603, 'best_test_valid/diff': 1.222, 'best_test_valid/acc_skew': 77.214, 'best_test_valid/acc_align': 75.992, 'best_test_test/acc': 75.57, 'best_test_test/acc_unbiased': 75.883, 'best_test_test/diff': 4.815, 'best_test_test/acc_skew': 73.476, 'best_test_test/acc_align': 78.291}
[7 / 20] Learning rate: 0.0001 weight: 0.01
[7 / 20] Loss: 4.680120244731317 CE Loss: 0.5315913400922303 Con Loss: 4.674804311894742
[7 / 20] tensor([[0.774, 0.690],
        [0.779, 0.835]]) {'epoch': 7, 'valid/acc': 77.468, 'valid/acc_unbiased': 77.701, 'valid/diff': 2.582, 'valid/acc_skew': 76.41, 'valid/acc_align': 78.992, 'test/acc': 76.835, 'test/acc_unbiased': 76.957, 'test/diff': 7.012, 'test/acc_skew': 73.451, 'test/acc_align': 80.463}
[7 / 20] best valid accuracy: 77.701 at epoch 7 
 best_stats: {'best_valid_epoch': 7, 'best_valid_valid/acc': 77.468, 'best_valid_valid/acc_unbiased': 77.701, 'best_valid_valid/diff': 2.582, 'best_valid_valid/acc_skew': 76.41, 'best_valid_valid/acc_align': 78.992, 'best_valid_test/acc': 76.835, 'best_valid_test/acc_unbiased': 76.957, 'best_valid_test/diff': 7.012, 'best_valid_test/acc_skew': 73.451, 'best_valid_test/acc_align': 80.463}
[7 / 20] best test accuracy: 76.957 at epoch 7 
 best_stats: {'best_test_epoch': 7, 'best_test_valid/acc': 77.468, 'best_test_valid/acc_unbiased': 77.701, 'best_test_valid/diff': 2.582, 'best_test_valid/acc_skew': 76.41, 'best_test_valid/acc_align': 78.992, 'best_test_test/acc': 76.835, 'best_test_test/acc_unbiased': 76.957, 'best_test_test/diff': 7.012, 'best_test_test/acc_skew': 73.451, 'best_test_test/acc_align': 80.463}
[8 / 20] Learning rate: 0.0001 weight: 0.01
[8 / 20] Loss: 4.64687606426144 CE Loss: 0.5081793728719518 Con Loss: 4.641794257771393
[8 / 20] tensor([[0.797, 0.697],
        [0.773, 0.834]]) {'epoch': 8, 'valid/acc': 78.481, 'valid/acc_unbiased': 78.715, 'valid/diff': 3.952, 'valid/acc_skew': 76.739, 'valid/acc_align': 80.69, 'test/acc': 77.426, 'test/acc_unbiased': 77.525, 'test/diff': 8.058, 'test/acc_skew': 73.496, 'test/acc_align': 81.554}
[8 / 20] best valid accuracy: 78.715 at epoch 8 
 best_stats: {'best_valid_epoch': 8, 'best_valid_valid/acc': 78.481, 'best_valid_valid/acc_unbiased': 78.715, 'best_valid_valid/diff': 3.952, 'best_valid_valid/acc_skew': 76.739, 'best_valid_valid/acc_align': 80.69, 'best_valid_test/acc': 77.426, 'best_valid_test/acc_unbiased': 77.525, 'best_valid_test/diff': 8.058, 'best_valid_test/acc_skew': 73.496, 'best_valid_test/acc_align': 81.554}
[8 / 20] best test accuracy: 77.525 at epoch 8 
 best_stats: {'best_test_epoch': 8, 'best_test_valid/acc': 78.481, 'best_test_valid/acc_unbiased': 78.715, 'best_test_valid/diff': 3.952, 'best_test_valid/acc_skew': 76.739, 'best_test_valid/acc_align': 80.69, 'best_test_test/acc': 77.426, 'best_test_test/acc_unbiased': 77.525, 'best_test_test/diff': 8.058, 'best_test_test/acc_skew': 73.496, 'best_test_test/acc_align': 81.554}
[9 / 20] Learning rate: 0.0001 weight: 0.01
[9 / 20] Loss: 4.633753247351807 CE Loss: 0.49955144323855855 Con Loss: 4.628757747689243
[9 / 20] tensor([[0.749, 0.647],
        [0.838, 0.875]]) {'epoch': 9, 'valid/acc': 77.215, 'valid/acc_unbiased': 77.739, 'valid/diff': 4.128, 'valid/acc_skew': 75.675, 'valid/acc_align': 79.804, 'test/acc': 77.3, 'test/acc_unbiased': 77.723, 'test/diff': 6.983, 'test/acc_skew': 74.232, 'test/acc_align': 81.214}
[9 / 20] best valid accuracy: 78.715 at epoch 8 
 best_stats: {'best_valid_epoch': 8, 'best_valid_valid/acc': 78.481, 'best_valid_valid/acc_unbiased': 78.715, 'best_valid_valid/diff': 3.952, 'best_valid_valid/acc_skew': 76.739, 'best_valid_valid/acc_align': 80.69, 'best_valid_test/acc': 77.426, 'best_valid_test/acc_unbiased': 77.525, 'best_valid_test/diff': 8.058, 'best_valid_test/acc_skew': 73.496, 'best_valid_test/acc_align': 81.554}
[9 / 20] best test accuracy: 77.723 at epoch 9 
 best_stats: {'best_test_epoch': 9, 'best_test_valid/acc': 77.215, 'best_test_valid/acc_unbiased': 77.739, 'best_test_valid/diff': 4.128, 'best_test_valid/acc_skew': 75.675, 'best_test_valid/acc_align': 79.804, 'best_test_test/acc': 77.3, 'best_test_test/acc_unbiased': 77.723, 'best_test_test/diff': 6.983, 'best_test_test/acc_skew': 74.232, 'best_test_test/acc_align': 81.214}
[10 / 20] Learning rate: 0.0001 weight: 0.01
[10 / 20] Loss: 4.6024302563590505 CE Loss: 0.48785403532304666 Con Loss: 4.597551731204567
[10 / 20] tensor([[0.797, 0.703],
        [0.768, 0.832]]) {'epoch': 10, 'valid/acc': 78.186, 'valid/acc_unbiased': 78.246, 'valid/diff': 4.252, 'valid/acc_skew': 76.12, 'valid/acc_align': 80.372, 'test/acc': 77.468, 'test/acc_unbiased': 77.527, 'test/diff': 7.904, 'test/acc_skew': 73.575, 'test/acc_align': 81.479}
[10 / 20] best valid accuracy: 78.715 at epoch 8 
 best_stats: {'best_valid_epoch': 8, 'best_valid_valid/acc': 78.481, 'best_valid_valid/acc_unbiased': 78.715, 'best_valid_valid/diff': 3.952, 'best_valid_valid/acc_skew': 76.739, 'best_valid_valid/acc_align': 80.69, 'best_valid_test/acc': 77.426, 'best_valid_test/acc_unbiased': 77.525, 'best_valid_test/diff': 8.058, 'best_valid_test/acc_skew': 73.496, 'best_valid_test/acc_align': 81.554}
[10 / 20] best test accuracy: 77.723 at epoch 9 
 best_stats: {'best_test_epoch': 9, 'best_test_valid/acc': 77.215, 'best_test_valid/acc_unbiased': 77.739, 'best_test_valid/diff': 4.128, 'best_test_valid/acc_skew': 75.675, 'best_test_valid/acc_align': 79.804, 'best_test_test/acc': 77.3, 'best_test_test/acc_unbiased': 77.723, 'best_test_test/diff': 6.983, 'best_test_test/acc_skew': 74.232, 'best_test_test/acc_align': 81.214}
[11 / 20] Learning rate: 0.0001 weight: 0.01
[11 / 20] Loss: 4.59133726332233 CE Loss: 0.4810829329717561 Con Loss: 4.586526435081292
[11 / 20] tensor([[0.785, 0.684],
        [0.777, 0.850]]) {'epoch': 11, 'valid/acc': 77.932, 'valid/acc_unbiased': 78.083, 'valid/diff': 5.755, 'valid/acc_skew': 75.205, 'valid/acc_align': 80.96, 'test/acc': 77.3, 'test/acc_unbiased': 77.396, 'test/diff': 8.696, 'test/acc_skew': 73.048, 'test/acc_align': 81.744}
[11 / 20] best valid accuracy: 78.715 at epoch 8 
 best_stats: {'best_valid_epoch': 8, 'best_valid_valid/acc': 78.481, 'best_valid_valid/acc_unbiased': 78.715, 'best_valid_valid/diff': 3.952, 'best_valid_valid/acc_skew': 76.739, 'best_valid_valid/acc_align': 80.69, 'best_valid_test/acc': 77.426, 'best_valid_test/acc_unbiased': 77.525, 'best_valid_test/diff': 8.058, 'best_valid_test/acc_skew': 73.496, 'best_valid_test/acc_align': 81.554}
[11 / 20] best test accuracy: 77.723 at epoch 9 
 best_stats: {'best_test_epoch': 9, 'best_test_valid/acc': 77.215, 'best_test_valid/acc_unbiased': 77.739, 'best_test_valid/diff': 4.128, 'best_test_valid/acc_skew': 75.675, 'best_test_valid/acc_align': 79.804, 'best_test_test/acc': 77.3, 'best_test_test/acc_unbiased': 77.723, 'best_test_test/diff': 6.983, 'best_test_test/acc_skew': 74.232, 'best_test_test/acc_align': 81.214}
[12 / 20] Learning rate: 0.0001 weight: 0.01
[12 / 20] Loss: 4.592637640839963 CE Loss: 0.48595592021767603 Con Loss: 4.587778076071341
[12 / 20] tensor([[0.792, 0.688],
        [0.786, 0.841]]) {'epoch': 12, 'valid/acc': 78.228, 'valid/acc_unbiased': 78.454, 'valid/diff': 5.112, 'valid/acc_skew': 75.898, 'valid/acc_align': 81.01, 'test/acc': 77.511, 'test/acc_unbiased': 77.679, 'test/diff': 7.954, 'test/acc_skew': 73.702, 'test/acc_align': 81.656}
[12 / 20] best valid accuracy: 78.715 at epoch 8 
 best_stats: {'best_valid_epoch': 8, 'best_valid_valid/acc': 78.481, 'best_valid_valid/acc_unbiased': 78.715, 'best_valid_valid/diff': 3.952, 'best_valid_valid/acc_skew': 76.739, 'best_valid_valid/acc_align': 80.69, 'best_valid_test/acc': 77.426, 'best_valid_test/acc_unbiased': 77.525, 'best_valid_test/diff': 8.058, 'best_valid_test/acc_skew': 73.496, 'best_valid_test/acc_align': 81.554}
[12 / 20] best test accuracy: 77.723 at epoch 9 
 best_stats: {'best_test_epoch': 9, 'best_test_valid/acc': 77.215, 'best_test_valid/acc_unbiased': 77.739, 'best_test_valid/diff': 4.128, 'best_test_valid/acc_skew': 75.675, 'best_test_valid/acc_align': 79.804, 'best_test_test/acc': 77.3, 'best_test_test/acc_unbiased': 77.723, 'best_test_test/diff': 6.983, 'best_test_test/acc_skew': 74.232, 'best_test_test/acc_align': 81.214}
[13 / 20] Learning rate: 0.0001 weight: 0.01
[13 / 20] Loss: 4.554685839098683 CE Loss: 0.4777158599559594 Con Loss: 4.549908682682155
[13 / 20] tensor([[0.767, 0.677],
        [0.779, 0.857]]) {'epoch': 13, 'valid/acc': 77.764, 'valid/acc_unbiased': 78.073, 'valid/diff': 7.419, 'valid/acc_skew': 74.364, 'valid/acc_align': 81.782, 'test/acc': 76.92, 'test/acc_unbiased': 77.003, 'test/diff': 8.432, 'test/acc_skew': 72.787, 'test/acc_align': 81.219}
[13 / 20] best valid accuracy: 78.715 at epoch 8 
 best_stats: {'best_valid_epoch': 8, 'best_valid_valid/acc': 78.481, 'best_valid_valid/acc_unbiased': 78.715, 'best_valid_valid/diff': 3.952, 'best_valid_valid/acc_skew': 76.739, 'best_valid_valid/acc_align': 80.69, 'best_valid_test/acc': 77.426, 'best_valid_test/acc_unbiased': 77.525, 'best_valid_test/diff': 8.058, 'best_valid_test/acc_skew': 73.496, 'best_valid_test/acc_align': 81.554}
[13 / 20] best test accuracy: 77.723 at epoch 9 
 best_stats: {'best_test_epoch': 9, 'best_test_valid/acc': 77.215, 'best_test_valid/acc_unbiased': 77.739, 'best_test_valid/diff': 4.128, 'best_test_valid/acc_skew': 75.675, 'best_test_valid/acc_align': 79.804, 'best_test_test/acc': 77.3, 'best_test_test/acc_unbiased': 77.723, 'best_test_test/diff': 6.983, 'best_test_test/acc_skew': 74.232, 'best_test_test/acc_align': 81.214}
[14 / 20] Learning rate: 1e-05 weight: 0.01
[14 / 20] Loss: 4.537015264938377 CE Loss: 0.47601595970407934 Con Loss: 4.532255140614544
[14 / 20] tensor([[0.760, 0.656],
        [0.799, 0.872]]) {'epoch': 14, 'valid/acc': 77.975, 'valid/acc_unbiased': 78.428, 'valid/diff': 6.746, 'valid/acc_skew': 75.056, 'valid/acc_align': 81.801, 'test/acc': 76.962, 'test/acc_unbiased': 77.165, 'test/diff': 8.877, 'test/acc_skew': 72.727, 'test/acc_align': 81.604}
[14 / 20] best valid accuracy: 78.715 at epoch 8 
 best_stats: {'best_valid_epoch': 8, 'best_valid_valid/acc': 78.481, 'best_valid_valid/acc_unbiased': 78.715, 'best_valid_valid/diff': 3.952, 'best_valid_valid/acc_skew': 76.739, 'best_valid_valid/acc_align': 80.69, 'best_valid_test/acc': 77.426, 'best_valid_test/acc_unbiased': 77.525, 'best_valid_test/diff': 8.058, 'best_valid_test/acc_skew': 73.496, 'best_valid_test/acc_align': 81.554}
[14 / 20] best test accuracy: 77.723 at epoch 9 
 best_stats: {'best_test_epoch': 9, 'best_test_valid/acc': 77.215, 'best_test_valid/acc_unbiased': 77.739, 'best_test_valid/diff': 4.128, 'best_test_valid/acc_skew': 75.675, 'best_test_valid/acc_align': 79.804, 'best_test_test/acc': 77.3, 'best_test_test/acc_unbiased': 77.723, 'best_test_test/diff': 6.983, 'best_test_test/acc_skew': 74.232, 'best_test_test/acc_align': 81.214}
[15 / 20] Learning rate: 1e-05 weight: 0.01
[15 / 20] Loss: 4.533588930244502 CE Loss: 0.4785895447081738 Con Loss: 4.528803033675142
[15 / 20] tensor([[0.774, 0.677],
        [0.786, 0.863]]) {'epoch': 15, 'valid/acc': 78.27, 'valid/acc_unbiased': 78.631, 'valid/diff': 7.076, 'valid/acc_skew': 75.093, 'valid/acc_align': 82.169, 'test/acc': 77.384, 'test/acc_unbiased': 77.493, 'test/diff': 8.763, 'test/acc_skew': 73.111, 'test/acc_align': 81.875}
[15 / 20] best valid accuracy: 78.715 at epoch 8 
 best_stats: {'best_valid_epoch': 8, 'best_valid_valid/acc': 78.481, 'best_valid_valid/acc_unbiased': 78.715, 'best_valid_valid/diff': 3.952, 'best_valid_valid/acc_skew': 76.739, 'best_valid_valid/acc_align': 80.69, 'best_valid_test/acc': 77.426, 'best_valid_test/acc_unbiased': 77.525, 'best_valid_test/diff': 8.058, 'best_valid_test/acc_skew': 73.496, 'best_valid_test/acc_align': 81.554}
[15 / 20] best test accuracy: 77.723 at epoch 9 
 best_stats: {'best_test_epoch': 9, 'best_test_valid/acc': 77.215, 'best_test_valid/acc_unbiased': 77.739, 'best_test_valid/diff': 4.128, 'best_test_valid/acc_skew': 75.675, 'best_test_valid/acc_align': 79.804, 'best_test_test/acc': 77.3, 'best_test_test/acc_unbiased': 77.723, 'best_test_test/diff': 6.983, 'best_test_test/acc_skew': 74.232, 'best_test_test/acc_align': 81.214}
[16 / 20] Learning rate: 1e-05 weight: 0.01
[16 / 20] Loss: 4.527065376237057 CE Loss: 0.4773445022926498 Con Loss: 4.522291919322873
[16 / 20] tensor([[0.774, 0.663],
        [0.788, 0.869]]) {'epoch': 16, 'valid/acc': 78.228, 'valid/acc_unbiased': 78.632, 'valid/diff': 7.007, 'valid/acc_skew': 75.129, 'valid/acc_align': 82.136, 'test/acc': 77.215, 'test/acc_unbiased': 77.363, 'test/diff': 9.617, 'test/acc_skew': 72.555, 'test/acc_align': 82.172}
[16 / 20] best valid accuracy: 78.715 at epoch 8 
 best_stats: {'best_valid_epoch': 8, 'best_valid_valid/acc': 78.481, 'best_valid_valid/acc_unbiased': 78.715, 'best_valid_valid/diff': 3.952, 'best_valid_valid/acc_skew': 76.739, 'best_valid_valid/acc_align': 80.69, 'best_valid_test/acc': 77.426, 'best_valid_test/acc_unbiased': 77.525, 'best_valid_test/diff': 8.058, 'best_valid_test/acc_skew': 73.496, 'best_valid_test/acc_align': 81.554}
[16 / 20] best test accuracy: 77.723 at epoch 9 
 best_stats: {'best_test_epoch': 9, 'best_test_valid/acc': 77.215, 'best_test_valid/acc_unbiased': 77.739, 'best_test_valid/diff': 4.128, 'best_test_valid/acc_skew': 75.675, 'best_test_valid/acc_align': 79.804, 'best_test_test/acc': 77.3, 'best_test_test/acc_unbiased': 77.723, 'best_test_test/diff': 6.983, 'best_test_test/acc_skew': 74.232, 'best_test_test/acc_align': 81.214}
[17 / 20] Learning rate: 1e-05 weight: 0.01
[17 / 20] Loss: 4.530070063310347 CE Loss: 0.4708049581392967 Con Loss: 4.5253620091853
[17 / 20] tensor([[0.790, 0.685],
        [0.779, 0.853]]) {'epoch': 17, 'valid/acc': 78.481, 'valid/acc_unbiased': 78.725, 'valid/diff': 7.04, 'valid/acc_skew': 75.205, 'valid/acc_align': 82.245, 'test/acc': 77.595, 'test/acc_unbiased': 77.695, 'test/diff': 8.931, 'test/acc_skew': 73.23, 'test/acc_align': 82.161}
[17 / 20] best valid accuracy: 78.725 at epoch 17 
 best_stats: {'best_valid_epoch': 17, 'best_valid_valid/acc': 78.481, 'best_valid_valid/acc_unbiased': 78.725, 'best_valid_valid/diff': 7.04, 'best_valid_valid/acc_skew': 75.205, 'best_valid_valid/acc_align': 82.245, 'best_valid_test/acc': 77.595, 'best_valid_test/acc_unbiased': 77.695, 'best_valid_test/diff': 8.931, 'best_valid_test/acc_skew': 73.23, 'best_valid_test/acc_align': 82.161}
[17 / 20] best test accuracy: 77.723 at epoch 9 
 best_stats: {'best_test_epoch': 9, 'best_test_valid/acc': 77.215, 'best_test_valid/acc_unbiased': 77.739, 'best_test_valid/diff': 4.128, 'best_test_valid/acc_skew': 75.675, 'best_test_valid/acc_align': 79.804, 'best_test_test/acc': 77.3, 'best_test_test/acc_unbiased': 77.723, 'best_test_test/diff': 6.983, 'best_test_test/acc_skew': 74.232, 'best_test_test/acc_align': 81.214}
[18 / 20] Learning rate: 1e-05 weight: 0.01
[18 / 20] Loss: 4.539621102513192 CE Loss: 0.4818352151929372 Con Loss: 4.534802771941111
[18 / 20] tensor([[0.790, 0.697],
        [0.773, 0.845]]) {'epoch': 18, 'valid/acc': 78.861, 'valid/acc_unbiased': 79.022, 'valid/diff': 6.756, 'valid/acc_skew': 75.644, 'valid/acc_align': 82.399, 'test/acc': 77.595, 'test/acc_unbiased': 77.643, 'test/diff': 8.293, 'test/acc_skew': 73.496, 'test/acc_align': 81.79}
[18 / 20] best valid accuracy: 79.022 at epoch 18 
 best_stats: {'best_valid_epoch': 18, 'best_valid_valid/acc': 78.861, 'best_valid_valid/acc_unbiased': 79.022, 'best_valid_valid/diff': 6.756, 'best_valid_valid/acc_skew': 75.644, 'best_valid_valid/acc_align': 82.399, 'best_valid_test/acc': 77.595, 'best_valid_test/acc_unbiased': 77.643, 'best_valid_test/diff': 8.293, 'best_valid_test/acc_skew': 73.496, 'best_valid_test/acc_align': 81.79}
[18 / 20] best test accuracy: 77.723 at epoch 9 
 best_stats: {'best_test_epoch': 9, 'best_test_valid/acc': 77.215, 'best_test_valid/acc_unbiased': 77.739, 'best_test_valid/diff': 4.128, 'best_test_valid/acc_skew': 75.675, 'best_test_valid/acc_align': 79.804, 'best_test_test/acc': 77.3, 'best_test_test/acc_unbiased': 77.723, 'best_test_test/diff': 6.983, 'best_test_test/acc_skew': 74.232, 'best_test_test/acc_align': 81.214}
[19 / 20] Learning rate: 1e-05 weight: 0.01
[19 / 20] Loss: 4.543840510255246 CE Loss: 0.4687419390172246 Con Loss: 4.539153090682246
[19 / 20] tensor([[0.783, 0.694],
        [0.777, 0.854]]) {'epoch': 19, 'valid/acc': 78.819, 'valid/acc_unbiased': 79.017, 'valid/diff': 7.333, 'valid/acc_skew': 75.351, 'valid/acc_align': 82.684, 'test/acc': 77.679, 'test/acc_unbiased': 77.721, 'test/diff': 8.312, 'test/acc_skew': 73.565, 'test/acc_align': 81.877}
[19 / 20] best valid accuracy: 79.022 at epoch 18 
 best_stats: {'best_valid_epoch': 18, 'best_valid_valid/acc': 78.861, 'best_valid_valid/acc_unbiased': 79.022, 'best_valid_valid/diff': 6.756, 'best_valid_valid/acc_skew': 75.644, 'best_valid_valid/acc_align': 82.399, 'best_valid_test/acc': 77.595, 'best_valid_test/acc_unbiased': 77.643, 'best_valid_test/diff': 8.293, 'best_valid_test/acc_skew': 73.496, 'best_valid_test/acc_align': 81.79}
[19 / 20] best test accuracy: 77.723 at epoch 9 
 best_stats: {'best_test_epoch': 9, 'best_test_valid/acc': 77.215, 'best_test_valid/acc_unbiased': 77.739, 'best_test_valid/diff': 4.128, 'best_test_valid/acc_skew': 75.675, 'best_test_valid/acc_align': 79.804, 'best_test_test/acc': 77.3, 'best_test_test/acc_unbiased': 77.723, 'best_test_test/diff': 6.983, 'best_test_test/acc_skew': 74.232, 'best_test_test/acc_align': 81.214}
[20 / 20] Learning rate: 1e-05 weight: 0.01
[20 / 20] Loss: 4.5179798145768935 CE Loss: 0.46794297702141424 Con Loss: 4.513300381153604
[20 / 20] tensor([[0.776, 0.669],
        [0.786, 0.869]]) {'epoch': 20, 'valid/acc': 78.776, 'valid/acc_unbiased': 79.099, 'valid/diff': 6.915, 'valid/acc_skew': 75.641, 'valid/acc_align': 82.556, 'test/acc': 77.384, 'test/acc_unbiased': 77.502, 'test/diff': 9.519, 'test/acc_skew': 72.742, 'test/acc_align': 82.261}
[20 / 20] best valid accuracy: 79.099 at epoch 20 
 best_stats: {'best_valid_epoch': 20, 'best_valid_valid/acc': 78.776, 'best_valid_valid/acc_unbiased': 79.099, 'best_valid_valid/diff': 6.915, 'best_valid_valid/acc_skew': 75.641, 'best_valid_valid/acc_align': 82.556, 'best_valid_test/acc': 77.384, 'best_valid_test/acc_unbiased': 77.502, 'best_valid_test/diff': 9.519, 'best_valid_test/acc_skew': 72.742, 'best_valid_test/acc_align': 82.261}
[20 / 20] best test accuracy: 77.723 at epoch 9 
 best_stats: {'best_test_epoch': 9, 'best_test_valid/acc': 77.215, 'best_test_valid/acc_unbiased': 77.739, 'best_test_valid/diff': 4.128, 'best_test_valid/acc_skew': 75.675, 'best_test_valid/acc_align': 79.804, 'best_test_test/acc': 77.3, 'best_test_test/acc_unbiased': 77.723, 'best_test_test/diff': 6.983, 'best_test_test/acc_skew': 74.232, 'best_test_test/acc_align': 81.214}
Total training time: 0:17:18
