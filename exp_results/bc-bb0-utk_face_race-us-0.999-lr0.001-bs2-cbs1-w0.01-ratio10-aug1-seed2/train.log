Log level set to: INFO
Set seed: 2
=======> Using Fixed Random Seed: 2 <========
save_path: exp_results/bc-bb0-utk_face_race-us-0.999-lr0.001-bs2-cbs1-w0.01-ratio10-aug1-seed2
get_utk_face - split: train, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_race-0.999
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [4407, 5]
Target 1: [4, 5529]
Binary Target 1
---------------------------
Target 0: [4407, 5]
Target 1: [4, 5529]
===================================
Normal Label Distribution: 
Target 0: [4407, 5]
Target 1: [4, 5529]
===================================
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [4, 4]
Target 1: [4, 4]
Binary Target 1
---------------------------
Target 0: [4, 4]
Target 1: [4, 4]
===================================
Normal Label Distribution: 
Target 0: [4, 4]
Target 1: [4, 4]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 16, target_attr: gender, bias_attr: race bias_rate: 0.999
['[train] target_0-bias_0: 4', '[train] target_0-bias_1: 4', '[train] target_1-bias_0: 4', '[train] target_1-bias_1: 4']
confusion_matrix - 
 original: tensor([[4., 4.],
        [4., 4.]]), 
 normalized: tensor([[0.500, 0.500],
        [0.500, 0.500]]), 
 b|y: tensor([[0.500, 0.500],
        [0.500, 0.500]])
get_utk_face - split: train, aug: 1, given_y: True, ratio: 10
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_race-0.999
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [4407, 5]
Target 1: [4, 5529]
Binary Target 1
---------------------------
Target 0: [4407, 5]
Target 1: [4, 5529]
===================================
Normal Label Distribution: 
Target 0: [4407, 5]
Target 1: [4, 5529]
===================================
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [4, 4]
Target 1: [4, 4]
Binary Target 1
---------------------------
Target 0: [4, 4]
Target 1: [4, 4]
===================================
Normal Label Distribution: 
Target 0: [4, 4]
Target 1: [4, 4]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 16, target_attr: gender, bias_attr: race bias_rate: 0.999
['[train] target_0-bias_0: 4', '[train] target_0-bias_1: 4', '[train] target_1-bias_0: 4', '[train] target_1-bias_1: 4']
get_utk_face - split: valid, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_race-0.999
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [583, 684]
Target 1: [457, 646]
Binary Target 1
---------------------------
Target 0: [583, 684]
Target 1: [457, 646]
===================================
Normal Label Distribution: 
Target 0: [583, 684]
Target 1: [457, 646]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 2370, target_attr: gender, bias_attr: race bias_rate: 0.999
['[valid] target_0-bias_0: 583', '[valid] target_0-bias_1: 684', '[valid] target_1-bias_0: 457', '[valid] target_1-bias_1: 646']
get_utk_face - split: test, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_race-0.999
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [558, 677]
Target 1: [462, 673]
Binary Target 1
---------------------------
Target 0: [558, 677]
Target 1: [462, 673]
===================================
Normal Label Distribution: 
Target 0: [558, 677]
Target 1: [462, 673]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 2370, target_attr: gender, bias_attr: race bias_rate: 0.999
['[test] target_0-bias_0: 558', '[test] target_0-bias_1: 677', '[test] target_1-bias_0: 462', '[test] target_1-bias_1: 673']
decay_epochs: [6, 13]
[1 / 20] Learning rate: 0.001 weight: 0.01
[1 / 20] Loss: 0.016153782868059352 CE Loss: 1.6153783444315195 Con Loss: 0.0
[1 / 20] tensor([[0.324, 0.411],
        [0.714, 0.713]]) {'epoch': 1, 'valid/acc': 53.207, 'valid/acc_unbiased': 54.316, 'valid/diff': 3.345, 'valid/acc_skew': 53.468, 'valid/acc_align': 55.164, 'test/acc': 53.544, 'test/acc_unbiased': 54.063, 'test/diff': 4.366, 'test/acc_skew': 51.933, 'test/acc_align': 56.193}
[1 / 20] best valid accuracy: 54.316 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 53.207, 'best_valid_valid/acc_unbiased': 54.316, 'best_valid_valid/diff': 3.345, 'best_valid_valid/acc_skew': 53.468, 'best_valid_valid/acc_align': 55.164, 'best_valid_test/acc': 53.544, 'best_valid_test/acc_unbiased': 54.063, 'best_valid_test/diff': 4.366, 'best_valid_test/acc_skew': 51.933, 'best_valid_test/acc_align': 56.193}
[1 / 20] best test accuracy: 54.063 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 53.207, 'best_test_valid/acc_unbiased': 54.316, 'best_test_valid/diff': 3.345, 'best_test_valid/acc_skew': 53.468, 'best_test_valid/acc_align': 55.164, 'best_test_test/acc': 53.544, 'best_test_test/acc_unbiased': 54.063, 'best_test_test/diff': 4.366, 'best_test_test/acc_skew': 51.933, 'best_test_test/acc_align': 56.193}
[2 / 20] Learning rate: 0.001 weight: 0.01
[2 / 20] Loss: 0.019875637535278656 CE Loss: 1.9875637842924334 Con Loss: 0.0
[2 / 20] tensor([[0.086, 0.080],
        [0.931, 0.899]]) {'epoch': 2, 'valid/acc': 46.498, 'valid/acc_unbiased': 49.472, 'valid/diff': 1.24, 'valid/acc_skew': 50.092, 'valid/acc_align': 48.852, 'test/acc': 47.975, 'test/acc_unbiased': 49.887, 'test/diff': 1.902, 'test/acc_skew': 50.838, 'test/acc_align': 48.936}
[2 / 20] best valid accuracy: 54.316 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 53.207, 'best_valid_valid/acc_unbiased': 54.316, 'best_valid_valid/diff': 3.345, 'best_valid_valid/acc_skew': 53.468, 'best_valid_valid/acc_align': 55.164, 'best_valid_test/acc': 53.544, 'best_valid_test/acc_unbiased': 54.063, 'best_valid_test/diff': 4.366, 'best_valid_test/acc_skew': 51.933, 'best_valid_test/acc_align': 56.193}
[2 / 20] best test accuracy: 54.063 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 53.207, 'best_test_valid/acc_unbiased': 54.316, 'best_test_valid/diff': 3.345, 'best_test_valid/acc_skew': 53.468, 'best_test_valid/acc_align': 55.164, 'best_test_test/acc': 53.544, 'best_test_test/acc_unbiased': 54.063, 'best_test_test/diff': 4.366, 'best_test_test/acc_skew': 51.933, 'best_test_test/acc_align': 56.193}
[3 / 20] Learning rate: 0.001 weight: 0.01
[3 / 20] Loss: 0.020251475769327953 CE Loss: 2.02514760941267 Con Loss: 0.0
[3 / 20] tensor([[0.975, 0.993],
        [0.015, 0.013]]) {'epoch': 3, 'valid/acc': 53.544, 'valid/acc_unbiased': 50.151, 'valid/diff': 0.105, 'valid/acc_skew': 50.204, 'valid/acc_align': 50.099, 'test/acc': 51.983, 'test/acc_unbiased': 49.901, 'test/diff': 0.974, 'test/acc_skew': 49.503, 'test/acc_align': 50.299}
[3 / 20] best valid accuracy: 54.316 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 53.207, 'best_valid_valid/acc_unbiased': 54.316, 'best_valid_valid/diff': 3.345, 'best_valid_valid/acc_skew': 53.468, 'best_valid_valid/acc_align': 55.164, 'best_valid_test/acc': 53.544, 'best_valid_test/acc_unbiased': 54.063, 'best_valid_test/diff': 4.366, 'best_valid_test/acc_skew': 51.933, 'best_valid_test/acc_align': 56.193}
[3 / 20] best test accuracy: 54.063 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 53.207, 'best_test_valid/acc_unbiased': 54.316, 'best_test_valid/diff': 3.345, 'best_test_valid/acc_skew': 53.468, 'best_test_valid/acc_align': 55.164, 'best_test_test/acc': 53.544, 'best_test_test/acc_unbiased': 54.063, 'best_test_test/diff': 4.366, 'best_test_test/acc_skew': 51.933, 'best_test_test/acc_align': 56.193}
[4 / 20] Learning rate: 0.001 weight: 0.01
[4 / 20] Loss: 0.012770404107868671 CE Loss: 1.2770404368638992 Con Loss: 0.0
[4 / 20] tensor([[0.565, 0.477],
        [0.576, 0.574]]) {'epoch': 4, 'valid/acc': 53.755, 'valid/acc_unbiased': 53.786, 'valid/diff': 1.286, 'valid/acc_skew': 53.143, 'valid/acc_align': 54.429, 'test/acc': 54.43, 'test/acc_unbiased': 54.773, 'test/diff': 4.481, 'test/acc_skew': 57.014, 'test/acc_align': 52.533}
[4 / 20] best valid accuracy: 54.316 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 53.207, 'best_valid_valid/acc_unbiased': 54.316, 'best_valid_valid/diff': 3.345, 'best_valid_valid/acc_skew': 53.468, 'best_valid_valid/acc_align': 55.164, 'best_valid_test/acc': 53.544, 'best_valid_test/acc_unbiased': 54.063, 'best_valid_test/diff': 4.366, 'best_valid_test/acc_skew': 51.933, 'best_valid_test/acc_align': 56.193}
[4 / 20] best test accuracy: 54.773 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 53.755, 'best_test_valid/acc_unbiased': 53.786, 'best_test_valid/diff': 1.286, 'best_test_valid/acc_skew': 53.143, 'best_test_valid/acc_align': 54.429, 'best_test_test/acc': 54.43, 'best_test_test/acc_unbiased': 54.773, 'best_test_test/diff': 4.481, 'best_test_test/acc_skew': 57.014, 'best_test_test/acc_align': 52.533}
[5 / 20] Learning rate: 0.001 weight: 0.01
[5 / 20] Loss: 0.008435933181317523 CE Loss: 0.8435933236032724 Con Loss: 0.0
[5 / 20] tensor([[0.740, 0.662],
        [0.400, 0.401]]) {'epoch': 5, 'valid/acc': 57.511, 'valid/acc_unbiased': 56.741, 'valid/diff': 3.618, 'valid/acc_skew': 58.55, 'valid/acc_align': 54.932, 'test/acc': 55.527, 'test/acc_unbiased': 55.088, 'test/diff': 3.958, 'test/acc_skew': 57.029, 'test/acc_align': 53.147}
[5 / 20] best valid accuracy: 56.741 at epoch 5 
 best_stats: {'best_valid_epoch': 5, 'best_valid_valid/acc': 57.511, 'best_valid_valid/acc_unbiased': 56.741, 'best_valid_valid/diff': 3.618, 'best_valid_valid/acc_skew': 58.55, 'best_valid_valid/acc_align': 54.932, 'best_valid_test/acc': 55.527, 'best_valid_test/acc_unbiased': 55.088, 'best_valid_test/diff': 3.958, 'best_valid_test/acc_skew': 57.029, 'best_valid_test/acc_align': 53.147}
[5 / 20] best test accuracy: 55.088 at epoch 5 
 best_stats: {'best_test_epoch': 5, 'best_test_valid/acc': 57.511, 'best_test_valid/acc_unbiased': 56.741, 'best_test_valid/diff': 3.618, 'best_test_valid/acc_skew': 58.55, 'best_test_valid/acc_align': 54.932, 'best_test_test/acc': 55.527, 'best_test_test/acc_unbiased': 55.088, 'best_test_test/diff': 3.958, 'best_test_test/acc_skew': 57.029, 'best_test_test/acc_align': 53.147}
[6 / 20] Learning rate: 0.001 weight: 0.01
[6 / 20] Loss: 0.009072681597899646 CE Loss: 0.9072681814432144 Con Loss: 0.0
[6 / 20] tensor([[0.998, 0.990],
        [0.006, 0.015]]) {'epoch': 6, 'valid/acc': 53.629, 'valid/acc_unbiased': 50.231, 'valid/diff': 0.34, 'valid/acc_skew': 50.376, 'valid/acc_align': 50.086, 'test/acc': 52.321, 'test/acc_unbiased': 50.231, 'test/diff': 0.846, 'test/acc_skew': 50.235, 'test/acc_align': 50.226}
[6 / 20] best valid accuracy: 56.741 at epoch 5 
 best_stats: {'best_valid_epoch': 5, 'best_valid_valid/acc': 57.511, 'best_valid_valid/acc_unbiased': 56.741, 'best_valid_valid/diff': 3.618, 'best_valid_valid/acc_skew': 58.55, 'best_valid_valid/acc_align': 54.932, 'best_valid_test/acc': 55.527, 'best_valid_test/acc_unbiased': 55.088, 'best_valid_test/diff': 3.958, 'best_valid_test/acc_skew': 57.029, 'best_valid_test/acc_align': 53.147}
[6 / 20] best test accuracy: 55.088 at epoch 5 
 best_stats: {'best_test_epoch': 5, 'best_test_valid/acc': 57.511, 'best_test_valid/acc_unbiased': 56.741, 'best_test_valid/diff': 3.618, 'best_test_valid/acc_skew': 58.55, 'best_test_valid/acc_align': 54.932, 'best_test_test/acc': 55.527, 'best_test_test/acc_unbiased': 55.088, 'best_test_test/diff': 3.958, 'best_test_test/acc_skew': 57.029, 'best_test_test/acc_align': 53.147}
[7 / 20] Learning rate: 0.0001 weight: 0.01
[7 / 20] Loss: 0.008146088570356369 CE Loss: 0.8146088756620884 Con Loss: 0.0
[7 / 20] tensor([[0.948, 0.905],
        [0.134, 0.155]]) {'epoch': 7, 'valid/acc': 56.793, 'valid/acc_unbiased': 54.298, 'valid/diff': 3.662, 'valid/acc_skew': 55.866, 'valid/acc_align': 52.73, 'test/acc': 55.19, 'test/acc_unbiased': 53.556, 'test/diff': 3.145, 'test/acc_skew': 54.111, 'test/acc_align': 53.0}
[7 / 20] best valid accuracy: 56.741 at epoch 5 
 best_stats: {'best_valid_epoch': 5, 'best_valid_valid/acc': 57.511, 'best_valid_valid/acc_unbiased': 56.741, 'best_valid_valid/diff': 3.618, 'best_valid_valid/acc_skew': 58.55, 'best_valid_valid/acc_align': 54.932, 'best_valid_test/acc': 55.527, 'best_valid_test/acc_unbiased': 55.088, 'best_valid_test/diff': 3.958, 'best_valid_test/acc_skew': 57.029, 'best_valid_test/acc_align': 53.147}
[7 / 20] best test accuracy: 55.088 at epoch 5 
 best_stats: {'best_test_epoch': 5, 'best_test_valid/acc': 57.511, 'best_test_valid/acc_unbiased': 56.741, 'best_test_valid/diff': 3.618, 'best_test_valid/acc_skew': 58.55, 'best_test_valid/acc_align': 54.932, 'best_test_test/acc': 55.527, 'best_test_test/acc_unbiased': 55.088, 'best_test_test/diff': 3.958, 'best_test_test/acc_skew': 57.029, 'best_test_test/acc_align': 53.147}
[8 / 20] Learning rate: 0.0001 weight: 0.01
[8 / 20] Loss: 0.008028578769881278 CE Loss: 0.8028578981757164 Con Loss: 0.0
[8 / 20] tensor([[0.962, 0.916],
        [0.141, 0.137]]) {'epoch': 8, 'valid/acc': 56.54, 'valid/acc_unbiased': 53.967, 'valid/diff': 3.143, 'valid/acc_skew': 55.538, 'valid/acc_align': 52.395, 'test/acc': 55.443, 'test/acc_unbiased': 53.889, 'test/diff': 2.528, 'test/acc_skew': 55.153, 'test/acc_align': 52.625}
[8 / 20] best valid accuracy: 56.741 at epoch 5 
 best_stats: {'best_valid_epoch': 5, 'best_valid_valid/acc': 57.511, 'best_valid_valid/acc_unbiased': 56.741, 'best_valid_valid/diff': 3.618, 'best_valid_valid/acc_skew': 58.55, 'best_valid_valid/acc_align': 54.932, 'best_valid_test/acc': 55.527, 'best_valid_test/acc_unbiased': 55.088, 'best_valid_test/diff': 3.958, 'best_valid_test/acc_skew': 57.029, 'best_valid_test/acc_align': 53.147}
[8 / 20] best test accuracy: 55.088 at epoch 5 
 best_stats: {'best_test_epoch': 5, 'best_test_valid/acc': 57.511, 'best_test_valid/acc_unbiased': 56.741, 'best_test_valid/diff': 3.618, 'best_test_valid/acc_skew': 58.55, 'best_test_valid/acc_align': 54.932, 'best_test_test/acc': 55.527, 'best_test_test/acc_unbiased': 55.088, 'best_test_test/diff': 3.958, 'best_test_test/acc_skew': 57.029, 'best_test_test/acc_align': 53.147}
[9 / 20] Learning rate: 0.0001 weight: 0.01
[9 / 20] Loss: 0.005998813488986343 CE Loss: 0.599881362169981 Con Loss: 0.0
[9 / 20] tensor([[0.894, 0.793],
        [0.299, 0.319]]) {'epoch': 9, 'valid/acc': 58.945, 'valid/acc_unbiased': 57.197, 'valid/diff': 4.956, 'valid/acc_skew': 58.533, 'valid/acc_align': 55.861, 'test/acc': 58.608, 'test/acc_unbiased': 57.641, 'test/diff': 6.091, 'test/acc_skew': 59.648, 'test/acc_align': 55.634}
[9 / 20] best valid accuracy: 57.197 at epoch 9 
 best_stats: {'best_valid_epoch': 9, 'best_valid_valid/acc': 58.945, 'best_valid_valid/acc_unbiased': 57.197, 'best_valid_valid/diff': 4.956, 'best_valid_valid/acc_skew': 58.533, 'best_valid_valid/acc_align': 55.861, 'best_valid_test/acc': 58.608, 'best_valid_test/acc_unbiased': 57.641, 'best_valid_test/diff': 6.091, 'best_valid_test/acc_skew': 59.648, 'best_valid_test/acc_align': 55.634}
[9 / 20] best test accuracy: 57.641 at epoch 9 
 best_stats: {'best_test_epoch': 9, 'best_test_valid/acc': 58.945, 'best_test_valid/acc_unbiased': 57.197, 'best_test_valid/diff': 4.956, 'best_test_valid/acc_skew': 58.533, 'best_test_valid/acc_align': 55.861, 'best_test_test/acc': 58.608, 'best_test_test/acc_unbiased': 57.641, 'best_test_test/diff': 6.091, 'best_test_test/acc_skew': 59.648, 'best_test_test/acc_align': 55.634}
[10 / 20] Learning rate: 0.0001 weight: 0.01
[10 / 20] Loss: 0.007358140137512237 CE Loss: 0.7358140274882317 Con Loss: 0.0
[10 / 20] tensor([[0.792, 0.719],
        [0.392, 0.379]]) {'epoch': 10, 'valid/acc': 57.764, 'valid/acc_unbiased': 56.72, 'valid/diff': 5.021, 'valid/acc_skew': 59.231, 'valid/acc_align': 54.21, 'test/acc': 57.595, 'test/acc_unbiased': 57.054, 'test/diff': 4.282, 'test/acc_skew': 59.194, 'test/acc_align': 54.913}
[10 / 20] best valid accuracy: 57.197 at epoch 9 
 best_stats: {'best_valid_epoch': 9, 'best_valid_valid/acc': 58.945, 'best_valid_valid/acc_unbiased': 57.197, 'best_valid_valid/diff': 4.956, 'best_valid_valid/acc_skew': 58.533, 'best_valid_valid/acc_align': 55.861, 'best_valid_test/acc': 58.608, 'best_valid_test/acc_unbiased': 57.641, 'best_valid_test/diff': 6.091, 'best_valid_test/acc_skew': 59.648, 'best_valid_test/acc_align': 55.634}
[10 / 20] best test accuracy: 57.641 at epoch 9 
 best_stats: {'best_test_epoch': 9, 'best_test_valid/acc': 58.945, 'best_test_valid/acc_unbiased': 57.197, 'best_test_valid/diff': 4.956, 'best_test_valid/acc_skew': 58.533, 'best_test_valid/acc_align': 55.861, 'best_test_test/acc': 58.608, 'best_test_test/acc_unbiased': 57.641, 'best_test_test/diff': 6.091, 'best_test_test/acc_skew': 59.648, 'best_test_test/acc_align': 55.634}
[11 / 20] Learning rate: 0.0001 weight: 0.01
[11 / 20] Loss: 0.006119718455011025 CE Loss: 0.6119718663394451 Con Loss: 0.0
[11 / 20] tensor([[0.846, 0.770],
        [0.344, 0.318]]) {'epoch': 11, 'valid/acc': 57.806, 'valid/acc_unbiased': 56.421, 'valid/diff': 4.578, 'valid/acc_skew': 58.71, 'valid/acc_align': 54.132, 'test/acc': 57.637, 'test/acc_unbiased': 56.94, 'test/diff': 5.124, 'test/acc_skew': 59.502, 'test/acc_align': 54.378}
[11 / 20] best valid accuracy: 57.197 at epoch 9 
 best_stats: {'best_valid_epoch': 9, 'best_valid_valid/acc': 58.945, 'best_valid_valid/acc_unbiased': 57.197, 'best_valid_valid/diff': 4.956, 'best_valid_valid/acc_skew': 58.533, 'best_valid_valid/acc_align': 55.861, 'best_valid_test/acc': 58.608, 'best_valid_test/acc_unbiased': 57.641, 'best_valid_test/diff': 6.091, 'best_valid_test/acc_skew': 59.648, 'best_valid_test/acc_align': 55.634}
[11 / 20] best test accuracy: 57.641 at epoch 9 
 best_stats: {'best_test_epoch': 9, 'best_test_valid/acc': 58.945, 'best_test_valid/acc_unbiased': 57.197, 'best_test_valid/diff': 4.956, 'best_test_valid/acc_skew': 58.533, 'best_test_valid/acc_align': 55.861, 'best_test_test/acc': 58.608, 'best_test_test/acc_unbiased': 57.641, 'best_test_test/diff': 6.091, 'best_test_test/acc_skew': 59.648, 'best_test_test/acc_align': 55.634}
[12 / 20] Learning rate: 0.0001 weight: 0.01
[12 / 20] Loss: 0.0053678393887821585 CE Loss: 0.5367839485406876 Con Loss: 0.0
[12 / 20] tensor([[0.789, 0.708],
        [0.407, 0.376]]) {'epoch': 12, 'valid/acc': 58.565, 'valid/acc_unbiased': 57.599, 'valid/diff': 4.937, 'valid/acc_skew': 60.067, 'valid/acc_align': 55.13, 'test/acc': 57.384, 'test/acc_unbiased': 56.973, 'test/diff': 5.6, 'test/acc_skew': 59.773, 'test/acc_align': 54.173}
[12 / 20] best valid accuracy: 57.599 at epoch 12 
 best_stats: {'best_valid_epoch': 12, 'best_valid_valid/acc': 58.565, 'best_valid_valid/acc_unbiased': 57.599, 'best_valid_valid/diff': 4.937, 'best_valid_valid/acc_skew': 60.067, 'best_valid_valid/acc_align': 55.13, 'best_valid_test/acc': 57.384, 'best_valid_test/acc_unbiased': 56.973, 'best_valid_test/diff': 5.6, 'best_valid_test/acc_skew': 59.773, 'best_valid_test/acc_align': 54.173}
[12 / 20] best test accuracy: 57.641 at epoch 9 
 best_stats: {'best_test_epoch': 9, 'best_test_valid/acc': 58.945, 'best_test_valid/acc_unbiased': 57.197, 'best_test_valid/diff': 4.956, 'best_test_valid/acc_skew': 58.533, 'best_test_valid/acc_align': 55.861, 'best_test_test/acc': 58.608, 'best_test_test/acc_unbiased': 57.641, 'best_test_test/diff': 6.091, 'best_test_test/acc_skew': 59.648, 'best_test_test/acc_align': 55.634}
[13 / 20] Learning rate: 0.0001 weight: 0.01
[13 / 20] Loss: 0.004249342775437981 CE Loss: 0.4249342866241932 Con Loss: 0.0
[13 / 20] tensor([[0.746, 0.685],
        [0.416, 0.397]]) {'epoch': 13, 'valid/acc': 58.987, 'valid/acc_unbiased': 58.1, 'valid/diff': 3.283, 'valid/acc_skew': 59.742, 'valid/acc_align': 56.459, 'test/acc': 56.498, 'test/acc_unbiased': 56.08, 'test/diff': 3.95, 'test/acc_skew': 58.055, 'test/acc_align': 54.105}
[13 / 20] best valid accuracy: 58.100 at epoch 13 
 best_stats: {'best_valid_epoch': 13, 'best_valid_valid/acc': 58.987, 'best_valid_valid/acc_unbiased': 58.1, 'best_valid_valid/diff': 3.283, 'best_valid_valid/acc_skew': 59.742, 'best_valid_valid/acc_align': 56.459, 'best_valid_test/acc': 56.498, 'best_valid_test/acc_unbiased': 56.08, 'best_valid_test/diff': 3.95, 'best_valid_test/acc_skew': 58.055, 'best_valid_test/acc_align': 54.105}
[13 / 20] best test accuracy: 57.641 at epoch 9 
 best_stats: {'best_test_epoch': 9, 'best_test_valid/acc': 58.945, 'best_test_valid/acc_unbiased': 57.197, 'best_test_valid/diff': 4.956, 'best_test_valid/acc_skew': 58.533, 'best_test_valid/acc_align': 55.861, 'best_test_test/acc': 58.608, 'best_test_test/acc_unbiased': 57.641, 'best_test_test/diff': 6.091, 'best_test_test/acc_skew': 59.648, 'best_test_test/acc_align': 55.634}
[14 / 20] Learning rate: 1e-05 weight: 0.01
[14 / 20] Loss: 0.007774391211569309 CE Loss: 0.7774391323328018 Con Loss: 0.0
[14 / 20] tensor([[0.835, 0.783],
        [0.355, 0.300]]) {'epoch': 14, 'valid/acc': 58.692, 'valid/acc_unbiased': 57.367, 'valid/diff': 3.941, 'valid/acc_skew': 59.337, 'valid/acc_align': 55.396, 'test/acc': 57.468, 'test/acc_unbiased': 56.828, 'test/diff': 5.354, 'test/acc_skew': 59.505, 'test/acc_align': 54.151}
[14 / 20] best valid accuracy: 58.100 at epoch 13 
 best_stats: {'best_valid_epoch': 13, 'best_valid_valid/acc': 58.987, 'best_valid_valid/acc_unbiased': 58.1, 'best_valid_valid/diff': 3.283, 'best_valid_valid/acc_skew': 59.742, 'best_valid_valid/acc_align': 56.459, 'best_valid_test/acc': 56.498, 'best_valid_test/acc_unbiased': 56.08, 'best_valid_test/diff': 3.95, 'best_valid_test/acc_skew': 58.055, 'best_valid_test/acc_align': 54.105}
[14 / 20] best test accuracy: 57.641 at epoch 9 
 best_stats: {'best_test_epoch': 9, 'best_test_valid/acc': 58.945, 'best_test_valid/acc_unbiased': 57.197, 'best_test_valid/diff': 4.956, 'best_test_valid/acc_skew': 58.533, 'best_test_valid/acc_align': 55.861, 'best_test_test/acc': 58.608, 'best_test_test/acc_unbiased': 57.641, 'best_test_test/diff': 6.091, 'best_test_test/acc_skew': 59.648, 'best_test_test/acc_align': 55.634}
[15 / 20] Learning rate: 1e-05 weight: 0.01
[15 / 20] Loss: 0.006228456972166896 CE Loss: 0.6228457093238831 Con Loss: 0.0
[15 / 20] tensor([[0.832, 0.786],
        [0.359, 0.273]]) {'epoch': 15, 'valid/acc': 58.017, 'valid/acc_unbiased': 56.669, 'valid/diff': 4.584, 'valid/acc_skew': 58.962, 'valid/acc_align': 54.377, 'test/acc': 56.793, 'test/acc_unbiased': 56.252, 'test/diff': 6.581, 'test/acc_skew': 59.542, 'test/acc_align': 52.961}
[15 / 20] best valid accuracy: 58.100 at epoch 13 
 best_stats: {'best_valid_epoch': 13, 'best_valid_valid/acc': 58.987, 'best_valid_valid/acc_unbiased': 58.1, 'best_valid_valid/diff': 3.283, 'best_valid_valid/acc_skew': 59.742, 'best_valid_valid/acc_align': 56.459, 'best_valid_test/acc': 56.498, 'best_valid_test/acc_unbiased': 56.08, 'best_valid_test/diff': 3.95, 'best_valid_test/acc_skew': 58.055, 'best_valid_test/acc_align': 54.105}
[15 / 20] best test accuracy: 57.641 at epoch 9 
 best_stats: {'best_test_epoch': 9, 'best_test_valid/acc': 58.945, 'best_test_valid/acc_unbiased': 57.197, 'best_test_valid/diff': 4.956, 'best_test_valid/acc_skew': 58.533, 'best_test_valid/acc_align': 55.861, 'best_test_test/acc': 58.608, 'best_test_test/acc_unbiased': 57.641, 'best_test_test/diff': 6.091, 'best_test_test/acc_skew': 59.648, 'best_test_test/acc_align': 55.634}
[16 / 20] Learning rate: 1e-05 weight: 0.01
[16 / 20] Loss: 0.005184037989238277 CE Loss: 0.5184038169682026 Con Loss: 0.0
[16 / 20] tensor([[0.806, 0.756],
        [0.372, 0.321]]) {'epoch': 16, 'valid/acc': 57.722, 'valid/acc_unbiased': 56.568, 'valid/diff': 6.272, 'valid/acc_skew': 59.704, 'valid/acc_align': 53.431, 'test/acc': 56.962, 'test/acc_unbiased': 56.399, 'test/diff': 5.076, 'test/acc_skew': 58.937, 'test/acc_align': 53.861}
[16 / 20] best valid accuracy: 58.100 at epoch 13 
 best_stats: {'best_valid_epoch': 13, 'best_valid_valid/acc': 58.987, 'best_valid_valid/acc_unbiased': 58.1, 'best_valid_valid/diff': 3.283, 'best_valid_valid/acc_skew': 59.742, 'best_valid_valid/acc_align': 56.459, 'best_valid_test/acc': 56.498, 'best_valid_test/acc_unbiased': 56.08, 'best_valid_test/diff': 3.95, 'best_valid_test/acc_skew': 58.055, 'best_valid_test/acc_align': 54.105}
[16 / 20] best test accuracy: 57.641 at epoch 9 
 best_stats: {'best_test_epoch': 9, 'best_test_valid/acc': 58.945, 'best_test_valid/acc_unbiased': 57.197, 'best_test_valid/diff': 4.956, 'best_test_valid/acc_skew': 58.533, 'best_test_valid/acc_align': 55.861, 'best_test_test/acc': 58.608, 'best_test_test/acc_unbiased': 57.641, 'best_test_test/diff': 6.091, 'best_test_test/acc_skew': 59.648, 'best_test_test/acc_align': 55.634}
[17 / 20] Learning rate: 1e-05 weight: 0.01
[17 / 20] Loss: 0.007041477860184386 CE Loss: 0.7041477933526039 Con Loss: 0.0
[17 / 20] tensor([[0.796, 0.730],
        [0.396, 0.361]]) {'epoch': 17, 'valid/acc': 58.27, 'valid/acc_unbiased': 57.164, 'valid/diff': 4.18, 'valid/acc_skew': 59.254, 'valid/acc_align': 55.074, 'test/acc': 57.553, 'test/acc_unbiased': 57.064, 'test/diff': 5.052, 'test/acc_skew': 59.59, 'test/acc_align': 54.538}
[17 / 20] best valid accuracy: 58.100 at epoch 13 
 best_stats: {'best_valid_epoch': 13, 'best_valid_valid/acc': 58.987, 'best_valid_valid/acc_unbiased': 58.1, 'best_valid_valid/diff': 3.283, 'best_valid_valid/acc_skew': 59.742, 'best_valid_valid/acc_align': 56.459, 'best_valid_test/acc': 56.498, 'best_valid_test/acc_unbiased': 56.08, 'best_valid_test/diff': 3.95, 'best_valid_test/acc_skew': 58.055, 'best_valid_test/acc_align': 54.105}
[17 / 20] best test accuracy: 57.641 at epoch 9 
 best_stats: {'best_test_epoch': 9, 'best_test_valid/acc': 58.945, 'best_test_valid/acc_unbiased': 57.197, 'best_test_valid/diff': 4.956, 'best_test_valid/acc_skew': 58.533, 'best_test_valid/acc_align': 55.861, 'best_test_test/acc': 58.608, 'best_test_test/acc_unbiased': 57.641, 'best_test_test/diff': 6.091, 'best_test_test/acc_skew': 59.648, 'best_test_test/acc_align': 55.634}
[18 / 20] Learning rate: 1e-05 weight: 0.01
[18 / 20] Loss: 0.006028248317306861 CE Loss: 0.6028248518705368 Con Loss: 0.0
[18 / 20] tensor([[0.891, 0.836],
        [0.275, 0.207]]) {'epoch': 18, 'valid/acc': 57.806, 'valid/acc_unbiased': 55.931, 'valid/diff': 4.045, 'valid/acc_skew': 57.954, 'valid/acc_align': 53.909, 'test/acc': 56.076, 'test/acc_unbiased': 55.204, 'test/diff': 6.15, 'test/acc_skew': 58.279, 'test/acc_align': 52.129}
[18 / 20] best valid accuracy: 58.100 at epoch 13 
 best_stats: {'best_valid_epoch': 13, 'best_valid_valid/acc': 58.987, 'best_valid_valid/acc_unbiased': 58.1, 'best_valid_valid/diff': 3.283, 'best_valid_valid/acc_skew': 59.742, 'best_valid_valid/acc_align': 56.459, 'best_valid_test/acc': 56.498, 'best_valid_test/acc_unbiased': 56.08, 'best_valid_test/diff': 3.95, 'best_valid_test/acc_skew': 58.055, 'best_valid_test/acc_align': 54.105}
[18 / 20] best test accuracy: 57.641 at epoch 9 
 best_stats: {'best_test_epoch': 9, 'best_test_valid/acc': 58.945, 'best_test_valid/acc_unbiased': 57.197, 'best_test_valid/diff': 4.956, 'best_test_valid/acc_skew': 58.533, 'best_test_valid/acc_align': 55.861, 'best_test_test/acc': 58.608, 'best_test_test/acc_unbiased': 57.641, 'best_test_test/diff': 6.091, 'best_test_test/acc_skew': 59.648, 'best_test_test/acc_align': 55.634}
[19 / 20] Learning rate: 1e-05 weight: 0.01
[19 / 20] Loss: 0.005221429659286514 CE Loss: 0.5221429746598005 Con Loss: 0.0
[19 / 20] tensor([[0.799, 0.736],
        [0.426, 0.364]]) {'epoch': 19, 'valid/acc': 59.283, 'valid/acc_unbiased': 58.242, 'valid/diff': 4.805, 'valid/acc_skew': 60.644, 'valid/acc_align': 55.839, 'test/acc': 58.481, 'test/acc_unbiased': 58.133, 'test/diff': 6.303, 'test/acc_skew': 61.285, 'test/acc_align': 54.982}
[19 / 20] best valid accuracy: 58.242 at epoch 19 
 best_stats: {'best_valid_epoch': 19, 'best_valid_valid/acc': 59.283, 'best_valid_valid/acc_unbiased': 58.242, 'best_valid_valid/diff': 4.805, 'best_valid_valid/acc_skew': 60.644, 'best_valid_valid/acc_align': 55.839, 'best_valid_test/acc': 58.481, 'best_valid_test/acc_unbiased': 58.133, 'best_valid_test/diff': 6.303, 'best_valid_test/acc_skew': 61.285, 'best_valid_test/acc_align': 54.982}
[19 / 20] best test accuracy: 58.133 at epoch 19 
 best_stats: {'best_test_epoch': 19, 'best_test_valid/acc': 59.283, 'best_test_valid/acc_unbiased': 58.242, 'best_test_valid/diff': 4.805, 'best_test_valid/acc_skew': 60.644, 'best_test_valid/acc_align': 55.839, 'best_test_test/acc': 58.481, 'best_test_test/acc_unbiased': 58.133, 'best_test_test/diff': 6.303, 'best_test_test/acc_skew': 61.285, 'best_test_test/acc_align': 54.982}
[20 / 20] Learning rate: 1e-05 weight: 0.01
[20 / 20] Loss: 0.00603221332130488 CE Loss: 0.6032213419675827 Con Loss: 0.0
[20 / 20] tensor([[0.665, 0.575],
        [0.556, 0.511]]) {'epoch': 20, 'valid/acc': 59.072, 'valid/acc_unbiased': 58.993, 'valid/diff': 3.383, 'valid/acc_skew': 60.685, 'valid/acc_align': 57.301, 'test/acc': 57.426, 'test/acc_unbiased': 57.672, 'test/diff': 6.771, 'test/acc_skew': 61.058, 'test/acc_align': 54.287}
[20 / 20] best valid accuracy: 58.993 at epoch 20 
 best_stats: {'best_valid_epoch': 20, 'best_valid_valid/acc': 59.072, 'best_valid_valid/acc_unbiased': 58.993, 'best_valid_valid/diff': 3.383, 'best_valid_valid/acc_skew': 60.685, 'best_valid_valid/acc_align': 57.301, 'best_valid_test/acc': 57.426, 'best_valid_test/acc_unbiased': 57.672, 'best_valid_test/diff': 6.771, 'best_valid_test/acc_skew': 61.058, 'best_valid_test/acc_align': 54.287}
[20 / 20] best test accuracy: 58.133 at epoch 19 
 best_stats: {'best_test_epoch': 19, 'best_test_valid/acc': 59.283, 'best_test_valid/acc_unbiased': 58.242, 'best_test_valid/diff': 4.805, 'best_test_valid/acc_skew': 60.644, 'best_test_valid/acc_align': 55.839, 'best_test_test/acc': 58.481, 'best_test_test/acc_unbiased': 58.133, 'best_test_test/diff': 6.303, 'best_test_test/acc_skew': 61.285, 'best_test_test/acc_align': 54.982}
Total training time: 0:11:49
