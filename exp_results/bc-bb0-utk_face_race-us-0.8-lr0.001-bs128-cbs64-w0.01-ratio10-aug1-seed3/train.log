Log level set to: INFO
Set seed: 3
=======> Using Fixed Random Seed: 3 <========
save_path: exp_results/bc-bb0-utk_face_race-us-0.8-lr0.001-bs128-cbs64-w0.01-ratio10-aug1-seed3
get_utk_face - split: train, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_race-0.8
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [4407, 1105]
Target 1: [881, 5529]
Binary Target 1
---------------------------
Target 0: [4407, 1105]
Target 1: [881, 5529]
===================================
Normal Label Distribution: 
Target 0: [4407, 1105]
Target 1: [881, 5529]
===================================
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [881, 881]
Target 1: [881, 881]
Binary Target 1
---------------------------
Target 0: [881, 881]
Target 1: [881, 881]
===================================
Normal Label Distribution: 
Target 0: [881, 881]
Target 1: [881, 881]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 3524, target_attr: gender, bias_attr: race bias_rate: 0.8
['[train] target_0-bias_0: 881', '[train] target_0-bias_1: 881', '[train] target_1-bias_0: 881', '[train] target_1-bias_1: 881']
confusion_matrix - 
 original: tensor([[881., 881.],
        [881., 881.]]), 
 normalized: tensor([[0.500, 0.500],
        [0.500, 0.500]]), 
 b|y: tensor([[0.500, 0.500],
        [0.500, 0.500]])
get_utk_face - split: train, aug: 1, given_y: True, ratio: 10
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_race-0.8
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [4407, 1105]
Target 1: [881, 5529]
Binary Target 1
---------------------------
Target 0: [4407, 1105]
Target 1: [881, 5529]
===================================
Normal Label Distribution: 
Target 0: [4407, 1105]
Target 1: [881, 5529]
===================================
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [881, 881]
Target 1: [881, 881]
Binary Target 1
---------------------------
Target 0: [881, 881]
Target 1: [881, 881]
===================================
Normal Label Distribution: 
Target 0: [881, 881]
Target 1: [881, 881]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 3524, target_attr: gender, bias_attr: race bias_rate: 0.8
['[train] target_0-bias_0: 881', '[train] target_0-bias_1: 881', '[train] target_1-bias_0: 881', '[train] target_1-bias_1: 881']
get_utk_face - split: valid, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_race-0.8
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [583, 684]
Target 1: [457, 646]
Binary Target 1
---------------------------
Target 0: [583, 684]
Target 1: [457, 646]
===================================
Normal Label Distribution: 
Target 0: [583, 684]
Target 1: [457, 646]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 2370, target_attr: gender, bias_attr: race bias_rate: 0.8
['[valid] target_0-bias_0: 583', '[valid] target_0-bias_1: 684', '[valid] target_1-bias_0: 457', '[valid] target_1-bias_1: 646']
get_utk_face - split: test, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_race-0.8
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [558, 677]
Target 1: [462, 673]
Binary Target 1
---------------------------
Target 0: [558, 677]
Target 1: [462, 673]
===================================
Normal Label Distribution: 
Target 0: [558, 677]
Target 1: [462, 673]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 2370, target_attr: gender, bias_attr: race bias_rate: 0.8
['[test] target_0-bias_0: 558', '[test] target_0-bias_1: 677', '[test] target_1-bias_0: 462', '[test] target_1-bias_1: 673']
decay_epochs: [6, 13]
[1 / 20] Learning rate: 0.001 weight: 0.01
[1 / 20] Loss: 5.067466706071349 CE Loss: 0.6979494958811532 Con Loss: 5.060487207029518
[1 / 20] tensor([[0.903, 0.894],
        [0.398, 0.435]]) {'epoch': 1, 'valid/acc': 68.987, 'valid/acc_unbiased': 67.549, 'valid/diff': 3.992, 'valid/acc_skew': 69.545, 'valid/acc_align': 65.553, 'test/acc': 66.92, 'test/acc_unbiased': 65.763, 'test/diff': 2.334, 'test/acc_skew': 65.075, 'test/acc_align': 66.451}
[1 / 20] best valid accuracy: 67.549 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 68.987, 'best_valid_valid/acc_unbiased': 67.549, 'best_valid_valid/diff': 3.992, 'best_valid_valid/acc_skew': 69.545, 'best_valid_valid/acc_align': 65.553, 'best_valid_test/acc': 66.92, 'best_valid_test/acc_unbiased': 65.763, 'best_valid_test/diff': 2.334, 'best_valid_test/acc_skew': 65.075, 'best_valid_test/acc_align': 66.451}
[1 / 20] best test accuracy: 65.763 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 68.987, 'best_test_valid/acc_unbiased': 67.549, 'best_test_valid/diff': 3.992, 'best_test_valid/acc_skew': 69.545, 'best_test_valid/acc_align': 65.553, 'best_test_test/acc': 66.92, 'best_test_test/acc_unbiased': 65.763, 'best_test_test/diff': 2.334, 'best_test_test/acc_skew': 65.075, 'best_test_test/acc_align': 66.451}
[2 / 20] Learning rate: 0.001 weight: 0.01
[2 / 20] Loss: 4.8114776925250435 CE Loss: 0.5465205343573372 Con Loss: 4.806012464841568
[2 / 20] tensor([[0.878, 0.829],
        [0.669, 0.691]]) {'epoch': 2, 'valid/acc': 77.975, 'valid/acc_unbiased': 77.277, 'valid/diff': 1.994, 'valid/acc_skew': 77.834, 'valid/acc_align': 76.72, 'test/acc': 77.004, 'test/acc_unbiased': 76.664, 'test/diff': 3.579, 'test/acc_skew': 77.348, 'test/acc_align': 75.98}
[2 / 20] best valid accuracy: 77.277 at epoch 2 
 best_stats: {'best_valid_epoch': 2, 'best_valid_valid/acc': 77.975, 'best_valid_valid/acc_unbiased': 77.277, 'best_valid_valid/diff': 1.994, 'best_valid_valid/acc_skew': 77.834, 'best_valid_valid/acc_align': 76.72, 'best_valid_test/acc': 77.004, 'best_valid_test/acc_unbiased': 76.664, 'best_valid_test/diff': 3.579, 'best_valid_test/acc_skew': 77.348, 'best_valid_test/acc_align': 75.98}
[2 / 20] best test accuracy: 76.664 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 77.975, 'best_test_valid/acc_unbiased': 77.277, 'best_test_valid/diff': 1.994, 'best_test_valid/acc_skew': 77.834, 'best_test_valid/acc_align': 76.72, 'best_test_test/acc': 77.004, 'best_test_test/acc_unbiased': 76.664, 'best_test_test/diff': 3.579, 'best_test_test/acc_skew': 77.348, 'best_test_test/acc_align': 75.98}
[3 / 20] Learning rate: 0.001 weight: 0.01
[3 / 20] Loss: 4.785494959719741 CE Loss: 0.4940259370035265 Con Loss: 4.780554706473898
[3 / 20] tensor([[0.970, 0.936],
        [0.485, 0.513]]) {'epoch': 3, 'valid/acc': 74.979, 'valid/acc_unbiased': 73.558, 'valid/diff': 2.095, 'valid/acc_skew': 74.605, 'valid/acc_align': 72.51, 'test/acc': 73.587, 'test/acc_unbiased': 72.587, 'test/diff': 3.042, 'test/acc_skew': 72.719, 'test/acc_align': 72.456}
[3 / 20] best valid accuracy: 77.277 at epoch 2 
 best_stats: {'best_valid_epoch': 2, 'best_valid_valid/acc': 77.975, 'best_valid_valid/acc_unbiased': 77.277, 'best_valid_valid/diff': 1.994, 'best_valid_valid/acc_skew': 77.834, 'best_valid_valid/acc_align': 76.72, 'best_valid_test/acc': 77.004, 'best_valid_test/acc_unbiased': 76.664, 'best_valid_test/diff': 3.579, 'best_valid_test/acc_skew': 77.348, 'best_valid_test/acc_align': 75.98}
[3 / 20] best test accuracy: 76.664 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 77.975, 'best_test_valid/acc_unbiased': 77.277, 'best_test_valid/diff': 1.994, 'best_test_valid/acc_skew': 77.834, 'best_test_valid/acc_align': 76.72, 'best_test_test/acc': 77.004, 'best_test_test/acc_unbiased': 76.664, 'best_test_test/diff': 3.579, 'best_test_test/acc_skew': 77.348, 'best_test_test/acc_align': 75.98}
[4 / 20] Learning rate: 0.001 weight: 0.01
[4 / 20] Loss: 4.768309323660497 CE Loss: 0.4772285257849872 Con Loss: 4.763536992327444
[4 / 20] tensor([[0.935, 0.907],
        [0.656, 0.658]]) {'epoch': 4, 'valid/acc': 79.536, 'valid/acc_unbiased': 78.746, 'valid/diff': 2.634, 'valid/acc_skew': 80.064, 'valid/acc_align': 77.429, 'test/acc': 79.409, 'test/acc_unbiased': 78.913, 'test/diff': 1.547, 'test/acc_skew': 79.566, 'test/acc_align': 78.259}
[4 / 20] best valid accuracy: 78.746 at epoch 4 
 best_stats: {'best_valid_epoch': 4, 'best_valid_valid/acc': 79.536, 'best_valid_valid/acc_unbiased': 78.746, 'best_valid_valid/diff': 2.634, 'best_valid_valid/acc_skew': 80.064, 'best_valid_valid/acc_align': 77.429, 'best_valid_test/acc': 79.409, 'best_valid_test/acc_unbiased': 78.913, 'best_valid_test/diff': 1.547, 'best_valid_test/acc_skew': 79.566, 'best_valid_test/acc_align': 78.259}
[4 / 20] best test accuracy: 78.913 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 79.536, 'best_test_valid/acc_unbiased': 78.746, 'best_test_valid/diff': 2.634, 'best_test_valid/acc_skew': 80.064, 'best_test_valid/acc_align': 77.429, 'best_test_test/acc': 79.409, 'best_test_test/acc_unbiased': 78.913, 'best_test_test/diff': 1.547, 'best_test_test/acc_skew': 79.566, 'best_test_test/acc_align': 78.259}
[5 / 20] Learning rate: 0.001 weight: 0.01
[5 / 20] Loss: 4.75583502383021 CE Loss: 0.45596557957089584 Con Loss: 4.751275353209791
[5 / 20] tensor([[0.894, 0.926],
        [0.680, 0.648]]) {'epoch': 5, 'valid/acc': 79.831, 'valid/acc_unbiased': 79.399, 'valid/diff': 4.197, 'valid/acc_skew': 81.497, 'valid/acc_align': 77.3, 'test/acc': 79.156, 'test/acc_unbiased': 78.698, 'test/diff': 3.184, 'test/acc_skew': 78.696, 'test/acc_align': 78.7}
[5 / 20] best valid accuracy: 79.399 at epoch 5 
 best_stats: {'best_valid_epoch': 5, 'best_valid_valid/acc': 79.831, 'best_valid_valid/acc_unbiased': 79.399, 'best_valid_valid/diff': 4.197, 'best_valid_valid/acc_skew': 81.497, 'best_valid_valid/acc_align': 77.3, 'best_valid_test/acc': 79.156, 'best_valid_test/acc_unbiased': 78.698, 'best_valid_test/diff': 3.184, 'best_valid_test/acc_skew': 78.696, 'best_valid_test/acc_align': 78.7}
[5 / 20] best test accuracy: 78.913 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 79.536, 'best_test_valid/acc_unbiased': 78.746, 'best_test_valid/diff': 2.634, 'best_test_valid/acc_skew': 80.064, 'best_test_valid/acc_align': 77.429, 'best_test_test/acc': 79.409, 'best_test_test/acc_unbiased': 78.913, 'best_test_test/diff': 1.547, 'best_test_test/acc_skew': 79.566, 'best_test_test/acc_align': 78.259}
[6 / 20] Learning rate: 0.001 weight: 0.01
[6 / 20] Loss: 4.751497527392038 CE Loss: 0.4449235000959455 Con Loss: 4.747048267035424
[6 / 20] tensor([[0.582, 0.578],
        [0.968, 0.963]]) {'epoch': 6, 'valid/acc': 75.738, 'valid/acc_unbiased': 77.08, 'valid/diff': 2.498, 'valid/acc_skew': 77.518, 'valid/acc_align': 76.643, 'test/acc': 76.414, 'test/acc_unbiased': 77.259, 'test/diff': 0.478, 'test/acc_skew': 77.498, 'test/acc_align': 77.02}
[6 / 20] best valid accuracy: 79.399 at epoch 5 
 best_stats: {'best_valid_epoch': 5, 'best_valid_valid/acc': 79.831, 'best_valid_valid/acc_unbiased': 79.399, 'best_valid_valid/diff': 4.197, 'best_valid_valid/acc_skew': 81.497, 'best_valid_valid/acc_align': 77.3, 'best_valid_test/acc': 79.156, 'best_valid_test/acc_unbiased': 78.698, 'best_valid_test/diff': 3.184, 'best_valid_test/acc_skew': 78.696, 'best_valid_test/acc_align': 78.7}
[6 / 20] best test accuracy: 78.913 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 79.536, 'best_test_valid/acc_unbiased': 78.746, 'best_test_valid/diff': 2.634, 'best_test_valid/acc_skew': 80.064, 'best_test_valid/acc_align': 77.429, 'best_test_test/acc': 79.409, 'best_test_test/acc_unbiased': 78.913, 'best_test_test/diff': 1.547, 'best_test_test/acc_skew': 79.566, 'best_test_test/acc_align': 78.259}
[7 / 20] Learning rate: 0.0001 weight: 0.01
[7 / 20] Loss: 4.728569738169399 CE Loss: 0.4188128278826477 Con Loss: 4.724381575654774
[7 / 20] tensor([[0.835, 0.808],
        [0.844, 0.847]]) {'epoch': 7, 'valid/acc': 82.785, 'valid/acc_unbiased': 83.177, 'valid/diff': 4.925, 'valid/acc_skew': 85.64, 'valid/acc_align': 80.715, 'test/acc': 83.249, 'test/acc_unbiased': 83.355, 'test/diff': 1.497, 'test/acc_skew': 83.964, 'test/acc_align': 82.747}
[7 / 20] best valid accuracy: 83.177 at epoch 7 
 best_stats: {'best_valid_epoch': 7, 'best_valid_valid/acc': 82.785, 'best_valid_valid/acc_unbiased': 83.177, 'best_valid_valid/diff': 4.925, 'best_valid_valid/acc_skew': 85.64, 'best_valid_valid/acc_align': 80.715, 'best_valid_test/acc': 83.249, 'best_valid_test/acc_unbiased': 83.355, 'best_valid_test/diff': 1.497, 'best_valid_test/acc_skew': 83.964, 'best_valid_test/acc_align': 82.747}
[7 / 20] best test accuracy: 83.355 at epoch 7 
 best_stats: {'best_test_epoch': 7, 'best_test_valid/acc': 82.785, 'best_test_valid/acc_unbiased': 83.177, 'best_test_valid/diff': 4.925, 'best_test_valid/acc_skew': 85.64, 'best_test_valid/acc_align': 80.715, 'best_test_test/acc': 83.249, 'best_test_test/acc_unbiased': 83.355, 'best_test_test/diff': 1.497, 'best_test_test/acc_skew': 83.964, 'best_test_test/acc_align': 82.747}
[8 / 20] Learning rate: 0.0001 weight: 0.01
[8 / 20] Loss: 4.705309076016932 CE Loss: 0.399593702307083 Con Loss: 4.701313142202769
[8 / 20] tensor([[0.869, 0.852],
        [0.810, 0.822]]) {'epoch': 8, 'valid/acc': 83.966, 'valid/acc_unbiased': 83.988, 'valid/diff': 3.777, 'valid/acc_skew': 85.877, 'valid/acc_align': 82.099, 'test/acc': 83.924, 'test/acc_unbiased': 83.817, 'test/diff': 1.453, 'test/acc_skew': 83.935, 'test/acc_align': 83.699}
[8 / 20] best valid accuracy: 83.988 at epoch 8 
 best_stats: {'best_valid_epoch': 8, 'best_valid_valid/acc': 83.966, 'best_valid_valid/acc_unbiased': 83.988, 'best_valid_valid/diff': 3.777, 'best_valid_valid/acc_skew': 85.877, 'best_valid_valid/acc_align': 82.099, 'best_valid_test/acc': 83.924, 'best_valid_test/acc_unbiased': 83.817, 'best_valid_test/diff': 1.453, 'best_valid_test/acc_skew': 83.935, 'best_valid_test/acc_align': 83.699}
[8 / 20] best test accuracy: 83.817 at epoch 8 
 best_stats: {'best_test_epoch': 8, 'best_test_valid/acc': 83.966, 'best_test_valid/acc_unbiased': 83.988, 'best_test_valid/diff': 3.777, 'best_test_valid/acc_skew': 85.877, 'best_test_valid/acc_align': 82.099, 'best_test_test/acc': 83.924, 'best_test_test/acc_unbiased': 83.817, 'best_test_test/diff': 1.453, 'best_test_test/acc_skew': 83.935, 'best_test_test/acc_align': 83.699}
[9 / 20] Learning rate: 0.0001 weight: 0.01
[9 / 20] Loss: 4.685420232787982 CE Loss: 0.38315646385902985 Con Loss: 4.681588657868436
[9 / 20] tensor([[0.830, 0.812],
        [0.857, 0.862]]) {'epoch': 9, 'valid/acc': 83.84, 'valid/acc_unbiased': 84.22, 'valid/diff': 4.105, 'valid/acc_skew': 86.273, 'valid/acc_align': 82.168, 'test/acc': 83.924, 'test/acc_unbiased': 84.028, 'test/diff': 1.101, 'test/acc_skew': 84.345, 'test/acc_align': 83.711}
[9 / 20] best valid accuracy: 84.220 at epoch 9 
 best_stats: {'best_valid_epoch': 9, 'best_valid_valid/acc': 83.84, 'best_valid_valid/acc_unbiased': 84.22, 'best_valid_valid/diff': 4.105, 'best_valid_valid/acc_skew': 86.273, 'best_valid_valid/acc_align': 82.168, 'best_valid_test/acc': 83.924, 'best_valid_test/acc_unbiased': 84.028, 'best_valid_test/diff': 1.101, 'best_valid_test/acc_skew': 84.345, 'best_valid_test/acc_align': 83.711}
[9 / 20] best test accuracy: 84.028 at epoch 9 
 best_stats: {'best_test_epoch': 9, 'best_test_valid/acc': 83.84, 'best_test_valid/acc_unbiased': 84.22, 'best_test_valid/diff': 4.105, 'best_test_valid/acc_skew': 86.273, 'best_test_valid/acc_align': 82.168, 'best_test_test/acc': 83.924, 'best_test_test/acc_unbiased': 84.028, 'best_test_test/diff': 1.101, 'best_test_test/acc_skew': 84.345, 'best_test_test/acc_align': 83.711}
[10 / 20] Learning rate: 0.0001 weight: 0.01
[10 / 20] Loss: 4.675420295637393 CE Loss: 0.3725899927123586 Con Loss: 4.671694370187506
[10 / 20] tensor([[0.817, 0.780],
        [0.879, 0.874]]) {'epoch': 10, 'valid/acc': 83.08, 'valid/acc_unbiased': 83.599, 'valid/diff': 3.448, 'valid/acc_skew': 85.323, 'valid/acc_align': 81.876, 'test/acc': 83.46, 'test/acc_unbiased': 83.74, 'test/diff': 2.119, 'test/acc_skew': 84.8, 'test/acc_align': 82.681}
[10 / 20] best valid accuracy: 84.220 at epoch 9 
 best_stats: {'best_valid_epoch': 9, 'best_valid_valid/acc': 83.84, 'best_valid_valid/acc_unbiased': 84.22, 'best_valid_valid/diff': 4.105, 'best_valid_valid/acc_skew': 86.273, 'best_valid_valid/acc_align': 82.168, 'best_valid_test/acc': 83.924, 'best_valid_test/acc_unbiased': 84.028, 'best_valid_test/diff': 1.101, 'best_valid_test/acc_skew': 84.345, 'best_valid_test/acc_align': 83.711}
[10 / 20] best test accuracy: 84.028 at epoch 9 
 best_stats: {'best_test_epoch': 9, 'best_test_valid/acc': 83.84, 'best_test_valid/acc_unbiased': 84.22, 'best_test_valid/diff': 4.105, 'best_test_valid/acc_skew': 86.273, 'best_test_valid/acc_align': 82.168, 'best_test_test/acc': 83.924, 'best_test_test/acc_unbiased': 84.028, 'best_test_test/diff': 1.101, 'best_test_test/acc_skew': 84.345, 'best_test_test/acc_align': 83.711}
[11 / 20] Learning rate: 0.0001 weight: 0.01
[11 / 20] Loss: 4.665683080606104 CE Loss: 0.36496880677582594 Con Loss: 4.662033446395302
[11 / 20] tensor([[0.810, 0.793],
        [0.881, 0.893]]) {'epoch': 11, 'valid/acc': 84.093, 'valid/acc_unbiased': 84.619, 'valid/diff': 3.655, 'valid/acc_skew': 86.447, 'valid/acc_align': 82.792, 'test/acc': 84.262, 'test/acc_unbiased': 84.43, 'test/diff': 1.445, 'test/acc_skew': 84.549, 'test/acc_align': 84.311}
[11 / 20] best valid accuracy: 84.619 at epoch 11 
 best_stats: {'best_valid_epoch': 11, 'best_valid_valid/acc': 84.093, 'best_valid_valid/acc_unbiased': 84.619, 'best_valid_valid/diff': 3.655, 'best_valid_valid/acc_skew': 86.447, 'best_valid_valid/acc_align': 82.792, 'best_valid_test/acc': 84.262, 'best_valid_test/acc_unbiased': 84.43, 'best_valid_test/diff': 1.445, 'best_valid_test/acc_skew': 84.549, 'best_valid_test/acc_align': 84.311}
[11 / 20] best test accuracy: 84.430 at epoch 11 
 best_stats: {'best_test_epoch': 11, 'best_test_valid/acc': 84.093, 'best_test_valid/acc_unbiased': 84.619, 'best_test_valid/diff': 3.655, 'best_test_valid/acc_skew': 86.447, 'best_test_valid/acc_align': 82.792, 'best_test_test/acc': 84.262, 'best_test_test/acc_unbiased': 84.43, 'best_test_test/diff': 1.445, 'best_test_test/acc_skew': 84.549, 'best_test_test/acc_align': 84.311}
[12 / 20] Learning rate: 0.0001 weight: 0.01
[12 / 20] Loss: 4.661876384029323 CE Loss: 0.37759330665754 Con Loss: 4.658100473488365
[12 / 20] tensor([[0.860, 0.830],
        [0.831, 0.845]]) {'epoch': 12, 'valid/acc': 84.81, 'valid/acc_unbiased': 85.056, 'valid/diff': 3.617, 'valid/acc_skew': 86.864, 'valid/acc_align': 83.247, 'test/acc': 84.177, 'test/acc_unbiased': 84.175, 'test/diff': 2.219, 'test/acc_skew': 84.569, 'test/acc_align': 83.78}
[12 / 20] best valid accuracy: 85.056 at epoch 12 
 best_stats: {'best_valid_epoch': 12, 'best_valid_valid/acc': 84.81, 'best_valid_valid/acc_unbiased': 85.056, 'best_valid_valid/diff': 3.617, 'best_valid_valid/acc_skew': 86.864, 'best_valid_valid/acc_align': 83.247, 'best_valid_test/acc': 84.177, 'best_valid_test/acc_unbiased': 84.175, 'best_valid_test/diff': 2.219, 'best_valid_test/acc_skew': 84.569, 'best_valid_test/acc_align': 83.78}
[12 / 20] best test accuracy: 84.430 at epoch 11 
 best_stats: {'best_test_epoch': 11, 'best_test_valid/acc': 84.093, 'best_test_valid/acc_unbiased': 84.619, 'best_test_valid/diff': 3.655, 'best_test_valid/acc_skew': 86.447, 'best_test_valid/acc_align': 82.792, 'best_test_test/acc': 84.262, 'best_test_test/acc_unbiased': 84.43, 'best_test_test/diff': 1.445, 'best_test_test/acc_skew': 84.549, 'best_test_test/acc_align': 84.311}
[13 / 20] Learning rate: 0.0001 weight: 0.01
[13 / 20] Loss: 4.6720856115577165 CE Loss: 0.36120628914822245 Con Loss: 4.668473557635685
[13 / 20] tensor([[0.803, 0.798],
        [0.898, 0.893]]) {'epoch': 13, 'valid/acc': 83.671, 'valid/acc_unbiased': 84.151, 'valid/diff': 2.907, 'valid/acc_skew': 85.604, 'valid/acc_align': 82.697, 'test/acc': 84.557, 'test/acc_unbiased': 84.795, 'test/diff': 0.524, 'test/acc_skew': 85.057, 'test/acc_align': 84.533}
[13 / 20] best valid accuracy: 85.056 at epoch 12 
 best_stats: {'best_valid_epoch': 12, 'best_valid_valid/acc': 84.81, 'best_valid_valid/acc_unbiased': 85.056, 'best_valid_valid/diff': 3.617, 'best_valid_valid/acc_skew': 86.864, 'best_valid_valid/acc_align': 83.247, 'best_valid_test/acc': 84.177, 'best_valid_test/acc_unbiased': 84.175, 'best_valid_test/diff': 2.219, 'best_valid_test/acc_skew': 84.569, 'best_valid_test/acc_align': 83.78}
[13 / 20] best test accuracy: 84.795 at epoch 13 
 best_stats: {'best_test_epoch': 13, 'best_test_valid/acc': 83.671, 'best_test_valid/acc_unbiased': 84.151, 'best_test_valid/diff': 2.907, 'best_test_valid/acc_skew': 85.604, 'best_test_valid/acc_align': 82.697, 'best_test_test/acc': 84.557, 'best_test_test/acc_unbiased': 84.795, 'best_test_test/diff': 0.524, 'best_test_test/acc_skew': 85.057, 'best_test_test/acc_align': 84.533}
[14 / 20] Learning rate: 1e-05 weight: 0.01
[14 / 20] Loss: 4.650999936830172 CE Loss: 0.35402451413308317 Con Loss: 4.647459698048136
[14 / 20] tensor([[0.801, 0.799],
        [0.894, 0.889]]) {'epoch': 14, 'valid/acc': 83.587, 'valid/acc_unbiased': 84.035, 'valid/diff': 2.639, 'valid/acc_skew': 85.3, 'valid/acc_align': 82.77, 'test/acc': 84.346, 'test/acc_unbiased': 84.567, 'test/diff': 0.367, 'test/acc_skew': 84.751, 'test/acc_align': 84.384}
[14 / 20] best valid accuracy: 85.056 at epoch 12 
 best_stats: {'best_valid_epoch': 12, 'best_valid_valid/acc': 84.81, 'best_valid_valid/acc_unbiased': 85.056, 'best_valid_valid/diff': 3.617, 'best_valid_valid/acc_skew': 86.864, 'best_valid_valid/acc_align': 83.247, 'best_valid_test/acc': 84.177, 'best_valid_test/acc_unbiased': 84.175, 'best_valid_test/diff': 2.219, 'best_valid_test/acc_skew': 84.569, 'best_valid_test/acc_align': 83.78}
[14 / 20] best test accuracy: 84.795 at epoch 13 
 best_stats: {'best_test_epoch': 13, 'best_test_valid/acc': 83.671, 'best_test_valid/acc_unbiased': 84.151, 'best_test_valid/diff': 2.907, 'best_test_valid/acc_skew': 85.604, 'best_test_valid/acc_align': 82.697, 'best_test_test/acc': 84.557, 'best_test_test/acc_unbiased': 84.795, 'best_test_test/diff': 0.524, 'best_test_test/acc_skew': 85.057, 'best_test_test/acc_align': 84.533}
[15 / 20] Learning rate: 1e-05 weight: 0.01
[15 / 20] Loss: 4.640266390312273 CE Loss: 0.35139253353287764 Con Loss: 4.636752479328065
[15 / 20] tensor([[0.824, 0.827],
        [0.866, 0.868]]) {'epoch': 15, 'valid/acc': 84.346, 'valid/acc_unbiased': 84.678, 'valid/diff': 3.189, 'valid/acc_skew': 86.273, 'valid/acc_align': 83.084, 'test/acc': 84.557, 'test/acc_unbiased': 84.628, 'test/diff': 0.238, 'test/acc_skew': 84.509, 'test/acc_align': 84.747}
[15 / 20] best valid accuracy: 85.056 at epoch 12 
 best_stats: {'best_valid_epoch': 12, 'best_valid_valid/acc': 84.81, 'best_valid_valid/acc_unbiased': 85.056, 'best_valid_valid/diff': 3.617, 'best_valid_valid/acc_skew': 86.864, 'best_valid_valid/acc_align': 83.247, 'best_valid_test/acc': 84.177, 'best_valid_test/acc_unbiased': 84.175, 'best_valid_test/diff': 2.219, 'best_valid_test/acc_skew': 84.569, 'best_valid_test/acc_align': 83.78}
[15 / 20] best test accuracy: 84.795 at epoch 13 
 best_stats: {'best_test_epoch': 13, 'best_test_valid/acc': 83.671, 'best_test_valid/acc_unbiased': 84.151, 'best_test_valid/diff': 2.907, 'best_test_valid/acc_skew': 85.604, 'best_test_valid/acc_align': 82.697, 'best_test_test/acc': 84.557, 'best_test_test/acc_unbiased': 84.795, 'best_test_test/diff': 0.524, 'best_test_test/acc_skew': 85.057, 'best_test_test/acc_align': 84.533}
[16 / 20] Learning rate: 1e-05 weight: 0.01
[16 / 20] Loss: 4.657031586979358 CE Loss: 0.36884490494424993 Con Loss: 4.653343136275397
[16 / 20] tensor([[0.837, 0.823],
        [0.859, 0.868]]) {'epoch': 16, 'valid/acc': 84.346, 'valid/acc_unbiased': 84.691, 'valid/diff': 3.678, 'valid/acc_skew': 86.53, 'valid/acc_align': 82.852, 'test/acc': 84.599, 'test/acc_unbiased': 84.668, 'test/diff': 1.131, 'test/acc_skew': 84.811, 'test/acc_align': 84.525}
[16 / 20] best valid accuracy: 85.056 at epoch 12 
 best_stats: {'best_valid_epoch': 12, 'best_valid_valid/acc': 84.81, 'best_valid_valid/acc_unbiased': 85.056, 'best_valid_valid/diff': 3.617, 'best_valid_valid/acc_skew': 86.864, 'best_valid_valid/acc_align': 83.247, 'best_valid_test/acc': 84.177, 'best_valid_test/acc_unbiased': 84.175, 'best_valid_test/diff': 2.219, 'best_valid_test/acc_skew': 84.569, 'best_valid_test/acc_align': 83.78}
[16 / 20] best test accuracy: 84.795 at epoch 13 
 best_stats: {'best_test_epoch': 13, 'best_test_valid/acc': 83.671, 'best_test_valid/acc_unbiased': 84.151, 'best_test_valid/diff': 2.907, 'best_test_valid/acc_skew': 85.604, 'best_test_valid/acc_align': 82.697, 'best_test_test/acc': 84.557, 'best_test_test/acc_unbiased': 84.795, 'best_test_test/diff': 0.524, 'best_test_test/acc_skew': 85.057, 'best_test_test/acc_align': 84.533}
[17 / 20] Learning rate: 1e-05 weight: 0.01
[17 / 20] Loss: 4.640345713066595 CE Loss: 0.3494937956739094 Con Loss: 4.636850786263231
[17 / 20] tensor([[0.824, 0.811],
        [0.877, 0.871]]) {'epoch': 17, 'valid/acc': 84.346, 'valid/acc_unbiased': 84.722, 'valid/diff': 3.242, 'valid/acc_skew': 86.344, 'valid/acc_align': 83.101, 'test/acc': 84.388, 'test/acc_unbiased': 84.566, 'test/diff': 0.967, 'test/acc_skew': 85.05, 'test/acc_align': 84.083}
[17 / 20] best valid accuracy: 85.056 at epoch 12 
 best_stats: {'best_valid_epoch': 12, 'best_valid_valid/acc': 84.81, 'best_valid_valid/acc_unbiased': 85.056, 'best_valid_valid/diff': 3.617, 'best_valid_valid/acc_skew': 86.864, 'best_valid_valid/acc_align': 83.247, 'best_valid_test/acc': 84.177, 'best_valid_test/acc_unbiased': 84.175, 'best_valid_test/diff': 2.219, 'best_valid_test/acc_skew': 84.569, 'best_valid_test/acc_align': 83.78}
[17 / 20] best test accuracy: 84.795 at epoch 13 
 best_stats: {'best_test_epoch': 13, 'best_test_valid/acc': 83.671, 'best_test_valid/acc_unbiased': 84.151, 'best_test_valid/diff': 2.907, 'best_test_valid/acc_skew': 85.604, 'best_test_valid/acc_align': 82.697, 'best_test_test/acc': 84.557, 'best_test_test/acc_unbiased': 84.795, 'best_test_test/diff': 0.524, 'best_test_test/acc_skew': 85.057, 'best_test_test/acc_align': 84.533}
[18 / 20] Learning rate: 1e-05 weight: 0.01
[18 / 20] Loss: 4.627836458528759 CE Loss: 0.34962445054368185 Con Loss: 4.624340252221375
[18 / 20] tensor([[0.839, 0.817],
        [0.864, 0.863]]) {'epoch': 18, 'valid/acc': 84.093, 'valid/acc_unbiased': 84.474, 'valid/diff': 3.692, 'valid/acc_skew': 86.32, 'valid/acc_align': 82.628, 'test/acc': 84.43, 'test/acc_unbiased': 84.562, 'test/diff': 1.11, 'test/acc_skew': 85.117, 'test/acc_align': 84.007}
[18 / 20] best valid accuracy: 85.056 at epoch 12 
 best_stats: {'best_valid_epoch': 12, 'best_valid_valid/acc': 84.81, 'best_valid_valid/acc_unbiased': 85.056, 'best_valid_valid/diff': 3.617, 'best_valid_valid/acc_skew': 86.864, 'best_valid_valid/acc_align': 83.247, 'best_valid_test/acc': 84.177, 'best_valid_test/acc_unbiased': 84.175, 'best_valid_test/diff': 2.219, 'best_valid_test/acc_skew': 84.569, 'best_valid_test/acc_align': 83.78}
[18 / 20] best test accuracy: 84.795 at epoch 13 
 best_stats: {'best_test_epoch': 13, 'best_test_valid/acc': 83.671, 'best_test_valid/acc_unbiased': 84.151, 'best_test_valid/diff': 2.907, 'best_test_valid/acc_skew': 85.604, 'best_test_valid/acc_align': 82.697, 'best_test_test/acc': 84.557, 'best_test_test/acc_unbiased': 84.795, 'best_test_test/diff': 0.524, 'best_test_test/acc_skew': 85.057, 'best_test_test/acc_align': 84.533}
[19 / 20] Learning rate: 1e-05 weight: 0.01
[19 / 20] Loss: 4.657937705855094 CE Loss: 0.3602149941526125 Con Loss: 4.6543355675479745
[19 / 20] tensor([[0.848, 0.842],
        [0.853, 0.848]]) {'epoch': 19, 'valid/acc': 84.852, 'valid/acc_unbiased': 85.167, 'valid/diff': 4.269, 'valid/acc_skew': 87.302, 'valid/acc_align': 83.032, 'test/acc': 84.726, 'test/acc_unbiased': 84.772, 'test/diff': 0.505, 'test/acc_skew': 85.024, 'test/acc_align': 84.519}
[19 / 20] best valid accuracy: 85.167 at epoch 19 
 best_stats: {'best_valid_epoch': 19, 'best_valid_valid/acc': 84.852, 'best_valid_valid/acc_unbiased': 85.167, 'best_valid_valid/diff': 4.269, 'best_valid_valid/acc_skew': 87.302, 'best_valid_valid/acc_align': 83.032, 'best_valid_test/acc': 84.726, 'best_valid_test/acc_unbiased': 84.772, 'best_valid_test/diff': 0.505, 'best_valid_test/acc_skew': 85.024, 'best_valid_test/acc_align': 84.519}
[19 / 20] best test accuracy: 84.795 at epoch 13 
 best_stats: {'best_test_epoch': 13, 'best_test_valid/acc': 83.671, 'best_test_valid/acc_unbiased': 84.151, 'best_test_valid/diff': 2.907, 'best_test_valid/acc_skew': 85.604, 'best_test_valid/acc_align': 82.697, 'best_test_test/acc': 84.557, 'best_test_test/acc_unbiased': 84.795, 'best_test_test/diff': 0.524, 'best_test_test/acc_skew': 85.057, 'best_test_test/acc_align': 84.533}
[20 / 20] Learning rate: 1e-05 weight: 0.01
[20 / 20] Loss: 4.651121231538077 CE Loss: 0.3507193713602224 Con Loss: 4.647614057976055
[20 / 20] tensor([[0.819, 0.806],
        [0.883, 0.874]]) {'epoch': 20, 'valid/acc': 84.051, 'valid/acc_unbiased': 84.485, 'valid/diff': 3.516, 'valid/acc_skew': 86.243, 'valid/acc_align': 82.727, 'test/acc': 84.346, 'test/acc_unbiased': 84.558, 'test/diff': 1.096, 'test/acc_skew': 85.106, 'test/acc_align': 84.01}
[20 / 20] best valid accuracy: 85.167 at epoch 19 
 best_stats: {'best_valid_epoch': 19, 'best_valid_valid/acc': 84.852, 'best_valid_valid/acc_unbiased': 85.167, 'best_valid_valid/diff': 4.269, 'best_valid_valid/acc_skew': 87.302, 'best_valid_valid/acc_align': 83.032, 'best_valid_test/acc': 84.726, 'best_valid_test/acc_unbiased': 84.772, 'best_valid_test/diff': 0.505, 'best_valid_test/acc_skew': 85.024, 'best_valid_test/acc_align': 84.519}
[20 / 20] best test accuracy: 84.795 at epoch 13 
 best_stats: {'best_test_epoch': 13, 'best_test_valid/acc': 83.671, 'best_test_valid/acc_unbiased': 84.151, 'best_test_valid/diff': 2.907, 'best_test_valid/acc_skew': 85.604, 'best_test_valid/acc_align': 82.697, 'best_test_test/acc': 84.557, 'best_test_test/acc_unbiased': 84.795, 'best_test_test/diff': 0.524, 'best_test_test/acc_skew': 85.057, 'best_test_test/acc_align': 84.533}
Total training time: 0:21:37
