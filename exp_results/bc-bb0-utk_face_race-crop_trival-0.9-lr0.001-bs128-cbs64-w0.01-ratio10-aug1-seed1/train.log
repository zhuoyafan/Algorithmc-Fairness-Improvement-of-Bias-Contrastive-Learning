Log level set to: INFO
Set seed: 1
=======> Using Fixed Random Seed: 1 <========
save_path: exp_results/bc-bb0-utk_face_race-crop_trival-0.9-lr0.001-bs128-cbs64-w0.01-ratio10-aug1-seed1
get_utk_face - split: train, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_race-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [4407, 552]
Target 1: [440, 5529]
Binary Target 1
---------------------------
Target 0: [4407, 552]
Target 1: [440, 5529]
===================================
Normal Label Distribution: 
Target 0: [4407, 552]
Target 1: [440, 5529]
===================================
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [4407, 552]
Target 1: [440, 5529]
Binary Target 1
---------------------------
Target 0: [4407, 552]
Target 1: [440, 5529]
===================================
Normal Label Distribution: 
Target 0: [4407, 552]
Target 1: [440, 5529]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 10928, target_attr: gender, bias_attr: race bias_rate: 0.9
['[train] target_0-bias_0: 4407', '[train] target_0-bias_1: 552', '[train] target_1-bias_0: 440', '[train] target_1-bias_1: 5529']
confusion_matrix - 
 original: tensor([[4407.,  440.],
        [ 552., 5529.]]), 
 normalized: tensor([[0.909, 0.091],
        [0.091, 0.909]]), 
 b|y: tensor([[0.889, 0.111],
        [0.074, 0.926]])
get_utk_face - split: train, aug: 1, given_y: True, ratio: 10
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_race-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [4407, 552]
Target 1: [440, 5529]
Binary Target 1
---------------------------
Target 0: [4407, 552]
Target 1: [440, 5529]
===================================
Normal Label Distribution: 
Target 0: [4407, 552]
Target 1: [440, 5529]
===================================
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [4407, 552]
Target 1: [440, 5529]
Binary Target 1
---------------------------
Target 0: [4407, 552]
Target 1: [440, 5529]
===================================
Normal Label Distribution: 
Target 0: [4407, 552]
Target 1: [440, 5529]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 10928, target_attr: gender, bias_attr: race bias_rate: 0.9
['[train] target_0-bias_0: 4407', '[train] target_0-bias_1: 552', '[train] target_1-bias_0: 440', '[train] target_1-bias_1: 5529']
get_utk_face - split: valid, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_race-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [583, 684]
Target 1: [457, 646]
Binary Target 1
---------------------------
Target 0: [583, 684]
Target 1: [457, 646]
===================================
Normal Label Distribution: 
Target 0: [583, 684]
Target 1: [457, 646]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 2370, target_attr: gender, bias_attr: race bias_rate: 0.9
['[valid] target_0-bias_0: 583', '[valid] target_0-bias_1: 684', '[valid] target_1-bias_0: 457', '[valid] target_1-bias_1: 646']
get_utk_face - split: test, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_race-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [558, 677]
Target 1: [462, 673]
Binary Target 1
---------------------------
Target 0: [558, 677]
Target 1: [462, 673]
===================================
Normal Label Distribution: 
Target 0: [558, 677]
Target 1: [462, 673]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 2370, target_attr: gender, bias_attr: race bias_rate: 0.9
['[test] target_0-bias_0: 558', '[test] target_0-bias_1: 677', '[test] target_1-bias_0: 462', '[test] target_1-bias_1: 673']
decay_epochs: [6, 13]
[1 / 20] Learning rate: 0.001 weight: 0.01
[1 / 20] Loss: 4.907549867169225 CE Loss: 0.5930779215881102 Con Loss: 4.901619094357135
[1 / 20] tensor([[0.848, 0.750],
        [0.600, 0.730]]) {'epoch': 1, 'valid/acc': 75.992, 'valid/acc_unbiased': 75.389, 'valid/diff': 6.988, 'valid/acc_skew': 71.895, 'valid/acc_align': 78.883, 'test/acc': 73.797, 'test/acc_unbiased': 73.179, 'test/diff': 11.365, 'test/acc_skew': 67.497, 'test/acc_align': 78.862}
[1 / 20] best valid accuracy: 75.389 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 75.992, 'best_valid_valid/acc_unbiased': 75.389, 'best_valid_valid/diff': 6.988, 'best_valid_valid/acc_skew': 71.895, 'best_valid_valid/acc_align': 78.883, 'best_valid_test/acc': 73.797, 'best_valid_test/acc_unbiased': 73.179, 'best_valid_test/diff': 11.365, 'best_valid_test/acc_skew': 67.497, 'best_valid_test/acc_align': 78.862}
[1 / 20] best test accuracy: 73.179 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 75.992, 'best_test_valid/acc_unbiased': 75.389, 'best_test_valid/diff': 6.988, 'best_test_valid/acc_skew': 71.895, 'best_test_valid/acc_align': 78.883, 'best_test_test/acc': 73.797, 'best_test_test/acc_unbiased': 73.179, 'best_test_test/diff': 11.365, 'best_test_test/acc_skew': 67.497, 'best_test_test/acc_align': 78.862}
[2 / 20] Learning rate: 0.001 weight: 0.01
[2 / 20] Loss: 4.80180010299906 CE Loss: 0.47750535960776913 Con Loss: 4.797025059187569
[2 / 20] tensor([[0.973, 0.970],
        [0.262, 0.311]]) {'epoch': 2, 'valid/acc': 65.949, 'valid/acc_unbiased': 63.362, 'valid/diff': 2.951, 'valid/acc_skew': 61.886, 'valid/acc_align': 64.838, 'test/acc': 64.557, 'test/acc_unbiased': 62.901, 'test/diff': 2.565, 'test/acc_skew': 61.618, 'test/acc_align': 64.183}
[2 / 20] best valid accuracy: 75.389 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 75.992, 'best_valid_valid/acc_unbiased': 75.389, 'best_valid_valid/diff': 6.988, 'best_valid_valid/acc_skew': 71.895, 'best_valid_valid/acc_align': 78.883, 'best_valid_test/acc': 73.797, 'best_valid_test/acc_unbiased': 73.179, 'best_valid_test/diff': 11.365, 'best_valid_test/acc_skew': 67.497, 'best_valid_test/acc_align': 78.862}
[2 / 20] best test accuracy: 73.179 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 75.992, 'best_test_valid/acc_unbiased': 75.389, 'best_test_valid/diff': 6.988, 'best_test_valid/acc_skew': 71.895, 'best_test_valid/acc_align': 78.883, 'best_test_test/acc': 73.797, 'best_test_test/acc_unbiased': 73.179, 'best_test_test/diff': 11.365, 'best_test_test/acc_skew': 67.497, 'best_test_test/acc_align': 78.862}
[3 / 20] Learning rate: 0.001 weight: 0.01
[3 / 20] Loss: 4.779779380446472 CE Loss: 0.45248663072006595 Con Loss: 4.775254513473846
[3 / 20] tensor([[0.841, 0.768],
        [0.807, 0.868]]) {'epoch': 3, 'valid/acc': 83.544, 'valid/acc_unbiased': 83.852, 'valid/diff': 3.463, 'valid/acc_skew': 82.69, 'valid/acc_align': 85.014, 'test/acc': 82.11, 'test/acc_unbiased': 82.093, 'test/diff': 6.64, 'test/acc_skew': 78.773, 'test/acc_align': 85.413}
[3 / 20] best valid accuracy: 83.852 at epoch 3 
 best_stats: {'best_valid_epoch': 3, 'best_valid_valid/acc': 83.544, 'best_valid_valid/acc_unbiased': 83.852, 'best_valid_valid/diff': 3.463, 'best_valid_valid/acc_skew': 82.69, 'best_valid_valid/acc_align': 85.014, 'best_valid_test/acc': 82.11, 'best_valid_test/acc_unbiased': 82.093, 'best_valid_test/diff': 6.64, 'best_valid_test/acc_skew': 78.773, 'best_valid_test/acc_align': 85.413}
[3 / 20] best test accuracy: 82.093 at epoch 3 
 best_stats: {'best_test_epoch': 3, 'best_test_valid/acc': 83.544, 'best_test_valid/acc_unbiased': 83.852, 'best_test_valid/diff': 3.463, 'best_test_valid/acc_skew': 82.69, 'best_test_valid/acc_align': 85.014, 'best_test_test/acc': 82.11, 'best_test_test/acc_unbiased': 82.093, 'best_test_test/diff': 6.64, 'best_test_test/acc_skew': 78.773, 'best_test_test/acc_align': 85.413}
[4 / 20] Learning rate: 0.001 weight: 0.01
[4 / 20] Loss: 4.7678679072490375 CE Loss: 0.42368668103986046 Con Loss: 4.763631035956945
[4 / 20] tensor([[0.772, 0.742],
        [0.868, 0.893]]) {'epoch': 4, 'valid/acc': 81.603, 'valid/acc_unbiased': 82.217, 'valid/diff': 3.745, 'valid/acc_skew': 81.408, 'valid/acc_align': 83.027, 'test/acc': 81.646, 'test/acc_unbiased': 81.872, 'test/diff': 2.797, 'test/acc_skew': 80.474, 'test/acc_align': 83.271}
[4 / 20] best valid accuracy: 83.852 at epoch 3 
 best_stats: {'best_valid_epoch': 3, 'best_valid_valid/acc': 83.544, 'best_valid_valid/acc_unbiased': 83.852, 'best_valid_valid/diff': 3.463, 'best_valid_valid/acc_skew': 82.69, 'best_valid_valid/acc_align': 85.014, 'best_valid_test/acc': 82.11, 'best_valid_test/acc_unbiased': 82.093, 'best_valid_test/diff': 6.64, 'best_valid_test/acc_skew': 78.773, 'best_valid_test/acc_align': 85.413}
[4 / 20] best test accuracy: 82.093 at epoch 3 
 best_stats: {'best_test_epoch': 3, 'best_test_valid/acc': 83.544, 'best_test_valid/acc_unbiased': 83.852, 'best_test_valid/diff': 3.463, 'best_test_valid/acc_skew': 82.69, 'best_test_valid/acc_align': 85.014, 'best_test_test/acc': 82.11, 'best_test_test/acc_unbiased': 82.093, 'best_test_test/diff': 6.64, 'best_test_test/acc_skew': 78.773, 'best_test_test/acc_align': 85.413}
[5 / 20] Learning rate: 0.001 weight: 0.01
[5 / 20] Loss: 4.760084708648056 CE Loss: 0.41008446890299005 Con Loss: 4.75598386231139
[5 / 20] tensor([[0.719, 0.663],
        [0.913, 0.936]]) {'epoch': 5, 'valid/acc': 80.633, 'valid/acc_unbiased': 81.63, 'valid/diff': 3.559, 'valid/acc_skew': 80.379, 'valid/acc_align': 82.881, 'test/acc': 80.253, 'test/acc_unbiased': 80.785, 'test/diff': 3.905, 'test/acc_skew': 78.832, 'test/acc_align': 82.737}
[5 / 20] best valid accuracy: 83.852 at epoch 3 
 best_stats: {'best_valid_epoch': 3, 'best_valid_valid/acc': 83.544, 'best_valid_valid/acc_unbiased': 83.852, 'best_valid_valid/diff': 3.463, 'best_valid_valid/acc_skew': 82.69, 'best_valid_valid/acc_align': 85.014, 'best_valid_test/acc': 82.11, 'best_valid_test/acc_unbiased': 82.093, 'best_valid_test/diff': 6.64, 'best_valid_test/acc_skew': 78.773, 'best_valid_test/acc_align': 85.413}
[5 / 20] best test accuracy: 82.093 at epoch 3 
 best_stats: {'best_test_epoch': 3, 'best_test_valid/acc': 83.544, 'best_test_valid/acc_unbiased': 83.852, 'best_test_valid/diff': 3.463, 'best_test_valid/acc_skew': 82.69, 'best_test_valid/acc_align': 85.014, 'best_test_test/acc': 82.11, 'best_test_test/acc_unbiased': 82.093, 'best_test_test/diff': 6.64, 'best_test_test/acc_skew': 78.773, 'best_test_test/acc_align': 85.413}
[6 / 20] Learning rate: 0.001 weight: 0.01
[6 / 20] Loss: 4.748283497934635 CE Loss: 0.39530722624560927 Con Loss: 4.744330432718704
[6 / 20] tensor([[0.815, 0.764],
        [0.851, 0.903]]) {'epoch': 6, 'valid/acc': 84.177, 'valid/acc_unbiased': 84.541, 'valid/diff': 2.536, 'valid/acc_skew': 83.273, 'valid/acc_align': 85.809, 'test/acc': 83.249, 'test/acc_unbiased': 83.329, 'test/diff': 5.226, 'test/acc_skew': 80.716, 'test/acc_align': 85.941}
[6 / 20] best valid accuracy: 84.541 at epoch 6 
 best_stats: {'best_valid_epoch': 6, 'best_valid_valid/acc': 84.177, 'best_valid_valid/acc_unbiased': 84.541, 'best_valid_valid/diff': 2.536, 'best_valid_valid/acc_skew': 83.273, 'best_valid_valid/acc_align': 85.809, 'best_valid_test/acc': 83.249, 'best_valid_test/acc_unbiased': 83.329, 'best_valid_test/diff': 5.226, 'best_valid_test/acc_skew': 80.716, 'best_valid_test/acc_align': 85.941}
[6 / 20] best test accuracy: 83.329 at epoch 6 
 best_stats: {'best_test_epoch': 6, 'best_test_valid/acc': 84.177, 'best_test_valid/acc_unbiased': 84.541, 'best_test_valid/diff': 2.536, 'best_test_valid/acc_skew': 83.273, 'best_test_valid/acc_align': 85.809, 'best_test_test/acc': 83.249, 'best_test_test/acc_unbiased': 83.329, 'best_test_test/diff': 5.226, 'best_test_test/acc_skew': 80.716, 'best_test_test/acc_align': 85.941}
[7 / 20] Learning rate: 0.0001 weight: 0.01
[7 / 20] Loss: 4.704843269085639 CE Loss: 0.3611684011767235 Con Loss: 4.70123161089717
[7 / 20] tensor([[0.833, 0.781],
        [0.885, 0.911]]) {'epoch': 7, 'valid/acc': 85.907, 'valid/acc_unbiased': 86.395, 'valid/diff': 2.743, 'valid/acc_skew': 86.302, 'valid/acc_align': 86.487, 'test/acc': 85.063, 'test/acc_unbiased': 85.271, 'test/diff': 3.876, 'test/acc_skew': 83.333, 'test/acc_align': 87.209}
[7 / 20] best valid accuracy: 86.395 at epoch 7 
 best_stats: {'best_valid_epoch': 7, 'best_valid_valid/acc': 85.907, 'best_valid_valid/acc_unbiased': 86.395, 'best_valid_valid/diff': 2.743, 'best_valid_valid/acc_skew': 86.302, 'best_valid_valid/acc_align': 86.487, 'best_valid_test/acc': 85.063, 'best_valid_test/acc_unbiased': 85.271, 'best_valid_test/diff': 3.876, 'best_valid_test/acc_skew': 83.333, 'best_valid_test/acc_align': 87.209}
[7 / 20] best test accuracy: 85.271 at epoch 7 
 best_stats: {'best_test_epoch': 7, 'best_test_valid/acc': 85.907, 'best_test_valid/acc_unbiased': 86.395, 'best_test_valid/diff': 2.743, 'best_test_valid/acc_skew': 86.302, 'best_test_valid/acc_align': 86.487, 'best_test_test/acc': 85.063, 'best_test_test/acc_unbiased': 85.271, 'best_test_test/diff': 3.876, 'best_test_test/acc_skew': 83.333, 'best_test_test/acc_align': 87.209}
[8 / 20] Learning rate: 0.0001 weight: 0.01
[8 / 20] Loss: 4.696744267448325 CE Loss: 0.34083493348445587 Con Loss: 4.693335919219614
[8 / 20] tensor([[0.858, 0.798],
        [0.864, 0.900]]) {'epoch': 8, 'valid/acc': 85.781, 'valid/acc_unbiased': 86.119, 'valid/diff': 1.916, 'valid/acc_skew': 85.391, 'valid/acc_align': 86.847, 'test/acc': 85.401, 'test/acc_unbiased': 85.504, 'test/diff': 4.88, 'test/acc_skew': 83.064, 'test/acc_align': 87.943}
[8 / 20] best valid accuracy: 86.395 at epoch 7 
 best_stats: {'best_valid_epoch': 7, 'best_valid_valid/acc': 85.907, 'best_valid_valid/acc_unbiased': 86.395, 'best_valid_valid/diff': 2.743, 'best_valid_valid/acc_skew': 86.302, 'best_valid_valid/acc_align': 86.487, 'best_valid_test/acc': 85.063, 'best_valid_test/acc_unbiased': 85.271, 'best_valid_test/diff': 3.876, 'best_valid_test/acc_skew': 83.333, 'best_valid_test/acc_align': 87.209}
[8 / 20] best test accuracy: 85.504 at epoch 8 
 best_stats: {'best_test_epoch': 8, 'best_test_valid/acc': 85.781, 'best_test_valid/acc_unbiased': 86.119, 'best_test_valid/diff': 1.916, 'best_test_valid/acc_skew': 85.391, 'best_test_valid/acc_align': 86.847, 'best_test_test/acc': 85.401, 'best_test_test/acc_unbiased': 85.504, 'best_test_test/diff': 4.88, 'best_test_test/acc_skew': 83.064, 'best_test_test/acc_align': 87.943}
[9 / 20] Learning rate: 0.0001 weight: 0.01
[9 / 20] Loss: 4.678788627049236 CE Loss: 0.32627226863912745 Con Loss: 4.675525908239764
[9 / 20] tensor([[0.842, 0.805],
        [0.887, 0.906]]) {'epoch': 9, 'valid/acc': 86.076, 'valid/acc_unbiased': 86.537, 'valid/diff': 2.753, 'valid/acc_skew': 86.485, 'valid/acc_align': 86.589, 'test/acc': 85.865, 'test/acc_unbiased': 86.029, 'test/diff': 2.811, 'test/acc_skew': 84.623, 'test/acc_align': 87.434}
[9 / 20] best valid accuracy: 86.537 at epoch 9 
 best_stats: {'best_valid_epoch': 9, 'best_valid_valid/acc': 86.076, 'best_valid_valid/acc_unbiased': 86.537, 'best_valid_valid/diff': 2.753, 'best_valid_valid/acc_skew': 86.485, 'best_valid_valid/acc_align': 86.589, 'best_valid_test/acc': 85.865, 'best_valid_test/acc_unbiased': 86.029, 'best_valid_test/diff': 2.811, 'best_valid_test/acc_skew': 84.623, 'best_valid_test/acc_align': 87.434}
[9 / 20] best test accuracy: 86.029 at epoch 9 
 best_stats: {'best_test_epoch': 9, 'best_test_valid/acc': 86.076, 'best_test_valid/acc_unbiased': 86.537, 'best_test_valid/diff': 2.753, 'best_test_valid/acc_skew': 86.485, 'best_test_valid/acc_align': 86.589, 'best_test_test/acc': 85.865, 'best_test_test/acc_unbiased': 86.029, 'best_test_test/diff': 2.811, 'best_test_test/acc_skew': 84.623, 'best_test_test/acc_align': 87.434}
[10 / 20] Learning rate: 0.0001 weight: 0.01
[10 / 20] Loss: 4.677006201374059 CE Loss: 0.3254842736361491 Con Loss: 4.6737513577082845
[10 / 20] tensor([[0.821, 0.759],
        [0.903, 0.930]]) {'epoch': 10, 'valid/acc': 85.274, 'valid/acc_unbiased': 85.902, 'valid/diff': 3.107, 'valid/acc_skew': 85.168, 'valid/acc_align': 86.635, 'test/acc': 85.021, 'test/acc_unbiased': 85.32, 'test/diff': 4.456, 'test/acc_skew': 83.091, 'test/acc_align': 87.548}
[10 / 20] best valid accuracy: 86.537 at epoch 9 
 best_stats: {'best_valid_epoch': 9, 'best_valid_valid/acc': 86.076, 'best_valid_valid/acc_unbiased': 86.537, 'best_valid_valid/diff': 2.753, 'best_valid_valid/acc_skew': 86.485, 'best_valid_valid/acc_align': 86.589, 'best_valid_test/acc': 85.865, 'best_valid_test/acc_unbiased': 86.029, 'best_valid_test/diff': 2.811, 'best_valid_test/acc_skew': 84.623, 'best_valid_test/acc_align': 87.434}
[10 / 20] best test accuracy: 86.029 at epoch 9 
 best_stats: {'best_test_epoch': 9, 'best_test_valid/acc': 86.076, 'best_test_valid/acc_unbiased': 86.537, 'best_test_valid/diff': 2.753, 'best_test_valid/acc_skew': 86.485, 'best_test_valid/acc_align': 86.589, 'best_test_test/acc': 85.865, 'best_test_test/acc_unbiased': 86.029, 'best_test_test/diff': 2.811, 'best_test_test/acc_skew': 84.623, 'best_test_test/acc_align': 87.434}
[11 / 20] Learning rate: 0.0001 weight: 0.01
[11 / 20] Loss: 4.655580817344074 CE Loss: 0.3142671487778207 Con Loss: 4.652438140020189
[11 / 20] tensor([[0.841, 0.798],
        [0.892, 0.923]]) {'epoch': 11, 'valid/acc': 85.907, 'valid/acc_unbiased': 86.319, 'valid/diff': 2.005, 'valid/acc_skew': 85.317, 'valid/acc_align': 87.322, 'test/acc': 86.16, 'test/acc_unbiased': 86.316, 'test/diff': 3.691, 'test/acc_skew': 84.471, 'test/acc_align': 88.162}
[11 / 20] best valid accuracy: 86.537 at epoch 9 
 best_stats: {'best_valid_epoch': 9, 'best_valid_valid/acc': 86.076, 'best_valid_valid/acc_unbiased': 86.537, 'best_valid_valid/diff': 2.753, 'best_valid_valid/acc_skew': 86.485, 'best_valid_valid/acc_align': 86.589, 'best_valid_test/acc': 85.865, 'best_valid_test/acc_unbiased': 86.029, 'best_valid_test/diff': 2.811, 'best_valid_test/acc_skew': 84.623, 'best_valid_test/acc_align': 87.434}
[11 / 20] best test accuracy: 86.316 at epoch 11 
 best_stats: {'best_test_epoch': 11, 'best_test_valid/acc': 85.907, 'best_test_valid/acc_unbiased': 86.319, 'best_test_valid/diff': 2.005, 'best_test_valid/acc_skew': 85.317, 'best_test_valid/acc_align': 87.322, 'best_test_test/acc': 86.16, 'best_test_test/acc_unbiased': 86.316, 'best_test_test/diff': 3.691, 'best_test_test/acc_skew': 84.471, 'best_test_test/acc_align': 88.162}
[12 / 20] Learning rate: 0.0001 weight: 0.01
[12 / 20] Loss: 4.659666126329413 CE Loss: 0.3180708087991656 Con Loss: 4.656485401868471
[12 / 20] tensor([[0.849, 0.792],
        [0.887, 0.927]]) {'epoch': 12, 'valid/acc': 85.823, 'valid/acc_unbiased': 86.23, 'valid/diff': 2.338, 'valid/acc_skew': 85.061, 'valid/acc_align': 87.399, 'test/acc': 86.245, 'test/acc_unbiased': 86.396, 'test/diff': 4.874, 'test/acc_skew': 83.959, 'test/acc_align': 88.833}
[12 / 20] best valid accuracy: 86.537 at epoch 9 
 best_stats: {'best_valid_epoch': 9, 'best_valid_valid/acc': 86.076, 'best_valid_valid/acc_unbiased': 86.537, 'best_valid_valid/diff': 2.753, 'best_valid_valid/acc_skew': 86.485, 'best_valid_valid/acc_align': 86.589, 'best_valid_test/acc': 85.865, 'best_valid_test/acc_unbiased': 86.029, 'best_valid_test/diff': 2.811, 'best_valid_test/acc_skew': 84.623, 'best_valid_test/acc_align': 87.434}
[12 / 20] best test accuracy: 86.396 at epoch 12 
 best_stats: {'best_test_epoch': 12, 'best_test_valid/acc': 85.823, 'best_test_valid/acc_unbiased': 86.23, 'best_test_valid/diff': 2.338, 'best_test_valid/acc_skew': 85.061, 'best_test_valid/acc_align': 87.399, 'best_test_test/acc': 86.245, 'best_test_test/acc_unbiased': 86.396, 'best_test_test/diff': 4.874, 'best_test_test/acc_skew': 83.959, 'best_test_test/acc_align': 88.833}
[13 / 20] Learning rate: 0.0001 weight: 0.01
[13 / 20] Loss: 4.648757322990004 CE Loss: 0.30722775610264713 Con Loss: 4.645685029762904
[13 / 20] tensor([[0.853, 0.792],
        [0.881, 0.936]]) {'epoch': 13, 'valid/acc': 85.823, 'valid/acc_unbiased': 86.185, 'valid/diff': 3.269, 'valid/acc_skew': 84.55, 'valid/acc_align': 87.819, 'test/acc': 86.456, 'test/acc_unbiased': 86.546, 'test/diff': 5.824, 'test/acc_skew': 83.634, 'test/acc_align': 89.458}
[13 / 20] best valid accuracy: 86.537 at epoch 9 
 best_stats: {'best_valid_epoch': 9, 'best_valid_valid/acc': 86.076, 'best_valid_valid/acc_unbiased': 86.537, 'best_valid_valid/diff': 2.753, 'best_valid_valid/acc_skew': 86.485, 'best_valid_valid/acc_align': 86.589, 'best_valid_test/acc': 85.865, 'best_valid_test/acc_unbiased': 86.029, 'best_valid_test/diff': 2.811, 'best_valid_test/acc_skew': 84.623, 'best_valid_test/acc_align': 87.434}
[13 / 20] best test accuracy: 86.546 at epoch 13 
 best_stats: {'best_test_epoch': 13, 'best_test_valid/acc': 85.823, 'best_test_valid/acc_unbiased': 86.185, 'best_test_valid/diff': 3.269, 'best_test_valid/acc_skew': 84.55, 'best_test_valid/acc_align': 87.819, 'best_test_test/acc': 86.456, 'best_test_test/acc_unbiased': 86.546, 'best_test_test/diff': 5.824, 'best_test_test/acc_skew': 83.634, 'best_test_test/acc_align': 89.458}
[14 / 20] Learning rate: 1e-05 weight: 0.01
[14 / 20] Loss: 4.638519922426819 CE Loss: 0.29319654350573987 Con Loss: 4.635587971521157
[14 / 20] tensor([[0.873, 0.809],
        [0.883, 0.927]]) {'epoch': 14, 'valid/acc': 85.949, 'valid/acc_unbiased': 86.289, 'valid/diff': 2.526, 'valid/acc_skew': 85.026, 'valid/acc_align': 87.552, 'test/acc': 87.215, 'test/acc_unbiased': 87.313, 'test/diff': 5.369, 'test/acc_skew': 84.629, 'test/acc_align': 89.998}
[14 / 20] best valid accuracy: 86.537 at epoch 9 
 best_stats: {'best_valid_epoch': 9, 'best_valid_valid/acc': 86.076, 'best_valid_valid/acc_unbiased': 86.537, 'best_valid_valid/diff': 2.753, 'best_valid_valid/acc_skew': 86.485, 'best_valid_valid/acc_align': 86.589, 'best_valid_test/acc': 85.865, 'best_valid_test/acc_unbiased': 86.029, 'best_valid_test/diff': 2.811, 'best_valid_test/acc_skew': 84.623, 'best_valid_test/acc_align': 87.434}
[14 / 20] best test accuracy: 87.313 at epoch 14 
 best_stats: {'best_test_epoch': 14, 'best_test_valid/acc': 85.949, 'best_test_valid/acc_unbiased': 86.289, 'best_test_valid/diff': 2.526, 'best_test_valid/acc_skew': 85.026, 'best_test_valid/acc_align': 87.552, 'best_test_test/acc': 87.215, 'best_test_test/acc_unbiased': 87.313, 'best_test_test/diff': 5.369, 'best_test_test/acc_skew': 84.629, 'best_test_test/acc_align': 89.998}
[15 / 20] Learning rate: 1e-05 weight: 0.01
[15 / 20] Loss: 4.641098345704868 CE Loss: 0.29794728601048664 Con Loss: 4.638118879337785
[15 / 20] tensor([[0.867, 0.809],
        [0.885, 0.929]]) {'epoch': 15, 'valid/acc': 86.245, 'valid/acc_unbiased': 86.596, 'valid/diff': 2.41, 'valid/acc_skew': 85.391, 'valid/acc_align': 87.801, 'test/acc': 87.173, 'test/acc_unbiased': 87.27, 'test/diff': 5.066, 'test/acc_skew': 84.737, 'test/acc_align': 89.803}
[15 / 20] best valid accuracy: 86.596 at epoch 15 
 best_stats: {'best_valid_epoch': 15, 'best_valid_valid/acc': 86.245, 'best_valid_valid/acc_unbiased': 86.596, 'best_valid_valid/diff': 2.41, 'best_valid_valid/acc_skew': 85.391, 'best_valid_valid/acc_align': 87.801, 'best_valid_test/acc': 87.173, 'best_valid_test/acc_unbiased': 87.27, 'best_valid_test/diff': 5.066, 'best_valid_test/acc_skew': 84.737, 'best_valid_test/acc_align': 89.803}
[15 / 20] best test accuracy: 87.313 at epoch 14 
 best_stats: {'best_test_epoch': 14, 'best_test_valid/acc': 85.949, 'best_test_valid/acc_unbiased': 86.289, 'best_test_valid/diff': 2.526, 'best_test_valid/acc_skew': 85.026, 'best_test_valid/acc_align': 87.552, 'best_test_test/acc': 87.215, 'best_test_test/acc_unbiased': 87.313, 'best_test_test/diff': 5.369, 'best_test_test/acc_skew': 84.629, 'best_test_test/acc_align': 89.998}
[16 / 20] Learning rate: 1e-05 weight: 0.01
[16 / 20] Loss: 4.632357438870788 CE Loss: 0.2935972685869756 Con Loss: 4.629421467313306
[16 / 20] tensor([[0.855, 0.798],
        [0.890, 0.932]]) {'epoch': 16, 'valid/acc': 85.907, 'valid/acc_unbiased': 86.359, 'valid/diff': 2.156, 'valid/acc_skew': 85.535, 'valid/acc_align': 87.183, 'test/acc': 86.709, 'test/acc_unbiased': 86.843, 'test/diff': 4.962, 'test/acc_skew': 84.362, 'test/acc_align': 89.324}
[16 / 20] best valid accuracy: 86.596 at epoch 15 
 best_stats: {'best_valid_epoch': 15, 'best_valid_valid/acc': 86.245, 'best_valid_valid/acc_unbiased': 86.596, 'best_valid_valid/diff': 2.41, 'best_valid_valid/acc_skew': 85.391, 'best_valid_valid/acc_align': 87.801, 'best_valid_test/acc': 87.173, 'best_valid_test/acc_unbiased': 87.27, 'best_valid_test/diff': 5.066, 'best_valid_test/acc_skew': 84.737, 'best_valid_test/acc_align': 89.803}
[16 / 20] best test accuracy: 87.313 at epoch 14 
 best_stats: {'best_test_epoch': 14, 'best_test_valid/acc': 85.949, 'best_test_valid/acc_unbiased': 86.289, 'best_test_valid/diff': 2.526, 'best_test_valid/acc_skew': 85.026, 'best_test_valid/acc_align': 87.552, 'best_test_test/acc': 87.215, 'best_test_test/acc_unbiased': 87.313, 'best_test_test/diff': 5.369, 'best_test_test/acc_skew': 84.629, 'best_test_test/acc_align': 89.998}
[17 / 20] Learning rate: 1e-05 weight: 0.01
[17 / 20] Loss: 4.6212767186311465 CE Loss: 0.29636571509422704 Con Loss: 4.618313070272108
[17 / 20] tensor([[0.862, 0.801],
        [0.890, 0.933]]) {'epoch': 17, 'valid/acc': 86.118, 'valid/acc_unbiased': 86.537, 'valid/diff': 1.929, 'valid/acc_skew': 85.572, 'valid/acc_align': 87.501, 'test/acc': 87.004, 'test/acc_unbiased': 87.134, 'test/diff': 5.247, 'test/acc_skew': 84.51, 'test/acc_align': 89.757}
[17 / 20] best valid accuracy: 86.596 at epoch 15 
 best_stats: {'best_valid_epoch': 15, 'best_valid_valid/acc': 86.245, 'best_valid_valid/acc_unbiased': 86.596, 'best_valid_valid/diff': 2.41, 'best_valid_valid/acc_skew': 85.391, 'best_valid_valid/acc_align': 87.801, 'best_valid_test/acc': 87.173, 'best_valid_test/acc_unbiased': 87.27, 'best_valid_test/diff': 5.066, 'best_valid_test/acc_skew': 84.737, 'best_valid_test/acc_align': 89.803}
[17 / 20] best test accuracy: 87.313 at epoch 14 
 best_stats: {'best_test_epoch': 14, 'best_test_valid/acc': 85.949, 'best_test_valid/acc_unbiased': 86.289, 'best_test_valid/diff': 2.526, 'best_test_valid/acc_skew': 85.026, 'best_test_valid/acc_align': 87.552, 'best_test_test/acc': 87.215, 'best_test_test/acc_unbiased': 87.313, 'best_test_test/diff': 5.369, 'best_test_test/acc_skew': 84.629, 'best_test_test/acc_align': 89.998}
[18 / 20] Learning rate: 1e-05 weight: 0.01
[18 / 20] Loss: 4.6327996023577445 CE Loss: 0.2938122696312769 Con Loss: 4.629861497948843
[18 / 20] tensor([[0.866, 0.808],
        [0.887, 0.927]]) {'epoch': 18, 'valid/acc': 86.414, 'valid/acc_unbiased': 86.791, 'valid/diff': 1.713, 'valid/acc_skew': 86.048, 'valid/acc_align': 87.535, 'test/acc': 87.089, 'test/acc_unbiased': 87.205, 'test/diff': 4.868, 'test/acc_skew': 84.771, 'test/acc_align': 89.639}
[18 / 20] best valid accuracy: 86.791 at epoch 18 
 best_stats: {'best_valid_epoch': 18, 'best_valid_valid/acc': 86.414, 'best_valid_valid/acc_unbiased': 86.791, 'best_valid_valid/diff': 1.713, 'best_valid_valid/acc_skew': 86.048, 'best_valid_valid/acc_align': 87.535, 'best_valid_test/acc': 87.089, 'best_valid_test/acc_unbiased': 87.205, 'best_valid_test/diff': 4.868, 'best_valid_test/acc_skew': 84.771, 'best_valid_test/acc_align': 89.639}
[18 / 20] best test accuracy: 87.313 at epoch 14 
 best_stats: {'best_test_epoch': 14, 'best_test_valid/acc': 85.949, 'best_test_valid/acc_unbiased': 86.289, 'best_test_valid/diff': 2.526, 'best_test_valid/acc_skew': 85.026, 'best_test_valid/acc_align': 87.552, 'best_test_test/acc': 87.215, 'best_test_test/acc_unbiased': 87.313, 'best_test_test/diff': 5.369, 'best_test_test/acc_skew': 84.629, 'best_test_test/acc_align': 89.998}
[19 / 20] Learning rate: 1e-05 weight: 0.01
[19 / 20] Loss: 4.63810395496307 CE Loss: 0.2951075398468168 Con Loss: 4.63515287053009
[19 / 20] tensor([[0.869, 0.811],
        [0.887, 0.929]]) {'epoch': 19, 'valid/acc': 85.992, 'valid/acc_unbiased': 86.399, 'valid/diff': 2.279, 'valid/acc_skew': 85.573, 'valid/acc_align': 87.225, 'test/acc': 87.3, 'test/acc_unbiased': 87.406, 'test/diff': 4.974, 'test/acc_skew': 84.919, 'test/acc_align': 89.893}
[19 / 20] best valid accuracy: 86.791 at epoch 18 
 best_stats: {'best_valid_epoch': 18, 'best_valid_valid/acc': 86.414, 'best_valid_valid/acc_unbiased': 86.791, 'best_valid_valid/diff': 1.713, 'best_valid_valid/acc_skew': 86.048, 'best_valid_valid/acc_align': 87.535, 'best_valid_test/acc': 87.089, 'best_valid_test/acc_unbiased': 87.205, 'best_valid_test/diff': 4.868, 'best_valid_test/acc_skew': 84.771, 'best_valid_test/acc_align': 89.639}
[19 / 20] best test accuracy: 87.406 at epoch 19 
 best_stats: {'best_test_epoch': 19, 'best_test_valid/acc': 85.992, 'best_test_valid/acc_unbiased': 86.399, 'best_test_valid/diff': 2.279, 'best_test_valid/acc_skew': 85.573, 'best_test_valid/acc_align': 87.225, 'best_test_test/acc': 87.3, 'best_test_test/acc_unbiased': 87.406, 'best_test_test/diff': 4.974, 'best_test_test/acc_skew': 84.919, 'best_test_test/acc_align': 89.893}
[20 / 20] Learning rate: 1e-05 weight: 0.01
[20 / 20] Loss: 4.637966566518669 CE Loss: 0.28965855033121907 Con Loss: 4.635069970679667
[20 / 20] tensor([[0.866, 0.804],
        [0.887, 0.926]]) {'epoch': 20, 'valid/acc': 86.203, 'valid/acc_unbiased': 86.645, 'valid/diff': 2.443, 'valid/acc_skew': 85.755, 'valid/acc_align': 87.535, 'test/acc': 86.92, 'test/acc_unbiased': 87.057, 'test/diff': 5.015, 'test/acc_skew': 84.55, 'test/acc_align': 89.565}
[20 / 20] best valid accuracy: 86.791 at epoch 18 
 best_stats: {'best_valid_epoch': 18, 'best_valid_valid/acc': 86.414, 'best_valid_valid/acc_unbiased': 86.791, 'best_valid_valid/diff': 1.713, 'best_valid_valid/acc_skew': 86.048, 'best_valid_valid/acc_align': 87.535, 'best_valid_test/acc': 87.089, 'best_valid_test/acc_unbiased': 87.205, 'best_valid_test/diff': 4.868, 'best_valid_test/acc_skew': 84.771, 'best_valid_test/acc_align': 89.639}
[20 / 20] best test accuracy: 87.406 at epoch 19 
 best_stats: {'best_test_epoch': 19, 'best_test_valid/acc': 85.992, 'best_test_valid/acc_unbiased': 86.399, 'best_test_valid/diff': 2.279, 'best_test_valid/acc_skew': 85.573, 'best_test_valid/acc_align': 87.225, 'best_test_test/acc': 87.3, 'best_test_test/acc_unbiased': 87.406, 'best_test_test/diff': 4.974, 'best_test_test/acc_skew': 84.919, 'best_test_test/acc_align': 89.893}
Total training time: 0:14:20
