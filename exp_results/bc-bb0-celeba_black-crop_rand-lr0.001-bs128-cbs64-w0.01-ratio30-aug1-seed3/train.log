Log level set to: INFO
Set seed: 3
=======> Using Fixed Random Seed: 3 <========
save_path: exp_results/bc-bb0-celeba_black-crop_rand-lr0.001-bs128-cbs64-w0.01-ratio30-aug1-seed3
get_celeba - split:train, aug: False, given_y: True, ratio: 0
use existing black indices from data/celeba/pickles/black
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [60544, 38546]
Target 1: [8005, 16093]
Binary Target 1
---------------------------
Target 0: [60544, 38546]
Target 1: [8005, 16093]
===================================
Normal Label Distribution: 
Target 0: [60544, 38546]
Target 1: [8005, 16093]
===================================
Use BiasedCelebASplit 
 target_attr: black split: train 
 tensor([[60544.,  8005.],
        [38546., 16093.]])
get_celeba - split:train, aug: 1, given_y: True, ratio: 30
use existing black indices from data/celeba/pickles/black
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [60623, 38503]
Target 1: [7983, 16079]
Binary Target 1
---------------------------
Target 0: [60623, 38503]
Target 1: [7983, 16079]
===================================
Normal Label Distribution: 
Target 0: [60623, 38503]
Target 1: [7983, 16079]
===================================
Use BiasedCelebASplit 
 target_attr: black split: train 
 tensor([[60623.,  7983.],
        [38503., 16079.]])
get_celeba - split:train_valid, aug: False, given_y: True, ratio: 0
use existing black indices from data/celeba/pickles/black
Use BiasedCelebASplit 
 target_attr: black split: train_valid 
 tensor([[15141.,  1962.],
        [ 9689.,  4006.]])
get_celeba - split:valid, aug: False, given_y: True, ratio: 0
Use BiasedCelebASplit 
 target_attr: black split: valid 
 tensor([[9752., 1657.],
        [5971., 2487.]])
decay_epochs: [3, 6]
[1 / 10] Learning rate: 0.001 weight: 0.01
[1 / 10] Loss: 4.811405845217478 CE Loss: 0.3136394540599814 Con Loss: 4.8082694536633905
[1 / 10] tensor([[0.990, 0.964],
        [0.186, 0.196]]) {'epoch': 1, 'valid/acc': 82.82, 'valid/acc_unbiased': 58.438, 'valid/diff': 2.564, 'valid/acc_skew': 57.156, 'valid/acc_align': 59.72, 'test/acc': 81.583, 'test/acc_unbiased': 58.409, 'test/diff': 1.798, 'test/acc_skew': 57.51, 'test/acc_align': 59.309}
[1 / 10] best valid accuracy: 58.438 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 82.82, 'best_valid_valid/acc_unbiased': 58.438, 'best_valid_valid/diff': 2.564, 'best_valid_valid/acc_skew': 57.156, 'best_valid_valid/acc_align': 59.72, 'best_valid_test/acc': 81.583, 'best_valid_test/acc_unbiased': 58.409, 'best_valid_test/diff': 1.798, 'best_valid_test/acc_skew': 57.51, 'best_valid_test/acc_align': 59.309}
[1 / 10] best test accuracy: 58.409 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 82.82, 'best_test_valid/acc_unbiased': 58.438, 'best_test_valid/diff': 2.564, 'best_test_valid/acc_skew': 57.156, 'best_test_valid/acc_align': 59.72, 'best_test_test/acc': 81.583, 'best_test_test/acc_unbiased': 58.409, 'best_test_test/diff': 1.798, 'best_test_test/acc_skew': 57.51, 'best_test_test/acc_align': 59.309}
[2 / 10] Learning rate: 0.001 weight: 0.01
[2 / 10] Loss: 4.796390345914335 CE Loss: 0.2856501389817301 Con Loss: 4.793533844719747
[2 / 10] tensor([[0.911, 0.877],
        [0.841, 0.770]]) {'epoch': 2, 'valid/acc': 87.438, 'valid/acc_unbiased': 84.365, 'valid/diff': 5.396, 'valid/acc_skew': 85.691, 'valid/acc_align': 83.04, 'test/acc': 87.728, 'test/acc_unbiased': 84.958, 'test/diff': 5.282, 'test/acc_skew': 85.871, 'test/acc_align': 84.045}
[2 / 10] best valid accuracy: 84.365 at epoch 2 
 best_stats: {'best_valid_epoch': 2, 'best_valid_valid/acc': 87.438, 'best_valid_valid/acc_unbiased': 84.365, 'best_valid_valid/diff': 5.396, 'best_valid_valid/acc_skew': 85.691, 'best_valid_valid/acc_align': 83.04, 'best_valid_test/acc': 87.728, 'best_valid_test/acc_unbiased': 84.958, 'best_valid_test/diff': 5.282, 'best_valid_test/acc_skew': 85.871, 'best_valid_test/acc_align': 84.045}
[2 / 10] best test accuracy: 84.958 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 87.438, 'best_test_valid/acc_unbiased': 84.365, 'best_test_valid/diff': 5.396, 'best_test_valid/acc_skew': 85.691, 'best_test_valid/acc_align': 83.04, 'best_test_test/acc': 87.728, 'best_test_test/acc_unbiased': 84.958, 'best_test_test/diff': 5.282, 'best_test_test/acc_skew': 85.871, 'best_test_test/acc_align': 84.045}
[3 / 10] Learning rate: 0.001 weight: 0.01
[3 / 10] Loss: 4.791489851437215 CE Loss: 0.2768466117459698 Con Loss: 4.788721386610689
[3 / 10] tensor([[0.980, 0.957],
        [0.517, 0.577]]) {'epoch': 3, 'valid/acc': 88.314, 'valid/acc_unbiased': 74.852, 'valid/diff': 3.322, 'valid/acc_skew': 73.191, 'valid/acc_align': 76.513, 'test/acc': 88.393, 'test/acc_unbiased': 75.778, 'test/diff': 4.174, 'test/acc_skew': 73.691, 'test/acc_align': 77.865}
[3 / 10] best valid accuracy: 84.365 at epoch 2 
 best_stats: {'best_valid_epoch': 2, 'best_valid_valid/acc': 87.438, 'best_valid_valid/acc_unbiased': 84.365, 'best_valid_valid/diff': 5.396, 'best_valid_valid/acc_skew': 85.691, 'best_valid_valid/acc_align': 83.04, 'best_valid_test/acc': 87.728, 'best_valid_test/acc_unbiased': 84.958, 'best_valid_test/diff': 5.282, 'best_valid_test/acc_skew': 85.871, 'best_valid_test/acc_align': 84.045}
[3 / 10] best test accuracy: 84.958 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 87.438, 'best_test_valid/acc_unbiased': 84.365, 'best_test_valid/diff': 5.396, 'best_test_valid/acc_skew': 85.691, 'best_test_valid/acc_align': 83.04, 'best_test_test/acc': 87.728, 'best_test_test/acc_unbiased': 84.958, 'best_test_test/diff': 5.282, 'best_test_test/acc_skew': 85.871, 'best_test_test/acc_align': 84.045}
[4 / 10] Learning rate: 0.0001 weight: 0.01
[4 / 10] Loss: 4.764588397311852 CE Loss: 0.24313440541131515 Con Loss: 4.762157045146314
[4 / 10] tensor([[0.967, 0.944],
        [0.669, 0.697]]) {'epoch': 4, 'valid/acc': 89.697, 'valid/acc_unbiased': 80.533, 'valid/diff': 2.05, 'valid/acc_skew': 79.509, 'valid/acc_align': 81.558, 'test/acc': 90.155, 'test/acc_unbiased': 81.924, 'test/diff': 2.624, 'test/acc_skew': 80.612, 'test/acc_align': 83.236}
[4 / 10] best valid accuracy: 84.365 at epoch 2 
 best_stats: {'best_valid_epoch': 2, 'best_valid_valid/acc': 87.438, 'best_valid_valid/acc_unbiased': 84.365, 'best_valid_valid/diff': 5.396, 'best_valid_valid/acc_skew': 85.691, 'best_valid_valid/acc_align': 83.04, 'best_valid_test/acc': 87.728, 'best_valid_test/acc_unbiased': 84.958, 'best_valid_test/diff': 5.282, 'best_valid_test/acc_skew': 85.871, 'best_valid_test/acc_align': 84.045}
[4 / 10] best test accuracy: 84.958 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 87.438, 'best_test_valid/acc_unbiased': 84.365, 'best_test_valid/diff': 5.396, 'best_test_valid/acc_skew': 85.691, 'best_test_valid/acc_align': 83.04, 'best_test_test/acc': 87.728, 'best_test_test/acc_unbiased': 84.958, 'best_test_test/diff': 5.282, 'best_test_test/acc_skew': 85.871, 'best_test_test/acc_align': 84.045}
[5 / 10] Learning rate: 0.0001 weight: 0.01
[5 / 10] Loss: 4.7545506050823825 CE Loss: 0.23528246798077765 Con Loss: 4.752197784932669
[5 / 10] tensor([[0.974, 0.957],
        [0.655, 0.661]]) {'epoch': 5, 'valid/acc': 89.905, 'valid/acc_unbiased': 79.783, 'valid/diff': 0.92, 'valid/acc_skew': 79.323, 'valid/acc_align': 80.242, 'test/acc': 90.306, 'test/acc_unbiased': 81.181, 'test/diff': 1.126, 'test/acc_skew': 80.618, 'test/acc_align': 81.744}
[5 / 10] best valid accuracy: 84.365 at epoch 2 
 best_stats: {'best_valid_epoch': 2, 'best_valid_valid/acc': 87.438, 'best_valid_valid/acc_unbiased': 84.365, 'best_valid_valid/diff': 5.396, 'best_valid_valid/acc_skew': 85.691, 'best_valid_valid/acc_align': 83.04, 'best_valid_test/acc': 87.728, 'best_valid_test/acc_unbiased': 84.958, 'best_valid_test/diff': 5.282, 'best_valid_test/acc_skew': 85.871, 'best_valid_test/acc_align': 84.045}
[5 / 10] best test accuracy: 84.958 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 87.438, 'best_test_valid/acc_unbiased': 84.365, 'best_test_valid/diff': 5.396, 'best_test_valid/acc_skew': 85.691, 'best_test_valid/acc_align': 83.04, 'best_test_test/acc': 87.728, 'best_test_test/acc_unbiased': 84.958, 'best_test_test/diff': 5.282, 'best_test_test/acc_skew': 85.871, 'best_test_test/acc_align': 84.045}
[6 / 10] Learning rate: 0.0001 weight: 0.01
[6 / 10] Loss: 4.753917902635476 CE Loss: 0.22994470230763997 Con Loss: 4.751618460935056
[6 / 10] tensor([[0.964, 0.926],
        [0.680, 0.732]]) {'epoch': 6, 'valid/acc': 89.886, 'valid/acc_unbiased': 81.751, 'valid/diff': 2.488, 'valid/acc_skew': 80.507, 'valid/acc_align': 82.994, 'test/acc': 89.993, 'test/acc_unbiased': 82.559, 'test/diff': 4.523, 'test/acc_skew': 80.298, 'test/acc_align': 84.821}
[6 / 10] best valid accuracy: 84.365 at epoch 2 
 best_stats: {'best_valid_epoch': 2, 'best_valid_valid/acc': 87.438, 'best_valid_valid/acc_unbiased': 84.365, 'best_valid_valid/diff': 5.396, 'best_valid_valid/acc_skew': 85.691, 'best_valid_valid/acc_align': 83.04, 'best_valid_test/acc': 87.728, 'best_valid_test/acc_unbiased': 84.958, 'best_valid_test/diff': 5.282, 'best_valid_test/acc_skew': 85.871, 'best_valid_test/acc_align': 84.045}
[6 / 10] best test accuracy: 84.958 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 87.438, 'best_test_valid/acc_unbiased': 84.365, 'best_test_valid/diff': 5.396, 'best_test_valid/acc_skew': 85.691, 'best_test_valid/acc_align': 83.04, 'best_test_test/acc': 87.728, 'best_test_test/acc_unbiased': 84.958, 'best_test_test/diff': 5.282, 'best_test_test/acc_skew': 85.871, 'best_test_test/acc_align': 84.045}
[7 / 10] Learning rate: 1e-05 weight: 0.01
[7 / 10] Loss: 4.752037816571466 CE Loss: 0.2280322458096308 Con Loss: 4.749757495271574
[7 / 10] tensor([[0.957, 0.927],
        [0.737, 0.755]]) {'epoch': 7, 'valid/acc': 90.347, 'valid/acc_unbiased': 83.733, 'valid/diff': 1.406, 'valid/acc_skew': 83.03, 'valid/acc_align': 84.436, 'test/acc': 90.426, 'test/acc_unbiased': 84.395, 'test/diff': 2.405, 'test/acc_skew': 83.193, 'test/acc_align': 85.598}
[7 / 10] best valid accuracy: 84.365 at epoch 2 
 best_stats: {'best_valid_epoch': 2, 'best_valid_valid/acc': 87.438, 'best_valid_valid/acc_unbiased': 84.365, 'best_valid_valid/diff': 5.396, 'best_valid_valid/acc_skew': 85.691, 'best_valid_valid/acc_align': 83.04, 'best_valid_test/acc': 87.728, 'best_valid_test/acc_unbiased': 84.958, 'best_valid_test/diff': 5.282, 'best_valid_test/acc_skew': 85.871, 'best_valid_test/acc_align': 84.045}
[7 / 10] best test accuracy: 84.958 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 87.438, 'best_test_valid/acc_unbiased': 84.365, 'best_test_valid/diff': 5.396, 'best_test_valid/acc_skew': 85.691, 'best_test_valid/acc_align': 83.04, 'best_test_test/acc': 87.728, 'best_test_test/acc_unbiased': 84.958, 'best_test_test/diff': 5.282, 'best_test_test/acc_skew': 85.871, 'best_test_test/acc_align': 84.045}
[8 / 10] Learning rate: 1e-05 weight: 0.01
[8 / 10] Loss: 4.746271576212378 CE Loss: 0.22566389730291195 Con Loss: 4.744014932849398
[8 / 10] tensor([[0.965, 0.946],
        [0.696, 0.713]]) {'epoch': 8, 'valid/acc': 90.389, 'valid/acc_unbiased': 82.279, 'valid/diff': 1.225, 'valid/acc_skew': 81.667, 'valid/acc_align': 82.892, 'test/acc': 90.512, 'test/acc_unbiased': 82.984, 'test/diff': 1.795, 'test/acc_skew': 82.087, 'test/acc_align': 83.882}
[8 / 10] best valid accuracy: 84.365 at epoch 2 
 best_stats: {'best_valid_epoch': 2, 'best_valid_valid/acc': 87.438, 'best_valid_valid/acc_unbiased': 84.365, 'best_valid_valid/diff': 5.396, 'best_valid_valid/acc_skew': 85.691, 'best_valid_valid/acc_align': 83.04, 'best_valid_test/acc': 87.728, 'best_valid_test/acc_unbiased': 84.958, 'best_valid_test/diff': 5.282, 'best_valid_test/acc_skew': 85.871, 'best_valid_test/acc_align': 84.045}
[8 / 10] best test accuracy: 84.958 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 87.438, 'best_test_valid/acc_unbiased': 84.365, 'best_test_valid/diff': 5.396, 'best_test_valid/acc_skew': 85.691, 'best_test_valid/acc_align': 83.04, 'best_test_test/acc': 87.728, 'best_test_test/acc_unbiased': 84.958, 'best_test_test/diff': 5.282, 'best_test_test/acc_skew': 85.871, 'best_test_test/acc_align': 84.045}
[9 / 10] Learning rate: 1e-05 weight: 0.01
[9 / 10] Loss: 4.748440618115857 CE Loss: 0.22292980493270456 Con Loss: 4.746211315093963
[9 / 10] tensor([[0.963, 0.942],
        [0.730, 0.727]]) {'epoch': 9, 'valid/acc': 90.506, 'valid/acc_unbiased': 83.134, 'valid/diff': 1.199, 'valid/acc_skew': 82.643, 'valid/acc_align': 83.626, 'test/acc': 90.769, 'test/acc_unbiased': 84.032, 'test/diff': 1.218, 'test/acc_skew': 83.576, 'test/acc_align': 84.488}
[9 / 10] best valid accuracy: 84.365 at epoch 2 
 best_stats: {'best_valid_epoch': 2, 'best_valid_valid/acc': 87.438, 'best_valid_valid/acc_unbiased': 84.365, 'best_valid_valid/diff': 5.396, 'best_valid_valid/acc_skew': 85.691, 'best_valid_valid/acc_align': 83.04, 'best_valid_test/acc': 87.728, 'best_valid_test/acc_unbiased': 84.958, 'best_valid_test/diff': 5.282, 'best_valid_test/acc_skew': 85.871, 'best_valid_test/acc_align': 84.045}
[9 / 10] best test accuracy: 84.958 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 87.438, 'best_test_valid/acc_unbiased': 84.365, 'best_test_valid/diff': 5.396, 'best_test_valid/acc_skew': 85.691, 'best_test_valid/acc_align': 83.04, 'best_test_test/acc': 87.728, 'best_test_test/acc_unbiased': 84.958, 'best_test_test/diff': 5.282, 'best_test_test/acc_skew': 85.871, 'best_test_test/acc_align': 84.045}
[10 / 10] Learning rate: 1e-05 weight: 0.01
[10 / 10] Loss: 4.748157509674549 CE Loss: 0.22300377577842279 Con Loss: 4.745927470378428
[10 / 10] tensor([[0.960, 0.936],
        [0.724, 0.742]]) {'epoch': 10, 'valid/acc': 90.444, 'valid/acc_unbiased': 83.459, 'valid/diff': 1.536, 'valid/acc_skew': 82.691, 'valid/acc_align': 84.227, 'test/acc': 90.562, 'test/acc_unbiased': 84.034, 'test/diff': 2.139, 'test/acc_skew': 82.964, 'test/acc_align': 85.103}
[10 / 10] best valid accuracy: 84.365 at epoch 2 
 best_stats: {'best_valid_epoch': 2, 'best_valid_valid/acc': 87.438, 'best_valid_valid/acc_unbiased': 84.365, 'best_valid_valid/diff': 5.396, 'best_valid_valid/acc_skew': 85.691, 'best_valid_valid/acc_align': 83.04, 'best_valid_test/acc': 87.728, 'best_valid_test/acc_unbiased': 84.958, 'best_valid_test/diff': 5.282, 'best_valid_test/acc_skew': 85.871, 'best_valid_test/acc_align': 84.045}
[10 / 10] best test accuracy: 84.958 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 87.438, 'best_test_valid/acc_unbiased': 84.365, 'best_test_valid/diff': 5.396, 'best_test_valid/acc_skew': 85.691, 'best_test_valid/acc_align': 83.04, 'best_test_test/acc': 87.728, 'best_test_test/acc_unbiased': 84.958, 'best_test_test/diff': 5.282, 'best_test_test/acc_skew': 85.871, 'best_test_test/acc_align': 84.045}
Total training time: 1:59:54
