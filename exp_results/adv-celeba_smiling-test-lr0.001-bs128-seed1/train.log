Log level set to: INFO
Set seed: 1
=======> Using Fixed Random Seed: 1 <========
save_path: exp_results/adv-celeba_smiling-test-lr0.001-bs128-seed1
get_celeba - split:train, aug: False, given_y: True, ratio: 0
get_celeba - split:train_valid, aug: False, given_y: True, ratio: 0
get_celeba - split:valid, aug: False, given_y: True, ratio: 0
decay_epochs: [3, 6]
[1 / 10] Learning rate: 0.001
[1 / 10] Loss: 0.7201
[1 / 10] tensor([[0.199, 0.201],
        [0.773, 0.749]]) {'epoch': 1, 'valid/acc': 50.677, 'valid/acc_unbiased': 47.856, 'valid/diff': 1.598, 'valid/acc_skew': 47.057, 'valid/acc_align': 48.655, 'test/acc': 47.289, 'test/acc_unbiased': 48.065, 'test/diff': 1.312, 'test/acc_skew': 47.409, 'test/acc_align': 48.721}
[1 / 10] best valid accuracy: 47.856 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 50.677, 'best_valid_valid/acc_unbiased': 47.856, 'best_valid_valid/diff': 1.598, 'best_valid_valid/acc_skew': 47.057, 'best_valid_valid/acc_align': 48.655, 'best_valid_test/acc': 47.289, 'best_valid_test/acc_unbiased': 48.065, 'best_valid_test/diff': 1.312, 'best_valid_test/acc_skew': 47.409, 'best_valid_test/acc_align': 48.721}
[1 / 10] best test accuracy: 48.065 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 50.677, 'best_test_valid/acc_unbiased': 47.856, 'best_test_valid/diff': 1.598, 'best_test_valid/acc_skew': 47.057, 'best_test_valid/acc_align': 48.655, 'best_test_test/acc': 47.289, 'best_test_test/acc_unbiased': 48.065, 'best_test_test/diff': 1.312, 'best_test_test/acc_skew': 47.409, 'best_test_test/acc_align': 48.721}
[2 / 10] Learning rate: 0.001
[2 / 10] Loss: 0.1703
[2 / 10] tensor([[0.904, 0.983],
        [0.945, 0.779]]) {'epoch': 2, 'valid/acc': 93.959, 'valid/acc_unbiased': 90.166, 'valid/diff': 12.192, 'valid/acc_skew': 84.069, 'valid/acc_align': 96.262, 'test/acc': 91.509, 'test/acc_unbiased': 90.282, 'test/diff': 12.308, 'test/acc_skew': 84.128, 'test/acc_align': 96.435}
[2 / 10] best valid accuracy: 90.166 at epoch 2 
 best_stats: {'best_valid_epoch': 2, 'best_valid_valid/acc': 93.959, 'best_valid_valid/acc_unbiased': 90.166, 'best_valid_valid/diff': 12.192, 'best_valid_valid/acc_skew': 84.069, 'best_valid_valid/acc_align': 96.262, 'best_valid_test/acc': 91.509, 'best_valid_test/acc_unbiased': 90.282, 'best_valid_test/diff': 12.308, 'best_valid_test/acc_skew': 84.128, 'best_valid_test/acc_align': 96.435}
[2 / 10] best test accuracy: 90.282 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 93.959, 'best_test_valid/acc_unbiased': 90.166, 'best_test_valid/diff': 12.192, 'best_test_valid/acc_skew': 84.069, 'best_test_valid/acc_align': 96.262, 'best_test_test/acc': 91.509, 'best_test_test/acc_unbiased': 90.282, 'best_test_test/diff': 12.308, 'best_test_test/acc_skew': 84.128, 'best_test_test/acc_align': 96.435}
[3 / 10] Learning rate: 0.001
[3 / 10] Loss: 0.1487
[3 / 10] tensor([[0.896, 0.981],
        [0.950, 0.795]]) {'epoch': 3, 'valid/acc': 94.125, 'valid/acc_unbiased': 90.463, 'valid/diff': 11.676, 'valid/acc_skew': 84.625, 'valid/acc_align': 96.301, 'test/acc': 91.68, 'test/acc_unbiased': 90.562, 'test/diff': 11.995, 'test/acc_skew': 84.565, 'test/acc_align': 96.559}
[3 / 10] best valid accuracy: 90.463 at epoch 3 
 best_stats: {'best_valid_epoch': 3, 'best_valid_valid/acc': 94.125, 'best_valid_valid/acc_unbiased': 90.463, 'best_valid_valid/diff': 11.676, 'best_valid_valid/acc_skew': 84.625, 'best_valid_valid/acc_align': 96.301, 'best_valid_test/acc': 91.68, 'best_valid_test/acc_unbiased': 90.562, 'best_valid_test/diff': 11.995, 'best_valid_test/acc_skew': 84.565, 'best_valid_test/acc_align': 96.559}
[3 / 10] best test accuracy: 90.562 at epoch 3 
 best_stats: {'best_test_epoch': 3, 'best_test_valid/acc': 94.125, 'best_test_valid/acc_unbiased': 90.463, 'best_test_valid/diff': 11.676, 'best_test_valid/acc_skew': 84.625, 'best_test_valid/acc_align': 96.301, 'best_test_test/acc': 91.68, 'best_test_test/acc_unbiased': 90.562, 'best_test_test/diff': 11.995, 'best_test_test/acc_skew': 84.565, 'best_test_test/acc_align': 96.559}
[4 / 10] Learning rate: 0.0001
[4 / 10] Loss: 0.1428
[4 / 10] tensor([[0.830, 0.976],
        [0.976, 0.841]]) {'epoch': 4, 'valid/acc': 95.506, 'valid/acc_unbiased': 91.186, 'valid/diff': 13.214, 'valid/acc_skew': 84.58, 'valid/acc_align': 97.793, 'test/acc': 91.373, 'test/acc_unbiased': 90.55, 'test/diff': 14.049, 'test/acc_skew': 83.526, 'test/acc_align': 97.575}
[4 / 10] best valid accuracy: 91.186 at epoch 4 
 best_stats: {'best_valid_epoch': 4, 'best_valid_valid/acc': 95.506, 'best_valid_valid/acc_unbiased': 91.186, 'best_valid_valid/diff': 13.214, 'best_valid_valid/acc_skew': 84.58, 'best_valid_valid/acc_align': 97.793, 'best_valid_test/acc': 91.373, 'best_valid_test/acc_unbiased': 90.55, 'best_valid_test/diff': 14.049, 'best_valid_test/acc_skew': 83.526, 'best_valid_test/acc_align': 97.575}
[4 / 10] best test accuracy: 90.562 at epoch 3 
 best_stats: {'best_test_epoch': 3, 'best_test_valid/acc': 94.125, 'best_test_valid/acc_unbiased': 90.463, 'best_test_valid/diff': 11.676, 'best_test_valid/acc_skew': 84.625, 'best_test_valid/acc_align': 96.301, 'best_test_test/acc': 91.68, 'best_test_test/acc_unbiased': 90.562, 'best_test_test/diff': 11.995, 'best_test_test/acc_skew': 84.565, 'best_test_test/acc_align': 96.559}
[5 / 10] Learning rate: 0.0001
[5 / 10] Loss: 0.1315
[5 / 10] tensor([[0.821, 0.973],
        [0.979, 0.854]]) {'epoch': 5, 'valid/acc': 95.426, 'valid/acc_unbiased': 91.035, 'valid/diff': 13.385, 'valid/acc_skew': 84.342, 'valid/acc_align': 97.728, 'test/acc': 91.413, 'test/acc_unbiased': 90.681, 'test/diff': 13.853, 'test/acc_skew': 83.755, 'test/acc_align': 97.608}
[5 / 10] best valid accuracy: 91.186 at epoch 4 
 best_stats: {'best_valid_epoch': 4, 'best_valid_valid/acc': 95.506, 'best_valid_valid/acc_unbiased': 91.186, 'best_valid_valid/diff': 13.214, 'best_valid_valid/acc_skew': 84.58, 'best_valid_valid/acc_align': 97.793, 'best_valid_test/acc': 91.373, 'best_valid_test/acc_unbiased': 90.55, 'best_valid_test/diff': 14.049, 'best_valid_test/acc_skew': 83.526, 'best_valid_test/acc_align': 97.575}
[5 / 10] best test accuracy: 90.681 at epoch 5 
 best_stats: {'best_test_epoch': 5, 'best_test_valid/acc': 95.426, 'best_test_valid/acc_unbiased': 91.035, 'best_test_valid/diff': 13.385, 'best_test_valid/acc_skew': 84.342, 'best_test_valid/acc_align': 97.728, 'best_test_test/acc': 91.413, 'best_test_test/acc_unbiased': 90.681, 'best_test_test/diff': 13.853, 'best_test_test/acc_skew': 83.755, 'best_test_test/acc_align': 97.608}
[6 / 10] Learning rate: 0.0001
[6 / 10] Loss: 0.1357
[6 / 10] tensor([[0.838, 0.969],
        [0.977, 0.857]]) {'epoch': 6, 'valid/acc': 95.605, 'valid/acc_unbiased': 91.664, 'valid/diff': 11.981, 'valid/acc_skew': 85.673, 'valid/acc_align': 97.655, 'test/acc': 91.745, 'test/acc_unbiased': 91.027, 'test/diff': 12.557, 'test/acc_skew': 84.748, 'test/acc_align': 97.305}
[6 / 10] best valid accuracy: 91.664 at epoch 6 
 best_stats: {'best_valid_epoch': 6, 'best_valid_valid/acc': 95.605, 'best_valid_valid/acc_unbiased': 91.664, 'best_valid_valid/diff': 11.981, 'best_valid_valid/acc_skew': 85.673, 'best_valid_valid/acc_align': 97.655, 'best_valid_test/acc': 91.745, 'best_valid_test/acc_unbiased': 91.027, 'best_valid_test/diff': 12.557, 'best_valid_test/acc_skew': 84.748, 'best_valid_test/acc_align': 97.305}
[6 / 10] best test accuracy: 91.027 at epoch 6 
 best_stats: {'best_test_epoch': 6, 'best_test_valid/acc': 95.605, 'best_test_valid/acc_unbiased': 91.664, 'best_test_valid/diff': 11.981, 'best_test_valid/acc_skew': 85.673, 'best_test_valid/acc_align': 97.655, 'best_test_test/acc': 91.745, 'best_test_test/acc_unbiased': 91.027, 'best_test_test/diff': 12.557, 'best_test_test/acc_skew': 84.748, 'best_test_test/acc_align': 97.305}
[7 / 10] Learning rate: 1e-05
[7 / 10] Loss: 0.1249
[7 / 10] tensor([[0.824, 0.967],
        [0.980, 0.868]]) {'epoch': 7, 'valid/acc': 95.493, 'valid/acc_unbiased': 91.639, 'valid/diff': 11.635, 'valid/acc_skew': 85.821, 'valid/acc_align': 97.457, 'test/acc': 91.589, 'test/acc_unbiased': 90.963, 'test/diff': 12.736, 'test/acc_skew': 84.595, 'test/acc_align': 97.331}
[7 / 10] best valid accuracy: 91.664 at epoch 6 
 best_stats: {'best_valid_epoch': 6, 'best_valid_valid/acc': 95.605, 'best_valid_valid/acc_unbiased': 91.664, 'best_valid_valid/diff': 11.981, 'best_valid_valid/acc_skew': 85.673, 'best_valid_valid/acc_align': 97.655, 'best_valid_test/acc': 91.745, 'best_valid_test/acc_unbiased': 91.027, 'best_valid_test/diff': 12.557, 'best_valid_test/acc_skew': 84.748, 'best_valid_test/acc_align': 97.305}
[7 / 10] best test accuracy: 91.027 at epoch 6 
 best_stats: {'best_test_epoch': 6, 'best_test_valid/acc': 95.605, 'best_test_valid/acc_unbiased': 91.664, 'best_test_valid/diff': 11.981, 'best_test_valid/acc_skew': 85.673, 'best_test_valid/acc_align': 97.655, 'best_test_test/acc': 91.745, 'best_test_test/acc_unbiased': 91.027, 'best_test_test/diff': 12.557, 'best_test_test/acc_skew': 84.748, 'best_test_test/acc_align': 97.305}
[8 / 10] Learning rate: 1e-05
[8 / 10] Loss: 0.1247
[8 / 10] tensor([[0.844, 0.976],
        [0.976, 0.844]]) {'epoch': 8, 'valid/acc': 95.842, 'valid/acc_unbiased': 91.869, 'valid/diff': 12.171, 'valid/acc_skew': 85.783, 'valid/acc_align': 97.954, 'test/acc': 91.816, 'test/acc_unbiased': 90.991, 'test/diff': 13.221, 'test/acc_skew': 84.38, 'test/acc_align': 97.601}
[8 / 10] best valid accuracy: 91.869 at epoch 8 
 best_stats: {'best_valid_epoch': 8, 'best_valid_valid/acc': 95.842, 'best_valid_valid/acc_unbiased': 91.869, 'best_valid_valid/diff': 12.171, 'best_valid_valid/acc_skew': 85.783, 'best_valid_valid/acc_align': 97.954, 'best_valid_test/acc': 91.816, 'best_valid_test/acc_unbiased': 90.991, 'best_valid_test/diff': 13.221, 'best_valid_test/acc_skew': 84.38, 'best_valid_test/acc_align': 97.601}
[8 / 10] best test accuracy: 91.027 at epoch 6 
 best_stats: {'best_test_epoch': 6, 'best_test_valid/acc': 95.605, 'best_test_valid/acc_unbiased': 91.664, 'best_test_valid/diff': 11.981, 'best_test_valid/acc_skew': 85.673, 'best_test_valid/acc_align': 97.655, 'best_test_test/acc': 91.745, 'best_test_test/acc_unbiased': 91.027, 'best_test_test/diff': 12.557, 'best_test_test/acc_skew': 84.748, 'best_test_test/acc_align': 97.305}
[9 / 10] Learning rate: 1e-05
[9 / 10] Loss: 0.1227
[9 / 10] tensor([[0.829, 0.969],
        [0.978, 0.858]]) {'epoch': 9, 'valid/acc': 95.708, 'valid/acc_unbiased': 91.622, 'valid/diff': 12.412, 'valid/acc_skew': 85.416, 'valid/acc_align': 97.828, 'test/acc': 91.564, 'test/acc_unbiased': 90.859, 'test/diff': 13.021, 'test/acc_skew': 84.349, 'test/acc_align': 97.37}
[9 / 10] best valid accuracy: 91.869 at epoch 8 
 best_stats: {'best_valid_epoch': 8, 'best_valid_valid/acc': 95.842, 'best_valid_valid/acc_unbiased': 91.869, 'best_valid_valid/diff': 12.171, 'best_valid_valid/acc_skew': 85.783, 'best_valid_valid/acc_align': 97.954, 'best_valid_test/acc': 91.816, 'best_valid_test/acc_unbiased': 90.991, 'best_valid_test/diff': 13.221, 'best_valid_test/acc_skew': 84.38, 'best_valid_test/acc_align': 97.601}
[9 / 10] best test accuracy: 91.027 at epoch 6 
 best_stats: {'best_test_epoch': 6, 'best_test_valid/acc': 95.605, 'best_test_valid/acc_unbiased': 91.664, 'best_test_valid/diff': 11.981, 'best_test_valid/acc_skew': 85.673, 'best_test_valid/acc_align': 97.655, 'best_test_test/acc': 91.745, 'best_test_test/acc_unbiased': 91.027, 'best_test_test/diff': 12.557, 'best_test_test/acc_skew': 84.748, 'best_test_test/acc_align': 97.305}
[10 / 10] Learning rate: 1e-05
[10 / 10] Loss: 0.1249
[10 / 10] tensor([[0.847, 0.981],
        [0.975, 0.828]]) {'epoch': 10, 'valid/acc': 95.784, 'valid/acc_unbiased': 91.461, 'valid/diff': 13.327, 'valid/acc_skew': 84.797, 'valid/acc_align': 98.124, 'test/acc': 91.71, 'test/acc_unbiased': 90.764, 'test/diff': 14.088, 'test/acc_skew': 83.72, 'test/acc_align': 97.808}
[10 / 10] best valid accuracy: 91.869 at epoch 8 
 best_stats: {'best_valid_epoch': 8, 'best_valid_valid/acc': 95.842, 'best_valid_valid/acc_unbiased': 91.869, 'best_valid_valid/diff': 12.171, 'best_valid_valid/acc_skew': 85.783, 'best_valid_valid/acc_align': 97.954, 'best_valid_test/acc': 91.816, 'best_valid_test/acc_unbiased': 90.991, 'best_valid_test/diff': 13.221, 'best_valid_test/acc_skew': 84.38, 'best_valid_test/acc_align': 97.601}
[10 / 10] best test accuracy: 91.027 at epoch 6 
 best_stats: {'best_test_epoch': 6, 'best_test_valid/acc': 95.605, 'best_test_valid/acc_unbiased': 91.664, 'best_test_valid/diff': 11.981, 'best_test_valid/acc_skew': 85.673, 'best_test_valid/acc_align': 97.655, 'best_test_test/acc': 91.745, 'best_test_test/acc_unbiased': 91.027, 'best_test_test/diff': 12.557, 'best_test_test/acc_skew': 84.748, 'best_test_test/acc_align': 97.305}
Total training time: 0:42:09
