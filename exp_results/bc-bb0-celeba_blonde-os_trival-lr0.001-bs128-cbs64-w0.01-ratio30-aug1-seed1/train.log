Log level set to: INFO
Set seed: 1
=======> Using Fixed Random Seed: 1 <========
save_path: exp_results/bc-bb0-celeba_blonde-os_trival-lr0.001-bs128-cbs64-w0.01-ratio30-aug1-seed1
get_celeba - split:train, aug: False, given_y: True, ratio: 0
use existing blonde indices from data/celeba/pickles/blonde
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [53577, 53577]
Target 1: [53577, 53577]
Binary Target 1
---------------------------
Target 0: [53577, 53577]
Target 1: [53577, 53577]
===================================
Normal Label Distribution: 
Target 0: [53577, 53577]
Target 1: [53577, 53577]
===================================
Use BiasedCelebASplit 
 target_attr: blonde split: train 
 tensor([[53577., 53577.],
        [53577., 53577.]])
get_celeba - split:train, aug: 1, given_y: True, ratio: 30
use existing blonde indices from data/celeba/pickles/blonde
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [53425, 53425]
Target 1: [53425, 53425]
Binary Target 1
---------------------------
Target 0: [53425, 53425]
Target 1: [53425, 53425]
===================================
Normal Label Distribution: 
Target 0: [53425, 53425]
Target 1: [53425, 53425]
===================================
Use BiasedCelebASplit 
 target_attr: blonde split: train 
 tensor([[53425., 53425.],
        [53425., 53425.]])
get_celeba - split:train_valid, aug: False, given_y: True, ratio: 0
use existing blonde indices from data/celeba/pickles/blonde
Use BiasedCelebASplit 
 target_attr: blonde split: train_valid 
 tensor([[  390.,  4598.],
        [13361.,   280.]])
get_celeba - split:valid, aug: False, given_y: True, ratio: 0
Use BiasedCelebASplit 
 target_attr: blonde split: valid 
 tensor([[8535., 2874.],
        [8276.,  182.]])
decay_epochs: [3, 6]
[1 / 10] Learning rate: 0.001 weight: 0.01
[1 / 10] Loss: 4.635865209938211 CE Loss: 0.23493432457090116 Con Loss: 4.633515869100183
[1 / 10] tensor([[0.876, 0.930],
        [0.937, 0.918]]) {'epoch': 1, 'valid/acc': 92.56, 'valid/acc_unbiased': 91.729, 'valid/diff': 2.424, 'valid/acc_skew': 92.941, 'valid/acc_align': 90.517, 'test/acc': 90.784, 'test/acc_unbiased': 91.523, 'test/diff': 3.696, 'test/acc_skew': 90.647, 'test/acc_align': 92.399}
[1 / 10] best valid accuracy: 91.729 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 92.56, 'best_valid_valid/acc_unbiased': 91.729, 'best_valid_valid/diff': 2.424, 'best_valid_valid/acc_skew': 92.941, 'best_valid_valid/acc_align': 90.517, 'best_valid_test/acc': 90.784, 'best_valid_test/acc_unbiased': 91.523, 'best_valid_test/diff': 3.696, 'best_valid_test/acc_skew': 90.647, 'best_valid_test/acc_align': 92.399}
[1 / 10] best test accuracy: 91.523 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 92.56, 'best_test_valid/acc_unbiased': 91.729, 'best_test_valid/diff': 2.424, 'best_test_valid/acc_skew': 92.941, 'best_test_valid/acc_align': 90.517, 'best_test_test/acc': 90.784, 'best_test_test/acc_unbiased': 91.523, 'best_test_test/diff': 3.696, 'best_test_test/acc_skew': 90.647, 'best_test_test/acc_align': 92.399}
[2 / 10] Learning rate: 0.001 weight: 0.01
[2 / 10] Loss: 4.590374984018884 CE Loss: 0.20257769936858502 Con Loss: 4.588349205606058
[2 / 10] tensor([[0.873, 0.914],
        [0.943, 0.923]]) {'epoch': 2, 'valid/acc': 91.9, 'valid/acc_unbiased': 92.378, 'valid/diff': 3.327, 'valid/acc_skew': 94.041, 'valid/acc_align': 90.714, 'test/acc': 90.094, 'test/acc_unbiased': 91.348, 'test/diff': 3.077, 'test/acc_skew': 90.82, 'test/acc_align': 91.876}
[2 / 10] best valid accuracy: 92.378 at epoch 2 
 best_stats: {'best_valid_epoch': 2, 'best_valid_valid/acc': 91.9, 'best_valid_valid/acc_unbiased': 92.378, 'best_valid_valid/diff': 3.327, 'best_valid_valid/acc_skew': 94.041, 'best_valid_valid/acc_align': 90.714, 'best_valid_test/acc': 90.094, 'best_valid_test/acc_unbiased': 91.348, 'best_valid_test/diff': 3.077, 'best_valid_test/acc_skew': 90.82, 'best_valid_test/acc_align': 91.876}
[2 / 10] best test accuracy: 91.523 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 92.56, 'best_test_valid/acc_unbiased': 91.729, 'best_test_valid/diff': 2.424, 'best_test_valid/acc_skew': 92.941, 'best_test_valid/acc_align': 90.517, 'best_test_test/acc': 90.784, 'best_test_test/acc_unbiased': 91.523, 'best_test_test/diff': 3.696, 'best_test_test/acc_skew': 90.647, 'best_test_test/acc_align': 92.399}
[3 / 10] Learning rate: 0.001 weight: 0.01
[3 / 10] Loss: 4.566302840114319 CE Loss: 0.18674001195857645 Con Loss: 4.564435439758882
[3 / 10] tensor([[0.920, 0.947],
        [0.897, 0.852]]) {'epoch': 3, 'valid/acc': 92.882, 'valid/acc_unbiased': 92.172, 'valid/diff': 2.936, 'valid/acc_skew': 93.64, 'valid/acc_align': 90.704, 'test/acc': 92.717, 'test/acc_unbiased': 90.384, 'test/diff': 3.593, 'test/acc_skew': 90.855, 'test/acc_align': 89.912}
[3 / 10] best valid accuracy: 92.378 at epoch 2 
 best_stats: {'best_valid_epoch': 2, 'best_valid_valid/acc': 91.9, 'best_valid_valid/acc_unbiased': 92.378, 'best_valid_valid/diff': 3.327, 'best_valid_valid/acc_skew': 94.041, 'best_valid_valid/acc_align': 90.714, 'best_valid_test/acc': 90.094, 'best_valid_test/acc_unbiased': 91.348, 'best_valid_test/diff': 3.077, 'best_valid_test/acc_skew': 90.82, 'best_valid_test/acc_align': 91.876}
[3 / 10] best test accuracy: 91.523 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 92.56, 'best_test_valid/acc_unbiased': 91.729, 'best_test_valid/diff': 2.424, 'best_test_valid/acc_skew': 92.941, 'best_test_valid/acc_align': 90.517, 'best_test_test/acc': 90.784, 'best_test_test/acc_unbiased': 91.523, 'best_test_test/diff': 3.696, 'best_test_test/acc_skew': 90.647, 'best_test_test/acc_align': 92.399}
[4 / 10] Learning rate: 0.0001 weight: 0.01
[4 / 10] Loss: 4.5016433648731855 CE Loss: 0.15044640408765964 Con Loss: 4.500138898213277
[4 / 10] tensor([[0.876, 0.946],
        [0.952, 0.934]]) {'epoch': 4, 'valid/acc': 94.664, 'valid/acc_unbiased': 95.413, 'valid/diff': 2.304, 'valid/acc_skew': 96.565, 'valid/acc_align': 94.261, 'test/acc': 91.665, 'test/acc_unbiased': 92.699, 'test/diff': 4.363, 'test/acc_skew': 91.413, 'test/acc_align': 93.985}
[4 / 10] best valid accuracy: 95.413 at epoch 4 
 best_stats: {'best_valid_epoch': 4, 'best_valid_valid/acc': 94.664, 'best_valid_valid/acc_unbiased': 95.413, 'best_valid_valid/diff': 2.304, 'best_valid_valid/acc_skew': 96.565, 'best_valid_valid/acc_align': 94.261, 'best_valid_test/acc': 91.665, 'best_valid_test/acc_unbiased': 92.699, 'best_valid_test/diff': 4.363, 'best_valid_test/acc_skew': 91.413, 'best_valid_test/acc_align': 93.985}
[4 / 10] best test accuracy: 92.699 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 94.664, 'best_test_valid/acc_unbiased': 95.413, 'best_test_valid/diff': 2.304, 'best_test_valid/acc_skew': 96.565, 'best_test_valid/acc_align': 94.261, 'best_test_test/acc': 91.665, 'best_test_test/acc_unbiased': 92.699, 'best_test_test/diff': 4.363, 'best_test_test/acc_skew': 91.413, 'best_test_test/acc_align': 93.985}
[5 / 10] Learning rate: 0.0001 weight: 0.01
[5 / 10] Loss: 4.4733466307010685 CE Loss: 0.13613193270409274 Con Loss: 4.471985310125291
[5 / 10] tensor([[0.858, 0.951],
        [0.957, 0.885]]) {'epoch': 5, 'valid/acc': 95.121, 'valid/acc_unbiased': 95.934, 'valid/diff': 2.279, 'valid/acc_skew': 97.074, 'valid/acc_align': 94.794, 'test/acc': 91.141, 'test/acc_unbiased': 91.263, 'test/diff': 8.23, 'test/acc_skew': 90.743, 'test/acc_align': 91.784}
[5 / 10] best valid accuracy: 95.934 at epoch 5 
 best_stats: {'best_valid_epoch': 5, 'best_valid_valid/acc': 95.121, 'best_valid_valid/acc_unbiased': 95.934, 'best_valid_valid/diff': 2.279, 'best_valid_valid/acc_skew': 97.074, 'best_valid_valid/acc_align': 94.794, 'best_valid_test/acc': 91.141, 'best_valid_test/acc_unbiased': 91.263, 'best_valid_test/diff': 8.23, 'best_valid_test/acc_skew': 90.743, 'best_valid_test/acc_align': 91.784}
[5 / 10] best test accuracy: 92.699 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 94.664, 'best_test_valid/acc_unbiased': 95.413, 'best_test_valid/diff': 2.304, 'best_test_valid/acc_skew': 96.565, 'best_test_valid/acc_align': 94.261, 'best_test_test/acc': 91.665, 'best_test_test/acc_unbiased': 92.699, 'best_test_test/diff': 4.363, 'best_test_test/acc_skew': 91.413, 'best_test_test/acc_align': 93.985}
[6 / 10] Learning rate: 0.0001 weight: 0.01
[6 / 10] Loss: 4.453316658882682 CE Loss: 0.1264961800061591 Con Loss: 4.452051696294606
[6 / 10] tensor([[0.857, 0.950],
        [0.958, 0.885]]) {'epoch': 6, 'valid/acc': 95.099, 'valid/acc_unbiased': 96.117, 'valid/diff': 2.296, 'valid/acc_skew': 97.265, 'valid/acc_align': 94.969, 'test/acc': 91.076, 'test/acc_unbiased': 91.253, 'test/diff': 8.339, 'test/acc_skew': 90.765, 'test/acc_align': 91.742}
[6 / 10] best valid accuracy: 96.117 at epoch 6 
 best_stats: {'best_valid_epoch': 6, 'best_valid_valid/acc': 95.099, 'best_valid_valid/acc_unbiased': 96.117, 'best_valid_valid/diff': 2.296, 'best_valid_valid/acc_skew': 97.265, 'best_valid_valid/acc_align': 94.969, 'best_valid_test/acc': 91.076, 'best_valid_test/acc_unbiased': 91.253, 'best_valid_test/diff': 8.339, 'best_valid_test/acc_skew': 90.765, 'best_valid_test/acc_align': 91.742}
[6 / 10] best test accuracy: 92.699 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 94.664, 'best_test_valid/acc_unbiased': 95.413, 'best_test_valid/diff': 2.304, 'best_test_valid/acc_skew': 96.565, 'best_test_valid/acc_align': 94.261, 'best_test_test/acc': 91.665, 'best_test_test/acc_unbiased': 92.699, 'best_test_test/diff': 4.363, 'best_test_test/acc_skew': 91.413, 'best_test_test/acc_align': 93.985}
[7 / 10] Learning rate: 1e-05 weight: 0.01
[7 / 10] Loss: 4.442446991638002 CE Loss: 0.1190591980325532 Con Loss: 4.441256402456754
[7 / 10] tensor([[0.834, 0.946],
        [0.969, 0.874]]) {'epoch': 7, 'valid/acc': 95.298, 'valid/acc_unbiased': 97.155, 'valid/diff': 2.367, 'valid/acc_skew': 98.024, 'valid/acc_align': 96.285, 'test/acc': 90.054, 'test/acc_unbiased': 90.572, 'test/diff': 10.43, 'test/acc_skew': 90.144, 'test/acc_align': 90.999}
[7 / 10] best valid accuracy: 97.155 at epoch 7 
 best_stats: {'best_valid_epoch': 7, 'best_valid_valid/acc': 95.298, 'best_valid_valid/acc_unbiased': 97.155, 'best_valid_valid/diff': 2.367, 'best_valid_valid/acc_skew': 98.024, 'best_valid_valid/acc_align': 96.285, 'best_valid_test/acc': 90.054, 'best_valid_test/acc_unbiased': 90.572, 'best_valid_test/diff': 10.43, 'best_valid_test/acc_skew': 90.144, 'best_valid_test/acc_align': 90.999}
[7 / 10] best test accuracy: 92.699 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 94.664, 'best_test_valid/acc_unbiased': 95.413, 'best_test_valid/diff': 2.304, 'best_test_valid/acc_skew': 96.565, 'best_test_valid/acc_align': 94.261, 'best_test_test/acc': 91.665, 'best_test_test/acc_unbiased': 92.699, 'best_test_test/diff': 4.363, 'best_test_test/acc_skew': 91.413, 'best_test_test/acc_align': 93.985}
[8 / 10] Learning rate: 1e-05 weight: 0.01
[8 / 10] Loss: 4.437061815665724 CE Loss: 0.11727750058028573 Con Loss: 4.435889041933102
[8 / 10] tensor([[0.845, 0.952],
        [0.962, 0.852]]) {'epoch': 8, 'valid/acc': 95.663, 'valid/acc_unbiased': 97.178, 'valid/diff': 2.219, 'valid/acc_skew': 97.913, 'valid/acc_align': 96.444, 'test/acc': 90.678, 'test/acc_unbiased': 90.286, 'test/diff': 10.885, 'test/acc_skew': 90.382, 'test/acc_align': 90.19}
[8 / 10] best valid accuracy: 97.178 at epoch 8 
 best_stats: {'best_valid_epoch': 8, 'best_valid_valid/acc': 95.663, 'best_valid_valid/acc_unbiased': 97.178, 'best_valid_valid/diff': 2.219, 'best_valid_valid/acc_skew': 97.913, 'best_valid_valid/acc_align': 96.444, 'best_valid_test/acc': 90.678, 'best_valid_test/acc_unbiased': 90.286, 'best_valid_test/diff': 10.885, 'best_valid_test/acc_skew': 90.382, 'best_valid_test/acc_align': 90.19}
[8 / 10] best test accuracy: 92.699 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 94.664, 'best_test_valid/acc_unbiased': 95.413, 'best_test_valid/diff': 2.304, 'best_test_valid/acc_skew': 96.565, 'best_test_valid/acc_align': 94.261, 'best_test_test/acc': 91.665, 'best_test_test/acc_unbiased': 92.699, 'best_test_test/diff': 4.363, 'best_test_test/acc_skew': 91.413, 'best_test_test/acc_align': 93.985}
[9 / 10] Learning rate: 1e-05 weight: 0.01
[9 / 10] Loss: 4.43383633804065 CE Loss: 0.11618536603104342 Con Loss: 4.432674489145101
[9 / 10] tensor([[0.846, 0.953],
        [0.966, 0.868]]) {'epoch': 9, 'valid/acc': 95.534, 'valid/acc_unbiased': 96.858, 'valid/diff': 2.317, 'valid/acc_skew': 98.017, 'valid/acc_align': 95.7, 'test/acc': 90.789, 'test/acc_unbiased': 90.812, 'test/diff': 10.218, 'test/acc_skew': 90.591, 'test/acc_align': 91.032}
[9 / 10] best valid accuracy: 97.178 at epoch 8 
 best_stats: {'best_valid_epoch': 8, 'best_valid_valid/acc': 95.663, 'best_valid_valid/acc_unbiased': 97.178, 'best_valid_valid/diff': 2.219, 'best_valid_valid/acc_skew': 97.913, 'best_valid_valid/acc_align': 96.444, 'best_valid_test/acc': 90.678, 'best_valid_test/acc_unbiased': 90.286, 'best_valid_test/diff': 10.885, 'best_valid_test/acc_skew': 90.382, 'best_valid_test/acc_align': 90.19}
[9 / 10] best test accuracy: 92.699 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 94.664, 'best_test_valid/acc_unbiased': 95.413, 'best_test_valid/diff': 2.304, 'best_test_valid/acc_skew': 96.565, 'best_test_valid/acc_align': 94.261, 'best_test_test/acc': 91.665, 'best_test_test/acc_unbiased': 92.699, 'best_test_test/diff': 4.363, 'best_test_test/acc_skew': 91.413, 'best_test_test/acc_align': 93.985}
[10 / 10] Learning rate: 1e-05 weight: 0.01
[10 / 10] Loss: 4.430771785146688 CE Loss: 0.1139406506063581 Con Loss: 4.429632373781477
[10 / 10] tensor([[0.833, 0.948],
        [0.970, 0.890]]) {'epoch': 10, 'valid/acc': 95.475, 'valid/acc_unbiased': 97.107, 'valid/diff': 2.111, 'valid/acc_skew': 98.163, 'valid/acc_align': 96.052, 'test/acc': 90.139, 'test/acc_unbiased': 91.038, 'test/diff': 9.737, 'test/acc_skew': 90.168, 'test/acc_align': 91.908}
[10 / 10] best valid accuracy: 97.178 at epoch 8 
 best_stats: {'best_valid_epoch': 8, 'best_valid_valid/acc': 95.663, 'best_valid_valid/acc_unbiased': 97.178, 'best_valid_valid/diff': 2.219, 'best_valid_valid/acc_skew': 97.913, 'best_valid_valid/acc_align': 96.444, 'best_valid_test/acc': 90.678, 'best_valid_test/acc_unbiased': 90.286, 'best_valid_test/diff': 10.885, 'best_valid_test/acc_skew': 90.382, 'best_valid_test/acc_align': 90.19}
[10 / 10] best test accuracy: 92.699 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 94.664, 'best_test_valid/acc_unbiased': 95.413, 'best_test_valid/diff': 2.304, 'best_test_valid/acc_skew': 96.565, 'best_test_valid/acc_align': 94.261, 'best_test_test/acc': 91.665, 'best_test_test/acc_unbiased': 92.699, 'best_test_test/diff': 4.363, 'best_test_test/acc_skew': 91.413, 'best_test_test/acc_align': 93.985}
Total training time: 3:15:02
