Log level set to: INFO
Set seed: 1
=======> Using Fixed Random Seed: 1 <========
save_path: exp_results/bc-bb0-utk_face_age-crop_cutout_color_blur_test-0.9-lr0.001-bs128-cbs64-w0.01-ratio10-aug1-seed1
get_utk_face - split: train, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_age-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
Binary Target 1
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Normal Label Distribution: 
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
Binary Target 1
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Normal Label Distribution: 
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 10684, target_attr: gender, bias_attr: age bias_rate: 0.9
['[train] target_0-bias_0: 8237', '[train] target_0-bias_1: 147', '[train] target_1-bias_0: 823', '[train] target_1-bias_1: 1477']
confusion_matrix - 
 original: tensor([[8237.,  823.],
        [ 147., 1477.]]), 
 normalized: tensor([[0.909, 0.091],
        [0.091, 0.909]]), 
 b|y: tensor([[0.982, 0.018],
        [0.358, 0.642]])
get_utk_face - split: train, aug: 1, given_y: True, ratio: 10
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_age-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
Binary Target 1
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Normal Label Distribution: 
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
Binary Target 1
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Normal Label Distribution: 
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 10684, target_attr: gender, bias_attr: age bias_rate: 0.9
['[train] target_0-bias_0: 8237', '[train] target_0-bias_1: 147', '[train] target_1-bias_0: 823', '[train] target_1-bias_1: 1477']
get_utk_face - split: valid, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_age-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [1030, 195]
Target 1: [841, 202]
Binary Target 1
---------------------------
Target 0: [1030, 195]
Target 1: [841, 202]
===================================
Normal Label Distribution: 
Target 0: [1030, 195]
Target 1: [841, 202]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 2268, target_attr: gender, bias_attr: age bias_rate: 0.9
['[valid] target_0-bias_0: 1030', '[valid] target_0-bias_1: 195', '[valid] target_1-bias_0: 841', '[valid] target_1-bias_1: 202']
get_utk_face - split: test, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_age-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [1061, 176]
Target 1: [867, 165]
Binary Target 1
---------------------------
Target 0: [1061, 176]
Target 1: [867, 165]
===================================
Normal Label Distribution: 
Target 0: [1061, 176]
Target 1: [867, 165]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 2269, target_attr: gender, bias_attr: age bias_rate: 0.9
['[test] target_0-bias_0: 1061', '[test] target_0-bias_1: 176', '[test] target_1-bias_0: 867', '[test] target_1-bias_1: 165']
decay_epochs: [6, 13]
[1 / 20] Learning rate: 0.001 weight: 0.01
[1 / 20] Loss: 4.897657583644443 CE Loss: 0.5463645881992384 Con Loss: 4.892193937069555
[1 / 20] tensor([[0.997, 1.000],
        [0.022, 0.006]]) {'epoch': 1, 'valid/acc': 54.762, 'valid/acc_unbiased': 50.793, 'valid/diff': 0.198, 'valid/acc_skew': 50.892, 'valid/acc_align': 50.694, 'test/acc': 55.267, 'test/acc_unbiased': 50.629, 'test/diff': 0.934, 'test/acc_skew': 51.096, 'test/acc_align': 50.162}
[1 / 20] best valid accuracy: 50.793 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 54.762, 'best_valid_valid/acc_unbiased': 50.793, 'best_valid_valid/diff': 0.198, 'best_valid_valid/acc_skew': 50.892, 'best_valid_valid/acc_align': 50.694, 'best_valid_test/acc': 55.267, 'best_valid_test/acc_unbiased': 50.629, 'best_valid_test/diff': 0.934, 'best_valid_test/acc_skew': 51.096, 'best_valid_test/acc_align': 50.162}
[1 / 20] best test accuracy: 50.629 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 54.762, 'best_test_valid/acc_unbiased': 50.793, 'best_test_valid/diff': 0.198, 'best_test_valid/acc_skew': 50.892, 'best_test_valid/acc_align': 50.694, 'best_test_test/acc': 55.267, 'best_test_test/acc_unbiased': 50.629, 'best_test_test/diff': 0.934, 'best_test_test/acc_skew': 51.096, 'best_test_test/acc_align': 50.162}
[2 / 20] Learning rate: 0.001 weight: 0.01
[2 / 20] Loss: 4.74896463282052 CE Loss: 0.5308568070373121 Con Loss: 4.743656065257825
[2 / 20] tensor([[0.998, 1.000],
        [0.012, 0.000]]) {'epoch': 2, 'valid/acc': 54.189, 'valid/acc_unbiased': 50.13, 'valid/diff': 0.454, 'valid/acc_skew': 50.357, 'valid/acc_align': 49.903, 'test/acc': 54.87, 'test/acc_unbiased': 50.241, 'test/diff': 0.671, 'test/acc_skew': 50.577, 'test/acc_align': 49.906}
[2 / 20] best valid accuracy: 50.793 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 54.762, 'best_valid_valid/acc_unbiased': 50.793, 'best_valid_valid/diff': 0.198, 'best_valid_valid/acc_skew': 50.892, 'best_valid_valid/acc_align': 50.694, 'best_valid_test/acc': 55.267, 'best_valid_test/acc_unbiased': 50.629, 'best_valid_test/diff': 0.934, 'best_valid_test/acc_skew': 51.096, 'best_valid_test/acc_align': 50.162}
[2 / 20] best test accuracy: 50.629 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 54.762, 'best_test_valid/acc_unbiased': 50.793, 'best_test_valid/diff': 0.198, 'best_test_valid/acc_skew': 50.892, 'best_test_valid/acc_align': 50.694, 'best_test_test/acc': 55.267, 'best_test_test/acc_unbiased': 50.629, 'best_test_test/diff': 0.934, 'best_test_test/acc_skew': 51.096, 'best_test_test/acc_align': 50.162}
[3 / 20] Learning rate: 0.001 weight: 0.01
[3 / 20] Loss: 4.672234009107549 CE Loss: 0.5126248459742784 Con Loss: 4.6671077948926945
[3 / 20] tensor([[0.981, 0.966],
        [0.130, 0.024]]) {'epoch': 3, 'valid/acc': 57.231, 'valid/acc_unbiased': 52.559, 'valid/diff': 4.283, 'valid/acc_skew': 54.7, 'valid/acc_align': 50.417, 'test/acc': 58.528, 'test/acc_unbiased': 52.541, 'test/diff': 6.067, 'test/acc_skew': 54.812, 'test/acc_align': 50.27}
[3 / 20] best valid accuracy: 52.559 at epoch 3 
 best_stats: {'best_valid_epoch': 3, 'best_valid_valid/acc': 57.231, 'best_valid_valid/acc_unbiased': 52.559, 'best_valid_valid/diff': 4.283, 'best_valid_valid/acc_skew': 54.7, 'best_valid_valid/acc_align': 50.417, 'best_valid_test/acc': 58.528, 'best_valid_test/acc_unbiased': 52.541, 'best_valid_test/diff': 6.067, 'best_valid_test/acc_skew': 54.812, 'best_valid_test/acc_align': 50.27}
[3 / 20] best test accuracy: 52.541 at epoch 3 
 best_stats: {'best_test_epoch': 3, 'best_test_valid/acc': 57.231, 'best_test_valid/acc_unbiased': 52.559, 'best_test_valid/diff': 4.283, 'best_test_valid/acc_skew': 54.7, 'best_test_valid/acc_align': 50.417, 'best_test_test/acc': 58.528, 'best_test_test/acc_unbiased': 52.541, 'best_test_test/diff': 6.067, 'best_test_test/acc_skew': 54.812, 'best_test_test/acc_align': 50.27}
[4 / 20] Learning rate: 0.001 weight: 0.01
[4 / 20] Loss: 4.692133243500807 CE Loss: 0.5037013645120347 Con Loss: 4.6870962394305895
[4 / 20] tensor([[0.961, 0.818],
        [0.374, 0.297]]) {'epoch': 4, 'valid/acc': 69.048, 'valid/acc_unbiased': 64.168, 'valid/diff': 8.448, 'valid/acc_skew': 64.971, 'valid/acc_align': 63.366, 'test/acc': 67.739, 'test/acc_unbiased': 61.255, 'test/diff': 10.995, 'test/acc_skew': 59.594, 'test/acc_align': 62.916}
[4 / 20] best valid accuracy: 64.168 at epoch 4 
 best_stats: {'best_valid_epoch': 4, 'best_valid_valid/acc': 69.048, 'best_valid_valid/acc_unbiased': 64.168, 'best_valid_valid/diff': 8.448, 'best_valid_valid/acc_skew': 64.971, 'best_valid_valid/acc_align': 63.366, 'best_valid_test/acc': 67.739, 'best_valid_test/acc_unbiased': 61.255, 'best_valid_test/diff': 10.995, 'best_valid_test/acc_skew': 59.594, 'best_valid_test/acc_align': 62.916}
[4 / 20] best test accuracy: 61.255 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 69.048, 'best_test_valid/acc_unbiased': 64.168, 'best_test_valid/diff': 8.448, 'best_test_valid/acc_skew': 64.971, 'best_test_valid/acc_align': 63.366, 'best_test_test/acc': 67.739, 'best_test_test/acc_unbiased': 61.255, 'best_test_test/diff': 10.995, 'best_test_test/acc_skew': 59.594, 'best_test_test/acc_align': 62.916}
[5 / 20] Learning rate: 0.001 weight: 0.01
[5 / 20] Loss: 4.696878150267263 CE Loss: 0.5067741236227901 Con Loss: 4.691810421531274
[5 / 20] tensor([[0.986, 0.994],
        [0.198, 0.067]]) {'epoch': 5, 'valid/acc': 61.067, 'valid/acc_unbiased': 55.753, 'valid/diff': 6.731, 'valid/acc_skew': 59.119, 'valid/acc_align': 52.388, 'test/acc': 61.877, 'test/acc_unbiased': 56.131, 'test/diff': 7.009, 'test/acc_skew': 59.635, 'test/acc_align': 52.626}
[5 / 20] best valid accuracy: 64.168 at epoch 4 
 best_stats: {'best_valid_epoch': 4, 'best_valid_valid/acc': 69.048, 'best_valid_valid/acc_unbiased': 64.168, 'best_valid_valid/diff': 8.448, 'best_valid_valid/acc_skew': 64.971, 'best_valid_valid/acc_align': 63.366, 'best_valid_test/acc': 67.739, 'best_valid_test/acc_unbiased': 61.255, 'best_valid_test/diff': 10.995, 'best_valid_test/acc_skew': 59.594, 'best_valid_test/acc_align': 62.916}
[5 / 20] best test accuracy: 61.255 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 69.048, 'best_test_valid/acc_unbiased': 64.168, 'best_test_valid/diff': 8.448, 'best_test_valid/acc_skew': 64.971, 'best_test_valid/acc_align': 63.366, 'best_test_test/acc': 67.739, 'best_test_test/acc_unbiased': 61.255, 'best_test_test/diff': 10.995, 'best_test_test/acc_skew': 59.594, 'best_test_test/acc_align': 62.916}
[6 / 20] Learning rate: 0.001 weight: 0.01
[6 / 20] Loss: 4.634083401170486 CE Loss: 0.4904712102177526 Con Loss: 4.6291786991492145
[6 / 20] tensor([[0.993, 0.989],
        [0.141, 0.042]]) {'epoch': 6, 'valid/acc': 59.171, 'valid/acc_unbiased': 54.449, 'valid/diff': 4.0, 'valid/acc_skew': 56.068, 'valid/acc_align': 52.829, 'test/acc': 59.806, 'test/acc_unbiased': 54.129, 'test/diff': 5.153, 'test/acc_skew': 56.468, 'test/acc_align': 51.791}
[6 / 20] best valid accuracy: 64.168 at epoch 4 
 best_stats: {'best_valid_epoch': 4, 'best_valid_valid/acc': 69.048, 'best_valid_valid/acc_unbiased': 64.168, 'best_valid_valid/diff': 8.448, 'best_valid_valid/acc_skew': 64.971, 'best_valid_valid/acc_align': 63.366, 'best_valid_test/acc': 67.739, 'best_valid_test/acc_unbiased': 61.255, 'best_valid_test/diff': 10.995, 'best_valid_test/acc_skew': 59.594, 'best_valid_test/acc_align': 62.916}
[6 / 20] best test accuracy: 61.255 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 69.048, 'best_test_valid/acc_unbiased': 64.168, 'best_test_valid/diff': 8.448, 'best_test_valid/acc_skew': 64.971, 'best_test_valid/acc_align': 63.366, 'best_test_test/acc': 67.739, 'best_test_test/acc_unbiased': 61.255, 'best_test_test/diff': 10.995, 'best_test_test/acc_skew': 59.594, 'best_test_test/acc_align': 62.916}
[7 / 20] Learning rate: 0.0001 weight: 0.01
[7 / 20] Loss: 4.656288957292334 CE Loss: 0.46671872849055596 Con Loss: 4.651621794441763
[7 / 20] tensor([[0.975, 0.892],
        [0.415, 0.224]]) {'epoch': 7, 'valid/acc': 69.4, 'valid/acc_unbiased': 64.805, 'valid/diff': 7.139, 'valid/acc_skew': 65.617, 'valid/acc_align': 63.992, 'test/acc': 70.031, 'test/acc_unbiased': 62.675, 'test/diff': 13.722, 'test/acc_skew': 65.364, 'test/acc_align': 59.987}
[7 / 20] best valid accuracy: 64.805 at epoch 7 
 best_stats: {'best_valid_epoch': 7, 'best_valid_valid/acc': 69.4, 'best_valid_valid/acc_unbiased': 64.805, 'best_valid_valid/diff': 7.139, 'best_valid_valid/acc_skew': 65.617, 'best_valid_valid/acc_align': 63.992, 'best_valid_test/acc': 70.031, 'best_valid_test/acc_unbiased': 62.675, 'best_valid_test/diff': 13.722, 'best_valid_test/acc_skew': 65.364, 'best_valid_test/acc_align': 59.987}
[7 / 20] best test accuracy: 62.675 at epoch 7 
 best_stats: {'best_test_epoch': 7, 'best_test_valid/acc': 69.4, 'best_test_valid/acc_unbiased': 64.805, 'best_test_valid/diff': 7.139, 'best_test_valid/acc_skew': 65.617, 'best_test_valid/acc_align': 63.992, 'best_test_test/acc': 70.031, 'best_test_test/acc_unbiased': 62.675, 'best_test_test/diff': 13.722, 'best_test_test/acc_skew': 65.364, 'best_test_test/acc_align': 59.987}
[8 / 20] Learning rate: 0.0001 weight: 0.01
[8 / 20] Loss: 4.611608688414476 CE Loss: 0.4671687703260274 Con Loss: 4.606936985702829
[8 / 20] tensor([[0.977, 0.943],
        [0.422, 0.152]]) {'epoch': 8, 'valid/acc': 69.709, 'valid/acc_unbiased': 64.157, 'valid/diff': 10.652, 'valid/acc_skew': 69.214, 'valid/acc_align': 59.1, 'test/acc': 70.251, 'test/acc_unbiased': 62.356, 'test/diff': 15.241, 'test/acc_skew': 68.266, 'test/acc_align': 56.445}
[8 / 20] best valid accuracy: 64.805 at epoch 7 
 best_stats: {'best_valid_epoch': 7, 'best_valid_valid/acc': 69.4, 'best_valid_valid/acc_unbiased': 64.805, 'best_valid_valid/diff': 7.139, 'best_valid_valid/acc_skew': 65.617, 'best_valid_valid/acc_align': 63.992, 'best_valid_test/acc': 70.031, 'best_valid_test/acc_unbiased': 62.675, 'best_valid_test/diff': 13.722, 'best_valid_test/acc_skew': 65.364, 'best_valid_test/acc_align': 59.987}
[8 / 20] best test accuracy: 62.675 at epoch 7 
 best_stats: {'best_test_epoch': 7, 'best_test_valid/acc': 69.4, 'best_test_valid/acc_unbiased': 64.805, 'best_test_valid/diff': 7.139, 'best_test_valid/acc_skew': 65.617, 'best_test_valid/acc_align': 63.992, 'best_test_test/acc': 70.031, 'best_test_test/acc_unbiased': 62.675, 'best_test_test/diff': 13.722, 'best_test_test/acc_skew': 65.364, 'best_test_test/acc_align': 59.987}
[9 / 20] Learning rate: 0.0001 weight: 0.01
[9 / 20] Loss: 4.612058389057429 CE Loss: 0.4623266665264267 Con Loss: 4.607435142177181
[9 / 20] tensor([[0.972, 0.903],
        [0.486, 0.267]]) {'epoch': 9, 'valid/acc': 71.869, 'valid/acc_unbiased': 66.517, 'valid/diff': 10.635, 'valid/acc_skew': 68.634, 'valid/acc_align': 64.4, 'test/acc': 72.94, 'test/acc_unbiased': 65.685, 'test/diff': 14.362, 'test/acc_skew': 69.45, 'test/acc_align': 61.92}
[9 / 20] best valid accuracy: 66.517 at epoch 9 
 best_stats: {'best_valid_epoch': 9, 'best_valid_valid/acc': 71.869, 'best_valid_valid/acc_unbiased': 66.517, 'best_valid_valid/diff': 10.635, 'best_valid_valid/acc_skew': 68.634, 'best_valid_valid/acc_align': 64.4, 'best_valid_test/acc': 72.94, 'best_valid_test/acc_unbiased': 65.685, 'best_valid_test/diff': 14.362, 'best_valid_test/acc_skew': 69.45, 'best_valid_test/acc_align': 61.92}
[9 / 20] best test accuracy: 65.685 at epoch 9 
 best_stats: {'best_test_epoch': 9, 'best_test_valid/acc': 71.869, 'best_test_valid/acc_unbiased': 66.517, 'best_test_valid/diff': 10.635, 'best_test_valid/acc_skew': 68.634, 'best_test_valid/acc_align': 64.4, 'best_test_test/acc': 72.94, 'best_test_test/acc_unbiased': 65.685, 'best_test_test/diff': 14.362, 'best_test_test/acc_skew': 69.45, 'best_test_test/acc_align': 61.92}
[10 / 20] Learning rate: 0.0001 weight: 0.01
[10 / 20] Loss: 4.579778263873261 CE Loss: 0.45121953293028416 Con Loss: 4.575266063458819
[10 / 20] tensor([[0.964, 0.767],
        [0.576, 0.485]]) {'epoch': 10, 'valid/acc': 74.603, 'valid/acc_unbiased': 68.857, 'valid/diff': 12.789, 'valid/acc_skew': 66.029, 'valid/acc_align': 71.685, 'test/acc': 76.554, 'test/acc_unbiased': 69.791, 'test/diff': 14.392, 'test/acc_skew': 67.13, 'test/acc_align': 72.452}
[10 / 20] best valid accuracy: 68.857 at epoch 10 
 best_stats: {'best_valid_epoch': 10, 'best_valid_valid/acc': 74.603, 'best_valid_valid/acc_unbiased': 68.857, 'best_valid_valid/diff': 12.789, 'best_valid_valid/acc_skew': 66.029, 'best_valid_valid/acc_align': 71.685, 'best_valid_test/acc': 76.554, 'best_valid_test/acc_unbiased': 69.791, 'best_valid_test/diff': 14.392, 'best_valid_test/acc_skew': 67.13, 'best_valid_test/acc_align': 72.452}
[10 / 20] best test accuracy: 69.791 at epoch 10 
 best_stats: {'best_test_epoch': 10, 'best_test_valid/acc': 74.603, 'best_test_valid/acc_unbiased': 68.857, 'best_test_valid/diff': 12.789, 'best_test_valid/acc_skew': 66.029, 'best_test_valid/acc_align': 71.685, 'best_test_test/acc': 76.554, 'best_test_test/acc_unbiased': 69.791, 'best_test_test/diff': 14.392, 'best_test_test/acc_skew': 67.13, 'best_test_test/acc_align': 72.452}
[11 / 20] Learning rate: 0.0001 weight: 0.01
[11 / 20] Loss: 4.5304759785014115 CE Loss: 0.441014561055975 Con Loss: 4.526065836770398
[11 / 20] tensor([[0.961, 0.801],
        [0.554, 0.442]]) {'epoch': 11, 'valid/acc': 74.295, 'valid/acc_unbiased': 69.046, 'valid/diff': 11.08, 'valid/acc_skew': 66.854, 'valid/acc_align': 71.238, 'test/acc': 75.54, 'test/acc_unbiased': 68.964, 'test/diff': 13.571, 'test/acc_skew': 67.738, 'test/acc_align': 70.189}
[11 / 20] best valid accuracy: 69.046 at epoch 11 
 best_stats: {'best_valid_epoch': 11, 'best_valid_valid/acc': 74.295, 'best_valid_valid/acc_unbiased': 69.046, 'best_valid_valid/diff': 11.08, 'best_valid_valid/acc_skew': 66.854, 'best_valid_valid/acc_align': 71.238, 'best_valid_test/acc': 75.54, 'best_valid_test/acc_unbiased': 68.964, 'best_valid_test/diff': 13.571, 'best_valid_test/acc_skew': 67.738, 'best_valid_test/acc_align': 70.189}
[11 / 20] best test accuracy: 69.791 at epoch 10 
 best_stats: {'best_test_epoch': 10, 'best_test_valid/acc': 74.603, 'best_test_valid/acc_unbiased': 68.857, 'best_test_valid/diff': 12.789, 'best_test_valid/acc_skew': 66.029, 'best_test_valid/acc_align': 71.685, 'best_test_test/acc': 76.554, 'best_test_test/acc_unbiased': 69.791, 'best_test_test/diff': 14.392, 'best_test_test/acc_skew': 67.13, 'best_test_test/acc_align': 72.452}
[12 / 20] Learning rate: 0.0001 weight: 0.01
[12 / 20] Loss: 4.54897369529727 CE Loss: 0.43653300310823634 Con Loss: 4.544608386613509
[12 / 20] tensor([[0.959, 0.716],
        [0.595, 0.527]]) {'epoch': 12, 'valid/acc': 75.794, 'valid/acc_unbiased': 70.371, 'valid/diff': 11.998, 'valid/acc_skew': 65.048, 'valid/acc_align': 75.694, 'test/acc': 76.95, 'test/acc_unbiased': 69.922, 'test/diff': 15.525, 'test/acc_skew': 65.553, 'test/acc_align': 74.29}
[12 / 20] best valid accuracy: 70.371 at epoch 12 
 best_stats: {'best_valid_epoch': 12, 'best_valid_valid/acc': 75.794, 'best_valid_valid/acc_unbiased': 70.371, 'best_valid_valid/diff': 11.998, 'best_valid_valid/acc_skew': 65.048, 'best_valid_valid/acc_align': 75.694, 'best_valid_test/acc': 76.95, 'best_valid_test/acc_unbiased': 69.922, 'best_valid_test/diff': 15.525, 'best_valid_test/acc_skew': 65.553, 'best_valid_test/acc_align': 74.29}
[12 / 20] best test accuracy: 69.922 at epoch 12 
 best_stats: {'best_test_epoch': 12, 'best_test_valid/acc': 75.794, 'best_test_valid/acc_unbiased': 70.371, 'best_test_valid/diff': 11.998, 'best_test_valid/acc_skew': 65.048, 'best_test_valid/acc_align': 75.694, 'best_test_test/acc': 76.95, 'best_test_test/acc_unbiased': 69.922, 'best_test_test/diff': 15.525, 'best_test_test/acc_skew': 65.553, 'best_test_test/acc_align': 74.29}
[13 / 20] Learning rate: 0.0001 weight: 0.01
[13 / 20] Loss: 4.543826198363652 CE Loss: 0.4263832982962875 Con Loss: 4.539562364947434
[13 / 20] tensor([[0.963, 0.670],
        [0.570, 0.576]]) {'epoch': 13, 'valid/acc': 75.132, 'valid/acc_unbiased': 69.465, 'valid/diff': 15.709, 'valid/acc_skew': 61.611, 'valid/acc_align': 77.32, 'test/acc': 76.201, 'test/acc_unbiased': 69.481, 'test/diff': 14.938, 'test/acc_skew': 62.012, 'test/acc_align': 76.95}
[13 / 20] best valid accuracy: 70.371 at epoch 12 
 best_stats: {'best_valid_epoch': 12, 'best_valid_valid/acc': 75.794, 'best_valid_valid/acc_unbiased': 70.371, 'best_valid_valid/diff': 11.998, 'best_valid_valid/acc_skew': 65.048, 'best_valid_valid/acc_align': 75.694, 'best_valid_test/acc': 76.95, 'best_valid_test/acc_unbiased': 69.922, 'best_valid_test/diff': 15.525, 'best_valid_test/acc_skew': 65.553, 'best_valid_test/acc_align': 74.29}
[13 / 20] best test accuracy: 69.922 at epoch 12 
 best_stats: {'best_test_epoch': 12, 'best_test_valid/acc': 75.794, 'best_test_valid/acc_unbiased': 70.371, 'best_test_valid/diff': 11.998, 'best_test_valid/acc_skew': 65.048, 'best_test_valid/acc_align': 75.694, 'best_test_test/acc': 76.95, 'best_test_test/acc_unbiased': 69.922, 'best_test_test/diff': 15.525, 'best_test_test/acc_skew': 65.553, 'best_test_test/acc_align': 74.29}
[14 / 20] Learning rate: 1e-05 weight: 0.01
[14 / 20] Loss: 4.521178429066934 CE Loss: 0.42097698158202035 Con Loss: 4.516968635350566
[14 / 20] tensor([[0.968, 0.756],
        [0.549, 0.491]]) {'epoch': 14, 'valid/acc': 75.044, 'valid/acc_unbiased': 70.323, 'valid/diff': 9.215, 'valid/acc_skew': 66.104, 'valid/acc_align': 74.543, 'test/acc': 75.672, 'test/acc_unbiased': 69.089, 'test/diff': 13.519, 'test/acc_skew': 65.235, 'test/acc_align': 72.943}
[14 / 20] best valid accuracy: 70.371 at epoch 12 
 best_stats: {'best_valid_epoch': 12, 'best_valid_valid/acc': 75.794, 'best_valid_valid/acc_unbiased': 70.371, 'best_valid_valid/diff': 11.998, 'best_valid_valid/acc_skew': 65.048, 'best_valid_valid/acc_align': 75.694, 'best_valid_test/acc': 76.95, 'best_valid_test/acc_unbiased': 69.922, 'best_valid_test/diff': 15.525, 'best_valid_test/acc_skew': 65.553, 'best_valid_test/acc_align': 74.29}
[14 / 20] best test accuracy: 69.922 at epoch 12 
 best_stats: {'best_test_epoch': 12, 'best_test_valid/acc': 75.794, 'best_test_valid/acc_unbiased': 70.371, 'best_test_valid/diff': 11.998, 'best_test_valid/acc_skew': 65.048, 'best_test_valid/acc_align': 75.694, 'best_test_test/acc': 76.95, 'best_test_test/acc_unbiased': 69.922, 'best_test_test/diff': 15.525, 'best_test_test/acc_skew': 65.553, 'best_test_test/acc_align': 74.29}
[15 / 20] Learning rate: 1e-05 weight: 0.01
[15 / 20] Loss: 4.522675168777575 CE Loss: 0.42987590652197677 Con Loss: 4.518376403602934
[15 / 20] tensor([[0.964, 0.722],
        [0.584, 0.527]]) {'epoch': 15, 'valid/acc': 76.19, 'valid/acc_unbiased': 71.025, 'valid/diff': 11.219, 'valid/acc_skew': 66.705, 'valid/acc_align': 75.344, 'test/acc': 76.818, 'test/acc_unbiased': 69.917, 'test/diff': 14.947, 'test/acc_skew': 65.261, 'test/acc_align': 74.573}
[15 / 20] best valid accuracy: 71.025 at epoch 15 
 best_stats: {'best_valid_epoch': 15, 'best_valid_valid/acc': 76.19, 'best_valid_valid/acc_unbiased': 71.025, 'best_valid_valid/diff': 11.219, 'best_valid_valid/acc_skew': 66.705, 'best_valid_valid/acc_align': 75.344, 'best_valid_test/acc': 76.818, 'best_valid_test/acc_unbiased': 69.917, 'best_valid_test/diff': 14.947, 'best_valid_test/acc_skew': 65.261, 'best_valid_test/acc_align': 74.573}
[15 / 20] best test accuracy: 69.922 at epoch 12 
 best_stats: {'best_test_epoch': 12, 'best_test_valid/acc': 75.794, 'best_test_valid/acc_unbiased': 70.371, 'best_test_valid/diff': 11.998, 'best_test_valid/acc_skew': 65.048, 'best_test_valid/acc_align': 75.694, 'best_test_test/acc': 76.95, 'best_test_test/acc_unbiased': 69.922, 'best_test_test/diff': 15.525, 'best_test_test/acc_skew': 65.553, 'best_test_test/acc_align': 74.29}
[16 / 20] Learning rate: 1e-05 weight: 0.01
[16 / 20] Loss: 4.470935707634998 CE Loss: 0.43060429119206867 Con Loss: 4.466629653510776
[16 / 20] tensor([[0.962, 0.739],
        [0.597, 0.521]]) {'epoch': 16, 'valid/acc': 76.455, 'valid/acc_unbiased': 71.707, 'valid/diff': 10.038, 'valid/acc_skew': 67.969, 'valid/acc_align': 75.446, 'test/acc': 77.347, 'test/acc_unbiased': 70.49, 'test/diff': 14.996, 'test/acc_skew': 66.805, 'test/acc_align': 74.176}
[16 / 20] best valid accuracy: 71.707 at epoch 16 
 best_stats: {'best_valid_epoch': 16, 'best_valid_valid/acc': 76.455, 'best_valid_valid/acc_unbiased': 71.707, 'best_valid_valid/diff': 10.038, 'best_valid_valid/acc_skew': 67.969, 'best_valid_valid/acc_align': 75.446, 'best_valid_test/acc': 77.347, 'best_valid_test/acc_unbiased': 70.49, 'best_valid_test/diff': 14.996, 'best_valid_test/acc_skew': 66.805, 'best_valid_test/acc_align': 74.176}
[16 / 20] best test accuracy: 70.490 at epoch 16 
 best_stats: {'best_test_epoch': 16, 'best_test_valid/acc': 76.455, 'best_test_valid/acc_unbiased': 71.707, 'best_test_valid/diff': 10.038, 'best_test_valid/acc_skew': 67.969, 'best_test_valid/acc_align': 75.446, 'best_test_test/acc': 77.347, 'best_test_test/acc_unbiased': 70.49, 'best_test_test/diff': 14.996, 'best_test_test/acc_skew': 66.805, 'best_test_test/acc_align': 74.176}
[17 / 20] Learning rate: 1e-05 weight: 0.01
[17 / 20] Loss: 4.490283495475629 CE Loss: 0.435810262502601 Con Loss: 4.485925405938632
[17 / 20] tensor([[0.960, 0.676],
        [0.611, 0.558]]) {'epoch': 17, 'valid/acc': 76.367, 'valid/acc_unbiased': 71.141, 'valid/diff': 11.784, 'valid/acc_skew': 65.249, 'valid/acc_align': 77.033, 'test/acc': 77.567, 'test/acc_unbiased': 70.136, 'test/diff': 16.9, 'test/acc_skew': 64.372, 'test/acc_align': 75.9}
[17 / 20] best valid accuracy: 71.707 at epoch 16 
 best_stats: {'best_valid_epoch': 16, 'best_valid_valid/acc': 76.455, 'best_valid_valid/acc_unbiased': 71.707, 'best_valid_valid/diff': 10.038, 'best_valid_valid/acc_skew': 67.969, 'best_valid_valid/acc_align': 75.446, 'best_valid_test/acc': 77.347, 'best_valid_test/acc_unbiased': 70.49, 'best_valid_test/diff': 14.996, 'best_valid_test/acc_skew': 66.805, 'best_valid_test/acc_align': 74.176}
[17 / 20] best test accuracy: 70.490 at epoch 16 
 best_stats: {'best_test_epoch': 16, 'best_test_valid/acc': 76.455, 'best_test_valid/acc_unbiased': 71.707, 'best_test_valid/diff': 10.038, 'best_test_valid/acc_skew': 67.969, 'best_test_valid/acc_align': 75.446, 'best_test_test/acc': 77.347, 'best_test_test/acc_unbiased': 70.49, 'best_test_test/diff': 14.996, 'best_test_test/acc_skew': 66.805, 'best_test_test/acc_align': 74.176}
[18 / 20] Learning rate: 1e-05 weight: 0.01
[18 / 20] Loss: 4.497205940626481 CE Loss: 0.4289550218118884 Con Loss: 4.492916375320532
[18 / 20] tensor([[0.966, 0.750],
        [0.571, 0.509]]) {'epoch': 18, 'valid/acc': 75.838, 'valid/acc_unbiased': 70.755, 'valid/diff': 10.698, 'valid/acc_skew': 65.676, 'valid/acc_align': 75.834, 'test/acc': 76.509, 'test/acc_unbiased': 69.902, 'test/diff': 13.896, 'test/acc_skew': 66.047, 'test/acc_align': 73.758}
[18 / 20] best valid accuracy: 71.707 at epoch 16 
 best_stats: {'best_valid_epoch': 16, 'best_valid_valid/acc': 76.455, 'best_valid_valid/acc_unbiased': 71.707, 'best_valid_valid/diff': 10.038, 'best_valid_valid/acc_skew': 67.969, 'best_valid_valid/acc_align': 75.446, 'best_valid_test/acc': 77.347, 'best_valid_test/acc_unbiased': 70.49, 'best_valid_test/diff': 14.996, 'best_valid_test/acc_skew': 66.805, 'best_valid_test/acc_align': 74.176}
[18 / 20] best test accuracy: 70.490 at epoch 16 
 best_stats: {'best_test_epoch': 16, 'best_test_valid/acc': 76.455, 'best_test_valid/acc_unbiased': 71.707, 'best_test_valid/diff': 10.038, 'best_test_valid/acc_skew': 67.969, 'best_test_valid/acc_align': 75.446, 'best_test_test/acc': 77.347, 'best_test_test/acc_unbiased': 70.49, 'best_test_test/diff': 14.996, 'best_test_test/acc_skew': 66.805, 'best_test_test/acc_align': 74.176}
[19 / 20] Learning rate: 1e-05 weight: 0.01
[19 / 20] Loss: 4.509041645874115 CE Loss: 0.42743753197486817 Con Loss: 4.5047672836577926
[19 / 20] tensor([[0.960, 0.653],
        [0.611, 0.618]]) {'epoch': 19, 'valid/acc': 76.323, 'valid/acc_unbiased': 70.673, 'valid/diff': 15.583, 'valid/acc_skew': 62.881, 'valid/acc_align': 78.465, 'test/acc': 77.832, 'test/acc_unbiased': 71.083, 'test/diff': 15.694, 'test/acc_skew': 63.236, 'test/acc_align': 78.93}
[19 / 20] best valid accuracy: 71.707 at epoch 16 
 best_stats: {'best_valid_epoch': 16, 'best_valid_valid/acc': 76.455, 'best_valid_valid/acc_unbiased': 71.707, 'best_valid_valid/diff': 10.038, 'best_valid_valid/acc_skew': 67.969, 'best_valid_valid/acc_align': 75.446, 'best_valid_test/acc': 77.347, 'best_valid_test/acc_unbiased': 70.49, 'best_valid_test/diff': 14.996, 'best_valid_test/acc_skew': 66.805, 'best_valid_test/acc_align': 74.176}
[19 / 20] best test accuracy: 71.083 at epoch 19 
 best_stats: {'best_test_epoch': 19, 'best_test_valid/acc': 76.323, 'best_test_valid/acc_unbiased': 70.673, 'best_test_valid/diff': 15.583, 'best_test_valid/acc_skew': 62.881, 'best_test_valid/acc_align': 78.465, 'best_test_test/acc': 77.832, 'best_test_test/acc_unbiased': 71.083, 'best_test_test/diff': 15.694, 'best_test_test/acc_skew': 63.236, 'best_test_test/acc_align': 78.93}
[20 / 20] Learning rate: 1e-05 weight: 0.01
[20 / 20] Loss: 4.501087588614089 CE Loss: 0.4216336357441791 Con Loss: 4.496871235575046
[20 / 20] tensor([[0.959, 0.665],
        [0.616, 0.570]]) {'epoch': 20, 'valid/acc': 76.499, 'valid/acc_unbiased': 70.919, 'valid/diff': 12.917, 'valid/acc_skew': 64.461, 'valid/acc_align': 77.378, 'test/acc': 77.699, 'test/acc_unbiased': 70.246, 'test/diff': 17.046, 'test/acc_skew': 64.034, 'test/acc_align': 76.458}
[20 / 20] best valid accuracy: 71.707 at epoch 16 
 best_stats: {'best_valid_epoch': 16, 'best_valid_valid/acc': 76.455, 'best_valid_valid/acc_unbiased': 71.707, 'best_valid_valid/diff': 10.038, 'best_valid_valid/acc_skew': 67.969, 'best_valid_valid/acc_align': 75.446, 'best_valid_test/acc': 77.347, 'best_valid_test/acc_unbiased': 70.49, 'best_valid_test/diff': 14.996, 'best_valid_test/acc_skew': 66.805, 'best_valid_test/acc_align': 74.176}
[20 / 20] best test accuracy: 71.083 at epoch 19 
 best_stats: {'best_test_epoch': 19, 'best_test_valid/acc': 76.323, 'best_test_valid/acc_unbiased': 70.673, 'best_test_valid/diff': 15.583, 'best_test_valid/acc_skew': 62.881, 'best_test_valid/acc_align': 78.465, 'best_test_test/acc': 77.832, 'best_test_test/acc_unbiased': 71.083, 'best_test_test/diff': 15.694, 'best_test_test/acc_skew': 63.236, 'best_test_test/acc_align': 78.93}
Total training time: 0:17:39
