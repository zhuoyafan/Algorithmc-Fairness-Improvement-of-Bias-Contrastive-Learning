Log level set to: INFO
Set seed: 1
=======> Using Fixed Random Seed: 1 <========
save_path: exp_results/bc-bb0-celeba_blonde-os_0.9_trivial-lr0.001-bs128-cbs64-w0.01-ratio30-aug1-seed1
get_celeba - split:train, aug: False, given_y: True, ratio: 0
use existing blonde indices from data/celeba/pickles/blonde
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [48219, 48219]
Target 1: [48219, 48219]
Binary Target 1
---------------------------
Target 0: [48219, 48219]
Target 1: [48219, 48219]
===================================
Normal Label Distribution: 
Target 0: [48219, 48219]
Target 1: [48219, 48219]
===================================
Use BiasedCelebASplit 
 target_attr: blonde split: train 
 tensor([[48219., 48219.],
        [48219., 48219.]])
get_celeba - split:train, aug: 1, given_y: True, ratio: 30
use existing blonde indices from data/celeba/pickles/blonde
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [48082, 48082]
Target 1: [48082, 48082]
Binary Target 1
---------------------------
Target 0: [48082, 48082]
Target 1: [48082, 48082]
===================================
Normal Label Distribution: 
Target 0: [48082, 48082]
Target 1: [48082, 48082]
===================================
Use BiasedCelebASplit 
 target_attr: blonde split: train 
 tensor([[48082., 48082.],
        [48082., 48082.]])
get_celeba - split:train_valid, aug: False, given_y: True, ratio: 0
use existing blonde indices from data/celeba/pickles/blonde
Use BiasedCelebASplit 
 target_attr: blonde split: train_valid 
 tensor([[  390.,  4598.],
        [13361.,   280.]])
get_celeba - split:valid, aug: False, given_y: True, ratio: 0
Use BiasedCelebASplit 
 target_attr: blonde split: valid 
 tensor([[8535., 2874.],
        [8276.,  182.]])
decay_epochs: [3, 6]
[1 / 10] Learning rate: 0.001 weight: 0.01
[1 / 10] Loss: 4.6313971651864 CE Loss: 0.2332745558340642 Con Loss: 4.629064418721761
[1 / 10] tensor([[0.895, 0.940],
        [0.937, 0.912]]) {'epoch': 1, 'valid/acc': 93.312, 'valid/acc_unbiased': 92.339, 'valid/diff': 3.817, 'valid/acc_skew': 94.247, 'valid/acc_align': 90.431, 'test/acc': 92.002, 'test/acc_unbiased': 92.099, 'test/diff': 3.452, 'test/acc_skew': 91.602, 'test/acc_align': 92.596}
[1 / 10] best valid accuracy: 92.339 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 93.312, 'best_valid_valid/acc_unbiased': 92.339, 'best_valid_valid/diff': 3.817, 'best_valid_valid/acc_skew': 94.247, 'best_valid_valid/acc_align': 90.431, 'best_valid_test/acc': 92.002, 'best_valid_test/acc_unbiased': 92.099, 'best_valid_test/diff': 3.452, 'best_valid_test/acc_skew': 91.602, 'best_valid_test/acc_align': 92.596}
[1 / 10] best test accuracy: 92.099 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 93.312, 'best_test_valid/acc_unbiased': 92.339, 'best_test_valid/diff': 3.817, 'best_test_valid/acc_skew': 94.247, 'best_test_valid/acc_align': 90.431, 'best_test_test/acc': 92.002, 'best_test_test/acc_unbiased': 92.099, 'best_test_test/diff': 3.452, 'best_test_test/acc_skew': 91.602, 'best_test_test/acc_align': 92.596}
[2 / 10] Learning rate: 0.001 weight: 0.01
[2 / 10] Loss: 4.588334281861024 CE Loss: 0.2017242795502265 Con Loss: 4.586317036725893
[2 / 10] tensor([[0.823, 0.894],
        [0.974, 0.984]]) {'epoch': 2, 'valid/acc': 91.588, 'valid/acc_unbiased': 92.759, 'valid/diff': 1.659, 'valid/acc_skew': 93.589, 'valid/acc_align': 91.93, 'test/acc': 87.577, 'test/acc_unbiased': 91.848, 'test/diff': 4.01, 'test/acc_skew': 89.844, 'test/acc_align': 93.853}
[2 / 10] best valid accuracy: 92.759 at epoch 2 
 best_stats: {'best_valid_epoch': 2, 'best_valid_valid/acc': 91.588, 'best_valid_valid/acc_unbiased': 92.759, 'best_valid_valid/diff': 1.659, 'best_valid_valid/acc_skew': 93.589, 'best_valid_valid/acc_align': 91.93, 'best_valid_test/acc': 87.577, 'best_valid_test/acc_unbiased': 91.848, 'best_valid_test/diff': 4.01, 'best_valid_test/acc_skew': 89.844, 'best_valid_test/acc_align': 93.853}
[2 / 10] best test accuracy: 92.099 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 93.312, 'best_test_valid/acc_unbiased': 92.339, 'best_test_valid/diff': 3.817, 'best_test_valid/acc_skew': 94.247, 'best_test_valid/acc_align': 90.431, 'best_test_test/acc': 92.002, 'best_test_test/acc_unbiased': 92.099, 'best_test_test/diff': 3.452, 'best_test_test/acc_skew': 91.602, 'best_test_test/acc_align': 92.596}
[3 / 10] Learning rate: 0.001 weight: 0.01
[3 / 10] Loss: 4.566332204771219 CE Loss: 0.1868864288612891 Con Loss: 4.56446333852579
[3 / 10] tensor([[0.903, 0.960],
        [0.923, 0.863]]) {'epoch': 3, 'valid/acc': 94.594, 'valid/acc_unbiased': 92.785, 'valid/diff': 3.245, 'valid/acc_skew': 94.408, 'valid/acc_align': 91.162, 'test/acc': 92.928, 'test/acc_unbiased': 91.213, 'test/diff': 5.875, 'test/acc_skew': 91.281, 'test/acc_align': 91.144}
[3 / 10] best valid accuracy: 92.785 at epoch 3 
 best_stats: {'best_valid_epoch': 3, 'best_valid_valid/acc': 94.594, 'best_valid_valid/acc_unbiased': 92.785, 'best_valid_valid/diff': 3.245, 'best_valid_valid/acc_skew': 94.408, 'best_valid_valid/acc_align': 91.162, 'best_valid_test/acc': 92.928, 'best_valid_test/acc_unbiased': 91.213, 'best_valid_test/diff': 5.875, 'best_valid_test/acc_skew': 91.281, 'best_valid_test/acc_align': 91.144}
[3 / 10] best test accuracy: 92.099 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 93.312, 'best_test_valid/acc_unbiased': 92.339, 'best_test_valid/diff': 3.817, 'best_test_valid/acc_skew': 94.247, 'best_test_valid/acc_align': 90.431, 'best_test_test/acc': 92.002, 'best_test_test/acc_unbiased': 92.099, 'best_test_test/diff': 3.452, 'best_test_test/acc_skew': 91.602, 'best_test_test/acc_align': 92.596}
[4 / 10] Learning rate: 0.0001 weight: 0.01
[4 / 10] Loss: 4.499784465292893 CE Loss: 0.1477951964361872 Con Loss: 4.498306512066245
[4 / 10] tensor([[0.857, 0.941],
        [0.965, 0.918]]) {'epoch': 4, 'valid/acc': 94.498, 'valid/acc_unbiased': 95.666, 'valid/diff': 2.055, 'valid/acc_skew': 96.694, 'valid/acc_align': 94.639, 'test/acc': 90.819, 'test/acc_unbiased': 92.013, 'test/diff': 6.563, 'test/acc_skew': 91.096, 'test/acc_align': 92.931}
[4 / 10] best valid accuracy: 95.666 at epoch 4 
 best_stats: {'best_valid_epoch': 4, 'best_valid_valid/acc': 94.498, 'best_valid_valid/acc_unbiased': 95.666, 'best_valid_valid/diff': 2.055, 'best_valid_valid/acc_skew': 96.694, 'best_valid_valid/acc_align': 94.639, 'best_valid_test/acc': 90.819, 'best_valid_test/acc_unbiased': 92.013, 'best_valid_test/diff': 6.563, 'best_valid_test/acc_skew': 91.096, 'best_valid_test/acc_align': 92.931}
[4 / 10] best test accuracy: 92.099 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 93.312, 'best_test_valid/acc_unbiased': 92.339, 'best_test_valid/diff': 3.817, 'best_test_valid/acc_skew': 94.247, 'best_test_valid/acc_align': 90.431, 'best_test_test/acc': 92.002, 'best_test_test/acc_unbiased': 92.099, 'best_test_test/diff': 3.452, 'best_test_test/acc_skew': 91.602, 'best_test_test/acc_align': 92.596}
[5 / 10] Learning rate: 0.0001 weight: 0.01
[5 / 10] Loss: 4.469849901372003 CE Loss: 0.1356104122178004 Con Loss: 4.468493794294253
[5 / 10] tensor([[0.857, 0.944],
        [0.964, 0.912]]) {'epoch': 5, 'valid/acc': 94.836, 'valid/acc_unbiased': 95.975, 'valid/diff': 1.82, 'valid/acc_skew': 96.885, 'valid/acc_align': 95.064, 'test/acc': 90.915, 'test/acc_unbiased': 91.925, 'test/diff': 6.959, 'test/acc_skew': 91.049, 'test/acc_align': 92.801}
[5 / 10] best valid accuracy: 95.975 at epoch 5 
 best_stats: {'best_valid_epoch': 5, 'best_valid_valid/acc': 94.836, 'best_valid_valid/acc_unbiased': 95.975, 'best_valid_valid/diff': 1.82, 'best_valid_valid/acc_skew': 96.885, 'best_valid_valid/acc_align': 95.064, 'best_valid_test/acc': 90.915, 'best_valid_test/acc_unbiased': 91.925, 'best_valid_test/diff': 6.959, 'best_valid_test/acc_skew': 91.049, 'best_valid_test/acc_align': 92.801}
[5 / 10] best test accuracy: 92.099 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 93.312, 'best_test_valid/acc_unbiased': 92.339, 'best_test_valid/diff': 3.817, 'best_test_valid/acc_skew': 94.247, 'best_test_valid/acc_align': 90.431, 'best_test_test/acc': 92.002, 'best_test_test/acc_unbiased': 92.099, 'best_test_test/diff': 3.452, 'best_test_test/acc_skew': 91.602, 'best_test_test/acc_align': 92.596}
[6 / 10] Learning rate: 0.0001 weight: 0.01
[6 / 10] Loss: 4.455012615333364 CE Loss: 0.12655129633118758 Con Loss: 4.453747098474916
[6 / 10] tensor([[0.853, 0.949],
        [0.965, 0.879]]) {'epoch': 6, 'valid/acc': 95.357, 'valid/acc_unbiased': 96.381, 'valid/diff': 1.721, 'valid/acc_skew': 97.241, 'valid/acc_align': 95.52, 'test/acc': 90.94, 'test/acc_unbiased': 91.149, 'test/diff': 9.101, 'test/acc_skew': 90.885, 'test/acc_align': 91.413}
[6 / 10] best valid accuracy: 96.381 at epoch 6 
 best_stats: {'best_valid_epoch': 6, 'best_valid_valid/acc': 95.357, 'best_valid_valid/acc_unbiased': 96.381, 'best_valid_valid/diff': 1.721, 'best_valid_valid/acc_skew': 97.241, 'best_valid_valid/acc_align': 95.52, 'best_valid_test/acc': 90.94, 'best_valid_test/acc_unbiased': 91.149, 'best_valid_test/diff': 9.101, 'best_valid_test/acc_skew': 90.885, 'best_valid_test/acc_align': 91.413}
[6 / 10] best test accuracy: 92.099 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 93.312, 'best_test_valid/acc_unbiased': 92.339, 'best_test_valid/diff': 3.817, 'best_test_valid/acc_skew': 94.247, 'best_test_valid/acc_align': 90.431, 'best_test_test/acc': 92.002, 'best_test_test/acc_unbiased': 92.099, 'best_test_test/diff': 3.452, 'best_test_test/acc_skew': 91.602, 'best_test_test/acc_align': 92.596}
[7 / 10] Learning rate: 1e-05 weight: 0.01
[7 / 10] Loss: 4.446452883016282 CE Loss: 0.12004312973120831 Con Loss: 4.445252456294004
[7 / 10] tensor([[0.861, 0.953],
        [0.961, 0.890]]) {'epoch': 7, 'valid/acc': 95.486, 'valid/acc_unbiased': 96.42, 'valid/diff': 1.895, 'valid/acc_skew': 97.367, 'valid/acc_align': 95.472, 'test/acc': 91.413, 'test/acc_unbiased': 91.638, 'test/diff': 8.185, 'test/acc_skew': 91.109, 'test/acc_align': 92.167}
[7 / 10] best valid accuracy: 96.420 at epoch 7 
 best_stats: {'best_valid_epoch': 7, 'best_valid_valid/acc': 95.486, 'best_valid_valid/acc_unbiased': 96.42, 'best_valid_valid/diff': 1.895, 'best_valid_valid/acc_skew': 97.367, 'best_valid_valid/acc_align': 95.472, 'best_valid_test/acc': 91.413, 'best_valid_test/acc_unbiased': 91.638, 'best_valid_test/diff': 8.185, 'best_valid_test/acc_skew': 91.109, 'best_valid_test/acc_align': 92.167}
[7 / 10] best test accuracy: 92.099 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 93.312, 'best_test_valid/acc_unbiased': 92.339, 'best_test_valid/diff': 3.817, 'best_test_valid/acc_skew': 94.247, 'best_test_valid/acc_align': 90.431, 'best_test_test/acc': 92.002, 'best_test_test/acc_unbiased': 92.099, 'best_test_test/diff': 3.452, 'best_test_test/acc_skew': 91.602, 'best_test_test/acc_align': 92.596}
[8 / 10] Learning rate: 1e-05 weight: 0.01
[8 / 10] Loss: 4.440000666332733 CE Loss: 0.11782147421273724 Con Loss: 4.438822445710925
[8 / 10] tensor([[0.853, 0.952],
        [0.966, 0.874]]) {'epoch': 8, 'valid/acc': 95.448, 'valid/acc_unbiased': 96.221, 'valid/diff': 2.636, 'valid/acc_skew': 97.539, 'valid/acc_align': 94.903, 'test/acc': 91.05, 'test/acc_unbiased': 91.092, 'test/diff': 9.55, 'test/acc_skew': 90.914, 'test/acc_align': 91.271}
[8 / 10] best valid accuracy: 96.420 at epoch 7 
 best_stats: {'best_valid_epoch': 7, 'best_valid_valid/acc': 95.486, 'best_valid_valid/acc_unbiased': 96.42, 'best_valid_valid/diff': 1.895, 'best_valid_valid/acc_skew': 97.367, 'best_valid_valid/acc_align': 95.472, 'best_valid_test/acc': 91.413, 'best_valid_test/acc_unbiased': 91.638, 'best_valid_test/diff': 8.185, 'best_valid_test/acc_skew': 91.109, 'best_valid_test/acc_align': 92.167}
[8 / 10] best test accuracy: 92.099 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 93.312, 'best_test_valid/acc_unbiased': 92.339, 'best_test_valid/diff': 3.817, 'best_test_valid/acc_skew': 94.247, 'best_test_valid/acc_align': 90.431, 'best_test_test/acc': 92.002, 'best_test_test/acc_unbiased': 92.099, 'best_test_test/diff': 3.452, 'best_test_test/acc_skew': 91.602, 'best_test_test/acc_align': 92.596}
[9 / 10] Learning rate: 1e-05 weight: 0.01
[9 / 10] Loss: 4.432652600256213 CE Loss: 0.1169378044808276 Con Loss: 4.431483230457517
[9 / 10] tensor([[0.845, 0.948],
        [0.967, 0.896]]) {'epoch': 9, 'valid/acc': 95.292, 'valid/acc_unbiased': 96.468, 'valid/diff': 2.381, 'valid/acc_skew': 97.659, 'valid/acc_align': 95.278, 'test/acc': 90.623, 'test/acc_unbiased': 91.407, 'test/diff': 8.731, 'test/acc_skew': 90.626, 'test/acc_align': 92.188}
[9 / 10] best valid accuracy: 96.468 at epoch 9 
 best_stats: {'best_valid_epoch': 9, 'best_valid_valid/acc': 95.292, 'best_valid_valid/acc_unbiased': 96.468, 'best_valid_valid/diff': 2.381, 'best_valid_valid/acc_skew': 97.659, 'best_valid_valid/acc_align': 95.278, 'best_valid_test/acc': 90.623, 'best_valid_test/acc_unbiased': 91.407, 'best_valid_test/diff': 8.731, 'best_valid_test/acc_skew': 90.626, 'best_valid_test/acc_align': 92.188}
[9 / 10] best test accuracy: 92.099 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 93.312, 'best_test_valid/acc_unbiased': 92.339, 'best_test_valid/diff': 3.817, 'best_test_valid/acc_skew': 94.247, 'best_test_valid/acc_align': 90.431, 'best_test_test/acc': 92.002, 'best_test_test/acc_unbiased': 92.099, 'best_test_test/diff': 3.452, 'best_test_test/acc_skew': 91.602, 'best_test_test/acc_align': 92.596}
[10 / 10] Learning rate: 1e-05 weight: 0.01
[10 / 10] Loss: 4.432661516682877 CE Loss: 0.11518182017620048 Con Loss: 4.431509698712224
[10 / 10] tensor([[0.840, 0.945],
        [0.970, 0.907]]) {'epoch': 10, 'valid/acc': 95.131, 'valid/acc_unbiased': 96.368, 'valid/diff': 2.434, 'valid/acc_skew': 97.585, 'valid/acc_align': 95.15, 'test/acc': 90.316, 'test/acc_unbiased': 91.541, 'test/diff': 8.404, 'test/acc_skew': 90.513, 'test/acc_align': 92.569}
[10 / 10] best valid accuracy: 96.468 at epoch 9 
 best_stats: {'best_valid_epoch': 9, 'best_valid_valid/acc': 95.292, 'best_valid_valid/acc_unbiased': 96.468, 'best_valid_valid/diff': 2.381, 'best_valid_valid/acc_skew': 97.659, 'best_valid_valid/acc_align': 95.278, 'best_valid_test/acc': 90.623, 'best_valid_test/acc_unbiased': 91.407, 'best_valid_test/diff': 8.731, 'best_valid_test/acc_skew': 90.626, 'best_valid_test/acc_align': 92.188}
[10 / 10] best test accuracy: 92.099 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 93.312, 'best_test_valid/acc_unbiased': 92.339, 'best_test_valid/diff': 3.817, 'best_test_valid/acc_skew': 94.247, 'best_test_valid/acc_align': 90.431, 'best_test_test/acc': 92.002, 'best_test_test/acc_unbiased': 92.099, 'best_test_test/diff': 3.452, 'best_test_test/acc_skew': 91.602, 'best_test_test/acc_align': 92.596}
Total training time: 2:13:42
