Log level set to: INFO
Set seed: 3
=======> Using Fixed Random Seed: 3 <========
save_path: exp_results/bc-bb0-utk_face_age-crop_cutout_color_test-0.9-lr0.001-bs128-cbs64-w0.01-ratio10-aug1-seed3
get_utk_face - split: train, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_age-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
Binary Target 1
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Normal Label Distribution: 
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
Binary Target 1
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Normal Label Distribution: 
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 10684, target_attr: gender, bias_attr: age bias_rate: 0.9
['[train] target_0-bias_0: 8237', '[train] target_0-bias_1: 147', '[train] target_1-bias_0: 823', '[train] target_1-bias_1: 1477']
confusion_matrix - 
 original: tensor([[8237.,  823.],
        [ 147., 1477.]]), 
 normalized: tensor([[0.909, 0.091],
        [0.091, 0.909]]), 
 b|y: tensor([[0.982, 0.018],
        [0.358, 0.642]])
get_utk_face - split: train, aug: 1, given_y: True, ratio: 10
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_age-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
Binary Target 1
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Normal Label Distribution: 
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
Binary Target 1
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Normal Label Distribution: 
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 10684, target_attr: gender, bias_attr: age bias_rate: 0.9
['[train] target_0-bias_0: 8237', '[train] target_0-bias_1: 147', '[train] target_1-bias_0: 823', '[train] target_1-bias_1: 1477']
get_utk_face - split: valid, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_age-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [1030, 195]
Target 1: [841, 202]
Binary Target 1
---------------------------
Target 0: [1030, 195]
Target 1: [841, 202]
===================================
Normal Label Distribution: 
Target 0: [1030, 195]
Target 1: [841, 202]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 2268, target_attr: gender, bias_attr: age bias_rate: 0.9
['[valid] target_0-bias_0: 1030', '[valid] target_0-bias_1: 195', '[valid] target_1-bias_0: 841', '[valid] target_1-bias_1: 202']
get_utk_face - split: test, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_age-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [1061, 176]
Target 1: [867, 165]
Binary Target 1
---------------------------
Target 0: [1061, 176]
Target 1: [867, 165]
===================================
Normal Label Distribution: 
Target 0: [1061, 176]
Target 1: [867, 165]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 2269, target_attr: gender, bias_attr: age bias_rate: 0.9
['[test] target_0-bias_0: 1061', '[test] target_0-bias_1: 176', '[test] target_1-bias_0: 867', '[test] target_1-bias_1: 165']
decay_epochs: [6, 13]
[1 / 20] Learning rate: 0.001 weight: 0.01
[1 / 20] Loss: 4.827475489948806 CE Loss: 0.5987933163382239 Con Loss: 4.821487563150021
[1 / 20] tensor([[0.947, 0.960],
        [0.413, 0.109]]) {'epoch': 1, 'valid/acc': 66.711, 'valid/acc_unbiased': 61.09, 'valid/diff': 14.814, 'valid/acc_skew': 68.497, 'valid/acc_align': 53.683, 'test/acc': 68.312, 'test/acc_unbiased': 60.736, 'test/diff': 15.842, 'test/acc_skew': 68.657, 'test/acc_align': 52.816}
[1 / 20] best valid accuracy: 61.090 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 66.711, 'best_valid_valid/acc_unbiased': 61.09, 'best_valid_valid/diff': 14.814, 'best_valid_valid/acc_skew': 68.497, 'best_valid_valid/acc_align': 53.683, 'best_valid_test/acc': 68.312, 'best_valid_test/acc_unbiased': 60.736, 'best_valid_test/diff': 15.842, 'best_valid_test/acc_skew': 68.657, 'best_valid_test/acc_align': 52.816}
[1 / 20] best test accuracy: 60.736 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 66.711, 'best_test_valid/acc_unbiased': 61.09, 'best_test_valid/diff': 14.814, 'best_test_valid/acc_skew': 68.497, 'best_test_valid/acc_align': 53.683, 'best_test_test/acc': 68.312, 'best_test_test/acc_unbiased': 60.736, 'best_test_test/diff': 15.842, 'best_test_test/acc_skew': 68.657, 'best_test_test/acc_align': 52.816}
[2 / 20] Learning rate: 0.001 weight: 0.01
[2 / 20] Loss: 4.609389157118488 CE Loss: 0.5460429722028295 Con Loss: 4.603928716296071
[2 / 20] tensor([[0.947, 0.943],
        [0.490, 0.194]]) {'epoch': 2, 'valid/acc': 70.459, 'valid/acc_unbiased': 63.964, 'valid/diff': 14.316, 'valid/acc_skew': 70.251, 'valid/acc_align': 57.678, 'test/acc': 71.75, 'test/acc_unbiased': 64.363, 'test/diff': 15.015, 'test/acc_skew': 71.669, 'test/acc_align': 57.058}
[2 / 20] best valid accuracy: 63.964 at epoch 2 
 best_stats: {'best_valid_epoch': 2, 'best_valid_valid/acc': 70.459, 'best_valid_valid/acc_unbiased': 63.964, 'best_valid_valid/diff': 14.316, 'best_valid_valid/acc_skew': 70.251, 'best_valid_valid/acc_align': 57.678, 'best_valid_test/acc': 71.75, 'best_valid_test/acc_unbiased': 64.363, 'best_valid_test/diff': 15.015, 'best_valid_test/acc_skew': 71.669, 'best_valid_test/acc_align': 57.058}
[2 / 20] best test accuracy: 64.363 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 70.459, 'best_test_valid/acc_unbiased': 63.964, 'best_test_valid/diff': 14.316, 'best_test_valid/acc_skew': 70.251, 'best_test_valid/acc_align': 57.678, 'best_test_test/acc': 71.75, 'best_test_test/acc_unbiased': 64.363, 'best_test_test/diff': 15.015, 'best_test_test/acc_skew': 71.669, 'best_test_test/acc_align': 57.058}
[3 / 20] Learning rate: 0.001 weight: 0.01
[3 / 20] Loss: 4.567440699745501 CE Loss: 0.5372996279828247 Con Loss: 4.562067708108631
[3 / 20] tensor([[0.977, 0.949],
        [0.433, 0.170]]) {'epoch': 3, 'valid/acc': 69.621, 'valid/acc_unbiased': 63.452, 'valid/diff': 12.212, 'valid/acc_skew': 68.56, 'valid/acc_align': 58.343, 'test/acc': 70.824, 'test/acc_unbiased': 63.212, 'test/diff': 14.567, 'test/acc_skew': 69.069, 'test/acc_align': 57.354}
[3 / 20] best valid accuracy: 63.964 at epoch 2 
 best_stats: {'best_valid_epoch': 2, 'best_valid_valid/acc': 70.459, 'best_valid_valid/acc_unbiased': 63.964, 'best_valid_valid/diff': 14.316, 'best_valid_valid/acc_skew': 70.251, 'best_valid_valid/acc_align': 57.678, 'best_valid_test/acc': 71.75, 'best_valid_test/acc_unbiased': 64.363, 'best_valid_test/diff': 15.015, 'best_valid_test/acc_skew': 71.669, 'best_valid_test/acc_align': 57.058}
[3 / 20] best test accuracy: 64.363 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 70.459, 'best_test_valid/acc_unbiased': 63.964, 'best_test_valid/diff': 14.316, 'best_test_valid/acc_skew': 70.251, 'best_test_valid/acc_align': 57.678, 'best_test_test/acc': 71.75, 'best_test_test/acc_unbiased': 64.363, 'best_test_test/diff': 15.015, 'best_test_test/acc_skew': 71.669, 'best_test_test/acc_align': 57.058}
[4 / 20] Learning rate: 0.001 weight: 0.01
[4 / 20] Loss: 4.5805993580005895 CE Loss: 0.5060218688545491 Con Loss: 4.575539131371638
[4 / 20] tensor([[0.944, 0.699],
        [0.646, 0.503]]) {'epoch': 4, 'valid/acc': 76.323, 'valid/acc_unbiased': 70.043, 'valid/diff': 15.022, 'valid/acc_skew': 63.398, 'valid/acc_align': 76.688, 'test/acc': 77.92, 'test/acc_unbiased': 69.805, 'test/diff': 19.42, 'test/acc_skew': 67.238, 'test/acc_align': 72.371}
[4 / 20] best valid accuracy: 70.043 at epoch 4 
 best_stats: {'best_valid_epoch': 4, 'best_valid_valid/acc': 76.323, 'best_valid_valid/acc_unbiased': 70.043, 'best_valid_valid/diff': 15.022, 'best_valid_valid/acc_skew': 63.398, 'best_valid_valid/acc_align': 76.688, 'best_valid_test/acc': 77.92, 'best_valid_test/acc_unbiased': 69.805, 'best_valid_test/diff': 19.42, 'best_valid_test/acc_skew': 67.238, 'best_valid_test/acc_align': 72.371}
[4 / 20] best test accuracy: 69.805 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 76.323, 'best_test_valid/acc_unbiased': 70.043, 'best_test_valid/diff': 15.022, 'best_test_valid/acc_skew': 63.398, 'best_test_valid/acc_align': 76.688, 'best_test_test/acc': 77.92, 'best_test_test/acc_unbiased': 69.805, 'best_test_test/diff': 19.42, 'best_test_test/acc_skew': 67.238, 'best_test_test/acc_align': 72.371}
[5 / 20] Learning rate: 0.001 weight: 0.01
[5 / 20] Loss: 4.553950070174434 CE Loss: 0.48763874644020977 Con Loss: 4.549073688459949
[5 / 20] tensor([[0.843, 0.864],
        [0.737, 0.333]]) {'epoch': 5, 'valid/acc': 76.058, 'valid/acc_unbiased': 70.196, 'valid/diff': 17.324, 'valid/acc_skew': 77.693, 'valid/acc_align': 62.7, 'test/acc': 76.686, 'test/acc_unbiased': 69.415, 'test/diff': 21.236, 'test/acc_skew': 80.033, 'test/acc_align': 58.797}
[5 / 20] best valid accuracy: 70.196 at epoch 5 
 best_stats: {'best_valid_epoch': 5, 'best_valid_valid/acc': 76.058, 'best_valid_valid/acc_unbiased': 70.196, 'best_valid_valid/diff': 17.324, 'best_valid_valid/acc_skew': 77.693, 'best_valid_valid/acc_align': 62.7, 'best_valid_test/acc': 76.686, 'best_valid_test/acc_unbiased': 69.415, 'best_valid_test/diff': 21.236, 'best_valid_test/acc_skew': 80.033, 'best_valid_test/acc_align': 58.797}
[5 / 20] best test accuracy: 69.805 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 76.323, 'best_test_valid/acc_unbiased': 70.043, 'best_test_valid/diff': 15.022, 'best_test_valid/acc_skew': 63.398, 'best_test_valid/acc_align': 76.688, 'best_test_test/acc': 77.92, 'best_test_test/acc_unbiased': 69.805, 'best_test_test/diff': 19.42, 'best_test_test/acc_skew': 67.238, 'best_test_test/acc_align': 72.371}
[6 / 20] Learning rate: 0.001 weight: 0.01
[6 / 20] Loss: 4.596359765293088 CE Loss: 0.4851843400512104 Con Loss: 4.591507923643226
[6 / 20] tensor([[0.976, 0.767],
        [0.441, 0.297]]) {'epoch': 6, 'valid/acc': 70.723, 'valid/acc_unbiased': 65.09, 'valid/diff': 10.469, 'valid/acc_skew': 62.882, 'valid/acc_align': 67.297, 'test/acc': 70.604, 'test/acc_unbiased': 62.026, 'test/diff': 17.651, 'test/acc_skew': 60.382, 'test/acc_align': 63.67}
[6 / 20] best valid accuracy: 70.196 at epoch 5 
 best_stats: {'best_valid_epoch': 5, 'best_valid_valid/acc': 76.058, 'best_valid_valid/acc_unbiased': 70.196, 'best_valid_valid/diff': 17.324, 'best_valid_valid/acc_skew': 77.693, 'best_valid_valid/acc_align': 62.7, 'best_valid_test/acc': 76.686, 'best_valid_test/acc_unbiased': 69.415, 'best_valid_test/diff': 21.236, 'best_valid_test/acc_skew': 80.033, 'best_valid_test/acc_align': 58.797}
[6 / 20] best test accuracy: 69.805 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 76.323, 'best_test_valid/acc_unbiased': 70.043, 'best_test_valid/diff': 15.022, 'best_test_valid/acc_skew': 63.398, 'best_test_valid/acc_align': 76.688, 'best_test_test/acc': 77.92, 'best_test_test/acc_unbiased': 69.805, 'best_test_test/diff': 19.42, 'best_test_test/acc_skew': 67.238, 'best_test_test/acc_align': 72.371}
[7 / 20] Learning rate: 0.0001 weight: 0.01
[7 / 20] Loss: 4.534695362875141 CE Loss: 0.4579870781395061 Con Loss: 4.530115492287668
[7 / 20] tensor([[0.963, 0.778],
        [0.585, 0.382]]) {'epoch': 7, 'valid/acc': 76.102, 'valid/acc_unbiased': 70.484, 'valid/diff': 12.418, 'valid/acc_skew': 69.05, 'valid/acc_align': 71.918, 'test/acc': 76.201, 'test/acc_unbiased': 67.706, 'test/diff': 19.39, 'test/acc_skew': 68.159, 'test/acc_align': 67.253}
[7 / 20] best valid accuracy: 70.484 at epoch 7 
 best_stats: {'best_valid_epoch': 7, 'best_valid_valid/acc': 76.102, 'best_valid_valid/acc_unbiased': 70.484, 'best_valid_valid/diff': 12.418, 'best_valid_valid/acc_skew': 69.05, 'best_valid_valid/acc_align': 71.918, 'best_valid_test/acc': 76.201, 'best_valid_test/acc_unbiased': 67.706, 'best_valid_test/diff': 19.39, 'best_valid_test/acc_skew': 68.159, 'best_valid_test/acc_align': 67.253}
[7 / 20] best test accuracy: 69.805 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 76.323, 'best_test_valid/acc_unbiased': 70.043, 'best_test_valid/diff': 15.022, 'best_test_valid/acc_skew': 63.398, 'best_test_valid/acc_align': 76.688, 'best_test_test/acc': 77.92, 'best_test_test/acc_unbiased': 69.805, 'best_test_test/diff': 19.42, 'best_test_test/acc_skew': 67.238, 'best_test_test/acc_align': 72.371}
[8 / 20] Learning rate: 0.0001 weight: 0.01
[8 / 20] Loss: 4.471215193301093 CE Loss: 0.4466930089015632 Con Loss: 4.4667482733146295
[8 / 20] tensor([[0.961, 0.710],
        [0.638, 0.527]]) {'epoch': 8, 'valid/acc': 77.16, 'valid/acc_unbiased': 71.877, 'valid/diff': 13.651, 'valid/acc_skew': 65.052, 'valid/acc_align': 78.703, 'test/acc': 78.669, 'test/acc_unbiased': 70.917, 'test/diff': 18.084, 'test/acc_skew': 67.403, 'test/acc_align': 74.431}
[8 / 20] best valid accuracy: 71.877 at epoch 8 
 best_stats: {'best_valid_epoch': 8, 'best_valid_valid/acc': 77.16, 'best_valid_valid/acc_unbiased': 71.877, 'best_valid_valid/diff': 13.651, 'best_valid_valid/acc_skew': 65.052, 'best_valid_valid/acc_align': 78.703, 'best_valid_test/acc': 78.669, 'best_valid_test/acc_unbiased': 70.917, 'best_valid_test/diff': 18.084, 'best_valid_test/acc_skew': 67.403, 'best_valid_test/acc_align': 74.431}
[8 / 20] best test accuracy: 70.917 at epoch 8 
 best_stats: {'best_test_epoch': 8, 'best_test_valid/acc': 77.16, 'best_test_valid/acc_unbiased': 71.877, 'best_test_valid/diff': 13.651, 'best_test_valid/acc_skew': 65.052, 'best_test_valid/acc_align': 78.703, 'best_test_test/acc': 78.669, 'best_test_test/acc_unbiased': 70.917, 'best_test_test/diff': 18.084, 'best_test_test/acc_skew': 67.403, 'best_test_test/acc_align': 74.431}
[9 / 20] Learning rate: 0.0001 weight: 0.01
[9 / 20] Loss: 4.461224959076054 CE Loss: 0.4270354979206051 Con Loss: 4.456954618466119
[9 / 20] tensor([[0.966, 0.773],
        [0.623, 0.533]]) {'epoch': 9, 'valid/acc': 76.323, 'valid/acc_unbiased': 71.104, 'valid/diff': 12.907, 'valid/acc_skew': 64.65, 'valid/acc_align': 77.557, 'test/acc': 78.845, 'test/acc_unbiased': 72.374, 'test/diff': 14.142, 'test/acc_skew': 69.778, 'test/acc_align': 74.97}
[9 / 20] best valid accuracy: 71.877 at epoch 8 
 best_stats: {'best_valid_epoch': 8, 'best_valid_valid/acc': 77.16, 'best_valid_valid/acc_unbiased': 71.877, 'best_valid_valid/diff': 13.651, 'best_valid_valid/acc_skew': 65.052, 'best_valid_valid/acc_align': 78.703, 'best_valid_test/acc': 78.669, 'best_valid_test/acc_unbiased': 70.917, 'best_valid_test/diff': 18.084, 'best_valid_test/acc_skew': 67.403, 'best_valid_test/acc_align': 74.431}
[9 / 20] best test accuracy: 72.374 at epoch 9 
 best_stats: {'best_test_epoch': 9, 'best_test_valid/acc': 76.323, 'best_test_valid/acc_unbiased': 71.104, 'best_test_valid/diff': 12.907, 'best_test_valid/acc_skew': 64.65, 'best_test_valid/acc_align': 77.557, 'best_test_test/acc': 78.845, 'best_test_test/acc_unbiased': 72.374, 'best_test_test/diff': 14.142, 'best_test_test/acc_skew': 69.778, 'best_test_test/acc_align': 74.97}
[10 / 20] Learning rate: 0.0001 weight: 0.01
[10 / 20] Loss: 4.44505496598147 CE Loss: 0.4179604525134966 Con Loss: 4.440875372606375
[10 / 20] tensor([[0.971, 0.693],
        [0.619, 0.630]]) {'epoch': 10, 'valid/acc': 76.411, 'valid/acc_unbiased': 70.864, 'valid/diff': 20.201, 'valid/acc_skew': 60.763, 'valid/acc_align': 80.965, 'test/acc': 79.022, 'test/acc_unbiased': 72.841, 'test/diff': 14.426, 'test/acc_skew': 65.628, 'test/acc_align': 80.054}
[10 / 20] best valid accuracy: 71.877 at epoch 8 
 best_stats: {'best_valid_epoch': 8, 'best_valid_valid/acc': 77.16, 'best_valid_valid/acc_unbiased': 71.877, 'best_valid_valid/diff': 13.651, 'best_valid_valid/acc_skew': 65.052, 'best_valid_valid/acc_align': 78.703, 'best_valid_test/acc': 78.669, 'best_valid_test/acc_unbiased': 70.917, 'best_valid_test/diff': 18.084, 'best_valid_test/acc_skew': 67.403, 'best_valid_test/acc_align': 74.431}
[10 / 20] best test accuracy: 72.841 at epoch 10 
 best_stats: {'best_test_epoch': 10, 'best_test_valid/acc': 76.411, 'best_test_valid/acc_unbiased': 70.864, 'best_test_valid/diff': 20.201, 'best_test_valid/acc_skew': 60.763, 'best_test_valid/acc_align': 80.965, 'best_test_test/acc': 79.022, 'best_test_test/acc_unbiased': 72.841, 'best_test_test/diff': 14.426, 'best_test_test/acc_skew': 65.628, 'best_test_test/acc_align': 80.054}
[11 / 20] Learning rate: 0.0001 weight: 0.01
[11 / 20] Loss: 4.409433625334437 CE Loss: 0.4090184738063848 Con Loss: 4.405343437409053
[11 / 20] tensor([[0.972, 0.693],
        [0.657, 0.667]]) {'epoch': 11, 'valid/acc': 78.263, 'valid/acc_unbiased': 72.212, 'valid/diff': 19.991, 'valid/acc_skew': 62.216, 'valid/acc_align': 82.207, 'test/acc': 80.784, 'test/acc_unbiased': 74.725, 'test/diff': 14.389, 'test/acc_skew': 67.531, 'test/acc_align': 81.92}
[11 / 20] best valid accuracy: 72.212 at epoch 11 
 best_stats: {'best_valid_epoch': 11, 'best_valid_valid/acc': 78.263, 'best_valid_valid/acc_unbiased': 72.212, 'best_valid_valid/diff': 19.991, 'best_valid_valid/acc_skew': 62.216, 'best_valid_valid/acc_align': 82.207, 'best_valid_test/acc': 80.784, 'best_valid_test/acc_unbiased': 74.725, 'best_valid_test/diff': 14.389, 'best_valid_test/acc_skew': 67.531, 'best_valid_test/acc_align': 81.92}
[11 / 20] best test accuracy: 74.725 at epoch 11 
 best_stats: {'best_test_epoch': 11, 'best_test_valid/acc': 78.263, 'best_test_valid/acc_unbiased': 72.212, 'best_test_valid/diff': 19.991, 'best_test_valid/acc_skew': 62.216, 'best_test_valid/acc_align': 82.207, 'best_test_test/acc': 80.784, 'best_test_test/acc_unbiased': 74.725, 'best_test_test/diff': 14.389, 'best_test_test/acc_skew': 67.531, 'best_test_test/acc_align': 81.92}
[12 / 20] Learning rate: 0.0001 weight: 0.01
[12 / 20] Loss: 4.350220481718314 CE Loss: 0.40525648816834225 Con Loss: 4.346167897517563
[12 / 20] tensor([[0.967, 0.733],
        [0.651, 0.582]]) {'epoch': 12, 'valid/acc': 77.954, 'valid/acc_unbiased': 72.71, 'valid/diff': 16.617, 'valid/acc_skew': 64.401, 'valid/acc_align': 81.018, 'test/acc': 79.991, 'test/acc_unbiased': 73.308, 'test/diff': 15.138, 'test/acc_skew': 69.174, 'test/acc_align': 77.442}
[12 / 20] best valid accuracy: 72.710 at epoch 12 
 best_stats: {'best_valid_epoch': 12, 'best_valid_valid/acc': 77.954, 'best_valid_valid/acc_unbiased': 72.71, 'best_valid_valid/diff': 16.617, 'best_valid_valid/acc_skew': 64.401, 'best_valid_valid/acc_align': 81.018, 'best_valid_test/acc': 79.991, 'best_valid_test/acc_unbiased': 73.308, 'best_valid_test/diff': 15.138, 'best_valid_test/acc_skew': 69.174, 'best_valid_test/acc_align': 77.442}
[12 / 20] best test accuracy: 74.725 at epoch 11 
 best_stats: {'best_test_epoch': 11, 'best_test_valid/acc': 78.263, 'best_test_valid/acc_unbiased': 72.212, 'best_test_valid/diff': 19.991, 'best_test_valid/acc_skew': 62.216, 'best_test_valid/acc_align': 82.207, 'best_test_test/acc': 80.784, 'best_test_test/acc_unbiased': 74.725, 'best_test_test/diff': 14.389, 'best_test_test/acc_skew': 67.531, 'best_test_test/acc_align': 81.92}
[13 / 20] Learning rate: 0.0001 weight: 0.01
[13 / 20] Loss: 4.386879948452143 CE Loss: 0.3993038094052658 Con Loss: 4.382886912304111
[13 / 20] tensor([[0.973, 0.688],
        [0.653, 0.661]]) {'epoch': 13, 'valid/acc': 78.395, 'valid/acc_unbiased': 72.217, 'valid/diff': 16.806, 'valid/acc_skew': 63.814, 'valid/acc_align': 80.62, 'test/acc': 80.564, 'test/acc_unbiased': 74.34, 'test/diff': 14.647, 'test/acc_skew': 67.016, 'test/acc_align': 81.664}
[13 / 20] best valid accuracy: 72.710 at epoch 12 
 best_stats: {'best_valid_epoch': 12, 'best_valid_valid/acc': 77.954, 'best_valid_valid/acc_unbiased': 72.71, 'best_valid_valid/diff': 16.617, 'best_valid_valid/acc_skew': 64.401, 'best_valid_valid/acc_align': 81.018, 'best_valid_test/acc': 79.991, 'best_valid_test/acc_unbiased': 73.308, 'best_valid_test/diff': 15.138, 'best_valid_test/acc_skew': 69.174, 'best_valid_test/acc_align': 77.442}
[13 / 20] best test accuracy: 74.725 at epoch 11 
 best_stats: {'best_test_epoch': 11, 'best_test_valid/acc': 78.263, 'best_test_valid/acc_unbiased': 72.212, 'best_test_valid/diff': 19.991, 'best_test_valid/acc_skew': 62.216, 'best_test_valid/acc_align': 82.207, 'best_test_test/acc': 80.784, 'best_test_test/acc_unbiased': 74.725, 'best_test_test/diff': 14.389, 'best_test_test/acc_skew': 67.531, 'best_test_test/acc_align': 81.92}
[14 / 20] Learning rate: 1e-05 weight: 0.01
[14 / 20] Loss: 4.359520883071025 CE Loss: 0.3890544402603798 Con Loss: 4.355630356557626
[14 / 20] tensor([[0.975, 0.705],
        [0.648, 0.648]]) {'epoch': 14, 'valid/acc': 78.042, 'valid/acc_unbiased': 71.787, 'valid/diff': 17.171, 'valid/acc_skew': 63.201, 'valid/acc_align': 80.372, 'test/acc': 80.52, 'test/acc_unbiased': 74.395, 'test/diff': 13.514, 'test/acc_skew': 67.638, 'test/acc_align': 81.152}
[14 / 20] best valid accuracy: 72.710 at epoch 12 
 best_stats: {'best_valid_epoch': 12, 'best_valid_valid/acc': 77.954, 'best_valid_valid/acc_unbiased': 72.71, 'best_valid_valid/diff': 16.617, 'best_valid_valid/acc_skew': 64.401, 'best_valid_valid/acc_align': 81.018, 'best_valid_test/acc': 79.991, 'best_valid_test/acc_unbiased': 73.308, 'best_valid_test/diff': 15.138, 'best_valid_test/acc_skew': 69.174, 'best_valid_test/acc_align': 77.442}
[14 / 20] best test accuracy: 74.725 at epoch 11 
 best_stats: {'best_test_epoch': 11, 'best_test_valid/acc': 78.263, 'best_test_valid/acc_unbiased': 72.212, 'best_test_valid/diff': 19.991, 'best_test_valid/acc_skew': 62.216, 'best_test_valid/acc_align': 82.207, 'best_test_test/acc': 80.784, 'best_test_test/acc_unbiased': 74.725, 'best_test_test/diff': 14.389, 'best_test_test/acc_skew': 67.531, 'best_test_test/acc_align': 81.92}
[15 / 20] Learning rate: 1e-05 weight: 0.01
[15 / 20] Loss: 4.3644183025695735 CE Loss: 0.3843684460687441 Con Loss: 4.360574614461644
[15 / 20] tensor([[0.969, 0.699],
        [0.686, 0.655]]) {'epoch': 15, 'valid/acc': 79.056, 'valid/acc_unbiased': 72.795, 'valid/diff': 15.465, 'valid/acc_skew': 65.063, 'valid/acc_align': 80.528, 'test/acc': 81.71, 'test/acc_unbiased': 75.215, 'test/diff': 15.088, 'test/acc_skew': 69.257, 'test/acc_align': 81.172}
[15 / 20] best valid accuracy: 72.795 at epoch 15 
 best_stats: {'best_valid_epoch': 15, 'best_valid_valid/acc': 79.056, 'best_valid_valid/acc_unbiased': 72.795, 'best_valid_valid/diff': 15.465, 'best_valid_valid/acc_skew': 65.063, 'best_valid_valid/acc_align': 80.528, 'best_valid_test/acc': 81.71, 'best_valid_test/acc_unbiased': 75.215, 'best_valid_test/diff': 15.088, 'best_valid_test/acc_skew': 69.257, 'best_valid_test/acc_align': 81.172}
[15 / 20] best test accuracy: 75.215 at epoch 15 
 best_stats: {'best_test_epoch': 15, 'best_test_valid/acc': 79.056, 'best_test_valid/acc_unbiased': 72.795, 'best_test_valid/diff': 15.465, 'best_test_valid/acc_skew': 65.063, 'best_test_valid/acc_align': 80.528, 'best_test_test/acc': 81.71, 'best_test_test/acc_unbiased': 75.215, 'best_test_test/diff': 15.088, 'best_test_test/acc_skew': 69.257, 'best_test_test/acc_align': 81.172}
[16 / 20] Learning rate: 1e-05 weight: 0.01
[16 / 20] Loss: 4.344626364213436 CE Loss: 0.3820881123111651 Con Loss: 4.340805465029849
[16 / 20] tensor([[0.973, 0.716],
        [0.659, 0.642]]) {'epoch': 16, 'valid/acc': 78.483, 'valid/acc_unbiased': 72.465, 'valid/diff': 17.301, 'valid/acc_skew': 63.814, 'valid/acc_align': 81.115, 'test/acc': 80.873, 'test/acc_unbiased': 74.74, 'test/diff': 13.646, 'test/acc_skew': 68.725, 'test/acc_align': 80.755}
[16 / 20] best valid accuracy: 72.795 at epoch 15 
 best_stats: {'best_valid_epoch': 15, 'best_valid_valid/acc': 79.056, 'best_valid_valid/acc_unbiased': 72.795, 'best_valid_valid/diff': 15.465, 'best_valid_valid/acc_skew': 65.063, 'best_valid_valid/acc_align': 80.528, 'best_valid_test/acc': 81.71, 'best_valid_test/acc_unbiased': 75.215, 'best_valid_test/diff': 15.088, 'best_valid_test/acc_skew': 69.257, 'best_valid_test/acc_align': 81.172}
[16 / 20] best test accuracy: 75.215 at epoch 15 
 best_stats: {'best_test_epoch': 15, 'best_test_valid/acc': 79.056, 'best_test_valid/acc_unbiased': 72.795, 'best_test_valid/diff': 15.465, 'best_test_valid/acc_skew': 65.063, 'best_test_valid/acc_align': 80.528, 'best_test_test/acc': 81.71, 'best_test_test/acc_unbiased': 75.215, 'best_test_test/diff': 15.088, 'best_test_test/acc_skew': 69.257, 'best_test_test/acc_align': 81.172}
[17 / 20] Learning rate: 1e-05 weight: 0.01
[17 / 20] Loss: 4.25516121595462 CE Loss: 0.3812381087707161 Con Loss: 4.251348837178015
[17 / 20] tensor([[0.973, 0.722],
        [0.656, 0.630]]) {'epoch': 17, 'valid/acc': 78.086, 'valid/acc_unbiased': 72.217, 'valid/diff': 16.612, 'valid/acc_skew': 63.911, 'valid/acc_align': 80.523, 'test/acc': 80.74, 'test/acc_unbiased': 74.521, 'test/diff': 13.853, 'test/acc_skew': 68.894, 'test/acc_align': 80.149}
[17 / 20] best valid accuracy: 72.795 at epoch 15 
 best_stats: {'best_valid_epoch': 15, 'best_valid_valid/acc': 79.056, 'best_valid_valid/acc_unbiased': 72.795, 'best_valid_valid/diff': 15.465, 'best_valid_valid/acc_skew': 65.063, 'best_valid_valid/acc_align': 80.528, 'best_valid_test/acc': 81.71, 'best_valid_test/acc_unbiased': 75.215, 'best_valid_test/diff': 15.088, 'best_valid_test/acc_skew': 69.257, 'best_valid_test/acc_align': 81.172}
[17 / 20] best test accuracy: 75.215 at epoch 15 
 best_stats: {'best_test_epoch': 15, 'best_test_valid/acc': 79.056, 'best_test_valid/acc_unbiased': 72.795, 'best_test_valid/diff': 15.465, 'best_test_valid/acc_skew': 65.063, 'best_test_valid/acc_align': 80.528, 'best_test_test/acc': 81.71, 'best_test_test/acc_unbiased': 75.215, 'best_test_test/diff': 15.088, 'best_test_test/acc_skew': 69.257, 'best_test_test/acc_align': 81.172}
[18 / 20] Learning rate: 1e-05 weight: 0.01
[18 / 20] Loss: 4.336613692044765 CE Loss: 0.3890184795686878 Con Loss: 4.332723504012553
[18 / 20] tensor([[0.974, 0.716],
        [0.657, 0.624]]) {'epoch': 18, 'valid/acc': 78.571, 'valid/acc_unbiased': 72.933, 'valid/diff': 15.674, 'valid/acc_skew': 65.096, 'valid/acc_align': 80.77, 'test/acc': 80.74, 'test/acc_unbiased': 74.28, 'test/diff': 14.545, 'test/acc_skew': 68.667, 'test/acc_align': 79.893}
[18 / 20] best valid accuracy: 72.933 at epoch 18 
 best_stats: {'best_valid_epoch': 18, 'best_valid_valid/acc': 78.571, 'best_valid_valid/acc_unbiased': 72.933, 'best_valid_valid/diff': 15.674, 'best_valid_valid/acc_skew': 65.096, 'best_valid_valid/acc_align': 80.77, 'best_valid_test/acc': 80.74, 'best_valid_test/acc_unbiased': 74.28, 'best_valid_test/diff': 14.545, 'best_valid_test/acc_skew': 68.667, 'best_valid_test/acc_align': 79.893}
[18 / 20] best test accuracy: 75.215 at epoch 15 
 best_stats: {'best_test_epoch': 15, 'best_test_valid/acc': 79.056, 'best_test_valid/acc_unbiased': 72.795, 'best_test_valid/diff': 15.465, 'best_test_valid/acc_skew': 65.063, 'best_test_valid/acc_align': 80.528, 'best_test_test/acc': 81.71, 'best_test_test/acc_unbiased': 75.215, 'best_test_test/diff': 15.088, 'best_test_test/acc_skew': 69.257, 'best_test_test/acc_align': 81.172}
[19 / 20] Learning rate: 1e-05 weight: 0.01
[19 / 20] Loss: 4.3340780448485114 CE Loss: 0.38952184579248333 Con Loss: 4.330182847973114
[19 / 20] tensor([[0.972, 0.688],
        [0.664, 0.661]]) {'epoch': 19, 'valid/acc': 78.483, 'valid/acc_unbiased': 72.653, 'valid/diff': 17.915, 'valid/acc_skew': 63.695, 'valid/acc_align': 81.61, 'test/acc': 80.961, 'test/acc_unbiased': 74.605, 'test/diff': 14.399, 'test/acc_skew': 67.593, 'test/acc_align': 81.617}
[19 / 20] best valid accuracy: 72.933 at epoch 18 
 best_stats: {'best_valid_epoch': 18, 'best_valid_valid/acc': 78.571, 'best_valid_valid/acc_unbiased': 72.933, 'best_valid_valid/diff': 15.674, 'best_valid_valid/acc_skew': 65.096, 'best_valid_valid/acc_align': 80.77, 'best_valid_test/acc': 80.74, 'best_valid_test/acc_unbiased': 74.28, 'best_valid_test/diff': 14.545, 'best_valid_test/acc_skew': 68.667, 'best_valid_test/acc_align': 79.893}
[19 / 20] best test accuracy: 75.215 at epoch 15 
 best_stats: {'best_test_epoch': 15, 'best_test_valid/acc': 79.056, 'best_test_valid/acc_unbiased': 72.795, 'best_test_valid/diff': 15.465, 'best_test_valid/acc_skew': 65.063, 'best_test_valid/acc_align': 80.528, 'best_test_test/acc': 81.71, 'best_test_test/acc_unbiased': 75.215, 'best_test_test/diff': 15.088, 'best_test_test/acc_skew': 69.257, 'best_test_test/acc_align': 81.172}
[20 / 20] Learning rate: 1e-05 weight: 0.01
[20 / 20] Loss: 4.319918014636338 CE Loss: 0.3801767557067221 Con Loss: 4.316116257313707
[20 / 20] tensor([[0.973, 0.705],
        [0.661, 0.679]]) {'epoch': 20, 'valid/acc': 78.527, 'valid/acc_unbiased': 72.805, 'valid/diff': 15.931, 'valid/acc_skew': 64.84, 'valid/acc_align': 80.77, 'test/acc': 81.137, 'test/acc_unbiased': 75.423, 'test/diff': 14.301, 'test/acc_skew': 68.272, 'test/acc_align': 82.573}
[20 / 20] best valid accuracy: 72.933 at epoch 18 
 best_stats: {'best_valid_epoch': 18, 'best_valid_valid/acc': 78.571, 'best_valid_valid/acc_unbiased': 72.933, 'best_valid_valid/diff': 15.674, 'best_valid_valid/acc_skew': 65.096, 'best_valid_valid/acc_align': 80.77, 'best_valid_test/acc': 80.74, 'best_valid_test/acc_unbiased': 74.28, 'best_valid_test/diff': 14.545, 'best_valid_test/acc_skew': 68.667, 'best_valid_test/acc_align': 79.893}
[20 / 20] best test accuracy: 75.423 at epoch 20 
 best_stats: {'best_test_epoch': 20, 'best_test_valid/acc': 78.527, 'best_test_valid/acc_unbiased': 72.805, 'best_test_valid/diff': 15.931, 'best_test_valid/acc_skew': 64.84, 'best_test_valid/acc_align': 80.77, 'best_test_test/acc': 81.137, 'best_test_test/acc_unbiased': 75.423, 'best_test_test/diff': 14.301, 'best_test_test/acc_skew': 68.272, 'best_test_test/acc_align': 82.573}
Total training time: 0:17:14
