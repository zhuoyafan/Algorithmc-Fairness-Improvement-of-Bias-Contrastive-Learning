Log level set to: INFO
Set seed: 2
=======> Using Fixed Random Seed: 2 <========
save_path: exp_results/bc-bb0-utk_face_race-rotate_blur-0.9-lr0.001-bs128-cbs64-w0.01-ratio10-aug1-seed2
get_utk_face - split: train, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_race-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [4407, 552]
Target 1: [440, 5529]
Binary Target 1
---------------------------
Target 0: [4407, 552]
Target 1: [440, 5529]
===================================
Normal Label Distribution: 
Target 0: [4407, 552]
Target 1: [440, 5529]
===================================
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [4407, 552]
Target 1: [440, 5529]
Binary Target 1
---------------------------
Target 0: [4407, 552]
Target 1: [440, 5529]
===================================
Normal Label Distribution: 
Target 0: [4407, 552]
Target 1: [440, 5529]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 10928, target_attr: gender, bias_attr: race bias_rate: 0.9
['[train] target_0-bias_0: 4407', '[train] target_0-bias_1: 552', '[train] target_1-bias_0: 440', '[train] target_1-bias_1: 5529']
confusion_matrix - 
 original: tensor([[4407.,  440.],
        [ 552., 5529.]]), 
 normalized: tensor([[0.909, 0.091],
        [0.091, 0.909]]), 
 b|y: tensor([[0.889, 0.111],
        [0.074, 0.926]])
get_utk_face - split: train, aug: 1, given_y: True, ratio: 10
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_race-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [4407, 552]
Target 1: [440, 5529]
Binary Target 1
---------------------------
Target 0: [4407, 552]
Target 1: [440, 5529]
===================================
Normal Label Distribution: 
Target 0: [4407, 552]
Target 1: [440, 5529]
===================================
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [4407, 552]
Target 1: [440, 5529]
Binary Target 1
---------------------------
Target 0: [4407, 552]
Target 1: [440, 5529]
===================================
Normal Label Distribution: 
Target 0: [4407, 552]
Target 1: [440, 5529]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 10928, target_attr: gender, bias_attr: race bias_rate: 0.9
['[train] target_0-bias_0: 4407', '[train] target_0-bias_1: 552', '[train] target_1-bias_0: 440', '[train] target_1-bias_1: 5529']
get_utk_face - split: valid, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_race-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [583, 684]
Target 1: [457, 646]
Binary Target 1
---------------------------
Target 0: [583, 684]
Target 1: [457, 646]
===================================
Normal Label Distribution: 
Target 0: [583, 684]
Target 1: [457, 646]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 2370, target_attr: gender, bias_attr: race bias_rate: 0.9
['[valid] target_0-bias_0: 583', '[valid] target_0-bias_1: 684', '[valid] target_1-bias_0: 457', '[valid] target_1-bias_1: 646']
get_utk_face - split: test, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_race-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [558, 677]
Target 1: [462, 673]
Binary Target 1
---------------------------
Target 0: [558, 677]
Target 1: [462, 673]
===================================
Normal Label Distribution: 
Target 0: [558, 677]
Target 1: [462, 673]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 2370, target_attr: gender, bias_attr: race bias_rate: 0.9
['[test] target_0-bias_0: 558', '[test] target_0-bias_1: 677', '[test] target_1-bias_0: 462', '[test] target_1-bias_1: 673']
decay_epochs: [6, 13]
[1 / 20] Learning rate: 0.001 weight: 0.01
[1 / 20] Loss: 4.911338367713492 CE Loss: 0.6394202828756363 Con Loss: 4.904944174111675
[1 / 20] tensor([[0.758, 0.724],
        [0.626, 0.725]]) {'epoch': 1, 'valid/acc': 71.35, 'valid/acc_unbiased': 70.835, 'valid/diff': 2.117, 'valid/acc_skew': 69.777, 'valid/acc_align': 71.894, 'test/acc': 71.308, 'test/acc_unbiased': 70.812, 'test/diff': 6.693, 'test/acc_skew': 67.466, 'test/acc_align': 74.159}
[1 / 20] best valid accuracy: 70.835 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 71.35, 'best_valid_valid/acc_unbiased': 70.835, 'best_valid_valid/diff': 2.117, 'best_valid_valid/acc_skew': 69.777, 'best_valid_valid/acc_align': 71.894, 'best_valid_test/acc': 71.308, 'best_valid_test/acc_unbiased': 70.812, 'best_valid_test/diff': 6.693, 'best_valid_test/acc_skew': 67.466, 'best_valid_test/acc_align': 74.159}
[1 / 20] best test accuracy: 70.812 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 71.35, 'best_test_valid/acc_unbiased': 70.835, 'best_test_valid/diff': 2.117, 'best_test_valid/acc_skew': 69.777, 'best_test_valid/acc_align': 71.894, 'best_test_test/acc': 71.308, 'best_test_test/acc_unbiased': 70.812, 'best_test_test/diff': 6.693, 'best_test_test/acc_skew': 67.466, 'best_test_test/acc_align': 74.159}
[2 / 20] Learning rate: 0.001 weight: 0.01
[2 / 20] Loss: 4.808346085806717 CE Loss: 0.5940771121231738 Con Loss: 4.8024053357181575
[2 / 20] tensor([[0.882, 0.879],
        [0.433, 0.523]]) {'epoch': 2, 'valid/acc': 69.873, 'valid/acc_unbiased': 68.17, 'valid/diff': 3.116, 'valid/acc_skew': 66.984, 'valid/acc_align': 69.356, 'test/acc': 69.156, 'test/acc_unbiased': 67.913, 'test/diff': 4.649, 'test/acc_skew': 65.589, 'test/acc_align': 70.238}
[2 / 20] best valid accuracy: 70.835 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 71.35, 'best_valid_valid/acc_unbiased': 70.835, 'best_valid_valid/diff': 2.117, 'best_valid_valid/acc_skew': 69.777, 'best_valid_valid/acc_align': 71.894, 'best_valid_test/acc': 71.308, 'best_valid_test/acc_unbiased': 70.812, 'best_valid_test/diff': 6.693, 'best_valid_test/acc_skew': 67.466, 'best_valid_test/acc_align': 74.159}
[2 / 20] best test accuracy: 70.812 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 71.35, 'best_test_valid/acc_unbiased': 70.835, 'best_test_valid/diff': 2.117, 'best_test_valid/acc_skew': 69.777, 'best_test_valid/acc_align': 71.894, 'best_test_test/acc': 71.308, 'best_test_test/acc_unbiased': 70.812, 'best_test_test/diff': 6.693, 'best_test_test/acc_skew': 67.466, 'best_test_test/acc_align': 74.159}
[3 / 20] Learning rate: 0.001 weight: 0.01
[3 / 20] Loss: 4.783104735272521 CE Loss: 0.5983677863812901 Con Loss: 4.777121062858213
[3 / 20] tensor([[0.797, 0.756],
        [0.602, 0.725]]) {'epoch': 3, 'valid/acc': 72.278, 'valid/acc_unbiased': 71.469, 'valid/diff': 7.322, 'valid/acc_skew': 67.808, 'valid/acc_align': 75.13, 'test/acc': 72.7, 'test/acc_unbiased': 72.015, 'test/diff': 8.23, 'test/acc_skew': 67.9, 'test/acc_align': 76.13}
[3 / 20] best valid accuracy: 71.469 at epoch 3 
 best_stats: {'best_valid_epoch': 3, 'best_valid_valid/acc': 72.278, 'best_valid_valid/acc_unbiased': 71.469, 'best_valid_valid/diff': 7.322, 'best_valid_valid/acc_skew': 67.808, 'best_valid_valid/acc_align': 75.13, 'best_valid_test/acc': 72.7, 'best_valid_test/acc_unbiased': 72.015, 'best_valid_test/diff': 8.23, 'best_valid_test/acc_skew': 67.9, 'best_valid_test/acc_align': 76.13}
[3 / 20] best test accuracy: 72.015 at epoch 3 
 best_stats: {'best_test_epoch': 3, 'best_test_valid/acc': 72.278, 'best_test_valid/acc_unbiased': 71.469, 'best_test_valid/diff': 7.322, 'best_test_valid/acc_skew': 67.808, 'best_test_valid/acc_align': 75.13, 'best_test_test/acc': 72.7, 'best_test_test/acc_unbiased': 72.015, 'best_test_test/diff': 8.23, 'best_test_test/acc_skew': 67.9, 'best_test_test/acc_align': 76.13}
[4 / 20] Learning rate: 0.001 weight: 0.01
[4 / 20] Loss: 4.775410838566971 CE Loss: 0.5677321240371352 Con Loss: 4.769733536470338
[4 / 20] tensor([[0.742, 0.703],
        [0.727, 0.786]]) {'epoch': 4, 'valid/acc': 74.135, 'valid/acc_unbiased': 74.025, 'valid/diff': 3.094, 'valid/acc_skew': 72.873, 'valid/acc_align': 75.176, 'test/acc': 74.051, 'test/acc_unbiased': 73.959, 'test/diff': 4.88, 'test/acc_skew': 71.519, 'test/acc_align': 76.398}
[4 / 20] best valid accuracy: 74.025 at epoch 4 
 best_stats: {'best_valid_epoch': 4, 'best_valid_valid/acc': 74.135, 'best_valid_valid/acc_unbiased': 74.025, 'best_valid_valid/diff': 3.094, 'best_valid_valid/acc_skew': 72.873, 'best_valid_valid/acc_align': 75.176, 'best_valid_test/acc': 74.051, 'best_valid_test/acc_unbiased': 73.959, 'best_valid_test/diff': 4.88, 'best_valid_test/acc_skew': 71.519, 'best_valid_test/acc_align': 76.398}
[4 / 20] best test accuracy: 73.959 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 74.135, 'best_test_valid/acc_unbiased': 74.025, 'best_test_valid/diff': 3.094, 'best_test_valid/acc_skew': 72.873, 'best_test_valid/acc_align': 75.176, 'best_test_test/acc': 74.051, 'best_test_test/acc_unbiased': 73.959, 'best_test_test/diff': 4.88, 'best_test_test/acc_skew': 71.519, 'best_test_test/acc_align': 76.398}
[5 / 20] Learning rate: 0.001 weight: 0.01
[5 / 20] Loss: 4.756693682244721 CE Loss: 0.5600579918565373 Con Loss: 4.751093079719152
[5 / 20] tensor([[0.643, 0.629],
        [0.857, 0.841]]) {'epoch': 5, 'valid/acc': 73.671, 'valid/acc_unbiased': 74.454, 'valid/diff': 1.316, 'valid/acc_skew': 75.089, 'valid/acc_align': 73.819, 'test/acc': 73.713, 'test/acc_unbiased': 74.269, 'test/diff': 1.513, 'test/acc_skew': 74.319, 'test/acc_align': 74.219}
[5 / 20] best valid accuracy: 74.454 at epoch 5 
 best_stats: {'best_valid_epoch': 5, 'best_valid_valid/acc': 73.671, 'best_valid_valid/acc_unbiased': 74.454, 'best_valid_valid/diff': 1.316, 'best_valid_valid/acc_skew': 75.089, 'best_valid_valid/acc_align': 73.819, 'best_valid_test/acc': 73.713, 'best_valid_test/acc_unbiased': 74.269, 'best_valid_test/diff': 1.513, 'best_valid_test/acc_skew': 74.319, 'best_valid_test/acc_align': 74.219}
[5 / 20] best test accuracy: 74.269 at epoch 5 
 best_stats: {'best_test_epoch': 5, 'best_test_valid/acc': 73.671, 'best_test_valid/acc_unbiased': 74.454, 'best_test_valid/diff': 1.316, 'best_test_valid/acc_skew': 75.089, 'best_test_valid/acc_align': 73.819, 'best_test_test/acc': 73.713, 'best_test_test/acc_unbiased': 74.269, 'best_test_test/diff': 1.513, 'best_test_test/acc_skew': 74.319, 'best_test_test/acc_align': 74.219}
[6 / 20] Learning rate: 0.001 weight: 0.01
[6 / 20] Loss: 4.750930653484115 CE Loss: 0.5650178265606501 Con Loss: 4.745280473857115
[6 / 20] tensor([[0.823, 0.781],
        [0.628, 0.733]]) {'epoch': 6, 'valid/acc': 75.527, 'valid/acc_unbiased': 74.81, 'valid/diff': 6.121, 'valid/acc_skew': 71.75, 'valid/acc_align': 77.87, 'test/acc': 74.726, 'test/acc_unbiased': 74.105, 'test/diff': 7.301, 'test/acc_skew': 70.455, 'test/acc_align': 77.756}
[6 / 20] best valid accuracy: 74.810 at epoch 6 
 best_stats: {'best_valid_epoch': 6, 'best_valid_valid/acc': 75.527, 'best_valid_valid/acc_unbiased': 74.81, 'best_valid_valid/diff': 6.121, 'best_valid_valid/acc_skew': 71.75, 'best_valid_valid/acc_align': 77.87, 'best_valid_test/acc': 74.726, 'best_valid_test/acc_unbiased': 74.105, 'best_valid_test/diff': 7.301, 'best_valid_test/acc_skew': 70.455, 'best_valid_test/acc_align': 77.756}
[6 / 20] best test accuracy: 74.269 at epoch 5 
 best_stats: {'best_test_epoch': 5, 'best_test_valid/acc': 73.671, 'best_test_valid/acc_unbiased': 74.454, 'best_test_valid/diff': 1.316, 'best_test_valid/acc_skew': 75.089, 'best_test_valid/acc_align': 73.819, 'best_test_test/acc': 73.713, 'best_test_test/acc_unbiased': 74.269, 'best_test_test/diff': 1.513, 'best_test_test/acc_skew': 74.319, 'best_test_test/acc_align': 74.219}
[7 / 20] Learning rate: 0.0001 weight: 0.01
[7 / 20] Loss: 4.677434527507463 CE Loss: 0.5235013802089943 Con Loss: 4.672199527829842
[7 / 20] tensor([[0.751, 0.694],
        [0.829, 0.841]]) {'epoch': 7, 'valid/acc': 77.004, 'valid/acc_unbiased': 77.28, 'valid/diff': 3.712, 'valid/acc_skew': 75.424, 'valid/acc_align': 79.136, 'test/acc': 77.553, 'test/acc_unbiased': 77.879, 'test/diff': 3.433, 'test/acc_skew': 76.162, 'test/acc_align': 79.595}
[7 / 20] best valid accuracy: 77.280 at epoch 7 
 best_stats: {'best_valid_epoch': 7, 'best_valid_valid/acc': 77.004, 'best_valid_valid/acc_unbiased': 77.28, 'best_valid_valid/diff': 3.712, 'best_valid_valid/acc_skew': 75.424, 'best_valid_valid/acc_align': 79.136, 'best_valid_test/acc': 77.553, 'best_valid_test/acc_unbiased': 77.879, 'best_valid_test/diff': 3.433, 'best_valid_test/acc_skew': 76.162, 'best_valid_test/acc_align': 79.595}
[7 / 20] best test accuracy: 77.879 at epoch 7 
 best_stats: {'best_test_epoch': 7, 'best_test_valid/acc': 77.004, 'best_test_valid/acc_unbiased': 77.28, 'best_test_valid/diff': 3.712, 'best_test_valid/acc_skew': 75.424, 'best_test_valid/acc_align': 79.136, 'best_test_test/acc': 77.553, 'best_test_test/acc_unbiased': 77.879, 'best_test_test/diff': 3.433, 'best_test_test/acc_skew': 76.162, 'best_test_test/acc_align': 79.595}
[8 / 20] Learning rate: 0.0001 weight: 0.01
[8 / 20] Loss: 4.660444029951863 CE Loss: 0.5132291836235918 Con Loss: 4.655311779954946
[8 / 20] tensor([[0.803, 0.742],
        [0.749, 0.807]]) {'epoch': 8, 'valid/acc': 77.848, 'valid/acc_unbiased': 77.861, 'valid/diff': 4.501, 'valid/acc_skew': 75.61, 'valid/acc_align': 80.111, 'test/acc': 77.595, 'test/acc_unbiased': 77.503, 'test/diff': 5.964, 'test/acc_skew': 74.521, 'test/acc_align': 80.485}
[8 / 20] best valid accuracy: 77.861 at epoch 8 
 best_stats: {'best_valid_epoch': 8, 'best_valid_valid/acc': 77.848, 'best_valid_valid/acc_unbiased': 77.861, 'best_valid_valid/diff': 4.501, 'best_valid_valid/acc_skew': 75.61, 'best_valid_valid/acc_align': 80.111, 'best_valid_test/acc': 77.595, 'best_valid_test/acc_unbiased': 77.503, 'best_valid_test/diff': 5.964, 'best_valid_test/acc_skew': 74.521, 'best_valid_test/acc_align': 80.485}
[8 / 20] best test accuracy: 77.879 at epoch 7 
 best_stats: {'best_test_epoch': 7, 'best_test_valid/acc': 77.004, 'best_test_valid/acc_unbiased': 77.28, 'best_test_valid/diff': 3.712, 'best_test_valid/acc_skew': 75.424, 'best_test_valid/acc_align': 79.136, 'best_test_test/acc': 77.553, 'best_test_test/acc_unbiased': 77.879, 'best_test_test/diff': 3.433, 'best_test_test/acc_skew': 76.162, 'best_test_test/acc_align': 79.595}
[9 / 20] Learning rate: 0.0001 weight: 0.01
[9 / 20] Loss: 4.618091597214974 CE Loss: 0.516849698730653 Con Loss: 4.612923072686482
[9 / 20] tensor([[0.832, 0.759],
        [0.721, 0.793]]) {'epoch': 9, 'valid/acc': 78.481, 'valid/acc_unbiased': 78.412, 'valid/diff': 3.482, 'valid/acc_skew': 76.67, 'valid/acc_align': 80.153, 'test/acc': 77.848, 'test/acc_unbiased': 77.625, 'test/diff': 7.25, 'test/acc_skew': 74.001, 'test/acc_align': 81.25}
[9 / 20] best valid accuracy: 78.412 at epoch 9 
 best_stats: {'best_valid_epoch': 9, 'best_valid_valid/acc': 78.481, 'best_valid_valid/acc_unbiased': 78.412, 'best_valid_valid/diff': 3.482, 'best_valid_valid/acc_skew': 76.67, 'best_valid_valid/acc_align': 80.153, 'best_valid_test/acc': 77.848, 'best_valid_test/acc_unbiased': 77.625, 'best_valid_test/diff': 7.25, 'best_valid_test/acc_skew': 74.001, 'best_valid_test/acc_align': 81.25}
[9 / 20] best test accuracy: 77.879 at epoch 7 
 best_stats: {'best_test_epoch': 7, 'best_test_valid/acc': 77.004, 'best_test_valid/acc_unbiased': 77.28, 'best_test_valid/diff': 3.712, 'best_test_valid/acc_skew': 75.424, 'best_test_valid/acc_align': 79.136, 'best_test_test/acc': 77.553, 'best_test_test/acc_unbiased': 77.879, 'best_test_test/diff': 3.433, 'best_test_test/acc_skew': 76.162, 'best_test_test/acc_align': 79.595}
[10 / 20] Learning rate: 0.0001 weight: 0.01
[10 / 20] Loss: 4.617198453989769 CE Loss: 0.5074239120127342 Con Loss: 4.612124232212586
[10 / 20] tensor([[0.821, 0.713],
        [0.753, 0.819]]) {'epoch': 10, 'valid/acc': 77.679, 'valid/acc_unbiased': 77.719, 'valid/diff': 5.387, 'valid/acc_skew': 75.025, 'valid/acc_align': 80.412, 'test/acc': 77.637, 'test/acc_unbiased': 77.655, 'test/diff': 8.641, 'test/acc_skew': 73.334, 'test/acc_align': 81.976}
[10 / 20] best valid accuracy: 78.412 at epoch 9 
 best_stats: {'best_valid_epoch': 9, 'best_valid_valid/acc': 78.481, 'best_valid_valid/acc_unbiased': 78.412, 'best_valid_valid/diff': 3.482, 'best_valid_valid/acc_skew': 76.67, 'best_valid_valid/acc_align': 80.153, 'best_valid_test/acc': 77.848, 'best_valid_test/acc_unbiased': 77.625, 'best_valid_test/diff': 7.25, 'best_valid_test/acc_skew': 74.001, 'best_valid_test/acc_align': 81.25}
[10 / 20] best test accuracy: 77.879 at epoch 7 
 best_stats: {'best_test_epoch': 7, 'best_test_valid/acc': 77.004, 'best_test_valid/acc_unbiased': 77.28, 'best_test_valid/diff': 3.712, 'best_test_valid/acc_skew': 75.424, 'best_test_valid/acc_align': 79.136, 'best_test_test/acc': 77.553, 'best_test_test/acc_unbiased': 77.879, 'best_test_test/diff': 3.433, 'best_test_test/acc_skew': 76.162, 'best_test_test/acc_align': 79.595}
[11 / 20] Learning rate: 0.0001 weight: 0.01
[11 / 20] Loss: 4.599341758348233 CE Loss: 0.5055746615456628 Con Loss: 4.59428601174194
[11 / 20] tensor([[0.839, 0.765],
        [0.719, 0.790]]) {'epoch': 11, 'valid/acc': 78.65, 'valid/acc_unbiased': 78.418, 'valid/diff': 4.222, 'valid/acc_skew': 76.307, 'valid/acc_align': 80.529, 'test/acc': 78.059, 'test/acc_unbiased': 77.824, 'test/diff': 7.272, 'test/acc_skew': 74.188, 'test/acc_align': 81.46}
[11 / 20] best valid accuracy: 78.418 at epoch 11 
 best_stats: {'best_valid_epoch': 11, 'best_valid_valid/acc': 78.65, 'best_valid_valid/acc_unbiased': 78.418, 'best_valid_valid/diff': 4.222, 'best_valid_valid/acc_skew': 76.307, 'best_valid_valid/acc_align': 80.529, 'best_valid_test/acc': 78.059, 'best_valid_test/acc_unbiased': 77.824, 'best_valid_test/diff': 7.272, 'best_valid_test/acc_skew': 74.188, 'best_valid_test/acc_align': 81.46}
[11 / 20] best test accuracy: 77.879 at epoch 7 
 best_stats: {'best_test_epoch': 7, 'best_test_valid/acc': 77.004, 'best_test_valid/acc_unbiased': 77.28, 'best_test_valid/diff': 3.712, 'best_test_valid/acc_skew': 75.424, 'best_test_valid/acc_align': 79.136, 'best_test_test/acc': 77.553, 'best_test_test/acc_unbiased': 77.879, 'best_test_test/diff': 3.433, 'best_test_test/acc_skew': 76.162, 'best_test_test/acc_align': 79.595}
[12 / 20] Learning rate: 0.0001 weight: 0.01
[12 / 20] Loss: 4.583316028030865 CE Loss: 0.4945982057563033 Con Loss: 4.5783700384472334
[12 / 20] tensor([[0.860, 0.781],
        [0.710, 0.777]]) {'epoch': 12, 'valid/acc': 78.903, 'valid/acc_unbiased': 78.41, 'valid/diff': 6.025, 'valid/acc_skew': 75.397, 'valid/acc_align': 81.422, 'test/acc': 78.481, 'test/acc_unbiased': 78.217, 'test/diff': 7.299, 'test/acc_skew': 74.567, 'test/acc_align': 81.867}
[12 / 20] best valid accuracy: 78.418 at epoch 11 
 best_stats: {'best_valid_epoch': 11, 'best_valid_valid/acc': 78.65, 'best_valid_valid/acc_unbiased': 78.418, 'best_valid_valid/diff': 4.222, 'best_valid_valid/acc_skew': 76.307, 'best_valid_valid/acc_align': 80.529, 'best_valid_test/acc': 78.059, 'best_valid_test/acc_unbiased': 77.824, 'best_valid_test/diff': 7.272, 'best_valid_test/acc_skew': 74.188, 'best_valid_test/acc_align': 81.46}
[12 / 20] best test accuracy: 78.217 at epoch 12 
 best_stats: {'best_test_epoch': 12, 'best_test_valid/acc': 78.903, 'best_test_valid/acc_unbiased': 78.41, 'best_test_valid/diff': 6.025, 'best_test_valid/acc_skew': 75.397, 'best_test_valid/acc_align': 81.422, 'best_test_test/acc': 78.481, 'best_test_test/acc_unbiased': 78.217, 'best_test_test/diff': 7.299, 'best_test_test/acc_skew': 74.567, 'best_test_test/acc_align': 81.867}
[13 / 20] Learning rate: 0.0001 weight: 0.01
[13 / 20] Loss: 4.571322550710787 CE Loss: 0.4967010027754883 Con Loss: 4.566355532119774
[13 / 20] tensor([[0.830, 0.742],
        [0.740, 0.802]]) {'epoch': 13, 'valid/acc': 78.608, 'valid/acc_unbiased': 78.473, 'valid/diff': 5.284, 'valid/acc_skew': 75.831, 'valid/acc_align': 81.115, 'test/acc': 77.932, 'test/acc_unbiased': 77.847, 'test/diff': 7.518, 'test/acc_skew': 74.088, 'test/acc_align': 81.606}
[13 / 20] best valid accuracy: 78.473 at epoch 13 
 best_stats: {'best_valid_epoch': 13, 'best_valid_valid/acc': 78.608, 'best_valid_valid/acc_unbiased': 78.473, 'best_valid_valid/diff': 5.284, 'best_valid_valid/acc_skew': 75.831, 'best_valid_valid/acc_align': 81.115, 'best_valid_test/acc': 77.932, 'best_valid_test/acc_unbiased': 77.847, 'best_valid_test/diff': 7.518, 'best_valid_test/acc_skew': 74.088, 'best_valid_test/acc_align': 81.606}
[13 / 20] best test accuracy: 78.217 at epoch 12 
 best_stats: {'best_test_epoch': 12, 'best_test_valid/acc': 78.903, 'best_test_valid/acc_unbiased': 78.41, 'best_test_valid/diff': 6.025, 'best_test_valid/acc_skew': 75.397, 'best_test_valid/acc_align': 81.422, 'best_test_test/acc': 78.481, 'best_test_test/acc_unbiased': 78.217, 'best_test_test/diff': 7.299, 'best_test_test/acc_skew': 74.567, 'best_test_test/acc_align': 81.867}
[14 / 20] Learning rate: 1e-05 weight: 0.01
[14 / 20] Loss: 4.5670461005382625 CE Loss: 0.48858705621163634 Con Loss: 4.562160235023778
[14 / 20] tensor([[0.824, 0.742],
        [0.740, 0.811]]) {'epoch': 14, 'valid/acc': 78.608, 'valid/acc_unbiased': 78.571, 'valid/diff': 5.192, 'valid/acc_skew': 75.976, 'valid/acc_align': 81.167, 'test/acc': 78.059, 'test/acc_unbiased': 77.936, 'test/diff': 7.695, 'test/acc_skew': 74.088, 'test/acc_align': 81.783}
[14 / 20] best valid accuracy: 78.571 at epoch 14 
 best_stats: {'best_valid_epoch': 14, 'best_valid_valid/acc': 78.608, 'best_valid_valid/acc_unbiased': 78.571, 'best_valid_valid/diff': 5.192, 'best_valid_valid/acc_skew': 75.976, 'best_valid_valid/acc_align': 81.167, 'best_valid_test/acc': 78.059, 'best_valid_test/acc_unbiased': 77.936, 'best_valid_test/diff': 7.695, 'best_valid_test/acc_skew': 74.088, 'best_valid_test/acc_align': 81.783}
[14 / 20] best test accuracy: 78.217 at epoch 12 
 best_stats: {'best_test_epoch': 12, 'best_test_valid/acc': 78.903, 'best_test_valid/acc_unbiased': 78.41, 'best_test_valid/diff': 6.025, 'best_test_valid/acc_skew': 75.397, 'best_test_valid/acc_align': 81.422, 'best_test_test/acc': 78.481, 'best_test_test/acc_unbiased': 78.217, 'best_test_test/diff': 7.299, 'best_test_test/acc_skew': 74.567, 'best_test_test/acc_align': 81.867}
[15 / 20] Learning rate: 1e-05 weight: 0.01
[15 / 20] Loss: 4.548128802465659 CE Loss: 0.4815770049918972 Con Loss: 4.543313061335774
[15 / 20] tensor([[0.819, 0.710],
        [0.762, 0.828]]) {'epoch': 15, 'valid/acc': 78.608, 'valid/acc_unbiased': 78.704, 'valid/diff': 4.948, 'valid/acc_skew': 76.229, 'valid/acc_align': 81.178, 'test/acc': 77.932, 'test/acc_unbiased': 77.976, 'test/diff': 8.712, 'test/acc_skew': 73.62, 'test/acc_align': 82.332}
[15 / 20] best valid accuracy: 78.704 at epoch 15 
 best_stats: {'best_valid_epoch': 15, 'best_valid_valid/acc': 78.608, 'best_valid_valid/acc_unbiased': 78.704, 'best_valid_valid/diff': 4.948, 'best_valid_valid/acc_skew': 76.229, 'best_valid_valid/acc_align': 81.178, 'best_valid_test/acc': 77.932, 'best_valid_test/acc_unbiased': 77.976, 'best_valid_test/diff': 8.712, 'best_valid_test/acc_skew': 73.62, 'best_valid_test/acc_align': 82.332}
[15 / 20] best test accuracy: 78.217 at epoch 12 
 best_stats: {'best_test_epoch': 12, 'best_test_valid/acc': 78.903, 'best_test_valid/acc_unbiased': 78.41, 'best_test_valid/diff': 6.025, 'best_test_valid/acc_skew': 75.397, 'best_test_valid/acc_align': 81.422, 'best_test_test/acc': 78.481, 'best_test_test/acc_unbiased': 78.217, 'best_test_test/diff': 7.299, 'best_test_test/acc_skew': 74.567, 'best_test_test/acc_align': 81.867}
[16 / 20] Learning rate: 1e-05 weight: 0.01
[16 / 20] Loss: 4.562685370968865 CE Loss: 0.4821433725154592 Con Loss: 4.557863932228368
[16 / 20] tensor([[0.837, 0.737],
        [0.742, 0.811]]) {'epoch': 16, 'valid/acc': 78.354, 'valid/acc_unbiased': 78.288, 'valid/diff': 6.085, 'valid/acc_skew': 75.246, 'valid/acc_align': 81.33, 'test/acc': 78.27, 'test/acc_unbiased': 78.193, 'test/diff': 8.436, 'test/acc_skew': 73.975, 'test/acc_align': 82.411}
[16 / 20] best valid accuracy: 78.704 at epoch 15 
 best_stats: {'best_valid_epoch': 15, 'best_valid_valid/acc': 78.608, 'best_valid_valid/acc_unbiased': 78.704, 'best_valid_valid/diff': 4.948, 'best_valid_valid/acc_skew': 76.229, 'best_valid_valid/acc_align': 81.178, 'best_valid_test/acc': 77.932, 'best_valid_test/acc_unbiased': 77.976, 'best_valid_test/diff': 8.712, 'best_valid_test/acc_skew': 73.62, 'best_valid_test/acc_align': 82.332}
[16 / 20] best test accuracy: 78.217 at epoch 12 
 best_stats: {'best_test_epoch': 12, 'best_test_valid/acc': 78.903, 'best_test_valid/acc_unbiased': 78.41, 'best_test_valid/diff': 6.025, 'best_test_valid/acc_skew': 75.397, 'best_test_valid/acc_align': 81.422, 'best_test_test/acc': 78.481, 'best_test_test/acc_unbiased': 78.217, 'best_test_test/diff': 7.299, 'best_test_test/acc_skew': 74.567, 'best_test_test/acc_align': 81.867}
[17 / 20] Learning rate: 1e-05 weight: 0.01
[17 / 20] Loss: 4.543278794686581 CE Loss: 0.48152167215877884 Con Loss: 4.53846358135888
[17 / 20] tensor([[0.817, 0.706],
        [0.758, 0.828]]) {'epoch': 17, 'valid/acc': 78.903, 'valid/acc_unbiased': 79.004, 'valid/diff': 6.427, 'valid/acc_skew': 75.791, 'valid/acc_align': 82.217, 'test/acc': 77.679, 'test/acc_unbiased': 77.712, 'test/diff': 9.06, 'test/acc_skew': 73.182, 'test/acc_align': 82.242}
[17 / 20] best valid accuracy: 79.004 at epoch 17 
 best_stats: {'best_valid_epoch': 17, 'best_valid_valid/acc': 78.903, 'best_valid_valid/acc_unbiased': 79.004, 'best_valid_valid/diff': 6.427, 'best_valid_valid/acc_skew': 75.791, 'best_valid_valid/acc_align': 82.217, 'best_valid_test/acc': 77.679, 'best_valid_test/acc_unbiased': 77.712, 'best_valid_test/diff': 9.06, 'best_valid_test/acc_skew': 73.182, 'best_valid_test/acc_align': 82.242}
[17 / 20] best test accuracy: 78.217 at epoch 12 
 best_stats: {'best_test_epoch': 12, 'best_test_valid/acc': 78.903, 'best_test_valid/acc_unbiased': 78.41, 'best_test_valid/diff': 6.025, 'best_test_valid/acc_skew': 75.397, 'best_test_valid/acc_align': 81.422, 'best_test_test/acc': 78.481, 'best_test_test/acc_unbiased': 78.217, 'best_test_test/diff': 7.299, 'best_test_test/acc_skew': 74.567, 'best_test_test/acc_align': 81.867}
[18 / 20] Learning rate: 1e-05 weight: 0.01
[18 / 20] Loss: 4.529141103540646 CE Loss: 0.4773312138603512 Con Loss: 4.524367800917842
[18 / 20] tensor([[0.835, 0.737],
        [0.736, 0.813]]) {'epoch': 18, 'valid/acc': 78.945, 'valid/acc_unbiased': 78.818, 'valid/diff': 6.193, 'valid/acc_skew': 75.721, 'valid/acc_align': 81.914, 'test/acc': 78.143, 'test/acc_unbiased': 78.023, 'test/diff': 8.745, 'test/acc_skew': 73.65, 'test/acc_align': 82.395}
[18 / 20] best valid accuracy: 79.004 at epoch 17 
 best_stats: {'best_valid_epoch': 17, 'best_valid_valid/acc': 78.903, 'best_valid_valid/acc_unbiased': 79.004, 'best_valid_valid/diff': 6.427, 'best_valid_valid/acc_skew': 75.791, 'best_valid_valid/acc_align': 82.217, 'best_valid_test/acc': 77.679, 'best_valid_test/acc_unbiased': 77.712, 'best_valid_test/diff': 9.06, 'best_valid_test/acc_skew': 73.182, 'best_valid_test/acc_align': 82.242}
[18 / 20] best test accuracy: 78.217 at epoch 12 
 best_stats: {'best_test_epoch': 12, 'best_test_valid/acc': 78.903, 'best_test_valid/acc_unbiased': 78.41, 'best_test_valid/diff': 6.025, 'best_test_valid/acc_skew': 75.397, 'best_test_valid/acc_align': 81.422, 'best_test_test/acc': 78.481, 'best_test_test/acc_unbiased': 78.217, 'best_test_test/diff': 7.299, 'best_test_test/acc_skew': 74.567, 'best_test_test/acc_align': 81.867}
[19 / 20] Learning rate: 1e-05 weight: 0.01
[19 / 20] Loss: 4.549136471783259 CE Loss: 0.48787148395010527 Con Loss: 4.544257771392867
[19 / 20] tensor([[0.832, 0.727],
        [0.742, 0.820]]) {'epoch': 19, 'valid/acc': 78.776, 'valid/acc_unbiased': 78.74, 'valid/diff': 5.749, 'valid/acc_skew': 75.866, 'valid/acc_align': 81.615, 'test/acc': 78.101, 'test/acc_unbiased': 78.023, 'test/diff': 9.129, 'test/acc_skew': 73.458, 'test/acc_align': 82.587}
[19 / 20] best valid accuracy: 79.004 at epoch 17 
 best_stats: {'best_valid_epoch': 17, 'best_valid_valid/acc': 78.903, 'best_valid_valid/acc_unbiased': 79.004, 'best_valid_valid/diff': 6.427, 'best_valid_valid/acc_skew': 75.791, 'best_valid_valid/acc_align': 82.217, 'best_valid_test/acc': 77.679, 'best_valid_test/acc_unbiased': 77.712, 'best_valid_test/diff': 9.06, 'best_valid_test/acc_skew': 73.182, 'best_valid_test/acc_align': 82.242}
[19 / 20] best test accuracy: 78.217 at epoch 12 
 best_stats: {'best_test_epoch': 12, 'best_test_valid/acc': 78.903, 'best_test_valid/acc_unbiased': 78.41, 'best_test_valid/diff': 6.025, 'best_test_valid/acc_skew': 75.397, 'best_test_valid/acc_align': 81.422, 'best_test_test/acc': 78.481, 'best_test_test/acc_unbiased': 78.217, 'best_test_test/diff': 7.299, 'best_test_test/acc_skew': 74.567, 'best_test_test/acc_align': 81.867}
[20 / 20] Learning rate: 1e-05 weight: 0.01
[20 / 20] Loss: 4.536582471336487 CE Loss: 0.4843939517898755 Con Loss: 4.5317385437547895
[20 / 20] tensor([[0.815, 0.715],
        [0.760, 0.831]]) {'epoch': 20, 'valid/acc': 78.354, 'valid/acc_unbiased': 78.39, 'valid/diff': 6.145, 'valid/acc_skew': 75.317, 'valid/acc_align': 81.462, 'test/acc': 78.017, 'test/acc_unbiased': 78.017, 'test/diff': 8.568, 'test/acc_skew': 73.733, 'test/acc_align': 82.301}
[20 / 20] best valid accuracy: 79.004 at epoch 17 
 best_stats: {'best_valid_epoch': 17, 'best_valid_valid/acc': 78.903, 'best_valid_valid/acc_unbiased': 79.004, 'best_valid_valid/diff': 6.427, 'best_valid_valid/acc_skew': 75.791, 'best_valid_valid/acc_align': 82.217, 'best_valid_test/acc': 77.679, 'best_valid_test/acc_unbiased': 77.712, 'best_valid_test/diff': 9.06, 'best_valid_test/acc_skew': 73.182, 'best_valid_test/acc_align': 82.242}
[20 / 20] best test accuracy: 78.217 at epoch 12 
 best_stats: {'best_test_epoch': 12, 'best_test_valid/acc': 78.903, 'best_test_valid/acc_unbiased': 78.41, 'best_test_valid/diff': 6.025, 'best_test_valid/acc_skew': 75.397, 'best_test_valid/acc_align': 81.422, 'best_test_test/acc': 78.481, 'best_test_test/acc_unbiased': 78.217, 'best_test_test/diff': 7.299, 'best_test_test/acc_skew': 74.567, 'best_test_test/acc_align': 81.867}
Total training time: 0:17:30
