Log level set to: INFO
Set seed: 3
=======> Using Fixed Random Seed: 3 <========
save_path: exp_results/bc-bb0-utk_face_age-os-0.9-lr0.001-bs128-cbs64-w0.01-ratio10-aug1-seed3
get_utk_face - split: train, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_age-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
Binary Target 1
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Normal Label Distribution: 
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [8237, 8237]
Target 1: [8237, 8237]
Binary Target 1
---------------------------
Target 0: [8237, 8237]
Target 1: [8237, 8237]
===================================
Normal Label Distribution: 
Target 0: [8237, 8237]
Target 1: [8237, 8237]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 32948, target_attr: gender, bias_attr: age bias_rate: 0.9
['[train] target_0-bias_0: 8237', '[train] target_0-bias_1: 8237', '[train] target_1-bias_0: 8237', '[train] target_1-bias_1: 8237']
confusion_matrix - 
 original: tensor([[8237., 8237.],
        [8237., 8237.]]), 
 normalized: tensor([[0.500, 0.500],
        [0.500, 0.500]]), 
 b|y: tensor([[0.500, 0.500],
        [0.500, 0.500]])
get_utk_face - split: train, aug: 1, given_y: True, ratio: 10
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_age-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
Binary Target 1
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Normal Label Distribution: 
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [8237, 8237]
Target 1: [8237, 8237]
Binary Target 1
---------------------------
Target 0: [8237, 8237]
Target 1: [8237, 8237]
===================================
Normal Label Distribution: 
Target 0: [8237, 8237]
Target 1: [8237, 8237]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 32948, target_attr: gender, bias_attr: age bias_rate: 0.9
['[train] target_0-bias_0: 8237', '[train] target_0-bias_1: 8237', '[train] target_1-bias_0: 8237', '[train] target_1-bias_1: 8237']
get_utk_face - split: valid, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_age-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [1030, 195]
Target 1: [841, 202]
Binary Target 1
---------------------------
Target 0: [1030, 195]
Target 1: [841, 202]
===================================
Normal Label Distribution: 
Target 0: [1030, 195]
Target 1: [841, 202]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 2268, target_attr: gender, bias_attr: age bias_rate: 0.9
['[valid] target_0-bias_0: 1030', '[valid] target_0-bias_1: 195', '[valid] target_1-bias_0: 841', '[valid] target_1-bias_1: 202']
get_utk_face - split: test, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_age-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [1061, 176]
Target 1: [867, 165]
Binary Target 1
---------------------------
Target 0: [1061, 176]
Target 1: [867, 165]
===================================
Normal Label Distribution: 
Target 0: [1061, 176]
Target 1: [867, 165]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 2269, target_attr: gender, bias_attr: age bias_rate: 0.9
['[test] target_0-bias_0: 1061', '[test] target_0-bias_1: 176', '[test] target_1-bias_0: 867', '[test] target_1-bias_1: 165']
decay_epochs: [6, 13]
[1 / 20] Learning rate: 0.001 weight: 0.01
[1 / 20] Loss: 4.842811117824079 CE Loss: 0.5489589556033162 Con Loss: 4.837321512354973
[1 / 20] tensor([[0.786, 0.568],
        [0.840, 0.764]]) {'epoch': 1, 'valid/acc': 77.425, 'valid/acc_unbiased': 72.12, 'valid/diff': 16.88, 'valid/acc_skew': 80.56, 'valid/acc_align': 63.68, 'test/acc': 78.801, 'test/acc_unbiased': 73.939, 'test/diff': 14.695, 'test/acc_skew': 81.286, 'test/acc_align': 66.591}
[1 / 20] best valid accuracy: 72.120 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 77.425, 'best_valid_valid/acc_unbiased': 72.12, 'best_valid_valid/diff': 16.88, 'best_valid_valid/acc_skew': 80.56, 'best_valid_valid/acc_align': 63.68, 'best_valid_test/acc': 78.801, 'best_valid_test/acc_unbiased': 73.939, 'best_valid_test/diff': 14.695, 'best_valid_test/acc_skew': 81.286, 'best_valid_test/acc_align': 66.591}
[1 / 20] best test accuracy: 73.939 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 77.425, 'best_test_valid/acc_unbiased': 72.12, 'best_test_valid/diff': 16.88, 'best_test_valid/acc_skew': 80.56, 'best_test_valid/acc_align': 63.68, 'best_test_test/acc': 78.801, 'best_test_test/acc_unbiased': 73.939, 'best_test_test/diff': 14.695, 'best_test_test/acc_skew': 81.286, 'best_test_test/acc_align': 66.591}
[2 / 20] Learning rate: 0.001 weight: 0.01
[2 / 20] Loss: 4.751036325241446 CE Loss: 0.4453880569158255 Con Loss: 4.7465824596914
[2 / 20] tensor([[0.914, 0.699],
        [0.700, 0.679]]) {'epoch': 2, 'valid/acc': 79.321, 'valid/acc_unbiased': 74.207, 'valid/diff': 12.828, 'valid/acc_skew': 80.621, 'valid/acc_align': 67.793, 'test/acc': 79.859, 'test/acc_unbiased': 74.8, 'test/diff': 11.835, 'test/acc_skew': 80.717, 'test/acc_align': 68.883}
[2 / 20] best valid accuracy: 74.207 at epoch 2 
 best_stats: {'best_valid_epoch': 2, 'best_valid_valid/acc': 79.321, 'best_valid_valid/acc_unbiased': 74.207, 'best_valid_valid/diff': 12.828, 'best_valid_valid/acc_skew': 80.621, 'best_valid_valid/acc_align': 67.793, 'best_valid_test/acc': 79.859, 'best_valid_test/acc_unbiased': 74.8, 'best_valid_test/diff': 11.835, 'best_valid_test/acc_skew': 80.717, 'best_valid_test/acc_align': 68.883}
[2 / 20] best test accuracy: 74.800 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 79.321, 'best_test_valid/acc_unbiased': 74.207, 'best_test_valid/diff': 12.828, 'best_test_valid/acc_skew': 80.621, 'best_test_valid/acc_align': 67.793, 'best_test_test/acc': 79.859, 'best_test_test/acc_unbiased': 74.8, 'best_test_test/diff': 11.835, 'best_test_test/acc_skew': 80.717, 'best_test_test/acc_align': 68.883}
[3 / 20] Learning rate: 0.001 weight: 0.01
[3 / 20] Loss: 4.701532487543923 CE Loss: 0.39373512118349263 Con Loss: 4.697595127059865
[3 / 20] tensor([[0.890, 0.540],
        [0.811, 0.800]]) {'epoch': 3, 'valid/acc': 81.173, 'valid/acc_unbiased': 74.05, 'valid/diff': 20.705, 'valid/acc_skew': 84.403, 'valid/acc_align': 63.698, 'test/acc': 82.591, 'test/acc_unbiased': 76.009, 'test/diff': 18.04, 'test/acc_skew': 85.028, 'test/acc_align': 66.989}
[3 / 20] best valid accuracy: 74.207 at epoch 2 
 best_stats: {'best_valid_epoch': 2, 'best_valid_valid/acc': 79.321, 'best_valid_valid/acc_unbiased': 74.207, 'best_valid_valid/diff': 12.828, 'best_valid_valid/acc_skew': 80.621, 'best_valid_valid/acc_align': 67.793, 'best_valid_test/acc': 79.859, 'best_valid_test/acc_unbiased': 74.8, 'best_valid_test/diff': 11.835, 'best_valid_test/acc_skew': 80.717, 'best_valid_test/acc_align': 68.883}
[3 / 20] best test accuracy: 76.009 at epoch 3 
 best_stats: {'best_test_epoch': 3, 'best_test_valid/acc': 81.173, 'best_test_valid/acc_unbiased': 74.05, 'best_test_valid/diff': 20.705, 'best_test_valid/acc_skew': 84.403, 'best_test_valid/acc_align': 63.698, 'best_test_test/acc': 82.591, 'best_test_test/acc_unbiased': 76.009, 'best_test_test/diff': 18.04, 'best_test_test/acc_skew': 85.028, 'best_test_test/acc_align': 66.989}
[4 / 20] Learning rate: 0.001 weight: 0.01
[4 / 20] Loss: 4.669877589117979 CE Loss: 0.3650059167210217 Con Loss: 4.666227525887276
[4 / 20] tensor([[0.922, 0.591],
        [0.798, 0.824]]) {'epoch': 4, 'valid/acc': 82.76, 'valid/acc_unbiased': 75.997, 'valid/diff': 22.427, 'valid/acc_skew': 85.529, 'valid/acc_align': 66.465, 'test/acc': 84.178, 'test/acc_unbiased': 78.377, 'test/diff': 17.848, 'test/acc_skew': 85.996, 'test/acc_align': 70.758}
[4 / 20] best valid accuracy: 75.997 at epoch 4 
 best_stats: {'best_valid_epoch': 4, 'best_valid_valid/acc': 82.76, 'best_valid_valid/acc_unbiased': 75.997, 'best_valid_valid/diff': 22.427, 'best_valid_valid/acc_skew': 85.529, 'best_valid_valid/acc_align': 66.465, 'best_valid_test/acc': 84.178, 'best_valid_test/acc_unbiased': 78.377, 'best_valid_test/diff': 17.848, 'best_valid_test/acc_skew': 85.996, 'best_valid_test/acc_align': 70.758}
[4 / 20] best test accuracy: 78.377 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 82.76, 'best_test_valid/acc_unbiased': 75.997, 'best_test_valid/diff': 22.427, 'best_test_valid/acc_skew': 85.529, 'best_test_valid/acc_align': 66.465, 'best_test_test/acc': 84.178, 'best_test_test/acc_unbiased': 78.377, 'best_test_test/diff': 17.848, 'best_test_test/acc_skew': 85.996, 'best_test_test/acc_align': 70.758}
[5 / 20] Learning rate: 0.001 weight: 0.01
[5 / 20] Loss: 4.637946633643081 CE Loss: 0.33492407740732705 Con Loss: 4.634597397579996
[5 / 20] tensor([[0.866, 0.449],
        [0.887, 0.848]]) {'epoch': 5, 'valid/acc': 83.598, 'valid/acc_unbiased': 76.146, 'valid/diff': 26.078, 'valid/acc_skew': 87.517, 'valid/acc_align': 64.775, 'test/acc': 84.046, 'test/acc_unbiased': 76.262, 'test/diff': 22.789, 'test/acc_skew': 87.657, 'test/acc_align': 64.867}
[5 / 20] best valid accuracy: 76.146 at epoch 5 
 best_stats: {'best_valid_epoch': 5, 'best_valid_valid/acc': 83.598, 'best_valid_valid/acc_unbiased': 76.146, 'best_valid_valid/diff': 26.078, 'best_valid_valid/acc_skew': 87.517, 'best_valid_valid/acc_align': 64.775, 'best_valid_test/acc': 84.046, 'best_valid_test/acc_unbiased': 76.262, 'best_valid_test/diff': 22.789, 'best_valid_test/acc_skew': 87.657, 'best_valid_test/acc_align': 64.867}
[5 / 20] best test accuracy: 78.377 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 82.76, 'best_test_valid/acc_unbiased': 75.997, 'best_test_valid/diff': 22.427, 'best_test_valid/acc_skew': 85.529, 'best_test_valid/acc_align': 66.465, 'best_test_test/acc': 84.178, 'best_test_test/acc_unbiased': 78.377, 'best_test_test/diff': 17.848, 'best_test_test/acc_skew': 85.996, 'best_test_test/acc_align': 70.758}
[6 / 20] Learning rate: 0.001 weight: 0.01
[6 / 20] Loss: 4.618489116028673 CE Loss: 0.3219021718464706 Con Loss: 4.615270081402333
[6 / 20] tensor([[0.911, 0.403],
        [0.830, 0.879]]) {'epoch': 6, 'valid/acc': 82.628, 'valid/acc_unbiased': 74.981, 'valid/diff': 33.089, 'valid/acc_skew': 85.973, 'valid/acc_align': 63.988, 'test/acc': 83.87, 'test/acc_unbiased': 75.601, 'test/diff': 27.817, 'test/acc_skew': 87.093, 'test/acc_align': 64.11}
[6 / 20] best valid accuracy: 76.146 at epoch 5 
 best_stats: {'best_valid_epoch': 5, 'best_valid_valid/acc': 83.598, 'best_valid_valid/acc_unbiased': 76.146, 'best_valid_valid/diff': 26.078, 'best_valid_valid/acc_skew': 87.517, 'best_valid_valid/acc_align': 64.775, 'best_valid_test/acc': 84.046, 'best_valid_test/acc_unbiased': 76.262, 'best_valid_test/diff': 22.789, 'best_valid_test/acc_skew': 87.657, 'best_valid_test/acc_align': 64.867}
[6 / 20] best test accuracy: 78.377 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 82.76, 'best_test_valid/acc_unbiased': 75.997, 'best_test_valid/diff': 22.427, 'best_test_valid/acc_skew': 85.529, 'best_test_valid/acc_align': 66.465, 'best_test_test/acc': 84.178, 'best_test_test/acc_unbiased': 78.377, 'best_test_test/diff': 17.848, 'best_test_test/acc_skew': 85.996, 'best_test_test/acc_align': 70.758}
[7 / 20] Learning rate: 0.0001 weight: 0.01
[7 / 20] Loss: 4.531136155114007 CE Loss: 0.2596544335301501 Con Loss: 4.528539614464974
[7 / 20] tensor([[0.922, 0.398],
        [0.850, 0.921]]) {'epoch': 7, 'valid/acc': 84.48, 'valid/acc_unbiased': 76.79, 'valid/diff': 32.597, 'valid/acc_skew': 87.814, 'valid/acc_align': 65.765, 'test/acc': 85.368, 'test/acc_unbiased': 77.269, 'test/diff': 29.76, 'test/acc_skew': 88.591, 'test/acc_align': 65.947}
[7 / 20] best valid accuracy: 76.790 at epoch 7 
 best_stats: {'best_valid_epoch': 7, 'best_valid_valid/acc': 84.48, 'best_valid_valid/acc_unbiased': 76.79, 'best_valid_valid/diff': 32.597, 'best_valid_valid/acc_skew': 87.814, 'best_valid_valid/acc_align': 65.765, 'best_valid_test/acc': 85.368, 'best_valid_test/acc_unbiased': 77.269, 'best_valid_test/diff': 29.76, 'best_valid_test/acc_skew': 88.591, 'best_valid_test/acc_align': 65.947}
[7 / 20] best test accuracy: 78.377 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 82.76, 'best_test_valid/acc_unbiased': 75.997, 'best_test_valid/diff': 22.427, 'best_test_valid/acc_skew': 85.529, 'best_test_valid/acc_align': 66.465, 'best_test_test/acc': 84.178, 'best_test_test/acc_unbiased': 78.377, 'best_test_test/diff': 17.848, 'best_test_test/acc_skew': 85.996, 'best_test_test/acc_align': 70.758}
[8 / 20] Learning rate: 0.0001 weight: 0.01
[8 / 20] Loss: 4.4899526761981114 CE Loss: 0.23490123373147742 Con Loss: 4.487603673834209
[8 / 20] tensor([[0.913, 0.381],
        [0.858, 0.933]]) {'epoch': 8, 'valid/acc': 84.303, 'valid/acc_unbiased': 76.134, 'valid/diff': 32.936, 'valid/acc_skew': 88.042, 'valid/acc_align': 64.227, 'test/acc': 85.236, 'test/acc_unbiased': 77.136, 'test/diff': 30.39, 'test/acc_skew': 88.571, 'test/acc_align': 65.701}
[8 / 20] best valid accuracy: 76.790 at epoch 7 
 best_stats: {'best_valid_epoch': 7, 'best_valid_valid/acc': 84.48, 'best_valid_valid/acc_unbiased': 76.79, 'best_valid_valid/diff': 32.597, 'best_valid_valid/acc_skew': 87.814, 'best_valid_valid/acc_align': 65.765, 'best_valid_test/acc': 85.368, 'best_valid_test/acc_unbiased': 77.269, 'best_valid_test/diff': 29.76, 'best_valid_test/acc_skew': 88.591, 'best_valid_test/acc_align': 65.947}
[8 / 20] best test accuracy: 78.377 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 82.76, 'best_test_valid/acc_unbiased': 75.997, 'best_test_valid/diff': 22.427, 'best_test_valid/acc_skew': 85.529, 'best_test_valid/acc_align': 66.465, 'best_test_test/acc': 84.178, 'best_test_test/acc_unbiased': 78.377, 'best_test_test/diff': 17.848, 'best_test_test/acc_skew': 85.996, 'best_test_test/acc_align': 70.758}
[9 / 20] Learning rate: 0.0001 weight: 0.01
[9 / 20] Loss: 4.446142123656408 CE Loss: 0.21669204897805008 Con Loss: 4.443975211723895
[9 / 20] tensor([[0.902, 0.381],
        [0.877, 0.927]]) {'epoch': 9, 'valid/acc': 84.832, 'valid/acc_unbiased': 76.307, 'valid/diff': 35.281, 'valid/acc_skew': 88.961, 'valid/acc_align': 63.652, 'test/acc': 85.368, 'test/acc_unbiased': 77.163, 'test/diff': 28.599, 'test/acc_skew': 88.928, 'test/acc_align': 65.398}
[9 / 20] best valid accuracy: 76.790 at epoch 7 
 best_stats: {'best_valid_epoch': 7, 'best_valid_valid/acc': 84.48, 'best_valid_valid/acc_unbiased': 76.79, 'best_valid_valid/diff': 32.597, 'best_valid_valid/acc_skew': 87.814, 'best_valid_valid/acc_align': 65.765, 'best_valid_test/acc': 85.368, 'best_valid_test/acc_unbiased': 77.269, 'best_valid_test/diff': 29.76, 'best_valid_test/acc_skew': 88.591, 'best_valid_test/acc_align': 65.947}
[9 / 20] best test accuracy: 78.377 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 82.76, 'best_test_valid/acc_unbiased': 75.997, 'best_test_valid/diff': 22.427, 'best_test_valid/acc_skew': 85.529, 'best_test_valid/acc_align': 66.465, 'best_test_test/acc': 84.178, 'best_test_test/acc_unbiased': 78.377, 'best_test_test/diff': 17.848, 'best_test_test/acc_skew': 85.996, 'best_test_test/acc_align': 70.758}
[10 / 20] Learning rate: 0.0001 weight: 0.01
[10 / 20] Loss: 4.454925059924879 CE Loss: 0.2161408534642778 Con Loss: 4.452763651852123
[10 / 20] tensor([[0.923, 0.386],
        [0.859, 0.945]]) {'epoch': 10, 'valid/acc': 84.788, 'valid/acc_unbiased': 76.315, 'valid/diff': 33.847, 'valid/acc_skew': 88.668, 'valid/acc_align': 63.962, 'test/acc': 85.853, 'test/acc_unbiased': 77.845, 'test/diff': 31.126, 'test/acc_skew': 89.1, 'test/acc_align': 66.591}
[10 / 20] best valid accuracy: 76.790 at epoch 7 
 best_stats: {'best_valid_epoch': 7, 'best_valid_valid/acc': 84.48, 'best_valid_valid/acc_unbiased': 76.79, 'best_valid_valid/diff': 32.597, 'best_valid_valid/acc_skew': 87.814, 'best_valid_valid/acc_align': 65.765, 'best_valid_test/acc': 85.368, 'best_valid_test/acc_unbiased': 77.269, 'best_valid_test/diff': 29.76, 'best_valid_test/acc_skew': 88.591, 'best_valid_test/acc_align': 65.947}
[10 / 20] best test accuracy: 78.377 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 82.76, 'best_test_valid/acc_unbiased': 75.997, 'best_test_valid/diff': 22.427, 'best_test_valid/acc_skew': 85.529, 'best_test_valid/acc_align': 66.465, 'best_test_test/acc': 84.178, 'best_test_test/acc_unbiased': 78.377, 'best_test_test/diff': 17.848, 'best_test_test/acc_skew': 85.996, 'best_test_test/acc_align': 70.758}
[11 / 20] Learning rate: 0.0001 weight: 0.01
[11 / 20] Loss: 4.441028838628297 CE Loss: 0.20677920252073878 Con Loss: 4.438961055797759
[11 / 20] tensor([[0.926, 0.330],
        [0.870, 0.945]]) {'epoch': 11, 'valid/acc': 84.347, 'valid/acc_unbiased': 75.651, 'valid/diff': 36.777, 'valid/acc_skew': 88.409, 'valid/acc_align': 62.892, 'test/acc': 85.985, 'test/acc_unbiased': 76.779, 'test/diff': 33.636, 'test/acc_skew': 89.807, 'test/acc_align': 63.75}
[11 / 20] best valid accuracy: 76.790 at epoch 7 
 best_stats: {'best_valid_epoch': 7, 'best_valid_valid/acc': 84.48, 'best_valid_valid/acc_unbiased': 76.79, 'best_valid_valid/diff': 32.597, 'best_valid_valid/acc_skew': 87.814, 'best_valid_valid/acc_align': 65.765, 'best_valid_test/acc': 85.368, 'best_valid_test/acc_unbiased': 77.269, 'best_valid_test/diff': 29.76, 'best_valid_test/acc_skew': 88.591, 'best_valid_test/acc_align': 65.947}
[11 / 20] best test accuracy: 78.377 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 82.76, 'best_test_valid/acc_unbiased': 75.997, 'best_test_valid/diff': 22.427, 'best_test_valid/acc_skew': 85.529, 'best_test_valid/acc_align': 66.465, 'best_test_test/acc': 84.178, 'best_test_test/acc_unbiased': 78.377, 'best_test_test/diff': 17.848, 'best_test_test/acc_skew': 85.996, 'best_test_test/acc_align': 70.758}
[12 / 20] Learning rate: 0.0001 weight: 0.01
[12 / 20] Loss: 4.438205074624296 CE Loss: 0.20035345243809943 Con Loss: 4.43620152813262
[12 / 20] tensor([[0.938, 0.358],
        [0.848, 0.933]]) {'epoch': 12, 'valid/acc': 84.7, 'valid/acc_unbiased': 76.427, 'valid/diff': 34.904, 'valid/acc_skew': 88.397, 'valid/acc_align': 64.457, 'test/acc': 85.809, 'test/acc_unbiased': 76.921, 'test/diff': 33.271, 'test/acc_skew': 89.277, 'test/acc_align': 64.564}
[12 / 20] best valid accuracy: 76.790 at epoch 7 
 best_stats: {'best_valid_epoch': 7, 'best_valid_valid/acc': 84.48, 'best_valid_valid/acc_unbiased': 76.79, 'best_valid_valid/diff': 32.597, 'best_valid_valid/acc_skew': 87.814, 'best_valid_valid/acc_align': 65.765, 'best_valid_test/acc': 85.368, 'best_valid_test/acc_unbiased': 77.269, 'best_valid_test/diff': 29.76, 'best_valid_test/acc_skew': 88.591, 'best_valid_test/acc_align': 65.947}
[12 / 20] best test accuracy: 78.377 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 82.76, 'best_test_valid/acc_unbiased': 75.997, 'best_test_valid/diff': 22.427, 'best_test_valid/acc_skew': 85.529, 'best_test_valid/acc_align': 66.465, 'best_test_test/acc': 84.178, 'best_test_test/acc_unbiased': 78.377, 'best_test_test/diff': 17.848, 'best_test_test/acc_skew': 85.996, 'best_test_test/acc_align': 70.758}
[13 / 20] Learning rate: 0.0001 weight: 0.01
[13 / 20] Loss: 4.418136724500065 CE Loss: 0.1973159872018062 Con Loss: 4.416163572686758
[13 / 20] tensor([[0.927, 0.347],
        [0.862, 0.939]]) {'epoch': 13, 'valid/acc': 84.083, 'valid/acc_unbiased': 75.014, 'valid/diff': 39.614, 'valid/acc_skew': 88.171, 'valid/acc_align': 61.857, 'test/acc': 85.809, 'test/acc_unbiased': 76.875, 'test/diff': 32.932, 'test/acc_skew': 89.451, 'test/acc_align': 64.299}
[13 / 20] best valid accuracy: 76.790 at epoch 7 
 best_stats: {'best_valid_epoch': 7, 'best_valid_valid/acc': 84.48, 'best_valid_valid/acc_unbiased': 76.79, 'best_valid_valid/diff': 32.597, 'best_valid_valid/acc_skew': 87.814, 'best_valid_valid/acc_align': 65.765, 'best_valid_test/acc': 85.368, 'best_valid_test/acc_unbiased': 77.269, 'best_valid_test/diff': 29.76, 'best_valid_test/acc_skew': 88.591, 'best_valid_test/acc_align': 65.947}
[13 / 20] best test accuracy: 78.377 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 82.76, 'best_test_valid/acc_unbiased': 75.997, 'best_test_valid/diff': 22.427, 'best_test_valid/acc_skew': 85.529, 'best_test_valid/acc_align': 66.465, 'best_test_test/acc': 84.178, 'best_test_test/acc_unbiased': 78.377, 'best_test_test/diff': 17.848, 'best_test_test/acc_skew': 85.996, 'best_test_test/acc_align': 70.758}
[14 / 20] Learning rate: 1e-05 weight: 0.01
[14 / 20] Loss: 4.404095099709545 CE Loss: 0.18839449030697106 Con Loss: 4.40221114446342
[14 / 20] tensor([[0.933, 0.358],
        [0.862, 0.939]]) {'epoch': 14, 'valid/acc': 84.083, 'valid/acc_unbiased': 74.63, 'valid/diff': 39.79, 'valid/acc_skew': 88.419, 'valid/acc_align': 60.84, 'test/acc': 86.161, 'test/acc_unbiased': 77.301, 'test/diff': 32.646, 'test/acc_skew': 89.734, 'test/acc_align': 64.867}
[14 / 20] best valid accuracy: 76.790 at epoch 7 
 best_stats: {'best_valid_epoch': 7, 'best_valid_valid/acc': 84.48, 'best_valid_valid/acc_unbiased': 76.79, 'best_valid_valid/diff': 32.597, 'best_valid_valid/acc_skew': 87.814, 'best_valid_valid/acc_align': 65.765, 'best_valid_test/acc': 85.368, 'best_valid_test/acc_unbiased': 77.269, 'best_valid_test/diff': 29.76, 'best_valid_test/acc_skew': 88.591, 'best_valid_test/acc_align': 65.947}
[14 / 20] best test accuracy: 78.377 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 82.76, 'best_test_valid/acc_unbiased': 75.997, 'best_test_valid/diff': 22.427, 'best_test_valid/acc_skew': 85.529, 'best_test_valid/acc_align': 66.465, 'best_test_test/acc': 84.178, 'best_test_test/acc_unbiased': 78.377, 'best_test_test/diff': 17.848, 'best_test_test/acc_skew': 85.996, 'best_test_test/acc_align': 70.758}
[15 / 20] Learning rate: 1e-05 weight: 0.01
[15 / 20] Loss: 4.40475481674048 CE Loss: 0.18661064329773416 Con Loss: 4.402888717850508
[15 / 20] tensor([[0.928, 0.352],
        [0.863, 0.945]]) {'epoch': 15, 'valid/acc': 84.392, 'valid/acc_unbiased': 75.431, 'valid/diff': 38.984, 'valid/acc_skew': 88.501, 'valid/acc_align': 62.361, 'test/acc': 85.985, 'test/acc_unbiased': 77.221, 'test/diff': 32.94, 'test/acc_skew': 89.556, 'test/acc_align': 64.886}
[15 / 20] best valid accuracy: 76.790 at epoch 7 
 best_stats: {'best_valid_epoch': 7, 'best_valid_valid/acc': 84.48, 'best_valid_valid/acc_unbiased': 76.79, 'best_valid_valid/diff': 32.597, 'best_valid_valid/acc_skew': 87.814, 'best_valid_valid/acc_align': 65.765, 'best_valid_test/acc': 85.368, 'best_valid_test/acc_unbiased': 77.269, 'best_valid_test/diff': 29.76, 'best_valid_test/acc_skew': 88.591, 'best_valid_test/acc_align': 65.947}
[15 / 20] best test accuracy: 78.377 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 82.76, 'best_test_valid/acc_unbiased': 75.997, 'best_test_valid/diff': 22.427, 'best_test_valid/acc_skew': 85.529, 'best_test_valid/acc_align': 66.465, 'best_test_test/acc': 84.178, 'best_test_test/acc_unbiased': 78.377, 'best_test_test/diff': 17.848, 'best_test_test/acc_skew': 85.996, 'best_test_test/acc_align': 70.758}
[16 / 20] Learning rate: 1e-05 weight: 0.01
[16 / 20] Loss: 4.395652054669398 CE Loss: 0.18703635228704854 Con Loss: 4.39378168184346
[16 / 20] tensor([[0.937, 0.364],
        [0.856, 0.939]]) {'epoch': 16, 'valid/acc': 84.392, 'valid/acc_unbiased': 75.505, 'valid/diff': 38.427, 'valid/acc_skew': 88.376, 'valid/acc_align': 62.635, 'test/acc': 86.161, 'test/acc_unbiased': 77.393, 'test/diff': 32.839, 'test/acc_skew': 89.634, 'test/acc_align': 65.152}
[16 / 20] best valid accuracy: 76.790 at epoch 7 
 best_stats: {'best_valid_epoch': 7, 'best_valid_valid/acc': 84.48, 'best_valid_valid/acc_unbiased': 76.79, 'best_valid_valid/diff': 32.597, 'best_valid_valid/acc_skew': 87.814, 'best_valid_valid/acc_align': 65.765, 'best_valid_test/acc': 85.368, 'best_valid_test/acc_unbiased': 77.269, 'best_valid_test/diff': 29.76, 'best_valid_test/acc_skew': 88.591, 'best_valid_test/acc_align': 65.947}
[16 / 20] best test accuracy: 78.377 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 82.76, 'best_test_valid/acc_unbiased': 75.997, 'best_test_valid/diff': 22.427, 'best_test_valid/acc_skew': 85.529, 'best_test_valid/acc_align': 66.465, 'best_test_test/acc': 84.178, 'best_test_test/acc_unbiased': 78.377, 'best_test_test/diff': 17.848, 'best_test_test/acc_skew': 85.996, 'best_test_test/acc_align': 70.758}
[17 / 20] Learning rate: 1e-05 weight: 0.01
[17 / 20] Loss: 4.397791159186271 CE Loss: 0.18478136435576228 Con Loss: 4.3959433406363475
[17 / 20] tensor([[0.939, 0.386],
        [0.856, 0.939]]) {'epoch': 17, 'valid/acc': 84.347, 'valid/acc_unbiased': 75.491, 'valid/diff': 37.766, 'valid/acc_skew': 88.338, 'valid/acc_align': 62.644, 'test/acc': 86.426, 'test/acc_unbiased': 78.008, 'test/diff': 31.797, 'test/acc_skew': 89.728, 'test/acc_align': 66.288}
[17 / 20] best valid accuracy: 76.790 at epoch 7 
 best_stats: {'best_valid_epoch': 7, 'best_valid_valid/acc': 84.48, 'best_valid_valid/acc_unbiased': 76.79, 'best_valid_valid/diff': 32.597, 'best_valid_valid/acc_skew': 87.814, 'best_valid_valid/acc_align': 65.765, 'best_valid_test/acc': 85.368, 'best_valid_test/acc_unbiased': 77.269, 'best_valid_test/diff': 29.76, 'best_valid_test/acc_skew': 88.591, 'best_valid_test/acc_align': 65.947}
[17 / 20] best test accuracy: 78.377 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 82.76, 'best_test_valid/acc_unbiased': 75.997, 'best_test_valid/diff': 22.427, 'best_test_valid/acc_skew': 85.529, 'best_test_valid/acc_align': 66.465, 'best_test_test/acc': 84.178, 'best_test_test/acc_unbiased': 78.377, 'best_test_test/diff': 17.848, 'best_test_test/acc_skew': 85.996, 'best_test_test/acc_align': 70.758}
[18 / 20] Learning rate: 1e-05 weight: 0.01
[18 / 20] Loss: 4.395838651579532 CE Loss: 0.186900707297104 Con Loss: 4.393969656238137
[18 / 20] tensor([[0.936, 0.358],
        [0.856, 0.939]]) {'epoch': 18, 'valid/acc': 84.436, 'valid/acc_unbiased': 75.634, 'valid/diff': 38.17, 'valid/acc_skew': 88.376, 'valid/acc_align': 62.892, 'test/acc': 86.073, 'test/acc_unbiased': 77.227, 'test/diff': 33.076, 'test/acc_skew': 89.587, 'test/acc_align': 64.867}
[18 / 20] best valid accuracy: 76.790 at epoch 7 
 best_stats: {'best_valid_epoch': 7, 'best_valid_valid/acc': 84.48, 'best_valid_valid/acc_unbiased': 76.79, 'best_valid_valid/diff': 32.597, 'best_valid_valid/acc_skew': 87.814, 'best_valid_valid/acc_align': 65.765, 'best_valid_test/acc': 85.368, 'best_valid_test/acc_unbiased': 77.269, 'best_valid_test/diff': 29.76, 'best_valid_test/acc_skew': 88.591, 'best_valid_test/acc_align': 65.947}
[18 / 20] best test accuracy: 78.377 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 82.76, 'best_test_valid/acc_unbiased': 75.997, 'best_test_valid/diff': 22.427, 'best_test_valid/acc_skew': 85.529, 'best_test_valid/acc_align': 66.465, 'best_test_test/acc': 84.178, 'best_test_test/acc_unbiased': 78.377, 'best_test_test/diff': 17.848, 'best_test_test/acc_skew': 85.996, 'best_test_test/acc_align': 70.758}
[19 / 20] Learning rate: 1e-05 weight: 0.01
[19 / 20] Loss: 4.387984222559381 CE Loss: 0.18242290263993946 Con Loss: 4.386159995494572
[19 / 20] tensor([[0.939, 0.381],
        [0.854, 0.933]]) {'epoch': 19, 'valid/acc': 84.48, 'valid/acc_unbiased': 75.947, 'valid/diff': 37.34, 'valid/acc_skew': 88.224, 'valid/acc_align': 63.67, 'test/acc': 86.249, 'test/acc_unbiased': 77.657, 'test/diff': 31.894, 'test/acc_skew': 89.613, 'test/acc_align': 65.701}
[19 / 20] best valid accuracy: 76.790 at epoch 7 
 best_stats: {'best_valid_epoch': 7, 'best_valid_valid/acc': 84.48, 'best_valid_valid/acc_unbiased': 76.79, 'best_valid_valid/diff': 32.597, 'best_valid_valid/acc_skew': 87.814, 'best_valid_valid/acc_align': 65.765, 'best_valid_test/acc': 85.368, 'best_valid_test/acc_unbiased': 77.269, 'best_valid_test/diff': 29.76, 'best_valid_test/acc_skew': 88.591, 'best_valid_test/acc_align': 65.947}
[19 / 20] best test accuracy: 78.377 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 82.76, 'best_test_valid/acc_unbiased': 75.997, 'best_test_valid/diff': 22.427, 'best_test_valid/acc_skew': 85.529, 'best_test_valid/acc_align': 66.465, 'best_test_test/acc': 84.178, 'best_test_test/acc_unbiased': 78.377, 'best_test_test/diff': 17.848, 'best_test_test/acc_skew': 85.996, 'best_test_test/acc_align': 70.758}
[20 / 20] Learning rate: 1e-05 weight: 0.01
[20 / 20] Loss: 4.38685600042951 CE Loss: 0.18402413995474073 Con Loss: 4.385015761836344
[20 / 20] tensor([[0.945, 0.369],
        [0.848, 0.933]]) {'epoch': 20, 'valid/acc': 84.48, 'valid/acc_unbiased': 75.951, 'valid/diff': 36.836, 'valid/acc_skew': 88.224, 'valid/acc_align': 63.679, 'test/acc': 86.249, 'test/acc_unbiased': 77.393, 'test/diff': 33.08, 'test/acc_skew': 89.654, 'test/acc_align': 65.133}
[20 / 20] best valid accuracy: 76.790 at epoch 7 
 best_stats: {'best_valid_epoch': 7, 'best_valid_valid/acc': 84.48, 'best_valid_valid/acc_unbiased': 76.79, 'best_valid_valid/diff': 32.597, 'best_valid_valid/acc_skew': 87.814, 'best_valid_valid/acc_align': 65.765, 'best_valid_test/acc': 85.368, 'best_valid_test/acc_unbiased': 77.269, 'best_valid_test/diff': 29.76, 'best_valid_test/acc_skew': 88.591, 'best_valid_test/acc_align': 65.947}
[20 / 20] best test accuracy: 78.377 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 82.76, 'best_test_valid/acc_unbiased': 75.997, 'best_test_valid/diff': 22.427, 'best_test_valid/acc_skew': 85.529, 'best_test_valid/acc_align': 66.465, 'best_test_test/acc': 84.178, 'best_test_test/acc_unbiased': 78.377, 'best_test_test/diff': 17.848, 'best_test_test/acc_skew': 85.996, 'best_test_test/acc_align': 70.758}
Total training time: 1:01:37
