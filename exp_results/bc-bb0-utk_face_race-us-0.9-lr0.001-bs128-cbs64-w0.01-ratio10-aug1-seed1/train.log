Log level set to: INFO
Set seed: 1
=======> Using Fixed Random Seed: 1 <========
save_path: exp_results/bc-bb0-utk_face_race-us-0.9-lr0.001-bs128-cbs64-w0.01-ratio10-aug1-seed1
get_utk_face - split: train, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_race-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [4407, 552]
Target 1: [440, 5529]
Binary Target 1
---------------------------
Target 0: [4407, 552]
Target 1: [440, 5529]
===================================
Normal Label Distribution: 
Target 0: [4407, 552]
Target 1: [440, 5529]
===================================
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [440, 440]
Target 1: [440, 440]
Binary Target 1
---------------------------
Target 0: [440, 440]
Target 1: [440, 440]
===================================
Normal Label Distribution: 
Target 0: [440, 440]
Target 1: [440, 440]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 1760, target_attr: gender, bias_attr: race bias_rate: 0.9
['[train] target_0-bias_0: 440', '[train] target_0-bias_1: 440', '[train] target_1-bias_0: 440', '[train] target_1-bias_1: 440']
confusion_matrix - 
 original: tensor([[440., 440.],
        [440., 440.]]), 
 normalized: tensor([[0.500, 0.500],
        [0.500, 0.500]]), 
 b|y: tensor([[0.500, 0.500],
        [0.500, 0.500]])
get_utk_face - split: train, aug: 1, given_y: True, ratio: 10
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_race-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [4407, 552]
Target 1: [440, 5529]
Binary Target 1
---------------------------
Target 0: [4407, 552]
Target 1: [440, 5529]
===================================
Normal Label Distribution: 
Target 0: [4407, 552]
Target 1: [440, 5529]
===================================
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [440, 440]
Target 1: [440, 440]
Binary Target 1
---------------------------
Target 0: [440, 440]
Target 1: [440, 440]
===================================
Normal Label Distribution: 
Target 0: [440, 440]
Target 1: [440, 440]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 1760, target_attr: gender, bias_attr: race bias_rate: 0.9
['[train] target_0-bias_0: 440', '[train] target_0-bias_1: 440', '[train] target_1-bias_0: 440', '[train] target_1-bias_1: 440']
get_utk_face - split: valid, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_race-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [583, 684]
Target 1: [457, 646]
Binary Target 1
---------------------------
Target 0: [583, 684]
Target 1: [457, 646]
===================================
Normal Label Distribution: 
Target 0: [583, 684]
Target 1: [457, 646]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 2370, target_attr: gender, bias_attr: race bias_rate: 0.9
['[valid] target_0-bias_0: 583', '[valid] target_0-bias_1: 684', '[valid] target_1-bias_0: 457', '[valid] target_1-bias_1: 646']
get_utk_face - split: test, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_race-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [558, 677]
Target 1: [462, 673]
Binary Target 1
---------------------------
Target 0: [558, 677]
Target 1: [462, 673]
===================================
Normal Label Distribution: 
Target 0: [558, 677]
Target 1: [462, 673]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 2370, target_attr: gender, bias_attr: race bias_rate: 0.9
['[test] target_0-bias_0: 558', '[test] target_0-bias_1: 677', '[test] target_1-bias_0: 462', '[test] target_1-bias_1: 673']
decay_epochs: [6, 13]
[1 / 20] Learning rate: 0.001 weight: 0.01
[1 / 20] Loss: 5.173320735584606 CE Loss: 0.6879742914980108 Con Loss: 5.166441033103249
[1 / 20] tensor([[0.948, 0.908],
        [0.268, 0.349]]) {'epoch': 1, 'valid/acc': 62.532, 'valid/acc_unbiased': 60.258, 'valid/diff': 1.935, 'valid/acc_skew': 59.731, 'valid/acc_align': 60.784, 'test/acc': 63.418, 'test/acc_unbiased': 61.851, 'test/diff': 6.02, 'test/acc_skew': 60.821, 'test/acc_align': 62.88}
[1 / 20] best valid accuracy: 60.258 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 62.532, 'best_valid_valid/acc_unbiased': 60.258, 'best_valid_valid/diff': 1.935, 'best_valid_valid/acc_skew': 59.731, 'best_valid_valid/acc_align': 60.784, 'best_valid_test/acc': 63.418, 'best_valid_test/acc_unbiased': 61.851, 'best_valid_test/diff': 6.02, 'best_valid_test/acc_skew': 60.821, 'best_valid_test/acc_align': 62.88}
[1 / 20] best test accuracy: 61.851 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 62.532, 'best_test_valid/acc_unbiased': 60.258, 'best_test_valid/diff': 1.935, 'best_test_valid/acc_skew': 59.731, 'best_test_valid/acc_align': 60.784, 'best_test_test/acc': 63.418, 'best_test_test/acc_unbiased': 61.851, 'best_test_test/diff': 6.02, 'best_test_test/acc_skew': 60.821, 'best_test_test/acc_align': 62.88}
[2 / 20] Learning rate: 0.001 weight: 0.01
[2 / 20] Loss: 4.956652623956853 CE Loss: 0.618923713944175 Con Loss: 4.950463399020109
[2 / 20] tensor([[0.943, 0.888],
        [0.476, 0.462]]) {'epoch': 2, 'valid/acc': 70.844, 'valid/acc_unbiased': 69.264, 'valid/diff': 2.444, 'valid/acc_skew': 69.436, 'valid/acc_align': 69.092, 'test/acc': 69.958, 'test/acc_unbiased': 69.217, 'test/diff': 3.45, 'test/acc_skew': 70.942, 'test/acc_align': 67.492}
[2 / 20] best valid accuracy: 69.264 at epoch 2 
 best_stats: {'best_valid_epoch': 2, 'best_valid_valid/acc': 70.844, 'best_valid_valid/acc_unbiased': 69.264, 'best_valid_valid/diff': 2.444, 'best_valid_valid/acc_skew': 69.436, 'best_valid_valid/acc_align': 69.092, 'best_valid_test/acc': 69.958, 'best_valid_test/acc_unbiased': 69.217, 'best_valid_test/diff': 3.45, 'best_valid_test/acc_skew': 70.942, 'best_valid_test/acc_align': 67.492}
[2 / 20] best test accuracy: 69.217 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 70.844, 'best_test_valid/acc_unbiased': 69.264, 'best_test_valid/diff': 2.444, 'best_test_valid/acc_skew': 69.436, 'best_test_valid/acc_align': 69.092, 'best_test_test/acc': 69.958, 'best_test_test/acc_unbiased': 69.217, 'best_test_test/diff': 3.45, 'best_test_test/acc_skew': 70.942, 'best_test_test/acc_align': 67.492}
[3 / 20] Learning rate: 0.001 weight: 0.01
[3 / 20] Loss: 4.823338933424516 CE Loss: 0.5454765623266047 Con Loss: 4.817884176427667
[3 / 20] tensor([[0.758, 0.727],
        [0.792, 0.805]]) {'epoch': 3, 'valid/acc': 76.751, 'valid/acc_unbiased': 77.074, 'valid/diff': 2.411, 'valid/acc_skew': 78.279, 'valid/acc_align': 75.869, 'test/acc': 76.92, 'test/acc_unbiased': 77.059, 'test/diff': 2.224, 'test/acc_skew': 77.514, 'test/acc_align': 76.604}
[3 / 20] best valid accuracy: 77.074 at epoch 3 
 best_stats: {'best_valid_epoch': 3, 'best_valid_valid/acc': 76.751, 'best_valid_valid/acc_unbiased': 77.074, 'best_valid_valid/diff': 2.411, 'best_valid_valid/acc_skew': 78.279, 'best_valid_valid/acc_align': 75.869, 'best_valid_test/acc': 76.92, 'best_valid_test/acc_unbiased': 77.059, 'best_valid_test/diff': 2.224, 'best_valid_test/acc_skew': 77.514, 'best_valid_test/acc_align': 76.604}
[3 / 20] best test accuracy: 77.059 at epoch 3 
 best_stats: {'best_test_epoch': 3, 'best_test_valid/acc': 76.751, 'best_test_valid/acc_unbiased': 77.074, 'best_test_valid/diff': 2.411, 'best_test_valid/acc_skew': 78.279, 'best_test_valid/acc_align': 75.869, 'best_test_test/acc': 76.92, 'best_test_test/acc_unbiased': 77.059, 'best_test_test/diff': 2.224, 'best_test_test/acc_skew': 77.514, 'best_test_test/acc_align': 76.604}
[4 / 20] Learning rate: 0.001 weight: 0.01
[4 / 20] Loss: 4.796583071621981 CE Loss: 0.5028787407008084 Con Loss: 4.79155422557484
[4 / 20] tensor([[0.758, 0.722],
        [0.814, 0.823]]) {'epoch': 4, 'valid/acc': 76.962, 'valid/acc_unbiased': 77.25, 'valid/diff': 1.249, 'valid/acc_skew': 77.874, 'valid/acc_align': 76.625, 'test/acc': 77.722, 'test/acc_unbiased': 77.935, 'test/diff': 2.254, 'test/acc_skew': 78.596, 'test/acc_align': 77.274}
[4 / 20] best valid accuracy: 77.250 at epoch 4 
 best_stats: {'best_valid_epoch': 4, 'best_valid_valid/acc': 76.962, 'best_valid_valid/acc_unbiased': 77.25, 'best_valid_valid/diff': 1.249, 'best_valid_valid/acc_skew': 77.874, 'best_valid_valid/acc_align': 76.625, 'best_valid_test/acc': 77.722, 'best_valid_test/acc_unbiased': 77.935, 'best_valid_test/diff': 2.254, 'best_valid_test/acc_skew': 78.596, 'best_valid_test/acc_align': 77.274}
[4 / 20] best test accuracy: 77.935 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 76.962, 'best_test_valid/acc_unbiased': 77.25, 'best_test_valid/diff': 1.249, 'best_test_valid/acc_skew': 77.874, 'best_test_valid/acc_align': 76.625, 'best_test_test/acc': 77.722, 'best_test_test/acc_unbiased': 77.935, 'best_test_test/diff': 2.254, 'best_test_test/acc_skew': 78.596, 'best_test_test/acc_align': 77.274}
[5 / 20] Learning rate: 0.001 weight: 0.01
[5 / 20] Loss: 4.780463210019199 CE Loss: 0.47378248518163507 Con Loss: 4.775725399364124
[5 / 20] tensor([[0.882, 0.849],
        [0.732, 0.719]]) {'epoch': 5, 'valid/acc': 79.409, 'valid/acc_unbiased': 79.304, 'valid/diff': 4.772, 'valid/acc_skew': 81.689, 'valid/acc_align': 76.918, 'test/acc': 79.705, 'test/acc_unbiased': 79.546, 'test/diff': 2.241, 'test/acc_skew': 80.666, 'test/acc_align': 78.425}
[5 / 20] best valid accuracy: 79.304 at epoch 5 
 best_stats: {'best_valid_epoch': 5, 'best_valid_valid/acc': 79.409, 'best_valid_valid/acc_unbiased': 79.304, 'best_valid_valid/diff': 4.772, 'best_valid_valid/acc_skew': 81.689, 'best_valid_valid/acc_align': 76.918, 'best_valid_test/acc': 79.705, 'best_valid_test/acc_unbiased': 79.546, 'best_valid_test/diff': 2.241, 'best_valid_test/acc_skew': 80.666, 'best_valid_test/acc_align': 78.425}
[5 / 20] best test accuracy: 79.546 at epoch 5 
 best_stats: {'best_test_epoch': 5, 'best_test_valid/acc': 79.409, 'best_test_valid/acc_unbiased': 79.304, 'best_test_valid/diff': 4.772, 'best_test_valid/acc_skew': 81.689, 'best_test_valid/acc_align': 76.918, 'best_test_test/acc': 79.705, 'best_test_test/acc_unbiased': 79.546, 'best_test_test/diff': 2.241, 'best_test_test/acc_skew': 80.666, 'best_test_test/acc_align': 78.425}
[6 / 20] Learning rate: 0.001 weight: 0.01
[6 / 20] Loss: 4.775114024769176 CE Loss: 0.4697397757660259 Con Loss: 4.770416658574884
[6 / 20] tensor([[0.934, 0.897],
        [0.643, 0.621]]) {'epoch': 6, 'valid/acc': 76.414, 'valid/acc_unbiased': 75.548, 'valid/diff': 3.159, 'valid/acc_skew': 77.127, 'valid/acc_align': 73.968, 'test/acc': 77.764, 'test/acc_unbiased': 77.356, 'test/diff': 2.942, 'test/acc_skew': 78.827, 'test/acc_align': 75.885}
[6 / 20] best valid accuracy: 79.304 at epoch 5 
 best_stats: {'best_valid_epoch': 5, 'best_valid_valid/acc': 79.409, 'best_valid_valid/acc_unbiased': 79.304, 'best_valid_valid/diff': 4.772, 'best_valid_valid/acc_skew': 81.689, 'best_valid_valid/acc_align': 76.918, 'best_valid_test/acc': 79.705, 'best_valid_test/acc_unbiased': 79.546, 'best_valid_test/diff': 2.241, 'best_valid_test/acc_skew': 80.666, 'best_valid_test/acc_align': 78.425}
[6 / 20] best test accuracy: 79.546 at epoch 5 
 best_stats: {'best_test_epoch': 5, 'best_test_valid/acc': 79.409, 'best_test_valid/acc_unbiased': 79.304, 'best_test_valid/diff': 4.772, 'best_test_valid/acc_skew': 81.689, 'best_test_valid/acc_align': 76.918, 'best_test_test/acc': 79.705, 'best_test_test/acc_unbiased': 79.546, 'best_test_test/diff': 2.241, 'best_test_test/acc_skew': 80.666, 'best_test_test/acc_align': 78.425}
[7 / 20] Learning rate: 0.0001 weight: 0.01
[7 / 20] Loss: 4.748349025032737 CE Loss: 0.466536097093062 Con Loss: 4.743683667616411
[7 / 20] tensor([[0.796, 0.747],
        [0.866, 0.854]]) {'epoch': 7, 'valid/acc': 80.422, 'valid/acc_unbiased': 80.767, 'valid/diff': 2.488, 'valid/acc_skew': 82.011, 'valid/acc_align': 79.524, 'test/acc': 81.224, 'test/acc_unbiased': 81.582, 'test/diff': 2.985, 'test/acc_skew': 83.075, 'test/acc_align': 80.09}
[7 / 20] best valid accuracy: 80.767 at epoch 7 
 best_stats: {'best_valid_epoch': 7, 'best_valid_valid/acc': 80.422, 'best_valid_valid/acc_unbiased': 80.767, 'best_valid_valid/diff': 2.488, 'best_valid_valid/acc_skew': 82.011, 'best_valid_valid/acc_align': 79.524, 'best_valid_test/acc': 81.224, 'best_valid_test/acc_unbiased': 81.582, 'best_valid_test/diff': 2.985, 'best_valid_test/acc_skew': 83.075, 'best_valid_test/acc_align': 80.09}
[7 / 20] best test accuracy: 81.582 at epoch 7 
 best_stats: {'best_test_epoch': 7, 'best_test_valid/acc': 80.422, 'best_test_valid/acc_unbiased': 80.767, 'best_test_valid/diff': 2.488, 'best_test_valid/acc_skew': 82.011, 'best_test_valid/acc_align': 79.524, 'best_test_test/acc': 81.224, 'best_test_test/acc_unbiased': 81.582, 'best_test_test/diff': 2.985, 'best_test_test/acc_skew': 83.075, 'best_test_test/acc_align': 80.09}
[8 / 20] Learning rate: 0.0001 weight: 0.01
[8 / 20] Loss: 4.737097592787309 CE Loss: 0.43447078358043323 Con Loss: 4.732752904024991
[8 / 20] tensor([[0.787, 0.740],
        [0.877, 0.860]]) {'epoch': 8, 'valid/acc': 81.139, 'valid/acc_unbiased': 81.598, 'valid/diff': 2.401, 'valid/acc_skew': 82.662, 'valid/acc_align': 80.534, 'test/acc': 81.181, 'test/acc_unbiased': 81.593, 'test/diff': 3.15, 'test/acc_skew': 83.168, 'test/acc_align': 80.018}
[8 / 20] best valid accuracy: 81.598 at epoch 8 
 best_stats: {'best_valid_epoch': 8, 'best_valid_valid/acc': 81.139, 'best_valid_valid/acc_unbiased': 81.598, 'best_valid_valid/diff': 2.401, 'best_valid_valid/acc_skew': 82.662, 'best_valid_valid/acc_align': 80.534, 'best_valid_test/acc': 81.181, 'best_valid_test/acc_unbiased': 81.593, 'best_valid_test/diff': 3.15, 'best_valid_test/acc_skew': 83.168, 'best_valid_test/acc_align': 80.018}
[8 / 20] best test accuracy: 81.593 at epoch 8 
 best_stats: {'best_test_epoch': 8, 'best_test_valid/acc': 81.139, 'best_test_valid/acc_unbiased': 81.598, 'best_test_valid/diff': 2.401, 'best_test_valid/acc_skew': 82.662, 'best_test_valid/acc_align': 80.534, 'best_test_test/acc': 81.181, 'best_test_test/acc_unbiased': 81.593, 'best_test_test/diff': 3.15, 'best_test_test/acc_skew': 83.168, 'best_test_test/acc_align': 80.018}
[9 / 20] Learning rate: 0.0001 weight: 0.01
[9 / 20] Loss: 4.721032723513517 CE Loss: 0.407126402313059 Con Loss: 4.71696140982888
[9 / 20] tensor([[0.864, 0.846],
        [0.794, 0.804]]) {'epoch': 9, 'valid/acc': 81.983, 'valid/acc_unbiased': 81.829, 'valid/diff': 1.833, 'valid/acc_skew': 82.745, 'valid/acc_align': 80.912, 'test/acc': 82.827, 'test/acc_unbiased': 82.71, 'test/diff': 1.345, 'test/acc_skew': 82.909, 'test/acc_align': 82.512}
[9 / 20] best valid accuracy: 81.829 at epoch 9 
 best_stats: {'best_valid_epoch': 9, 'best_valid_valid/acc': 81.983, 'best_valid_valid/acc_unbiased': 81.829, 'best_valid_valid/diff': 1.833, 'best_valid_valid/acc_skew': 82.745, 'best_valid_valid/acc_align': 80.912, 'best_valid_test/acc': 82.827, 'best_valid_test/acc_unbiased': 82.71, 'best_valid_test/diff': 1.345, 'best_valid_test/acc_skew': 82.909, 'best_valid_test/acc_align': 82.512}
[9 / 20] best test accuracy: 82.710 at epoch 9 
 best_stats: {'best_test_epoch': 9, 'best_test_valid/acc': 81.983, 'best_test_valid/acc_unbiased': 81.829, 'best_test_valid/diff': 1.833, 'best_test_valid/acc_skew': 82.745, 'best_test_valid/acc_align': 80.912, 'best_test_test/acc': 82.827, 'best_test_test/acc_unbiased': 82.71, 'best_test_test/diff': 1.345, 'best_test_test/acc_skew': 82.909, 'best_test_test/acc_align': 82.512}
[10 / 20] Learning rate: 0.0001 weight: 0.01
[10 / 20] Loss: 4.681218398701061 CE Loss: 0.4031710581345992 Con Loss: 4.677186705849388
[10 / 20] tensor([[0.787, 0.756],
        [0.864, 0.878]]) {'epoch': 10, 'valid/acc': 81.73, 'valid/acc_unbiased': 82.257, 'valid/diff': 3.447, 'valid/acc_skew': 83.981, 'valid/acc_align': 80.534, 'test/acc': 81.899, 'test/acc_unbiased': 82.12, 'test/diff': 2.249, 'test/acc_skew': 82.519, 'test/acc_align': 81.722}
[10 / 20] best valid accuracy: 82.257 at epoch 10 
 best_stats: {'best_valid_epoch': 10, 'best_valid_valid/acc': 81.73, 'best_valid_valid/acc_unbiased': 82.257, 'best_valid_valid/diff': 3.447, 'best_valid_valid/acc_skew': 83.981, 'best_valid_valid/acc_align': 80.534, 'best_valid_test/acc': 81.899, 'best_valid_test/acc_unbiased': 82.12, 'best_valid_test/diff': 2.249, 'best_valid_test/acc_skew': 82.519, 'best_valid_test/acc_align': 81.722}
[10 / 20] best test accuracy: 82.710 at epoch 9 
 best_stats: {'best_test_epoch': 9, 'best_test_valid/acc': 81.983, 'best_test_valid/acc_unbiased': 81.829, 'best_test_valid/diff': 1.833, 'best_test_valid/acc_skew': 82.745, 'best_test_valid/acc_align': 80.912, 'best_test_test/acc': 82.827, 'best_test_test/acc_unbiased': 82.71, 'best_test_test/diff': 1.345, 'best_test_test/acc_skew': 82.909, 'best_test_test/acc_align': 82.512}
[11 / 20] Learning rate: 0.0001 weight: 0.01
[11 / 20] Loss: 4.719415621324019 CE Loss: 0.41940938396887345 Con Loss: 4.715221543745561
[11 / 20] tensor([[0.830, 0.784],
        [0.857, 0.856]]) {'epoch': 11, 'valid/acc': 82.743, 'valid/acc_unbiased': 83.037, 'valid/diff': 2.864, 'valid/acc_skew': 84.469, 'valid/acc_align': 81.605, 'test/acc': 82.954, 'test/acc_unbiased': 83.178, 'test/diff': 2.334, 'test/acc_skew': 84.345, 'test/acc_align': 82.011}
[11 / 20] best valid accuracy: 83.037 at epoch 11 
 best_stats: {'best_valid_epoch': 11, 'best_valid_valid/acc': 82.743, 'best_valid_valid/acc_unbiased': 83.037, 'best_valid_valid/diff': 2.864, 'best_valid_valid/acc_skew': 84.469, 'best_valid_valid/acc_align': 81.605, 'best_valid_test/acc': 82.954, 'best_valid_test/acc_unbiased': 83.178, 'best_valid_test/diff': 2.334, 'best_valid_test/acc_skew': 84.345, 'best_valid_test/acc_align': 82.011}
[11 / 20] best test accuracy: 83.178 at epoch 11 
 best_stats: {'best_test_epoch': 11, 'best_test_valid/acc': 82.743, 'best_test_valid/acc_unbiased': 83.037, 'best_test_valid/diff': 2.864, 'best_test_valid/acc_skew': 84.469, 'best_test_valid/acc_align': 81.605, 'best_test_test/acc': 82.954, 'best_test_test/acc_unbiased': 83.178, 'best_test_test/diff': 2.334, 'best_test_test/acc_skew': 84.345, 'best_test_test/acc_align': 82.011}
[12 / 20] Learning rate: 0.0001 weight: 0.01
[12 / 20] Loss: 4.698826651139693 CE Loss: 0.4077410573309118 Con Loss: 4.6947491992603645
[12 / 20] tensor([[0.860, 0.820],
        [0.833, 0.840]]) {'epoch': 12, 'valid/acc': 82.574, 'valid/acc_unbiased': 82.629, 'valid/diff': 2.608, 'valid/acc_skew': 83.934, 'valid/acc_align': 81.325, 'test/acc': 83.755, 'test/acc_unbiased': 83.822, 'test/diff': 2.331, 'test/acc_skew': 84.677, 'test/acc_align': 82.966}
[12 / 20] best valid accuracy: 83.037 at epoch 11 
 best_stats: {'best_valid_epoch': 11, 'best_valid_valid/acc': 82.743, 'best_valid_valid/acc_unbiased': 83.037, 'best_valid_valid/diff': 2.864, 'best_valid_valid/acc_skew': 84.469, 'best_valid_valid/acc_align': 81.605, 'best_valid_test/acc': 82.954, 'best_valid_test/acc_unbiased': 83.178, 'best_valid_test/diff': 2.334, 'best_valid_test/acc_skew': 84.345, 'best_valid_test/acc_align': 82.011}
[12 / 20] best test accuracy: 83.822 at epoch 12 
 best_stats: {'best_test_epoch': 12, 'best_test_valid/acc': 82.574, 'best_test_valid/acc_unbiased': 82.629, 'best_test_valid/diff': 2.608, 'best_test_valid/acc_skew': 83.934, 'best_test_valid/acc_align': 81.325, 'best_test_test/acc': 83.755, 'best_test_test/acc_unbiased': 83.822, 'best_test_test/diff': 2.331, 'best_test_test/acc_skew': 84.677, 'best_test_test/acc_align': 82.966}
[13 / 20] Learning rate: 0.0001 weight: 0.01
[13 / 20] Loss: 4.692611113461581 CE Loss: 0.3935178729620847 Con Loss: 4.68867600180886
[13 / 20] tensor([[0.837, 0.798],
        [0.844, 0.854]]) {'epoch': 13, 'valid/acc': 82.363, 'valid/acc_unbiased': 82.582, 'valid/diff': 2.118, 'valid/acc_skew': 83.641, 'valid/acc_align': 81.523, 'test/acc': 83.207, 'test/acc_unbiased': 83.327, 'test/diff': 2.475, 'test/acc_skew': 84.054, 'test/acc_align': 82.601}
[13 / 20] best valid accuracy: 83.037 at epoch 11 
 best_stats: {'best_valid_epoch': 11, 'best_valid_valid/acc': 82.743, 'best_valid_valid/acc_unbiased': 83.037, 'best_valid_valid/diff': 2.864, 'best_valid_valid/acc_skew': 84.469, 'best_valid_valid/acc_align': 81.605, 'best_valid_test/acc': 82.954, 'best_valid_test/acc_unbiased': 83.178, 'best_valid_test/diff': 2.334, 'best_valid_test/acc_skew': 84.345, 'best_valid_test/acc_align': 82.011}
[13 / 20] best test accuracy: 83.822 at epoch 12 
 best_stats: {'best_test_epoch': 12, 'best_test_valid/acc': 82.574, 'best_test_valid/acc_unbiased': 82.629, 'best_test_valid/diff': 2.608, 'best_test_valid/acc_skew': 83.934, 'best_test_valid/acc_align': 81.325, 'best_test_test/acc': 83.755, 'best_test_test/acc_unbiased': 83.822, 'best_test_test/diff': 2.331, 'best_test_test/acc_skew': 84.677, 'best_test_test/acc_align': 82.966}
[14 / 20] Learning rate: 1e-05 weight: 0.01
[14 / 20] Loss: 4.6806596149097786 CE Loss: 0.4042489983818748 Con Loss: 4.676617050170899
[14 / 20] tensor([[0.848, 0.805],
        [0.842, 0.847]]) {'epoch': 14, 'valid/acc': 82.532, 'valid/acc_unbiased': 82.633, 'valid/diff': 1.514, 'valid/acc_skew': 83.39, 'valid/acc_align': 81.876, 'test/acc': 83.418, 'test/acc_unbiased': 83.541, 'test/diff': 2.381, 'test/acc_skew': 84.483, 'test/acc_align': 82.599}
[14 / 20] best valid accuracy: 83.037 at epoch 11 
 best_stats: {'best_valid_epoch': 11, 'best_valid_valid/acc': 82.743, 'best_valid_valid/acc_unbiased': 83.037, 'best_valid_valid/diff': 2.864, 'best_valid_valid/acc_skew': 84.469, 'best_valid_valid/acc_align': 81.605, 'best_valid_test/acc': 82.954, 'best_valid_test/acc_unbiased': 83.178, 'best_valid_test/diff': 2.334, 'best_valid_test/acc_skew': 84.345, 'best_valid_test/acc_align': 82.011}
[14 / 20] best test accuracy: 83.822 at epoch 12 
 best_stats: {'best_test_epoch': 12, 'best_test_valid/acc': 82.574, 'best_test_valid/acc_unbiased': 82.629, 'best_test_valid/diff': 2.608, 'best_test_valid/acc_skew': 83.934, 'best_test_valid/acc_align': 81.325, 'best_test_test/acc': 83.755, 'best_test_test/acc_unbiased': 83.822, 'best_test_test/diff': 2.331, 'best_test_test/acc_skew': 84.677, 'best_test_test/acc_align': 82.966}
[15 / 20] Learning rate: 1e-05 weight: 0.01
[15 / 20] Loss: 4.669544766165993 CE Loss: 0.4056461529298262 Con Loss: 4.6654882951216265
[15 / 20] tensor([[0.846, 0.808],
        [0.838, 0.840]]) {'epoch': 15, 'valid/acc': 82.7, 'valid/acc_unbiased': 82.774, 'valid/diff': 1.823, 'valid/acc_skew': 83.685, 'valid/acc_align': 81.863, 'test/acc': 83.165, 'test/acc_unbiased': 83.276, 'test/diff': 1.988, 'test/acc_skew': 84.177, 'test/acc_align': 82.375}
[15 / 20] best valid accuracy: 83.037 at epoch 11 
 best_stats: {'best_valid_epoch': 11, 'best_valid_valid/acc': 82.743, 'best_valid_valid/acc_unbiased': 83.037, 'best_valid_valid/diff': 2.864, 'best_valid_valid/acc_skew': 84.469, 'best_valid_valid/acc_align': 81.605, 'best_valid_test/acc': 82.954, 'best_valid_test/acc_unbiased': 83.178, 'best_valid_test/diff': 2.334, 'best_valid_test/acc_skew': 84.345, 'best_valid_test/acc_align': 82.011}
[15 / 20] best test accuracy: 83.822 at epoch 12 
 best_stats: {'best_test_epoch': 12, 'best_test_valid/acc': 82.574, 'best_test_valid/acc_unbiased': 82.629, 'best_test_valid/diff': 2.608, 'best_test_valid/acc_skew': 83.934, 'best_test_valid/acc_align': 81.325, 'best_test_test/acc': 83.755, 'best_test_test/acc_unbiased': 83.822, 'best_test_test/diff': 2.331, 'best_test_test/acc_skew': 84.677, 'best_test_test/acc_align': 82.966}
[16 / 20] Learning rate: 1e-05 weight: 0.01
[16 / 20] Loss: 4.675732369856401 CE Loss: 0.39620623426003887 Con Loss: 4.671770312569358
[16 / 20] tensor([[0.839, 0.801],
        [0.853, 0.859]]) {'epoch': 16, 'valid/acc': 82.785, 'valid/acc_unbiased': 82.979, 'valid/diff': 2.353, 'valid/acc_skew': 84.155, 'valid/acc_align': 81.803, 'test/acc': 83.629, 'test/acc_unbiased': 83.774, 'test/diff': 2.207, 'test/acc_skew': 84.576, 'test/acc_align': 82.972}
[16 / 20] best valid accuracy: 83.037 at epoch 11 
 best_stats: {'best_valid_epoch': 11, 'best_valid_valid/acc': 82.743, 'best_valid_valid/acc_unbiased': 83.037, 'best_valid_valid/diff': 2.864, 'best_valid_valid/acc_skew': 84.469, 'best_valid_valid/acc_align': 81.605, 'best_valid_test/acc': 82.954, 'best_valid_test/acc_unbiased': 83.178, 'best_valid_test/diff': 2.334, 'best_valid_test/acc_skew': 84.345, 'best_valid_test/acc_align': 82.011}
[16 / 20] best test accuracy: 83.822 at epoch 12 
 best_stats: {'best_test_epoch': 12, 'best_test_valid/acc': 82.574, 'best_test_valid/acc_unbiased': 82.629, 'best_test_valid/diff': 2.608, 'best_test_valid/acc_skew': 83.934, 'best_test_valid/acc_align': 81.325, 'best_test_test/acc': 83.755, 'best_test_test/acc_unbiased': 83.822, 'best_test_test/diff': 2.331, 'best_test_test/acc_skew': 84.677, 'best_test_test/acc_align': 82.966}
[17 / 20] Learning rate: 1e-05 weight: 0.01
[17 / 20] Loss: 4.649699939380993 CE Loss: 0.3919218502261422 Con Loss: 4.645780762759122
[17 / 20] tensor([[0.832, 0.795],
        [0.857, 0.857]]) {'epoch': 17, 'valid/acc': 83.038, 'valid/acc_unbiased': 83.32, 'valid/diff': 2.735, 'valid/acc_skew': 84.688, 'valid/acc_align': 81.953, 'test/acc': 83.333, 'test/acc_unbiased': 83.518, 'test/diff': 1.854, 'test/acc_skew': 84.434, 'test/acc_align': 82.602}
[17 / 20] best valid accuracy: 83.320 at epoch 17 
 best_stats: {'best_valid_epoch': 17, 'best_valid_valid/acc': 83.038, 'best_valid_valid/acc_unbiased': 83.32, 'best_valid_valid/diff': 2.735, 'best_valid_valid/acc_skew': 84.688, 'best_valid_valid/acc_align': 81.953, 'best_valid_test/acc': 83.333, 'best_valid_test/acc_unbiased': 83.518, 'best_valid_test/diff': 1.854, 'best_valid_test/acc_skew': 84.434, 'best_valid_test/acc_align': 82.602}
[17 / 20] best test accuracy: 83.822 at epoch 12 
 best_stats: {'best_test_epoch': 12, 'best_test_valid/acc': 82.574, 'best_test_valid/acc_unbiased': 82.629, 'best_test_valid/diff': 2.608, 'best_test_valid/acc_skew': 83.934, 'best_test_valid/acc_align': 81.325, 'best_test_test/acc': 83.755, 'best_test_test/acc_unbiased': 83.822, 'best_test_test/diff': 2.331, 'best_test_test/acc_skew': 84.677, 'best_test_test/acc_align': 82.966}
[18 / 20] Learning rate: 1e-05 weight: 0.01
[18 / 20] Loss: 4.6365644368258385 CE Loss: 0.39398769465359773 Con Loss: 4.632624530792237
[18 / 20] tensor([[0.842, 0.808],
        [0.844, 0.835]]) {'epoch': 18, 'valid/acc': 82.996, 'valid/acc_unbiased': 83.169, 'valid/diff': 2.612, 'valid/acc_skew': 84.475, 'valid/acc_align': 81.863, 'test/acc': 83.08, 'test/acc_unbiased': 83.237, 'test/diff': 2.17, 'test/acc_skew': 84.322, 'test/acc_align': 82.152}
[18 / 20] best valid accuracy: 83.320 at epoch 17 
 best_stats: {'best_valid_epoch': 17, 'best_valid_valid/acc': 83.038, 'best_valid_valid/acc_unbiased': 83.32, 'best_valid_valid/diff': 2.735, 'best_valid_valid/acc_skew': 84.688, 'best_valid_valid/acc_align': 81.953, 'best_valid_test/acc': 83.333, 'best_valid_test/acc_unbiased': 83.518, 'best_valid_test/diff': 1.854, 'best_valid_test/acc_skew': 84.434, 'best_valid_test/acc_align': 82.602}
[18 / 20] best test accuracy: 83.822 at epoch 12 
 best_stats: {'best_test_epoch': 12, 'best_test_valid/acc': 82.574, 'best_test_valid/acc_unbiased': 82.629, 'best_test_valid/diff': 2.608, 'best_test_valid/acc_skew': 83.934, 'best_test_valid/acc_align': 81.325, 'best_test_test/acc': 83.755, 'best_test_test/acc_unbiased': 83.822, 'best_test_test/diff': 2.331, 'best_test_test/acc_skew': 84.677, 'best_test_test/acc_align': 82.966}
[19 / 20] Learning rate: 1e-05 weight: 0.01
[19 / 20] Loss: 4.668978968533603 CE Loss: 0.39568253701383416 Con Loss: 4.665022113106468
[19 / 20] tensor([[0.832, 0.796],
        [0.851, 0.850]]) {'epoch': 19, 'valid/acc': 83.122, 'valid/acc_unbiased': 83.402, 'valid/diff': 2.743, 'valid/acc_skew': 84.773, 'valid/acc_align': 82.03, 'test/acc': 83.038, 'test/acc_unbiased': 83.207, 'test/diff': 1.805, 'test/acc_skew': 84.11, 'test/acc_align': 82.304}
[19 / 20] best valid accuracy: 83.402 at epoch 19 
 best_stats: {'best_valid_epoch': 19, 'best_valid_valid/acc': 83.122, 'best_valid_valid/acc_unbiased': 83.402, 'best_valid_valid/diff': 2.743, 'best_valid_valid/acc_skew': 84.773, 'best_valid_valid/acc_align': 82.03, 'best_valid_test/acc': 83.038, 'best_valid_test/acc_unbiased': 83.207, 'best_valid_test/diff': 1.805, 'best_valid_test/acc_skew': 84.11, 'best_valid_test/acc_align': 82.304}
[19 / 20] best test accuracy: 83.822 at epoch 12 
 best_stats: {'best_test_epoch': 12, 'best_test_valid/acc': 82.574, 'best_test_valid/acc_unbiased': 82.629, 'best_test_valid/diff': 2.608, 'best_test_valid/acc_skew': 83.934, 'best_test_valid/acc_align': 81.325, 'best_test_test/acc': 83.755, 'best_test_test/acc_unbiased': 83.822, 'best_test_test/diff': 2.331, 'best_test_test/acc_skew': 84.677, 'best_test_test/acc_align': 82.966}
[20 / 20] Learning rate: 1e-05 weight: 0.01
[20 / 20] Loss: 4.647928827459162 CE Loss: 0.3932931650768627 Con Loss: 4.643995839899237
[20 / 20] tensor([[0.833, 0.796],
        [0.855, 0.844]]) {'epoch': 20, 'valid/acc': 83.038, 'valid/acc_unbiased': 83.343, 'valid/diff': 2.908, 'valid/acc_skew': 84.797, 'valid/acc_align': 81.889, 'test/acc': 82.996, 'test/acc_unbiased': 83.211, 'test/diff': 2.409, 'test/acc_skew': 84.416, 'test/acc_align': 82.007}
[20 / 20] best valid accuracy: 83.402 at epoch 19 
 best_stats: {'best_valid_epoch': 19, 'best_valid_valid/acc': 83.122, 'best_valid_valid/acc_unbiased': 83.402, 'best_valid_valid/diff': 2.743, 'best_valid_valid/acc_skew': 84.773, 'best_valid_valid/acc_align': 82.03, 'best_valid_test/acc': 83.038, 'best_valid_test/acc_unbiased': 83.207, 'best_valid_test/diff': 1.805, 'best_valid_test/acc_skew': 84.11, 'best_valid_test/acc_align': 82.304}
[20 / 20] best test accuracy: 83.822 at epoch 12 
 best_stats: {'best_test_epoch': 12, 'best_test_valid/acc': 82.574, 'best_test_valid/acc_unbiased': 82.629, 'best_test_valid/diff': 2.608, 'best_test_valid/acc_skew': 83.934, 'best_test_valid/acc_align': 81.325, 'best_test_test/acc': 83.755, 'best_test_test/acc_unbiased': 83.822, 'best_test_test/diff': 2.331, 'best_test_test/acc_skew': 84.677, 'best_test_test/acc_align': 82.966}
Total training time: 0:16:32
