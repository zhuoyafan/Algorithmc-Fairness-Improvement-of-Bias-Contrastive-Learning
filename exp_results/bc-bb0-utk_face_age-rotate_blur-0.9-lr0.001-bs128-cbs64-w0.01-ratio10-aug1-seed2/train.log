Log level set to: INFO
Set seed: 2
=======> Using Fixed Random Seed: 2 <========
save_path: exp_results/bc-bb0-utk_face_age-rotate_blur-0.9-lr0.001-bs128-cbs64-w0.01-ratio10-aug1-seed2
get_utk_face - split: train, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_age-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
Binary Target 1
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Normal Label Distribution: 
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
Binary Target 1
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Normal Label Distribution: 
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 10684, target_attr: gender, bias_attr: age bias_rate: 0.9
['[train] target_0-bias_0: 8237', '[train] target_0-bias_1: 147', '[train] target_1-bias_0: 823', '[train] target_1-bias_1: 1477']
confusion_matrix - 
 original: tensor([[8237.,  823.],
        [ 147., 1477.]]), 
 normalized: tensor([[0.909, 0.091],
        [0.091, 0.909]]), 
 b|y: tensor([[0.982, 0.018],
        [0.358, 0.642]])
get_utk_face - split: train, aug: 1, given_y: True, ratio: 10
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_age-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
Binary Target 1
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Normal Label Distribution: 
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
Binary Target 1
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Normal Label Distribution: 
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 10684, target_attr: gender, bias_attr: age bias_rate: 0.9
['[train] target_0-bias_0: 8237', '[train] target_0-bias_1: 147', '[train] target_1-bias_0: 823', '[train] target_1-bias_1: 1477']
get_utk_face - split: valid, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_age-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [1030, 195]
Target 1: [841, 202]
Binary Target 1
---------------------------
Target 0: [1030, 195]
Target 1: [841, 202]
===================================
Normal Label Distribution: 
Target 0: [1030, 195]
Target 1: [841, 202]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 2268, target_attr: gender, bias_attr: age bias_rate: 0.9
['[valid] target_0-bias_0: 1030', '[valid] target_0-bias_1: 195', '[valid] target_1-bias_0: 841', '[valid] target_1-bias_1: 202']
get_utk_face - split: test, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_age-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [1061, 176]
Target 1: [867, 165]
Binary Target 1
---------------------------
Target 0: [1061, 176]
Target 1: [867, 165]
===================================
Normal Label Distribution: 
Target 0: [1061, 176]
Target 1: [867, 165]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 2269, target_attr: gender, bias_attr: age bias_rate: 0.9
['[test] target_0-bias_0: 1061', '[test] target_0-bias_1: 176', '[test] target_1-bias_0: 867', '[test] target_1-bias_1: 165']
decay_epochs: [6, 13]
[1 / 20] Learning rate: 0.001 weight: 0.01
[1 / 20] Loss: 4.846135762156462 CE Loss: 0.5638013261616878 Con Loss: 4.840497727431594
[1 / 20] tensor([[1., 1.],
        [0., 0.]]) {'epoch': 1, 'valid/acc': 54.012, 'valid/acc_unbiased': 50.0, 'valid/diff': 0.0, 'valid/acc_skew': 50.0, 'valid/acc_align': 50.0, 'test/acc': 54.517, 'test/acc_unbiased': 50.0, 'test/diff': 0.0, 'test/acc_skew': 50.0, 'test/acc_align': 50.0}
[1 / 20] best valid accuracy: 50.000 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 54.012, 'best_valid_valid/acc_unbiased': 50.0, 'best_valid_valid/diff': 0.0, 'best_valid_valid/acc_skew': 50.0, 'best_valid_valid/acc_align': 50.0, 'best_valid_test/acc': 54.517, 'best_valid_test/acc_unbiased': 50.0, 'best_valid_test/diff': 0.0, 'best_valid_test/acc_skew': 50.0, 'best_valid_test/acc_align': 50.0}
[1 / 20] best test accuracy: 50.000 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 54.012, 'best_test_valid/acc_unbiased': 50.0, 'best_test_valid/diff': 0.0, 'best_test_valid/acc_skew': 50.0, 'best_test_valid/acc_align': 50.0, 'best_test_test/acc': 54.517, 'best_test_test/acc_unbiased': 50.0, 'best_test_test/diff': 0.0, 'best_test_test/acc_skew': 50.0, 'best_test_test/acc_align': 50.0}
[2 / 20] Learning rate: 0.001 weight: 0.01
[2 / 20] Loss: 4.653403619218524 CE Loss: 0.536780034098809 Con Loss: 4.648035829409103
[2 / 20] tensor([[0.990, 1.000],
        [0.018, 0.000]]) {'epoch': 2, 'valid/acc': 54.541, 'valid/acc_unbiased': 50.872, 'valid/diff': 0.714, 'valid/acc_skew': 50.695, 'valid/acc_align': 51.048, 'test/acc': 54.738, 'test/acc_unbiased': 50.202, 'test/diff': 1.441, 'test/acc_skew': 50.923, 'test/acc_align': 49.482}
[2 / 20] best valid accuracy: 50.872 at epoch 2 
 best_stats: {'best_valid_epoch': 2, 'best_valid_valid/acc': 54.541, 'best_valid_valid/acc_unbiased': 50.872, 'best_valid_valid/diff': 0.714, 'best_valid_valid/acc_skew': 50.695, 'best_valid_valid/acc_align': 51.048, 'best_valid_test/acc': 54.738, 'best_valid_test/acc_unbiased': 50.202, 'best_valid_test/diff': 1.441, 'best_valid_test/acc_skew': 50.923, 'best_valid_test/acc_align': 49.482}
[2 / 20] best test accuracy: 50.202 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 54.541, 'best_test_valid/acc_unbiased': 50.872, 'best_test_valid/diff': 0.714, 'best_test_valid/acc_skew': 50.695, 'best_test_valid/acc_align': 51.048, 'best_test_test/acc': 54.738, 'best_test_test/acc_unbiased': 50.202, 'best_test_test/diff': 1.441, 'best_test_test/acc_skew': 50.923, 'best_test_test/acc_align': 49.482}
[3 / 20] Learning rate: 0.001 weight: 0.01
[3 / 20] Loss: 4.632637573065092 CE Loss: 0.5360630682593917 Con Loss: 4.627276946702998
[3 / 20] tensor([[0.966, 0.960],
        [0.166, 0.073]]) {'epoch': 3, 'valid/acc': 59.48, 'valid/acc_unbiased': 55.315, 'valid/diff': 2.888, 'valid/acc_skew': 55.7, 'valid/acc_align': 54.931, 'test/acc': 59.498, 'test/acc_unbiased': 54.128, 'test/diff': 4.96, 'test/acc_skew': 56.316, 'test/acc_align': 51.94}
[3 / 20] best valid accuracy: 55.315 at epoch 3 
 best_stats: {'best_valid_epoch': 3, 'best_valid_valid/acc': 59.48, 'best_valid_valid/acc_unbiased': 55.315, 'best_valid_valid/diff': 2.888, 'best_valid_valid/acc_skew': 55.7, 'best_valid_valid/acc_align': 54.931, 'best_valid_test/acc': 59.498, 'best_valid_test/acc_unbiased': 54.128, 'best_valid_test/diff': 4.96, 'best_valid_test/acc_skew': 56.316, 'best_valid_test/acc_align': 51.94}
[3 / 20] best test accuracy: 54.128 at epoch 3 
 best_stats: {'best_test_epoch': 3, 'best_test_valid/acc': 59.48, 'best_test_valid/acc_unbiased': 55.315, 'best_test_valid/diff': 2.888, 'best_test_valid/acc_skew': 55.7, 'best_test_valid/acc_align': 54.931, 'best_test_test/acc': 59.498, 'best_test_test/acc_unbiased': 54.128, 'best_test_test/diff': 4.96, 'best_test_test/acc_skew': 56.316, 'best_test_test/acc_align': 51.94}
[4 / 20] Learning rate: 0.001 weight: 0.01
[4 / 20] Loss: 4.593039086497888 CE Loss: 0.5236121619720666 Con Loss: 4.5878029658704245
[4 / 20] tensor([[0.936, 0.869],
        [0.371, 0.309]]) {'epoch': 4, 'valid/acc': 66.402, 'valid/acc_unbiased': 62.727, 'valid/diff': 4.188, 'valid/acc_skew': 60.638, 'valid/acc_align': 64.817, 'test/acc': 66.946, 'test/acc_unbiased': 62.143, 'test/diff': 6.445, 'test/acc_skew': 62.036, 'test/acc_align': 62.25}
[4 / 20] best valid accuracy: 62.727 at epoch 4 
 best_stats: {'best_valid_epoch': 4, 'best_valid_valid/acc': 66.402, 'best_valid_valid/acc_unbiased': 62.727, 'best_valid_valid/diff': 4.188, 'best_valid_valid/acc_skew': 60.638, 'best_valid_valid/acc_align': 64.817, 'best_valid_test/acc': 66.946, 'best_valid_test/acc_unbiased': 62.143, 'best_valid_test/diff': 6.445, 'best_valid_test/acc_skew': 62.036, 'best_valid_test/acc_align': 62.25}
[4 / 20] best test accuracy: 62.143 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 66.402, 'best_test_valid/acc_unbiased': 62.727, 'best_test_valid/diff': 4.188, 'best_test_valid/acc_skew': 60.638, 'best_test_valid/acc_align': 64.817, 'best_test_test/acc': 66.946, 'best_test_test/acc_unbiased': 62.143, 'best_test_test/diff': 6.445, 'best_test_test/acc_skew': 62.036, 'best_test_test/acc_align': 62.25}
[5 / 20] Learning rate: 0.001 weight: 0.01
[5 / 20] Loss: 4.53769466074519 CE Loss: 0.5088753933118373 Con Loss: 4.5326059185043786
[5 / 20] tensor([[0.988, 0.983],
        [0.083, 0.127]]) {'epoch': 5, 'valid/acc': 58.245, 'valid/acc_unbiased': 54.933, 'valid/diff': 2.918, 'valid/acc_skew': 53.474, 'valid/acc_align': 56.392, 'test/acc': 57.911, 'test/acc_unbiased': 54.525, 'test/diff': 2.451, 'test/acc_skew': 53.3, 'test/acc_align': 55.751}
[5 / 20] best valid accuracy: 62.727 at epoch 4 
 best_stats: {'best_valid_epoch': 4, 'best_valid_valid/acc': 66.402, 'best_valid_valid/acc_unbiased': 62.727, 'best_valid_valid/diff': 4.188, 'best_valid_valid/acc_skew': 60.638, 'best_valid_valid/acc_align': 64.817, 'best_valid_test/acc': 66.946, 'best_valid_test/acc_unbiased': 62.143, 'best_valid_test/diff': 6.445, 'best_valid_test/acc_skew': 62.036, 'best_valid_test/acc_align': 62.25}
[5 / 20] best test accuracy: 62.143 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 66.402, 'best_test_valid/acc_unbiased': 62.727, 'best_test_valid/diff': 4.188, 'best_test_valid/acc_skew': 60.638, 'best_test_valid/acc_align': 64.817, 'best_test_test/acc': 66.946, 'best_test_test/acc_unbiased': 62.143, 'best_test_test/diff': 6.445, 'best_test_test/acc_skew': 62.036, 'best_test_test/acc_align': 62.25}
[6 / 20] Learning rate: 0.001 weight: 0.01
[6 / 20] Loss: 4.54375548400222 CE Loss: 0.49410438430483355 Con Loss: 4.538814423817099
[6 / 20] tensor([[0.972, 0.892],
        [0.253, 0.261]]) {'epoch': 6, 'valid/acc': 63.58, 'valid/acc_unbiased': 59.12, 'valid/diff': 4.735, 'valid/acc_skew': 57.476, 'valid/acc_align': 60.765, 'test/acc': 63.905, 'test/acc_unbiased': 59.424, 'test/diff': 4.385, 'test/acc_skew': 57.232, 'test/acc_align': 61.617}
[6 / 20] best valid accuracy: 62.727 at epoch 4 
 best_stats: {'best_valid_epoch': 4, 'best_valid_valid/acc': 66.402, 'best_valid_valid/acc_unbiased': 62.727, 'best_valid_valid/diff': 4.188, 'best_valid_valid/acc_skew': 60.638, 'best_valid_valid/acc_align': 64.817, 'best_valid_test/acc': 66.946, 'best_valid_test/acc_unbiased': 62.143, 'best_valid_test/diff': 6.445, 'best_valid_test/acc_skew': 62.036, 'best_valid_test/acc_align': 62.25}
[6 / 20] best test accuracy: 62.143 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 66.402, 'best_test_valid/acc_unbiased': 62.727, 'best_test_valid/diff': 4.188, 'best_test_valid/acc_skew': 60.638, 'best_test_valid/acc_align': 64.817, 'best_test_test/acc': 66.946, 'best_test_test/acc_unbiased': 62.143, 'best_test_test/diff': 6.445, 'best_test_test/acc_skew': 62.036, 'best_test_test/acc_align': 62.25}
[7 / 20] Learning rate: 0.0001 weight: 0.01
[7 / 20] Loss: 4.409258716073388 CE Loss: 0.4756978350223918 Con Loss: 4.404501716459525
[7 / 20] tensor([[0.971, 0.847],
        [0.294, 0.345]]) {'epoch': 7, 'valid/acc': 65.388, 'valid/acc_unbiased': 61.751, 'valid/diff': 12.17, 'valid/acc_skew': 55.666, 'valid/acc_align': 67.836, 'test/acc': 65.712, 'test/acc_unbiased': 61.424, 'test/diff': 8.776, 'test/acc_skew': 57.035, 'test/acc_align': 65.812}
[7 / 20] best valid accuracy: 62.727 at epoch 4 
 best_stats: {'best_valid_epoch': 4, 'best_valid_valid/acc': 66.402, 'best_valid_valid/acc_unbiased': 62.727, 'best_valid_valid/diff': 4.188, 'best_valid_valid/acc_skew': 60.638, 'best_valid_valid/acc_align': 64.817, 'best_valid_test/acc': 66.946, 'best_valid_test/acc_unbiased': 62.143, 'best_valid_test/diff': 6.445, 'best_valid_test/acc_skew': 62.036, 'best_valid_test/acc_align': 62.25}
[7 / 20] best test accuracy: 62.143 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 66.402, 'best_test_valid/acc_unbiased': 62.727, 'best_test_valid/diff': 4.188, 'best_test_valid/acc_skew': 60.638, 'best_test_valid/acc_align': 64.817, 'best_test_test/acc': 66.946, 'best_test_test/acc_unbiased': 62.143, 'best_test_test/diff': 6.445, 'best_test_test/acc_skew': 62.036, 'best_test_test/acc_align': 62.25}
[8 / 20] Learning rate: 0.0001 weight: 0.01
[8 / 20] Loss: 4.331770450602038 CE Loss: 0.46178220498655587 Con Loss: 4.327152633167126
[8 / 20] tensor([[0.947, 0.665],
        [0.439, 0.515]]) {'epoch': 8, 'valid/acc': 70.15, 'valid/acc_unbiased': 66.143, 'valid/diff': 18.791, 'valid/acc_skew': 56.747, 'valid/acc_align': 75.538, 'test/acc': 69.987, 'test/acc_unbiased': 64.165, 'test/diff': 17.908, 'test/acc_skew': 55.211, 'test/acc_align': 73.119}
[8 / 20] best valid accuracy: 66.143 at epoch 8 
 best_stats: {'best_valid_epoch': 8, 'best_valid_valid/acc': 70.15, 'best_valid_valid/acc_unbiased': 66.143, 'best_valid_valid/diff': 18.791, 'best_valid_valid/acc_skew': 56.747, 'best_valid_valid/acc_align': 75.538, 'best_valid_test/acc': 69.987, 'best_valid_test/acc_unbiased': 64.165, 'best_valid_test/diff': 17.908, 'best_valid_test/acc_skew': 55.211, 'best_valid_test/acc_align': 73.119}
[8 / 20] best test accuracy: 64.165 at epoch 8 
 best_stats: {'best_test_epoch': 8, 'best_test_valid/acc': 70.15, 'best_test_valid/acc_unbiased': 66.143, 'best_test_valid/diff': 18.791, 'best_test_valid/acc_skew': 56.747, 'best_test_valid/acc_align': 75.538, 'best_test_test/acc': 69.987, 'best_test_test/acc_unbiased': 64.165, 'best_test_test/diff': 17.908, 'best_test_test/acc_skew': 55.211, 'best_test_test/acc_align': 73.119}
[9 / 20] Learning rate: 0.0001 weight: 0.01
[9 / 20] Loss: 4.269786700288351 CE Loss: 0.45260134780063294 Con Loss: 4.2652607115856584
[9 / 20] tensor([[0.973, 0.830],
        [0.347, 0.364]]) {'epoch': 9, 'valid/acc': 67.549, 'valid/acc_unbiased': 63.799, 'valid/diff': 10.559, 'valid/acc_skew': 58.52, 'valid/acc_align': 69.079, 'test/acc': 67.827, 'test/acc_unbiased': 62.826, 'test/diff': 7.979, 'test/acc_skew': 58.836, 'test/acc_align': 66.815}
[9 / 20] best valid accuracy: 66.143 at epoch 8 
 best_stats: {'best_valid_epoch': 8, 'best_valid_valid/acc': 70.15, 'best_valid_valid/acc_unbiased': 66.143, 'best_valid_valid/diff': 18.791, 'best_valid_valid/acc_skew': 56.747, 'best_valid_valid/acc_align': 75.538, 'best_valid_test/acc': 69.987, 'best_valid_test/acc_unbiased': 64.165, 'best_valid_test/diff': 17.908, 'best_valid_test/acc_skew': 55.211, 'best_valid_test/acc_align': 73.119}
[9 / 20] best test accuracy: 64.165 at epoch 8 
 best_stats: {'best_test_epoch': 8, 'best_test_valid/acc': 70.15, 'best_test_valid/acc_unbiased': 66.143, 'best_test_valid/diff': 18.791, 'best_test_valid/acc_skew': 56.747, 'best_test_valid/acc_align': 75.538, 'best_test_test/acc': 69.987, 'best_test_test/acc_unbiased': 64.165, 'best_test_test/diff': 17.908, 'best_test_test/acc_skew': 55.211, 'best_test_test/acc_align': 73.119}
[10 / 20] Learning rate: 0.0001 weight: 0.01
[10 / 20] Loss: 4.212312470210799 CE Loss: 0.43801231874771573 Con Loss: 4.207932347262321
[10 / 20] tensor([[0.977, 0.744],
        [0.348, 0.418]]) {'epoch': 10, 'valid/acc': 67.593, 'valid/acc_unbiased': 64.757, 'valid/diff': 15.477, 'valid/acc_skew': 57.019, 'valid/acc_align': 72.495, 'test/acc': 67.827, 'test/acc_unbiased': 62.205, 'test/diff': 15.146, 'test/acc_skew': 54.632, 'test/acc_align': 69.778}
[10 / 20] best valid accuracy: 66.143 at epoch 8 
 best_stats: {'best_valid_epoch': 8, 'best_valid_valid/acc': 70.15, 'best_valid_valid/acc_unbiased': 66.143, 'best_valid_valid/diff': 18.791, 'best_valid_valid/acc_skew': 56.747, 'best_valid_valid/acc_align': 75.538, 'best_valid_test/acc': 69.987, 'best_valid_test/acc_unbiased': 64.165, 'best_valid_test/diff': 17.908, 'best_valid_test/acc_skew': 55.211, 'best_valid_test/acc_align': 73.119}
[10 / 20] best test accuracy: 64.165 at epoch 8 
 best_stats: {'best_test_epoch': 8, 'best_test_valid/acc': 70.15, 'best_test_valid/acc_unbiased': 66.143, 'best_test_valid/diff': 18.791, 'best_test_valid/acc_skew': 56.747, 'best_test_valid/acc_align': 75.538, 'best_test_test/acc': 69.987, 'best_test_test/acc_unbiased': 64.165, 'best_test_test/diff': 17.908, 'best_test_test/acc_skew': 55.211, 'best_test_test/acc_align': 73.119}
[11 / 20] Learning rate: 0.0001 weight: 0.01
[11 / 20] Loss: 4.169693500885844 CE Loss: 0.42968734075674087 Con Loss: 4.165396624493358
[11 / 20] tensor([[0.983, 0.699],
        [0.301, 0.455]]) {'epoch': 11, 'valid/acc': 66.402, 'valid/acc_unbiased': 63.441, 'valid/diff': 18.895, 'valid/acc_skew': 53.994, 'valid/acc_align': 72.889, 'test/acc': 66.197, 'test/acc_unbiased': 60.937, 'test/diff': 21.884, 'test/acc_skew': 49.995, 'test/acc_align': 71.879}
[11 / 20] best valid accuracy: 66.143 at epoch 8 
 best_stats: {'best_valid_epoch': 8, 'best_valid_valid/acc': 70.15, 'best_valid_valid/acc_unbiased': 66.143, 'best_valid_valid/diff': 18.791, 'best_valid_valid/acc_skew': 56.747, 'best_valid_valid/acc_align': 75.538, 'best_valid_test/acc': 69.987, 'best_valid_test/acc_unbiased': 64.165, 'best_valid_test/diff': 17.908, 'best_valid_test/acc_skew': 55.211, 'best_valid_test/acc_align': 73.119}
[11 / 20] best test accuracy: 64.165 at epoch 8 
 best_stats: {'best_test_epoch': 8, 'best_test_valid/acc': 70.15, 'best_test_valid/acc_unbiased': 66.143, 'best_test_valid/diff': 18.791, 'best_test_valid/acc_skew': 56.747, 'best_test_valid/acc_align': 75.538, 'best_test_test/acc': 69.987, 'best_test_test/acc_unbiased': 64.165, 'best_test_test/diff': 17.908, 'best_test_test/acc_skew': 55.211, 'best_test_test/acc_align': 73.119}
[12 / 20] Learning rate: 0.0001 weight: 0.01
[12 / 20] Loss: 4.216102079165111 CE Loss: 0.4242623563966069 Con Loss: 4.211859475267554
[12 / 20] tensor([[0.975, 0.688],
        [0.359, 0.509]]) {'epoch': 12, 'valid/acc': 68.43, 'valid/acc_unbiased': 64.693, 'valid/diff': 22.944, 'valid/acc_skew': 53.221, 'valid/acc_align': 76.165, 'test/acc': 68.312, 'test/acc_unbiased': 63.246, 'test/diff': 21.872, 'test/acc_skew': 52.31, 'test/acc_align': 74.182}
[12 / 20] best valid accuracy: 66.143 at epoch 8 
 best_stats: {'best_valid_epoch': 8, 'best_valid_valid/acc': 70.15, 'best_valid_valid/acc_unbiased': 66.143, 'best_valid_valid/diff': 18.791, 'best_valid_valid/acc_skew': 56.747, 'best_valid_valid/acc_align': 75.538, 'best_valid_test/acc': 69.987, 'best_valid_test/acc_unbiased': 64.165, 'best_valid_test/diff': 17.908, 'best_valid_test/acc_skew': 55.211, 'best_valid_test/acc_align': 73.119}
[12 / 20] best test accuracy: 64.165 at epoch 8 
 best_stats: {'best_test_epoch': 8, 'best_test_valid/acc': 70.15, 'best_test_valid/acc_unbiased': 66.143, 'best_test_valid/diff': 18.791, 'best_test_valid/acc_skew': 56.747, 'best_test_valid/acc_align': 75.538, 'best_test_test/acc': 69.987, 'best_test_test/acc_unbiased': 64.165, 'best_test_test/diff': 17.908, 'best_test_test/acc_skew': 55.211, 'best_test_test/acc_align': 73.119}
[13 / 20] Learning rate: 0.0001 weight: 0.01
[13 / 20] Loss: 4.129377148562895 CE Loss: 0.41857833761438723 Con Loss: 4.125191364695365
[13 / 20] tensor([[0.975, 0.699],
        [0.388, 0.509]]) {'epoch': 13, 'valid/acc': 68.034, 'valid/acc_unbiased': 62.878, 'valid/diff': 22.311, 'valid/acc_skew': 51.723, 'valid/acc_align': 74.034, 'test/acc': 69.546, 'test/acc_unbiased': 64.275, 'test/diff': 19.909, 'test/acc_skew': 54.32, 'test/acc_align': 74.229}
[13 / 20] best valid accuracy: 66.143 at epoch 8 
 best_stats: {'best_valid_epoch': 8, 'best_valid_valid/acc': 70.15, 'best_valid_valid/acc_unbiased': 66.143, 'best_valid_valid/diff': 18.791, 'best_valid_valid/acc_skew': 56.747, 'best_valid_valid/acc_align': 75.538, 'best_valid_test/acc': 69.987, 'best_valid_test/acc_unbiased': 64.165, 'best_valid_test/diff': 17.908, 'best_valid_test/acc_skew': 55.211, 'best_valid_test/acc_align': 73.119}
[13 / 20] best test accuracy: 64.275 at epoch 13 
 best_stats: {'best_test_epoch': 13, 'best_test_valid/acc': 68.034, 'best_test_valid/acc_unbiased': 62.878, 'best_test_valid/diff': 22.311, 'best_test_valid/acc_skew': 51.723, 'best_test_valid/acc_align': 74.034, 'best_test_test/acc': 69.546, 'best_test_test/acc_unbiased': 64.275, 'best_test_test/diff': 19.909, 'best_test_test/acc_skew': 54.32, 'best_test_test/acc_align': 74.229}
[14 / 20] Learning rate: 1e-05 weight: 0.01
[14 / 20] Loss: 4.110923869205476 CE Loss: 0.4196135826054605 Con Loss: 4.106727730241531
[14 / 20] tensor([[0.978, 0.710],
        [0.363, 0.491]]) {'epoch': 14, 'valid/acc': 68.122, 'valid/acc_unbiased': 63.725, 'valid/diff': 20.221, 'valid/acc_skew': 53.614, 'valid/acc_align': 73.835, 'test/acc': 68.709, 'test/acc_unbiased': 63.57, 'test/diff': 19.784, 'test/acc_skew': 53.677, 'test/acc_align': 73.462}
[14 / 20] best valid accuracy: 66.143 at epoch 8 
 best_stats: {'best_valid_epoch': 8, 'best_valid_valid/acc': 70.15, 'best_valid_valid/acc_unbiased': 66.143, 'best_valid_valid/diff': 18.791, 'best_valid_valid/acc_skew': 56.747, 'best_valid_valid/acc_align': 75.538, 'best_valid_test/acc': 69.987, 'best_valid_test/acc_unbiased': 64.165, 'best_valid_test/diff': 17.908, 'best_valid_test/acc_skew': 55.211, 'best_valid_test/acc_align': 73.119}
[14 / 20] best test accuracy: 64.275 at epoch 13 
 best_stats: {'best_test_epoch': 13, 'best_test_valid/acc': 68.034, 'best_test_valid/acc_unbiased': 62.878, 'best_test_valid/diff': 22.311, 'best_test_valid/acc_skew': 51.723, 'best_test_valid/acc_align': 74.034, 'best_test_test/acc': 69.546, 'best_test_test/acc_unbiased': 64.275, 'best_test_test/diff': 19.909, 'best_test_test/acc_skew': 54.32, 'best_test_test/acc_align': 74.229}
[15 / 20] Learning rate: 1e-05 weight: 0.01
[15 / 20] Loss: 4.089189999472198 CE Loss: 0.4146102246542809 Con Loss: 4.085043896989669
[15 / 20] tensor([[0.978, 0.693],
        [0.360, 0.509]]) {'epoch': 15, 'valid/acc': 68.254, 'valid/acc_unbiased': 63.609, 'valid/diff': 19.752, 'valid/acc_skew': 53.733, 'valid/acc_align': 73.486, 'test/acc': 68.576, 'test/acc_unbiased': 63.511, 'test/diff': 21.718, 'test/acc_skew': 52.652, 'test/acc_align': 74.371}
[15 / 20] best valid accuracy: 66.143 at epoch 8 
 best_stats: {'best_valid_epoch': 8, 'best_valid_valid/acc': 70.15, 'best_valid_valid/acc_unbiased': 66.143, 'best_valid_valid/diff': 18.791, 'best_valid_valid/acc_skew': 56.747, 'best_valid_valid/acc_align': 75.538, 'best_valid_test/acc': 69.987, 'best_valid_test/acc_unbiased': 64.165, 'best_valid_test/diff': 17.908, 'best_valid_test/acc_skew': 55.211, 'best_valid_test/acc_align': 73.119}
[15 / 20] best test accuracy: 64.275 at epoch 13 
 best_stats: {'best_test_epoch': 13, 'best_test_valid/acc': 68.034, 'best_test_valid/acc_unbiased': 62.878, 'best_test_valid/diff': 22.311, 'best_test_valid/acc_skew': 51.723, 'best_test_valid/acc_align': 74.034, 'best_test_test/acc': 69.546, 'best_test_test/acc_unbiased': 64.275, 'best_test_test/diff': 19.909, 'best_test_test/acc_skew': 54.32, 'best_test_test/acc_align': 74.229}
[16 / 20] Learning rate: 1e-05 weight: 0.01
[16 / 20] Loss: 4.03866886985476 CE Loss: 0.4066714593441198 Con Loss: 4.034602141657022
[16 / 20] tensor([[0.979, 0.705],
        [0.360, 0.485]]) {'epoch': 16, 'valid/acc': 67.681, 'valid/acc_unbiased': 63.228, 'valid/diff': 20.417, 'valid/acc_skew': 53.02, 'valid/acc_align': 73.437, 'test/acc': 68.532, 'test/acc_unbiased': 63.213, 'test/diff': 19.985, 'test/acc_skew': 53.22, 'test/acc_align': 73.206}
[16 / 20] best valid accuracy: 66.143 at epoch 8 
 best_stats: {'best_valid_epoch': 8, 'best_valid_valid/acc': 70.15, 'best_valid_valid/acc_unbiased': 66.143, 'best_valid_valid/diff': 18.791, 'best_valid_valid/acc_skew': 56.747, 'best_valid_valid/acc_align': 75.538, 'best_valid_test/acc': 69.987, 'best_valid_test/acc_unbiased': 64.165, 'best_valid_test/diff': 17.908, 'best_valid_test/acc_skew': 55.211, 'best_valid_test/acc_align': 73.119}
[16 / 20] best test accuracy: 64.275 at epoch 13 
 best_stats: {'best_test_epoch': 13, 'best_test_valid/acc': 68.034, 'best_test_valid/acc_unbiased': 62.878, 'best_test_valid/diff': 22.311, 'best_test_valid/acc_skew': 51.723, 'best_test_valid/acc_align': 74.034, 'best_test_test/acc': 69.546, 'best_test_test/acc_unbiased': 64.275, 'best_test_test/diff': 19.909, 'best_test_test/acc_skew': 54.32, 'best_test_test/acc_align': 74.229}
[17 / 20] Learning rate: 1e-05 weight: 0.01
[17 / 20] Loss: 4.100015216800257 CE Loss: 0.4132735956612262 Con Loss: 4.095882465222586
[17 / 20] tensor([[0.980, 0.688],
        [0.349, 0.473]]) {'epoch': 17, 'valid/acc': 67.593, 'valid/acc_unbiased': 63.445, 'valid/diff': 21.169, 'valid/acc_skew': 52.86, 'valid/acc_align': 74.029, 'test/acc': 67.959, 'test/acc_unbiased': 62.248, 'test/diff': 20.798, 'test/acc_skew': 51.849, 'test/acc_align': 72.647}
[17 / 20] best valid accuracy: 66.143 at epoch 8 
 best_stats: {'best_valid_epoch': 8, 'best_valid_valid/acc': 70.15, 'best_valid_valid/acc_unbiased': 66.143, 'best_valid_valid/diff': 18.791, 'best_valid_valid/acc_skew': 56.747, 'best_valid_valid/acc_align': 75.538, 'best_valid_test/acc': 69.987, 'best_valid_test/acc_unbiased': 64.165, 'best_valid_test/diff': 17.908, 'best_valid_test/acc_skew': 55.211, 'best_valid_test/acc_align': 73.119}
[17 / 20] best test accuracy: 64.275 at epoch 13 
 best_stats: {'best_test_epoch': 13, 'best_test_valid/acc': 68.034, 'best_test_valid/acc_unbiased': 62.878, 'best_test_valid/diff': 22.311, 'best_test_valid/acc_skew': 51.723, 'best_test_valid/acc_align': 74.034, 'best_test_test/acc': 69.546, 'best_test_test/acc_unbiased': 64.275, 'best_test_test/diff': 19.909, 'best_test_test/acc_skew': 54.32, 'best_test_test/acc_align': 74.229}
[18 / 20] Learning rate: 1e-05 weight: 0.01
[18 / 20] Loss: 4.030599326151937 CE Loss: 0.4038269099605436 Con Loss: 4.026561056170648
[18 / 20] tensor([[0.978, 0.659],
        [0.383, 0.521]]) {'epoch': 18, 'valid/acc': 68.695, 'valid/acc_unbiased': 63.881, 'valid/diff': 22.577, 'valid/acc_skew': 52.592, 'valid/acc_align': 75.17, 'test/acc': 69.282, 'test/acc_unbiased': 63.539, 'test/diff': 22.876, 'test/acc_skew': 52.101, 'test/acc_align': 74.977}
[18 / 20] best valid accuracy: 66.143 at epoch 8 
 best_stats: {'best_valid_epoch': 8, 'best_valid_valid/acc': 70.15, 'best_valid_valid/acc_unbiased': 66.143, 'best_valid_valid/diff': 18.791, 'best_valid_valid/acc_skew': 56.747, 'best_valid_valid/acc_align': 75.538, 'best_valid_test/acc': 69.987, 'best_valid_test/acc_unbiased': 64.165, 'best_valid_test/diff': 17.908, 'best_valid_test/acc_skew': 55.211, 'best_valid_test/acc_align': 73.119}
[18 / 20] best test accuracy: 64.275 at epoch 13 
 best_stats: {'best_test_epoch': 13, 'best_test_valid/acc': 68.034, 'best_test_valid/acc_unbiased': 62.878, 'best_test_valid/diff': 22.311, 'best_test_valid/acc_skew': 51.723, 'best_test_valid/acc_align': 74.034, 'best_test_test/acc': 69.546, 'best_test_test/acc_unbiased': 64.275, 'best_test_test/diff': 19.909, 'best_test_test/acc_skew': 54.32, 'best_test_test/acc_align': 74.229}
[19 / 20] Learning rate: 1e-05 weight: 0.01
[19 / 20] Loss: 4.0516377512054556 CE Loss: 0.4069613816920223 Con Loss: 4.047568128868597
[19 / 20] tensor([[0.976, 0.653],
        [0.382, 0.521]]) {'epoch': 19, 'valid/acc': 68.298, 'valid/acc_unbiased': 63.239, 'valid/diff': 22.676, 'valid/acc_skew': 51.901, 'valid/acc_align': 74.578, 'test/acc': 69.105, 'test/acc_unbiased': 63.321, 'test/diff': 23.123, 'test/acc_skew': 51.759, 'test/acc_align': 74.882}
[19 / 20] best valid accuracy: 66.143 at epoch 8 
 best_stats: {'best_valid_epoch': 8, 'best_valid_valid/acc': 70.15, 'best_valid_valid/acc_unbiased': 66.143, 'best_valid_valid/diff': 18.791, 'best_valid_valid/acc_skew': 56.747, 'best_valid_valid/acc_align': 75.538, 'best_valid_test/acc': 69.987, 'best_valid_test/acc_unbiased': 64.165, 'best_valid_test/diff': 17.908, 'best_valid_test/acc_skew': 55.211, 'best_valid_test/acc_align': 73.119}
[19 / 20] best test accuracy: 64.275 at epoch 13 
 best_stats: {'best_test_epoch': 13, 'best_test_valid/acc': 68.034, 'best_test_valid/acc_unbiased': 62.878, 'best_test_valid/diff': 22.311, 'best_test_valid/acc_skew': 51.723, 'best_test_valid/acc_align': 74.034, 'best_test_test/acc': 69.546, 'best_test_test/acc_unbiased': 64.275, 'best_test_test/diff': 19.909, 'best_test_test/acc_skew': 54.32, 'best_test_test/acc_align': 74.229}
[20 / 20] Learning rate: 1e-05 weight: 0.01
[20 / 20] Loss: 4.001986719079341 CE Loss: 0.3990247335183134 Con Loss: 3.9979964855769654
[20 / 20] tensor([[0.979, 0.670],
        [0.356, 0.491]]) {'epoch': 20, 'valid/acc': 67.945, 'valid/acc_unbiased': 63.47, 'valid/diff': 21.807, 'valid/acc_skew': 52.567, 'valid/acc_align': 74.374, 'test/acc': 68.18, 'test/acc_unbiased': 62.426, 'test/diff': 22.166, 'test/acc_skew': 51.343, 'test/acc_align': 73.509}
[20 / 20] best valid accuracy: 66.143 at epoch 8 
 best_stats: {'best_valid_epoch': 8, 'best_valid_valid/acc': 70.15, 'best_valid_valid/acc_unbiased': 66.143, 'best_valid_valid/diff': 18.791, 'best_valid_valid/acc_skew': 56.747, 'best_valid_valid/acc_align': 75.538, 'best_valid_test/acc': 69.987, 'best_valid_test/acc_unbiased': 64.165, 'best_valid_test/diff': 17.908, 'best_valid_test/acc_skew': 55.211, 'best_valid_test/acc_align': 73.119}
[20 / 20] best test accuracy: 64.275 at epoch 13 
 best_stats: {'best_test_epoch': 13, 'best_test_valid/acc': 68.034, 'best_test_valid/acc_unbiased': 62.878, 'best_test_valid/diff': 22.311, 'best_test_valid/acc_skew': 51.723, 'best_test_valid/acc_align': 74.034, 'best_test_test/acc': 69.546, 'best_test_test/acc_unbiased': 64.275, 'best_test_test/diff': 19.909, 'best_test_test/acc_skew': 54.32, 'best_test_test/acc_align': 74.229}
Total training time: 0:16:41
