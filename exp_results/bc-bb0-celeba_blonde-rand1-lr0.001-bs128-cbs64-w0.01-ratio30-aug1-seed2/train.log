Log level set to: INFO
Set seed: 2
=======> Using Fixed Random Seed: 2 <========
save_path: exp_results/bc-bb0-celeba_blonde-rand1-lr0.001-bs128-cbs64-w0.01-ratio30-aug1-seed2
get_celeba - split:train, aug: False, given_y: True, ratio: 0
use existing blonde indices from data/celeba/pickles/blonde
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [1586, 53554]
Target 1: [18282, 1090]
Binary Target 1
---------------------------
Target 0: [1586, 53554]
Target 1: [18282, 1090]
===================================
Normal Label Distribution: 
Target 0: [1586, 53554]
Target 1: [18282, 1090]
===================================
Use BiasedCelebASplit 
 target_attr: blonde split: train 
 tensor([[ 1586., 18282.],
        [53554.,  1090.]])
get_celeba - split:train, aug: 1, given_y: True, ratio: 30
use existing blonde indices from data/celeba/pickles/blonde
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [1615, 53474]
Target 1: [18298, 1125]
Binary Target 1
---------------------------
Target 0: [1615, 53474]
Target 1: [18298, 1125]
===================================
Normal Label Distribution: 
Target 0: [1615, 53474]
Target 1: [18298, 1125]
===================================
Use BiasedCelebASplit 
 target_attr: blonde split: train 
 tensor([[ 1615., 18298.],
        [53474.,  1125.]])
get_celeba - split:train_valid, aug: False, given_y: True, ratio: 0
use existing blonde indices from data/celeba/pickles/blonde
Use BiasedCelebASplit 
 target_attr: blonde split: train_valid 
 tensor([[  403.,  4597.],
        [13344.,   285.]])
get_celeba - split:valid, aug: False, given_y: True, ratio: 0
Use BiasedCelebASplit 
 target_attr: blonde split: valid 
 tensor([[8535., 2874.],
        [8276.,  182.]])
decay_epochs: [3, 6]
[1 / 10] Learning rate: 0.001 weight: 0.01
[1 / 10] Loss: 4.689251672205352 CE Loss: 0.2005139839992852 Con Loss: 4.687246525571765
[1 / 10] tensor([[0.734, 0.785],
        [0.982, 0.962]]) {'epoch': 1, 'valid/acc': 83.451, 'valid/acc_unbiased': 88.362, 'valid/diff': 0.928, 'valid/acc_skew': 88.598, 'valid/acc_align': 88.126, 'test/acc': 79.312, 'test/acc_unbiased': 86.557, 'test/diff': 3.604, 'test/acc_skew': 84.755, 'test/acc_align': 88.359}
[1 / 10] best valid accuracy: 88.362 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 83.451, 'best_valid_valid/acc_unbiased': 88.362, 'best_valid_valid/diff': 0.928, 'best_valid_valid/acc_skew': 88.598, 'best_valid_valid/acc_align': 88.126, 'best_valid_test/acc': 79.312, 'best_valid_test/acc_unbiased': 86.557, 'best_valid_test/diff': 3.604, 'best_valid_test/acc_skew': 84.755, 'best_valid_test/acc_align': 88.359}
[1 / 10] best test accuracy: 86.557 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 83.451, 'best_test_valid/acc_unbiased': 88.362, 'best_test_valid/diff': 0.928, 'best_test_valid/acc_skew': 88.598, 'best_test_valid/acc_align': 88.126, 'best_test_test/acc': 79.312, 'best_test_test/acc_unbiased': 86.557, 'best_test_test/diff': 3.604, 'best_test_test/acc_skew': 84.755, 'best_test_test/acc_align': 88.359}
[2 / 10] Learning rate: 0.001 weight: 0.01
[2 / 10] Loss: 4.653974201946983 CE Loss: 0.17592652741358059 Con Loss: 4.652214935569772
[2 / 10] tensor([[0.922, 0.974],
        [0.820, 0.626]]) {'epoch': 2, 'valid/acc': 92.587, 'valid/acc_unbiased': 84.297, 'valid/diff': 9.902, 'valid/acc_skew': 79.346, 'valid/acc_align': 89.247, 'test/acc': 92.646, 'test/acc_unbiased': 83.582, 'test/diff': 12.283, 'test/acc_skew': 77.441, 'test/acc_align': 89.724}
[2 / 10] best valid accuracy: 88.362 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 83.451, 'best_valid_valid/acc_unbiased': 88.362, 'best_valid_valid/diff': 0.928, 'best_valid_valid/acc_skew': 88.598, 'best_valid_valid/acc_align': 88.126, 'best_valid_test/acc': 79.312, 'best_valid_test/acc_unbiased': 86.557, 'best_valid_test/diff': 3.604, 'best_valid_test/acc_skew': 84.755, 'best_valid_test/acc_align': 88.359}
[2 / 10] best test accuracy: 86.557 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 83.451, 'best_test_valid/acc_unbiased': 88.362, 'best_test_valid/diff': 0.928, 'best_test_valid/acc_skew': 88.598, 'best_test_valid/acc_align': 88.126, 'best_test_test/acc': 79.312, 'best_test_test/acc_unbiased': 86.557, 'best_test_test/diff': 3.604, 'best_test_test/acc_skew': 84.755, 'best_test_test/acc_align': 88.359}
[3 / 10] Learning rate: 0.001 weight: 0.01
[3 / 10] Loss: 4.636709508861061 CE Loss: 0.17020852494859276 Con Loss: 4.635007414409268
[3 / 10] tensor([[0.857, 0.930],
        [0.942, 0.934]]) {'epoch': 3, 'valid/acc': 93.038, 'valid/acc_unbiased': 92.757, 'valid/diff': 1.628, 'valid/acc_skew': 91.943, 'valid/acc_align': 93.571, 'test/acc': 90.029, 'test/acc_unbiased': 91.573, 'test/diff': 4.069, 'test/acc_skew': 89.539, 'test/acc_align': 93.608}
[3 / 10] best valid accuracy: 92.757 at epoch 3 
 best_stats: {'best_valid_epoch': 3, 'best_valid_valid/acc': 93.038, 'best_valid_valid/acc_unbiased': 92.757, 'best_valid_valid/diff': 1.628, 'best_valid_valid/acc_skew': 91.943, 'best_valid_valid/acc_align': 93.571, 'best_valid_test/acc': 90.029, 'best_valid_test/acc_unbiased': 91.573, 'best_valid_test/diff': 4.069, 'best_valid_test/acc_skew': 89.539, 'best_valid_test/acc_align': 93.608}
[3 / 10] best test accuracy: 91.573 at epoch 3 
 best_stats: {'best_test_epoch': 3, 'best_test_valid/acc': 93.038, 'best_test_valid/acc_unbiased': 92.757, 'best_test_valid/diff': 1.628, 'best_test_valid/acc_skew': 91.943, 'best_test_valid/acc_align': 93.571, 'best_test_test/acc': 90.029, 'best_test_test/acc_unbiased': 91.573, 'best_test_test/diff': 4.069, 'best_test_test/acc_skew': 89.539, 'best_test_test/acc_align': 93.608}
[4 / 10] Learning rate: 0.0001 weight: 0.01
[4 / 10] Loss: 4.583330140391311 CE Loss: 0.14495957265545018 Con Loss: 4.581880540583608
[4 / 10] tensor([[0.910, 0.969],
        [0.908, 0.830]]) {'epoch': 4, 'valid/acc': 95.002, 'valid/acc_unbiased': 92.419, 'valid/diff': 5.164, 'valid/acc_skew': 91.083, 'valid/acc_align': 93.755, 'test/acc': 93.346, 'test/acc_unbiased': 90.408, 'test/diff': 6.823, 'test/acc_skew': 86.996, 'test/acc_align': 93.819}
[4 / 10] best valid accuracy: 92.757 at epoch 3 
 best_stats: {'best_valid_epoch': 3, 'best_valid_valid/acc': 93.038, 'best_valid_valid/acc_unbiased': 92.757, 'best_valid_valid/diff': 1.628, 'best_valid_valid/acc_skew': 91.943, 'best_valid_valid/acc_align': 93.571, 'best_valid_test/acc': 90.029, 'best_valid_test/acc_unbiased': 91.573, 'best_valid_test/diff': 4.069, 'best_valid_test/acc_skew': 89.539, 'best_valid_test/acc_align': 93.608}
[4 / 10] best test accuracy: 91.573 at epoch 3 
 best_stats: {'best_test_epoch': 3, 'best_test_valid/acc': 93.038, 'best_test_valid/acc_unbiased': 92.757, 'best_test_valid/diff': 1.628, 'best_test_valid/acc_skew': 91.943, 'best_test_valid/acc_align': 93.571, 'best_test_test/acc': 90.029, 'best_test_test/acc_unbiased': 91.573, 'best_test_test/diff': 4.069, 'best_test_test/acc_skew': 89.539, 'best_test_test/acc_align': 93.608}
[5 / 10] Learning rate: 0.0001 weight: 0.01
[5 / 10] Loss: 4.570899765968118 CE Loss: 0.1412174801778353 Con Loss: 4.569487585436768
[5 / 10] tensor([[0.908, 0.969],
        [0.916, 0.819]]) {'epoch': 5, 'valid/acc': 95.11, 'valid/acc_unbiased': 92.808, 'valid/diff': 4.271, 'valid/acc_skew': 91.588, 'valid/acc_align': 94.029, 'test/acc': 93.396, 'test/acc_unbiased': 90.312, 'test/diff': 7.907, 'test/acc_skew': 86.359, 'test/acc_align': 94.266}
[5 / 10] best valid accuracy: 92.808 at epoch 5 
 best_stats: {'best_valid_epoch': 5, 'best_valid_valid/acc': 95.11, 'best_valid_valid/acc_unbiased': 92.808, 'best_valid_valid/diff': 4.271, 'best_valid_valid/acc_skew': 91.588, 'best_valid_valid/acc_align': 94.029, 'best_valid_test/acc': 93.396, 'best_valid_test/acc_unbiased': 90.312, 'best_valid_test/diff': 7.907, 'best_valid_test/acc_skew': 86.359, 'best_valid_test/acc_align': 94.266}
[5 / 10] best test accuracy: 91.573 at epoch 3 
 best_stats: {'best_test_epoch': 3, 'best_test_valid/acc': 93.038, 'best_test_valid/acc_unbiased': 92.757, 'best_test_valid/diff': 1.628, 'best_test_valid/acc_skew': 91.943, 'best_test_valid/acc_align': 93.571, 'best_test_test/acc': 90.029, 'best_test_test/acc_unbiased': 91.573, 'best_test_test/diff': 4.069, 'best_test_test/acc_skew': 89.539, 'best_test_test/acc_align': 93.608}
[6 / 10] Learning rate: 0.0001 weight: 0.01
[6 / 10] Loss: 4.549888681182796 CE Loss: 0.13430375514789178 Con Loss: 4.5485456439848235
[6 / 10] tensor([[0.904, 0.976],
        [0.918, 0.758]]) {'epoch': 6, 'valid/acc': 95.63, 'valid/acc_unbiased': 92.343, 'valid/diff': 6.542, 'valid/acc_skew': 90.154, 'valid/acc_align': 94.533, 'test/acc': 93.472, 'test/acc_unbiased': 88.912, 'test/diff': 11.607, 'test/acc_skew': 83.108, 'test/acc_align': 94.715}
[6 / 10] best valid accuracy: 92.808 at epoch 5 
 best_stats: {'best_valid_epoch': 5, 'best_valid_valid/acc': 95.11, 'best_valid_valid/acc_unbiased': 92.808, 'best_valid_valid/diff': 4.271, 'best_valid_valid/acc_skew': 91.588, 'best_valid_valid/acc_align': 94.029, 'best_valid_test/acc': 93.396, 'best_valid_test/acc_unbiased': 90.312, 'best_valid_test/diff': 7.907, 'best_valid_test/acc_skew': 86.359, 'best_valid_test/acc_align': 94.266}
[6 / 10] best test accuracy: 91.573 at epoch 3 
 best_stats: {'best_test_epoch': 3, 'best_test_valid/acc': 93.038, 'best_test_valid/acc_unbiased': 92.757, 'best_test_valid/diff': 1.628, 'best_test_valid/acc_skew': 91.943, 'best_test_valid/acc_align': 93.571, 'best_test_test/acc': 90.029, 'best_test_test/acc_unbiased': 91.573, 'best_test_test/diff': 4.069, 'best_test_test/acc_skew': 89.539, 'best_test_test/acc_align': 93.608}
[7 / 10] Learning rate: 1e-05 weight: 0.01
[7 / 10] Loss: 4.541372098916586 CE Loss: 0.12401113759855076 Con Loss: 4.5401319950620636
[7 / 10] tensor([[0.920, 0.978],
        [0.908, 0.764]]) {'epoch': 7, 'valid/acc': 95.545, 'valid/acc_unbiased': 92.013, 'valid/diff': 6.298, 'valid/acc_skew': 89.927, 'valid/acc_align': 94.099, 'test/acc': 94.106, 'test/acc_unbiased': 89.25, 'test/diff': 10.128, 'test/acc_skew': 84.186, 'test/acc_align': 94.314}
[7 / 10] best valid accuracy: 92.808 at epoch 5 
 best_stats: {'best_valid_epoch': 5, 'best_valid_valid/acc': 95.11, 'best_valid_valid/acc_unbiased': 92.808, 'best_valid_valid/diff': 4.271, 'best_valid_valid/acc_skew': 91.588, 'best_valid_valid/acc_align': 94.029, 'best_valid_test/acc': 93.396, 'best_valid_test/acc_unbiased': 90.312, 'best_valid_test/diff': 7.907, 'best_valid_test/acc_skew': 86.359, 'best_valid_test/acc_align': 94.266}
[7 / 10] best test accuracy: 91.573 at epoch 3 
 best_stats: {'best_test_epoch': 3, 'best_test_valid/acc': 93.038, 'best_test_valid/acc_unbiased': 92.757, 'best_test_valid/diff': 1.628, 'best_test_valid/acc_skew': 91.943, 'best_test_valid/acc_align': 93.571, 'best_test_test/acc': 90.029, 'best_test_test/acc_unbiased': 91.573, 'best_test_test/diff': 4.069, 'best_test_test/acc_skew': 89.539, 'best_test_test/acc_align': 93.608}
[8 / 10] Learning rate: 1e-05 weight: 0.01
[8 / 10] Loss: 4.539508569130499 CE Loss: 0.12636342110975837 Con Loss: 4.538244933152317
[8 / 10] tensor([[0.911, 0.976],
        [0.916, 0.797]]) {'epoch': 8, 'valid/acc': 95.62, 'valid/acc_unbiased': 92.83, 'valid/diff': 5.417, 'valid/acc_skew': 91.207, 'valid/acc_align': 94.453, 'test/acc': 93.774, 'test/acc_unbiased': 90.0, 'test/diff': 9.269, 'test/acc_skew': 85.365, 'test/acc_align': 94.634}
[8 / 10] best valid accuracy: 92.830 at epoch 8 
 best_stats: {'best_valid_epoch': 8, 'best_valid_valid/acc': 95.62, 'best_valid_valid/acc_unbiased': 92.83, 'best_valid_valid/diff': 5.417, 'best_valid_valid/acc_skew': 91.207, 'best_valid_valid/acc_align': 94.453, 'best_valid_test/acc': 93.774, 'best_valid_test/acc_unbiased': 90.0, 'best_valid_test/diff': 9.269, 'best_valid_test/acc_skew': 85.365, 'best_valid_test/acc_align': 94.634}
[8 / 10] best test accuracy: 91.573 at epoch 3 
 best_stats: {'best_test_epoch': 3, 'best_test_valid/acc': 93.038, 'best_test_valid/acc_unbiased': 92.757, 'best_test_valid/diff': 1.628, 'best_test_valid/acc_skew': 91.943, 'best_test_valid/acc_align': 93.571, 'best_test_test/acc': 90.029, 'best_test_test/acc_unbiased': 91.573, 'best_test_test/diff': 4.069, 'best_test_test/acc_skew': 89.539, 'best_test_test/acc_align': 93.608}
[9 / 10] Learning rate: 1e-05 weight: 0.01
[9 / 10] Loss: 4.533108047438661 CE Loss: 0.12505144164100568 Con Loss: 4.5318575234072185
[9 / 10] tensor([[0.901, 0.969],
        [0.930, 0.841]]) {'epoch': 9, 'valid/acc': 95.598, 'valid/acc_unbiased': 93.696, 'valid/diff': 4.136, 'valid/acc_skew': 92.589, 'valid/acc_align': 94.804, 'test/acc': 93.285, 'test/acc_unbiased': 91.011, 'test/diff': 7.856, 'test/acc_skew': 87.083, 'test/acc_align': 94.938}
[9 / 10] best valid accuracy: 93.696 at epoch 9 
 best_stats: {'best_valid_epoch': 9, 'best_valid_valid/acc': 95.598, 'best_valid_valid/acc_unbiased': 93.696, 'best_valid_valid/diff': 4.136, 'best_valid_valid/acc_skew': 92.589, 'best_valid_valid/acc_align': 94.804, 'best_valid_test/acc': 93.285, 'best_valid_test/acc_unbiased': 91.011, 'best_valid_test/diff': 7.856, 'best_valid_test/acc_skew': 87.083, 'best_valid_test/acc_align': 94.938}
[9 / 10] best test accuracy: 91.573 at epoch 3 
 best_stats: {'best_test_epoch': 3, 'best_test_valid/acc': 93.038, 'best_test_valid/acc_unbiased': 92.757, 'best_test_valid/diff': 1.628, 'best_test_valid/acc_skew': 91.943, 'best_test_valid/acc_align': 93.571, 'best_test_test/acc': 90.029, 'best_test_test/acc_unbiased': 91.573, 'best_test_test/diff': 4.069, 'best_test_test/acc_skew': 89.539, 'best_test_test/acc_align': 93.608}
[10 / 10] Learning rate: 1e-05 weight: 0.01
[10 / 10] Loss: 4.530813600516816 CE Loss: 0.12361612932951327 Con Loss: 4.5295774409871825
[10 / 10] tensor([[0.923, 0.981],
        [0.904, 0.720]]) {'epoch': 10, 'valid/acc': 95.486, 'valid/acc_unbiased': 91.571, 'valid/diff': 6.302, 'valid/acc_skew': 89.277, 'valid/acc_align': 93.866, 'test/acc': 94.242, 'test/acc_unbiased': 88.18, 'test/diff': 12.092, 'test/acc_skew': 82.134, 'test/acc_align': 94.226}
[10 / 10] best valid accuracy: 93.696 at epoch 9 
 best_stats: {'best_valid_epoch': 9, 'best_valid_valid/acc': 95.598, 'best_valid_valid/acc_unbiased': 93.696, 'best_valid_valid/diff': 4.136, 'best_valid_valid/acc_skew': 92.589, 'best_valid_valid/acc_align': 94.804, 'best_valid_test/acc': 93.285, 'best_valid_test/acc_unbiased': 91.011, 'best_valid_test/diff': 7.856, 'best_valid_test/acc_skew': 87.083, 'best_valid_test/acc_align': 94.938}
[10 / 10] best test accuracy: 91.573 at epoch 3 
 best_stats: {'best_test_epoch': 3, 'best_test_valid/acc': 93.038, 'best_test_valid/acc_unbiased': 92.757, 'best_test_valid/diff': 1.628, 'best_test_valid/acc_skew': 91.943, 'best_test_valid/acc_align': 93.571, 'best_test_test/acc': 90.029, 'best_test_test/acc_unbiased': 91.573, 'best_test_test/diff': 4.069, 'best_test_test/acc_skew': 89.539, 'best_test_test/acc_align': 93.608}
Total training time: 0:47:10
