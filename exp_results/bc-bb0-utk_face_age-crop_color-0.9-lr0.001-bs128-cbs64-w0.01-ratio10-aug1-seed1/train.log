Log level set to: INFO
Set seed: 1
=======> Using Fixed Random Seed: 1 <========
save_path: exp_results/bc-bb0-utk_face_age-crop_color-0.9-lr0.001-bs128-cbs64-w0.01-ratio10-aug1-seed1
get_utk_face - split: train, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_age-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
Binary Target 1
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Normal Label Distribution: 
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
Binary Target 1
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Normal Label Distribution: 
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 10684, target_attr: gender, bias_attr: age bias_rate: 0.9
['[train] target_0-bias_0: 8237', '[train] target_0-bias_1: 147', '[train] target_1-bias_0: 823', '[train] target_1-bias_1: 1477']
confusion_matrix - 
 original: tensor([[8237.,  823.],
        [ 147., 1477.]]), 
 normalized: tensor([[0.909, 0.091],
        [0.091, 0.909]]), 
 b|y: tensor([[0.982, 0.018],
        [0.358, 0.642]])
get_utk_face - split: train, aug: 1, given_y: True, ratio: 10
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_age-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
Binary Target 1
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Normal Label Distribution: 
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
Binary Target 1
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Normal Label Distribution: 
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 10684, target_attr: gender, bias_attr: age bias_rate: 0.9
['[train] target_0-bias_0: 8237', '[train] target_0-bias_1: 147', '[train] target_1-bias_0: 823', '[train] target_1-bias_1: 1477']
get_utk_face - split: valid, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_age-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [1030, 195]
Target 1: [841, 202]
Binary Target 1
---------------------------
Target 0: [1030, 195]
Target 1: [841, 202]
===================================
Normal Label Distribution: 
Target 0: [1030, 195]
Target 1: [841, 202]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 2268, target_attr: gender, bias_attr: age bias_rate: 0.9
['[valid] target_0-bias_0: 1030', '[valid] target_0-bias_1: 195', '[valid] target_1-bias_0: 841', '[valid] target_1-bias_1: 202']
get_utk_face - split: test, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_age-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [1061, 176]
Target 1: [867, 165]
Binary Target 1
---------------------------
Target 0: [1061, 176]
Target 1: [867, 165]
===================================
Normal Label Distribution: 
Target 0: [1061, 176]
Target 1: [867, 165]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 2269, target_attr: gender, bias_attr: age bias_rate: 0.9
['[test] target_0-bias_0: 1061', '[test] target_0-bias_1: 176', '[test] target_1-bias_0: 867', '[test] target_1-bias_1: 165']
decay_epochs: [6, 13]
[1 / 20] Learning rate: 0.001 weight: 0.01
[1 / 20] Loss: 4.7671527339474 CE Loss: 0.5698626175528383 Con Loss: 4.761454108233578
[1 / 20] tensor([[0.964, 0.977],
        [0.358, 0.121]]) {'epoch': 1, 'valid/acc': 65.917, 'valid/acc_unbiased': 60.982, 'valid/diff': 7.851, 'valid/acc_skew': 64.908, 'valid/acc_align': 57.057, 'test/acc': 67.21, 'test/acc_unbiased': 60.506, 'test/diff': 12.472, 'test/acc_skew': 66.741, 'test/acc_align': 54.27}
[1 / 20] best valid accuracy: 60.982 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 65.917, 'best_valid_valid/acc_unbiased': 60.982, 'best_valid_valid/diff': 7.851, 'best_valid_valid/acc_skew': 64.908, 'best_valid_valid/acc_align': 57.057, 'best_valid_test/acc': 67.21, 'best_valid_test/acc_unbiased': 60.506, 'best_valid_test/diff': 12.472, 'best_valid_test/acc_skew': 66.741, 'best_valid_test/acc_align': 54.27}
[1 / 20] best test accuracy: 60.506 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 65.917, 'best_test_valid/acc_unbiased': 60.982, 'best_test_valid/diff': 7.851, 'best_test_valid/acc_skew': 64.908, 'best_test_valid/acc_align': 57.057, 'best_test_test/acc': 67.21, 'best_test_test/acc_unbiased': 60.506, 'best_test_test/diff': 12.472, 'best_test_test/acc_skew': 66.741, 'best_test_test/acc_align': 54.27}
[2 / 20] Learning rate: 0.001 weight: 0.01
[2 / 20] Loss: 4.595252726864431 CE Loss: 0.4953505766610446 Con Loss: 4.590299233565479
[2 / 20] tensor([[0.985, 0.972],
        [0.355, 0.139]]) {'epoch': 2, 'valid/acc': 66.358, 'valid/acc_unbiased': 61.369, 'valid/diff': 7.056, 'valid/acc_skew': 63.269, 'valid/acc_align': 59.469, 'test/acc': 68.18, 'test/acc_unbiased': 61.279, 'test/diff': 11.459, 'test/acc_skew': 66.342, 'test/acc_align': 56.216}
[2 / 20] best valid accuracy: 61.369 at epoch 2 
 best_stats: {'best_valid_epoch': 2, 'best_valid_valid/acc': 66.358, 'best_valid_valid/acc_unbiased': 61.369, 'best_valid_valid/diff': 7.056, 'best_valid_valid/acc_skew': 63.269, 'best_valid_valid/acc_align': 59.469, 'best_valid_test/acc': 68.18, 'best_valid_test/acc_unbiased': 61.279, 'best_valid_test/diff': 11.459, 'best_valid_test/acc_skew': 66.342, 'best_valid_test/acc_align': 56.216}
[2 / 20] best test accuracy: 61.279 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 66.358, 'best_test_valid/acc_unbiased': 61.369, 'best_test_valid/diff': 7.056, 'best_test_valid/acc_skew': 63.269, 'best_test_valid/acc_align': 59.469, 'best_test_test/acc': 68.18, 'best_test_test/acc_unbiased': 61.279, 'best_test_test/diff': 11.459, 'best_test_test/acc_skew': 66.342, 'best_test_test/acc_align': 56.216}
[3 / 20] Learning rate: 0.001 weight: 0.01
[3 / 20] Loss: 4.501754152332964 CE Loss: 0.48322892675503326 Con Loss: 4.496921851187777
[3 / 20] tensor([[0.963, 0.926],
        [0.497, 0.303]]) {'epoch': 3, 'valid/acc': 72.575, 'valid/acc_unbiased': 67.609, 'valid/diff': 9.194, 'valid/acc_skew': 70.585, 'valid/acc_align': 64.633, 'test/acc': 73.424, 'test/acc_unbiased': 67.238, 'test/diff': 11.56, 'test/acc_skew': 71.163, 'test/acc_align': 63.314}
[3 / 20] best valid accuracy: 67.609 at epoch 3 
 best_stats: {'best_valid_epoch': 3, 'best_valid_valid/acc': 72.575, 'best_valid_valid/acc_unbiased': 67.609, 'best_valid_valid/diff': 9.194, 'best_valid_valid/acc_skew': 70.585, 'best_valid_valid/acc_align': 64.633, 'best_valid_test/acc': 73.424, 'best_valid_test/acc_unbiased': 67.238, 'best_valid_test/diff': 11.56, 'best_valid_test/acc_skew': 71.163, 'best_valid_test/acc_align': 63.314}
[3 / 20] best test accuracy: 67.238 at epoch 3 
 best_stats: {'best_test_epoch': 3, 'best_test_valid/acc': 72.575, 'best_test_valid/acc_unbiased': 67.609, 'best_test_valid/diff': 9.194, 'best_test_valid/acc_skew': 70.585, 'best_test_valid/acc_align': 64.633, 'best_test_test/acc': 73.424, 'best_test_test/acc_unbiased': 67.238, 'best_test_test/diff': 11.56, 'best_test_test/acc_skew': 71.163, 'best_test_test/acc_align': 63.314}
[4 / 20] Learning rate: 0.001 weight: 0.01
[4 / 20] Loss: 4.493016775160504 CE Loss: 0.4582381493721237 Con Loss: 4.48843439095746
[4 / 20] tensor([[0.991, 0.977],
        [0.434, 0.176]]) {'epoch': 4, 'valid/acc': 70.106, 'valid/acc_unbiased': 64.714, 'valid/diff': 9.273, 'valid/acc_skew': 67.687, 'valid/acc_align': 61.74, 'test/acc': 71.75, 'test/acc_unbiased': 64.432, 'test/diff': 13.561, 'test/acc_skew': 70.548, 'test/acc_align': 58.317}
[4 / 20] best valid accuracy: 67.609 at epoch 3 
 best_stats: {'best_valid_epoch': 3, 'best_valid_valid/acc': 72.575, 'best_valid_valid/acc_unbiased': 67.609, 'best_valid_valid/diff': 9.194, 'best_valid_valid/acc_skew': 70.585, 'best_valid_valid/acc_align': 64.633, 'best_valid_test/acc': 73.424, 'best_valid_test/acc_unbiased': 67.238, 'best_valid_test/diff': 11.56, 'best_valid_test/acc_skew': 71.163, 'best_valid_test/acc_align': 63.314}
[4 / 20] best test accuracy: 67.238 at epoch 3 
 best_stats: {'best_test_epoch': 3, 'best_test_valid/acc': 72.575, 'best_test_valid/acc_unbiased': 67.609, 'best_test_valid/diff': 9.194, 'best_test_valid/acc_skew': 70.585, 'best_test_valid/acc_align': 64.633, 'best_test_test/acc': 73.424, 'best_test_test/acc_unbiased': 67.238, 'best_test_test/diff': 11.56, 'best_test_test/acc_skew': 71.163, 'best_test_test/acc_align': 63.314}
[5 / 20] Learning rate: 0.001 weight: 0.01
[5 / 20] Loss: 4.501223855141797 CE Loss: 0.45929058525991634 Con Loss: 4.496630975701129
[5 / 20] tensor([[0.993, 0.955],
        [0.338, 0.267]]) {'epoch': 5, 'valid/acc': 66.623, 'valid/acc_unbiased': 62.431, 'valid/diff': 4.283, 'valid/acc_skew': 61.786, 'valid/acc_align': 63.075, 'test/acc': 68.709, 'test/acc_unbiased': 63.814, 'test/diff': 5.507, 'test/acc_skew': 64.625, 'test/acc_align': 63.003}
[5 / 20] best valid accuracy: 67.609 at epoch 3 
 best_stats: {'best_valid_epoch': 3, 'best_valid_valid/acc': 72.575, 'best_valid_valid/acc_unbiased': 67.609, 'best_valid_valid/diff': 9.194, 'best_valid_valid/acc_skew': 70.585, 'best_valid_valid/acc_align': 64.633, 'best_valid_test/acc': 73.424, 'best_valid_test/acc_unbiased': 67.238, 'best_valid_test/diff': 11.56, 'best_valid_test/acc_skew': 71.163, 'best_valid_test/acc_align': 63.314}
[5 / 20] best test accuracy: 67.238 at epoch 3 
 best_stats: {'best_test_epoch': 3, 'best_test_valid/acc': 72.575, 'best_test_valid/acc_unbiased': 67.609, 'best_test_valid/diff': 9.194, 'best_test_valid/acc_skew': 70.585, 'best_test_valid/acc_align': 64.633, 'best_test_test/acc': 73.424, 'best_test_test/acc_unbiased': 67.238, 'best_test_test/diff': 11.56, 'best_test_test/acc_skew': 71.163, 'best_test_test/acc_align': 63.314}
[6 / 20] Learning rate: 0.001 weight: 0.01
[6 / 20] Loss: 4.440042606769364 CE Loss: 0.44423568452935414 Con Loss: 4.435600245949571
[6 / 20] tensor([[0.859, 0.557],
        [0.797, 0.739]]) {'epoch': 6, 'valid/acc': 78.263, 'valid/acc_unbiased': 69.999, 'valid/diff': 24.555, 'valid/acc_skew': 62.476, 'valid/acc_align': 77.522, 'test/acc': 80.3, 'test/acc_unbiased': 73.796, 'test/diff': 17.971, 'test/acc_skew': 67.691, 'test/acc_align': 79.901}
[6 / 20] best valid accuracy: 69.999 at epoch 6 
 best_stats: {'best_valid_epoch': 6, 'best_valid_valid/acc': 78.263, 'best_valid_valid/acc_unbiased': 69.999, 'best_valid_valid/diff': 24.555, 'best_valid_valid/acc_skew': 62.476, 'best_valid_valid/acc_align': 77.522, 'best_valid_test/acc': 80.3, 'best_valid_test/acc_unbiased': 73.796, 'best_valid_test/diff': 17.971, 'best_valid_test/acc_skew': 67.691, 'best_valid_test/acc_align': 79.901}
[6 / 20] best test accuracy: 73.796 at epoch 6 
 best_stats: {'best_test_epoch': 6, 'best_test_valid/acc': 78.263, 'best_test_valid/acc_unbiased': 69.999, 'best_test_valid/diff': 24.555, 'best_test_valid/acc_skew': 62.476, 'best_test_valid/acc_align': 77.522, 'best_test_test/acc': 80.3, 'best_test_test/acc_unbiased': 73.796, 'best_test_test/diff': 17.971, 'best_test_test/acc_skew': 67.691, 'best_test_test/acc_align': 79.901}
[7 / 20] Learning rate: 0.0001 weight: 0.01
[7 / 20] Loss: 4.445950202663397 CE Loss: 0.42678787834588083 Con Loss: 4.441682321933359
[7 / 20] tensor([[0.956, 0.750],
        [0.678, 0.612]]) {'epoch': 7, 'valid/acc': 80.511, 'valid/acc_unbiased': 75.001, 'valid/diff': 13.319, 'valid/acc_skew': 70.061, 'valid/acc_align': 79.94, 'test/acc': 80.873, 'test/acc_unbiased': 74.901, 'test/diff': 13.589, 'test/acc_skew': 71.41, 'test/acc_align': 78.391}
[7 / 20] best valid accuracy: 75.001 at epoch 7 
 best_stats: {'best_valid_epoch': 7, 'best_valid_valid/acc': 80.511, 'best_valid_valid/acc_unbiased': 75.001, 'best_valid_valid/diff': 13.319, 'best_valid_valid/acc_skew': 70.061, 'best_valid_valid/acc_align': 79.94, 'best_valid_test/acc': 80.873, 'best_valid_test/acc_unbiased': 74.901, 'best_valid_test/diff': 13.589, 'best_valid_test/acc_skew': 71.41, 'best_valid_test/acc_align': 78.391}
[7 / 20] best test accuracy: 74.901 at epoch 7 
 best_stats: {'best_test_epoch': 7, 'best_test_valid/acc': 80.511, 'best_test_valid/acc_unbiased': 75.001, 'best_test_valid/diff': 13.319, 'best_test_valid/acc_skew': 70.061, 'best_test_valid/acc_align': 79.94, 'best_test_test/acc': 80.873, 'best_test_test/acc_unbiased': 74.901, 'best_test_test/diff': 13.589, 'best_test_test/acc_skew': 71.41, 'best_test_test/acc_align': 78.391}
[8 / 20] Learning rate: 0.0001 weight: 0.01
[8 / 20] Loss: 4.369803822830526 CE Loss: 0.4062346840275222 Con Loss: 4.3657414587371495
[8 / 20] tensor([[0.975, 0.761],
        [0.621, 0.576]]) {'epoch': 8, 'valid/acc': 78.042, 'valid/acc_unbiased': 73.053, 'valid/diff': 13.639, 'valid/acc_skew': 66.233, 'valid/acc_align': 79.873, 'test/acc': 79.374, 'test/acc_unbiased': 73.305, 'test/diff': 12.898, 'test/acc_skew': 69.095, 'test/acc_align': 77.515}
[8 / 20] best valid accuracy: 75.001 at epoch 7 
 best_stats: {'best_valid_epoch': 7, 'best_valid_valid/acc': 80.511, 'best_valid_valid/acc_unbiased': 75.001, 'best_valid_valid/diff': 13.319, 'best_valid_valid/acc_skew': 70.061, 'best_valid_valid/acc_align': 79.94, 'best_valid_test/acc': 80.873, 'best_valid_test/acc_unbiased': 74.901, 'best_valid_test/diff': 13.589, 'best_valid_test/acc_skew': 71.41, 'best_valid_test/acc_align': 78.391}
[8 / 20] best test accuracy: 74.901 at epoch 7 
 best_stats: {'best_test_epoch': 7, 'best_test_valid/acc': 80.511, 'best_test_valid/acc_unbiased': 75.001, 'best_test_valid/diff': 13.319, 'best_test_valid/acc_skew': 70.061, 'best_test_valid/acc_align': 79.94, 'best_test_test/acc': 80.873, 'best_test_test/acc_unbiased': 74.901, 'best_test_test/diff': 13.589, 'best_test_test/acc_skew': 71.41, 'best_test_test/acc_align': 78.391}
[9 / 20] Learning rate: 0.0001 weight: 0.01
[9 / 20] Loss: 4.342835881744865 CE Loss: 0.38705081563235133 Con Loss: 4.338965372216251
[9 / 20] tensor([[0.968, 0.608],
        [0.677, 0.733]]) {'epoch': 9, 'valid/acc': 79.63, 'valid/acc_unbiased': 73.985, 'valid/diff': 20.803, 'valid/acc_skew': 63.584, 'valid/acc_align': 84.386, 'test/acc': 81.181, 'test/acc_unbiased': 74.657, 'test/diff': 20.814, 'test/acc_skew': 64.25, 'test/acc_align': 85.064}
[9 / 20] best valid accuracy: 75.001 at epoch 7 
 best_stats: {'best_valid_epoch': 7, 'best_valid_valid/acc': 80.511, 'best_valid_valid/acc_unbiased': 75.001, 'best_valid_valid/diff': 13.319, 'best_valid_valid/acc_skew': 70.061, 'best_valid_valid/acc_align': 79.94, 'best_valid_test/acc': 80.873, 'best_valid_test/acc_unbiased': 74.901, 'best_valid_test/diff': 13.589, 'best_valid_test/acc_skew': 71.41, 'best_valid_test/acc_align': 78.391}
[9 / 20] best test accuracy: 74.901 at epoch 7 
 best_stats: {'best_test_epoch': 7, 'best_test_valid/acc': 80.511, 'best_test_valid/acc_unbiased': 75.001, 'best_test_valid/diff': 13.319, 'best_test_valid/acc_skew': 70.061, 'best_test_valid/acc_align': 79.94, 'best_test_test/acc': 80.873, 'best_test_test/acc_unbiased': 74.901, 'best_test_test/diff': 13.589, 'best_test_test/acc_skew': 71.41, 'best_test_test/acc_align': 78.391}
[10 / 20] Learning rate: 0.0001 weight: 0.01
[10 / 20] Loss: 4.290018698643406 CE Loss: 0.3794173675054738 Con Loss: 4.286224527334015
[10 / 20] tensor([[0.968, 0.602],
        [0.674, 0.739]]) {'epoch': 10, 'valid/acc': 80.026, 'valid/acc_unbiased': 74.154, 'valid/diff': 20.464, 'valid/acc_skew': 63.922, 'valid/acc_align': 84.386, 'test/acc': 81.049, 'test/acc_unbiased': 74.58, 'test/diff': 21.574, 'test/acc_skew': 63.793, 'test/acc_align': 85.367}
[10 / 20] best valid accuracy: 75.001 at epoch 7 
 best_stats: {'best_valid_epoch': 7, 'best_valid_valid/acc': 80.511, 'best_valid_valid/acc_unbiased': 75.001, 'best_valid_valid/diff': 13.319, 'best_valid_valid/acc_skew': 70.061, 'best_valid_valid/acc_align': 79.94, 'best_valid_test/acc': 80.873, 'best_valid_test/acc_unbiased': 74.901, 'best_valid_test/diff': 13.589, 'best_valid_test/acc_skew': 71.41, 'best_valid_test/acc_align': 78.391}
[10 / 20] best test accuracy: 74.901 at epoch 7 
 best_stats: {'best_test_epoch': 7, 'best_test_valid/acc': 80.511, 'best_test_valid/acc_unbiased': 75.001, 'best_test_valid/diff': 13.319, 'best_test_valid/acc_skew': 70.061, 'best_test_valid/acc_align': 79.94, 'best_test_test/acc': 80.873, 'best_test_test/acc_unbiased': 74.901, 'best_test_test/diff': 13.589, 'best_test_test/acc_skew': 71.41, 'best_test_test/acc_align': 78.391}
[11 / 20] Learning rate: 0.0001 weight: 0.01
[11 / 20] Loss: 4.227494297470327 CE Loss: 0.390132588355651 Con Loss: 4.223592954911975
[11 / 20] tensor([[0.962, 0.562],
        [0.709, 0.758]]) {'epoch': 11, 'valid/acc': 80.776, 'valid/acc_unbiased': 75.257, 'valid/diff': 23.131, 'valid/acc_skew': 63.691, 'valid/acc_align': 86.823, 'test/acc': 81.974, 'test/acc_unbiased': 74.793, 'test/diff': 22.402, 'test/acc_skew': 63.592, 'test/acc_align': 85.994}
[11 / 20] best valid accuracy: 75.257 at epoch 11 
 best_stats: {'best_valid_epoch': 11, 'best_valid_valid/acc': 80.776, 'best_valid_valid/acc_unbiased': 75.257, 'best_valid_valid/diff': 23.131, 'best_valid_valid/acc_skew': 63.691, 'best_valid_valid/acc_align': 86.823, 'best_valid_test/acc': 81.974, 'best_valid_test/acc_unbiased': 74.793, 'best_valid_test/diff': 22.402, 'best_valid_test/acc_skew': 63.592, 'best_valid_test/acc_align': 85.994}
[11 / 20] best test accuracy: 74.901 at epoch 7 
 best_stats: {'best_test_epoch': 7, 'best_test_valid/acc': 80.511, 'best_test_valid/acc_unbiased': 75.001, 'best_test_valid/diff': 13.319, 'best_test_valid/acc_skew': 70.061, 'best_test_valid/acc_align': 79.94, 'best_test_test/acc': 80.873, 'best_test_test/acc_unbiased': 74.901, 'best_test_test/diff': 13.589, 'best_test_test/acc_skew': 71.41, 'best_test_test/acc_align': 78.391}
[12 / 20] Learning rate: 0.0001 weight: 0.01
[12 / 20] Loss: 4.251858942431039 CE Loss: 0.37349643422976186 Con Loss: 4.248123979800562
[12 / 20] tensor([[0.961, 0.670],
        [0.707, 0.697]]) {'epoch': 12, 'valid/acc': 80.511, 'valid/acc_unbiased': 74.851, 'valid/diff': 16.916, 'valid/acc_skew': 66.393, 'valid/acc_align': 83.309, 'test/acc': 82.239, 'test/acc_unbiased': 75.895, 'test/diff': 15.048, 'test/acc_skew': 68.875, 'test/acc_align': 82.916}
[12 / 20] best valid accuracy: 75.257 at epoch 11 
 best_stats: {'best_valid_epoch': 11, 'best_valid_valid/acc': 80.776, 'best_valid_valid/acc_unbiased': 75.257, 'best_valid_valid/diff': 23.131, 'best_valid_valid/acc_skew': 63.691, 'best_valid_valid/acc_align': 86.823, 'best_valid_test/acc': 81.974, 'best_valid_test/acc_unbiased': 74.793, 'best_valid_test/diff': 22.402, 'best_valid_test/acc_skew': 63.592, 'best_valid_test/acc_align': 85.994}
[12 / 20] best test accuracy: 75.895 at epoch 12 
 best_stats: {'best_test_epoch': 12, 'best_test_valid/acc': 80.511, 'best_test_valid/acc_unbiased': 74.851, 'best_test_valid/diff': 16.916, 'best_test_valid/acc_skew': 66.393, 'best_test_valid/acc_align': 83.309, 'best_test_test/acc': 82.239, 'best_test_test/acc_unbiased': 75.895, 'best_test_test/diff': 15.048, 'best_test_test/acc_skew': 68.875, 'best_test_test/acc_align': 82.916}
[13 / 20] Learning rate: 0.0001 weight: 0.01
[13 / 20] Loss: 4.264704948505272 CE Loss: 0.36253382932242717 Con Loss: 4.261079601472078
[13 / 20] tensor([[0.965, 0.597],
        [0.696, 0.727]]) {'epoch': 13, 'valid/acc': 80.467, 'valid/acc_unbiased': 74.218, 'valid/diff': 23.899, 'valid/acc_skew': 62.268, 'valid/acc_align': 86.167, 'test/acc': 81.622, 'test/acc_unbiased': 74.612, 'test/diff': 20.015, 'test/acc_skew': 64.605, 'test/acc_align': 84.62}
[13 / 20] best valid accuracy: 75.257 at epoch 11 
 best_stats: {'best_valid_epoch': 11, 'best_valid_valid/acc': 80.776, 'best_valid_valid/acc_unbiased': 75.257, 'best_valid_valid/diff': 23.131, 'best_valid_valid/acc_skew': 63.691, 'best_valid_valid/acc_align': 86.823, 'best_valid_test/acc': 81.974, 'best_valid_test/acc_unbiased': 74.793, 'best_valid_test/diff': 22.402, 'best_valid_test/acc_skew': 63.592, 'best_valid_test/acc_align': 85.994}
[13 / 20] best test accuracy: 75.895 at epoch 12 
 best_stats: {'best_test_epoch': 12, 'best_test_valid/acc': 80.511, 'best_test_valid/acc_unbiased': 74.851, 'best_test_valid/diff': 16.916, 'best_test_valid/acc_skew': 66.393, 'best_test_valid/acc_align': 83.309, 'best_test_test/acc': 82.239, 'best_test_test/acc_unbiased': 75.895, 'best_test_test/diff': 15.048, 'best_test_test/acc_skew': 68.875, 'best_test_test/acc_align': 82.916}
[14 / 20] Learning rate: 1e-05 weight: 0.01
[14 / 20] Loss: 4.21401298416549 CE Loss: 0.36458768736597574 Con Loss: 4.21036710778411
[14 / 20] tensor([[0.972, 0.602],
        [0.678, 0.697]]) {'epoch': 14, 'valid/acc': 80.203, 'valid/acc_unbiased': 74.317, 'valid/diff': 23.593, 'valid/acc_skew': 62.521, 'valid/acc_align': 86.114, 'test/acc': 81.093, 'test/acc_unbiased': 73.729, 'test/diff': 19.411, 'test/acc_skew': 64.024, 'test/acc_align': 83.435}
[14 / 20] best valid accuracy: 75.257 at epoch 11 
 best_stats: {'best_valid_epoch': 11, 'best_valid_valid/acc': 80.776, 'best_valid_valid/acc_unbiased': 75.257, 'best_valid_valid/diff': 23.131, 'best_valid_valid/acc_skew': 63.691, 'best_valid_valid/acc_align': 86.823, 'best_valid_test/acc': 81.974, 'best_valid_test/acc_unbiased': 74.793, 'best_valid_test/diff': 22.402, 'best_valid_test/acc_skew': 63.592, 'best_valid_test/acc_align': 85.994}
[14 / 20] best test accuracy: 75.895 at epoch 12 
 best_stats: {'best_test_epoch': 12, 'best_test_valid/acc': 80.511, 'best_test_valid/acc_unbiased': 74.851, 'best_test_valid/diff': 16.916, 'best_test_valid/acc_skew': 66.393, 'best_test_valid/acc_align': 83.309, 'best_test_test/acc': 82.239, 'best_test_test/acc_unbiased': 75.895, 'best_test_test/diff': 15.048, 'best_test_test/acc_skew': 68.875, 'best_test_test/acc_align': 82.916}
[15 / 20] Learning rate: 1e-05 weight: 0.01
[15 / 20] Loss: 4.165958369014773 CE Loss: 0.3540475055469372 Con Loss: 4.162417888462834
[15 / 20] tensor([[0.968, 0.562],
        [0.700, 0.739]]) {'epoch': 15, 'valid/acc': 80.556, 'valid/acc_unbiased': 74.454, 'valid/diff': 26.698, 'valid/acc_skew': 61.105, 'valid/acc_align': 87.803, 'test/acc': 81.754, 'test/acc_unbiased': 74.249, 'test/diff': 22.237, 'test/acc_skew': 63.131, 'test/acc_align': 85.367}
[15 / 20] best valid accuracy: 75.257 at epoch 11 
 best_stats: {'best_valid_epoch': 11, 'best_valid_valid/acc': 80.776, 'best_valid_valid/acc_unbiased': 75.257, 'best_valid_valid/diff': 23.131, 'best_valid_valid/acc_skew': 63.691, 'best_valid_valid/acc_align': 86.823, 'best_valid_test/acc': 81.974, 'best_valid_test/acc_unbiased': 74.793, 'best_valid_test/diff': 22.402, 'best_valid_test/acc_skew': 63.592, 'best_valid_test/acc_align': 85.994}
[15 / 20] best test accuracy: 75.895 at epoch 12 
 best_stats: {'best_test_epoch': 12, 'best_test_valid/acc': 80.511, 'best_test_valid/acc_unbiased': 74.851, 'best_test_valid/diff': 16.916, 'best_test_valid/acc_skew': 66.393, 'best_test_valid/acc_align': 83.309, 'best_test_test/acc': 82.239, 'best_test_test/acc_unbiased': 75.895, 'best_test_test/diff': 15.048, 'best_test_test/acc_skew': 68.875, 'best_test_test/acc_align': 82.916}
[16 / 20] Learning rate: 1e-05 weight: 0.01
[16 / 20] Loss: 4.122588290654064 CE Loss: 0.35779401849647086 Con Loss: 4.119010350446226
[16 / 20] tensor([[0.962, 0.580],
        [0.713, 0.715]]) {'epoch': 16, 'valid/acc': 80.732, 'valid/acc_unbiased': 74.292, 'valid/diff': 25.935, 'valid/acc_skew': 61.324, 'valid/acc_align': 87.259, 'test/acc': 81.93, 'test/acc_unbiased': 74.245, 'test/diff': 19.255, 'test/acc_skew': 64.617, 'test/acc_align': 83.873}
[16 / 20] best valid accuracy: 75.257 at epoch 11 
 best_stats: {'best_valid_epoch': 11, 'best_valid_valid/acc': 80.776, 'best_valid_valid/acc_unbiased': 75.257, 'best_valid_valid/diff': 23.131, 'best_valid_valid/acc_skew': 63.691, 'best_valid_valid/acc_align': 86.823, 'best_valid_test/acc': 81.974, 'best_valid_test/acc_unbiased': 74.793, 'best_valid_test/diff': 22.402, 'best_valid_test/acc_skew': 63.592, 'best_valid_test/acc_align': 85.994}
[16 / 20] best test accuracy: 75.895 at epoch 12 
 best_stats: {'best_test_epoch': 12, 'best_test_valid/acc': 80.511, 'best_test_valid/acc_unbiased': 74.851, 'best_test_valid/diff': 16.916, 'best_test_valid/acc_skew': 66.393, 'best_test_valid/acc_align': 83.309, 'best_test_test/acc': 82.239, 'best_test_test/acc_unbiased': 75.895, 'best_test_test/diff': 15.048, 'best_test_test/acc_skew': 68.875, 'best_test_test/acc_align': 82.916}
[17 / 20] Learning rate: 1e-05 weight: 0.01
[17 / 20] Loss: 4.142315809488386 CE Loss: 0.34964732223796025 Con Loss: 4.138819319618993
[17 / 20] tensor([[0.963, 0.523],
        [0.716, 0.764]]) {'epoch': 17, 'valid/acc': 80.732, 'valid/acc_unbiased': 73.965, 'valid/diff': 30.054, 'valid/acc_skew': 58.938, 'valid/acc_align': 88.992, 'test/acc': 82.019, 'test/acc_unbiased': 74.147, 'test/diff': 24.394, 'test/acc_skew': 61.95, 'test/acc_align': 86.344}
[17 / 20] best valid accuracy: 75.257 at epoch 11 
 best_stats: {'best_valid_epoch': 11, 'best_valid_valid/acc': 80.776, 'best_valid_valid/acc_unbiased': 75.257, 'best_valid_valid/diff': 23.131, 'best_valid_valid/acc_skew': 63.691, 'best_valid_valid/acc_align': 86.823, 'best_valid_test/acc': 81.974, 'best_valid_test/acc_unbiased': 74.793, 'best_valid_test/diff': 22.402, 'best_valid_test/acc_skew': 63.592, 'best_valid_test/acc_align': 85.994}
[17 / 20] best test accuracy: 75.895 at epoch 12 
 best_stats: {'best_test_epoch': 12, 'best_test_valid/acc': 80.511, 'best_test_valid/acc_unbiased': 74.851, 'best_test_valid/diff': 16.916, 'best_test_valid/acc_skew': 66.393, 'best_test_valid/acc_align': 83.309, 'best_test_test/acc': 82.239, 'best_test_test/acc_unbiased': 75.895, 'best_test_test/diff': 15.048, 'best_test_test/acc_skew': 68.875, 'best_test_test/acc_align': 82.916}
[18 / 20] Learning rate: 1e-05 weight: 0.01
[18 / 20] Loss: 4.149380700680166 CE Loss: 0.35229527453767456 Con Loss: 4.145857745991446
[18 / 20] tensor([[0.970, 0.557],
        [0.700, 0.764]]) {'epoch': 18, 'valid/acc': 80.423, 'valid/acc_unbiased': 74.142, 'valid/diff': 28.206, 'valid/acc_skew': 60.038, 'valid/acc_align': 88.245, 'test/acc': 81.974, 'test/acc_unbiased': 74.76, 'test/diff': 23.827, 'test/acc_skew': 62.847, 'test/acc_align': 86.674}
[18 / 20] best valid accuracy: 75.257 at epoch 11 
 best_stats: {'best_valid_epoch': 11, 'best_valid_valid/acc': 80.776, 'best_valid_valid/acc_unbiased': 75.257, 'best_valid_valid/diff': 23.131, 'best_valid_valid/acc_skew': 63.691, 'best_valid_valid/acc_align': 86.823, 'best_valid_test/acc': 81.974, 'best_valid_test/acc_unbiased': 74.793, 'best_valid_test/diff': 22.402, 'best_valid_test/acc_skew': 63.592, 'best_valid_test/acc_align': 85.994}
[18 / 20] best test accuracy: 75.895 at epoch 12 
 best_stats: {'best_test_epoch': 12, 'best_test_valid/acc': 80.511, 'best_test_valid/acc_unbiased': 74.851, 'best_test_valid/diff': 16.916, 'best_test_valid/acc_skew': 66.393, 'best_test_valid/acc_align': 83.309, 'best_test_test/acc': 82.239, 'best_test_test/acc_unbiased': 75.895, 'best_test_test/diff': 15.048, 'best_test_test/acc_skew': 68.875, 'best_test_test/acc_align': 82.916}
[19 / 20] Learning rate: 1e-05 weight: 0.01
[19 / 20] Loss: 4.177404858386726 CE Loss: 0.355794551956301 Con Loss: 4.1738469328428645
[19 / 20] tensor([[0.966, 0.545],
        [0.714, 0.758]]) {'epoch': 19, 'valid/acc': 80.864, 'valid/acc_unbiased': 74.063, 'valid/diff': 28.868, 'valid/acc_skew': 59.63, 'valid/acc_align': 88.497, 'test/acc': 82.195, 'test/acc_unbiased': 74.576, 'test/diff': 23.212, 'test/acc_skew': 62.971, 'test/acc_align': 86.182}
[19 / 20] best valid accuracy: 75.257 at epoch 11 
 best_stats: {'best_valid_epoch': 11, 'best_valid_valid/acc': 80.776, 'best_valid_valid/acc_unbiased': 75.257, 'best_valid_valid/diff': 23.131, 'best_valid_valid/acc_skew': 63.691, 'best_valid_valid/acc_align': 86.823, 'best_valid_test/acc': 81.974, 'best_valid_test/acc_unbiased': 74.793, 'best_valid_test/diff': 22.402, 'best_valid_test/acc_skew': 63.592, 'best_valid_test/acc_align': 85.994}
[19 / 20] best test accuracy: 75.895 at epoch 12 
 best_stats: {'best_test_epoch': 12, 'best_test_valid/acc': 80.511, 'best_test_valid/acc_unbiased': 74.851, 'best_test_valid/diff': 16.916, 'best_test_valid/acc_skew': 66.393, 'best_test_valid/acc_align': 83.309, 'best_test_test/acc': 82.239, 'best_test_test/acc_unbiased': 75.895, 'best_test_test/diff': 15.048, 'best_test_test/acc_skew': 68.875, 'best_test_test/acc_align': 82.916}
[20 / 20] Learning rate: 1e-05 weight: 0.01
[20 / 20] Loss: 4.166565841344893 CE Loss: 0.3480121766481003 Con Loss: 4.163085724521067
[20 / 20] tensor([[0.966, 0.494],
        [0.709, 0.800]]) {'epoch': 20, 'valid/acc': 80.864, 'valid/acc_unbiased': 74.05, 'valid/diff': 30.379, 'valid/acc_skew': 58.86, 'valid/acc_align': 89.24, 'test/acc': 81.93, 'test/acc_unbiased': 74.243, 'test/diff': 28.12, 'test/acc_skew': 60.183, 'test/acc_align': 88.303}
[20 / 20] best valid accuracy: 75.257 at epoch 11 
 best_stats: {'best_valid_epoch': 11, 'best_valid_valid/acc': 80.776, 'best_valid_valid/acc_unbiased': 75.257, 'best_valid_valid/diff': 23.131, 'best_valid_valid/acc_skew': 63.691, 'best_valid_valid/acc_align': 86.823, 'best_valid_test/acc': 81.974, 'best_valid_test/acc_unbiased': 74.793, 'best_valid_test/diff': 22.402, 'best_valid_test/acc_skew': 63.592, 'best_valid_test/acc_align': 85.994}
[20 / 20] best test accuracy: 75.895 at epoch 12 
 best_stats: {'best_test_epoch': 12, 'best_test_valid/acc': 80.511, 'best_test_valid/acc_unbiased': 74.851, 'best_test_valid/diff': 16.916, 'best_test_valid/acc_skew': 66.393, 'best_test_valid/acc_align': 83.309, 'best_test_test/acc': 82.239, 'best_test_test/acc_unbiased': 75.895, 'best_test_test/diff': 15.048, 'best_test_test/acc_skew': 68.875, 'best_test_test/acc_align': 82.916}
Total training time: 0:15:42
