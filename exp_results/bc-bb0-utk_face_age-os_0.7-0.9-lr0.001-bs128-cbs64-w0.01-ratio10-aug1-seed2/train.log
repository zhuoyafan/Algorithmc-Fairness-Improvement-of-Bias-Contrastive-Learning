Log level set to: INFO
Set seed: 2
=======> Using Fixed Random Seed: 2 <========
save_path: exp_results/bc-bb0-utk_face_age-os_0.7-0.9-lr0.001-bs128-cbs64-w0.01-ratio10-aug1-seed2
get_utk_face - split: train, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_age-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
Binary Target 1
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Normal Label Distribution: 
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [5765, 5765]
Target 1: [5765, 5765]
Binary Target 1
---------------------------
Target 0: [5765, 5765]
Target 1: [5765, 5765]
===================================
Normal Label Distribution: 
Target 0: [5765, 5765]
Target 1: [5765, 5765]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 23060, target_attr: gender, bias_attr: age bias_rate: 0.9
['[train] target_0-bias_0: 5765', '[train] target_0-bias_1: 5765', '[train] target_1-bias_0: 5765', '[train] target_1-bias_1: 5765']
confusion_matrix - 
 original: tensor([[5765., 5765.],
        [5765., 5765.]]), 
 normalized: tensor([[0.500, 0.500],
        [0.500, 0.500]]), 
 b|y: tensor([[0.500, 0.500],
        [0.500, 0.500]])
get_utk_face - split: train, aug: 1, given_y: True, ratio: 10
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_age-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
Binary Target 1
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Normal Label Distribution: 
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [5765, 5765]
Target 1: [5765, 5765]
Binary Target 1
---------------------------
Target 0: [5765, 5765]
Target 1: [5765, 5765]
===================================
Normal Label Distribution: 
Target 0: [5765, 5765]
Target 1: [5765, 5765]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 23060, target_attr: gender, bias_attr: age bias_rate: 0.9
['[train] target_0-bias_0: 5765', '[train] target_0-bias_1: 5765', '[train] target_1-bias_0: 5765', '[train] target_1-bias_1: 5765']
get_utk_face - split: valid, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_age-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [1030, 195]
Target 1: [841, 202]
Binary Target 1
---------------------------
Target 0: [1030, 195]
Target 1: [841, 202]
===================================
Normal Label Distribution: 
Target 0: [1030, 195]
Target 1: [841, 202]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 2268, target_attr: gender, bias_attr: age bias_rate: 0.9
['[valid] target_0-bias_0: 1030', '[valid] target_0-bias_1: 195', '[valid] target_1-bias_0: 841', '[valid] target_1-bias_1: 202']
get_utk_face - split: test, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_age-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [1061, 176]
Target 1: [867, 165]
Binary Target 1
---------------------------
Target 0: [1061, 176]
Target 1: [867, 165]
===================================
Normal Label Distribution: 
Target 0: [1061, 176]
Target 1: [867, 165]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 2269, target_attr: gender, bias_attr: age bias_rate: 0.9
['[test] target_0-bias_0: 1061', '[test] target_0-bias_1: 176', '[test] target_1-bias_0: 867', '[test] target_1-bias_1: 165']
decay_epochs: [6, 13]
[1 / 20] Learning rate: 0.001 weight: 0.01
[1 / 20] Loss: 4.867258978510358 CE Loss: 0.5944536601163363 Con Loss: 4.861314436423706
[1 / 20] tensor([[0.955, 0.676],
        [0.373, 0.558]]) {'epoch': 1, 'valid/acc': 67.46, 'valid/acc_unbiased': 63.11, 'valid/diff': 22.099, 'valid/acc_skew': 66.155, 'valid/acc_align': 60.066, 'test/acc': 68.18, 'test/acc_unbiased': 64.026, 'test/diff': 23.183, 'test/acc_skew': 66.365, 'test/acc_align': 61.686}
[1 / 20] best valid accuracy: 63.110 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 67.46, 'best_valid_valid/acc_unbiased': 63.11, 'best_valid_valid/diff': 22.099, 'best_valid_valid/acc_skew': 66.155, 'best_valid_valid/acc_align': 60.066, 'best_valid_test/acc': 68.18, 'best_valid_test/acc_unbiased': 64.026, 'best_valid_test/diff': 23.183, 'best_valid_test/acc_skew': 66.365, 'best_valid_test/acc_align': 61.686}
[1 / 20] best test accuracy: 64.026 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 67.46, 'best_test_valid/acc_unbiased': 63.11, 'best_test_valid/diff': 22.099, 'best_test_valid/acc_skew': 66.155, 'best_test_valid/acc_align': 60.066, 'best_test_test/acc': 68.18, 'best_test_test/acc_unbiased': 64.026, 'best_test_test/diff': 23.183, 'best_test_test/acc_skew': 66.365, 'best_test_test/acc_align': 61.686}
[2 / 20] Learning rate: 0.001 weight: 0.01
[2 / 20] Loss: 4.783529842737336 CE Loss: 0.48495844636703717 Con Loss: 4.778680257061101
[2 / 20] tensor([[0.775, 0.523],
        [0.869, 0.806]]) {'epoch': 2, 'valid/acc': 78.042, 'valid/acc_unbiased': 71.515, 'valid/diff': 21.347, 'valid/acc_skew': 82.188, 'valid/acc_align': 60.842, 'test/acc': 79.33, 'test/acc_unbiased': 74.301, 'test/diff': 15.723, 'test/acc_skew': 82.163, 'test/acc_align': 66.439}
[2 / 20] best valid accuracy: 71.515 at epoch 2 
 best_stats: {'best_valid_epoch': 2, 'best_valid_valid/acc': 78.042, 'best_valid_valid/acc_unbiased': 71.515, 'best_valid_valid/diff': 21.347, 'best_valid_valid/acc_skew': 82.188, 'best_valid_valid/acc_align': 60.842, 'best_valid_test/acc': 79.33, 'best_valid_test/acc_unbiased': 74.301, 'best_valid_test/diff': 15.723, 'best_valid_test/acc_skew': 82.163, 'best_valid_test/acc_align': 66.439}
[2 / 20] best test accuracy: 74.301 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 78.042, 'best_test_valid/acc_unbiased': 71.515, 'best_test_valid/diff': 21.347, 'best_test_valid/acc_skew': 82.188, 'best_test_valid/acc_align': 60.842, 'best_test_test/acc': 79.33, 'best_test_test/acc_unbiased': 74.301, 'best_test_test/diff': 15.723, 'best_test_test/acc_skew': 82.163, 'best_test_test/acc_align': 66.439}
[3 / 20] Learning rate: 0.001 weight: 0.01
[3 / 20] Loss: 4.742817383937389 CE Loss: 0.4254402656505548 Con Loss: 4.738563000132287
[3 / 20] tensor([[0.940, 0.835],
        [0.672, 0.424]]) {'epoch': 3, 'valid/acc': 79.233, 'valid/acc_unbiased': 74.09, 'valid/diff': 12.593, 'valid/acc_skew': 80.387, 'valid/acc_align': 67.794, 'test/acc': 79.198, 'test/acc_unbiased': 71.79, 'test/diff': 17.632, 'test/acc_skew': 80.606, 'test/acc_align': 62.973}
[3 / 20] best valid accuracy: 74.090 at epoch 3 
 best_stats: {'best_valid_epoch': 3, 'best_valid_valid/acc': 79.233, 'best_valid_valid/acc_unbiased': 74.09, 'best_valid_valid/diff': 12.593, 'best_valid_valid/acc_skew': 80.387, 'best_valid_valid/acc_align': 67.794, 'best_valid_test/acc': 79.198, 'best_valid_test/acc_unbiased': 71.79, 'best_valid_test/diff': 17.632, 'best_valid_test/acc_skew': 80.606, 'best_valid_test/acc_align': 62.973}
[3 / 20] best test accuracy: 74.301 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 78.042, 'best_test_valid/acc_unbiased': 71.515, 'best_test_valid/diff': 21.347, 'best_test_valid/acc_skew': 82.188, 'best_test_valid/acc_align': 60.842, 'best_test_test/acc': 79.33, 'best_test_test/acc_unbiased': 74.301, 'best_test_test/diff': 15.723, 'best_test_test/acc_skew': 82.163, 'best_test_test/acc_align': 66.439}
[4 / 20] Learning rate: 0.001 weight: 0.01
[4 / 20] Loss: 4.707876992287681 CE Loss: 0.3994413823018566 Con Loss: 4.7038825927562335
[4 / 20] tensor([[0.795, 0.483],
        [0.884, 0.848]]) {'epoch': 4, 'valid/acc': 81.041, 'valid/acc_unbiased': 73.995, 'valid/diff': 22.452, 'valid/acc_skew': 85.221, 'valid/acc_align': 62.768, 'test/acc': 80.873, 'test/acc_unbiased': 75.261, 'test/diff': 17.377, 'test/acc_skew': 83.949, 'test/acc_align': 66.572}
[4 / 20] best valid accuracy: 74.090 at epoch 3 
 best_stats: {'best_valid_epoch': 3, 'best_valid_valid/acc': 79.233, 'best_valid_valid/acc_unbiased': 74.09, 'best_valid_valid/diff': 12.593, 'best_valid_valid/acc_skew': 80.387, 'best_valid_valid/acc_align': 67.794, 'best_valid_test/acc': 79.198, 'best_valid_test/acc_unbiased': 71.79, 'best_valid_test/diff': 17.632, 'best_valid_test/acc_skew': 80.606, 'best_valid_test/acc_align': 62.973}
[4 / 20] best test accuracy: 75.261 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 81.041, 'best_test_valid/acc_unbiased': 73.995, 'best_test_valid/diff': 22.452, 'best_test_valid/acc_skew': 85.221, 'best_test_valid/acc_align': 62.768, 'best_test_test/acc': 80.873, 'best_test_test/acc_unbiased': 75.261, 'best_test_test/diff': 17.377, 'best_test_test/acc_skew': 83.949, 'best_test_test/acc_align': 66.572}
[5 / 20] Learning rate: 0.001 weight: 0.01
[5 / 20] Loss: 4.686172858963608 CE Loss: 0.3790850177239255 Con Loss: 4.682382002232495
[5 / 20] tensor([[0.893, 0.608],
        [0.833, 0.788]]) {'epoch': 5, 'valid/acc': 82.672, 'valid/acc_unbiased': 75.858, 'valid/diff': 20.29, 'valid/acc_skew': 86.003, 'valid/acc_align': 65.713, 'test/acc': 84.002, 'test/acc_unbiased': 78.029, 'test/diff': 16.474, 'test/acc_skew': 86.266, 'test/acc_align': 69.792}
[5 / 20] best valid accuracy: 75.858 at epoch 5 
 best_stats: {'best_valid_epoch': 5, 'best_valid_valid/acc': 82.672, 'best_valid_valid/acc_unbiased': 75.858, 'best_valid_valid/diff': 20.29, 'best_valid_valid/acc_skew': 86.003, 'best_valid_valid/acc_align': 65.713, 'best_valid_test/acc': 84.002, 'best_valid_test/acc_unbiased': 78.029, 'best_valid_test/diff': 16.474, 'best_valid_test/acc_skew': 86.266, 'best_valid_test/acc_align': 69.792}
[5 / 20] best test accuracy: 78.029 at epoch 5 
 best_stats: {'best_test_epoch': 5, 'best_test_valid/acc': 82.672, 'best_test_valid/acc_unbiased': 75.858, 'best_test_valid/diff': 20.29, 'best_test_valid/acc_skew': 86.003, 'best_test_valid/acc_align': 65.713, 'best_test_test/acc': 84.002, 'best_test_test/acc_unbiased': 78.029, 'best_test_test/diff': 16.474, 'best_test_test/acc_skew': 86.266, 'best_test_test/acc_align': 69.792}
[6 / 20] Learning rate: 0.001 weight: 0.01
[6 / 20] Loss: 4.662145817600327 CE Loss: 0.3545345558152443 Con Loss: 4.658600469061528
[6 / 20] tensor([[0.940, 0.619],
        [0.738, 0.764]]) {'epoch': 6, 'valid/acc': 81.658, 'valid/acc_unbiased': 75.271, 'valid/diff': 23.249, 'valid/acc_skew': 83.776, 'valid/acc_align': 66.766, 'test/acc': 82.503, 'test/acc_unbiased': 76.52, 'test/diff': 17.291, 'test/acc_skew': 83.893, 'test/acc_align': 69.148}
[6 / 20] best valid accuracy: 75.858 at epoch 5 
 best_stats: {'best_valid_epoch': 5, 'best_valid_valid/acc': 82.672, 'best_valid_valid/acc_unbiased': 75.858, 'best_valid_valid/diff': 20.29, 'best_valid_valid/acc_skew': 86.003, 'best_valid_valid/acc_align': 65.713, 'best_valid_test/acc': 84.002, 'best_valid_test/acc_unbiased': 78.029, 'best_valid_test/diff': 16.474, 'best_valid_test/acc_skew': 86.266, 'best_valid_test/acc_align': 69.792}
[6 / 20] best test accuracy: 78.029 at epoch 5 
 best_stats: {'best_test_epoch': 5, 'best_test_valid/acc': 82.672, 'best_test_valid/acc_unbiased': 75.858, 'best_test_valid/diff': 20.29, 'best_test_valid/acc_skew': 86.003, 'best_test_valid/acc_align': 65.713, 'best_test_test/acc': 84.002, 'best_test_test/acc_unbiased': 78.029, 'best_test_test/diff': 16.474, 'best_test_test/acc_skew': 86.266, 'best_test_test/acc_align': 69.792}
[7 / 20] Learning rate: 0.0001 weight: 0.01
[7 / 20] Loss: 4.577627759256884 CE Loss: 0.301971708384164 Con Loss: 4.574608037457296
[7 / 20] tensor([[0.886, 0.455],
        [0.880, 0.897]]) {'epoch': 7, 'valid/acc': 83.466, 'valid/acc_unbiased': 75.617, 'valid/diff': 27.117, 'valid/acc_skew': 87.467, 'valid/acc_align': 63.767, 'test/acc': 85.104, 'test/acc_unbiased': 77.938, 'test/diff': 22.417, 'test/acc_skew': 88.3, 'test/acc_align': 67.576}
[7 / 20] best valid accuracy: 75.858 at epoch 5 
 best_stats: {'best_valid_epoch': 5, 'best_valid_valid/acc': 82.672, 'best_valid_valid/acc_unbiased': 75.858, 'best_valid_valid/diff': 20.29, 'best_valid_valid/acc_skew': 86.003, 'best_valid_valid/acc_align': 65.713, 'best_valid_test/acc': 84.002, 'best_valid_test/acc_unbiased': 78.029, 'best_valid_test/diff': 16.474, 'best_valid_test/acc_skew': 86.266, 'best_valid_test/acc_align': 69.792}
[7 / 20] best test accuracy: 78.029 at epoch 5 
 best_stats: {'best_test_epoch': 5, 'best_test_valid/acc': 82.672, 'best_test_valid/acc_unbiased': 75.858, 'best_test_valid/diff': 20.29, 'best_test_valid/acc_skew': 86.003, 'best_test_valid/acc_align': 65.713, 'best_test_test/acc': 84.002, 'best_test_test/acc_unbiased': 78.029, 'best_test_test/diff': 16.474, 'best_test_test/acc_skew': 86.266, 'best_test_test/acc_align': 69.792}
[8 / 20] Learning rate: 0.0001 weight: 0.01
[8 / 20] Loss: 4.532409314786674 CE Loss: 0.2749540911636865 Con Loss: 4.529659765529716
[8 / 20] tensor([[0.877, 0.398],
        [0.886, 0.915]]) {'epoch': 8, 'valid/acc': 83.51, 'valid/acc_unbiased': 75.575, 'valid/diff': 28.406, 'valid/acc_skew': 87.674, 'valid/acc_align': 63.476, 'test/acc': 84.619, 'test/acc_unbiased': 76.904, 'test/diff': 25.454, 'test/acc_skew': 88.164, 'test/acc_align': 65.644}
[8 / 20] best valid accuracy: 75.858 at epoch 5 
 best_stats: {'best_valid_epoch': 5, 'best_valid_valid/acc': 82.672, 'best_valid_valid/acc_unbiased': 75.858, 'best_valid_valid/diff': 20.29, 'best_valid_valid/acc_skew': 86.003, 'best_valid_valid/acc_align': 65.713, 'best_valid_test/acc': 84.002, 'best_valid_test/acc_unbiased': 78.029, 'best_valid_test/diff': 16.474, 'best_valid_test/acc_skew': 86.266, 'best_valid_test/acc_align': 69.792}
[8 / 20] best test accuracy: 78.029 at epoch 5 
 best_stats: {'best_test_epoch': 5, 'best_test_valid/acc': 82.672, 'best_test_valid/acc_unbiased': 75.858, 'best_test_valid/diff': 20.29, 'best_test_valid/acc_skew': 86.003, 'best_test_valid/acc_align': 65.713, 'best_test_test/acc': 84.002, 'best_test_test/acc_unbiased': 78.029, 'best_test_test/diff': 16.474, 'best_test_test/acc_skew': 86.266, 'best_test_test/acc_align': 69.792}
[9 / 20] Learning rate: 0.0001 weight: 0.01
[9 / 20] Loss: 4.521424051832346 CE Loss: 0.25546749018630255 Con Loss: 4.518869386294151
[9 / 20] tensor([[0.878, 0.352],
        [0.899, 0.933]]) {'epoch': 9, 'valid/acc': 83.51, 'valid/acc_unbiased': 74.916, 'valid/diff': 28.345, 'valid/acc_skew': 88.133, 'valid/acc_align': 61.698, 'test/acc': 84.927, 'test/acc_unbiased': 76.563, 'test/diff': 28.049, 'test/acc_skew': 88.846, 'test/acc_align': 64.28}
[9 / 20] best valid accuracy: 75.858 at epoch 5 
 best_stats: {'best_valid_epoch': 5, 'best_valid_valid/acc': 82.672, 'best_valid_valid/acc_unbiased': 75.858, 'best_valid_valid/diff': 20.29, 'best_valid_valid/acc_skew': 86.003, 'best_valid_valid/acc_align': 65.713, 'best_valid_test/acc': 84.002, 'best_valid_test/acc_unbiased': 78.029, 'best_valid_test/diff': 16.474, 'best_valid_test/acc_skew': 86.266, 'best_valid_test/acc_align': 69.792}
[9 / 20] best test accuracy: 78.029 at epoch 5 
 best_stats: {'best_test_epoch': 5, 'best_test_valid/acc': 82.672, 'best_test_valid/acc_unbiased': 75.858, 'best_test_valid/diff': 20.29, 'best_test_valid/acc_skew': 86.003, 'best_test_valid/acc_align': 65.713, 'best_test_test/acc': 84.002, 'best_test_test/acc_unbiased': 78.029, 'best_test_test/diff': 16.474, 'best_test_test/acc_skew': 86.266, 'best_test_test/acc_align': 69.792}
[10 / 20] Learning rate: 0.0001 weight: 0.01
[10 / 20] Loss: 4.498719996611967 CE Loss: 0.25260946912059346 Con Loss: 4.496193895563289
[10 / 20] tensor([[0.896, 0.386],
        [0.881, 0.915]]) {'epoch': 10, 'valid/acc': 84.127, 'valid/acc_unbiased': 75.657, 'valid/diff': 30.667, 'valid/acc_skew': 88.352, 'valid/acc_align': 62.963, 'test/acc': 85.236, 'test/acc_unbiased': 76.976, 'test/diff': 27.196, 'test/acc_skew': 88.876, 'test/acc_align': 65.076}
[10 / 20] best valid accuracy: 75.858 at epoch 5 
 best_stats: {'best_valid_epoch': 5, 'best_valid_valid/acc': 82.672, 'best_valid_valid/acc_unbiased': 75.858, 'best_valid_valid/diff': 20.29, 'best_valid_valid/acc_skew': 86.003, 'best_valid_valid/acc_align': 65.713, 'best_valid_test/acc': 84.002, 'best_valid_test/acc_unbiased': 78.029, 'best_valid_test/diff': 16.474, 'best_valid_test/acc_skew': 86.266, 'best_valid_test/acc_align': 69.792}
[10 / 20] best test accuracy: 78.029 at epoch 5 
 best_stats: {'best_test_epoch': 5, 'best_test_valid/acc': 82.672, 'best_test_valid/acc_unbiased': 75.858, 'best_test_valid/diff': 20.29, 'best_test_valid/acc_skew': 86.003, 'best_test_valid/acc_align': 65.713, 'best_test_test/acc': 84.002, 'best_test_test/acc_unbiased': 78.029, 'best_test_test/diff': 16.474, 'best_test_test/acc_skew': 86.266, 'best_test_test/acc_align': 69.792}
[11 / 20] Learning rate: 0.0001 weight: 0.01
[11 / 20] Loss: 4.485045113526317 CE Loss: 0.24142821425473493 Con Loss: 4.482630845141845
[11 / 20] tensor([[0.923, 0.415],
        [0.860, 0.915]]) {'epoch': 11, 'valid/acc': 84.612, 'valid/acc_unbiased': 76.602, 'valid/diff': 29.643, 'valid/acc_skew': 88.437, 'valid/acc_align': 64.766, 'test/acc': 85.897, 'test/acc_unbiased': 77.827, 'test/diff': 28.133, 'test/acc_skew': 89.158, 'test/acc_align': 66.496}
[11 / 20] best valid accuracy: 76.602 at epoch 11 
 best_stats: {'best_valid_epoch': 11, 'best_valid_valid/acc': 84.612, 'best_valid_valid/acc_unbiased': 76.602, 'best_valid_valid/diff': 29.643, 'best_valid_valid/acc_skew': 88.437, 'best_valid_valid/acc_align': 64.766, 'best_valid_test/acc': 85.897, 'best_valid_test/acc_unbiased': 77.827, 'best_valid_test/diff': 28.133, 'best_valid_test/acc_skew': 89.158, 'best_valid_test/acc_align': 66.496}
[11 / 20] best test accuracy: 78.029 at epoch 5 
 best_stats: {'best_test_epoch': 5, 'best_test_valid/acc': 82.672, 'best_test_valid/acc_unbiased': 75.858, 'best_test_valid/diff': 20.29, 'best_test_valid/acc_skew': 86.003, 'best_test_valid/acc_align': 65.713, 'best_test_test/acc': 84.002, 'best_test_test/acc_unbiased': 78.029, 'best_test_test/diff': 16.474, 'best_test_test/acc_skew': 86.266, 'best_test_test/acc_align': 69.792}
[12 / 20] Learning rate: 0.0001 weight: 0.01
[12 / 20] Loss: 4.473352161698618 CE Loss: 0.2280534376295773 Con Loss: 4.471071628312494
[12 / 20] tensor([[0.902, 0.392],
        [0.892, 0.921]]) {'epoch': 12, 'valid/acc': 84.259, 'valid/acc_unbiased': 75.457, 'valid/diff': 30.972, 'valid/acc_skew': 88.72, 'valid/acc_align': 62.193, 'test/acc': 85.985, 'test/acc_unbiased': 77.67, 'test/diff': 26.978, 'test/acc_skew': 89.678, 'test/acc_align': 65.663}
[12 / 20] best valid accuracy: 76.602 at epoch 11 
 best_stats: {'best_valid_epoch': 11, 'best_valid_valid/acc': 84.612, 'best_valid_valid/acc_unbiased': 76.602, 'best_valid_valid/diff': 29.643, 'best_valid_valid/acc_skew': 88.437, 'best_valid_valid/acc_align': 64.766, 'best_valid_test/acc': 85.897, 'best_valid_test/acc_unbiased': 77.827, 'best_valid_test/diff': 28.133, 'best_valid_test/acc_skew': 89.158, 'best_valid_test/acc_align': 66.496}
[12 / 20] best test accuracy: 78.029 at epoch 5 
 best_stats: {'best_test_epoch': 5, 'best_test_valid/acc': 82.672, 'best_test_valid/acc_unbiased': 75.858, 'best_test_valid/diff': 20.29, 'best_test_valid/acc_skew': 86.003, 'best_test_valid/acc_align': 65.713, 'best_test_test/acc': 84.002, 'best_test_test/acc_unbiased': 78.029, 'best_test_test/diff': 16.474, 'best_test_test/acc_skew': 86.266, 'best_test_test/acc_align': 69.792}
[13 / 20] Learning rate: 0.0001 weight: 0.01
[13 / 20] Loss: 4.458653288888394 CE Loss: 0.22429798660543 Con Loss: 4.4564103009074225
[13 / 20] tensor([[0.893, 0.347],
        [0.895, 0.933]]) {'epoch': 13, 'valid/acc': 83.951, 'valid/acc_unbiased': 75.061, 'valid/diff': 33.258, 'valid/acc_skew': 88.477, 'valid/acc_align': 61.645, 'test/acc': 85.412, 'test/acc_unbiased': 76.688, 'test/diff': 29.213, 'test/acc_skew': 89.38, 'test/acc_align': 63.996}
[13 / 20] best valid accuracy: 76.602 at epoch 11 
 best_stats: {'best_valid_epoch': 11, 'best_valid_valid/acc': 84.612, 'best_valid_valid/acc_unbiased': 76.602, 'best_valid_valid/diff': 29.643, 'best_valid_valid/acc_skew': 88.437, 'best_valid_valid/acc_align': 64.766, 'best_valid_test/acc': 85.897, 'best_valid_test/acc_unbiased': 77.827, 'best_valid_test/diff': 28.133, 'best_valid_test/acc_skew': 89.158, 'best_valid_test/acc_align': 66.496}
[13 / 20] best test accuracy: 78.029 at epoch 5 
 best_stats: {'best_test_epoch': 5, 'best_test_valid/acc': 82.672, 'best_test_valid/acc_unbiased': 75.858, 'best_test_valid/diff': 20.29, 'best_test_valid/acc_skew': 86.003, 'best_test_valid/acc_align': 65.713, 'best_test_test/acc': 84.002, 'best_test_test/acc_unbiased': 78.029, 'best_test_test/diff': 16.474, 'best_test_test/acc_skew': 86.266, 'best_test_test/acc_align': 69.792}
[14 / 20] Learning rate: 1e-05 weight: 0.01
[14 / 20] Loss: 4.459210202762177 CE Loss: 0.21673336565649623 Con Loss: 4.45704285860682
[14 / 20] tensor([[0.911, 0.392],
        [0.874, 0.921]]) {'epoch': 14, 'valid/acc': 84.568, 'valid/acc_unbiased': 76.053, 'valid/diff': 31.623, 'valid/acc_skew': 88.631, 'valid/acc_align': 63.476, 'test/acc': 85.765, 'test/acc_unbiased': 77.474, 'test/diff': 28.315, 'test/acc_skew': 89.284, 'test/acc_align': 65.663}
[14 / 20] best valid accuracy: 76.602 at epoch 11 
 best_stats: {'best_valid_epoch': 11, 'best_valid_valid/acc': 84.612, 'best_valid_valid/acc_unbiased': 76.602, 'best_valid_valid/diff': 29.643, 'best_valid_valid/acc_skew': 88.437, 'best_valid_valid/acc_align': 64.766, 'best_valid_test/acc': 85.897, 'best_valid_test/acc_unbiased': 77.827, 'best_valid_test/diff': 28.133, 'best_valid_test/acc_skew': 89.158, 'best_valid_test/acc_align': 66.496}
[14 / 20] best test accuracy: 78.029 at epoch 5 
 best_stats: {'best_test_epoch': 5, 'best_test_valid/acc': 82.672, 'best_test_valid/acc_unbiased': 75.858, 'best_test_valid/diff': 20.29, 'best_test_valid/acc_skew': 86.003, 'best_test_valid/acc_align': 65.713, 'best_test_test/acc': 84.002, 'best_test_test/acc_unbiased': 78.029, 'best_test_test/diff': 16.474, 'best_test_test/acc_skew': 86.266, 'best_test_test/acc_align': 69.792}
[15 / 20] Learning rate: 1e-05 weight: 0.01
[15 / 20] Loss: 4.44921812196452 CE Loss: 0.2171450663988009 Con Loss: 4.447046676844177
[15 / 20] tensor([[0.916, 0.392],
        [0.867, 0.921]]) {'epoch': 15, 'valid/acc': 84.921, 'valid/acc_unbiased': 76.366, 'valid/diff': 30.59, 'valid/acc_skew': 88.982, 'valid/acc_align': 63.75, 'test/acc': 85.721, 'test/acc_unbiased': 77.418, 'test/diff': 28.896, 'test/acc_skew': 89.174, 'test/acc_align': 65.663}
[15 / 20] best valid accuracy: 76.602 at epoch 11 
 best_stats: {'best_valid_epoch': 11, 'best_valid_valid/acc': 84.612, 'best_valid_valid/acc_unbiased': 76.602, 'best_valid_valid/diff': 29.643, 'best_valid_valid/acc_skew': 88.437, 'best_valid_valid/acc_align': 64.766, 'best_valid_test/acc': 85.897, 'best_valid_test/acc_unbiased': 77.827, 'best_valid_test/diff': 28.133, 'best_valid_test/acc_skew': 89.158, 'best_valid_test/acc_align': 66.496}
[15 / 20] best test accuracy: 78.029 at epoch 5 
 best_stats: {'best_test_epoch': 5, 'best_test_valid/acc': 82.672, 'best_test_valid/acc_unbiased': 75.858, 'best_test_valid/diff': 20.29, 'best_test_valid/acc_skew': 86.003, 'best_test_valid/acc_align': 65.713, 'best_test_test/acc': 84.002, 'best_test_test/acc_unbiased': 78.029, 'best_test_test/diff': 16.474, 'best_test_test/acc_skew': 86.266, 'best_test_test/acc_align': 69.792}
[16 / 20] Learning rate: 1e-05 weight: 0.01
[16 / 20] Loss: 4.436854816496321 CE Loss: 0.2143565504037083 Con Loss: 4.434711243645171
[16 / 20] tensor([[0.911, 0.381],
        [0.875, 0.927]]) {'epoch': 16, 'valid/acc': 84.788, 'valid/acc_unbiased': 76.098, 'valid/diff': 31.63, 'valid/acc_skew': 88.977, 'valid/acc_align': 63.219, 'test/acc': 85.765, 'test/acc_unbiased': 77.37, 'test/diff': 29.128, 'test/acc_skew': 89.342, 'test/acc_align': 65.398}
[16 / 20] best valid accuracy: 76.602 at epoch 11 
 best_stats: {'best_valid_epoch': 11, 'best_valid_valid/acc': 84.612, 'best_valid_valid/acc_unbiased': 76.602, 'best_valid_valid/diff': 29.643, 'best_valid_valid/acc_skew': 88.437, 'best_valid_valid/acc_align': 64.766, 'best_valid_test/acc': 85.897, 'best_valid_test/acc_unbiased': 77.827, 'best_valid_test/diff': 28.133, 'best_valid_test/acc_skew': 89.158, 'best_valid_test/acc_align': 66.496}
[16 / 20] best test accuracy: 78.029 at epoch 5 
 best_stats: {'best_test_epoch': 5, 'best_test_valid/acc': 82.672, 'best_test_valid/acc_unbiased': 75.858, 'best_test_valid/diff': 20.29, 'best_test_valid/acc_skew': 86.003, 'best_test_valid/acc_align': 65.713, 'best_test_test/acc': 84.002, 'best_test_test/acc_unbiased': 78.029, 'best_test_test/diff': 16.474, 'best_test_test/acc_skew': 86.266, 'best_test_test/acc_align': 69.792}
[17 / 20] Learning rate: 1e-05 weight: 0.01
[17 / 20] Loss: 4.445023147106585 CE Loss: 0.21743657506117073 Con Loss: 4.442848795306031
[17 / 20] tensor([[0.914, 0.386],
        [0.870, 0.927]]) {'epoch': 17, 'valid/acc': 84.921, 'valid/acc_unbiased': 76.653, 'valid/diff': 31.403, 'valid/acc_skew': 88.815, 'valid/acc_align': 64.492, 'test/acc': 85.721, 'test/acc_unbiased': 77.438, 'test/diff': 29.274, 'test/acc_skew': 89.195, 'test/acc_align': 65.682}
[17 / 20] best valid accuracy: 76.653 at epoch 17 
 best_stats: {'best_valid_epoch': 17, 'best_valid_valid/acc': 84.921, 'best_valid_valid/acc_unbiased': 76.653, 'best_valid_valid/diff': 31.403, 'best_valid_valid/acc_skew': 88.815, 'best_valid_valid/acc_align': 64.492, 'best_valid_test/acc': 85.721, 'best_valid_test/acc_unbiased': 77.438, 'best_valid_test/diff': 29.274, 'best_valid_test/acc_skew': 89.195, 'best_valid_test/acc_align': 65.682}
[17 / 20] best test accuracy: 78.029 at epoch 5 
 best_stats: {'best_test_epoch': 5, 'best_test_valid/acc': 82.672, 'best_test_valid/acc_unbiased': 75.858, 'best_test_valid/diff': 20.29, 'best_test_valid/acc_skew': 86.003, 'best_test_valid/acc_align': 65.713, 'best_test_test/acc': 84.002, 'best_test_test/acc_unbiased': 78.029, 'best_test_test/diff': 16.474, 'best_test_test/acc_skew': 86.266, 'best_test_test/acc_align': 69.792}
[18 / 20] Learning rate: 1e-05 weight: 0.01
[18 / 20] Loss: 4.433828114263926 CE Loss: 0.20792531157098226 Con Loss: 4.431748844619843
[18 / 20] tensor([[0.909, 0.392],
        [0.880, 0.927]]) {'epoch': 18, 'valid/acc': 84.436, 'valid/acc_unbiased': 75.501, 'valid/diff': 33.038, 'valid/acc_skew': 88.827, 'valid/acc_align': 62.176, 'test/acc': 85.897, 'test/acc_unbiased': 77.699, 'test/diff': 28.188, 'test/acc_skew': 89.431, 'test/acc_align': 65.966}
[18 / 20] best valid accuracy: 76.653 at epoch 17 
 best_stats: {'best_valid_epoch': 17, 'best_valid_valid/acc': 84.921, 'best_valid_valid/acc_unbiased': 76.653, 'best_valid_valid/diff': 31.403, 'best_valid_valid/acc_skew': 88.815, 'best_valid_valid/acc_align': 64.492, 'best_valid_test/acc': 85.721, 'best_valid_test/acc_unbiased': 77.438, 'best_valid_test/diff': 29.274, 'best_valid_test/acc_skew': 89.195, 'best_valid_test/acc_align': 65.682}
[18 / 20] best test accuracy: 78.029 at epoch 5 
 best_stats: {'best_test_epoch': 5, 'best_test_valid/acc': 82.672, 'best_test_valid/acc_unbiased': 75.858, 'best_test_valid/diff': 20.29, 'best_test_valid/acc_skew': 86.003, 'best_test_valid/acc_align': 65.713, 'best_test_test/acc': 84.002, 'best_test_test/acc_unbiased': 78.029, 'best_test_test/diff': 16.474, 'best_test_test/acc_skew': 86.266, 'best_test_test/acc_align': 69.792}
[19 / 20] Learning rate: 1e-05 weight: 0.01
[19 / 20] Loss: 4.440917613830964 CE Loss: 0.2159033953445638 Con Loss: 4.4387585736727155
[19 / 20] tensor([[0.908, 0.375],
        [0.885, 0.939]]) {'epoch': 19, 'valid/acc': 84.127, 'valid/acc_unbiased': 75.029, 'valid/diff': 33.001, 'valid/acc_skew': 88.643, 'valid/acc_align': 61.415, 'test/acc': 85.985, 'test/acc_unbiased': 77.667, 'test/diff': 29.368, 'test/acc_skew': 89.615, 'test/acc_align': 65.72}
[19 / 20] best valid accuracy: 76.653 at epoch 17 
 best_stats: {'best_valid_epoch': 17, 'best_valid_valid/acc': 84.921, 'best_valid_valid/acc_unbiased': 76.653, 'best_valid_valid/diff': 31.403, 'best_valid_valid/acc_skew': 88.815, 'best_valid_valid/acc_align': 64.492, 'best_valid_test/acc': 85.721, 'best_valid_test/acc_unbiased': 77.438, 'best_valid_test/diff': 29.274, 'best_valid_test/acc_skew': 89.195, 'best_valid_test/acc_align': 65.682}
[19 / 20] best test accuracy: 78.029 at epoch 5 
 best_stats: {'best_test_epoch': 5, 'best_test_valid/acc': 82.672, 'best_test_valid/acc_unbiased': 75.858, 'best_test_valid/diff': 20.29, 'best_test_valid/acc_skew': 86.003, 'best_test_valid/acc_align': 65.713, 'best_test_test/acc': 84.002, 'best_test_test/acc_unbiased': 78.029, 'best_test_test/diff': 16.474, 'best_test_test/acc_skew': 86.266, 'best_test_test/acc_align': 69.792}
[20 / 20] Learning rate: 1e-05 weight: 0.01
[20 / 20] Loss: 4.440769688357298 CE Loss: 0.21298850680162673 Con Loss: 4.43863980606754
[20 / 20] tensor([[0.911, 0.392],
        [0.877, 0.927]]) {'epoch': 20, 'valid/acc': 84.48, 'valid/acc_unbiased': 75.627, 'valid/diff': 31.99, 'valid/acc_skew': 88.805, 'valid/acc_align': 62.45, 'test/acc': 85.897, 'test/acc_unbiased': 77.683, 'test/diff': 28.502, 'test/acc_skew': 89.4, 'test/acc_align': 65.966}
[20 / 20] best valid accuracy: 76.653 at epoch 17 
 best_stats: {'best_valid_epoch': 17, 'best_valid_valid/acc': 84.921, 'best_valid_valid/acc_unbiased': 76.653, 'best_valid_valid/diff': 31.403, 'best_valid_valid/acc_skew': 88.815, 'best_valid_valid/acc_align': 64.492, 'best_valid_test/acc': 85.721, 'best_valid_test/acc_unbiased': 77.438, 'best_valid_test/diff': 29.274, 'best_valid_test/acc_skew': 89.195, 'best_valid_test/acc_align': 65.682}
[20 / 20] best test accuracy: 78.029 at epoch 5 
 best_stats: {'best_test_epoch': 5, 'best_test_valid/acc': 82.672, 'best_test_valid/acc_unbiased': 75.858, 'best_test_valid/diff': 20.29, 'best_test_valid/acc_skew': 86.003, 'best_test_valid/acc_align': 65.713, 'best_test_test/acc': 84.002, 'best_test_test/acc_unbiased': 78.029, 'best_test_test/diff': 16.474, 'best_test_test/acc_skew': 86.266, 'best_test_test/acc_align': 69.792}
Total training time: 0:49:45
