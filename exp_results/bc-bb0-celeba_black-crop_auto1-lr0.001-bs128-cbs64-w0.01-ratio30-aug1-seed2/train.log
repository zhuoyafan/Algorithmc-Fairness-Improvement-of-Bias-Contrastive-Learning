Log level set to: INFO
Set seed: 2
=======> Using Fixed Random Seed: 2 <========
save_path: exp_results/bc-bb0-celeba_black-crop_auto1-lr0.001-bs128-cbs64-w0.01-ratio30-aug1-seed2
get_celeba - split:train, aug: False, given_y: True, ratio: 0
use existing black indices from data/celeba/pickles/black
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [60774, 38396]
Target 1: [8027, 15991]
Binary Target 1
---------------------------
Target 0: [60774, 38396]
Target 1: [8027, 15991]
===================================
Normal Label Distribution: 
Target 0: [60774, 38396]
Target 1: [8027, 15991]
===================================
Use BiasedCelebASplit 
 target_attr: black split: train 
 tensor([[60774.,  8027.],
        [38396., 15991.]])
get_celeba - split:train, aug: 1, given_y: True, ratio: 30
use existing black indices from data/celeba/pickles/black
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [60435, 38588]
Target 1: [7963, 16202]
Binary Target 1
---------------------------
Target 0: [60435, 38588]
Target 1: [7963, 16202]
===================================
Normal Label Distribution: 
Target 0: [60435, 38588]
Target 1: [7963, 16202]
===================================
Use BiasedCelebASplit 
 target_attr: black split: train 
 tensor([[60435.,  7963.],
        [38588., 16202.]])
get_celeba - split:train_valid, aug: False, given_y: True, ratio: 0
use existing black indices from data/celeba/pickles/black
Use BiasedCelebASplit 
 target_attr: black split: train_valid 
 tensor([[15020.,  1991.],
        [ 9642.,  4145.]])
get_celeba - split:valid, aug: False, given_y: True, ratio: 0
Use BiasedCelebASplit 
 target_attr: black split: valid 
 tensor([[9752., 1657.],
        [5971., 2487.]])
decay_epochs: [3, 6]
[1 / 10] Learning rate: 0.001 weight: 0.01
[1 / 10] Loss: 4.826216386774049 CE Loss: 0.33571553450728187 Con Loss: 4.822859231599737
[1 / 10] tensor([[0.929, 0.917],
        [0.600, 0.587]]) {'epoch': 1, 'valid/acc': 85.333, 'valid/acc_unbiased': 73.816, 'valid/diff': 2.585, 'valid/acc_skew': 74.774, 'valid/acc_align': 72.859, 'test/acc': 85.549, 'test/acc_unbiased': 75.85, 'test/diff': 1.292, 'test/acc_skew': 75.896, 'test/acc_align': 75.805}
[1 / 10] best valid accuracy: 73.816 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 85.333, 'best_valid_valid/acc_unbiased': 73.816, 'best_valid_valid/diff': 2.585, 'best_valid_valid/acc_skew': 74.774, 'best_valid_valid/acc_align': 72.859, 'best_valid_test/acc': 85.549, 'best_valid_test/acc_unbiased': 75.85, 'best_valid_test/diff': 1.292, 'best_valid_test/acc_skew': 75.896, 'best_valid_test/acc_align': 75.805}
[1 / 10] best test accuracy: 75.850 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 85.333, 'best_test_valid/acc_unbiased': 73.816, 'best_test_valid/diff': 2.585, 'best_test_valid/acc_skew': 74.774, 'best_test_valid/acc_align': 72.859, 'best_test_test/acc': 85.549, 'best_test_test/acc_unbiased': 75.85, 'best_test_test/diff': 1.292, 'best_test_test/acc_skew': 75.896, 'best_test_test/acc_align': 75.805}
[2 / 10] Learning rate: 0.001 weight: 0.01
[2 / 10] Loss: 4.813269650970577 CE Loss: 0.2917168070577153 Con Loss: 4.810352480271793
[2 / 10] tensor([[0.967, 0.967],
        [0.519, 0.380]]) {'epoch': 2, 'valid/acc': 85.967, 'valid/acc_unbiased': 70.209, 'valid/diff': 6.192, 'valid/acc_skew': 73.305, 'valid/acc_align': 67.113, 'test/acc': 85.634, 'test/acc_unbiased': 70.84, 'test/diff': 6.959, 'test/acc_skew': 74.292, 'test/acc_align': 67.388}
[2 / 10] best valid accuracy: 73.816 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 85.333, 'best_valid_valid/acc_unbiased': 73.816, 'best_valid_valid/diff': 2.585, 'best_valid_valid/acc_skew': 74.774, 'best_valid_valid/acc_align': 72.859, 'best_valid_test/acc': 85.549, 'best_valid_test/acc_unbiased': 75.85, 'best_valid_test/diff': 1.292, 'best_valid_test/acc_skew': 75.896, 'best_valid_test/acc_align': 75.805}
[2 / 10] best test accuracy: 75.850 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 85.333, 'best_test_valid/acc_unbiased': 73.816, 'best_test_valid/diff': 2.585, 'best_test_valid/acc_skew': 74.774, 'best_test_valid/acc_align': 72.859, 'best_test_test/acc': 85.549, 'best_test_test/acc_unbiased': 75.85, 'best_test_test/diff': 1.292, 'best_test_test/acc_skew': 75.896, 'best_test_test/acc_align': 75.805}
[3 / 10] Learning rate: 0.001 weight: 0.01
[3 / 10] Loss: 4.8075351369192445 CE Loss: 0.28413859363147553 Con Loss: 4.804693743707019
[3 / 10] tensor([[0.897, 0.878],
        [0.870, 0.765]]) {'epoch': 3, 'valid/acc': 87.152, 'valid/acc_unbiased': 84.678, 'valid/diff': 4.872, 'valid/acc_skew': 86.961, 'valid/acc_align': 82.396, 'test/acc': 87.265, 'test/acc_unbiased': 85.27, 'test/diff': 6.18, 'test/acc_skew': 87.433, 'test/acc_align': 83.106}
[3 / 10] best valid accuracy: 84.678 at epoch 3 
 best_stats: {'best_valid_epoch': 3, 'best_valid_valid/acc': 87.152, 'best_valid_valid/acc_unbiased': 84.678, 'best_valid_valid/diff': 4.872, 'best_valid_valid/acc_skew': 86.961, 'best_valid_valid/acc_align': 82.396, 'best_valid_test/acc': 87.265, 'best_valid_test/acc_unbiased': 85.27, 'best_valid_test/diff': 6.18, 'best_valid_test/acc_skew': 87.433, 'best_valid_test/acc_align': 83.106}
[3 / 10] best test accuracy: 85.270 at epoch 3 
 best_stats: {'best_test_epoch': 3, 'best_test_valid/acc': 87.152, 'best_test_valid/acc_unbiased': 84.678, 'best_test_valid/diff': 4.872, 'best_test_valid/acc_skew': 86.961, 'best_test_valid/acc_align': 82.396, 'best_test_test/acc': 87.265, 'best_test_test/acc_unbiased': 85.27, 'best_test_test/diff': 6.18, 'best_test_test/acc_skew': 87.433, 'best_test_test/acc_align': 83.106}
[4 / 10] Learning rate: 0.0001 weight: 0.01
[4 / 10] Loss: 4.780877364588724 CE Loss: 0.2495728821558128 Con Loss: 4.778381634777341
[4 / 10] tensor([[0.963, 0.940],
        [0.686, 0.689]]) {'epoch': 4, 'valid/acc': 89.84, 'valid/acc_unbiased': 80.931, 'valid/diff': 1.651, 'valid/acc_skew': 80.783, 'valid/acc_align': 81.078, 'test/acc': 89.868, 'test/acc_unbiased': 81.946, 'test/diff': 1.304, 'test/acc_skew': 81.294, 'test/acc_align': 82.598}
[4 / 10] best valid accuracy: 84.678 at epoch 3 
 best_stats: {'best_valid_epoch': 3, 'best_valid_valid/acc': 87.152, 'best_valid_valid/acc_unbiased': 84.678, 'best_valid_valid/diff': 4.872, 'best_valid_valid/acc_skew': 86.961, 'best_valid_valid/acc_align': 82.396, 'best_valid_test/acc': 87.265, 'best_valid_test/acc_unbiased': 85.27, 'best_valid_test/diff': 6.18, 'best_valid_test/acc_skew': 87.433, 'best_valid_test/acc_align': 83.106}
[4 / 10] best test accuracy: 85.270 at epoch 3 
 best_stats: {'best_test_epoch': 3, 'best_test_valid/acc': 87.152, 'best_test_valid/acc_unbiased': 84.678, 'best_test_valid/diff': 4.872, 'best_test_valid/acc_skew': 86.961, 'best_test_valid/acc_align': 82.396, 'best_test_test/acc': 87.265, 'best_test_test/acc_unbiased': 85.27, 'best_test_test/diff': 6.18, 'best_test_test/acc_skew': 87.433, 'best_test_test/acc_align': 83.106}
[5 / 10] Learning rate: 0.0001 weight: 0.01
[5 / 10] Loss: 4.773360453383715 CE Loss: 0.23986430762146774 Con Loss: 4.770961804301234
[5 / 10] tensor([[0.952, 0.905],
        [0.756, 0.769]]) {'epoch': 5, 'valid/acc': 90.094, 'valid/acc_unbiased': 83.959, 'valid/diff': 2.228, 'valid/acc_skew': 82.845, 'valid/acc_align': 85.073, 'test/acc': 89.837, 'test/acc_unbiased': 84.53, 'test/diff': 3.031, 'test/acc_skew': 83.014, 'test/acc_align': 86.045}
[5 / 10] best valid accuracy: 84.678 at epoch 3 
 best_stats: {'best_valid_epoch': 3, 'best_valid_valid/acc': 87.152, 'best_valid_valid/acc_unbiased': 84.678, 'best_valid_valid/diff': 4.872, 'best_valid_valid/acc_skew': 86.961, 'best_valid_valid/acc_align': 82.396, 'best_valid_test/acc': 87.265, 'best_valid_test/acc_unbiased': 85.27, 'best_valid_test/diff': 6.18, 'best_valid_test/acc_skew': 87.433, 'best_valid_test/acc_align': 83.106}
[5 / 10] best test accuracy: 85.270 at epoch 3 
 best_stats: {'best_test_epoch': 3, 'best_test_valid/acc': 87.152, 'best_test_valid/acc_unbiased': 84.678, 'best_test_valid/diff': 4.872, 'best_test_valid/acc_skew': 86.961, 'best_test_valid/acc_align': 82.396, 'best_test_test/acc': 87.265, 'best_test_test/acc_unbiased': 85.27, 'best_test_test/diff': 6.18, 'best_test_test/acc_skew': 87.433, 'best_test_test/acc_align': 83.106}
[6 / 10] Learning rate: 0.0001 weight: 0.01
[6 / 10] Loss: 4.768909009976887 CE Loss: 0.23345138567312354 Con Loss: 4.766574487371228
[6 / 10] tensor([[0.963, 0.940],
        [0.712, 0.727]]) {'epoch': 6, 'valid/acc': 90.594, 'valid/acc_unbiased': 82.93, 'valid/diff': 1.6, 'valid/acc_skew': 82.828, 'valid/acc_align': 83.033, 'test/acc': 90.532, 'test/acc_unbiased': 83.524, 'test/diff': 1.907, 'test/acc_skew': 82.57, 'test/acc_align': 84.478}
[6 / 10] best valid accuracy: 84.678 at epoch 3 
 best_stats: {'best_valid_epoch': 3, 'best_valid_valid/acc': 87.152, 'best_valid_valid/acc_unbiased': 84.678, 'best_valid_valid/diff': 4.872, 'best_valid_valid/acc_skew': 86.961, 'best_valid_valid/acc_align': 82.396, 'best_valid_test/acc': 87.265, 'best_valid_test/acc_unbiased': 85.27, 'best_valid_test/diff': 6.18, 'best_valid_test/acc_skew': 87.433, 'best_valid_test/acc_align': 83.106}
[6 / 10] best test accuracy: 85.270 at epoch 3 
 best_stats: {'best_test_epoch': 3, 'best_test_valid/acc': 87.152, 'best_test_valid/acc_unbiased': 84.678, 'best_test_valid/diff': 4.872, 'best_test_valid/acc_skew': 86.961, 'best_test_valid/acc_align': 82.396, 'best_test_test/acc': 87.265, 'best_test_test/acc_unbiased': 85.27, 'best_test_test/diff': 6.18, 'best_test_test/acc_skew': 87.433, 'best_test_test/acc_align': 83.106}
[7 / 10] Learning rate: 1e-05 weight: 0.01
[7 / 10] Loss: 4.764203937401201 CE Loss: 0.22810650228424406 Con Loss: 4.76192286665085
[7 / 10] tensor([[0.963, 0.936],
        [0.717, 0.734]]) {'epoch': 7, 'valid/acc': 90.6, 'valid/acc_unbiased': 82.986, 'valid/diff': 1.351, 'valid/acc_skew': 82.644, 'valid/acc_align': 83.329, 'test/acc': 90.562, 'test/acc_unbiased': 83.746, 'test/diff': 2.228, 'test/acc_skew': 82.632, 'test/acc_align': 84.86}
[7 / 10] best valid accuracy: 84.678 at epoch 3 
 best_stats: {'best_valid_epoch': 3, 'best_valid_valid/acc': 87.152, 'best_valid_valid/acc_unbiased': 84.678, 'best_valid_valid/diff': 4.872, 'best_valid_valid/acc_skew': 86.961, 'best_valid_valid/acc_align': 82.396, 'best_valid_test/acc': 87.265, 'best_valid_test/acc_unbiased': 85.27, 'best_valid_test/diff': 6.18, 'best_valid_test/acc_skew': 87.433, 'best_valid_test/acc_align': 83.106}
[7 / 10] best test accuracy: 85.270 at epoch 3 
 best_stats: {'best_test_epoch': 3, 'best_test_valid/acc': 87.152, 'best_test_valid/acc_unbiased': 84.678, 'best_test_valid/diff': 4.872, 'best_test_valid/acc_skew': 86.961, 'best_test_valid/acc_align': 82.396, 'best_test_test/acc': 87.265, 'best_test_test/acc_unbiased': 85.27, 'best_test_test/diff': 6.18, 'best_test_test/acc_skew': 87.433, 'best_test_test/acc_align': 83.106}
[8 / 10] Learning rate: 1e-05 weight: 0.01
[8 / 10] Loss: 4.760853231210626 CE Loss: 0.22722962506551628 Con Loss: 4.7585809366205325
[8 / 10] tensor([[0.967, 0.944],
        [0.699, 0.710]]) {'epoch': 8, 'valid/acc': 90.438, 'valid/acc_unbiased': 82.176, 'valid/diff': 2.163, 'valid/acc_skew': 82.433, 'valid/acc_align': 81.92, 'test/acc': 90.562, 'test/acc_unbiased': 83.004, 'test/diff': 1.699, 'test/acc_skew': 82.154, 'test/acc_align': 83.854}
[8 / 10] best valid accuracy: 84.678 at epoch 3 
 best_stats: {'best_valid_epoch': 3, 'best_valid_valid/acc': 87.152, 'best_valid_valid/acc_unbiased': 84.678, 'best_valid_valid/diff': 4.872, 'best_valid_valid/acc_skew': 86.961, 'best_valid_valid/acc_align': 82.396, 'best_valid_test/acc': 87.265, 'best_valid_test/acc_unbiased': 85.27, 'best_valid_test/diff': 6.18, 'best_valid_test/acc_skew': 87.433, 'best_valid_test/acc_align': 83.106}
[8 / 10] best test accuracy: 85.270 at epoch 3 
 best_stats: {'best_test_epoch': 3, 'best_test_valid/acc': 87.152, 'best_test_valid/acc_unbiased': 84.678, 'best_test_valid/diff': 4.872, 'best_test_valid/acc_skew': 86.961, 'best_test_valid/acc_align': 82.396, 'best_test_test/acc': 87.265, 'best_test_test/acc_unbiased': 85.27, 'best_test_test/diff': 6.18, 'best_test_test/acc_skew': 87.433, 'best_test_test/acc_align': 83.106}
[9 / 10] Learning rate: 1e-05 weight: 0.01
[9 / 10] Loss: 4.755883293964415 CE Loss: 0.22474608489848671 Con Loss: 4.753635835782287
[9 / 10] tensor([[0.968, 0.942],
        [0.687, 0.714]]) {'epoch': 9, 'valid/acc': 90.678, 'valid/acc_unbiased': 82.399, 'valid/diff': 1.294, 'valid/acc_skew': 82.173, 'valid/acc_align': 82.625, 'test/acc': 90.492, 'test/acc_unbiased': 82.778, 'test/diff': 2.595, 'test/acc_skew': 81.48, 'test/acc_align': 84.076}
[9 / 10] best valid accuracy: 84.678 at epoch 3 
 best_stats: {'best_valid_epoch': 3, 'best_valid_valid/acc': 87.152, 'best_valid_valid/acc_unbiased': 84.678, 'best_valid_valid/diff': 4.872, 'best_valid_valid/acc_skew': 86.961, 'best_valid_valid/acc_align': 82.396, 'best_valid_test/acc': 87.265, 'best_valid_test/acc_unbiased': 85.27, 'best_valid_test/diff': 6.18, 'best_valid_test/acc_skew': 87.433, 'best_valid_test/acc_align': 83.106}
[9 / 10] best test accuracy: 85.270 at epoch 3 
 best_stats: {'best_test_epoch': 3, 'best_test_valid/acc': 87.152, 'best_test_valid/acc_unbiased': 84.678, 'best_test_valid/diff': 4.872, 'best_test_valid/acc_skew': 86.961, 'best_test_valid/acc_align': 82.396, 'best_test_test/acc': 87.265, 'best_test_test/acc_unbiased': 85.27, 'best_test_test/diff': 6.18, 'best_test_test/acc_skew': 87.433, 'best_test_test/acc_align': 83.106}
[10 / 10] Learning rate: 1e-05 weight: 0.01
[10 / 10] Loss: 4.761296132572611 CE Loss: 0.22407667188176894 Con Loss: 4.759055360685747
[10 / 10] tensor([[0.963, 0.935],
        [0.702, 0.735]]) {'epoch': 10, 'valid/acc': 90.756, 'valid/acc_unbiased': 83.271, 'valid/diff': 1.083, 'valid/acc_skew': 82.729, 'valid/acc_align': 83.813, 'test/acc': 90.421, 'test/acc_unbiased': 83.381, 'test/diff': 3.039, 'test/acc_skew': 81.861, 'test/acc_align': 84.9}
[10 / 10] best valid accuracy: 84.678 at epoch 3 
 best_stats: {'best_valid_epoch': 3, 'best_valid_valid/acc': 87.152, 'best_valid_valid/acc_unbiased': 84.678, 'best_valid_valid/diff': 4.872, 'best_valid_valid/acc_skew': 86.961, 'best_valid_valid/acc_align': 82.396, 'best_valid_test/acc': 87.265, 'best_valid_test/acc_unbiased': 85.27, 'best_valid_test/diff': 6.18, 'best_valid_test/acc_skew': 87.433, 'best_valid_test/acc_align': 83.106}
[10 / 10] best test accuracy: 85.270 at epoch 3 
 best_stats: {'best_test_epoch': 3, 'best_test_valid/acc': 87.152, 'best_test_valid/acc_unbiased': 84.678, 'best_test_valid/diff': 4.872, 'best_test_valid/acc_skew': 86.961, 'best_test_valid/acc_align': 82.396, 'best_test_test/acc': 87.265, 'best_test_test/acc_unbiased': 85.27, 'best_test_test/diff': 6.18, 'best_test_test/acc_skew': 87.433, 'best_test_test/acc_align': 83.106}
Total training time: 2:07:48
