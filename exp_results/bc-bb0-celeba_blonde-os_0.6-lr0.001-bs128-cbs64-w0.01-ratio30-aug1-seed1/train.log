Log level set to: INFO
Set seed: 1
=======> Using Fixed Random Seed: 1 <========
save_path: exp_results/bc-bb0-celeba_blonde-os_0.6-lr0.001-bs128-cbs64-w0.01-ratio30-aug1-seed1
get_celeba - split:train, aug: False, given_y: True, ratio: 0
use existing blonde indices from data/celeba/pickles/blonde
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [32146, 32146]
Target 1: [32146, 32146]
Binary Target 1
---------------------------
Target 0: [32146, 32146]
Target 1: [32146, 32146]
===================================
Normal Label Distribution: 
Target 0: [32146, 32146]
Target 1: [32146, 32146]
===================================
Use BiasedCelebASplit 
 target_attr: blonde split: train 
 tensor([[32146., 32146.],
        [32146., 32146.]])
get_celeba - split:train, aug: 1, given_y: True, ratio: 30
use existing blonde indices from data/celeba/pickles/blonde
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [32055, 32055]
Target 1: [32055, 32055]
Binary Target 1
---------------------------
Target 0: [32055, 32055]
Target 1: [32055, 32055]
===================================
Normal Label Distribution: 
Target 0: [32055, 32055]
Target 1: [32055, 32055]
===================================
Use BiasedCelebASplit 
 target_attr: blonde split: train 
 tensor([[32055., 32055.],
        [32055., 32055.]])
get_celeba - split:train_valid, aug: False, given_y: True, ratio: 0
use existing blonde indices from data/celeba/pickles/blonde
Use BiasedCelebASplit 
 target_attr: blonde split: train_valid 
 tensor([[  390.,  4598.],
        [13361.,   280.]])
get_celeba - split:valid, aug: False, given_y: True, ratio: 0
Use BiasedCelebASplit 
 target_attr: blonde split: valid 
 tensor([[8535., 2874.],
        [8276.,  182.]])
decay_epochs: [3, 6]
[1 / 10] Learning rate: 0.001 weight: 0.01
[1 / 10] Loss: 4.629884343790161 CE Loss: 0.24980160574332147 Con Loss: 4.627386323948651
[1 / 10] tensor([[0.853, 0.905],
        [0.955, 0.956]]) {'epoch': 1, 'valid/acc': 91.202, 'valid/acc_unbiased': 92.12, 'valid/diff': 2.892, 'valid/acc_skew': 93.566, 'valid/acc_align': 90.673, 'test/acc': 89.042, 'test/acc_unbiased': 91.726, 'test/diff': 2.644, 'test/acc_skew': 90.404, 'test/acc_align': 93.047}
[1 / 10] best valid accuracy: 92.120 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 91.202, 'best_valid_valid/acc_unbiased': 92.12, 'best_valid_valid/diff': 2.892, 'best_valid_valid/acc_skew': 93.566, 'best_valid_valid/acc_align': 90.673, 'best_valid_test/acc': 89.042, 'best_valid_test/acc_unbiased': 91.726, 'best_valid_test/diff': 2.644, 'best_valid_test/acc_skew': 90.404, 'best_valid_test/acc_align': 93.047}
[1 / 10] best test accuracy: 91.726 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 91.202, 'best_test_valid/acc_unbiased': 92.12, 'best_test_valid/diff': 2.892, 'best_test_valid/acc_skew': 93.566, 'best_test_valid/acc_align': 90.673, 'best_test_test/acc': 89.042, 'best_test_test/acc_unbiased': 91.726, 'best_test_test/diff': 2.644, 'best_test_test/acc_skew': 90.404, 'best_test_test/acc_align': 93.047}
[2 / 10] Learning rate: 0.001 weight: 0.01
[2 / 10] Loss: 4.57868134281968 CE Loss: 0.20969417521758227 Con Loss: 4.57658440316316
[2 / 10] tensor([[0.913, 0.965],
        [0.908, 0.835]]) {'epoch': 2, 'valid/acc': 94.267, 'valid/acc_unbiased': 91.659, 'valid/diff': 3.878, 'valid/acc_skew': 93.598, 'valid/acc_align': 89.72, 'test/acc': 93.295, 'test/acc_unbiased': 90.515, 'test/diff': 6.255, 'test/acc_skew': 91.037, 'test/acc_align': 89.994}
[2 / 10] best valid accuracy: 92.120 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 91.202, 'best_valid_valid/acc_unbiased': 92.12, 'best_valid_valid/diff': 2.892, 'best_valid_valid/acc_skew': 93.566, 'best_valid_valid/acc_align': 90.673, 'best_valid_test/acc': 89.042, 'best_valid_test/acc_unbiased': 91.726, 'best_valid_test/diff': 2.644, 'best_valid_test/acc_skew': 90.404, 'best_valid_test/acc_align': 93.047}
[2 / 10] best test accuracy: 91.726 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 91.202, 'best_test_valid/acc_unbiased': 92.12, 'best_test_valid/diff': 2.892, 'best_test_valid/acc_skew': 93.566, 'best_test_valid/acc_align': 90.673, 'best_test_test/acc': 89.042, 'best_test_test/acc_unbiased': 91.726, 'best_test_test/diff': 2.644, 'best_test_test/acc_skew': 90.404, 'best_test_test/acc_align': 93.047}
[3 / 10] Learning rate: 0.001 weight: 0.01
[3 / 10] Loss: 4.562223192454794 CE Loss: 0.19954450714679392 Con Loss: 4.560227746725572
[3 / 10] tensor([[0.851, 0.913],
        [0.953, 0.929]]) {'epoch': 3, 'valid/acc': 91.664, 'valid/acc_unbiased': 93.624, 'valid/diff': 2.579, 'valid/acc_skew': 94.913, 'valid/acc_align': 92.334, 'test/acc': 89.218, 'test/acc_unbiased': 91.133, 'test/diff': 4.348, 'test/acc_skew': 90.182, 'test/acc_align': 92.085}
[3 / 10] best valid accuracy: 93.624 at epoch 3 
 best_stats: {'best_valid_epoch': 3, 'best_valid_valid/acc': 91.664, 'best_valid_valid/acc_unbiased': 93.624, 'best_valid_valid/diff': 2.579, 'best_valid_valid/acc_skew': 94.913, 'best_valid_valid/acc_align': 92.334, 'best_valid_test/acc': 89.218, 'best_valid_test/acc_unbiased': 91.133, 'best_valid_test/diff': 4.348, 'best_valid_test/acc_skew': 90.182, 'best_valid_test/acc_align': 92.085}
[3 / 10] best test accuracy: 91.726 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 91.202, 'best_test_valid/acc_unbiased': 92.12, 'best_test_valid/diff': 2.892, 'best_test_valid/acc_skew': 93.566, 'best_test_valid/acc_align': 90.673, 'best_test_test/acc': 89.042, 'best_test_test/acc_unbiased': 91.726, 'best_test_test/diff': 2.644, 'best_test_test/acc_skew': 90.404, 'best_test_test/acc_align': 93.047}
[4 / 10] Learning rate: 0.0001 weight: 0.01
[4 / 10] Loss: 4.4922065381529706 CE Loss: 0.15801717241932695 Con Loss: 4.490626364573674
[4 / 10] tensor([[0.886, 0.950],
        [0.943, 0.863]]) {'epoch': 4, 'valid/acc': 94.514, 'valid/acc_unbiased': 95.132, 'valid/diff': 2.043, 'valid/acc_skew': 96.153, 'valid/acc_align': 94.11, 'test/acc': 92.047, 'test/acc_unbiased': 91.027, 'test/diff': 7.237, 'test/acc_skew': 91.423, 'test/acc_align': 90.631}
[4 / 10] best valid accuracy: 95.132 at epoch 4 
 best_stats: {'best_valid_epoch': 4, 'best_valid_valid/acc': 94.514, 'best_valid_valid/acc_unbiased': 95.132, 'best_valid_valid/diff': 2.043, 'best_valid_valid/acc_skew': 96.153, 'best_valid_valid/acc_align': 94.11, 'best_valid_test/acc': 92.047, 'best_valid_test/acc_unbiased': 91.027, 'best_valid_test/diff': 7.237, 'best_valid_test/acc_skew': 91.423, 'best_valid_test/acc_align': 90.631}
[4 / 10] best test accuracy: 91.726 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 91.202, 'best_test_valid/acc_unbiased': 92.12, 'best_test_valid/diff': 2.892, 'best_test_valid/acc_skew': 93.566, 'best_test_valid/acc_align': 90.673, 'best_test_test/acc': 89.042, 'best_test_test/acc_unbiased': 91.726, 'best_test_test/diff': 2.644, 'best_test_test/acc_skew': 90.404, 'best_test_test/acc_align': 93.047}
[5 / 10] Learning rate: 0.0001 weight: 0.01
[5 / 10] Loss: 4.454918936268585 CE Loss: 0.14353710082470572 Con Loss: 4.4534835660271455
[5 / 10] tensor([[0.851, 0.936],
        [0.965, 0.912]]) {'epoch': 5, 'valid/acc': 94.074, 'valid/acc_unbiased': 95.841, 'valid/diff': 2.228, 'valid/acc_skew': 96.346, 'valid/acc_align': 95.337, 'test/acc': 90.336, 'test/acc_unbiased': 91.6, 'test/diff': 6.905, 'test/acc_skew': 90.803, 'test/acc_align': 92.396}
[5 / 10] best valid accuracy: 95.841 at epoch 5 
 best_stats: {'best_valid_epoch': 5, 'best_valid_valid/acc': 94.074, 'best_valid_valid/acc_unbiased': 95.841, 'best_valid_valid/diff': 2.228, 'best_valid_valid/acc_skew': 96.346, 'best_valid_valid/acc_align': 95.337, 'best_valid_test/acc': 90.336, 'best_valid_test/acc_unbiased': 91.6, 'best_valid_test/diff': 6.905, 'best_valid_test/acc_skew': 90.803, 'best_valid_test/acc_align': 92.396}
[5 / 10] best test accuracy: 91.726 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 91.202, 'best_test_valid/acc_unbiased': 92.12, 'best_test_valid/diff': 2.892, 'best_test_valid/acc_skew': 93.566, 'best_test_valid/acc_align': 90.673, 'best_test_test/acc': 89.042, 'best_test_test/acc_unbiased': 91.726, 'best_test_test/diff': 2.644, 'best_test_test/acc_skew': 90.404, 'best_test_test/acc_align': 93.047}
[6 / 10] Learning rate: 0.0001 weight: 0.01
[6 / 10] Loss: 4.432787806142402 CE Loss: 0.136356147804265 Con Loss: 4.431424244230555
[6 / 10] tensor([[0.859, 0.955],
        [0.956, 0.874]]) {'epoch': 6, 'valid/acc': 95.341, 'valid/acc_unbiased': 96.418, 'valid/diff': 2.114, 'valid/acc_skew': 97.475, 'valid/acc_align': 95.361, 'test/acc': 91.332, 'test/acc_unbiased': 91.097, 'test/diff': 8.892, 'test/acc_skew': 90.761, 'test/acc_align': 91.434}
[6 / 10] best valid accuracy: 96.418 at epoch 6 
 best_stats: {'best_valid_epoch': 6, 'best_valid_valid/acc': 95.341, 'best_valid_valid/acc_unbiased': 96.418, 'best_valid_valid/diff': 2.114, 'best_valid_valid/acc_skew': 97.475, 'best_valid_valid/acc_align': 95.361, 'best_valid_test/acc': 91.332, 'best_valid_test/acc_unbiased': 91.097, 'best_valid_test/diff': 8.892, 'best_valid_test/acc_skew': 90.761, 'best_valid_test/acc_align': 91.434}
[6 / 10] best test accuracy: 91.726 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 91.202, 'best_test_valid/acc_unbiased': 92.12, 'best_test_valid/diff': 2.892, 'best_test_valid/acc_skew': 93.566, 'best_test_valid/acc_align': 90.673, 'best_test_test/acc': 89.042, 'best_test_test/acc_unbiased': 91.726, 'best_test_test/diff': 2.644, 'best_test_test/acc_skew': 90.404, 'best_test_test/acc_align': 93.047}
[7 / 10] Learning rate: 1e-05 weight: 0.01
[7 / 10] Loss: 4.414370344384253 CE Loss: 0.1292241979120367 Con Loss: 4.4130781077347745
[7 / 10] tensor([[0.845, 0.951],
        [0.964, 0.874]]) {'epoch': 7, 'valid/acc': 95.174, 'valid/acc_unbiased': 96.677, 'valid/diff': 1.995, 'valid/acc_skew': 97.558, 'valid/acc_align': 95.795, 'test/acc': 90.648, 'test/acc_unbiased': 90.829, 'test/diff': 9.831, 'test/acc_skew': 90.423, 'test/acc_align': 91.234}
[7 / 10] best valid accuracy: 96.677 at epoch 7 
 best_stats: {'best_valid_epoch': 7, 'best_valid_valid/acc': 95.174, 'best_valid_valid/acc_unbiased': 96.677, 'best_valid_valid/diff': 1.995, 'best_valid_valid/acc_skew': 97.558, 'best_valid_valid/acc_align': 95.795, 'best_valid_test/acc': 90.648, 'best_valid_test/acc_unbiased': 90.829, 'best_valid_test/diff': 9.831, 'best_valid_test/acc_skew': 90.423, 'best_valid_test/acc_align': 91.234}
[7 / 10] best test accuracy: 91.726 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 91.202, 'best_test_valid/acc_unbiased': 92.12, 'best_test_valid/diff': 2.892, 'best_test_valid/acc_skew': 93.566, 'best_test_valid/acc_align': 90.673, 'best_test_test/acc': 89.042, 'best_test_test/acc_unbiased': 91.726, 'best_test_test/diff': 2.644, 'best_test_test/acc_skew': 90.404, 'best_test_test/acc_align': 93.047}
[8 / 10] Learning rate: 1e-05 weight: 0.01
[8 / 10] Loss: 4.407936374408221 CE Loss: 0.12776866483456953 Con Loss: 4.4066586878633025
[8 / 10] tensor([[0.838, 0.953],
        [0.965, 0.874]]) {'epoch': 8, 'valid/acc': 95.378, 'valid/acc_unbiased': 96.707, 'valid/diff': 1.778, 'valid/acc_skew': 97.291, 'valid/acc_align': 96.123, 'test/acc': 90.472, 'test/acc_unbiased': 90.745, 'test/diff': 10.296, 'test/acc_skew': 90.159, 'test/acc_align': 91.331}
[8 / 10] best valid accuracy: 96.707 at epoch 8 
 best_stats: {'best_valid_epoch': 8, 'best_valid_valid/acc': 95.378, 'best_valid_valid/acc_unbiased': 96.707, 'best_valid_valid/diff': 1.778, 'best_valid_valid/acc_skew': 97.291, 'best_valid_valid/acc_align': 96.123, 'best_valid_test/acc': 90.472, 'best_valid_test/acc_unbiased': 90.745, 'best_valid_test/diff': 10.296, 'best_valid_test/acc_skew': 90.159, 'best_valid_test/acc_align': 91.331}
[8 / 10] best test accuracy: 91.726 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 91.202, 'best_test_valid/acc_unbiased': 92.12, 'best_test_valid/diff': 2.892, 'best_test_valid/acc_skew': 93.566, 'best_test_valid/acc_align': 90.673, 'best_test_test/acc': 89.042, 'best_test_test/acc_unbiased': 91.726, 'best_test_test/diff': 2.644, 'best_test_test/acc_skew': 90.404, 'best_test_test/acc_align': 93.047}
[9 / 10] Learning rate: 1e-05 weight: 0.01
[9 / 10] Loss: 4.400262959912889 CE Loss: 0.12570695099188783 Con Loss: 4.399005890307915
[9 / 10] tensor([[0.844, 0.953],
        [0.963, 0.879]]) {'epoch': 9, 'valid/acc': 95.346, 'valid/acc_unbiased': 96.752, 'valid/diff': 2.1, 'valid/acc_skew': 97.545, 'valid/acc_align': 95.959, 'test/acc': 90.678, 'test/acc_unbiased': 90.976, 'test/diff': 9.67, 'test/acc_skew': 90.358, 'test/acc_align': 91.594}
[9 / 10] best valid accuracy: 96.752 at epoch 9 
 best_stats: {'best_valid_epoch': 9, 'best_valid_valid/acc': 95.346, 'best_valid_valid/acc_unbiased': 96.752, 'best_valid_valid/diff': 2.1, 'best_valid_valid/acc_skew': 97.545, 'best_valid_valid/acc_align': 95.959, 'best_valid_test/acc': 90.678, 'best_valid_test/acc_unbiased': 90.976, 'best_valid_test/diff': 9.67, 'best_valid_test/acc_skew': 90.358, 'best_valid_test/acc_align': 91.594}
[9 / 10] best test accuracy: 91.726 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 91.202, 'best_test_valid/acc_unbiased': 92.12, 'best_test_valid/diff': 2.892, 'best_test_valid/acc_skew': 93.566, 'best_test_valid/acc_align': 90.673, 'best_test_test/acc': 89.042, 'best_test_test/acc_unbiased': 91.726, 'best_test_test/diff': 2.644, 'best_test_test/acc_skew': 90.404, 'best_test_test/acc_align': 93.047}
[10 / 10] Learning rate: 1e-05 weight: 0.01
[10 / 10] Loss: 4.3979984533658465 CE Loss: 0.12455806059646138 Con Loss: 4.396752866034056
[10 / 10] tensor([[0.844, 0.952],
        [0.965, 0.863]]) {'epoch': 10, 'valid/acc': 95.464, 'valid/acc_unbiased': 96.672, 'valid/diff': 1.663, 'valid/acc_skew': 97.504, 'valid/acc_align': 95.841, 'test/acc': 90.678, 'test/acc_unbiased': 90.59, 'test/diff': 10.475, 'test/acc_skew': 90.446, 'test/acc_align': 90.733}
[10 / 10] best valid accuracy: 96.752 at epoch 9 
 best_stats: {'best_valid_epoch': 9, 'best_valid_valid/acc': 95.346, 'best_valid_valid/acc_unbiased': 96.752, 'best_valid_valid/diff': 2.1, 'best_valid_valid/acc_skew': 97.545, 'best_valid_valid/acc_align': 95.959, 'best_valid_test/acc': 90.678, 'best_valid_test/acc_unbiased': 90.976, 'best_valid_test/diff': 9.67, 'best_valid_test/acc_skew': 90.358, 'best_valid_test/acc_align': 91.594}
[10 / 10] best test accuracy: 91.726 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 91.202, 'best_test_valid/acc_unbiased': 92.12, 'best_test_valid/diff': 2.892, 'best_test_valid/acc_skew': 93.566, 'best_test_valid/acc_align': 90.673, 'best_test_test/acc': 89.042, 'best_test_test/acc_unbiased': 91.726, 'best_test_test/diff': 2.644, 'best_test_test/acc_skew': 90.404, 'best_test_test/acc_align': 93.047}
Total training time: 1:48:17
