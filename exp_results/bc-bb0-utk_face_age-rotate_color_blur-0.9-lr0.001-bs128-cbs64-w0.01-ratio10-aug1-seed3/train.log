Log level set to: INFO
Set seed: 3
=======> Using Fixed Random Seed: 3 <========
save_path: exp_results/bc-bb0-utk_face_age-rotate_color_blur-0.9-lr0.001-bs128-cbs64-w0.01-ratio10-aug1-seed3
get_utk_face - split: train, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_age-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
Binary Target 1
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Normal Label Distribution: 
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
Binary Target 1
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Normal Label Distribution: 
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 10684, target_attr: gender, bias_attr: age bias_rate: 0.9
['[train] target_0-bias_0: 8237', '[train] target_0-bias_1: 147', '[train] target_1-bias_0: 823', '[train] target_1-bias_1: 1477']
confusion_matrix - 
 original: tensor([[8237.,  823.],
        [ 147., 1477.]]), 
 normalized: tensor([[0.909, 0.091],
        [0.091, 0.909]]), 
 b|y: tensor([[0.982, 0.018],
        [0.358, 0.642]])
get_utk_face - split: train, aug: 1, given_y: True, ratio: 10
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_age-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
Binary Target 1
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Normal Label Distribution: 
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
Binary Target 1
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Normal Label Distribution: 
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 10684, target_attr: gender, bias_attr: age bias_rate: 0.9
['[train] target_0-bias_0: 8237', '[train] target_0-bias_1: 147', '[train] target_1-bias_0: 823', '[train] target_1-bias_1: 1477']
get_utk_face - split: valid, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_age-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [1030, 195]
Target 1: [841, 202]
Binary Target 1
---------------------------
Target 0: [1030, 195]
Target 1: [841, 202]
===================================
Normal Label Distribution: 
Target 0: [1030, 195]
Target 1: [841, 202]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 2268, target_attr: gender, bias_attr: age bias_rate: 0.9
['[valid] target_0-bias_0: 1030', '[valid] target_0-bias_1: 195', '[valid] target_1-bias_0: 841', '[valid] target_1-bias_1: 202']
get_utk_face - split: test, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_age-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [1061, 176]
Target 1: [867, 165]
Binary Target 1
---------------------------
Target 0: [1061, 176]
Target 1: [867, 165]
===================================
Normal Label Distribution: 
Target 0: [1061, 176]
Target 1: [867, 165]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 2269, target_attr: gender, bias_attr: age bias_rate: 0.9
['[test] target_0-bias_0: 1061', '[test] target_0-bias_1: 176', '[test] target_1-bias_0: 867', '[test] target_1-bias_1: 165']
decay_epochs: [6, 13]
[1 / 20] Learning rate: 0.001 weight: 0.01
[1 / 20] Loss: 4.8723742148707485 CE Loss: 0.5788670786084954 Con Loss: 4.86658553227375
[1 / 20] tensor([[1., 1.],
        [0., 0.]]) {'epoch': 1, 'valid/acc': 54.012, 'valid/acc_unbiased': 50.0, 'valid/diff': 0.0, 'valid/acc_skew': 50.0, 'valid/acc_align': 50.0, 'test/acc': 54.517, 'test/acc_unbiased': 50.0, 'test/diff': 0.0, 'test/acc_skew': 50.0, 'test/acc_align': 50.0}
[1 / 20] best valid accuracy: 50.000 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 54.012, 'best_valid_valid/acc_unbiased': 50.0, 'best_valid_valid/diff': 0.0, 'best_valid_valid/acc_skew': 50.0, 'best_valid_valid/acc_align': 50.0, 'best_valid_test/acc': 54.517, 'best_valid_test/acc_unbiased': 50.0, 'best_valid_test/diff': 0.0, 'best_valid_test/acc_skew': 50.0, 'best_valid_test/acc_align': 50.0}
[1 / 20] best test accuracy: 50.000 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 54.012, 'best_test_valid/acc_unbiased': 50.0, 'best_test_valid/diff': 0.0, 'best_test_valid/acc_skew': 50.0, 'best_test_valid/acc_align': 50.0, 'best_test_test/acc': 54.517, 'best_test_test/acc_unbiased': 50.0, 'best_test_test/diff': 0.0, 'best_test_test/acc_skew': 50.0, 'best_test_test/acc_align': 50.0}
[2 / 20] Learning rate: 0.001 weight: 0.01
[2 / 20] Loss: 4.69876484476373 CE Loss: 0.534327050779072 Con Loss: 4.693421583236358
[2 / 20] tensor([[1., 1.],
        [0., 0.]]) {'epoch': 2, 'valid/acc': 54.012, 'valid/acc_unbiased': 50.0, 'valid/diff': 0.0, 'valid/acc_skew': 50.0, 'valid/acc_align': 50.0, 'test/acc': 54.517, 'test/acc_unbiased': 50.0, 'test/diff': 0.0, 'test/acc_skew': 50.0, 'test/acc_align': 50.0}
[2 / 20] best valid accuracy: 50.000 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 54.012, 'best_valid_valid/acc_unbiased': 50.0, 'best_valid_valid/diff': 0.0, 'best_valid_valid/acc_skew': 50.0, 'best_valid_valid/acc_align': 50.0, 'best_valid_test/acc': 54.517, 'best_valid_test/acc_unbiased': 50.0, 'best_valid_test/diff': 0.0, 'best_valid_test/acc_skew': 50.0, 'best_valid_test/acc_align': 50.0}
[2 / 20] best test accuracy: 50.000 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 54.012, 'best_test_valid/acc_unbiased': 50.0, 'best_test_valid/diff': 0.0, 'best_test_valid/acc_skew': 50.0, 'best_test_valid/acc_align': 50.0, 'best_test_test/acc': 54.517, 'best_test_test/acc_unbiased': 50.0, 'best_test_test/diff': 0.0, 'best_test_test/acc_skew': 50.0, 'best_test_test/acc_align': 50.0}
[3 / 20] Learning rate: 0.001 weight: 0.01
[3 / 20] Loss: 4.671679288070776 CE Loss: 0.530098906173906 Con Loss: 4.666378252250074
[3 / 20] tensor([[1., 1.],
        [0., 0.]]) {'epoch': 3, 'valid/acc': 54.012, 'valid/acc_unbiased': 50.0, 'valid/diff': 0.0, 'valid/acc_skew': 50.0, 'valid/acc_align': 50.0, 'test/acc': 54.517, 'test/acc_unbiased': 50.0, 'test/diff': 0.0, 'test/acc_skew': 50.0, 'test/acc_align': 50.0}
[3 / 20] best valid accuracy: 50.000 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 54.012, 'best_valid_valid/acc_unbiased': 50.0, 'best_valid_valid/diff': 0.0, 'best_valid_valid/acc_skew': 50.0, 'best_valid_valid/acc_align': 50.0, 'best_valid_test/acc': 54.517, 'best_valid_test/acc_unbiased': 50.0, 'best_valid_test/diff': 0.0, 'best_valid_test/acc_skew': 50.0, 'best_valid_test/acc_align': 50.0}
[3 / 20] best test accuracy: 50.000 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 54.012, 'best_test_valid/acc_unbiased': 50.0, 'best_test_valid/diff': 0.0, 'best_test_valid/acc_skew': 50.0, 'best_test_valid/acc_align': 50.0, 'best_test_test/acc': 54.517, 'best_test_test/acc_unbiased': 50.0, 'best_test_test/diff': 0.0, 'best_test_test/acc_skew': 50.0, 'best_test_test/acc_align': 50.0}
[4 / 20] Learning rate: 0.001 weight: 0.01
[4 / 20] Loss: 4.6438414433706745 CE Loss: 0.5257307030497664 Con Loss: 4.638584131250128
[4 / 20] tensor([[0.987, 0.983],
        [0.198, 0.061]]) {'epoch': 4, 'valid/acc': 60.626, 'valid/acc_unbiased': 55.954, 'valid/diff': 4.745, 'valid/acc_skew': 58.327, 'valid/acc_align': 53.582, 'test/acc': 61.789, 'test/acc_unbiased': 55.719, 'test/diff': 7.081, 'test/acc_skew': 59.067, 'test/acc_align': 52.371}
[4 / 20] best valid accuracy: 55.954 at epoch 4 
 best_stats: {'best_valid_epoch': 4, 'best_valid_valid/acc': 60.626, 'best_valid_valid/acc_unbiased': 55.954, 'best_valid_valid/diff': 4.745, 'best_valid_valid/acc_skew': 58.327, 'best_valid_valid/acc_align': 53.582, 'best_valid_test/acc': 61.789, 'best_valid_test/acc_unbiased': 55.719, 'best_valid_test/diff': 7.081, 'best_valid_test/acc_skew': 59.067, 'best_valid_test/acc_align': 52.371}
[4 / 20] best test accuracy: 55.719 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 60.626, 'best_test_valid/acc_unbiased': 55.954, 'best_test_valid/diff': 4.745, 'best_test_valid/acc_skew': 58.327, 'best_test_valid/acc_align': 53.582, 'best_test_test/acc': 61.789, 'best_test_test/acc_unbiased': 55.719, 'best_test_test/diff': 7.081, 'best_test_test/acc_skew': 59.067, 'best_test_test/acc_align': 52.371}
[5 / 20] Learning rate: 0.001 weight: 0.01
[5 / 20] Loss: 4.63208626736777 CE Loss: 0.5063296457949938 Con Loss: 4.627022965844318
[5 / 20] tensor([[0.894, 0.955],
        [0.281, 0.097]]) {'epoch': 5, 'valid/acc': 60.141, 'valid/acc_unbiased': 55.413, 'valid/diff': 7.878, 'valid/acc_skew': 59.352, 'valid/acc_align': 51.475, 'test/acc': 60.688, 'test/acc_unbiased': 55.685, 'test/diff': 12.228, 'test/acc_skew': 61.799, 'test/acc_align': 49.57}
[5 / 20] best valid accuracy: 55.954 at epoch 4 
 best_stats: {'best_valid_epoch': 4, 'best_valid_valid/acc': 60.626, 'best_valid_valid/acc_unbiased': 55.954, 'best_valid_valid/diff': 4.745, 'best_valid_valid/acc_skew': 58.327, 'best_valid_valid/acc_align': 53.582, 'best_valid_test/acc': 61.789, 'best_valid_test/acc_unbiased': 55.719, 'best_valid_test/diff': 7.081, 'best_valid_test/acc_skew': 59.067, 'best_valid_test/acc_align': 52.371}
[5 / 20] best test accuracy: 55.719 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 60.626, 'best_test_valid/acc_unbiased': 55.954, 'best_test_valid/diff': 4.745, 'best_test_valid/acc_skew': 58.327, 'best_test_valid/acc_align': 53.582, 'best_test_test/acc': 61.789, 'best_test_test/acc_unbiased': 55.719, 'best_test_test/diff': 7.081, 'best_test_test/acc_skew': 59.067, 'best_test_test/acc_align': 52.371}
[6 / 20] Learning rate: 0.001 weight: 0.01
[6 / 20] Loss: 4.65360900749655 CE Loss: 0.5149057005862983 Con Loss: 4.6484599665103
[6 / 20] tensor([[1.000, 1.000],
        [0.005, 0.000]]) {'epoch': 6, 'valid/acc': 54.145, 'valid/acc_unbiased': 50.377, 'valid/diff': 0.732, 'valid/acc_skew': 50.059, 'valid/acc_align': 50.694, 'test/acc': 54.694, 'test/acc_unbiased': 50.115, 'test/diff': 0.231, 'test/acc_skew': 50.231, 'test/acc_align': 50.0}
[6 / 20] best valid accuracy: 55.954 at epoch 4 
 best_stats: {'best_valid_epoch': 4, 'best_valid_valid/acc': 60.626, 'best_valid_valid/acc_unbiased': 55.954, 'best_valid_valid/diff': 4.745, 'best_valid_valid/acc_skew': 58.327, 'best_valid_valid/acc_align': 53.582, 'best_valid_test/acc': 61.789, 'best_valid_test/acc_unbiased': 55.719, 'best_valid_test/diff': 7.081, 'best_valid_test/acc_skew': 59.067, 'best_valid_test/acc_align': 52.371}
[6 / 20] best test accuracy: 55.719 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 60.626, 'best_test_valid/acc_unbiased': 55.954, 'best_test_valid/diff': 4.745, 'best_test_valid/acc_skew': 58.327, 'best_test_valid/acc_align': 53.582, 'best_test_test/acc': 61.789, 'best_test_test/acc_unbiased': 55.719, 'best_test_test/diff': 7.081, 'best_test_test/acc_skew': 59.067, 'best_test_test/acc_align': 52.371}
[7 / 20] Learning rate: 0.0001 weight: 0.01
[7 / 20] Loss: 4.5809159923340665 CE Loss: 0.4988045219020958 Con Loss: 4.575927957172744
[7 / 20] tensor([[0.983, 0.915],
        [0.105, 0.097]]) {'epoch': 7, 'valid/acc': 57.672, 'valid/acc_unbiased': 54.127, 'valid/diff': 1.58, 'valid/acc_skew': 53.337, 'valid/acc_align': 54.916, 'test/acc': 57.779, 'test/acc_unbiased': 52.493, 'test/diff': 3.813, 'test/acc_skew': 50.987, 'test/acc_align': 54.0}
[7 / 20] best valid accuracy: 55.954 at epoch 4 
 best_stats: {'best_valid_epoch': 4, 'best_valid_valid/acc': 60.626, 'best_valid_valid/acc_unbiased': 55.954, 'best_valid_valid/diff': 4.745, 'best_valid_valid/acc_skew': 58.327, 'best_valid_valid/acc_align': 53.582, 'best_valid_test/acc': 61.789, 'best_valid_test/acc_unbiased': 55.719, 'best_valid_test/diff': 7.081, 'best_valid_test/acc_skew': 59.067, 'best_valid_test/acc_align': 52.371}
[7 / 20] best test accuracy: 55.719 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 60.626, 'best_test_valid/acc_unbiased': 55.954, 'best_test_valid/diff': 4.745, 'best_test_valid/acc_skew': 58.327, 'best_test_valid/acc_align': 53.582, 'best_test_test/acc': 61.789, 'best_test_test/acc_unbiased': 55.719, 'best_test_test/diff': 7.081, 'best_test_test/acc_skew': 59.067, 'best_test_test/acc_align': 52.371}
[8 / 20] Learning rate: 0.0001 weight: 0.01
[8 / 20] Loss: 4.533110114797052 CE Loss: 0.49595009399147705 Con Loss: 4.528150615420782
[8 / 20] tensor([[0.976, 0.869],
        [0.203, 0.164]]) {'epoch': 8, 'valid/acc': 61.596, 'valid/acc_unbiased': 57.774, 'valid/diff': 2.413, 'valid/acc_skew': 57.249, 'valid/acc_align': 58.299, 'test/acc': 61.349, 'test/acc_unbiased': 55.31, 'test/diff': 7.324, 'test/acc_skew': 53.616, 'test/acc_align': 57.004}
[8 / 20] best valid accuracy: 57.774 at epoch 8 
 best_stats: {'best_valid_epoch': 8, 'best_valid_valid/acc': 61.596, 'best_valid_valid/acc_unbiased': 57.774, 'best_valid_valid/diff': 2.413, 'best_valid_valid/acc_skew': 57.249, 'best_valid_valid/acc_align': 58.299, 'best_valid_test/acc': 61.349, 'best_valid_test/acc_unbiased': 55.31, 'best_valid_test/diff': 7.324, 'best_valid_test/acc_skew': 53.616, 'best_valid_test/acc_align': 57.004}
[8 / 20] best test accuracy: 55.719 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 60.626, 'best_test_valid/acc_unbiased': 55.954, 'best_test_valid/diff': 4.745, 'best_test_valid/acc_skew': 58.327, 'best_test_valid/acc_align': 53.582, 'best_test_test/acc': 61.789, 'best_test_test/acc_unbiased': 55.719, 'best_test_test/diff': 7.081, 'best_test_test/acc_skew': 59.067, 'best_test_test/acc_align': 52.371}
[9 / 20] Learning rate: 0.0001 weight: 0.01
[9 / 20] Loss: 4.502330801452157 CE Loss: 0.48113481299299643 Con Loss: 4.497519461504309
[9 / 20] tensor([[0.965, 0.835],
        [0.331, 0.267]]) {'epoch': 9, 'valid/acc': 64.991, 'valid/acc_unbiased': 60.739, 'valid/diff': 5.091, 'valid/acc_skew': 59.107, 'valid/acc_align': 62.371, 'test/acc': 66.197, 'test/acc_unbiased': 59.951, 'test/diff': 9.713, 'test/acc_skew': 58.313, 'test/acc_align': 61.59}
[9 / 20] best valid accuracy: 60.739 at epoch 9 
 best_stats: {'best_valid_epoch': 9, 'best_valid_valid/acc': 64.991, 'best_valid_valid/acc_unbiased': 60.739, 'best_valid_valid/diff': 5.091, 'best_valid_valid/acc_skew': 59.107, 'best_valid_valid/acc_align': 62.371, 'best_valid_test/acc': 66.197, 'best_valid_test/acc_unbiased': 59.951, 'best_valid_test/diff': 9.713, 'best_valid_test/acc_skew': 58.313, 'best_valid_test/acc_align': 61.59}
[9 / 20] best test accuracy: 59.951 at epoch 9 
 best_stats: {'best_test_epoch': 9, 'best_test_valid/acc': 64.991, 'best_test_valid/acc_unbiased': 60.739, 'best_test_valid/diff': 5.091, 'best_test_valid/acc_skew': 59.107, 'best_test_valid/acc_align': 62.371, 'best_test_test/acc': 66.197, 'best_test_test/acc_unbiased': 59.951, 'best_test_test/diff': 9.713, 'best_test_test/acc_skew': 58.313, 'best_test_test/acc_align': 61.59}
[10 / 20] Learning rate: 0.0001 weight: 0.01
[10 / 20] Loss: 4.477231425767711 CE Loss: 0.47050394705287174 Con Loss: 4.472526390335615
[10 / 20] tensor([[0.973, 0.830],
        [0.326, 0.267]]) {'epoch': 10, 'valid/acc': 65.741, 'valid/acc_unbiased': 62.155, 'valid/diff': 2.829, 'valid/acc_skew': 60.861, 'valid/acc_align': 63.449, 'test/acc': 66.329, 'test/acc_unbiased': 59.882, 'test/diff': 10.143, 'test/acc_skew': 57.798, 'test/acc_align': 61.967}
[10 / 20] best valid accuracy: 62.155 at epoch 10 
 best_stats: {'best_valid_epoch': 10, 'best_valid_valid/acc': 65.741, 'best_valid_valid/acc_unbiased': 62.155, 'best_valid_valid/diff': 2.829, 'best_valid_valid/acc_skew': 60.861, 'best_valid_valid/acc_align': 63.449, 'best_valid_test/acc': 66.329, 'best_valid_test/acc_unbiased': 59.882, 'best_valid_test/diff': 10.143, 'best_valid_test/acc_skew': 57.798, 'best_valid_test/acc_align': 61.967}
[10 / 20] best test accuracy: 59.951 at epoch 9 
 best_stats: {'best_test_epoch': 9, 'best_test_valid/acc': 64.991, 'best_test_valid/acc_unbiased': 60.739, 'best_test_valid/diff': 5.091, 'best_test_valid/acc_skew': 59.107, 'best_test_valid/acc_align': 62.371, 'best_test_test/acc': 66.197, 'best_test_test/acc_unbiased': 59.951, 'best_test_test/diff': 9.713, 'best_test_test/acc_skew': 58.313, 'best_test_test/acc_align': 61.59}
[11 / 20] Learning rate: 0.0001 weight: 0.01
[11 / 20] Loss: 4.442388441713505 CE Loss: 0.4681444219528 Con Loss: 4.437707002312001
[11 / 20] tensor([[0.976, 0.773],
        [0.324, 0.291]]) {'epoch': 11, 'valid/acc': 66.005, 'valid/acc_unbiased': 61.716, 'valid/diff': 6.436, 'valid/acc_skew': 58.498, 'valid/acc_align': 64.934, 'test/acc': 66.152, 'test/acc_unbiased': 59.104, 'test/diff': 11.845, 'test/acc_skew': 54.842, 'test/acc_align': 63.367}
[11 / 20] best valid accuracy: 62.155 at epoch 10 
 best_stats: {'best_valid_epoch': 10, 'best_valid_valid/acc': 65.741, 'best_valid_valid/acc_unbiased': 62.155, 'best_valid_valid/diff': 2.829, 'best_valid_valid/acc_skew': 60.861, 'best_valid_valid/acc_align': 63.449, 'best_valid_test/acc': 66.329, 'best_valid_test/acc_unbiased': 59.882, 'best_valid_test/diff': 10.143, 'best_valid_test/acc_skew': 57.798, 'best_valid_test/acc_align': 61.967}
[11 / 20] best test accuracy: 59.951 at epoch 9 
 best_stats: {'best_test_epoch': 9, 'best_test_valid/acc': 64.991, 'best_test_valid/acc_unbiased': 60.739, 'best_test_valid/diff': 5.091, 'best_test_valid/acc_skew': 59.107, 'best_test_valid/acc_align': 62.371, 'best_test_test/acc': 66.197, 'best_test_test/acc_unbiased': 59.951, 'best_test_test/diff': 9.713, 'best_test_test/acc_skew': 58.313, 'best_test_test/acc_align': 61.59}
[12 / 20] Learning rate: 0.0001 weight: 0.01
[12 / 20] Loss: 4.385158477584684 CE Loss: 0.46415022886991053 Con Loss: 4.380516976642501
[12 / 20] tensor([[0.978, 0.841],
        [0.298, 0.261]]) {'epoch': 12, 'valid/acc': 66.667, 'valid/acc_unbiased': 62.931, 'valid/diff': 3.501, 'valid/acc_skew': 61.181, 'valid/acc_align': 64.681, 'test/acc': 65.535, 'test/acc_unbiased': 59.435, 'test/diff': 8.719, 'test/acc_skew': 56.924, 'test/acc_align': 61.946}
[12 / 20] best valid accuracy: 62.931 at epoch 12 
 best_stats: {'best_valid_epoch': 12, 'best_valid_valid/acc': 66.667, 'best_valid_valid/acc_unbiased': 62.931, 'best_valid_valid/diff': 3.501, 'best_valid_valid/acc_skew': 61.181, 'best_valid_valid/acc_align': 64.681, 'best_valid_test/acc': 65.535, 'best_valid_test/acc_unbiased': 59.435, 'best_valid_test/diff': 8.719, 'best_valid_test/acc_skew': 56.924, 'best_valid_test/acc_align': 61.946}
[12 / 20] best test accuracy: 59.951 at epoch 9 
 best_stats: {'best_test_epoch': 9, 'best_test_valid/acc': 64.991, 'best_test_valid/acc_unbiased': 60.739, 'best_test_valid/diff': 5.091, 'best_test_valid/acc_skew': 59.107, 'best_test_valid/acc_align': 62.371, 'best_test_test/acc': 66.197, 'best_test_test/acc_unbiased': 59.951, 'best_test_test/diff': 9.713, 'best_test_test/acc_skew': 58.313, 'best_test_test/acc_align': 61.59}
[13 / 20] Learning rate: 0.0001 weight: 0.01
[13 / 20] Loss: 4.411830161047178 CE Loss: 0.4622077853302079 Con Loss: 4.407208090996037
[13 / 20] tensor([[0.977, 0.835],
        [0.338, 0.255]]) {'epoch': 13, 'valid/acc': 67.108, 'valid/acc_unbiased': 62.712, 'valid/diff': 5.518, 'valid/acc_skew': 60.946, 'valid/acc_align': 64.478, 'test/acc': 66.946, 'test/acc_unbiased': 60.127, 'test/diff': 11.278, 'test/acc_skew': 58.659, 'test/acc_align': 61.596}
[13 / 20] best valid accuracy: 62.931 at epoch 12 
 best_stats: {'best_valid_epoch': 12, 'best_valid_valid/acc': 66.667, 'best_valid_valid/acc_unbiased': 62.931, 'best_valid_valid/diff': 3.501, 'best_valid_valid/acc_skew': 61.181, 'best_valid_valid/acc_align': 64.681, 'best_valid_test/acc': 65.535, 'best_valid_test/acc_unbiased': 59.435, 'best_valid_test/diff': 8.719, 'best_valid_test/acc_skew': 56.924, 'best_valid_test/acc_align': 61.946}
[13 / 20] best test accuracy: 60.127 at epoch 13 
 best_stats: {'best_test_epoch': 13, 'best_test_valid/acc': 67.108, 'best_test_valid/acc_unbiased': 62.712, 'best_test_valid/diff': 5.518, 'best_test_valid/acc_skew': 60.946, 'best_test_valid/acc_align': 64.478, 'best_test_test/acc': 66.946, 'best_test_test/acc_unbiased': 60.127, 'best_test_test/diff': 11.278, 'best_test_test/acc_skew': 58.659, 'best_test_test/acc_align': 61.596}
[14 / 20] Learning rate: 1e-05 weight: 0.01
[14 / 20] Loss: 4.349608011970535 CE Loss: 0.45742953036751743 Con Loss: 4.345033693295746
[14 / 20] tensor([[0.975, 0.812],
        [0.386, 0.279]]) {'epoch': 14, 'valid/acc': 68.342, 'valid/acc_unbiased': 63.841, 'valid/diff': 6.363, 'valid/acc_skew': 61.764, 'valid/acc_align': 65.919, 'test/acc': 68.665, 'test/acc_unbiased': 61.306, 'test/diff': 13.483, 'test/acc_skew': 59.944, 'test/acc_align': 62.667}
[14 / 20] best valid accuracy: 63.841 at epoch 14 
 best_stats: {'best_valid_epoch': 14, 'best_valid_valid/acc': 68.342, 'best_valid_valid/acc_unbiased': 63.841, 'best_valid_valid/diff': 6.363, 'best_valid_valid/acc_skew': 61.764, 'best_valid_valid/acc_align': 65.919, 'best_valid_test/acc': 68.665, 'best_valid_test/acc_unbiased': 61.306, 'best_valid_test/diff': 13.483, 'best_valid_test/acc_skew': 59.944, 'best_valid_test/acc_align': 62.667}
[14 / 20] best test accuracy: 61.306 at epoch 14 
 best_stats: {'best_test_epoch': 14, 'best_test_valid/acc': 68.342, 'best_test_valid/acc_unbiased': 63.841, 'best_test_valid/diff': 6.363, 'best_test_valid/acc_skew': 61.764, 'best_test_valid/acc_align': 65.919, 'best_test_test/acc': 68.665, 'best_test_test/acc_unbiased': 61.306, 'best_test_test/diff': 13.483, 'best_test_test/acc_skew': 59.944, 'best_test_test/acc_align': 62.667}
[15 / 20] Learning rate: 1e-05 weight: 0.01
[15 / 20] Loss: 4.347290465377413 CE Loss: 0.45017827389526793 Con Loss: 4.342788727709257
[15 / 20] tensor([[0.972, 0.801],
        [0.391, 0.297]]) {'epoch': 15, 'valid/acc': 68.563, 'valid/acc_unbiased': 63.784, 'valid/diff': 7.309, 'valid/acc_skew': 61.154, 'valid/acc_align': 66.414, 'test/acc': 68.753, 'test/acc_unbiased': 61.521, 'test/diff': 13.231, 'test/acc_skew': 59.607, 'test/acc_align': 63.435}
[15 / 20] best valid accuracy: 63.841 at epoch 14 
 best_stats: {'best_valid_epoch': 14, 'best_valid_valid/acc': 68.342, 'best_valid_valid/acc_unbiased': 63.841, 'best_valid_valid/diff': 6.363, 'best_valid_valid/acc_skew': 61.764, 'best_valid_valid/acc_align': 65.919, 'best_valid_test/acc': 68.665, 'best_valid_test/acc_unbiased': 61.306, 'best_valid_test/diff': 13.483, 'best_valid_test/acc_skew': 59.944, 'best_valid_test/acc_align': 62.667}
[15 / 20] best test accuracy: 61.521 at epoch 15 
 best_stats: {'best_test_epoch': 15, 'best_test_valid/acc': 68.563, 'best_test_valid/acc_unbiased': 63.784, 'best_test_valid/diff': 7.309, 'best_test_valid/acc_skew': 61.154, 'best_test_valid/acc_align': 66.414, 'best_test_test/acc': 68.753, 'best_test_test/acc_unbiased': 61.521, 'best_test_test/diff': 13.231, 'best_test_test/acc_skew': 59.607, 'best_test_test/acc_align': 63.435}
[16 / 20] Learning rate: 1e-05 weight: 0.01
[16 / 20] Loss: 4.324589076090377 CE Loss: 0.4466245923873326 Con Loss: 4.320122825925335
[16 / 20] tensor([[0.972, 0.807],
        [0.389, 0.285]]) {'epoch': 16, 'valid/acc': 69.092, 'valid/acc_unbiased': 64.419, 'valid/diff': 7.023, 'valid/acc_skew': 62.477, 'valid/acc_align': 66.361, 'test/acc': 68.621, 'test/acc_unbiased': 61.302, 'test/diff': 13.438, 'test/acc_skew': 59.776, 'test/acc_align': 62.829}
[16 / 20] best valid accuracy: 64.419 at epoch 16 
 best_stats: {'best_valid_epoch': 16, 'best_valid_valid/acc': 69.092, 'best_valid_valid/acc_unbiased': 64.419, 'best_valid_valid/diff': 7.023, 'best_valid_valid/acc_skew': 62.477, 'best_valid_valid/acc_align': 66.361, 'best_valid_test/acc': 68.621, 'best_valid_test/acc_unbiased': 61.302, 'best_valid_test/diff': 13.438, 'best_valid_test/acc_skew': 59.776, 'best_valid_test/acc_align': 62.829}
[16 / 20] best test accuracy: 61.521 at epoch 15 
 best_stats: {'best_test_epoch': 15, 'best_test_valid/acc': 68.563, 'best_test_valid/acc_unbiased': 63.784, 'best_test_valid/diff': 7.309, 'best_test_valid/acc_skew': 61.154, 'best_test_valid/acc_align': 66.414, 'best_test_test/acc': 68.753, 'best_test_test/acc_unbiased': 61.521, 'best_test_test/diff': 13.231, 'best_test_test/acc_skew': 59.607, 'best_test_test/acc_align': 63.435}
[17 / 20] Learning rate: 1e-05 weight: 0.01
[17 / 20] Loss: 4.242656846833738 CE Loss: 0.4505735408920601 Con Loss: 4.238151125049198
[17 / 20] tensor([[0.973, 0.801],
        [0.394, 0.297]]) {'epoch': 17, 'valid/acc': 68.651, 'valid/acc_unbiased': 63.977, 'valid/diff': 7.129, 'valid/acc_skew': 62.477, 'valid/acc_align': 65.477, 'test/acc': 68.929, 'test/acc_unbiased': 61.631, 'test/diff': 13.451, 'test/acc_skew': 59.78, 'test/acc_align': 63.482}
[17 / 20] best valid accuracy: 64.419 at epoch 16 
 best_stats: {'best_valid_epoch': 16, 'best_valid_valid/acc': 69.092, 'best_valid_valid/acc_unbiased': 64.419, 'best_valid_valid/diff': 7.023, 'best_valid_valid/acc_skew': 62.477, 'best_valid_valid/acc_align': 66.361, 'best_valid_test/acc': 68.621, 'best_valid_test/acc_unbiased': 61.302, 'best_valid_test/diff': 13.438, 'best_valid_test/acc_skew': 59.776, 'best_valid_test/acc_align': 62.829}
[17 / 20] best test accuracy: 61.631 at epoch 17 
 best_stats: {'best_test_epoch': 17, 'best_test_valid/acc': 68.651, 'best_test_valid/acc_unbiased': 63.977, 'best_test_valid/diff': 7.129, 'best_test_valid/acc_skew': 62.477, 'best_test_valid/acc_align': 65.477, 'best_test_test/acc': 68.929, 'best_test_test/acc_unbiased': 61.631, 'best_test_test/diff': 13.451, 'best_test_test/acc_skew': 59.78, 'best_test_test/acc_align': 63.482}
[18 / 20] Learning rate: 1e-05 weight: 0.01
[18 / 20] Loss: 4.325118884304765 CE Loss: 0.44601262714790524 Con Loss: 4.320658772860249
[18 / 20] tensor([[0.974, 0.801],
        [0.401, 0.297]]) {'epoch': 18, 'valid/acc': 68.915, 'valid/acc_unbiased': 64.136, 'valid/diff': 7.482, 'valid/acc_skew': 62.202, 'valid/acc_align': 66.069, 'test/acc': 69.238, 'test/acc_unbiased': 61.827, 'test/diff': 13.844, 'test/acc_skew': 60.126, 'test/acc_align': 63.529}
[18 / 20] best valid accuracy: 64.419 at epoch 16 
 best_stats: {'best_valid_epoch': 16, 'best_valid_valid/acc': 69.092, 'best_valid_valid/acc_unbiased': 64.419, 'best_valid_valid/diff': 7.023, 'best_valid_valid/acc_skew': 62.477, 'best_valid_valid/acc_align': 66.361, 'best_valid_test/acc': 68.621, 'best_valid_test/acc_unbiased': 61.302, 'best_valid_test/diff': 13.438, 'best_valid_test/acc_skew': 59.776, 'best_valid_test/acc_align': 62.829}
[18 / 20] best test accuracy: 61.827 at epoch 18 
 best_stats: {'best_test_epoch': 18, 'best_test_valid/acc': 68.915, 'best_test_valid/acc_unbiased': 64.136, 'best_test_valid/diff': 7.482, 'best_test_valid/acc_skew': 62.202, 'best_test_valid/acc_align': 66.069, 'best_test_test/acc': 69.238, 'best_test_test/acc_unbiased': 61.827, 'best_test_test/diff': 13.844, 'best_test_test/acc_skew': 60.126, 'best_test_test/acc_align': 63.529}
[19 / 20] Learning rate: 1e-05 weight: 0.01
[19 / 20] Loss: 4.316684432085067 CE Loss: 0.44141254681453684 Con Loss: 4.312270292669858
[19 / 20] tensor([[0.970, 0.773],
        [0.405, 0.339]]) {'epoch': 19, 'valid/acc': 69.577, 'valid/acc_unbiased': 64.656, 'valid/diff': 8.151, 'valid/acc_skew': 61.359, 'valid/acc_align': 67.953, 'test/acc': 69.282, 'test/acc_unbiased': 62.17, 'test/diff': 13.128, 'test/acc_skew': 58.879, 'test/acc_align': 65.462}
[19 / 20] best valid accuracy: 64.656 at epoch 19 
 best_stats: {'best_valid_epoch': 19, 'best_valid_valid/acc': 69.577, 'best_valid_valid/acc_unbiased': 64.656, 'best_valid_valid/diff': 8.151, 'best_valid_valid/acc_skew': 61.359, 'best_valid_valid/acc_align': 67.953, 'best_valid_test/acc': 69.282, 'best_valid_test/acc_unbiased': 62.17, 'best_valid_test/diff': 13.128, 'best_valid_test/acc_skew': 58.879, 'best_valid_test/acc_align': 65.462}
[19 / 20] best test accuracy: 62.170 at epoch 19 
 best_stats: {'best_test_epoch': 19, 'best_test_valid/acc': 69.577, 'best_test_valid/acc_unbiased': 64.656, 'best_test_valid/diff': 8.151, 'best_test_valid/acc_skew': 61.359, 'best_test_valid/acc_align': 67.953, 'best_test_test/acc': 69.282, 'best_test_test/acc_unbiased': 62.17, 'best_test_test/diff': 13.128, 'best_test_test/acc_skew': 58.879, 'best_test_test/acc_align': 65.462}
[20 / 20] Learning rate: 1e-05 weight: 0.01
[20 / 20] Loss: 4.3055350801017305 CE Loss: 0.4437326266273761 Con Loss: 4.301097772756082
[20 / 20] tensor([[0.967, 0.784],
        [0.418, 0.333]]) {'epoch': 20, 'valid/acc': 69.489, 'valid/acc_unbiased': 64.508, 'valid/diff': 8.35, 'valid/acc_skew': 61.359, 'valid/acc_align': 67.656, 'test/acc': 69.678, 'test/acc_unbiased': 62.549, 'test/diff': 13.356, 'test/acc_skew': 60.081, 'test/acc_align': 65.017}
[20 / 20] best valid accuracy: 64.656 at epoch 19 
 best_stats: {'best_valid_epoch': 19, 'best_valid_valid/acc': 69.577, 'best_valid_valid/acc_unbiased': 64.656, 'best_valid_valid/diff': 8.151, 'best_valid_valid/acc_skew': 61.359, 'best_valid_valid/acc_align': 67.953, 'best_valid_test/acc': 69.282, 'best_valid_test/acc_unbiased': 62.17, 'best_valid_test/diff': 13.128, 'best_valid_test/acc_skew': 58.879, 'best_valid_test/acc_align': 65.462}
[20 / 20] best test accuracy: 62.549 at epoch 20 
 best_stats: {'best_test_epoch': 20, 'best_test_valid/acc': 69.489, 'best_test_valid/acc_unbiased': 64.508, 'best_test_valid/diff': 8.35, 'best_test_valid/acc_skew': 61.359, 'best_test_valid/acc_align': 67.656, 'best_test_test/acc': 69.678, 'best_test_test/acc_unbiased': 62.549, 'best_test_test/diff': 13.356, 'best_test_test/acc_skew': 60.081, 'best_test_test/acc_align': 65.017}
Total training time: 0:17:13
