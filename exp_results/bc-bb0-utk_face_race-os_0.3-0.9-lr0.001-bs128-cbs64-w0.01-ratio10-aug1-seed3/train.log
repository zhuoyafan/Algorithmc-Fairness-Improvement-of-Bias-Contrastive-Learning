Log level set to: INFO
Set seed: 3
=======> Using Fixed Random Seed: 3 <========
save_path: exp_results/bc-bb0-utk_face_race-os_0.3-0.9-lr0.001-bs128-cbs64-w0.01-ratio10-aug1-seed3
get_utk_face - split: train, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_race-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [4407, 552]
Target 1: [440, 5529]
Binary Target 1
---------------------------
Target 0: [4407, 552]
Target 1: [440, 5529]
===================================
Normal Label Distribution: 
Target 0: [4407, 552]
Target 1: [440, 5529]
===================================
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [1658, 1658]
Target 1: [1658, 1658]
Binary Target 1
---------------------------
Target 0: [1658, 1658]
Target 1: [1658, 1658]
===================================
Normal Label Distribution: 
Target 0: [1658, 1658]
Target 1: [1658, 1658]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 6632, target_attr: gender, bias_attr: race bias_rate: 0.9
['[train] target_0-bias_0: 1658', '[train] target_0-bias_1: 1658', '[train] target_1-bias_0: 1658', '[train] target_1-bias_1: 1658']
confusion_matrix - 
 original: tensor([[1658., 1658.],
        [1658., 1658.]]), 
 normalized: tensor([[0.500, 0.500],
        [0.500, 0.500]]), 
 b|y: tensor([[0.500, 0.500],
        [0.500, 0.500]])
get_utk_face - split: train, aug: 1, given_y: True, ratio: 10
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_race-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [4407, 552]
Target 1: [440, 5529]
Binary Target 1
---------------------------
Target 0: [4407, 552]
Target 1: [440, 5529]
===================================
Normal Label Distribution: 
Target 0: [4407, 552]
Target 1: [440, 5529]
===================================
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [1658, 1658]
Target 1: [1658, 1658]
Binary Target 1
---------------------------
Target 0: [1658, 1658]
Target 1: [1658, 1658]
===================================
Normal Label Distribution: 
Target 0: [1658, 1658]
Target 1: [1658, 1658]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 6632, target_attr: gender, bias_attr: race bias_rate: 0.9
['[train] target_0-bias_0: 1658', '[train] target_0-bias_1: 1658', '[train] target_1-bias_0: 1658', '[train] target_1-bias_1: 1658']
get_utk_face - split: valid, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_race-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [583, 684]
Target 1: [457, 646]
Binary Target 1
---------------------------
Target 0: [583, 684]
Target 1: [457, 646]
===================================
Normal Label Distribution: 
Target 0: [583, 684]
Target 1: [457, 646]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 2370, target_attr: gender, bias_attr: race bias_rate: 0.9
['[valid] target_0-bias_0: 583', '[valid] target_0-bias_1: 684', '[valid] target_1-bias_0: 457', '[valid] target_1-bias_1: 646']
get_utk_face - split: test, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_race-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [558, 677]
Target 1: [462, 673]
Binary Target 1
---------------------------
Target 0: [558, 677]
Target 1: [462, 673]
===================================
Normal Label Distribution: 
Target 0: [558, 677]
Target 1: [462, 673]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 2370, target_attr: gender, bias_attr: race bias_rate: 0.9
['[test] target_0-bias_0: 558', '[test] target_0-bias_1: 677', '[test] target_1-bias_0: 462', '[test] target_1-bias_1: 673']
decay_epochs: [6, 13]
[1 / 20] Learning rate: 0.001 weight: 0.01
[1 / 20] Loss: 4.950394795513268 CE Loss: 0.6080332700392306 Con Loss: 4.9443144510681005
[1 / 20] tensor([[0.414, 0.396],
        [0.944, 0.944]]) {'epoch': 1, 'valid/acc': 66.287, 'valid/acc_unbiased': 68.124, 'valid/diff': 2.358, 'valid/acc_skew': 68.176, 'valid/acc_align': 68.073, 'test/acc': 66.245, 'test/acc_unbiased': 67.428, 'test/diff': 0.915, 'test/acc_skew': 67.885, 'test/acc_align': 66.97}
[1 / 20] best valid accuracy: 68.124 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 66.287, 'best_valid_valid/acc_unbiased': 68.124, 'best_valid_valid/diff': 2.358, 'best_valid_valid/acc_skew': 68.176, 'best_valid_valid/acc_align': 68.073, 'best_valid_test/acc': 66.245, 'best_valid_test/acc_unbiased': 67.428, 'best_valid_test/diff': 0.915, 'best_valid_test/acc_skew': 67.885, 'best_valid_test/acc_align': 66.97}
[1 / 20] best test accuracy: 67.428 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 66.287, 'best_test_valid/acc_unbiased': 68.124, 'best_test_valid/diff': 2.358, 'best_test_valid/acc_skew': 68.176, 'best_test_valid/acc_align': 68.073, 'best_test_test/acc': 66.245, 'best_test_test/acc_unbiased': 67.428, 'best_test_test/diff': 0.915, 'best_test_test/acc_skew': 67.885, 'best_test_test/acc_align': 66.97}
[2 / 20] Learning rate: 0.001 weight: 0.01
[2 / 20] Loss: 4.782338080849089 CE Loss: 0.4808388766534941 Con Loss: 4.777529692333483
[2 / 20] tensor([[0.801, 0.747],
        [0.820, 0.828]]) {'epoch': 2, 'valid/acc': 79.831, 'valid/acc_unbiased': 80.132, 'valid/diff': 3.676, 'valid/acc_skew': 81.97, 'valid/acc_align': 78.294, 'test/acc': 79.705, 'test/acc_unbiased': 79.912, 'test/diff': 3.048, 'test/acc_skew': 81.071, 'test/acc_align': 78.753}
[2 / 20] best valid accuracy: 80.132 at epoch 2 
 best_stats: {'best_valid_epoch': 2, 'best_valid_valid/acc': 79.831, 'best_valid_valid/acc_unbiased': 80.132, 'best_valid_valid/diff': 3.676, 'best_valid_valid/acc_skew': 81.97, 'best_valid_valid/acc_align': 78.294, 'best_valid_test/acc': 79.705, 'best_valid_test/acc_unbiased': 79.912, 'best_valid_test/diff': 3.048, 'best_valid_test/acc_skew': 81.071, 'best_valid_test/acc_align': 78.753}
[2 / 20] best test accuracy: 79.912 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 79.831, 'best_test_valid/acc_unbiased': 80.132, 'best_test_valid/diff': 3.676, 'best_test_valid/acc_skew': 81.97, 'best_test_valid/acc_align': 78.294, 'best_test_test/acc': 79.705, 'best_test_test/acc_unbiased': 79.912, 'best_test_test/diff': 3.048, 'best_test_test/acc_skew': 81.071, 'best_test_test/acc_align': 78.753}
[3 / 20] Learning rate: 0.001 weight: 0.01
[3 / 20] Loss: 4.752137066227967 CE Loss: 0.4320025765421307 Con Loss: 4.747817049268072
[3 / 20] tensor([[0.907, 0.880],
        [0.706, 0.706]]) {'epoch': 3, 'valid/acc': 81.477, 'valid/acc_unbiased': 81.007, 'valid/diff': 2.666, 'valid/acc_skew': 82.34, 'valid/acc_align': 79.674, 'test/acc': 80.295, 'test/acc_unbiased': 79.965, 'test/diff': 1.331, 'test/acc_skew': 80.622, 'test/acc_align': 79.307}
[3 / 20] best valid accuracy: 81.007 at epoch 3 
 best_stats: {'best_valid_epoch': 3, 'best_valid_valid/acc': 81.477, 'best_valid_valid/acc_unbiased': 81.007, 'best_valid_valid/diff': 2.666, 'best_valid_valid/acc_skew': 82.34, 'best_valid_valid/acc_align': 79.674, 'best_valid_test/acc': 80.295, 'best_valid_test/acc_unbiased': 79.965, 'best_valid_test/diff': 1.331, 'best_valid_test/acc_skew': 80.622, 'best_valid_test/acc_align': 79.307}
[3 / 20] best test accuracy: 79.965 at epoch 3 
 best_stats: {'best_test_epoch': 3, 'best_test_valid/acc': 81.477, 'best_test_valid/acc_unbiased': 81.007, 'best_test_valid/diff': 2.666, 'best_test_valid/acc_skew': 82.34, 'best_test_valid/acc_align': 79.674, 'best_test_test/acc': 80.295, 'best_test_test/acc_unbiased': 79.965, 'best_test_test/diff': 1.331, 'best_test_test/acc_skew': 80.622, 'best_test_test/acc_align': 79.307}
[4 / 20] Learning rate: 0.001 weight: 0.01
[4 / 20] Loss: 4.73945462545526 CE Loss: 0.42749723853190646 Con Loss: 4.735179631356307
[4 / 20] tensor([[0.830, 0.774],
        [0.833, 0.828]]) {'epoch': 4, 'valid/acc': 80.802, 'valid/acc_unbiased': 81.003, 'valid/diff': 1.858, 'valid/acc_skew': 81.932, 'valid/acc_align': 80.074, 'test/acc': 81.392, 'test/acc_unbiased': 81.618, 'test/diff': 3.072, 'test/acc_skew': 83.154, 'test/acc_align': 80.082}
[4 / 20] best valid accuracy: 81.007 at epoch 3 
 best_stats: {'best_valid_epoch': 3, 'best_valid_valid/acc': 81.477, 'best_valid_valid/acc_unbiased': 81.007, 'best_valid_valid/diff': 2.666, 'best_valid_valid/acc_skew': 82.34, 'best_valid_valid/acc_align': 79.674, 'best_valid_test/acc': 80.295, 'best_valid_test/acc_unbiased': 79.965, 'best_valid_test/diff': 1.331, 'best_valid_test/acc_skew': 80.622, 'best_valid_test/acc_align': 79.307}
[4 / 20] best test accuracy: 81.618 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 80.802, 'best_test_valid/acc_unbiased': 81.003, 'best_test_valid/diff': 1.858, 'best_test_valid/acc_skew': 81.932, 'best_test_valid/acc_align': 80.074, 'best_test_test/acc': 81.392, 'best_test_test/acc_unbiased': 81.618, 'best_test_test/diff': 3.072, 'best_test_test/acc_skew': 83.154, 'best_test_test/acc_align': 80.082}
[5 / 20] Learning rate: 0.001 weight: 0.01
[5 / 20] Loss: 4.717673207939893 CE Loss: 0.4175043453353449 Con Loss: 4.71349813394581
[5 / 20] tensor([[0.787, 0.740],
        [0.879, 0.892]]) {'epoch': 5, 'valid/acc': 82.11, 'valid/acc_unbiased': 82.743, 'valid/diff': 3.368, 'valid/acc_skew': 84.427, 'valid/acc_align': 81.059, 'test/acc': 82.11, 'test/acc_unbiased': 82.427, 'test/diff': 2.973, 'test/acc_skew': 83.276, 'test/acc_align': 81.578}
[5 / 20] best valid accuracy: 82.743 at epoch 5 
 best_stats: {'best_valid_epoch': 5, 'best_valid_valid/acc': 82.11, 'best_valid_valid/acc_unbiased': 82.743, 'best_valid_valid/diff': 3.368, 'best_valid_valid/acc_skew': 84.427, 'best_valid_valid/acc_align': 81.059, 'best_valid_test/acc': 82.11, 'best_valid_test/acc_unbiased': 82.427, 'best_valid_test/diff': 2.973, 'best_valid_test/acc_skew': 83.276, 'best_valid_test/acc_align': 81.578}
[5 / 20] best test accuracy: 82.427 at epoch 5 
 best_stats: {'best_test_epoch': 5, 'best_test_valid/acc': 82.11, 'best_test_valid/acc_unbiased': 82.743, 'best_test_valid/diff': 3.368, 'best_test_valid/acc_skew': 84.427, 'best_test_valid/acc_align': 81.059, 'best_test_test/acc': 82.11, 'best_test_test/acc_unbiased': 82.427, 'best_test_test/diff': 2.973, 'best_test_test/acc_skew': 83.276, 'best_test_test/acc_align': 81.578}
[6 / 20] Learning rate: 0.001 weight: 0.01
[6 / 20] Loss: 4.711978266408849 CE Loss: 0.4164895613029581 Con Loss: 4.707813343466838
[6 / 20] tensor([[0.645, 0.582],
        [0.942, 0.961]]) {'epoch': 6, 'valid/acc': 77.131, 'valid/acc_unbiased': 78.383, 'valid/diff': 1.34, 'valid/acc_skew': 79.053, 'valid/acc_align': 77.713, 'test/acc': 77.468, 'test/acc_unbiased': 78.252, 'test/diff': 4.15, 'test/acc_skew': 79.336, 'test/acc_align': 77.167}
[6 / 20] best valid accuracy: 82.743 at epoch 5 
 best_stats: {'best_valid_epoch': 5, 'best_valid_valid/acc': 82.11, 'best_valid_valid/acc_unbiased': 82.743, 'best_valid_valid/diff': 3.368, 'best_valid_valid/acc_skew': 84.427, 'best_valid_valid/acc_align': 81.059, 'best_valid_test/acc': 82.11, 'best_valid_test/acc_unbiased': 82.427, 'best_valid_test/diff': 2.973, 'best_valid_test/acc_skew': 83.276, 'best_valid_test/acc_align': 81.578}
[6 / 20] best test accuracy: 82.427 at epoch 5 
 best_stats: {'best_test_epoch': 5, 'best_test_valid/acc': 82.11, 'best_test_valid/acc_unbiased': 82.743, 'best_test_valid/diff': 3.368, 'best_test_valid/acc_skew': 84.427, 'best_test_valid/acc_align': 81.059, 'best_test_test/acc': 82.11, 'best_test_test/acc_unbiased': 82.427, 'best_test_test/diff': 2.973, 'best_test_test/acc_skew': 83.276, 'best_test_test/acc_align': 81.578}
[7 / 20] Learning rate: 0.0001 weight: 0.01
[7 / 20] Loss: 4.661208913754784 CE Loss: 0.37819157628875016 Con Loss: 4.6574270135674745
[7 / 20] tensor([[0.862, 0.848],
        [0.814, 0.826]]) {'epoch': 7, 'valid/acc': 84.008, 'valid/acc_unbiased': 84.046, 'valid/diff': 3.661, 'valid/acc_skew': 85.877, 'valid/acc_align': 82.215, 'test/acc': 83.84, 'test/acc_unbiased': 83.747, 'test/diff': 1.322, 'test/acc_skew': 83.793, 'test/acc_align': 83.7}
[7 / 20] best valid accuracy: 84.046 at epoch 7 
 best_stats: {'best_valid_epoch': 7, 'best_valid_valid/acc': 84.008, 'best_valid_valid/acc_unbiased': 84.046, 'best_valid_valid/diff': 3.661, 'best_valid_valid/acc_skew': 85.877, 'best_valid_valid/acc_align': 82.215, 'best_valid_test/acc': 83.84, 'best_valid_test/acc_unbiased': 83.747, 'best_valid_test/diff': 1.322, 'best_valid_test/acc_skew': 83.793, 'best_valid_test/acc_align': 83.7}
[7 / 20] best test accuracy: 83.747 at epoch 7 
 best_stats: {'best_test_epoch': 7, 'best_test_valid/acc': 84.008, 'best_test_valid/acc_unbiased': 84.046, 'best_test_valid/diff': 3.661, 'best_test_valid/acc_skew': 85.877, 'best_test_valid/acc_align': 82.215, 'best_test_test/acc': 83.84, 'best_test_test/acc_unbiased': 83.747, 'best_test_test/diff': 1.322, 'best_test_test/acc_skew': 83.793, 'best_test_test/acc_align': 83.7}
[8 / 20] Learning rate: 0.0001 weight: 0.01
[8 / 20] Loss: 4.62302756338269 CE Loss: 0.3468585803080238 Con Loss: 4.619558967065753
[8 / 20] tensor([[0.857, 0.838],
        [0.827, 0.857]]) {'epoch': 8, 'valid/acc': 84.219, 'valid/acc_unbiased': 84.352, 'valid/diff': 3.208, 'valid/acc_skew': 85.956, 'valid/acc_align': 82.749, 'test/acc': 84.557, 'test/acc_unbiased': 84.459, 'test/diff': 2.481, 'test/acc_skew': 84.174, 'test/acc_align': 84.744}
[8 / 20] best valid accuracy: 84.352 at epoch 8 
 best_stats: {'best_valid_epoch': 8, 'best_valid_valid/acc': 84.219, 'best_valid_valid/acc_unbiased': 84.352, 'best_valid_valid/diff': 3.208, 'best_valid_valid/acc_skew': 85.956, 'best_valid_valid/acc_align': 82.749, 'best_valid_test/acc': 84.557, 'best_valid_test/acc_unbiased': 84.459, 'best_valid_test/diff': 2.481, 'best_valid_test/acc_skew': 84.174, 'best_valid_test/acc_align': 84.744}
[8 / 20] best test accuracy: 84.459 at epoch 8 
 best_stats: {'best_test_epoch': 8, 'best_test_valid/acc': 84.219, 'best_test_valid/acc_unbiased': 84.352, 'best_test_valid/diff': 3.208, 'best_test_valid/acc_skew': 85.956, 'best_test_valid/acc_align': 82.749, 'best_test_test/acc': 84.557, 'best_test_test/acc_unbiased': 84.459, 'best_test_test/diff': 2.481, 'best_test_test/acc_skew': 84.174, 'best_test_test/acc_align': 84.744}
[9 / 20] Learning rate: 0.0001 weight: 0.01
[9 / 20] Loss: 4.6367757421063285 CE Loss: 0.3327537797688 Con Loss: 4.633448225166312
[9 / 20] tensor([[0.848, 0.839],
        [0.855, 0.871]]) {'epoch': 9, 'valid/acc': 85.105, 'valid/acc_unbiased': 85.341, 'valid/diff': 2.484, 'valid/acc_skew': 86.583, 'valid/acc_align': 84.099, 'test/acc': 85.316, 'test/acc_unbiased': 85.309, 'test/diff': 1.221, 'test/acc_skew': 85.132, 'test/acc_align': 85.486}
[9 / 20] best valid accuracy: 85.341 at epoch 9 
 best_stats: {'best_valid_epoch': 9, 'best_valid_valid/acc': 85.105, 'best_valid_valid/acc_unbiased': 85.341, 'best_valid_valid/diff': 2.484, 'best_valid_valid/acc_skew': 86.583, 'best_valid_valid/acc_align': 84.099, 'best_valid_test/acc': 85.316, 'best_valid_test/acc_unbiased': 85.309, 'best_valid_test/diff': 1.221, 'best_valid_test/acc_skew': 85.132, 'best_valid_test/acc_align': 85.486}
[9 / 20] best test accuracy: 85.309 at epoch 9 
 best_stats: {'best_test_epoch': 9, 'best_test_valid/acc': 85.105, 'best_test_valid/acc_unbiased': 85.341, 'best_test_valid/diff': 2.484, 'best_test_valid/acc_skew': 86.583, 'best_test_valid/acc_align': 84.099, 'best_test_test/acc': 85.316, 'best_test_test/acc_unbiased': 85.309, 'best_test_test/diff': 1.221, 'best_test_test/acc_skew': 85.132, 'best_test_test/acc_align': 85.486}
[10 / 20] Learning rate: 0.0001 weight: 0.01
[10 / 20] Loss: 4.6028958114697645 CE Loss: 0.3266072740241328 Con Loss: 4.599629736924488
[10 / 20] tensor([[0.821, 0.778],
        [0.861, 0.884]]) {'epoch': 10, 'valid/acc': 84.979, 'valid/acc_unbiased': 85.312, 'valid/diff': 2.264, 'valid/acc_skew': 86.444, 'valid/acc_align': 84.18, 'test/acc': 83.46, 'test/acc_unbiased': 83.62, 'test/diff': 3.249, 'test/acc_skew': 84.113, 'test/acc_align': 83.127}
[10 / 20] best valid accuracy: 85.341 at epoch 9 
 best_stats: {'best_valid_epoch': 9, 'best_valid_valid/acc': 85.105, 'best_valid_valid/acc_unbiased': 85.341, 'best_valid_valid/diff': 2.484, 'best_valid_valid/acc_skew': 86.583, 'best_valid_valid/acc_align': 84.099, 'best_valid_test/acc': 85.316, 'best_valid_test/acc_unbiased': 85.309, 'best_valid_test/diff': 1.221, 'best_valid_test/acc_skew': 85.132, 'best_valid_test/acc_align': 85.486}
[10 / 20] best test accuracy: 85.309 at epoch 9 
 best_stats: {'best_test_epoch': 9, 'best_test_valid/acc': 85.105, 'best_test_valid/acc_unbiased': 85.341, 'best_test_valid/diff': 2.484, 'best_test_valid/acc_skew': 86.583, 'best_test_valid/acc_align': 84.099, 'best_test_test/acc': 85.316, 'best_test_test/acc_unbiased': 85.309, 'best_test_test/diff': 1.221, 'best_test_test/acc_skew': 85.132, 'best_test_test/acc_align': 85.486}
[11 / 20] Learning rate: 0.0001 weight: 0.01
[11 / 20] Loss: 4.590818659963021 CE Loss: 0.3329133883172554 Con Loss: 4.587489526148153
[11 / 20] tensor([[0.884, 0.873],
        [0.816, 0.834]]) {'epoch': 11, 'valid/acc': 85.527, 'valid/acc_unbiased': 85.409, 'valid/diff': 1.847, 'valid/acc_skew': 86.125, 'valid/acc_align': 84.692, 'test/acc': 85.316, 'test/acc_unbiased': 85.152, 'test/diff': 1.405, 'test/acc_skew': 84.976, 'test/acc_align': 85.327}
[11 / 20] best valid accuracy: 85.409 at epoch 11 
 best_stats: {'best_valid_epoch': 11, 'best_valid_valid/acc': 85.527, 'best_valid_valid/acc_unbiased': 85.409, 'best_valid_valid/diff': 1.847, 'best_valid_valid/acc_skew': 86.125, 'best_valid_valid/acc_align': 84.692, 'best_valid_test/acc': 85.316, 'best_valid_test/acc_unbiased': 85.152, 'best_valid_test/diff': 1.405, 'best_valid_test/acc_skew': 84.976, 'best_valid_test/acc_align': 85.327}
[11 / 20] best test accuracy: 85.309 at epoch 9 
 best_stats: {'best_test_epoch': 9, 'best_test_valid/acc': 85.105, 'best_test_valid/acc_unbiased': 85.341, 'best_test_valid/diff': 2.484, 'best_test_valid/acc_skew': 86.583, 'best_test_valid/acc_align': 84.099, 'best_test_test/acc': 85.316, 'best_test_test/acc_unbiased': 85.309, 'best_test_test/diff': 1.221, 'best_test_test/acc_skew': 85.132, 'best_test_test/acc_align': 85.486}
[12 / 20] Learning rate: 0.0001 weight: 0.01
[12 / 20] Loss: 4.599531741424118 CE Loss: 0.31832719604126364 Con Loss: 4.5963484680120565
[12 / 20] tensor([[0.864, 0.836],
        [0.842, 0.854]]) {'epoch': 12, 'valid/acc': 85.063, 'valid/acc_unbiased': 85.132, 'valid/diff': 1.525, 'valid/acc_skew': 85.894, 'valid/acc_align': 84.37, 'test/acc': 84.895, 'test/acc_unbiased': 84.905, 'test/diff': 2.007, 'test/acc_skew': 85.29, 'test/acc_align': 84.521}
[12 / 20] best valid accuracy: 85.409 at epoch 11 
 best_stats: {'best_valid_epoch': 11, 'best_valid_valid/acc': 85.527, 'best_valid_valid/acc_unbiased': 85.409, 'best_valid_valid/diff': 1.847, 'best_valid_valid/acc_skew': 86.125, 'best_valid_valid/acc_align': 84.692, 'best_valid_test/acc': 85.316, 'best_valid_test/acc_unbiased': 85.152, 'best_valid_test/diff': 1.405, 'best_valid_test/acc_skew': 84.976, 'best_valid_test/acc_align': 85.327}
[12 / 20] best test accuracy: 85.309 at epoch 9 
 best_stats: {'best_test_epoch': 9, 'best_test_valid/acc': 85.105, 'best_test_valid/acc_unbiased': 85.341, 'best_test_valid/diff': 2.484, 'best_test_valid/acc_skew': 86.583, 'best_test_valid/acc_align': 84.099, 'best_test_test/acc': 85.316, 'best_test_test/acc_unbiased': 85.309, 'best_test_test/diff': 1.221, 'best_test_test/acc_skew': 85.132, 'best_test_test/acc_align': 85.486}
[13 / 20] Learning rate: 0.0001 weight: 0.01
[13 / 20] Loss: 4.566430164907752 CE Loss: 0.30625353737389366 Con Loss: 4.56336764461025
[13 / 20] tensor([[0.844, 0.814],
        [0.855, 0.875]]) {'epoch': 13, 'valid/acc': 85.021, 'valid/acc_unbiased': 85.14, 'valid/diff': 2.121, 'valid/acc_skew': 85.622, 'valid/acc_align': 84.658, 'test/acc': 84.641, 'test/acc_unbiased': 84.703, 'test/diff': 2.52, 'test/acc_skew': 84.953, 'test/acc_align': 84.454}
[13 / 20] best valid accuracy: 85.409 at epoch 11 
 best_stats: {'best_valid_epoch': 11, 'best_valid_valid/acc': 85.527, 'best_valid_valid/acc_unbiased': 85.409, 'best_valid_valid/diff': 1.847, 'best_valid_valid/acc_skew': 86.125, 'best_valid_valid/acc_align': 84.692, 'best_valid_test/acc': 85.316, 'best_valid_test/acc_unbiased': 85.152, 'best_valid_test/diff': 1.405, 'best_valid_test/acc_skew': 84.976, 'best_valid_test/acc_align': 85.327}
[13 / 20] best test accuracy: 85.309 at epoch 9 
 best_stats: {'best_test_epoch': 9, 'best_test_valid/acc': 85.105, 'best_test_valid/acc_unbiased': 85.341, 'best_test_valid/diff': 2.484, 'best_test_valid/acc_skew': 86.583, 'best_test_valid/acc_align': 84.099, 'best_test_test/acc': 85.316, 'best_test_test/acc_unbiased': 85.309, 'best_test_test/diff': 1.221, 'best_test_test/acc_skew': 85.132, 'best_test_test/acc_align': 85.486}
[14 / 20] Learning rate: 1e-05 weight: 0.01
[14 / 20] Loss: 4.5641829884095415 CE Loss: 0.30643603640672523 Con Loss: 4.561118643591573
[14 / 20] tensor([[0.853, 0.836],
        [0.840, 0.859]]) {'epoch': 14, 'valid/acc': 85.527, 'valid/acc_unbiased': 85.523, 'valid/diff': 1.642, 'valid/acc_skew': 85.761, 'valid/acc_align': 85.286, 'test/acc': 84.726, 'test/acc_unbiased': 84.694, 'test/diff': 1.801, 'test/acc_skew': 84.644, 'test/acc_align': 84.744}
[14 / 20] best valid accuracy: 85.523 at epoch 14 
 best_stats: {'best_valid_epoch': 14, 'best_valid_valid/acc': 85.527, 'best_valid_valid/acc_unbiased': 85.523, 'best_valid_valid/diff': 1.642, 'best_valid_valid/acc_skew': 85.761, 'best_valid_valid/acc_align': 85.286, 'best_valid_test/acc': 84.726, 'best_valid_test/acc_unbiased': 84.694, 'best_valid_test/diff': 1.801, 'best_valid_test/acc_skew': 84.644, 'best_valid_test/acc_align': 84.744}
[14 / 20] best test accuracy: 85.309 at epoch 9 
 best_stats: {'best_test_epoch': 9, 'best_test_valid/acc': 85.105, 'best_test_valid/acc_unbiased': 85.341, 'best_test_valid/diff': 2.484, 'best_test_valid/acc_skew': 86.583, 'best_test_valid/acc_align': 84.099, 'best_test_test/acc': 85.316, 'best_test_test/acc_unbiased': 85.309, 'best_test_test/diff': 1.221, 'best_test_test/acc_skew': 85.132, 'best_test_test/acc_align': 85.486}
[15 / 20] Learning rate: 1e-05 weight: 0.01
[15 / 20] Loss: 4.554929362850396 CE Loss: 0.3124001151618106 Con Loss: 4.5518053696727865
[15 / 20] tensor([[0.857, 0.839],
        [0.840, 0.854]]) {'epoch': 15, 'valid/acc': 85.612, 'valid/acc_unbiased': 85.649, 'valid/diff': 0.361, 'valid/acc_skew': 85.794, 'valid/acc_align': 85.505, 'test/acc': 84.768, 'test/acc_unbiased': 84.746, 'test/diff': 1.61, 'test/acc_skew': 84.823, 'test/acc_align': 84.669}
[15 / 20] best valid accuracy: 85.649 at epoch 15 
 best_stats: {'best_valid_epoch': 15, 'best_valid_valid/acc': 85.612, 'best_valid_valid/acc_unbiased': 85.649, 'best_valid_valid/diff': 0.361, 'best_valid_valid/acc_skew': 85.794, 'best_valid_valid/acc_align': 85.505, 'best_valid_test/acc': 84.768, 'best_valid_test/acc_unbiased': 84.746, 'best_valid_test/diff': 1.61, 'best_valid_test/acc_skew': 84.823, 'best_valid_test/acc_align': 84.669}
[15 / 20] best test accuracy: 85.309 at epoch 9 
 best_stats: {'best_test_epoch': 9, 'best_test_valid/acc': 85.105, 'best_test_valid/acc_unbiased': 85.341, 'best_test_valid/diff': 2.484, 'best_test_valid/acc_skew': 86.583, 'best_test_valid/acc_align': 84.099, 'best_test_test/acc': 85.316, 'best_test_test/acc_unbiased': 85.309, 'best_test_test/diff': 1.221, 'best_test_test/acc_skew': 85.132, 'best_test_test/acc_align': 85.486}
[16 / 20] Learning rate: 1e-05 weight: 0.01
[16 / 20] Loss: 4.56816783601326 CE Loss: 0.30535131401693577 Con Loss: 4.565114339959636
[16 / 20] tensor([[0.855, 0.830],
        [0.851, 0.865]]) {'epoch': 16, 'valid/acc': 85.823, 'valid/acc_unbiased': 85.92, 'valid/diff': 0.795, 'valid/acc_skew': 86.317, 'valid/acc_align': 85.522, 'test/acc': 84.979, 'test/acc_unbiased': 85.01, 'test/diff': 1.942, 'test/acc_skew': 85.274, 'test/acc_align': 84.746}
[16 / 20] best valid accuracy: 85.920 at epoch 16 
 best_stats: {'best_valid_epoch': 16, 'best_valid_valid/acc': 85.823, 'best_valid_valid/acc_unbiased': 85.92, 'best_valid_valid/diff': 0.795, 'best_valid_valid/acc_skew': 86.317, 'best_valid_valid/acc_align': 85.522, 'best_valid_test/acc': 84.979, 'best_valid_test/acc_unbiased': 85.01, 'best_valid_test/diff': 1.942, 'best_valid_test/acc_skew': 85.274, 'best_valid_test/acc_align': 84.746}
[16 / 20] best test accuracy: 85.309 at epoch 9 
 best_stats: {'best_test_epoch': 9, 'best_test_valid/acc': 85.105, 'best_test_valid/acc_unbiased': 85.341, 'best_test_valid/diff': 2.484, 'best_test_valid/acc_skew': 86.583, 'best_test_valid/acc_align': 84.099, 'best_test_test/acc': 85.316, 'best_test_test/acc_unbiased': 85.309, 'best_test_test/diff': 1.221, 'best_test_test/acc_skew': 85.132, 'best_test_test/acc_align': 85.486}
[17 / 20] Learning rate: 1e-05 weight: 0.01
[17 / 20] Loss: 4.560794791208965 CE Loss: 0.2967274348252645 Con Loss: 4.557827531931915
[17 / 20] tensor([[0.860, 0.843],
        [0.842, 0.851]]) {'epoch': 17, 'valid/acc': 85.738, 'valid/acc_unbiased': 85.796, 'valid/diff': 1.072, 'valid/acc_skew': 86.332, 'valid/acc_align': 85.26, 'test/acc': 84.937, 'test/acc_unbiased': 84.926, 'test/diff': 1.31, 'test/acc_skew': 85.11, 'test/acc_align': 84.742}
[17 / 20] best valid accuracy: 85.920 at epoch 16 
 best_stats: {'best_valid_epoch': 16, 'best_valid_valid/acc': 85.823, 'best_valid_valid/acc_unbiased': 85.92, 'best_valid_valid/diff': 0.795, 'best_valid_valid/acc_skew': 86.317, 'best_valid_valid/acc_align': 85.522, 'best_valid_test/acc': 84.979, 'best_valid_test/acc_unbiased': 85.01, 'best_valid_test/diff': 1.942, 'best_valid_test/acc_skew': 85.274, 'best_valid_test/acc_align': 84.746}
[17 / 20] best test accuracy: 85.309 at epoch 9 
 best_stats: {'best_test_epoch': 9, 'best_test_valid/acc': 85.105, 'best_test_valid/acc_unbiased': 85.341, 'best_test_valid/diff': 2.484, 'best_test_valid/acc_skew': 86.583, 'best_test_valid/acc_align': 84.099, 'best_test_test/acc': 85.316, 'best_test_test/acc_unbiased': 85.309, 'best_test_test/diff': 1.221, 'best_test_test/acc_skew': 85.132, 'best_test_test/acc_align': 85.486}
[18 / 20] Learning rate: 1e-05 weight: 0.01
[18 / 20] Loss: 4.551747568266239 CE Loss: 0.30143068279662094 Con Loss: 4.548733267766862
[18 / 20] tensor([[0.853, 0.824],
        [0.846, 0.862]]) {'epoch': 18, 'valid/acc': 85.696, 'valid/acc_unbiased': 85.813, 'valid/diff': 1.055, 'valid/acc_skew': 86.341, 'valid/acc_align': 85.286, 'test/acc': 84.599, 'test/acc_unbiased': 84.635, 'test/diff': 2.216, 'test/acc_skew': 84.968, 'test/acc_align': 84.302}
[18 / 20] best valid accuracy: 85.920 at epoch 16 
 best_stats: {'best_valid_epoch': 16, 'best_valid_valid/acc': 85.823, 'best_valid_valid/acc_unbiased': 85.92, 'best_valid_valid/diff': 0.795, 'best_valid_valid/acc_skew': 86.317, 'best_valid_valid/acc_align': 85.522, 'best_valid_test/acc': 84.979, 'best_valid_test/acc_unbiased': 85.01, 'best_valid_test/diff': 1.942, 'best_valid_test/acc_skew': 85.274, 'best_valid_test/acc_align': 84.746}
[18 / 20] best test accuracy: 85.309 at epoch 9 
 best_stats: {'best_test_epoch': 9, 'best_test_valid/acc': 85.105, 'best_test_valid/acc_unbiased': 85.341, 'best_test_valid/diff': 2.484, 'best_test_valid/acc_skew': 86.583, 'best_test_valid/acc_align': 84.099, 'best_test_test/acc': 85.316, 'best_test_test/acc_unbiased': 85.309, 'best_test_test/diff': 1.221, 'best_test_test/acc_skew': 85.132, 'best_test_test/acc_align': 85.486}
[19 / 20] Learning rate: 1e-05 weight: 0.01
[19 / 20] Loss: 4.571396898446814 CE Loss: 0.30137467790570277 Con Loss: 4.568383129428178
[19 / 20] tensor([[0.851, 0.830],
        [0.851, 0.862]]) {'epoch': 19, 'valid/acc': 85.823, 'valid/acc_unbiased': 85.927, 'valid/diff': 0.827, 'valid/acc_skew': 86.341, 'valid/acc_align': 85.513, 'test/acc': 84.81, 'test/acc_unbiased': 84.846, 'test/diff': 1.614, 'test/acc_skew': 85.095, 'test/acc_align': 84.597}
[19 / 20] best valid accuracy: 85.927 at epoch 19 
 best_stats: {'best_valid_epoch': 19, 'best_valid_valid/acc': 85.823, 'best_valid_valid/acc_unbiased': 85.927, 'best_valid_valid/diff': 0.827, 'best_valid_valid/acc_skew': 86.341, 'best_valid_valid/acc_align': 85.513, 'best_valid_test/acc': 84.81, 'best_valid_test/acc_unbiased': 84.846, 'best_valid_test/diff': 1.614, 'best_valid_test/acc_skew': 85.095, 'best_valid_test/acc_align': 84.597}
[19 / 20] best test accuracy: 85.309 at epoch 9 
 best_stats: {'best_test_epoch': 9, 'best_test_valid/acc': 85.105, 'best_test_valid/acc_unbiased': 85.341, 'best_test_valid/diff': 2.484, 'best_test_valid/acc_skew': 86.583, 'best_test_valid/acc_align': 84.099, 'best_test_test/acc': 85.316, 'best_test_test/acc_unbiased': 85.309, 'best_test_test/diff': 1.221, 'best_test_test/acc_skew': 85.132, 'best_test_test/acc_align': 85.486}
[20 / 20] Learning rate: 1e-05 weight: 0.01
[20 / 20] Loss: 4.553285473362241 CE Loss: 0.3089293197282692 Con Loss: 4.550196192664318
[20 / 20] tensor([[0.849, 0.814],
        [0.859, 0.875]]) {'epoch': 20, 'valid/acc': 85.823, 'valid/acc_unbiased': 86.014, 'valid/diff': 1.233, 'valid/acc_skew': 86.63, 'valid/acc_align': 85.397, 'test/acc': 84.852, 'test/acc_unbiased': 84.946, 'test/diff': 2.573, 'test/acc_skew': 85.438, 'test/acc_align': 84.454}
[20 / 20] best valid accuracy: 86.014 at epoch 20 
 best_stats: {'best_valid_epoch': 20, 'best_valid_valid/acc': 85.823, 'best_valid_valid/acc_unbiased': 86.014, 'best_valid_valid/diff': 1.233, 'best_valid_valid/acc_skew': 86.63, 'best_valid_valid/acc_align': 85.397, 'best_valid_test/acc': 84.852, 'best_valid_test/acc_unbiased': 84.946, 'best_valid_test/diff': 2.573, 'best_valid_test/acc_skew': 85.438, 'best_valid_test/acc_align': 84.454}
[20 / 20] best test accuracy: 85.309 at epoch 9 
 best_stats: {'best_test_epoch': 9, 'best_test_valid/acc': 85.105, 'best_test_valid/acc_unbiased': 85.341, 'best_test_valid/diff': 2.484, 'best_test_valid/acc_skew': 86.583, 'best_test_valid/acc_align': 84.099, 'best_test_test/acc': 85.316, 'best_test_test/acc_unbiased': 85.309, 'best_test_test/diff': 1.221, 'best_test_test/acc_skew': 85.132, 'best_test_test/acc_align': 85.486}
Total training time: 0:21:32
