Log level set to: INFO
Set seed: 2
=======> Using Fixed Random Seed: 2 <========
save_path: exp_results/bc-bb0-utk_face_race-os_0.9-0.9-lr0.001-bs128-cbs64-w0.01-ratio10-aug1-seed2
get_utk_face - split: train, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_race-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [4407, 552]
Target 1: [440, 5529]
Binary Target 1
---------------------------
Target 0: [4407, 552]
Target 1: [440, 5529]
===================================
Normal Label Distribution: 
Target 0: [4407, 552]
Target 1: [440, 5529]
===================================
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [4976, 4976]
Target 1: [4976, 4976]
Binary Target 1
---------------------------
Target 0: [4976, 4976]
Target 1: [4976, 4976]
===================================
Normal Label Distribution: 
Target 0: [4976, 4976]
Target 1: [4976, 4976]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 19904, target_attr: gender, bias_attr: race bias_rate: 0.9
['[train] target_0-bias_0: 4976', '[train] target_0-bias_1: 4976', '[train] target_1-bias_0: 4976', '[train] target_1-bias_1: 4976']
confusion_matrix - 
 original: tensor([[4976., 4976.],
        [4976., 4976.]]), 
 normalized: tensor([[0.500, 0.500],
        [0.500, 0.500]]), 
 b|y: tensor([[0.500, 0.500],
        [0.500, 0.500]])
get_utk_face - split: train, aug: 1, given_y: True, ratio: 10
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_race-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [4407, 552]
Target 1: [440, 5529]
Binary Target 1
---------------------------
Target 0: [4407, 552]
Target 1: [440, 5529]
===================================
Normal Label Distribution: 
Target 0: [4407, 552]
Target 1: [440, 5529]
===================================
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [4976, 4976]
Target 1: [4976, 4976]
Binary Target 1
---------------------------
Target 0: [4976, 4976]
Target 1: [4976, 4976]
===================================
Normal Label Distribution: 
Target 0: [4976, 4976]
Target 1: [4976, 4976]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 19904, target_attr: gender, bias_attr: race bias_rate: 0.9
['[train] target_0-bias_0: 4976', '[train] target_0-bias_1: 4976', '[train] target_1-bias_0: 4976', '[train] target_1-bias_1: 4976']
get_utk_face - split: valid, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_race-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [583, 684]
Target 1: [457, 646]
Binary Target 1
---------------------------
Target 0: [583, 684]
Target 1: [457, 646]
===================================
Normal Label Distribution: 
Target 0: [583, 684]
Target 1: [457, 646]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 2370, target_attr: gender, bias_attr: race bias_rate: 0.9
['[valid] target_0-bias_0: 583', '[valid] target_0-bias_1: 684', '[valid] target_1-bias_0: 457', '[valid] target_1-bias_1: 646']
get_utk_face - split: test, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_race-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [558, 677]
Target 1: [462, 673]
Binary Target 1
---------------------------
Target 0: [558, 677]
Target 1: [462, 673]
===================================
Normal Label Distribution: 
Target 0: [558, 677]
Target 1: [462, 673]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 2370, target_attr: gender, bias_attr: race bias_rate: 0.9
['[test] target_0-bias_0: 558', '[test] target_0-bias_1: 677', '[test] target_1-bias_0: 462', '[test] target_1-bias_1: 673']
decay_epochs: [6, 13]
[1 / 20] Learning rate: 0.001 weight: 0.01
[1 / 20] Loss: 4.827045848515256 CE Loss: 0.5160517493244919 Con Loss: 4.821885355799145
[1 / 20] tensor([[0.921, 0.885],
        [0.662, 0.697]]) {'epoch': 1, 'valid/acc': 80.127, 'valid/acc_unbiased': 79.426, 'valid/diff': 2.386, 'valid/acc_skew': 80.619, 'valid/acc_align': 78.234, 'test/acc': 79.662, 'test/acc_unbiased': 79.129, 'test/diff': 3.545, 'test/acc_skew': 79.174, 'test/acc_align': 79.083}
[1 / 20] best valid accuracy: 79.426 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 80.127, 'best_valid_valid/acc_unbiased': 79.426, 'best_valid_valid/diff': 2.386, 'best_valid_valid/acc_skew': 80.619, 'best_valid_valid/acc_align': 78.234, 'best_valid_test/acc': 79.662, 'best_valid_test/acc_unbiased': 79.129, 'best_valid_test/diff': 3.545, 'best_valid_test/acc_skew': 79.174, 'best_valid_test/acc_align': 79.083}
[1 / 20] best test accuracy: 79.129 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 80.127, 'best_test_valid/acc_unbiased': 79.426, 'best_test_valid/diff': 2.386, 'best_test_valid/acc_skew': 80.619, 'best_test_valid/acc_align': 78.234, 'best_test_test/acc': 79.662, 'best_test_test/acc_unbiased': 79.129, 'best_test_test/diff': 3.545, 'best_test_test/acc_skew': 79.174, 'best_test_test/acc_align': 79.083}
[2 / 20] Learning rate: 0.001 weight: 0.01
[2 / 20] Loss: 4.715084959073082 CE Loss: 0.40816801518106 Con Loss: 4.711003272863063
[2 / 20] tensor([[0.803, 0.730],
        [0.844, 0.886]]) {'epoch': 2, 'valid/acc': 82.489, 'valid/acc_unbiased': 82.728, 'valid/diff': 3.435, 'valid/acc_skew': 82.487, 'valid/acc_align': 82.968, 'test/acc': 81.35, 'test/acc_unbiased': 81.558, 'test/diff': 5.73, 'test/acc_skew': 82.351, 'test/acc_align': 80.764}
[2 / 20] best valid accuracy: 82.728 at epoch 2 
 best_stats: {'best_valid_epoch': 2, 'best_valid_valid/acc': 82.489, 'best_valid_valid/acc_unbiased': 82.728, 'best_valid_valid/diff': 3.435, 'best_valid_valid/acc_skew': 82.487, 'best_valid_valid/acc_align': 82.968, 'best_valid_test/acc': 81.35, 'best_valid_test/acc_unbiased': 81.558, 'best_valid_test/diff': 5.73, 'best_valid_test/acc_skew': 82.351, 'best_valid_test/acc_align': 80.764}
[2 / 20] best test accuracy: 81.558 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 82.489, 'best_test_valid/acc_unbiased': 82.728, 'best_test_valid/diff': 3.435, 'best_test_valid/acc_skew': 82.487, 'best_test_valid/acc_align': 82.968, 'best_test_test/acc': 81.35, 'best_test_test/acc_unbiased': 81.558, 'best_test_test/diff': 5.73, 'best_test_test/acc_skew': 82.351, 'best_test_test/acc_align': 80.764}
[3 / 20] Learning rate: 0.001 weight: 0.01
[3 / 20] Loss: 4.681499688188363 CE Loss: 0.37088782955979227 Con Loss: 4.677790808907659
[3 / 20] tensor([[0.916, 0.849],
        [0.742, 0.808]]) {'epoch': 3, 'valid/acc': 84.515, 'valid/acc_unbiased': 84.153, 'valid/diff': 2.906, 'valid/acc_skew': 84.895, 'valid/acc_align': 83.411, 'test/acc': 83.249, 'test/acc_unbiased': 82.896, 'test/diff': 6.617, 'test/acc_skew': 82.91, 'test/acc_align': 82.883}
[3 / 20] best valid accuracy: 84.153 at epoch 3 
 best_stats: {'best_valid_epoch': 3, 'best_valid_valid/acc': 84.515, 'best_valid_valid/acc_unbiased': 84.153, 'best_valid_valid/diff': 2.906, 'best_valid_valid/acc_skew': 84.895, 'best_valid_valid/acc_align': 83.411, 'best_valid_test/acc': 83.249, 'best_valid_test/acc_unbiased': 82.896, 'best_valid_test/diff': 6.617, 'best_valid_test/acc_skew': 82.91, 'best_valid_test/acc_align': 82.883}
[3 / 20] best test accuracy: 82.896 at epoch 3 
 best_stats: {'best_test_epoch': 3, 'best_test_valid/acc': 84.515, 'best_test_valid/acc_unbiased': 84.153, 'best_test_valid/diff': 2.906, 'best_test_valid/acc_skew': 84.895, 'best_test_valid/acc_align': 83.411, 'best_test_test/acc': 83.249, 'best_test_test/acc_unbiased': 82.896, 'best_test_test/diff': 6.617, 'best_test_test/acc_skew': 82.91, 'best_test_test/acc_align': 82.883}
[4 / 20] Learning rate: 0.001 weight: 0.01
[4 / 20] Loss: 4.658108340198971 CE Loss: 0.36173857772465307 Con Loss: 4.654490947723389
[4 / 20] tensor([[0.864, 0.832],
        [0.801, 0.831]]) {'epoch': 4, 'valid/acc': 85.316, 'valid/acc_unbiased': 85.31, 'valid/diff': 1.141, 'valid/acc_skew': 85.652, 'valid/acc_align': 84.967, 'test/acc': 83.291, 'test/acc_unbiased': 83.172, 'test/diff': 3.097, 'test/acc_skew': 83.233, 'test/acc_align': 83.111}
[4 / 20] best valid accuracy: 85.310 at epoch 4 
 best_stats: {'best_valid_epoch': 4, 'best_valid_valid/acc': 85.316, 'best_valid_valid/acc_unbiased': 85.31, 'best_valid_valid/diff': 1.141, 'best_valid_valid/acc_skew': 85.652, 'best_valid_valid/acc_align': 84.967, 'best_valid_test/acc': 83.291, 'best_valid_test/acc_unbiased': 83.172, 'best_valid_test/diff': 3.097, 'best_valid_test/acc_skew': 83.233, 'best_valid_test/acc_align': 83.111}
[4 / 20] best test accuracy: 83.172 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 85.316, 'best_test_valid/acc_unbiased': 85.31, 'best_test_valid/diff': 1.141, 'best_test_valid/acc_skew': 85.652, 'best_test_valid/acc_align': 84.967, 'best_test_test/acc': 83.291, 'best_test_test/acc_unbiased': 83.172, 'best_test_test/diff': 3.097, 'best_test_test/acc_skew': 83.233, 'best_test_test/acc_align': 83.111}
[5 / 20] Learning rate: 0.001 weight: 0.01
[5 / 20] Loss: 4.645793373561749 CE Loss: 0.3602962399985629 Con Loss: 4.642190390461128
[5 / 20] tensor([[0.837, 0.783],
        [0.872, 0.900]]) {'epoch': 5, 'valid/acc': 84.515, 'valid/acc_unbiased': 84.971, 'valid/diff': 1.237, 'valid/acc_skew': 85.589, 'valid/acc_align': 84.352, 'test/acc': 84.641, 'test/acc_unbiased': 84.813, 'test/diff': 4.11, 'test/acc_skew': 85.461, 'test/acc_align': 84.166}
[5 / 20] best valid accuracy: 85.310 at epoch 4 
 best_stats: {'best_valid_epoch': 4, 'best_valid_valid/acc': 85.316, 'best_valid_valid/acc_unbiased': 85.31, 'best_valid_valid/diff': 1.141, 'best_valid_valid/acc_skew': 85.652, 'best_valid_valid/acc_align': 84.967, 'best_valid_test/acc': 83.291, 'best_valid_test/acc_unbiased': 83.172, 'best_valid_test/diff': 3.097, 'best_valid_test/acc_skew': 83.233, 'best_valid_test/acc_align': 83.111}
[5 / 20] best test accuracy: 84.813 at epoch 5 
 best_stats: {'best_test_epoch': 5, 'best_test_valid/acc': 84.515, 'best_test_valid/acc_unbiased': 84.971, 'best_test_valid/diff': 1.237, 'best_test_valid/acc_skew': 85.589, 'best_test_valid/acc_align': 84.352, 'best_test_test/acc': 84.641, 'best_test_test/acc_unbiased': 84.813, 'best_test_test/diff': 4.11, 'best_test_test/acc_skew': 85.461, 'best_test_test/acc_align': 84.166}
[6 / 20] Learning rate: 0.001 weight: 0.01
[6 / 20] Loss: 4.632053235719441 CE Loss: 0.3377054108492431 Con Loss: 4.628676193703409
[6 / 20] tensor([[0.853, 0.804],
        [0.833, 0.887]]) {'epoch': 6, 'valid/acc': 85.105, 'valid/acc_unbiased': 85.39, 'valid/diff': 3.063, 'valid/acc_skew': 86.755, 'valid/acc_align': 84.026, 'test/acc': 84.473, 'test/acc_unbiased': 84.425, 'test/diff': 5.162, 'test/acc_skew': 84.319, 'test/acc_align': 84.531}
[6 / 20] best valid accuracy: 85.390 at epoch 6 
 best_stats: {'best_valid_epoch': 6, 'best_valid_valid/acc': 85.105, 'best_valid_valid/acc_unbiased': 85.39, 'best_valid_valid/diff': 3.063, 'best_valid_valid/acc_skew': 86.755, 'best_valid_valid/acc_align': 84.026, 'best_valid_test/acc': 84.473, 'best_valid_test/acc_unbiased': 84.425, 'best_valid_test/diff': 5.162, 'best_valid_test/acc_skew': 84.319, 'best_valid_test/acc_align': 84.531}
[6 / 20] best test accuracy: 84.813 at epoch 5 
 best_stats: {'best_test_epoch': 5, 'best_test_valid/acc': 84.515, 'best_test_valid/acc_unbiased': 84.971, 'best_test_valid/diff': 1.237, 'best_test_valid/acc_skew': 85.589, 'best_test_valid/acc_align': 84.352, 'best_test_test/acc': 84.641, 'best_test_test/acc_unbiased': 84.813, 'best_test_test/diff': 4.11, 'best_test_test/acc_skew': 85.461, 'best_test_test/acc_align': 84.166}
[7 / 20] Learning rate: 0.0001 weight: 0.01
[7 / 20] Loss: 4.5675435066223145 CE Loss: 0.29384873773890674 Con Loss: 4.5646050168003685
[7 / 20] tensor([[0.896, 0.852],
        [0.840, 0.871]]) {'epoch': 7, 'valid/acc': 87.342, 'valid/acc_unbiased': 87.517, 'valid/diff': 2.829, 'valid/acc_skew': 88.931, 'valid/acc_align': 86.103, 'test/acc': 86.54, 'test/acc_unbiased': 86.473, 'test/diff': 3.733, 'test/acc_skew': 86.794, 'test/acc_align': 86.151}
[7 / 20] best valid accuracy: 87.517 at epoch 7 
 best_stats: {'best_valid_epoch': 7, 'best_valid_valid/acc': 87.342, 'best_valid_valid/acc_unbiased': 87.517, 'best_valid_valid/diff': 2.829, 'best_valid_valid/acc_skew': 88.931, 'best_valid_valid/acc_align': 86.103, 'best_valid_test/acc': 86.54, 'best_valid_test/acc_unbiased': 86.473, 'best_valid_test/diff': 3.733, 'best_valid_test/acc_skew': 86.794, 'best_valid_test/acc_align': 86.151}
[7 / 20] best test accuracy: 86.473 at epoch 7 
 best_stats: {'best_test_epoch': 7, 'best_test_valid/acc': 87.342, 'best_test_valid/acc_unbiased': 87.517, 'best_test_valid/diff': 2.829, 'best_test_valid/acc_skew': 88.931, 'best_test_valid/acc_align': 86.103, 'best_test_test/acc': 86.54, 'best_test_test/acc_unbiased': 86.473, 'best_test_test/diff': 3.733, 'best_test_test/acc_skew': 86.794, 'best_test_test/acc_align': 86.151}
[8 / 20] Learning rate: 0.0001 weight: 0.01
[8 / 20] Loss: 4.53868664959236 CE Loss: 0.2706262404129053 Con Loss: 4.535980408597989
[8 / 20] tensor([[0.892, 0.843],
        [0.846, 0.883]]) {'epoch': 8, 'valid/acc': 87.426, 'valid/acc_unbiased': 87.656, 'valid/diff': 2.616, 'valid/acc_skew': 88.964, 'valid/acc_align': 86.348, 'test/acc': 86.667, 'test/acc_unbiased': 86.621, 'test/diff': 4.267, 'test/acc_skew': 86.94, 'test/acc_align': 86.302}
[8 / 20] best valid accuracy: 87.656 at epoch 8 
 best_stats: {'best_valid_epoch': 8, 'best_valid_valid/acc': 87.426, 'best_valid_valid/acc_unbiased': 87.656, 'best_valid_valid/diff': 2.616, 'best_valid_valid/acc_skew': 88.964, 'best_valid_valid/acc_align': 86.348, 'best_valid_test/acc': 86.667, 'best_valid_test/acc_unbiased': 86.621, 'best_valid_test/diff': 4.267, 'best_valid_test/acc_skew': 86.94, 'best_valid_test/acc_align': 86.302}
[8 / 20] best test accuracy: 86.621 at epoch 8 
 best_stats: {'best_test_epoch': 8, 'best_test_valid/acc': 87.426, 'best_test_valid/acc_unbiased': 87.656, 'best_test_valid/diff': 2.616, 'best_test_valid/acc_skew': 88.964, 'best_test_valid/acc_align': 86.348, 'best_test_test/acc': 86.667, 'best_test_test/acc_unbiased': 86.621, 'best_test_test/diff': 4.267, 'best_test_test/acc_skew': 86.94, 'best_test_test/acc_align': 86.302}
[9 / 20] Learning rate: 0.0001 weight: 0.01
[9 / 20] Loss: 4.527583586824669 CE Loss: 0.25954692137586344 Con Loss: 4.524988128441323
[9 / 20] tensor([[0.898, 0.861],
        [0.840, 0.880]]) {'epoch': 9, 'valid/acc': 88.101, 'valid/acc_unbiased': 88.145, 'valid/diff': 1.85, 'valid/acc_skew': 89.07, 'valid/acc_align': 87.221, 'test/acc': 87.089, 'test/acc_unbiased': 86.962, 'test/diff': 3.826, 'test/acc_skew': 86.884, 'test/acc_align': 87.04}
[9 / 20] best valid accuracy: 88.145 at epoch 9 
 best_stats: {'best_valid_epoch': 9, 'best_valid_valid/acc': 88.101, 'best_valid_valid/acc_unbiased': 88.145, 'best_valid_valid/diff': 1.85, 'best_valid_valid/acc_skew': 89.07, 'best_valid_valid/acc_align': 87.221, 'best_valid_test/acc': 87.089, 'best_valid_test/acc_unbiased': 86.962, 'best_valid_test/diff': 3.826, 'best_valid_test/acc_skew': 86.884, 'best_valid_test/acc_align': 87.04}
[9 / 20] best test accuracy: 86.962 at epoch 9 
 best_stats: {'best_test_epoch': 9, 'best_test_valid/acc': 88.101, 'best_test_valid/acc_unbiased': 88.145, 'best_test_valid/diff': 1.85, 'best_test_valid/acc_skew': 89.07, 'best_test_valid/acc_align': 87.221, 'best_test_test/acc': 87.089, 'best_test_test/acc_unbiased': 86.962, 'best_test_test/diff': 3.826, 'best_test_test/acc_skew': 86.884, 'best_test_test/acc_align': 87.04}
[10 / 20] Learning rate: 0.0001 weight: 0.01
[10 / 20] Loss: 4.514467210248352 CE Loss: 0.2534615275752506 Con Loss: 4.5119325892334965
[10 / 20] tensor([[0.909, 0.877],
        [0.838, 0.872]]) {'epoch': 10, 'valid/acc': 87.932, 'valid/acc_unbiased': 87.916, 'valid/diff': 1.605, 'valid/acc_skew': 88.718, 'valid/acc_align': 87.113, 'test/acc': 87.553, 'test/acc_unbiased': 87.397, 'test/diff': 3.288, 'test/acc_skew': 87.313, 'test/acc_align': 87.481}
[10 / 20] best valid accuracy: 88.145 at epoch 9 
 best_stats: {'best_valid_epoch': 9, 'best_valid_valid/acc': 88.101, 'best_valid_valid/acc_unbiased': 88.145, 'best_valid_valid/diff': 1.85, 'best_valid_valid/acc_skew': 89.07, 'best_valid_valid/acc_align': 87.221, 'best_valid_test/acc': 87.089, 'best_valid_test/acc_unbiased': 86.962, 'best_valid_test/diff': 3.826, 'best_valid_test/acc_skew': 86.884, 'best_valid_test/acc_align': 87.04}
[10 / 20] best test accuracy: 87.397 at epoch 10 
 best_stats: {'best_test_epoch': 10, 'best_test_valid/acc': 87.932, 'best_test_valid/acc_unbiased': 87.916, 'best_test_valid/diff': 1.605, 'best_test_valid/acc_skew': 88.718, 'best_test_valid/acc_align': 87.113, 'best_test_test/acc': 87.553, 'best_test_test/acc_unbiased': 87.397, 'best_test_test/diff': 3.288, 'best_test_test/acc_skew': 87.313, 'best_test_test/acc_align': 87.481}
[11 / 20] Learning rate: 0.0001 weight: 0.01
[11 / 20] Loss: 4.5114861101966195 CE Loss: 0.24675819009446637 Con Loss: 4.509018530033026
[11 / 20] tensor([[0.918, 0.880],
        [0.805, 0.865]]) {'epoch': 11, 'valid/acc': 87.173, 'valid/acc_unbiased': 86.903, 'valid/diff': 2.204, 'valid/acc_skew': 87.193, 'valid/acc_align': 86.614, 'test/acc': 87.004, 'test/acc_unbiased': 86.697, 'test/diff': 4.84, 'test/acc_skew': 86.138, 'test/acc_align': 87.257}
[11 / 20] best valid accuracy: 88.145 at epoch 9 
 best_stats: {'best_valid_epoch': 9, 'best_valid_valid/acc': 88.101, 'best_valid_valid/acc_unbiased': 88.145, 'best_valid_valid/diff': 1.85, 'best_valid_valid/acc_skew': 89.07, 'best_valid_valid/acc_align': 87.221, 'best_valid_test/acc': 87.089, 'best_valid_test/acc_unbiased': 86.962, 'best_valid_test/diff': 3.826, 'best_valid_test/acc_skew': 86.884, 'best_valid_test/acc_align': 87.04}
[11 / 20] best test accuracy: 87.397 at epoch 10 
 best_stats: {'best_test_epoch': 10, 'best_test_valid/acc': 87.932, 'best_test_valid/acc_unbiased': 87.916, 'best_test_valid/diff': 1.605, 'best_test_valid/acc_skew': 88.718, 'best_test_valid/acc_align': 87.113, 'best_test_test/acc': 87.553, 'best_test_test/acc_unbiased': 87.397, 'best_test_test/diff': 3.288, 'best_test_test/acc_skew': 87.313, 'best_test_test/acc_align': 87.481}
[12 / 20] Learning rate: 0.0001 weight: 0.01
[12 / 20] Loss: 4.507306083605604 CE Loss: 0.24260152239124874 Con Loss: 4.504880077202603
[12 / 20] tensor([[0.891, 0.840],
        [0.840, 0.892]]) {'epoch': 12, 'valid/acc': 87.511, 'valid/acc_unbiased': 87.567, 'valid/diff': 2.517, 'valid/acc_skew': 88.485, 'valid/acc_align': 86.649, 'test/acc': 86.667, 'test/acc_unbiased': 86.563, 'test/diff': 5.096, 'test/acc_skew': 86.525, 'test/acc_align': 86.6}
[12 / 20] best valid accuracy: 88.145 at epoch 9 
 best_stats: {'best_valid_epoch': 9, 'best_valid_valid/acc': 88.101, 'best_valid_valid/acc_unbiased': 88.145, 'best_valid_valid/diff': 1.85, 'best_valid_valid/acc_skew': 89.07, 'best_valid_valid/acc_align': 87.221, 'best_valid_test/acc': 87.089, 'best_valid_test/acc_unbiased': 86.962, 'best_valid_test/diff': 3.826, 'best_valid_test/acc_skew': 86.884, 'best_valid_test/acc_align': 87.04}
[12 / 20] best test accuracy: 87.397 at epoch 10 
 best_stats: {'best_test_epoch': 10, 'best_test_valid/acc': 87.932, 'best_test_valid/acc_unbiased': 87.916, 'best_test_valid/diff': 1.605, 'best_test_valid/acc_skew': 88.718, 'best_test_valid/acc_align': 87.113, 'best_test_test/acc': 87.553, 'best_test_test/acc_unbiased': 87.397, 'best_test_test/diff': 3.288, 'best_test_test/acc_skew': 87.313, 'best_test_test/acc_align': 87.481}
[13 / 20] Learning rate: 0.0001 weight: 0.01
[13 / 20] Loss: 4.483107091529576 CE Loss: 0.23485994597723248 Con Loss: 4.480758486070051
[13 / 20] tensor([[0.882, 0.839],
        [0.855, 0.902]]) {'epoch': 13, 'valid/acc': 88.059, 'valid/acc_unbiased': 88.244, 'valid/diff': 2.561, 'valid/acc_skew': 89.026, 'valid/acc_align': 87.461, 'test/acc': 87.004, 'test/acc_unbiased': 86.941, 'test/diff': 4.484, 'test/acc_skew': 86.835, 'test/acc_align': 87.046}
[13 / 20] best valid accuracy: 88.244 at epoch 13 
 best_stats: {'best_valid_epoch': 13, 'best_valid_valid/acc': 88.059, 'best_valid_valid/acc_unbiased': 88.244, 'best_valid_valid/diff': 2.561, 'best_valid_valid/acc_skew': 89.026, 'best_valid_valid/acc_align': 87.461, 'best_valid_test/acc': 87.004, 'best_valid_test/acc_unbiased': 86.941, 'best_valid_test/diff': 4.484, 'best_valid_test/acc_skew': 86.835, 'best_valid_test/acc_align': 87.046}
[13 / 20] best test accuracy: 87.397 at epoch 10 
 best_stats: {'best_test_epoch': 10, 'best_test_valid/acc': 87.932, 'best_test_valid/acc_unbiased': 87.916, 'best_test_valid/diff': 1.605, 'best_test_valid/acc_skew': 88.718, 'best_test_valid/acc_align': 87.113, 'best_test_test/acc': 87.553, 'best_test_test/acc_unbiased': 87.397, 'best_test_test/diff': 3.288, 'best_test_test/acc_skew': 87.313, 'best_test_test/acc_align': 87.481}
[14 / 20] Learning rate: 1e-05 weight: 0.01
[14 / 20] Loss: 4.477717433328414 CE Loss: 0.2347623927704391 Con Loss: 4.475369781543204
[14 / 20] tensor([[0.887, 0.846],
        [0.851, 0.890]]) {'epoch': 14, 'valid/acc': 88.354, 'valid/acc_unbiased': 88.469, 'valid/diff': 1.988, 'valid/acc_skew': 88.979, 'valid/acc_align': 87.96, 'test/acc': 86.92, 'test/acc_unbiased': 86.854, 'test/diff': 4.006, 'test/acc_skew': 86.887, 'test/acc_align': 86.821}
[14 / 20] best valid accuracy: 88.469 at epoch 14 
 best_stats: {'best_valid_epoch': 14, 'best_valid_valid/acc': 88.354, 'best_valid_valid/acc_unbiased': 88.469, 'best_valid_valid/diff': 1.988, 'best_valid_valid/acc_skew': 88.979, 'best_valid_valid/acc_align': 87.96, 'best_valid_test/acc': 86.92, 'best_valid_test/acc_unbiased': 86.854, 'best_valid_test/diff': 4.006, 'best_valid_test/acc_skew': 86.887, 'best_valid_test/acc_align': 86.821}
[14 / 20] best test accuracy: 87.397 at epoch 10 
 best_stats: {'best_test_epoch': 10, 'best_test_valid/acc': 87.932, 'best_test_valid/acc_unbiased': 87.916, 'best_test_valid/diff': 1.605, 'best_test_valid/acc_skew': 88.718, 'best_test_valid/acc_align': 87.113, 'best_test_test/acc': 87.553, 'best_test_test/acc_unbiased': 87.397, 'best_test_test/diff': 3.288, 'best_test_test/acc_skew': 87.313, 'best_test_test/acc_align': 87.481}
[15 / 20] Learning rate: 1e-05 weight: 0.01
[15 / 20] Loss: 4.462200380981543 CE Loss: 0.23498376571480484 Con Loss: 4.459850538198587
[15 / 20] tensor([[0.891, 0.848],
        [0.848, 0.896]]) {'epoch': 15, 'valid/acc': 88.523, 'valid/acc_unbiased': 88.605, 'valid/diff': 2.404, 'valid/acc_skew': 89.103, 'valid/acc_align': 88.106, 'test/acc': 87.173, 'test/acc_unbiased': 87.075, 'test/diff': 4.516, 'test/acc_skew': 86.958, 'test/acc_align': 87.192}
[15 / 20] best valid accuracy: 88.605 at epoch 15 
 best_stats: {'best_valid_epoch': 15, 'best_valid_valid/acc': 88.523, 'best_valid_valid/acc_unbiased': 88.605, 'best_valid_valid/diff': 2.404, 'best_valid_valid/acc_skew': 89.103, 'best_valid_valid/acc_align': 88.106, 'best_valid_test/acc': 87.173, 'best_valid_test/acc_unbiased': 87.075, 'best_valid_test/diff': 4.516, 'best_valid_test/acc_skew': 86.958, 'best_valid_test/acc_align': 87.192}
[15 / 20] best test accuracy: 87.397 at epoch 10 
 best_stats: {'best_test_epoch': 10, 'best_test_valid/acc': 87.932, 'best_test_valid/acc_unbiased': 87.916, 'best_test_valid/diff': 1.605, 'best_test_valid/acc_skew': 88.718, 'best_test_valid/acc_align': 87.113, 'best_test_test/acc': 87.553, 'best_test_test/acc_unbiased': 87.397, 'best_test_test/diff': 3.288, 'best_test_test/acc_skew': 87.313, 'best_test_test/acc_align': 87.481}
[16 / 20] Learning rate: 1e-05 weight: 0.01
[16 / 20] Loss: 4.477046966552734 CE Loss: 0.22569072054896708 Con Loss: 4.47479004568609
[16 / 20] tensor([[0.876, 0.829],
        [0.859, 0.911]]) {'epoch': 16, 'valid/acc': 88.27, 'valid/acc_unbiased': 88.492, 'valid/diff': 1.671, 'valid/acc_skew': 89.144, 'valid/acc_align': 87.84, 'test/acc': 86.92, 'test/acc_unbiased': 86.879, 'test/diff': 4.961, 'test/acc_skew': 86.783, 'test/acc_align': 86.975}
[16 / 20] best valid accuracy: 88.605 at epoch 15 
 best_stats: {'best_valid_epoch': 15, 'best_valid_valid/acc': 88.523, 'best_valid_valid/acc_unbiased': 88.605, 'best_valid_valid/diff': 2.404, 'best_valid_valid/acc_skew': 89.103, 'best_valid_valid/acc_align': 88.106, 'best_valid_test/acc': 87.173, 'best_valid_test/acc_unbiased': 87.075, 'best_valid_test/diff': 4.516, 'best_valid_test/acc_skew': 86.958, 'best_valid_test/acc_align': 87.192}
[16 / 20] best test accuracy: 87.397 at epoch 10 
 best_stats: {'best_test_epoch': 10, 'best_test_valid/acc': 87.932, 'best_test_valid/acc_unbiased': 87.916, 'best_test_valid/diff': 1.605, 'best_test_valid/acc_skew': 88.718, 'best_test_valid/acc_align': 87.113, 'best_test_test/acc': 87.553, 'best_test_test/acc_unbiased': 87.397, 'best_test_test/diff': 3.288, 'best_test_test/acc_skew': 87.313, 'best_test_test/acc_align': 87.481}
[17 / 20] Learning rate: 1e-05 weight: 0.01
[17 / 20] Loss: 4.46989711841203 CE Loss: 0.22848651570139208 Con Loss: 4.467612268073766
[17 / 20] tensor([[0.892, 0.845],
        [0.842, 0.890]]) {'epoch': 17, 'valid/acc': 88.312, 'valid/acc_unbiased': 88.433, 'valid/diff': 1.989, 'valid/acc_skew': 89.298, 'valid/acc_align': 87.569, 'test/acc': 86.835, 'test/acc_unbiased': 86.735, 'test/diff': 4.781, 'test/acc_skew': 86.723, 'test/acc_align': 86.747}
[17 / 20] best valid accuracy: 88.605 at epoch 15 
 best_stats: {'best_valid_epoch': 15, 'best_valid_valid/acc': 88.523, 'best_valid_valid/acc_unbiased': 88.605, 'best_valid_valid/diff': 2.404, 'best_valid_valid/acc_skew': 89.103, 'best_valid_valid/acc_align': 88.106, 'best_valid_test/acc': 87.173, 'best_valid_test/acc_unbiased': 87.075, 'best_valid_test/diff': 4.516, 'best_valid_test/acc_skew': 86.958, 'best_valid_test/acc_align': 87.192}
[17 / 20] best test accuracy: 87.397 at epoch 10 
 best_stats: {'best_test_epoch': 10, 'best_test_valid/acc': 87.932, 'best_test_valid/acc_unbiased': 87.916, 'best_test_valid/diff': 1.605, 'best_test_valid/acc_skew': 88.718, 'best_test_valid/acc_align': 87.113, 'best_test_test/acc': 87.553, 'best_test_test/acc_unbiased': 87.397, 'best_test_test/diff': 3.288, 'best_test_test/acc_skew': 87.313, 'best_test_test/acc_align': 87.481}
[18 / 20] Learning rate: 1e-05 weight: 0.01
[18 / 20] Loss: 4.4640742452198285 CE Loss: 0.2275863322893523 Con Loss: 4.4617983796588865
[18 / 20] tensor([[0.896, 0.860],
        [0.833, 0.883]]) {'epoch': 18, 'valid/acc': 88.523, 'valid/acc_unbiased': 88.546, 'valid/diff': 1.847, 'valid/acc_skew': 89.18, 'valid/acc_align': 87.913, 'test/acc': 86.962, 'test/acc_unbiased': 86.792, 'test/diff': 4.283, 'test/acc_skew': 86.47, 'test/acc_align': 87.115}
[18 / 20] best valid accuracy: 88.605 at epoch 15 
 best_stats: {'best_valid_epoch': 15, 'best_valid_valid/acc': 88.523, 'best_valid_valid/acc_unbiased': 88.605, 'best_valid_valid/diff': 2.404, 'best_valid_valid/acc_skew': 89.103, 'best_valid_valid/acc_align': 88.106, 'best_valid_test/acc': 87.173, 'best_valid_test/acc_unbiased': 87.075, 'best_valid_test/diff': 4.516, 'best_valid_test/acc_skew': 86.958, 'best_valid_test/acc_align': 87.192}
[18 / 20] best test accuracy: 87.397 at epoch 10 
 best_stats: {'best_test_epoch': 10, 'best_test_valid/acc': 87.932, 'best_test_valid/acc_unbiased': 87.916, 'best_test_valid/diff': 1.605, 'best_test_valid/acc_skew': 88.718, 'best_test_valid/acc_align': 87.113, 'best_test_test/acc': 87.553, 'best_test_test/acc_unbiased': 87.397, 'best_test_test/diff': 3.288, 'best_test_test/acc_skew': 87.313, 'best_test_test/acc_align': 87.481}
[19 / 20] Learning rate: 1e-05 weight: 0.01
[19 / 20] Loss: 4.456422589599511 CE Loss: 0.2240351413128077 Con Loss: 4.454182239974044
[19 / 20] tensor([[0.882, 0.833],
        [0.857, 0.909]]) {'epoch': 19, 'valid/acc': 88.186, 'valid/acc_unbiased': 88.417, 'valid/diff': 1.667, 'valid/acc_skew': 89.144, 'valid/acc_align': 87.689, 'test/acc': 87.089, 'test/acc_unbiased': 87.033, 'test/diff': 5.043, 'test/acc_skew': 86.943, 'test/acc_align': 87.122}
[19 / 20] best valid accuracy: 88.605 at epoch 15 
 best_stats: {'best_valid_epoch': 15, 'best_valid_valid/acc': 88.523, 'best_valid_valid/acc_unbiased': 88.605, 'best_valid_valid/diff': 2.404, 'best_valid_valid/acc_skew': 89.103, 'best_valid_valid/acc_align': 88.106, 'best_valid_test/acc': 87.173, 'best_valid_test/acc_unbiased': 87.075, 'best_valid_test/diff': 4.516, 'best_valid_test/acc_skew': 86.958, 'best_valid_test/acc_align': 87.192}
[19 / 20] best test accuracy: 87.397 at epoch 10 
 best_stats: {'best_test_epoch': 10, 'best_test_valid/acc': 87.932, 'best_test_valid/acc_unbiased': 87.916, 'best_test_valid/diff': 1.605, 'best_test_valid/acc_skew': 88.718, 'best_test_valid/acc_align': 87.113, 'best_test_test/acc': 87.553, 'best_test_test/acc_unbiased': 87.397, 'best_test_test/diff': 3.288, 'best_test_test/acc_skew': 87.313, 'best_test_test/acc_align': 87.481}
[20 / 20] Learning rate: 1e-05 weight: 0.01
[20 / 20] Loss: 4.458553602457813 CE Loss: 0.21826129859475077 Con Loss: 4.4563710114580255
[20 / 20] tensor([[0.894, 0.849],
        [0.840, 0.895]]) {'epoch': 20, 'valid/acc': 88.143, 'valid/acc_unbiased': 88.206, 'valid/diff': 2.41, 'valid/acc_skew': 88.689, 'valid/acc_align': 87.724, 'test/acc': 87.089, 'test/acc_unbiased': 86.948, 'test/diff': 4.98, 'test/acc_skew': 86.705, 'test/acc_align': 87.192}
[20 / 20] best valid accuracy: 88.605 at epoch 15 
 best_stats: {'best_valid_epoch': 15, 'best_valid_valid/acc': 88.523, 'best_valid_valid/acc_unbiased': 88.605, 'best_valid_valid/diff': 2.404, 'best_valid_valid/acc_skew': 89.103, 'best_valid_valid/acc_align': 88.106, 'best_valid_test/acc': 87.173, 'best_valid_test/acc_unbiased': 87.075, 'best_valid_test/diff': 4.516, 'best_valid_test/acc_skew': 86.958, 'best_valid_test/acc_align': 87.192}
[20 / 20] best test accuracy: 87.397 at epoch 10 
 best_stats: {'best_test_epoch': 10, 'best_test_valid/acc': 87.932, 'best_test_valid/acc_unbiased': 87.916, 'best_test_valid/diff': 1.605, 'best_test_valid/acc_skew': 88.718, 'best_test_valid/acc_align': 87.113, 'best_test_test/acc': 87.553, 'best_test_test/acc_unbiased': 87.397, 'best_test_test/diff': 3.288, 'best_test_test/acc_skew': 87.313, 'best_test_test/acc_align': 87.481}
Total training time: 0:41:27
