Log level set to: INFO
Set seed: 3
=======> Using Fixed Random Seed: 3 <========
save_path: exp_results/bc-bb0-utk_face_race-uw-0.9-lr0.001-bs128-cbs64-w0.01-ratio10-aug1-seed3
get_utk_face - split: train, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_race-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [4407, 552]
Target 1: [440, 5529]
Binary Target 1
---------------------------
Target 0: [4407, 552]
Target 1: [440, 5529]
===================================
Normal Label Distribution: 
Target 0: [4407, 552]
Target 1: [440, 5529]
===================================
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [4407, 552]
Target 1: [440, 5529]
Binary Target 1
---------------------------
Target 0: [4407, 552]
Target 1: [440, 5529]
===================================
Normal Label Distribution: 
Target 0: [4407, 552]
Target 1: [440, 5529]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 10928, target_attr: gender, bias_attr: race bias_rate: 0.9
['[train] target_0-bias_0: 4407', '[train] target_0-bias_1: 552', '[train] target_1-bias_0: 440', '[train] target_1-bias_1: 5529']
confusion_matrix - 
 original: tensor([[4407.,  440.],
        [ 552., 5529.]]), 
 normalized: tensor([[0.909, 0.091],
        [0.091, 0.909]]), 
 b|y: tensor([[0.889, 0.111],
        [0.074, 0.926]])
get_utk_face - split: train, aug: 1, given_y: True, ratio: 10
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_race-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [4407, 552]
Target 1: [440, 5529]
Binary Target 1
---------------------------
Target 0: [4407, 552]
Target 1: [440, 5529]
===================================
Normal Label Distribution: 
Target 0: [4407, 552]
Target 1: [440, 5529]
===================================
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [4407, 552]
Target 1: [440, 5529]
Binary Target 1
---------------------------
Target 0: [4407, 552]
Target 1: [440, 5529]
===================================
Normal Label Distribution: 
Target 0: [4407, 552]
Target 1: [440, 5529]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 10928, target_attr: gender, bias_attr: race bias_rate: 0.9
['[train] target_0-bias_0: 4407', '[train] target_0-bias_1: 552', '[train] target_1-bias_0: 440', '[train] target_1-bias_1: 5529']
get_utk_face - split: valid, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_race-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [583, 684]
Target 1: [457, 646]
Binary Target 1
---------------------------
Target 0: [583, 684]
Target 1: [457, 646]
===================================
Normal Label Distribution: 
Target 0: [583, 684]
Target 1: [457, 646]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 2370, target_attr: gender, bias_attr: race bias_rate: 0.9
['[valid] target_0-bias_0: 583', '[valid] target_0-bias_1: 684', '[valid] target_1-bias_0: 457', '[valid] target_1-bias_1: 646']
get_utk_face - split: test, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_race-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [558, 677]
Target 1: [462, 673]
Binary Target 1
---------------------------
Target 0: [558, 677]
Target 1: [462, 673]
===================================
Normal Label Distribution: 
Target 0: [558, 677]
Target 1: [462, 673]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 2370, target_attr: gender, bias_attr: race bias_rate: 0.9
['[test] target_0-bias_0: 558', '[test] target_0-bias_1: 677', '[test] target_1-bias_0: 462', '[test] target_1-bias_1: 673']
decay_epochs: [6, 13]
[1 / 20] Learning rate: 0.001 weight: 0.01
[1 / 20] Loss: 4.893268583808776 CE Loss: 2.1750561405589606 Con Loss: 4.871518030348145
[1 / 20] tensor([[0.880, 0.829],
        [0.719, 0.740]]) {'epoch': 1, 'valid/acc': 80.127, 'valid/acc_unbiased': 79.835, 'valid/diff': 2.721, 'valid/acc_skew': 79.451, 'valid/acc_align': 80.219, 'test/acc': 79.409, 'test/acc_unbiased': 79.179, 'test/diff': 3.631, 'test/acc_skew': 77.364, 'test/acc_align': 80.995}
[1 / 20] best valid accuracy: 79.835 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 80.127, 'best_valid_valid/acc_unbiased': 79.835, 'best_valid_valid/diff': 2.721, 'best_valid_valid/acc_skew': 79.451, 'best_valid_valid/acc_align': 80.219, 'best_valid_test/acc': 79.409, 'best_valid_test/acc_unbiased': 79.179, 'best_valid_test/diff': 3.631, 'best_valid_test/acc_skew': 77.364, 'best_valid_test/acc_align': 80.995}
[1 / 20] best test accuracy: 79.179 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 80.127, 'best_test_valid/acc_unbiased': 79.835, 'best_test_valid/diff': 2.721, 'best_test_valid/acc_skew': 79.451, 'best_test_valid/acc_align': 80.219, 'best_test_test/acc': 79.409, 'best_test_test/acc_unbiased': 79.179, 'best_test_test/diff': 3.631, 'best_test_test/acc_skew': 77.364, 'best_test_test/acc_align': 80.995}
[2 / 20] Learning rate: 0.001 weight: 0.01
[2 / 20] Loss: 4.757888403678883 CE Loss: 1.6699292778445198 Con Loss: 4.7411891105059825
[2 / 20] tensor([[0.876, 0.842],
        [0.734, 0.725]]) {'epoch': 2, 'valid/acc': 79.241, 'valid/acc_unbiased': 78.826, 'valid/diff': 2.208, 'valid/acc_skew': 79.307, 'valid/acc_align': 78.345, 'test/acc': 79.578, 'test/acc_unbiased': 79.429, 'test/diff': 2.152, 'test/acc_skew': 78.786, 'test/acc_align': 80.073}
[2 / 20] best valid accuracy: 79.835 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 80.127, 'best_valid_valid/acc_unbiased': 79.835, 'best_valid_valid/diff': 2.721, 'best_valid_valid/acc_skew': 79.451, 'best_valid_valid/acc_align': 80.219, 'best_valid_test/acc': 79.409, 'best_valid_test/acc_unbiased': 79.179, 'best_valid_test/diff': 3.631, 'best_valid_test/acc_skew': 77.364, 'best_valid_test/acc_align': 80.995}
[2 / 20] best test accuracy: 79.429 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 79.241, 'best_test_valid/acc_unbiased': 78.826, 'best_test_valid/diff': 2.208, 'best_test_valid/acc_skew': 79.307, 'best_test_valid/acc_align': 78.345, 'best_test_test/acc': 79.578, 'best_test_test/acc_unbiased': 79.429, 'best_test_test/diff': 2.152, 'best_test_test/acc_skew': 78.786, 'best_test_test/acc_align': 80.073}
[3 / 20] Learning rate: 0.001 weight: 0.01
[3 / 20] Loss: 4.745979665837211 CE Loss: 1.7140402230127314 Con Loss: 4.728839248724249
[3 / 20] tensor([[0.909, 0.876],
        [0.747, 0.734]]) {'epoch': 3, 'valid/acc': 82.489, 'valid/acc_unbiased': 82.071, 'valid/diff': 2.928, 'valid/acc_skew': 81.461, 'valid/acc_align': 82.682, 'test/acc': 81.814, 'test/acc_unbiased': 81.633, 'test/diff': 2.27, 'test/acc_skew': 81.134, 'test/acc_align': 82.131}
[3 / 20] best valid accuracy: 82.071 at epoch 3 
 best_stats: {'best_valid_epoch': 3, 'best_valid_valid/acc': 82.489, 'best_valid_valid/acc_unbiased': 82.071, 'best_valid_valid/diff': 2.928, 'best_valid_valid/acc_skew': 81.461, 'best_valid_valid/acc_align': 82.682, 'best_valid_test/acc': 81.814, 'best_valid_test/acc_unbiased': 81.633, 'best_valid_test/diff': 2.27, 'best_valid_test/acc_skew': 81.134, 'best_valid_test/acc_align': 82.131}
[3 / 20] best test accuracy: 81.633 at epoch 3 
 best_stats: {'best_test_epoch': 3, 'best_test_valid/acc': 82.489, 'best_test_valid/acc_unbiased': 82.071, 'best_test_valid/diff': 2.928, 'best_test_valid/acc_skew': 81.461, 'best_test_valid/acc_align': 82.682, 'best_test_test/acc': 81.814, 'best_test_test/acc_unbiased': 81.633, 'best_test_test/diff': 2.27, 'best_test_test/acc_skew': 81.134, 'best_test_test/acc_align': 82.131}
[4 / 20] Learning rate: 0.001 weight: 0.01
[4 / 20] Loss: 4.713069759385652 CE Loss: 1.5771816729801116 Con Loss: 4.697297946600404
[4 / 20] tensor([[0.910, 0.876],
        [0.745, 0.755]]) {'epoch': 4, 'valid/acc': 82.236, 'valid/acc_unbiased': 81.825, 'valid/diff': 1.971, 'valid/acc_skew': 81.679, 'valid/acc_align': 81.97, 'test/acc': 82.405, 'test/acc_unbiased': 82.143, 'test/diff': 2.236, 'test/acc_skew': 81.026, 'test/acc_align': 83.261}
[4 / 20] best valid accuracy: 82.071 at epoch 3 
 best_stats: {'best_valid_epoch': 3, 'best_valid_valid/acc': 82.489, 'best_valid_valid/acc_unbiased': 82.071, 'best_valid_valid/diff': 2.928, 'best_valid_valid/acc_skew': 81.461, 'best_valid_valid/acc_align': 82.682, 'best_valid_test/acc': 81.814, 'best_valid_test/acc_unbiased': 81.633, 'best_valid_test/diff': 2.27, 'best_valid_test/acc_skew': 81.134, 'best_valid_test/acc_align': 82.131}
[4 / 20] best test accuracy: 82.143 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 82.236, 'best_test_valid/acc_unbiased': 81.825, 'best_test_valid/diff': 1.971, 'best_test_valid/acc_skew': 81.679, 'best_test_valid/acc_align': 81.97, 'best_test_test/acc': 82.405, 'best_test_test/acc_unbiased': 82.143, 'best_test_test/diff': 2.236, 'best_test_test/acc_skew': 81.026, 'best_test_test/acc_align': 83.261}
[5 / 20] Learning rate: 0.001 weight: 0.01
[5 / 20] Loss: 4.701003242900396 CE Loss: 1.500523095249606 Con Loss: 4.685997985292493
[5 / 20] tensor([[0.953, 0.957],
        [0.630, 0.667]]) {'epoch': 5, 'valid/acc': 82.363, 'valid/acc_unbiased': 81.428, 'valid/diff': 1.907, 'valid/acc_skew': 82.382, 'valid/acc_align': 80.475, 'test/acc': 81.013, 'test/acc_unbiased': 80.19, 'test/diff': 2.053, 'test/acc_skew': 79.352, 'test/acc_align': 81.028}
[5 / 20] best valid accuracy: 82.071 at epoch 3 
 best_stats: {'best_valid_epoch': 3, 'best_valid_valid/acc': 82.489, 'best_valid_valid/acc_unbiased': 82.071, 'best_valid_valid/diff': 2.928, 'best_valid_valid/acc_skew': 81.461, 'best_valid_valid/acc_align': 82.682, 'best_valid_test/acc': 81.814, 'best_valid_test/acc_unbiased': 81.633, 'best_valid_test/diff': 2.27, 'best_valid_test/acc_skew': 81.134, 'best_valid_test/acc_align': 82.131}
[5 / 20] best test accuracy: 82.143 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 82.236, 'best_test_valid/acc_unbiased': 81.825, 'best_test_valid/diff': 1.971, 'best_test_valid/acc_skew': 81.679, 'best_test_valid/acc_align': 81.97, 'best_test_test/acc': 82.405, 'best_test_test/acc_unbiased': 82.143, 'best_test_test/diff': 2.236, 'best_test_test/acc_skew': 81.026, 'best_test_test/acc_align': 83.261}
[6 / 20] Learning rate: 0.001 weight: 0.01
[6 / 20] Loss: 4.67900419584305 CE Loss: 1.4223708652647138 Con Loss: 4.664780498772728
[6 / 20] tensor([[0.875, 0.815],
        [0.805, 0.860]]) {'epoch': 6, 'valid/acc': 84.473, 'valid/acc_unbiased': 84.488, 'valid/diff': 1.157, 'valid/acc_skew': 83.972, 'valid/acc_align': 85.004, 'test/acc': 84.008, 'test/acc_unbiased': 83.886, 'test/diff': 5.716, 'test/acc_skew': 81.028, 'test/acc_align': 86.744}
[6 / 20] best valid accuracy: 84.488 at epoch 6 
 best_stats: {'best_valid_epoch': 6, 'best_valid_valid/acc': 84.473, 'best_valid_valid/acc_unbiased': 84.488, 'best_valid_valid/diff': 1.157, 'best_valid_valid/acc_skew': 83.972, 'best_valid_valid/acc_align': 85.004, 'best_valid_test/acc': 84.008, 'best_valid_test/acc_unbiased': 83.886, 'best_valid_test/diff': 5.716, 'best_valid_test/acc_skew': 81.028, 'best_valid_test/acc_align': 86.744}
[6 / 20] best test accuracy: 83.886 at epoch 6 
 best_stats: {'best_test_epoch': 6, 'best_test_valid/acc': 84.473, 'best_test_valid/acc_unbiased': 84.488, 'best_test_valid/diff': 1.157, 'best_test_valid/acc_skew': 83.972, 'best_test_valid/acc_align': 85.004, 'best_test_test/acc': 84.008, 'best_test_test/acc_unbiased': 83.886, 'best_test_test/diff': 5.716, 'best_test_test/acc_skew': 81.028, 'best_test_test/acc_align': 86.744}
[7 / 20] Learning rate: 0.0001 weight: 0.01
[7 / 20] Loss: 4.629971075546689 CE Loss: 1.3108679386043967 Con Loss: 4.616862419932688
[7 / 20] tensor([[0.849, 0.833],
        [0.829, 0.887]]) {'epoch': 7, 'valid/acc': 86.16, 'valid/acc_unbiased': 86.227, 'valid/diff': 1.161, 'valid/acc_skew': 86.016, 'valid/acc_align': 86.439, 'test/acc': 85.148, 'test/acc_unbiased': 84.966, 'test/diff': 3.722, 'test/acc_skew': 83.105, 'test/acc_align': 86.827}
[7 / 20] best valid accuracy: 86.227 at epoch 7 
 best_stats: {'best_valid_epoch': 7, 'best_valid_valid/acc': 86.16, 'best_valid_valid/acc_unbiased': 86.227, 'best_valid_valid/diff': 1.161, 'best_valid_valid/acc_skew': 86.016, 'best_valid_valid/acc_align': 86.439, 'best_valid_test/acc': 85.148, 'best_valid_test/acc_unbiased': 84.966, 'best_valid_test/diff': 3.722, 'best_valid_test/acc_skew': 83.105, 'best_valid_test/acc_align': 86.827}
[7 / 20] best test accuracy: 84.966 at epoch 7 
 best_stats: {'best_test_epoch': 7, 'best_test_valid/acc': 86.16, 'best_test_valid/acc_unbiased': 86.227, 'best_test_valid/diff': 1.161, 'best_test_valid/acc_skew': 86.016, 'best_test_valid/acc_align': 86.439, 'best_test_test/acc': 85.148, 'best_test_test/acc_unbiased': 84.966, 'best_test_test/diff': 3.722, 'best_test_test/acc_skew': 83.105, 'best_test_test/acc_align': 86.827}
[8 / 20] Learning rate: 0.0001 weight: 0.01
[8 / 20] Loss: 4.610409305874111 CE Loss: 1.1808070417379042 Con Loss: 4.598601249789772
[8 / 20] tensor([[0.867, 0.833],
        [0.838, 0.903]]) {'epoch': 8, 'valid/acc': 86.751, 'valid/acc_unbiased': 86.827, 'valid/diff': 1.768, 'valid/acc_skew': 85.943, 'valid/acc_align': 87.71, 'test/acc': 86.203, 'test/acc_unbiased': 86.039, 'test/diff': 5.003, 'test/acc_skew': 83.537, 'test/acc_align': 88.54}
[8 / 20] best valid accuracy: 86.827 at epoch 8 
 best_stats: {'best_valid_epoch': 8, 'best_valid_valid/acc': 86.751, 'best_valid_valid/acc_unbiased': 86.827, 'best_valid_valid/diff': 1.768, 'best_valid_valid/acc_skew': 85.943, 'best_valid_valid/acc_align': 87.71, 'best_valid_test/acc': 86.203, 'best_valid_test/acc_unbiased': 86.039, 'best_valid_test/diff': 5.003, 'best_valid_test/acc_skew': 83.537, 'best_valid_test/acc_align': 88.54}
[8 / 20] best test accuracy: 86.039 at epoch 8 
 best_stats: {'best_test_epoch': 8, 'best_test_valid/acc': 86.751, 'best_test_valid/acc_unbiased': 86.827, 'best_test_valid/diff': 1.768, 'best_test_valid/acc_skew': 85.943, 'best_test_valid/acc_align': 87.71, 'best_test_test/acc': 86.203, 'best_test_test/acc_unbiased': 86.039, 'best_test_test/diff': 5.003, 'best_test_test/acc_skew': 83.537, 'best_test_test/acc_align': 88.54}
[9 / 20] Learning rate: 0.0001 weight: 0.01
[9 / 20] Loss: 4.592767466912332 CE Loss: 1.1365684541392291 Con Loss: 4.581401776080599
[9 / 20] tensor([[0.837, 0.795],
        [0.859, 0.920]]) {'epoch': 9, 'valid/acc': 86.203, 'valid/acc_unbiased': 86.48, 'valid/diff': 3.055, 'valid/acc_skew': 84.953, 'valid/acc_align': 88.008, 'test/acc': 85.274, 'test/acc_unbiased': 85.267, 'test/diff': 5.135, 'test/acc_skew': 82.699, 'test/acc_align': 87.834}
[9 / 20] best valid accuracy: 86.827 at epoch 8 
 best_stats: {'best_valid_epoch': 8, 'best_valid_valid/acc': 86.751, 'best_valid_valid/acc_unbiased': 86.827, 'best_valid_valid/diff': 1.768, 'best_valid_valid/acc_skew': 85.943, 'best_valid_valid/acc_align': 87.71, 'best_valid_test/acc': 86.203, 'best_valid_test/acc_unbiased': 86.039, 'best_valid_test/diff': 5.003, 'best_valid_test/acc_skew': 83.537, 'best_valid_test/acc_align': 88.54}
[9 / 20] best test accuracy: 86.039 at epoch 8 
 best_stats: {'best_test_epoch': 8, 'best_test_valid/acc': 86.751, 'best_test_valid/acc_unbiased': 86.827, 'best_test_valid/diff': 1.768, 'best_test_valid/acc_skew': 85.943, 'best_test_valid/acc_align': 87.71, 'best_test_test/acc': 86.203, 'best_test_test/acc_unbiased': 86.039, 'best_test_test/diff': 5.003, 'best_test_test/acc_skew': 83.537, 'best_test_test/acc_align': 88.54}
[10 / 20] Learning rate: 0.0001 weight: 0.01
[10 / 20] Loss: 4.58306642367585 CE Loss: 1.1090828881954902 Con Loss: 4.571975576755418
[10 / 20] tensor([[0.867, 0.814],
        [0.846, 0.903]]) {'epoch': 10, 'valid/acc': 86.878, 'valid/acc_unbiased': 87.111, 'valid/diff': 2.852, 'valid/acc_skew': 85.685, 'valid/acc_align': 88.537, 'test/acc': 85.823, 'test/acc_unbiased': 85.775, 'test/diff': 5.53, 'test/acc_skew': 83.01, 'test/acc_align': 88.54}
[10 / 20] best valid accuracy: 87.111 at epoch 10 
 best_stats: {'best_valid_epoch': 10, 'best_valid_valid/acc': 86.878, 'best_valid_valid/acc_unbiased': 87.111, 'best_valid_valid/diff': 2.852, 'best_valid_valid/acc_skew': 85.685, 'best_valid_valid/acc_align': 88.537, 'best_valid_test/acc': 85.823, 'best_valid_test/acc_unbiased': 85.775, 'best_valid_test/diff': 5.53, 'best_valid_test/acc_skew': 83.01, 'best_valid_test/acc_align': 88.54}
[10 / 20] best test accuracy: 86.039 at epoch 8 
 best_stats: {'best_test_epoch': 8, 'best_test_valid/acc': 86.751, 'best_test_valid/acc_unbiased': 86.827, 'best_test_valid/diff': 1.768, 'best_test_valid/acc_skew': 85.943, 'best_test_valid/acc_align': 87.71, 'best_test_test/acc': 86.203, 'best_test_test/acc_unbiased': 86.039, 'best_test_test/diff': 5.003, 'best_test_test/acc_skew': 83.537, 'best_test_test/acc_align': 88.54}
[11 / 20] Learning rate: 0.0001 weight: 0.01
[11 / 20] Loss: 4.5701466151247265 CE Loss: 1.0890619927583642 Con Loss: 4.559255999317979
[11 / 20] tensor([[0.875, 0.832],
        [0.842, 0.897]]) {'epoch': 11, 'valid/acc': 86.456, 'valid/acc_unbiased': 86.552, 'valid/diff': 3.849, 'valid/acc_skew': 84.627, 'valid/acc_align': 88.476, 'test/acc': 86.245, 'test/acc_unbiased': 86.141, 'test/diff': 4.921, 'test/acc_skew': 83.68, 'test/acc_align': 88.601}
[11 / 20] best valid accuracy: 87.111 at epoch 10 
 best_stats: {'best_valid_epoch': 10, 'best_valid_valid/acc': 86.878, 'best_valid_valid/acc_unbiased': 87.111, 'best_valid_valid/diff': 2.852, 'best_valid_valid/acc_skew': 85.685, 'best_valid_valid/acc_align': 88.537, 'best_valid_test/acc': 85.823, 'best_valid_test/acc_unbiased': 85.775, 'best_valid_test/diff': 5.53, 'best_valid_test/acc_skew': 83.01, 'best_valid_test/acc_align': 88.54}
[11 / 20] best test accuracy: 86.141 at epoch 11 
 best_stats: {'best_test_epoch': 11, 'best_test_valid/acc': 86.456, 'best_test_valid/acc_unbiased': 86.552, 'best_test_valid/diff': 3.849, 'best_test_valid/acc_skew': 84.627, 'best_test_valid/acc_align': 88.476, 'best_test_test/acc': 86.245, 'best_test_test/acc_unbiased': 86.141, 'best_test_test/diff': 4.921, 'best_test_test/acc_skew': 83.68, 'best_test_test/acc_align': 88.601}
[12 / 20] Learning rate: 0.0001 weight: 0.01
[12 / 20] Loss: 4.577201136034718 CE Loss: 1.0860886757056152 Con Loss: 4.566340274028862
[12 / 20] tensor([[0.878, 0.846],
        [0.842, 0.895]]) {'epoch': 12, 'valid/acc': 87.975, 'valid/acc_unbiased': 88.049, 'valid/diff': 2.535, 'valid/acc_skew': 86.782, 'valid/acc_align': 89.317, 'test/acc': 86.667, 'test/acc_unbiased': 86.525, 'test/diff': 4.213, 'test/acc_skew': 84.419, 'test/acc_align': 88.632}
[12 / 20] best valid accuracy: 88.049 at epoch 12 
 best_stats: {'best_valid_epoch': 12, 'best_valid_valid/acc': 87.975, 'best_valid_valid/acc_unbiased': 88.049, 'best_valid_valid/diff': 2.535, 'best_valid_valid/acc_skew': 86.782, 'best_valid_valid/acc_align': 89.317, 'best_valid_test/acc': 86.667, 'best_valid_test/acc_unbiased': 86.525, 'best_valid_test/diff': 4.213, 'best_valid_test/acc_skew': 84.419, 'best_valid_test/acc_align': 88.632}
[12 / 20] best test accuracy: 86.525 at epoch 12 
 best_stats: {'best_test_epoch': 12, 'best_test_valid/acc': 87.975, 'best_test_valid/acc_unbiased': 88.049, 'best_test_valid/diff': 2.535, 'best_test_valid/acc_skew': 86.782, 'best_test_valid/acc_align': 89.317, 'best_test_test/acc': 86.667, 'best_test_test/acc_unbiased': 86.525, 'best_test_test/diff': 4.213, 'best_test_test/acc_skew': 84.419, 'best_test_test/acc_align': 88.632}
[13 / 20] Learning rate: 0.0001 weight: 0.01
[13 / 20] Loss: 4.554233685768541 CE Loss: 1.023930023390238 Con Loss: 4.5439944239346906
[13 / 20] tensor([[0.873, 0.820],
        [0.848, 0.906]]) {'epoch': 13, 'valid/acc': 87.257, 'valid/acc_unbiased': 87.375, 'valid/diff': 2.356, 'valid/acc_skew': 86.197, 'valid/acc_align': 88.554, 'test/acc': 86.245, 'test/acc_unbiased': 86.186, 'test/diff': 5.544, 'test/acc_skew': 83.414, 'test/acc_align': 88.957}
[13 / 20] best valid accuracy: 88.049 at epoch 12 
 best_stats: {'best_valid_epoch': 12, 'best_valid_valid/acc': 87.975, 'best_valid_valid/acc_unbiased': 88.049, 'best_valid_valid/diff': 2.535, 'best_valid_valid/acc_skew': 86.782, 'best_valid_valid/acc_align': 89.317, 'best_valid_test/acc': 86.667, 'best_valid_test/acc_unbiased': 86.525, 'best_valid_test/diff': 4.213, 'best_valid_test/acc_skew': 84.419, 'best_valid_test/acc_align': 88.632}
[13 / 20] best test accuracy: 86.525 at epoch 12 
 best_stats: {'best_test_epoch': 12, 'best_test_valid/acc': 87.975, 'best_test_valid/acc_unbiased': 88.049, 'best_test_valid/diff': 2.535, 'best_test_valid/acc_skew': 86.782, 'best_test_valid/acc_align': 89.317, 'best_test_test/acc': 86.667, 'best_test_test/acc_unbiased': 86.525, 'best_test_test/diff': 4.213, 'best_test_test/acc_skew': 84.419, 'best_test_test/acc_align': 88.632}
[14 / 20] Learning rate: 1e-05 weight: 0.01
[14 / 20] Loss: 4.538677462721639 CE Loss: 1.0410918219023184 Con Loss: 4.52826654230344
[14 / 20] tensor([[0.885, 0.835],
        [0.844, 0.893]]) {'epoch': 14, 'valid/acc': 87.553, 'valid/acc_unbiased': 87.619, 'valid/diff': 1.747, 'valid/acc_skew': 86.746, 'valid/acc_align': 88.493, 'test/acc': 86.498, 'test/acc_unbiased': 86.426, 'test/diff': 4.98, 'test/acc_skew': 83.936, 'test/acc_align': 88.916}
[14 / 20] best valid accuracy: 88.049 at epoch 12 
 best_stats: {'best_valid_epoch': 12, 'best_valid_valid/acc': 87.975, 'best_valid_valid/acc_unbiased': 88.049, 'best_valid_valid/diff': 2.535, 'best_valid_valid/acc_skew': 86.782, 'best_valid_valid/acc_align': 89.317, 'best_valid_test/acc': 86.667, 'best_valid_test/acc_unbiased': 86.525, 'best_valid_test/diff': 4.213, 'best_valid_test/acc_skew': 84.419, 'best_valid_test/acc_align': 88.632}
[14 / 20] best test accuracy: 86.525 at epoch 12 
 best_stats: {'best_test_epoch': 12, 'best_test_valid/acc': 87.975, 'best_test_valid/acc_unbiased': 88.049, 'best_test_valid/diff': 2.535, 'best_test_valid/acc_skew': 86.782, 'best_test_valid/acc_align': 89.317, 'best_test_test/acc': 86.667, 'best_test_test/acc_unbiased': 86.525, 'best_test_test/diff': 4.213, 'best_test_test/acc_skew': 84.419, 'best_test_test/acc_align': 88.632}
[15 / 20] Learning rate: 1e-05 weight: 0.01
[15 / 20] Loss: 4.538594742994182 CE Loss: 1.0270494508882917 Con Loss: 4.528324250769999
[15 / 20] tensor([[0.880, 0.830],
        [0.846, 0.900]]) {'epoch': 15, 'valid/acc': 87.637, 'valid/acc_unbiased': 87.711, 'valid/diff': 1.857, 'valid/acc_skew': 86.782, 'valid/acc_align': 88.639, 'test/acc': 86.498, 'test/acc_unbiased': 86.421, 'test/diff': 5.196, 'test/acc_skew': 83.823, 'test/acc_align': 89.019}
[15 / 20] best valid accuracy: 88.049 at epoch 12 
 best_stats: {'best_valid_epoch': 12, 'best_valid_valid/acc': 87.975, 'best_valid_valid/acc_unbiased': 88.049, 'best_valid_valid/diff': 2.535, 'best_valid_valid/acc_skew': 86.782, 'best_valid_valid/acc_align': 89.317, 'best_valid_test/acc': 86.667, 'best_valid_test/acc_unbiased': 86.525, 'best_valid_test/diff': 4.213, 'best_valid_test/acc_skew': 84.419, 'best_valid_test/acc_align': 88.632}
[15 / 20] best test accuracy: 86.525 at epoch 12 
 best_stats: {'best_test_epoch': 12, 'best_test_valid/acc': 87.975, 'best_test_valid/acc_unbiased': 88.049, 'best_test_valid/diff': 2.535, 'best_test_valid/acc_skew': 86.782, 'best_test_valid/acc_align': 89.317, 'best_test_test/acc': 86.667, 'best_test_test/acc_unbiased': 86.525, 'best_test_test/diff': 4.213, 'best_test_test/acc_skew': 84.419, 'best_test_test/acc_align': 88.632}
[16 / 20] Learning rate: 1e-05 weight: 0.01
[16 / 20] Loss: 4.532610955384954 CE Loss: 1.0123739798456475 Con Loss: 4.5224871963568
[16 / 20] tensor([[0.867, 0.823],
        [0.848, 0.908]]) {'epoch': 16, 'valid/acc': 87.3, 'valid/acc_unbiased': 87.471, 'valid/diff': 2.185, 'valid/acc_skew': 86.379, 'valid/acc_align': 88.564, 'test/acc': 86.245, 'test/acc_unbiased': 86.162, 'test/diff': 5.201, 'test/acc_skew': 83.562, 'test/acc_align': 88.763}
[16 / 20] best valid accuracy: 88.049 at epoch 12 
 best_stats: {'best_valid_epoch': 12, 'best_valid_valid/acc': 87.975, 'best_valid_valid/acc_unbiased': 88.049, 'best_valid_valid/diff': 2.535, 'best_valid_valid/acc_skew': 86.782, 'best_valid_valid/acc_align': 89.317, 'best_valid_test/acc': 86.667, 'best_valid_test/acc_unbiased': 86.525, 'best_valid_test/diff': 4.213, 'best_valid_test/acc_skew': 84.419, 'best_valid_test/acc_align': 88.632}
[16 / 20] best test accuracy: 86.525 at epoch 12 
 best_stats: {'best_test_epoch': 12, 'best_test_valid/acc': 87.975, 'best_test_valid/acc_unbiased': 88.049, 'best_test_valid/diff': 2.535, 'best_test_valid/acc_skew': 86.782, 'best_test_valid/acc_align': 89.317, 'best_test_test/acc': 86.667, 'best_test_test/acc_unbiased': 86.525, 'best_test_test/diff': 4.213, 'best_test_test/acc_skew': 84.419, 'best_test_test/acc_align': 88.632}
[17 / 20] Learning rate: 1e-05 weight: 0.01
[17 / 20] Loss: 4.543923573473013 CE Loss: 1.0038004373561586 Con Loss: 4.533885563449664
[17 / 20] tensor([[0.878, 0.839],
        [0.835, 0.895]]) {'epoch': 17, 'valid/acc': 88.017, 'valid/acc_unbiased': 88.073, 'valid/diff': 2.144, 'valid/acc_skew': 87.001, 'valid/acc_align': 89.145, 'test/acc': 86.329, 'test/acc_unbiased': 86.178, 'test/diff': 4.907, 'test/acc_skew': 83.725, 'test/acc_align': 88.632}
[17 / 20] best valid accuracy: 88.073 at epoch 17 
 best_stats: {'best_valid_epoch': 17, 'best_valid_valid/acc': 88.017, 'best_valid_valid/acc_unbiased': 88.073, 'best_valid_valid/diff': 2.144, 'best_valid_valid/acc_skew': 87.001, 'best_valid_valid/acc_align': 89.145, 'best_valid_test/acc': 86.329, 'best_valid_test/acc_unbiased': 86.178, 'best_valid_test/diff': 4.907, 'best_valid_test/acc_skew': 83.725, 'best_valid_test/acc_align': 88.632}
[17 / 20] best test accuracy: 86.525 at epoch 12 
 best_stats: {'best_test_epoch': 12, 'best_test_valid/acc': 87.975, 'best_test_valid/acc_unbiased': 88.049, 'best_test_valid/diff': 2.535, 'best_test_valid/acc_skew': 86.782, 'best_test_valid/acc_align': 89.317, 'best_test_test/acc': 86.667, 'best_test_test/acc_unbiased': 86.525, 'best_test_test/diff': 4.213, 'best_test_test/acc_skew': 84.419, 'best_test_test/acc_align': 88.632}
[18 / 20] Learning rate: 1e-05 weight: 0.01
[18 / 20] Loss: 4.537929616595781 CE Loss: 0.9985115700899071 Con Loss: 4.527944522930274
[18 / 20] tensor([[0.871, 0.830],
        [0.844, 0.899]]) {'epoch': 18, 'valid/acc': 87.848, 'valid/acc_unbiased': 87.944, 'valid/diff': 1.667, 'valid/acc_skew': 87.11, 'valid/acc_align': 88.777, 'test/acc': 86.203, 'test/acc_unbiased': 86.105, 'test/diff': 4.782, 'test/acc_skew': 83.714, 'test/acc_align': 88.496}
[18 / 20] best valid accuracy: 88.073 at epoch 17 
 best_stats: {'best_valid_epoch': 17, 'best_valid_valid/acc': 88.017, 'best_valid_valid/acc_unbiased': 88.073, 'best_valid_valid/diff': 2.144, 'best_valid_valid/acc_skew': 87.001, 'best_valid_valid/acc_align': 89.145, 'best_valid_test/acc': 86.329, 'best_valid_test/acc_unbiased': 86.178, 'best_valid_test/diff': 4.907, 'best_valid_test/acc_skew': 83.725, 'best_valid_test/acc_align': 88.632}
[18 / 20] best test accuracy: 86.525 at epoch 12 
 best_stats: {'best_test_epoch': 12, 'best_test_valid/acc': 87.975, 'best_test_valid/acc_unbiased': 88.049, 'best_test_valid/diff': 2.535, 'best_test_valid/acc_skew': 86.782, 'best_test_valid/acc_align': 89.317, 'best_test_test/acc': 86.667, 'best_test_test/acc_unbiased': 86.525, 'best_test_test/diff': 4.213, 'best_test_test/acc_skew': 84.419, 'best_test_test/acc_align': 88.632}
[19 / 20] Learning rate: 1e-05 weight: 0.01
[19 / 20] Loss: 4.522936413263682 CE Loss: 0.9795059724922236 Con Loss: 4.513141352819663
[19 / 20] tensor([[0.875, 0.832],
        [0.846, 0.897]]) {'epoch': 19, 'valid/acc': 87.637, 'valid/acc_unbiased': 87.706, 'valid/diff': 1.556, 'valid/acc_skew': 86.928, 'valid/acc_align': 88.484, 'test/acc': 86.329, 'test/acc_unbiased': 86.249, 'test/diff': 4.705, 'test/acc_skew': 83.897, 'test/acc_align': 88.601}
[19 / 20] best valid accuracy: 88.073 at epoch 17 
 best_stats: {'best_valid_epoch': 17, 'best_valid_valid/acc': 88.017, 'best_valid_valid/acc_unbiased': 88.073, 'best_valid_valid/diff': 2.144, 'best_valid_valid/acc_skew': 87.001, 'best_valid_valid/acc_align': 89.145, 'best_valid_test/acc': 86.329, 'best_valid_test/acc_unbiased': 86.178, 'best_valid_test/diff': 4.907, 'best_valid_test/acc_skew': 83.725, 'best_valid_test/acc_align': 88.632}
[19 / 20] best test accuracy: 86.525 at epoch 12 
 best_stats: {'best_test_epoch': 12, 'best_test_valid/acc': 87.975, 'best_test_valid/acc_unbiased': 88.049, 'best_test_valid/diff': 2.535, 'best_test_valid/acc_skew': 86.782, 'best_test_valid/acc_align': 89.317, 'best_test_test/acc': 86.667, 'best_test_test/acc_unbiased': 86.525, 'best_test_test/diff': 4.213, 'best_test_test/acc_skew': 84.419, 'best_test_test/acc_align': 88.632}
[20 / 20] Learning rate: 1e-05 weight: 0.01
[20 / 20] Loss: 4.53146235380829 CE Loss: 1.0113954426254395 Con Loss: 4.521348398915147
[20 / 20] tensor([[0.876, 0.827],
        [0.840, 0.903]]) {'epoch': 20, 'valid/acc': 87.679, 'valid/acc_unbiased': 87.772, 'valid/diff': 2.199, 'valid/acc_skew': 86.672, 'valid/acc_align': 88.871, 'test/acc': 86.287, 'test/acc_unbiased': 86.169, 'test/diff': 5.638, 'test/acc_skew': 83.35, 'test/acc_align': 88.988}
[20 / 20] best valid accuracy: 88.073 at epoch 17 
 best_stats: {'best_valid_epoch': 17, 'best_valid_valid/acc': 88.017, 'best_valid_valid/acc_unbiased': 88.073, 'best_valid_valid/diff': 2.144, 'best_valid_valid/acc_skew': 87.001, 'best_valid_valid/acc_align': 89.145, 'best_valid_test/acc': 86.329, 'best_valid_test/acc_unbiased': 86.178, 'best_valid_test/diff': 4.907, 'best_valid_test/acc_skew': 83.725, 'best_valid_test/acc_align': 88.632}
[20 / 20] best test accuracy: 86.525 at epoch 12 
 best_stats: {'best_test_epoch': 12, 'best_test_valid/acc': 87.975, 'best_test_valid/acc_unbiased': 88.049, 'best_test_valid/diff': 2.535, 'best_test_valid/acc_skew': 86.782, 'best_test_valid/acc_align': 89.317, 'best_test_test/acc': 86.667, 'best_test_test/acc_unbiased': 86.525, 'best_test_test/diff': 4.213, 'best_test_test/acc_skew': 84.419, 'best_test_test/acc_align': 88.632}
Total training time: 1:06:14
