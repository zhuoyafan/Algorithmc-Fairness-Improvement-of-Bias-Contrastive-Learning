Log level set to: INFO
Set seed: 1
=======> Using Fixed Random Seed: 1 <========
save_path: exp_results/uw-celeba_black-test-lr0.001-bs128-seed1
get_celeba - split:train, aug: False, given_y: True, ratio: 0
get_celeba - split:train_valid, aug: False, given_y: True, ratio: 0
get_celeba - split:valid, aug: False, given_y: True, ratio: 0
decay_epochs: [3, 6]
[1 / 10] Learning rate: 0.001
[1 / 10] Loss: 1.2271
[1 / 10] tensor([[0.884, 0.813],
        [0.917, 0.925]]) {'epoch': 1, 'valid/acc': 86.905, 'valid/acc_unbiased': 88.521, 'valid/diff': 3.663, 'valid/acc_skew': 87.754, 'valid/acc_align': 89.288, 'test/acc': 87.069, 'test/acc_unbiased': 88.483, 'test/diff': 3.958, 'test/acc_skew': 86.504, 'test/acc_align': 90.462}
[1 / 10] best valid accuracy: 88.521 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 86.905, 'best_valid_valid/acc_unbiased': 88.521, 'best_valid_valid/diff': 3.663, 'best_valid_valid/acc_skew': 87.754, 'best_valid_valid/acc_align': 89.288, 'best_valid_test/acc': 87.069, 'best_valid_test/acc_unbiased': 88.483, 'best_valid_test/diff': 3.958, 'best_valid_test/acc_skew': 86.504, 'best_valid_test/acc_align': 90.462}
[1 / 10] best test accuracy: 88.483 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 86.905, 'best_test_valid/acc_unbiased': 88.521, 'best_test_valid/diff': 3.663, 'best_test_valid/acc_skew': 87.754, 'best_test_valid/acc_align': 89.288, 'best_test_test/acc': 87.069, 'best_test_test/acc_unbiased': 88.483, 'best_test_test/diff': 3.958, 'best_test_test/acc_skew': 86.504, 'best_test_test/acc_align': 90.462}
[2 / 10] Learning rate: 0.001
[2 / 10] Loss: 1.0983
[2 / 10] tensor([[0.932, 0.911],
        [0.844, 0.806]]) {'epoch': 2, 'valid/acc': 90.379, 'valid/acc_unbiased': 87.273, 'valid/diff': 3.72, 'valid/acc_skew': 88.582, 'valid/acc_align': 85.965, 'test/acc': 90.235, 'test/acc_unbiased': 87.299, 'test/diff': 2.962, 'test/acc_skew': 87.713, 'test/acc_align': 86.885}
[2 / 10] best valid accuracy: 88.521 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 86.905, 'best_valid_valid/acc_unbiased': 88.521, 'best_valid_valid/diff': 3.663, 'best_valid_valid/acc_skew': 87.754, 'best_valid_valid/acc_align': 89.288, 'best_valid_test/acc': 87.069, 'best_valid_test/acc_unbiased': 88.483, 'best_valid_test/diff': 3.958, 'best_valid_test/acc_skew': 86.504, 'best_valid_test/acc_align': 90.462}
[2 / 10] best test accuracy: 88.483 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 86.905, 'best_test_valid/acc_unbiased': 88.521, 'best_test_valid/diff': 3.663, 'best_test_valid/acc_skew': 87.754, 'best_test_valid/acc_align': 89.288, 'best_test_test/acc': 87.069, 'best_test_test/acc_unbiased': 88.483, 'best_test_test/diff': 3.958, 'best_test_test/acc_skew': 86.504, 'best_test_test/acc_align': 90.462}
[3 / 10] Learning rate: 0.001
[3 / 10] Loss: 1.0585
[3 / 10] tensor([[0.861, 0.804],
        [0.935, 0.938]]) {'epoch': 3, 'valid/acc': 85.57, 'valid/acc_unbiased': 88.857, 'valid/diff': 3.485, 'valid/acc_skew': 88.914, 'valid/acc_align': 88.8, 'test/acc': 85.962, 'test/acc_unbiased': 88.46, 'test/diff': 3.023, 'test/acc_skew': 86.949, 'test/acc_align': 89.972}
[3 / 10] best valid accuracy: 88.857 at epoch 3 
 best_stats: {'best_valid_epoch': 3, 'best_valid_valid/acc': 85.57, 'best_valid_valid/acc_unbiased': 88.857, 'best_valid_valid/diff': 3.485, 'best_valid_valid/acc_skew': 88.914, 'best_valid_valid/acc_align': 88.8, 'best_valid_test/acc': 85.962, 'best_valid_test/acc_unbiased': 88.46, 'best_valid_test/diff': 3.023, 'best_valid_test/acc_skew': 86.949, 'best_valid_test/acc_align': 89.972}
[3 / 10] best test accuracy: 88.483 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 86.905, 'best_test_valid/acc_unbiased': 88.521, 'best_test_valid/diff': 3.663, 'best_test_valid/acc_skew': 87.754, 'best_test_valid/acc_align': 89.288, 'best_test_test/acc': 87.069, 'best_test_test/acc_unbiased': 88.483, 'best_test_test/diff': 3.958, 'best_test_test/acc_skew': 86.504, 'best_test_test/acc_align': 90.462}
[4 / 10] Learning rate: 0.0001
[4 / 10] Loss: 0.8937
[4 / 10] tensor([[0.917, 0.871],
        [0.893, 0.897]]) {'epoch': 4, 'valid/acc': 90.694, 'valid/acc_unbiased': 91.619, 'valid/diff': 3.67, 'valid/acc_skew': 92.303, 'valid/acc_align': 90.934, 'test/acc': 89.908, 'test/acc_unbiased': 89.487, 'test/diff': 2.518, 'test/acc_skew': 88.228, 'test/acc_align': 90.746}
[4 / 10] best valid accuracy: 91.619 at epoch 4 
 best_stats: {'best_valid_epoch': 4, 'best_valid_valid/acc': 90.694, 'best_valid_valid/acc_unbiased': 91.619, 'best_valid_valid/diff': 3.67, 'best_valid_valid/acc_skew': 92.303, 'best_valid_valid/acc_align': 90.934, 'best_valid_test/acc': 89.908, 'best_valid_test/acc_unbiased': 89.487, 'best_valid_test/diff': 2.518, 'best_valid_test/acc_skew': 88.228, 'best_valid_test/acc_align': 90.746}
[4 / 10] best test accuracy: 89.487 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 90.694, 'best_test_valid/acc_unbiased': 91.619, 'best_test_valid/diff': 3.67, 'best_test_valid/acc_skew': 92.303, 'best_test_valid/acc_align': 90.934, 'best_test_test/acc': 89.908, 'best_test_test/acc_unbiased': 89.487, 'best_test_test/diff': 2.518, 'best_test_test/acc_skew': 88.228, 'best_test_test/acc_align': 90.746}
[5 / 10] Learning rate: 0.0001
[5 / 10] Loss: 0.8318
[5 / 10] tensor([[0.925, 0.875],
        [0.875, 0.887]]) {'epoch': 5, 'valid/acc': 91.409, 'valid/acc_unbiased': 92.145, 'valid/diff': 3.852, 'valid/acc_skew': 92.79, 'valid/acc_align': 91.499, 'test/acc': 90.109, 'test/acc_unbiased': 89.058, 'test/diff': 3.069, 'test/acc_skew': 87.524, 'test/acc_align': 90.592}
[5 / 10] best valid accuracy: 92.145 at epoch 5 
 best_stats: {'best_valid_epoch': 5, 'best_valid_valid/acc': 91.409, 'best_valid_valid/acc_unbiased': 92.145, 'best_valid_valid/diff': 3.852, 'best_valid_valid/acc_skew': 92.79, 'best_valid_valid/acc_align': 91.499, 'best_valid_test/acc': 90.109, 'best_valid_test/acc_unbiased': 89.058, 'best_valid_test/diff': 3.069, 'best_valid_test/acc_skew': 87.524, 'best_valid_test/acc_align': 90.592}
[5 / 10] best test accuracy: 89.487 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 90.694, 'best_test_valid/acc_unbiased': 91.619, 'best_test_valid/diff': 3.67, 'best_test_valid/acc_skew': 92.303, 'best_test_valid/acc_align': 90.934, 'best_test_test/acc': 89.908, 'best_test_test/acc_unbiased': 89.487, 'best_test_test/diff': 2.518, 'best_test_test/acc_skew': 88.228, 'best_test_test/acc_align': 90.746}
[6 / 10] Learning rate: 0.0001
[6 / 10] Loss: 0.7721
[6 / 10] tensor([[0.937, 0.892],
        [0.849, 0.864]]) {'epoch': 6, 'valid/acc': 92.73, 'valid/acc_unbiased': 92.986, 'valid/diff': 4.512, 'valid/acc_skew': 94.158, 'valid/acc_align': 91.814, 'test/acc': 90.718, 'test/acc_unbiased': 88.565, 'test/diff': 3.003, 'test/acc_skew': 87.064, 'test/acc_align': 90.067}
[6 / 10] best valid accuracy: 92.986 at epoch 6 
 best_stats: {'best_valid_epoch': 6, 'best_valid_valid/acc': 92.73, 'best_valid_valid/acc_unbiased': 92.986, 'best_valid_valid/diff': 4.512, 'best_valid_valid/acc_skew': 94.158, 'best_valid_valid/acc_align': 91.814, 'best_valid_test/acc': 90.718, 'best_valid_test/acc_unbiased': 88.565, 'best_valid_test/diff': 3.003, 'best_valid_test/acc_skew': 87.064, 'best_valid_test/acc_align': 90.067}
[6 / 10] best test accuracy: 89.487 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 90.694, 'best_test_valid/acc_unbiased': 91.619, 'best_test_valid/diff': 3.67, 'best_test_valid/acc_skew': 92.303, 'best_test_valid/acc_align': 90.934, 'best_test_test/acc': 89.908, 'best_test_test/acc_unbiased': 89.487, 'best_test_test/diff': 2.518, 'best_test_test/acc_skew': 88.228, 'best_test_test/acc_align': 90.746}
[7 / 10] Learning rate: 1e-05
[7 / 10] Loss: 0.6871
[7 / 10] tensor([[0.932, 0.882],
        [0.857, 0.881]]) {'epoch': 7, 'valid/acc': 92.347, 'valid/acc_unbiased': 93.089, 'valid/diff': 3.925, 'valid/acc_skew': 93.831, 'valid/acc_align': 92.347, 'test/acc': 90.401, 'test/acc_unbiased': 88.786, 'test/diff': 3.716, 'test/acc_skew': 86.928, 'test/acc_align': 90.644}
[7 / 10] best valid accuracy: 93.089 at epoch 7 
 best_stats: {'best_valid_epoch': 7, 'best_valid_valid/acc': 92.347, 'best_valid_valid/acc_unbiased': 93.089, 'best_valid_valid/diff': 3.925, 'best_valid_valid/acc_skew': 93.831, 'best_valid_valid/acc_align': 92.347, 'best_valid_test/acc': 90.401, 'best_valid_test/acc_unbiased': 88.786, 'best_valid_test/diff': 3.716, 'best_valid_test/acc_skew': 86.928, 'best_valid_test/acc_align': 90.644}
[7 / 10] best test accuracy: 89.487 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 90.694, 'best_test_valid/acc_unbiased': 91.619, 'best_test_valid/diff': 3.67, 'best_test_valid/acc_skew': 92.303, 'best_test_valid/acc_align': 90.934, 'best_test_test/acc': 89.908, 'best_test_test/acc_unbiased': 89.487, 'best_test_test/diff': 2.518, 'best_test_test/acc_skew': 88.228, 'best_test_test/acc_align': 90.746}
[8 / 10] Learning rate: 1e-05
[8 / 10] Loss: 0.6660
[8 / 10] tensor([[0.927, 0.871],
        [0.865, 0.895]]) {'epoch': 8, 'valid/acc': 92.142, 'valid/acc_unbiased': 93.37, 'valid/diff': 3.665, 'valid/acc_skew': 93.731, 'valid/acc_align': 93.008, 'test/acc': 90.104, 'test/acc_unbiased': 88.95, 'test/diff': 4.305, 'test/acc_skew': 86.798, 'test/acc_align': 91.103}
[8 / 10] best valid accuracy: 93.370 at epoch 8 
 best_stats: {'best_valid_epoch': 8, 'best_valid_valid/acc': 92.142, 'best_valid_valid/acc_unbiased': 93.37, 'best_valid_valid/diff': 3.665, 'best_valid_valid/acc_skew': 93.731, 'best_valid_valid/acc_align': 93.008, 'best_valid_test/acc': 90.104, 'best_valid_test/acc_unbiased': 88.95, 'best_valid_test/diff': 4.305, 'best_valid_test/acc_skew': 86.798, 'best_valid_test/acc_align': 91.103}
[8 / 10] best test accuracy: 89.487 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 90.694, 'best_test_valid/acc_unbiased': 91.619, 'best_test_valid/diff': 3.67, 'best_test_valid/acc_skew': 92.303, 'best_test_valid/acc_align': 90.934, 'best_test_test/acc': 89.908, 'best_test_test/acc_unbiased': 89.487, 'best_test_test/diff': 2.518, 'best_test_test/acc_skew': 88.228, 'best_test_test/acc_align': 90.746}
[9 / 10] Learning rate: 1e-05
[9 / 10] Loss: 0.6479
[9 / 10] tensor([[0.931, 0.865],
        [0.856, 0.896]]) {'epoch': 9, 'valid/acc': 92.483, 'valid/acc_unbiased': 93.591, 'valid/diff': 3.961, 'valid/acc_skew': 93.782, 'valid/acc_align': 93.4, 'test/acc': 90.064, 'test/acc_unbiased': 88.711, 'test/diff': 5.284, 'test/acc_skew': 86.069, 'test/acc_align': 91.353}
[9 / 10] best valid accuracy: 93.591 at epoch 9 
 best_stats: {'best_valid_epoch': 9, 'best_valid_valid/acc': 92.483, 'best_valid_valid/acc_unbiased': 93.591, 'best_valid_valid/diff': 3.961, 'best_valid_valid/acc_skew': 93.782, 'best_valid_valid/acc_align': 93.4, 'best_valid_test/acc': 90.064, 'best_valid_test/acc_unbiased': 88.711, 'best_valid_test/diff': 5.284, 'best_valid_test/acc_skew': 86.069, 'best_valid_test/acc_align': 91.353}
[9 / 10] best test accuracy: 89.487 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 90.694, 'best_test_valid/acc_unbiased': 91.619, 'best_test_valid/diff': 3.67, 'best_test_valid/acc_skew': 92.303, 'best_test_valid/acc_align': 90.934, 'best_test_test/acc': 89.908, 'best_test_test/acc_unbiased': 89.487, 'best_test_test/diff': 2.518, 'best_test_test/acc_skew': 88.228, 'best_test_test/acc_align': 90.746}
[10 / 10] Learning rate: 1e-05
[10 / 10] Loss: 0.6312
[10 / 10] tensor([[0.937, 0.878],
        [0.835, 0.885]]) {'epoch': 10, 'valid/acc': 93.068, 'valid/acc_unbiased': 93.793, 'valid/diff': 3.959, 'valid/acc_skew': 94.203, 'valid/acc_align': 93.383, 'test/acc': 90.436, 'test/acc_unbiased': 88.383, 'test/diff': 5.468, 'test/acc_skew': 85.649, 'test/acc_align': 91.117}
[10 / 10] best valid accuracy: 93.793 at epoch 10 
 best_stats: {'best_valid_epoch': 10, 'best_valid_valid/acc': 93.068, 'best_valid_valid/acc_unbiased': 93.793, 'best_valid_valid/diff': 3.959, 'best_valid_valid/acc_skew': 94.203, 'best_valid_valid/acc_align': 93.383, 'best_valid_test/acc': 90.436, 'best_valid_test/acc_unbiased': 88.383, 'best_valid_test/diff': 5.468, 'best_valid_test/acc_skew': 85.649, 'best_valid_test/acc_align': 91.117}
[10 / 10] best test accuracy: 89.487 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 90.694, 'best_test_valid/acc_unbiased': 91.619, 'best_test_valid/diff': 3.67, 'best_test_valid/acc_skew': 92.303, 'best_test_valid/acc_align': 90.934, 'best_test_test/acc': 89.908, 'best_test_test/acc_unbiased': 89.487, 'best_test_test/diff': 2.518, 'best_test_test/acc_skew': 88.228, 'best_test_test/acc_align': 90.746}
Total training time: 1:01:40
