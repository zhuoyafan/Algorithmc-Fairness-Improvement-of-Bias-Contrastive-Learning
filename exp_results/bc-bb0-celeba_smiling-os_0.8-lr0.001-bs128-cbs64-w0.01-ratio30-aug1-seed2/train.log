Log level set to: INFO
Set seed: 2
=======> Using Fixed Random Seed: 2 <========
save_path: exp_results/bc-bb0-celeba_smiling-os_0.8-lr0.001-bs128-cbs64-w0.01-ratio30-aug1-seed2
get_celeba - split:train, aug: False, given_y: True, ratio: 0
use existing smiling indices from data/celeba/pickles/smiling
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [32488, 32488]
Target 1: [32488, 32488]
Binary Target 1
---------------------------
Target 0: [32488, 32488]
Target 1: [32488, 32488]
===================================
Normal Label Distribution: 
Target 0: [32488, 32488]
Target 1: [32488, 32488]
===================================
Use BiasedCelebASplit 
 target_attr: smiling split: train 
 tensor([[32488., 32488.],
        [32488., 32488.]])
get_celeba - split:train, aug: 1, given_y: True, ratio: 30
use existing smiling indices from data/celeba/pickles/smiling
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [32615, 32615]
Target 1: [32615, 32615]
Binary Target 1
---------------------------
Target 0: [32615, 32615]
Target 1: [32615, 32615]
===================================
Normal Label Distribution: 
Target 0: [32615, 32615]
Target 1: [32615, 32615]
===================================
Use BiasedCelebASplit 
 target_attr: smiling split: train 
 tensor([[32615., 32615.],
        [32615., 32615.]])
get_celeba - split:train_valid, aug: False, given_y: True, ratio: 0
use existing smiling indices from data/celeba/pickles/smiling
Use BiasedCelebASplit 
 target_attr: smiling split: train_valid 
 tensor([[ 1973., 10114.],
        [ 8289.,  1989.]])
get_celeba - split:valid, aug: False, given_y: True, ratio: 0
Use BiasedCelebASplit 
 target_attr: smiling split: valid 
 tensor([[5252., 6157.],
        [5013., 3445.]])
decay_epochs: [3, 6]
[1 / 10] Learning rate: 0.001 weight: 0.01
[1 / 10] Loss: 4.639615305712939 CE Loss: 0.2603828429889573 Con Loss: 4.637011475528998
[1 / 10] tensor([[0.932, 0.930],
        [0.912, 0.891]]) {'epoch': 1, 'valid/acc': 91.473, 'valid/acc_unbiased': 91.104, 'valid/diff': 1.49, 'valid/acc_skew': 91.849, 'valid/acc_align': 90.359, 'test/acc': 91.811, 'test/acc_unbiased': 91.615, 'test/diff': 1.154, 'test/acc_skew': 92.192, 'test/acc_align': 91.037}
[1 / 10] best valid accuracy: 91.104 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 91.473, 'best_valid_valid/acc_unbiased': 91.104, 'best_valid_valid/diff': 1.49, 'best_valid_valid/acc_skew': 91.849, 'best_valid_valid/acc_align': 90.359, 'best_valid_test/acc': 91.811, 'best_valid_test/acc_unbiased': 91.615, 'best_valid_test/diff': 1.154, 'best_valid_test/acc_skew': 92.192, 'best_valid_test/acc_align': 91.037}
[1 / 10] best test accuracy: 91.615 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 91.473, 'best_test_valid/acc_unbiased': 91.104, 'best_test_valid/diff': 1.49, 'best_test_valid/acc_skew': 91.849, 'best_test_valid/acc_align': 90.359, 'best_test_test/acc': 91.811, 'best_test_test/acc_unbiased': 91.615, 'best_test_test/diff': 1.154, 'best_test_test/acc_skew': 92.192, 'best_test_test/acc_align': 91.037}
[2 / 10] Learning rate: 0.001 weight: 0.01
[2 / 10] Loss: 4.599199828359477 CE Loss: 0.2317298121880616 Con Loss: 4.596882521651174
[2 / 10] tensor([[0.857, 0.822],
        [0.953, 0.956]]) {'epoch': 2, 'valid/acc': 89.855, 'valid/acc_unbiased': 90.002, 'valid/diff': 2.479, 'valid/acc_skew': 91.242, 'valid/acc_align': 88.763, 'test/acc': 89.525, 'test/acc_unbiased': 89.719, 'test/diff': 1.928, 'test/acc_skew': 90.521, 'test/acc_align': 88.916}
[2 / 10] best valid accuracy: 91.104 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 91.473, 'best_valid_valid/acc_unbiased': 91.104, 'best_valid_valid/diff': 1.49, 'best_valid_valid/acc_skew': 91.849, 'best_valid_valid/acc_align': 90.359, 'best_valid_test/acc': 91.811, 'best_valid_test/acc_unbiased': 91.615, 'best_valid_test/diff': 1.154, 'best_valid_test/acc_skew': 92.192, 'best_valid_test/acc_align': 91.037}
[2 / 10] best test accuracy: 91.615 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 91.473, 'best_test_valid/acc_unbiased': 91.104, 'best_test_valid/diff': 1.49, 'best_test_valid/acc_skew': 91.849, 'best_test_valid/acc_align': 90.359, 'best_test_test/acc': 91.811, 'best_test_test/acc_unbiased': 91.615, 'best_test_test/diff': 1.154, 'best_test_test/acc_skew': 92.192, 'best_test_test/acc_align': 91.037}
[3 / 10] Learning rate: 0.001 weight: 0.01
[3 / 10] Loss: 4.590028505670528 CE Loss: 0.2181238800643172 Con Loss: 4.587847265930664
[3 / 10] tensor([[0.965, 0.953],
        [0.883, 0.871]]) {'epoch': 3, 'valid/acc': 91.303, 'valid/acc_unbiased': 91.722, 'valid/diff': 1.512, 'valid/acc_skew': 92.478, 'valid/acc_align': 90.966, 'test/acc': 92.032, 'test/acc_unbiased': 91.805, 'test/diff': 1.215, 'test/acc_skew': 92.412, 'test/acc_align': 91.197}
[3 / 10] best valid accuracy: 91.722 at epoch 3 
 best_stats: {'best_valid_epoch': 3, 'best_valid_valid/acc': 91.303, 'best_valid_valid/acc_unbiased': 91.722, 'best_valid_valid/diff': 1.512, 'best_valid_valid/acc_skew': 92.478, 'best_valid_valid/acc_align': 90.966, 'best_valid_test/acc': 92.032, 'best_valid_test/acc_unbiased': 91.805, 'best_valid_test/diff': 1.215, 'best_valid_test/acc_skew': 92.412, 'best_valid_test/acc_align': 91.197}
[3 / 10] best test accuracy: 91.805 at epoch 3 
 best_stats: {'best_test_epoch': 3, 'best_test_valid/acc': 91.303, 'best_test_valid/acc_unbiased': 91.722, 'best_test_valid/diff': 1.512, 'best_test_valid/acc_skew': 92.478, 'best_test_valid/acc_align': 90.966, 'best_test_test/acc': 92.032, 'best_test_test/acc_unbiased': 91.805, 'best_test_test/diff': 1.215, 'best_test_test/acc_skew': 92.412, 'best_test_test/acc_align': 91.197}
[4 / 10] Learning rate: 0.0001 weight: 0.01
[4 / 10] Loss: 4.546297229531069 CE Loss: 0.19490191020480638 Con Loss: 4.544348216062694
[4 / 10] tensor([[0.950, 0.935],
        [0.913, 0.907]]) {'epoch': 4, 'valid/acc': 92.461, 'valid/acc_unbiased': 92.6, 'valid/diff': 1.491, 'valid/acc_skew': 93.345, 'valid/acc_align': 91.854, 'test/acc': 92.717, 'test/acc_unbiased': 92.615, 'test/diff': 1.022, 'test/acc_skew': 93.126, 'test/acc_align': 92.104}
[4 / 10] best valid accuracy: 92.600 at epoch 4 
 best_stats: {'best_valid_epoch': 4, 'best_valid_valid/acc': 92.461, 'best_valid_valid/acc_unbiased': 92.6, 'best_valid_valid/diff': 1.491, 'best_valid_valid/acc_skew': 93.345, 'best_valid_valid/acc_align': 91.854, 'best_valid_test/acc': 92.717, 'best_valid_test/acc_unbiased': 92.615, 'best_valid_test/diff': 1.022, 'best_valid_test/acc_skew': 93.126, 'best_valid_test/acc_align': 92.104}
[4 / 10] best test accuracy: 92.615 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 92.461, 'best_test_valid/acc_unbiased': 92.6, 'best_test_valid/diff': 1.491, 'best_test_valid/acc_skew': 93.345, 'best_test_valid/acc_align': 91.854, 'best_test_test/acc': 92.717, 'best_test_test/acc_unbiased': 92.615, 'best_test_test/diff': 1.022, 'best_test_test/acc_skew': 93.126, 'best_test_test/acc_align': 92.104}
[5 / 10] Learning rate: 0.0001 weight: 0.01
[5 / 10] Loss: 4.535162888146245 CE Loss: 0.18985902331631865 Con Loss: 4.533264302350242
[5 / 10] tensor([[0.937, 0.920],
        [0.929, 0.925]]) {'epoch': 5, 'valid/acc': 92.9, 'valid/acc_unbiased': 93.143, 'valid/diff': 1.416, 'valid/acc_skew': 93.851, 'valid/acc_align': 92.435, 'test/acc': 92.792, 'test/acc_unbiased': 92.751, 'test/diff': 1.028, 'test/acc_skew': 93.265, 'test/acc_align': 92.237}
[5 / 10] best valid accuracy: 93.143 at epoch 5 
 best_stats: {'best_valid_epoch': 5, 'best_valid_valid/acc': 92.9, 'best_valid_valid/acc_unbiased': 93.143, 'best_valid_valid/diff': 1.416, 'best_valid_valid/acc_skew': 93.851, 'best_valid_valid/acc_align': 92.435, 'best_valid_test/acc': 92.792, 'best_valid_test/acc_unbiased': 92.751, 'best_valid_test/diff': 1.028, 'best_valid_test/acc_skew': 93.265, 'best_valid_test/acc_align': 92.237}
[5 / 10] best test accuracy: 92.751 at epoch 5 
 best_stats: {'best_test_epoch': 5, 'best_test_valid/acc': 92.9, 'best_test_valid/acc_unbiased': 93.143, 'best_test_valid/diff': 1.416, 'best_test_valid/acc_skew': 93.851, 'best_test_valid/acc_align': 92.435, 'best_test_test/acc': 92.792, 'best_test_test/acc_unbiased': 92.751, 'best_test_test/diff': 1.028, 'best_test_test/acc_skew': 93.265, 'best_test_test/acc_align': 92.237}
[6 / 10] Learning rate: 0.0001 weight: 0.01
[6 / 10] Loss: 4.526785744965531 CE Loss: 0.18690789020346232 Con Loss: 4.52491667211364
[6 / 10] tensor([[0.945, 0.932],
        [0.921, 0.908]]) {'epoch': 6, 'valid/acc': 92.922, 'valid/acc_unbiased': 92.998, 'valid/diff': 1.312, 'valid/acc_skew': 93.654, 'valid/acc_align': 92.342, 'test/acc': 92.772, 'test/acc_unbiased': 92.635, 'test/diff': 1.302, 'test/acc_skew': 93.286, 'test/acc_align': 91.983}
[6 / 10] best valid accuracy: 93.143 at epoch 5 
 best_stats: {'best_valid_epoch': 5, 'best_valid_valid/acc': 92.9, 'best_valid_valid/acc_unbiased': 93.143, 'best_valid_valid/diff': 1.416, 'best_valid_valid/acc_skew': 93.851, 'best_valid_valid/acc_align': 92.435, 'best_valid_test/acc': 92.792, 'best_valid_test/acc_unbiased': 92.751, 'best_valid_test/diff': 1.028, 'best_valid_test/acc_skew': 93.265, 'best_valid_test/acc_align': 92.237}
[6 / 10] best test accuracy: 92.751 at epoch 5 
 best_stats: {'best_test_epoch': 5, 'best_test_valid/acc': 92.9, 'best_test_valid/acc_unbiased': 93.143, 'best_test_valid/diff': 1.416, 'best_test_valid/acc_skew': 93.851, 'best_test_valid/acc_align': 92.435, 'best_test_test/acc': 92.792, 'best_test_test/acc_unbiased': 92.751, 'best_test_test/diff': 1.028, 'best_test_test/acc_skew': 93.265, 'best_test_test/acc_align': 92.237}
[7 / 10] Learning rate: 1e-05 weight: 0.01
[7 / 10] Loss: 4.526689584957969 CE Loss: 0.18204590054978823 Con Loss: 4.524869124603459
[7 / 10] tensor([[0.956, 0.942],
        [0.912, 0.898]]) {'epoch': 7, 'valid/acc': 92.837, 'valid/acc_unbiased': 93.013, 'valid/diff': 1.114, 'valid/acc_skew': 93.57, 'valid/acc_align': 92.456, 'test/acc': 92.883, 'test/acc_unbiased': 92.708, 'test/diff': 1.401, 'test/acc_skew': 93.409, 'test/acc_align': 92.008}
[7 / 10] best valid accuracy: 93.143 at epoch 5 
 best_stats: {'best_valid_epoch': 5, 'best_valid_valid/acc': 92.9, 'best_valid_valid/acc_unbiased': 93.143, 'best_valid_valid/diff': 1.416, 'best_valid_valid/acc_skew': 93.851, 'best_valid_valid/acc_align': 92.435, 'best_valid_test/acc': 92.792, 'best_valid_test/acc_unbiased': 92.751, 'best_valid_test/diff': 1.028, 'best_valid_test/acc_skew': 93.265, 'best_valid_test/acc_align': 92.237}
[7 / 10] best test accuracy: 92.751 at epoch 5 
 best_stats: {'best_test_epoch': 5, 'best_test_valid/acc': 92.9, 'best_test_valid/acc_unbiased': 93.143, 'best_test_valid/diff': 1.416, 'best_test_valid/acc_skew': 93.851, 'best_test_valid/acc_align': 92.435, 'best_test_test/acc': 92.792, 'best_test_test/acc_unbiased': 92.751, 'best_test_test/diff': 1.028, 'best_test_test/acc_skew': 93.265, 'best_test_test/acc_align': 92.237}
[8 / 10] Learning rate: 1e-05 weight: 0.01
[8 / 10] Loss: 4.5199156730405745 CE Loss: 0.18079167285581377 Con Loss: 4.518107755464217
[8 / 10] tensor([[0.951, 0.935],
        [0.920, 0.904]]) {'epoch': 8, 'valid/acc': 93.043, 'valid/acc_unbiased': 93.127, 'valid/diff': 1.362, 'valid/acc_skew': 93.808, 'valid/acc_align': 92.446, 'test/acc': 92.938, 'test/acc_unbiased': 92.764, 'test/diff': 1.6, 'test/acc_skew': 93.565, 'test/acc_align': 91.964}
[8 / 10] best valid accuracy: 93.143 at epoch 5 
 best_stats: {'best_valid_epoch': 5, 'best_valid_valid/acc': 92.9, 'best_valid_valid/acc_unbiased': 93.143, 'best_valid_valid/diff': 1.416, 'best_valid_valid/acc_skew': 93.851, 'best_valid_valid/acc_align': 92.435, 'best_valid_test/acc': 92.792, 'best_valid_test/acc_unbiased': 92.751, 'best_valid_test/diff': 1.028, 'best_valid_test/acc_skew': 93.265, 'best_valid_test/acc_align': 92.237}
[8 / 10] best test accuracy: 92.764 at epoch 8 
 best_stats: {'best_test_epoch': 8, 'best_test_valid/acc': 93.043, 'best_test_valid/acc_unbiased': 93.127, 'best_test_valid/diff': 1.362, 'best_test_valid/acc_skew': 93.808, 'best_test_valid/acc_align': 92.446, 'best_test_test/acc': 92.938, 'best_test_test/acc_unbiased': 92.764, 'best_test_test/diff': 1.6, 'best_test_test/acc_skew': 93.565, 'best_test_test/acc_align': 91.964}
[9 / 10] Learning rate: 1e-05 weight: 0.01
[9 / 10] Loss: 4.513004652416433 CE Loss: 0.18000428884583017 Con Loss: 4.511204612927318
[9 / 10] tensor([[0.944, 0.930],
        [0.924, 0.915]]) {'epoch': 9, 'valid/acc': 93.083, 'valid/acc_unbiased': 93.163, 'valid/diff': 1.263, 'valid/acc_skew': 93.794, 'valid/acc_align': 92.532, 'test/acc': 92.928, 'test/acc_unbiased': 92.83, 'test/diff': 1.119, 'test/acc_skew': 93.39, 'test/acc_align': 92.271}
[9 / 10] best valid accuracy: 93.163 at epoch 9 
 best_stats: {'best_valid_epoch': 9, 'best_valid_valid/acc': 93.083, 'best_valid_valid/acc_unbiased': 93.163, 'best_valid_valid/diff': 1.263, 'best_valid_valid/acc_skew': 93.794, 'best_valid_valid/acc_align': 92.532, 'best_valid_test/acc': 92.928, 'best_valid_test/acc_unbiased': 92.83, 'best_valid_test/diff': 1.119, 'best_valid_test/acc_skew': 93.39, 'best_valid_test/acc_align': 92.271}
[9 / 10] best test accuracy: 92.830 at epoch 9 
 best_stats: {'best_test_epoch': 9, 'best_test_valid/acc': 93.083, 'best_test_valid/acc_unbiased': 93.163, 'best_test_valid/diff': 1.263, 'best_test_valid/acc_skew': 93.794, 'best_test_valid/acc_align': 92.532, 'best_test_test/acc': 92.928, 'best_test_test/acc_unbiased': 92.83, 'best_test_test/diff': 1.119, 'best_test_test/acc_skew': 93.39, 'best_test_test/acc_align': 92.271}
[10 / 10] Learning rate: 1e-05 weight: 0.01
[10 / 10] Loss: 4.517295343422062 CE Loss: 0.17973835188395518 Con Loss: 4.515497954306829
[10 / 10] tensor([[0.949, 0.932],
        [0.921, 0.909]]) {'epoch': 10, 'valid/acc': 93.141, 'valid/acc_unbiased': 93.254, 'valid/diff': 1.193, 'valid/acc_skew': 93.85, 'valid/acc_align': 92.657, 'test/acc': 92.918, 'test/acc_unbiased': 92.784, 'test/diff': 1.416, 'test/acc_skew': 93.492, 'test/acc_align': 92.076}
[10 / 10] best valid accuracy: 93.254 at epoch 10 
 best_stats: {'best_valid_epoch': 10, 'best_valid_valid/acc': 93.141, 'best_valid_valid/acc_unbiased': 93.254, 'best_valid_valid/diff': 1.193, 'best_valid_valid/acc_skew': 93.85, 'best_valid_valid/acc_align': 92.657, 'best_valid_test/acc': 92.918, 'best_valid_test/acc_unbiased': 92.784, 'best_valid_test/diff': 1.416, 'best_valid_test/acc_skew': 93.492, 'best_valid_test/acc_align': 92.076}
[10 / 10] best test accuracy: 92.830 at epoch 9 
 best_stats: {'best_test_epoch': 9, 'best_test_valid/acc': 93.083, 'best_test_valid/acc_unbiased': 93.163, 'best_test_valid/diff': 1.263, 'best_test_valid/acc_skew': 93.794, 'best_test_valid/acc_align': 92.532, 'best_test_test/acc': 92.928, 'best_test_test/acc_unbiased': 92.83, 'best_test_test/diff': 1.119, 'best_test_test/acc_skew': 93.39, 'best_test_test/acc_align': 92.271}
Total training time: 2:06:06
