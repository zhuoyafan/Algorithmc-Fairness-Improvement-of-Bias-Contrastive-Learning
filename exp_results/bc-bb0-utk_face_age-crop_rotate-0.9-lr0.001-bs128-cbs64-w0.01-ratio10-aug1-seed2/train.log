Log level set to: INFO
Set seed: 2
=======> Using Fixed Random Seed: 2 <========
save_path: exp_results/bc-bb0-utk_face_age-crop_rotate-0.9-lr0.001-bs128-cbs64-w0.01-ratio10-aug1-seed2
get_utk_face - split: train, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_age-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
Binary Target 1
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Normal Label Distribution: 
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
Binary Target 1
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Normal Label Distribution: 
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 10684, target_attr: gender, bias_attr: age bias_rate: 0.9
['[train] target_0-bias_0: 8237', '[train] target_0-bias_1: 147', '[train] target_1-bias_0: 823', '[train] target_1-bias_1: 1477']
confusion_matrix - 
 original: tensor([[8237.,  823.],
        [ 147., 1477.]]), 
 normalized: tensor([[0.909, 0.091],
        [0.091, 0.909]]), 
 b|y: tensor([[0.982, 0.018],
        [0.358, 0.642]])
get_utk_face - split: train, aug: 1, given_y: True, ratio: 10
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_age-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
Binary Target 1
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Normal Label Distribution: 
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
Binary Target 1
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Normal Label Distribution: 
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 10684, target_attr: gender, bias_attr: age bias_rate: 0.9
['[train] target_0-bias_0: 8237', '[train] target_0-bias_1: 147', '[train] target_1-bias_0: 823', '[train] target_1-bias_1: 1477']
get_utk_face - split: valid, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_age-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [1030, 195]
Target 1: [841, 202]
Binary Target 1
---------------------------
Target 0: [1030, 195]
Target 1: [841, 202]
===================================
Normal Label Distribution: 
Target 0: [1030, 195]
Target 1: [841, 202]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 2268, target_attr: gender, bias_attr: age bias_rate: 0.9
['[valid] target_0-bias_0: 1030', '[valid] target_0-bias_1: 195', '[valid] target_1-bias_0: 841', '[valid] target_1-bias_1: 202']
get_utk_face - split: test, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_age-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [1061, 176]
Target 1: [867, 165]
Binary Target 1
---------------------------
Target 0: [1061, 176]
Target 1: [867, 165]
===================================
Normal Label Distribution: 
Target 0: [1061, 176]
Target 1: [867, 165]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 2269, target_attr: gender, bias_attr: age bias_rate: 0.9
['[test] target_0-bias_0: 1061', '[test] target_0-bias_1: 176', '[test] target_1-bias_0: 867', '[test] target_1-bias_1: 165']
decay_epochs: [6, 13]
[1 / 20] Learning rate: 0.001 weight: 0.01
[1 / 20] Loss: 4.821723969587 CE Loss: 0.5716518264435418 Con Loss: 4.8160074338266705
[1 / 20] tensor([[0.995, 1.000],
        [0.006, 0.000]]) {'epoch': 1, 'valid/acc': 54.233, 'valid/acc_unbiased': 50.342, 'valid/diff': 0.306, 'valid/acc_skew': 50.238, 'valid/acc_align': 50.447, 'test/acc': 54.517, 'test/acc_unbiased': 50.026, 'test/diff': 0.524, 'test/acc_skew': 50.288, 'test/acc_align': 49.764}
[1 / 20] best valid accuracy: 50.342 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 54.233, 'best_valid_valid/acc_unbiased': 50.342, 'best_valid_valid/diff': 0.306, 'best_valid_valid/acc_skew': 50.238, 'best_valid_valid/acc_align': 50.447, 'best_valid_test/acc': 54.517, 'best_valid_test/acc_unbiased': 50.026, 'best_valid_test/diff': 0.524, 'best_valid_test/acc_skew': 50.288, 'best_valid_test/acc_align': 49.764}
[1 / 20] best test accuracy: 50.026 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 54.233, 'best_test_valid/acc_unbiased': 50.342, 'best_test_valid/diff': 0.306, 'best_test_valid/acc_skew': 50.238, 'best_test_valid/acc_align': 50.447, 'best_test_test/acc': 54.517, 'best_test_test/acc_unbiased': 50.026, 'best_test_test/diff': 0.524, 'best_test_test/acc_skew': 50.288, 'best_test_test/acc_align': 49.764}
[2 / 20] Learning rate: 0.001 weight: 0.01
[2 / 20] Loss: 4.668549996643466 CE Loss: 0.5480258879434835 Con Loss: 4.663069695758712
[2 / 20] tensor([[0.976, 0.983],
        [0.129, 0.036]]) {'epoch': 2, 'valid/acc': 57.672, 'valid/acc_unbiased': 53.132, 'valid/diff': 4.245, 'valid/acc_skew': 55.254, 'valid/acc_align': 51.009, 'test/acc': 58.484, 'test/acc_unbiased': 53.123, 'test/diff': 4.967, 'test/acc_skew': 55.607, 'test/acc_align': 50.64}
[2 / 20] best valid accuracy: 53.132 at epoch 2 
 best_stats: {'best_valid_epoch': 2, 'best_valid_valid/acc': 57.672, 'best_valid_valid/acc_unbiased': 53.132, 'best_valid_valid/diff': 4.245, 'best_valid_valid/acc_skew': 55.254, 'best_valid_valid/acc_align': 51.009, 'best_valid_test/acc': 58.484, 'best_valid_test/acc_unbiased': 53.123, 'best_valid_test/diff': 4.967, 'best_valid_test/acc_skew': 55.607, 'best_valid_test/acc_align': 50.64}
[2 / 20] best test accuracy: 53.123 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 57.672, 'best_test_valid/acc_unbiased': 53.132, 'best_test_valid/diff': 4.245, 'best_test_valid/acc_skew': 55.254, 'best_test_valid/acc_align': 51.009, 'best_test_test/acc': 58.484, 'best_test_test/acc_unbiased': 53.123, 'best_test_test/diff': 4.967, 'best_test_test/acc_skew': 55.607, 'best_test_test/acc_align': 50.64}
[3 / 20] Learning rate: 0.001 weight: 0.01
[3 / 20] Loss: 4.679177562380855 CE Loss: 0.527434169487398 Con Loss: 4.673903237117537
[3 / 20] tensor([[0.976, 0.949],
        [0.121, 0.145]]) {'epoch': 3, 'valid/acc': 58.951, 'valid/acc_unbiased': 55.679, 'valid/diff': 3.444, 'valid/acc_skew': 53.957, 'valid/acc_align': 57.401, 'test/acc': 58.704, 'test/acc_unbiased': 54.797, 'test/diff': 2.596, 'test/acc_skew': 53.499, 'test/acc_align': 56.095}
[3 / 20] best valid accuracy: 55.679 at epoch 3 
 best_stats: {'best_valid_epoch': 3, 'best_valid_valid/acc': 58.951, 'best_valid_valid/acc_unbiased': 55.679, 'best_valid_valid/diff': 3.444, 'best_valid_valid/acc_skew': 53.957, 'best_valid_valid/acc_align': 57.401, 'best_valid_test/acc': 58.704, 'best_valid_test/acc_unbiased': 54.797, 'best_valid_test/diff': 2.596, 'best_valid_test/acc_skew': 53.499, 'best_valid_test/acc_align': 56.095}
[3 / 20] best test accuracy: 54.797 at epoch 3 
 best_stats: {'best_test_epoch': 3, 'best_test_valid/acc': 58.951, 'best_test_valid/acc_unbiased': 55.679, 'best_test_valid/diff': 3.444, 'best_test_valid/acc_skew': 53.957, 'best_test_valid/acc_align': 57.401, 'best_test_test/acc': 58.704, 'best_test_test/acc_unbiased': 54.797, 'best_test_test/diff': 2.596, 'best_test_test/acc_skew': 53.499, 'best_test_test/acc_align': 56.095}
[4 / 20] Learning rate: 0.001 weight: 0.01
[4 / 20] Loss: 4.651458307671128 CE Loss: 0.5166243004892614 Con Loss: 4.646292061986034
[4 / 20] tensor([[0.948, 0.892],
        [0.314, 0.291]]) {'epoch': 4, 'valid/acc': 64.109, 'valid/acc_unbiased': 60.619, 'valid/diff': 2.782, 'valid/acc_skew': 59.795, 'valid/acc_align': 61.444, 'test/acc': 65.359, 'test/acc_unbiased': 61.121, 'test/diff': 3.947, 'test/acc_skew': 60.289, 'test/acc_align': 61.954}
[4 / 20] best valid accuracy: 60.619 at epoch 4 
 best_stats: {'best_valid_epoch': 4, 'best_valid_valid/acc': 64.109, 'best_valid_valid/acc_unbiased': 60.619, 'best_valid_valid/diff': 2.782, 'best_valid_valid/acc_skew': 59.795, 'best_valid_valid/acc_align': 61.444, 'best_valid_test/acc': 65.359, 'best_valid_test/acc_unbiased': 61.121, 'best_valid_test/diff': 3.947, 'best_valid_test/acc_skew': 60.289, 'best_valid_test/acc_align': 61.954}
[4 / 20] best test accuracy: 61.121 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 64.109, 'best_test_valid/acc_unbiased': 60.619, 'best_test_valid/diff': 2.782, 'best_test_valid/acc_skew': 59.795, 'best_test_valid/acc_align': 61.444, 'best_test_test/acc': 65.359, 'best_test_test/acc_unbiased': 61.121, 'best_test_test/diff': 3.947, 'best_test_test/acc_skew': 60.289, 'best_test_test/acc_align': 61.954}
[5 / 20] Learning rate: 0.001 weight: 0.01
[5 / 20] Loss: 4.602745607076892 CE Loss: 0.5151614964075277 Con Loss: 4.597593989277636
[5 / 20] tensor([[0.985, 0.966],
        [0.194, 0.145]]) {'epoch': 5, 'valid/acc': 61.684, 'valid/acc_unbiased': 57.666, 'valid/diff': 2.55, 'valid/acc_skew': 58.29, 'valid/acc_align': 57.042, 'test/acc': 62.01, 'test/acc_unbiased': 57.251, 'test/diff': 3.366, 'test/acc_skew': 57.984, 'test/acc_align': 56.519}
[5 / 20] best valid accuracy: 60.619 at epoch 4 
 best_stats: {'best_valid_epoch': 4, 'best_valid_valid/acc': 64.109, 'best_valid_valid/acc_unbiased': 60.619, 'best_valid_valid/diff': 2.782, 'best_valid_valid/acc_skew': 59.795, 'best_valid_valid/acc_align': 61.444, 'best_valid_test/acc': 65.359, 'best_valid_test/acc_unbiased': 61.121, 'best_valid_test/diff': 3.947, 'best_valid_test/acc_skew': 60.289, 'best_valid_test/acc_align': 61.954}
[5 / 20] best test accuracy: 61.121 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 64.109, 'best_test_valid/acc_unbiased': 60.619, 'best_test_valid/diff': 2.782, 'best_test_valid/acc_skew': 59.795, 'best_test_valid/acc_align': 61.444, 'best_test_test/acc': 65.359, 'best_test_test/acc_unbiased': 61.121, 'best_test_test/diff': 3.947, 'best_test_test/acc_skew': 60.289, 'best_test_test/acc_align': 61.954}
[6 / 20] Learning rate: 0.001 weight: 0.01
[6 / 20] Loss: 4.602716470380616 CE Loss: 0.49851021234215265 Con Loss: 4.597731382647778
[6 / 20] tensor([[0.989, 0.989],
        [0.104, 0.085]]) {'epoch': 6, 'valid/acc': 58.642, 'valid/acc_unbiased': 54.771, 'valid/diff': 1.204, 'valid/acc_skew': 55.373, 'valid/acc_align': 54.169, 'test/acc': 58.484, 'test/acc_unbiased': 54.15, 'test/diff': 0.951, 'test/acc_skew': 54.622, 'test/acc_align': 53.677}
[6 / 20] best valid accuracy: 60.619 at epoch 4 
 best_stats: {'best_valid_epoch': 4, 'best_valid_valid/acc': 64.109, 'best_valid_valid/acc_unbiased': 60.619, 'best_valid_valid/diff': 2.782, 'best_valid_valid/acc_skew': 59.795, 'best_valid_valid/acc_align': 61.444, 'best_valid_test/acc': 65.359, 'best_valid_test/acc_unbiased': 61.121, 'best_valid_test/diff': 3.947, 'best_valid_test/acc_skew': 60.289, 'best_valid_test/acc_align': 61.954}
[6 / 20] best test accuracy: 61.121 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 64.109, 'best_test_valid/acc_unbiased': 60.619, 'best_test_valid/diff': 2.782, 'best_test_valid/acc_skew': 59.795, 'best_test_valid/acc_align': 61.444, 'best_test_test/acc': 65.359, 'best_test_test/acc_unbiased': 61.121, 'best_test_test/diff': 3.947, 'best_test_test/acc_skew': 60.289, 'best_test_test/acc_align': 61.954}
[7 / 20] Learning rate: 0.0001 weight: 0.01
[7 / 20] Loss: 4.557887804459115 CE Loss: 0.4899810144223778 Con Loss: 4.5529879784592975
[7 / 20] tensor([[0.967, 0.955],
        [0.261, 0.212]]) {'epoch': 7, 'valid/acc': 64.021, 'valid/acc_unbiased': 60.187, 'valid/diff': 2.818, 'valid/acc_skew': 58.817, 'valid/acc_align': 61.556, 'test/acc': 64.125, 'test/acc_unbiased': 59.859, 'test/diff': 3.051, 'test/acc_skew': 60.761, 'test/acc_align': 58.957}
[7 / 20] best valid accuracy: 60.619 at epoch 4 
 best_stats: {'best_valid_epoch': 4, 'best_valid_valid/acc': 64.109, 'best_valid_valid/acc_unbiased': 60.619, 'best_valid_valid/diff': 2.782, 'best_valid_valid/acc_skew': 59.795, 'best_valid_valid/acc_align': 61.444, 'best_valid_test/acc': 65.359, 'best_valid_test/acc_unbiased': 61.121, 'best_valid_test/diff': 3.947, 'best_valid_test/acc_skew': 60.289, 'best_valid_test/acc_align': 61.954}
[7 / 20] best test accuracy: 61.121 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 64.109, 'best_test_valid/acc_unbiased': 60.619, 'best_test_valid/diff': 2.782, 'best_test_valid/acc_skew': 59.795, 'best_test_valid/acc_align': 61.444, 'best_test_test/acc': 65.359, 'best_test_test/acc_unbiased': 61.121, 'best_test_test/diff': 3.947, 'best_test_test/acc_skew': 60.289, 'best_test_test/acc_align': 61.954}
[8 / 20] Learning rate: 0.0001 weight: 0.01
[8 / 20] Loss: 4.512093467241099 CE Loss: 0.47956576270585827 Con Loss: 4.507297794009273
[8 / 20] tensor([[0.957, 0.915],
        [0.394, 0.285]]) {'epoch': 8, 'valid/acc': 68.034, 'valid/acc_unbiased': 63.693, 'valid/diff': 6.066, 'valid/acc_skew': 62.002, 'valid/acc_align': 65.385, 'test/acc': 68.973, 'test/acc_unbiased': 63.768, 'test/diff': 7.574, 'test/acc_skew': 65.462, 'test/acc_align': 62.075}
[8 / 20] best valid accuracy: 63.693 at epoch 8 
 best_stats: {'best_valid_epoch': 8, 'best_valid_valid/acc': 68.034, 'best_valid_valid/acc_unbiased': 63.693, 'best_valid_valid/diff': 6.066, 'best_valid_valid/acc_skew': 62.002, 'best_valid_valid/acc_align': 65.385, 'best_valid_test/acc': 68.973, 'best_valid_test/acc_unbiased': 63.768, 'best_valid_test/diff': 7.574, 'best_valid_test/acc_skew': 65.462, 'best_valid_test/acc_align': 62.075}
[8 / 20] best test accuracy: 63.768 at epoch 8 
 best_stats: {'best_test_epoch': 8, 'best_test_valid/acc': 68.034, 'best_test_valid/acc_unbiased': 63.693, 'best_test_valid/diff': 6.066, 'best_test_valid/acc_skew': 62.002, 'best_test_valid/acc_align': 65.385, 'best_test_test/acc': 68.973, 'best_test_test/acc_unbiased': 63.768, 'best_test_test/diff': 7.574, 'best_test_test/acc_skew': 65.462, 'best_test_test/acc_align': 62.075}
[9 / 20] Learning rate: 0.0001 weight: 0.01
[9 / 20] Loss: 4.461798052714586 CE Loss: 0.47823818898834747 Con Loss: 4.457015695039899
[9 / 20] tensor([[0.970, 0.920],
        [0.376, 0.333]]) {'epoch': 9, 'valid/acc': 67.769, 'valid/acc_unbiased': 64.23, 'valid/diff': 7.348, 'valid/acc_skew': 60.556, 'valid/acc_align': 67.904, 'test/acc': 69.282, 'test/acc_unbiased': 64.991, 'test/diff': 4.603, 'test/acc_skew': 64.823, 'test/acc_align': 65.159}
[9 / 20] best valid accuracy: 64.230 at epoch 9 
 best_stats: {'best_valid_epoch': 9, 'best_valid_valid/acc': 67.769, 'best_valid_valid/acc_unbiased': 64.23, 'best_valid_valid/diff': 7.348, 'best_valid_valid/acc_skew': 60.556, 'best_valid_valid/acc_align': 67.904, 'best_valid_test/acc': 69.282, 'best_valid_test/acc_unbiased': 64.991, 'best_valid_test/diff': 4.603, 'best_valid_test/acc_skew': 64.823, 'best_valid_test/acc_align': 65.159}
[9 / 20] best test accuracy: 64.991 at epoch 9 
 best_stats: {'best_test_epoch': 9, 'best_test_valid/acc': 67.769, 'best_test_valid/acc_unbiased': 64.23, 'best_test_valid/diff': 7.348, 'best_test_valid/acc_skew': 60.556, 'best_test_valid/acc_align': 67.904, 'best_test_test/acc': 69.282, 'best_test_test/acc_unbiased': 64.991, 'best_test_test/diff': 4.603, 'best_test_test/acc_skew': 64.823, 'best_test_test/acc_align': 65.159}
[10 / 20] Learning rate: 0.0001 weight: 0.01
[10 / 20] Loss: 4.440357427479221 CE Loss: 0.4698735137349075 Con Loss: 4.435658693581384
[10 / 20] tensor([[0.963, 0.898],
        [0.415, 0.333]]) {'epoch': 10, 'valid/acc': 69.18, 'valid/acc_unbiased': 64.532, 'valid/diff': 7.319, 'valid/acc_skew': 62.343, 'valid/acc_align': 66.72, 'test/acc': 70.295, 'test/acc_unbiased': 65.238, 'test/diff': 7.37, 'test/acc_skew': 65.648, 'test/acc_align': 64.829}
[10 / 20] best valid accuracy: 64.532 at epoch 10 
 best_stats: {'best_valid_epoch': 10, 'best_valid_valid/acc': 69.18, 'best_valid_valid/acc_unbiased': 64.532, 'best_valid_valid/diff': 7.319, 'best_valid_valid/acc_skew': 62.343, 'best_valid_valid/acc_align': 66.72, 'best_valid_test/acc': 70.295, 'best_valid_test/acc_unbiased': 65.238, 'best_valid_test/diff': 7.37, 'best_valid_test/acc_skew': 65.648, 'best_valid_test/acc_align': 64.829}
[10 / 20] best test accuracy: 65.238 at epoch 10 
 best_stats: {'best_test_epoch': 10, 'best_test_valid/acc': 69.18, 'best_test_valid/acc_unbiased': 64.532, 'best_test_valid/diff': 7.319, 'best_test_valid/acc_skew': 62.343, 'best_test_valid/acc_align': 66.72, 'best_test_test/acc': 70.295, 'best_test_test/acc_unbiased': 65.238, 'best_test_test/diff': 7.37, 'best_test_test/acc_skew': 65.648, 'best_test_test/acc_align': 64.829}
[11 / 20] Learning rate: 0.0001 weight: 0.01
[11 / 20] Loss: 4.399149969515841 CE Loss: 0.46009136880885704 Con Loss: 4.394549074712115
[11 / 20] tensor([[0.979, 0.881],
        [0.363, 0.376]]) {'epoch': 11, 'valid/acc': 67.504, 'valid/acc_unbiased': 63.864, 'valid/diff': 10.925, 'valid/acc_skew': 58.401, 'valid/acc_align': 69.326, 'test/acc': 69.238, 'test/acc_unbiased': 64.976, 'test/diff': 5.551, 'test/acc_skew': 62.2, 'test/acc_align': 67.751}
[11 / 20] best valid accuracy: 64.532 at epoch 10 
 best_stats: {'best_valid_epoch': 10, 'best_valid_valid/acc': 69.18, 'best_valid_valid/acc_unbiased': 64.532, 'best_valid_valid/diff': 7.319, 'best_valid_valid/acc_skew': 62.343, 'best_valid_valid/acc_align': 66.72, 'best_valid_test/acc': 70.295, 'best_valid_test/acc_unbiased': 65.238, 'best_valid_test/diff': 7.37, 'best_valid_test/acc_skew': 65.648, 'best_valid_test/acc_align': 64.829}
[11 / 20] best test accuracy: 65.238 at epoch 10 
 best_stats: {'best_test_epoch': 10, 'best_test_valid/acc': 69.18, 'best_test_valid/acc_unbiased': 64.532, 'best_test_valid/diff': 7.319, 'best_test_valid/acc_skew': 62.343, 'best_test_valid/acc_align': 66.72, 'best_test_test/acc': 70.295, 'best_test_test/acc_unbiased': 65.238, 'best_test_test/diff': 7.37, 'best_test_test/acc_skew': 65.648, 'best_test_test/acc_align': 64.829}
[12 / 20] Learning rate: 0.0001 weight: 0.01
[12 / 20] Loss: 4.457955371838123 CE Loss: 0.4576619807163547 Con Loss: 4.453378749313269
[12 / 20] tensor([[0.970, 0.830],
        [0.429, 0.418]]) {'epoch': 12, 'valid/acc': 69.577, 'valid/acc_unbiased': 65.354, 'valid/diff': 14.701, 'valid/acc_skew': 58.003, 'valid/acc_align': 72.704, 'test/acc': 71.221, 'test/acc_unbiased': 66.166, 'test/diff': 7.559, 'test/acc_skew': 62.931, 'test/acc_align': 69.401}
[12 / 20] best valid accuracy: 65.354 at epoch 12 
 best_stats: {'best_valid_epoch': 12, 'best_valid_valid/acc': 69.577, 'best_valid_valid/acc_unbiased': 65.354, 'best_valid_valid/diff': 14.701, 'best_valid_valid/acc_skew': 58.003, 'best_valid_valid/acc_align': 72.704, 'best_valid_test/acc': 71.221, 'best_valid_test/acc_unbiased': 66.166, 'best_valid_test/diff': 7.559, 'best_valid_test/acc_skew': 62.931, 'best_valid_test/acc_align': 69.401}
[12 / 20] best test accuracy: 66.166 at epoch 12 
 best_stats: {'best_test_epoch': 12, 'best_test_valid/acc': 69.577, 'best_test_valid/acc_unbiased': 65.354, 'best_test_valid/diff': 14.701, 'best_test_valid/acc_skew': 58.003, 'best_test_valid/acc_align': 72.704, 'best_test_test/acc': 71.221, 'best_test_test/acc_unbiased': 66.166, 'best_test_test/diff': 7.559, 'best_test_test/acc_skew': 62.931, 'best_test_test/acc_align': 69.401}
[13 / 20] Learning rate: 0.0001 weight: 0.01
[13 / 20] Loss: 4.414072031208925 CE Loss: 0.45758010134050703 Con Loss: 4.409496217397035
[13 / 20] tensor([[0.975, 0.852],
        [0.428, 0.400]]) {'epoch': 13, 'valid/acc': 69.665, 'valid/acc_unbiased': 65.157, 'valid/diff': 8.154, 'valid/acc_skew': 61.08, 'valid/acc_align': 69.234, 'test/acc': 71.485, 'test/acc_unbiased': 66.392, 'test/diff': 7.557, 'test/acc_skew': 64.009, 'test/acc_align': 68.775}
[13 / 20] best valid accuracy: 65.354 at epoch 12 
 best_stats: {'best_valid_epoch': 12, 'best_valid_valid/acc': 69.577, 'best_valid_valid/acc_unbiased': 65.354, 'best_valid_valid/diff': 14.701, 'best_valid_valid/acc_skew': 58.003, 'best_valid_valid/acc_align': 72.704, 'best_valid_test/acc': 71.221, 'best_valid_test/acc_unbiased': 66.166, 'best_valid_test/diff': 7.559, 'best_valid_test/acc_skew': 62.931, 'best_valid_test/acc_align': 69.401}
[13 / 20] best test accuracy: 66.392 at epoch 13 
 best_stats: {'best_test_epoch': 13, 'best_test_valid/acc': 69.665, 'best_test_valid/acc_unbiased': 65.157, 'best_test_valid/diff': 8.154, 'best_test_valid/acc_skew': 61.08, 'best_test_valid/acc_align': 69.234, 'best_test_test/acc': 71.485, 'best_test_test/acc_unbiased': 66.392, 'best_test_test/diff': 7.557, 'best_test_test/acc_skew': 64.009, 'best_test_test/acc_align': 68.775}
[14 / 20] Learning rate: 1e-05 weight: 0.01
[14 / 20] Loss: 4.413295506806197 CE Loss: 0.45117783434870357 Con Loss: 4.408783734134858
[14 / 20] tensor([[0.973, 0.852],
        [0.451, 0.400]]) {'epoch': 14, 'valid/acc': 70.37, 'valid/acc_unbiased': 66.299, 'valid/diff': 7.948, 'valid/acc_skew': 62.325, 'valid/acc_align': 70.273, 'test/acc': 72.234, 'test/acc_unbiased': 66.898, 'test/diff': 8.569, 'test/acc_skew': 65.163, 'test/acc_align': 68.633}
[14 / 20] best valid accuracy: 66.299 at epoch 14 
 best_stats: {'best_valid_epoch': 14, 'best_valid_valid/acc': 70.37, 'best_valid_valid/acc_unbiased': 66.299, 'best_valid_valid/diff': 7.948, 'best_valid_valid/acc_skew': 62.325, 'best_valid_valid/acc_align': 70.273, 'best_valid_test/acc': 72.234, 'best_valid_test/acc_unbiased': 66.898, 'best_valid_test/diff': 8.569, 'best_valid_test/acc_skew': 65.163, 'best_valid_test/acc_align': 68.633}
[14 / 20] best test accuracy: 66.898 at epoch 14 
 best_stats: {'best_test_epoch': 14, 'best_test_valid/acc': 70.37, 'best_test_valid/acc_unbiased': 66.299, 'best_test_valid/diff': 7.948, 'best_test_valid/acc_skew': 62.325, 'best_test_valid/acc_align': 70.273, 'best_test_test/acc': 72.234, 'best_test_test/acc_unbiased': 66.898, 'best_test_test/diff': 8.569, 'best_test_test/acc_skew': 65.163, 'best_test_test/acc_align': 68.633}
[15 / 20] Learning rate: 1e-05 weight: 0.01
[15 / 20] Loss: 4.402168303739261 CE Loss: 0.45246850846189546 Con Loss: 4.397643607549121
[15 / 20] tensor([[0.976, 0.869],
        [0.427, 0.400]]) {'epoch': 15, 'valid/acc': 69.665, 'valid/acc_unbiased': 65.526, 'valid/diff': 8.698, 'valid/acc_skew': 61.177, 'valid/acc_align': 69.875, 'test/acc': 71.617, 'test/acc_unbiased': 66.813, 'test/diff': 6.694, 'test/acc_skew': 64.804, 'test/acc_align': 68.822}
[15 / 20] best valid accuracy: 66.299 at epoch 14 
 best_stats: {'best_valid_epoch': 14, 'best_valid_valid/acc': 70.37, 'best_valid_valid/acc_unbiased': 66.299, 'best_valid_valid/diff': 7.948, 'best_valid_valid/acc_skew': 62.325, 'best_valid_valid/acc_align': 70.273, 'best_valid_test/acc': 72.234, 'best_valid_test/acc_unbiased': 66.898, 'best_valid_test/diff': 8.569, 'best_valid_test/acc_skew': 65.163, 'best_valid_test/acc_align': 68.633}
[15 / 20] best test accuracy: 66.898 at epoch 14 
 best_stats: {'best_test_epoch': 14, 'best_test_valid/acc': 70.37, 'best_test_valid/acc_unbiased': 66.299, 'best_test_valid/diff': 7.948, 'best_test_valid/acc_skew': 62.325, 'best_test_valid/acc_align': 70.273, 'best_test_test/acc': 72.234, 'best_test_test/acc_unbiased': 66.898, 'best_test_test/diff': 8.569, 'best_test_test/acc_skew': 65.163, 'best_test_test/acc_align': 68.633}
[16 / 20] Learning rate: 1e-05 weight: 0.01
[16 / 20] Loss: 4.3559967836874876 CE Loss: 0.44819535287700313 Con Loss: 4.351514830030514
[16 / 20] tensor([[0.976, 0.864],
        [0.414, 0.400]]) {'epoch': 16, 'valid/acc': 69.797, 'valid/acc_unbiased': 65.805, 'valid/diff': 7.838, 'valid/acc_skew': 61.886, 'valid/acc_align': 69.724, 'test/acc': 71.089, 'test/acc_unbiased': 66.354, 'test/diff': 6.344, 'test/acc_skew': 63.885, 'test/acc_align': 68.822}
[16 / 20] best valid accuracy: 66.299 at epoch 14 
 best_stats: {'best_valid_epoch': 14, 'best_valid_valid/acc': 70.37, 'best_valid_valid/acc_unbiased': 66.299, 'best_valid_valid/diff': 7.948, 'best_valid_valid/acc_skew': 62.325, 'best_valid_valid/acc_align': 70.273, 'best_valid_test/acc': 72.234, 'best_valid_test/acc_unbiased': 66.898, 'best_valid_test/diff': 8.569, 'best_valid_test/acc_skew': 65.163, 'best_valid_test/acc_align': 68.633}
[16 / 20] best test accuracy: 66.898 at epoch 14 
 best_stats: {'best_test_epoch': 14, 'best_test_valid/acc': 70.37, 'best_test_valid/acc_unbiased': 66.299, 'best_test_valid/diff': 7.948, 'best_test_valid/acc_skew': 62.325, 'best_test_valid/acc_align': 70.273, 'best_test_test/acc': 72.234, 'best_test_test/acc_unbiased': 66.898, 'best_test_test/diff': 8.569, 'best_test_test/acc_skew': 65.163, 'best_test_test/acc_align': 68.633}
[17 / 20] Learning rate: 1e-05 weight: 0.01
[17 / 20] Loss: 4.415860028447216 CE Loss: 0.45209204355057414 Con Loss: 4.411339105358288
[17 / 20] tensor([[0.977, 0.881],
        [0.400, 0.394]]) {'epoch': 17, 'valid/acc': 69.4, 'valid/acc_unbiased': 65.447, 'valid/diff': 7.166, 'valid/acc_skew': 61.864, 'valid/acc_align': 69.03, 'test/acc': 70.692, 'test/acc_unbiased': 66.306, 'test/diff': 5.149, 'test/acc_skew': 64.046, 'test/acc_align': 68.566}
[17 / 20] best valid accuracy: 66.299 at epoch 14 
 best_stats: {'best_valid_epoch': 14, 'best_valid_valid/acc': 70.37, 'best_valid_valid/acc_unbiased': 66.299, 'best_valid_valid/diff': 7.948, 'best_valid_valid/acc_skew': 62.325, 'best_valid_valid/acc_align': 70.273, 'best_valid_test/acc': 72.234, 'best_valid_test/acc_unbiased': 66.898, 'best_valid_test/diff': 8.569, 'best_valid_test/acc_skew': 65.163, 'best_valid_test/acc_align': 68.633}
[17 / 20] best test accuracy: 66.898 at epoch 14 
 best_stats: {'best_test_epoch': 14, 'best_test_valid/acc': 70.37, 'best_test_valid/acc_unbiased': 66.299, 'best_test_valid/diff': 7.948, 'best_test_valid/acc_skew': 62.325, 'best_test_valid/acc_align': 70.273, 'best_test_test/acc': 72.234, 'best_test_test/acc_unbiased': 66.898, 'best_test_test/diff': 8.569, 'best_test_test/acc_skew': 65.163, 'best_test_test/acc_align': 68.633}
[18 / 20] Learning rate: 1e-05 weight: 0.01
[18 / 20] Loss: 4.375367278510022 CE Loss: 0.44017274878034873 Con Loss: 4.37096554257369
[18 / 20] tensor([[0.971, 0.830],
        [0.466, 0.424]]) {'epoch': 18, 'valid/acc': 71.076, 'valid/acc_unbiased': 66.868, 'valid/diff': 9.391, 'valid/acc_skew': 62.172, 'valid/acc_align': 71.563, 'test/acc': 72.719, 'test/acc_unbiased': 67.264, 'test/diff': 9.148, 'test/acc_skew': 64.776, 'test/acc_align': 69.751}
[18 / 20] best valid accuracy: 66.868 at epoch 18 
 best_stats: {'best_valid_epoch': 18, 'best_valid_valid/acc': 71.076, 'best_valid_valid/acc_unbiased': 66.868, 'best_valid_valid/diff': 9.391, 'best_valid_valid/acc_skew': 62.172, 'best_valid_valid/acc_align': 71.563, 'best_valid_test/acc': 72.719, 'best_valid_test/acc_unbiased': 67.264, 'best_valid_test/diff': 9.148, 'best_valid_test/acc_skew': 64.776, 'best_valid_test/acc_align': 69.751}
[18 / 20] best test accuracy: 67.264 at epoch 18 
 best_stats: {'best_test_epoch': 18, 'best_test_valid/acc': 71.076, 'best_test_valid/acc_unbiased': 66.868, 'best_test_valid/diff': 9.391, 'best_test_valid/acc_skew': 62.172, 'best_test_valid/acc_align': 71.563, 'best_test_test/acc': 72.719, 'best_test_test/acc_unbiased': 67.264, 'best_test_test/diff': 9.148, 'best_test_test/acc_skew': 64.776, 'best_test_test/acc_align': 69.751}
[19 / 20] Learning rate: 1e-05 weight: 0.01
[19 / 20] Loss: 4.370669573445037 CE Loss: 0.4394636638197547 Con Loss: 4.366274965608312
[19 / 20] tensor([[0.974, 0.830],
        [0.446, 0.418]]) {'epoch': 19, 'valid/acc': 70.37, 'valid/acc_unbiased': 65.906, 'valid/diff': 9.132, 'valid/acc_skew': 61.34, 'valid/acc_align': 70.472, 'test/acc': 72.058, 'test/acc_unbiased': 66.693, 'test/diff': 8.612, 'test/acc_skew': 63.796, 'test/acc_align': 69.59}
[19 / 20] best valid accuracy: 66.868 at epoch 18 
 best_stats: {'best_valid_epoch': 18, 'best_valid_valid/acc': 71.076, 'best_valid_valid/acc_unbiased': 66.868, 'best_valid_valid/diff': 9.391, 'best_valid_valid/acc_skew': 62.172, 'best_valid_valid/acc_align': 71.563, 'best_valid_test/acc': 72.719, 'best_valid_test/acc_unbiased': 67.264, 'best_valid_test/diff': 9.148, 'best_valid_test/acc_skew': 64.776, 'best_valid_test/acc_align': 69.751}
[19 / 20] best test accuracy: 67.264 at epoch 18 
 best_stats: {'best_test_epoch': 18, 'best_test_valid/acc': 71.076, 'best_test_valid/acc_unbiased': 66.868, 'best_test_valid/diff': 9.391, 'best_test_valid/acc_skew': 62.172, 'best_test_valid/acc_align': 71.563, 'best_test_test/acc': 72.719, 'best_test_test/acc_unbiased': 67.264, 'best_test_test/diff': 9.148, 'best_test_test/acc_skew': 64.776, 'best_test_test/acc_align': 69.751}
[20 / 20] Learning rate: 1e-05 weight: 0.01
[20 / 20] Loss: 4.343676798266 CE Loss: 0.4363004852773901 Con Loss: 4.339313787362496
[20 / 20] tensor([[0.978, 0.858],
        [0.399, 0.412]]) {'epoch': 20, 'valid/acc': 69.18, 'valid/acc_unbiased': 65.394, 'valid/diff': 8.166, 'valid/acc_skew': 61.31, 'valid/acc_align': 69.477, 'test/acc': 70.648, 'test/acc_unbiased': 66.187, 'test/diff': 6.671, 'test/acc_skew': 62.852, 'test/acc_align': 69.522}
[20 / 20] best valid accuracy: 66.868 at epoch 18 
 best_stats: {'best_valid_epoch': 18, 'best_valid_valid/acc': 71.076, 'best_valid_valid/acc_unbiased': 66.868, 'best_valid_valid/diff': 9.391, 'best_valid_valid/acc_skew': 62.172, 'best_valid_valid/acc_align': 71.563, 'best_valid_test/acc': 72.719, 'best_valid_test/acc_unbiased': 67.264, 'best_valid_test/diff': 9.148, 'best_valid_test/acc_skew': 64.776, 'best_valid_test/acc_align': 69.751}
[20 / 20] best test accuracy: 67.264 at epoch 18 
 best_stats: {'best_test_epoch': 18, 'best_test_valid/acc': 71.076, 'best_test_valid/acc_unbiased': 66.868, 'best_test_valid/diff': 9.391, 'best_test_valid/acc_skew': 62.172, 'best_test_valid/acc_align': 71.563, 'best_test_test/acc': 72.719, 'best_test_test/acc_unbiased': 67.264, 'best_test_test/diff': 9.148, 'best_test_test/acc_skew': 64.776, 'best_test_test/acc_align': 69.751}
Total training time: 0:16:04
