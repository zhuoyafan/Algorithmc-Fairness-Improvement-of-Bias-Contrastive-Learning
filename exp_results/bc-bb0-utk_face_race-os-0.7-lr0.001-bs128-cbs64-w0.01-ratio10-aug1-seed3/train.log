Log level set to: INFO
Set seed: 3
=======> Using Fixed Random Seed: 3 <========
save_path: exp_results/bc-bb0-utk_face_race-os-0.7-lr0.001-bs128-cbs64-w0.01-ratio10-aug1-seed3
get_utk_face - split: train, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_race-0.7
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [4407, 1658]
Target 1: [1322, 5529]
Binary Target 1
---------------------------
Target 0: [4407, 1658]
Target 1: [1322, 5529]
===================================
Normal Label Distribution: 
Target 0: [4407, 1658]
Target 1: [1322, 5529]
===================================
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [5529, 5529]
Target 1: [5529, 5529]
Binary Target 1
---------------------------
Target 0: [5529, 5529]
Target 1: [5529, 5529]
===================================
Normal Label Distribution: 
Target 0: [5529, 5529]
Target 1: [5529, 5529]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 22116, target_attr: gender, bias_attr: race bias_rate: 0.7
['[train] target_0-bias_0: 5529', '[train] target_0-bias_1: 5529', '[train] target_1-bias_0: 5529', '[train] target_1-bias_1: 5529']
confusion_matrix - 
 original: tensor([[5529., 5529.],
        [5529., 5529.]]), 
 normalized: tensor([[0.500, 0.500],
        [0.500, 0.500]]), 
 b|y: tensor([[0.500, 0.500],
        [0.500, 0.500]])
get_utk_face - split: train, aug: 1, given_y: True, ratio: 10
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_race-0.7
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [4407, 1658]
Target 1: [1322, 5529]
Binary Target 1
---------------------------
Target 0: [4407, 1658]
Target 1: [1322, 5529]
===================================
Normal Label Distribution: 
Target 0: [4407, 1658]
Target 1: [1322, 5529]
===================================
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [5529, 5529]
Target 1: [5529, 5529]
Binary Target 1
---------------------------
Target 0: [5529, 5529]
Target 1: [5529, 5529]
===================================
Normal Label Distribution: 
Target 0: [5529, 5529]
Target 1: [5529, 5529]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 22116, target_attr: gender, bias_attr: race bias_rate: 0.7
['[train] target_0-bias_0: 5529', '[train] target_0-bias_1: 5529', '[train] target_1-bias_0: 5529', '[train] target_1-bias_1: 5529']
get_utk_face - split: valid, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_race-0.7
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [583, 684]
Target 1: [457, 646]
Binary Target 1
---------------------------
Target 0: [583, 684]
Target 1: [457, 646]
===================================
Normal Label Distribution: 
Target 0: [583, 684]
Target 1: [457, 646]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 2370, target_attr: gender, bias_attr: race bias_rate: 0.7
['[valid] target_0-bias_0: 583', '[valid] target_0-bias_1: 684', '[valid] target_1-bias_0: 457', '[valid] target_1-bias_1: 646']
get_utk_face - split: test, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_race-0.7
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [558, 677]
Target 1: [462, 673]
Binary Target 1
---------------------------
Target 0: [558, 677]
Target 1: [462, 673]
===================================
Normal Label Distribution: 
Target 0: [558, 677]
Target 1: [462, 673]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 2370, target_attr: gender, bias_attr: race bias_rate: 0.7
['[test] target_0-bias_0: 558', '[test] target_0-bias_1: 677', '[test] target_1-bias_0: 462', '[test] target_1-bias_1: 673']
decay_epochs: [6, 13]
[1 / 20] Learning rate: 0.001 weight: 0.01
[1 / 20] Loss: 4.823886006321306 CE Loss: 0.526391128763667 Con Loss: 4.818622085883834
[1 / 20] tensor([[0.882, 0.843],
        [0.747, 0.795]]) {'epoch': 1, 'valid/acc': 82.658, 'valid/acc_unbiased': 82.321, 'valid/diff': 0.539, 'valid/acc_skew': 82.47, 'valid/acc_align': 82.172, 'test/acc': 81.983, 'test/acc_unbiased': 81.671, 'test/diff': 4.324, 'test/acc_skew': 81.424, 'test/acc_align': 81.919}
[1 / 20] best valid accuracy: 82.321 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 82.658, 'best_valid_valid/acc_unbiased': 82.321, 'best_valid_valid/diff': 0.539, 'best_valid_valid/acc_skew': 82.47, 'best_valid_valid/acc_align': 82.172, 'best_valid_test/acc': 81.983, 'best_valid_test/acc_unbiased': 81.671, 'best_valid_test/diff': 4.324, 'best_valid_test/acc_skew': 81.424, 'best_valid_test/acc_align': 81.919}
[1 / 20] best test accuracy: 81.671 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 82.658, 'best_test_valid/acc_unbiased': 82.321, 'best_test_valid/diff': 0.539, 'best_test_valid/acc_skew': 82.47, 'best_test_valid/acc_align': 82.172, 'best_test_test/acc': 81.983, 'best_test_test/acc_unbiased': 81.671, 'best_test_test/diff': 4.324, 'best_test_test/acc_skew': 81.424, 'best_test_test/acc_align': 81.919}
[2 / 20] Learning rate: 0.001 weight: 0.01
[2 / 20] Loss: 4.727752062700437 CE Loss: 0.42372371428567823 Con Loss: 4.723514829584909
[2 / 20] tensor([[0.737, 0.671],
        [0.890, 0.932]]) {'epoch': 2, 'valid/acc': 80.549, 'valid/acc_unbiased': 81.345, 'valid/diff': 2.439, 'valid/acc_skew': 81.567, 'valid/acc_align': 81.123, 'test/acc': 80.295, 'test/acc_unbiased': 80.711, 'test/diff': 5.4, 'test/acc_skew': 81.308, 'test/acc_align': 80.113}
[2 / 20] best valid accuracy: 82.321 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 82.658, 'best_valid_valid/acc_unbiased': 82.321, 'best_valid_valid/diff': 0.539, 'best_valid_valid/acc_skew': 82.47, 'best_valid_valid/acc_align': 82.172, 'best_valid_test/acc': 81.983, 'best_valid_test/acc_unbiased': 81.671, 'best_valid_test/diff': 4.324, 'best_valid_test/acc_skew': 81.424, 'best_valid_test/acc_align': 81.919}
[2 / 20] best test accuracy: 81.671 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 82.658, 'best_test_valid/acc_unbiased': 82.321, 'best_test_valid/diff': 0.539, 'best_test_valid/acc_skew': 82.47, 'best_test_valid/acc_align': 82.172, 'best_test_test/acc': 81.983, 'best_test_test/acc_unbiased': 81.671, 'best_test_test/diff': 4.324, 'best_test_test/acc_skew': 81.424, 'best_test_test/acc_align': 81.919}
[3 / 20] Learning rate: 0.001 weight: 0.01
[3 / 20] Loss: 4.704331274682865 CE Loss: 0.40422050137700083 Con Loss: 4.7002890502852415
[3 / 20] tensor([[0.855, 0.811],
        [0.833, 0.857]]) {'epoch': 3, 'valid/acc': 85.274, 'valid/acc_unbiased': 85.315, 'valid/diff': 2.541, 'valid/acc_skew': 85.847, 'valid/acc_align': 84.782, 'test/acc': 83.882, 'test/acc_unbiased': 83.911, 'test/diff': 3.396, 'test/acc_skew': 84.409, 'test/acc_align': 83.414}
[3 / 20] best valid accuracy: 85.315 at epoch 3 
 best_stats: {'best_valid_epoch': 3, 'best_valid_valid/acc': 85.274, 'best_valid_valid/acc_unbiased': 85.315, 'best_valid_valid/diff': 2.541, 'best_valid_valid/acc_skew': 85.847, 'best_valid_valid/acc_align': 84.782, 'best_valid_test/acc': 83.882, 'best_valid_test/acc_unbiased': 83.911, 'best_valid_test/diff': 3.396, 'best_valid_test/acc_skew': 84.409, 'best_valid_test/acc_align': 83.414}
[3 / 20] best test accuracy: 83.911 at epoch 3 
 best_stats: {'best_test_epoch': 3, 'best_test_valid/acc': 85.274, 'best_test_valid/acc_unbiased': 85.315, 'best_test_valid/diff': 2.541, 'best_test_valid/acc_skew': 85.847, 'best_test_valid/acc_align': 84.782, 'best_test_test/acc': 83.882, 'best_test_test/acc_unbiased': 83.911, 'best_test_test/diff': 3.396, 'best_test_test/acc_skew': 84.409, 'best_test_test/acc_align': 83.414}
[4 / 20] Learning rate: 0.001 weight: 0.01
[4 / 20] Loss: 4.687922631234583 CE Loss: 0.38372766390526397 Con Loss: 4.684085353845109
[4 / 20] tensor([[0.824, 0.784],
        [0.857, 0.892]]) {'epoch': 4, 'valid/acc': 85.738, 'valid/acc_unbiased': 86.106, 'valid/diff': 1.959, 'valid/acc_skew': 87.086, 'valid/acc_align': 85.126, 'test/acc': 83.84, 'test/acc_unbiased': 83.935, 'test/diff': 3.721, 'test/acc_skew': 84.076, 'test/acc_align': 83.794}
[4 / 20] best valid accuracy: 86.106 at epoch 4 
 best_stats: {'best_valid_epoch': 4, 'best_valid_valid/acc': 85.738, 'best_valid_valid/acc_unbiased': 86.106, 'best_valid_valid/diff': 1.959, 'best_valid_valid/acc_skew': 87.086, 'best_valid_valid/acc_align': 85.126, 'best_valid_test/acc': 83.84, 'best_valid_test/acc_unbiased': 83.935, 'best_valid_test/diff': 3.721, 'best_valid_test/acc_skew': 84.076, 'best_valid_test/acc_align': 83.794}
[4 / 20] best test accuracy: 83.935 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 85.738, 'best_test_valid/acc_unbiased': 86.106, 'best_test_valid/diff': 1.959, 'best_test_valid/acc_skew': 87.086, 'best_test_valid/acc_align': 85.126, 'best_test_test/acc': 83.84, 'best_test_test/acc_unbiased': 83.935, 'best_test_test/diff': 3.721, 'best_test_test/acc_skew': 84.076, 'best_test_test/acc_align': 83.794}
[5 / 20] Learning rate: 0.001 weight: 0.01
[5 / 20] Loss: 4.667251623912279 CE Loss: 0.37407750508457094 Con Loss: 4.663510846410356
[5 / 20] tensor([[0.909, 0.900],
        [0.762, 0.785]]) {'epoch': 5, 'valid/acc': 83.924, 'valid/acc_unbiased': 83.735, 'valid/diff': 3.401, 'valid/acc_skew': 85.436, 'valid/acc_align': 82.035, 'test/acc': 84.219, 'test/acc_unbiased': 83.865, 'test/diff': 1.584, 'test/acc_skew': 83.525, 'test/acc_align': 84.205}
[5 / 20] best valid accuracy: 86.106 at epoch 4 
 best_stats: {'best_valid_epoch': 4, 'best_valid_valid/acc': 85.738, 'best_valid_valid/acc_unbiased': 86.106, 'best_valid_valid/diff': 1.959, 'best_valid_valid/acc_skew': 87.086, 'best_valid_valid/acc_align': 85.126, 'best_valid_test/acc': 83.84, 'best_valid_test/acc_unbiased': 83.935, 'best_valid_test/diff': 3.721, 'best_valid_test/acc_skew': 84.076, 'best_valid_test/acc_align': 83.794}
[5 / 20] best test accuracy: 83.935 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 85.738, 'best_test_valid/acc_unbiased': 86.106, 'best_test_valid/diff': 1.959, 'best_test_valid/acc_skew': 87.086, 'best_test_valid/acc_align': 85.126, 'best_test_test/acc': 83.84, 'best_test_test/acc_unbiased': 83.935, 'best_test_test/diff': 3.721, 'best_test_test/acc_skew': 84.076, 'best_test_test/acc_align': 83.794}
[6 / 20] Learning rate: 0.001 weight: 0.01
[6 / 20] Loss: 4.662214821901562 CE Loss: 0.360333824485438 Con Loss: 4.658611486479438
[6 / 20] tensor([[0.785, 0.739],
        [0.916, 0.924]]) {'epoch': 6, 'valid/acc': 84.515, 'valid/acc_unbiased': 85.143, 'valid/diff': 1.437, 'valid/acc_skew': 85.172, 'valid/acc_align': 85.114, 'test/acc': 83.671, 'test/acc_unbiased': 84.083, 'test/diff': 2.751, 'test/acc_skew': 85.027, 'test/acc_align': 83.139}
[6 / 20] best valid accuracy: 86.106 at epoch 4 
 best_stats: {'best_valid_epoch': 4, 'best_valid_valid/acc': 85.738, 'best_valid_valid/acc_unbiased': 86.106, 'best_valid_valid/diff': 1.959, 'best_valid_valid/acc_skew': 87.086, 'best_valid_valid/acc_align': 85.126, 'best_valid_test/acc': 83.84, 'best_valid_test/acc_unbiased': 83.935, 'best_valid_test/diff': 3.721, 'best_valid_test/acc_skew': 84.076, 'best_valid_test/acc_align': 83.794}
[6 / 20] best test accuracy: 84.083 at epoch 6 
 best_stats: {'best_test_epoch': 6, 'best_test_valid/acc': 84.515, 'best_test_valid/acc_unbiased': 85.143, 'best_test_valid/diff': 1.437, 'best_test_valid/acc_skew': 85.172, 'best_test_valid/acc_align': 85.114, 'best_test_test/acc': 83.671, 'best_test_test/acc_unbiased': 84.083, 'best_test_test/diff': 2.751, 'best_test_test/acc_skew': 85.027, 'best_test_test/acc_align': 83.139}
[7 / 20] Learning rate: 0.0001 weight: 0.01
[7 / 20] Loss: 4.606699442471059 CE Loss: 0.3175878295158473 Con Loss: 4.603523549776566
[7 / 20] tensor([[0.866, 0.842],
        [0.877, 0.896]]) {'epoch': 7, 'valid/acc': 88.186, 'valid/acc_unbiased': 88.42, 'valid/diff': 1.668, 'valid/acc_skew': 89.254, 'valid/acc_align': 87.586, 'test/acc': 86.962, 'test/acc_unbiased': 87.004, 'test/diff': 2.15, 'test/acc_skew': 87.111, 'test/acc_align': 86.897}
[7 / 20] best valid accuracy: 88.420 at epoch 7 
 best_stats: {'best_valid_epoch': 7, 'best_valid_valid/acc': 88.186, 'best_valid_valid/acc_unbiased': 88.42, 'best_valid_valid/diff': 1.668, 'best_valid_valid/acc_skew': 89.254, 'best_valid_valid/acc_align': 87.586, 'best_valid_test/acc': 86.962, 'best_valid_test/acc_unbiased': 87.004, 'best_valid_test/diff': 2.15, 'best_valid_test/acc_skew': 87.111, 'best_valid_test/acc_align': 86.897}
[7 / 20] best test accuracy: 87.004 at epoch 7 
 best_stats: {'best_test_epoch': 7, 'best_test_valid/acc': 88.186, 'best_test_valid/acc_unbiased': 88.42, 'best_test_valid/diff': 1.668, 'best_test_valid/acc_skew': 89.254, 'best_test_valid/acc_align': 87.586, 'best_test_test/acc': 86.962, 'best_test_test/acc_unbiased': 87.004, 'best_test_test/diff': 2.15, 'best_test_test/acc_skew': 87.111, 'best_test_test/acc_align': 86.897}
[8 / 20] Learning rate: 0.0001 weight: 0.01
[8 / 20] Loss: 4.577751960088599 CE Loss: 0.305100704273278 Con Loss: 4.574700940084362
[8 / 20] tensor([[0.882, 0.864],
        [0.866, 0.889]]) {'epoch': 8, 'valid/acc': 88.523, 'valid/acc_unbiased': 88.711, 'valid/diff': 2.362, 'valid/acc_skew': 89.892, 'valid/acc_align': 87.53, 'test/acc': 87.553, 'test/acc_unbiased': 87.505, 'test/diff': 2.019, 'test/acc_skew': 87.376, 'test/acc_align': 87.633}
[8 / 20] best valid accuracy: 88.711 at epoch 8 
 best_stats: {'best_valid_epoch': 8, 'best_valid_valid/acc': 88.523, 'best_valid_valid/acc_unbiased': 88.711, 'best_valid_valid/diff': 2.362, 'best_valid_valid/acc_skew': 89.892, 'best_valid_valid/acc_align': 87.53, 'best_valid_test/acc': 87.553, 'best_valid_test/acc_unbiased': 87.505, 'best_valid_test/diff': 2.019, 'best_valid_test/acc_skew': 87.376, 'best_valid_test/acc_align': 87.633}
[8 / 20] best test accuracy: 87.505 at epoch 8 
 best_stats: {'best_test_epoch': 8, 'best_test_valid/acc': 88.523, 'best_test_valid/acc_unbiased': 88.711, 'best_test_valid/diff': 2.362, 'best_test_valid/acc_skew': 89.892, 'best_test_valid/acc_align': 87.53, 'best_test_test/acc': 87.553, 'best_test_test/acc_unbiased': 87.505, 'best_test_test/diff': 2.019, 'best_test_test/acc_skew': 87.376, 'best_test_test/acc_align': 87.633}
[9 / 20] Learning rate: 0.0001 weight: 0.01
[9 / 20] Loss: 4.5722443598221 CE Loss: 0.2993768060060754 Con Loss: 4.569250601500968
[9 / 20] tensor([[0.889, 0.857],
        [0.868, 0.895]]) {'epoch': 9, 'valid/acc': 88.439, 'valid/acc_unbiased': 88.626, 'valid/diff': 2.828, 'valid/acc_skew': 90.04, 'valid/acc_align': 87.212, 'test/acc': 87.722, 'test/acc_unbiased': 87.702, 'test/diff': 2.935, 'test/acc_skew': 87.843, 'test/acc_align': 87.561}
[9 / 20] best valid accuracy: 88.711 at epoch 8 
 best_stats: {'best_valid_epoch': 8, 'best_valid_valid/acc': 88.523, 'best_valid_valid/acc_unbiased': 88.711, 'best_valid_valid/diff': 2.362, 'best_valid_valid/acc_skew': 89.892, 'best_valid_valid/acc_align': 87.53, 'best_valid_test/acc': 87.553, 'best_valid_test/acc_unbiased': 87.505, 'best_valid_test/diff': 2.019, 'best_valid_test/acc_skew': 87.376, 'best_valid_test/acc_align': 87.633}
[9 / 20] best test accuracy: 87.702 at epoch 9 
 best_stats: {'best_test_epoch': 9, 'best_test_valid/acc': 88.439, 'best_test_valid/acc_unbiased': 88.626, 'best_test_valid/diff': 2.828, 'best_test_valid/acc_skew': 90.04, 'best_test_valid/acc_align': 87.212, 'best_test_test/acc': 87.722, 'best_test_test/acc_unbiased': 87.702, 'best_test_test/diff': 2.935, 'best_test_test/acc_skew': 87.843, 'best_test_test/acc_align': 87.561}
[10 / 20] Learning rate: 0.0001 weight: 0.01
[10 / 20] Loss: 4.562071371604573 CE Loss: 0.2856703149968363 Con Loss: 4.559214673048334
[10 / 20] tensor([[0.910, 0.886],
        [0.859, 0.874]]) {'epoch': 10, 'valid/acc': 88.397, 'valid/acc_unbiased': 88.479, 'valid/diff': 2.792, 'valid/acc_skew': 89.875, 'valid/acc_align': 87.083, 'test/acc': 88.312, 'test/acc_unbiased': 88.242, 'test/diff': 1.926, 'test/acc_skew': 88.485, 'test/acc_align': 87.998}
[10 / 20] best valid accuracy: 88.711 at epoch 8 
 best_stats: {'best_valid_epoch': 8, 'best_valid_valid/acc': 88.523, 'best_valid_valid/acc_unbiased': 88.711, 'best_valid_valid/diff': 2.362, 'best_valid_valid/acc_skew': 89.892, 'best_valid_valid/acc_align': 87.53, 'best_valid_test/acc': 87.553, 'best_valid_test/acc_unbiased': 87.505, 'best_valid_test/diff': 2.019, 'best_valid_test/acc_skew': 87.376, 'best_valid_test/acc_align': 87.633}
[10 / 20] best test accuracy: 88.242 at epoch 10 
 best_stats: {'best_test_epoch': 10, 'best_test_valid/acc': 88.397, 'best_test_valid/acc_unbiased': 88.479, 'best_test_valid/diff': 2.792, 'best_test_valid/acc_skew': 89.875, 'best_test_valid/acc_align': 87.083, 'best_test_test/acc': 88.312, 'best_test_test/acc_unbiased': 88.242, 'best_test_test/diff': 1.926, 'best_test_test/acc_skew': 88.485, 'best_test_test/acc_align': 87.998}
[11 / 20] Learning rate: 0.0001 weight: 0.01
[11 / 20] Loss: 4.562059696640453 CE Loss: 0.28376117467254985 Con Loss: 4.559222107878816
[11 / 20] tensor([[0.896, 0.871],
        [0.870, 0.875]]) {'epoch': 11, 'valid/acc': 88.65, 'valid/acc_unbiased': 88.754, 'valid/diff': 2.087, 'valid/acc_skew': 89.798, 'valid/acc_align': 87.711, 'test/acc': 87.806, 'test/acc_unbiased': 87.822, 'test/diff': 1.481, 'test/acc_skew': 88.309, 'test/acc_align': 87.334}
[11 / 20] best valid accuracy: 88.754 at epoch 11 
 best_stats: {'best_valid_epoch': 11, 'best_valid_valid/acc': 88.65, 'best_valid_valid/acc_unbiased': 88.754, 'best_valid_valid/diff': 2.087, 'best_valid_valid/acc_skew': 89.798, 'best_valid_valid/acc_align': 87.711, 'best_valid_test/acc': 87.806, 'best_valid_test/acc_unbiased': 87.822, 'best_valid_test/diff': 1.481, 'best_valid_test/acc_skew': 88.309, 'best_valid_test/acc_align': 87.334}
[11 / 20] best test accuracy: 88.242 at epoch 10 
 best_stats: {'best_test_epoch': 10, 'best_test_valid/acc': 88.397, 'best_test_valid/acc_unbiased': 88.479, 'best_test_valid/diff': 2.792, 'best_test_valid/acc_skew': 89.875, 'best_test_valid/acc_align': 87.083, 'best_test_test/acc': 88.312, 'best_test_test/acc_unbiased': 88.242, 'best_test_test/diff': 1.926, 'best_test_test/acc_skew': 88.485, 'best_test_test/acc_align': 87.998}
[12 / 20] Learning rate: 0.0001 weight: 0.01
[12 / 20] Loss: 4.5467846579438715 CE Loss: 0.28043506532600243 Con Loss: 4.543980329716738
[12 / 20] tensor([[0.885, 0.851],
        [0.887, 0.905]]) {'epoch': 12, 'valid/acc': 89.409, 'valid/acc_unbiased': 89.656, 'valid/diff': 2.223, 'valid/acc_skew': 90.768, 'valid/acc_align': 88.545, 'test/acc': 88.143, 'test/acc_unbiased': 88.212, 'test/diff': 2.597, 'test/acc_skew': 88.638, 'test/acc_align': 87.786}
[12 / 20] best valid accuracy: 89.656 at epoch 12 
 best_stats: {'best_valid_epoch': 12, 'best_valid_valid/acc': 89.409, 'best_valid_valid/acc_unbiased': 89.656, 'best_valid_valid/diff': 2.223, 'best_valid_valid/acc_skew': 90.768, 'best_valid_valid/acc_align': 88.545, 'best_valid_test/acc': 88.143, 'best_valid_test/acc_unbiased': 88.212, 'best_valid_test/diff': 2.597, 'best_valid_test/acc_skew': 88.638, 'best_valid_test/acc_align': 87.786}
[12 / 20] best test accuracy: 88.242 at epoch 10 
 best_stats: {'best_test_epoch': 10, 'best_test_valid/acc': 88.397, 'best_test_valid/acc_unbiased': 88.479, 'best_test_valid/diff': 2.792, 'best_test_valid/acc_skew': 89.875, 'best_test_valid/acc_align': 87.083, 'best_test_test/acc': 88.312, 'best_test_test/acc_unbiased': 88.242, 'best_test_test/diff': 1.926, 'best_test_test/acc_skew': 88.485, 'best_test_test/acc_align': 87.998}
[13 / 20] Learning rate: 0.0001 weight: 0.01
[13 / 20] Loss: 4.5432238125158575 CE Loss: 0.2781301491524432 Con Loss: 4.540442514686909
[13 / 20] tensor([[0.885, 0.860],
        [0.883, 0.909]]) {'epoch': 13, 'valid/acc': 89.072, 'valid/acc_unbiased': 89.223, 'valid/diff': 1.854, 'valid/acc_skew': 90.15, 'valid/acc_align': 88.295, 'test/acc': 88.439, 'test/acc_unbiased': 88.436, 'test/diff': 2.594, 'test/acc_skew': 88.421, 'test/acc_align': 88.452}
[13 / 20] best valid accuracy: 89.656 at epoch 12 
 best_stats: {'best_valid_epoch': 12, 'best_valid_valid/acc': 89.409, 'best_valid_valid/acc_unbiased': 89.656, 'best_valid_valid/diff': 2.223, 'best_valid_valid/acc_skew': 90.768, 'best_valid_valid/acc_align': 88.545, 'best_valid_test/acc': 88.143, 'best_valid_test/acc_unbiased': 88.212, 'best_valid_test/diff': 2.597, 'best_valid_test/acc_skew': 88.638, 'best_valid_test/acc_align': 87.786}
[13 / 20] best test accuracy: 88.436 at epoch 13 
 best_stats: {'best_test_epoch': 13, 'best_test_valid/acc': 89.072, 'best_test_valid/acc_unbiased': 89.223, 'best_test_valid/diff': 1.854, 'best_test_valid/acc_skew': 90.15, 'best_test_valid/acc_align': 88.295, 'best_test_test/acc': 88.439, 'best_test_test/acc_unbiased': 88.436, 'best_test_test/diff': 2.594, 'best_test_test/acc_skew': 88.421, 'best_test_test/acc_align': 88.452}
[14 / 20] Learning rate: 1e-05 weight: 0.01
[14 / 20] Loss: 4.532828613266761 CE Loss: 0.27089613226529896 Con Loss: 4.530119641604659
[14 / 20] tensor([[0.892, 0.867],
        [0.881, 0.908]]) {'epoch': 14, 'valid/acc': 89.198, 'valid/acc_unbiased': 89.348, 'valid/diff': 1.993, 'valid/acc_skew': 90.345, 'valid/acc_align': 88.351, 'test/acc': 88.734, 'test/acc_unbiased': 88.709, 'test/diff': 2.617, 'test/acc_skew': 88.671, 'test/acc_align': 88.747}
[14 / 20] best valid accuracy: 89.656 at epoch 12 
 best_stats: {'best_valid_epoch': 12, 'best_valid_valid/acc': 89.409, 'best_valid_valid/acc_unbiased': 89.656, 'best_valid_valid/diff': 2.223, 'best_valid_valid/acc_skew': 90.768, 'best_valid_valid/acc_align': 88.545, 'best_valid_test/acc': 88.143, 'best_valid_test/acc_unbiased': 88.212, 'best_valid_test/diff': 2.597, 'best_valid_test/acc_skew': 88.638, 'best_valid_test/acc_align': 87.786}
[14 / 20] best test accuracy: 88.709 at epoch 14 
 best_stats: {'best_test_epoch': 14, 'best_test_valid/acc': 89.198, 'best_test_valid/acc_unbiased': 89.348, 'best_test_valid/diff': 1.993, 'best_test_valid/acc_skew': 90.345, 'best_test_valid/acc_align': 88.351, 'best_test_test/acc': 88.734, 'best_test_test/acc_unbiased': 88.709, 'best_test_test/diff': 2.617, 'best_test_test/acc_skew': 88.671, 'best_test_test/acc_align': 88.747}
[15 / 20] Learning rate: 1e-05 weight: 0.01
[15 / 20] Loss: 4.537093403326881 CE Loss: 0.27139530773295656 Con Loss: 4.534379444926098
[15 / 20] tensor([[0.898, 0.870],
        [0.881, 0.900]]) {'epoch': 15, 'valid/acc': 89.03, 'valid/acc_unbiased': 89.179, 'valid/diff': 1.818, 'valid/acc_skew': 90.087, 'valid/acc_align': 88.27, 'test/acc': 88.734, 'test/acc_unbiased': 88.732, 'test/diff': 2.366, 'test/acc_skew': 88.94, 'test/acc_align': 88.523}
[15 / 20] best valid accuracy: 89.656 at epoch 12 
 best_stats: {'best_valid_epoch': 12, 'best_valid_valid/acc': 89.409, 'best_valid_valid/acc_unbiased': 89.656, 'best_valid_valid/diff': 2.223, 'best_valid_valid/acc_skew': 90.768, 'best_valid_valid/acc_align': 88.545, 'best_valid_test/acc': 88.143, 'best_valid_test/acc_unbiased': 88.212, 'best_valid_test/diff': 2.597, 'best_valid_test/acc_skew': 88.638, 'best_valid_test/acc_align': 87.786}
[15 / 20] best test accuracy: 88.732 at epoch 15 
 best_stats: {'best_test_epoch': 15, 'best_test_valid/acc': 89.03, 'best_test_valid/acc_unbiased': 89.179, 'best_test_valid/diff': 1.818, 'best_test_valid/acc_skew': 90.087, 'best_test_valid/acc_align': 88.27, 'best_test_test/acc': 88.734, 'best_test_test/acc_unbiased': 88.732, 'best_test_test/diff': 2.366, 'best_test_test/acc_skew': 88.94, 'best_test_test/acc_align': 88.523}
[16 / 20] Learning rate: 1e-05 weight: 0.01
[16 / 20] Loss: 4.523172618554113 CE Loss: 0.26966107776700143 Con Loss: 4.5204760135244255
[16 / 20] tensor([[0.900, 0.870],
        [0.879, 0.897]]) {'epoch': 16, 'valid/acc': 89.409, 'valid/acc_unbiased': 89.553, 'valid/diff': 1.974, 'valid/acc_skew': 90.54, 'valid/acc_align': 88.566, 'test/acc': 88.65, 'test/acc_unbiased': 88.648, 'test/diff': 2.416, 'test/acc_skew': 88.921, 'test/acc_align': 88.374}
[16 / 20] best valid accuracy: 89.656 at epoch 12 
 best_stats: {'best_valid_epoch': 12, 'best_valid_valid/acc': 89.409, 'best_valid_valid/acc_unbiased': 89.656, 'best_valid_valid/diff': 2.223, 'best_valid_valid/acc_skew': 90.768, 'best_valid_valid/acc_align': 88.545, 'best_valid_test/acc': 88.143, 'best_valid_test/acc_unbiased': 88.212, 'best_valid_test/diff': 2.597, 'best_valid_test/acc_skew': 88.638, 'best_valid_test/acc_align': 87.786}
[16 / 20] best test accuracy: 88.732 at epoch 15 
 best_stats: {'best_test_epoch': 15, 'best_test_valid/acc': 89.03, 'best_test_valid/acc_unbiased': 89.179, 'best_test_valid/diff': 1.818, 'best_test_valid/acc_skew': 90.087, 'best_test_valid/acc_align': 88.27, 'best_test_test/acc': 88.734, 'best_test_test/acc_unbiased': 88.732, 'best_test_test/diff': 2.366, 'best_test_test/acc_skew': 88.94, 'best_test_test/acc_align': 88.523}
[17 / 20] Learning rate: 1e-05 weight: 0.01
[17 / 20] Loss: 4.533943002231299 CE Loss: 0.26825877698534195 Con Loss: 4.531260414178731
[17 / 20] tensor([[0.900, 0.869],
        [0.877, 0.900]]) {'epoch': 17, 'valid/acc': 89.283, 'valid/acc_unbiased': 89.333, 'valid/diff': 1.224, 'valid/acc_skew': 89.946, 'valid/acc_align': 88.721, 'test/acc': 88.65, 'test/acc_unbiased': 88.631, 'test/diff': 2.746, 'test/acc_skew': 88.813, 'test/acc_align': 88.449}
[17 / 20] best valid accuracy: 89.656 at epoch 12 
 best_stats: {'best_valid_epoch': 12, 'best_valid_valid/acc': 89.409, 'best_valid_valid/acc_unbiased': 89.656, 'best_valid_valid/diff': 2.223, 'best_valid_valid/acc_skew': 90.768, 'best_valid_valid/acc_align': 88.545, 'best_valid_test/acc': 88.143, 'best_valid_test/acc_unbiased': 88.212, 'best_valid_test/diff': 2.597, 'best_valid_test/acc_skew': 88.638, 'best_valid_test/acc_align': 87.786}
[17 / 20] best test accuracy: 88.732 at epoch 15 
 best_stats: {'best_test_epoch': 15, 'best_test_valid/acc': 89.03, 'best_test_valid/acc_unbiased': 89.179, 'best_test_valid/diff': 1.818, 'best_test_valid/acc_skew': 90.087, 'best_test_valid/acc_align': 88.27, 'best_test_test/acc': 88.734, 'best_test_test/acc_unbiased': 88.732, 'best_test_test/diff': 2.366, 'best_test_test/acc_skew': 88.94, 'best_test_test/acc_align': 88.523}
[18 / 20] Learning rate: 1e-05 weight: 0.01
[18 / 20] Loss: 4.5212679979576516 CE Loss: 0.2637731199708462 Con Loss: 4.518630272700916
[18 / 20] tensor([[0.901, 0.877],
        [0.877, 0.897]]) {'epoch': 18, 'valid/acc': 89.494, 'valid/acc_unbiased': 89.552, 'valid/diff': 1.396, 'valid/acc_skew': 90.25, 'valid/acc_align': 88.854, 'test/acc': 88.861, 'test/acc_unbiased': 88.823, 'test/diff': 2.244, 'test/acc_skew': 88.903, 'test/acc_align': 88.744}
[18 / 20] best valid accuracy: 89.656 at epoch 12 
 best_stats: {'best_valid_epoch': 12, 'best_valid_valid/acc': 89.409, 'best_valid_valid/acc_unbiased': 89.656, 'best_valid_valid/diff': 2.223, 'best_valid_valid/acc_skew': 90.768, 'best_valid_valid/acc_align': 88.545, 'best_valid_test/acc': 88.143, 'best_valid_test/acc_unbiased': 88.212, 'best_valid_test/diff': 2.597, 'best_valid_test/acc_skew': 88.638, 'best_valid_test/acc_align': 87.786}
[18 / 20] best test accuracy: 88.823 at epoch 18 
 best_stats: {'best_test_epoch': 18, 'best_test_valid/acc': 89.494, 'best_test_valid/acc_unbiased': 89.552, 'best_test_valid/diff': 1.396, 'best_test_valid/acc_skew': 90.25, 'best_test_valid/acc_align': 88.854, 'best_test_test/acc': 88.861, 'best_test_test/acc_unbiased': 88.823, 'best_test_test/diff': 2.244, 'best_test_test/acc_skew': 88.903, 'best_test_test/acc_align': 88.744}
[19 / 20] Learning rate: 1e-05 weight: 0.01
[19 / 20] Loss: 4.519466005930052 CE Loss: 0.26679859401886924 Con Loss: 4.516798019581666
[19 / 20] tensor([[0.898, 0.866],
        [0.883, 0.905]]) {'epoch': 19, 'valid/acc': 89.241, 'valid/acc_unbiased': 89.345, 'valid/diff': 1.686, 'valid/acc_skew': 90.188, 'valid/acc_align': 88.502, 'test/acc': 88.776, 'test/acc_unbiased': 88.786, 'test/diff': 2.703, 'test/acc_skew': 89.048, 'test/acc_align': 88.524}
[19 / 20] best valid accuracy: 89.656 at epoch 12 
 best_stats: {'best_valid_epoch': 12, 'best_valid_valid/acc': 89.409, 'best_valid_valid/acc_unbiased': 89.656, 'best_valid_valid/diff': 2.223, 'best_valid_valid/acc_skew': 90.768, 'best_valid_valid/acc_align': 88.545, 'best_valid_test/acc': 88.143, 'best_valid_test/acc_unbiased': 88.212, 'best_valid_test/diff': 2.597, 'best_valid_test/acc_skew': 88.638, 'best_valid_test/acc_align': 87.786}
[19 / 20] best test accuracy: 88.823 at epoch 18 
 best_stats: {'best_test_epoch': 18, 'best_test_valid/acc': 89.494, 'best_test_valid/acc_unbiased': 89.552, 'best_test_valid/diff': 1.396, 'best_test_valid/acc_skew': 90.25, 'best_test_valid/acc_align': 88.854, 'best_test_test/acc': 88.861, 'best_test_test/acc_unbiased': 88.823, 'best_test_test/diff': 2.244, 'best_test_test/acc_skew': 88.903, 'best_test_test/acc_align': 88.744}
[20 / 20] Learning rate: 1e-05 weight: 0.01
[20 / 20] Loss: 4.520161520057053 CE Loss: 0.2645338623503014 Con Loss: 4.5175161919686095
[20 / 20] tensor([[0.892, 0.863],
        [0.885, 0.911]]) {'epoch': 20, 'valid/acc': 88.987, 'valid/acc_unbiased': 89.158, 'valid/diff': 1.562, 'valid/acc_skew': 89.94, 'valid/acc_align': 88.377, 'test/acc': 88.776, 'test/acc_unbiased': 88.781, 'test/diff': 2.77, 'test/acc_skew': 88.888, 'test/acc_align': 88.674}
[20 / 20] best valid accuracy: 89.656 at epoch 12 
 best_stats: {'best_valid_epoch': 12, 'best_valid_valid/acc': 89.409, 'best_valid_valid/acc_unbiased': 89.656, 'best_valid_valid/diff': 2.223, 'best_valid_valid/acc_skew': 90.768, 'best_valid_valid/acc_align': 88.545, 'best_valid_test/acc': 88.143, 'best_valid_test/acc_unbiased': 88.212, 'best_valid_test/diff': 2.597, 'best_valid_test/acc_skew': 88.638, 'best_valid_test/acc_align': 87.786}
[20 / 20] best test accuracy: 88.823 at epoch 18 
 best_stats: {'best_test_epoch': 18, 'best_test_valid/acc': 89.494, 'best_test_valid/acc_unbiased': 89.552, 'best_test_valid/diff': 1.396, 'best_test_valid/acc_skew': 90.25, 'best_test_valid/acc_align': 88.854, 'best_test_test/acc': 88.861, 'best_test_test/acc_unbiased': 88.823, 'best_test_test/diff': 2.244, 'best_test_test/acc_skew': 88.903, 'best_test_test/acc_align': 88.744}
Total training time: 1:38:16
