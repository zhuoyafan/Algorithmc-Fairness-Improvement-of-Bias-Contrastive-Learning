Log level set to: INFO
Set seed: 1
=======> Using Fixed Random Seed: 1 <========
save_path: exp_results/bc-bb0-celeba_blonde-rand1-lr0.001-bs128-cbs64-w0.01-ratio30-aug1-seed1
get_celeba - split:train, aug: False, given_y: True, ratio: 0
use existing blonde indices from data/celeba/pickles/blonde
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [1558, 53577]
Target 1: [18279, 1098]
Binary Target 1
---------------------------
Target 0: [1558, 53577]
Target 1: [18279, 1098]
===================================
Normal Label Distribution: 
Target 0: [1558, 53577]
Target 1: [18279, 1098]
===================================
Use BiasedCelebASplit 
 target_attr: blonde split: train 
 tensor([[ 1558., 18279.],
        [53577.,  1098.]])
get_celeba - split:train, aug: 1, given_y: True, ratio: 30
use existing blonde indices from data/celeba/pickles/blonde
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [1606, 53425]
Target 1: [18350, 1131]
Binary Target 1
---------------------------
Target 0: [1606, 53425]
Target 1: [18350, 1131]
===================================
Normal Label Distribution: 
Target 0: [1606, 53425]
Target 1: [18350, 1131]
===================================
Use BiasedCelebASplit 
 target_attr: blonde split: train 
 tensor([[ 1606., 18350.],
        [53425.,  1131.]])
get_celeba - split:train_valid, aug: False, given_y: True, ratio: 0
use existing blonde indices from data/celeba/pickles/blonde
Use BiasedCelebASplit 
 target_attr: blonde split: train_valid 
 tensor([[  390.,  4598.],
        [13361.,   280.]])
get_celeba - split:valid, aug: False, given_y: True, ratio: 0
Use BiasedCelebASplit 
 target_attr: blonde split: valid 
 tensor([[8535., 2874.],
        [8276.,  182.]])
decay_epochs: [3, 6]
[1 / 10] Learning rate: 0.001 weight: 0.01
[1 / 10] Loss: 4.691544888893473 CE Loss: 0.2069143330830731 Con Loss: 4.6894757521876915
[1 / 10] tensor([[0.906, 0.946],
        [0.912, 0.879]]) {'epoch': 1, 'valid/acc': 92.871, 'valid/acc_unbiased': 91.1, 'valid/diff': 4.514, 'valid/acc_skew': 90.041, 'valid/acc_align': 92.16, 'test/acc': 92.339, 'test/acc_unbiased': 91.09, 'test/diff': 3.699, 'test/acc_skew': 89.24, 'test/acc_align': 92.939}
[1 / 10] best valid accuracy: 91.100 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 92.871, 'best_valid_valid/acc_unbiased': 91.1, 'best_valid_valid/diff': 4.514, 'best_valid_valid/acc_skew': 90.041, 'best_valid_valid/acc_align': 92.16, 'best_valid_test/acc': 92.339, 'best_valid_test/acc_unbiased': 91.09, 'best_valid_test/diff': 3.699, 'best_valid_test/acc_skew': 89.24, 'best_valid_test/acc_align': 92.939}
[1 / 10] best test accuracy: 91.090 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 92.871, 'best_test_valid/acc_unbiased': 91.1, 'best_test_valid/diff': 4.514, 'best_test_valid/acc_skew': 90.041, 'best_test_valid/acc_align': 92.16, 'best_test_test/acc': 92.339, 'best_test_test/acc_unbiased': 91.09, 'best_test_test/diff': 3.699, 'best_test_test/acc_skew': 89.24, 'best_test_test/acc_align': 92.939}
[2 / 10] Learning rate: 0.001 weight: 0.01
[2 / 10] Loss: 4.655510135492542 CE Loss: 0.18424920863492925 Con Loss: 4.65366765012653
[2 / 10] tensor([[0.972, 0.992],
        [0.706, 0.484]]) {'epoch': 2, 'valid/acc': 91.363, 'valid/acc_unbiased': 80.116, 'valid/diff': 10.269, 'valid/acc_skew': 75.151, 'valid/acc_align': 85.081, 'test/acc': 93.738, 'test/acc_unbiased': 78.844, 'test/diff': 12.172, 'test/acc_skew': 72.758, 'test/acc_align': 84.93}
[2 / 10] best valid accuracy: 91.100 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 92.871, 'best_valid_valid/acc_unbiased': 91.1, 'best_valid_valid/diff': 4.514, 'best_valid_valid/acc_skew': 90.041, 'best_valid_valid/acc_align': 92.16, 'best_valid_test/acc': 92.339, 'best_valid_test/acc_unbiased': 91.09, 'best_valid_test/diff': 3.699, 'best_valid_test/acc_skew': 89.24, 'best_valid_test/acc_align': 92.939}
[2 / 10] best test accuracy: 91.090 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 92.871, 'best_test_valid/acc_unbiased': 91.1, 'best_test_valid/diff': 4.514, 'best_test_valid/acc_skew': 90.041, 'best_test_valid/acc_align': 92.16, 'best_test_test/acc': 92.339, 'best_test_test/acc_unbiased': 91.09, 'best_test_test/diff': 3.699, 'best_test_test/acc_skew': 89.24, 'best_test_test/acc_align': 92.939}
[3 / 10] Learning rate: 0.001 weight: 0.01
[3 / 10] Loss: 4.640460673130094 CE Loss: 0.17435228735022926 Con Loss: 4.6387171521062935
[3 / 10] tensor([[0.951, 0.979],
        [0.798, 0.615]]) {'epoch': 3, 'valid/acc': 92.485, 'valid/acc_unbiased': 85.042, 'valid/diff': 8.06, 'valid/acc_skew': 81.68, 'valid/acc_align': 88.403, 'test/acc': 93.764, 'test/acc_unbiased': 83.598, 'test/diff': 10.52, 'test/acc_skew': 78.338, 'test/acc_align': 88.858}
[3 / 10] best valid accuracy: 91.100 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 92.871, 'best_valid_valid/acc_unbiased': 91.1, 'best_valid_valid/diff': 4.514, 'best_valid_valid/acc_skew': 90.041, 'best_valid_valid/acc_align': 92.16, 'best_valid_test/acc': 92.339, 'best_valid_test/acc_unbiased': 91.09, 'best_valid_test/diff': 3.699, 'best_valid_test/acc_skew': 89.24, 'best_valid_test/acc_align': 92.939}
[3 / 10] best test accuracy: 91.090 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 92.871, 'best_test_valid/acc_unbiased': 91.1, 'best_test_valid/diff': 4.514, 'best_test_valid/acc_skew': 90.041, 'best_test_valid/acc_align': 92.16, 'best_test_test/acc': 92.339, 'best_test_test/acc_unbiased': 91.09, 'best_test_test/diff': 3.699, 'best_test_test/acc_skew': 89.24, 'best_test_test/acc_align': 92.939}
[4 / 10] Learning rate: 0.0001 weight: 0.01
[4 / 10] Loss: 4.587699041106503 CE Loss: 0.15404694668095922 Con Loss: 4.586158566908031
[4 / 10] tensor([[0.921, 0.969],
        [0.905, 0.835]]) {'epoch': 4, 'valid/acc': 94.868, 'valid/acc_unbiased': 92.498, 'valid/diff': 3.536, 'valid/acc_skew': 91.474, 'valid/acc_align': 93.521, 'test/acc': 93.784, 'test/acc_unbiased': 90.751, 'test/diff': 5.93, 'test/acc_skew': 87.786, 'test/acc_align': 93.716}
[4 / 10] best valid accuracy: 92.498 at epoch 4 
 best_stats: {'best_valid_epoch': 4, 'best_valid_valid/acc': 94.868, 'best_valid_valid/acc_unbiased': 92.498, 'best_valid_valid/diff': 3.536, 'best_valid_valid/acc_skew': 91.474, 'best_valid_valid/acc_align': 93.521, 'best_valid_test/acc': 93.784, 'best_valid_test/acc_unbiased': 90.751, 'best_valid_test/diff': 5.93, 'best_valid_test/acc_skew': 87.786, 'best_valid_test/acc_align': 93.716}
[4 / 10] best test accuracy: 91.090 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 92.871, 'best_test_valid/acc_unbiased': 91.1, 'best_test_valid/diff': 4.514, 'best_test_valid/acc_skew': 90.041, 'best_test_valid/acc_align': 92.16, 'best_test_test/acc': 92.339, 'best_test_test/acc_unbiased': 91.09, 'best_test_test/diff': 3.699, 'best_test_test/acc_skew': 89.24, 'best_test_test/acc_align': 92.939}
[5 / 10] Learning rate: 0.0001 weight: 0.01
[5 / 10] Loss: 4.557687157132683 CE Loss: 0.14048064867262935 Con Loss: 4.556282354112805
[5 / 10] tensor([[0.937, 0.982],
        [0.890, 0.758]]) {'epoch': 5, 'valid/acc': 94.917, 'valid/acc_unbiased': 91.262, 'valid/diff': 4.681, 'valid/acc_skew': 89.794, 'valid/acc_align': 92.729, 'test/acc': 94.7, 'test/acc_unbiased': 89.158, 'test/diff': 8.818, 'test/acc_skew': 84.749, 'test/acc_align': 93.567}
[5 / 10] best valid accuracy: 92.498 at epoch 4 
 best_stats: {'best_valid_epoch': 4, 'best_valid_valid/acc': 94.868, 'best_valid_valid/acc_unbiased': 92.498, 'best_valid_valid/diff': 3.536, 'best_valid_valid/acc_skew': 91.474, 'best_valid_valid/acc_align': 93.521, 'best_valid_test/acc': 93.784, 'best_valid_test/acc_unbiased': 90.751, 'best_valid_test/diff': 5.93, 'best_valid_test/acc_skew': 87.786, 'best_valid_test/acc_align': 93.716}
[5 / 10] best test accuracy: 91.090 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 92.871, 'best_test_valid/acc_unbiased': 91.1, 'best_test_valid/diff': 4.514, 'best_test_valid/acc_skew': 90.041, 'best_test_valid/acc_align': 92.16, 'best_test_test/acc': 92.339, 'best_test_test/acc_unbiased': 91.09, 'best_test_test/diff': 3.699, 'best_test_test/acc_skew': 89.24, 'best_test_test/acc_align': 92.939}
[6 / 10] Learning rate: 0.0001 weight: 0.01
[6 / 10] Loss: 4.550388973056694 CE Loss: 0.132797445523552 Con Loss: 4.549061007476145
[6 / 10] tensor([[0.924, 0.979],
        [0.906, 0.769]]) {'epoch': 6, 'valid/acc': 95.389, 'valid/acc_unbiased': 92.616, 'valid/diff': 4.43, 'valid/acc_skew': 91.401, 'valid/acc_align': 93.831, 'test/acc': 94.302, 'test/acc_unbiased': 89.465, 'test/diff': 9.622, 'test/acc_skew': 84.654, 'test/acc_align': 94.276}
[6 / 10] best valid accuracy: 92.616 at epoch 6 
 best_stats: {'best_valid_epoch': 6, 'best_valid_valid/acc': 95.389, 'best_valid_valid/acc_unbiased': 92.616, 'best_valid_valid/diff': 4.43, 'best_valid_valid/acc_skew': 91.401, 'best_valid_valid/acc_align': 93.831, 'best_valid_test/acc': 94.302, 'best_valid_test/acc_unbiased': 89.465, 'best_valid_test/diff': 9.622, 'best_valid_test/acc_skew': 84.654, 'best_valid_test/acc_align': 94.276}
[6 / 10] best test accuracy: 91.090 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 92.871, 'best_test_valid/acc_unbiased': 91.1, 'best_test_valid/diff': 4.514, 'best_test_valid/acc_skew': 90.041, 'best_test_valid/acc_align': 92.16, 'best_test_test/acc': 92.339, 'best_test_test/acc_unbiased': 91.09, 'best_test_test/diff': 3.699, 'best_test_test/acc_skew': 89.24, 'best_test_test/acc_align': 92.939}
[7 / 10] Learning rate: 1e-05 weight: 0.01
[7 / 10] Loss: 4.54011377398487 CE Loss: 0.12772472497313375 Con Loss: 4.5388365249560065
[7 / 10] tensor([[0.915, 0.980],
        [0.914, 0.780]]) {'epoch': 7, 'valid/acc': 95.314, 'valid/acc_unbiased': 92.195, 'valid/diff': 5.532, 'valid/acc_skew': 90.508, 'valid/acc_align': 93.883, 'test/acc': 94.086, 'test/acc_unbiased': 89.746, 'test/diff': 9.942, 'test/acc_skew': 84.775, 'test/acc_align': 94.717}
[7 / 10] best valid accuracy: 92.616 at epoch 6 
 best_stats: {'best_valid_epoch': 6, 'best_valid_valid/acc': 95.389, 'best_valid_valid/acc_unbiased': 92.616, 'best_valid_valid/diff': 4.43, 'best_valid_valid/acc_skew': 91.401, 'best_valid_valid/acc_align': 93.831, 'best_valid_test/acc': 94.302, 'best_valid_test/acc_unbiased': 89.465, 'best_valid_test/diff': 9.622, 'best_valid_test/acc_skew': 84.654, 'best_valid_test/acc_align': 94.276}
[7 / 10] best test accuracy: 91.090 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 92.871, 'best_test_valid/acc_unbiased': 91.1, 'best_test_valid/diff': 4.514, 'best_test_valid/acc_skew': 90.041, 'best_test_valid/acc_align': 92.16, 'best_test_test/acc': 92.339, 'best_test_test/acc_unbiased': 91.09, 'best_test_test/diff': 3.699, 'best_test_test/acc_skew': 89.24, 'best_test_test/acc_align': 92.939}
[8 / 10] Learning rate: 1e-05 weight: 0.01
[8 / 10] Loss: 4.537886690934738 CE Loss: 0.12573116898875855 Con Loss: 4.536629379473967
[8 / 10] tensor([[0.926, 0.981],
        [0.902, 0.775]]) {'epoch': 8, 'valid/acc': 95.341, 'valid/acc_unbiased': 92.194, 'valid/diff': 4.812, 'valid/acc_skew': 90.815, 'valid/acc_align': 93.573, 'test/acc': 94.388, 'test/acc_unbiased': 89.575, 'test/diff': 9.106, 'test/acc_skew': 85.022, 'test/acc_align': 94.128}
[8 / 10] best valid accuracy: 92.616 at epoch 6 
 best_stats: {'best_valid_epoch': 6, 'best_valid_valid/acc': 95.389, 'best_valid_valid/acc_unbiased': 92.616, 'best_valid_valid/diff': 4.43, 'best_valid_valid/acc_skew': 91.401, 'best_valid_valid/acc_align': 93.831, 'best_valid_test/acc': 94.302, 'best_valid_test/acc_unbiased': 89.465, 'best_valid_test/diff': 9.622, 'best_valid_test/acc_skew': 84.654, 'best_valid_test/acc_align': 94.276}
[8 / 10] best test accuracy: 91.090 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 92.871, 'best_test_valid/acc_unbiased': 91.1, 'best_test_valid/diff': 4.514, 'best_test_valid/acc_skew': 90.041, 'best_test_valid/acc_align': 92.16, 'best_test_test/acc': 92.339, 'best_test_test/acc_unbiased': 91.09, 'best_test_test/diff': 3.699, 'best_test_test/acc_skew': 89.24, 'best_test_test/acc_align': 92.939}
[9 / 10] Learning rate: 1e-05 weight: 0.01
[9 / 10] Loss: 4.530632783293033 CE Loss: 0.12477291865277909 Con Loss: 4.529385058644864
[9 / 10] tensor([[0.895, 0.971],
        [0.938, 0.857]]) {'epoch': 9, 'valid/acc': 95.604, 'valid/acc_unbiased': 94.043, 'valid/diff': 4.329, 'valid/acc_skew': 92.981, 'valid/acc_align': 95.106, 'test/acc': 93.23, 'test/acc_unbiased': 91.516, 'test/diff': 7.851, 'test/acc_skew': 87.591, 'test/acc_align': 95.441}
[9 / 10] best valid accuracy: 94.043 at epoch 9 
 best_stats: {'best_valid_epoch': 9, 'best_valid_valid/acc': 95.604, 'best_valid_valid/acc_unbiased': 94.043, 'best_valid_valid/diff': 4.329, 'best_valid_valid/acc_skew': 92.981, 'best_valid_valid/acc_align': 95.106, 'best_valid_test/acc': 93.23, 'best_valid_test/acc_unbiased': 91.516, 'best_valid_test/diff': 7.851, 'best_valid_test/acc_skew': 87.591, 'best_valid_test/acc_align': 95.441}
[9 / 10] best test accuracy: 91.516 at epoch 9 
 best_stats: {'best_test_epoch': 9, 'best_test_valid/acc': 95.604, 'best_test_valid/acc_unbiased': 94.043, 'best_test_valid/diff': 4.329, 'best_test_valid/acc_skew': 92.981, 'best_test_valid/acc_align': 95.106, 'best_test_test/acc': 93.23, 'best_test_test/acc_unbiased': 91.516, 'best_test_test/diff': 7.851, 'best_test_test/acc_skew': 87.591, 'best_test_test/acc_align': 95.441}
[10 / 10] Learning rate: 1e-05 weight: 0.01
[10 / 10] Loss: 4.53347406280842 CE Loss: 0.12294302999474138 Con Loss: 4.532244637874106
[10 / 10] tensor([[0.912, 0.978],
        [0.921, 0.791]]) {'epoch': 10, 'valid/acc': 95.571, 'valid/acc_unbiased': 93.4, 'valid/diff': 4.466, 'valid/acc_skew': 92.422, 'valid/acc_align': 94.378, 'test/acc': 93.975, 'test/acc_unbiased': 90.059, 'test/diff': 9.82, 'test/acc_skew': 85.149, 'test/acc_align': 94.969}
[10 / 10] best valid accuracy: 94.043 at epoch 9 
 best_stats: {'best_valid_epoch': 9, 'best_valid_valid/acc': 95.604, 'best_valid_valid/acc_unbiased': 94.043, 'best_valid_valid/diff': 4.329, 'best_valid_valid/acc_skew': 92.981, 'best_valid_valid/acc_align': 95.106, 'best_valid_test/acc': 93.23, 'best_valid_test/acc_unbiased': 91.516, 'best_valid_test/diff': 7.851, 'best_valid_test/acc_skew': 87.591, 'best_valid_test/acc_align': 95.441}
[10 / 10] best test accuracy: 91.516 at epoch 9 
 best_stats: {'best_test_epoch': 9, 'best_test_valid/acc': 95.604, 'best_test_valid/acc_unbiased': 94.043, 'best_test_valid/diff': 4.329, 'best_test_valid/acc_skew': 92.981, 'best_test_valid/acc_align': 95.106, 'best_test_test/acc': 93.23, 'best_test_test/acc_unbiased': 91.516, 'best_test_test/diff': 7.851, 'best_test_test/acc_skew': 87.591, 'best_test_test/acc_align': 95.441}
Total training time: 0:47:01
