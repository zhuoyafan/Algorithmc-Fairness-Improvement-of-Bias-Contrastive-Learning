Log level set to: INFO
Set seed: 2
=======> Using Fixed Random Seed: 2 <========
save_path: exp_results/bc-bb0-utk_face_race-os-0.1-lr0.001-bs128-cbs64-w0.01-ratio10-aug1-seed2
get_utk_face - split: train, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_race-0.1
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [4407, 4976]
Target 1: [3755, 5529]
Binary Target 1
---------------------------
Target 0: [4407, 4976]
Target 1: [3755, 5529]
===================================
Normal Label Distribution: 
Target 0: [4407, 4976]
Target 1: [3755, 5529]
===================================
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [5529, 5529]
Target 1: [5529, 5529]
Binary Target 1
---------------------------
Target 0: [5529, 5529]
Target 1: [5529, 5529]
===================================
Normal Label Distribution: 
Target 0: [5529, 5529]
Target 1: [5529, 5529]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 22116, target_attr: gender, bias_attr: race bias_rate: 0.1
['[train] target_0-bias_0: 5529', '[train] target_0-bias_1: 5529', '[train] target_1-bias_0: 5529', '[train] target_1-bias_1: 5529']
confusion_matrix - 
 original: tensor([[5529., 5529.],
        [5529., 5529.]]), 
 normalized: tensor([[0.500, 0.500],
        [0.500, 0.500]]), 
 b|y: tensor([[0.500, 0.500],
        [0.500, 0.500]])
get_utk_face - split: train, aug: 1, given_y: True, ratio: 10
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_race-0.1
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [4407, 4976]
Target 1: [3755, 5529]
Binary Target 1
---------------------------
Target 0: [4407, 4976]
Target 1: [3755, 5529]
===================================
Normal Label Distribution: 
Target 0: [4407, 4976]
Target 1: [3755, 5529]
===================================
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [5529, 5529]
Target 1: [5529, 5529]
Binary Target 1
---------------------------
Target 0: [5529, 5529]
Target 1: [5529, 5529]
===================================
Normal Label Distribution: 
Target 0: [5529, 5529]
Target 1: [5529, 5529]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 22116, target_attr: gender, bias_attr: race bias_rate: 0.1
['[train] target_0-bias_0: 5529', '[train] target_0-bias_1: 5529', '[train] target_1-bias_0: 5529', '[train] target_1-bias_1: 5529']
get_utk_face - split: valid, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_race-0.1
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [583, 684]
Target 1: [457, 646]
Binary Target 1
---------------------------
Target 0: [583, 684]
Target 1: [457, 646]
===================================
Normal Label Distribution: 
Target 0: [583, 684]
Target 1: [457, 646]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 2370, target_attr: gender, bias_attr: race bias_rate: 0.1
['[valid] target_0-bias_0: 583', '[valid] target_0-bias_1: 684', '[valid] target_1-bias_0: 457', '[valid] target_1-bias_1: 646']
get_utk_face - split: test, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_race-0.1
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [558, 677]
Target 1: [462, 673]
Binary Target 1
---------------------------
Target 0: [558, 677]
Target 1: [462, 673]
===================================
Normal Label Distribution: 
Target 0: [558, 677]
Target 1: [462, 673]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 2370, target_attr: gender, bias_attr: race bias_rate: 0.1
['[test] target_0-bias_0: 558', '[test] target_0-bias_1: 677', '[test] target_1-bias_0: 462', '[test] target_1-bias_1: 673']
decay_epochs: [6, 13]
[1 / 20] Learning rate: 0.001 weight: 0.01
[1 / 20] Loss: 4.828333526779675 CE Loss: 0.51095818895978 Con Loss: 4.823223952812406
[1 / 20] tensor([[0.688, 0.674],
        [0.939, 0.945]]) {'epoch': 1, 'valid/acc': 79.114, 'valid/acc_unbiased': 80.014, 'valid/diff': 1.974, 'valid/acc_skew': 80.08, 'valid/acc_align': 79.949, 'test/acc': 80.591, 'test/acc_unbiased': 81.154, 'test/diff': 1.012, 'test/acc_skew': 81.378, 'test/acc_align': 80.929}
[1 / 20] best valid accuracy: 80.014 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 79.114, 'best_valid_valid/acc_unbiased': 80.014, 'best_valid_valid/diff': 1.974, 'best_valid_valid/acc_skew': 80.08, 'best_valid_valid/acc_align': 79.949, 'best_valid_test/acc': 80.591, 'best_valid_test/acc_unbiased': 81.154, 'best_valid_test/diff': 1.012, 'best_valid_test/acc_skew': 81.378, 'best_valid_test/acc_align': 80.929}
[1 / 20] best test accuracy: 81.154 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 79.114, 'best_test_valid/acc_unbiased': 80.014, 'best_test_valid/diff': 1.974, 'best_test_valid/acc_skew': 80.08, 'best_test_valid/acc_align': 79.949, 'best_test_test/acc': 80.591, 'best_test_test/acc_unbiased': 81.154, 'best_test_test/diff': 1.012, 'best_test_test/acc_skew': 81.378, 'best_test_test/acc_align': 80.929}
[2 / 20] Learning rate: 0.001 weight: 0.01
[2 / 20] Loss: 4.7281714092868 CE Loss: 0.4207448785517181 Con Loss: 4.723963959390851
[2 / 20] tensor([[0.642, 0.626],
        [0.961, 0.954]]) {'epoch': 2, 'valid/acc': 78.186, 'valid/acc_unbiased': 79.296, 'valid/diff': 0.921, 'valid/acc_skew': 79.201, 'valid/acc_align': 79.39, 'test/acc': 78.819, 'test/acc_unbiased': 79.571, 'test/diff': 1.119, 'test/acc_skew': 80.131, 'test/acc_align': 79.011}
[2 / 20] best valid accuracy: 80.014 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 79.114, 'best_valid_valid/acc_unbiased': 80.014, 'best_valid_valid/diff': 1.974, 'best_valid_valid/acc_skew': 80.08, 'best_valid_valid/acc_align': 79.949, 'best_valid_test/acc': 80.591, 'best_valid_test/acc_unbiased': 81.154, 'best_valid_test/diff': 1.012, 'best_valid_test/acc_skew': 81.378, 'best_valid_test/acc_align': 80.929}
[2 / 20] best test accuracy: 81.154 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 79.114, 'best_test_valid/acc_unbiased': 80.014, 'best_test_valid/diff': 1.974, 'best_test_valid/acc_skew': 80.08, 'best_test_valid/acc_align': 79.949, 'best_test_test/acc': 80.591, 'best_test_test/acc_unbiased': 81.154, 'best_test_test/diff': 1.012, 'best_test_test/acc_skew': 81.378, 'best_test_test/acc_align': 80.929}
[3 / 20] Learning rate: 0.001 weight: 0.01
[3 / 20] Loss: 4.7079536151144294 CE Loss: 0.41071234833463277 Con Loss: 4.703846490066206
[3 / 20] tensor([[0.944, 0.919],
        [0.660, 0.694]]) {'epoch': 3, 'valid/acc': 81.857, 'valid/acc_unbiased': 80.963, 'valid/diff': 1.693, 'valid/acc_skew': 81.297, 'valid/acc_align': 80.629, 'test/acc': 81.055, 'test/acc_unbiased': 80.432, 'test/diff': 2.971, 'test/acc_skew': 80.231, 'test/acc_align': 80.633}
[3 / 20] best valid accuracy: 80.963 at epoch 3 
 best_stats: {'best_valid_epoch': 3, 'best_valid_valid/acc': 81.857, 'best_valid_valid/acc_unbiased': 80.963, 'best_valid_valid/diff': 1.693, 'best_valid_valid/acc_skew': 81.297, 'best_valid_valid/acc_align': 80.629, 'best_valid_test/acc': 81.055, 'best_valid_test/acc_unbiased': 80.432, 'best_valid_test/diff': 2.971, 'best_valid_test/acc_skew': 80.231, 'best_valid_test/acc_align': 80.633}
[3 / 20] best test accuracy: 81.154 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 79.114, 'best_test_valid/acc_unbiased': 80.014, 'best_test_valid/diff': 1.974, 'best_test_valid/acc_skew': 80.08, 'best_test_valid/acc_align': 79.949, 'best_test_test/acc': 80.591, 'best_test_test/acc_unbiased': 81.154, 'best_test_test/diff': 1.012, 'best_test_test/acc_skew': 81.378, 'best_test_test/acc_align': 80.929}
[4 / 20] Learning rate: 0.001 weight: 0.01
[4 / 20] Loss: 4.699047813926086 CE Loss: 0.3917785520837328 Con Loss: 4.695130007373509
[4 / 20] tensor([[0.944, 0.945],
        [0.719, 0.697]]) {'epoch': 4, 'valid/acc': 83.418, 'valid/acc_unbiased': 82.835, 'valid/diff': 2.46, 'valid/acc_skew': 84.064, 'valid/acc_align': 81.605, 'test/acc': 83.038, 'test/acc_unbiased': 82.632, 'test/diff': 1.132, 'test/acc_skew': 83.153, 'test/acc_align': 82.111}
[4 / 20] best valid accuracy: 82.835 at epoch 4 
 best_stats: {'best_valid_epoch': 4, 'best_valid_valid/acc': 83.418, 'best_valid_valid/acc_unbiased': 82.835, 'best_valid_valid/diff': 2.46, 'best_valid_valid/acc_skew': 84.064, 'best_valid_valid/acc_align': 81.605, 'best_valid_test/acc': 83.038, 'best_valid_test/acc_unbiased': 82.632, 'best_valid_test/diff': 1.132, 'best_valid_test/acc_skew': 83.153, 'best_valid_test/acc_align': 82.111}
[4 / 20] best test accuracy: 82.632 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 83.418, 'best_test_valid/acc_unbiased': 82.835, 'best_test_valid/diff': 2.46, 'best_test_valid/acc_skew': 84.064, 'best_test_valid/acc_align': 81.605, 'best_test_test/acc': 83.038, 'best_test_test/acc_unbiased': 82.632, 'best_test_test/diff': 1.132, 'best_test_test/acc_skew': 83.153, 'best_test_test/acc_align': 82.111}
[5 / 20] Learning rate: 0.001 weight: 0.01
[5 / 20] Loss: 4.692993103692449 CE Loss: 0.3793794696553962 Con Loss: 4.689199296620466
[5 / 20] tensor([[0.935, 0.919],
        [0.742, 0.768]]) {'epoch': 5, 'valid/acc': 85.612, 'valid/acc_unbiased': 85.132, 'valid/diff': 1.757, 'valid/acc_skew': 86.01, 'valid/acc_align': 84.254, 'test/acc': 84.557, 'test/acc_unbiased': 84.122, 'test/diff': 2.125, 'test/acc_skew': 83.895, 'test/acc_align': 84.348}
[5 / 20] best valid accuracy: 85.132 at epoch 5 
 best_stats: {'best_valid_epoch': 5, 'best_valid_valid/acc': 85.612, 'best_valid_valid/acc_unbiased': 85.132, 'best_valid_valid/diff': 1.757, 'best_valid_valid/acc_skew': 86.01, 'best_valid_valid/acc_align': 84.254, 'best_valid_test/acc': 84.557, 'best_valid_test/acc_unbiased': 84.122, 'best_valid_test/diff': 2.125, 'best_valid_test/acc_skew': 83.895, 'best_valid_test/acc_align': 84.348}
[5 / 20] best test accuracy: 84.122 at epoch 5 
 best_stats: {'best_test_epoch': 5, 'best_test_valid/acc': 85.612, 'best_test_valid/acc_unbiased': 85.132, 'best_test_valid/diff': 1.757, 'best_test_valid/acc_skew': 86.01, 'best_test_valid/acc_align': 84.254, 'best_test_test/acc': 84.557, 'best_test_test/acc_unbiased': 84.122, 'best_test_test/diff': 2.125, 'best_test_test/acc_skew': 83.895, 'best_test_test/acc_align': 84.348}
[6 / 20] Learning rate: 0.001 weight: 0.01
[6 / 20] Loss: 4.674660525026147 CE Loss: 0.3694767188230288 Con Loss: 4.6709657603695245
[6 / 20] tensor([[0.891, 0.895],
        [0.797, 0.823]]) {'epoch': 6, 'valid/acc': 85.949, 'valid/acc_unbiased': 85.858, 'valid/diff': 2.83, 'valid/acc_skew': 87.273, 'valid/acc_align': 84.443, 'test/acc': 85.443, 'test/acc_unbiased': 85.138, 'test/diff': 1.554, 'test/acc_skew': 84.361, 'test/acc_align': 85.915}
[6 / 20] best valid accuracy: 85.858 at epoch 6 
 best_stats: {'best_valid_epoch': 6, 'best_valid_valid/acc': 85.949, 'best_valid_valid/acc_unbiased': 85.858, 'best_valid_valid/diff': 2.83, 'best_valid_valid/acc_skew': 87.273, 'best_valid_valid/acc_align': 84.443, 'best_valid_test/acc': 85.443, 'best_valid_test/acc_unbiased': 85.138, 'best_valid_test/diff': 1.554, 'best_valid_test/acc_skew': 84.361, 'best_valid_test/acc_align': 85.915}
[6 / 20] best test accuracy: 85.138 at epoch 6 
 best_stats: {'best_test_epoch': 6, 'best_test_valid/acc': 85.949, 'best_test_valid/acc_unbiased': 85.858, 'best_test_valid/diff': 2.83, 'best_test_valid/acc_skew': 87.273, 'best_test_valid/acc_align': 84.443, 'best_test_test/acc': 85.443, 'best_test_test/acc_unbiased': 85.138, 'best_test_test/diff': 1.554, 'best_test_test/acc_skew': 84.361, 'best_test_test/acc_align': 85.915}
[7 / 20] Learning rate: 0.0001 weight: 0.01
[7 / 20] Loss: 4.612011502935693 CE Loss: 0.3260207212753938 Con Loss: 4.608751308208651
[7 / 20] tensor([[0.891, 0.883],
        [0.868, 0.889]]) {'epoch': 7, 'valid/acc': 87.848, 'valid/acc_unbiased': 87.883, 'valid/diff': 1.672, 'valid/acc_skew': 88.369, 'valid/acc_align': 87.397, 'test/acc': 88.354, 'test/acc_unbiased': 88.263, 'test/diff': 1.398, 'test/acc_skew': 87.932, 'test/acc_align': 88.593}
[7 / 20] best valid accuracy: 87.883 at epoch 7 
 best_stats: {'best_valid_epoch': 7, 'best_valid_valid/acc': 87.848, 'best_valid_valid/acc_unbiased': 87.883, 'best_valid_valid/diff': 1.672, 'best_valid_valid/acc_skew': 88.369, 'best_valid_valid/acc_align': 87.397, 'best_valid_test/acc': 88.354, 'best_valid_test/acc_unbiased': 88.263, 'best_valid_test/diff': 1.398, 'best_valid_test/acc_skew': 87.932, 'best_valid_test/acc_align': 88.593}
[7 / 20] best test accuracy: 88.263 at epoch 7 
 best_stats: {'best_test_epoch': 7, 'best_test_valid/acc': 87.848, 'best_test_valid/acc_unbiased': 87.883, 'best_test_valid/diff': 1.672, 'best_test_valid/acc_skew': 88.369, 'best_test_valid/acc_align': 87.397, 'best_test_test/acc': 88.354, 'best_test_test/acc_unbiased': 88.263, 'best_test_test/diff': 1.398, 'best_test_test/acc_skew': 87.932, 'best_test_test/acc_align': 88.593}
[8 / 20] Learning rate: 0.0001 weight: 0.01
[8 / 20] Loss: 4.605738565058923 CE Loss: 0.3132649710077471 Con Loss: 4.602605928109511
[8 / 20] tensor([[0.858, 0.854],
        [0.896, 0.920]]) {'epoch': 8, 'valid/acc': 88.228, 'valid/acc_unbiased': 88.519, 'valid/diff': 2.144, 'valid/acc_skew': 89.1, 'valid/acc_align': 87.939, 'test/acc': 88.186, 'test/acc_unbiased': 88.201, 'test/diff': 1.416, 'test/acc_skew': 87.726, 'test/acc_align': 88.676}
[8 / 20] best valid accuracy: 88.519 at epoch 8 
 best_stats: {'best_valid_epoch': 8, 'best_valid_valid/acc': 88.228, 'best_valid_valid/acc_unbiased': 88.519, 'best_valid_valid/diff': 2.144, 'best_valid_valid/acc_skew': 89.1, 'best_valid_valid/acc_align': 87.939, 'best_valid_test/acc': 88.186, 'best_valid_test/acc_unbiased': 88.201, 'best_valid_test/diff': 1.416, 'best_valid_test/acc_skew': 87.726, 'best_valid_test/acc_align': 88.676}
[8 / 20] best test accuracy: 88.263 at epoch 7 
 best_stats: {'best_test_epoch': 7, 'best_test_valid/acc': 87.848, 'best_test_valid/acc_unbiased': 87.883, 'best_test_valid/diff': 1.672, 'best_test_valid/acc_skew': 88.369, 'best_test_valid/acc_align': 87.397, 'best_test_test/acc': 88.354, 'best_test_test/acc_unbiased': 88.263, 'best_test_test/diff': 1.398, 'best_test_test/acc_skew': 87.932, 'best_test_test/acc_align': 88.593}
[9 / 20] Learning rate: 0.0001 weight: 0.01
[9 / 20] Loss: 4.598743912625602 CE Loss: 0.3016090680363166 Con Loss: 4.595727808071446
[9 / 20] tensor([[0.860, 0.845],
        [0.905, 0.915]]) {'epoch': 9, 'valid/acc': 88.481, 'valid/acc_unbiased': 88.809, 'valid/diff': 2.293, 'valid/acc_skew': 89.366, 'valid/acc_align': 88.252, 'test/acc': 88.017, 'test/acc_unbiased': 88.13, 'test/diff': 1.293, 'test/acc_skew': 88.249, 'test/acc_align': 88.01}
[9 / 20] best valid accuracy: 88.809 at epoch 9 
 best_stats: {'best_valid_epoch': 9, 'best_valid_valid/acc': 88.481, 'best_valid_valid/acc_unbiased': 88.809, 'best_valid_valid/diff': 2.293, 'best_valid_valid/acc_skew': 89.366, 'best_valid_valid/acc_align': 88.252, 'best_valid_test/acc': 88.017, 'best_valid_test/acc_unbiased': 88.13, 'best_valid_test/diff': 1.293, 'best_valid_test/acc_skew': 88.249, 'best_valid_test/acc_align': 88.01}
[9 / 20] best test accuracy: 88.263 at epoch 7 
 best_stats: {'best_test_epoch': 7, 'best_test_valid/acc': 87.848, 'best_test_valid/acc_unbiased': 87.883, 'best_test_valid/diff': 1.672, 'best_test_valid/acc_skew': 88.369, 'best_test_valid/acc_align': 87.397, 'best_test_test/acc': 88.354, 'best_test_test/acc_unbiased': 88.263, 'best_test_test/diff': 1.398, 'best_test_test/acc_skew': 87.932, 'best_test_test/acc_align': 88.593}
[10 / 20] Learning rate: 0.0001 weight: 0.01
[10 / 20] Loss: 4.590661635599811 CE Loss: 0.306379460077278 Con Loss: 4.587597828442633
[10 / 20] tensor([[0.896, 0.886],
        [0.877, 0.887]]) {'epoch': 10, 'valid/acc': 89.367, 'valid/acc_unbiased': 89.46, 'valid/diff': 2.019, 'valid/acc_skew': 90.469, 'valid/acc_align': 88.45, 'test/acc': 88.692, 'test/acc_unbiased': 88.65, 'test/diff': 1.012, 'test/acc_skew': 88.634, 'test/acc_align': 88.667}
[10 / 20] best valid accuracy: 89.460 at epoch 10 
 best_stats: {'best_valid_epoch': 10, 'best_valid_valid/acc': 89.367, 'best_valid_valid/acc_unbiased': 89.46, 'best_valid_valid/diff': 2.019, 'best_valid_valid/acc_skew': 90.469, 'best_valid_valid/acc_align': 88.45, 'best_valid_test/acc': 88.692, 'best_valid_test/acc_unbiased': 88.65, 'best_valid_test/diff': 1.012, 'best_valid_test/acc_skew': 88.634, 'best_valid_test/acc_align': 88.667}
[10 / 20] best test accuracy: 88.650 at epoch 10 
 best_stats: {'best_test_epoch': 10, 'best_test_valid/acc': 89.367, 'best_test_valid/acc_unbiased': 89.46, 'best_test_valid/diff': 2.019, 'best_test_valid/acc_skew': 90.469, 'best_test_valid/acc_align': 88.45, 'best_test_test/acc': 88.692, 'best_test_test/acc_unbiased': 88.65, 'best_test_test/diff': 1.012, 'best_test_test/acc_skew': 88.634, 'best_test_test/acc_align': 88.667}
[11 / 20] Learning rate: 0.0001 weight: 0.01
[11 / 20] Loss: 4.577947542753201 CE Loss: 0.29905525994227533 Con Loss: 4.574956984389732
[11 / 20] tensor([[0.871, 0.869],
        [0.887, 0.912]]) {'epoch': 11, 'valid/acc': 89.198, 'valid/acc_unbiased': 89.504, 'valid/diff': 2.365, 'valid/acc_skew': 90.566, 'valid/acc_align': 88.442, 'test/acc': 88.523, 'test/acc_unbiased': 88.482, 'test/diff': 1.366, 'test/acc_skew': 87.921, 'test/acc_align': 89.044}
[11 / 20] best valid accuracy: 89.504 at epoch 11 
 best_stats: {'best_valid_epoch': 11, 'best_valid_valid/acc': 89.198, 'best_valid_valid/acc_unbiased': 89.504, 'best_valid_valid/diff': 2.365, 'best_valid_valid/acc_skew': 90.566, 'best_valid_valid/acc_align': 88.442, 'best_valid_test/acc': 88.523, 'best_valid_test/acc_unbiased': 88.482, 'best_valid_test/diff': 1.366, 'best_valid_test/acc_skew': 87.921, 'best_valid_test/acc_align': 89.044}
[11 / 20] best test accuracy: 88.650 at epoch 10 
 best_stats: {'best_test_epoch': 10, 'best_test_valid/acc': 89.367, 'best_test_valid/acc_unbiased': 89.46, 'best_test_valid/diff': 2.019, 'best_test_valid/acc_skew': 90.469, 'best_test_valid/acc_align': 88.45, 'best_test_test/acc': 88.692, 'best_test_test/acc_unbiased': 88.65, 'best_test_test/diff': 1.012, 'best_test_test/acc_skew': 88.634, 'best_test_test/acc_align': 88.667}
[12 / 20] Learning rate: 0.0001 weight: 0.01
[12 / 20] Loss: 4.578627878555792 CE Loss: 0.2933302914811681 Con Loss: 4.57569456281574
[12 / 20] tensor([[0.887, 0.867],
        [0.883, 0.921]]) {'epoch': 12, 'valid/acc': 89.114, 'valid/acc_unbiased': 89.36, 'valid/diff': 1.786, 'valid/acc_skew': 90.253, 'valid/acc_align': 88.467, 'test/acc': 89.03, 'test/acc_unbiased': 88.963, 'test/diff': 2.908, 'test/acc_skew': 88.511, 'test/acc_align': 89.415}
[12 / 20] best valid accuracy: 89.504 at epoch 11 
 best_stats: {'best_valid_epoch': 11, 'best_valid_valid/acc': 89.198, 'best_valid_valid/acc_unbiased': 89.504, 'best_valid_valid/diff': 2.365, 'best_valid_valid/acc_skew': 90.566, 'best_valid_valid/acc_align': 88.442, 'best_valid_test/acc': 88.523, 'best_valid_test/acc_unbiased': 88.482, 'best_valid_test/diff': 1.366, 'best_valid_test/acc_skew': 87.921, 'best_valid_test/acc_align': 89.044}
[12 / 20] best test accuracy: 88.963 at epoch 12 
 best_stats: {'best_test_epoch': 12, 'best_test_valid/acc': 89.114, 'best_test_valid/acc_unbiased': 89.36, 'best_test_valid/diff': 1.786, 'best_test_valid/acc_skew': 90.253, 'best_test_valid/acc_align': 88.467, 'best_test_test/acc': 89.03, 'best_test_test/acc_unbiased': 88.963, 'best_test_test/diff': 2.908, 'best_test_test/acc_skew': 88.511, 'best_test_test/acc_align': 89.415}
[13 / 20] Learning rate: 0.0001 weight: 0.01
[13 / 20] Loss: 4.578405971789278 CE Loss: 0.28996668834435313 Con Loss: 4.575506295535163
[13 / 20] tensor([[0.912, 0.898],
        [0.855, 0.886]]) {'epoch': 13, 'valid/acc': 89.409, 'valid/acc_unbiased': 89.527, 'valid/diff': 3.056, 'valid/acc_skew': 90.711, 'valid/acc_align': 88.343, 'test/acc': 88.945, 'test/acc_unbiased': 88.771, 'test/diff': 2.236, 'test/acc_skew': 88.358, 'test/acc_align': 89.183}
[13 / 20] best valid accuracy: 89.527 at epoch 13 
 best_stats: {'best_valid_epoch': 13, 'best_valid_valid/acc': 89.409, 'best_valid_valid/acc_unbiased': 89.527, 'best_valid_valid/diff': 3.056, 'best_valid_valid/acc_skew': 90.711, 'best_valid_valid/acc_align': 88.343, 'best_valid_test/acc': 88.945, 'best_valid_test/acc_unbiased': 88.771, 'best_valid_test/diff': 2.236, 'best_valid_test/acc_skew': 88.358, 'best_valid_test/acc_align': 89.183}
[13 / 20] best test accuracy: 88.963 at epoch 12 
 best_stats: {'best_test_epoch': 12, 'best_test_valid/acc': 89.114, 'best_test_valid/acc_unbiased': 89.36, 'best_test_valid/diff': 1.786, 'best_test_valid/acc_skew': 90.253, 'best_test_valid/acc_align': 88.467, 'best_test_test/acc': 89.03, 'best_test_test/acc_unbiased': 88.963, 'best_test_test/diff': 2.908, 'best_test_test/acc_skew': 88.511, 'best_test_test/acc_align': 89.415}
[14 / 20] Learning rate: 1e-05 weight: 0.01
[14 / 20] Loss: 4.5689589015224525 CE Loss: 0.2849254293502358 Con Loss: 4.566109629344888
[14 / 20] tensor([[0.898, 0.891],
        [0.866, 0.892]]) {'epoch': 14, 'valid/acc': 89.873, 'valid/acc_unbiased': 90.009, 'valid/diff': 2.676, 'valid/acc_skew': 90.892, 'valid/acc_align': 89.125, 'test/acc': 88.776, 'test/acc_unbiased': 88.647, 'test/diff': 1.644, 'test/acc_skew': 88.183, 'test/acc_align': 89.111}
[14 / 20] best valid accuracy: 90.009 at epoch 14 
 best_stats: {'best_valid_epoch': 14, 'best_valid_valid/acc': 89.873, 'best_valid_valid/acc_unbiased': 90.009, 'best_valid_valid/diff': 2.676, 'best_valid_valid/acc_skew': 90.892, 'best_valid_valid/acc_align': 89.125, 'best_valid_test/acc': 88.776, 'best_valid_test/acc_unbiased': 88.647, 'best_valid_test/diff': 1.644, 'best_valid_test/acc_skew': 88.183, 'best_valid_test/acc_align': 89.111}
[14 / 20] best test accuracy: 88.963 at epoch 12 
 best_stats: {'best_test_epoch': 12, 'best_test_valid/acc': 89.114, 'best_test_valid/acc_unbiased': 89.36, 'best_test_valid/diff': 1.786, 'best_test_valid/acc_skew': 90.253, 'best_test_valid/acc_align': 88.467, 'best_test_test/acc': 89.03, 'best_test_test/acc_unbiased': 88.963, 'best_test_test/diff': 2.908, 'best_test_test/acc_skew': 88.511, 'best_test_test/acc_align': 89.415}
[15 / 20] Learning rate: 1e-05 weight: 0.01
[15 / 20] Loss: 4.56016560906548 CE Loss: 0.28450650430044744 Con Loss: 4.5573205385572075
[15 / 20] tensor([[0.891, 0.880],
        [0.879, 0.905]]) {'epoch': 15, 'valid/acc': 90.042, 'valid/acc_unbiased': 90.24, 'valid/diff': 2.431, 'valid/acc_skew': 91.096, 'valid/acc_align': 89.383, 'test/acc': 88.945, 'test/acc_unbiased': 88.868, 'test/diff': 1.822, 'test/acc_skew': 88.473, 'test/acc_align': 89.263}
[15 / 20] best valid accuracy: 90.240 at epoch 15 
 best_stats: {'best_valid_epoch': 15, 'best_valid_valid/acc': 90.042, 'best_valid_valid/acc_unbiased': 90.24, 'best_valid_valid/diff': 2.431, 'best_valid_valid/acc_skew': 91.096, 'best_valid_valid/acc_align': 89.383, 'best_valid_test/acc': 88.945, 'best_valid_test/acc_unbiased': 88.868, 'best_valid_test/diff': 1.822, 'best_valid_test/acc_skew': 88.473, 'best_valid_test/acc_align': 89.263}
[15 / 20] best test accuracy: 88.963 at epoch 12 
 best_stats: {'best_test_epoch': 12, 'best_test_valid/acc': 89.114, 'best_test_valid/acc_unbiased': 89.36, 'best_test_valid/diff': 1.786, 'best_test_valid/acc_skew': 90.253, 'best_test_valid/acc_align': 88.467, 'best_test_test/acc': 89.03, 'best_test_test/acc_unbiased': 88.963, 'best_test_test/diff': 2.908, 'best_test_test/acc_skew': 88.511, 'best_test_test/acc_align': 89.415}
[16 / 20] Learning rate: 1e-05 weight: 0.01
[16 / 20] Loss: 4.559273405604605 CE Loss: 0.2874099927642587 Con Loss: 4.556399314178009
[16 / 20] tensor([[0.889, 0.876],
        [0.887, 0.909]]) {'epoch': 16, 'valid/acc': 90.169, 'valid/acc_unbiased': 90.421, 'valid/diff': 2.178, 'valid/acc_skew': 91.51, 'valid/acc_align': 89.332, 'test/acc': 89.072, 'test/acc_unbiased': 89.04, 'test/diff': 1.744, 'test/acc_skew': 88.817, 'test/acc_align': 89.264}
[16 / 20] best valid accuracy: 90.421 at epoch 16 
 best_stats: {'best_valid_epoch': 16, 'best_valid_valid/acc': 90.169, 'best_valid_valid/acc_unbiased': 90.421, 'best_valid_valid/diff': 2.178, 'best_valid_valid/acc_skew': 91.51, 'best_valid_valid/acc_align': 89.332, 'best_valid_test/acc': 89.072, 'best_valid_test/acc_unbiased': 89.04, 'best_valid_test/diff': 1.744, 'best_valid_test/acc_skew': 88.817, 'best_valid_test/acc_align': 89.264}
[16 / 20] best test accuracy: 89.040 at epoch 16 
 best_stats: {'best_test_epoch': 16, 'best_test_valid/acc': 90.169, 'best_test_valid/acc_unbiased': 90.421, 'best_test_valid/diff': 2.178, 'best_test_valid/acc_skew': 91.51, 'best_test_valid/acc_align': 89.332, 'best_test_test/acc': 89.072, 'best_test_test/acc_unbiased': 89.04, 'best_test_test/diff': 1.744, 'best_test_test/acc_skew': 88.817, 'best_test_test/acc_align': 89.264}
[17 / 20] Learning rate: 1e-05 weight: 0.01
[17 / 20] Loss: 4.552439628834965 CE Loss: 0.2803832581093264 Con Loss: 4.549635796332191
[17 / 20] tensor([[0.896, 0.880],
        [0.887, 0.902]]) {'epoch': 17, 'valid/acc': 90.0, 'valid/acc_unbiased': 90.244, 'valid/diff': 2.422, 'valid/acc_skew': 91.4, 'valid/acc_align': 89.087, 'test/acc': 89.156, 'test/acc_unbiased': 89.145, 'test/diff': 1.509, 'test/acc_skew': 89.175, 'test/acc_align': 89.114}
[17 / 20] best valid accuracy: 90.421 at epoch 16 
 best_stats: {'best_valid_epoch': 16, 'best_valid_valid/acc': 90.169, 'best_valid_valid/acc_unbiased': 90.421, 'best_valid_valid/diff': 2.178, 'best_valid_valid/acc_skew': 91.51, 'best_valid_valid/acc_align': 89.332, 'best_valid_test/acc': 89.072, 'best_valid_test/acc_unbiased': 89.04, 'best_valid_test/diff': 1.744, 'best_valid_test/acc_skew': 88.817, 'best_valid_test/acc_align': 89.264}
[17 / 20] best test accuracy: 89.145 at epoch 17 
 best_stats: {'best_test_epoch': 17, 'best_test_valid/acc': 90.0, 'best_test_valid/acc_unbiased': 90.244, 'best_test_valid/diff': 2.422, 'best_test_valid/acc_skew': 91.4, 'best_test_valid/acc_align': 89.087, 'best_test_test/acc': 89.156, 'best_test_test/acc_unbiased': 89.145, 'best_test_test/diff': 1.509, 'best_test_test/acc_skew': 89.175, 'best_test_test/acc_align': 89.114}
[18 / 20] Learning rate: 1e-05 weight: 0.01
[18 / 20] Loss: 4.550487889327631 CE Loss: 0.28198004307400193 Con Loss: 4.547668086531624
[18 / 20] tensor([[0.907, 0.889],
        [0.868, 0.896]]) {'epoch': 18, 'valid/acc': 89.831, 'valid/acc_unbiased': 90.013, 'valid/diff': 2.662, 'valid/acc_skew': 91.344, 'valid/acc_align': 88.682, 'test/acc': 89.114, 'test/acc_unbiased': 89.0, 'test/diff': 2.281, 'test/acc_skew': 88.739, 'test/acc_align': 89.26}
[18 / 20] best valid accuracy: 90.421 at epoch 16 
 best_stats: {'best_valid_epoch': 16, 'best_valid_valid/acc': 90.169, 'best_valid_valid/acc_unbiased': 90.421, 'best_valid_valid/diff': 2.178, 'best_valid_valid/acc_skew': 91.51, 'best_valid_valid/acc_align': 89.332, 'best_valid_test/acc': 89.072, 'best_valid_test/acc_unbiased': 89.04, 'best_valid_test/diff': 1.744, 'best_valid_test/acc_skew': 88.817, 'best_valid_test/acc_align': 89.264}
[18 / 20] best test accuracy: 89.145 at epoch 17 
 best_stats: {'best_test_epoch': 17, 'best_test_valid/acc': 90.0, 'best_test_valid/acc_unbiased': 90.244, 'best_test_valid/diff': 2.422, 'best_test_valid/acc_skew': 91.4, 'best_test_valid/acc_align': 89.087, 'best_test_test/acc': 89.156, 'best_test_test/acc_unbiased': 89.145, 'best_test_test/diff': 1.509, 'best_test_test/acc_skew': 89.175, 'best_test_test/acc_align': 89.114}
[19 / 20] Learning rate: 1e-05 weight: 0.01
[19 / 20] Loss: 4.556941993759605 CE Loss: 0.28089726672484744 Con Loss: 4.554133006258195
[19 / 20] tensor([[0.900, 0.880],
        [0.877, 0.897]]) {'epoch': 19, 'valid/acc': 89.831, 'valid/acc_unbiased': 90.035, 'valid/diff': 2.37, 'valid/acc_skew': 91.22, 'valid/acc_align': 88.85, 'test/acc': 88.903, 'test/acc_unbiased': 88.852, 'test/diff': 2.007, 'test/acc_skew': 88.813, 'test/acc_align': 88.891}
[19 / 20] best valid accuracy: 90.421 at epoch 16 
 best_stats: {'best_valid_epoch': 16, 'best_valid_valid/acc': 90.169, 'best_valid_valid/acc_unbiased': 90.421, 'best_valid_valid/diff': 2.178, 'best_valid_valid/acc_skew': 91.51, 'best_valid_valid/acc_align': 89.332, 'best_valid_test/acc': 89.072, 'best_valid_test/acc_unbiased': 89.04, 'best_valid_test/diff': 1.744, 'best_valid_test/acc_skew': 88.817, 'best_valid_test/acc_align': 89.264}
[19 / 20] best test accuracy: 89.145 at epoch 17 
 best_stats: {'best_test_epoch': 17, 'best_test_valid/acc': 90.0, 'best_test_valid/acc_unbiased': 90.244, 'best_test_valid/diff': 2.422, 'best_test_valid/acc_skew': 91.4, 'best_test_valid/acc_align': 89.087, 'best_test_test/acc': 89.156, 'best_test_test/acc_unbiased': 89.145, 'best_test_test/diff': 1.509, 'best_test_test/acc_skew': 89.175, 'best_test_test/acc_align': 89.114}
[20 / 20] Learning rate: 1e-05 weight: 0.01
[20 / 20] Loss: 4.560919665065634 CE Loss: 0.27690419450140835 Con Loss: 4.558150634862217
[20 / 20] tensor([[0.894, 0.879],
        [0.883, 0.909]]) {'epoch': 20, 'valid/acc': 89.747, 'valid/acc_unbiased': 89.972, 'valid/diff': 2.372, 'valid/acc_skew': 91.158, 'valid/acc_align': 88.786, 'test/acc': 89.198, 'test/acc_unbiased': 89.141, 'test/diff': 2.082, 'test/acc_skew': 88.869, 'test/acc_align': 89.412}
[20 / 20] best valid accuracy: 90.421 at epoch 16 
 best_stats: {'best_valid_epoch': 16, 'best_valid_valid/acc': 90.169, 'best_valid_valid/acc_unbiased': 90.421, 'best_valid_valid/diff': 2.178, 'best_valid_valid/acc_skew': 91.51, 'best_valid_valid/acc_align': 89.332, 'best_valid_test/acc': 89.072, 'best_valid_test/acc_unbiased': 89.04, 'best_valid_test/diff': 1.744, 'best_valid_test/acc_skew': 88.817, 'best_valid_test/acc_align': 89.264}
[20 / 20] best test accuracy: 89.145 at epoch 17 
 best_stats: {'best_test_epoch': 17, 'best_test_valid/acc': 90.0, 'best_test_valid/acc_unbiased': 90.244, 'best_test_valid/diff': 2.422, 'best_test_valid/acc_skew': 91.4, 'best_test_valid/acc_align': 89.087, 'best_test_test/acc': 89.156, 'best_test_test/acc_unbiased': 89.145, 'best_test_test/diff': 1.509, 'best_test_test/acc_skew': 89.175, 'best_test_test/acc_align': 89.114}
Total training time: 0:53:47
