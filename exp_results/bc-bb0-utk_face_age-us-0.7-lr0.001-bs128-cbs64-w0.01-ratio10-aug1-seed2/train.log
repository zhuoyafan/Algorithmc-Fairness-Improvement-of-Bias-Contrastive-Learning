Log level set to: INFO
Set seed: 2
=======> Using Fixed Random Seed: 2 <========
save_path: exp_results/bc-bb0-utk_face_age-us-0.7-lr0.001-bs128-cbs64-w0.01-ratio10-aug1-seed2
get_utk_face - split: train, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_age-0.7
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [8237, 443]
Target 1: [2471, 1477]
Binary Target 1
---------------------------
Target 0: [8237, 443]
Target 1: [2471, 1477]
===================================
Normal Label Distribution: 
Target 0: [8237, 443]
Target 1: [2471, 1477]
===================================
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [443, 443]
Target 1: [443, 443]
Binary Target 1
---------------------------
Target 0: [443, 443]
Target 1: [443, 443]
===================================
Normal Label Distribution: 
Target 0: [443, 443]
Target 1: [443, 443]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 1772, target_attr: gender, bias_attr: age bias_rate: 0.7
['[train] target_0-bias_0: 443', '[train] target_0-bias_1: 443', '[train] target_1-bias_0: 443', '[train] target_1-bias_1: 443']
confusion_matrix - 
 original: tensor([[443., 443.],
        [443., 443.]]), 
 normalized: tensor([[0.500, 0.500],
        [0.500, 0.500]]), 
 b|y: tensor([[0.500, 0.500],
        [0.500, 0.500]])
get_utk_face - split: train, aug: 1, given_y: True, ratio: 10
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_age-0.7
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [8237, 443]
Target 1: [2471, 1477]
Binary Target 1
---------------------------
Target 0: [8237, 443]
Target 1: [2471, 1477]
===================================
Normal Label Distribution: 
Target 0: [8237, 443]
Target 1: [2471, 1477]
===================================
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [443, 443]
Target 1: [443, 443]
Binary Target 1
---------------------------
Target 0: [443, 443]
Target 1: [443, 443]
===================================
Normal Label Distribution: 
Target 0: [443, 443]
Target 1: [443, 443]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 1772, target_attr: gender, bias_attr: age bias_rate: 0.7
['[train] target_0-bias_0: 443', '[train] target_0-bias_1: 443', '[train] target_1-bias_0: 443', '[train] target_1-bias_1: 443']
get_utk_face - split: valid, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_age-0.7
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [1030, 195]
Target 1: [841, 202]
Binary Target 1
---------------------------
Target 0: [1030, 195]
Target 1: [841, 202]
===================================
Normal Label Distribution: 
Target 0: [1030, 195]
Target 1: [841, 202]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 2268, target_attr: gender, bias_attr: age bias_rate: 0.7
['[valid] target_0-bias_0: 1030', '[valid] target_0-bias_1: 195', '[valid] target_1-bias_0: 841', '[valid] target_1-bias_1: 202']
get_utk_face - split: test, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_age-0.7
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [1061, 176]
Target 1: [867, 165]
Binary Target 1
---------------------------
Target 0: [1061, 176]
Target 1: [867, 165]
===================================
Normal Label Distribution: 
Target 0: [1061, 176]
Target 1: [867, 165]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 2269, target_attr: gender, bias_attr: age bias_rate: 0.7
['[test] target_0-bias_0: 1061', '[test] target_0-bias_1: 176', '[test] target_1-bias_0: 867', '[test] target_1-bias_1: 165']
decay_epochs: [6, 13]
[1 / 20] Learning rate: 0.001 weight: 0.01
[1 / 20] Loss: 5.212571517608505 CE Loss: 0.7117923924669993 Con Loss: 5.205453579904802
[1 / 20] tensor([[0.600, 0.545],
        [0.547, 0.461]]) {'epoch': 1, 'valid/acc': 57.54, 'valid/acc_unbiased': 57.954, 'valid/diff': 2.712, 'valid/acc_skew': 56.965, 'valid/acc_align': 58.943, 'test/acc': 56.545, 'test/acc_unbiased': 53.829, 'test/diff': 7.051, 'test/acc_skew': 57.354, 'test/acc_align': 50.303}
[1 / 20] best valid accuracy: 57.954 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 57.54, 'best_valid_valid/acc_unbiased': 57.954, 'best_valid_valid/diff': 2.712, 'best_valid_valid/acc_skew': 56.965, 'best_valid_valid/acc_align': 58.943, 'best_valid_test/acc': 56.545, 'best_valid_test/acc_unbiased': 53.829, 'best_valid_test/diff': 7.051, 'best_valid_test/acc_skew': 57.354, 'best_valid_test/acc_align': 50.303}
[1 / 20] best test accuracy: 53.829 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 57.54, 'best_test_valid/acc_unbiased': 57.954, 'best_test_valid/diff': 2.712, 'best_test_valid/acc_skew': 56.965, 'best_test_valid/acc_align': 58.943, 'best_test_test/acc': 56.545, 'best_test_test/acc_unbiased': 53.829, 'best_test_test/diff': 7.051, 'best_test_test/acc_skew': 57.354, 'best_test_test/acc_align': 50.303}
[2 / 20] Learning rate: 0.001 weight: 0.01
[2 / 20] Loss: 4.96086898183715 CE Loss: 0.6752878373686401 Con Loss: 4.9541161022659885
[2 / 20] tensor([[0.919, 0.892],
        [0.218, 0.152]]) {'epoch': 2, 'valid/acc': 58.951, 'valid/acc_unbiased': 55.267, 'valid/diff': 2.933, 'valid/acc_skew': 56.733, 'valid/acc_align': 53.8, 'test/acc': 59.321, 'test/acc_unbiased': 54.512, 'test/diff': 4.669, 'test/acc_skew': 56.847, 'test/acc_align': 52.178}
[2 / 20] best valid accuracy: 57.954 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 57.54, 'best_valid_valid/acc_unbiased': 57.954, 'best_valid_valid/diff': 2.712, 'best_valid_valid/acc_skew': 56.965, 'best_valid_valid/acc_align': 58.943, 'best_valid_test/acc': 56.545, 'best_valid_test/acc_unbiased': 53.829, 'best_valid_test/diff': 7.051, 'best_valid_test/acc_skew': 57.354, 'best_valid_test/acc_align': 50.303}
[2 / 20] best test accuracy: 54.512 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 58.951, 'best_test_valid/acc_unbiased': 55.267, 'best_test_valid/diff': 2.933, 'best_test_valid/acc_skew': 56.733, 'best_test_valid/acc_align': 53.8, 'best_test_test/acc': 59.321, 'best_test_test/acc_unbiased': 54.512, 'best_test_test/diff': 4.669, 'best_test_test/acc_skew': 56.847, 'best_test_test/acc_align': 52.178}
[3 / 20] Learning rate: 0.001 weight: 0.01
[3 / 20] Loss: 4.85709330621207 CE Loss: 0.6670372849393376 Con Loss: 4.850422962524552
[3 / 20] tensor([[0.959, 0.932],
        [0.254, 0.152]]) {'epoch': 3, 'valid/acc': 62.39, 'valid/acc_unbiased': 57.446, 'valid/diff': 6.725, 'valid/acc_skew': 60.809, 'valid/acc_align': 54.084, 'test/acc': 62.891, 'test/acc_unbiased': 57.414, 'test/diff': 6.494, 'test/acc_skew': 60.661, 'test/acc_align': 54.167}
[3 / 20] best valid accuracy: 57.954 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 57.54, 'best_valid_valid/acc_unbiased': 57.954, 'best_valid_valid/diff': 2.712, 'best_valid_valid/acc_skew': 56.965, 'best_valid_valid/acc_align': 58.943, 'best_valid_test/acc': 56.545, 'best_valid_test/acc_unbiased': 53.829, 'best_valid_test/diff': 7.051, 'best_valid_test/acc_skew': 57.354, 'best_valid_test/acc_align': 50.303}
[3 / 20] best test accuracy: 57.414 at epoch 3 
 best_stats: {'best_test_epoch': 3, 'best_test_valid/acc': 62.39, 'best_test_valid/acc_unbiased': 57.446, 'best_test_valid/diff': 6.725, 'best_test_valid/acc_skew': 60.809, 'best_test_valid/acc_align': 54.084, 'best_test_test/acc': 62.891, 'best_test_test/acc_unbiased': 57.414, 'best_test_test/diff': 6.494, 'best_test_test/acc_skew': 60.661, 'best_test_test/acc_align': 54.167}
[4 / 20] Learning rate: 0.001 weight: 0.01
[4 / 20] Loss: 4.848834341320442 CE Loss: 0.6382641528583811 Con Loss: 4.842451747868454
[4 / 20] tensor([[0.527, 0.511],
        [0.874, 0.721]]) {'epoch': 4, 'valid/acc': 65.961, 'valid/acc_unbiased': 64.854, 'valid/diff': 7.848, 'valid/acc_skew': 68.778, 'valid/acc_align': 60.93, 'test/acc': 67.254, 'test/acc_unbiased': 65.843, 'test/diff': 8.428, 'test/acc_skew': 70.057, 'test/acc_align': 61.629}
[4 / 20] best valid accuracy: 64.854 at epoch 4 
 best_stats: {'best_valid_epoch': 4, 'best_valid_valid/acc': 65.961, 'best_valid_valid/acc_unbiased': 64.854, 'best_valid_valid/diff': 7.848, 'best_valid_valid/acc_skew': 68.778, 'best_valid_valid/acc_align': 60.93, 'best_valid_test/acc': 67.254, 'best_valid_test/acc_unbiased': 65.843, 'best_valid_test/diff': 8.428, 'best_valid_test/acc_skew': 70.057, 'best_valid_test/acc_align': 61.629}
[4 / 20] best test accuracy: 65.843 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 65.961, 'best_test_valid/acc_unbiased': 64.854, 'best_test_valid/diff': 7.848, 'best_test_valid/acc_skew': 68.778, 'best_test_valid/acc_align': 60.93, 'best_test_test/acc': 67.254, 'best_test_test/acc_unbiased': 65.843, 'best_test_test/diff': 8.428, 'best_test_test/acc_skew': 70.057, 'best_test_test/acc_align': 61.629}
[5 / 20] Learning rate: 0.001 weight: 0.01
[5 / 20] Loss: 4.840662553670982 CE Loss: 0.6167543451081011 Con Loss: 4.83449494811805
[5 / 20] tensor([[0.808, 0.733],
        [0.672, 0.552]]) {'epoch': 5, 'valid/acc': 72.972, 'valid/acc_unbiased': 69.184, 'valid/diff': 9.642, 'valid/acc_skew': 74.005, 'valid/acc_align': 64.363, 'test/acc': 73.16, 'test/acc_unbiased': 69.116, 'test/diff': 9.785, 'test/acc_skew': 74.008, 'test/acc_align': 64.223}
[5 / 20] best valid accuracy: 69.184 at epoch 5 
 best_stats: {'best_valid_epoch': 5, 'best_valid_valid/acc': 72.972, 'best_valid_valid/acc_unbiased': 69.184, 'best_valid_valid/diff': 9.642, 'best_valid_valid/acc_skew': 74.005, 'best_valid_valid/acc_align': 64.363, 'best_valid_test/acc': 73.16, 'best_valid_test/acc_unbiased': 69.116, 'best_valid_test/diff': 9.785, 'best_valid_test/acc_skew': 74.008, 'best_valid_test/acc_align': 64.223}
[5 / 20] best test accuracy: 69.116 at epoch 5 
 best_stats: {'best_test_epoch': 5, 'best_test_valid/acc': 72.972, 'best_test_valid/acc_unbiased': 69.184, 'best_test_valid/diff': 9.642, 'best_test_valid/acc_skew': 74.005, 'best_test_valid/acc_align': 64.363, 'best_test_test/acc': 73.16, 'best_test_test/acc_unbiased': 69.116, 'best_test_test/diff': 9.785, 'best_test_test/acc_skew': 74.008, 'best_test_test/acc_align': 64.223}
[6 / 20] Learning rate: 0.001 weight: 0.01
[6 / 20] Loss: 4.83516096153862 CE Loss: 0.5937912034934584 Con Loss: 4.829223025733138
[6 / 20] tensor([[0.792, 0.727],
        [0.745, 0.521]]) {'epoch': 6, 'valid/acc': 74.691, 'valid/acc_unbiased': 69.341, 'valid/diff': 15.915, 'valid/acc_skew': 77.299, 'valid/acc_align': 61.384, 'test/acc': 74.923, 'test/acc_unbiased': 69.632, 'test/diff': 14.416, 'test/acc_skew': 76.84, 'test/acc_align': 62.424}
[6 / 20] best valid accuracy: 69.341 at epoch 6 
 best_stats: {'best_valid_epoch': 6, 'best_valid_valid/acc': 74.691, 'best_valid_valid/acc_unbiased': 69.341, 'best_valid_valid/diff': 15.915, 'best_valid_valid/acc_skew': 77.299, 'best_valid_valid/acc_align': 61.384, 'best_valid_test/acc': 74.923, 'best_valid_test/acc_unbiased': 69.632, 'best_valid_test/diff': 14.416, 'best_valid_test/acc_skew': 76.84, 'best_valid_test/acc_align': 62.424}
[6 / 20] best test accuracy: 69.632 at epoch 6 
 best_stats: {'best_test_epoch': 6, 'best_test_valid/acc': 74.691, 'best_test_valid/acc_unbiased': 69.341, 'best_test_valid/diff': 15.915, 'best_test_valid/acc_skew': 77.299, 'best_test_valid/acc_align': 61.384, 'best_test_test/acc': 74.923, 'best_test_test/acc_unbiased': 69.632, 'best_test_test/diff': 14.416, 'best_test_test/acc_skew': 76.84, 'best_test_test/acc_align': 62.424}
[7 / 20] Learning rate: 0.0001 weight: 0.01
[7 / 20] Loss: 4.825107069639804 CE Loss: 0.5888322470688658 Con Loss: 4.819218723822393
[7 / 20] tensor([[0.794, 0.665],
        [0.752, 0.673]]) {'epoch': 7, 'valid/acc': 75.97, 'valid/acc_unbiased': 70.0, 'valid/diff': 17.676, 'valid/acc_skew': 78.838, 'valid/acc_align': 61.161, 'test/acc': 75.892, 'test/acc_unbiased': 72.078, 'test/diff': 10.405, 'test/acc_skew': 77.28, 'test/acc_align': 66.875}
[7 / 20] best valid accuracy: 70.000 at epoch 7 
 best_stats: {'best_valid_epoch': 7, 'best_valid_valid/acc': 75.97, 'best_valid_valid/acc_unbiased': 70.0, 'best_valid_valid/diff': 17.676, 'best_valid_valid/acc_skew': 78.838, 'best_valid_valid/acc_align': 61.161, 'best_valid_test/acc': 75.892, 'best_valid_test/acc_unbiased': 72.078, 'best_valid_test/diff': 10.405, 'best_valid_test/acc_skew': 77.28, 'best_valid_test/acc_align': 66.875}
[7 / 20] best test accuracy: 72.078 at epoch 7 
 best_stats: {'best_test_epoch': 7, 'best_test_valid/acc': 75.97, 'best_test_valid/acc_unbiased': 70.0, 'best_test_valid/diff': 17.676, 'best_test_valid/acc_skew': 78.838, 'best_test_valid/acc_align': 61.161, 'best_test_test/acc': 75.892, 'best_test_test/acc_unbiased': 72.078, 'best_test_test/diff': 10.405, 'best_test_test/acc_skew': 77.28, 'best_test_test/acc_align': 66.875}
[8 / 20] Learning rate: 0.0001 weight: 0.01
[8 / 20] Loss: 4.828665953995681 CE Loss: 0.5835651184850568 Con Loss: 4.822830355194299
[8 / 20] tensor([[0.821, 0.705],
        [0.738, 0.655]]) {'epoch': 8, 'valid/acc': 76.499, 'valid/acc_unbiased': 71.344, 'valid/diff': 14.67, 'valid/acc_skew': 78.679, 'valid/acc_align': 64.009, 'test/acc': 76.818, 'test/acc_unbiased': 72.955, 'test/diff': 10.001, 'test/acc_skew': 77.955, 'test/acc_align': 67.955}
[8 / 20] best valid accuracy: 71.344 at epoch 8 
 best_stats: {'best_valid_epoch': 8, 'best_valid_valid/acc': 76.499, 'best_valid_valid/acc_unbiased': 71.344, 'best_valid_valid/diff': 14.67, 'best_valid_valid/acc_skew': 78.679, 'best_valid_valid/acc_align': 64.009, 'best_valid_test/acc': 76.818, 'best_valid_test/acc_unbiased': 72.955, 'best_valid_test/diff': 10.001, 'best_valid_test/acc_skew': 77.955, 'best_valid_test/acc_align': 67.955}
[8 / 20] best test accuracy: 72.955 at epoch 8 
 best_stats: {'best_test_epoch': 8, 'best_test_valid/acc': 76.499, 'best_test_valid/acc_unbiased': 71.344, 'best_test_valid/diff': 14.67, 'best_test_valid/acc_skew': 78.679, 'best_test_valid/acc_align': 64.009, 'best_test_test/acc': 76.818, 'best_test_test/acc_unbiased': 72.955, 'best_test_test/diff': 10.001, 'best_test_test/acc_skew': 77.955, 'best_test_test/acc_align': 67.955}
[9 / 20] Learning rate: 0.0001 weight: 0.01
[9 / 20] Loss: 4.810247902407334 CE Loss: 0.5514704295797757 Con Loss: 4.804733134284784
[9 / 20] tensor([[0.832, 0.722],
        [0.744, 0.618]]) {'epoch': 9, 'valid/acc': 77.028, 'valid/acc_unbiased': 72.429, 'valid/diff': 12.649, 'valid/acc_skew': 78.753, 'valid/acc_align': 66.104, 'test/acc': 77.435, 'test/acc_unbiased': 72.899, 'test/diff': 11.82, 'test/acc_skew': 78.809, 'test/acc_align': 66.989}
[9 / 20] best valid accuracy: 72.429 at epoch 9 
 best_stats: {'best_valid_epoch': 9, 'best_valid_valid/acc': 77.028, 'best_valid_valid/acc_unbiased': 72.429, 'best_valid_valid/diff': 12.649, 'best_valid_valid/acc_skew': 78.753, 'best_valid_valid/acc_align': 66.104, 'best_valid_test/acc': 77.435, 'best_valid_test/acc_unbiased': 72.899, 'best_valid_test/diff': 11.82, 'best_valid_test/acc_skew': 78.809, 'best_valid_test/acc_align': 66.989}
[9 / 20] best test accuracy: 72.955 at epoch 8 
 best_stats: {'best_test_epoch': 8, 'best_test_valid/acc': 76.499, 'best_test_valid/acc_unbiased': 71.344, 'best_test_valid/diff': 14.67, 'best_test_valid/acc_skew': 78.679, 'best_test_valid/acc_align': 64.009, 'best_test_test/acc': 76.818, 'best_test_test/acc_unbiased': 72.955, 'best_test_test/diff': 10.001, 'best_test_test/acc_skew': 77.955, 'best_test_test/acc_align': 67.955}
[10 / 20] Learning rate: 0.0001 weight: 0.01
[10 / 20] Loss: 4.809349555194244 CE Loss: 0.5472022163141392 Con Loss: 4.8038775937013645
[10 / 20] tensor([[0.824, 0.773],
        [0.751, 0.570]]) {'epoch': 10, 'valid/acc': 76.764, 'valid/acc_unbiased': 72.742, 'valid/diff': 11.117, 'valid/acc_skew': 78.3, 'valid/acc_align': 67.183, 'test/acc': 77.347, 'test/acc_unbiased': 72.926, 'test/diff': 11.61, 'test/acc_skew': 78.731, 'test/acc_align': 67.121}
[10 / 20] best valid accuracy: 72.742 at epoch 10 
 best_stats: {'best_valid_epoch': 10, 'best_valid_valid/acc': 76.764, 'best_valid_valid/acc_unbiased': 72.742, 'best_valid_valid/diff': 11.117, 'best_valid_valid/acc_skew': 78.3, 'best_valid_valid/acc_align': 67.183, 'best_valid_test/acc': 77.347, 'best_valid_test/acc_unbiased': 72.926, 'best_valid_test/diff': 11.61, 'best_valid_test/acc_skew': 78.731, 'best_valid_test/acc_align': 67.121}
[10 / 20] best test accuracy: 72.955 at epoch 8 
 best_stats: {'best_test_epoch': 8, 'best_test_valid/acc': 76.499, 'best_test_valid/acc_unbiased': 71.344, 'best_test_valid/diff': 14.67, 'best_test_valid/acc_skew': 78.679, 'best_test_valid/acc_align': 64.009, 'best_test_test/acc': 76.818, 'best_test_test/acc_unbiased': 72.955, 'best_test_test/diff': 10.001, 'best_test_test/acc_skew': 77.955, 'best_test_test/acc_align': 67.955}
[11 / 20] Learning rate: 0.0001 weight: 0.01
[11 / 20] Loss: 4.81660498022764 CE Loss: 0.5638114797880633 Con Loss: 4.810966889960502
[11 / 20] tensor([[0.876, 0.756],
        [0.693, 0.576]]) {'epoch': 11, 'valid/acc': 76.367, 'valid/acc_unbiased': 71.318, 'valid/diff': 12.939, 'valid/acc_skew': 77.788, 'valid/acc_align': 64.849, 'test/acc': 77.479, 'test/acc_unbiased': 72.506, 'test/diff': 11.867, 'test/acc_skew': 78.439, 'test/acc_align': 66.572}
[11 / 20] best valid accuracy: 72.742 at epoch 10 
 best_stats: {'best_valid_epoch': 10, 'best_valid_valid/acc': 76.764, 'best_valid_valid/acc_unbiased': 72.742, 'best_valid_valid/diff': 11.117, 'best_valid_valid/acc_skew': 78.3, 'best_valid_valid/acc_align': 67.183, 'best_valid_test/acc': 77.347, 'best_valid_test/acc_unbiased': 72.926, 'best_valid_test/diff': 11.61, 'best_valid_test/acc_skew': 78.731, 'best_valid_test/acc_align': 67.121}
[11 / 20] best test accuracy: 72.955 at epoch 8 
 best_stats: {'best_test_epoch': 8, 'best_test_valid/acc': 76.499, 'best_test_valid/acc_unbiased': 71.344, 'best_test_valid/diff': 14.67, 'best_test_valid/acc_skew': 78.679, 'best_test_valid/acc_align': 64.009, 'best_test_test/acc': 76.818, 'best_test_test/acc_unbiased': 72.955, 'best_test_test/diff': 10.001, 'best_test_test/acc_skew': 77.955, 'best_test_test/acc_align': 67.955}
[12 / 20] Learning rate: 0.0001 weight: 0.01
[12 / 20] Loss: 4.797475343364087 CE Loss: 0.5448579313254518 Con Loss: 4.792026744739196
[12 / 20] tensor([[0.769, 0.688],
        [0.803, 0.636]]) {'epoch': 12, 'valid/acc': 76.19, 'valid/acc_unbiased': 71.894, 'valid/diff': 13.366, 'valid/acc_skew': 78.576, 'valid/acc_align': 65.211, 'test/acc': 76.598, 'test/acc_unbiased': 72.393, 'test/diff': 12.4, 'test/acc_skew': 78.593, 'test/acc_align': 66.193}
[12 / 20] best valid accuracy: 72.742 at epoch 10 
 best_stats: {'best_valid_epoch': 10, 'best_valid_valid/acc': 76.764, 'best_valid_valid/acc_unbiased': 72.742, 'best_valid_valid/diff': 11.117, 'best_valid_valid/acc_skew': 78.3, 'best_valid_valid/acc_align': 67.183, 'best_valid_test/acc': 77.347, 'best_valid_test/acc_unbiased': 72.926, 'best_valid_test/diff': 11.61, 'best_valid_test/acc_skew': 78.731, 'best_valid_test/acc_align': 67.121}
[12 / 20] best test accuracy: 72.955 at epoch 8 
 best_stats: {'best_test_epoch': 8, 'best_test_valid/acc': 76.499, 'best_test_valid/acc_unbiased': 71.344, 'best_test_valid/diff': 14.67, 'best_test_valid/acc_skew': 78.679, 'best_test_valid/acc_align': 64.009, 'best_test_test/acc': 76.818, 'best_test_test/acc_unbiased': 72.955, 'best_test_test/diff': 10.001, 'best_test_test/acc_skew': 77.955, 'best_test_test/acc_align': 67.955}
[13 / 20] Learning rate: 0.0001 weight: 0.01
[13 / 20] Loss: 4.796587070008702 CE Loss: 0.5491414609665796 Con Loss: 4.791095684129013
[13 / 20] tensor([[0.825, 0.699],
        [0.767, 0.679]]) {'epoch': 13, 'valid/acc': 77.293, 'valid/acc_unbiased': 72.356, 'valid/diff': 14.344, 'valid/acc_skew': 79.528, 'valid/acc_align': 65.184, 'test/acc': 78.228, 'test/acc_unbiased': 74.234, 'test/diff': 10.703, 'test/acc_skew': 79.585, 'test/acc_align': 68.883}
[13 / 20] best valid accuracy: 72.742 at epoch 10 
 best_stats: {'best_valid_epoch': 10, 'best_valid_valid/acc': 76.764, 'best_valid_valid/acc_unbiased': 72.742, 'best_valid_valid/diff': 11.117, 'best_valid_valid/acc_skew': 78.3, 'best_valid_valid/acc_align': 67.183, 'best_valid_test/acc': 77.347, 'best_valid_test/acc_unbiased': 72.926, 'best_valid_test/diff': 11.61, 'best_valid_test/acc_skew': 78.731, 'best_valid_test/acc_align': 67.121}
[13 / 20] best test accuracy: 74.234 at epoch 13 
 best_stats: {'best_test_epoch': 13, 'best_test_valid/acc': 77.293, 'best_test_valid/acc_unbiased': 72.356, 'best_test_valid/diff': 14.344, 'best_test_valid/acc_skew': 79.528, 'best_test_valid/acc_align': 65.184, 'best_test_test/acc': 78.228, 'best_test_test/acc_unbiased': 74.234, 'best_test_test/diff': 10.703, 'best_test_test/acc_skew': 79.585, 'best_test_test/acc_align': 68.883}
[14 / 20] Learning rate: 1e-05 weight: 0.01
[14 / 20] Loss: 4.790531524417093 CE Loss: 0.5362438289091227 Con Loss: 4.785169056791215
[14 / 20] tensor([[0.822, 0.693],
        [0.767, 0.691]]) {'epoch': 14, 'valid/acc': 77.425, 'valid/acc_unbiased': 72.847, 'valid/diff': 13.309, 'valid/acc_skew': 79.501, 'valid/acc_align': 66.192, 'test/acc': 78.14, 'test/acc_unbiased': 74.324, 'test/diff': 10.239, 'test/acc_skew': 79.444, 'test/acc_align': 69.205}
[14 / 20] best valid accuracy: 72.847 at epoch 14 
 best_stats: {'best_valid_epoch': 14, 'best_valid_valid/acc': 77.425, 'best_valid_valid/acc_unbiased': 72.847, 'best_valid_valid/diff': 13.309, 'best_valid_valid/acc_skew': 79.501, 'best_valid_valid/acc_align': 66.192, 'best_valid_test/acc': 78.14, 'best_valid_test/acc_unbiased': 74.324, 'best_valid_test/diff': 10.239, 'best_valid_test/acc_skew': 79.444, 'best_valid_test/acc_align': 69.205}
[14 / 20] best test accuracy: 74.324 at epoch 14 
 best_stats: {'best_test_epoch': 14, 'best_test_valid/acc': 77.425, 'best_test_valid/acc_unbiased': 72.847, 'best_test_valid/diff': 13.309, 'best_test_valid/acc_skew': 79.501, 'best_test_valid/acc_align': 66.192, 'best_test_test/acc': 78.14, 'best_test_test/acc_unbiased': 74.324, 'best_test_test/diff': 10.239, 'best_test_test/acc_skew': 79.444, 'best_test_test/acc_align': 69.205}
[15 / 20] Learning rate: 1e-05 weight: 0.01
[15 / 20] Loss: 4.799070414248224 CE Loss: 0.5402156259889797 Con Loss: 4.7936682141392275
[15 / 20] tensor([[0.816, 0.699],
        [0.774, 0.691]]) {'epoch': 15, 'valid/acc': 77.293, 'valid/acc_unbiased': 72.702, 'valid/diff': 13.514, 'valid/acc_skew': 79.459, 'valid/acc_align': 65.944, 'test/acc': 78.184, 'test/acc_unbiased': 74.498, 'test/diff': 10.019, 'test/acc_skew': 79.507, 'test/acc_align': 69.489}
[15 / 20] best valid accuracy: 72.847 at epoch 14 
 best_stats: {'best_valid_epoch': 14, 'best_valid_valid/acc': 77.425, 'best_valid_valid/acc_unbiased': 72.847, 'best_valid_valid/diff': 13.309, 'best_valid_valid/acc_skew': 79.501, 'best_valid_valid/acc_align': 66.192, 'best_valid_test/acc': 78.14, 'best_valid_test/acc_unbiased': 74.324, 'best_valid_test/diff': 10.239, 'best_valid_test/acc_skew': 79.444, 'best_valid_test/acc_align': 69.205}
[15 / 20] best test accuracy: 74.498 at epoch 15 
 best_stats: {'best_test_epoch': 15, 'best_test_valid/acc': 77.293, 'best_test_valid/acc_unbiased': 72.702, 'best_test_valid/diff': 13.514, 'best_test_valid/acc_skew': 79.459, 'best_test_valid/acc_align': 65.944, 'best_test_test/acc': 78.184, 'best_test_test/acc_unbiased': 74.498, 'best_test_test/diff': 10.019, 'best_test_test/acc_skew': 79.507, 'best_test_test/acc_align': 69.489}
[16 / 20] Learning rate: 1e-05 weight: 0.01
[16 / 20] Loss: 4.7934206796822645 CE Loss: 0.536426525756414 Con Loss: 4.7880564683177935
[16 / 20] tensor([[0.814, 0.705],
        [0.776, 0.685]]) {'epoch': 16, 'valid/acc': 77.601, 'valid/acc_unbiased': 73.198, 'valid/diff': 12.932, 'valid/acc_skew': 79.664, 'valid/acc_align': 66.731, 'test/acc': 78.184, 'test/acc_unbiased': 74.499, 'test/diff': 10.059, 'test/acc_skew': 79.528, 'test/acc_align': 69.47}
[16 / 20] best valid accuracy: 73.198 at epoch 16 
 best_stats: {'best_valid_epoch': 16, 'best_valid_valid/acc': 77.601, 'best_valid_valid/acc_unbiased': 73.198, 'best_valid_valid/diff': 12.932, 'best_valid_valid/acc_skew': 79.664, 'best_valid_valid/acc_align': 66.731, 'best_valid_test/acc': 78.184, 'best_valid_test/acc_unbiased': 74.499, 'best_valid_test/diff': 10.059, 'best_valid_test/acc_skew': 79.528, 'best_valid_test/acc_align': 69.47}
[16 / 20] best test accuracy: 74.499 at epoch 16 
 best_stats: {'best_test_epoch': 16, 'best_test_valid/acc': 77.601, 'best_test_valid/acc_unbiased': 73.198, 'best_test_valid/diff': 12.932, 'best_test_valid/acc_skew': 79.664, 'best_test_valid/acc_align': 66.731, 'best_test_test/acc': 78.184, 'best_test_test/acc_unbiased': 74.499, 'best_test_test/diff': 10.059, 'best_test_test/acc_skew': 79.528, 'best_test_test/acc_align': 69.47}
[17 / 20] Learning rate: 1e-05 weight: 0.01
[17 / 20] Loss: 4.807242750852425 CE Loss: 0.5355050811380081 Con Loss: 4.8018876801226
[17 / 20] tensor([[0.817, 0.710],
        [0.776, 0.648]]) {'epoch': 17, 'valid/acc': 77.734, 'valid/acc_unbiased': 73.282, 'valid/diff': 13.012, 'valid/acc_skew': 79.788, 'valid/acc_align': 66.776, 'test/acc': 78.096, 'test/acc_unbiased': 73.803, 'test/diff': 11.734, 'test/acc_skew': 79.67, 'test/acc_align': 67.936}
[17 / 20] best valid accuracy: 73.282 at epoch 17 
 best_stats: {'best_valid_epoch': 17, 'best_valid_valid/acc': 77.734, 'best_valid_valid/acc_unbiased': 73.282, 'best_valid_valid/diff': 13.012, 'best_valid_valid/acc_skew': 79.788, 'best_valid_valid/acc_align': 66.776, 'best_valid_test/acc': 78.096, 'best_valid_test/acc_unbiased': 73.803, 'best_valid_test/diff': 11.734, 'best_valid_test/acc_skew': 79.67, 'best_valid_test/acc_align': 67.936}
[17 / 20] best test accuracy: 74.499 at epoch 16 
 best_stats: {'best_test_epoch': 16, 'best_test_valid/acc': 77.601, 'best_test_valid/acc_unbiased': 73.198, 'best_test_valid/diff': 12.932, 'best_test_valid/acc_skew': 79.664, 'best_test_valid/acc_align': 66.731, 'best_test_test/acc': 78.184, 'best_test_test/acc_unbiased': 74.499, 'best_test_test/diff': 10.059, 'best_test_test/acc_skew': 79.528, 'best_test_test/acc_align': 69.47}
[18 / 20] Learning rate: 1e-05 weight: 0.01
[18 / 20] Loss: 4.781627169581084 CE Loss: 0.5234182859112931 Con Loss: 4.7763930185115635
[18 / 20] tensor([[0.812, 0.705],
        [0.781, 0.661]]) {'epoch': 18, 'valid/acc': 77.822, 'valid/acc_unbiased': 73.458, 'valid/diff': 12.887, 'valid/acc_skew': 79.902, 'valid/acc_align': 67.014, 'test/acc': 78.096, 'test/acc_unbiased': 73.961, 'test/diff': 11.407, 'test/acc_skew': 79.665, 'test/acc_align': 68.258}
[18 / 20] best valid accuracy: 73.458 at epoch 18 
 best_stats: {'best_valid_epoch': 18, 'best_valid_valid/acc': 77.822, 'best_valid_valid/acc_unbiased': 73.458, 'best_valid_valid/diff': 12.887, 'best_valid_valid/acc_skew': 79.902, 'best_valid_valid/acc_align': 67.014, 'best_valid_test/acc': 78.096, 'best_valid_test/acc_unbiased': 73.961, 'best_valid_test/diff': 11.407, 'best_valid_test/acc_skew': 79.665, 'best_valid_test/acc_align': 68.258}
[18 / 20] best test accuracy: 74.499 at epoch 16 
 best_stats: {'best_test_epoch': 16, 'best_test_valid/acc': 77.601, 'best_test_valid/acc_unbiased': 73.198, 'best_test_valid/diff': 12.932, 'best_test_valid/acc_skew': 79.664, 'best_test_valid/acc_align': 66.731, 'best_test_test/acc': 78.184, 'best_test_test/acc_unbiased': 74.499, 'best_test_test/diff': 10.059, 'best_test_test/acc_skew': 79.528, 'best_test_test/acc_align': 69.47}
[19 / 20] Learning rate: 1e-05 weight: 0.01
[19 / 20] Loss: 4.802778637974311 CE Loss: 0.5241555607883979 Con Loss: 4.797537168584612
[19 / 20] tensor([[0.820, 0.722],
        [0.774, 0.642]]) {'epoch': 19, 'valid/acc': 77.822, 'valid/acc_unbiased': 73.34, 'valid/diff': 13.111, 'valid/acc_skew': 79.896, 'valid/acc_align': 66.785, 'test/acc': 78.184, 'test/acc_unbiased': 73.948, 'test/diff': 11.495, 'test/acc_skew': 79.696, 'test/acc_align': 68.201}
[19 / 20] best valid accuracy: 73.458 at epoch 18 
 best_stats: {'best_valid_epoch': 18, 'best_valid_valid/acc': 77.822, 'best_valid_valid/acc_unbiased': 73.458, 'best_valid_valid/diff': 12.887, 'best_valid_valid/acc_skew': 79.902, 'best_valid_valid/acc_align': 67.014, 'best_valid_test/acc': 78.096, 'best_valid_test/acc_unbiased': 73.961, 'best_valid_test/diff': 11.407, 'best_valid_test/acc_skew': 79.665, 'best_valid_test/acc_align': 68.258}
[19 / 20] best test accuracy: 74.499 at epoch 16 
 best_stats: {'best_test_epoch': 16, 'best_test_valid/acc': 77.601, 'best_test_valid/acc_unbiased': 73.198, 'best_test_valid/diff': 12.932, 'best_test_valid/acc_skew': 79.664, 'best_test_valid/acc_align': 66.731, 'best_test_test/acc': 78.184, 'best_test_test/acc_unbiased': 74.499, 'best_test_test/diff': 10.059, 'best_test_test/acc_skew': 79.528, 'best_test_test/acc_align': 69.47}
[20 / 20] Learning rate: 1e-05 weight: 0.01
[20 / 20] Loss: 4.780338845995694 CE Loss: 0.5435975628566526 Con Loss: 4.774902860413286
[20 / 20] tensor([[0.819, 0.722],
        [0.777, 0.642]]) {'epoch': 20, 'valid/acc': 77.646, 'valid/acc_unbiased': 73.029, 'valid/diff': 13.496, 'valid/acc_skew': 79.777, 'valid/acc_align': 66.281, 'test/acc': 78.272, 'test/acc_unbiased': 74.011, 'test/diff': 11.621, 'test/acc_skew': 79.822, 'test/acc_align': 68.201}
[20 / 20] best valid accuracy: 73.458 at epoch 18 
 best_stats: {'best_valid_epoch': 18, 'best_valid_valid/acc': 77.822, 'best_valid_valid/acc_unbiased': 73.458, 'best_valid_valid/diff': 12.887, 'best_valid_valid/acc_skew': 79.902, 'best_valid_valid/acc_align': 67.014, 'best_valid_test/acc': 78.096, 'best_valid_test/acc_unbiased': 73.961, 'best_valid_test/diff': 11.407, 'best_valid_test/acc_skew': 79.665, 'best_valid_test/acc_align': 68.258}
[20 / 20] best test accuracy: 74.499 at epoch 16 
 best_stats: {'best_test_epoch': 16, 'best_test_valid/acc': 77.601, 'best_test_valid/acc_unbiased': 73.198, 'best_test_valid/diff': 12.932, 'best_test_valid/acc_skew': 79.664, 'best_test_valid/acc_align': 66.731, 'best_test_test/acc': 78.184, 'best_test_test/acc_unbiased': 74.499, 'best_test_test/diff': 10.059, 'best_test_test/acc_skew': 79.528, 'best_test_test/acc_align': 69.47}
Total training time: 0:09:32
