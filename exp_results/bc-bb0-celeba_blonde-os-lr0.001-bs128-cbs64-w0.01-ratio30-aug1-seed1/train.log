Log level set to: INFO
Set seed: 1
=======> Using Fixed Random Seed: 1 <========
save_path: exp_results/bc-bb0-celeba_blonde-os-lr0.001-bs128-cbs64-w0.01-ratio30-aug1-seed1
get_celeba - split:train, aug: False, given_y: True, ratio: 0
use existing blonde indices from data/celeba/pickles/blonde
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [53577, 53577]
Target 1: [53577, 53577]
Binary Target 1
---------------------------
Target 0: [53577, 53577]
Target 1: [53577, 53577]
===================================
Normal Label Distribution: 
Target 0: [53577, 53577]
Target 1: [53577, 53577]
===================================
Use BiasedCelebASplit 
 target_attr: blonde split: train 
 tensor([[53577., 53577.],
        [53577., 53577.]])
get_celeba - split:train, aug: 1, given_y: True, ratio: 30
use existing blonde indices from data/celeba/pickles/blonde
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [53425, 53425]
Target 1: [53425, 53425]
Binary Target 1
---------------------------
Target 0: [53425, 53425]
Target 1: [53425, 53425]
===================================
Normal Label Distribution: 
Target 0: [53425, 53425]
Target 1: [53425, 53425]
===================================
Use BiasedCelebASplit 
 target_attr: blonde split: train 
 tensor([[53425., 53425.],
        [53425., 53425.]])
get_celeba - split:train_valid, aug: False, given_y: True, ratio: 0
use existing blonde indices from data/celeba/pickles/blonde
Use BiasedCelebASplit 
 target_attr: blonde split: train_valid 
 tensor([[  390.,  4598.],
        [13361.,   280.]])
get_celeba - split:valid, aug: False, given_y: True, ratio: 0
Use BiasedCelebASplit 
 target_attr: blonde split: valid 
 tensor([[8535., 2874.],
        [8276.,  182.]])
decay_epochs: [3, 6]
[1 / 10] Learning rate: 0.001 weight: 0.01
[1 / 10] Loss: 4.611787427470071 CE Loss: 0.2391016294025397 Con Loss: 4.609396408695228
[1 / 10] tensor([[0.868, 0.934],
        [0.933, 0.868]]) {'epoch': 1, 'valid/acc': 92.689, 'valid/acc_unbiased': 91.783, 'valid/diff': 3.928, 'valid/acc_skew': 93.747, 'valid/acc_align': 89.819, 'test/acc': 90.477, 'test/acc_unbiased': 90.068, 'test/diff': 6.551, 'test/acc_skew': 90.028, 'test/acc_align': 90.108}
[1 / 10] best valid accuracy: 91.783 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 92.689, 'best_valid_valid/acc_unbiased': 91.783, 'best_valid_valid/diff': 3.928, 'best_valid_valid/acc_skew': 93.747, 'best_valid_valid/acc_align': 89.819, 'best_valid_test/acc': 90.477, 'best_valid_test/acc_unbiased': 90.068, 'best_valid_test/diff': 6.551, 'best_valid_test/acc_skew': 90.028, 'best_valid_test/acc_align': 90.108}
[1 / 10] best test accuracy: 90.068 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 92.689, 'best_test_valid/acc_unbiased': 91.783, 'best_test_valid/diff': 3.928, 'best_test_valid/acc_skew': 93.747, 'best_test_valid/acc_align': 89.819, 'best_test_test/acc': 90.477, 'best_test_test/acc_unbiased': 90.068, 'best_test_test/diff': 6.551, 'best_test_test/acc_skew': 90.028, 'best_test_test/acc_align': 90.108}
[2 / 10] Learning rate: 0.001 weight: 0.01
[2 / 10] Loss: 4.5589801143184365 CE Loss: 0.20026935721797867 Con Loss: 4.556977413437442
[2 / 10] tensor([[0.862, 0.942],
        [0.957, 0.879]]) {'epoch': 2, 'valid/acc': 94.106, 'valid/acc_unbiased': 94.24, 'valid/diff': 3.154, 'valid/acc_skew': 95.817, 'valid/acc_align': 92.663, 'test/acc': 90.965, 'test/acc_unbiased': 91.031, 'test/diff': 7.906, 'test/acc_skew': 90.983, 'test/acc_align': 91.08}
[2 / 10] best valid accuracy: 94.240 at epoch 2 
 best_stats: {'best_valid_epoch': 2, 'best_valid_valid/acc': 94.106, 'best_valid_valid/acc_unbiased': 94.24, 'best_valid_valid/diff': 3.154, 'best_valid_valid/acc_skew': 95.817, 'best_valid_valid/acc_align': 92.663, 'best_valid_test/acc': 90.965, 'best_valid_test/acc_unbiased': 91.031, 'best_valid_test/diff': 7.906, 'best_valid_test/acc_skew': 90.983, 'best_valid_test/acc_align': 91.08}
[2 / 10] best test accuracy: 91.031 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 94.106, 'best_test_valid/acc_unbiased': 94.24, 'best_test_valid/diff': 3.154, 'best_test_valid/acc_skew': 95.817, 'best_test_valid/acc_align': 92.663, 'best_test_test/acc': 90.965, 'best_test_test/acc_unbiased': 91.031, 'best_test_test/diff': 7.906, 'best_test_test/acc_skew': 90.983, 'best_test_test/acc_align': 91.08}
[3 / 10] Learning rate: 0.001 weight: 0.01
[3 / 10] Loss: 4.527090234790468 CE Loss: 0.18470772432960988 Con Loss: 4.525243150117
[3 / 10] tensor([[0.854, 0.928],
        [0.958, 0.885]]) {'epoch': 3, 'valid/acc': 93.043, 'valid/acc_unbiased': 94.206, 'valid/diff': 2.319, 'valid/acc_skew': 95.365, 'valid/acc_align': 93.046, 'test/acc': 90.029, 'test/acc_unbiased': 90.616, 'test/diff': 7.358, 'test/acc_skew': 90.584, 'test/acc_align': 90.648}
[3 / 10] best valid accuracy: 94.240 at epoch 2 
 best_stats: {'best_valid_epoch': 2, 'best_valid_valid/acc': 94.106, 'best_valid_valid/acc_unbiased': 94.24, 'best_valid_valid/diff': 3.154, 'best_valid_valid/acc_skew': 95.817, 'best_valid_valid/acc_align': 92.663, 'best_valid_test/acc': 90.965, 'best_valid_test/acc_unbiased': 91.031, 'best_valid_test/diff': 7.906, 'best_valid_test/acc_skew': 90.983, 'best_valid_test/acc_align': 91.08}
[3 / 10] best test accuracy: 91.031 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 94.106, 'best_test_valid/acc_unbiased': 94.24, 'best_test_valid/diff': 3.154, 'best_test_valid/acc_skew': 95.817, 'best_test_valid/acc_align': 92.663, 'best_test_test/acc': 90.965, 'best_test_test/acc_unbiased': 91.031, 'best_test_test/diff': 7.906, 'best_test_test/acc_skew': 90.983, 'best_test_test/acc_align': 91.08}
[4 / 10] Learning rate: 0.0001 weight: 0.01
[4 / 10] Loss: 4.444588865485244 CE Loss: 0.14238191190608843 Con Loss: 4.44316505047683
[4 / 10] tensor([[0.848, 0.948],
        [0.964, 0.879]]) {'epoch': 4, 'valid/acc': 94.917, 'valid/acc_unbiased': 96.237, 'valid/diff': 2.159, 'valid/acc_skew': 97.026, 'valid/acc_align': 95.449, 'test/acc': 90.663, 'test/acc_unbiased': 90.975, 'test/diff': 9.282, 'test/acc_skew': 90.587, 'test/acc_align': 91.364}
[4 / 10] best valid accuracy: 96.237 at epoch 4 
 best_stats: {'best_valid_epoch': 4, 'best_valid_valid/acc': 94.917, 'best_valid_valid/acc_unbiased': 96.237, 'best_valid_valid/diff': 2.159, 'best_valid_valid/acc_skew': 97.026, 'best_valid_valid/acc_align': 95.449, 'best_valid_test/acc': 90.663, 'best_valid_test/acc_unbiased': 90.975, 'best_valid_test/diff': 9.282, 'best_valid_test/acc_skew': 90.587, 'best_valid_test/acc_align': 91.364}
[4 / 10] best test accuracy: 91.031 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 94.106, 'best_test_valid/acc_unbiased': 94.24, 'best_test_valid/diff': 3.154, 'best_test_valid/acc_skew': 95.817, 'best_test_valid/acc_align': 92.663, 'best_test_test/acc': 90.965, 'best_test_test/acc_unbiased': 91.031, 'best_test_test/diff': 7.906, 'best_test_test/acc_skew': 90.983, 'best_test_test/acc_align': 91.08}
[5 / 10] Learning rate: 0.0001 weight: 0.01
[5 / 10] Loss: 4.412019368851352 CE Loss: 0.1294771707069968 Con Loss: 4.410724602895134
[5 / 10] tensor([[0.849, 0.951],
        [0.962, 0.874]]) {'epoch': 5, 'valid/acc': 95.271, 'valid/acc_unbiased': 96.578, 'valid/diff': 2.091, 'valid/acc_skew': 97.36, 'valid/acc_align': 95.796, 'test/acc': 90.794, 'test/acc_unbiased': 90.885, 'test/diff': 9.544, 'test/acc_skew': 90.535, 'test/acc_align': 91.234}
[5 / 10] best valid accuracy: 96.578 at epoch 5 
 best_stats: {'best_valid_epoch': 5, 'best_valid_valid/acc': 95.271, 'best_valid_valid/acc_unbiased': 96.578, 'best_valid_valid/diff': 2.091, 'best_valid_valid/acc_skew': 97.36, 'best_valid_valid/acc_align': 95.796, 'best_valid_test/acc': 90.794, 'best_valid_test/acc_unbiased': 90.885, 'best_valid_test/diff': 9.544, 'best_valid_test/acc_skew': 90.535, 'best_valid_test/acc_align': 91.234}
[5 / 10] best test accuracy: 91.031 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 94.106, 'best_test_valid/acc_unbiased': 94.24, 'best_test_valid/diff': 3.154, 'best_test_valid/acc_skew': 95.817, 'best_test_valid/acc_align': 92.663, 'best_test_test/acc': 90.965, 'best_test_test/acc_unbiased': 91.031, 'best_test_test/diff': 7.906, 'best_test_test/acc_skew': 90.983, 'best_test_test/acc_align': 91.08}
[6 / 10] Learning rate: 0.0001 weight: 0.01
[6 / 10] Loss: 4.387985279367982 CE Loss: 0.12031147956516063 Con Loss: 4.386782164233421
[6 / 10] tensor([[0.837, 0.960],
        [0.965, 0.846]]) {'epoch': 6, 'valid/acc': 95.979, 'valid/acc_unbiased': 97.083, 'valid/diff': 1.85, 'valid/acc_skew': 97.962, 'valid/acc_align': 96.204, 'test/acc': 90.688, 'test/acc_unbiased': 90.21, 'test/diff': 12.102, 'test/acc_skew': 90.111, 'test/acc_align': 90.308}
[6 / 10] best valid accuracy: 97.083 at epoch 6 
 best_stats: {'best_valid_epoch': 6, 'best_valid_valid/acc': 95.979, 'best_valid_valid/acc_unbiased': 97.083, 'best_valid_valid/diff': 1.85, 'best_valid_valid/acc_skew': 97.962, 'best_valid_valid/acc_align': 96.204, 'best_valid_test/acc': 90.688, 'best_valid_test/acc_unbiased': 90.21, 'best_valid_test/diff': 12.102, 'best_valid_test/acc_skew': 90.111, 'best_valid_test/acc_align': 90.308}
[6 / 10] best test accuracy: 91.031 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 94.106, 'best_test_valid/acc_unbiased': 94.24, 'best_test_valid/diff': 3.154, 'best_test_valid/acc_skew': 95.817, 'best_test_valid/acc_align': 92.663, 'best_test_test/acc': 90.965, 'best_test_test/acc_unbiased': 91.031, 'best_test_test/diff': 7.906, 'best_test_test/acc_skew': 90.983, 'best_test_test/acc_align': 91.08}
[7 / 10] Learning rate: 1e-05 weight: 0.01
[7 / 10] Loss: 4.374983453785321 CE Loss: 0.11390805677001392 Con Loss: 4.373844369754485
[7 / 10] tensor([[0.815, 0.953],
        [0.974, 0.857]]) {'epoch': 7, 'valid/acc': 95.614, 'valid/acc_unbiased': 97.124, 'valid/diff': 1.97, 'valid/acc_skew': 98.065, 'valid/acc_align': 96.183, 'test/acc': 89.581, 'test/acc_unbiased': 89.973, 'test/diff': 12.756, 'test/acc_skew': 89.433, 'test/acc_align': 90.513}
[7 / 10] best valid accuracy: 97.124 at epoch 7 
 best_stats: {'best_valid_epoch': 7, 'best_valid_valid/acc': 95.614, 'best_valid_valid/acc_unbiased': 97.124, 'best_valid_valid/diff': 1.97, 'best_valid_valid/acc_skew': 98.065, 'best_valid_valid/acc_align': 96.183, 'best_valid_test/acc': 89.581, 'best_valid_test/acc_unbiased': 89.973, 'best_valid_test/diff': 12.756, 'best_valid_test/acc_skew': 89.433, 'best_valid_test/acc_align': 90.513}
[7 / 10] best test accuracy: 91.031 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 94.106, 'best_test_valid/acc_unbiased': 94.24, 'best_test_valid/diff': 3.154, 'best_test_valid/acc_skew': 95.817, 'best_test_valid/acc_align': 92.663, 'best_test_test/acc': 90.965, 'best_test_test/acc_unbiased': 91.031, 'best_test_test/diff': 7.906, 'best_test_test/acc_skew': 90.983, 'best_test_test/acc_align': 91.08}
[8 / 10] Learning rate: 1e-05 weight: 0.01
[8 / 10] Loss: 4.367907103386448 CE Loss: 0.11211377859695772 Con Loss: 4.366785966061949
[8 / 10] tensor([[0.830, 0.958],
        [0.969, 0.841]]) {'epoch': 8, 'valid/acc': 96.038, 'valid/acc_unbiased': 97.296, 'valid/diff': 2.038, 'valid/acc_skew': 98.221, 'valid/acc_align': 96.371, 'test/acc': 90.336, 'test/acc_unbiased': 89.932, 'test/diff': 12.846, 'test/acc_skew': 89.928, 'test/acc_align': 89.937}
[8 / 10] best valid accuracy: 97.296 at epoch 8 
 best_stats: {'best_valid_epoch': 8, 'best_valid_valid/acc': 96.038, 'best_valid_valid/acc_unbiased': 97.296, 'best_valid_valid/diff': 2.038, 'best_valid_valid/acc_skew': 98.221, 'best_valid_valid/acc_align': 96.371, 'best_valid_test/acc': 90.336, 'best_valid_test/acc_unbiased': 89.932, 'best_valid_test/diff': 12.846, 'best_valid_test/acc_skew': 89.928, 'best_valid_test/acc_align': 89.937}
[8 / 10] best test accuracy: 91.031 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 94.106, 'best_test_valid/acc_unbiased': 94.24, 'best_test_valid/diff': 3.154, 'best_test_valid/acc_skew': 95.817, 'best_test_valid/acc_align': 92.663, 'best_test_test/acc': 90.965, 'best_test_test/acc_unbiased': 91.031, 'best_test_test/diff': 7.906, 'best_test_test/acc_skew': 90.983, 'best_test_test/acc_align': 91.08}
[9 / 10] Learning rate: 1e-05 weight: 0.01
[9 / 10] Loss: 4.364881501351874 CE Loss: 0.11087717153787643 Con Loss: 4.363772729157062
[9 / 10] tensor([[0.826, 0.956],
        [0.971, 0.852]]) {'epoch': 9, 'valid/acc': 95.829, 'valid/acc_unbiased': 97.314, 'valid/diff': 2.359, 'valid/acc_skew': 98.232, 'valid/acc_align': 96.396, 'test/acc': 90.119, 'test/acc_unbiased': 90.108, 'test/diff': 12.474, 'test/acc_skew': 89.845, 'test/acc_align': 90.371}
[9 / 10] best valid accuracy: 97.314 at epoch 9 
 best_stats: {'best_valid_epoch': 9, 'best_valid_valid/acc': 95.829, 'best_valid_valid/acc_unbiased': 97.314, 'best_valid_valid/diff': 2.359, 'best_valid_valid/acc_skew': 98.232, 'best_valid_valid/acc_align': 96.396, 'best_valid_test/acc': 90.119, 'best_valid_test/acc_unbiased': 90.108, 'best_valid_test/diff': 12.474, 'best_valid_test/acc_skew': 89.845, 'best_valid_test/acc_align': 90.371}
[9 / 10] best test accuracy: 91.031 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 94.106, 'best_test_valid/acc_unbiased': 94.24, 'best_test_valid/diff': 3.154, 'best_test_valid/acc_skew': 95.817, 'best_test_valid/acc_align': 92.663, 'best_test_test/acc': 90.965, 'best_test_test/acc_unbiased': 91.031, 'best_test_test/diff': 7.906, 'best_test_test/acc_skew': 90.983, 'best_test_test/acc_align': 91.08}
[10 / 10] Learning rate: 1e-05 weight: 0.01
[10 / 10] Loss: 4.360927167597295 CE Loss: 0.10937091065169689 Con Loss: 4.359833465920212
[10 / 10] tensor([[0.809, 0.950],
        [0.973, 0.879]]) {'epoch': 10, 'valid/acc': 95.802, 'valid/acc_unbiased': 97.145, 'valid/diff': 1.692, 'valid/acc_skew': 97.991, 'valid/acc_align': 96.299, 'test/acc': 89.203, 'test/acc_unbiased': 90.266, 'test/diff': 11.753, 'test/acc_skew': 89.059, 'test/acc_align': 91.473}
[10 / 10] best valid accuracy: 97.314 at epoch 9 
 best_stats: {'best_valid_epoch': 9, 'best_valid_valid/acc': 95.829, 'best_valid_valid/acc_unbiased': 97.314, 'best_valid_valid/diff': 2.359, 'best_valid_valid/acc_skew': 98.232, 'best_valid_valid/acc_align': 96.396, 'best_valid_test/acc': 90.119, 'best_valid_test/acc_unbiased': 90.108, 'best_valid_test/diff': 12.474, 'best_valid_test/acc_skew': 89.845, 'best_valid_test/acc_align': 90.371}
[10 / 10] best test accuracy: 91.031 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 94.106, 'best_test_valid/acc_unbiased': 94.24, 'best_test_valid/diff': 3.154, 'best_test_valid/acc_skew': 95.817, 'best_test_valid/acc_align': 92.663, 'best_test_test/acc': 90.965, 'best_test_test/acc_unbiased': 91.031, 'best_test_test/diff': 7.906, 'best_test_test/acc_skew': 90.983, 'best_test_test/acc_align': 91.08}
Total training time: 3:06:50
