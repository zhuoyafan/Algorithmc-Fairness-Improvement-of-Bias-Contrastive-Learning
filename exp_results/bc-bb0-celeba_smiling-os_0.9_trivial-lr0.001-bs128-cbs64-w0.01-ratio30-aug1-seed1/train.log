Log level set to: INFO
Set seed: 1
=======> Using Fixed Random Seed: 1 <========
save_path: exp_results/bc-bb0-celeba_smiling-os_0.9_trivial-lr0.001-bs128-cbs64-w0.01-ratio30-aug1-seed1
get_celeba - split:train, aug: False, given_y: True, ratio: 0
use existing smiling indices from data/celeba/pickles/smiling
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [36551, 36551]
Target 1: [36551, 36551]
Binary Target 1
---------------------------
Target 0: [36551, 36551]
Target 1: [36551, 36551]
===================================
Normal Label Distribution: 
Target 0: [36551, 36551]
Target 1: [36551, 36551]
===================================
Use BiasedCelebASplit 
 target_attr: smiling split: train 
 tensor([[36551., 36551.],
        [36551., 36551.]])
get_celeba - split:train, aug: 1, given_y: True, ratio: 30
use existing smiling indices from data/celeba/pickles/smiling
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [36630, 36630]
Target 1: [36630, 36630]
Binary Target 1
---------------------------
Target 0: [36630, 36630]
Target 1: [36630, 36630]
===================================
Normal Label Distribution: 
Target 0: [36630, 36630]
Target 1: [36630, 36630]
===================================
Use BiasedCelebASplit 
 target_attr: smiling split: train 
 tensor([[36630., 36630.],
        [36630., 36630.]])
get_celeba - split:train_valid, aug: False, given_y: True, ratio: 0
use existing smiling indices from data/celeba/pickles/smiling
Use BiasedCelebASplit 
 target_attr: smiling split: train_valid 
 tensor([[ 2019., 10233.],
        [ 8156.,  1957.]])
get_celeba - split:valid, aug: False, given_y: True, ratio: 0
Use BiasedCelebASplit 
 target_attr: smiling split: valid 
 tensor([[5252., 6157.],
        [5013., 3445.]])
decay_epochs: [3, 6]
[1 / 10] Learning rate: 0.001 weight: 0.01
[1 / 10] Loss: 4.693950870980225 CE Loss: 0.25930765352560026 Con Loss: 4.691357793855209
[1 / 10] tensor([[0.893, 0.881],
        [0.939, 0.931]]) {'epoch': 1, 'valid/acc': 91.031, 'valid/acc_unbiased': 91.089, 'valid/diff': 1.7, 'valid/acc_skew': 91.939, 'valid/acc_align': 90.24, 'test/acc': 91.091, 'test/acc_unbiased': 91.11, 'test/diff': 1.028, 'test/acc_skew': 91.623, 'test/acc_align': 90.596}
[1 / 10] best valid accuracy: 91.089 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 91.031, 'best_valid_valid/acc_unbiased': 91.089, 'best_valid_valid/diff': 1.7, 'best_valid_valid/acc_skew': 91.939, 'best_valid_valid/acc_align': 90.24, 'best_valid_test/acc': 91.091, 'best_valid_test/acc_unbiased': 91.11, 'best_valid_test/diff': 1.028, 'best_valid_test/acc_skew': 91.623, 'best_valid_test/acc_align': 90.596}
[1 / 10] best test accuracy: 91.110 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 91.031, 'best_test_valid/acc_unbiased': 91.089, 'best_test_valid/diff': 1.7, 'best_test_valid/acc_skew': 91.939, 'best_test_valid/acc_align': 90.24, 'best_test_test/acc': 91.091, 'best_test_test/acc_unbiased': 91.11, 'best_test_test/diff': 1.028, 'best_test_test/acc_skew': 91.623, 'best_test_test/acc_align': 90.596}
[2 / 10] Learning rate: 0.001 weight: 0.01
[2 / 10] Loss: 4.651963797578642 CE Loss: 0.22973679390013232 Con Loss: 4.649666428203958
[2 / 10] tensor([[0.996, 0.987],
        [0.701, 0.707]]) {'epoch': 2, 'valid/acc': 83.26, 'valid/acc_unbiased': 84.745, 'valid/diff': 0.625, 'valid/acc_skew': 84.959, 'valid/acc_align': 84.532, 'test/acc': 85.217, 'test/acc_unbiased': 84.773, 'test/diff': 0.766, 'test/acc_skew': 84.858, 'test/acc_align': 84.687}
[2 / 10] best valid accuracy: 91.089 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 91.031, 'best_valid_valid/acc_unbiased': 91.089, 'best_valid_valid/diff': 1.7, 'best_valid_valid/acc_skew': 91.939, 'best_valid_valid/acc_align': 90.24, 'best_valid_test/acc': 91.091, 'best_valid_test/acc_unbiased': 91.11, 'best_valid_test/diff': 1.028, 'best_valid_test/acc_skew': 91.623, 'best_valid_test/acc_align': 90.596}
[2 / 10] best test accuracy: 91.110 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 91.031, 'best_test_valid/acc_unbiased': 91.089, 'best_test_valid/diff': 1.7, 'best_test_valid/acc_skew': 91.939, 'best_test_valid/acc_align': 90.24, 'best_test_test/acc': 91.091, 'best_test_test/acc_unbiased': 91.11, 'best_test_test/diff': 1.028, 'best_test_test/acc_skew': 91.623, 'best_test_test/acc_align': 90.596}
[3 / 10] Learning rate: 0.001 weight: 0.01
[3 / 10] Loss: 4.641427338327162 CE Loss: 0.22422224004405106 Con Loss: 4.639185114150295
[3 / 10] tensor([[0.951, 0.927],
        [0.898, 0.899]]) {'epoch': 3, 'valid/acc': 90.973, 'valid/acc_unbiased': 91.56, 'valid/diff': 1.399, 'valid/acc_skew': 92.198, 'valid/acc_align': 90.923, 'test/acc': 91.957, 'test/acc_unbiased': 91.881, 'test/diff': 1.206, 'test/acc_skew': 92.443, 'test/acc_align': 91.319}
[3 / 10] best valid accuracy: 91.560 at epoch 3 
 best_stats: {'best_valid_epoch': 3, 'best_valid_valid/acc': 90.973, 'best_valid_valid/acc_unbiased': 91.56, 'best_valid_valid/diff': 1.399, 'best_valid_valid/acc_skew': 92.198, 'best_valid_valid/acc_align': 90.923, 'best_valid_test/acc': 91.957, 'best_valid_test/acc_unbiased': 91.881, 'best_valid_test/diff': 1.206, 'best_valid_test/acc_skew': 92.443, 'best_valid_test/acc_align': 91.319}
[3 / 10] best test accuracy: 91.881 at epoch 3 
 best_stats: {'best_test_epoch': 3, 'best_test_valid/acc': 90.973, 'best_test_valid/acc_unbiased': 91.56, 'best_test_valid/diff': 1.399, 'best_test_valid/acc_skew': 92.198, 'best_test_valid/acc_align': 90.923, 'best_test_test/acc': 91.957, 'best_test_test/acc_unbiased': 91.881, 'best_test_test/diff': 1.206, 'best_test_test/acc_skew': 92.443, 'best_test_test/acc_align': 91.319}
[4 / 10] Learning rate: 0.0001 weight: 0.01
[4 / 10] Loss: 4.595992442772348 CE Loss: 0.19879022147646616 Con Loss: 4.594004540269781
[4 / 10] tensor([[0.930, 0.931],
        [0.928, 0.909]]) {'epoch': 4, 'valid/acc': 92.533, 'valid/acc_unbiased': 92.423, 'valid/diff': 1.218, 'valid/acc_skew': 93.032, 'valid/acc_align': 91.814, 'test/acc': 92.576, 'test/acc_unbiased': 92.424, 'test/diff': 1.018, 'test/acc_skew': 92.881, 'test/acc_align': 91.967}
[4 / 10] best valid accuracy: 92.423 at epoch 4 
 best_stats: {'best_valid_epoch': 4, 'best_valid_valid/acc': 92.533, 'best_valid_valid/acc_unbiased': 92.423, 'best_valid_valid/diff': 1.218, 'best_valid_valid/acc_skew': 93.032, 'best_valid_valid/acc_align': 91.814, 'best_valid_test/acc': 92.576, 'best_valid_test/acc_unbiased': 92.424, 'best_valid_test/diff': 1.018, 'best_valid_test/acc_skew': 92.881, 'best_valid_test/acc_align': 91.967}
[4 / 10] best test accuracy: 92.424 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 92.533, 'best_test_valid/acc_unbiased': 92.423, 'best_test_valid/diff': 1.218, 'best_test_valid/acc_skew': 93.032, 'best_test_valid/acc_align': 91.814, 'best_test_test/acc': 92.576, 'best_test_test/acc_unbiased': 92.424, 'best_test_test/diff': 1.018, 'best_test_test/acc_skew': 92.881, 'best_test_test/acc_align': 91.967}
[5 / 10] Learning rate: 0.0001 weight: 0.01
[5 / 10] Loss: 4.5817012368094945 CE Loss: 0.191793454745697 Con Loss: 4.579783302707479
[5 / 10] tensor([[0.950, 0.933],
        [0.917, 0.908]]) {'epoch': 5, 'valid/acc': 92.457, 'valid/acc_unbiased': 92.716, 'valid/diff': 1.171, 'valid/acc_skew': 93.302, 'valid/acc_align': 92.131, 'test/acc': 92.847, 'test/acc_unbiased': 92.725, 'test/diff': 1.315, 'test/acc_skew': 93.383, 'test/acc_align': 92.068}
[5 / 10] best valid accuracy: 92.716 at epoch 5 
 best_stats: {'best_valid_epoch': 5, 'best_valid_valid/acc': 92.457, 'best_valid_valid/acc_unbiased': 92.716, 'best_valid_valid/diff': 1.171, 'best_valid_valid/acc_skew': 93.302, 'best_valid_valid/acc_align': 92.131, 'best_valid_test/acc': 92.847, 'best_valid_test/acc_unbiased': 92.725, 'best_valid_test/diff': 1.315, 'best_valid_test/acc_skew': 93.383, 'best_valid_test/acc_align': 92.068}
[5 / 10] best test accuracy: 92.725 at epoch 5 
 best_stats: {'best_test_epoch': 5, 'best_test_valid/acc': 92.457, 'best_test_valid/acc_unbiased': 92.716, 'best_test_valid/diff': 1.171, 'best_test_valid/acc_skew': 93.302, 'best_test_valid/acc_align': 92.131, 'best_test_test/acc': 92.847, 'best_test_test/acc_unbiased': 92.725, 'best_test_test/diff': 1.315, 'best_test_test/acc_skew': 93.383, 'best_test_test/acc_align': 92.068}
[6 / 10] Learning rate: 0.0001 weight: 0.01
[6 / 10] Loss: 4.575414381804491 CE Loss: 0.18905468892692062 Con Loss: 4.5735238378884375
[6 / 10] tensor([[0.914, 0.900],
        [0.942, 0.933]]) {'epoch': 6, 'valid/acc': 92.43, 'valid/acc_unbiased': 92.632, 'valid/diff': 1.535, 'valid/acc_skew': 93.4, 'valid/acc_align': 91.864, 'test/acc': 92.228, 'test/acc_unbiased': 92.209, 'test/diff': 1.167, 'test/acc_skew': 92.792, 'test/acc_align': 91.626}
[6 / 10] best valid accuracy: 92.716 at epoch 5 
 best_stats: {'best_valid_epoch': 5, 'best_valid_valid/acc': 92.457, 'best_valid_valid/acc_unbiased': 92.716, 'best_valid_valid/diff': 1.171, 'best_valid_valid/acc_skew': 93.302, 'best_valid_valid/acc_align': 92.131, 'best_valid_test/acc': 92.847, 'best_valid_test/acc_unbiased': 92.725, 'best_valid_test/diff': 1.315, 'best_valid_test/acc_skew': 93.383, 'best_valid_test/acc_align': 92.068}
[6 / 10] best test accuracy: 92.725 at epoch 5 
 best_stats: {'best_test_epoch': 5, 'best_test_valid/acc': 92.457, 'best_test_valid/acc_unbiased': 92.716, 'best_test_valid/diff': 1.171, 'best_test_valid/acc_skew': 93.302, 'best_test_valid/acc_align': 92.131, 'best_test_test/acc': 92.847, 'best_test_test/acc_unbiased': 92.725, 'best_test_test/diff': 1.315, 'best_test_test/acc_skew': 93.383, 'best_test_test/acc_align': 92.068}
[7 / 10] Learning rate: 1e-05 weight: 0.01
[7 / 10] Loss: 4.567301238604973 CE Loss: 0.18613834645493027 Con Loss: 4.565439852685603
[7 / 10] tensor([[0.932, 0.915],
        [0.933, 0.926]]) {'epoch': 7, 'valid/acc': 92.555, 'valid/acc_unbiased': 92.791, 'valid/diff': 1.072, 'valid/acc_skew': 93.327, 'valid/acc_align': 92.254, 'test/acc': 92.676, 'test/acc_unbiased': 92.627, 'test/diff': 1.203, 'test/acc_skew': 93.228, 'test/acc_align': 92.026}
[7 / 10] best valid accuracy: 92.791 at epoch 7 
 best_stats: {'best_valid_epoch': 7, 'best_valid_valid/acc': 92.555, 'best_valid_valid/acc_unbiased': 92.791, 'best_valid_valid/diff': 1.072, 'best_valid_valid/acc_skew': 93.327, 'best_valid_valid/acc_align': 92.254, 'best_valid_test/acc': 92.676, 'best_valid_test/acc_unbiased': 92.627, 'best_valid_test/diff': 1.203, 'best_valid_test/acc_skew': 93.228, 'best_valid_test/acc_align': 92.026}
[7 / 10] best test accuracy: 92.725 at epoch 5 
 best_stats: {'best_test_epoch': 5, 'best_test_valid/acc': 92.457, 'best_test_valid/acc_unbiased': 92.716, 'best_test_valid/diff': 1.171, 'best_test_valid/acc_skew': 93.302, 'best_test_valid/acc_align': 92.131, 'best_test_test/acc': 92.847, 'best_test_test/acc_unbiased': 92.725, 'best_test_test/diff': 1.315, 'best_test_test/acc_skew': 93.383, 'best_test_test/acc_align': 92.068}
[8 / 10] Learning rate: 1e-05 weight: 0.01
[8 / 10] Loss: 4.5623228545195555 CE Loss: 0.1853373958510461 Con Loss: 4.5604694922649855
[8 / 10] tensor([[0.955, 0.940],
        [0.916, 0.902]]) {'epoch': 8, 'valid/acc': 92.596, 'valid/acc_unbiased': 92.941, 'valid/diff': 1.487, 'valid/acc_skew': 93.684, 'valid/acc_align': 92.198, 'test/acc': 92.988, 'test/acc_unbiased': 92.82, 'test/diff': 1.447, 'test/acc_skew': 93.544, 'test/acc_align': 92.097}
[8 / 10] best valid accuracy: 92.941 at epoch 8 
 best_stats: {'best_valid_epoch': 8, 'best_valid_valid/acc': 92.596, 'best_valid_valid/acc_unbiased': 92.941, 'best_valid_valid/diff': 1.487, 'best_valid_valid/acc_skew': 93.684, 'best_valid_valid/acc_align': 92.198, 'best_valid_test/acc': 92.988, 'best_valid_test/acc_unbiased': 92.82, 'best_valid_test/diff': 1.447, 'best_valid_test/acc_skew': 93.544, 'best_valid_test/acc_align': 92.097}
[8 / 10] best test accuracy: 92.820 at epoch 8 
 best_stats: {'best_test_epoch': 8, 'best_test_valid/acc': 92.596, 'best_test_valid/acc_unbiased': 92.941, 'best_test_valid/diff': 1.487, 'best_test_valid/acc_skew': 93.684, 'best_test_valid/acc_align': 92.198, 'best_test_test/acc': 92.988, 'best_test_test/acc_unbiased': 92.82, 'best_test_test/diff': 1.447, 'best_test_test/acc_skew': 93.544, 'best_test_test/acc_align': 92.097}
[9 / 10] Learning rate: 1e-05 weight: 0.01
[9 / 10] Loss: 4.562999470452891 CE Loss: 0.18471993551818894 Con Loss: 4.561152276201962
[9 / 10] tensor([[0.936, 0.927],
        [0.929, 0.917]]) {'epoch': 9, 'valid/acc': 92.654, 'valid/acc_unbiased': 92.811, 'valid/diff': 1.046, 'valid/acc_skew': 93.334, 'valid/acc_align': 92.288, 'test/acc': 92.842, 'test/acc_unbiased': 92.738, 'test/diff': 1.099, 'test/acc_skew': 93.288, 'test/acc_align': 92.189}
[9 / 10] best valid accuracy: 92.941 at epoch 8 
 best_stats: {'best_valid_epoch': 8, 'best_valid_valid/acc': 92.596, 'best_valid_valid/acc_unbiased': 92.941, 'best_valid_valid/diff': 1.487, 'best_valid_valid/acc_skew': 93.684, 'best_valid_valid/acc_align': 92.198, 'best_valid_test/acc': 92.988, 'best_valid_test/acc_unbiased': 92.82, 'best_valid_test/diff': 1.447, 'best_valid_test/acc_skew': 93.544, 'best_valid_test/acc_align': 92.097}
[9 / 10] best test accuracy: 92.820 at epoch 8 
 best_stats: {'best_test_epoch': 8, 'best_test_valid/acc': 92.596, 'best_test_valid/acc_unbiased': 92.941, 'best_test_valid/diff': 1.487, 'best_test_valid/acc_skew': 93.684, 'best_test_valid/acc_align': 92.198, 'best_test_test/acc': 92.988, 'best_test_test/acc_unbiased': 92.82, 'best_test_test/diff': 1.447, 'best_test_test/acc_skew': 93.544, 'best_test_test/acc_align': 92.097}
[10 / 10] Learning rate: 1e-05 weight: 0.01
[10 / 10] Loss: 4.561250561157926 CE Loss: 0.18431181453382628 Con Loss: 4.559407444059733
[10 / 10] tensor([[0.943, 0.930],
        [0.928, 0.918]]) {'epoch': 10, 'valid/acc': 92.761, 'valid/acc_unbiased': 93.047, 'valid/diff': 1.347, 'valid/acc_skew': 93.721, 'valid/acc_align': 92.374, 'test/acc': 93.049, 'test/acc_unbiased': 92.949, 'test/diff': 1.143, 'test/acc_skew': 93.521, 'test/acc_align': 92.377}
[10 / 10] best valid accuracy: 93.047 at epoch 10 
 best_stats: {'best_valid_epoch': 10, 'best_valid_valid/acc': 92.761, 'best_valid_valid/acc_unbiased': 93.047, 'best_valid_valid/diff': 1.347, 'best_valid_valid/acc_skew': 93.721, 'best_valid_valid/acc_align': 92.374, 'best_valid_test/acc': 93.049, 'best_valid_test/acc_unbiased': 92.949, 'best_valid_test/diff': 1.143, 'best_valid_test/acc_skew': 93.521, 'best_valid_test/acc_align': 92.377}
[10 / 10] best test accuracy: 92.949 at epoch 10 
 best_stats: {'best_test_epoch': 10, 'best_test_valid/acc': 92.761, 'best_test_valid/acc_unbiased': 93.047, 'best_test_valid/diff': 1.347, 'best_test_valid/acc_skew': 93.721, 'best_test_valid/acc_align': 92.374, 'best_test_test/acc': 93.049, 'best_test_test/acc_unbiased': 92.949, 'best_test_test/diff': 1.143, 'best_test_test/acc_skew': 93.521, 'best_test_test/acc_align': 92.377}
Total training time: 2:14:35
