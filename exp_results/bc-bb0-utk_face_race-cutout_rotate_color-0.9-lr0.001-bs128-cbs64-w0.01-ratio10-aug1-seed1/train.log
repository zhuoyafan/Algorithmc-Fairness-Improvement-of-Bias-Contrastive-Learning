Log level set to: INFO
Set seed: 1
=======> Using Fixed Random Seed: 1 <========
save_path: exp_results/bc-bb0-utk_face_race-cutout_rotate_color-0.9-lr0.001-bs128-cbs64-w0.01-ratio10-aug1-seed1
get_utk_face - split: train, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_race-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [4407, 552]
Target 1: [440, 5529]
Binary Target 1
---------------------------
Target 0: [4407, 552]
Target 1: [440, 5529]
===================================
Normal Label Distribution: 
Target 0: [4407, 552]
Target 1: [440, 5529]
===================================
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [4407, 552]
Target 1: [440, 5529]
Binary Target 1
---------------------------
Target 0: [4407, 552]
Target 1: [440, 5529]
===================================
Normal Label Distribution: 
Target 0: [4407, 552]
Target 1: [440, 5529]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 10928, target_attr: gender, bias_attr: race bias_rate: 0.9
['[train] target_0-bias_0: 4407', '[train] target_0-bias_1: 552', '[train] target_1-bias_0: 440', '[train] target_1-bias_1: 5529']
confusion_matrix - 
 original: tensor([[4407.,  440.],
        [ 552., 5529.]]), 
 normalized: tensor([[0.909, 0.091],
        [0.091, 0.909]]), 
 b|y: tensor([[0.889, 0.111],
        [0.074, 0.926]])
get_utk_face - split: train, aug: 1, given_y: True, ratio: 10
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_race-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [4407, 552]
Target 1: [440, 5529]
Binary Target 1
---------------------------
Target 0: [4407, 552]
Target 1: [440, 5529]
===================================
Normal Label Distribution: 
Target 0: [4407, 552]
Target 1: [440, 5529]
===================================
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [4407, 552]
Target 1: [440, 5529]
Binary Target 1
---------------------------
Target 0: [4407, 552]
Target 1: [440, 5529]
===================================
Normal Label Distribution: 
Target 0: [4407, 552]
Target 1: [440, 5529]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 10928, target_attr: gender, bias_attr: race bias_rate: 0.9
['[train] target_0-bias_0: 4407', '[train] target_0-bias_1: 552', '[train] target_1-bias_0: 440', '[train] target_1-bias_1: 5529']
get_utk_face - split: valid, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_race-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [583, 684]
Target 1: [457, 646]
Binary Target 1
---------------------------
Target 0: [583, 684]
Target 1: [457, 646]
===================================
Normal Label Distribution: 
Target 0: [583, 684]
Target 1: [457, 646]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 2370, target_attr: gender, bias_attr: race bias_rate: 0.9
['[valid] target_0-bias_0: 583', '[valid] target_0-bias_1: 684', '[valid] target_1-bias_0: 457', '[valid] target_1-bias_1: 646']
get_utk_face - split: test, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_race-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [558, 677]
Target 1: [462, 673]
Binary Target 1
---------------------------
Target 0: [558, 677]
Target 1: [462, 673]
===================================
Normal Label Distribution: 
Target 0: [558, 677]
Target 1: [462, 673]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 2370, target_attr: gender, bias_attr: race bias_rate: 0.9
['[test] target_0-bias_0: 558', '[test] target_0-bias_1: 677', '[test] target_1-bias_0: 462', '[test] target_1-bias_1: 673']
decay_epochs: [6, 13]
[1 / 20] Learning rate: 0.001 weight: 0.01
[1 / 20] Loss: 4.917264270922101 CE Loss: 0.6656202597115435 Con Loss: 4.910608100332593
[1 / 20] tensor([[0.439, 0.344],
        [0.835, 0.887]]) {'epoch': 1, 'valid/acc': 61.688, 'valid/acc_unbiased': 63.275, 'valid/diff': 3.637, 'valid/acc_skew': 61.457, 'valid/acc_align': 65.094, 'test/acc': 61.646, 'test/acc_unbiased': 62.645, 'test/diff': 7.324, 'test/acc_skew': 58.983, 'test/acc_align': 66.307}
[1 / 20] best valid accuracy: 63.275 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 61.688, 'best_valid_valid/acc_unbiased': 63.275, 'best_valid_valid/diff': 3.637, 'best_valid_valid/acc_skew': 61.457, 'best_valid_valid/acc_align': 65.094, 'best_valid_test/acc': 61.646, 'best_valid_test/acc_unbiased': 62.645, 'best_valid_test/diff': 7.324, 'best_valid_test/acc_skew': 58.983, 'best_valid_test/acc_align': 66.307}
[1 / 20] best test accuracy: 62.645 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 61.688, 'best_test_valid/acc_unbiased': 63.275, 'best_test_valid/diff': 3.637, 'best_test_valid/acc_skew': 61.457, 'best_test_valid/acc_align': 65.094, 'best_test_test/acc': 61.646, 'best_test_test/acc_unbiased': 62.645, 'best_test_test/diff': 7.324, 'best_test_test/acc_skew': 58.983, 'best_test_test/acc_align': 66.307}
[2 / 20] Learning rate: 0.001 weight: 0.01
[2 / 20] Loss: 4.84282656819021 CE Loss: 0.5919811020483908 Con Loss: 4.836906769614268
[2 / 20] tensor([[0.498, 0.442],
        [0.887, 0.902]]) {'epoch': 2, 'valid/acc': 67.637, 'valid/acc_unbiased': 69.002, 'valid/diff': 5.007, 'valid/acc_skew': 66.498, 'valid/acc_align': 71.505, 'test/acc': 67.257, 'test/acc_unbiased': 68.231, 'test/diff': 3.552, 'test/acc_skew': 66.455, 'test/acc_align': 70.007}
[2 / 20] best valid accuracy: 69.002 at epoch 2 
 best_stats: {'best_valid_epoch': 2, 'best_valid_valid/acc': 67.637, 'best_valid_valid/acc_unbiased': 69.002, 'best_valid_valid/diff': 5.007, 'best_valid_valid/acc_skew': 66.498, 'best_valid_valid/acc_align': 71.505, 'best_valid_test/acc': 67.257, 'best_valid_test/acc_unbiased': 68.231, 'best_valid_test/diff': 3.552, 'best_valid_test/acc_skew': 66.455, 'best_valid_test/acc_align': 70.007}
[2 / 20] best test accuracy: 68.231 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 67.637, 'best_test_valid/acc_unbiased': 69.002, 'best_test_valid/diff': 5.007, 'best_test_valid/acc_skew': 66.498, 'best_test_valid/acc_align': 71.505, 'best_test_test/acc': 67.257, 'best_test_test/acc_unbiased': 68.231, 'best_test_test/diff': 3.552, 'best_test_test/acc_skew': 66.455, 'best_test_test/acc_align': 70.007}
[3 / 20] Learning rate: 0.001 weight: 0.01
[3 / 20] Loss: 4.831026620432015 CE Loss: 0.5738631314100319 Con Loss: 4.825288000427961
[3 / 20] tensor([[0.593, 0.496],
        [0.868, 0.881]]) {'epoch': 3, 'valid/acc': 70.127, 'valid/acc_unbiased': 71.333, 'valid/diff': 6.67, 'valid/acc_skew': 67.998, 'valid/acc_align': 74.668, 'test/acc': 70.084, 'test/acc_unbiased': 70.965, 'test/diff': 5.502, 'test/acc_skew': 68.214, 'test/acc_align': 73.716}
[3 / 20] best valid accuracy: 71.333 at epoch 3 
 best_stats: {'best_valid_epoch': 3, 'best_valid_valid/acc': 70.127, 'best_valid_valid/acc_unbiased': 71.333, 'best_valid_valid/diff': 6.67, 'best_valid_valid/acc_skew': 67.998, 'best_valid_valid/acc_align': 74.668, 'best_valid_test/acc': 70.084, 'best_valid_test/acc_unbiased': 70.965, 'best_valid_test/diff': 5.502, 'best_valid_test/acc_skew': 68.214, 'best_valid_test/acc_align': 73.716}
[3 / 20] best test accuracy: 70.965 at epoch 3 
 best_stats: {'best_test_epoch': 3, 'best_test_valid/acc': 70.127, 'best_test_valid/acc_unbiased': 71.333, 'best_test_valid/diff': 6.67, 'best_test_valid/acc_skew': 67.998, 'best_test_valid/acc_align': 74.668, 'best_test_test/acc': 70.084, 'best_test_test/acc_unbiased': 70.965, 'best_test_test/diff': 5.502, 'best_test_test/acc_skew': 68.214, 'best_test_test/acc_align': 73.716}
[4 / 20] Learning rate: 0.001 weight: 0.01
[4 / 20] Loss: 4.8199531609631565 CE Loss: 0.5739016116625394 Con Loss: 4.814214146503767
[4 / 20] tensor([[0.889, 0.808],
        [0.494, 0.646]]) {'epoch': 4, 'valid/acc': 72.996, 'valid/acc_unbiased': 71.55, 'valid/diff': 9.511, 'valid/acc_skew': 66.794, 'valid/acc_align': 76.306, 'test/acc': 71.983, 'test/acc_unbiased': 70.918, 'test/diff': 11.688, 'test/acc_skew': 65.074, 'test/acc_align': 76.762}
[4 / 20] best valid accuracy: 71.550 at epoch 4 
 best_stats: {'best_valid_epoch': 4, 'best_valid_valid/acc': 72.996, 'best_valid_valid/acc_unbiased': 71.55, 'best_valid_valid/diff': 9.511, 'best_valid_valid/acc_skew': 66.794, 'best_valid_valid/acc_align': 76.306, 'best_valid_test/acc': 71.983, 'best_valid_test/acc_unbiased': 70.918, 'best_valid_test/diff': 11.688, 'best_valid_test/acc_skew': 65.074, 'best_valid_test/acc_align': 76.762}
[4 / 20] best test accuracy: 70.965 at epoch 3 
 best_stats: {'best_test_epoch': 3, 'best_test_valid/acc': 70.127, 'best_test_valid/acc_unbiased': 71.333, 'best_test_valid/diff': 6.67, 'best_test_valid/acc_skew': 67.998, 'best_test_valid/acc_align': 74.668, 'best_test_test/acc': 70.084, 'best_test_test/acc_unbiased': 70.965, 'best_test_test/diff': 5.502, 'best_test_test/acc_skew': 68.214, 'best_test_test/acc_align': 73.716}
[5 / 20] Learning rate: 0.001 weight: 0.01
[5 / 20] Loss: 4.817429702418091 CE Loss: 0.5666096209607048 Con Loss: 4.811763612627111
[5 / 20] tensor([[0.905, 0.833],
        [0.489, 0.633]]) {'epoch': 5, 'valid/acc': 74.008, 'valid/acc_unbiased': 72.518, 'valid/diff': 9.181, 'valid/acc_skew': 67.928, 'valid/acc_align': 77.109, 'test/acc': 72.616, 'test/acc_unbiased': 71.507, 'test/diff': 10.787, 'test/acc_skew': 66.113, 'test/acc_align': 76.9}
[5 / 20] best valid accuracy: 72.518 at epoch 5 
 best_stats: {'best_valid_epoch': 5, 'best_valid_valid/acc': 74.008, 'best_valid_valid/acc_unbiased': 72.518, 'best_valid_valid/diff': 9.181, 'best_valid_valid/acc_skew': 67.928, 'best_valid_valid/acc_align': 77.109, 'best_valid_test/acc': 72.616, 'best_valid_test/acc_unbiased': 71.507, 'best_valid_test/diff': 10.787, 'best_valid_test/acc_skew': 66.113, 'best_valid_test/acc_align': 76.9}
[5 / 20] best test accuracy: 71.507 at epoch 5 
 best_stats: {'best_test_epoch': 5, 'best_test_valid/acc': 74.008, 'best_test_valid/acc_unbiased': 72.518, 'best_test_valid/diff': 9.181, 'best_test_valid/acc_skew': 67.928, 'best_test_valid/acc_align': 77.109, 'best_test_test/acc': 72.616, 'best_test_test/acc_unbiased': 71.507, 'best_test_test/diff': 10.787, 'best_test_test/acc_skew': 66.113, 'best_test_test/acc_align': 76.9}
[6 / 20] Learning rate: 0.001 weight: 0.01
[6 / 20] Loss: 4.808049698350719 CE Loss: 0.5556683591832877 Con Loss: 4.802493054207038
[6 / 20] tensor([[0.894, 0.846],
        [0.545, 0.615]]) {'epoch': 6, 'valid/acc': 74.979, 'valid/acc_unbiased': 73.697, 'valid/diff': 3.875, 'valid/acc_skew': 71.759, 'valid/acc_align': 75.634, 'test/acc': 73.333, 'test/acc_unbiased': 72.531, 'test/diff': 5.879, 'test/acc_skew': 69.592, 'test/acc_align': 75.471}
[6 / 20] best valid accuracy: 73.697 at epoch 6 
 best_stats: {'best_valid_epoch': 6, 'best_valid_valid/acc': 74.979, 'best_valid_valid/acc_unbiased': 73.697, 'best_valid_valid/diff': 3.875, 'best_valid_valid/acc_skew': 71.759, 'best_valid_valid/acc_align': 75.634, 'best_valid_test/acc': 73.333, 'best_valid_test/acc_unbiased': 72.531, 'best_valid_test/diff': 5.879, 'best_valid_test/acc_skew': 69.592, 'best_valid_test/acc_align': 75.471}
[6 / 20] best test accuracy: 72.531 at epoch 6 
 best_stats: {'best_test_epoch': 6, 'best_test_valid/acc': 74.979, 'best_test_valid/acc_unbiased': 73.697, 'best_test_valid/diff': 3.875, 'best_test_valid/acc_skew': 71.759, 'best_test_valid/acc_align': 75.634, 'best_test_test/acc': 73.333, 'best_test_test/acc_unbiased': 72.531, 'best_test_test/diff': 5.879, 'best_test_test/acc_skew': 69.592, 'best_test_test/acc_align': 75.471}
[7 / 20] Learning rate: 0.0001 weight: 0.01
[7 / 20] Loss: 4.778992222133876 CE Loss: 0.5257386158099112 Con Loss: 4.773734835545105
[7 / 20] tensor([[0.753, 0.679],
        [0.801, 0.835]]) {'epoch': 7, 'valid/acc': 77.426, 'valid/acc_unbiased': 77.695, 'valid/diff': 1.841, 'valid/acc_skew': 76.775, 'valid/acc_align': 78.615, 'test/acc': 76.456, 'test/acc_unbiased': 76.702, 'test/diff': 5.371, 'test/acc_skew': 74.017, 'test/acc_align': 79.388}
[7 / 20] best valid accuracy: 77.695 at epoch 7 
 best_stats: {'best_valid_epoch': 7, 'best_valid_valid/acc': 77.426, 'best_valid_valid/acc_unbiased': 77.695, 'best_valid_valid/diff': 1.841, 'best_valid_valid/acc_skew': 76.775, 'best_valid_valid/acc_align': 78.615, 'best_valid_test/acc': 76.456, 'best_valid_test/acc_unbiased': 76.702, 'best_valid_test/diff': 5.371, 'best_valid_test/acc_skew': 74.017, 'best_valid_test/acc_align': 79.388}
[7 / 20] best test accuracy: 76.702 at epoch 7 
 best_stats: {'best_test_epoch': 7, 'best_test_valid/acc': 77.426, 'best_test_valid/acc_unbiased': 77.695, 'best_test_valid/diff': 1.841, 'best_test_valid/acc_skew': 76.775, 'best_test_valid/acc_align': 78.615, 'best_test_test/acc': 76.456, 'best_test_test/acc_unbiased': 76.702, 'best_test_test/diff': 5.371, 'best_test_test/acc_skew': 74.017, 'best_test_test/acc_align': 79.388}
[8 / 20] Learning rate: 0.0001 weight: 0.01
[8 / 20] Loss: 4.754035632746461 CE Loss: 0.508043028032448 Con Loss: 4.748955212784372
[8 / 20] tensor([[0.751, 0.687],
        [0.807, 0.848]]) {'epoch': 8, 'valid/acc': 78.312, 'valid/acc_unbiased': 78.671, 'valid/diff': 4.525, 'valid/acc_skew': 76.408, 'valid/acc_align': 80.933, 'test/acc': 77.131, 'test/acc_unbiased': 77.339, 'test/diff': 5.256, 'test/acc_skew': 74.711, 'test/acc_align': 79.967}
[8 / 20] best valid accuracy: 78.671 at epoch 8 
 best_stats: {'best_valid_epoch': 8, 'best_valid_valid/acc': 78.312, 'best_valid_valid/acc_unbiased': 78.671, 'best_valid_valid/diff': 4.525, 'best_valid_valid/acc_skew': 76.408, 'best_valid_valid/acc_align': 80.933, 'best_valid_test/acc': 77.131, 'best_valid_test/acc_unbiased': 77.339, 'best_valid_test/diff': 5.256, 'best_valid_test/acc_skew': 74.711, 'best_valid_test/acc_align': 79.967}
[8 / 20] best test accuracy: 77.339 at epoch 8 
 best_stats: {'best_test_epoch': 8, 'best_test_valid/acc': 78.312, 'best_test_valid/acc_unbiased': 78.671, 'best_test_valid/diff': 4.525, 'best_test_valid/acc_skew': 76.408, 'best_test_valid/acc_align': 80.933, 'best_test_test/acc': 77.131, 'best_test_test/acc_unbiased': 77.339, 'best_test_test/diff': 5.256, 'best_test_test/acc_skew': 74.711, 'best_test_test/acc_align': 79.967}
[9 / 20] Learning rate: 0.0001 weight: 0.01
[9 / 20] Loss: 4.742381733996278 CE Loss: 0.502905338478996 Con Loss: 4.737352660948501
[9 / 20] tensor([[0.740, 0.671],
        [0.842, 0.857]]) {'epoch': 9, 'valid/acc': 77.173, 'valid/acc_unbiased': 77.719, 'valid/diff': 1.896, 'valid/acc_skew': 76.771, 'valid/acc_align': 78.668, 'test/acc': 77.342, 'test/acc_unbiased': 77.752, 'test/diff': 4.245, 'test/acc_skew': 75.63, 'test/acc_align': 79.875}
[9 / 20] best valid accuracy: 78.671 at epoch 8 
 best_stats: {'best_valid_epoch': 8, 'best_valid_valid/acc': 78.312, 'best_valid_valid/acc_unbiased': 78.671, 'best_valid_valid/diff': 4.525, 'best_valid_valid/acc_skew': 76.408, 'best_valid_valid/acc_align': 80.933, 'best_valid_test/acc': 77.131, 'best_valid_test/acc_unbiased': 77.339, 'best_valid_test/diff': 5.256, 'best_valid_test/acc_skew': 74.711, 'best_valid_test/acc_align': 79.967}
[9 / 20] best test accuracy: 77.752 at epoch 9 
 best_stats: {'best_test_epoch': 9, 'best_test_valid/acc': 77.173, 'best_test_valid/acc_unbiased': 77.719, 'best_test_valid/diff': 1.896, 'best_test_valid/acc_skew': 76.771, 'best_test_valid/acc_align': 78.668, 'best_test_test/acc': 77.342, 'best_test_test/acc_unbiased': 77.752, 'best_test_test/diff': 4.245, 'best_test_test/acc_skew': 75.63, 'best_test_test/acc_align': 79.875}
[10 / 20] Learning rate: 0.0001 weight: 0.01
[10 / 20] Loss: 4.743618338907446 CE Loss: 0.49589270488584025 Con Loss: 4.738659416075856
[10 / 20] tensor([[0.771, 0.699],
        [0.788, 0.851]]) {'epoch': 10, 'valid/acc': 78.903, 'valid/acc_unbiased': 79.065, 'valid/diff': 3.628, 'valid/acc_skew': 77.251, 'valid/acc_align': 80.879, 'test/acc': 77.637, 'test/acc_unbiased': 77.714, 'test/diff': 6.774, 'test/acc_skew': 74.327, 'test/acc_align': 81.101}
[10 / 20] best valid accuracy: 79.065 at epoch 10 
 best_stats: {'best_valid_epoch': 10, 'best_valid_valid/acc': 78.903, 'best_valid_valid/acc_unbiased': 79.065, 'best_valid_valid/diff': 3.628, 'best_valid_valid/acc_skew': 77.251, 'best_valid_valid/acc_align': 80.879, 'best_valid_test/acc': 77.637, 'best_valid_test/acc_unbiased': 77.714, 'best_valid_test/diff': 6.774, 'best_valid_test/acc_skew': 74.327, 'best_valid_test/acc_align': 81.101}
[10 / 20] best test accuracy: 77.752 at epoch 9 
 best_stats: {'best_test_epoch': 9, 'best_test_valid/acc': 77.173, 'best_test_valid/acc_unbiased': 77.719, 'best_test_valid/diff': 1.896, 'best_test_valid/acc_skew': 76.771, 'best_test_valid/acc_align': 78.668, 'best_test_test/acc': 77.342, 'best_test_test/acc_unbiased': 77.752, 'best_test_test/diff': 4.245, 'best_test_test/acc_skew': 75.63, 'best_test_test/acc_align': 79.875}
[11 / 20] Learning rate: 0.0001 weight: 0.01
[11 / 20] Loss: 4.717169025108371 CE Loss: 0.4982639815587425 Con Loss: 4.712186388878662
[11 / 20] tensor([[0.731, 0.681],
        [0.833, 0.857]]) {'epoch': 11, 'valid/acc': 78.27, 'valid/acc_unbiased': 78.653, 'valid/diff': 3.907, 'valid/acc_skew': 76.7, 'valid/acc_align': 80.607, 'test/acc': 77.257, 'test/acc_unbiased': 77.57, 'test/diff': 3.713, 'test/acc_skew': 75.714, 'test/acc_align': 79.427}
[11 / 20] best valid accuracy: 79.065 at epoch 10 
 best_stats: {'best_valid_epoch': 10, 'best_valid_valid/acc': 78.903, 'best_valid_valid/acc_unbiased': 79.065, 'best_valid_valid/diff': 3.628, 'best_valid_valid/acc_skew': 77.251, 'best_valid_valid/acc_align': 80.879, 'best_valid_test/acc': 77.637, 'best_valid_test/acc_unbiased': 77.714, 'best_valid_test/diff': 6.774, 'best_valid_test/acc_skew': 74.327, 'best_valid_test/acc_align': 81.101}
[11 / 20] best test accuracy: 77.752 at epoch 9 
 best_stats: {'best_test_epoch': 9, 'best_test_valid/acc': 77.173, 'best_test_valid/acc_unbiased': 77.719, 'best_test_valid/diff': 1.896, 'best_test_valid/acc_skew': 76.771, 'best_test_valid/acc_align': 78.668, 'best_test_test/acc': 77.342, 'best_test_test/acc_unbiased': 77.752, 'best_test_test/diff': 4.245, 'best_test_test/acc_skew': 75.63, 'best_test_test/acc_align': 79.875}
[12 / 20] Learning rate: 0.0001 weight: 0.01
[12 / 20] Loss: 4.712266222449731 CE Loss: 0.4859349646470557 Con Loss: 4.707406877598686
[12 / 20] tensor([[0.763, 0.702],
        [0.835, 0.869]]) {'epoch': 12, 'valid/acc': 78.059, 'valid/acc_unbiased': 78.528, 'valid/diff': 3.439, 'valid/acc_skew': 76.808, 'valid/acc_align': 80.247, 'test/acc': 78.987, 'test/acc_unbiased': 79.245, 'test/diff': 4.778, 'test/acc_skew': 76.856, 'test/acc_align': 81.634}
[12 / 20] best valid accuracy: 79.065 at epoch 10 
 best_stats: {'best_valid_epoch': 10, 'best_valid_valid/acc': 78.903, 'best_valid_valid/acc_unbiased': 79.065, 'best_valid_valid/diff': 3.628, 'best_valid_valid/acc_skew': 77.251, 'best_valid_valid/acc_align': 80.879, 'best_valid_test/acc': 77.637, 'best_valid_test/acc_unbiased': 77.714, 'best_valid_test/diff': 6.774, 'best_valid_test/acc_skew': 74.327, 'best_valid_test/acc_align': 81.101}
[12 / 20] best test accuracy: 79.245 at epoch 12 
 best_stats: {'best_test_epoch': 12, 'best_test_valid/acc': 78.059, 'best_test_valid/acc_unbiased': 78.528, 'best_test_valid/diff': 3.439, 'best_test_valid/acc_skew': 76.808, 'best_test_valid/acc_align': 80.247, 'best_test_test/acc': 78.987, 'best_test_test/acc_unbiased': 79.245, 'best_test_test/diff': 4.778, 'best_test_test/acc_skew': 76.856, 'best_test_test/acc_align': 81.634}
[13 / 20] Learning rate: 0.0001 weight: 0.01
[13 / 20] Loss: 4.701251088612949 CE Loss: 0.48061289449561917 Con Loss: 4.696444958230238
[13 / 20] tensor([[0.708, 0.629],
        [0.855, 0.896]]) {'epoch': 13, 'valid/acc': 76.667, 'valid/acc_unbiased': 77.433, 'valid/diff': 4.983, 'valid/acc_skew': 74.942, 'valid/acc_align': 79.925, 'test/acc': 76.751, 'test/acc_unbiased': 77.202, 'test/diff': 5.982, 'test/acc_skew': 74.211, 'test/acc_align': 80.194}
[13 / 20] best valid accuracy: 79.065 at epoch 10 
 best_stats: {'best_valid_epoch': 10, 'best_valid_valid/acc': 78.903, 'best_valid_valid/acc_unbiased': 79.065, 'best_valid_valid/diff': 3.628, 'best_valid_valid/acc_skew': 77.251, 'best_valid_valid/acc_align': 80.879, 'best_valid_test/acc': 77.637, 'best_valid_test/acc_unbiased': 77.714, 'best_valid_test/diff': 6.774, 'best_valid_test/acc_skew': 74.327, 'best_valid_test/acc_align': 81.101}
[13 / 20] best test accuracy: 79.245 at epoch 12 
 best_stats: {'best_test_epoch': 12, 'best_test_valid/acc': 78.059, 'best_test_valid/acc_unbiased': 78.528, 'best_test_valid/diff': 3.439, 'best_test_valid/acc_skew': 76.808, 'best_test_valid/acc_align': 80.247, 'best_test_test/acc': 78.987, 'best_test_test/acc_unbiased': 79.245, 'best_test_test/diff': 4.778, 'best_test_test/acc_skew': 76.856, 'best_test_test/acc_align': 81.634}
[14 / 20] Learning rate: 1e-05 weight: 0.01
[14 / 20] Loss: 4.694971835805243 CE Loss: 0.46829133676051393 Con Loss: 4.690288941647263
[14 / 20] tensor([[0.738, 0.675],
        [0.833, 0.881]]) {'epoch': 14, 'valid/acc': 77.932, 'valid/acc_unbiased': 78.448, 'valid/diff': 5.472, 'valid/acc_skew': 75.712, 'valid/acc_align': 81.184, 'test/acc': 77.932, 'test/acc_unbiased': 78.196, 'test/diff': 5.556, 'test/acc_skew': 75.419, 'test/acc_align': 80.974}
[14 / 20] best valid accuracy: 79.065 at epoch 10 
 best_stats: {'best_valid_epoch': 10, 'best_valid_valid/acc': 78.903, 'best_valid_valid/acc_unbiased': 79.065, 'best_valid_valid/diff': 3.628, 'best_valid_valid/acc_skew': 77.251, 'best_valid_valid/acc_align': 80.879, 'best_valid_test/acc': 77.637, 'best_valid_test/acc_unbiased': 77.714, 'best_valid_test/diff': 6.774, 'best_valid_test/acc_skew': 74.327, 'best_valid_test/acc_align': 81.101}
[14 / 20] best test accuracy: 79.245 at epoch 12 
 best_stats: {'best_test_epoch': 12, 'best_test_valid/acc': 78.059, 'best_test_valid/acc_unbiased': 78.528, 'best_test_valid/diff': 3.439, 'best_test_valid/acc_skew': 76.808, 'best_test_valid/acc_align': 80.247, 'best_test_test/acc': 78.987, 'best_test_test/acc_unbiased': 79.245, 'best_test_test/diff': 4.778, 'best_test_test/acc_skew': 76.856, 'best_test_test/acc_align': 81.634}
[15 / 20] Learning rate: 1e-05 weight: 0.01
[15 / 20] Loss: 4.691157801084952 CE Loss: 0.4709559495766725 Con Loss: 4.686448236859211
[15 / 20] tensor([[0.740, 0.677],
        [0.833, 0.884]]) {'epoch': 15, 'valid/acc': 78.354, 'valid/acc_unbiased': 78.879, 'valid/diff': 5.385, 'valid/acc_skew': 76.186, 'valid/acc_align': 81.571, 'test/acc': 78.101, 'test/acc_unbiased': 78.352, 'test/diff': 5.72, 'test/acc_skew': 75.492, 'test/acc_align': 81.212}
[15 / 20] best valid accuracy: 79.065 at epoch 10 
 best_stats: {'best_valid_epoch': 10, 'best_valid_valid/acc': 78.903, 'best_valid_valid/acc_unbiased': 79.065, 'best_valid_valid/diff': 3.628, 'best_valid_valid/acc_skew': 77.251, 'best_valid_valid/acc_align': 80.879, 'best_valid_test/acc': 77.637, 'best_valid_test/acc_unbiased': 77.714, 'best_valid_test/diff': 6.774, 'best_valid_test/acc_skew': 74.327, 'best_valid_test/acc_align': 81.101}
[15 / 20] best test accuracy: 79.245 at epoch 12 
 best_stats: {'best_test_epoch': 12, 'best_test_valid/acc': 78.059, 'best_test_valid/acc_unbiased': 78.528, 'best_test_valid/diff': 3.439, 'best_test_valid/acc_skew': 76.808, 'best_test_valid/acc_align': 80.247, 'best_test_test/acc': 78.987, 'best_test_test/acc_unbiased': 79.245, 'best_test_test/diff': 4.778, 'best_test_test/acc_skew': 76.856, 'best_test_test/acc_align': 81.634}
[16 / 20] Learning rate: 1e-05 weight: 0.01
[16 / 20] Loss: 4.684867319914118 CE Loss: 0.4700618280236927 Con Loss: 4.6801666871345935
[16 / 20] tensor([[0.747, 0.682],
        [0.831, 0.875]]) {'epoch': 16, 'valid/acc': 78.565, 'valid/acc_unbiased': 79.043, 'valid/diff': 5.346, 'valid/acc_skew': 76.37, 'valid/acc_align': 81.715, 'test/acc': 78.143, 'test/acc_unbiased': 78.402, 'test/diff': 5.445, 'test/acc_skew': 75.68, 'test/acc_align': 81.125}
[16 / 20] best valid accuracy: 79.065 at epoch 10 
 best_stats: {'best_valid_epoch': 10, 'best_valid_valid/acc': 78.903, 'best_valid_valid/acc_unbiased': 79.065, 'best_valid_valid/diff': 3.628, 'best_valid_valid/acc_skew': 77.251, 'best_valid_valid/acc_align': 80.879, 'best_valid_test/acc': 77.637, 'best_valid_test/acc_unbiased': 77.714, 'best_valid_test/diff': 6.774, 'best_valid_test/acc_skew': 74.327, 'best_valid_test/acc_align': 81.101}
[16 / 20] best test accuracy: 79.245 at epoch 12 
 best_stats: {'best_test_epoch': 12, 'best_test_valid/acc': 78.059, 'best_test_valid/acc_unbiased': 78.528, 'best_test_valid/diff': 3.439, 'best_test_valid/acc_skew': 76.808, 'best_test_valid/acc_align': 80.247, 'best_test_test/acc': 78.987, 'best_test_test/acc_unbiased': 79.245, 'best_test_test/diff': 4.778, 'best_test_test/acc_skew': 76.856, 'best_test_test/acc_align': 81.634}
[17 / 20] Learning rate: 1e-05 weight: 0.01
[17 / 20] Loss: 4.6724385265724555 CE Loss: 0.46714118349953593 Con Loss: 4.6677671016397095
[17 / 20] tensor([[0.740, 0.677],
        [0.838, 0.883]]) {'epoch': 17, 'valid/acc': 78.481, 'valid/acc_unbiased': 78.979, 'valid/diff': 5.218, 'valid/acc_skew': 76.369, 'valid/acc_align': 81.588, 'test/acc': 78.143, 'test/acc_unbiased': 78.423, 'test/diff': 5.429, 'test/acc_skew': 75.709, 'test/acc_align': 81.138}
[17 / 20] best valid accuracy: 79.065 at epoch 10 
 best_stats: {'best_valid_epoch': 10, 'best_valid_valid/acc': 78.903, 'best_valid_valid/acc_unbiased': 79.065, 'best_valid_valid/diff': 3.628, 'best_valid_valid/acc_skew': 77.251, 'best_valid_valid/acc_align': 80.879, 'best_valid_test/acc': 77.637, 'best_valid_test/acc_unbiased': 77.714, 'best_valid_test/diff': 6.774, 'best_valid_test/acc_skew': 74.327, 'best_valid_test/acc_align': 81.101}
[17 / 20] best test accuracy: 79.245 at epoch 12 
 best_stats: {'best_test_epoch': 12, 'best_test_valid/acc': 78.059, 'best_test_valid/acc_unbiased': 78.528, 'best_test_valid/diff': 3.439, 'best_test_valid/acc_skew': 76.808, 'best_test_valid/acc_align': 80.247, 'best_test_test/acc': 78.987, 'best_test_test/acc_unbiased': 79.245, 'best_test_test/diff': 4.778, 'best_test_test/acc_skew': 76.856, 'best_test_test/acc_align': 81.634}
[18 / 20] Learning rate: 1e-05 weight: 0.01
[18 / 20] Loss: 4.679592616387028 CE Loss: 0.47196949876593985 Con Loss: 4.674872911517477
[18 / 20] tensor([[0.760, 0.703],
        [0.820, 0.872]]) {'epoch': 18, 'valid/acc': 78.903, 'valid/acc_unbiased': 79.272, 'valid/diff': 5.143, 'valid/acc_skew': 76.7, 'valid/acc_align': 81.843, 'test/acc': 78.734, 'test/acc_unbiased': 78.888, 'test/diff': 5.431, 'test/acc_skew': 76.172, 'test/acc_align': 81.604}
[18 / 20] best valid accuracy: 79.272 at epoch 18 
 best_stats: {'best_valid_epoch': 18, 'best_valid_valid/acc': 78.903, 'best_valid_valid/acc_unbiased': 79.272, 'best_valid_valid/diff': 5.143, 'best_valid_valid/acc_skew': 76.7, 'best_valid_valid/acc_align': 81.843, 'best_valid_test/acc': 78.734, 'best_valid_test/acc_unbiased': 78.888, 'best_valid_test/diff': 5.431, 'best_valid_test/acc_skew': 76.172, 'best_valid_test/acc_align': 81.604}
[18 / 20] best test accuracy: 79.245 at epoch 12 
 best_stats: {'best_test_epoch': 12, 'best_test_valid/acc': 78.059, 'best_test_valid/acc_unbiased': 78.528, 'best_test_valid/diff': 3.439, 'best_test_valid/acc_skew': 76.808, 'best_test_valid/acc_align': 80.247, 'best_test_test/acc': 78.987, 'best_test_test/acc_unbiased': 79.245, 'best_test_test/diff': 4.778, 'best_test_test/acc_skew': 76.856, 'best_test_test/acc_align': 81.634}
[19 / 20] Learning rate: 1e-05 weight: 0.01
[19 / 20] Loss: 4.675758616641534 CE Loss: 0.4693734185500166 Con Loss: 4.671064890670218
[19 / 20] tensor([[0.740, 0.675],
        [0.838, 0.881]]) {'epoch': 19, 'valid/acc': 78.903, 'valid/acc_unbiased': 79.446, 'valid/diff': 4.986, 'valid/acc_skew': 76.953, 'valid/acc_align': 81.939, 'test/acc': 78.059, 'test/acc_unbiased': 78.349, 'test/diff': 5.429, 'test/acc_skew': 75.635, 'test/acc_align': 81.064}
[19 / 20] best valid accuracy: 79.446 at epoch 19 
 best_stats: {'best_valid_epoch': 19, 'best_valid_valid/acc': 78.903, 'best_valid_valid/acc_unbiased': 79.446, 'best_valid_valid/diff': 4.986, 'best_valid_valid/acc_skew': 76.953, 'best_valid_valid/acc_align': 81.939, 'best_valid_test/acc': 78.059, 'best_valid_test/acc_unbiased': 78.349, 'best_valid_test/diff': 5.429, 'best_valid_test/acc_skew': 75.635, 'best_valid_test/acc_align': 81.064}
[19 / 20] best test accuracy: 79.245 at epoch 12 
 best_stats: {'best_test_epoch': 12, 'best_test_valid/acc': 78.059, 'best_test_valid/acc_unbiased': 78.528, 'best_test_valid/diff': 3.439, 'best_test_valid/acc_skew': 76.808, 'best_test_valid/acc_align': 80.247, 'best_test_test/acc': 78.987, 'best_test_test/acc_unbiased': 79.245, 'best_test_test/diff': 4.778, 'best_test_test/acc_skew': 76.856, 'best_test_test/acc_align': 81.634}
[20 / 20] Learning rate: 1e-05 weight: 0.01
[20 / 20] Loss: 4.675852634547221 CE Loss: 0.4617623294953197 Con Loss: 4.671235012624135
[20 / 20] tensor([[0.738, 0.678],
        [0.835, 0.886]]) {'epoch': 20, 'valid/acc': 78.776, 'valid/acc_unbiased': 79.302, 'valid/diff': 5.428, 'valid/acc_skew': 76.588, 'valid/acc_align': 82.017, 'test/acc': 78.186, 'test/acc_unbiased': 78.436, 'test/diff': 5.522, 'test/acc_skew': 75.674, 'test/acc_align': 81.197}
[20 / 20] best valid accuracy: 79.446 at epoch 19 
 best_stats: {'best_valid_epoch': 19, 'best_valid_valid/acc': 78.903, 'best_valid_valid/acc_unbiased': 79.446, 'best_valid_valid/diff': 4.986, 'best_valid_valid/acc_skew': 76.953, 'best_valid_valid/acc_align': 81.939, 'best_valid_test/acc': 78.059, 'best_valid_test/acc_unbiased': 78.349, 'best_valid_test/diff': 5.429, 'best_valid_test/acc_skew': 75.635, 'best_valid_test/acc_align': 81.064}
[20 / 20] best test accuracy: 79.245 at epoch 12 
 best_stats: {'best_test_epoch': 12, 'best_test_valid/acc': 78.059, 'best_test_valid/acc_unbiased': 78.528, 'best_test_valid/diff': 3.439, 'best_test_valid/acc_skew': 76.808, 'best_test_valid/acc_align': 80.247, 'best_test_test/acc': 78.987, 'best_test_test/acc_unbiased': 79.245, 'best_test_test/diff': 4.778, 'best_test_test/acc_skew': 76.856, 'best_test_test/acc_align': 81.634}
Total training time: 0:18:10
