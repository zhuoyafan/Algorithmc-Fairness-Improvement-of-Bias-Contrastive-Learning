Log level set to: INFO
Set seed: 1
=======> Using Fixed Random Seed: 1 <========
save_path: exp_results/bc-bb0-utk_face_race-crop_rotate-0.9-lr0.001-bs128-cbs64-w0.01-ratio10-aug1-seed1
get_utk_face - split: train, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_race-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [4407, 552]
Target 1: [440, 5529]
Binary Target 1
---------------------------
Target 0: [4407, 552]
Target 1: [440, 5529]
===================================
Normal Label Distribution: 
Target 0: [4407, 552]
Target 1: [440, 5529]
===================================
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [4407, 552]
Target 1: [440, 5529]
Binary Target 1
---------------------------
Target 0: [4407, 552]
Target 1: [440, 5529]
===================================
Normal Label Distribution: 
Target 0: [4407, 552]
Target 1: [440, 5529]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 10928, target_attr: gender, bias_attr: race bias_rate: 0.9
['[train] target_0-bias_0: 4407', '[train] target_0-bias_1: 552', '[train] target_1-bias_0: 440', '[train] target_1-bias_1: 5529']
confusion_matrix - 
 original: tensor([[4407.,  440.],
        [ 552., 5529.]]), 
 normalized: tensor([[0.909, 0.091],
        [0.091, 0.909]]), 
 b|y: tensor([[0.889, 0.111],
        [0.074, 0.926]])
get_utk_face - split: train, aug: 1, given_y: True, ratio: 10
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_race-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [4407, 552]
Target 1: [440, 5529]
Binary Target 1
---------------------------
Target 0: [4407, 552]
Target 1: [440, 5529]
===================================
Normal Label Distribution: 
Target 0: [4407, 552]
Target 1: [440, 5529]
===================================
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [4407, 552]
Target 1: [440, 5529]
Binary Target 1
---------------------------
Target 0: [4407, 552]
Target 1: [440, 5529]
===================================
Normal Label Distribution: 
Target 0: [4407, 552]
Target 1: [440, 5529]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 10928, target_attr: gender, bias_attr: race bias_rate: 0.9
['[train] target_0-bias_0: 4407', '[train] target_0-bias_1: 552', '[train] target_1-bias_0: 440', '[train] target_1-bias_1: 5529']
get_utk_face - split: valid, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_race-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [583, 684]
Target 1: [457, 646]
Binary Target 1
---------------------------
Target 0: [583, 684]
Target 1: [457, 646]
===================================
Normal Label Distribution: 
Target 0: [583, 684]
Target 1: [457, 646]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 2370, target_attr: gender, bias_attr: race bias_rate: 0.9
['[valid] target_0-bias_0: 583', '[valid] target_0-bias_1: 684', '[valid] target_1-bias_0: 457', '[valid] target_1-bias_1: 646']
get_utk_face - split: test, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_race-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [558, 677]
Target 1: [462, 673]
Binary Target 1
---------------------------
Target 0: [558, 677]
Target 1: [462, 673]
===================================
Normal Label Distribution: 
Target 0: [558, 677]
Target 1: [462, 673]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 2370, target_attr: gender, bias_attr: race bias_rate: 0.9
['[test] target_0-bias_0: 558', '[test] target_0-bias_1: 677', '[test] target_1-bias_0: 462', '[test] target_1-bias_1: 673']
decay_epochs: [6, 13]
[1 / 20] Learning rate: 0.001 weight: 0.01
[1 / 20] Loss: 4.913764039733574 CE Loss: 0.6527765867999846 Con Loss: 4.907236283555037
[1 / 20] tensor([[0.685, 0.616],
        [0.591, 0.710]]) {'epoch': 1, 'valid/acc': 67.511, 'valid/acc_unbiased': 67.403, 'valid/diff': 8.12, 'valid/acc_skew': 63.343, 'valid/acc_align': 71.463, 'test/acc': 65.401, 'test/acc_unbiased': 65.043, 'test/diff': 9.399, 'test/acc_skew': 60.343, 'test/acc_align': 69.742}
[1 / 20] best valid accuracy: 67.403 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 67.511, 'best_valid_valid/acc_unbiased': 67.403, 'best_valid_valid/diff': 8.12, 'best_valid_valid/acc_skew': 63.343, 'best_valid_valid/acc_align': 71.463, 'best_valid_test/acc': 65.401, 'best_valid_test/acc_unbiased': 65.043, 'best_valid_test/diff': 9.399, 'best_valid_test/acc_skew': 60.343, 'best_valid_test/acc_align': 69.742}
[1 / 20] best test accuracy: 65.043 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 67.511, 'best_test_valid/acc_unbiased': 67.403, 'best_test_valid/diff': 8.12, 'best_test_valid/acc_skew': 63.343, 'best_test_valid/acc_align': 71.463, 'best_test_test/acc': 65.401, 'best_test_test/acc_unbiased': 65.043, 'best_test_test/diff': 9.399, 'best_test_test/acc_skew': 60.343, 'best_test_test/acc_align': 69.742}
[2 / 20] Learning rate: 0.001 weight: 0.01
[2 / 20] Loss: 4.82875023823706 CE Loss: 0.5809920398766614 Con Loss: 4.822940326539873
[2 / 20] tensor([[0.516, 0.449],
        [0.881, 0.883]]) {'epoch': 2, 'valid/acc': 68.228, 'valid/acc_unbiased': 69.452, 'valid/diff': 1.463, 'valid/acc_skew': 69.056, 'valid/acc_align': 69.849, 'test/acc': 67.215, 'test/acc_unbiased': 68.218, 'test/diff': 3.438, 'test/acc_skew': 66.5, 'test/acc_align': 69.937}
[2 / 20] best valid accuracy: 69.452 at epoch 2 
 best_stats: {'best_valid_epoch': 2, 'best_valid_valid/acc': 68.228, 'best_valid_valid/acc_unbiased': 69.452, 'best_valid_valid/diff': 1.463, 'best_valid_valid/acc_skew': 69.056, 'best_valid_valid/acc_align': 69.849, 'best_valid_test/acc': 67.215, 'best_valid_test/acc_unbiased': 68.218, 'best_valid_test/diff': 3.438, 'best_valid_test/acc_skew': 66.5, 'best_valid_test/acc_align': 69.937}
[2 / 20] best test accuracy: 68.218 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 68.228, 'best_test_valid/acc_unbiased': 69.452, 'best_test_valid/diff': 1.463, 'best_test_valid/acc_skew': 69.056, 'best_test_valid/acc_align': 69.849, 'best_test_test/acc': 67.215, 'best_test_test/acc_unbiased': 68.218, 'best_test_test/diff': 3.438, 'best_test_test/acc_skew': 66.5, 'best_test_test/acc_align': 69.937}
[3 / 20] Learning rate: 0.001 weight: 0.01
[3 / 20] Loss: 4.817563917766029 CE Loss: 0.5621469651797505 Con Loss: 4.8119424244669835
[3 / 20] tensor([[0.600, 0.563],
        [0.816, 0.835]]) {'epoch': 3, 'valid/acc': 70.675, 'valid/acc_unbiased': 71.448, 'valid/diff': 1.265, 'valid/acc_skew': 70.816, 'valid/acc_align': 72.081, 'test/acc': 69.831, 'test/acc_unbiased': 70.355, 'test/diff': 2.832, 'test/acc_skew': 68.94, 'test/acc_align': 71.771}
[3 / 20] best valid accuracy: 71.448 at epoch 3 
 best_stats: {'best_valid_epoch': 3, 'best_valid_valid/acc': 70.675, 'best_valid_valid/acc_unbiased': 71.448, 'best_valid_valid/diff': 1.265, 'best_valid_valid/acc_skew': 70.816, 'best_valid_valid/acc_align': 72.081, 'best_valid_test/acc': 69.831, 'best_valid_test/acc_unbiased': 70.355, 'best_valid_test/diff': 2.832, 'best_valid_test/acc_skew': 68.94, 'best_valid_test/acc_align': 71.771}
[3 / 20] best test accuracy: 70.355 at epoch 3 
 best_stats: {'best_test_epoch': 3, 'best_test_valid/acc': 70.675, 'best_test_valid/acc_unbiased': 71.448, 'best_test_valid/diff': 1.265, 'best_test_valid/acc_skew': 70.816, 'best_test_valid/acc_align': 72.081, 'best_test_test/acc': 69.831, 'best_test_test/acc_unbiased': 70.355, 'best_test_test/diff': 2.832, 'best_test_test/acc_skew': 68.94, 'best_test_test/acc_align': 71.771}
[4 / 20] Learning rate: 0.001 weight: 0.01
[4 / 20] Loss: 4.814228897038874 CE Loss: 0.5544345997612089 Con Loss: 4.8086845445423485
[4 / 20] tensor([[0.839, 0.818],
        [0.619, 0.666]]) {'epoch': 4, 'valid/acc': 74.641, 'valid/acc_unbiased': 74.156, 'valid/diff': 1.743, 'valid/acc_skew': 74.269, 'valid/acc_align': 74.042, 'test/acc': 74.093, 'test/acc_unbiased': 73.544, 'test/diff': 3.351, 'test/acc_skew': 71.868, 'test/acc_align': 75.219}
[4 / 20] best valid accuracy: 74.156 at epoch 4 
 best_stats: {'best_valid_epoch': 4, 'best_valid_valid/acc': 74.641, 'best_valid_valid/acc_unbiased': 74.156, 'best_valid_valid/diff': 1.743, 'best_valid_valid/acc_skew': 74.269, 'best_valid_valid/acc_align': 74.042, 'best_valid_test/acc': 74.093, 'best_valid_test/acc_unbiased': 73.544, 'best_valid_test/diff': 3.351, 'best_valid_test/acc_skew': 71.868, 'best_valid_test/acc_align': 75.219}
[4 / 20] best test accuracy: 73.544 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 74.641, 'best_test_valid/acc_unbiased': 74.156, 'best_test_valid/diff': 1.743, 'best_test_valid/acc_skew': 74.269, 'best_test_valid/acc_align': 74.042, 'best_test_test/acc': 74.093, 'best_test_test/acc_unbiased': 73.544, 'best_test_test/diff': 3.351, 'best_test_test/acc_skew': 71.868, 'best_test_test/acc_align': 75.219}
[5 / 20] Learning rate: 0.001 weight: 0.01
[5 / 20] Loss: 4.799888740695937 CE Loss: 0.544703719905669 Con Loss: 4.7944417090576525
[5 / 20] tensor([[0.475, 0.436],
        [0.929, 0.924]]) {'epoch': 5, 'valid/acc': 67.806, 'valid/acc_unbiased': 69.406, 'valid/diff': 1.408, 'valid/acc_skew': 70.11, 'valid/acc_align': 68.703, 'test/acc': 67.975, 'test/acc_unbiased': 69.086, 'test/diff': 2.176, 'test/acc_skew': 68.216, 'test/acc_align': 69.957}
[5 / 20] best valid accuracy: 74.156 at epoch 4 
 best_stats: {'best_valid_epoch': 4, 'best_valid_valid/acc': 74.641, 'best_valid_valid/acc_unbiased': 74.156, 'best_valid_valid/diff': 1.743, 'best_valid_valid/acc_skew': 74.269, 'best_valid_valid/acc_align': 74.042, 'best_valid_test/acc': 74.093, 'best_valid_test/acc_unbiased': 73.544, 'best_valid_test/diff': 3.351, 'best_valid_test/acc_skew': 71.868, 'best_valid_test/acc_align': 75.219}
[5 / 20] best test accuracy: 73.544 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 74.641, 'best_test_valid/acc_unbiased': 74.156, 'best_test_valid/diff': 1.743, 'best_test_valid/acc_skew': 74.269, 'best_test_valid/acc_align': 74.042, 'best_test_test/acc': 74.093, 'best_test_test/acc_unbiased': 73.544, 'best_test_test/diff': 3.351, 'best_test_test/acc_skew': 71.868, 'best_test_test/acc_align': 75.219}
[6 / 20] Learning rate: 0.001 weight: 0.01
[6 / 20] Loss: 4.793244058879892 CE Loss: 0.5432311323516366 Con Loss: 4.7878117456617675
[6 / 20] tensor([[0.726, 0.672],
        [0.729, 0.820]]) {'epoch': 6, 'valid/acc': 73.502, 'valid/acc_unbiased': 73.763, 'valid/diff': 5.224, 'valid/acc_skew': 71.151, 'valid/acc_align': 76.375, 'test/acc': 73.797, 'test/acc_unbiased': 73.688, 'test/diff': 7.225, 'test/acc_skew': 70.076, 'test/acc_align': 77.301}
[6 / 20] best valid accuracy: 74.156 at epoch 4 
 best_stats: {'best_valid_epoch': 4, 'best_valid_valid/acc': 74.641, 'best_valid_valid/acc_unbiased': 74.156, 'best_valid_valid/diff': 1.743, 'best_valid_valid/acc_skew': 74.269, 'best_valid_valid/acc_align': 74.042, 'best_valid_test/acc': 74.093, 'best_valid_test/acc_unbiased': 73.544, 'best_valid_test/diff': 3.351, 'best_valid_test/acc_skew': 71.868, 'best_valid_test/acc_align': 75.219}
[6 / 20] best test accuracy: 73.688 at epoch 6 
 best_stats: {'best_test_epoch': 6, 'best_test_valid/acc': 73.502, 'best_test_valid/acc_unbiased': 73.763, 'best_test_valid/diff': 5.224, 'best_test_valid/acc_skew': 71.151, 'best_test_valid/acc_align': 76.375, 'best_test_test/acc': 73.797, 'best_test_test/acc_unbiased': 73.688, 'best_test_test/diff': 7.225, 'best_test_test/acc_skew': 70.076, 'best_test_test/acc_align': 77.301}
[7 / 20] Learning rate: 0.0001 weight: 0.01
[7 / 20] Loss: 4.760160548097043 CE Loss: 0.5056794620450384 Con Loss: 4.755103747282685
[7 / 20] tensor([[0.783, 0.734],
        [0.771, 0.814]]) {'epoch': 7, 'valid/acc': 77.004, 'valid/acc_unbiased': 77.106, 'valid/diff': 3.579, 'valid/acc_skew': 75.316, 'valid/acc_align': 78.896, 'test/acc': 77.553, 'test/acc_unbiased': 77.553, 'test/diff': 4.637, 'test/acc_skew': 75.234, 'test/acc_align': 79.871}
[7 / 20] best valid accuracy: 77.106 at epoch 7 
 best_stats: {'best_valid_epoch': 7, 'best_valid_valid/acc': 77.004, 'best_valid_valid/acc_unbiased': 77.106, 'best_valid_valid/diff': 3.579, 'best_valid_valid/acc_skew': 75.316, 'best_valid_valid/acc_align': 78.896, 'best_valid_test/acc': 77.553, 'best_valid_test/acc_unbiased': 77.553, 'best_valid_test/diff': 4.637, 'best_valid_test/acc_skew': 75.234, 'best_valid_test/acc_align': 79.871}
[7 / 20] best test accuracy: 77.553 at epoch 7 
 best_stats: {'best_test_epoch': 7, 'best_test_valid/acc': 77.004, 'best_test_valid/acc_unbiased': 77.106, 'best_test_valid/diff': 3.579, 'best_test_valid/acc_skew': 75.316, 'best_test_valid/acc_align': 78.896, 'best_test_test/acc': 77.553, 'best_test_test/acc_unbiased': 77.553, 'best_test_test/diff': 4.637, 'best_test_test/acc_skew': 75.234, 'best_test_test/acc_align': 79.871}
[8 / 20] Learning rate: 0.0001 weight: 0.01
[8 / 20] Loss: 4.742101003973585 CE Loss: 0.48897248327644816 Con Loss: 4.737211283967226
[8 / 20] tensor([[0.819, 0.746],
        [0.764, 0.811]]) {'epoch': 8, 'valid/acc': 77.764, 'valid/acc_unbiased': 77.73, 'valid/diff': 2.924, 'valid/acc_skew': 76.268, 'valid/acc_align': 79.193, 'test/acc': 78.523, 'test/acc_unbiased': 78.507, 'test/diff': 6.014, 'test/acc_skew': 75.5, 'test/acc_align': 81.514}
[8 / 20] best valid accuracy: 77.730 at epoch 8 
 best_stats: {'best_valid_epoch': 8, 'best_valid_valid/acc': 77.764, 'best_valid_valid/acc_unbiased': 77.73, 'best_valid_valid/diff': 2.924, 'best_valid_valid/acc_skew': 76.268, 'best_valid_valid/acc_align': 79.193, 'best_valid_test/acc': 78.523, 'best_valid_test/acc_unbiased': 78.507, 'best_valid_test/diff': 6.014, 'best_valid_test/acc_skew': 75.5, 'best_valid_test/acc_align': 81.514}
[8 / 20] best test accuracy: 78.507 at epoch 8 
 best_stats: {'best_test_epoch': 8, 'best_test_valid/acc': 77.764, 'best_test_valid/acc_unbiased': 77.73, 'best_test_valid/diff': 2.924, 'best_test_valid/acc_skew': 76.268, 'best_test_valid/acc_align': 79.193, 'best_test_test/acc': 78.523, 'best_test_test/acc_unbiased': 78.507, 'best_test_test/diff': 6.014, 'best_test_test/acc_skew': 75.5, 'best_test_test/acc_align': 81.514}
[9 / 20] Learning rate: 0.0001 weight: 0.01
[9 / 20] Loss: 4.724176468297642 CE Loss: 0.47207202067486886 Con Loss: 4.719455749712786
[9 / 20] tensor([[0.808, 0.736],
        [0.777, 0.840]]) {'epoch': 9, 'valid/acc': 77.722, 'valid/acc_unbiased': 77.794, 'valid/diff': 5.174, 'valid/acc_skew': 75.207, 'valid/acc_align': 80.381, 'test/acc': 79.03, 'test/acc_unbiased': 79.011, 'test/diff': 6.756, 'test/acc_skew': 75.633, 'test/acc_align': 82.388}
[9 / 20] best valid accuracy: 77.794 at epoch 9 
 best_stats: {'best_valid_epoch': 9, 'best_valid_valid/acc': 77.722, 'best_valid_valid/acc_unbiased': 77.794, 'best_valid_valid/diff': 5.174, 'best_valid_valid/acc_skew': 75.207, 'best_valid_valid/acc_align': 80.381, 'best_valid_test/acc': 79.03, 'best_valid_test/acc_unbiased': 79.011, 'best_valid_test/diff': 6.756, 'best_valid_test/acc_skew': 75.633, 'best_valid_test/acc_align': 82.388}
[9 / 20] best test accuracy: 79.011 at epoch 9 
 best_stats: {'best_test_epoch': 9, 'best_test_valid/acc': 77.722, 'best_test_valid/acc_unbiased': 77.794, 'best_test_valid/diff': 5.174, 'best_test_valid/acc_skew': 75.207, 'best_test_valid/acc_align': 80.381, 'best_test_test/acc': 79.03, 'best_test_test/acc_unbiased': 79.011, 'best_test_test/diff': 6.756, 'best_test_test/acc_skew': 75.633, 'best_test_test/acc_align': 82.388}
[10 / 20] Learning rate: 0.0001 weight: 0.01
[10 / 20] Loss: 4.717801956969858 CE Loss: 0.46108014656893503 Con Loss: 4.713191176228782
[10 / 20] tensor([[0.772, 0.693],
        [0.799, 0.856]]) {'epoch': 10, 'valid/acc': 77.131, 'valid/acc_unbiased': 77.515, 'valid/diff': 6.012, 'valid/acc_skew': 74.509, 'valid/acc_align': 80.521, 'test/acc': 77.848, 'test/acc_unbiased': 77.993, 'test/diff': 6.84, 'test/acc_skew': 74.573, 'test/acc_align': 81.414}
[10 / 20] best valid accuracy: 77.794 at epoch 9 
 best_stats: {'best_valid_epoch': 9, 'best_valid_valid/acc': 77.722, 'best_valid_valid/acc_unbiased': 77.794, 'best_valid_valid/diff': 5.174, 'best_valid_valid/acc_skew': 75.207, 'best_valid_valid/acc_align': 80.381, 'best_valid_test/acc': 79.03, 'best_valid_test/acc_unbiased': 79.011, 'best_valid_test/diff': 6.756, 'best_valid_test/acc_skew': 75.633, 'best_valid_test/acc_align': 82.388}
[10 / 20] best test accuracy: 79.011 at epoch 9 
 best_stats: {'best_test_epoch': 9, 'best_test_valid/acc': 77.722, 'best_test_valid/acc_unbiased': 77.794, 'best_test_valid/diff': 5.174, 'best_test_valid/acc_skew': 75.207, 'best_test_valid/acc_align': 80.381, 'best_test_test/acc': 79.03, 'best_test_test/acc_unbiased': 79.011, 'best_test_test/diff': 6.756, 'best_test_test/acc_skew': 75.633, 'best_test_test/acc_align': 82.388}
[11 / 20] Learning rate: 0.0001 weight: 0.01
[11 / 20] Loss: 4.702738768883366 CE Loss: 0.4609664881037409 Con Loss: 4.698129110769157
[11 / 20] tensor([[0.787, 0.733],
        [0.797, 0.826]]) {'epoch': 11, 'valid/acc': 78.27, 'valid/acc_unbiased': 78.56, 'valid/diff': 3.863, 'valid/acc_skew': 76.629, 'valid/acc_align': 80.492, 'test/acc': 78.439, 'test/acc_unbiased': 78.552, 'test/diff': 4.185, 'test/acc_skew': 76.459, 'test/acc_align': 80.644}
[11 / 20] best valid accuracy: 78.560 at epoch 11 
 best_stats: {'best_valid_epoch': 11, 'best_valid_valid/acc': 78.27, 'best_valid_valid/acc_unbiased': 78.56, 'best_valid_valid/diff': 3.863, 'best_valid_valid/acc_skew': 76.629, 'best_valid_valid/acc_align': 80.492, 'best_valid_test/acc': 78.439, 'best_valid_test/acc_unbiased': 78.552, 'best_valid_test/diff': 4.185, 'best_valid_test/acc_skew': 76.459, 'best_valid_test/acc_align': 80.644}
[11 / 20] best test accuracy: 79.011 at epoch 9 
 best_stats: {'best_test_epoch': 9, 'best_test_valid/acc': 77.722, 'best_test_valid/acc_unbiased': 77.794, 'best_test_valid/diff': 5.174, 'best_test_valid/acc_skew': 75.207, 'best_test_valid/acc_align': 80.381, 'best_test_test/acc': 79.03, 'best_test_test/acc_unbiased': 79.011, 'best_test_test/diff': 6.756, 'best_test_test/acc_skew': 75.633, 'best_test_test/acc_align': 82.388}
[12 / 20] Learning rate: 0.0001 weight: 0.01
[12 / 20] Loss: 4.709797988349837 CE Loss: 0.461395078836388 Con Loss: 4.705184032417844
[12 / 20] tensor([[0.785, 0.742],
        [0.812, 0.844]]) {'epoch': 12, 'valid/acc': 79.241, 'valid/acc_unbiased': 79.654, 'valid/diff': 3.496, 'valid/acc_skew': 77.905, 'valid/acc_align': 81.402, 'test/acc': 79.451, 'test/acc_unbiased': 79.553, 'test/diff': 3.787, 'test/acc_skew': 77.66, 'test/acc_align': 81.446}
[12 / 20] best valid accuracy: 79.654 at epoch 12 
 best_stats: {'best_valid_epoch': 12, 'best_valid_valid/acc': 79.241, 'best_valid_valid/acc_unbiased': 79.654, 'best_valid_valid/diff': 3.496, 'best_valid_valid/acc_skew': 77.905, 'best_valid_valid/acc_align': 81.402, 'best_valid_test/acc': 79.451, 'best_valid_test/acc_unbiased': 79.553, 'best_valid_test/diff': 3.787, 'best_valid_test/acc_skew': 77.66, 'best_valid_test/acc_align': 81.446}
[12 / 20] best test accuracy: 79.553 at epoch 12 
 best_stats: {'best_test_epoch': 12, 'best_test_valid/acc': 79.241, 'best_test_valid/acc_unbiased': 79.654, 'best_test_valid/diff': 3.496, 'best_test_valid/acc_skew': 77.905, 'best_test_valid/acc_align': 81.402, 'best_test_test/acc': 79.451, 'best_test_test/acc_unbiased': 79.553, 'best_test_test/diff': 3.787, 'best_test_test/acc_skew': 77.66, 'best_test_test/acc_align': 81.446}
[13 / 20] Learning rate: 0.0001 weight: 0.01
[13 / 20] Loss: 4.696338423872762 CE Loss: 0.450679159138248 Con Loss: 4.691831630634179
[13 / 20] tensor([[0.760, 0.694],
        [0.823, 0.859]]) {'epoch': 13, 'valid/acc': 78.608, 'valid/acc_unbiased': 79.023, 'valid/diff': 3.698, 'valid/acc_skew': 77.174, 'valid/acc_align': 80.872, 'test/acc': 78.143, 'test/acc_unbiased': 78.386, 'test/diff': 5.097, 'test/acc_skew': 75.838, 'test/acc_align': 80.935}
[13 / 20] best valid accuracy: 79.654 at epoch 12 
 best_stats: {'best_valid_epoch': 12, 'best_valid_valid/acc': 79.241, 'best_valid_valid/acc_unbiased': 79.654, 'best_valid_valid/diff': 3.496, 'best_valid_valid/acc_skew': 77.905, 'best_valid_valid/acc_align': 81.402, 'best_valid_test/acc': 79.451, 'best_valid_test/acc_unbiased': 79.553, 'best_valid_test/diff': 3.787, 'best_valid_test/acc_skew': 77.66, 'best_valid_test/acc_align': 81.446}
[13 / 20] best test accuracy: 79.553 at epoch 12 
 best_stats: {'best_test_epoch': 12, 'best_test_valid/acc': 79.241, 'best_test_valid/acc_unbiased': 79.654, 'best_test_valid/diff': 3.496, 'best_test_valid/acc_skew': 77.905, 'best_test_valid/acc_align': 81.402, 'best_test_test/acc': 79.451, 'best_test_test/acc_unbiased': 79.553, 'best_test_test/diff': 3.787, 'best_test_test/acc_skew': 77.66, 'best_test_test/acc_align': 81.446}
[14 / 20] Learning rate: 1e-05 weight: 0.01
[14 / 20] Loss: 4.680942539589297 CE Loss: 0.43764230853292985 Con Loss: 4.676566116282741
[14 / 20] tensor([[0.792, 0.736],
        [0.807, 0.845]]) {'epoch': 14, 'valid/acc': 79.325, 'valid/acc_unbiased': 79.655, 'valid/diff': 4.008, 'valid/acc_skew': 77.651, 'valid/acc_align': 81.659, 'test/acc': 79.409, 'test/acc_unbiased': 79.514, 'test/diff': 4.731, 'test/acc_skew': 77.148, 'test/acc_align': 81.879}
[14 / 20] best valid accuracy: 79.655 at epoch 14 
 best_stats: {'best_valid_epoch': 14, 'best_valid_valid/acc': 79.325, 'best_valid_valid/acc_unbiased': 79.655, 'best_valid_valid/diff': 4.008, 'best_valid_valid/acc_skew': 77.651, 'best_valid_valid/acc_align': 81.659, 'best_valid_test/acc': 79.409, 'best_valid_test/acc_unbiased': 79.514, 'best_valid_test/diff': 4.731, 'best_valid_test/acc_skew': 77.148, 'best_valid_test/acc_align': 81.879}
[14 / 20] best test accuracy: 79.553 at epoch 12 
 best_stats: {'best_test_epoch': 12, 'best_test_valid/acc': 79.241, 'best_test_valid/acc_unbiased': 79.654, 'best_test_valid/diff': 3.496, 'best_test_valid/acc_skew': 77.905, 'best_test_valid/acc_align': 81.402, 'best_test_test/acc': 79.451, 'best_test_test/acc_unbiased': 79.553, 'best_test_test/diff': 3.787, 'best_test_test/acc_skew': 77.66, 'best_test_test/acc_align': 81.446}
[15 / 20] Learning rate: 1e-05 weight: 0.01
[15 / 20] Loss: 4.678601853494937 CE Loss: 0.4402722631680669 Con Loss: 4.674199115479499
[15 / 20] tensor([[0.794, 0.736],
        [0.803, 0.851]]) {'epoch': 15, 'valid/acc': 79.705, 'valid/acc_unbiased': 80.059, 'valid/diff': 4.161, 'valid/acc_skew': 77.979, 'valid/acc_align': 82.14, 'test/acc': 79.536, 'test/acc_unbiased': 79.599, 'test/diff': 5.334, 'test/acc_skew': 76.931, 'test/acc_align': 82.266}
[15 / 20] best valid accuracy: 80.059 at epoch 15 
 best_stats: {'best_valid_epoch': 15, 'best_valid_valid/acc': 79.705, 'best_valid_valid/acc_unbiased': 80.059, 'best_valid_valid/diff': 4.161, 'best_valid_valid/acc_skew': 77.979, 'best_valid_valid/acc_align': 82.14, 'best_valid_test/acc': 79.536, 'best_valid_test/acc_unbiased': 79.599, 'best_valid_test/diff': 5.334, 'best_valid_test/acc_skew': 76.931, 'best_valid_test/acc_align': 82.266}
[15 / 20] best test accuracy: 79.599 at epoch 15 
 best_stats: {'best_test_epoch': 15, 'best_test_valid/acc': 79.705, 'best_test_valid/acc_unbiased': 80.059, 'best_test_valid/diff': 4.161, 'best_test_valid/acc_skew': 77.979, 'best_test_valid/acc_align': 82.14, 'best_test_test/acc': 79.536, 'best_test_test/acc_unbiased': 79.599, 'best_test_test/diff': 5.334, 'best_test_test/acc_skew': 76.931, 'best_test_test/acc_align': 82.266}
[16 / 20] Learning rate: 1e-05 weight: 0.01
[16 / 20] Loss: 4.684268204394406 CE Loss: 0.43600888447740593 Con Loss: 4.6799081296906815
[16 / 20] tensor([[0.778, 0.721],
        [0.814, 0.863]]) {'epoch': 16, 'valid/acc': 78.945, 'valid/acc_unbiased': 79.36, 'valid/diff': 3.64, 'valid/acc_skew': 77.54, 'valid/acc_align': 81.18, 'test/acc': 79.283, 'test/acc_unbiased': 79.394, 'test/diff': 5.32, 'test/acc_skew': 76.734, 'test/acc_align': 82.054}
[16 / 20] best valid accuracy: 80.059 at epoch 15 
 best_stats: {'best_valid_epoch': 15, 'best_valid_valid/acc': 79.705, 'best_valid_valid/acc_unbiased': 80.059, 'best_valid_valid/diff': 4.161, 'best_valid_valid/acc_skew': 77.979, 'best_valid_valid/acc_align': 82.14, 'best_valid_test/acc': 79.536, 'best_valid_test/acc_unbiased': 79.599, 'best_valid_test/diff': 5.334, 'best_valid_test/acc_skew': 76.931, 'best_valid_test/acc_align': 82.266}
[16 / 20] best test accuracy: 79.599 at epoch 15 
 best_stats: {'best_test_epoch': 15, 'best_test_valid/acc': 79.705, 'best_test_valid/acc_unbiased': 80.059, 'best_test_valid/diff': 4.161, 'best_test_valid/acc_skew': 77.979, 'best_test_valid/acc_align': 82.14, 'best_test_test/acc': 79.536, 'best_test_test/acc_unbiased': 79.599, 'best_test_test/diff': 5.334, 'best_test_test/acc_skew': 76.931, 'best_test_test/acc_align': 82.266}
[17 / 20] Learning rate: 1e-05 weight: 0.01
[17 / 20] Loss: 4.677262470977023 CE Loss: 0.43341653068627656 Con Loss: 4.672928311639788
[17 / 20] tensor([[0.776, 0.719],
        [0.823, 0.869]]) {'epoch': 17, 'valid/acc': 79.072, 'valid/acc_unbiased': 79.536, 'valid/diff': 3.409, 'valid/acc_skew': 77.831, 'valid/acc_align': 81.241, 'test/acc': 79.536, 'test/acc_unbiased': 79.677, 'test/diff': 5.168, 'test/acc_skew': 77.093, 'test/acc_align': 82.261}
[17 / 20] best valid accuracy: 80.059 at epoch 15 
 best_stats: {'best_valid_epoch': 15, 'best_valid_valid/acc': 79.705, 'best_valid_valid/acc_unbiased': 80.059, 'best_valid_valid/diff': 4.161, 'best_valid_valid/acc_skew': 77.979, 'best_valid_valid/acc_align': 82.14, 'best_valid_test/acc': 79.536, 'best_valid_test/acc_unbiased': 79.599, 'best_valid_test/diff': 5.334, 'best_valid_test/acc_skew': 76.931, 'best_valid_test/acc_align': 82.266}
[17 / 20] best test accuracy: 79.677 at epoch 17 
 best_stats: {'best_test_epoch': 17, 'best_test_valid/acc': 79.072, 'best_test_valid/acc_unbiased': 79.536, 'best_test_valid/diff': 3.409, 'best_test_valid/acc_skew': 77.831, 'best_test_valid/acc_align': 81.241, 'best_test_test/acc': 79.536, 'best_test_test/acc_unbiased': 79.677, 'best_test_test/diff': 5.168, 'best_test_test/acc_skew': 77.093, 'best_test_test/acc_align': 82.261}
[18 / 20] Learning rate: 1e-05 weight: 0.01
[18 / 20] Loss: 4.679822819822879 CE Loss: 0.4404825858804527 Con Loss: 4.675417976882064
[18 / 20] tensor([[0.781, 0.728],
        [0.820, 0.860]]) {'epoch': 18, 'valid/acc': 79.451, 'valid/acc_unbiased': 79.858, 'valid/diff': 3.468, 'valid/acc_skew': 78.124, 'valid/acc_align': 81.592, 'test/acc': 79.62, 'test/acc_unbiased': 79.756, 'test/diff': 4.656, 'test/acc_skew': 77.428, 'test/acc_align': 82.084}
[18 / 20] best valid accuracy: 80.059 at epoch 15 
 best_stats: {'best_valid_epoch': 15, 'best_valid_valid/acc': 79.705, 'best_valid_valid/acc_unbiased': 80.059, 'best_valid_valid/diff': 4.161, 'best_valid_valid/acc_skew': 77.979, 'best_valid_valid/acc_align': 82.14, 'best_valid_test/acc': 79.536, 'best_valid_test/acc_unbiased': 79.599, 'best_valid_test/diff': 5.334, 'best_valid_test/acc_skew': 76.931, 'best_valid_test/acc_align': 82.266}
[18 / 20] best test accuracy: 79.756 at epoch 18 
 best_stats: {'best_test_epoch': 18, 'best_test_valid/acc': 79.451, 'best_test_valid/acc_unbiased': 79.858, 'best_test_valid/diff': 3.468, 'best_test_valid/acc_skew': 78.124, 'best_test_valid/acc_align': 81.592, 'best_test_test/acc': 79.62, 'best_test_test/acc_unbiased': 79.756, 'best_test_test/diff': 4.656, 'best_test_test/acc_skew': 77.428, 'best_test_test/acc_align': 82.084}
[19 / 20] Learning rate: 1e-05 weight: 0.01
[19 / 20] Loss: 4.67035878280595 CE Loss: 0.4387074558399781 Con Loss: 4.66597169175155
[19 / 20] tensor([[0.780, 0.724],
        [0.823, 0.865]]) {'epoch': 19, 'valid/acc': 79.662, 'valid/acc_unbiased': 80.098, 'valid/diff': 3.657, 'valid/acc_skew': 78.27, 'valid/acc_align': 81.927, 'test/acc': 79.62, 'test/acc_unbiased': 79.766, 'test/diff': 4.903, 'test/acc_skew': 77.315, 'test/acc_align': 82.218}
[19 / 20] best valid accuracy: 80.098 at epoch 19 
 best_stats: {'best_valid_epoch': 19, 'best_valid_valid/acc': 79.662, 'best_valid_valid/acc_unbiased': 80.098, 'best_valid_valid/diff': 3.657, 'best_valid_valid/acc_skew': 78.27, 'best_valid_valid/acc_align': 81.927, 'best_valid_test/acc': 79.62, 'best_valid_test/acc_unbiased': 79.766, 'best_valid_test/diff': 4.903, 'best_valid_test/acc_skew': 77.315, 'best_valid_test/acc_align': 82.218}
[19 / 20] best test accuracy: 79.766 at epoch 19 
 best_stats: {'best_test_epoch': 19, 'best_test_valid/acc': 79.662, 'best_test_valid/acc_unbiased': 80.098, 'best_test_valid/diff': 3.657, 'best_test_valid/acc_skew': 78.27, 'best_test_valid/acc_align': 81.927, 'best_test_test/acc': 79.62, 'best_test_test/acc_unbiased': 79.766, 'best_test_test/diff': 4.903, 'best_test_test/acc_skew': 77.315, 'best_test_test/acc_align': 82.218}
[20 / 20] Learning rate: 1e-05 weight: 0.01
[20 / 20] Loss: 4.677613064973979 CE Loss: 0.4358075663425563 Con Loss: 4.673254980698861
[20 / 20] tensor([[0.776, 0.721],
        [0.825, 0.868]]) {'epoch': 20, 'valid/acc': 79.325, 'valid/acc_unbiased': 79.795, 'valid/diff': 3.561, 'valid/acc_skew': 78.014, 'valid/acc_align': 81.575, 'test/acc': 79.578, 'test/acc_unbiased': 79.731, 'test/diff': 4.912, 'test/acc_skew': 77.275, 'test/acc_align': 82.187}
[20 / 20] best valid accuracy: 80.098 at epoch 19 
 best_stats: {'best_valid_epoch': 19, 'best_valid_valid/acc': 79.662, 'best_valid_valid/acc_unbiased': 80.098, 'best_valid_valid/diff': 3.657, 'best_valid_valid/acc_skew': 78.27, 'best_valid_valid/acc_align': 81.927, 'best_valid_test/acc': 79.62, 'best_valid_test/acc_unbiased': 79.766, 'best_valid_test/diff': 4.903, 'best_valid_test/acc_skew': 77.315, 'best_valid_test/acc_align': 82.218}
[20 / 20] best test accuracy: 79.766 at epoch 19 
 best_stats: {'best_test_epoch': 19, 'best_test_valid/acc': 79.662, 'best_test_valid/acc_unbiased': 80.098, 'best_test_valid/diff': 3.657, 'best_test_valid/acc_skew': 78.27, 'best_test_valid/acc_align': 81.927, 'best_test_test/acc': 79.62, 'best_test_test/acc_unbiased': 79.766, 'best_test_test/diff': 4.903, 'best_test_test/acc_skew': 77.315, 'best_test_test/acc_align': 82.218}
Total training time: 0:12:34
