Log level set to: INFO
Set seed: 3
=======> Using Fixed Random Seed: 3 <========
save_path: exp_results/bc-bb0-celeba_blonde-os_0.2-lr0.001-bs128-cbs64-w0.01-ratio30-aug1-seed3
get_celeba - split:train, aug: False, given_y: True, ratio: 0
use existing blonde indices from data/celeba/pickles/blonde
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [10697, 10697]
Target 1: [10697, 10697]
Binary Target 1
---------------------------
Target 0: [10697, 10697]
Target 1: [10697, 10697]
===================================
Normal Label Distribution: 
Target 0: [10697, 10697]
Target 1: [10697, 10697]
===================================
Use BiasedCelebASplit 
 target_attr: blonde split: train 
 tensor([[10697., 10697.],
        [10697., 10697.]])
get_celeba - split:train, aug: 1, given_y: True, ratio: 30
use existing blonde indices from data/celeba/pickles/blonde
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [10701, 10701]
Target 1: [10701, 10701]
Binary Target 1
---------------------------
Target 0: [10701, 10701]
Target 1: [10701, 10701]
===================================
Normal Label Distribution: 
Target 0: [10701, 10701]
Target 1: [10701, 10701]
===================================
Use BiasedCelebASplit 
 target_attr: blonde split: train 
 tensor([[10701., 10701.],
        [10701., 10701.]])
get_celeba - split:train_valid, aug: False, given_y: True, ratio: 0
use existing blonde indices from data/celeba/pickles/blonde
Use BiasedCelebASplit 
 target_attr: blonde split: train_valid 
 tensor([[  386.,  4517.],
        [13446.,   280.]])
get_celeba - split:valid, aug: False, given_y: True, ratio: 0
Use BiasedCelebASplit 
 target_attr: blonde split: valid 
 tensor([[8535., 2874.],
        [8276.,  182.]])
decay_epochs: [3, 6]
[1 / 10] Learning rate: 0.001 weight: 0.01
[1 / 10] Loss: 4.670696343106957 CE Loss: 0.2898028417676478 Con Loss: 4.66779832286323
[1 / 10] tensor([[0.938, 0.960],
        [0.797, 0.742]]) {'epoch': 1, 'valid/acc': 91.234, 'valid/acc_unbiased': 86.381, 'valid/diff': 4.88, 'valid/acc_skew': 88.821, 'valid/acc_align': 83.941, 'test/acc': 92.525, 'test/acc_unbiased': 85.938, 'test/diff': 3.863, 'test/acc_skew': 86.776, 'test/acc_align': 85.1}
[1 / 10] best valid accuracy: 86.381 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 91.234, 'best_valid_valid/acc_unbiased': 86.381, 'best_valid_valid/diff': 4.88, 'best_valid_valid/acc_skew': 88.821, 'best_valid_valid/acc_align': 83.941, 'best_valid_test/acc': 92.525, 'best_valid_test/acc_unbiased': 85.938, 'best_valid_test/diff': 3.863, 'best_valid_test/acc_skew': 86.776, 'best_valid_test/acc_align': 85.1}
[1 / 10] best test accuracy: 85.938 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 91.234, 'best_test_valid/acc_unbiased': 86.381, 'best_test_valid/diff': 4.88, 'best_test_valid/acc_skew': 88.821, 'best_test_valid/acc_align': 83.941, 'best_test_test/acc': 92.525, 'best_test_test/acc_unbiased': 85.938, 'best_test_test/diff': 3.863, 'best_test_test/acc_skew': 86.776, 'best_test_test/acc_align': 85.1}
[2 / 10] Learning rate: 0.001 weight: 0.01
[2 / 10] Loss: 4.610350884844725 CE Loss: 0.2421983008943251 Con Loss: 4.607928908873108
[2 / 10] tensor([[0.763, 0.874],
        [0.979, 0.923]]) {'epoch': 2, 'valid/acc': 89.849, 'valid/acc_unbiased': 90.634, 'valid/diff': 3.661, 'valid/acc_skew': 90.633, 'valid/acc_align': 90.635, 'test/acc': 84.205, 'test/acc_unbiased': 88.479, 'test/diff': 8.317, 'test/acc_skew': 87.105, 'test/acc_align': 89.852}
[2 / 10] best valid accuracy: 90.634 at epoch 2 
 best_stats: {'best_valid_epoch': 2, 'best_valid_valid/acc': 89.849, 'best_valid_valid/acc_unbiased': 90.634, 'best_valid_valid/diff': 3.661, 'best_valid_valid/acc_skew': 90.633, 'best_valid_valid/acc_align': 90.635, 'best_valid_test/acc': 84.205, 'best_valid_test/acc_unbiased': 88.479, 'best_valid_test/diff': 8.317, 'best_valid_test/acc_skew': 87.105, 'best_valid_test/acc_align': 89.852}
[2 / 10] best test accuracy: 88.479 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 89.849, 'best_test_valid/acc_unbiased': 90.634, 'best_test_valid/diff': 3.661, 'best_test_valid/acc_skew': 90.633, 'best_test_valid/acc_align': 90.635, 'best_test_test/acc': 84.205, 'best_test_test/acc_unbiased': 88.479, 'best_test_test/diff': 8.317, 'best_test_test/acc_skew': 87.105, 'best_test_test/acc_align': 89.852}
[3 / 10] Learning rate: 0.001 weight: 0.01
[3 / 10] Loss: 4.599260295786968 CE Loss: 0.2258533050331477 Con Loss: 4.5970017632959355
[3 / 10] tensor([[0.858, 0.910],
        [0.951, 0.951]]) {'epoch': 3, 'valid/acc': 92.34, 'valid/acc_unbiased': 92.76, 'valid/diff': 2.272, 'valid/acc_skew': 93.896, 'valid/acc_align': 91.624, 'test/acc': 89.41, 'test/acc_unbiased': 91.746, 'test/diff': 2.637, 'test/acc_skew': 90.447, 'test/acc_align': 93.045}
[3 / 10] best valid accuracy: 92.760 at epoch 3 
 best_stats: {'best_valid_epoch': 3, 'best_valid_valid/acc': 92.34, 'best_valid_valid/acc_unbiased': 92.76, 'best_valid_valid/diff': 2.272, 'best_valid_valid/acc_skew': 93.896, 'best_valid_valid/acc_align': 91.624, 'best_valid_test/acc': 89.41, 'best_valid_test/acc_unbiased': 91.746, 'best_valid_test/diff': 2.637, 'best_valid_test/acc_skew': 90.447, 'best_valid_test/acc_align': 93.045}
[3 / 10] best test accuracy: 91.746 at epoch 3 
 best_stats: {'best_test_epoch': 3, 'best_test_valid/acc': 92.34, 'best_test_valid/acc_unbiased': 92.76, 'best_test_valid/diff': 2.272, 'best_test_valid/acc_skew': 93.896, 'best_test_valid/acc_align': 91.624, 'best_test_test/acc': 89.41, 'best_test_test/acc_unbiased': 91.746, 'best_test_test/diff': 2.637, 'best_test_test/acc_skew': 90.447, 'best_test_test/acc_align': 93.045}
[4 / 10] Learning rate: 0.0001 weight: 0.01
[4 / 10] Loss: 4.5336554286033515 CE Loss: 0.19147200290261 Con Loss: 4.5317407101908165
[4 / 10] tensor([[0.865, 0.940],
        [0.955, 0.918]]) {'epoch': 4, 'valid/acc': 93.617, 'valid/acc_unbiased': 93.767, 'valid/diff': 0.958, 'valid/acc_skew': 94.244, 'valid/acc_align': 93.29, 'test/acc': 90.97, 'test/acc_unbiased': 91.939, 'test/diff': 5.605, 'test/acc_skew': 91.013, 'test/acc_align': 92.864}
[4 / 10] best valid accuracy: 93.767 at epoch 4 
 best_stats: {'best_valid_epoch': 4, 'best_valid_valid/acc': 93.617, 'best_valid_valid/acc_unbiased': 93.767, 'best_valid_valid/diff': 0.958, 'best_valid_valid/acc_skew': 94.244, 'best_valid_valid/acc_align': 93.29, 'best_valid_test/acc': 90.97, 'best_valid_test/acc_unbiased': 91.939, 'best_valid_test/diff': 5.605, 'best_valid_test/acc_skew': 91.013, 'best_valid_test/acc_align': 92.864}
[4 / 10] best test accuracy: 91.939 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 93.617, 'best_test_valid/acc_unbiased': 93.767, 'best_test_valid/diff': 0.958, 'best_test_valid/acc_skew': 94.244, 'best_test_valid/acc_align': 93.29, 'best_test_test/acc': 90.97, 'best_test_test/acc_unbiased': 91.939, 'best_test_test/diff': 5.605, 'best_test_test/acc_skew': 91.013, 'best_test_test/acc_align': 92.864}
[5 / 10] Learning rate: 0.0001 weight: 0.01
[5 / 10] Loss: 4.4994785497040795 CE Loss: 0.17964370645122282 Con Loss: 4.497682118155058
[5 / 10] tensor([[0.899, 0.935],
        [0.928, 0.934]]) {'epoch': 5, 'valid/acc': 93.231, 'valid/acc_unbiased': 94.385, 'valid/diff': 2.343, 'valid/acc_skew': 94.736, 'valid/acc_align': 94.034, 'test/acc': 91.836, 'test/acc_unbiased': 92.398, 'test/diff': 2.062, 'test/acc_skew': 91.366, 'test/acc_align': 93.429}
[5 / 10] best valid accuracy: 94.385 at epoch 5 
 best_stats: {'best_valid_epoch': 5, 'best_valid_valid/acc': 93.231, 'best_valid_valid/acc_unbiased': 94.385, 'best_valid_valid/diff': 2.343, 'best_valid_valid/acc_skew': 94.736, 'best_valid_valid/acc_align': 94.034, 'best_valid_test/acc': 91.836, 'best_valid_test/acc_unbiased': 92.398, 'best_valid_test/diff': 2.062, 'best_valid_test/acc_skew': 91.366, 'best_valid_test/acc_align': 93.429}
[5 / 10] best test accuracy: 92.398 at epoch 5 
 best_stats: {'best_test_epoch': 5, 'best_test_valid/acc': 93.231, 'best_test_valid/acc_unbiased': 94.385, 'best_test_valid/diff': 2.343, 'best_test_valid/acc_skew': 94.736, 'best_test_valid/acc_align': 94.034, 'best_test_test/acc': 91.836, 'best_test_test/acc_unbiased': 92.398, 'best_test_test/diff': 2.062, 'best_test_test/acc_skew': 91.366, 'best_test_test/acc_align': 93.429}
[6 / 10] Learning rate: 0.0001 weight: 0.01
[6 / 10] Loss: 4.4917105579527785 CE Loss: 0.17052932255366388 Con Loss: 4.49000527625375
[6 / 10] tensor([[0.895, 0.954],
        [0.930, 0.874]]) {'epoch': 6, 'valid/acc': 94.471, 'valid/acc_unbiased': 94.378, 'valid/diff': 3.039, 'valid/acc_skew': 95.898, 'valid/acc_align': 92.858, 'test/acc': 92.455, 'test/acc_unbiased': 91.328, 'test/diff': 5.78, 'test/acc_skew': 91.277, 'test/acc_align': 91.379}
[6 / 10] best valid accuracy: 94.385 at epoch 5 
 best_stats: {'best_valid_epoch': 5, 'best_valid_valid/acc': 93.231, 'best_valid_valid/acc_unbiased': 94.385, 'best_valid_valid/diff': 2.343, 'best_valid_valid/acc_skew': 94.736, 'best_valid_valid/acc_align': 94.034, 'best_valid_test/acc': 91.836, 'best_valid_test/acc_unbiased': 92.398, 'best_valid_test/diff': 2.062, 'best_valid_test/acc_skew': 91.366, 'best_valid_test/acc_align': 93.429}
[6 / 10] best test accuracy: 92.398 at epoch 5 
 best_stats: {'best_test_epoch': 5, 'best_test_valid/acc': 93.231, 'best_test_valid/acc_unbiased': 94.385, 'best_test_valid/diff': 2.343, 'best_test_valid/acc_skew': 94.736, 'best_test_valid/acc_align': 94.034, 'best_test_test/acc': 91.836, 'best_test_test/acc_unbiased': 92.398, 'best_test_test/diff': 2.062, 'best_test_test/acc_skew': 91.366, 'best_test_test/acc_align': 93.429}
[7 / 10] Learning rate: 1e-05 weight: 0.01
[7 / 10] Loss: 4.478223227402579 CE Loss: 0.16397518667593464 Con Loss: 4.476583481771072
[7 / 10] tensor([[0.869, 0.939],
        [0.953, 0.912]]) {'epoch': 7, 'valid/acc': 93.961, 'valid/acc_unbiased': 94.949, 'valid/diff': 2.38, 'valid/acc_skew': 96.139, 'valid/acc_align': 93.759, 'test/acc': 91.071, 'test/acc_unbiased': 91.822, 'test/diff': 5.522, 'test/acc_skew': 91.09, 'test/acc_align': 92.553}
[7 / 10] best valid accuracy: 94.949 at epoch 7 
 best_stats: {'best_valid_epoch': 7, 'best_valid_valid/acc': 93.961, 'best_valid_valid/acc_unbiased': 94.949, 'best_valid_valid/diff': 2.38, 'best_valid_valid/acc_skew': 96.139, 'best_valid_valid/acc_align': 93.759, 'best_valid_test/acc': 91.071, 'best_valid_test/acc_unbiased': 91.822, 'best_valid_test/diff': 5.522, 'best_valid_test/acc_skew': 91.09, 'best_valid_test/acc_align': 92.553}
[7 / 10] best test accuracy: 92.398 at epoch 5 
 best_stats: {'best_test_epoch': 5, 'best_test_valid/acc': 93.231, 'best_test_valid/acc_unbiased': 94.385, 'best_test_valid/diff': 2.343, 'best_test_valid/acc_skew': 94.736, 'best_test_valid/acc_align': 94.034, 'best_test_test/acc': 91.836, 'best_test_test/acc_unbiased': 92.398, 'best_test_test/diff': 2.062, 'best_test_test/acc_skew': 91.366, 'best_test_test/acc_align': 93.429}
[8 / 10] Learning rate: 1e-05 weight: 0.01
[8 / 10] Loss: 4.484708414820407 CE Loss: 0.16151688874152326 Con Loss: 4.483093242327877
[8 / 10] tensor([[0.868, 0.942],
        [0.955, 0.923]]) {'epoch': 8, 'valid/acc': 94.031, 'valid/acc_unbiased': 95.186, 'valid/diff': 2.423, 'valid/acc_skew': 96.398, 'valid/acc_align': 93.975, 'test/acc': 91.161, 'test/acc_unbiased': 92.186, 'test/diff': 5.304, 'test/acc_skew': 91.136, 'test/acc_align': 93.236}
[8 / 10] best valid accuracy: 95.186 at epoch 8 
 best_stats: {'best_valid_epoch': 8, 'best_valid_valid/acc': 94.031, 'best_valid_valid/acc_unbiased': 95.186, 'best_valid_valid/diff': 2.423, 'best_valid_valid/acc_skew': 96.398, 'best_valid_valid/acc_align': 93.975, 'best_valid_test/acc': 91.161, 'best_valid_test/acc_unbiased': 92.186, 'best_valid_test/diff': 5.304, 'best_valid_test/acc_skew': 91.136, 'best_valid_test/acc_align': 93.236}
[8 / 10] best test accuracy: 92.398 at epoch 5 
 best_stats: {'best_test_epoch': 5, 'best_test_valid/acc': 93.231, 'best_test_valid/acc_unbiased': 94.385, 'best_test_valid/diff': 2.343, 'best_test_valid/acc_skew': 94.736, 'best_test_valid/acc_align': 94.034, 'best_test_test/acc': 91.836, 'best_test_test/acc_unbiased': 92.398, 'best_test_test/diff': 2.062, 'best_test_test/acc_skew': 91.366, 'best_test_test/acc_align': 93.429}
[9 / 10] Learning rate: 1e-05 weight: 0.01
[9 / 10] Loss: 4.482499965699106 CE Loss: 0.15985311985272185 Con Loss: 4.480901436593094
[9 / 10] tensor([[0.862, 0.940],
        [0.953, 0.918]]) {'epoch': 9, 'valid/acc': 93.945, 'valid/acc_unbiased': 95.097, 'valid/diff': 2.364, 'valid/acc_skew': 96.279, 'valid/acc_align': 93.915, 'test/acc': 90.814, 'test/acc_unbiased': 91.813, 'test/diff': 5.659, 'test/acc_skew': 90.756, 'test/acc_align': 92.87}
[9 / 10] best valid accuracy: 95.186 at epoch 8 
 best_stats: {'best_valid_epoch': 8, 'best_valid_valid/acc': 94.031, 'best_valid_valid/acc_unbiased': 95.186, 'best_valid_valid/diff': 2.423, 'best_valid_valid/acc_skew': 96.398, 'best_valid_valid/acc_align': 93.975, 'best_valid_test/acc': 91.161, 'best_valid_test/acc_unbiased': 92.186, 'best_valid_test/diff': 5.304, 'best_valid_test/acc_skew': 91.136, 'best_valid_test/acc_align': 93.236}
[9 / 10] best test accuracy: 92.398 at epoch 5 
 best_stats: {'best_test_epoch': 5, 'best_test_valid/acc': 93.231, 'best_test_valid/acc_unbiased': 94.385, 'best_test_valid/diff': 2.343, 'best_test_valid/acc_skew': 94.736, 'best_test_valid/acc_align': 94.034, 'best_test_test/acc': 91.836, 'best_test_test/acc_unbiased': 92.398, 'best_test_test/diff': 2.062, 'best_test_test/acc_skew': 91.366, 'best_test_test/acc_align': 93.429}
[10 / 10] Learning rate: 1e-05 weight: 0.01
[10 / 10] Loss: 4.468911877500462 CE Loss: 0.1598731884000635 Con Loss: 4.4673131436535805
[10 / 10] tensor([[0.862, 0.941],
        [0.954, 0.890]]) {'epoch': 10, 'valid/acc': 94.095, 'valid/acc_unbiased': 95.149, 'valid/diff': 2.26, 'valid/acc_skew': 96.279, 'valid/acc_align': 94.019, 'test/acc': 90.859, 'test/acc_unbiased': 91.186, 'test/diff': 7.139, 'test/acc_skew': 90.814, 'test/acc_align': 91.557}
[10 / 10] best valid accuracy: 95.186 at epoch 8 
 best_stats: {'best_valid_epoch': 8, 'best_valid_valid/acc': 94.031, 'best_valid_valid/acc_unbiased': 95.186, 'best_valid_valid/diff': 2.423, 'best_valid_valid/acc_skew': 96.398, 'best_valid_valid/acc_align': 93.975, 'best_valid_test/acc': 91.161, 'best_valid_test/acc_unbiased': 92.186, 'best_valid_test/diff': 5.304, 'best_valid_test/acc_skew': 91.136, 'best_valid_test/acc_align': 93.236}
[10 / 10] best test accuracy: 92.398 at epoch 5 
 best_stats: {'best_test_epoch': 5, 'best_test_valid/acc': 93.231, 'best_test_valid/acc_unbiased': 94.385, 'best_test_valid/diff': 2.343, 'best_test_valid/acc_skew': 94.736, 'best_test_valid/acc_align': 94.034, 'best_test_test/acc': 91.836, 'best_test_test/acc_unbiased': 92.398, 'best_test_test/diff': 2.062, 'best_test_test/acc_skew': 91.366, 'best_test_test/acc_align': 93.429}
Total training time: 0:42:40
