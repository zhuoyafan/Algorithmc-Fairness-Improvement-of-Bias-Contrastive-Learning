Log level set to: INFO
Set seed: 2
=======> Using Fixed Random Seed: 2 <========
save_path: exp_results/bc-bb0-utk_face_age-us-0.4-lr0.001-bs128-cbs64-w0.01-ratio10-aug1-seed2
get_utk_face - split: train, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_age-0.4
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [8237, 886]
Target 1: [4942, 1477]
Binary Target 1
---------------------------
Target 0: [8237, 886]
Target 1: [4942, 1477]
===================================
Normal Label Distribution: 
Target 0: [8237, 886]
Target 1: [4942, 1477]
===================================
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [886, 886]
Target 1: [886, 886]
Binary Target 1
---------------------------
Target 0: [886, 886]
Target 1: [886, 886]
===================================
Normal Label Distribution: 
Target 0: [886, 886]
Target 1: [886, 886]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 3544, target_attr: gender, bias_attr: age bias_rate: 0.4
['[train] target_0-bias_0: 886', '[train] target_0-bias_1: 886', '[train] target_1-bias_0: 886', '[train] target_1-bias_1: 886']
confusion_matrix - 
 original: tensor([[886., 886.],
        [886., 886.]]), 
 normalized: tensor([[0.500, 0.500],
        [0.500, 0.500]]), 
 b|y: tensor([[0.500, 0.500],
        [0.500, 0.500]])
get_utk_face - split: train, aug: 1, given_y: True, ratio: 10
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_age-0.4
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [8237, 886]
Target 1: [4942, 1477]
Binary Target 1
---------------------------
Target 0: [8237, 886]
Target 1: [4942, 1477]
===================================
Normal Label Distribution: 
Target 0: [8237, 886]
Target 1: [4942, 1477]
===================================
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [886, 886]
Target 1: [886, 886]
Binary Target 1
---------------------------
Target 0: [886, 886]
Target 1: [886, 886]
===================================
Normal Label Distribution: 
Target 0: [886, 886]
Target 1: [886, 886]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 3544, target_attr: gender, bias_attr: age bias_rate: 0.4
['[train] target_0-bias_0: 886', '[train] target_0-bias_1: 886', '[train] target_1-bias_0: 886', '[train] target_1-bias_1: 886']
get_utk_face - split: valid, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_age-0.4
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [1030, 195]
Target 1: [841, 202]
Binary Target 1
---------------------------
Target 0: [1030, 195]
Target 1: [841, 202]
===================================
Normal Label Distribution: 
Target 0: [1030, 195]
Target 1: [841, 202]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 2268, target_attr: gender, bias_attr: age bias_rate: 0.4
['[valid] target_0-bias_0: 1030', '[valid] target_0-bias_1: 195', '[valid] target_1-bias_0: 841', '[valid] target_1-bias_1: 202']
get_utk_face - split: test, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_age-0.4
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [1061, 176]
Target 1: [867, 165]
Binary Target 1
---------------------------
Target 0: [1061, 176]
Target 1: [867, 165]
===================================
Normal Label Distribution: 
Target 0: [1061, 176]
Target 1: [867, 165]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 2269, target_attr: gender, bias_attr: age bias_rate: 0.4
['[test] target_0-bias_0: 1061', '[test] target_0-bias_1: 176', '[test] target_1-bias_0: 867', '[test] target_1-bias_1: 165']
decay_epochs: [6, 13]
[1 / 20] Learning rate: 0.001 weight: 0.01
[1 / 20] Loss: 5.094105919650661 CE Loss: 0.7204962909625292 Con Loss: 5.0869009263359395
[1 / 20] tensor([[0.291, 0.256],
        [0.915, 0.933]]) {'epoch': 1, 'valid/acc': 57.099, 'valid/acc_unbiased': 57.17, 'valid/diff': 7.76, 'valid/acc_skew': 61.05, 'valid/acc_align': 53.29, 'test/acc': 57.338, 'test/acc_unbiased': 59.872, 'test/diff': 2.712, 'test/acc_skew': 60.294, 'test/acc_align': 59.451}
[1 / 20] best valid accuracy: 57.170 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 57.099, 'best_valid_valid/acc_unbiased': 57.17, 'best_valid_valid/diff': 7.76, 'best_valid_valid/acc_skew': 61.05, 'best_valid_valid/acc_align': 53.29, 'best_valid_test/acc': 57.338, 'best_valid_test/acc_unbiased': 59.872, 'best_valid_test/diff': 2.712, 'best_valid_test/acc_skew': 60.294, 'best_valid_test/acc_align': 59.451}
[1 / 20] best test accuracy: 59.872 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 57.099, 'best_test_valid/acc_unbiased': 57.17, 'best_test_valid/diff': 7.76, 'best_test_valid/acc_skew': 61.05, 'best_test_valid/acc_align': 53.29, 'best_test_test/acc': 57.338, 'best_test_test/acc_unbiased': 59.872, 'best_test_test/diff': 2.712, 'best_test_test/acc_skew': 60.294, 'best_test_test/acc_align': 59.451}
[2 / 20] Learning rate: 0.001 weight: 0.01
[2 / 20] Loss: 4.852985684543377 CE Loss: 0.6579196532477644 Con Loss: 4.8464064802596045
[2 / 20] tensor([[0.694, 0.699],
        [0.725, 0.570]]) {'epoch': 2, 'valid/acc': 71.914, 'valid/acc_unbiased': 69.535, 'valid/diff': 7.641, 'valid/acc_skew': 73.356, 'valid/acc_align': 65.715, 'test/acc': 69.722, 'test/acc_unbiased': 67.193, 'test/diff': 8.049, 'test/acc_skew': 70.959, 'test/acc_align': 63.428}
[2 / 20] best valid accuracy: 69.535 at epoch 2 
 best_stats: {'best_valid_epoch': 2, 'best_valid_valid/acc': 71.914, 'best_valid_valid/acc_unbiased': 69.535, 'best_valid_valid/diff': 7.641, 'best_valid_valid/acc_skew': 73.356, 'best_valid_valid/acc_align': 65.715, 'best_valid_test/acc': 69.722, 'best_valid_test/acc_unbiased': 67.193, 'best_valid_test/diff': 8.049, 'best_valid_test/acc_skew': 70.959, 'best_valid_test/acc_align': 63.428}
[2 / 20] best test accuracy: 67.193 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 71.914, 'best_test_valid/acc_unbiased': 69.535, 'best_test_valid/diff': 7.641, 'best_test_valid/acc_skew': 73.356, 'best_test_valid/acc_align': 65.715, 'best_test_test/acc': 69.722, 'best_test_test/acc_unbiased': 67.193, 'best_test_test/diff': 8.049, 'best_test_test/acc_skew': 70.959, 'best_test_test/acc_align': 63.428}
[3 / 20] Learning rate: 0.001 weight: 0.01
[3 / 20] Loss: 4.845064390324578 CE Loss: 0.6123297343673878 Con Loss: 4.838941124169068
[3 / 20] tensor([[0.831, 0.784],
        [0.641, 0.545]]) {'epoch': 3, 'valid/acc': 72.663, 'valid/acc_unbiased': 68.981, 'valid/diff': 9.237, 'valid/acc_skew': 73.6, 'valid/acc_align': 64.363, 'test/acc': 73.424, 'test/acc_unbiased': 70.053, 'test/diff': 7.152, 'test/acc_skew': 73.629, 'test/acc_align': 66.477}
[3 / 20] best valid accuracy: 69.535 at epoch 2 
 best_stats: {'best_valid_epoch': 2, 'best_valid_valid/acc': 71.914, 'best_valid_valid/acc_unbiased': 69.535, 'best_valid_valid/diff': 7.641, 'best_valid_valid/acc_skew': 73.356, 'best_valid_valid/acc_align': 65.715, 'best_valid_test/acc': 69.722, 'best_valid_test/acc_unbiased': 67.193, 'best_valid_test/diff': 8.049, 'best_valid_test/acc_skew': 70.959, 'best_valid_test/acc_align': 63.428}
[3 / 20] best test accuracy: 70.053 at epoch 3 
 best_stats: {'best_test_epoch': 3, 'best_test_valid/acc': 72.663, 'best_test_valid/acc_unbiased': 68.981, 'best_test_valid/diff': 9.237, 'best_test_valid/acc_skew': 73.6, 'best_test_valid/acc_align': 64.363, 'best_test_test/acc': 73.424, 'best_test_test/acc_unbiased': 70.053, 'best_test_test/diff': 7.152, 'best_test_test/acc_skew': 73.629, 'best_test_test/acc_align': 66.477}
[4 / 20] Learning rate: 0.001 weight: 0.01
[4 / 20] Loss: 4.838423294084605 CE Loss: 0.5976445244343501 Con Loss: 4.832446853947693
[4 / 20] tensor([[0.874, 0.864],
        [0.621, 0.418]]) {'epoch': 4, 'valid/acc': 75.088, 'valid/acc_unbiased': 70.694, 'valid/diff': 10.839, 'valid/acc_skew': 76.113, 'valid/acc_align': 65.274, 'test/acc': 74.306, 'test/acc_unbiased': 69.401, 'test/diff': 10.621, 'test/acc_skew': 74.712, 'test/acc_align': 64.091}
[4 / 20] best valid accuracy: 70.694 at epoch 4 
 best_stats: {'best_valid_epoch': 4, 'best_valid_valid/acc': 75.088, 'best_valid_valid/acc_unbiased': 70.694, 'best_valid_valid/diff': 10.839, 'best_valid_valid/acc_skew': 76.113, 'best_valid_valid/acc_align': 65.274, 'best_valid_test/acc': 74.306, 'best_valid_test/acc_unbiased': 69.401, 'best_valid_test/diff': 10.621, 'best_valid_test/acc_skew': 74.712, 'best_valid_test/acc_align': 64.091}
[4 / 20] best test accuracy: 70.053 at epoch 3 
 best_stats: {'best_test_epoch': 3, 'best_test_valid/acc': 72.663, 'best_test_valid/acc_unbiased': 68.981, 'best_test_valid/diff': 9.237, 'best_test_valid/acc_skew': 73.6, 'best_test_valid/acc_align': 64.363, 'best_test_test/acc': 73.424, 'best_test_test/acc_unbiased': 70.053, 'best_test_test/diff': 7.152, 'best_test_test/acc_skew': 73.629, 'best_test_test/acc_align': 66.477}
[5 / 20] Learning rate: 0.001 weight: 0.01
[5 / 20] Loss: 4.835795990231344 CE Loss: 0.5854781081660337 Con Loss: 4.829941215687358
[5 / 20] tensor([[0.875, 0.784],
        [0.704, 0.533]]) {'epoch': 5, 'valid/acc': 77.425, 'valid/acc_unbiased': 73.724, 'valid/diff': 9.58, 'valid/acc_skew': 78.514, 'valid/acc_align': 68.934, 'test/acc': 77.743, 'test/acc_unbiased': 72.391, 'test/diff': 13.04, 'test/acc_skew': 78.911, 'test/acc_align': 65.871}
[5 / 20] best valid accuracy: 73.724 at epoch 5 
 best_stats: {'best_valid_epoch': 5, 'best_valid_valid/acc': 77.425, 'best_valid_valid/acc_unbiased': 73.724, 'best_valid_valid/diff': 9.58, 'best_valid_valid/acc_skew': 78.514, 'best_valid_valid/acc_align': 68.934, 'best_valid_test/acc': 77.743, 'best_valid_test/acc_unbiased': 72.391, 'best_valid_test/diff': 13.04, 'best_valid_test/acc_skew': 78.911, 'best_valid_test/acc_align': 65.871}
[5 / 20] best test accuracy: 72.391 at epoch 5 
 best_stats: {'best_test_epoch': 5, 'best_test_valid/acc': 77.425, 'best_test_valid/acc_unbiased': 73.724, 'best_test_valid/diff': 9.58, 'best_test_valid/acc_skew': 78.514, 'best_test_valid/acc_align': 68.934, 'best_test_test/acc': 77.743, 'best_test_test/acc_unbiased': 72.391, 'best_test_test/diff': 13.04, 'best_test_test/acc_skew': 78.911, 'best_test_test/acc_align': 65.871}
[6 / 20] Learning rate: 0.001 weight: 0.01
[6 / 20] Loss: 4.8308892077839936 CE Loss: 0.5724856593807987 Con Loss: 4.825164327772153
[6 / 20] tensor([[0.905, 0.812],
        [0.657, 0.473]]) {'epoch': 6, 'valid/acc': 77.954, 'valid/acc_unbiased': 73.422, 'valid/diff': 10.886, 'valid/acc_skew': 78.865, 'valid/acc_align': 67.979, 'test/acc': 77.171, 'test/acc_unbiased': 71.187, 'test/diff': 13.851, 'test/acc_skew': 78.112, 'test/acc_align': 64.261}
[6 / 20] best valid accuracy: 73.724 at epoch 5 
 best_stats: {'best_valid_epoch': 5, 'best_valid_valid/acc': 77.425, 'best_valid_valid/acc_unbiased': 73.724, 'best_valid_valid/diff': 9.58, 'best_valid_valid/acc_skew': 78.514, 'best_valid_valid/acc_align': 68.934, 'best_valid_test/acc': 77.743, 'best_valid_test/acc_unbiased': 72.391, 'best_valid_test/diff': 13.04, 'best_valid_test/acc_skew': 78.911, 'best_valid_test/acc_align': 65.871}
[6 / 20] best test accuracy: 72.391 at epoch 5 
 best_stats: {'best_test_epoch': 5, 'best_test_valid/acc': 77.425, 'best_test_valid/acc_unbiased': 73.724, 'best_test_valid/diff': 9.58, 'best_test_valid/acc_skew': 78.514, 'best_test_valid/acc_align': 68.934, 'best_test_test/acc': 77.743, 'best_test_test/acc_unbiased': 72.391, 'best_test_test/diff': 13.04, 'best_test_test/acc_skew': 78.911, 'best_test_test/acc_align': 65.871}
[7 / 20] Learning rate: 0.0001 weight: 0.01
[7 / 20] Loss: 4.817329395974463 CE Loss: 0.5505827120410669 Con Loss: 4.811823539217223
[7 / 20] tensor([[0.798, 0.636],
        [0.799, 0.727]]) {'epoch': 7, 'valid/acc': 78.131, 'valid/acc_unbiased': 73.399, 'valid/diff': 14.717, 'valid/acc_skew': 80.758, 'valid/acc_align': 66.041, 'test/acc': 78.096, 'test/acc_unbiased': 74.031, 'test/diff': 11.699, 'test/acc_skew': 79.881, 'test/acc_align': 68.182}
[7 / 20] best valid accuracy: 73.724 at epoch 5 
 best_stats: {'best_valid_epoch': 5, 'best_valid_valid/acc': 77.425, 'best_valid_valid/acc_unbiased': 73.724, 'best_valid_valid/diff': 9.58, 'best_valid_valid/acc_skew': 78.514, 'best_valid_valid/acc_align': 68.934, 'best_valid_test/acc': 77.743, 'best_valid_test/acc_unbiased': 72.391, 'best_valid_test/diff': 13.04, 'best_valid_test/acc_skew': 78.911, 'best_valid_test/acc_align': 65.871}
[7 / 20] best test accuracy: 74.031 at epoch 7 
 best_stats: {'best_test_epoch': 7, 'best_test_valid/acc': 78.131, 'best_test_valid/acc_unbiased': 73.399, 'best_test_valid/diff': 14.717, 'best_test_valid/acc_skew': 80.758, 'best_test_valid/acc_align': 66.041, 'best_test_test/acc': 78.096, 'best_test_test/acc_unbiased': 74.031, 'best_test_test/diff': 11.699, 'best_test_test/acc_skew': 79.881, 'best_test_test/acc_align': 68.182}
[8 / 20] Learning rate: 0.0001 weight: 0.01
[8 / 20] Loss: 4.809710675921989 CE Loss: 0.5434392744477662 Con Loss: 4.8042763006068245
[8 / 20] tensor([[0.832, 0.688],
        [0.783, 0.673]]) {'epoch': 8, 'valid/acc': 78.439, 'valid/acc_unbiased': 73.721, 'valid/diff': 14.122, 'valid/acc_skew': 80.783, 'valid/acc_align': 66.66, 'test/acc': 79.066, 'test/acc_unbiased': 74.391, 'test/diff': 12.758, 'test/acc_skew': 80.77, 'test/acc_align': 68.011}
[8 / 20] best valid accuracy: 73.724 at epoch 5 
 best_stats: {'best_valid_epoch': 5, 'best_valid_valid/acc': 77.425, 'best_valid_valid/acc_unbiased': 73.724, 'best_valid_valid/diff': 9.58, 'best_valid_valid/acc_skew': 78.514, 'best_valid_valid/acc_align': 68.934, 'best_valid_test/acc': 77.743, 'best_valid_test/acc_unbiased': 72.391, 'best_valid_test/diff': 13.04, 'best_valid_test/acc_skew': 78.911, 'best_valid_test/acc_align': 65.871}
[8 / 20] best test accuracy: 74.391 at epoch 8 
 best_stats: {'best_test_epoch': 8, 'best_test_valid/acc': 78.439, 'best_test_valid/acc_unbiased': 73.721, 'best_test_valid/diff': 14.122, 'best_test_valid/acc_skew': 80.783, 'best_test_valid/acc_align': 66.66, 'best_test_test/acc': 79.066, 'best_test_test/acc_unbiased': 74.391, 'best_test_test/diff': 12.758, 'best_test_test/acc_skew': 80.77, 'best_test_test/acc_align': 68.011}
[9 / 20] Learning rate: 0.0001 weight: 0.01
[9 / 20] Loss: 4.804909027995159 CE Loss: 0.5268226925191168 Con Loss: 4.799640804058273
[9 / 20] tensor([[0.830, 0.722],
        [0.800, 0.624]]) {'epoch': 9, 'valid/acc': 79.453, 'valid/acc_unbiased': 74.608, 'valid/diff': 14.693, 'valid/acc_skew': 81.955, 'valid/acc_align': 67.262, 'test/acc': 79.55, 'test/acc_unbiased': 74.416, 'test/diff': 14.249, 'test/acc_skew': 81.541, 'test/acc_align': 67.292}
[9 / 20] best valid accuracy: 74.608 at epoch 9 
 best_stats: {'best_valid_epoch': 9, 'best_valid_valid/acc': 79.453, 'best_valid_valid/acc_unbiased': 74.608, 'best_valid_valid/diff': 14.693, 'best_valid_valid/acc_skew': 81.955, 'best_valid_valid/acc_align': 67.262, 'best_valid_test/acc': 79.55, 'best_valid_test/acc_unbiased': 74.416, 'best_valid_test/diff': 14.249, 'best_valid_test/acc_skew': 81.541, 'best_valid_test/acc_align': 67.292}
[9 / 20] best test accuracy: 74.416 at epoch 9 
 best_stats: {'best_test_epoch': 9, 'best_test_valid/acc': 79.453, 'best_test_valid/acc_unbiased': 74.608, 'best_test_valid/diff': 14.693, 'best_test_valid/acc_skew': 81.955, 'best_test_valid/acc_align': 67.262, 'best_test_test/acc': 79.55, 'best_test_test/acc_unbiased': 74.416, 'best_test_test/diff': 14.249, 'best_test_test/acc_skew': 81.541, 'best_test_test/acc_align': 67.292}
[10 / 20] Learning rate: 0.0001 weight: 0.01
[10 / 20] Loss: 4.803477921281388 CE Loss: 0.5236034597823098 Con Loss: 4.798241873627053
[10 / 20] tensor([[0.847, 0.688],
        [0.785, 0.648]]) {'epoch': 10, 'valid/acc': 79.541, 'valid/acc_unbiased': 74.358, 'valid/diff': 15.254, 'valid/acc_skew': 81.985, 'valid/acc_align': 66.731, 'test/acc': 79.683, 'test/acc_unbiased': 74.219, 'test/diff': 14.84, 'test/acc_skew': 81.639, 'test/acc_align': 66.799}
[10 / 20] best valid accuracy: 74.608 at epoch 9 
 best_stats: {'best_valid_epoch': 9, 'best_valid_valid/acc': 79.453, 'best_valid_valid/acc_unbiased': 74.608, 'best_valid_valid/diff': 14.693, 'best_valid_valid/acc_skew': 81.955, 'best_valid_valid/acc_align': 67.262, 'best_valid_test/acc': 79.55, 'best_valid_test/acc_unbiased': 74.416, 'best_valid_test/diff': 14.249, 'best_valid_test/acc_skew': 81.541, 'best_valid_test/acc_align': 67.292}
[10 / 20] best test accuracy: 74.416 at epoch 9 
 best_stats: {'best_test_epoch': 9, 'best_test_valid/acc': 79.453, 'best_test_valid/acc_unbiased': 74.608, 'best_test_valid/diff': 14.693, 'best_test_valid/acc_skew': 81.955, 'best_test_valid/acc_align': 67.262, 'best_test_test/acc': 79.55, 'best_test_test/acc_unbiased': 74.416, 'best_test_test/diff': 14.249, 'best_test_test/acc_skew': 81.541, 'best_test_test/acc_align': 67.292}
[11 / 20] Learning rate: 0.0001 weight: 0.01
[11 / 20] Loss: 4.783929290943705 CE Loss: 0.508830045200632 Con Loss: 4.778840987461685
[11 / 20] tensor([[0.848, 0.693],
        [0.798, 0.661]]) {'epoch': 11, 'valid/acc': 80.026, 'valid/acc_unbiased': 75.057, 'valid/diff': 14.689, 'valid/acc_skew': 82.401, 'valid/acc_align': 67.713, 'test/acc': 80.344, 'test/acc_unbiased': 75.005, 'test/diff': 14.631, 'test/acc_skew': 82.321, 'test/acc_align': 67.689}
[11 / 20] best valid accuracy: 75.057 at epoch 11 
 best_stats: {'best_valid_epoch': 11, 'best_valid_valid/acc': 80.026, 'best_valid_valid/acc_unbiased': 75.057, 'best_valid_valid/diff': 14.689, 'best_valid_valid/acc_skew': 82.401, 'best_valid_valid/acc_align': 67.713, 'best_valid_test/acc': 80.344, 'best_valid_test/acc_unbiased': 75.005, 'best_valid_test/diff': 14.631, 'best_valid_test/acc_skew': 82.321, 'best_valid_test/acc_align': 67.689}
[11 / 20] best test accuracy: 75.005 at epoch 11 
 best_stats: {'best_test_epoch': 11, 'best_test_valid/acc': 80.026, 'best_test_valid/acc_unbiased': 75.057, 'best_test_valid/diff': 14.689, 'best_test_valid/acc_skew': 82.401, 'best_test_valid/acc_align': 67.713, 'best_test_test/acc': 80.344, 'best_test_test/acc_unbiased': 75.005, 'best_test_test/diff': 14.631, 'best_test_test/acc_skew': 82.321, 'best_test_test/acc_align': 67.689}
[12 / 20] Learning rate: 0.0001 weight: 0.01
[12 / 20] Loss: 4.794315637368919 CE Loss: 0.5099955881960505 Con Loss: 4.7892156702132045
[12 / 20] tensor([[0.859, 0.636],
        [0.797, 0.691]]) {'epoch': 12, 'valid/acc': 80.467, 'valid/acc_unbiased': 75.757, 'valid/diff': 13.774, 'valid/acc_skew': 82.644, 'valid/acc_align': 68.87, 'test/acc': 80.564, 'test/acc_unbiased': 74.572, 'test/diff': 16.418, 'test/acc_skew': 82.781, 'test/acc_align': 66.364}
[12 / 20] best valid accuracy: 75.757 at epoch 12 
 best_stats: {'best_valid_epoch': 12, 'best_valid_valid/acc': 80.467, 'best_valid_valid/acc_unbiased': 75.757, 'best_valid_valid/diff': 13.774, 'best_valid_valid/acc_skew': 82.644, 'best_valid_valid/acc_align': 68.87, 'best_valid_test/acc': 80.564, 'best_valid_test/acc_unbiased': 74.572, 'best_valid_test/diff': 16.418, 'best_valid_test/acc_skew': 82.781, 'best_valid_test/acc_align': 66.364}
[12 / 20] best test accuracy: 75.005 at epoch 11 
 best_stats: {'best_test_epoch': 11, 'best_test_valid/acc': 80.026, 'best_test_valid/acc_unbiased': 75.057, 'best_test_valid/diff': 14.689, 'best_test_valid/acc_skew': 82.401, 'best_test_valid/acc_align': 67.713, 'best_test_test/acc': 80.344, 'best_test_test/acc_unbiased': 75.005, 'best_test_test/diff': 14.631, 'best_test_test/acc_skew': 82.321, 'best_test_test/acc_align': 67.689}
[13 / 20] Learning rate: 0.0001 weight: 0.01
[13 / 20] Loss: 4.784126914650807 CE Loss: 0.5042653815740925 Con Loss: 4.779084268057589
[13 / 20] tensor([[0.869, 0.722],
        [0.781, 0.618]]) {'epoch': 13, 'valid/acc': 81.085, 'valid/acc_unbiased': 75.566, 'valid/diff': 16.077, 'valid/acc_skew': 83.604, 'valid/acc_align': 67.527, 'test/acc': 80.564, 'test/acc_unbiased': 74.74, 'test/diff': 15.504, 'test/acc_skew': 82.492, 'test/acc_align': 66.989}
[13 / 20] best valid accuracy: 75.757 at epoch 12 
 best_stats: {'best_valid_epoch': 12, 'best_valid_valid/acc': 80.467, 'best_valid_valid/acc_unbiased': 75.757, 'best_valid_valid/diff': 13.774, 'best_valid_valid/acc_skew': 82.644, 'best_valid_valid/acc_align': 68.87, 'best_valid_test/acc': 80.564, 'best_valid_test/acc_unbiased': 74.572, 'best_valid_test/diff': 16.418, 'best_valid_test/acc_skew': 82.781, 'best_valid_test/acc_align': 66.364}
[13 / 20] best test accuracy: 75.005 at epoch 11 
 best_stats: {'best_test_epoch': 11, 'best_test_valid/acc': 80.026, 'best_test_valid/acc_unbiased': 75.057, 'best_test_valid/diff': 14.689, 'best_test_valid/acc_skew': 82.401, 'best_test_valid/acc_align': 67.713, 'best_test_test/acc': 80.344, 'best_test_test/acc_unbiased': 75.005, 'best_test_test/diff': 14.631, 'best_test_test/acc_skew': 82.321, 'best_test_test/acc_align': 67.689}
[14 / 20] Learning rate: 1e-05 weight: 0.01
[14 / 20] Loss: 4.789543370360984 CE Loss: 0.4944556239765331 Con Loss: 4.7845988392022605
[14 / 20] tensor([[0.860, 0.699],
        [0.791, 0.655]]) {'epoch': 14, 'valid/acc': 81.217, 'valid/acc_unbiased': 75.671, 'valid/diff': 16.376, 'valid/acc_skew': 83.859, 'valid/acc_align': 67.483, 'test/acc': 80.608, 'test/acc_unbiased': 75.105, 'test/diff': 14.87, 'test/acc_skew': 82.54, 'test/acc_align': 67.67}
[14 / 20] best valid accuracy: 75.757 at epoch 12 
 best_stats: {'best_valid_epoch': 12, 'best_valid_valid/acc': 80.467, 'best_valid_valid/acc_unbiased': 75.757, 'best_valid_valid/diff': 13.774, 'best_valid_valid/acc_skew': 82.644, 'best_valid_valid/acc_align': 68.87, 'best_valid_test/acc': 80.564, 'best_valid_test/acc_unbiased': 74.572, 'best_valid_test/diff': 16.418, 'best_valid_test/acc_skew': 82.781, 'best_valid_test/acc_align': 66.364}
[14 / 20] best test accuracy: 75.105 at epoch 14 
 best_stats: {'best_test_epoch': 14, 'best_test_valid/acc': 81.217, 'best_test_valid/acc_unbiased': 75.671, 'best_test_valid/diff': 16.376, 'best_test_valid/acc_skew': 83.859, 'best_test_valid/acc_align': 67.483, 'best_test_test/acc': 80.608, 'best_test_test/acc_unbiased': 75.105, 'best_test_test/diff': 14.87, 'best_test_test/acc_skew': 82.54, 'best_test_test/acc_align': 67.67}
[15 / 20] Learning rate: 1e-05 weight: 0.01
[15 / 20] Loss: 4.784671235568905 CE Loss: 0.4946229183377854 Con Loss: 4.779724940220335
[15 / 20] tensor([[0.857, 0.699],
        [0.798, 0.661]]) {'epoch': 15, 'valid/acc': 80.996, 'valid/acc_unbiased': 75.448, 'valid/diff': 16.39, 'valid/acc_skew': 83.643, 'valid/acc_align': 67.253, 'test/acc': 80.784, 'test/acc_unbiased': 75.359, 'test/diff': 14.771, 'test/acc_skew': 82.745, 'test/acc_align': 67.973}
[15 / 20] best valid accuracy: 75.757 at epoch 12 
 best_stats: {'best_valid_epoch': 12, 'best_valid_valid/acc': 80.467, 'best_valid_valid/acc_unbiased': 75.757, 'best_valid_valid/diff': 13.774, 'best_valid_valid/acc_skew': 82.644, 'best_valid_valid/acc_align': 68.87, 'best_valid_test/acc': 80.564, 'best_valid_test/acc_unbiased': 74.572, 'best_valid_test/diff': 16.418, 'best_valid_test/acc_skew': 82.781, 'best_valid_test/acc_align': 66.364}
[15 / 20] best test accuracy: 75.359 at epoch 15 
 best_stats: {'best_test_epoch': 15, 'best_test_valid/acc': 80.996, 'best_test_valid/acc_unbiased': 75.448, 'best_test_valid/diff': 16.39, 'best_test_valid/acc_skew': 83.643, 'best_test_valid/acc_align': 67.253, 'best_test_test/acc': 80.784, 'best_test_test/acc_unbiased': 75.359, 'best_test_test/diff': 14.771, 'best_test_test/acc_skew': 82.745, 'best_test_test/acc_align': 67.973}
[16 / 20] Learning rate: 1e-05 weight: 0.01
[16 / 20] Loss: 4.780150932329234 CE Loss: 0.4934379671012844 Con Loss: 4.775216507319672
[16 / 20] tensor([[0.874, 0.705],
        [0.784, 0.667]]) {'epoch': 16, 'valid/acc': 80.776, 'valid/acc_unbiased': 75.064, 'valid/diff': 16.648, 'valid/acc_skew': 83.388, 'valid/acc_align': 66.74, 'test/acc': 81.137, 'test/acc_unbiased': 75.731, 'test/diff': 14.34, 'test/acc_skew': 82.901, 'test/acc_align': 68.561}
[16 / 20] best valid accuracy: 75.757 at epoch 12 
 best_stats: {'best_valid_epoch': 12, 'best_valid_valid/acc': 80.467, 'best_valid_valid/acc_unbiased': 75.757, 'best_valid_valid/diff': 13.774, 'best_valid_valid/acc_skew': 82.644, 'best_valid_valid/acc_align': 68.87, 'best_valid_test/acc': 80.564, 'best_valid_test/acc_unbiased': 74.572, 'best_valid_test/diff': 16.418, 'best_valid_test/acc_skew': 82.781, 'best_valid_test/acc_align': 66.364}
[16 / 20] best test accuracy: 75.731 at epoch 16 
 best_stats: {'best_test_epoch': 16, 'best_test_valid/acc': 80.776, 'best_test_valid/acc_unbiased': 75.064, 'best_test_valid/diff': 16.648, 'best_test_valid/acc_skew': 83.388, 'best_test_valid/acc_align': 66.74, 'best_test_test/acc': 81.137, 'best_test_test/acc_unbiased': 75.731, 'best_test_test/diff': 14.34, 'best_test_test/acc_skew': 82.901, 'best_test_test/acc_align': 68.561}
[17 / 20] Learning rate: 1e-05 weight: 0.01
[17 / 20] Loss: 4.775227810405447 CE Loss: 0.48311357761882495 Con Loss: 4.770396644859228
[17 / 20] tensor([[0.874, 0.682],
        [0.789, 0.673]]) {'epoch': 17, 'valid/acc': 80.776, 'valid/acc_unbiased': 74.887, 'valid/diff': 17.372, 'valid/acc_skew': 83.572, 'valid/acc_align': 66.201, 'test/acc': 81.181, 'test/acc_unbiased': 75.429, 'test/diff': 15.404, 'test/acc_skew': 83.132, 'test/acc_align': 67.727}
[17 / 20] best valid accuracy: 75.757 at epoch 12 
 best_stats: {'best_valid_epoch': 12, 'best_valid_valid/acc': 80.467, 'best_valid_valid/acc_unbiased': 75.757, 'best_valid_valid/diff': 13.774, 'best_valid_valid/acc_skew': 82.644, 'best_valid_valid/acc_align': 68.87, 'best_valid_test/acc': 80.564, 'best_valid_test/acc_unbiased': 74.572, 'best_valid_test/diff': 16.418, 'best_valid_test/acc_skew': 82.781, 'best_valid_test/acc_align': 66.364}
[17 / 20] best test accuracy: 75.731 at epoch 16 
 best_stats: {'best_test_epoch': 16, 'best_test_valid/acc': 80.776, 'best_test_valid/acc_unbiased': 75.064, 'best_test_valid/diff': 16.648, 'best_test_valid/acc_skew': 83.388, 'best_test_valid/acc_align': 66.74, 'best_test_test/acc': 81.137, 'best_test_test/acc_unbiased': 75.731, 'best_test_test/diff': 14.34, 'best_test_test/acc_skew': 82.901, 'best_test_test/acc_align': 68.561}
[18 / 20] Learning rate: 1e-05 weight: 0.01
[18 / 20] Loss: 4.793646457232955 CE Loss: 0.4793540271625562 Con Loss: 4.78885290692676
[18 / 20] tensor([[0.877, 0.705],
        [0.783, 0.655]]) {'epoch': 18, 'valid/acc': 80.996, 'valid/acc_unbiased': 75.099, 'valid/diff': 17.248, 'valid/acc_skew': 83.723, 'valid/acc_align': 66.475, 'test/acc': 81.181, 'test/acc_unbiased': 75.493, 'test/diff': 15.077, 'test/acc_skew': 83.032, 'test/acc_align': 67.955}
[18 / 20] best valid accuracy: 75.757 at epoch 12 
 best_stats: {'best_valid_epoch': 12, 'best_valid_valid/acc': 80.467, 'best_valid_valid/acc_unbiased': 75.757, 'best_valid_valid/diff': 13.774, 'best_valid_valid/acc_skew': 82.644, 'best_valid_valid/acc_align': 68.87, 'best_valid_test/acc': 80.564, 'best_valid_test/acc_unbiased': 74.572, 'best_valid_test/diff': 16.418, 'best_valid_test/acc_skew': 82.781, 'best_valid_test/acc_align': 66.364}
[18 / 20] best test accuracy: 75.731 at epoch 16 
 best_stats: {'best_test_epoch': 16, 'best_test_valid/acc': 80.776, 'best_test_valid/acc_unbiased': 75.064, 'best_test_valid/diff': 16.648, 'best_test_valid/acc_skew': 83.388, 'best_test_valid/acc_align': 66.74, 'best_test_test/acc': 81.137, 'best_test_test/acc_unbiased': 75.731, 'best_test_test/diff': 14.34, 'best_test_test/acc_skew': 82.901, 'best_test_test/acc_align': 68.561}
[19 / 20] Learning rate: 1e-05 weight: 0.01
[19 / 20] Loss: 4.778315581801783 CE Loss: 0.4931081249536295 Con Loss: 4.773384468819164
[19 / 20] tensor([[0.876, 0.705],
        [0.796, 0.673]]) {'epoch': 19, 'valid/acc': 81.129, 'valid/acc_unbiased': 75.888, 'valid/diff': 15.325, 'valid/acc_skew': 83.551, 'valid/acc_align': 68.225, 'test/acc': 81.71, 'test/acc_unbiased': 76.218, 'test/diff': 14.708, 'test/acc_skew': 83.572, 'test/acc_align': 68.864}
[19 / 20] best valid accuracy: 75.888 at epoch 19 
 best_stats: {'best_valid_epoch': 19, 'best_valid_valid/acc': 81.129, 'best_valid_valid/acc_unbiased': 75.888, 'best_valid_valid/diff': 15.325, 'best_valid_valid/acc_skew': 83.551, 'best_valid_valid/acc_align': 68.225, 'best_valid_test/acc': 81.71, 'best_valid_test/acc_unbiased': 76.218, 'best_valid_test/diff': 14.708, 'best_valid_test/acc_skew': 83.572, 'best_valid_test/acc_align': 68.864}
[19 / 20] best test accuracy: 76.218 at epoch 19 
 best_stats: {'best_test_epoch': 19, 'best_test_valid/acc': 81.129, 'best_test_valid/acc_unbiased': 75.888, 'best_test_valid/diff': 15.325, 'best_test_valid/acc_skew': 83.551, 'best_test_valid/acc_align': 68.225, 'best_test_test/acc': 81.71, 'best_test_test/acc_unbiased': 76.218, 'best_test_test/diff': 14.708, 'best_test_test/acc_skew': 83.572, 'best_test_test/acc_align': 68.864}
[20 / 20] Learning rate: 1e-05 weight: 0.01
[20 / 20] Loss: 4.771591964747513 CE Loss: 0.4867010066121749 Con Loss: 4.766724961067699
[20 / 20] tensor([[0.892, 0.739],
        [0.774, 0.655]]) {'epoch': 20, 'valid/acc': 81.305, 'valid/acc_unbiased': 76.053, 'valid/diff': 14.982, 'valid/acc_skew': 83.544, 'valid/acc_align': 68.562, 'test/acc': 81.754, 'test/acc_unbiased': 76.468, 'test/diff': 13.618, 'test/acc_skew': 83.277, 'test/acc_align': 69.659}
[20 / 20] best valid accuracy: 76.053 at epoch 20 
 best_stats: {'best_valid_epoch': 20, 'best_valid_valid/acc': 81.305, 'best_valid_valid/acc_unbiased': 76.053, 'best_valid_valid/diff': 14.982, 'best_valid_valid/acc_skew': 83.544, 'best_valid_valid/acc_align': 68.562, 'best_valid_test/acc': 81.754, 'best_valid_test/acc_unbiased': 76.468, 'best_valid_test/diff': 13.618, 'best_valid_test/acc_skew': 83.277, 'best_valid_test/acc_align': 69.659}
[20 / 20] best test accuracy: 76.468 at epoch 20 
 best_stats: {'best_test_epoch': 20, 'best_test_valid/acc': 81.305, 'best_test_valid/acc_unbiased': 76.053, 'best_test_valid/diff': 14.982, 'best_test_valid/acc_skew': 83.544, 'best_test_valid/acc_align': 68.562, 'best_test_test/acc': 81.754, 'best_test_test/acc_unbiased': 76.468, 'best_test_test/diff': 13.618, 'best_test_test/acc_skew': 83.277, 'best_test_test/acc_align': 69.659}
Total training time: 0:10:51
