Log level set to: INFO
Set seed: 2
=======> Using Fixed Random Seed: 2 <========
save_path: exp_results/bc-bb0-celeba_blonde-os_0.4-lr0.001-bs128-cbs64-w0.01-ratio30-aug1-seed2
get_celeba - split:train, aug: False, given_y: True, ratio: 0
use existing blonde indices from data/celeba/pickles/blonde
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [21421, 21421]
Target 1: [21421, 21421]
Binary Target 1
---------------------------
Target 0: [21421, 21421]
Target 1: [21421, 21421]
===================================
Normal Label Distribution: 
Target 0: [21421, 21421]
Target 1: [21421, 21421]
===================================
Use BiasedCelebASplit 
 target_attr: blonde split: train 
 tensor([[21421., 21421.],
        [21421., 21421.]])
get_celeba - split:train, aug: 1, given_y: True, ratio: 30
use existing blonde indices from data/celeba/pickles/blonde
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [21389, 21389]
Target 1: [21389, 21389]
Binary Target 1
---------------------------
Target 0: [21389, 21389]
Target 1: [21389, 21389]
===================================
Normal Label Distribution: 
Target 0: [21389, 21389]
Target 1: [21389, 21389]
===================================
Use BiasedCelebASplit 
 target_attr: blonde split: train 
 tensor([[21389., 21389.],
        [21389., 21389.]])
get_celeba - split:train_valid, aug: False, given_y: True, ratio: 0
use existing blonde indices from data/celeba/pickles/blonde
Use BiasedCelebASplit 
 target_attr: blonde split: train_valid 
 tensor([[  403.,  4597.],
        [13344.,   285.]])
get_celeba - split:valid, aug: False, given_y: True, ratio: 0
Use BiasedCelebASplit 
 target_attr: blonde split: valid 
 tensor([[8535., 2874.],
        [8276.,  182.]])
decay_epochs: [3, 6]
[1 / 10] Learning rate: 0.001 weight: 0.01
[1 / 10] Loss: 4.640803025431183 CE Loss: 0.25829588055226665 Con Loss: 4.638220071180445
[1 / 10] tensor([[0.826, 0.914],
        [0.965, 0.901]]) {'epoch': 1, 'valid/acc': 91.782, 'valid/acc_unbiased': 91.84, 'valid/diff': 2.505, 'valid/acc_skew': 91.745, 'valid/acc_align': 91.934, 'test/acc': 88.322, 'test/acc_unbiased': 90.131, 'test/diff': 7.55, 'test/acc_skew': 89.526, 'test/acc_align': 90.735}
[1 / 10] best valid accuracy: 91.840 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 91.782, 'best_valid_valid/acc_unbiased': 91.84, 'best_valid_valid/diff': 2.505, 'best_valid_valid/acc_skew': 91.745, 'best_valid_valid/acc_align': 91.934, 'best_valid_test/acc': 88.322, 'best_valid_test/acc_unbiased': 90.131, 'best_valid_test/diff': 7.55, 'best_valid_test/acc_skew': 89.526, 'best_valid_test/acc_align': 90.735}
[1 / 10] best test accuracy: 90.131 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 91.782, 'best_test_valid/acc_unbiased': 91.84, 'best_test_valid/diff': 2.505, 'best_test_valid/acc_skew': 91.745, 'best_test_valid/acc_align': 91.934, 'best_test_test/acc': 88.322, 'best_test_test/acc_unbiased': 90.131, 'best_test_test/diff': 7.55, 'best_test_test/acc_skew': 89.526, 'best_test_test/acc_align': 90.735}
[2 / 10] Learning rate: 0.001 weight: 0.01
[2 / 10] Loss: 4.586020831684233 CE Loss: 0.21274655180929378 Con Loss: 4.583893361231186
[2 / 10] tensor([[0.922, 0.964],
        [0.882, 0.808]]) {'epoch': 2, 'valid/acc': 93.596, 'valid/acc_unbiased': 90.355, 'valid/diff': 3.503, 'valid/acc_skew': 92.107, 'valid/acc_align': 88.603, 'test/acc': 93.275, 'test/acc_unbiased': 89.398, 'test/diff': 5.807, 'test/acc_skew': 90.212, 'test/acc_align': 88.584}
[2 / 10] best valid accuracy: 91.840 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 91.782, 'best_valid_valid/acc_unbiased': 91.84, 'best_valid_valid/diff': 2.505, 'best_valid_valid/acc_skew': 91.745, 'best_valid_valid/acc_align': 91.934, 'best_valid_test/acc': 88.322, 'best_valid_test/acc_unbiased': 90.131, 'best_valid_test/diff': 7.55, 'best_valid_test/acc_skew': 89.526, 'best_valid_test/acc_align': 90.735}
[2 / 10] best test accuracy: 90.131 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 91.782, 'best_test_valid/acc_unbiased': 91.84, 'best_test_valid/diff': 2.505, 'best_test_valid/acc_skew': 91.745, 'best_test_valid/acc_align': 91.934, 'best_test_test/acc': 88.322, 'best_test_test/acc_unbiased': 90.131, 'best_test_test/diff': 7.55, 'best_test_test/acc_skew': 89.526, 'best_test_test/acc_align': 90.735}
[3 / 10] Learning rate: 0.001 weight: 0.01
[3 / 10] Loss: 4.582274793827268 CE Loss: 0.20683145436117126 Con Loss: 4.580206480498608
[3 / 10] tensor([[0.861, 0.955],
        [0.950, 0.868]]) {'epoch': 3, 'valid/acc': 94.305, 'valid/acc_unbiased': 92.16, 'valid/diff': 4.765, 'valid/acc_skew': 94.514, 'valid/acc_align': 89.806, 'test/acc': 91.282, 'test/acc_unbiased': 90.835, 'test/diff': 8.776, 'test/acc_skew': 90.535, 'test/acc_align': 91.135}
[3 / 10] best valid accuracy: 92.160 at epoch 3 
 best_stats: {'best_valid_epoch': 3, 'best_valid_valid/acc': 94.305, 'best_valid_valid/acc_unbiased': 92.16, 'best_valid_valid/diff': 4.765, 'best_valid_valid/acc_skew': 94.514, 'best_valid_valid/acc_align': 89.806, 'best_valid_test/acc': 91.282, 'best_valid_test/acc_unbiased': 90.835, 'best_valid_test/diff': 8.776, 'best_valid_test/acc_skew': 90.535, 'best_valid_test/acc_align': 91.135}
[3 / 10] best test accuracy: 90.835 at epoch 3 
 best_stats: {'best_test_epoch': 3, 'best_test_valid/acc': 94.305, 'best_test_valid/acc_unbiased': 92.16, 'best_test_valid/diff': 4.765, 'best_test_valid/acc_skew': 94.514, 'best_test_valid/acc_align': 89.806, 'best_test_test/acc': 91.282, 'best_test_test/acc_unbiased': 90.835, 'best_test_test/diff': 8.776, 'best_test_test/acc_skew': 90.535, 'best_test_test/acc_align': 91.135}
[4 / 10] Learning rate: 0.0001 weight: 0.01
[4 / 10] Loss: 4.498090969047584 CE Loss: 0.16744343302582254 Con Loss: 4.496416540953032
[4 / 10] tensor([[0.832, 0.937],
        [0.968, 0.901]]) {'epoch': 4, 'valid/acc': 94.192, 'valid/acc_unbiased': 95.083, 'valid/diff': 0.532, 'valid/acc_skew': 95.349, 'valid/acc_align': 94.817, 'test/acc': 89.581, 'test/acc_unbiased': 90.938, 'test/diff': 8.615, 'test/acc_skew': 89.975, 'test/acc_align': 91.901}
[4 / 10] best valid accuracy: 95.083 at epoch 4 
 best_stats: {'best_valid_epoch': 4, 'best_valid_valid/acc': 94.192, 'best_valid_valid/acc_unbiased': 95.083, 'best_valid_valid/diff': 0.532, 'best_valid_valid/acc_skew': 95.349, 'best_valid_valid/acc_align': 94.817, 'best_valid_test/acc': 89.581, 'best_valid_test/acc_unbiased': 90.938, 'best_valid_test/diff': 8.615, 'best_valid_test/acc_skew': 89.975, 'best_valid_test/acc_align': 91.901}
[4 / 10] best test accuracy: 90.938 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 94.192, 'best_test_valid/acc_unbiased': 95.083, 'best_test_valid/diff': 0.532, 'best_test_valid/acc_skew': 95.349, 'best_test_valid/acc_align': 94.817, 'best_test_test/acc': 89.581, 'best_test_test/acc_unbiased': 90.938, 'best_test_test/diff': 8.615, 'best_test_test/acc_skew': 89.975, 'best_test_test/acc_align': 91.901}
[5 / 10] Learning rate: 0.0001 weight: 0.01
[5 / 10] Loss: 4.474584132036426 CE Loss: 0.15200058146939047 Con Loss: 4.473064134693141
[5 / 10] tensor([[0.845, 0.946],
        [0.966, 0.890]]) {'epoch': 5, 'valid/acc': 94.67, 'valid/acc_unbiased': 96.008, 'valid/diff': 1.356, 'valid/acc_skew': 96.686, 'valid/acc_align': 95.33, 'test/acc': 90.512, 'test/acc_unbiased': 91.189, 'test/diff': 8.821, 'test/acc_skew': 90.585, 'test/acc_align': 91.793}
[5 / 10] best valid accuracy: 96.008 at epoch 5 
 best_stats: {'best_valid_epoch': 5, 'best_valid_valid/acc': 94.67, 'best_valid_valid/acc_unbiased': 96.008, 'best_valid_valid/diff': 1.356, 'best_valid_valid/acc_skew': 96.686, 'best_valid_valid/acc_align': 95.33, 'best_valid_test/acc': 90.512, 'best_valid_test/acc_unbiased': 91.189, 'best_valid_test/diff': 8.821, 'best_valid_test/acc_skew': 90.585, 'best_valid_test/acc_align': 91.793}
[5 / 10] best test accuracy: 91.189 at epoch 5 
 best_stats: {'best_test_epoch': 5, 'best_test_valid/acc': 94.67, 'best_test_valid/acc_unbiased': 96.008, 'best_test_valid/diff': 1.356, 'best_test_valid/acc_skew': 96.686, 'best_test_valid/acc_align': 95.33, 'best_test_test/acc': 90.512, 'best_test_test/acc_unbiased': 91.189, 'best_test_test/diff': 8.821, 'best_test_test/acc_skew': 90.585, 'best_test_test/acc_align': 91.793}
[6 / 10] Learning rate: 0.0001 weight: 0.01
[6 / 10] Loss: 4.455755936098301 CE Loss: 0.1425347523446828 Con Loss: 4.454330592388967
[6 / 10] tensor([[0.846, 0.940],
        [0.956, 0.907]]) {'epoch': 6, 'valid/acc': 94.374, 'valid/acc_unbiased': 95.951, 'valid/diff': 1.816, 'valid/acc_skew': 96.566, 'valid/acc_align': 95.337, 'test/acc': 90.165, 'test/acc_unbiased': 91.219, 'test/diff': 7.185, 'test/acc_skew': 90.104, 'test/acc_align': 92.333}
[6 / 10] best valid accuracy: 96.008 at epoch 5 
 best_stats: {'best_valid_epoch': 5, 'best_valid_valid/acc': 94.67, 'best_valid_valid/acc_unbiased': 96.008, 'best_valid_valid/diff': 1.356, 'best_valid_valid/acc_skew': 96.686, 'best_valid_valid/acc_align': 95.33, 'best_valid_test/acc': 90.512, 'best_valid_test/acc_unbiased': 91.189, 'best_valid_test/diff': 8.821, 'best_valid_test/acc_skew': 90.585, 'best_valid_test/acc_align': 91.793}
[6 / 10] best test accuracy: 91.219 at epoch 6 
 best_stats: {'best_test_epoch': 6, 'best_test_valid/acc': 94.374, 'best_test_valid/acc_unbiased': 95.951, 'best_test_valid/diff': 1.816, 'best_test_valid/acc_skew': 96.566, 'best_test_valid/acc_align': 95.337, 'best_test_test/acc': 90.165, 'best_test_test/acc_unbiased': 91.219, 'best_test_test/diff': 7.185, 'best_test_test/acc_skew': 90.104, 'best_test_test/acc_align': 92.333}
[7 / 10] Learning rate: 1e-05 weight: 0.01
[7 / 10] Loss: 4.443070938315502 CE Loss: 0.13836490200487017 Con Loss: 4.441687286704268
[7 / 10] tensor([[0.853, 0.952],
        [0.960, 0.896]]) {'epoch': 7, 'valid/acc': 95.147, 'valid/acc_unbiased': 96.116, 'valid/diff': 1.472, 'valid/acc_skew': 96.851, 'valid/acc_align': 95.38, 'test/acc': 91.005, 'test/acc_unbiased': 91.511, 'test/diff': 8.155, 'test/acc_skew': 90.653, 'test/acc_align': 92.37}
[7 / 10] best valid accuracy: 96.116 at epoch 7 
 best_stats: {'best_valid_epoch': 7, 'best_valid_valid/acc': 95.147, 'best_valid_valid/acc_unbiased': 96.116, 'best_valid_valid/diff': 1.472, 'best_valid_valid/acc_skew': 96.851, 'best_valid_valid/acc_align': 95.38, 'best_valid_test/acc': 91.005, 'best_valid_test/acc_unbiased': 91.511, 'best_valid_test/diff': 8.155, 'best_valid_test/acc_skew': 90.653, 'best_valid_test/acc_align': 92.37}
[7 / 10] best test accuracy: 91.511 at epoch 7 
 best_stats: {'best_test_epoch': 7, 'best_test_valid/acc': 95.147, 'best_test_valid/acc_unbiased': 96.116, 'best_test_valid/diff': 1.472, 'best_test_valid/acc_skew': 96.851, 'best_test_valid/acc_align': 95.38, 'best_test_test/acc': 91.005, 'best_test_test/acc_unbiased': 91.511, 'best_test_test/diff': 8.155, 'best_test_test/acc_skew': 90.653, 'best_test_test/acc_align': 92.37}
[8 / 10] Learning rate: 1e-05 weight: 0.01
[8 / 10] Loss: 4.432510248158115 CE Loss: 0.13437473393375313 Con Loss: 4.431166494044596
[8 / 10] tensor([[0.851, 0.954],
        [0.957, 0.868]]) {'epoch': 8, 'valid/acc': 95.335, 'valid/acc_unbiased': 95.637, 'valid/diff': 2.656, 'valid/acc_skew': 96.965, 'valid/acc_align': 94.309, 'test/acc': 90.955, 'test/acc_unbiased': 90.76, 'test/diff': 9.61, 'test/acc_skew': 90.391, 'test/acc_align': 91.129}
[8 / 10] best valid accuracy: 96.116 at epoch 7 
 best_stats: {'best_valid_epoch': 7, 'best_valid_valid/acc': 95.147, 'best_valid_valid/acc_unbiased': 96.116, 'best_valid_valid/diff': 1.472, 'best_valid_valid/acc_skew': 96.851, 'best_valid_valid/acc_align': 95.38, 'best_valid_test/acc': 91.005, 'best_valid_test/acc_unbiased': 91.511, 'best_valid_test/diff': 8.155, 'best_valid_test/acc_skew': 90.653, 'best_valid_test/acc_align': 92.37}
[8 / 10] best test accuracy: 91.511 at epoch 7 
 best_stats: {'best_test_epoch': 7, 'best_test_valid/acc': 95.147, 'best_test_valid/acc_unbiased': 96.116, 'best_test_valid/diff': 1.472, 'best_test_valid/acc_skew': 96.851, 'best_test_valid/acc_align': 95.38, 'best_test_test/acc': 91.005, 'best_test_test/acc_unbiased': 91.511, 'best_test_test/diff': 8.155, 'best_test_test/acc_skew': 90.653, 'best_test_test/acc_align': 92.37}
[9 / 10] Learning rate: 1e-05 weight: 0.01
[9 / 10] Loss: 4.422842098236262 CE Loss: 0.13232338469591853 Con Loss: 4.4215188605862945
[9 / 10] tensor([[0.848, 0.954],
        [0.960, 0.863]]) {'epoch': 9, 'valid/acc': 95.319, 'valid/acc_unbiased': 96.208, 'valid/diff': 1.483, 'valid/acc_skew': 96.949, 'valid/acc_align': 95.466, 'test/acc': 90.859, 'test/acc_unbiased': 90.622, 'test/diff': 10.2, 'test/acc_skew': 90.389, 'test/acc_align': 90.854}
[9 / 10] best valid accuracy: 96.208 at epoch 9 
 best_stats: {'best_valid_epoch': 9, 'best_valid_valid/acc': 95.319, 'best_valid_valid/acc_unbiased': 96.208, 'best_valid_valid/diff': 1.483, 'best_valid_valid/acc_skew': 96.949, 'best_valid_valid/acc_align': 95.466, 'best_valid_test/acc': 90.859, 'best_valid_test/acc_unbiased': 90.622, 'best_valid_test/diff': 10.2, 'best_valid_test/acc_skew': 90.389, 'best_valid_test/acc_align': 90.854}
[9 / 10] best test accuracy: 91.511 at epoch 7 
 best_stats: {'best_test_epoch': 7, 'best_test_valid/acc': 95.147, 'best_test_valid/acc_unbiased': 96.116, 'best_test_valid/diff': 1.472, 'best_test_valid/acc_skew': 96.851, 'best_test_valid/acc_align': 95.38, 'best_test_test/acc': 91.005, 'best_test_test/acc_unbiased': 91.511, 'best_test_test/diff': 8.155, 'best_test_test/acc_skew': 90.653, 'best_test_test/acc_align': 92.37}
[10 / 10] Learning rate: 1e-05 weight: 0.01
[10 / 10] Loss: 4.4175014218486695 CE Loss: 0.1307786948028318 Con Loss: 4.41619363585071
[10 / 10] tensor([[0.843, 0.954],
        [0.964, 0.874]]) {'epoch': 10, 'valid/acc': 95.4, 'valid/acc_unbiased': 96.354, 'valid/diff': 1.387, 'valid/acc_skew': 97.047, 'valid/acc_align': 95.66, 'test/acc': 90.678, 'test/acc_unbiased': 90.848, 'test/diff': 10.069, 'test/acc_skew': 90.323, 'test/acc_align': 91.373}
[10 / 10] best valid accuracy: 96.354 at epoch 10 
 best_stats: {'best_valid_epoch': 10, 'best_valid_valid/acc': 95.4, 'best_valid_valid/acc_unbiased': 96.354, 'best_valid_valid/diff': 1.387, 'best_valid_valid/acc_skew': 97.047, 'best_valid_valid/acc_align': 95.66, 'best_valid_test/acc': 90.678, 'best_valid_test/acc_unbiased': 90.848, 'best_valid_test/diff': 10.069, 'best_valid_test/acc_skew': 90.323, 'best_valid_test/acc_align': 91.373}
[10 / 10] best test accuracy: 91.511 at epoch 7 
 best_stats: {'best_test_epoch': 7, 'best_test_valid/acc': 95.147, 'best_test_valid/acc_unbiased': 96.116, 'best_test_valid/diff': 1.472, 'best_test_valid/acc_skew': 96.851, 'best_test_valid/acc_align': 95.38, 'best_test_test/acc': 91.005, 'best_test_test/acc_unbiased': 91.511, 'best_test_test/diff': 8.155, 'best_test_test/acc_skew': 90.653, 'best_test_test/acc_align': 92.37}
Total training time: 1:16:10
