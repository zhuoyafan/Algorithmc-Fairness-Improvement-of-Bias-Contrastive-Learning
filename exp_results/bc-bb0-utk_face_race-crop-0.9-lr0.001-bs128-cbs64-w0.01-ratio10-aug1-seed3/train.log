Log level set to: INFO
Set seed: 3
=======> Using Fixed Random Seed: 3 <========
save_path: exp_results/bc-bb0-utk_face_race-crop-0.9-lr0.001-bs128-cbs64-w0.01-ratio10-aug1-seed3
get_utk_face - split: train, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_race-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [4407, 552]
Target 1: [440, 5529]
Binary Target 1
---------------------------
Target 0: [4407, 552]
Target 1: [440, 5529]
===================================
Normal Label Distribution: 
Target 0: [4407, 552]
Target 1: [440, 5529]
===================================
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [4407, 552]
Target 1: [440, 5529]
Binary Target 1
---------------------------
Target 0: [4407, 552]
Target 1: [440, 5529]
===================================
Normal Label Distribution: 
Target 0: [4407, 552]
Target 1: [440, 5529]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 10928, target_attr: gender, bias_attr: race bias_rate: 0.9
['[train] target_0-bias_0: 4407', '[train] target_0-bias_1: 552', '[train] target_1-bias_0: 440', '[train] target_1-bias_1: 5529']
confusion_matrix - 
 original: tensor([[4407.,  440.],
        [ 552., 5529.]]), 
 normalized: tensor([[0.909, 0.091],
        [0.091, 0.909]]), 
 b|y: tensor([[0.889, 0.111],
        [0.074, 0.926]])
get_utk_face - split: train, aug: 1, given_y: True, ratio: 10
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_race-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [4407, 552]
Target 1: [440, 5529]
Binary Target 1
---------------------------
Target 0: [4407, 552]
Target 1: [440, 5529]
===================================
Normal Label Distribution: 
Target 0: [4407, 552]
Target 1: [440, 5529]
===================================
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [4407, 552]
Target 1: [440, 5529]
Binary Target 1
---------------------------
Target 0: [4407, 552]
Target 1: [440, 5529]
===================================
Normal Label Distribution: 
Target 0: [4407, 552]
Target 1: [440, 5529]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 10928, target_attr: gender, bias_attr: race bias_rate: 0.9
['[train] target_0-bias_0: 4407', '[train] target_0-bias_1: 552', '[train] target_1-bias_0: 440', '[train] target_1-bias_1: 5529']
get_utk_face - split: valid, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_race-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [583, 684]
Target 1: [457, 646]
Binary Target 1
---------------------------
Target 0: [583, 684]
Target 1: [457, 646]
===================================
Normal Label Distribution: 
Target 0: [583, 684]
Target 1: [457, 646]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 2370, target_attr: gender, bias_attr: race bias_rate: 0.9
['[valid] target_0-bias_0: 583', '[valid] target_0-bias_1: 684', '[valid] target_1-bias_0: 457', '[valid] target_1-bias_1: 646']
get_utk_face - split: test, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_race-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [558, 677]
Target 1: [462, 673]
Binary Target 1
---------------------------
Target 0: [558, 677]
Target 1: [462, 673]
===================================
Normal Label Distribution: 
Target 0: [558, 677]
Target 1: [462, 673]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 2370, target_attr: gender, bias_attr: race bias_rate: 0.9
['[test] target_0-bias_0: 558', '[test] target_0-bias_1: 677', '[test] target_1-bias_0: 462', '[test] target_1-bias_1: 673']
decay_epochs: [6, 13]
[1 / 20] Learning rate: 0.001 weight: 0.01
[1 / 20] Loss: 4.884139876414532 CE Loss: 0.565857193436839 Con Loss: 4.878481295237953
[1 / 20] tensor([[0.862, 0.804],
        [0.710, 0.762]]) {'epoch': 1, 'valid/acc': 78.186, 'valid/acc_unbiased': 77.811, 'valid/diff': 0.445, 'valid/acc_skew': 77.589, 'valid/acc_align': 78.034, 'test/acc': 78.734, 'test/acc_unbiased': 78.444, 'test/diff': 5.538, 'test/acc_skew': 75.675, 'test/acc_align': 81.213}
[1 / 20] best valid accuracy: 77.811 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 78.186, 'best_valid_valid/acc_unbiased': 77.811, 'best_valid_valid/diff': 0.445, 'best_valid_valid/acc_skew': 77.589, 'best_valid_valid/acc_align': 78.034, 'best_valid_test/acc': 78.734, 'best_valid_test/acc_unbiased': 78.444, 'best_valid_test/diff': 5.538, 'best_valid_test/acc_skew': 75.675, 'best_valid_test/acc_align': 81.213}
[1 / 20] best test accuracy: 78.444 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 78.186, 'best_test_valid/acc_unbiased': 77.811, 'best_test_valid/diff': 0.445, 'best_test_valid/acc_skew': 77.589, 'best_test_valid/acc_align': 78.034, 'best_test_test/acc': 78.734, 'best_test_test/acc_unbiased': 78.444, 'best_test_test/diff': 5.538, 'best_test_test/acc_skew': 75.675, 'best_test_test/acc_align': 81.213}
[2 / 20] Learning rate: 0.001 weight: 0.01
[2 / 20] Loss: 4.737774335098825 CE Loss: 0.44968586121610804 Con Loss: 4.733277456303117
[2 / 20] tensor([[0.812, 0.812],
        [0.747, 0.774]]) {'epoch': 2, 'valid/acc': 77.89, 'valid/acc_unbiased': 77.762, 'valid/diff': 1.989, 'valid/acc_skew': 77.111, 'valid/acc_align': 78.412, 'test/acc': 78.861, 'test/acc_unbiased': 78.628, 'test/diff': 1.399, 'test/acc_skew': 77.958, 'test/acc_align': 79.299}
[2 / 20] best valid accuracy: 77.811 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 78.186, 'best_valid_valid/acc_unbiased': 77.811, 'best_valid_valid/diff': 0.445, 'best_valid_valid/acc_skew': 77.589, 'best_valid_valid/acc_align': 78.034, 'best_valid_test/acc': 78.734, 'best_valid_test/acc_unbiased': 78.444, 'best_valid_test/diff': 5.538, 'best_valid_test/acc_skew': 75.675, 'best_valid_test/acc_align': 81.213}
[2 / 20] best test accuracy: 78.628 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 77.89, 'best_test_valid/acc_unbiased': 77.762, 'best_test_valid/diff': 1.989, 'best_test_valid/acc_skew': 77.111, 'best_test_valid/acc_align': 78.412, 'best_test_test/acc': 78.861, 'best_test_test/acc_unbiased': 78.628, 'best_test_test/diff': 1.399, 'best_test_test/acc_skew': 77.958, 'best_test_test/acc_align': 79.299}
[3 / 20] Learning rate: 0.001 weight: 0.01
[3 / 20] Loss: 4.700566627619731 CE Loss: 0.43138993331837966 Con Loss: 4.696252736305248
[3 / 20] tensor([[0.638, 0.561],
        [0.965, 0.970]]) {'epoch': 3, 'valid/acc': 76.16, 'valid/acc_unbiased': 77.534, 'valid/diff': 1.465, 'valid/acc_skew': 76.831, 'valid/acc_align': 78.237, 'test/acc': 77.426, 'test/acc_unbiased': 78.374, 'test/diff': 4.08, 'test/acc_skew': 76.333, 'test/acc_align': 80.414}
[3 / 20] best valid accuracy: 77.811 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 78.186, 'best_valid_valid/acc_unbiased': 77.811, 'best_valid_valid/diff': 0.445, 'best_valid_valid/acc_skew': 77.589, 'best_valid_valid/acc_align': 78.034, 'best_valid_test/acc': 78.734, 'best_valid_test/acc_unbiased': 78.444, 'best_valid_test/diff': 5.538, 'best_valid_test/acc_skew': 75.675, 'best_valid_test/acc_align': 81.213}
[3 / 20] best test accuracy: 78.628 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 77.89, 'best_test_valid/acc_unbiased': 77.762, 'best_test_valid/diff': 1.989, 'best_test_valid/acc_skew': 77.111, 'best_test_valid/acc_align': 78.412, 'best_test_test/acc': 78.861, 'best_test_test/acc_unbiased': 78.628, 'best_test_test/diff': 1.399, 'best_test_test/acc_skew': 77.958, 'best_test_test/acc_align': 79.299}
[4 / 20] Learning rate: 0.001 weight: 0.01
[4 / 20] Loss: 4.6867903022431 CE Loss: 0.40883699692185765 Con Loss: 4.682701936752521
[4 / 20] tensor([[0.939, 0.886],
        [0.582, 0.666]]) {'epoch': 4, 'valid/acc': 78.059, 'valid/acc_unbiased': 76.952, 'valid/diff': 3.233, 'valid/acc_skew': 75.336, 'valid/acc_align': 78.569, 'test/acc': 77.679, 'test/acc_unbiased': 76.831, 'test/diff': 6.812, 'test/acc_skew': 73.426, 'test/acc_align': 80.237}
[4 / 20] best valid accuracy: 77.811 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 78.186, 'best_valid_valid/acc_unbiased': 77.811, 'best_valid_valid/diff': 0.445, 'best_valid_valid/acc_skew': 77.589, 'best_valid_valid/acc_align': 78.034, 'best_valid_test/acc': 78.734, 'best_valid_test/acc_unbiased': 78.444, 'best_valid_test/diff': 5.538, 'best_valid_test/acc_skew': 75.675, 'best_valid_test/acc_align': 81.213}
[4 / 20] best test accuracy: 78.628 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 77.89, 'best_test_valid/acc_unbiased': 77.762, 'best_test_valid/diff': 1.989, 'best_test_valid/acc_skew': 77.111, 'best_test_valid/acc_align': 78.412, 'best_test_test/acc': 78.861, 'best_test_test/acc_unbiased': 78.628, 'best_test_test/diff': 1.399, 'best_test_test/acc_skew': 77.958, 'best_test_test/acc_align': 79.299}
[5 / 20] Learning rate: 0.001 weight: 0.01
[5 / 20] Loss: 4.659667915690521 CE Loss: 0.4062469246883169 Con Loss: 4.655605476736848
[5 / 20] tensor([[0.667, 0.650],
        [0.929, 0.945]]) {'epoch': 5, 'valid/acc': 79.578, 'valid/acc_unbiased': 80.633, 'valid/diff': 1.548, 'valid/acc_skew': 80.89, 'valid/acc_align': 80.377, 'test/acc': 79.198, 'test/acc_unbiased': 79.755, 'test/diff': 1.66, 'test/acc_skew': 78.925, 'test/acc_align': 80.584}
[5 / 20] best valid accuracy: 80.633 at epoch 5 
 best_stats: {'best_valid_epoch': 5, 'best_valid_valid/acc': 79.578, 'best_valid_valid/acc_unbiased': 80.633, 'best_valid_valid/diff': 1.548, 'best_valid_valid/acc_skew': 80.89, 'best_valid_valid/acc_align': 80.377, 'best_valid_test/acc': 79.198, 'best_valid_test/acc_unbiased': 79.755, 'best_valid_test/diff': 1.66, 'best_valid_test/acc_skew': 78.925, 'best_valid_test/acc_align': 80.584}
[5 / 20] best test accuracy: 79.755 at epoch 5 
 best_stats: {'best_test_epoch': 5, 'best_test_valid/acc': 79.578, 'best_test_valid/acc_unbiased': 80.633, 'best_test_valid/diff': 1.548, 'best_test_valid/acc_skew': 80.89, 'best_test_valid/acc_align': 80.377, 'best_test_test/acc': 79.198, 'best_test_test/acc_unbiased': 79.755, 'best_test_test/diff': 1.66, 'best_test_test/acc_skew': 78.925, 'best_test_test/acc_align': 80.584}
[6 / 20] Learning rate: 0.001 weight: 0.01
[6 / 20] Loss: 4.640097481963575 CE Loss: 0.38293116154642787 Con Loss: 4.636268156339274
[6 / 20] tensor([[0.740, 0.690],
        [0.913, 0.933]]) {'epoch': 6, 'valid/acc': 82.194, 'valid/acc_unbiased': 82.985, 'valid/diff': 3.139, 'valid/acc_skew': 82.062, 'valid/acc_align': 83.908, 'test/acc': 81.435, 'test/acc_unbiased': 81.913, 'test/diff': 3.503, 'test/acc_skew': 80.161, 'test/acc_align': 83.664}
[6 / 20] best valid accuracy: 82.985 at epoch 6 
 best_stats: {'best_valid_epoch': 6, 'best_valid_valid/acc': 82.194, 'best_valid_valid/acc_unbiased': 82.985, 'best_valid_valid/diff': 3.139, 'best_valid_valid/acc_skew': 82.062, 'best_valid_valid/acc_align': 83.908, 'best_valid_test/acc': 81.435, 'best_valid_test/acc_unbiased': 81.913, 'best_valid_test/diff': 3.503, 'best_valid_test/acc_skew': 80.161, 'best_valid_test/acc_align': 83.664}
[6 / 20] best test accuracy: 81.913 at epoch 6 
 best_stats: {'best_test_epoch': 6, 'best_test_valid/acc': 82.194, 'best_test_valid/acc_unbiased': 82.985, 'best_test_valid/diff': 3.139, 'best_test_valid/acc_skew': 82.062, 'best_test_valid/acc_align': 83.908, 'best_test_test/acc': 81.435, 'best_test_test/acc_unbiased': 81.913, 'best_test_test/diff': 3.503, 'best_test_test/acc_skew': 80.161, 'best_test_test/acc_align': 83.664}
[7 / 20] Learning rate: 0.0001 weight: 0.01
[7 / 20] Loss: 4.594449312760226 CE Loss: 0.3446173686670524 Con Loss: 4.591003133123127
[7 / 20] tensor([[0.844, 0.808],
        [0.877, 0.886]]) {'epoch': 7, 'valid/acc': 85.063, 'valid/acc_unbiased': 85.355, 'valid/diff': 3.485, 'valid/acc_skew': 84.297, 'valid/acc_align': 86.414, 'test/acc': 85.19, 'test/acc_unbiased': 85.357, 'test/diff': 2.254, 'test/acc_skew': 84.23, 'test/acc_align': 86.484}
[7 / 20] best valid accuracy: 85.355 at epoch 7 
 best_stats: {'best_valid_epoch': 7, 'best_valid_valid/acc': 85.063, 'best_valid_valid/acc_unbiased': 85.355, 'best_valid_valid/diff': 3.485, 'best_valid_valid/acc_skew': 84.297, 'best_valid_valid/acc_align': 86.414, 'best_valid_test/acc': 85.19, 'best_valid_test/acc_unbiased': 85.357, 'best_valid_test/diff': 2.254, 'best_valid_test/acc_skew': 84.23, 'best_valid_test/acc_align': 86.484}
[7 / 20] best test accuracy: 85.357 at epoch 7 
 best_stats: {'best_test_epoch': 7, 'best_test_valid/acc': 85.063, 'best_test_valid/acc_unbiased': 85.355, 'best_test_valid/diff': 3.485, 'best_test_valid/acc_skew': 84.297, 'best_test_valid/acc_align': 86.414, 'best_test_test/acc': 85.19, 'best_test_test/acc_unbiased': 85.357, 'best_test_test/diff': 2.254, 'best_test_test/acc_skew': 84.23, 'best_test_test/acc_align': 86.484}
[8 / 20] Learning rate: 0.0001 weight: 0.01
[8 / 20] Loss: 4.571460691063854 CE Loss: 0.3229802442417312 Con Loss: 4.5682309082277
[8 / 20] tensor([[0.851, 0.814],
        [0.866, 0.887]]) {'epoch': 8, 'valid/acc': 84.979, 'valid/acc_unbiased': 85.227, 'valid/diff': 3.54, 'valid/acc_skew': 83.458, 'valid/acc_align': 86.997, 'test/acc': 85.359, 'test/acc_unbiased': 85.45, 'test/diff': 2.932, 'test/acc_skew': 83.984, 'test/acc_align': 86.916}
[8 / 20] best valid accuracy: 85.355 at epoch 7 
 best_stats: {'best_valid_epoch': 7, 'best_valid_valid/acc': 85.063, 'best_valid_valid/acc_unbiased': 85.355, 'best_valid_valid/diff': 3.485, 'best_valid_valid/acc_skew': 84.297, 'best_valid_valid/acc_align': 86.414, 'best_valid_test/acc': 85.19, 'best_valid_test/acc_unbiased': 85.357, 'best_valid_test/diff': 2.254, 'best_valid_test/acc_skew': 84.23, 'best_valid_test/acc_align': 86.484}
[8 / 20] best test accuracy: 85.450 at epoch 8 
 best_stats: {'best_test_epoch': 8, 'best_test_valid/acc': 84.979, 'best_test_valid/acc_unbiased': 85.227, 'best_test_valid/diff': 3.54, 'best_test_valid/acc_skew': 83.458, 'best_test_valid/acc_align': 86.997, 'best_test_test/acc': 85.359, 'best_test_test/acc_unbiased': 85.45, 'best_test_test/diff': 2.932, 'best_test_test/acc_skew': 83.984, 'best_test_test/acc_align': 86.916}
[9 / 20] Learning rate: 0.0001 weight: 0.01
[9 / 20] Loss: 4.551999346229028 CE Loss: 0.3108203680326789 Con Loss: 4.548891165944179
[9 / 20] tensor([[0.849, 0.775],
        [0.883, 0.909]]) {'epoch': 9, 'valid/acc': 85.57, 'valid/acc_unbiased': 85.957, 'valid/diff': 4.784, 'valid/acc_skew': 83.565, 'valid/acc_align': 88.349, 'test/acc': 85.19, 'test/acc_unbiased': 85.436, 'test/diff': 5.011, 'test/acc_skew': 82.93, 'test/acc_align': 87.941}
[9 / 20] best valid accuracy: 85.957 at epoch 9 
 best_stats: {'best_valid_epoch': 9, 'best_valid_valid/acc': 85.57, 'best_valid_valid/acc_unbiased': 85.957, 'best_valid_valid/diff': 4.784, 'best_valid_valid/acc_skew': 83.565, 'best_valid_valid/acc_align': 88.349, 'best_valid_test/acc': 85.19, 'best_valid_test/acc_unbiased': 85.436, 'best_valid_test/diff': 5.011, 'best_valid_test/acc_skew': 82.93, 'best_valid_test/acc_align': 87.941}
[9 / 20] best test accuracy: 85.450 at epoch 8 
 best_stats: {'best_test_epoch': 8, 'best_test_valid/acc': 84.979, 'best_test_valid/acc_unbiased': 85.227, 'best_test_valid/diff': 3.54, 'best_test_valid/acc_skew': 83.458, 'best_test_valid/acc_align': 86.997, 'best_test_test/acc': 85.359, 'best_test_test/acc_unbiased': 85.45, 'best_test_test/diff': 2.932, 'best_test_test/acc_skew': 83.984, 'best_test_test/acc_align': 86.916}
[10 / 20] Learning rate: 0.0001 weight: 0.01
[10 / 20] Loss: 4.52766130748989 CE Loss: 0.3004178873441928 Con Loss: 4.524657142633575
[10 / 20] tensor([[0.869, 0.812],
        [0.857, 0.902]]) {'epoch': 10, 'valid/acc': 85.781, 'valid/acc_unbiased': 86.036, 'valid/diff': 4.428, 'valid/acc_skew': 83.823, 'valid/acc_align': 88.25, 'test/acc': 85.992, 'test/acc_unbiased': 86.016, 'test/diff': 5.078, 'test/acc_skew': 83.478, 'test/acc_align': 88.555}
[10 / 20] best valid accuracy: 86.036 at epoch 10 
 best_stats: {'best_valid_epoch': 10, 'best_valid_valid/acc': 85.781, 'best_valid_valid/acc_unbiased': 86.036, 'best_valid_valid/diff': 4.428, 'best_valid_valid/acc_skew': 83.823, 'best_valid_valid/acc_align': 88.25, 'best_valid_test/acc': 85.992, 'best_valid_test/acc_unbiased': 86.016, 'best_valid_test/diff': 5.078, 'best_valid_test/acc_skew': 83.478, 'best_valid_test/acc_align': 88.555}
[10 / 20] best test accuracy: 86.016 at epoch 10 
 best_stats: {'best_test_epoch': 10, 'best_test_valid/acc': 85.781, 'best_test_valid/acc_unbiased': 86.036, 'best_test_valid/diff': 4.428, 'best_test_valid/acc_skew': 83.823, 'best_test_valid/acc_align': 88.25, 'best_test_test/acc': 85.992, 'best_test_test/acc_unbiased': 86.016, 'best_test_test/diff': 5.078, 'best_test_test/acc_skew': 83.478, 'best_test_test/acc_align': 88.555}
[11 / 20] Learning rate: 0.0001 weight: 0.01
[11 / 20] Loss: 4.520930489893365 CE Loss: 0.2989183547599773 Con Loss: 4.517941326906531
[11 / 20] tensor([[0.851, 0.796],
        [0.877, 0.902]]) {'epoch': 11, 'valid/acc': 85.654, 'valid/acc_unbiased': 85.856, 'valid/diff': 5.308, 'valid/acc_skew': 83.202, 'valid/acc_align': 88.51, 'test/acc': 85.485, 'test/acc_unbiased': 85.649, 'test/diff': 4.02, 'test/acc_skew': 83.639, 'test/acc_align': 87.659}
[11 / 20] best valid accuracy: 86.036 at epoch 10 
 best_stats: {'best_valid_epoch': 10, 'best_valid_valid/acc': 85.781, 'best_valid_valid/acc_unbiased': 86.036, 'best_valid_valid/diff': 4.428, 'best_valid_valid/acc_skew': 83.823, 'best_valid_valid/acc_align': 88.25, 'best_valid_test/acc': 85.992, 'best_valid_test/acc_unbiased': 86.016, 'best_valid_test/diff': 5.078, 'best_valid_test/acc_skew': 83.478, 'best_valid_test/acc_align': 88.555}
[11 / 20] best test accuracy: 86.016 at epoch 10 
 best_stats: {'best_test_epoch': 10, 'best_test_valid/acc': 85.781, 'best_test_valid/acc_unbiased': 86.036, 'best_test_valid/diff': 4.428, 'best_test_valid/acc_skew': 83.823, 'best_test_valid/acc_align': 88.25, 'best_test_test/acc': 85.992, 'best_test_test/acc_unbiased': 86.016, 'best_test_test/diff': 5.078, 'best_test_test/acc_skew': 83.478, 'best_test_test/acc_align': 88.555}
[12 / 20] Learning rate: 0.0001 weight: 0.01
[12 / 20] Loss: 4.522700505235708 CE Loss: 0.2966616964881277 Con Loss: 4.51973386739393
[12 / 20] tensor([[0.855, 0.817],
        [0.859, 0.892]]) {'epoch': 12, 'valid/acc': 85.949, 'valid/acc_unbiased': 86.023, 'valid/diff': 3.957, 'valid/acc_skew': 84.044, 'valid/acc_align': 88.001, 'test/acc': 85.527, 'test/acc_unbiased': 85.563, 'test/diff': 3.511, 'test/acc_skew': 83.807, 'test/acc_align': 87.318}
[12 / 20] best valid accuracy: 86.036 at epoch 10 
 best_stats: {'best_valid_epoch': 10, 'best_valid_valid/acc': 85.781, 'best_valid_valid/acc_unbiased': 86.036, 'best_valid_valid/diff': 4.428, 'best_valid_valid/acc_skew': 83.823, 'best_valid_valid/acc_align': 88.25, 'best_valid_test/acc': 85.992, 'best_valid_test/acc_unbiased': 86.016, 'best_valid_test/diff': 5.078, 'best_valid_test/acc_skew': 83.478, 'best_valid_test/acc_align': 88.555}
[12 / 20] best test accuracy: 86.016 at epoch 10 
 best_stats: {'best_test_epoch': 10, 'best_test_valid/acc': 85.781, 'best_test_valid/acc_unbiased': 86.036, 'best_test_valid/diff': 4.428, 'best_test_valid/acc_skew': 83.823, 'best_test_valid/acc_align': 88.25, 'best_test_test/acc': 85.992, 'best_test_test/acc_unbiased': 86.016, 'best_test_test/diff': 5.078, 'best_test_test/acc_skew': 83.478, 'best_test_test/acc_align': 88.555}
[13 / 20] Learning rate: 0.0001 weight: 0.01
[13 / 20] Loss: 4.504235130801557 CE Loss: 0.28223180792691244 Con Loss: 4.501412800779105
[13 / 20] tensor([[0.860, 0.787],
        [0.870, 0.909]]) {'epoch': 13, 'valid/acc': 85.907, 'valid/acc_unbiased': 86.139, 'valid/diff': 4.194, 'valid/acc_skew': 84.041, 'valid/acc_align': 88.236, 'test/acc': 85.527, 'test/acc_unbiased': 85.675, 'test/diff': 5.607, 'test/acc_skew': 82.871, 'test/acc_align': 88.479}
[13 / 20] best valid accuracy: 86.139 at epoch 13 
 best_stats: {'best_valid_epoch': 13, 'best_valid_valid/acc': 85.907, 'best_valid_valid/acc_unbiased': 86.139, 'best_valid_valid/diff': 4.194, 'best_valid_valid/acc_skew': 84.041, 'best_valid_valid/acc_align': 88.236, 'best_valid_test/acc': 85.527, 'best_valid_test/acc_unbiased': 85.675, 'best_valid_test/diff': 5.607, 'best_valid_test/acc_skew': 82.871, 'best_valid_test/acc_align': 88.479}
[13 / 20] best test accuracy: 86.016 at epoch 10 
 best_stats: {'best_test_epoch': 10, 'best_test_valid/acc': 85.781, 'best_test_valid/acc_unbiased': 86.036, 'best_test_valid/diff': 4.428, 'best_test_valid/acc_skew': 83.823, 'best_test_valid/acc_align': 88.25, 'best_test_test/acc': 85.992, 'best_test_test/acc_unbiased': 86.016, 'best_test_test/diff': 5.078, 'best_test_test/acc_skew': 83.478, 'best_test_test/acc_align': 88.555}
[14 / 20] Learning rate: 1e-05 weight: 0.01
[14 / 20] Loss: 4.487235690629325 CE Loss: 0.28655375546801665 Con Loss: 4.48437013877433
[14 / 20] tensor([[0.864, 0.790],
        [0.870, 0.906]]) {'epoch': 14, 'valid/acc': 85.992, 'valid/acc_unbiased': 86.184, 'valid/diff': 4.137, 'valid/acc_skew': 84.115, 'valid/acc_align': 88.252, 'test/acc': 85.612, 'test/acc_unbiased': 85.764, 'test/diff': 5.49, 'test/acc_skew': 83.019, 'test/acc_align': 88.509}
[14 / 20] best valid accuracy: 86.184 at epoch 14 
 best_stats: {'best_valid_epoch': 14, 'best_valid_valid/acc': 85.992, 'best_valid_valid/acc_unbiased': 86.184, 'best_valid_valid/diff': 4.137, 'best_valid_valid/acc_skew': 84.115, 'best_valid_valid/acc_align': 88.252, 'best_valid_test/acc': 85.612, 'best_valid_test/acc_unbiased': 85.764, 'best_valid_test/diff': 5.49, 'best_valid_test/acc_skew': 83.019, 'best_valid_test/acc_align': 88.509}
[14 / 20] best test accuracy: 86.016 at epoch 10 
 best_stats: {'best_test_epoch': 10, 'best_test_valid/acc': 85.781, 'best_test_valid/acc_unbiased': 86.036, 'best_test_valid/diff': 4.428, 'best_test_valid/acc_skew': 83.823, 'best_test_valid/acc_align': 88.25, 'best_test_test/acc': 85.992, 'best_test_test/acc_unbiased': 86.016, 'best_test_test/diff': 5.078, 'best_test_test/acc_skew': 83.478, 'best_test_test/acc_align': 88.555}
[15 / 20] Learning rate: 1e-05 weight: 0.01
[15 / 20] Loss: 4.4887414048391765 CE Loss: 0.2900847143781307 Con Loss: 4.485840572619683
[15 / 20] tensor([[0.855, 0.793],
        [0.874, 0.917]]) {'epoch': 15, 'valid/acc': 86.076, 'valid/acc_unbiased': 86.319, 'valid/diff': 4.264, 'valid/acc_skew': 84.187, 'valid/acc_align': 88.451, 'test/acc': 85.865, 'test/acc_unbiased': 85.982, 'test/diff': 5.198, 'test/acc_skew': 83.383, 'test/acc_align': 88.581}
[15 / 20] best valid accuracy: 86.319 at epoch 15 
 best_stats: {'best_valid_epoch': 15, 'best_valid_valid/acc': 86.076, 'best_valid_valid/acc_unbiased': 86.319, 'best_valid_valid/diff': 4.264, 'best_valid_valid/acc_skew': 84.187, 'best_valid_valid/acc_align': 88.451, 'best_valid_test/acc': 85.865, 'best_valid_test/acc_unbiased': 85.982, 'best_valid_test/diff': 5.198, 'best_valid_test/acc_skew': 83.383, 'best_valid_test/acc_align': 88.581}
[15 / 20] best test accuracy: 86.016 at epoch 10 
 best_stats: {'best_test_epoch': 10, 'best_test_valid/acc': 85.781, 'best_test_valid/acc_unbiased': 86.036, 'best_test_valid/diff': 4.428, 'best_test_valid/acc_skew': 83.823, 'best_test_valid/acc_align': 88.25, 'best_test_test/acc': 85.992, 'best_test_test/acc_unbiased': 86.016, 'best_test_test/diff': 5.078, 'best_test_test/acc_skew': 83.478, 'best_test_test/acc_align': 88.555}
[16 / 20] Learning rate: 1e-05 weight: 0.01
[16 / 20] Loss: 4.483682913801157 CE Loss: 0.28912815796334085 Con Loss: 4.480791616928525
[16 / 20] tensor([[0.849, 0.781],
        [0.883, 0.920]]) {'epoch': 16, 'valid/acc': 86.371, 'valid/acc_unbiased': 86.67, 'valid/diff': 3.579, 'valid/acc_skew': 84.88, 'valid/acc_align': 88.459, 'test/acc': 85.654, 'test/acc_unbiased': 85.843, 'test/diff': 5.236, 'test/acc_skew': 83.225, 'test/acc_align': 88.461}
[16 / 20] best valid accuracy: 86.670 at epoch 16 
 best_stats: {'best_valid_epoch': 16, 'best_valid_valid/acc': 86.371, 'best_valid_valid/acc_unbiased': 86.67, 'best_valid_valid/diff': 3.579, 'best_valid_valid/acc_skew': 84.88, 'best_valid_valid/acc_align': 88.459, 'best_valid_test/acc': 85.654, 'best_valid_test/acc_unbiased': 85.843, 'best_valid_test/diff': 5.236, 'best_valid_test/acc_skew': 83.225, 'best_valid_test/acc_align': 88.461}
[16 / 20] best test accuracy: 86.016 at epoch 10 
 best_stats: {'best_test_epoch': 10, 'best_test_valid/acc': 85.781, 'best_test_valid/acc_unbiased': 86.036, 'best_test_valid/diff': 4.428, 'best_test_valid/acc_skew': 83.823, 'best_test_valid/acc_align': 88.25, 'best_test_test/acc': 85.992, 'best_test_test/acc_unbiased': 86.016, 'best_test_test/diff': 5.078, 'best_test_test/acc_skew': 83.478, 'best_test_test/acc_align': 88.555}
[17 / 20] Learning rate: 1e-05 weight: 0.01
[17 / 20] Loss: 4.4845848816554685 CE Loss: 0.2812811217623958 Con Loss: 4.48177206114829
[17 / 20] tensor([[0.853, 0.781],
        [0.890, 0.921]]) {'epoch': 17, 'valid/acc': 86.034, 'valid/acc_unbiased': 86.389, 'valid/diff': 3.969, 'valid/acc_skew': 84.405, 'valid/acc_align': 88.374, 'test/acc': 85.907, 'test/acc_unbiased': 86.132, 'test/diff': 5.165, 'test/acc_skew': 83.55, 'test/acc_align': 88.715}
[17 / 20] best valid accuracy: 86.670 at epoch 16 
 best_stats: {'best_valid_epoch': 16, 'best_valid_valid/acc': 86.371, 'best_valid_valid/acc_unbiased': 86.67, 'best_valid_valid/diff': 3.579, 'best_valid_valid/acc_skew': 84.88, 'best_valid_valid/acc_align': 88.459, 'best_valid_test/acc': 85.654, 'best_valid_test/acc_unbiased': 85.843, 'best_valid_test/diff': 5.236, 'best_valid_test/acc_skew': 83.225, 'best_valid_test/acc_align': 88.461}
[17 / 20] best test accuracy: 86.132 at epoch 17 
 best_stats: {'best_test_epoch': 17, 'best_test_valid/acc': 86.034, 'best_test_valid/acc_unbiased': 86.389, 'best_test_valid/diff': 3.969, 'best_test_valid/acc_skew': 84.405, 'best_test_valid/acc_align': 88.374, 'best_test_test/acc': 85.907, 'best_test_test/acc_unbiased': 86.132, 'best_test_test/diff': 5.165, 'best_test_test/acc_skew': 83.55, 'best_test_test/acc_align': 88.715}
[18 / 20] Learning rate: 1e-05 weight: 0.01
[18 / 20] Loss: 4.496154033247583 CE Loss: 0.28701244824801847 Con Loss: 4.493283905710692
[18 / 20] tensor([[0.866, 0.799],
        [0.868, 0.912]]) {'epoch': 18, 'valid/acc': 86.329, 'valid/acc_unbiased': 86.538, 'valid/diff': 4.115, 'valid/acc_skew': 84.48, 'valid/acc_align': 88.595, 'test/acc': 86.034, 'test/acc_unbiased': 86.125, 'test/diff': 5.542, 'test/acc_skew': 83.354, 'test/acc_align': 88.896}
[18 / 20] best valid accuracy: 86.670 at epoch 16 
 best_stats: {'best_valid_epoch': 16, 'best_valid_valid/acc': 86.371, 'best_valid_valid/acc_unbiased': 86.67, 'best_valid_valid/diff': 3.579, 'best_valid_valid/acc_skew': 84.88, 'best_valid_valid/acc_align': 88.459, 'best_valid_test/acc': 85.654, 'best_valid_test/acc_unbiased': 85.843, 'best_valid_test/diff': 5.236, 'best_valid_test/acc_skew': 83.225, 'best_valid_test/acc_align': 88.461}
[18 / 20] best test accuracy: 86.132 at epoch 17 
 best_stats: {'best_test_epoch': 17, 'best_test_valid/acc': 86.034, 'best_test_valid/acc_unbiased': 86.389, 'best_test_valid/diff': 3.969, 'best_test_valid/acc_skew': 84.405, 'best_test_valid/acc_align': 88.374, 'best_test_test/acc': 85.907, 'best_test_test/acc_unbiased': 86.132, 'best_test_test/diff': 5.165, 'best_test_test/acc_skew': 83.55, 'best_test_test/acc_align': 88.715}
[19 / 20] Learning rate: 1e-05 weight: 0.01
[19 / 20] Loss: 4.485497432083197 CE Loss: 0.27866199558074445 Con Loss: 4.482710788050997
[19 / 20] tensor([[0.866, 0.796],
        [0.872, 0.915]]) {'epoch': 19, 'valid/acc': 86.371, 'valid/acc_unbiased': 86.588, 'valid/diff': 3.998, 'valid/acc_skew': 84.589, 'valid/acc_align': 88.587, 'test/acc': 86.118, 'test/acc_unbiased': 86.234, 'test/diff': 5.622, 'test/acc_skew': 83.423, 'test/acc_align': 89.045}
[19 / 20] best valid accuracy: 86.670 at epoch 16 
 best_stats: {'best_valid_epoch': 16, 'best_valid_valid/acc': 86.371, 'best_valid_valid/acc_unbiased': 86.67, 'best_valid_valid/diff': 3.579, 'best_valid_valid/acc_skew': 84.88, 'best_valid_valid/acc_align': 88.459, 'best_valid_test/acc': 85.654, 'best_valid_test/acc_unbiased': 85.843, 'best_valid_test/diff': 5.236, 'best_valid_test/acc_skew': 83.225, 'best_valid_test/acc_align': 88.461}
[19 / 20] best test accuracy: 86.234 at epoch 19 
 best_stats: {'best_test_epoch': 19, 'best_test_valid/acc': 86.371, 'best_test_valid/acc_unbiased': 86.588, 'best_test_valid/diff': 3.998, 'best_test_valid/acc_skew': 84.589, 'best_test_valid/acc_align': 88.587, 'best_test_test/acc': 86.118, 'best_test_test/acc_unbiased': 86.234, 'best_test_test/diff': 5.622, 'best_test_test/acc_skew': 83.423, 'best_test_test/acc_align': 89.045}
[20 / 20] Learning rate: 1e-05 weight: 0.01
[20 / 20] Loss: 4.481056766314527 CE Loss: 0.275116143101829 Con Loss: 4.478305618375496
[20 / 20] tensor([[0.862, 0.798],
        [0.874, 0.918]]) {'epoch': 20, 'valid/acc': 86.118, 'valid/acc_unbiased': 86.337, 'valid/diff': 4.517, 'valid/acc_skew': 84.078, 'valid/acc_align': 88.595, 'test/acc': 86.203, 'test/acc_unbiased': 86.309, 'test/diff': 5.409, 'test/acc_skew': 83.605, 'test/acc_align': 89.014}
[20 / 20] best valid accuracy: 86.670 at epoch 16 
 best_stats: {'best_valid_epoch': 16, 'best_valid_valid/acc': 86.371, 'best_valid_valid/acc_unbiased': 86.67, 'best_valid_valid/diff': 3.579, 'best_valid_valid/acc_skew': 84.88, 'best_valid_valid/acc_align': 88.459, 'best_valid_test/acc': 85.654, 'best_valid_test/acc_unbiased': 85.843, 'best_valid_test/diff': 5.236, 'best_valid_test/acc_skew': 83.225, 'best_valid_test/acc_align': 88.461}
[20 / 20] best test accuracy: 86.309 at epoch 20 
 best_stats: {'best_test_epoch': 20, 'best_test_valid/acc': 86.118, 'best_test_valid/acc_unbiased': 86.337, 'best_test_valid/diff': 4.517, 'best_test_valid/acc_skew': 84.078, 'best_test_valid/acc_align': 88.595, 'best_test_test/acc': 86.203, 'best_test_test/acc_unbiased': 86.309, 'best_test_test/diff': 5.409, 'best_test_test/acc_skew': 83.605, 'best_test_test/acc_align': 89.014}
Total training time: 0:16:41
