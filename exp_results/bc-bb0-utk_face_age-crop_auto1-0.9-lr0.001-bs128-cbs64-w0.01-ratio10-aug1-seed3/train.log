Log level set to: INFO
Set seed: 3
=======> Using Fixed Random Seed: 3 <========
save_path: exp_results/bc-bb0-utk_face_age-crop_auto1-0.9-lr0.001-bs128-cbs64-w0.01-ratio10-aug1-seed3
get_utk_face - split: train, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_age-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
Binary Target 1
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Normal Label Distribution: 
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
Binary Target 1
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Normal Label Distribution: 
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 10684, target_attr: gender, bias_attr: age bias_rate: 0.9
['[train] target_0-bias_0: 8237', '[train] target_0-bias_1: 147', '[train] target_1-bias_0: 823', '[train] target_1-bias_1: 1477']
confusion_matrix - 
 original: tensor([[8237.,  823.],
        [ 147., 1477.]]), 
 normalized: tensor([[0.909, 0.091],
        [0.091, 0.909]]), 
 b|y: tensor([[0.982, 0.018],
        [0.358, 0.642]])
get_utk_face - split: train, aug: 1, given_y: True, ratio: 10
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_age-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
Binary Target 1
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Normal Label Distribution: 
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
Binary Target 1
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Normal Label Distribution: 
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 10684, target_attr: gender, bias_attr: age bias_rate: 0.9
['[train] target_0-bias_0: 8237', '[train] target_0-bias_1: 147', '[train] target_1-bias_0: 823', '[train] target_1-bias_1: 1477']
get_utk_face - split: valid, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_age-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [1030, 195]
Target 1: [841, 202]
Binary Target 1
---------------------------
Target 0: [1030, 195]
Target 1: [841, 202]
===================================
Normal Label Distribution: 
Target 0: [1030, 195]
Target 1: [841, 202]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 2268, target_attr: gender, bias_attr: age bias_rate: 0.9
['[valid] target_0-bias_0: 1030', '[valid] target_0-bias_1: 195', '[valid] target_1-bias_0: 841', '[valid] target_1-bias_1: 202']
get_utk_face - split: test, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_age-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [1061, 176]
Target 1: [867, 165]
Binary Target 1
---------------------------
Target 0: [1061, 176]
Target 1: [867, 165]
===================================
Normal Label Distribution: 
Target 0: [1061, 176]
Target 1: [867, 165]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 2269, target_attr: gender, bias_attr: age bias_rate: 0.9
['[test] target_0-bias_0: 1061', '[test] target_0-bias_1: 176', '[test] target_1-bias_0: 867', '[test] target_1-bias_1: 165']
decay_epochs: [6, 13]
[1 / 20] Learning rate: 0.001 weight: 0.01
[1 / 20] Loss: 4.827371393594346 CE Loss: 0.5928153866063072 Con Loss: 4.82144325371317
[1 / 20] tensor([[0.984, 0.977],
        [0.336, 0.079]]) {'epoch': 1, 'valid/acc': 65.564, 'valid/acc_unbiased': 60.389, 'valid/diff': 9.431, 'valid/acc_skew': 65.105, 'valid/acc_align': 55.673, 'test/acc': 66.99, 'test/acc_unbiased': 59.392, 'test/diff': 13.178, 'test/acc_skew': 65.646, 'test/acc_align': 53.138}
[1 / 20] best valid accuracy: 60.389 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 65.564, 'best_valid_valid/acc_unbiased': 60.389, 'best_valid_valid/diff': 9.431, 'best_valid_valid/acc_skew': 65.105, 'best_valid_valid/acc_align': 55.673, 'best_valid_test/acc': 66.99, 'best_valid_test/acc_unbiased': 59.392, 'best_valid_test/diff': 13.178, 'best_valid_test/acc_skew': 65.646, 'best_valid_test/acc_align': 53.138}
[1 / 20] best test accuracy: 59.392 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 65.564, 'best_test_valid/acc_unbiased': 60.389, 'best_test_valid/diff': 9.431, 'best_test_valid/acc_skew': 65.105, 'best_test_valid/acc_align': 55.673, 'best_test_test/acc': 66.99, 'best_test_test/acc_unbiased': 59.392, 'best_test_test/diff': 13.178, 'best_test_test/acc_skew': 65.646, 'best_test_test/acc_align': 53.138}
[2 / 20] Learning rate: 0.001 weight: 0.01
[2 / 20] Loss: 4.620513677150736 CE Loss: 0.5192213656303366 Con Loss: 4.615321467494929
[2 / 20] tensor([[0.970, 0.994],
        [0.293, 0.079]]) {'epoch': 2, 'valid/acc': 63.272, 'valid/acc_unbiased': 57.166, 'valid/diff': 9.983, 'valid/acc_skew': 61.541, 'valid/acc_align': 52.791, 'test/acc': 64.83, 'test/acc_unbiased': 58.398, 'test/diff': 11.933, 'test/acc_skew': 64.364, 'test/acc_align': 52.431}
[2 / 20] best valid accuracy: 60.389 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 65.564, 'best_valid_valid/acc_unbiased': 60.389, 'best_valid_valid/diff': 9.431, 'best_valid_valid/acc_skew': 65.105, 'best_valid_valid/acc_align': 55.673, 'best_valid_test/acc': 66.99, 'best_valid_test/acc_unbiased': 59.392, 'best_valid_test/diff': 13.178, 'best_valid_test/acc_skew': 65.646, 'best_valid_test/acc_align': 53.138}
[2 / 20] best test accuracy: 59.392 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 65.564, 'best_test_valid/acc_unbiased': 60.389, 'best_test_valid/diff': 9.431, 'best_test_valid/acc_skew': 65.105, 'best_test_valid/acc_align': 55.673, 'best_test_test/acc': 66.99, 'best_test_test/acc_unbiased': 59.392, 'best_test_test/diff': 13.178, 'best_test_test/acc_skew': 65.646, 'best_test_test/acc_align': 53.138}
[3 / 20] Learning rate: 0.001 weight: 0.01
[3 / 20] Loss: 4.557144574394211 CE Loss: 0.5340149607028197 Con Loss: 4.551804437926537
[3 / 20] tensor([[0.931, 0.869],
        [0.580, 0.285]]) {'epoch': 3, 'valid/acc': 72.884, 'valid/acc_unbiased': 67.934, 'valid/diff': 10.587, 'valid/acc_skew': 70.444, 'valid/acc_align': 65.423, 'test/acc': 74.526, 'test/acc_unbiased': 66.638, 'test/diff': 17.86, 'test/acc_skew': 72.474, 'test/acc_align': 60.802}
[3 / 20] best valid accuracy: 67.934 at epoch 3 
 best_stats: {'best_valid_epoch': 3, 'best_valid_valid/acc': 72.884, 'best_valid_valid/acc_unbiased': 67.934, 'best_valid_valid/diff': 10.587, 'best_valid_valid/acc_skew': 70.444, 'best_valid_valid/acc_align': 65.423, 'best_valid_test/acc': 74.526, 'best_valid_test/acc_unbiased': 66.638, 'best_valid_test/diff': 17.86, 'best_valid_test/acc_skew': 72.474, 'best_valid_test/acc_align': 60.802}
[3 / 20] best test accuracy: 66.638 at epoch 3 
 best_stats: {'best_test_epoch': 3, 'best_test_valid/acc': 72.884, 'best_test_valid/acc_unbiased': 67.934, 'best_test_valid/diff': 10.587, 'best_test_valid/acc_skew': 70.444, 'best_test_valid/acc_align': 65.423, 'best_test_test/acc': 74.526, 'best_test_test/acc_unbiased': 66.638, 'best_test_test/diff': 17.86, 'best_test_test/acc_skew': 72.474, 'best_test_test/acc_align': 60.802}
[4 / 20] Learning rate: 0.001 weight: 0.01
[4 / 20] Loss: 4.581206740176174 CE Loss: 0.5074376683809123 Con Loss: 4.576132368032783
[4 / 20] tensor([[0.965, 0.756],
        [0.520, 0.588]]) {'epoch': 4, 'valid/acc': 74.647, 'valid/acc_unbiased': 69.917, 'valid/diff': 24.201, 'valid/acc_skew': 57.817, 'valid/acc_align': 82.018, 'test/acc': 75.143, 'test/acc_unbiased': 70.722, 'test/diff': 13.857, 'test/acc_skew': 63.793, 'test/acc_align': 77.65}
[4 / 20] best valid accuracy: 69.917 at epoch 4 
 best_stats: {'best_valid_epoch': 4, 'best_valid_valid/acc': 74.647, 'best_valid_valid/acc_unbiased': 69.917, 'best_valid_valid/diff': 24.201, 'best_valid_valid/acc_skew': 57.817, 'best_valid_valid/acc_align': 82.018, 'best_valid_test/acc': 75.143, 'best_valid_test/acc_unbiased': 70.722, 'best_valid_test/diff': 13.857, 'best_valid_test/acc_skew': 63.793, 'best_valid_test/acc_align': 77.65}
[4 / 20] best test accuracy: 70.722 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 74.647, 'best_test_valid/acc_unbiased': 69.917, 'best_test_valid/diff': 24.201, 'best_test_valid/acc_skew': 57.817, 'best_test_valid/acc_align': 82.018, 'best_test_test/acc': 75.143, 'best_test_test/acc_unbiased': 70.722, 'best_test_test/diff': 13.857, 'best_test_test/acc_skew': 63.793, 'best_test_test/acc_align': 77.65}
[5 / 20] Learning rate: 0.001 weight: 0.01
[5 / 20] Loss: 4.564803836319786 CE Loss: 0.47707190387751536 Con Loss: 4.560033109294301
[5 / 20] tensor([[0.940, 0.841],
        [0.600, 0.467]]) {'epoch': 5, 'valid/acc': 76.323, 'valid/acc_unbiased': 71.173, 'valid/diff': 11.302, 'valid/acc_skew': 70.02, 'valid/acc_align': 72.325, 'test/acc': 76.774, 'test/acc_unbiased': 71.176, 'test/diff': 11.594, 'test/acc_skew': 72.034, 'test/acc_align': 70.317}
[5 / 20] best valid accuracy: 71.173 at epoch 5 
 best_stats: {'best_valid_epoch': 5, 'best_valid_valid/acc': 76.323, 'best_valid_valid/acc_unbiased': 71.173, 'best_valid_valid/diff': 11.302, 'best_valid_valid/acc_skew': 70.02, 'best_valid_valid/acc_align': 72.325, 'best_valid_test/acc': 76.774, 'best_valid_test/acc_unbiased': 71.176, 'best_valid_test/diff': 11.594, 'best_valid_test/acc_skew': 72.034, 'best_valid_test/acc_align': 70.317}
[5 / 20] best test accuracy: 71.176 at epoch 5 
 best_stats: {'best_test_epoch': 5, 'best_test_valid/acc': 76.323, 'best_test_valid/acc_unbiased': 71.173, 'best_test_valid/diff': 11.302, 'best_test_valid/acc_skew': 70.02, 'best_test_valid/acc_align': 72.325, 'best_test_test/acc': 76.774, 'best_test_test/acc_unbiased': 71.176, 'best_test_test/diff': 11.594, 'best_test_test/acc_skew': 72.034, 'best_test_test/acc_align': 70.317}
[6 / 20] Learning rate: 0.001 weight: 0.01
[6 / 20] Loss: 4.5757091397964205 CE Loss: 0.4598384585241306 Con Loss: 4.571110752359931
[6 / 20] tensor([[0.933, 0.847],
        [0.653, 0.412]]) {'epoch': 6, 'valid/acc': 78.175, 'valid/acc_unbiased': 73.015, 'valid/diff': 11.963, 'valid/acc_skew': 73.108, 'valid/acc_align': 72.922, 'test/acc': 78.14, 'test/acc_unbiased': 71.115, 'test/diff': 16.36, 'test/acc_skew': 74.971, 'test/acc_align': 67.26}
[6 / 20] best valid accuracy: 73.015 at epoch 6 
 best_stats: {'best_valid_epoch': 6, 'best_valid_valid/acc': 78.175, 'best_valid_valid/acc_unbiased': 73.015, 'best_valid_valid/diff': 11.963, 'best_valid_valid/acc_skew': 73.108, 'best_valid_valid/acc_align': 72.922, 'best_valid_test/acc': 78.14, 'best_valid_test/acc_unbiased': 71.115, 'best_valid_test/diff': 16.36, 'best_valid_test/acc_skew': 74.971, 'best_valid_test/acc_align': 67.26}
[6 / 20] best test accuracy: 71.176 at epoch 5 
 best_stats: {'best_test_epoch': 5, 'best_test_valid/acc': 76.323, 'best_test_valid/acc_unbiased': 71.173, 'best_test_valid/diff': 11.302, 'best_test_valid/acc_skew': 70.02, 'best_test_valid/acc_align': 72.325, 'best_test_test/acc': 76.774, 'best_test_test/acc_unbiased': 71.176, 'best_test_test/diff': 11.594, 'best_test_test/acc_skew': 72.034, 'best_test_test/acc_align': 70.317}
[7 / 20] Learning rate: 0.0001 weight: 0.01
[7 / 20] Loss: 4.511611139939457 CE Loss: 0.4522241094348048 Con Loss: 4.5070888691741136
[7 / 20] tensor([[0.971, 0.830],
        [0.640, 0.509]]) {'epoch': 7, 'valid/acc': 78.483, 'valid/acc_unbiased': 73.754, 'valid/diff': 10.136, 'valid/acc_skew': 69.849, 'valid/acc_align': 77.659, 'test/acc': 79.991, 'test/acc_unbiased': 73.739, 'test/diff': 13.614, 'test/acc_skew': 73.484, 'test/acc_align': 73.994}
[7 / 20] best valid accuracy: 73.754 at epoch 7 
 best_stats: {'best_valid_epoch': 7, 'best_valid_valid/acc': 78.483, 'best_valid_valid/acc_unbiased': 73.754, 'best_valid_valid/diff': 10.136, 'best_valid_valid/acc_skew': 69.849, 'best_valid_valid/acc_align': 77.659, 'best_valid_test/acc': 79.991, 'best_valid_test/acc_unbiased': 73.739, 'best_valid_test/diff': 13.614, 'best_valid_test/acc_skew': 73.484, 'best_valid_test/acc_align': 73.994}
[7 / 20] best test accuracy: 73.739 at epoch 7 
 best_stats: {'best_test_epoch': 7, 'best_test_valid/acc': 78.483, 'best_test_valid/acc_unbiased': 73.754, 'best_test_valid/diff': 10.136, 'best_test_valid/acc_skew': 69.849, 'best_test_valid/acc_align': 77.659, 'best_test_test/acc': 79.991, 'best_test_test/acc_unbiased': 73.739, 'best_test_test/diff': 13.614, 'best_test_test/acc_skew': 73.484, 'best_test_test/acc_align': 73.994}
[8 / 20] Learning rate: 0.0001 weight: 0.01
[8 / 20] Loss: 4.443640209770702 CE Loss: 0.4315940126726485 Con Loss: 4.439324275066414
[8 / 20] tensor([[0.963, 0.710],
        [0.674, 0.648]]) {'epoch': 8, 'valid/acc': 78.66, 'valid/acc_unbiased': 72.849, 'valid/diff': 16.561, 'valid/acc_skew': 64.568, 'valid/acc_align': 81.129, 'test/acc': 81.005, 'test/acc_unbiased': 74.889, 'test/diff': 13.906, 'test/acc_skew': 69.191, 'test/acc_align': 80.586}
[8 / 20] best valid accuracy: 73.754 at epoch 7 
 best_stats: {'best_valid_epoch': 7, 'best_valid_valid/acc': 78.483, 'best_valid_valid/acc_unbiased': 73.754, 'best_valid_valid/diff': 10.136, 'best_valid_valid/acc_skew': 69.849, 'best_valid_valid/acc_align': 77.659, 'best_valid_test/acc': 79.991, 'best_valid_test/acc_unbiased': 73.739, 'best_valid_test/diff': 13.614, 'best_valid_test/acc_skew': 73.484, 'best_valid_test/acc_align': 73.994}
[8 / 20] best test accuracy: 74.889 at epoch 8 
 best_stats: {'best_test_epoch': 8, 'best_test_valid/acc': 78.66, 'best_test_valid/acc_unbiased': 72.849, 'best_test_valid/diff': 16.561, 'best_test_valid/acc_skew': 64.568, 'best_test_valid/acc_align': 81.129, 'best_test_test/acc': 81.005, 'best_test_test/acc_unbiased': 74.889, 'best_test_test/diff': 13.906, 'best_test_test/acc_skew': 69.191, 'best_test_test/acc_align': 80.586}
[9 / 20] Learning rate: 0.0001 weight: 0.01
[9 / 20] Loss: 4.413969265035545 CE Loss: 0.41761219543894773 Con Loss: 4.409793140735577
[9 / 20] tensor([[0.964, 0.756],
        [0.685, 0.600]]) {'epoch': 9, 'valid/acc': 80.115, 'valid/acc_unbiased': 74.626, 'valid/diff': 14.103, 'valid/acc_skew': 67.575, 'valid/acc_align': 81.678, 'test/acc': 81.49, 'test/acc_unbiased': 75.125, 'test/diff': 14.681, 'test/acc_skew': 72.04, 'test/acc_align': 78.209}
[9 / 20] best valid accuracy: 74.626 at epoch 9 
 best_stats: {'best_valid_epoch': 9, 'best_valid_valid/acc': 80.115, 'best_valid_valid/acc_unbiased': 74.626, 'best_valid_valid/diff': 14.103, 'best_valid_valid/acc_skew': 67.575, 'best_valid_valid/acc_align': 81.678, 'best_valid_test/acc': 81.49, 'best_valid_test/acc_unbiased': 75.125, 'best_valid_test/diff': 14.681, 'best_valid_test/acc_skew': 72.04, 'best_valid_test/acc_align': 78.209}
[9 / 20] best test accuracy: 75.125 at epoch 9 
 best_stats: {'best_test_epoch': 9, 'best_test_valid/acc': 80.115, 'best_test_valid/acc_unbiased': 74.626, 'best_test_valid/diff': 14.103, 'best_test_valid/acc_skew': 67.575, 'best_test_valid/acc_align': 81.678, 'best_test_test/acc': 81.49, 'best_test_test/acc_unbiased': 75.125, 'best_test_test/diff': 14.681, 'best_test_test/acc_skew': 72.04, 'best_test_test/acc_align': 78.209}
[10 / 20] Learning rate: 0.0001 weight: 0.01
[10 / 20] Loss: 4.417626845974995 CE Loss: 0.4062930062575003 Con Loss: 4.4135639029288285
[10 / 20] tensor([[0.965, 0.659],
        [0.686, 0.745]]) {'epoch': 10, 'valid/acc': 79.233, 'valid/acc_unbiased': 72.155, 'valid/diff': 27.548, 'valid/acc_skew': 58.381, 'valid/acc_align': 85.93, 'test/acc': 81.886, 'test/acc_unbiased': 76.399, 'test/diff': 18.261, 'test/acc_skew': 67.268, 'test/acc_align': 85.529}
[10 / 20] best valid accuracy: 74.626 at epoch 9 
 best_stats: {'best_valid_epoch': 9, 'best_valid_valid/acc': 80.115, 'best_valid_valid/acc_unbiased': 74.626, 'best_valid_valid/diff': 14.103, 'best_valid_valid/acc_skew': 67.575, 'best_valid_valid/acc_align': 81.678, 'best_valid_test/acc': 81.49, 'best_valid_test/acc_unbiased': 75.125, 'best_valid_test/diff': 14.681, 'best_valid_test/acc_skew': 72.04, 'best_valid_test/acc_align': 78.209}
[10 / 20] best test accuracy: 76.399 at epoch 10 
 best_stats: {'best_test_epoch': 10, 'best_test_valid/acc': 79.233, 'best_test_valid/acc_unbiased': 72.155, 'best_test_valid/diff': 27.548, 'best_test_valid/acc_skew': 58.381, 'best_test_valid/acc_align': 85.93, 'best_test_test/acc': 81.886, 'best_test_test/acc_unbiased': 76.399, 'best_test_test/diff': 18.261, 'best_test_test/acc_skew': 67.268, 'best_test_test/acc_align': 85.529}
[11 / 20] Learning rate: 0.0001 weight: 0.01
[11 / 20] Loss: 4.378325107614452 CE Loss: 0.39862697733024316 Con Loss: 4.374338834127743
[11 / 20] tensor([[0.971, 0.727],
        [0.691, 0.697]]) {'epoch': 11, 'valid/acc': 80.247, 'valid/acc_unbiased': 73.56, 'valid/diff': 21.671, 'valid/acc_skew': 62.725, 'valid/acc_align': 84.396, 'test/acc': 82.503, 'test/acc_unbiased': 77.148, 'test/diff': 12.48, 'test/acc_skew': 70.908, 'test/acc_align': 83.388}
[11 / 20] best valid accuracy: 74.626 at epoch 9 
 best_stats: {'best_valid_epoch': 9, 'best_valid_valid/acc': 80.115, 'best_valid_valid/acc_unbiased': 74.626, 'best_valid_valid/diff': 14.103, 'best_valid_valid/acc_skew': 67.575, 'best_valid_valid/acc_align': 81.678, 'best_valid_test/acc': 81.49, 'best_valid_test/acc_unbiased': 75.125, 'best_valid_test/diff': 14.681, 'best_valid_test/acc_skew': 72.04, 'best_valid_test/acc_align': 78.209}
[11 / 20] best test accuracy: 77.148 at epoch 11 
 best_stats: {'best_test_epoch': 11, 'best_test_valid/acc': 80.247, 'best_test_valid/acc_unbiased': 73.56, 'best_test_valid/diff': 21.671, 'best_test_valid/acc_skew': 62.725, 'best_test_valid/acc_align': 84.396, 'best_test_test/acc': 82.503, 'best_test_test/acc_unbiased': 77.148, 'best_test_test/diff': 12.48, 'best_test_test/acc_skew': 70.908, 'best_test_test/acc_align': 83.388}
[12 / 20] Learning rate: 0.0001 weight: 0.01
[12 / 20] Loss: 4.31773102341498 CE Loss: 0.4084071029285865 Con Loss: 4.313646971532264
[12 / 20] tensor([[0.966, 0.716],
        [0.721, 0.661]]) {'epoch': 12, 'valid/acc': 81.217, 'valid/acc_unbiased': 75.094, 'valid/diff': 18.302, 'valid/acc_skew': 65.943, 'valid/acc_align': 84.245, 'test/acc': 83.076, 'test/acc_unbiased': 76.587, 'test/diff': 15.522, 'test/acc_skew': 71.839, 'test/acc_align': 81.334}
[12 / 20] best valid accuracy: 75.094 at epoch 12 
 best_stats: {'best_valid_epoch': 12, 'best_valid_valid/acc': 81.217, 'best_valid_valid/acc_unbiased': 75.094, 'best_valid_valid/diff': 18.302, 'best_valid_valid/acc_skew': 65.943, 'best_valid_valid/acc_align': 84.245, 'best_valid_test/acc': 83.076, 'best_valid_test/acc_unbiased': 76.587, 'best_valid_test/diff': 15.522, 'best_valid_test/acc_skew': 71.839, 'best_valid_test/acc_align': 81.334}
[12 / 20] best test accuracy: 77.148 at epoch 11 
 best_stats: {'best_test_epoch': 11, 'best_test_valid/acc': 80.247, 'best_test_valid/acc_unbiased': 73.56, 'best_test_valid/diff': 21.671, 'best_test_valid/acc_skew': 62.725, 'best_test_valid/acc_align': 84.396, 'best_test_test/acc': 82.503, 'best_test_test/acc_unbiased': 77.148, 'best_test_test/diff': 12.48, 'best_test_test/acc_skew': 70.908, 'best_test_test/acc_align': 83.388}
[13 / 20] Learning rate: 0.0001 weight: 0.01
[13 / 20] Loss: 4.334555934226187 CE Loss: 0.3981206570948969 Con Loss: 4.330574722068669
[13 / 20] tensor([[0.966, 0.722],
        [0.675, 0.697]]) {'epoch': 13, 'valid/acc': 80.247, 'valid/acc_unbiased': 73.335, 'valid/diff': 19.725, 'valid/acc_skew': 63.472, 'valid/acc_align': 83.197, 'test/acc': 81.622, 'test/acc_unbiased': 76.484, 'test/diff': 13.335, 'test/acc_skew': 69.817, 'test/acc_align': 83.152}
[13 / 20] best valid accuracy: 75.094 at epoch 12 
 best_stats: {'best_valid_epoch': 12, 'best_valid_valid/acc': 81.217, 'best_valid_valid/acc_unbiased': 75.094, 'best_valid_valid/diff': 18.302, 'best_valid_valid/acc_skew': 65.943, 'best_valid_valid/acc_align': 84.245, 'best_valid_test/acc': 83.076, 'best_valid_test/acc_unbiased': 76.587, 'best_valid_test/diff': 15.522, 'best_valid_test/acc_skew': 71.839, 'best_valid_test/acc_align': 81.334}
[13 / 20] best test accuracy: 77.148 at epoch 11 
 best_stats: {'best_test_epoch': 11, 'best_test_valid/acc': 80.247, 'best_test_valid/acc_unbiased': 73.56, 'best_test_valid/diff': 21.671, 'best_test_valid/acc_skew': 62.725, 'best_test_valid/acc_align': 84.396, 'best_test_test/acc': 82.503, 'best_test_test/acc_unbiased': 77.148, 'best_test_test/diff': 12.48, 'best_test_test/acc_skew': 70.908, 'best_test_test/acc_align': 83.388}
[14 / 20] Learning rate: 1e-05 weight: 0.01
[14 / 20] Loss: 4.314098540962702 CE Loss: 0.3853790166448538 Con Loss: 4.3102447425145325
[14 / 20] tensor([[0.966, 0.739],
        [0.698, 0.685]]) {'epoch': 14, 'valid/acc': 80.996, 'valid/acc_unbiased': 74.436, 'valid/diff': 19.512, 'valid/acc_skew': 64.68, 'valid/acc_align': 84.192, 'test/acc': 82.547, 'test/acc_unbiased': 77.184, 'test/diff': 12.02, 'test/acc_skew': 71.822, 'test/acc_align': 82.546}
[14 / 20] best valid accuracy: 75.094 at epoch 12 
 best_stats: {'best_valid_epoch': 12, 'best_valid_valid/acc': 81.217, 'best_valid_valid/acc_unbiased': 75.094, 'best_valid_valid/diff': 18.302, 'best_valid_valid/acc_skew': 65.943, 'best_valid_valid/acc_align': 84.245, 'best_valid_test/acc': 83.076, 'best_valid_test/acc_unbiased': 76.587, 'best_valid_test/diff': 15.522, 'best_valid_test/acc_skew': 71.839, 'best_valid_test/acc_align': 81.334}
[14 / 20] best test accuracy: 77.184 at epoch 14 
 best_stats: {'best_test_epoch': 14, 'best_test_valid/acc': 80.996, 'best_test_valid/acc_unbiased': 74.436, 'best_test_valid/diff': 19.512, 'best_test_valid/acc_skew': 64.68, 'best_test_valid/acc_align': 84.192, 'best_test_test/acc': 82.547, 'best_test_test/acc_unbiased': 77.184, 'best_test_test/diff': 12.02, 'best_test_test/acc_skew': 71.822, 'best_test_test/acc_align': 82.546}
[15 / 20] Learning rate: 1e-05 weight: 0.01
[15 / 20] Loss: 4.327076174265791 CE Loss: 0.38091360168124977 Con Loss: 4.323267041052472
[15 / 20] tensor([[0.963, 0.733],
        [0.707, 0.709]]) {'epoch': 15, 'valid/acc': 80.864, 'valid/acc_unbiased': 73.762, 'valid/diff': 21.16, 'valid/acc_skew': 63.182, 'valid/acc_align': 84.342, 'test/acc': 82.9, 'test/acc_unbiased': 77.808, 'test/diff': 11.617, 'test/acc_skew': 72.0, 'test/acc_align': 83.617}
[15 / 20] best valid accuracy: 75.094 at epoch 12 
 best_stats: {'best_valid_epoch': 12, 'best_valid_valid/acc': 81.217, 'best_valid_valid/acc_unbiased': 75.094, 'best_valid_valid/diff': 18.302, 'best_valid_valid/acc_skew': 65.943, 'best_valid_valid/acc_align': 84.245, 'best_valid_test/acc': 83.076, 'best_valid_test/acc_unbiased': 76.587, 'best_valid_test/diff': 15.522, 'best_valid_test/acc_skew': 71.839, 'best_valid_test/acc_align': 81.334}
[15 / 20] best test accuracy: 77.808 at epoch 15 
 best_stats: {'best_test_epoch': 15, 'best_test_valid/acc': 80.864, 'best_test_valid/acc_unbiased': 73.762, 'best_test_valid/diff': 21.16, 'best_test_valid/acc_skew': 63.182, 'best_test_valid/acc_align': 84.342, 'best_test_test/acc': 82.9, 'best_test_test/acc_unbiased': 77.808, 'best_test_test/diff': 11.617, 'best_test_test/acc_skew': 72.0, 'best_test_test/acc_align': 83.617}
[16 / 20] Learning rate: 1e-05 weight: 0.01
[16 / 20] Loss: 4.299661606182012 CE Loss: 0.3823042429037997 Con Loss: 4.295838549359377
[16 / 20] tensor([[0.966, 0.744],
        [0.705, 0.685]]) {'epoch': 16, 'valid/acc': 81.173, 'valid/acc_unbiased': 74.957, 'valid/diff': 17.083, 'valid/acc_skew': 66.415, 'valid/acc_align': 83.498, 'test/acc': 82.856, 'test/acc_unbiased': 77.499, 'test/diff': 12.082, 'test/acc_skew': 72.452, 'test/acc_align': 82.546}
[16 / 20] best valid accuracy: 75.094 at epoch 12 
 best_stats: {'best_valid_epoch': 12, 'best_valid_valid/acc': 81.217, 'best_valid_valid/acc_unbiased': 75.094, 'best_valid_valid/diff': 18.302, 'best_valid_valid/acc_skew': 65.943, 'best_valid_valid/acc_align': 84.245, 'best_valid_test/acc': 83.076, 'best_valid_test/acc_unbiased': 76.587, 'best_valid_test/diff': 15.522, 'best_valid_test/acc_skew': 71.839, 'best_valid_test/acc_align': 81.334}
[16 / 20] best test accuracy: 77.808 at epoch 15 
 best_stats: {'best_test_epoch': 15, 'best_test_valid/acc': 80.864, 'best_test_valid/acc_unbiased': 73.762, 'best_test_valid/diff': 21.16, 'best_test_valid/acc_skew': 63.182, 'best_test_valid/acc_align': 84.342, 'best_test_test/acc': 82.9, 'best_test_test/acc_unbiased': 77.808, 'best_test_test/diff': 11.617, 'best_test_test/acc_skew': 72.0, 'best_test_test/acc_align': 83.617}
[17 / 20] Learning rate: 1e-05 weight: 0.01
[17 / 20] Loss: 4.205290623703774 CE Loss: 0.3798189614203841 Con Loss: 4.201492439714187
[17 / 20] tensor([[0.969, 0.739],
        [0.694, 0.691]]) {'epoch': 17, 'valid/acc': 80.776, 'valid/acc_unbiased': 74.393, 'valid/diff': 17.813, 'valid/acc_skew': 65.486, 'valid/acc_align': 83.299, 'test/acc': 82.591, 'test/acc_unbiased': 77.32, 'test/diff': 11.685, 'test/acc_skew': 71.649, 'test/acc_align': 82.99}
[17 / 20] best valid accuracy: 75.094 at epoch 12 
 best_stats: {'best_valid_epoch': 12, 'best_valid_valid/acc': 81.217, 'best_valid_valid/acc_unbiased': 75.094, 'best_valid_valid/diff': 18.302, 'best_valid_valid/acc_skew': 65.943, 'best_valid_valid/acc_align': 84.245, 'best_valid_test/acc': 83.076, 'best_valid_test/acc_unbiased': 76.587, 'best_valid_test/diff': 15.522, 'best_valid_test/acc_skew': 71.839, 'best_valid_test/acc_align': 81.334}
[17 / 20] best test accuracy: 77.808 at epoch 15 
 best_stats: {'best_test_epoch': 15, 'best_test_valid/acc': 80.864, 'best_test_valid/acc_unbiased': 73.762, 'best_test_valid/diff': 21.16, 'best_test_valid/acc_skew': 63.182, 'best_test_valid/acc_align': 84.342, 'best_test_test/acc': 82.9, 'best_test_test/acc_unbiased': 77.808, 'best_test_test/diff': 11.617, 'best_test_test/acc_skew': 72.0, 'best_test_test/acc_align': 83.617}
[18 / 20] Learning rate: 1e-05 weight: 0.01
[18 / 20] Loss: 4.304971407701442 CE Loss: 0.38382721218398697 Con Loss: 4.301133139398561
[18 / 20] tensor([[0.969, 0.727],
        [0.716, 0.697]]) {'epoch': 18, 'valid/acc': 81.349, 'valid/acc_unbiased': 74.472, 'valid/diff': 19.935, 'valid/acc_skew': 64.505, 'valid/acc_align': 84.44, 'test/acc': 83.385, 'test/acc_unbiased': 77.735, 'test/diff': 13.046, 'test/acc_skew': 72.177, 'test/acc_align': 83.293}
[18 / 20] best valid accuracy: 75.094 at epoch 12 
 best_stats: {'best_valid_epoch': 12, 'best_valid_valid/acc': 81.217, 'best_valid_valid/acc_unbiased': 75.094, 'best_valid_valid/diff': 18.302, 'best_valid_valid/acc_skew': 65.943, 'best_valid_valid/acc_align': 84.245, 'best_valid_test/acc': 83.076, 'best_valid_test/acc_unbiased': 76.587, 'best_valid_test/diff': 15.522, 'best_valid_test/acc_skew': 71.839, 'best_valid_test/acc_align': 81.334}
[18 / 20] best test accuracy: 77.808 at epoch 15 
 best_stats: {'best_test_epoch': 15, 'best_test_valid/acc': 80.864, 'best_test_valid/acc_unbiased': 73.762, 'best_test_valid/diff': 21.16, 'best_test_valid/acc_skew': 63.182, 'best_test_valid/acc_align': 84.342, 'best_test_test/acc': 82.9, 'best_test_test/acc_unbiased': 77.808, 'best_test_test/diff': 11.617, 'best_test_test/acc_skew': 72.0, 'best_test_test/acc_align': 83.617}
[19 / 20] Learning rate: 1e-05 weight: 0.01
[19 / 20] Loss: 4.308628346669187 CE Loss: 0.3953879042226962 Con Loss: 4.304674457048754
[19 / 20] tensor([[0.970, 0.727],
        [0.708, 0.703]]) {'epoch': 19, 'valid/acc': 81.437, 'valid/acc_unbiased': 75.107, 'valid/diff': 19.354, 'valid/acc_skew': 65.43, 'valid/acc_align': 84.784, 'test/acc': 83.164, 'test/acc_unbiased': 77.708, 'test/diff': 12.386, 'test/acc_skew': 71.773, 'test/acc_align': 83.644}
[19 / 20] best valid accuracy: 75.107 at epoch 19 
 best_stats: {'best_valid_epoch': 19, 'best_valid_valid/acc': 81.437, 'best_valid_valid/acc_unbiased': 75.107, 'best_valid_valid/diff': 19.354, 'best_valid_valid/acc_skew': 65.43, 'best_valid_valid/acc_align': 84.784, 'best_valid_test/acc': 83.164, 'best_valid_test/acc_unbiased': 77.708, 'best_valid_test/diff': 12.386, 'best_valid_test/acc_skew': 71.773, 'best_valid_test/acc_align': 83.644}
[19 / 20] best test accuracy: 77.808 at epoch 15 
 best_stats: {'best_test_epoch': 15, 'best_test_valid/acc': 80.864, 'best_test_valid/acc_unbiased': 73.762, 'best_test_valid/diff': 21.16, 'best_test_valid/acc_skew': 63.182, 'best_test_valid/acc_align': 84.342, 'best_test_test/acc': 82.9, 'best_test_test/acc_unbiased': 77.808, 'best_test_test/diff': 11.617, 'best_test_test/acc_skew': 72.0, 'best_test_test/acc_align': 83.617}
[20 / 20] Learning rate: 1e-05 weight: 0.01
[20 / 20] Loss: 4.284485639145829 CE Loss: 0.3776425425031577 Con Loss: 4.280709204000733
[20 / 20] tensor([[0.967, 0.716],
        [0.714, 0.697]]) {'epoch': 20, 'valid/acc': 81.041, 'valid/acc_unbiased': 74.243, 'valid/diff': 21.179, 'valid/acc_skew': 63.654, 'valid/acc_align': 84.833, 'test/acc': 83.12, 'test/acc_unbiased': 77.346, 'test/diff': 13.404, 'test/acc_skew': 71.493, 'test/acc_align': 83.199}
[20 / 20] best valid accuracy: 75.107 at epoch 19 
 best_stats: {'best_valid_epoch': 19, 'best_valid_valid/acc': 81.437, 'best_valid_valid/acc_unbiased': 75.107, 'best_valid_valid/diff': 19.354, 'best_valid_valid/acc_skew': 65.43, 'best_valid_valid/acc_align': 84.784, 'best_valid_test/acc': 83.164, 'best_valid_test/acc_unbiased': 77.708, 'best_valid_test/diff': 12.386, 'best_valid_test/acc_skew': 71.773, 'best_valid_test/acc_align': 83.644}
[20 / 20] best test accuracy: 77.808 at epoch 15 
 best_stats: {'best_test_epoch': 15, 'best_test_valid/acc': 80.864, 'best_test_valid/acc_unbiased': 73.762, 'best_test_valid/diff': 21.16, 'best_test_valid/acc_skew': 63.182, 'best_test_valid/acc_align': 84.342, 'best_test_test/acc': 82.9, 'best_test_test/acc_unbiased': 77.808, 'best_test_test/diff': 11.617, 'best_test_test/acc_skew': 72.0, 'best_test_test/acc_align': 83.617}
Total training time: 0:23:02
