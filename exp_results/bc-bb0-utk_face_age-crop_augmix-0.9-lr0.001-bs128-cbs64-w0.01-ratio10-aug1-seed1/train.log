Log level set to: INFO
Set seed: 1
=======> Using Fixed Random Seed: 1 <========
save_path: exp_results/bc-bb0-utk_face_age-crop_augmix-0.9-lr0.001-bs128-cbs64-w0.01-ratio10-aug1-seed1
get_utk_face - split: train, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_age-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
Binary Target 1
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Normal Label Distribution: 
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
Binary Target 1
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Normal Label Distribution: 
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 10684, target_attr: gender, bias_attr: age bias_rate: 0.9
['[train] target_0-bias_0: 8237', '[train] target_0-bias_1: 147', '[train] target_1-bias_0: 823', '[train] target_1-bias_1: 1477']
confusion_matrix - 
 original: tensor([[8237.,  823.],
        [ 147., 1477.]]), 
 normalized: tensor([[0.909, 0.091],
        [0.091, 0.909]]), 
 b|y: tensor([[0.982, 0.018],
        [0.358, 0.642]])
get_utk_face - split: train, aug: 1, given_y: True, ratio: 10
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_age-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
Binary Target 1
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Normal Label Distribution: 
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
Binary Target 1
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Normal Label Distribution: 
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 10684, target_attr: gender, bias_attr: age bias_rate: 0.9
['[train] target_0-bias_0: 8237', '[train] target_0-bias_1: 147', '[train] target_1-bias_0: 823', '[train] target_1-bias_1: 1477']
get_utk_face - split: valid, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_age-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [1030, 195]
Target 1: [841, 202]
Binary Target 1
---------------------------
Target 0: [1030, 195]
Target 1: [841, 202]
===================================
Normal Label Distribution: 
Target 0: [1030, 195]
Target 1: [841, 202]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 2268, target_attr: gender, bias_attr: age bias_rate: 0.9
['[valid] target_0-bias_0: 1030', '[valid] target_0-bias_1: 195', '[valid] target_1-bias_0: 841', '[valid] target_1-bias_1: 202']
get_utk_face - split: test, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_age-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [1061, 176]
Target 1: [867, 165]
Binary Target 1
---------------------------
Target 0: [1061, 176]
Target 1: [867, 165]
===================================
Normal Label Distribution: 
Target 0: [1061, 176]
Target 1: [867, 165]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 2269, target_attr: gender, bias_attr: age bias_rate: 0.9
['[test] target_0-bias_0: 1061', '[test] target_0-bias_1: 176', '[test] target_1-bias_0: 867', '[test] target_1-bias_1: 165']
decay_epochs: [6, 13]
[1 / 20] Learning rate: 0.001 weight: 0.01
[1 / 20] Loss: 4.742727972157034 CE Loss: 0.5621039996384593 Con Loss: 4.737106937721221
[1 / 20] tensor([[0.993, 1.000],
        [0.171, 0.091]]) {'epoch': 1, 'valid/acc': 60.935, 'valid/acc_unbiased': 57.424, 'valid/diff': 0.546, 'valid/acc_skew': 57.316, 'valid/acc_align': 57.532, 'test/acc': 61.393, 'test/acc_unbiased': 56.375, 'test/diff': 4.32, 'test/acc_skew': 58.535, 'test/acc_align': 54.216}
[1 / 20] best valid accuracy: 57.424 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 60.935, 'best_valid_valid/acc_unbiased': 57.424, 'best_valid_valid/diff': 0.546, 'best_valid_valid/acc_skew': 57.316, 'best_valid_valid/acc_align': 57.532, 'best_valid_test/acc': 61.393, 'best_valid_test/acc_unbiased': 56.375, 'best_valid_test/diff': 4.32, 'best_valid_test/acc_skew': 58.535, 'best_valid_test/acc_align': 54.216}
[1 / 20] best test accuracy: 56.375 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 60.935, 'best_test_valid/acc_unbiased': 57.424, 'best_test_valid/diff': 0.546, 'best_test_valid/acc_skew': 57.316, 'best_test_valid/acc_align': 57.532, 'best_test_test/acc': 61.393, 'best_test_test/acc_unbiased': 56.375, 'best_test_test/diff': 4.32, 'best_test_test/acc_skew': 58.535, 'best_test_test/acc_align': 54.216}
[2 / 20] Learning rate: 0.001 weight: 0.01
[2 / 20] Loss: 4.535573906329008 CE Loss: 0.5032165140214818 Con Loss: 4.530541742754
[2 / 20] tensor([[0.968, 0.949],
        [0.453, 0.261]]) {'epoch': 2, 'valid/acc': 70.899, 'valid/acc_unbiased': 65.153, 'valid/diff': 11.318, 'valid/acc_skew': 67.798, 'valid/acc_align': 62.507, 'test/acc': 71.838, 'test/acc_unbiased': 65.768, 'test/diff': 10.589, 'test/acc_skew': 70.108, 'test/acc_align': 61.428}
[2 / 20] best valid accuracy: 65.153 at epoch 2 
 best_stats: {'best_valid_epoch': 2, 'best_valid_valid/acc': 70.899, 'best_valid_valid/acc_unbiased': 65.153, 'best_valid_valid/diff': 11.318, 'best_valid_valid/acc_skew': 67.798, 'best_valid_valid/acc_align': 62.507, 'best_valid_test/acc': 71.838, 'best_valid_test/acc_unbiased': 65.768, 'best_valid_test/diff': 10.589, 'best_valid_test/acc_skew': 70.108, 'best_valid_test/acc_align': 61.428}
[2 / 20] best test accuracy: 65.768 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 70.899, 'best_test_valid/acc_unbiased': 65.153, 'best_test_valid/diff': 11.318, 'best_test_valid/acc_skew': 67.798, 'best_test_valid/acc_align': 62.507, 'best_test_test/acc': 71.838, 'best_test_test/acc_unbiased': 65.768, 'best_test_test/diff': 10.589, 'best_test_test/acc_skew': 70.108, 'best_test_test/acc_align': 61.428}
[3 / 20] Learning rate: 0.001 weight: 0.01
[3 / 20] Loss: 4.472218990504452 CE Loss: 0.5016199877783405 Con Loss: 4.467202790352077
[3 / 20] tensor([[0.908, 0.716],
        [0.742, 0.509]]) {'epoch': 3, 'valid/acc': 77.293, 'valid/acc_unbiased': 70.785, 'valid/diff': 17.353, 'valid/acc_skew': 69.492, 'valid/acc_align': 72.077, 'test/acc': 80.035, 'test/acc_unbiased': 71.857, 'test/diff': 21.214, 'test/acc_skew': 72.877, 'test/acc_align': 70.836}
[3 / 20] best valid accuracy: 70.785 at epoch 3 
 best_stats: {'best_valid_epoch': 3, 'best_valid_valid/acc': 77.293, 'best_valid_valid/acc_unbiased': 70.785, 'best_valid_valid/diff': 17.353, 'best_valid_valid/acc_skew': 69.492, 'best_valid_valid/acc_align': 72.077, 'best_valid_test/acc': 80.035, 'best_valid_test/acc_unbiased': 71.857, 'best_valid_test/diff': 21.214, 'best_valid_test/acc_skew': 72.877, 'best_valid_test/acc_align': 70.836}
[3 / 20] best test accuracy: 71.857 at epoch 3 
 best_stats: {'best_test_epoch': 3, 'best_test_valid/acc': 77.293, 'best_test_valid/acc_unbiased': 70.785, 'best_test_valid/diff': 17.353, 'best_test_valid/acc_skew': 69.492, 'best_test_valid/acc_align': 72.077, 'best_test_test/acc': 80.035, 'best_test_test/acc_unbiased': 71.857, 'best_test_test/diff': 21.214, 'best_test_test/acc_skew': 72.877, 'best_test_test/acc_align': 70.836}
[4 / 20] Learning rate: 0.001 weight: 0.01
[4 / 20] Loss: 4.475440837077459 CE Loss: 0.4806742591051875 Con Loss: 4.4706340982243615
[4 / 20] tensor([[0.994, 0.989],
        [0.284, 0.127]]) {'epoch': 4, 'valid/acc': 64.242, 'valid/acc_unbiased': 59.341, 'valid/diff': 5.9, 'valid/acc_skew': 61.203, 'valid/acc_align': 57.479, 'test/acc': 65.932, 'test/acc_unbiased': 59.85, 'test/diff': 8.109, 'test/acc_skew': 63.619, 'test/acc_align': 56.081}
[4 / 20] best valid accuracy: 70.785 at epoch 3 
 best_stats: {'best_valid_epoch': 3, 'best_valid_valid/acc': 77.293, 'best_valid_valid/acc_unbiased': 70.785, 'best_valid_valid/diff': 17.353, 'best_valid_valid/acc_skew': 69.492, 'best_valid_valid/acc_align': 72.077, 'best_valid_test/acc': 80.035, 'best_valid_test/acc_unbiased': 71.857, 'best_valid_test/diff': 21.214, 'best_valid_test/acc_skew': 72.877, 'best_valid_test/acc_align': 70.836}
[4 / 20] best test accuracy: 71.857 at epoch 3 
 best_stats: {'best_test_epoch': 3, 'best_test_valid/acc': 77.293, 'best_test_valid/acc_unbiased': 70.785, 'best_test_valid/diff': 17.353, 'best_test_valid/acc_skew': 69.492, 'best_test_valid/acc_align': 72.077, 'best_test_test/acc': 80.035, 'best_test_test/acc_unbiased': 71.857, 'best_test_test/diff': 21.214, 'best_test_test/acc_skew': 72.877, 'best_test_test/acc_align': 70.836}
[5 / 20] Learning rate: 0.001 weight: 0.01
[5 / 20] Loss: 4.471877544214555 CE Loss: 0.4486085832877714 Con Loss: 4.467391460051656
[5 / 20] tensor([[0.989, 0.960],
        [0.392, 0.255]]) {'epoch': 5, 'valid/acc': 70.547, 'valid/acc_unbiased': 66.302, 'valid/diff': 5.643, 'valid/acc_skew': 65.714, 'valid/acc_align': 66.89, 'test/acc': 70.516, 'test/acc_unbiased': 64.89, 'test/diff': 8.304, 'test/acc_skew': 67.619, 'test/acc_align': 62.162}
[5 / 20] best valid accuracy: 70.785 at epoch 3 
 best_stats: {'best_valid_epoch': 3, 'best_valid_valid/acc': 77.293, 'best_valid_valid/acc_unbiased': 70.785, 'best_valid_valid/diff': 17.353, 'best_valid_valid/acc_skew': 69.492, 'best_valid_valid/acc_align': 72.077, 'best_valid_test/acc': 80.035, 'best_valid_test/acc_unbiased': 71.857, 'best_valid_test/diff': 21.214, 'best_valid_test/acc_skew': 72.877, 'best_valid_test/acc_align': 70.836}
[5 / 20] best test accuracy: 71.857 at epoch 3 
 best_stats: {'best_test_epoch': 3, 'best_test_valid/acc': 77.293, 'best_test_valid/acc_unbiased': 70.785, 'best_test_valid/diff': 17.353, 'best_test_valid/acc_skew': 69.492, 'best_test_valid/acc_align': 72.077, 'best_test_test/acc': 80.035, 'best_test_test/acc_unbiased': 71.857, 'best_test_test/diff': 21.214, 'best_test_test/acc_skew': 72.877, 'best_test_test/acc_align': 70.836}
[6 / 20] Learning rate: 0.001 weight: 0.01
[6 / 20] Loss: 4.4002634844321165 CE Loss: 0.44910803745186584 Con Loss: 4.395772413027416
[6 / 20] tensor([[0.980, 0.801],
        [0.554, 0.473]]) {'epoch': 6, 'valid/acc': 74.78, 'valid/acc_unbiased': 69.087, 'valid/diff': 11.728, 'valid/acc_skew': 64.639, 'valid/acc_align': 73.534, 'test/acc': 76.642, 'test/acc_unbiased': 70.193, 'test/diff': 12.999, 'test/acc_skew': 67.738, 'test/acc_align': 72.647}
[6 / 20] best valid accuracy: 70.785 at epoch 3 
 best_stats: {'best_valid_epoch': 3, 'best_valid_valid/acc': 77.293, 'best_valid_valid/acc_unbiased': 70.785, 'best_valid_valid/diff': 17.353, 'best_valid_valid/acc_skew': 69.492, 'best_valid_valid/acc_align': 72.077, 'best_valid_test/acc': 80.035, 'best_valid_test/acc_unbiased': 71.857, 'best_valid_test/diff': 21.214, 'best_valid_test/acc_skew': 72.877, 'best_valid_test/acc_align': 70.836}
[6 / 20] best test accuracy: 71.857 at epoch 3 
 best_stats: {'best_test_epoch': 3, 'best_test_valid/acc': 77.293, 'best_test_valid/acc_unbiased': 70.785, 'best_test_valid/diff': 17.353, 'best_test_valid/acc_skew': 69.492, 'best_test_valid/acc_align': 72.077, 'best_test_test/acc': 80.035, 'best_test_test/acc_unbiased': 71.857, 'best_test_test/diff': 21.214, 'best_test_test/acc_skew': 72.877, 'best_test_test/acc_align': 70.836}
[7 / 20] Learning rate: 0.0001 weight: 0.01
[7 / 20] Loss: 4.39666473352253 CE Loss: 0.42444713582755117 Con Loss: 4.392420273155632
[7 / 20] tensor([[0.976, 0.767],
        [0.638, 0.515]]) {'epoch': 7, 'valid/acc': 79.277, 'valid/acc_unbiased': 73.256, 'valid/diff': 14.179, 'valid/acc_skew': 69.459, 'valid/acc_align': 77.053, 'test/acc': 79.727, 'test/acc_unbiased': 72.412, 'test/diff': 16.604, 'test/acc_skew': 70.244, 'test/acc_align': 74.579}
[7 / 20] best valid accuracy: 73.256 at epoch 7 
 best_stats: {'best_valid_epoch': 7, 'best_valid_valid/acc': 79.277, 'best_valid_valid/acc_unbiased': 73.256, 'best_valid_valid/diff': 14.179, 'best_valid_valid/acc_skew': 69.459, 'best_valid_valid/acc_align': 77.053, 'best_valid_test/acc': 79.727, 'best_valid_test/acc_unbiased': 72.412, 'best_valid_test/diff': 16.604, 'best_valid_test/acc_skew': 70.244, 'best_valid_test/acc_align': 74.579}
[7 / 20] best test accuracy: 72.412 at epoch 7 
 best_stats: {'best_test_epoch': 7, 'best_test_valid/acc': 79.277, 'best_test_valid/acc_unbiased': 73.256, 'best_test_valid/diff': 14.179, 'best_test_valid/acc_skew': 69.459, 'best_test_valid/acc_align': 77.053, 'best_test_test/acc': 79.727, 'best_test_test/acc_unbiased': 72.412, 'best_test_test/diff': 16.604, 'best_test_test/acc_skew': 70.244, 'best_test_test/acc_align': 74.579}
[8 / 20] Learning rate: 0.0001 weight: 0.01
[8 / 20] Loss: 4.310175153210296 CE Loss: 0.405999240257998 Con Loss: 4.306115179818831
[8 / 20] tensor([[0.978, 0.761],
        [0.630, 0.533]]) {'epoch': 8, 'valid/acc': 78.66, 'valid/acc_unbiased': 73.407, 'valid/diff': 11.476, 'valid/acc_skew': 68.723, 'valid/acc_align': 78.091, 'test/acc': 79.595, 'test/acc_unbiased': 72.569, 'test/diff': 15.669, 'test/acc_skew': 69.556, 'test/acc_align': 75.583}
[8 / 20] best valid accuracy: 73.407 at epoch 8 
 best_stats: {'best_valid_epoch': 8, 'best_valid_valid/acc': 78.66, 'best_valid_valid/acc_unbiased': 73.407, 'best_valid_valid/diff': 11.476, 'best_valid_valid/acc_skew': 68.723, 'best_valid_valid/acc_align': 78.091, 'best_valid_test/acc': 79.595, 'best_valid_test/acc_unbiased': 72.569, 'best_valid_test/diff': 15.669, 'best_valid_test/acc_skew': 69.556, 'best_valid_test/acc_align': 75.583}
[8 / 20] best test accuracy: 72.569 at epoch 8 
 best_stats: {'best_test_epoch': 8, 'best_test_valid/acc': 78.66, 'best_test_valid/acc_unbiased': 73.407, 'best_test_valid/diff': 11.476, 'best_test_valid/acc_skew': 68.723, 'best_test_valid/acc_align': 78.091, 'best_test_test/acc': 79.595, 'best_test_test/acc_unbiased': 72.569, 'best_test_test/diff': 15.669, 'best_test_test/acc_skew': 69.556, 'best_test_test/acc_align': 75.583}
[9 / 20] Learning rate: 0.0001 weight: 0.01
[9 / 20] Loss: 4.319427560929813 CE Loss: 0.3992659427708162 Con Loss: 4.315434904323451
[9 / 20] tensor([[0.976, 0.682],
        [0.634, 0.661]]) {'epoch': 9, 'valid/acc': 78.527, 'valid/acc_unbiased': 72.851, 'valid/diff': 19.693, 'valid/acc_skew': 63.004, 'valid/acc_align': 82.697, 'test/acc': 79.991, 'test/acc_unbiased': 73.831, 'test/diff': 16.043, 'test/acc_skew': 65.809, 'test/acc_align': 81.852}
[9 / 20] best valid accuracy: 73.407 at epoch 8 
 best_stats: {'best_valid_epoch': 8, 'best_valid_valid/acc': 78.66, 'best_valid_valid/acc_unbiased': 73.407, 'best_valid_valid/diff': 11.476, 'best_valid_valid/acc_skew': 68.723, 'best_valid_valid/acc_align': 78.091, 'best_valid_test/acc': 79.595, 'best_valid_test/acc_unbiased': 72.569, 'best_valid_test/diff': 15.669, 'best_valid_test/acc_skew': 69.556, 'best_valid_test/acc_align': 75.583}
[9 / 20] best test accuracy: 73.831 at epoch 9 
 best_stats: {'best_test_epoch': 9, 'best_test_valid/acc': 78.527, 'best_test_valid/acc_unbiased': 72.851, 'best_test_valid/diff': 19.693, 'best_test_valid/acc_skew': 63.004, 'best_test_valid/acc_align': 82.697, 'best_test_test/acc': 79.991, 'best_test_test/acc_unbiased': 73.831, 'best_test_test/diff': 16.043, 'best_test_test/acc_skew': 65.809, 'best_test_test/acc_align': 81.852}
[10 / 20] Learning rate: 0.0001 weight: 0.01
[10 / 20] Loss: 4.248810950043227 CE Loss: 0.3899994358526371 Con Loss: 4.2449109656941975
[10 / 20] tensor([[0.983, 0.739],
        [0.612, 0.606]]) {'epoch': 10, 'valid/acc': 78.219, 'valid/acc_unbiased': 72.345, 'valid/diff': 17.425, 'valid/acc_skew': 63.632, 'valid/acc_align': 81.057, 'test/acc': 79.506, 'test/acc_unbiased': 73.505, 'test/diff': 12.54, 'test/acc_skew': 67.555, 'test/acc_align': 79.455}
[10 / 20] best valid accuracy: 73.407 at epoch 8 
 best_stats: {'best_valid_epoch': 8, 'best_valid_valid/acc': 78.66, 'best_valid_valid/acc_unbiased': 73.407, 'best_valid_valid/diff': 11.476, 'best_valid_valid/acc_skew': 68.723, 'best_valid_valid/acc_align': 78.091, 'best_valid_test/acc': 79.595, 'best_valid_test/acc_unbiased': 72.569, 'best_valid_test/diff': 15.669, 'best_valid_test/acc_skew': 69.556, 'best_valid_test/acc_align': 75.583}
[10 / 20] best test accuracy: 73.831 at epoch 9 
 best_stats: {'best_test_epoch': 9, 'best_test_valid/acc': 78.527, 'best_test_valid/acc_unbiased': 72.851, 'best_test_valid/diff': 19.693, 'best_test_valid/acc_skew': 63.004, 'best_test_valid/acc_align': 82.697, 'best_test_test/acc': 79.991, 'best_test_test/acc_unbiased': 73.831, 'best_test_test/diff': 16.043, 'best_test_test/acc_skew': 65.809, 'best_test_test/acc_align': 81.852}
[11 / 20] Learning rate: 0.0001 weight: 0.01
[11 / 20] Loss: 4.183840682916274 CE Loss: 0.38539733717344266 Con Loss: 4.179986715584558
[11 / 20] tensor([[0.975, 0.670],
        [0.675, 0.661]]) {'epoch': 11, 'valid/acc': 79.63, 'valid/acc_unbiased': 73.095, 'valid/diff': 20.991, 'valid/acc_skew': 62.599, 'valid/acc_align': 83.59, 'test/acc': 81.401, 'test/acc_unbiased': 74.532, 'test/diff': 15.959, 'test/acc_skew': 67.26, 'test/acc_align': 81.805}
[11 / 20] best valid accuracy: 73.407 at epoch 8 
 best_stats: {'best_valid_epoch': 8, 'best_valid_valid/acc': 78.66, 'best_valid_valid/acc_unbiased': 73.407, 'best_valid_valid/diff': 11.476, 'best_valid_valid/acc_skew': 68.723, 'best_valid_valid/acc_align': 78.091, 'best_valid_test/acc': 79.595, 'best_valid_test/acc_unbiased': 72.569, 'best_valid_test/diff': 15.669, 'best_valid_test/acc_skew': 69.556, 'best_valid_test/acc_align': 75.583}
[11 / 20] best test accuracy: 74.532 at epoch 11 
 best_stats: {'best_test_epoch': 11, 'best_test_valid/acc': 79.63, 'best_test_valid/acc_unbiased': 73.095, 'best_test_valid/diff': 20.991, 'best_test_valid/acc_skew': 62.599, 'best_test_valid/acc_align': 83.59, 'best_test_test/acc': 81.401, 'best_test_test/acc_unbiased': 74.532, 'best_test_test/diff': 15.959, 'best_test_test/acc_skew': 67.26, 'best_test_test/acc_align': 81.805}
[12 / 20] Learning rate: 0.0001 weight: 0.01
[12 / 20] Loss: 4.223271154098768 CE Loss: 0.37569812316209 Con Loss: 4.21951416412662
[12 / 20] tensor([[0.975, 0.602],
        [0.669, 0.752]]) {'epoch': 12, 'valid/acc': 79.233, 'valid/acc_unbiased': 72.502, 'valid/diff': 26.041, 'valid/acc_skew': 59.481, 'valid/acc_align': 85.522, 'test/acc': 81.313, 'test/acc_unbiased': 74.956, 'test/diff': 22.788, 'test/acc_skew': 63.562, 'test/acc_align': 86.351}
[12 / 20] best valid accuracy: 73.407 at epoch 8 
 best_stats: {'best_valid_epoch': 8, 'best_valid_valid/acc': 78.66, 'best_valid_valid/acc_unbiased': 73.407, 'best_valid_valid/diff': 11.476, 'best_valid_valid/acc_skew': 68.723, 'best_valid_valid/acc_align': 78.091, 'best_valid_test/acc': 79.595, 'best_valid_test/acc_unbiased': 72.569, 'best_valid_test/diff': 15.669, 'best_valid_test/acc_skew': 69.556, 'best_valid_test/acc_align': 75.583}
[12 / 20] best test accuracy: 74.956 at epoch 12 
 best_stats: {'best_test_epoch': 12, 'best_test_valid/acc': 79.233, 'best_test_valid/acc_unbiased': 72.502, 'best_test_valid/diff': 26.041, 'best_test_valid/acc_skew': 59.481, 'best_test_valid/acc_align': 85.522, 'best_test_test/acc': 81.313, 'best_test_test/acc_unbiased': 74.956, 'best_test_test/diff': 22.788, 'best_test_test/acc_skew': 63.562, 'best_test_test/acc_align': 86.351}
[13 / 20] Learning rate: 0.0001 weight: 0.01
[13 / 20] Loss: 4.21085735493856 CE Loss: 0.3563822935757589 Con Loss: 4.207293547212921
[13 / 20] tensor([[0.985, 0.716],
        [0.621, 0.655]]) {'epoch': 13, 'valid/acc': 78.351, 'valid/acc_unbiased': 72.128, 'valid/diff': 18.449, 'valid/acc_skew': 62.904, 'valid/acc_align': 81.353, 'test/acc': 80.079, 'test/acc_unbiased': 74.398, 'test/diff': 15.151, 'test/acc_skew': 66.822, 'test/acc_align': 81.973}
[13 / 20] best valid accuracy: 73.407 at epoch 8 
 best_stats: {'best_valid_epoch': 8, 'best_valid_valid/acc': 78.66, 'best_valid_valid/acc_unbiased': 73.407, 'best_valid_valid/diff': 11.476, 'best_valid_valid/acc_skew': 68.723, 'best_valid_valid/acc_align': 78.091, 'best_valid_test/acc': 79.595, 'best_valid_test/acc_unbiased': 72.569, 'best_valid_test/diff': 15.669, 'best_valid_test/acc_skew': 69.556, 'best_valid_test/acc_align': 75.583}
[13 / 20] best test accuracy: 74.956 at epoch 12 
 best_stats: {'best_test_epoch': 12, 'best_test_valid/acc': 79.233, 'best_test_valid/acc_unbiased': 72.502, 'best_test_valid/diff': 26.041, 'best_test_valid/acc_skew': 59.481, 'best_test_valid/acc_align': 85.522, 'best_test_test/acc': 81.313, 'best_test_test/acc_unbiased': 74.956, 'best_test_test/diff': 22.788, 'best_test_test/acc_skew': 63.562, 'best_test_test/acc_align': 86.351}
[14 / 20] Learning rate: 1e-05 weight: 0.01
[14 / 20] Loss: 4.157693207018476 CE Loss: 0.35721945251609805 Con Loss: 4.154120988678013
[14 / 20] tensor([[0.981, 0.602],
        [0.646, 0.733]]) {'epoch': 14, 'valid/acc': 79.321, 'valid/acc_unbiased': 73.117, 'valid/diff': 24.596, 'valid/acc_skew': 60.819, 'valid/acc_align': 85.415, 'test/acc': 80.564, 'test/acc_unbiased': 74.067, 'test/diff': 23.315, 'test/acc_skew': 62.409, 'test/acc_align': 85.724}
[14 / 20] best valid accuracy: 73.407 at epoch 8 
 best_stats: {'best_valid_epoch': 8, 'best_valid_valid/acc': 78.66, 'best_valid_valid/acc_unbiased': 73.407, 'best_valid_valid/diff': 11.476, 'best_valid_valid/acc_skew': 68.723, 'best_valid_valid/acc_align': 78.091, 'best_valid_test/acc': 79.595, 'best_valid_test/acc_unbiased': 72.569, 'best_valid_test/diff': 15.669, 'best_valid_test/acc_skew': 69.556, 'best_valid_test/acc_align': 75.583}
[14 / 20] best test accuracy: 74.956 at epoch 12 
 best_stats: {'best_test_epoch': 12, 'best_test_valid/acc': 79.233, 'best_test_valid/acc_unbiased': 72.502, 'best_test_valid/diff': 26.041, 'best_test_valid/acc_skew': 59.481, 'best_test_valid/acc_align': 85.522, 'best_test_test/acc': 81.313, 'best_test_test/acc_unbiased': 74.956, 'best_test_test/diff': 22.788, 'best_test_test/acc_skew': 63.562, 'best_test_test/acc_align': 86.351}
[15 / 20] Learning rate: 1e-05 weight: 0.01
[15 / 20] Loss: 4.132740527759639 CE Loss: 0.35337696942172664 Con Loss: 4.129206752384347
[15 / 20] tensor([[0.978, 0.591],
        [0.674, 0.758]]) {'epoch': 15, 'valid/acc': 80.467, 'valid/acc_unbiased': 73.608, 'valid/diff': 24.613, 'valid/acc_skew': 61.302, 'valid/acc_align': 85.915, 'test/acc': 81.578, 'test/acc_unbiased': 75.01, 'test/diff': 23.57, 'test/acc_skew': 63.225, 'test/acc_align': 86.795}
[15 / 20] best valid accuracy: 73.608 at epoch 15 
 best_stats: {'best_valid_epoch': 15, 'best_valid_valid/acc': 80.467, 'best_valid_valid/acc_unbiased': 73.608, 'best_valid_valid/diff': 24.613, 'best_valid_valid/acc_skew': 61.302, 'best_valid_valid/acc_align': 85.915, 'best_valid_test/acc': 81.578, 'best_valid_test/acc_unbiased': 75.01, 'best_valid_test/diff': 23.57, 'best_valid_test/acc_skew': 63.225, 'best_valid_test/acc_align': 86.795}
[15 / 20] best test accuracy: 75.010 at epoch 15 
 best_stats: {'best_test_epoch': 15, 'best_test_valid/acc': 80.467, 'best_test_valid/acc_unbiased': 73.608, 'best_test_valid/diff': 24.613, 'best_test_valid/acc_skew': 61.302, 'best_test_valid/acc_align': 85.915, 'best_test_test/acc': 81.578, 'best_test_test/acc_unbiased': 75.01, 'best_test_test/diff': 23.57, 'best_test_test/acc_skew': 63.225, 'best_test_test/acc_align': 86.795}
[16 / 20] Learning rate: 1e-05 weight: 0.01
[16 / 20] Loss: 4.086474414177041 CE Loss: 0.3533662252326174 Con Loss: 4.082940752521431
[16 / 20] tensor([[0.978, 0.602],
        [0.686, 0.739]]) {'epoch': 16, 'valid/acc': 80.864, 'valid/acc_unbiased': 73.689, 'valid/diff': 23.86, 'valid/acc_skew': 61.759, 'valid/acc_align': 85.619, 'test/acc': 82.019, 'test/acc_unbiased': 75.157, 'test/diff': 21.458, 'test/acc_skew': 64.427, 'test/acc_align': 85.886}
[16 / 20] best valid accuracy: 73.689 at epoch 16 
 best_stats: {'best_valid_epoch': 16, 'best_valid_valid/acc': 80.864, 'best_valid_valid/acc_unbiased': 73.689, 'best_valid_valid/diff': 23.86, 'best_valid_valid/acc_skew': 61.759, 'best_valid_valid/acc_align': 85.619, 'best_valid_test/acc': 82.019, 'best_valid_test/acc_unbiased': 75.157, 'best_valid_test/diff': 21.458, 'best_valid_test/acc_skew': 64.427, 'best_valid_test/acc_align': 85.886}
[16 / 20] best test accuracy: 75.157 at epoch 16 
 best_stats: {'best_test_epoch': 16, 'best_test_valid/acc': 80.864, 'best_test_valid/acc_unbiased': 73.689, 'best_test_valid/diff': 23.86, 'best_test_valid/acc_skew': 61.759, 'best_test_valid/acc_align': 85.619, 'best_test_test/acc': 82.019, 'best_test_test/acc_unbiased': 75.157, 'best_test_test/diff': 21.458, 'best_test_test/acc_skew': 64.427, 'best_test_test/acc_align': 85.886}
[17 / 20] Learning rate: 1e-05 weight: 0.01
[17 / 20] Loss: 4.0815426856112005 CE Loss: 0.35192651934545166 Con Loss: 4.078023430828922
[17 / 20] tensor([[0.978, 0.591],
        [0.683, 0.752]]) {'epoch': 17, 'valid/acc': 80.82, 'valid/acc_unbiased': 73.743, 'valid/diff': 24.839, 'valid/acc_skew': 61.324, 'valid/acc_align': 86.163, 'test/acc': 81.886, 'test/acc_unbiased': 75.089, 'test/diff': 22.806, 'test/acc_skew': 63.686, 'test/acc_align': 86.492}
[17 / 20] best valid accuracy: 73.743 at epoch 17 
 best_stats: {'best_valid_epoch': 17, 'best_valid_valid/acc': 80.82, 'best_valid_valid/acc_unbiased': 73.743, 'best_valid_valid/diff': 24.839, 'best_valid_valid/acc_skew': 61.324, 'best_valid_valid/acc_align': 86.163, 'best_valid_test/acc': 81.886, 'best_valid_test/acc_unbiased': 75.089, 'best_valid_test/diff': 22.806, 'best_valid_test/acc_skew': 63.686, 'best_valid_test/acc_align': 86.492}
[17 / 20] best test accuracy: 75.157 at epoch 16 
 best_stats: {'best_test_epoch': 16, 'best_test_valid/acc': 80.864, 'best_test_valid/acc_unbiased': 73.689, 'best_test_valid/diff': 23.86, 'best_test_valid/acc_skew': 61.759, 'best_test_valid/acc_align': 85.619, 'best_test_test/acc': 82.019, 'best_test_test/acc_unbiased': 75.157, 'best_test_test/diff': 21.458, 'best_test_test/acc_skew': 64.427, 'best_test_test/acc_align': 85.886}
[18 / 20] Learning rate: 1e-05 weight: 0.01
[18 / 20] Loss: 4.109784880366409 CE Loss: 0.35640264151025824 Con Loss: 4.10622084948598
[18 / 20] tensor([[0.981, 0.614],
        [0.668, 0.752]]) {'epoch': 18, 'valid/acc': 80.159, 'valid/acc_unbiased': 73.576, 'valid/diff': 25.067, 'valid/acc_skew': 61.042, 'valid/acc_align': 86.109, 'test/acc': 81.622, 'test/acc_unbiased': 75.353, 'test/diff': 22.56, 'test/acc_skew': 64.073, 'test/acc_align': 86.633}
[18 / 20] best valid accuracy: 73.743 at epoch 17 
 best_stats: {'best_valid_epoch': 17, 'best_valid_valid/acc': 80.82, 'best_valid_valid/acc_unbiased': 73.743, 'best_valid_valid/diff': 24.839, 'best_valid_valid/acc_skew': 61.324, 'best_valid_valid/acc_align': 86.163, 'best_valid_test/acc': 81.886, 'best_valid_test/acc_unbiased': 75.089, 'best_valid_test/diff': 22.806, 'best_valid_test/acc_skew': 63.686, 'best_valid_test/acc_align': 86.492}
[18 / 20] best test accuracy: 75.353 at epoch 18 
 best_stats: {'best_test_epoch': 18, 'best_test_valid/acc': 80.159, 'best_test_valid/acc_unbiased': 73.576, 'best_test_valid/diff': 25.067, 'best_test_valid/acc_skew': 61.042, 'best_test_valid/acc_align': 86.109, 'best_test_test/acc': 81.622, 'best_test_test/acc_unbiased': 75.353, 'best_test_test/diff': 22.56, 'best_test_test/acc_skew': 64.073, 'best_test_test/acc_align': 86.633}
[19 / 20] Learning rate: 1e-05 weight: 0.01
[19 / 20] Loss: 4.149953013455453 CE Loss: 0.3512578778211564 Con Loss: 4.146440444212199
[19 / 20] tensor([[0.977, 0.562],
        [0.678, 0.776]]) {'epoch': 19, 'valid/acc': 80.908, 'valid/acc_unbiased': 73.679, 'valid/diff': 26.248, 'valid/acc_skew': 60.555, 'valid/acc_align': 86.803, 'test/acc': 81.622, 'test/acc_unbiased': 74.846, 'test/diff': 25.622, 'test/acc_skew': 62.035, 'test/acc_align': 87.657}
[19 / 20] best valid accuracy: 73.743 at epoch 17 
 best_stats: {'best_valid_epoch': 17, 'best_valid_valid/acc': 80.82, 'best_valid_valid/acc_unbiased': 73.743, 'best_valid_valid/diff': 24.839, 'best_valid_valid/acc_skew': 61.324, 'best_valid_valid/acc_align': 86.163, 'best_valid_test/acc': 81.886, 'best_valid_test/acc_unbiased': 75.089, 'best_valid_test/diff': 22.806, 'best_valid_test/acc_skew': 63.686, 'best_valid_test/acc_align': 86.492}
[19 / 20] best test accuracy: 75.353 at epoch 18 
 best_stats: {'best_test_epoch': 18, 'best_test_valid/acc': 80.159, 'best_test_valid/acc_unbiased': 73.576, 'best_test_valid/diff': 25.067, 'best_test_valid/acc_skew': 61.042, 'best_test_valid/acc_align': 86.109, 'best_test_test/acc': 81.622, 'best_test_test/acc_unbiased': 75.353, 'best_test_test/diff': 22.56, 'best_test_test/acc_skew': 64.073, 'best_test_test/acc_align': 86.633}
[20 / 20] Learning rate: 1e-05 weight: 0.01
[20 / 20] Loss: 4.135456609618838 CE Loss: 0.34437861802068287 Con Loss: 4.132012833642049
[20 / 20] tensor([[0.979, 0.562],
        [0.677, 0.788]]) {'epoch': 20, 'valid/acc': 80.379, 'valid/acc_unbiased': 73.022, 'valid/diff': 27.661, 'valid/acc_skew': 59.191, 'valid/acc_align': 86.852, 'test/acc': 81.754, 'test/acc_unbiased': 75.167, 'test/diff': 26.38, 'test/acc_skew': 61.977, 'test/acc_align': 88.357}
[20 / 20] best valid accuracy: 73.743 at epoch 17 
 best_stats: {'best_valid_epoch': 17, 'best_valid_valid/acc': 80.82, 'best_valid_valid/acc_unbiased': 73.743, 'best_valid_valid/diff': 24.839, 'best_valid_valid/acc_skew': 61.324, 'best_valid_valid/acc_align': 86.163, 'best_valid_test/acc': 81.886, 'best_valid_test/acc_unbiased': 75.089, 'best_valid_test/diff': 22.806, 'best_valid_test/acc_skew': 63.686, 'best_valid_test/acc_align': 86.492}
[20 / 20] best test accuracy: 75.353 at epoch 18 
 best_stats: {'best_test_epoch': 18, 'best_test_valid/acc': 80.159, 'best_test_valid/acc_unbiased': 73.576, 'best_test_valid/diff': 25.067, 'best_test_valid/acc_skew': 61.042, 'best_test_valid/acc_align': 86.109, 'best_test_test/acc': 81.622, 'best_test_test/acc_unbiased': 75.353, 'best_test_test/diff': 22.56, 'best_test_test/acc_skew': 64.073, 'best_test_test/acc_align': 86.633}
Total training time: 0:28:13
