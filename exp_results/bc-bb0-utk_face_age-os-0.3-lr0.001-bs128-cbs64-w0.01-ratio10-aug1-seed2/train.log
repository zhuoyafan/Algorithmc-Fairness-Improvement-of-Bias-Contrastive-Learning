Log level set to: INFO
Set seed: 2
=======> Using Fixed Random Seed: 2 <========
save_path: exp_results/bc-bb0-utk_face_age-os-0.3-lr0.001-bs128-cbs64-w0.01-ratio10-aug1-seed2
get_utk_face - split: train, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_age-0.3
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [8237, 1033]
Target 1: [5765, 1477]
Binary Target 1
---------------------------
Target 0: [8237, 1033]
Target 1: [5765, 1477]
===================================
Normal Label Distribution: 
Target 0: [8237, 1033]
Target 1: [5765, 1477]
===================================
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [8237, 8237]
Target 1: [8237, 8237]
Binary Target 1
---------------------------
Target 0: [8237, 8237]
Target 1: [8237, 8237]
===================================
Normal Label Distribution: 
Target 0: [8237, 8237]
Target 1: [8237, 8237]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 32948, target_attr: gender, bias_attr: age bias_rate: 0.3
['[train] target_0-bias_0: 8237', '[train] target_0-bias_1: 8237', '[train] target_1-bias_0: 8237', '[train] target_1-bias_1: 8237']
confusion_matrix - 
 original: tensor([[8237., 8237.],
        [8237., 8237.]]), 
 normalized: tensor([[0.500, 0.500],
        [0.500, 0.500]]), 
 b|y: tensor([[0.500, 0.500],
        [0.500, 0.500]])
get_utk_face - split: train, aug: 1, given_y: True, ratio: 10
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_age-0.3
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [8237, 1033]
Target 1: [5765, 1477]
Binary Target 1
---------------------------
Target 0: [8237, 1033]
Target 1: [5765, 1477]
===================================
Normal Label Distribution: 
Target 0: [8237, 1033]
Target 1: [5765, 1477]
===================================
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [8237, 8237]
Target 1: [8237, 8237]
Binary Target 1
---------------------------
Target 0: [8237, 8237]
Target 1: [8237, 8237]
===================================
Normal Label Distribution: 
Target 0: [8237, 8237]
Target 1: [8237, 8237]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 32948, target_attr: gender, bias_attr: age bias_rate: 0.3
['[train] target_0-bias_0: 8237', '[train] target_0-bias_1: 8237', '[train] target_1-bias_0: 8237', '[train] target_1-bias_1: 8237']
get_utk_face - split: valid, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_age-0.3
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [1030, 195]
Target 1: [841, 202]
Binary Target 1
---------------------------
Target 0: [1030, 195]
Target 1: [841, 202]
===================================
Normal Label Distribution: 
Target 0: [1030, 195]
Target 1: [841, 202]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 2268, target_attr: gender, bias_attr: age bias_rate: 0.3
['[valid] target_0-bias_0: 1030', '[valid] target_0-bias_1: 195', '[valid] target_1-bias_0: 841', '[valid] target_1-bias_1: 202']
get_utk_face - split: test, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_age-0.3
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [1061, 176]
Target 1: [867, 165]
Binary Target 1
---------------------------
Target 0: [1061, 176]
Target 1: [867, 165]
===================================
Normal Label Distribution: 
Target 0: [1061, 176]
Target 1: [867, 165]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 2269, target_attr: gender, bias_attr: age bias_rate: 0.3
['[test] target_0-bias_0: 1061', '[test] target_0-bias_1: 176', '[test] target_1-bias_0: 867', '[test] target_1-bias_1: 165']
decay_epochs: [6, 13]
[1 / 20] Learning rate: 0.001 weight: 0.01
[1 / 20] Loss: 4.864183029185456 CE Loss: 0.5981545740356575 Con Loss: 4.85820149732791
[1 / 20] tensor([[0.870, 0.801],
        [0.746, 0.497]]) {'epoch': 1, 'valid/acc': 78.395, 'valid/acc_unbiased': 74.774, 'valid/diff': 9.664, 'valid/acc_skew': 79.606, 'valid/acc_align': 69.942, 'test/acc': 79.022, 'test/acc_unbiased': 72.857, 'test/diff': 15.904, 'test/acc_skew': 80.809, 'test/acc_align': 64.905}
[1 / 20] best valid accuracy: 74.774 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 78.395, 'best_valid_valid/acc_unbiased': 74.774, 'best_valid_valid/diff': 9.664, 'best_valid_valid/acc_skew': 79.606, 'best_valid_valid/acc_align': 69.942, 'best_valid_test/acc': 79.022, 'best_valid_test/acc_unbiased': 72.857, 'best_valid_test/diff': 15.904, 'best_valid_test/acc_skew': 80.809, 'best_valid_test/acc_align': 64.905}
[1 / 20] best test accuracy: 72.857 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 78.395, 'best_test_valid/acc_unbiased': 74.774, 'best_test_valid/diff': 9.664, 'best_test_valid/acc_skew': 79.606, 'best_test_valid/acc_align': 69.942, 'best_test_test/acc': 79.022, 'best_test_test/acc_unbiased': 72.857, 'best_test_test/diff': 15.904, 'best_test_test/acc_skew': 80.809, 'best_test_test/acc_align': 64.905}
[2 / 20] Learning rate: 0.001 weight: 0.01
[2 / 20] Loss: 4.814989214254928 CE Loss: 0.5358446436381621 Con Loss: 4.809630769280622
[2 / 20] tensor([[0.870, 0.716],
        [0.799, 0.655]]) {'epoch': 2, 'valid/acc': 80.732, 'valid/acc_unbiased': 75.552, 'valid/diff': 15.024, 'valid/acc_skew': 83.064, 'valid/acc_align': 68.04, 'test/acc': 81.534, 'test/acc_unbiased': 75.992, 'test/diff': 14.939, 'test/acc_skew': 83.462, 'test/acc_align': 68.523}
[2 / 20] best valid accuracy: 75.552 at epoch 2 
 best_stats: {'best_valid_epoch': 2, 'best_valid_valid/acc': 80.732, 'best_valid_valid/acc_unbiased': 75.552, 'best_valid_valid/diff': 15.024, 'best_valid_valid/acc_skew': 83.064, 'best_valid_valid/acc_align': 68.04, 'best_valid_test/acc': 81.534, 'best_valid_test/acc_unbiased': 75.992, 'best_valid_test/diff': 14.939, 'best_valid_test/acc_skew': 83.462, 'best_valid_test/acc_align': 68.523}
[2 / 20] best test accuracy: 75.992 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 80.732, 'best_test_valid/acc_unbiased': 75.552, 'best_test_valid/diff': 15.024, 'best_test_valid/acc_skew': 83.064, 'best_test_valid/acc_align': 68.04, 'best_test_test/acc': 81.534, 'best_test_test/acc_unbiased': 75.992, 'best_test_test/diff': 14.939, 'best_test_test/acc_skew': 83.462, 'best_test_test/acc_align': 68.523}
[3 / 20] Learning rate: 0.001 weight: 0.01
[3 / 20] Loss: 4.7996784006201905 CE Loss: 0.5137044105466685 Con Loss: 4.794541351885215
[3 / 20] tensor([[0.857, 0.545],
        [0.829, 0.770]]) {'epoch': 3, 'valid/acc': 80.996, 'valid/acc_unbiased': 74.905, 'valid/diff': 21.455, 'valid/acc_skew': 83.902, 'valid/acc_align': 65.908, 'test/acc': 81.578, 'test/acc_unbiased': 75.03, 'test/diff': 18.544, 'test/acc_skew': 84.302, 'test/acc_align': 65.758}
[3 / 20] best valid accuracy: 75.552 at epoch 2 
 best_stats: {'best_valid_epoch': 2, 'best_valid_valid/acc': 80.732, 'best_valid_valid/acc_unbiased': 75.552, 'best_valid_valid/diff': 15.024, 'best_valid_valid/acc_skew': 83.064, 'best_valid_valid/acc_align': 68.04, 'best_valid_test/acc': 81.534, 'best_valid_test/acc_unbiased': 75.992, 'best_valid_test/diff': 14.939, 'best_valid_test/acc_skew': 83.462, 'best_valid_test/acc_align': 68.523}
[3 / 20] best test accuracy: 75.992 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 80.732, 'best_test_valid/acc_unbiased': 75.552, 'best_test_valid/diff': 15.024, 'best_test_valid/acc_skew': 83.064, 'best_test_valid/acc_align': 68.04, 'best_test_test/acc': 81.534, 'best_test_test/acc_unbiased': 75.992, 'best_test_test/diff': 14.939, 'best_test_test/acc_skew': 83.462, 'best_test_test/acc_align': 68.523}
[4 / 20] Learning rate: 0.001 weight: 0.01
[4 / 20] Loss: 4.7888561052301775 CE Loss: 0.48201910904835366 Con Loss: 4.784035921646754
[4 / 20] tensor([[0.888, 0.727],
        [0.773, 0.636]]) {'epoch': 4, 'valid/acc': 80.644, 'valid/acc_unbiased': 75.373, 'valid/diff': 14.665, 'valid/acc_skew': 82.705, 'valid/acc_align': 68.04, 'test/acc': 81.313, 'test/acc_unbiased': 75.606, 'test/diff': 14.849, 'test/acc_skew': 83.031, 'test/acc_align': 68.182}
[4 / 20] best valid accuracy: 75.552 at epoch 2 
 best_stats: {'best_valid_epoch': 2, 'best_valid_valid/acc': 80.732, 'best_valid_valid/acc_unbiased': 75.552, 'best_valid_valid/diff': 15.024, 'best_valid_valid/acc_skew': 83.064, 'best_valid_valid/acc_align': 68.04, 'best_valid_test/acc': 81.534, 'best_valid_test/acc_unbiased': 75.992, 'best_valid_test/diff': 14.939, 'best_valid_test/acc_skew': 83.462, 'best_valid_test/acc_align': 68.523}
[4 / 20] best test accuracy: 75.992 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 80.732, 'best_test_valid/acc_unbiased': 75.552, 'best_test_valid/diff': 15.024, 'best_test_valid/acc_skew': 83.064, 'best_test_valid/acc_align': 68.04, 'best_test_test/acc': 81.534, 'best_test_test/acc_unbiased': 75.992, 'best_test_test/diff': 14.939, 'best_test_test/acc_skew': 83.462, 'best_test_test/acc_align': 68.523}
[5 / 20] Learning rate: 0.001 weight: 0.01
[5 / 20] Loss: 4.776461093564976 CE Loss: 0.478956108715865 Con Loss: 4.771671527361456
[5 / 20] tensor([[0.882, 0.636],
        [0.835, 0.733]]) {'epoch': 5, 'valid/acc': 82.319, 'valid/acc_unbiased': 76.269, 'valid/diff': 17.715, 'valid/acc_skew': 85.127, 'valid/acc_align': 67.412, 'test/acc': 83.429, 'test/acc_unbiased': 77.174, 'test/diff': 17.378, 'test/acc_skew': 85.863, 'test/acc_align': 68.485}
[5 / 20] best valid accuracy: 76.269 at epoch 5 
 best_stats: {'best_valid_epoch': 5, 'best_valid_valid/acc': 82.319, 'best_valid_valid/acc_unbiased': 76.269, 'best_valid_valid/diff': 17.715, 'best_valid_valid/acc_skew': 85.127, 'best_valid_valid/acc_align': 67.412, 'best_valid_test/acc': 83.429, 'best_valid_test/acc_unbiased': 77.174, 'best_valid_test/diff': 17.378, 'best_valid_test/acc_skew': 85.863, 'best_valid_test/acc_align': 68.485}
[5 / 20] best test accuracy: 77.174 at epoch 5 
 best_stats: {'best_test_epoch': 5, 'best_test_valid/acc': 82.319, 'best_test_valid/acc_unbiased': 76.269, 'best_test_valid/diff': 17.715, 'best_test_valid/acc_skew': 85.127, 'best_test_valid/acc_align': 67.412, 'best_test_test/acc': 83.429, 'best_test_test/acc_unbiased': 77.174, 'best_test_test/diff': 17.378, 'best_test_test/acc_skew': 85.863, 'best_test_test/acc_align': 68.485}
[6 / 20] Learning rate: 0.001 weight: 0.01
[6 / 20] Loss: 4.764934683882294 CE Loss: 0.46083802502899474 Con Loss: 4.760326302021152
[6 / 20] tensor([[0.889, 0.830],
        [0.807, 0.533]]) {'epoch': 6, 'valid/acc': 82.628, 'valid/acc_unbiased': 77.617, 'valid/diff': 14.326, 'valid/acc_skew': 84.78, 'valid/acc_align': 70.454, 'test/acc': 82.724, 'test/acc_unbiased': 76.476, 'test/diff': 16.664, 'test/acc_skew': 84.808, 'test/acc_align': 68.144}
[6 / 20] best valid accuracy: 77.617 at epoch 6 
 best_stats: {'best_valid_epoch': 6, 'best_valid_valid/acc': 82.628, 'best_valid_valid/acc_unbiased': 77.617, 'best_valid_valid/diff': 14.326, 'best_valid_valid/acc_skew': 84.78, 'best_valid_valid/acc_align': 70.454, 'best_valid_test/acc': 82.724, 'best_valid_test/acc_unbiased': 76.476, 'best_valid_test/diff': 16.664, 'best_valid_test/acc_skew': 84.808, 'best_valid_test/acc_align': 68.144}
[6 / 20] best test accuracy: 77.174 at epoch 5 
 best_stats: {'best_test_epoch': 5, 'best_test_valid/acc': 82.319, 'best_test_valid/acc_unbiased': 76.269, 'best_test_valid/diff': 17.715, 'best_test_valid/acc_skew': 85.127, 'best_test_valid/acc_align': 67.412, 'best_test_test/acc': 83.429, 'best_test_test/acc_unbiased': 77.174, 'best_test_test/diff': 17.378, 'best_test_test/acc_skew': 85.863, 'best_test_test/acc_align': 68.485}
[7 / 20] Learning rate: 0.0001 weight: 0.01
[7 / 20] Loss: 4.7331429676362955 CE Loss: 0.4205535811403647 Con Loss: 4.7289374283654775
[7 / 20] tensor([[0.905, 0.739],
        [0.869, 0.721]]) {'epoch': 7, 'valid/acc': 85.229, 'valid/acc_unbiased': 79.882, 'valid/diff': 15.762, 'valid/acc_skew': 87.763, 'valid/acc_align': 72.001, 'test/acc': 86.47, 'test/acc_unbiased': 80.829, 'test/diff': 15.674, 'test/acc_skew': 88.666, 'test/acc_align': 72.992}
[7 / 20] best valid accuracy: 79.882 at epoch 7 
 best_stats: {'best_valid_epoch': 7, 'best_valid_valid/acc': 85.229, 'best_valid_valid/acc_unbiased': 79.882, 'best_valid_valid/diff': 15.762, 'best_valid_valid/acc_skew': 87.763, 'best_valid_valid/acc_align': 72.001, 'best_valid_test/acc': 86.47, 'best_valid_test/acc_unbiased': 80.829, 'best_valid_test/diff': 15.674, 'best_valid_test/acc_skew': 88.666, 'best_valid_test/acc_align': 72.992}
[7 / 20] best test accuracy: 80.829 at epoch 7 
 best_stats: {'best_test_epoch': 7, 'best_test_valid/acc': 85.229, 'best_test_valid/acc_unbiased': 79.882, 'best_test_valid/diff': 15.762, 'best_test_valid/acc_skew': 87.763, 'best_test_valid/acc_align': 72.001, 'best_test_test/acc': 86.47, 'best_test_test/acc_unbiased': 80.829, 'best_test_test/diff': 15.674, 'best_test_test/acc_skew': 88.666, 'best_test_test/acc_align': 72.992}
[8 / 20] Learning rate: 0.0001 weight: 0.01
[8 / 20] Loss: 4.701417859237114 CE Loss: 0.3914020110518229 Con Loss: 4.697503837549789
[8 / 20] tensor([[0.915, 0.761],
        [0.875, 0.697]]) {'epoch': 8, 'valid/acc': 85.362, 'valid/acc_unbiased': 79.472, 'valid/diff': 17.401, 'valid/acc_skew': 88.173, 'valid/acc_align': 70.772, 'test/acc': 87.219, 'test/acc_unbiased': 81.224, 'test/diff': 16.614, 'test/acc_skew': 89.53, 'test/acc_align': 72.917}
[8 / 20] best valid accuracy: 79.882 at epoch 7 
 best_stats: {'best_valid_epoch': 7, 'best_valid_valid/acc': 85.229, 'best_valid_valid/acc_unbiased': 79.882, 'best_valid_valid/diff': 15.762, 'best_valid_valid/acc_skew': 87.763, 'best_valid_valid/acc_align': 72.001, 'best_valid_test/acc': 86.47, 'best_valid_test/acc_unbiased': 80.829, 'best_valid_test/diff': 15.674, 'best_valid_test/acc_skew': 88.666, 'best_valid_test/acc_align': 72.992}
[8 / 20] best test accuracy: 81.224 at epoch 8 
 best_stats: {'best_test_epoch': 8, 'best_test_valid/acc': 85.362, 'best_test_valid/acc_unbiased': 79.472, 'best_test_valid/diff': 17.401, 'best_test_valid/acc_skew': 88.173, 'best_test_valid/acc_align': 70.772, 'best_test_test/acc': 87.219, 'best_test_test/acc_unbiased': 81.224, 'best_test_test/diff': 16.614, 'best_test_test/acc_skew': 89.53, 'best_test_test/acc_align': 72.917}
[9 / 20] Learning rate: 0.0001 weight: 0.01
[9 / 20] Loss: 4.6870366847672855 CE Loss: 0.37608885110198864 Con Loss: 4.683275793859851
[9 / 20] tensor([[0.890, 0.739],
        [0.895, 0.739]]) {'epoch': 9, 'valid/acc': 85.979, 'valid/acc_unbiased': 80.528, 'valid/diff': 16.612, 'valid/acc_skew': 88.834, 'valid/acc_align': 72.221, 'test/acc': 86.911, 'test/acc_unbiased': 81.57, 'test/diff': 15.337, 'test/acc_skew': 89.238, 'test/acc_align': 73.902}
[9 / 20] best valid accuracy: 80.528 at epoch 9 
 best_stats: {'best_valid_epoch': 9, 'best_valid_valid/acc': 85.979, 'best_valid_valid/acc_unbiased': 80.528, 'best_valid_valid/diff': 16.612, 'best_valid_valid/acc_skew': 88.834, 'best_valid_valid/acc_align': 72.221, 'best_valid_test/acc': 86.911, 'best_valid_test/acc_unbiased': 81.57, 'best_valid_test/diff': 15.337, 'best_valid_test/acc_skew': 89.238, 'best_valid_test/acc_align': 73.902}
[9 / 20] best test accuracy: 81.570 at epoch 9 
 best_stats: {'best_test_epoch': 9, 'best_test_valid/acc': 85.979, 'best_test_valid/acc_unbiased': 80.528, 'best_test_valid/diff': 16.612, 'best_test_valid/acc_skew': 88.834, 'best_test_valid/acc_align': 72.221, 'best_test_test/acc': 86.911, 'best_test_test/acc_unbiased': 81.57, 'best_test_test/diff': 15.337, 'best_test_test/acc_skew': 89.238, 'best_test_test/acc_align': 73.902}
[10 / 20] Learning rate: 0.0001 weight: 0.01
[10 / 20] Loss: 4.667355194939302 CE Loss: 0.369148563167142 Con Loss: 4.663663712175375
[10 / 20] tensor([[0.919, 0.739],
        [0.874, 0.715]]) {'epoch': 10, 'valid/acc': 85.802, 'valid/acc_unbiased': 80.174, 'valid/diff': 16.754, 'valid/acc_skew': 88.551, 'valid/acc_align': 71.797, 'test/acc': 87.307, 'test/acc_unbiased': 81.175, 'test/diff': 16.972, 'test/acc_skew': 89.661, 'test/acc_align': 72.689}
[10 / 20] best valid accuracy: 80.528 at epoch 9 
 best_stats: {'best_valid_epoch': 9, 'best_valid_valid/acc': 85.979, 'best_valid_valid/acc_unbiased': 80.528, 'best_valid_valid/diff': 16.612, 'best_valid_valid/acc_skew': 88.834, 'best_valid_valid/acc_align': 72.221, 'best_valid_test/acc': 86.911, 'best_valid_test/acc_unbiased': 81.57, 'best_valid_test/diff': 15.337, 'best_valid_test/acc_skew': 89.238, 'best_valid_test/acc_align': 73.902}
[10 / 20] best test accuracy: 81.570 at epoch 9 
 best_stats: {'best_test_epoch': 9, 'best_test_valid/acc': 85.979, 'best_test_valid/acc_unbiased': 80.528, 'best_test_valid/diff': 16.612, 'best_test_valid/acc_skew': 88.834, 'best_test_valid/acc_align': 72.221, 'best_test_test/acc': 86.911, 'best_test_test/acc_unbiased': 81.57, 'best_test_test/diff': 15.337, 'best_test_test/acc_skew': 89.238, 'best_test_test/acc_align': 73.902}
[11 / 20] Learning rate: 0.0001 weight: 0.01
[11 / 20] Loss: 4.659387111142811 CE Loss: 0.3596860793257159 Con Loss: 4.655790251175785
[11 / 20] tensor([[0.933, 0.801],
        [0.842, 0.667]]) {'epoch': 11, 'valid/acc': 86.376, 'valid/acc_unbiased': 80.898, 'valid/diff': 15.495, 'valid/acc_skew': 88.645, 'valid/acc_align': 73.151, 'test/acc': 86.866, 'test/acc_unbiased': 81.072, 'test/diff': 15.363, 'test/acc_skew': 88.753, 'test/acc_align': 73.39}
[11 / 20] best valid accuracy: 80.898 at epoch 11 
 best_stats: {'best_valid_epoch': 11, 'best_valid_valid/acc': 86.376, 'best_valid_valid/acc_unbiased': 80.898, 'best_valid_valid/diff': 15.495, 'best_valid_valid/acc_skew': 88.645, 'best_valid_valid/acc_align': 73.151, 'best_valid_test/acc': 86.866, 'best_valid_test/acc_unbiased': 81.072, 'best_valid_test/diff': 15.363, 'best_valid_test/acc_skew': 88.753, 'best_valid_test/acc_align': 73.39}
[11 / 20] best test accuracy: 81.570 at epoch 9 
 best_stats: {'best_test_epoch': 9, 'best_test_valid/acc': 85.979, 'best_test_valid/acc_unbiased': 80.528, 'best_test_valid/diff': 16.612, 'best_test_valid/acc_skew': 88.834, 'best_test_valid/acc_align': 72.221, 'best_test_test/acc': 86.911, 'best_test_test/acc_unbiased': 81.57, 'best_test_test/diff': 15.337, 'best_test_test/acc_skew': 89.238, 'best_test_test/acc_align': 73.902}
[12 / 20] Learning rate: 0.0001 weight: 0.01
[12 / 20] Loss: 4.641596500743604 CE Loss: 0.34458615784363156 Con Loss: 4.6381506376855794
[12 / 20] tensor([[0.910, 0.699],
        [0.877, 0.752]]) {'epoch': 12, 'valid/acc': 86.243, 'valid/acc_unbiased': 80.187, 'valid/diff': 17.982, 'valid/acc_skew': 89.177, 'valid/acc_align': 71.196, 'test/acc': 86.955, 'test/acc_unbiased': 80.936, 'test/diff': 16.833, 'test/acc_skew': 89.352, 'test/acc_align': 72.519}
[12 / 20] best valid accuracy: 80.898 at epoch 11 
 best_stats: {'best_valid_epoch': 11, 'best_valid_valid/acc': 86.376, 'best_valid_valid/acc_unbiased': 80.898, 'best_valid_valid/diff': 15.495, 'best_valid_valid/acc_skew': 88.645, 'best_valid_valid/acc_align': 73.151, 'best_valid_test/acc': 86.866, 'best_valid_test/acc_unbiased': 81.072, 'best_valid_test/diff': 15.363, 'best_valid_test/acc_skew': 88.753, 'best_valid_test/acc_align': 73.39}
[12 / 20] best test accuracy: 81.570 at epoch 9 
 best_stats: {'best_test_epoch': 9, 'best_test_valid/acc': 85.979, 'best_test_valid/acc_unbiased': 80.528, 'best_test_valid/diff': 16.612, 'best_test_valid/acc_skew': 88.834, 'best_test_valid/acc_align': 72.221, 'best_test_test/acc': 86.911, 'best_test_test/acc_unbiased': 81.57, 'best_test_test/diff': 15.337, 'best_test_test/acc_skew': 89.238, 'best_test_test/acc_align': 73.902}
[13 / 20] Learning rate: 0.0001 weight: 0.01
[13 / 20] Loss: 4.633982922710434 CE Loss: 0.3398578456627074 Con Loss: 4.630584334377758
[13 / 20] tensor([[0.926, 0.744],
        [0.875, 0.733]]) {'epoch': 13, 'valid/acc': 86.508, 'valid/acc_unbiased': 81.037, 'valid/diff': 15.987, 'valid/acc_skew': 89.031, 'valid/acc_align': 73.044, 'test/acc': 87.836, 'test/acc_unbiased': 81.966, 'test/diff': 16.166, 'test/acc_skew': 90.049, 'test/acc_align': 73.883}
[13 / 20] best valid accuracy: 81.037 at epoch 13 
 best_stats: {'best_valid_epoch': 13, 'best_valid_valid/acc': 86.508, 'best_valid_valid/acc_unbiased': 81.037, 'best_valid_valid/diff': 15.987, 'best_valid_valid/acc_skew': 89.031, 'best_valid_valid/acc_align': 73.044, 'best_valid_test/acc': 87.836, 'best_valid_test/acc_unbiased': 81.966, 'best_valid_test/diff': 16.166, 'best_valid_test/acc_skew': 90.049, 'best_valid_test/acc_align': 73.883}
[13 / 20] best test accuracy: 81.966 at epoch 13 
 best_stats: {'best_test_epoch': 13, 'best_test_valid/acc': 86.508, 'best_test_valid/acc_unbiased': 81.037, 'best_test_valid/diff': 15.987, 'best_test_valid/acc_skew': 89.031, 'best_test_valid/acc_align': 73.044, 'best_test_test/acc': 87.836, 'best_test_test/acc_unbiased': 81.966, 'best_test_test/diff': 16.166, 'best_test_test/acc_skew': 90.049, 'best_test_test/acc_align': 73.883}
[14 / 20] Learning rate: 1e-05 weight: 0.01
[14 / 20] Loss: 4.63046424203928 CE Loss: 0.339548756257993 Con Loss: 4.627068750572042
[14 / 20] tensor([[0.914, 0.722],
        [0.890, 0.770]]) {'epoch': 14, 'valid/acc': 86.508, 'valid/acc_unbiased': 80.789, 'valid/diff': 17.189, 'valid/acc_skew': 89.384, 'valid/acc_align': 72.195, 'test/acc': 87.968, 'test/acc_unbiased': 82.399, 'test/diff': 15.669, 'test/acc_skew': 90.233, 'test/acc_align': 74.564}
[14 / 20] best valid accuracy: 81.037 at epoch 13 
 best_stats: {'best_valid_epoch': 13, 'best_valid_valid/acc': 86.508, 'best_valid_valid/acc_unbiased': 81.037, 'best_valid_valid/diff': 15.987, 'best_valid_valid/acc_skew': 89.031, 'best_valid_valid/acc_align': 73.044, 'best_valid_test/acc': 87.836, 'best_valid_test/acc_unbiased': 81.966, 'best_valid_test/diff': 16.166, 'best_valid_test/acc_skew': 90.049, 'best_valid_test/acc_align': 73.883}
[14 / 20] best test accuracy: 82.399 at epoch 14 
 best_stats: {'best_test_epoch': 14, 'best_test_valid/acc': 86.508, 'best_test_valid/acc_unbiased': 80.789, 'best_test_valid/diff': 17.189, 'best_test_valid/acc_skew': 89.384, 'best_test_valid/acc_align': 72.195, 'best_test_test/acc': 87.968, 'best_test_test/acc_unbiased': 82.399, 'best_test_test/diff': 15.669, 'best_test_test/acc_skew': 90.233, 'best_test_test/acc_align': 74.564}
[15 / 20] Learning rate: 1e-05 weight: 0.01
[15 / 20] Loss: 4.617829139999384 CE Loss: 0.3305673003739432 Con Loss: 4.614523457398298
[15 / 20] tensor([[0.913, 0.699],
        [0.895, 0.770]]) {'epoch': 15, 'valid/acc': 86.155, 'valid/acc_unbiased': 80.064, 'valid/diff': 18.303, 'valid/acc_skew': 89.216, 'valid/acc_align': 70.913, 'test/acc': 87.924, 'test/acc_unbiased': 81.922, 'test/diff': 16.988, 'test/acc_skew': 90.416, 'test/acc_align': 73.428}
[15 / 20] best valid accuracy: 81.037 at epoch 13 
 best_stats: {'best_valid_epoch': 13, 'best_valid_valid/acc': 86.508, 'best_valid_valid/acc_unbiased': 81.037, 'best_valid_valid/diff': 15.987, 'best_valid_valid/acc_skew': 89.031, 'best_valid_valid/acc_align': 73.044, 'best_valid_test/acc': 87.836, 'best_valid_test/acc_unbiased': 81.966, 'best_valid_test/diff': 16.166, 'best_valid_test/acc_skew': 90.049, 'best_valid_test/acc_align': 73.883}
[15 / 20] best test accuracy: 82.399 at epoch 14 
 best_stats: {'best_test_epoch': 14, 'best_test_valid/acc': 86.508, 'best_test_valid/acc_unbiased': 80.789, 'best_test_valid/diff': 17.189, 'best_test_valid/acc_skew': 89.384, 'best_test_valid/acc_align': 72.195, 'best_test_test/acc': 87.968, 'best_test_test/acc_unbiased': 82.399, 'best_test_test/diff': 15.669, 'best_test_test/acc_skew': 90.233, 'best_test_test/acc_align': 74.564}
[16 / 20] Learning rate: 1e-05 weight: 0.01
[16 / 20] Loss: 4.611963554596285 CE Loss: 0.3343991449016151 Con Loss: 4.608619572483279
[16 / 20] tensor([[0.924, 0.710],
        [0.880, 0.745]]) {'epoch': 16, 'valid/acc': 86.861, 'valid/acc_unbiased': 81.183, 'valid/diff': 16.897, 'valid/acc_skew': 89.631, 'valid/acc_align': 72.734, 'test/acc': 87.748, 'test/acc_unbiased': 81.485, 'test/diff': 17.401, 'test/acc_skew': 90.185, 'test/acc_align': 72.784}
[16 / 20] best valid accuracy: 81.183 at epoch 16 
 best_stats: {'best_valid_epoch': 16, 'best_valid_valid/acc': 86.861, 'best_valid_valid/acc_unbiased': 81.183, 'best_valid_valid/diff': 16.897, 'best_valid_valid/acc_skew': 89.631, 'best_valid_valid/acc_align': 72.734, 'best_valid_test/acc': 87.748, 'best_valid_test/acc_unbiased': 81.485, 'best_valid_test/diff': 17.401, 'best_valid_test/acc_skew': 90.185, 'best_valid_test/acc_align': 72.784}
[16 / 20] best test accuracy: 82.399 at epoch 14 
 best_stats: {'best_test_epoch': 14, 'best_test_valid/acc': 86.508, 'best_test_valid/acc_unbiased': 80.789, 'best_test_valid/diff': 17.189, 'best_test_valid/acc_skew': 89.384, 'best_test_valid/acc_align': 72.195, 'best_test_test/acc': 87.968, 'best_test_test/acc_unbiased': 82.399, 'best_test_test/diff': 15.669, 'best_test_test/acc_skew': 90.233, 'best_test_test/acc_align': 74.564}
[17 / 20] Learning rate: 1e-05 weight: 0.01
[17 / 20] Loss: 4.6148313912746755 CE Loss: 0.32950625549723717 Con Loss: 4.611536324074854
[17 / 20] tensor([[0.919, 0.705],
        [0.881, 0.758]]) {'epoch': 17, 'valid/acc': 86.376, 'valid/acc_unbiased': 80.085, 'valid/diff': 18.822, 'valid/acc_skew': 89.496, 'valid/acc_align': 70.674, 'test/acc': 87.616, 'test/acc_unbiased': 81.557, 'test/diff': 16.901, 'test/acc_skew': 90.007, 'test/acc_align': 73.106}
[17 / 20] best valid accuracy: 81.183 at epoch 16 
 best_stats: {'best_valid_epoch': 16, 'best_valid_valid/acc': 86.861, 'best_valid_valid/acc_unbiased': 81.183, 'best_valid_valid/diff': 16.897, 'best_valid_valid/acc_skew': 89.631, 'best_valid_valid/acc_align': 72.734, 'best_valid_test/acc': 87.748, 'best_valid_test/acc_unbiased': 81.485, 'best_valid_test/diff': 17.401, 'best_valid_test/acc_skew': 90.185, 'best_valid_test/acc_align': 72.784}
[17 / 20] best test accuracy: 82.399 at epoch 14 
 best_stats: {'best_test_epoch': 14, 'best_test_valid/acc': 86.508, 'best_test_valid/acc_unbiased': 80.789, 'best_test_valid/diff': 17.189, 'best_test_valid/acc_skew': 89.384, 'best_test_valid/acc_align': 72.195, 'best_test_test/acc': 87.968, 'best_test_test/acc_unbiased': 82.399, 'best_test_test/diff': 15.669, 'best_test_test/acc_skew': 90.233, 'best_test_test/acc_align': 74.564}
[18 / 20] Learning rate: 1e-05 weight: 0.01
[18 / 20] Loss: 4.617447475763552 CE Loss: 0.3248482173914989 Con Loss: 4.614198996428221
[18 / 20] tensor([[0.919, 0.705],
        [0.886, 0.764]]) {'epoch': 18, 'valid/acc': 86.508, 'valid/acc_unbiased': 80.474, 'valid/diff': 18.044, 'valid/acc_skew': 89.496, 'valid/acc_align': 71.452, 'test/acc': 87.836, 'test/acc_unbiased': 81.823, 'test/diff': 16.829, 'test/acc_skew': 90.238, 'test/acc_align': 73.409}
[18 / 20] best valid accuracy: 81.183 at epoch 16 
 best_stats: {'best_valid_epoch': 16, 'best_valid_valid/acc': 86.861, 'best_valid_valid/acc_unbiased': 81.183, 'best_valid_valid/diff': 16.897, 'best_valid_valid/acc_skew': 89.631, 'best_valid_valid/acc_align': 72.734, 'best_valid_test/acc': 87.748, 'best_valid_test/acc_unbiased': 81.485, 'best_valid_test/diff': 17.401, 'best_valid_test/acc_skew': 90.185, 'best_valid_test/acc_align': 72.784}
[18 / 20] best test accuracy: 82.399 at epoch 14 
 best_stats: {'best_test_epoch': 14, 'best_test_valid/acc': 86.508, 'best_test_valid/acc_unbiased': 80.789, 'best_test_valid/diff': 17.189, 'best_test_valid/acc_skew': 89.384, 'best_test_valid/acc_align': 72.195, 'best_test_test/acc': 87.968, 'best_test_test/acc_unbiased': 82.399, 'best_test_test/diff': 15.669, 'best_test_test/acc_skew': 90.233, 'best_test_test/acc_align': 74.564}
[19 / 20] Learning rate: 1e-05 weight: 0.01
[19 / 20] Loss: 4.6091794790508995 CE Loss: 0.32837805938515197 Con Loss: 4.605895692867692
[19 / 20] tensor([[0.920, 0.710],
        [0.882, 0.770]]) {'epoch': 19, 'valid/acc': 86.552, 'valid/acc_unbiased': 80.484, 'valid/diff': 18.1, 'valid/acc_skew': 89.534, 'valid/acc_align': 71.434, 'test/acc': 87.836, 'test/acc_unbiased': 82.054, 'test/diff': 16.116, 'test/acc_skew': 90.112, 'test/acc_align': 73.996}
[19 / 20] best valid accuracy: 81.183 at epoch 16 
 best_stats: {'best_valid_epoch': 16, 'best_valid_valid/acc': 86.861, 'best_valid_valid/acc_unbiased': 81.183, 'best_valid_valid/diff': 16.897, 'best_valid_valid/acc_skew': 89.631, 'best_valid_valid/acc_align': 72.734, 'best_valid_test/acc': 87.748, 'best_valid_test/acc_unbiased': 81.485, 'best_valid_test/diff': 17.401, 'best_valid_test/acc_skew': 90.185, 'best_valid_test/acc_align': 72.784}
[19 / 20] best test accuracy: 82.399 at epoch 14 
 best_stats: {'best_test_epoch': 14, 'best_test_valid/acc': 86.508, 'best_test_valid/acc_unbiased': 80.789, 'best_test_valid/diff': 17.189, 'best_test_valid/acc_skew': 89.384, 'best_test_valid/acc_align': 72.195, 'best_test_test/acc': 87.968, 'best_test_test/acc_unbiased': 82.399, 'best_test_test/diff': 15.669, 'best_test_test/acc_skew': 90.233, 'best_test_test/acc_align': 74.564}
[20 / 20] Learning rate: 1e-05 weight: 0.01
[20 / 20] Loss: 4.611533887383138 CE Loss: 0.32674208280891703 Con Loss: 4.608266476275375
[20 / 20] tensor([[0.921, 0.710],
        [0.885, 0.758]]) {'epoch': 20, 'valid/acc': 86.728, 'valid/acc_unbiased': 80.794, 'valid/diff': 17.675, 'valid/acc_skew': 89.631, 'valid/acc_align': 71.956, 'test/acc': 87.88, 'test/acc_unbiased': 81.832, 'test/diff': 16.884, 'test/acc_skew': 90.274, 'test/acc_align': 73.39}
[20 / 20] best valid accuracy: 81.183 at epoch 16 
 best_stats: {'best_valid_epoch': 16, 'best_valid_valid/acc': 86.861, 'best_valid_valid/acc_unbiased': 81.183, 'best_valid_valid/diff': 16.897, 'best_valid_valid/acc_skew': 89.631, 'best_valid_valid/acc_align': 72.734, 'best_valid_test/acc': 87.748, 'best_valid_test/acc_unbiased': 81.485, 'best_valid_test/diff': 17.401, 'best_valid_test/acc_skew': 90.185, 'best_valid_test/acc_align': 72.784}
[20 / 20] best test accuracy: 82.399 at epoch 14 
 best_stats: {'best_test_epoch': 14, 'best_test_valid/acc': 86.508, 'best_test_valid/acc_unbiased': 80.789, 'best_test_valid/diff': 17.189, 'best_test_valid/acc_skew': 89.384, 'best_test_valid/acc_align': 72.195, 'best_test_test/acc': 87.968, 'best_test_test/acc_unbiased': 82.399, 'best_test_test/diff': 15.669, 'best_test_test/acc_skew': 90.233, 'best_test_test/acc_align': 74.564}
Total training time: 2:00:45
