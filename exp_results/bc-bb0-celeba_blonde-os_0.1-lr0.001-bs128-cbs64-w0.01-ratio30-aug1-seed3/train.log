Log level set to: INFO
Set seed: 3
=======> Using Fixed Random Seed: 3 <========
save_path: exp_results/bc-bb0-celeba_blonde-os_0.1-lr0.001-bs128-cbs64-w0.01-ratio30-aug1-seed3
get_celeba - split:train, aug: False, given_y: True, ratio: 0
use existing blonde indices from data/celeba/pickles/blonde
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [5348, 5348]
Target 1: [5348, 5348]
Binary Target 1
---------------------------
Target 0: [5348, 5348]
Target 1: [5348, 5348]
===================================
Normal Label Distribution: 
Target 0: [5348, 5348]
Target 1: [5348, 5348]
===================================
Use BiasedCelebASplit 
 target_attr: blonde split: train 
 tensor([[5348., 5348.],
        [5348., 5348.]])
get_celeba - split:train, aug: 1, given_y: True, ratio: 30
use existing blonde indices from data/celeba/pickles/blonde
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [5350, 5350]
Target 1: [5350, 5350]
Binary Target 1
---------------------------
Target 0: [5350, 5350]
Target 1: [5350, 5350]
===================================
Normal Label Distribution: 
Target 0: [5350, 5350]
Target 1: [5350, 5350]
===================================
Use BiasedCelebASplit 
 target_attr: blonde split: train 
 tensor([[5350., 5350.],
        [5350., 5350.]])
get_celeba - split:train_valid, aug: False, given_y: True, ratio: 0
use existing blonde indices from data/celeba/pickles/blonde
Use BiasedCelebASplit 
 target_attr: blonde split: train_valid 
 tensor([[  386.,  4517.],
        [13446.,   280.]])
get_celeba - split:valid, aug: False, given_y: True, ratio: 0
Use BiasedCelebASplit 
 target_attr: blonde split: valid 
 tensor([[8535., 2874.],
        [8276.,  182.]])
decay_epochs: [3, 6]
[1 / 10] Learning rate: 0.001 weight: 0.01
[1 / 10] Loss: 4.698765050678353 CE Loss: 0.3108341351496968 Con Loss: 4.695656701888981
[1 / 10] tensor([[0.746, 0.861],
        [0.977, 0.951]]) {'epoch': 1, 'valid/acc': 88.856, 'valid/acc_unbiased': 89.992, 'valid/diff': 3.511, 'valid/acc_skew': 90.178, 'valid/acc_align': 89.806, 'test/acc': 82.926, 'test/acc_unbiased': 88.369, 'test/diff': 7.107, 'test/acc_skew': 86.139, 'test/acc_align': 90.598}
[1 / 10] best valid accuracy: 89.992 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 88.856, 'best_valid_valid/acc_unbiased': 89.992, 'best_valid_valid/diff': 3.511, 'best_valid_valid/acc_skew': 90.178, 'best_valid_valid/acc_align': 89.806, 'best_valid_test/acc': 82.926, 'best_valid_test/acc_unbiased': 88.369, 'best_valid_test/diff': 7.107, 'best_valid_test/acc_skew': 86.139, 'best_valid_test/acc_align': 90.598}
[1 / 10] best test accuracy: 88.369 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 88.856, 'best_test_valid/acc_unbiased': 89.992, 'best_test_valid/diff': 3.511, 'best_test_valid/acc_skew': 90.178, 'best_test_valid/acc_align': 89.806, 'best_test_test/acc': 82.926, 'best_test_test/acc_unbiased': 88.369, 'best_test_test/diff': 7.107, 'best_test_test/acc_skew': 86.139, 'best_test_test/acc_align': 90.598}
[2 / 10] Learning rate: 0.001 weight: 0.01
[2 / 10] Loss: 4.636316791254813 CE Loss: 0.2628020941319533 Con Loss: 4.63368875479288
[2 / 10] tensor([[0.817, 0.901],
        [0.952, 0.918]]) {'epoch': 2, 'valid/acc': 91.132, 'valid/acc_unbiased': 91.127, 'valid/diff': 2.644, 'valid/acc_skew': 91.399, 'valid/acc_align': 90.854, 'test/acc': 87.245, 'test/acc_unbiased': 89.69, 'test/diff': 5.958, 'test/acc_skew': 88.431, 'test/acc_align': 90.949}
[2 / 10] best valid accuracy: 91.127 at epoch 2 
 best_stats: {'best_valid_epoch': 2, 'best_valid_valid/acc': 91.132, 'best_valid_valid/acc_unbiased': 91.127, 'best_valid_valid/diff': 2.644, 'best_valid_valid/acc_skew': 91.399, 'best_valid_valid/acc_align': 90.854, 'best_valid_test/acc': 87.245, 'best_valid_test/acc_unbiased': 89.69, 'best_valid_test/diff': 5.958, 'best_valid_test/acc_skew': 88.431, 'best_valid_test/acc_align': 90.949}
[2 / 10] best test accuracy: 89.690 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 91.132, 'best_test_valid/acc_unbiased': 91.127, 'best_test_valid/diff': 2.644, 'best_test_valid/acc_skew': 91.399, 'best_test_valid/acc_align': 90.854, 'best_test_test/acc': 87.245, 'best_test_test/acc_unbiased': 89.69, 'best_test_test/diff': 5.958, 'best_test_test/acc_skew': 88.431, 'best_test_test/acc_align': 90.949}
[3 / 10] Learning rate: 0.001 weight: 0.01
[3 / 10] Loss: 4.612576291020806 CE Loss: 0.25177103174584253 Con Loss: 4.610058571923198
[3 / 10] tensor([[0.894, 0.937],
        [0.903, 0.830]]) {'epoch': 3, 'valid/acc': 92.109, 'valid/acc_unbiased': 90.04, 'valid/diff': 3.083, 'valid/acc_skew': 91.581, 'valid/acc_align': 88.499, 'test/acc': 91.282, 'test/acc_unbiased': 89.108, 'test/diff': 5.805, 'test/acc_skew': 89.885, 'test/acc_align': 88.33}
[3 / 10] best valid accuracy: 91.127 at epoch 2 
 best_stats: {'best_valid_epoch': 2, 'best_valid_valid/acc': 91.132, 'best_valid_valid/acc_unbiased': 91.127, 'best_valid_valid/diff': 2.644, 'best_valid_valid/acc_skew': 91.399, 'best_valid_valid/acc_align': 90.854, 'best_valid_test/acc': 87.245, 'best_valid_test/acc_unbiased': 89.69, 'best_valid_test/diff': 5.958, 'best_valid_test/acc_skew': 88.431, 'best_valid_test/acc_align': 90.949}
[3 / 10] best test accuracy: 89.690 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 91.132, 'best_test_valid/acc_unbiased': 91.127, 'best_test_valid/diff': 2.644, 'best_test_valid/acc_skew': 91.399, 'best_test_valid/acc_align': 90.854, 'best_test_test/acc': 87.245, 'best_test_test/acc_unbiased': 89.69, 'best_test_test/diff': 5.958, 'best_test_test/acc_skew': 88.431, 'best_test_test/acc_align': 90.949}
[4 / 10] Learning rate: 0.0001 weight: 0.01
[4 / 10] Loss: 4.568958263568407 CE Loss: 0.21317203301677262 Con Loss: 4.566826538622335
[4 / 10] tensor([[0.852, 0.928],
        [0.959, 0.934]]) {'epoch': 4, 'valid/acc': 93.075, 'valid/acc_unbiased': 93.377, 'valid/diff': 1.401, 'valid/acc_skew': 94.077, 'valid/acc_align': 92.677, 'test/acc': 90.014, 'test/acc_unbiased': 91.846, 'test/diff': 5.084, 'test/acc_skew': 90.566, 'test/acc_align': 93.127}
[4 / 10] best valid accuracy: 93.377 at epoch 4 
 best_stats: {'best_valid_epoch': 4, 'best_valid_valid/acc': 93.075, 'best_valid_valid/acc_unbiased': 93.377, 'best_valid_valid/diff': 1.401, 'best_valid_valid/acc_skew': 94.077, 'best_valid_valid/acc_align': 92.677, 'best_valid_test/acc': 90.014, 'best_valid_test/acc_unbiased': 91.846, 'best_valid_test/diff': 5.084, 'best_valid_test/acc_skew': 90.566, 'best_valid_test/acc_align': 93.127}
[4 / 10] best test accuracy: 91.846 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 93.075, 'best_test_valid/acc_unbiased': 93.377, 'best_test_valid/diff': 1.401, 'best_test_valid/acc_skew': 94.077, 'best_test_valid/acc_align': 92.677, 'best_test_test/acc': 90.014, 'best_test_test/acc_unbiased': 91.846, 'best_test_test/diff': 5.084, 'best_test_test/acc_skew': 90.566, 'best_test_test/acc_align': 93.127}
[5 / 10] Learning rate: 0.0001 weight: 0.01
[5 / 10] Loss: 4.538039395768159 CE Loss: 0.20043955329825117 Con Loss: 4.536034991336386
[5 / 10] tensor([[0.887, 0.945],
        [0.939, 0.879]]) {'epoch': 5, 'valid/acc': 93.687, 'valid/acc_unbiased': 93.472, 'valid/diff': 2.513, 'valid/acc_skew': 94.728, 'valid/acc_align': 92.215, 'test/acc': 91.841, 'test/acc_unbiased': 91.248, 'test/diff': 5.903, 'test/acc_skew': 91.314, 'test/acc_align': 91.183}
[5 / 10] best valid accuracy: 93.472 at epoch 5 
 best_stats: {'best_valid_epoch': 5, 'best_valid_valid/acc': 93.687, 'best_valid_valid/acc_unbiased': 93.472, 'best_valid_valid/diff': 2.513, 'best_valid_valid/acc_skew': 94.728, 'best_valid_valid/acc_align': 92.215, 'best_valid_test/acc': 91.841, 'best_valid_test/acc_unbiased': 91.248, 'best_valid_test/diff': 5.903, 'best_valid_test/acc_skew': 91.314, 'best_valid_test/acc_align': 91.183}
[5 / 10] best test accuracy: 91.846 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 93.075, 'best_test_valid/acc_unbiased': 93.377, 'best_test_valid/diff': 1.401, 'best_test_valid/acc_skew': 94.077, 'best_test_valid/acc_align': 92.677, 'best_test_test/acc': 90.014, 'best_test_test/acc_unbiased': 91.846, 'best_test_test/diff': 5.084, 'best_test_test/acc_skew': 90.566, 'best_test_test/acc_align': 93.127}
[6 / 10] Learning rate: 0.0001 weight: 0.01
[6 / 10] Loss: 4.519983202107557 CE Loss: 0.19097318129980395 Con Loss: 4.518073485338073
[6 / 10] tensor([[0.870, 0.941],
        [0.947, 0.912]]) {'epoch': 6, 'valid/acc': 94.031, 'valid/acc_unbiased': 92.666, 'valid/diff': 3.595, 'valid/acc_skew': 94.326, 'valid/acc_align': 91.006, 'test/acc': 91.126, 'test/acc_unbiased': 91.769, 'test/diff': 5.347, 'test/acc_skew': 90.865, 'test/acc_align': 92.674}
[6 / 10] best valid accuracy: 93.472 at epoch 5 
 best_stats: {'best_valid_epoch': 5, 'best_valid_valid/acc': 93.687, 'best_valid_valid/acc_unbiased': 93.472, 'best_valid_valid/diff': 2.513, 'best_valid_valid/acc_skew': 94.728, 'best_valid_valid/acc_align': 92.215, 'best_valid_test/acc': 91.841, 'best_valid_test/acc_unbiased': 91.248, 'best_valid_test/diff': 5.903, 'best_valid_test/acc_skew': 91.314, 'best_valid_test/acc_align': 91.183}
[6 / 10] best test accuracy: 91.846 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 93.075, 'best_test_valid/acc_unbiased': 93.377, 'best_test_valid/diff': 1.401, 'best_test_valid/acc_skew': 94.077, 'best_test_valid/acc_align': 92.677, 'best_test_test/acc': 90.014, 'best_test_test/acc_unbiased': 91.846, 'best_test_test/diff': 5.084, 'best_test_test/acc_skew': 90.566, 'best_test_test/acc_align': 93.127}
[7 / 10] Learning rate: 1e-05 weight: 0.01
[7 / 10] Loss: 4.504684488543308 CE Loss: 0.18708450415728248 Con Loss: 4.5028136359637765
[7 / 10] tensor([[0.875, 0.939],
        [0.945, 0.907]]) {'epoch': 7, 'valid/acc': 93.66, 'valid/acc_unbiased': 93.195, 'valid/diff': 3.514, 'valid/acc_skew': 94.952, 'valid/acc_align': 91.438, 'test/acc': 91.207, 'test/acc_unbiased': 91.64, 'test/diff': 5.169, 'test/acc_skew': 90.977, 'test/acc_align': 92.303}
[7 / 10] best valid accuracy: 93.472 at epoch 5 
 best_stats: {'best_valid_epoch': 5, 'best_valid_valid/acc': 93.687, 'best_valid_valid/acc_unbiased': 93.472, 'best_valid_valid/diff': 2.513, 'best_valid_valid/acc_skew': 94.728, 'best_valid_valid/acc_align': 92.215, 'best_valid_test/acc': 91.841, 'best_valid_test/acc_unbiased': 91.248, 'best_valid_test/diff': 5.903, 'best_valid_test/acc_skew': 91.314, 'best_valid_test/acc_align': 91.183}
[7 / 10] best test accuracy: 91.846 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 93.075, 'best_test_valid/acc_unbiased': 93.377, 'best_test_valid/diff': 1.401, 'best_test_valid/acc_skew': 94.077, 'best_test_valid/acc_align': 92.677, 'best_test_test/acc': 90.014, 'best_test_test/acc_unbiased': 91.846, 'best_test_test/diff': 5.084, 'best_test_test/acc_skew': 90.566, 'best_test_test/acc_align': 93.127}
[8 / 10] Learning rate: 1e-05 weight: 0.01
[8 / 10] Loss: 4.521624074378117 CE Loss: 0.1836128632078977 Con Loss: 4.519787951022186
[8 / 10] tensor([[0.869, 0.936],
        [0.951, 0.912]]) {'epoch': 8, 'valid/acc': 93.542, 'valid/acc_unbiased': 93.584, 'valid/diff': 2.12, 'valid/acc_skew': 94.644, 'valid/acc_align': 92.524, 'test/acc': 90.925, 'test/acc_unbiased': 91.712, 'test/diff': 5.313, 'test/acc_skew': 91.015, 'test/acc_align': 92.408}
[8 / 10] best valid accuracy: 93.584 at epoch 8 
 best_stats: {'best_valid_epoch': 8, 'best_valid_valid/acc': 93.542, 'best_valid_valid/acc_unbiased': 93.584, 'best_valid_valid/diff': 2.12, 'best_valid_valid/acc_skew': 94.644, 'best_valid_valid/acc_align': 92.524, 'best_valid_test/acc': 90.925, 'best_valid_test/acc_unbiased': 91.712, 'best_valid_test/diff': 5.313, 'best_valid_test/acc_skew': 91.015, 'best_valid_test/acc_align': 92.408}
[8 / 10] best test accuracy: 91.846 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 93.075, 'best_test_valid/acc_unbiased': 93.377, 'best_test_valid/diff': 1.401, 'best_test_valid/acc_skew': 94.077, 'best_test_valid/acc_align': 92.677, 'best_test_test/acc': 90.014, 'best_test_test/acc_unbiased': 91.846, 'best_test_test/diff': 5.084, 'best_test_test/acc_skew': 90.566, 'best_test_test/acc_align': 93.127}
[9 / 10] Learning rate: 1e-05 weight: 0.01
[9 / 10] Loss: 4.498866351932934 CE Loss: 0.18021979917985964 Con Loss: 4.497064138225593
[9 / 10] tensor([[0.871, 0.940],
        [0.952, 0.918]]) {'epoch': 9, 'valid/acc': 93.677, 'valid/acc_unbiased': 94.164, 'valid/diff': 2.403, 'valid/acc_skew': 95.366, 'valid/acc_align': 92.963, 'test/acc': 91.196, 'test/acc_unbiased': 92.019, 'test/diff': 5.167, 'test/acc_skew': 91.155, 'test/acc_align': 92.883}
[9 / 10] best valid accuracy: 94.164 at epoch 9 
 best_stats: {'best_valid_epoch': 9, 'best_valid_valid/acc': 93.677, 'best_valid_valid/acc_unbiased': 94.164, 'best_valid_valid/diff': 2.403, 'best_valid_valid/acc_skew': 95.366, 'best_valid_valid/acc_align': 92.963, 'best_valid_test/acc': 91.196, 'best_valid_test/acc_unbiased': 92.019, 'best_valid_test/diff': 5.167, 'best_valid_test/acc_skew': 91.155, 'best_valid_test/acc_align': 92.883}
[9 / 10] best test accuracy: 92.019 at epoch 9 
 best_stats: {'best_test_epoch': 9, 'best_test_valid/acc': 93.677, 'best_test_valid/acc_unbiased': 94.164, 'best_test_valid/diff': 2.403, 'best_test_valid/acc_skew': 95.366, 'best_test_valid/acc_align': 92.963, 'best_test_test/acc': 91.196, 'best_test_test/acc_unbiased': 92.019, 'best_test_test/diff': 5.167, 'best_test_test/acc_skew': 91.155, 'best_test_test/acc_align': 92.883}
[10 / 10] Learning rate: 1e-05 weight: 0.01
[10 / 10] Loss: 4.504133424922969 CE Loss: 0.17996475033645945 Con Loss: 4.502333785494317
[10 / 10] tensor([[0.856, 0.930],
        [0.960, 0.940]]) {'epoch': 10, 'valid/acc': 93.269, 'valid/acc_unbiased': 93.751, 'valid/diff': 2.022, 'valid/acc_skew': 94.761, 'valid/acc_align': 92.74, 'test/acc': 90.265, 'test/acc_unbiased': 92.145, 'test/diff': 4.711, 'test/acc_skew': 90.829, 'test/acc_align': 93.462}
[10 / 10] best valid accuracy: 94.164 at epoch 9 
 best_stats: {'best_valid_epoch': 9, 'best_valid_valid/acc': 93.677, 'best_valid_valid/acc_unbiased': 94.164, 'best_valid_valid/diff': 2.403, 'best_valid_valid/acc_skew': 95.366, 'best_valid_valid/acc_align': 92.963, 'best_valid_test/acc': 91.196, 'best_valid_test/acc_unbiased': 92.019, 'best_valid_test/diff': 5.167, 'best_valid_test/acc_skew': 91.155, 'best_valid_test/acc_align': 92.883}
[10 / 10] best test accuracy: 92.145 at epoch 10 
 best_stats: {'best_test_epoch': 10, 'best_test_valid/acc': 93.269, 'best_test_valid/acc_unbiased': 93.751, 'best_test_valid/diff': 2.022, 'best_test_valid/acc_skew': 94.761, 'best_test_valid/acc_align': 92.74, 'best_test_test/acc': 90.265, 'best_test_test/acc_unbiased': 92.145, 'best_test_test/diff': 4.711, 'best_test_test/acc_skew': 90.829, 'best_test_test/acc_align': 93.462}
Total training time: 0:24:29
