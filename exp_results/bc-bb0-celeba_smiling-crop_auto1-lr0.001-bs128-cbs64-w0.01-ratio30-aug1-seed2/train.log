Log level set to: INFO
Set seed: 2
=======> Using Fixed Random Seed: 2 <========
save_path: exp_results/bc-bb0-celeba_smiling-crop_auto1-lr0.001-bs128-cbs64-w0.01-ratio30-aug1-seed2
get_celeba - split:train, aug: False, given_y: True, ratio: 0
use existing smiling indices from data/celeba/pickles/smiling
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [8019, 32821]
Target 1: [40611, 8007]
Binary Target 1
---------------------------
Target 0: [8019, 32821]
Target 1: [40611, 8007]
===================================
Normal Label Distribution: 
Target 0: [8019, 32821]
Target 1: [40611, 8007]
===================================
Use BiasedCelebASplit 
 target_attr: smiling split: train 
 tensor([[ 8019., 40611.],
        [32821.,  8007.]])
get_celeba - split:train, aug: 1, given_y: True, ratio: 30
use existing smiling indices from data/celeba/pickles/smiling
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [7986, 32687]
Target 1: [40769, 8016]
Binary Target 1
---------------------------
Target 0: [7986, 32687]
Target 1: [40769, 8016]
===================================
Normal Label Distribution: 
Target 0: [7986, 32687]
Target 1: [40769, 8016]
===================================
Use BiasedCelebASplit 
 target_attr: smiling split: train 
 tensor([[ 7986., 40769.],
        [32687.,  8016.]])
get_celeba - split:train_valid, aug: False, given_y: True, ratio: 0
use existing smiling indices from data/celeba/pickles/smiling
Use BiasedCelebASplit 
 target_attr: smiling split: train_valid 
 tensor([[ 1973., 10114.],
        [ 8289.,  1989.]])
get_celeba - split:valid, aug: False, given_y: True, ratio: 0
Use BiasedCelebASplit 
 target_attr: smiling split: valid 
 tensor([[5252., 6157.],
        [5013., 3445.]])
decay_epochs: [3, 6]
[1 / 10] Learning rate: 0.001 weight: 0.01
[1 / 10] Loss: 4.696606333905157 CE Loss: 0.25688258359342087 Con Loss: 4.694037503662498
[1 / 10] tensor([[0.813, 0.869],
        [0.964, 0.927]]) {'epoch': 1, 'valid/acc': 91.169, 'valid/acc_unbiased': 89.604, 'valid/diff': 3.479, 'valid/acc_skew': 87.865, 'valid/acc_align': 91.343, 'test/acc': 89.364, 'test/acc_unbiased': 89.317, 'test/diff': 4.666, 'test/acc_skew': 86.984, 'test/acc_align': 91.65}
[1 / 10] best valid accuracy: 89.604 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 91.169, 'best_valid_valid/acc_unbiased': 89.604, 'best_valid_valid/diff': 3.479, 'best_valid_valid/acc_skew': 87.865, 'best_valid_valid/acc_align': 91.343, 'best_valid_test/acc': 89.364, 'best_valid_test/acc_unbiased': 89.317, 'best_valid_test/diff': 4.666, 'best_valid_test/acc_skew': 86.984, 'best_valid_test/acc_align': 91.65}
[1 / 10] best test accuracy: 89.317 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 91.169, 'best_test_valid/acc_unbiased': 89.604, 'best_test_valid/diff': 3.479, 'best_test_valid/acc_skew': 87.865, 'best_test_valid/acc_align': 91.343, 'best_test_test/acc': 89.364, 'best_test_test/acc_unbiased': 89.317, 'best_test_test/diff': 4.666, 'best_test_test/acc_skew': 86.984, 'best_test_test/acc_align': 91.65}
[2 / 10] Learning rate: 0.001 weight: 0.01
[2 / 10] Loss: 4.651410282261828 CE Loss: 0.21896098415513493 Con Loss: 4.649220672235069
[2 / 10] tensor([[0.938, 0.933],
        [0.913, 0.888]]) {'epoch': 2, 'valid/acc': 91.8, 'valid/acc_unbiased': 91.622, 'valid/diff': 1.478, 'valid/acc_skew': 91.251, 'valid/acc_align': 91.992, 'test/acc': 92.017, 'test/acc_unbiased': 91.783, 'test/diff': 1.522, 'test/acc_skew': 91.28, 'test/acc_align': 92.286}
[2 / 10] best valid accuracy: 91.622 at epoch 2 
 best_stats: {'best_valid_epoch': 2, 'best_valid_valid/acc': 91.8, 'best_valid_valid/acc_unbiased': 91.622, 'best_valid_valid/diff': 1.478, 'best_valid_valid/acc_skew': 91.251, 'best_valid_valid/acc_align': 91.992, 'best_valid_test/acc': 92.017, 'best_valid_test/acc_unbiased': 91.783, 'best_valid_test/diff': 1.522, 'best_valid_test/acc_skew': 91.28, 'best_valid_test/acc_align': 92.286}
[2 / 10] best test accuracy: 91.783 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 91.8, 'best_test_valid/acc_unbiased': 91.622, 'best_test_valid/diff': 1.478, 'best_test_valid/acc_skew': 91.251, 'best_test_valid/acc_align': 91.992, 'best_test_test/acc': 92.017, 'best_test_test/acc_unbiased': 91.783, 'best_test_test/diff': 1.522, 'best_test_test/acc_skew': 91.28, 'best_test_test/acc_align': 92.286}
[3 / 10] Learning rate: 0.001 weight: 0.01
[3 / 10] Loss: 4.641737966209769 CE Loss: 0.21045247672270656 Con Loss: 4.639633440929265
[3 / 10] tensor([[0.962, 0.963],
        [0.882, 0.824]]) {'epoch': 3, 'valid/acc': 91.205, 'valid/acc_unbiased': 90.618, 'valid/diff': 3.124, 'valid/acc_skew': 89.176, 'valid/acc_align': 92.06, 'test/acc': 91.358, 'test/acc_unbiased': 90.776, 'test/diff': 2.99, 'test/acc_skew': 89.281, 'test/acc_align': 92.271}
[3 / 10] best valid accuracy: 91.622 at epoch 2 
 best_stats: {'best_valid_epoch': 2, 'best_valid_valid/acc': 91.8, 'best_valid_valid/acc_unbiased': 91.622, 'best_valid_valid/diff': 1.478, 'best_valid_valid/acc_skew': 91.251, 'best_valid_valid/acc_align': 91.992, 'best_valid_test/acc': 92.017, 'best_valid_test/acc_unbiased': 91.783, 'best_valid_test/diff': 1.522, 'best_valid_test/acc_skew': 91.28, 'best_valid_test/acc_align': 92.286}
[3 / 10] best test accuracy: 91.783 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 91.8, 'best_test_valid/acc_unbiased': 91.622, 'best_test_valid/diff': 1.478, 'best_test_valid/acc_skew': 91.251, 'best_test_valid/acc_align': 91.992, 'best_test_test/acc': 92.017, 'best_test_test/acc_unbiased': 91.783, 'best_test_test/diff': 1.522, 'best_test_test/acc_skew': 91.28, 'best_test_test/acc_align': 92.286}
[4 / 10] Learning rate: 0.0001 weight: 0.01
[4 / 10] Loss: 4.600128779914176 CE Loss: 0.18699782641364304 Con Loss: 4.59825879900814
[4 / 10] tensor([[0.931, 0.932],
        [0.930, 0.907]]) {'epoch': 4, 'valid/acc': 92.609, 'valid/acc_unbiased': 92.175, 'valid/diff': 1.396, 'valid/acc_skew': 91.5, 'valid/acc_align': 92.85, 'test/acc': 92.666, 'test/acc_unbiased': 92.484, 'test/diff': 1.226, 'test/acc_skew': 91.871, 'test/acc_align': 93.097}
[4 / 10] best valid accuracy: 92.175 at epoch 4 
 best_stats: {'best_valid_epoch': 4, 'best_valid_valid/acc': 92.609, 'best_valid_valid/acc_unbiased': 92.175, 'best_valid_valid/diff': 1.396, 'best_valid_valid/acc_skew': 91.5, 'best_valid_valid/acc_align': 92.85, 'best_valid_test/acc': 92.666, 'best_valid_test/acc_unbiased': 92.484, 'best_valid_test/diff': 1.226, 'best_valid_test/acc_skew': 91.871, 'best_valid_test/acc_align': 93.097}
[4 / 10] best test accuracy: 92.484 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 92.609, 'best_test_valid/acc_unbiased': 92.175, 'best_test_valid/diff': 1.396, 'best_test_valid/acc_skew': 91.5, 'best_test_valid/acc_align': 92.85, 'best_test_test/acc': 92.666, 'best_test_test/acc_unbiased': 92.484, 'best_test_test/diff': 1.226, 'best_test_test/acc_skew': 91.871, 'best_test_test/acc_align': 93.097}
[5 / 10] Learning rate: 0.0001 weight: 0.01
[5 / 10] Loss: 4.588077737525552 CE Loss: 0.18061295519767093 Con Loss: 4.586271613546454
[5 / 10] tensor([[0.916, 0.932],
        [0.942, 0.907]]) {'epoch': 5, 'valid/acc': 93.168, 'valid/acc_unbiased': 92.378, 'valid/diff': 2.269, 'valid/acc_skew': 91.243, 'valid/acc_align': 93.513, 'test/acc': 92.666, 'test/acc_unbiased': 92.441, 'test/diff': 2.557, 'test/acc_skew': 91.162, 'test/acc_align': 93.72}
[5 / 10] best valid accuracy: 92.378 at epoch 5 
 best_stats: {'best_valid_epoch': 5, 'best_valid_valid/acc': 93.168, 'best_valid_valid/acc_unbiased': 92.378, 'best_valid_valid/diff': 2.269, 'best_valid_valid/acc_skew': 91.243, 'best_valid_valid/acc_align': 93.513, 'best_valid_test/acc': 92.666, 'best_valid_test/acc_unbiased': 92.441, 'best_valid_test/diff': 2.557, 'best_valid_test/acc_skew': 91.162, 'best_valid_test/acc_align': 93.72}
[5 / 10] best test accuracy: 92.484 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 92.609, 'best_test_valid/acc_unbiased': 92.175, 'best_test_valid/diff': 1.396, 'best_test_valid/acc_skew': 91.5, 'best_test_valid/acc_align': 92.85, 'best_test_test/acc': 92.666, 'best_test_test/acc_unbiased': 92.484, 'best_test_test/diff': 1.226, 'best_test_test/acc_skew': 91.871, 'best_test_test/acc_align': 93.097}
[6 / 10] Learning rate: 0.0001 weight: 0.01
[6 / 10] Loss: 4.586345834115234 CE Loss: 0.1774244538716924 Con Loss: 4.584571583420435
[6 / 10] tensor([[0.912, 0.923],
        [0.945, 0.918]]) {'epoch': 6, 'valid/acc': 93.195, 'valid/acc_unbiased': 92.586, 'valid/diff': 1.629, 'valid/acc_skew': 91.771, 'valid/acc_align': 93.401, 'test/acc': 92.596, 'test/acc_unbiased': 92.439, 'test/diff': 1.956, 'test/acc_skew': 91.461, 'test/acc_align': 93.417}
[6 / 10] best valid accuracy: 92.586 at epoch 6 
 best_stats: {'best_valid_epoch': 6, 'best_valid_valid/acc': 93.195, 'best_valid_valid/acc_unbiased': 92.586, 'best_valid_valid/diff': 1.629, 'best_valid_valid/acc_skew': 91.771, 'best_valid_valid/acc_align': 93.401, 'best_valid_test/acc': 92.596, 'best_valid_test/acc_unbiased': 92.439, 'best_valid_test/diff': 1.956, 'best_valid_test/acc_skew': 91.461, 'best_valid_test/acc_align': 93.417}
[6 / 10] best test accuracy: 92.484 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 92.609, 'best_test_valid/acc_unbiased': 92.175, 'best_test_valid/diff': 1.396, 'best_test_valid/acc_skew': 91.5, 'best_test_valid/acc_align': 92.85, 'best_test_test/acc': 92.666, 'best_test_test/acc_unbiased': 92.484, 'best_test_test/diff': 1.226, 'best_test_test/acc_skew': 91.871, 'best_test_test/acc_align': 93.097}
[7 / 10] Learning rate: 1e-05 weight: 0.01
[7 / 10] Loss: 4.576335956703375 CE Loss: 0.17443204034824358 Con Loss: 4.574591633523504
[7 / 10] tensor([[0.922, 0.930],
        [0.940, 0.908]]) {'epoch': 7, 'valid/acc': 93.244, 'valid/acc_unbiased': 92.707, 'valid/diff': 1.564, 'valid/acc_skew': 91.925, 'valid/acc_align': 93.49, 'test/acc': 92.712, 'test/acc_unbiased': 92.492, 'test/diff': 2.041, 'test/acc_skew': 91.472, 'test/acc_align': 93.512}
[7 / 10] best valid accuracy: 92.707 at epoch 7 
 best_stats: {'best_valid_epoch': 7, 'best_valid_valid/acc': 93.244, 'best_valid_valid/acc_unbiased': 92.707, 'best_valid_valid/diff': 1.564, 'best_valid_valid/acc_skew': 91.925, 'best_valid_valid/acc_align': 93.49, 'best_valid_test/acc': 92.712, 'best_valid_test/acc_unbiased': 92.492, 'best_valid_test/diff': 2.041, 'best_valid_test/acc_skew': 91.472, 'best_valid_test/acc_align': 93.512}
[7 / 10] best test accuracy: 92.492 at epoch 7 
 best_stats: {'best_test_epoch': 7, 'best_test_valid/acc': 93.244, 'best_test_valid/acc_unbiased': 92.707, 'best_test_valid/diff': 1.564, 'best_test_valid/acc_skew': 91.925, 'best_test_valid/acc_align': 93.49, 'best_test_test/acc': 92.712, 'best_test_test/acc_unbiased': 92.492, 'best_test_test/diff': 2.041, 'best_test_test/acc_skew': 91.472, 'best_test_test/acc_align': 93.512}
[8 / 10] Learning rate: 1e-05 weight: 0.01
[8 / 10] Loss: 4.574772235919656 CE Loss: 0.17289155098953202 Con Loss: 4.573043316779273
[8 / 10] tensor([[0.929, 0.936],
        [0.937, 0.902]]) {'epoch': 8, 'valid/acc': 93.275, 'valid/acc_unbiased': 92.613, 'valid/diff': 2.076, 'valid/acc_skew': 91.575, 'valid/acc_align': 93.651, 'test/acc': 92.837, 'test/acc_unbiased': 92.58, 'test/diff': 2.14, 'test/acc_skew': 91.51, 'test/acc_align': 93.649}
[8 / 10] best valid accuracy: 92.707 at epoch 7 
 best_stats: {'best_valid_epoch': 7, 'best_valid_valid/acc': 93.244, 'best_valid_valid/acc_unbiased': 92.707, 'best_valid_valid/diff': 1.564, 'best_valid_valid/acc_skew': 91.925, 'best_valid_valid/acc_align': 93.49, 'best_valid_test/acc': 92.712, 'best_valid_test/acc_unbiased': 92.492, 'best_valid_test/diff': 2.041, 'best_valid_test/acc_skew': 91.472, 'best_valid_test/acc_align': 93.512}
[8 / 10] best test accuracy: 92.580 at epoch 8 
 best_stats: {'best_test_epoch': 8, 'best_test_valid/acc': 93.275, 'best_test_valid/acc_unbiased': 92.613, 'best_test_valid/diff': 2.076, 'best_test_valid/acc_skew': 91.575, 'best_test_valid/acc_align': 93.651, 'best_test_test/acc': 92.837, 'best_test_test/acc_unbiased': 92.58, 'best_test_test/diff': 2.14, 'best_test_test/acc_skew': 91.51, 'best_test_test/acc_align': 93.649}
[9 / 10] Learning rate: 1e-05 weight: 0.01
[9 / 10] Loss: 4.573043218819188 CE Loss: 0.17151838510048567 Con Loss: 4.571328043567228
[9 / 10] tensor([[0.930, 0.938],
        [0.935, 0.898]]) {'epoch': 9, 'valid/acc': 93.311, 'valid/acc_unbiased': 92.745, 'valid/diff': 1.786, 'valid/acc_skew': 91.852, 'valid/acc_align': 93.638, 'test/acc': 92.827, 'test/acc_unbiased': 92.552, 'test/diff': 2.232, 'test/acc_skew': 91.436, 'test/acc_align': 93.668}
[9 / 10] best valid accuracy: 92.745 at epoch 9 
 best_stats: {'best_valid_epoch': 9, 'best_valid_valid/acc': 93.311, 'best_valid_valid/acc_unbiased': 92.745, 'best_valid_valid/diff': 1.786, 'best_valid_valid/acc_skew': 91.852, 'best_valid_valid/acc_align': 93.638, 'best_valid_test/acc': 92.827, 'best_valid_test/acc_unbiased': 92.552, 'best_valid_test/diff': 2.232, 'best_valid_test/acc_skew': 91.436, 'best_valid_test/acc_align': 93.668}
[9 / 10] best test accuracy: 92.580 at epoch 8 
 best_stats: {'best_test_epoch': 8, 'best_test_valid/acc': 93.275, 'best_test_valid/acc_unbiased': 92.613, 'best_test_valid/diff': 2.076, 'best_test_valid/acc_skew': 91.575, 'best_test_valid/acc_align': 93.651, 'best_test_test/acc': 92.837, 'best_test_test/acc_unbiased': 92.58, 'best_test_test/diff': 2.14, 'best_test_test/acc_skew': 91.51, 'best_test_test/acc_align': 93.649}
[10 / 10] Learning rate: 1e-05 weight: 0.01
[10 / 10] Loss: 4.570869708530817 CE Loss: 0.17054289411920404 Con Loss: 4.569164287103446
[10 / 10] tensor([[0.924, 0.932],
        [0.942, 0.908]]) {'epoch': 10, 'valid/acc': 93.387, 'valid/acc_unbiased': 92.879, 'valid/diff': 1.502, 'valid/acc_skew': 92.128, 'valid/acc_align': 93.63, 'test/acc': 92.863, 'test/acc_unbiased': 92.631, 'test/diff': 2.089, 'test/acc_skew': 91.586, 'test/acc_align': 93.675}
[10 / 10] best valid accuracy: 92.879 at epoch 10 
 best_stats: {'best_valid_epoch': 10, 'best_valid_valid/acc': 93.387, 'best_valid_valid/acc_unbiased': 92.879, 'best_valid_valid/diff': 1.502, 'best_valid_valid/acc_skew': 92.128, 'best_valid_valid/acc_align': 93.63, 'best_valid_test/acc': 92.863, 'best_valid_test/acc_unbiased': 92.631, 'best_valid_test/diff': 2.089, 'best_valid_test/acc_skew': 91.586, 'best_valid_test/acc_align': 93.675}
[10 / 10] best test accuracy: 92.631 at epoch 10 
 best_stats: {'best_test_epoch': 10, 'best_test_valid/acc': 93.387, 'best_test_valid/acc_unbiased': 92.879, 'best_test_valid/diff': 1.502, 'best_test_valid/acc_skew': 92.128, 'best_test_valid/acc_align': 93.63, 'best_test_test/acc': 92.863, 'best_test_test/acc_unbiased': 92.631, 'best_test_test/diff': 2.089, 'best_test_test/acc_skew': 91.586, 'best_test_test/acc_align': 93.675}
Total training time: 1:49:00
