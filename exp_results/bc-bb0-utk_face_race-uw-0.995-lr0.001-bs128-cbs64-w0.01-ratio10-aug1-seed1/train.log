Log level set to: INFO
Set seed: 1
=======> Using Fixed Random Seed: 1 <========
save_path: exp_results/bc-bb0-utk_face_race-uw-0.995-lr0.001-bs128-cbs64-w0.01-ratio10-aug1-seed1
get_utk_face - split: train, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_race-0.995
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [4407, 27]
Target 1: [22, 5529]
Binary Target 1
---------------------------
Target 0: [4407, 27]
Target 1: [22, 5529]
===================================
Normal Label Distribution: 
Target 0: [4407, 27]
Target 1: [22, 5529]
===================================
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [4407, 27]
Target 1: [22, 5529]
Binary Target 1
---------------------------
Target 0: [4407, 27]
Target 1: [22, 5529]
===================================
Normal Label Distribution: 
Target 0: [4407, 27]
Target 1: [22, 5529]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 9985, target_attr: gender, bias_attr: race bias_rate: 0.995
['[train] target_0-bias_0: 4407', '[train] target_0-bias_1: 27', '[train] target_1-bias_0: 22', '[train] target_1-bias_1: 5529']
confusion_matrix - 
 original: tensor([[4407.,   22.],
        [  27., 5529.]]), 
 normalized: tensor([[0.995, 0.005],
        [0.005, 0.995]]), 
 b|y: tensor([[0.994, 0.006],
        [0.004, 0.996]])
get_utk_face - split: train, aug: 1, given_y: True, ratio: 10
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_race-0.995
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [4407, 27]
Target 1: [22, 5529]
Binary Target 1
---------------------------
Target 0: [4407, 27]
Target 1: [22, 5529]
===================================
Normal Label Distribution: 
Target 0: [4407, 27]
Target 1: [22, 5529]
===================================
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [4407, 27]
Target 1: [22, 5529]
Binary Target 1
---------------------------
Target 0: [4407, 27]
Target 1: [22, 5529]
===================================
Normal Label Distribution: 
Target 0: [4407, 27]
Target 1: [22, 5529]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 9985, target_attr: gender, bias_attr: race bias_rate: 0.995
['[train] target_0-bias_0: 4407', '[train] target_0-bias_1: 27', '[train] target_1-bias_0: 22', '[train] target_1-bias_1: 5529']
get_utk_face - split: valid, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_race-0.995
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [583, 684]
Target 1: [457, 646]
Binary Target 1
---------------------------
Target 0: [583, 684]
Target 1: [457, 646]
===================================
Normal Label Distribution: 
Target 0: [583, 684]
Target 1: [457, 646]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 2370, target_attr: gender, bias_attr: race bias_rate: 0.995
['[valid] target_0-bias_0: 583', '[valid] target_0-bias_1: 684', '[valid] target_1-bias_0: 457', '[valid] target_1-bias_1: 646']
get_utk_face - split: test, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_race-0.995
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [558, 677]
Target 1: [462, 673]
Binary Target 1
---------------------------
Target 0: [558, 677]
Target 1: [462, 673]
===================================
Normal Label Distribution: 
Target 0: [558, 677]
Target 1: [462, 673]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 2370, target_attr: gender, bias_attr: race bias_rate: 0.995
['[test] target_0-bias_0: 558', '[test] target_0-bias_1: 677', '[test] target_1-bias_0: 462', '[test] target_1-bias_1: 673']
decay_epochs: [6, 13]
[1 / 20] Learning rate: 0.001 weight: 0.01
[1 / 20] Loss: 4.118189764774974 CE Loss: 3.1572583926100104 Con Loss: 4.0866171803424285
[1 / 20] tensor([[0.987, 0.970],
        [0.069, 0.111]]) {'epoch': 1, 'valid/acc': 56.371, 'valid/acc_unbiased': 53.079, 'valid/diff': 3.101, 'valid/acc_skew': 51.529, 'valid/acc_align': 54.629, 'test/acc': 55.485, 'test/acc_unbiased': 53.465, 'test/diff': 2.959, 'test/acc_skew': 51.986, 'test/acc_align': 54.945}
[1 / 20] best valid accuracy: 53.079 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 56.371, 'best_valid_valid/acc_unbiased': 53.079, 'best_valid_valid/diff': 3.101, 'best_valid_valid/acc_skew': 51.529, 'best_valid_valid/acc_align': 54.629, 'best_valid_test/acc': 55.485, 'best_valid_test/acc_unbiased': 53.465, 'best_valid_test/diff': 2.959, 'best_valid_test/acc_skew': 51.986, 'best_valid_test/acc_align': 54.945}
[1 / 20] best test accuracy: 53.465 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 56.371, 'best_test_valid/acc_unbiased': 53.079, 'best_test_valid/diff': 3.101, 'best_test_valid/acc_skew': 51.529, 'best_test_valid/acc_align': 54.629, 'best_test_test/acc': 55.485, 'best_test_test/acc_unbiased': 53.465, 'best_test_test/diff': 2.959, 'best_test_test/acc_skew': 51.986, 'best_test_test/acc_align': 54.945}
[2 / 20] Learning rate: 0.001 weight: 0.01
[2 / 20] Loss: 3.666052903290922 CE Loss: 2.8094380614395793 Con Loss: 3.637958509467158
[2 / 20] tensor([[0.919, 0.889],
        [0.260, 0.412]]) {'epoch': 2, 'valid/acc': 64.135, 'valid/acc_unbiased': 61.766, 'valid/diff': 7.365, 'valid/acc_skew': 58.084, 'valid/acc_align': 65.449, 'test/acc': 63.797, 'test/acc_unbiased': 61.998, 'test/diff': 9.099, 'test/acc_skew': 57.448, 'test/acc_align': 66.547}
[2 / 20] best valid accuracy: 61.766 at epoch 2 
 best_stats: {'best_valid_epoch': 2, 'best_valid_valid/acc': 64.135, 'best_valid_valid/acc_unbiased': 61.766, 'best_valid_valid/diff': 7.365, 'best_valid_valid/acc_skew': 58.084, 'best_valid_valid/acc_align': 65.449, 'best_valid_test/acc': 63.797, 'best_valid_test/acc_unbiased': 61.998, 'best_valid_test/diff': 9.099, 'best_valid_test/acc_skew': 57.448, 'best_valid_test/acc_align': 66.547}
[2 / 20] best test accuracy: 61.998 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 64.135, 'best_test_valid/acc_unbiased': 61.766, 'best_test_valid/diff': 7.365, 'best_test_valid/acc_skew': 58.084, 'best_test_valid/acc_align': 65.449, 'best_test_test/acc': 63.797, 'best_test_test/acc_unbiased': 61.998, 'best_test_test/diff': 9.099, 'best_test_test/acc_skew': 57.448, 'best_test_test/acc_align': 66.547}
[3 / 20] Learning rate: 0.001 weight: 0.01
[3 / 20] Loss: 3.750178129003235 CE Loss: 2.915265026979585 Con Loss: 3.721025491847237
[3 / 20] tensor([[0.848, 0.799],
        [0.342, 0.425]]) {'epoch': 3, 'valid/acc': 62.743, 'valid/acc_unbiased': 61.151, 'valid/diff': 4.11, 'valid/acc_skew': 59.096, 'valid/acc_align': 63.206, 'test/acc': 61.519, 'test/acc_unbiased': 60.343, 'test/diff': 6.576, 'test/acc_skew': 57.055, 'test/acc_align': 63.632}
[3 / 20] best valid accuracy: 61.766 at epoch 2 
 best_stats: {'best_valid_epoch': 2, 'best_valid_valid/acc': 64.135, 'best_valid_valid/acc_unbiased': 61.766, 'best_valid_valid/diff': 7.365, 'best_valid_valid/acc_skew': 58.084, 'best_valid_valid/acc_align': 65.449, 'best_valid_test/acc': 63.797, 'best_valid_test/acc_unbiased': 61.998, 'best_valid_test/diff': 9.099, 'best_valid_test/acc_skew': 57.448, 'best_valid_test/acc_align': 66.547}
[3 / 20] best test accuracy: 61.998 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 64.135, 'best_test_valid/acc_unbiased': 61.766, 'best_test_valid/diff': 7.365, 'best_test_valid/acc_skew': 58.084, 'best_test_valid/acc_align': 65.449, 'best_test_test/acc': 63.797, 'best_test_test/acc_unbiased': 61.998, 'best_test_test/diff': 9.099, 'best_test_test/acc_skew': 57.448, 'best_test_test/acc_align': 66.547}
[4 / 20] Learning rate: 0.001 weight: 0.01
[4 / 20] Loss: 3.5649999602174067 CE Loss: 2.6650776492636026 Con Loss: 3.5383491779722807
[4 / 20] tensor([[0.272, 0.204],
        [0.913, 0.947]]) {'epoch': 4, 'valid/acc': 57.004, 'valid/acc_unbiased': 59.397, 'valid/diff': 3.864, 'valid/acc_skew': 57.465, 'valid/acc_align': 61.329, 'test/acc': 56.92, 'test/acc_unbiased': 58.404, 'test/diff': 5.082, 'test/acc_skew': 55.863, 'test/acc_align': 60.945}
[4 / 20] best valid accuracy: 61.766 at epoch 2 
 best_stats: {'best_valid_epoch': 2, 'best_valid_valid/acc': 64.135, 'best_valid_valid/acc_unbiased': 61.766, 'best_valid_valid/diff': 7.365, 'best_valid_valid/acc_skew': 58.084, 'best_valid_valid/acc_align': 65.449, 'best_valid_test/acc': 63.797, 'best_valid_test/acc_unbiased': 61.998, 'best_valid_test/diff': 9.099, 'best_valid_test/acc_skew': 57.448, 'best_valid_test/acc_align': 66.547}
[4 / 20] best test accuracy: 61.998 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 64.135, 'best_test_valid/acc_unbiased': 61.766, 'best_test_valid/diff': 7.365, 'best_test_valid/acc_skew': 58.084, 'best_test_valid/acc_align': 65.449, 'best_test_test/acc': 63.797, 'best_test_test/acc_unbiased': 61.998, 'best_test_test/diff': 9.099, 'best_test_test/acc_skew': 57.448, 'best_test_test/acc_align': 66.547}
[5 / 20] Learning rate: 0.001 weight: 0.01
[5 / 20] Loss: 3.563392959312015 CE Loss: 2.4318490781125033 Con Loss: 3.5390744717884015
[5 / 20] tensor([[0.633, 0.539],
        [0.742, 0.832]]) {'epoch': 5, 'valid/acc': 67.511, 'valid/acc_unbiased': 68.069, 'valid/diff': 9.106, 'valid/acc_skew': 63.516, 'valid/acc_align': 72.622, 'test/acc': 68.397, 'test/acc_unbiased': 68.657, 'test/diff': 9.157, 'test/acc_skew': 64.078, 'test/acc_align': 73.236}
[5 / 20] best valid accuracy: 68.069 at epoch 5 
 best_stats: {'best_valid_epoch': 5, 'best_valid_valid/acc': 67.511, 'best_valid_valid/acc_unbiased': 68.069, 'best_valid_valid/diff': 9.106, 'best_valid_valid/acc_skew': 63.516, 'best_valid_valid/acc_align': 72.622, 'best_valid_test/acc': 68.397, 'best_valid_test/acc_unbiased': 68.657, 'best_valid_test/diff': 9.157, 'best_valid_test/acc_skew': 64.078, 'best_valid_test/acc_align': 73.236}
[5 / 20] best test accuracy: 68.657 at epoch 5 
 best_stats: {'best_test_epoch': 5, 'best_test_valid/acc': 67.511, 'best_test_valid/acc_unbiased': 68.069, 'best_test_valid/diff': 9.106, 'best_test_valid/acc_skew': 63.516, 'best_test_valid/acc_align': 72.622, 'best_test_test/acc': 68.397, 'best_test_test/acc_unbiased': 68.657, 'best_test_test/diff': 9.157, 'best_test_test/acc_skew': 64.078, 'best_test_test/acc_align': 73.236}
[6 / 20] Learning rate: 0.001 weight: 0.01
[6 / 20] Loss: 3.4219749762287246 CE Loss: 2.226409890523957 Con Loss: 3.399710872546995
[6 / 20] tensor([[0.930, 0.870],
        [0.314, 0.487]]) {'epoch': 6, 'valid/acc': 66.667, 'valid/acc_unbiased': 64.241, 'valid/diff': 9.687, 'valid/acc_skew': 59.398, 'valid/acc_align': 69.084, 'test/acc': 66.709, 'test/acc_unbiased': 65.034, 'test/diff': 11.68, 'test/acc_skew': 59.193, 'test/acc_align': 70.874}
[6 / 20] best valid accuracy: 68.069 at epoch 5 
 best_stats: {'best_valid_epoch': 5, 'best_valid_valid/acc': 67.511, 'best_valid_valid/acc_unbiased': 68.069, 'best_valid_valid/diff': 9.106, 'best_valid_valid/acc_skew': 63.516, 'best_valid_valid/acc_align': 72.622, 'best_valid_test/acc': 68.397, 'best_valid_test/acc_unbiased': 68.657, 'best_valid_test/diff': 9.157, 'best_valid_test/acc_skew': 64.078, 'best_valid_test/acc_align': 73.236}
[6 / 20] best test accuracy: 68.657 at epoch 5 
 best_stats: {'best_test_epoch': 5, 'best_test_valid/acc': 67.511, 'best_test_valid/acc_unbiased': 68.069, 'best_test_valid/diff': 9.106, 'best_test_valid/acc_skew': 63.516, 'best_test_valid/acc_align': 72.622, 'best_test_test/acc': 68.397, 'best_test_test/acc_unbiased': 68.657, 'best_test_test/diff': 9.157, 'best_test_test/acc_skew': 64.078, 'best_test_test/acc_align': 73.236}
[7 / 20] Learning rate: 0.0001 weight: 0.01
[7 / 20] Loss: 3.47590133582704 CE Loss: 1.8118873574104557 Con Loss: 3.4577824595933206
[7 / 20] tensor([[0.722, 0.622],
        [0.742, 0.841]]) {'epoch': 7, 'valid/acc': 71.983, 'valid/acc_unbiased': 72.248, 'valid/diff': 7.597, 'valid/acc_skew': 68.449, 'valid/acc_align': 76.047, 'test/acc': 73.122, 'test/acc_unbiased': 73.188, 'test/diff': 9.947, 'test/acc_skew': 68.214, 'test/acc_align': 78.162}
[7 / 20] best valid accuracy: 72.248 at epoch 7 
 best_stats: {'best_valid_epoch': 7, 'best_valid_valid/acc': 71.983, 'best_valid_valid/acc_unbiased': 72.248, 'best_valid_valid/diff': 7.597, 'best_valid_valid/acc_skew': 68.449, 'best_valid_valid/acc_align': 76.047, 'best_valid_test/acc': 73.122, 'best_valid_test/acc_unbiased': 73.188, 'best_valid_test/diff': 9.947, 'best_valid_test/acc_skew': 68.214, 'best_valid_test/acc_align': 78.162}
[7 / 20] best test accuracy: 73.188 at epoch 7 
 best_stats: {'best_test_epoch': 7, 'best_test_valid/acc': 71.983, 'best_test_valid/acc_unbiased': 72.248, 'best_test_valid/diff': 7.597, 'best_test_valid/acc_skew': 68.449, 'best_test_valid/acc_align': 76.047, 'best_test_test/acc': 73.122, 'best_test_test/acc_unbiased': 73.188, 'best_test_test/diff': 9.947, 'best_test_test/acc_skew': 68.214, 'best_test_test/acc_align': 78.162}
[8 / 20] Learning rate: 0.0001 weight: 0.01
[8 / 20] Loss: 3.6611095227774944 CE Loss: 1.7319430814245431 Con Loss: 3.64379010647013
[8 / 20] tensor([[0.735, 0.654],
        [0.729, 0.817]]) {'epoch': 8, 'valid/acc': 72.827, 'valid/acc_unbiased': 72.966, 'valid/diff': 5.743, 'valid/acc_skew': 70.095, 'valid/acc_align': 75.837, 'test/acc': 73.418, 'test/acc_unbiased': 73.395, 'test/diff': 8.41, 'test/acc_skew': 69.19, 'test/acc_align': 77.6}
[8 / 20] best valid accuracy: 72.966 at epoch 8 
 best_stats: {'best_valid_epoch': 8, 'best_valid_valid/acc': 72.827, 'best_valid_valid/acc_unbiased': 72.966, 'best_valid_valid/diff': 5.743, 'best_valid_valid/acc_skew': 70.095, 'best_valid_valid/acc_align': 75.837, 'best_valid_test/acc': 73.418, 'best_valid_test/acc_unbiased': 73.395, 'best_valid_test/diff': 8.41, 'best_valid_test/acc_skew': 69.19, 'best_valid_test/acc_align': 77.6}
[8 / 20] best test accuracy: 73.395 at epoch 8 
 best_stats: {'best_test_epoch': 8, 'best_test_valid/acc': 72.827, 'best_test_valid/acc_unbiased': 72.966, 'best_test_valid/diff': 5.743, 'best_test_valid/acc_skew': 70.095, 'best_test_valid/acc_align': 75.837, 'best_test_test/acc': 73.418, 'best_test_test/acc_unbiased': 73.395, 'best_test_test/diff': 8.41, 'best_test_test/acc_skew': 69.19, 'best_test_test/acc_align': 77.6}
[9 / 20] Learning rate: 0.0001 weight: 0.01
[9 / 20] Loss: 3.370964909757921 CE Loss: 1.8480386211087718 Con Loss: 3.3524845302851127
[9 / 20] tensor([[0.758, 0.688],
        [0.710, 0.792]]) {'epoch': 9, 'valid/acc': 74.346, 'valid/acc_unbiased': 74.467, 'valid/diff': 5.31, 'valid/acc_skew': 71.812, 'valid/acc_align': 77.122, 'test/acc': 73.84, 'test/acc_unbiased': 73.708, 'test/diff': 7.588, 'test/acc_skew': 69.914, 'test/acc_align': 77.502}
[9 / 20] best valid accuracy: 74.467 at epoch 9 
 best_stats: {'best_valid_epoch': 9, 'best_valid_valid/acc': 74.346, 'best_valid_valid/acc_unbiased': 74.467, 'best_valid_valid/diff': 5.31, 'best_valid_valid/acc_skew': 71.812, 'best_valid_valid/acc_align': 77.122, 'best_valid_test/acc': 73.84, 'best_valid_test/acc_unbiased': 73.708, 'best_valid_test/diff': 7.588, 'best_valid_test/acc_skew': 69.914, 'best_valid_test/acc_align': 77.502}
[9 / 20] best test accuracy: 73.708 at epoch 9 
 best_stats: {'best_test_epoch': 9, 'best_test_valid/acc': 74.346, 'best_test_valid/acc_unbiased': 74.467, 'best_test_valid/diff': 5.31, 'best_test_valid/acc_skew': 71.812, 'best_test_valid/acc_align': 77.122, 'best_test_test/acc': 73.84, 'best_test_test/acc_unbiased': 73.708, 'best_test_test/diff': 7.588, 'best_test_test/acc_skew': 69.914, 'best_test_test/acc_align': 77.502}
[10 / 20] Learning rate: 0.0001 weight: 0.01
[10 / 20] Loss: 3.3160535114314116 CE Loss: 1.544367944877865 Con Loss: 3.3006098149834004
[10 / 20] tensor([[0.772, 0.645],
        [0.727, 0.845]]) {'epoch': 10, 'valid/acc': 74.304, 'valid/acc_unbiased': 74.232, 'valid/diff': 8.126, 'valid/acc_skew': 70.169, 'valid/acc_align': 78.295, 'test/acc': 74.81, 'test/acc_unbiased': 74.766, 'test/diff': 12.255, 'test/acc_skew': 68.638, 'test/acc_align': 80.893}
[10 / 20] best valid accuracy: 74.467 at epoch 9 
 best_stats: {'best_valid_epoch': 9, 'best_valid_valid/acc': 74.346, 'best_valid_valid/acc_unbiased': 74.467, 'best_valid_valid/diff': 5.31, 'best_valid_valid/acc_skew': 71.812, 'best_valid_valid/acc_align': 77.122, 'best_valid_test/acc': 73.84, 'best_valid_test/acc_unbiased': 73.708, 'best_valid_test/diff': 7.588, 'best_valid_test/acc_skew': 69.914, 'best_valid_test/acc_align': 77.502}
[10 / 20] best test accuracy: 74.766 at epoch 10 
 best_stats: {'best_test_epoch': 10, 'best_test_valid/acc': 74.304, 'best_test_valid/acc_unbiased': 74.232, 'best_test_valid/diff': 8.126, 'best_test_valid/acc_skew': 70.169, 'best_test_valid/acc_align': 78.295, 'best_test_test/acc': 74.81, 'best_test_test/acc_unbiased': 74.766, 'best_test_test/diff': 12.255, 'best_test_test/acc_skew': 68.638, 'best_test_test/acc_align': 80.893}
[11 / 20] Learning rate: 0.0001 weight: 0.01
[11 / 20] Loss: 3.1775905518037533 CE Loss: 1.5365429037501948 Con Loss: 3.162225138932153
[11 / 20] tensor([[0.810, 0.730],
        [0.656, 0.789]]) {'epoch': 11, 'valid/acc': 75.907, 'valid/acc_unbiased': 75.716, 'valid/diff': 5.025, 'valid/acc_skew': 73.203, 'valid/acc_align': 78.228, 'test/acc': 75.105, 'test/acc_unbiased': 74.614, 'test/diff': 10.675, 'test/acc_skew': 69.277, 'test/acc_align': 79.952}
[11 / 20] best valid accuracy: 75.716 at epoch 11 
 best_stats: {'best_valid_epoch': 11, 'best_valid_valid/acc': 75.907, 'best_valid_valid/acc_unbiased': 75.716, 'best_valid_valid/diff': 5.025, 'best_valid_valid/acc_skew': 73.203, 'best_valid_valid/acc_align': 78.228, 'best_valid_test/acc': 75.105, 'best_valid_test/acc_unbiased': 74.614, 'best_valid_test/diff': 10.675, 'best_valid_test/acc_skew': 69.277, 'best_valid_test/acc_align': 79.952}
[11 / 20] best test accuracy: 74.766 at epoch 10 
 best_stats: {'best_test_epoch': 10, 'best_test_valid/acc': 74.304, 'best_test_valid/acc_unbiased': 74.232, 'best_test_valid/diff': 8.126, 'best_test_valid/acc_skew': 70.169, 'best_test_valid/acc_align': 78.295, 'best_test_test/acc': 74.81, 'best_test_test/acc_unbiased': 74.766, 'best_test_test/diff': 12.255, 'best_test_test/acc_skew': 68.638, 'best_test_test/acc_align': 80.893}
[12 / 20] Learning rate: 0.0001 weight: 0.01
[12 / 20] Loss: 3.1606913269551087 CE Loss: 1.4089067460419717 Con Loss: 3.14660227787035
[12 / 20] tensor([[0.828, 0.725],
        [0.665, 0.801]]) {'epoch': 12, 'valid/acc': 76.793, 'valid/acc_unbiased': 76.548, 'valid/diff': 6.394, 'valid/acc_skew': 73.35, 'valid/acc_align': 79.745, 'test/acc': 75.907, 'test/acc_unbiased': 75.465, 'test/diff': 11.954, 'test/acc_skew': 69.488, 'test/acc_align': 81.442}
[12 / 20] best valid accuracy: 76.548 at epoch 12 
 best_stats: {'best_valid_epoch': 12, 'best_valid_valid/acc': 76.793, 'best_valid_valid/acc_unbiased': 76.548, 'best_valid_valid/diff': 6.394, 'best_valid_valid/acc_skew': 73.35, 'best_valid_valid/acc_align': 79.745, 'best_valid_test/acc': 75.907, 'best_valid_test/acc_unbiased': 75.465, 'best_valid_test/diff': 11.954, 'best_valid_test/acc_skew': 69.488, 'best_valid_test/acc_align': 81.442}
[12 / 20] best test accuracy: 75.465 at epoch 12 
 best_stats: {'best_test_epoch': 12, 'best_test_valid/acc': 76.793, 'best_test_valid/acc_unbiased': 76.548, 'best_test_valid/diff': 6.394, 'best_test_valid/acc_skew': 73.35, 'best_test_valid/acc_align': 79.745, 'best_test_test/acc': 75.907, 'best_test_test/acc_unbiased': 75.465, 'best_test_test/diff': 11.954, 'best_test_test/acc_skew': 69.488, 'best_test_test/acc_align': 81.442}
[13 / 20] Learning rate: 0.0001 weight: 0.01
[13 / 20] Loss: 2.833028054941757 CE Loss: 1.7475969520520138 Con Loss: 2.8155520841247985
[13 / 20] tensor([[0.869, 0.778],
        [0.619, 0.747]]) {'epoch': 13, 'valid/acc': 76.371, 'valid/acc_unbiased': 75.666, 'valid/diff': 8.198, 'valid/acc_skew': 71.567, 'valid/acc_align': 79.766, 'test/acc': 75.992, 'test/acc_unbiased': 75.351, 'test/diff': 10.955, 'test/acc_skew': 69.874, 'test/acc_align': 80.829}
[13 / 20] best valid accuracy: 76.548 at epoch 12 
 best_stats: {'best_valid_epoch': 12, 'best_valid_valid/acc': 76.793, 'best_valid_valid/acc_unbiased': 76.548, 'best_valid_valid/diff': 6.394, 'best_valid_valid/acc_skew': 73.35, 'best_valid_valid/acc_align': 79.745, 'best_valid_test/acc': 75.907, 'best_valid_test/acc_unbiased': 75.465, 'best_valid_test/diff': 11.954, 'best_valid_test/acc_skew': 69.488, 'best_valid_test/acc_align': 81.442}
[13 / 20] best test accuracy: 75.465 at epoch 12 
 best_stats: {'best_test_epoch': 12, 'best_test_valid/acc': 76.793, 'best_test_valid/acc_unbiased': 76.548, 'best_test_valid/diff': 6.394, 'best_test_valid/acc_skew': 73.35, 'best_test_valid/acc_align': 79.745, 'best_test_test/acc': 75.907, 'best_test_test/acc_unbiased': 75.465, 'best_test_test/diff': 11.954, 'best_test_test/acc_skew': 69.488, 'best_test_test/acc_align': 81.442}
[14 / 20] Learning rate: 1e-05 weight: 0.01
[14 / 20] Loss: 3.134800841047815 CE Loss: 1.6710071043664954 Con Loss: 3.118090764796907
[14 / 20] tensor([[0.858, 0.761],
        [0.639, 0.770]]) {'epoch': 14, 'valid/acc': 77.004, 'valid/acc_unbiased': 76.315, 'valid/diff': 8.403, 'valid/acc_skew': 72.114, 'valid/acc_align': 80.517, 'test/acc': 76.245, 'test/acc_unbiased': 75.684, 'test/diff': 11.444, 'test/acc_skew': 69.962, 'test/acc_align': 81.406}
[14 / 20] best valid accuracy: 76.548 at epoch 12 
 best_stats: {'best_valid_epoch': 12, 'best_valid_valid/acc': 76.793, 'best_valid_valid/acc_unbiased': 76.548, 'best_valid_valid/diff': 6.394, 'best_valid_valid/acc_skew': 73.35, 'best_valid_valid/acc_align': 79.745, 'best_valid_test/acc': 75.907, 'best_valid_test/acc_unbiased': 75.465, 'best_valid_test/diff': 11.954, 'best_valid_test/acc_skew': 69.488, 'best_valid_test/acc_align': 81.442}
[14 / 20] best test accuracy: 75.684 at epoch 14 
 best_stats: {'best_test_epoch': 14, 'best_test_valid/acc': 77.004, 'best_test_valid/acc_unbiased': 76.315, 'best_test_valid/diff': 8.403, 'best_test_valid/acc_skew': 72.114, 'best_test_valid/acc_align': 80.517, 'best_test_test/acc': 76.245, 'best_test_test/acc_unbiased': 75.684, 'best_test_test/diff': 11.444, 'best_test_test/acc_skew': 69.962, 'best_test_test/acc_align': 81.406}
[15 / 20] Learning rate: 1e-05 weight: 0.01
[15 / 20] Loss: 2.971244212813418 CE Loss: 1.3745854763609802 Con Loss: 2.9574983470250085
[15 / 20] tensor([[0.848, 0.747],
        [0.647, 0.792]]) {'epoch': 15, 'valid/acc': 75.865, 'valid/acc_unbiased': 75.306, 'valid/diff': 9.016, 'valid/acc_skew': 70.798, 'valid/acc_align': 79.814, 'test/acc': 76.414, 'test/acc_unbiased': 75.856, 'test/diff': 12.252, 'test/acc_skew': 69.73, 'test/acc_align': 81.982}
[15 / 20] best valid accuracy: 76.548 at epoch 12 
 best_stats: {'best_valid_epoch': 12, 'best_valid_valid/acc': 76.793, 'best_valid_valid/acc_unbiased': 76.548, 'best_valid_valid/diff': 6.394, 'best_valid_valid/acc_skew': 73.35, 'best_valid_valid/acc_align': 79.745, 'best_valid_test/acc': 75.907, 'best_valid_test/acc_unbiased': 75.465, 'best_valid_test/diff': 11.954, 'best_valid_test/acc_skew': 69.488, 'best_valid_test/acc_align': 81.442}
[15 / 20] best test accuracy: 75.856 at epoch 15 
 best_stats: {'best_test_epoch': 15, 'best_test_valid/acc': 75.865, 'best_test_valid/acc_unbiased': 75.306, 'best_test_valid/diff': 9.016, 'best_test_valid/acc_skew': 70.798, 'best_test_valid/acc_align': 79.814, 'best_test_test/acc': 76.414, 'best_test_test/acc_unbiased': 75.856, 'best_test_test/diff': 12.252, 'best_test_test/acc_skew': 69.73, 'best_test_test/acc_align': 81.982}
[16 / 20] Learning rate: 1e-05 weight: 0.01
[16 / 20] Loss: 2.8489084452942843 CE Loss: 1.4673115276251665 Con Loss: 2.834235330456546
[16 / 20] tensor([[0.826, 0.709],
        [0.697, 0.823]]) {'epoch': 16, 'valid/acc': 75.992, 'valid/acc_unbiased': 75.71, 'valid/diff': 8.664, 'valid/acc_skew': 71.378, 'valid/acc_align': 80.042, 'test/acc': 76.667, 'test/acc_unbiased': 76.383, 'test/diff': 12.168, 'test/acc_skew': 70.299, 'test/acc_align': 82.467}
[16 / 20] best valid accuracy: 76.548 at epoch 12 
 best_stats: {'best_valid_epoch': 12, 'best_valid_valid/acc': 76.793, 'best_valid_valid/acc_unbiased': 76.548, 'best_valid_valid/diff': 6.394, 'best_valid_valid/acc_skew': 73.35, 'best_valid_valid/acc_align': 79.745, 'best_valid_test/acc': 75.907, 'best_valid_test/acc_unbiased': 75.465, 'best_valid_test/diff': 11.954, 'best_valid_test/acc_skew': 69.488, 'best_valid_test/acc_align': 81.442}
[16 / 20] best test accuracy: 76.383 at epoch 16 
 best_stats: {'best_test_epoch': 16, 'best_test_valid/acc': 75.992, 'best_test_valid/acc_unbiased': 75.71, 'best_test_valid/diff': 8.664, 'best_test_valid/acc_skew': 71.378, 'best_test_valid/acc_align': 80.042, 'best_test_test/acc': 76.667, 'best_test_test/acc_unbiased': 76.383, 'best_test_test/diff': 12.168, 'best_test_test/acc_skew': 70.299, 'best_test_test/acc_align': 82.467}
[17 / 20] Learning rate: 1e-05 weight: 0.01
[17 / 20] Loss: 2.9615151339193315 CE Loss: 1.3363163335357957 Con Loss: 2.948151961122684
[17 / 20] tensor([[0.819, 0.712],
        [0.684, 0.826]]) {'epoch': 17, 'valid/acc': 75.527, 'valid/acc_unbiased': 75.186, 'valid/diff': 9.076, 'valid/acc_skew': 70.648, 'valid/acc_align': 79.724, 'test/acc': 76.414, 'test/acc_unbiased': 76.027, 'test/diff': 12.46, 'test/acc_skew': 69.797, 'test/acc_align': 82.257}
[17 / 20] best valid accuracy: 76.548 at epoch 12 
 best_stats: {'best_valid_epoch': 12, 'best_valid_valid/acc': 76.793, 'best_valid_valid/acc_unbiased': 76.548, 'best_valid_valid/diff': 6.394, 'best_valid_valid/acc_skew': 73.35, 'best_valid_valid/acc_align': 79.745, 'best_valid_test/acc': 75.907, 'best_valid_test/acc_unbiased': 75.465, 'best_valid_test/diff': 11.954, 'best_valid_test/acc_skew': 69.488, 'best_valid_test/acc_align': 81.442}
[17 / 20] best test accuracy: 76.383 at epoch 16 
 best_stats: {'best_test_epoch': 16, 'best_test_valid/acc': 75.992, 'best_test_valid/acc_unbiased': 75.71, 'best_test_valid/diff': 8.664, 'best_test_valid/acc_skew': 71.378, 'best_test_valid/acc_align': 80.042, 'best_test_test/acc': 76.667, 'best_test_test/acc_unbiased': 76.383, 'best_test_test/diff': 12.168, 'best_test_test/acc_skew': 70.299, 'best_test_test/acc_align': 82.467}
[18 / 20] Learning rate: 1e-05 weight: 0.01
[18 / 20] Loss: 2.9277461725291336 CE Loss: 1.6815641872872098 Con Loss: 2.9109305204125007
[18 / 20] tensor([[0.835, 0.746],
        [0.671, 0.802]]) {'epoch': 18, 'valid/acc': 76.498, 'valid/acc_unbiased': 76.056, 'valid/diff': 8.256, 'valid/acc_skew': 71.928, 'valid/acc_align': 80.184, 'test/acc': 76.835, 'test/acc_unbiased': 76.361, 'test/diff': 11.028, 'test/acc_skew': 70.847, 'test/acc_align': 81.875}
[18 / 20] best valid accuracy: 76.548 at epoch 12 
 best_stats: {'best_valid_epoch': 12, 'best_valid_valid/acc': 76.793, 'best_valid_valid/acc_unbiased': 76.548, 'best_valid_valid/diff': 6.394, 'best_valid_valid/acc_skew': 73.35, 'best_valid_valid/acc_align': 79.745, 'best_valid_test/acc': 75.907, 'best_valid_test/acc_unbiased': 75.465, 'best_valid_test/diff': 11.954, 'best_valid_test/acc_skew': 69.488, 'best_valid_test/acc_align': 81.442}
[18 / 20] best test accuracy: 76.383 at epoch 16 
 best_stats: {'best_test_epoch': 16, 'best_test_valid/acc': 75.992, 'best_test_valid/acc_unbiased': 75.71, 'best_test_valid/diff': 8.664, 'best_test_valid/acc_skew': 71.378, 'best_test_valid/acc_align': 80.042, 'best_test_test/acc': 76.667, 'best_test_test/acc_unbiased': 76.383, 'best_test_test/diff': 12.168, 'best_test_test/acc_skew': 70.299, 'best_test_test/acc_align': 82.467}
[19 / 20] Learning rate: 1e-05 weight: 0.01
[19 / 20] Loss: 2.8758032536351448 CE Loss: 1.3854835998671737 Con Loss: 2.86194842034838
[19 / 20] tensor([[0.837, 0.746],
        [0.656, 0.799]]) {'epoch': 19, 'valid/acc': 75.654, 'valid/acc_unbiased': 75.132, 'valid/diff': 7.648, 'valid/acc_skew': 71.308, 'valid/acc_align': 78.956, 'test/acc': 76.498, 'test/acc_unbiased': 75.953, 'test/diff': 11.727, 'test/acc_skew': 70.089, 'test/acc_align': 81.816}
[19 / 20] best valid accuracy: 76.548 at epoch 12 
 best_stats: {'best_valid_epoch': 12, 'best_valid_valid/acc': 76.793, 'best_valid_valid/acc_unbiased': 76.548, 'best_valid_valid/diff': 6.394, 'best_valid_valid/acc_skew': 73.35, 'best_valid_valid/acc_align': 79.745, 'best_valid_test/acc': 75.907, 'best_valid_test/acc_unbiased': 75.465, 'best_valid_test/diff': 11.954, 'best_valid_test/acc_skew': 69.488, 'best_valid_test/acc_align': 81.442}
[19 / 20] best test accuracy: 76.383 at epoch 16 
 best_stats: {'best_test_epoch': 16, 'best_test_valid/acc': 75.992, 'best_test_valid/acc_unbiased': 75.71, 'best_test_valid/diff': 8.664, 'best_test_valid/acc_skew': 71.378, 'best_test_valid/acc_align': 80.042, 'best_test_test/acc': 76.667, 'best_test_test/acc_unbiased': 76.383, 'best_test_test/diff': 12.168, 'best_test_test/acc_skew': 70.299, 'best_test_test/acc_align': 82.467}
[20 / 20] Learning rate: 1e-05 weight: 0.01
[20 / 20] Loss: 3.011130500269581 CE Loss: 1.4574396736095354 Con Loss: 2.996556106112752
[20 / 20] tensor([[0.780, 0.679],
        [0.738, 0.856]]) {'epoch': 20, 'valid/acc': 75.274, 'valid/acc_unbiased': 75.369, 'valid/diff': 8.651, 'valid/acc_skew': 71.044, 'valid/acc_align': 79.695, 'test/acc': 76.456, 'test/acc_unbiased': 76.325, 'test/diff': 10.894, 'test/acc_skew': 70.878, 'test/acc_align': 81.772}
[20 / 20] best valid accuracy: 76.548 at epoch 12 
 best_stats: {'best_valid_epoch': 12, 'best_valid_valid/acc': 76.793, 'best_valid_valid/acc_unbiased': 76.548, 'best_valid_valid/diff': 6.394, 'best_valid_valid/acc_skew': 73.35, 'best_valid_valid/acc_align': 79.745, 'best_valid_test/acc': 75.907, 'best_valid_test/acc_unbiased': 75.465, 'best_valid_test/diff': 11.954, 'best_valid_test/acc_skew': 69.488, 'best_valid_test/acc_align': 81.442}
[20 / 20] best test accuracy: 76.383 at epoch 16 
 best_stats: {'best_test_epoch': 16, 'best_test_valid/acc': 75.992, 'best_test_valid/acc_unbiased': 75.71, 'best_test_valid/diff': 8.664, 'best_test_valid/acc_skew': 71.378, 'best_test_valid/acc_align': 80.042, 'best_test_test/acc': 76.667, 'best_test_test/acc_unbiased': 76.383, 'best_test_test/diff': 12.168, 'best_test_test/acc_skew': 70.299, 'best_test_test/acc_align': 82.467}
Total training time: 1:06:49
