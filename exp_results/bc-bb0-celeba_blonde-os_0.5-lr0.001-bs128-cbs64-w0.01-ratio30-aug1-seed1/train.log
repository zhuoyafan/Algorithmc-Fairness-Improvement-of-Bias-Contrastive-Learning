Log level set to: INFO
Set seed: 1
=======> Using Fixed Random Seed: 1 <========
save_path: exp_results/bc-bb0-celeba_blonde-os_0.5-lr0.001-bs128-cbs64-w0.01-ratio30-aug1-seed1
get_celeba - split:train, aug: False, given_y: True, ratio: 0
use existing blonde indices from data/celeba/pickles/blonde
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [26788, 26788]
Target 1: [26788, 26788]
Binary Target 1
---------------------------
Target 0: [26788, 26788]
Target 1: [26788, 26788]
===================================
Normal Label Distribution: 
Target 0: [26788, 26788]
Target 1: [26788, 26788]
===================================
Use BiasedCelebASplit 
 target_attr: blonde split: train 
 tensor([[26788., 26788.],
        [26788., 26788.]])
get_celeba - split:train, aug: 1, given_y: True, ratio: 30
use existing blonde indices from data/celeba/pickles/blonde
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [26712, 26712]
Target 1: [26712, 26712]
Binary Target 1
---------------------------
Target 0: [26712, 26712]
Target 1: [26712, 26712]
===================================
Normal Label Distribution: 
Target 0: [26712, 26712]
Target 1: [26712, 26712]
===================================
Use BiasedCelebASplit 
 target_attr: blonde split: train 
 tensor([[26712., 26712.],
        [26712., 26712.]])
get_celeba - split:train_valid, aug: False, given_y: True, ratio: 0
use existing blonde indices from data/celeba/pickles/blonde
Use BiasedCelebASplit 
 target_attr: blonde split: train_valid 
 tensor([[  390.,  4598.],
        [13361.,   280.]])
get_celeba - split:valid, aug: False, given_y: True, ratio: 0
Use BiasedCelebASplit 
 target_attr: blonde split: valid 
 tensor([[8535., 2874.],
        [8276.,  182.]])
decay_epochs: [3, 6]
[1 / 10] Learning rate: 0.001 weight: 0.01
[1 / 10] Loss: 4.631533861765492 CE Loss: 0.2514052444464576 Con Loss: 4.629019814141388
[1 / 10] tensor([[0.793, 0.915],
        [0.972, 0.934]]) {'epoch': 1, 'valid/acc': 92.34, 'valid/acc_unbiased': 90.476, 'valid/diff': 6.895, 'valid/acc_skew': 90.933, 'valid/acc_align': 90.019, 'test/acc': 87.109, 'test/acc_unbiased': 90.354, 'test/diff': 7.992, 'test/acc_skew': 88.245, 'test/acc_align': 92.462}
[1 / 10] best valid accuracy: 90.476 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 92.34, 'best_valid_valid/acc_unbiased': 90.476, 'best_valid_valid/diff': 6.895, 'best_valid_valid/acc_skew': 90.933, 'best_valid_valid/acc_align': 90.019, 'best_valid_test/acc': 87.109, 'best_valid_test/acc_unbiased': 90.354, 'best_valid_test/diff': 7.992, 'best_valid_test/acc_skew': 88.245, 'best_valid_test/acc_align': 92.462}
[1 / 10] best test accuracy: 90.354 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 92.34, 'best_test_valid/acc_unbiased': 90.476, 'best_test_valid/diff': 6.895, 'best_test_valid/acc_skew': 90.933, 'best_test_valid/acc_align': 90.019, 'best_test_test/acc': 87.109, 'best_test_test/acc_unbiased': 90.354, 'best_test_test/diff': 7.992, 'best_test_test/acc_skew': 88.245, 'best_test_test/acc_align': 92.462}
[2 / 10] Learning rate: 0.001 weight: 0.01
[2 / 10] Loss: 4.587813841614845 CE Loss: 0.21690309321157644 Con Loss: 4.585644809278032
[2 / 10] tensor([[0.891, 0.948],
        [0.928, 0.863]]) {'epoch': 2, 'valid/acc': 93.376, 'valid/acc_unbiased': 91.836, 'valid/diff': 5.144, 'valid/acc_skew': 94.408, 'valid/acc_align': 89.264, 'test/acc': 91.987, 'test/acc_unbiased': 90.748, 'test/diff': 6.117, 'test/acc_skew': 90.974, 'test/acc_align': 90.522}
[2 / 10] best valid accuracy: 91.836 at epoch 2 
 best_stats: {'best_valid_epoch': 2, 'best_valid_valid/acc': 93.376, 'best_valid_valid/acc_unbiased': 91.836, 'best_valid_valid/diff': 5.144, 'best_valid_valid/acc_skew': 94.408, 'best_valid_valid/acc_align': 89.264, 'best_valid_test/acc': 91.987, 'best_valid_test/acc_unbiased': 90.748, 'best_valid_test/diff': 6.117, 'best_valid_test/acc_skew': 90.974, 'best_valid_test/acc_align': 90.522}
[2 / 10] best test accuracy: 90.748 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 93.376, 'best_test_valid/acc_unbiased': 91.836, 'best_test_valid/diff': 5.144, 'best_test_valid/acc_skew': 94.408, 'best_test_valid/acc_align': 89.264, 'best_test_test/acc': 91.987, 'best_test_test/acc_unbiased': 90.748, 'best_test_test/diff': 6.117, 'best_test_test/acc_skew': 90.974, 'best_test_test/acc_align': 90.522}
[3 / 10] Learning rate: 0.001 weight: 0.01
[3 / 10] Loss: 4.566578379598717 CE Loss: 0.20190449615939618 Con Loss: 4.564559331879396
[3 / 10] tensor([[0.838, 0.933],
        [0.961, 0.885]]) {'epoch': 3, 'valid/acc': 93.451, 'valid/acc_unbiased': 93.065, 'valid/diff': 3.502, 'valid/acc_skew': 94.816, 'valid/acc_align': 91.314, 'test/acc': 89.576, 'test/acc_unbiased': 90.414, 'test/diff': 8.581, 'test/acc_skew': 89.944, 'test/acc_align': 90.884}
[3 / 10] best valid accuracy: 93.065 at epoch 3 
 best_stats: {'best_valid_epoch': 3, 'best_valid_valid/acc': 93.451, 'best_valid_valid/acc_unbiased': 93.065, 'best_valid_valid/diff': 3.502, 'best_valid_valid/acc_skew': 94.816, 'best_valid_valid/acc_align': 91.314, 'best_valid_test/acc': 89.576, 'best_valid_test/acc_unbiased': 90.414, 'best_valid_test/diff': 8.581, 'best_valid_test/acc_skew': 89.944, 'best_valid_test/acc_align': 90.884}
[3 / 10] best test accuracy: 90.748 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 93.376, 'best_test_valid/acc_unbiased': 91.836, 'best_test_valid/diff': 5.144, 'best_test_valid/acc_skew': 94.408, 'best_test_valid/acc_align': 89.264, 'best_test_test/acc': 91.987, 'best_test_test/acc_unbiased': 90.748, 'best_test_test/diff': 6.117, 'best_test_test/acc_skew': 90.974, 'best_test_test/acc_align': 90.522}
[4 / 10] Learning rate: 0.0001 weight: 0.01
[4 / 10] Loss: 4.486744836531273 CE Loss: 0.15963612151080073 Con Loss: 4.485148471025134
[4 / 10] tensor([[0.878, 0.944],
        [0.944, 0.896]]) {'epoch': 4, 'valid/acc': 94.084, 'valid/acc_unbiased': 94.955, 'valid/diff': 3.175, 'valid/acc_skew': 96.543, 'valid/acc_align': 93.367, 'test/acc': 91.488, 'test/acc_unbiased': 91.527, 'test/diff': 5.737, 'test/acc_skew': 91.095, 'test/acc_align': 91.959}
[4 / 10] best valid accuracy: 94.955 at epoch 4 
 best_stats: {'best_valid_epoch': 4, 'best_valid_valid/acc': 94.084, 'best_valid_valid/acc_unbiased': 94.955, 'best_valid_valid/diff': 3.175, 'best_valid_valid/acc_skew': 96.543, 'best_valid_valid/acc_align': 93.367, 'best_valid_test/acc': 91.488, 'best_valid_test/acc_unbiased': 91.527, 'best_valid_test/diff': 5.737, 'best_valid_test/acc_skew': 91.095, 'best_valid_test/acc_align': 91.959}
[4 / 10] best test accuracy: 91.527 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 94.084, 'best_test_valid/acc_unbiased': 94.955, 'best_test_valid/diff': 3.175, 'best_test_valid/acc_skew': 96.543, 'best_test_valid/acc_align': 93.367, 'best_test_test/acc': 91.488, 'best_test_test/acc_unbiased': 91.527, 'best_test_test/diff': 5.737, 'best_test_test/acc_skew': 91.095, 'best_test_test/acc_align': 91.959}
[5 / 10] Learning rate: 0.0001 weight: 0.01
[5 / 10] Loss: 4.454404915520126 CE Loss: 0.14574455346133935 Con Loss: 4.4529474661993556
[5 / 10] tensor([[0.852, 0.944],
        [0.959, 0.896]]) {'epoch': 5, 'valid/acc': 94.675, 'valid/acc_unbiased': 95.547, 'valid/diff': 2.706, 'valid/acc_skew': 96.9, 'valid/acc_align': 94.194, 'test/acc': 90.648, 'test/acc_unbiased': 91.286, 'test/diff': 7.763, 'test/acc_skew': 90.589, 'test/acc_align': 91.983}
[5 / 10] best valid accuracy: 95.547 at epoch 5 
 best_stats: {'best_valid_epoch': 5, 'best_valid_valid/acc': 94.675, 'best_valid_valid/acc_unbiased': 95.547, 'best_valid_valid/diff': 2.706, 'best_valid_valid/acc_skew': 96.9, 'best_valid_valid/acc_align': 94.194, 'best_valid_test/acc': 90.648, 'best_valid_test/acc_unbiased': 91.286, 'best_valid_test/diff': 7.763, 'best_valid_test/acc_skew': 90.589, 'best_valid_test/acc_align': 91.983}
[5 / 10] best test accuracy: 91.527 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 94.084, 'best_test_valid/acc_unbiased': 94.955, 'best_test_valid/diff': 3.175, 'best_test_valid/acc_skew': 96.543, 'best_test_valid/acc_align': 93.367, 'best_test_test/acc': 91.488, 'best_test_test/acc_unbiased': 91.527, 'best_test_test/diff': 5.737, 'best_test_test/acc_skew': 91.095, 'best_test_test/acc_align': 91.959}
[6 / 10] Learning rate: 0.0001 weight: 0.01
[6 / 10] Loss: 4.4363877289469995 CE Loss: 0.13983793204687275 Con Loss: 4.434989352537408
[6 / 10] tensor([[0.842, 0.936],
        [0.962, 0.923]]) {'epoch': 6, 'valid/acc': 94.246, 'valid/acc_unbiased': 96.105, 'valid/diff': 2.746, 'valid/acc_skew': 97.478, 'valid/acc_align': 94.731, 'test/acc': 89.923, 'test/acc_unbiased': 91.582, 'test/diff': 6.686, 'test/acc_skew': 90.207, 'test/acc_align': 92.958}
[6 / 10] best valid accuracy: 96.105 at epoch 6 
 best_stats: {'best_valid_epoch': 6, 'best_valid_valid/acc': 94.246, 'best_valid_valid/acc_unbiased': 96.105, 'best_valid_valid/diff': 2.746, 'best_valid_valid/acc_skew': 97.478, 'best_valid_valid/acc_align': 94.731, 'best_valid_test/acc': 89.923, 'best_valid_test/acc_unbiased': 91.582, 'best_valid_test/diff': 6.686, 'best_valid_test/acc_skew': 90.207, 'best_valid_test/acc_align': 92.958}
[6 / 10] best test accuracy: 91.582 at epoch 6 
 best_stats: {'best_test_epoch': 6, 'best_test_valid/acc': 94.246, 'best_test_valid/acc_unbiased': 96.105, 'best_test_valid/diff': 2.746, 'best_test_valid/acc_skew': 97.478, 'best_test_valid/acc_align': 94.731, 'best_test_test/acc': 89.923, 'best_test_test/acc_unbiased': 91.582, 'best_test_test/diff': 6.686, 'best_test_test/acc_skew': 90.207, 'best_test_test/acc_align': 92.958}
[7 / 10] Learning rate: 1e-05 weight: 0.01
[7 / 10] Loss: 4.414678496069849 CE Loss: 0.1312404019070843 Con Loss: 4.413366092395939
[7 / 10] tensor([[0.844, 0.947],
        [0.962, 0.896]]) {'epoch': 7, 'valid/acc': 94.755, 'valid/acc_unbiased': 96.102, 'valid/diff': 2.433, 'valid/acc_skew': 97.319, 'valid/acc_align': 94.886, 'test/acc': 90.411, 'test/acc_unbiased': 91.191, 'test/diff': 8.451, 'test/acc_skew': 90.271, 'test/acc_align': 92.11}
[7 / 10] best valid accuracy: 96.105 at epoch 6 
 best_stats: {'best_valid_epoch': 6, 'best_valid_valid/acc': 94.246, 'best_valid_valid/acc_unbiased': 96.105, 'best_valid_valid/diff': 2.746, 'best_valid_valid/acc_skew': 97.478, 'best_valid_valid/acc_align': 94.731, 'best_valid_test/acc': 89.923, 'best_valid_test/acc_unbiased': 91.582, 'best_valid_test/diff': 6.686, 'best_valid_test/acc_skew': 90.207, 'best_valid_test/acc_align': 92.958}
[7 / 10] best test accuracy: 91.582 at epoch 6 
 best_stats: {'best_test_epoch': 6, 'best_test_valid/acc': 94.246, 'best_test_valid/acc_unbiased': 96.105, 'best_test_valid/diff': 2.746, 'best_test_valid/acc_skew': 97.478, 'best_test_valid/acc_align': 94.731, 'best_test_test/acc': 89.923, 'best_test_test/acc_unbiased': 91.582, 'best_test_test/diff': 6.686, 'best_test_test/acc_skew': 90.207, 'best_test_test/acc_align': 92.958}
[8 / 10] Learning rate: 1e-05 weight: 0.01
[8 / 10] Loss: 4.410926080415796 CE Loss: 0.1286631075414202 Con Loss: 4.409639445813677
[8 / 10] tensor([[0.832, 0.942],
        [0.972, 0.896]]) {'epoch': 8, 'valid/acc': 94.686, 'valid/acc_unbiased': 96.248, 'valid/diff': 2.643, 'valid/acc_skew': 97.569, 'valid/acc_align': 94.926, 'test/acc': 89.888, 'test/acc_unbiased': 91.05, 'test/diff': 9.318, 'test/acc_skew': 90.202, 'test/acc_align': 91.898}
[8 / 10] best valid accuracy: 96.248 at epoch 8 
 best_stats: {'best_valid_epoch': 8, 'best_valid_valid/acc': 94.686, 'best_valid_valid/acc_unbiased': 96.248, 'best_valid_valid/diff': 2.643, 'best_valid_valid/acc_skew': 97.569, 'best_valid_valid/acc_align': 94.926, 'best_valid_test/acc': 89.888, 'best_valid_test/acc_unbiased': 91.05, 'best_valid_test/diff': 9.318, 'best_valid_test/acc_skew': 90.202, 'best_valid_test/acc_align': 91.898}
[8 / 10] best test accuracy: 91.582 at epoch 6 
 best_stats: {'best_test_epoch': 6, 'best_test_valid/acc': 94.246, 'best_test_valid/acc_unbiased': 96.105, 'best_test_valid/diff': 2.746, 'best_test_valid/acc_skew': 97.478, 'best_test_valid/acc_align': 94.731, 'best_test_test/acc': 89.923, 'best_test_test/acc_unbiased': 91.582, 'best_test_test/diff': 6.686, 'best_test_test/acc_skew': 90.207, 'best_test_test/acc_align': 92.958}
[9 / 10] Learning rate: 1e-05 weight: 0.01
[9 / 10] Loss: 4.409407247620518 CE Loss: 0.12681039862531646 Con Loss: 4.408139139818792
[9 / 10] tensor([[0.831, 0.943],
        [0.968, 0.885]]) {'epoch': 9, 'valid/acc': 94.857, 'valid/acc_unbiased': 96.34, 'valid/diff': 2.246, 'valid/acc_skew': 97.463, 'valid/acc_align': 95.217, 'test/acc': 89.807, 'test/acc_unbiased': 90.666, 'test/diff': 9.742, 'test/acc_skew': 89.946, 'test/acc_align': 91.385}
[9 / 10] best valid accuracy: 96.340 at epoch 9 
 best_stats: {'best_valid_epoch': 9, 'best_valid_valid/acc': 94.857, 'best_valid_valid/acc_unbiased': 96.34, 'best_valid_valid/diff': 2.246, 'best_valid_valid/acc_skew': 97.463, 'best_valid_valid/acc_align': 95.217, 'best_valid_test/acc': 89.807, 'best_valid_test/acc_unbiased': 90.666, 'best_valid_test/diff': 9.742, 'best_valid_test/acc_skew': 89.946, 'best_valid_test/acc_align': 91.385}
[9 / 10] best test accuracy: 91.582 at epoch 6 
 best_stats: {'best_test_epoch': 6, 'best_test_valid/acc': 94.246, 'best_test_valid/acc_unbiased': 96.105, 'best_test_valid/diff': 2.746, 'best_test_valid/acc_skew': 97.478, 'best_test_valid/acc_align': 94.731, 'best_test_test/acc': 89.923, 'best_test_test/acc_unbiased': 91.582, 'best_test_test/diff': 6.686, 'best_test_test/acc_skew': 90.207, 'best_test_test/acc_align': 92.958}
[10 / 10] Learning rate: 1e-05 weight: 0.01
[10 / 10] Loss: 4.397694522700453 CE Loss: 0.1266220254937321 Con Loss: 4.3964283023821125
[10 / 10] tensor([[0.837, 0.951],
        [0.964, 0.868]]) {'epoch': 10, 'valid/acc': 95.104, 'valid/acc_unbiased': 96.042, 'valid/diff': 2.101, 'valid/acc_skew': 97.093, 'valid/acc_align': 94.992, 'test/acc': 90.346, 'test/acc_unbiased': 90.524, 'test/diff': 10.51, 'test/acc_skew': 90.071, 'test/acc_align': 90.978}
[10 / 10] best valid accuracy: 96.340 at epoch 9 
 best_stats: {'best_valid_epoch': 9, 'best_valid_valid/acc': 94.857, 'best_valid_valid/acc_unbiased': 96.34, 'best_valid_valid/diff': 2.246, 'best_valid_valid/acc_skew': 97.463, 'best_valid_valid/acc_align': 95.217, 'best_valid_test/acc': 89.807, 'best_valid_test/acc_unbiased': 90.666, 'best_valid_test/diff': 9.742, 'best_valid_test/acc_skew': 89.946, 'best_valid_test/acc_align': 91.385}
[10 / 10] best test accuracy: 91.582 at epoch 6 
 best_stats: {'best_test_epoch': 6, 'best_test_valid/acc': 94.246, 'best_test_valid/acc_unbiased': 96.105, 'best_test_valid/diff': 2.746, 'best_test_valid/acc_skew': 97.478, 'best_test_valid/acc_align': 94.731, 'best_test_test/acc': 89.923, 'best_test_test/acc_unbiased': 91.582, 'best_test_test/diff': 6.686, 'best_test_test/acc_skew': 90.207, 'best_test_test/acc_align': 92.958}
Total training time: 1:33:54
