Log level set to: INFO
Set seed: 2
=======> Using Fixed Random Seed: 2 <========
save_path: exp_results/bc-bb0-celeba_black-crop_test-lr0.001-bs128-cbs64-w0.01-ratio30-aug1-seed2
get_celeba - split:train, aug: False, given_y: True, ratio: 0
use existing black indices from data/celeba/pickles/black
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [60774, 38396]
Target 1: [8027, 15991]
Binary Target 1
---------------------------
Target 0: [60774, 38396]
Target 1: [8027, 15991]
===================================
Normal Label Distribution: 
Target 0: [60774, 38396]
Target 1: [8027, 15991]
===================================
Use BiasedCelebASplit 
 target_attr: black split: train 
 tensor([[60774.,  8027.],
        [38396., 15991.]])
get_celeba - split:train, aug: 1, given_y: True, ratio: 30
use existing black indices from data/celeba/pickles/black
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [60435, 38588]
Target 1: [7963, 16202]
Binary Target 1
---------------------------
Target 0: [60435, 38588]
Target 1: [7963, 16202]
===================================
Normal Label Distribution: 
Target 0: [60435, 38588]
Target 1: [7963, 16202]
===================================
Use BiasedCelebASplit 
 target_attr: black split: train 
 tensor([[60435.,  7963.],
        [38588., 16202.]])
get_celeba - split:train_valid, aug: False, given_y: True, ratio: 0
use existing black indices from data/celeba/pickles/black
Use BiasedCelebASplit 
 target_attr: black split: train_valid 
 tensor([[15020.,  1991.],
        [ 9642.,  4145.]])
get_celeba - split:valid, aug: False, given_y: True, ratio: 0
Use BiasedCelebASplit 
 target_attr: black split: valid 
 tensor([[9752., 1657.],
        [5971., 2487.]])
decay_epochs: [3, 6]
[1 / 10] Learning rate: 0.001 weight: 0.01
[1 / 10] Loss: 4.792988822031057 CE Loss: 0.3072764856318249 Con Loss: 4.789916053516437
[1 / 10] tensor([[0.913, 0.881],
        [0.789, 0.752]]) {'epoch': 1, 'valid/acc': 87.204, 'valid/acc_unbiased': 82.553, 'valid/diff': 4.407, 'valid/acc_skew': 83.889, 'valid/acc_align': 81.217, 'test/acc': 87.316, 'test/acc_unbiased': 83.396, 'test/diff': 3.492, 'test/acc_skew': 83.524, 'test/acc_align': 83.268}
[1 / 10] best valid accuracy: 82.553 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 87.204, 'best_valid_valid/acc_unbiased': 82.553, 'best_valid_valid/diff': 4.407, 'best_valid_valid/acc_skew': 83.889, 'best_valid_valid/acc_align': 81.217, 'best_valid_test/acc': 87.316, 'best_valid_test/acc_unbiased': 83.396, 'best_valid_test/diff': 3.492, 'best_valid_test/acc_skew': 83.524, 'best_valid_test/acc_align': 83.268}
[1 / 10] best test accuracy: 83.396 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 87.204, 'best_test_valid/acc_unbiased': 82.553, 'best_test_valid/diff': 4.407, 'best_test_valid/acc_skew': 83.889, 'best_test_valid/acc_align': 81.217, 'best_test_test/acc': 87.316, 'best_test_test/acc_unbiased': 83.396, 'best_test_test/diff': 3.492, 'best_test_test/acc_skew': 83.524, 'best_test_test/acc_align': 83.268}
[2 / 10] Learning rate: 0.001 weight: 0.01
[2 / 10] Loss: 4.774967296164458 CE Loss: 0.2731688718802628 Con Loss: 4.772235608385008
[2 / 10] tensor([[0.932, 0.883],
        [0.798, 0.815]]) {'epoch': 2, 'valid/acc': 89.022, 'valid/acc_unbiased': 84.768, 'valid/diff': 2.121, 'valid/acc_skew': 83.708, 'valid/acc_align': 85.828, 'test/acc': 89.158, 'test/acc_unbiased': 85.705, 'test/diff': 3.316, 'test/acc_skew': 84.046, 'test/acc_align': 87.363}
[2 / 10] best valid accuracy: 84.768 at epoch 2 
 best_stats: {'best_valid_epoch': 2, 'best_valid_valid/acc': 89.022, 'best_valid_valid/acc_unbiased': 84.768, 'best_valid_valid/diff': 2.121, 'best_valid_valid/acc_skew': 83.708, 'best_valid_valid/acc_align': 85.828, 'best_valid_test/acc': 89.158, 'best_valid_test/acc_unbiased': 85.705, 'best_valid_test/diff': 3.316, 'best_valid_test/acc_skew': 84.046, 'best_valid_test/acc_align': 87.363}
[2 / 10] best test accuracy: 85.705 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 89.022, 'best_test_valid/acc_unbiased': 84.768, 'best_test_valid/diff': 2.121, 'best_test_valid/acc_skew': 83.708, 'best_test_valid/acc_align': 85.828, 'best_test_test/acc': 89.158, 'best_test_test/acc_unbiased': 85.705, 'best_test_test/diff': 3.316, 'best_test_test/acc_skew': 84.046, 'best_test_test/acc_align': 87.363}
[3 / 10] Learning rate: 0.001 weight: 0.01
[3 / 10] Loss: 4.771860637668511 CE Loss: 0.26707105778539225 Con Loss: 4.76918992614709
[3 / 10] tensor([[0.969, 0.955],
        [0.634, 0.562]]) {'epoch': 3, 'valid/acc': 88.619, 'valid/acc_unbiased': 77.798, 'valid/diff': 4.776, 'valid/acc_skew': 79.947, 'valid/acc_align': 75.649, 'test/acc': 88.584, 'test/acc_unbiased': 77.984, 'test/diff': 4.302, 'test/acc_skew': 79.431, 'test/acc_align': 76.538}
[3 / 10] best valid accuracy: 84.768 at epoch 2 
 best_stats: {'best_valid_epoch': 2, 'best_valid_valid/acc': 89.022, 'best_valid_valid/acc_unbiased': 84.768, 'best_valid_valid/diff': 2.121, 'best_valid_valid/acc_skew': 83.708, 'best_valid_valid/acc_align': 85.828, 'best_valid_test/acc': 89.158, 'best_valid_test/acc_unbiased': 85.705, 'best_valid_test/diff': 3.316, 'best_valid_test/acc_skew': 84.046, 'best_valid_test/acc_align': 87.363}
[3 / 10] best test accuracy: 85.705 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 89.022, 'best_test_valid/acc_unbiased': 84.768, 'best_test_valid/diff': 2.121, 'best_test_valid/acc_skew': 83.708, 'best_test_valid/acc_align': 85.828, 'best_test_test/acc': 89.158, 'best_test_test/acc_unbiased': 85.705, 'best_test_test/diff': 3.316, 'best_test_test/acc_skew': 84.046, 'best_test_test/acc_align': 87.363}
[4 / 10] Learning rate: 0.0001 weight: 0.01
[4 / 10] Loss: 4.739966868425254 CE Loss: 0.23520181689083713 Con Loss: 4.737614846714953
[4 / 10] tensor([[0.977, 0.960],
        [0.596, 0.632]]) {'epoch': 4, 'valid/acc': 89.986, 'valid/acc_unbiased': 78.883, 'valid/diff': 1.523, 'valid/acc_skew': 79.064, 'valid/acc_align': 78.702, 'test/acc': 89.717, 'test/acc_unbiased': 79.141, 'test/diff': 2.609, 'test/acc_skew': 77.837, 'test/acc_align': 80.446}
[4 / 10] best valid accuracy: 84.768 at epoch 2 
 best_stats: {'best_valid_epoch': 2, 'best_valid_valid/acc': 89.022, 'best_valid_valid/acc_unbiased': 84.768, 'best_valid_valid/diff': 2.121, 'best_valid_valid/acc_skew': 83.708, 'best_valid_valid/acc_align': 85.828, 'best_valid_test/acc': 89.158, 'best_valid_test/acc_unbiased': 85.705, 'best_valid_test/diff': 3.316, 'best_valid_test/acc_skew': 84.046, 'best_valid_test/acc_align': 87.363}
[4 / 10] best test accuracy: 85.705 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 89.022, 'best_test_valid/acc_unbiased': 84.768, 'best_test_valid/diff': 2.121, 'best_test_valid/acc_skew': 83.708, 'best_test_valid/acc_align': 85.828, 'best_test_test/acc': 89.158, 'best_test_test/acc_unbiased': 85.705, 'best_test_test/diff': 3.316, 'best_test_test/acc_skew': 84.046, 'best_test_test/acc_align': 87.363}
[5 / 10] Learning rate: 0.0001 weight: 0.01
[5 / 10] Loss: 4.732922800184051 CE Loss: 0.22767044957132662 Con Loss: 4.730646103369894
[5 / 10] tensor([[0.956, 0.916],
        [0.762, 0.785]]) {'epoch': 5, 'valid/acc': 90.603, 'valid/acc_unbiased': 84.854, 'valid/diff': 1.854, 'valid/acc_skew': 83.927, 'valid/acc_align': 85.781, 'test/acc': 90.653, 'test/acc_unbiased': 85.489, 'test/diff': 3.112, 'test/acc_skew': 83.933, 'test/acc_align': 87.045}
[5 / 10] best valid accuracy: 84.854 at epoch 5 
 best_stats: {'best_valid_epoch': 5, 'best_valid_valid/acc': 90.603, 'best_valid_valid/acc_unbiased': 84.854, 'best_valid_valid/diff': 1.854, 'best_valid_valid/acc_skew': 83.927, 'best_valid_valid/acc_align': 85.781, 'best_valid_test/acc': 90.653, 'best_valid_test/acc_unbiased': 85.489, 'best_valid_test/diff': 3.112, 'best_valid_test/acc_skew': 83.933, 'best_valid_test/acc_align': 87.045}
[5 / 10] best test accuracy: 85.705 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 89.022, 'best_test_valid/acc_unbiased': 84.768, 'best_test_valid/diff': 2.121, 'best_test_valid/acc_skew': 83.708, 'best_test_valid/acc_align': 85.828, 'best_test_test/acc': 89.158, 'best_test_test/acc_unbiased': 85.705, 'best_test_test/diff': 3.316, 'best_test_test/acc_skew': 84.046, 'best_test_test/acc_align': 87.363}
[6 / 10] Learning rate: 0.0001 weight: 0.01
[6 / 10] Loss: 4.727926218366841 CE Loss: 0.22689119633882934 Con Loss: 4.725657308969102
[6 / 10] tensor([[0.966, 0.946],
        [0.728, 0.715]]) {'epoch': 6, 'valid/acc': 90.769, 'valid/acc_unbiased': 83.111, 'valid/diff': 2.469, 'valid/acc_skew': 83.779, 'valid/acc_align': 82.442, 'test/acc': 90.874, 'test/acc_unbiased': 83.875, 'test/diff': 1.617, 'test/acc_skew': 83.711, 'test/acc_align': 84.039}
[6 / 10] best valid accuracy: 84.854 at epoch 5 
 best_stats: {'best_valid_epoch': 5, 'best_valid_valid/acc': 90.603, 'best_valid_valid/acc_unbiased': 84.854, 'best_valid_valid/diff': 1.854, 'best_valid_valid/acc_skew': 83.927, 'best_valid_valid/acc_align': 85.781, 'best_valid_test/acc': 90.653, 'best_valid_test/acc_unbiased': 85.489, 'best_valid_test/diff': 3.112, 'best_valid_test/acc_skew': 83.933, 'best_valid_test/acc_align': 87.045}
[6 / 10] best test accuracy: 85.705 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 89.022, 'best_test_valid/acc_unbiased': 84.768, 'best_test_valid/diff': 2.121, 'best_test_valid/acc_skew': 83.708, 'best_test_valid/acc_align': 85.828, 'best_test_test/acc': 89.158, 'best_test_test/acc_unbiased': 85.705, 'best_test_test/diff': 3.316, 'best_test_test/acc_skew': 84.046, 'best_test_test/acc_align': 87.363}
[7 / 10] Learning rate: 1e-05 weight: 0.01
[7 / 10] Loss: 4.727824786090501 CE Loss: 0.2217764158895249 Con Loss: 4.725607016498665
[7 / 10] tensor([[0.965, 0.943],
        [0.730, 0.729]]) {'epoch': 7, 'valid/acc': 90.983, 'valid/acc_unbiased': 83.836, 'valid/diff': 2.564, 'valid/acc_skew': 84.294, 'valid/acc_align': 83.379, 'test/acc': 90.91, 'test/acc_unbiased': 84.168, 'test/diff': 1.181, 'test/acc_skew': 83.64, 'test/acc_align': 84.696}
[7 / 10] best valid accuracy: 84.854 at epoch 5 
 best_stats: {'best_valid_epoch': 5, 'best_valid_valid/acc': 90.603, 'best_valid_valid/acc_unbiased': 84.854, 'best_valid_valid/diff': 1.854, 'best_valid_valid/acc_skew': 83.927, 'best_valid_valid/acc_align': 85.781, 'best_valid_test/acc': 90.653, 'best_valid_test/acc_unbiased': 85.489, 'best_valid_test/diff': 3.112, 'best_valid_test/acc_skew': 83.933, 'best_valid_test/acc_align': 87.045}
[7 / 10] best test accuracy: 85.705 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 89.022, 'best_test_valid/acc_unbiased': 84.768, 'best_test_valid/diff': 2.121, 'best_test_valid/acc_skew': 83.708, 'best_test_valid/acc_align': 85.828, 'best_test_test/acc': 89.158, 'best_test_test/acc_unbiased': 85.705, 'best_test_test/diff': 3.316, 'best_test_test/acc_skew': 84.046, 'best_test_test/acc_align': 87.363}
[8 / 10] Learning rate: 1e-05 weight: 0.01
[8 / 10] Loss: 4.723641853284212 CE Loss: 0.21944753673348205 Con Loss: 4.721447379812736
[8 / 10] tensor([[0.965, 0.946],
        [0.742, 0.721]]) {'epoch': 8, 'valid/acc': 91.032, 'valid/acc_unbiased': 83.731, 'valid/diff': 3.155, 'valid/acc_skew': 84.719, 'valid/acc_align': 82.743, 'test/acc': 91.035, 'test/acc_unbiased': 84.356, 'test/diff': 1.993, 'test/acc_skew': 84.397, 'test/acc_align': 84.314}
[8 / 10] best valid accuracy: 84.854 at epoch 5 
 best_stats: {'best_valid_epoch': 5, 'best_valid_valid/acc': 90.603, 'best_valid_valid/acc_unbiased': 84.854, 'best_valid_valid/diff': 1.854, 'best_valid_valid/acc_skew': 83.927, 'best_valid_valid/acc_align': 85.781, 'best_valid_test/acc': 90.653, 'best_valid_test/acc_unbiased': 85.489, 'best_valid_test/diff': 3.112, 'best_valid_test/acc_skew': 83.933, 'best_valid_test/acc_align': 87.045}
[8 / 10] best test accuracy: 85.705 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 89.022, 'best_test_valid/acc_unbiased': 84.768, 'best_test_valid/diff': 2.121, 'best_test_valid/acc_skew': 83.708, 'best_test_valid/acc_align': 85.828, 'best_test_test/acc': 89.158, 'best_test_test/acc_unbiased': 85.705, 'best_test_test/diff': 3.316, 'best_test_test/acc_skew': 84.046, 'best_test_test/acc_align': 87.363}
[9 / 10] Learning rate: 1e-05 weight: 0.01
[9 / 10] Loss: 4.718040143436714 CE Loss: 0.21819687170959445 Con Loss: 4.715858171360638
[9 / 10] tensor([[0.968, 0.947],
        [0.723, 0.719]]) {'epoch': 9, 'valid/acc': 90.983, 'valid/acc_unbiased': 83.306, 'valid/diff': 2.229, 'valid/acc_skew': 83.596, 'valid/acc_align': 83.017, 'test/acc': 91.025, 'test/acc_unbiased': 83.944, 'test/diff': 1.212, 'test/acc_skew': 83.52, 'test/acc_align': 84.367}
[9 / 10] best valid accuracy: 84.854 at epoch 5 
 best_stats: {'best_valid_epoch': 5, 'best_valid_valid/acc': 90.603, 'best_valid_valid/acc_unbiased': 84.854, 'best_valid_valid/diff': 1.854, 'best_valid_valid/acc_skew': 83.927, 'best_valid_valid/acc_align': 85.781, 'best_valid_test/acc': 90.653, 'best_valid_test/acc_unbiased': 85.489, 'best_valid_test/diff': 3.112, 'best_valid_test/acc_skew': 83.933, 'best_valid_test/acc_align': 87.045}
[9 / 10] best test accuracy: 85.705 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 89.022, 'best_test_valid/acc_unbiased': 84.768, 'best_test_valid/diff': 2.121, 'best_test_valid/acc_skew': 83.708, 'best_test_valid/acc_align': 85.828, 'best_test_test/acc': 89.158, 'best_test_test/acc_unbiased': 85.705, 'best_test_test/diff': 3.316, 'best_test_test/acc_skew': 84.046, 'best_test_test/acc_align': 87.363}
[10 / 10] Learning rate: 1e-05 weight: 0.01
[10 / 10] Loss: 4.7242028573335295 CE Loss: 0.2179743372288316 Con Loss: 4.722023113279345
[10 / 10] tensor([[0.965, 0.942],
        [0.737, 0.737]]) {'epoch': 10, 'valid/acc': 91.129, 'valid/acc_unbiased': 84.003, 'valid/diff': 2.176, 'valid/acc_skew': 84.167, 'valid/acc_align': 83.838, 'test/acc': 91.061, 'test/acc_unbiased': 84.518, 'test/diff': 1.185, 'test/acc_skew': 83.938, 'test/acc_align': 85.099}
[10 / 10] best valid accuracy: 84.854 at epoch 5 
 best_stats: {'best_valid_epoch': 5, 'best_valid_valid/acc': 90.603, 'best_valid_valid/acc_unbiased': 84.854, 'best_valid_valid/diff': 1.854, 'best_valid_valid/acc_skew': 83.927, 'best_valid_valid/acc_align': 85.781, 'best_valid_test/acc': 90.653, 'best_valid_test/acc_unbiased': 85.489, 'best_valid_test/diff': 3.112, 'best_valid_test/acc_skew': 83.933, 'best_valid_test/acc_align': 87.045}
[10 / 10] best test accuracy: 85.705 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 89.022, 'best_test_valid/acc_unbiased': 84.768, 'best_test_valid/diff': 2.121, 'best_test_valid/acc_skew': 83.708, 'best_test_valid/acc_align': 85.828, 'best_test_test/acc': 89.158, 'best_test_test/acc_unbiased': 85.705, 'best_test_test/diff': 3.316, 'best_test_test/acc_skew': 84.046, 'best_test_test/acc_align': 87.363}
Total training time: 2:19:40
