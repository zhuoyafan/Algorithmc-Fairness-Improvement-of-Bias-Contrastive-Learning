Log level set to: INFO
Set seed: 2
=======> Using Fixed Random Seed: 2 <========
save_path: exp_results/bc-bb0-utk_face_age-test-0.99-lr0.001-bs128-cbs64-w0.01-ratio10-aug1-seed2
get_utk_face - split: train, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_age-0.99
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [8237, 14]
Target 1: [82, 1477]
Binary Target 1
---------------------------
Target 0: [8237, 14]
Target 1: [82, 1477]
===================================
Normal Label Distribution: 
Target 0: [8237, 14]
Target 1: [82, 1477]
===================================
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [8237, 14]
Target 1: [82, 1477]
Binary Target 1
---------------------------
Target 0: [8237, 14]
Target 1: [82, 1477]
===================================
Normal Label Distribution: 
Target 0: [8237, 14]
Target 1: [82, 1477]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 9810, target_attr: gender, bias_attr: age bias_rate: 0.99
['[train] target_0-bias_0: 8237', '[train] target_0-bias_1: 14', '[train] target_1-bias_0: 82', '[train] target_1-bias_1: 1477']
confusion_matrix - 
 original: tensor([[8237.,   82.],
        [  14., 1477.]]), 
 normalized: tensor([[0.990, 0.010],
        [0.009, 0.991]]), 
 b|y: tensor([[0.998, 0.002],
        [0.053, 0.947]])
get_utk_face - split: train, aug: 1, given_y: True, ratio: 10
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_age-0.99
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [8237, 14]
Target 1: [82, 1477]
Binary Target 1
---------------------------
Target 0: [8237, 14]
Target 1: [82, 1477]
===================================
Normal Label Distribution: 
Target 0: [8237, 14]
Target 1: [82, 1477]
===================================
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [8237, 14]
Target 1: [82, 1477]
Binary Target 1
---------------------------
Target 0: [8237, 14]
Target 1: [82, 1477]
===================================
Normal Label Distribution: 
Target 0: [8237, 14]
Target 1: [82, 1477]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 9810, target_attr: gender, bias_attr: age bias_rate: 0.99
['[train] target_0-bias_0: 8237', '[train] target_0-bias_1: 14', '[train] target_1-bias_0: 82', '[train] target_1-bias_1: 1477']
get_utk_face - split: valid, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_age-0.99
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [1030, 195]
Target 1: [841, 202]
Binary Target 1
---------------------------
Target 0: [1030, 195]
Target 1: [841, 202]
===================================
Normal Label Distribution: 
Target 0: [1030, 195]
Target 1: [841, 202]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 2268, target_attr: gender, bias_attr: age bias_rate: 0.99
['[valid] target_0-bias_0: 1030', '[valid] target_0-bias_1: 195', '[valid] target_1-bias_0: 841', '[valid] target_1-bias_1: 202']
get_utk_face - split: test, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_age-0.99
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [1061, 176]
Target 1: [867, 165]
Binary Target 1
---------------------------
Target 0: [1061, 176]
Target 1: [867, 165]
===================================
Normal Label Distribution: 
Target 0: [1061, 176]
Target 1: [867, 165]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 2269, target_attr: gender, bias_attr: age bias_rate: 0.99
['[test] target_0-bias_0: 1061', '[test] target_0-bias_1: 176', '[test] target_1-bias_0: 867', '[test] target_1-bias_1: 165']
decay_epochs: [6, 13]
[1 / 20] Learning rate: 0.001 weight: 0.01
[1 / 20] Loss: 3.2528982285816492 CE Loss: 0.5251536120393833 Con Loss: 3.2476466744317922
[1 / 20] tensor([[1., 1.],
        [0., 0.]]) {'epoch': 1, 'valid/acc': 54.012, 'valid/acc_unbiased': 50.0, 'valid/diff': 0.0, 'valid/acc_skew': 50.0, 'valid/acc_align': 50.0, 'test/acc': 54.517, 'test/acc_unbiased': 50.0, 'test/diff': 0.0, 'test/acc_skew': 50.0, 'test/acc_align': 50.0}
[1 / 20] best valid accuracy: 50.000 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 54.012, 'best_valid_valid/acc_unbiased': 50.0, 'best_valid_valid/diff': 0.0, 'best_valid_valid/acc_skew': 50.0, 'best_valid_valid/acc_align': 50.0, 'best_valid_test/acc': 54.517, 'best_valid_test/acc_unbiased': 50.0, 'best_valid_test/diff': 0.0, 'best_valid_test/acc_skew': 50.0, 'best_valid_test/acc_align': 50.0}
[1 / 20] best test accuracy: 50.000 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 54.012, 'best_test_valid/acc_unbiased': 50.0, 'best_test_valid/diff': 0.0, 'best_test_valid/acc_skew': 50.0, 'best_test_valid/acc_align': 50.0, 'best_test_test/acc': 54.517, 'best_test_test/acc_unbiased': 50.0, 'best_test_test/diff': 0.0, 'best_test_test/acc_skew': 50.0, 'best_test_test/acc_align': 50.0}
[2 / 20] Learning rate: 0.001 weight: 0.01
[2 / 20] Loss: 2.921799169846874 CE Loss: 0.4670395283037977 Con Loss: 2.9171287844791083
[2 / 20] tensor([[1., 1.],
        [0., 0.]]) {'epoch': 2, 'valid/acc': 54.012, 'valid/acc_unbiased': 50.0, 'valid/diff': 0.0, 'valid/acc_skew': 50.0, 'valid/acc_align': 50.0, 'test/acc': 54.517, 'test/acc_unbiased': 50.0, 'test/diff': 0.0, 'test/acc_skew': 50.0, 'test/acc_align': 50.0}
[2 / 20] best valid accuracy: 50.000 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 54.012, 'best_valid_valid/acc_unbiased': 50.0, 'best_valid_valid/diff': 0.0, 'best_valid_valid/acc_skew': 50.0, 'best_valid_valid/acc_align': 50.0, 'best_valid_test/acc': 54.517, 'best_valid_test/acc_unbiased': 50.0, 'best_valid_test/diff': 0.0, 'best_valid_test/acc_skew': 50.0, 'best_valid_test/acc_align': 50.0}
[2 / 20] best test accuracy: 50.000 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 54.012, 'best_test_valid/acc_unbiased': 50.0, 'best_test_valid/diff': 0.0, 'best_test_valid/acc_skew': 50.0, 'best_test_valid/acc_align': 50.0, 'best_test_test/acc': 54.517, 'best_test_test/acc_unbiased': 50.0, 'best_test_test/diff': 0.0, 'best_test_test/acc_skew': 50.0, 'best_test_test/acc_align': 50.0}
[3 / 20] Learning rate: 0.001 weight: 0.01
[3 / 20] Loss: 3.013108668779379 CE Loss: 0.4804963473697686 Con Loss: 3.008303711975751
[3 / 20] tensor([[1., 1.],
        [0., 0.]]) {'epoch': 3, 'valid/acc': 54.012, 'valid/acc_unbiased': 50.0, 'valid/diff': 0.0, 'valid/acc_skew': 50.0, 'valid/acc_align': 50.0, 'test/acc': 54.517, 'test/acc_unbiased': 50.0, 'test/diff': 0.0, 'test/acc_skew': 50.0, 'test/acc_align': 50.0}
[3 / 20] best valid accuracy: 50.000 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 54.012, 'best_valid_valid/acc_unbiased': 50.0, 'best_valid_valid/diff': 0.0, 'best_valid_valid/acc_skew': 50.0, 'best_valid_valid/acc_align': 50.0, 'best_valid_test/acc': 54.517, 'best_valid_test/acc_unbiased': 50.0, 'best_valid_test/diff': 0.0, 'best_valid_test/acc_skew': 50.0, 'best_valid_test/acc_align': 50.0}
[3 / 20] best test accuracy: 50.000 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 54.012, 'best_test_valid/acc_unbiased': 50.0, 'best_test_valid/diff': 0.0, 'best_test_valid/acc_skew': 50.0, 'best_test_valid/acc_align': 50.0, 'best_test_test/acc': 54.517, 'best_test_test/acc_unbiased': 50.0, 'best_test_test/diff': 0.0, 'best_test_test/acc_skew': 50.0, 'best_test_test/acc_align': 50.0}
[4 / 20] Learning rate: 0.001 weight: 0.01
[4 / 20] Loss: 2.893243776937751 CE Loss: 0.48043616837560826 Con Loss: 2.888439405754315
[4 / 20] tensor([[1., 1.],
        [0., 0.]]) {'epoch': 4, 'valid/acc': 54.012, 'valid/acc_unbiased': 50.0, 'valid/diff': 0.0, 'valid/acc_skew': 50.0, 'valid/acc_align': 50.0, 'test/acc': 54.517, 'test/acc_unbiased': 50.0, 'test/diff': 0.0, 'test/acc_skew': 50.0, 'test/acc_align': 50.0}
[4 / 20] best valid accuracy: 50.000 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 54.012, 'best_valid_valid/acc_unbiased': 50.0, 'best_valid_valid/diff': 0.0, 'best_valid_valid/acc_skew': 50.0, 'best_valid_valid/acc_align': 50.0, 'best_valid_test/acc': 54.517, 'best_valid_test/acc_unbiased': 50.0, 'best_valid_test/diff': 0.0, 'best_valid_test/acc_skew': 50.0, 'best_valid_test/acc_align': 50.0}
[4 / 20] best test accuracy: 50.000 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 54.012, 'best_test_valid/acc_unbiased': 50.0, 'best_test_valid/diff': 0.0, 'best_test_valid/acc_skew': 50.0, 'best_test_valid/acc_align': 50.0, 'best_test_test/acc': 54.517, 'best_test_test/acc_unbiased': 50.0, 'best_test_test/diff': 0.0, 'best_test_test/acc_skew': 50.0, 'best_test_test/acc_align': 50.0}
[5 / 20] Learning rate: 0.001 weight: 0.01
[5 / 20] Loss: 3.0900278735962847 CE Loss: 0.4823006720717894 Con Loss: 3.0852048522956994
[5 / 20] tensor([[0.923, 0.835],
        [0.318, 0.230]]) {'epoch': 5, 'valid/acc': 62.831, 'valid/acc_unbiased': 56.824, 'valid/diff': 11.318, 'valid/acc_skew': 57.476, 'valid/acc_align': 56.173, 'test/acc': 63.464, 'test/acc_unbiased': 57.665, 'test/diff': 8.776, 'test/acc_skew': 57.678, 'test/acc_align': 57.651}
[5 / 20] best valid accuracy: 56.824 at epoch 5 
 best_stats: {'best_valid_epoch': 5, 'best_valid_valid/acc': 62.831, 'best_valid_valid/acc_unbiased': 56.824, 'best_valid_valid/diff': 11.318, 'best_valid_valid/acc_skew': 57.476, 'best_valid_valid/acc_align': 56.173, 'best_valid_test/acc': 63.464, 'best_valid_test/acc_unbiased': 57.665, 'best_valid_test/diff': 8.776, 'best_valid_test/acc_skew': 57.678, 'best_valid_test/acc_align': 57.651}
[5 / 20] best test accuracy: 57.665 at epoch 5 
 best_stats: {'best_test_epoch': 5, 'best_test_valid/acc': 62.831, 'best_test_valid/acc_unbiased': 56.824, 'best_test_valid/diff': 11.318, 'best_test_valid/acc_skew': 57.476, 'best_test_valid/acc_align': 56.173, 'best_test_test/acc': 63.464, 'best_test_test/acc_unbiased': 57.665, 'best_test_test/diff': 8.776, 'best_test_test/acc_skew': 57.678, 'best_test_test/acc_align': 57.651}
[6 / 20] Learning rate: 0.001 weight: 0.01
[6 / 20] Loss: 2.679392786735667 CE Loss: 0.48540132361693 Con Loss: 2.6745387597429158
[6 / 20] tensor([[1., 1.],
        [0., 0.]]) {'epoch': 6, 'valid/acc': 54.012, 'valid/acc_unbiased': 50.0, 'valid/diff': 0.0, 'valid/acc_skew': 50.0, 'valid/acc_align': 50.0, 'test/acc': 54.517, 'test/acc_unbiased': 50.0, 'test/diff': 0.0, 'test/acc_skew': 50.0, 'test/acc_align': 50.0}
[6 / 20] best valid accuracy: 56.824 at epoch 5 
 best_stats: {'best_valid_epoch': 5, 'best_valid_valid/acc': 62.831, 'best_valid_valid/acc_unbiased': 56.824, 'best_valid_valid/diff': 11.318, 'best_valid_valid/acc_skew': 57.476, 'best_valid_valid/acc_align': 56.173, 'best_valid_test/acc': 63.464, 'best_valid_test/acc_unbiased': 57.665, 'best_valid_test/diff': 8.776, 'best_valid_test/acc_skew': 57.678, 'best_valid_test/acc_align': 57.651}
[6 / 20] best test accuracy: 57.665 at epoch 5 
 best_stats: {'best_test_epoch': 5, 'best_test_valid/acc': 62.831, 'best_test_valid/acc_unbiased': 56.824, 'best_test_valid/diff': 11.318, 'best_test_valid/acc_skew': 57.476, 'best_test_valid/acc_align': 56.173, 'best_test_test/acc': 63.464, 'best_test_test/acc_unbiased': 57.665, 'best_test_test/diff': 8.776, 'best_test_test/acc_skew': 57.678, 'best_test_test/acc_align': 57.651}
[7 / 20] Learning rate: 0.0001 weight: 0.01
[7 / 20] Loss: 2.92389704321381 CE Loss: 0.48246955937201824 Con Loss: 2.9190723468525817
[7 / 20] tensor([[1., 1.],
        [0., 0.]]) {'epoch': 7, 'valid/acc': 54.012, 'valid/acc_unbiased': 50.0, 'valid/diff': 0.0, 'valid/acc_skew': 50.0, 'valid/acc_align': 50.0, 'test/acc': 54.517, 'test/acc_unbiased': 50.0, 'test/diff': 0.0, 'test/acc_skew': 50.0, 'test/acc_align': 50.0}
[7 / 20] best valid accuracy: 56.824 at epoch 5 
 best_stats: {'best_valid_epoch': 5, 'best_valid_valid/acc': 62.831, 'best_valid_valid/acc_unbiased': 56.824, 'best_valid_valid/diff': 11.318, 'best_valid_valid/acc_skew': 57.476, 'best_valid_valid/acc_align': 56.173, 'best_valid_test/acc': 63.464, 'best_valid_test/acc_unbiased': 57.665, 'best_valid_test/diff': 8.776, 'best_valid_test/acc_skew': 57.678, 'best_valid_test/acc_align': 57.651}
[7 / 20] best test accuracy: 57.665 at epoch 5 
 best_stats: {'best_test_epoch': 5, 'best_test_valid/acc': 62.831, 'best_test_valid/acc_unbiased': 56.824, 'best_test_valid/diff': 11.318, 'best_test_valid/acc_skew': 57.476, 'best_test_valid/acc_align': 56.173, 'best_test_test/acc': 63.464, 'best_test_test/acc_unbiased': 57.665, 'best_test_test/diff': 8.776, 'best_test_test/acc_skew': 57.678, 'best_test_test/acc_align': 57.651}
[8 / 20] Learning rate: 0.0001 weight: 0.01
[8 / 20] Loss: 2.5312291053943072 CE Loss: 0.47224474991619525 Con Loss: 2.5265066667920344
[8 / 20] tensor([[1., 1.],
        [0., 0.]]) {'epoch': 8, 'valid/acc': 54.012, 'valid/acc_unbiased': 50.0, 'valid/diff': 0.0, 'valid/acc_skew': 50.0, 'valid/acc_align': 50.0, 'test/acc': 54.517, 'test/acc_unbiased': 50.0, 'test/diff': 0.0, 'test/acc_skew': 50.0, 'test/acc_align': 50.0}
[8 / 20] best valid accuracy: 56.824 at epoch 5 
 best_stats: {'best_valid_epoch': 5, 'best_valid_valid/acc': 62.831, 'best_valid_valid/acc_unbiased': 56.824, 'best_valid_valid/diff': 11.318, 'best_valid_valid/acc_skew': 57.476, 'best_valid_valid/acc_align': 56.173, 'best_valid_test/acc': 63.464, 'best_valid_test/acc_unbiased': 57.665, 'best_valid_test/diff': 8.776, 'best_valid_test/acc_skew': 57.678, 'best_valid_test/acc_align': 57.651}
[8 / 20] best test accuracy: 57.665 at epoch 5 
 best_stats: {'best_test_epoch': 5, 'best_test_valid/acc': 62.831, 'best_test_valid/acc_unbiased': 56.824, 'best_test_valid/diff': 11.318, 'best_test_valid/acc_skew': 57.476, 'best_test_valid/acc_align': 56.173, 'best_test_test/acc': 63.464, 'best_test_test/acc_unbiased': 57.665, 'best_test_test/diff': 8.776, 'best_test_test/acc_skew': 57.678, 'best_test_test/acc_align': 57.651}
[9 / 20] Learning rate: 0.0001 weight: 0.01
[9 / 20] Loss: 2.4605032298603797 CE Loss: 0.4734192175724212 Con Loss: 2.4557690304475215
[9 / 20] tensor([[0.985, 0.994],
        [0.040, 0.030]]) {'epoch': 9, 'valid/acc': 55.247, 'valid/acc_unbiased': 51.073, 'valid/diff': 1.208, 'valid/acc_skew': 51.49, 'valid/acc_align': 50.655, 'test/acc': 55.531, 'test/acc_unbiased': 51.248, 'test/diff': 0.973, 'test/acc_skew': 51.734, 'test/acc_align': 50.761}
[9 / 20] best valid accuracy: 56.824 at epoch 5 
 best_stats: {'best_valid_epoch': 5, 'best_valid_valid/acc': 62.831, 'best_valid_valid/acc_unbiased': 56.824, 'best_valid_valid/diff': 11.318, 'best_valid_valid/acc_skew': 57.476, 'best_valid_valid/acc_align': 56.173, 'best_valid_test/acc': 63.464, 'best_valid_test/acc_unbiased': 57.665, 'best_valid_test/diff': 8.776, 'best_valid_test/acc_skew': 57.678, 'best_valid_test/acc_align': 57.651}
[9 / 20] best test accuracy: 57.665 at epoch 5 
 best_stats: {'best_test_epoch': 5, 'best_test_valid/acc': 62.831, 'best_test_valid/acc_unbiased': 56.824, 'best_test_valid/diff': 11.318, 'best_test_valid/acc_skew': 57.476, 'best_test_valid/acc_align': 56.173, 'best_test_test/acc': 63.464, 'best_test_test/acc_unbiased': 57.665, 'best_test_test/diff': 8.776, 'best_test_test/acc_skew': 57.678, 'best_test_test/acc_align': 57.651}
[10 / 20] Learning rate: 0.0001 weight: 0.01
[10 / 20] Loss: 2.898427798283817 CE Loss: 0.4716813739772723 Con Loss: 2.8937109672087535
[10 / 20] tensor([[0.997, 0.994],
        [0.008, 0.006]]) {'epoch': 10, 'valid/acc': 54.277, 'valid/acc_unbiased': 50.185, 'valid/diff': 0.387, 'valid/acc_skew': 50.219, 'valid/acc_align': 50.15, 'test/acc': 54.694, 'test/acc_unbiased': 50.141, 'test/diff': 0.243, 'test/acc_skew': 50.12, 'test/acc_align': 50.162}
[10 / 20] best valid accuracy: 56.824 at epoch 5 
 best_stats: {'best_valid_epoch': 5, 'best_valid_valid/acc': 62.831, 'best_valid_valid/acc_unbiased': 56.824, 'best_valid_valid/diff': 11.318, 'best_valid_valid/acc_skew': 57.476, 'best_valid_valid/acc_align': 56.173, 'best_valid_test/acc': 63.464, 'best_valid_test/acc_unbiased': 57.665, 'best_valid_test/diff': 8.776, 'best_valid_test/acc_skew': 57.678, 'best_valid_test/acc_align': 57.651}
[10 / 20] best test accuracy: 57.665 at epoch 5 
 best_stats: {'best_test_epoch': 5, 'best_test_valid/acc': 62.831, 'best_test_valid/acc_unbiased': 56.824, 'best_test_valid/diff': 11.318, 'best_test_valid/acc_skew': 57.476, 'best_test_valid/acc_align': 56.173, 'best_test_test/acc': 63.464, 'best_test_test/acc_unbiased': 57.665, 'best_test_test/diff': 8.776, 'best_test_test/acc_skew': 57.678, 'best_test_test/acc_align': 57.651}
[11 / 20] Learning rate: 0.0001 weight: 0.01
[11 / 20] Loss: 2.6717064145872715 CE Loss: 0.4695542761917387 Con Loss: 2.667010883988469
[11 / 20] tensor([[0.978, 0.915],
        [0.121, 0.091]]) {'epoch': 11, 'valid/acc': 57.319, 'valid/acc_unbiased': 52.427, 'valid/diff': 4.29, 'valid/acc_skew': 50.282, 'valid/acc_align': 54.572, 'test/acc': 58.131, 'test/acc_unbiased': 52.628, 'test/diff': 4.687, 'test/acc_skew': 51.794, 'test/acc_align': 53.462}
[11 / 20] best valid accuracy: 56.824 at epoch 5 
 best_stats: {'best_valid_epoch': 5, 'best_valid_valid/acc': 62.831, 'best_valid_valid/acc_unbiased': 56.824, 'best_valid_valid/diff': 11.318, 'best_valid_valid/acc_skew': 57.476, 'best_valid_valid/acc_align': 56.173, 'best_valid_test/acc': 63.464, 'best_valid_test/acc_unbiased': 57.665, 'best_valid_test/diff': 8.776, 'best_valid_test/acc_skew': 57.678, 'best_valid_test/acc_align': 57.651}
[11 / 20] best test accuracy: 57.665 at epoch 5 
 best_stats: {'best_test_epoch': 5, 'best_test_valid/acc': 62.831, 'best_test_valid/acc_unbiased': 56.824, 'best_test_valid/diff': 11.318, 'best_test_valid/acc_skew': 57.476, 'best_test_valid/acc_align': 56.173, 'best_test_test/acc': 63.464, 'best_test_test/acc_unbiased': 57.665, 'best_test_test/diff': 8.776, 'best_test_test/acc_skew': 57.678, 'best_test_test/acc_align': 57.651}
[12 / 20] Learning rate: 0.0001 weight: 0.01
[12 / 20] Loss: 2.3809290321109007 CE Loss: 0.4565287653216285 Con Loss: 2.3763637474674453
[12 / 20] tensor([[0.962, 0.892],
        [0.182, 0.212]]) {'epoch': 12, 'valid/acc': 59.568, 'valid/acc_unbiased': 54.487, 'valid/diff': 6.006, 'valid/acc_skew': 52.155, 'valid/acc_align': 56.819, 'test/acc': 60.423, 'test/acc_unbiased': 56.218, 'test/diff': 5.007, 'test/acc_skew': 53.714, 'test/acc_align': 58.721}
[12 / 20] best valid accuracy: 56.824 at epoch 5 
 best_stats: {'best_valid_epoch': 5, 'best_valid_valid/acc': 62.831, 'best_valid_valid/acc_unbiased': 56.824, 'best_valid_valid/diff': 11.318, 'best_valid_valid/acc_skew': 57.476, 'best_valid_valid/acc_align': 56.173, 'best_valid_test/acc': 63.464, 'best_valid_test/acc_unbiased': 57.665, 'best_valid_test/diff': 8.776, 'best_valid_test/acc_skew': 57.678, 'best_valid_test/acc_align': 57.651}
[12 / 20] best test accuracy: 57.665 at epoch 5 
 best_stats: {'best_test_epoch': 5, 'best_test_valid/acc': 62.831, 'best_test_valid/acc_unbiased': 56.824, 'best_test_valid/diff': 11.318, 'best_test_valid/acc_skew': 57.476, 'best_test_valid/acc_align': 56.173, 'best_test_test/acc': 63.464, 'best_test_test/acc_unbiased': 57.665, 'best_test_test/diff': 8.776, 'best_test_test/acc_skew': 57.678, 'best_test_test/acc_align': 57.651}
[13 / 20] Learning rate: 0.0001 weight: 0.01
[13 / 20] Loss: 2.5708867727859546 CE Loss: 0.4383972688066364 Con Loss: 2.566502782110045
[13 / 20] tensor([[0.949, 0.835],
        [0.245, 0.297]]) {'epoch': 13, 'valid/acc': 61.861, 'valid/acc_unbiased': 55.626, 'valid/diff': 10.407, 'valid/acc_skew': 53.492, 'valid/acc_align': 57.76, 'test/acc': 62.362, 'test/acc_unbiased': 58.146, 'test/diff': 8.316, 'test/acc_skew': 53.987, 'test/acc_align': 62.304}
[13 / 20] best valid accuracy: 56.824 at epoch 5 
 best_stats: {'best_valid_epoch': 5, 'best_valid_valid/acc': 62.831, 'best_valid_valid/acc_unbiased': 56.824, 'best_valid_valid/diff': 11.318, 'best_valid_valid/acc_skew': 57.476, 'best_valid_valid/acc_align': 56.173, 'best_valid_test/acc': 63.464, 'best_valid_test/acc_unbiased': 57.665, 'best_valid_test/diff': 8.776, 'best_valid_test/acc_skew': 57.678, 'best_valid_test/acc_align': 57.651}
[13 / 20] best test accuracy: 58.146 at epoch 13 
 best_stats: {'best_test_epoch': 13, 'best_test_valid/acc': 61.861, 'best_test_valid/acc_unbiased': 55.626, 'best_test_valid/diff': 10.407, 'best_test_valid/acc_skew': 53.492, 'best_test_valid/acc_align': 57.76, 'best_test_test/acc': 62.362, 'best_test_test/acc_unbiased': 58.146, 'best_test_test/diff': 8.316, 'best_test_test/acc_skew': 53.987, 'best_test_test/acc_align': 62.304}
[14 / 20] Learning rate: 1e-05 weight: 0.01
[14 / 20] Loss: 2.3909283070996876 CE Loss: 0.4726582254838506 Con Loss: 2.386201718774654
[14 / 20] tensor([[0.961, 0.795],
        [0.292, 0.370]]) {'epoch': 14, 'valid/acc': 63.889, 'valid/acc_unbiased': 58.075, 'valid/diff': 9.4, 'valid/acc_skew': 54.585, 'valid/acc_align': 61.565, 'test/acc': 64.963, 'test/acc_unbiased': 60.458, 'test/diff': 12.189, 'test/acc_skew': 54.363, 'test/acc_align': 66.553}
[14 / 20] best valid accuracy: 58.075 at epoch 14 
 best_stats: {'best_valid_epoch': 14, 'best_valid_valid/acc': 63.889, 'best_valid_valid/acc_unbiased': 58.075, 'best_valid_valid/diff': 9.4, 'best_valid_valid/acc_skew': 54.585, 'best_valid_valid/acc_align': 61.565, 'best_valid_test/acc': 64.963, 'best_valid_test/acc_unbiased': 60.458, 'best_valid_test/diff': 12.189, 'best_valid_test/acc_skew': 54.363, 'best_valid_test/acc_align': 66.553}
[14 / 20] best test accuracy: 60.458 at epoch 14 
 best_stats: {'best_test_epoch': 14, 'best_test_valid/acc': 63.889, 'best_test_valid/acc_unbiased': 58.075, 'best_test_valid/diff': 9.4, 'best_test_valid/acc_skew': 54.585, 'best_test_valid/acc_align': 61.565, 'best_test_test/acc': 64.963, 'best_test_test/acc_unbiased': 60.458, 'best_test_test/diff': 12.189, 'best_test_test/acc_skew': 54.363, 'best_test_test/acc_align': 66.553}
[15 / 20] Learning rate: 1e-05 weight: 0.01
[15 / 20] Loss: 2.8043814722794154 CE Loss: 0.4576541780939404 Con Loss: 2.799804933878017
[15 / 20] tensor([[0.966, 0.824],
        [0.273, 0.309]]) {'epoch': 15, 'valid/acc': 62.566, 'valid/acc_unbiased': 57.49, 'valid/diff': 6.602, 'valid/acc_skew': 54.555, 'valid/acc_align': 60.425, 'test/acc': 64.257, 'test/acc_unbiased': 59.31, 'test/diff': 8.897, 'test/acc_skew': 54.861, 'test/acc_align': 63.758}
[15 / 20] best valid accuracy: 58.075 at epoch 14 
 best_stats: {'best_valid_epoch': 14, 'best_valid_valid/acc': 63.889, 'best_valid_valid/acc_unbiased': 58.075, 'best_valid_valid/diff': 9.4, 'best_valid_valid/acc_skew': 54.585, 'best_valid_valid/acc_align': 61.565, 'best_valid_test/acc': 64.963, 'best_valid_test/acc_unbiased': 60.458, 'best_valid_test/diff': 12.189, 'best_valid_test/acc_skew': 54.363, 'best_valid_test/acc_align': 66.553}
[15 / 20] best test accuracy: 60.458 at epoch 14 
 best_stats: {'best_test_epoch': 14, 'best_test_valid/acc': 63.889, 'best_test_valid/acc_unbiased': 58.075, 'best_test_valid/diff': 9.4, 'best_test_valid/acc_skew': 54.585, 'best_test_valid/acc_align': 61.565, 'best_test_test/acc': 64.963, 'best_test_test/acc_unbiased': 60.458, 'best_test_test/diff': 12.189, 'best_test_test/acc_skew': 54.363, 'best_test_test/acc_align': 66.553}
[16 / 20] Learning rate: 1e-05 weight: 0.01
[16 / 20] Loss: 2.6532794453925193 CE Loss: 0.4468867077071611 Con Loss: 2.6488105997276112
[16 / 20] tensor([[0.964, 0.818],
        [0.278, 0.345]]) {'epoch': 16, 'valid/acc': 63.139, 'valid/acc_unbiased': 57.767, 'valid/diff': 7.757, 'valid/acc_skew': 53.968, 'valid/acc_align': 61.565, 'test/acc': 64.566, 'test/acc_unbiased': 60.145, 'test/diff': 10.674, 'test/acc_skew': 54.808, 'test/acc_align': 65.482}
[16 / 20] best valid accuracy: 58.075 at epoch 14 
 best_stats: {'best_valid_epoch': 14, 'best_valid_valid/acc': 63.889, 'best_valid_valid/acc_unbiased': 58.075, 'best_valid_valid/diff': 9.4, 'best_valid_valid/acc_skew': 54.585, 'best_valid_valid/acc_align': 61.565, 'best_valid_test/acc': 64.963, 'best_valid_test/acc_unbiased': 60.458, 'best_valid_test/diff': 12.189, 'best_valid_test/acc_skew': 54.363, 'best_valid_test/acc_align': 66.553}
[16 / 20] best test accuracy: 60.458 at epoch 14 
 best_stats: {'best_test_epoch': 14, 'best_test_valid/acc': 63.889, 'best_test_valid/acc_unbiased': 58.075, 'best_test_valid/diff': 9.4, 'best_test_valid/acc_skew': 54.585, 'best_test_valid/acc_align': 61.565, 'best_test_test/acc': 64.963, 'best_test_test/acc_unbiased': 60.458, 'best_test_test/diff': 12.189, 'best_test_test/acc_skew': 54.363, 'best_test_test/acc_align': 66.553}
[17 / 20] Learning rate: 1e-05 weight: 0.01
[17 / 20] Loss: 2.443724385241121 CE Loss: 0.4432928926840227 Con Loss: 2.4392914607741174
[17 / 20] tensor([[0.957, 0.795],
        [0.311, 0.388]]) {'epoch': 17, 'valid/acc': 64.33, 'valid/acc_unbiased': 58.838, 'valid/diff': 8.468, 'valid/acc_skew': 54.625, 'valid/acc_align': 63.051, 'test/acc': 65.624, 'test/acc_unbiased': 61.285, 'test/diff': 11.883, 'test/acc_skew': 55.344, 'test/acc_align': 67.226}
[17 / 20] best valid accuracy: 58.838 at epoch 17 
 best_stats: {'best_valid_epoch': 17, 'best_valid_valid/acc': 64.33, 'best_valid_valid/acc_unbiased': 58.838, 'best_valid_valid/diff': 8.468, 'best_valid_valid/acc_skew': 54.625, 'best_valid_valid/acc_align': 63.051, 'best_valid_test/acc': 65.624, 'best_valid_test/acc_unbiased': 61.285, 'best_valid_test/diff': 11.883, 'best_valid_test/acc_skew': 55.344, 'best_valid_test/acc_align': 67.226}
[17 / 20] best test accuracy: 61.285 at epoch 17 
 best_stats: {'best_test_epoch': 17, 'best_test_valid/acc': 64.33, 'best_test_valid/acc_unbiased': 58.838, 'best_test_valid/diff': 8.468, 'best_test_valid/acc_skew': 54.625, 'best_test_valid/acc_align': 63.051, 'best_test_test/acc': 65.624, 'best_test_test/acc_unbiased': 61.285, 'best_test_test/diff': 11.883, 'best_test_test/acc_skew': 55.344, 'best_test_test/acc_align': 67.226}
[18 / 20] Learning rate: 1e-05 weight: 0.01
[18 / 20] Loss: 2.7091415272575636 CE Loss: 0.4358943572224219 Con Loss: 2.704782572264093
[18 / 20] tensor([[0.971, 0.835],
        [0.260, 0.315]]) {'epoch': 18, 'valid/acc': 63.007, 'valid/acc_unbiased': 57.751, 'valid/diff': 7.072, 'valid/acc_skew': 55.384, 'valid/acc_align': 60.119, 'test/acc': 64.081, 'test/acc_unbiased': 59.517, 'test/diff': 9.56, 'test/acc_skew': 54.737, 'test/acc_align': 64.297}
[18 / 20] best valid accuracy: 58.838 at epoch 17 
 best_stats: {'best_valid_epoch': 17, 'best_valid_valid/acc': 64.33, 'best_valid_valid/acc_unbiased': 58.838, 'best_valid_valid/diff': 8.468, 'best_valid_valid/acc_skew': 54.625, 'best_valid_valid/acc_align': 63.051, 'best_valid_test/acc': 65.624, 'best_valid_test/acc_unbiased': 61.285, 'best_valid_test/diff': 11.883, 'best_valid_test/acc_skew': 55.344, 'best_valid_test/acc_align': 67.226}
[18 / 20] best test accuracy: 61.285 at epoch 17 
 best_stats: {'best_test_epoch': 17, 'best_test_valid/acc': 64.33, 'best_test_valid/acc_unbiased': 58.838, 'best_test_valid/diff': 8.468, 'best_test_valid/acc_skew': 54.625, 'best_test_valid/acc_align': 63.051, 'best_test_test/acc': 65.624, 'best_test_test/acc_unbiased': 61.285, 'best_test_test/diff': 11.883, 'best_test_test/acc_skew': 55.344, 'best_test_test/acc_align': 67.226}
[19 / 20] Learning rate: 1e-05 weight: 0.01
[19 / 20] Loss: 2.7915491087964064 CE Loss: 0.443264061060642 Con Loss: 2.7871164494455165
[19 / 20] tensor([[0.962, 0.807],
        [0.295, 0.352]]) {'epoch': 19, 'valid/acc': 63.933, 'valid/acc_unbiased': 58.369, 'valid/diff': 8.486, 'valid/acc_skew': 54.484, 'valid/acc_align': 62.255, 'test/acc': 65.095, 'test/acc_unbiased': 60.398, 'test/diff': 10.586, 'test/acc_skew': 55.104, 'test/acc_align': 65.691}
[19 / 20] best valid accuracy: 58.838 at epoch 17 
 best_stats: {'best_valid_epoch': 17, 'best_valid_valid/acc': 64.33, 'best_valid_valid/acc_unbiased': 58.838, 'best_valid_valid/diff': 8.468, 'best_valid_valid/acc_skew': 54.625, 'best_valid_valid/acc_align': 63.051, 'best_valid_test/acc': 65.624, 'best_valid_test/acc_unbiased': 61.285, 'best_valid_test/diff': 11.883, 'best_valid_test/acc_skew': 55.344, 'best_valid_test/acc_align': 67.226}
[19 / 20] best test accuracy: 61.285 at epoch 17 
 best_stats: {'best_test_epoch': 17, 'best_test_valid/acc': 64.33, 'best_test_valid/acc_unbiased': 58.838, 'best_test_valid/diff': 8.468, 'best_test_valid/acc_skew': 54.625, 'best_test_valid/acc_align': 63.051, 'best_test_test/acc': 65.624, 'best_test_test/acc_unbiased': 61.285, 'best_test_test/diff': 11.883, 'best_test_test/acc_skew': 55.344, 'best_test_test/acc_align': 67.226}
[20 / 20] Learning rate: 1e-05 weight: 0.01
[20 / 20] Loss: 2.5329337851109246 CE Loss: 0.4415043957918791 Con Loss: 2.5285187166157606
[20 / 20] tensor([[0.972, 0.795],
        [0.292, 0.376]]) {'epoch': 20, 'valid/acc': 63.492, 'valid/acc_unbiased': 57.768, 'valid/diff': 8.768, 'valid/acc_skew': 53.83, 'valid/acc_align': 61.706, 'test/acc': 65.491, 'test/acc_unbiased': 60.869, 'test/diff': 13.011, 'test/acc_skew': 54.363, 'test/acc_align': 67.374}
[20 / 20] best valid accuracy: 58.838 at epoch 17 
 best_stats: {'best_valid_epoch': 17, 'best_valid_valid/acc': 64.33, 'best_valid_valid/acc_unbiased': 58.838, 'best_valid_valid/diff': 8.468, 'best_valid_valid/acc_skew': 54.625, 'best_valid_valid/acc_align': 63.051, 'best_valid_test/acc': 65.624, 'best_valid_test/acc_unbiased': 61.285, 'best_valid_test/diff': 11.883, 'best_valid_test/acc_skew': 55.344, 'best_valid_test/acc_align': 67.226}
[20 / 20] best test accuracy: 61.285 at epoch 17 
 best_stats: {'best_test_epoch': 17, 'best_test_valid/acc': 64.33, 'best_test_valid/acc_unbiased': 58.838, 'best_test_valid/diff': 8.468, 'best_test_valid/acc_skew': 54.625, 'best_test_valid/acc_align': 63.051, 'best_test_test/acc': 65.624, 'best_test_test/acc_unbiased': 61.285, 'best_test_test/diff': 11.883, 'best_test_test/acc_skew': 55.344, 'best_test_test/acc_align': 67.226}
Total training time: 0:31:46
