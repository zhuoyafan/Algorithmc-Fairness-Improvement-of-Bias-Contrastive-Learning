Log level set to: INFO
Set seed: 2
=======> Using Fixed Random Seed: 2 <========
save_path: exp_results/bc-bb0-utk_face_race-rotate-0.9-lr0.001-bs128-cbs64-w0.01-ratio10-aug1-seed2
get_utk_face - split: train, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_race-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [4407, 552]
Target 1: [440, 5529]
Binary Target 1
---------------------------
Target 0: [4407, 552]
Target 1: [440, 5529]
===================================
Normal Label Distribution: 
Target 0: [4407, 552]
Target 1: [440, 5529]
===================================
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [4407, 552]
Target 1: [440, 5529]
Binary Target 1
---------------------------
Target 0: [4407, 552]
Target 1: [440, 5529]
===================================
Normal Label Distribution: 
Target 0: [4407, 552]
Target 1: [440, 5529]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 10928, target_attr: gender, bias_attr: race bias_rate: 0.9
['[train] target_0-bias_0: 4407', '[train] target_0-bias_1: 552', '[train] target_1-bias_0: 440', '[train] target_1-bias_1: 5529']
confusion_matrix - 
 original: tensor([[4407.,  440.],
        [ 552., 5529.]]), 
 normalized: tensor([[0.909, 0.091],
        [0.091, 0.909]]), 
 b|y: tensor([[0.889, 0.111],
        [0.074, 0.926]])
get_utk_face - split: train, aug: 1, given_y: True, ratio: 10
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_race-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [4407, 552]
Target 1: [440, 5529]
Binary Target 1
---------------------------
Target 0: [4407, 552]
Target 1: [440, 5529]
===================================
Normal Label Distribution: 
Target 0: [4407, 552]
Target 1: [440, 5529]
===================================
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [4407, 552]
Target 1: [440, 5529]
Binary Target 1
---------------------------
Target 0: [4407, 552]
Target 1: [440, 5529]
===================================
Normal Label Distribution: 
Target 0: [4407, 552]
Target 1: [440, 5529]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 10928, target_attr: gender, bias_attr: race bias_rate: 0.9
['[train] target_0-bias_0: 4407', '[train] target_0-bias_1: 552', '[train] target_1-bias_0: 440', '[train] target_1-bias_1: 5529']
get_utk_face - split: valid, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_race-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [583, 684]
Target 1: [457, 646]
Binary Target 1
---------------------------
Target 0: [583, 684]
Target 1: [457, 646]
===================================
Normal Label Distribution: 
Target 0: [583, 684]
Target 1: [457, 646]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 2370, target_attr: gender, bias_attr: race bias_rate: 0.9
['[valid] target_0-bias_0: 583', '[valid] target_0-bias_1: 684', '[valid] target_1-bias_0: 457', '[valid] target_1-bias_1: 646']
get_utk_face - split: test, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_race-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [558, 677]
Target 1: [462, 673]
Binary Target 1
---------------------------
Target 0: [558, 677]
Target 1: [462, 673]
===================================
Normal Label Distribution: 
Target 0: [558, 677]
Target 1: [462, 673]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 2370, target_attr: gender, bias_attr: race bias_rate: 0.9
['[test] target_0-bias_0: 558', '[test] target_0-bias_1: 677', '[test] target_1-bias_0: 462', '[test] target_1-bias_1: 673']
decay_epochs: [6, 13]
[1 / 20] Learning rate: 0.001 weight: 0.01
[1 / 20] Loss: 4.903556781841407 CE Loss: 0.6234788969704557 Con Loss: 4.897322018010375
[1 / 20] tensor([[0.894, 0.883],
        [0.487, 0.535]]) {'epoch': 1, 'valid/acc': 72.827, 'valid/acc_unbiased': 71.372, 'valid/diff': 1.846, 'valid/acc_skew': 70.449, 'valid/acc_align': 72.295, 'test/acc': 70.97, 'test/acc_unbiased': 69.988, 'test/diff': 2.943, 'test/acc_skew': 68.516, 'test/acc_align': 71.459}
[1 / 20] best valid accuracy: 71.372 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 72.827, 'best_valid_valid/acc_unbiased': 71.372, 'best_valid_valid/diff': 1.846, 'best_valid_valid/acc_skew': 70.449, 'best_valid_valid/acc_align': 72.295, 'best_valid_test/acc': 70.97, 'best_valid_test/acc_unbiased': 69.988, 'best_valid_test/diff': 2.943, 'best_valid_test/acc_skew': 68.516, 'best_valid_test/acc_align': 71.459}
[1 / 20] best test accuracy: 69.988 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 72.827, 'best_test_valid/acc_unbiased': 71.372, 'best_test_valid/diff': 1.846, 'best_test_valid/acc_skew': 70.449, 'best_test_valid/acc_align': 72.295, 'best_test_test/acc': 70.97, 'best_test_test/acc_unbiased': 69.988, 'best_test_test/diff': 2.943, 'best_test_test/acc_skew': 68.516, 'best_test_test/acc_align': 71.459}
[2 / 20] Learning rate: 0.001 weight: 0.01
[2 / 20] Loss: 4.788471839787496 CE Loss: 0.5768700732493645 Con Loss: 4.782703152512736
[2 / 20] tensor([[0.887, 0.860],
        [0.524, 0.608]]) {'epoch': 2, 'valid/acc': 72.574, 'valid/acc_unbiased': 71.288, 'valid/diff': 3.363, 'valid/acc_skew': 69.606, 'valid/acc_align': 72.969, 'test/acc': 72.911, 'test/acc_unbiased': 71.958, 'test/diff': 5.567, 'test/acc_skew': 69.174, 'test/acc_align': 74.741}
[2 / 20] best valid accuracy: 71.372 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 72.827, 'best_valid_valid/acc_unbiased': 71.372, 'best_valid_valid/diff': 1.846, 'best_valid_valid/acc_skew': 70.449, 'best_valid_valid/acc_align': 72.295, 'best_valid_test/acc': 70.97, 'best_valid_test/acc_unbiased': 69.988, 'best_valid_test/diff': 2.943, 'best_valid_test/acc_skew': 68.516, 'best_valid_test/acc_align': 71.459}
[2 / 20] best test accuracy: 71.958 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 72.574, 'best_test_valid/acc_unbiased': 71.288, 'best_test_valid/diff': 3.363, 'best_test_valid/acc_skew': 69.606, 'best_test_valid/acc_align': 72.969, 'best_test_test/acc': 72.911, 'best_test_test/acc_unbiased': 71.958, 'best_test_test/diff': 5.567, 'best_test_test/acc_skew': 69.174, 'best_test_test/acc_align': 74.741}
[3 / 20] Learning rate: 0.001 weight: 0.01
[3 / 20] Loss: 4.760783499191307 CE Loss: 0.583395697972785 Con Loss: 4.754949558531732
[3 / 20] tensor([[0.781, 0.666],
        [0.658, 0.753]]) {'epoch': 3, 'valid/acc': 72.11, 'valid/acc_unbiased': 71.958, 'valid/diff': 5.616, 'valid/acc_skew': 69.15, 'valid/acc_align': 74.766, 'test/acc': 71.646, 'test/acc_unbiased': 71.472, 'test/diff': 10.526, 'test/acc_skew': 66.209, 'test/acc_align': 76.735}
[3 / 20] best valid accuracy: 71.958 at epoch 3 
 best_stats: {'best_valid_epoch': 3, 'best_valid_valid/acc': 72.11, 'best_valid_valid/acc_unbiased': 71.958, 'best_valid_valid/diff': 5.616, 'best_valid_valid/acc_skew': 69.15, 'best_valid_valid/acc_align': 74.766, 'best_valid_test/acc': 71.646, 'best_valid_test/acc_unbiased': 71.472, 'best_valid_test/diff': 10.526, 'best_valid_test/acc_skew': 66.209, 'best_valid_test/acc_align': 76.735}
[3 / 20] best test accuracy: 71.958 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 72.574, 'best_test_valid/acc_unbiased': 71.288, 'best_test_valid/diff': 3.363, 'best_test_valid/acc_skew': 69.606, 'best_test_valid/acc_align': 72.969, 'best_test_test/acc': 72.911, 'best_test_test/acc_unbiased': 71.958, 'best_test_test/diff': 5.567, 'best_test_test/acc_skew': 69.174, 'best_test_test/acc_align': 74.741}
[4 / 20] Learning rate: 0.001 weight: 0.01
[4 / 20] Loss: 4.742297799486018 CE Loss: 0.5554762792447651 Con Loss: 4.7367430389538345
[4 / 20] tensor([[0.740, 0.705],
        [0.701, 0.780]]) {'epoch': 4, 'valid/acc': 74.684, 'valid/acc_unbiased': 74.487, 'valid/diff': 4.977, 'valid/acc_skew': 71.998, 'valid/acc_align': 76.975, 'test/acc': 73.376, 'test/acc_unbiased': 73.153, 'test/diff': 5.718, 'test/acc_skew': 70.294, 'test/acc_align': 76.012}
[4 / 20] best valid accuracy: 74.487 at epoch 4 
 best_stats: {'best_valid_epoch': 4, 'best_valid_valid/acc': 74.684, 'best_valid_valid/acc_unbiased': 74.487, 'best_valid_valid/diff': 4.977, 'best_valid_valid/acc_skew': 71.998, 'best_valid_valid/acc_align': 76.975, 'best_valid_test/acc': 73.376, 'best_valid_test/acc_unbiased': 73.153, 'best_valid_test/diff': 5.718, 'best_valid_test/acc_skew': 70.294, 'best_valid_test/acc_align': 76.012}
[4 / 20] best test accuracy: 73.153 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 74.684, 'best_test_valid/acc_unbiased': 74.487, 'best_test_valid/diff': 4.977, 'best_test_valid/acc_skew': 71.998, 'best_test_valid/acc_align': 76.975, 'best_test_test/acc': 73.376, 'best_test_test/acc_unbiased': 73.153, 'best_test_test/diff': 5.718, 'best_test_test/acc_skew': 70.294, 'best_test_test/acc_align': 76.012}
[5 / 20] Learning rate: 0.001 weight: 0.01
[5 / 20] Loss: 4.721025750368266 CE Loss: 0.5431440311591761 Con Loss: 4.71559429727222
[5 / 20] tensor([[0.708, 0.662],
        [0.842, 0.845]]) {'epoch': 5, 'valid/acc': 74.684, 'valid/acc_unbiased': 75.04, 'valid/diff': 1.863, 'valid/acc_skew': 74.108, 'valid/acc_align': 75.971, 'test/acc': 75.992, 'test/acc_unbiased': 76.427, 'test/diff': 2.481, 'test/acc_skew': 75.187, 'test/acc_align': 77.668}
[5 / 20] best valid accuracy: 75.040 at epoch 5 
 best_stats: {'best_valid_epoch': 5, 'best_valid_valid/acc': 74.684, 'best_valid_valid/acc_unbiased': 75.04, 'best_valid_valid/diff': 1.863, 'best_valid_valid/acc_skew': 74.108, 'best_valid_valid/acc_align': 75.971, 'best_valid_test/acc': 75.992, 'best_valid_test/acc_unbiased': 76.427, 'best_valid_test/diff': 2.481, 'best_valid_test/acc_skew': 75.187, 'best_valid_test/acc_align': 77.668}
[5 / 20] best test accuracy: 76.427 at epoch 5 
 best_stats: {'best_test_epoch': 5, 'best_test_valid/acc': 74.684, 'best_test_valid/acc_unbiased': 75.04, 'best_test_valid/diff': 1.863, 'best_test_valid/acc_skew': 74.108, 'best_test_valid/acc_align': 75.971, 'best_test_test/acc': 75.992, 'best_test_test/acc_unbiased': 76.427, 'best_test_test/diff': 2.481, 'best_test_test/acc_skew': 75.187, 'best_test_test/acc_align': 77.668}
[6 / 20] Learning rate: 0.001 weight: 0.01
[6 / 20] Loss: 4.709611325103403 CE Loss: 0.5351541614811731 Con Loss: 4.704259757939753
[6 / 20] tensor([[0.717, 0.631],
        [0.777, 0.844]]) {'epoch': 6, 'valid/acc': 75.401, 'valid/acc_unbiased': 75.773, 'valid/diff': 2.819, 'valid/acc_skew': 74.363, 'valid/acc_align': 77.182, 'test/acc': 74.008, 'test/acc_unbiased': 74.215, 'test/diff': 7.652, 'test/acc_skew': 70.389, 'test/acc_align': 78.041}
[6 / 20] best valid accuracy: 75.773 at epoch 6 
 best_stats: {'best_valid_epoch': 6, 'best_valid_valid/acc': 75.401, 'best_valid_valid/acc_unbiased': 75.773, 'best_valid_valid/diff': 2.819, 'best_valid_valid/acc_skew': 74.363, 'best_valid_valid/acc_align': 77.182, 'best_valid_test/acc': 74.008, 'best_valid_test/acc_unbiased': 74.215, 'best_valid_test/diff': 7.652, 'best_valid_test/acc_skew': 70.389, 'best_valid_test/acc_align': 78.041}
[6 / 20] best test accuracy: 76.427 at epoch 5 
 best_stats: {'best_test_epoch': 5, 'best_test_valid/acc': 74.684, 'best_test_valid/acc_unbiased': 75.04, 'best_test_valid/diff': 1.863, 'best_test_valid/acc_skew': 74.108, 'best_test_valid/acc_align': 75.971, 'best_test_test/acc': 75.992, 'best_test_test/acc_unbiased': 76.427, 'best_test_test/diff': 2.481, 'best_test_test/acc_skew': 75.187, 'best_test_test/acc_align': 77.668}
[7 / 20] Learning rate: 0.0001 weight: 0.01
[7 / 20] Loss: 4.634659839758586 CE Loss: 0.509539257467753 Con Loss: 4.629564445853059
[7 / 20] tensor([[0.731, 0.648],
        [0.816, 0.872]]) {'epoch': 7, 'valid/acc': 77.932, 'valid/acc_unbiased': 78.37, 'valid/diff': 3.123, 'valid/acc_skew': 76.808, 'valid/acc_align': 79.931, 'test/acc': 76.414, 'test/acc_unbiased': 76.697, 'test/diff': 6.947, 'test/acc_skew': 73.223, 'test/acc_align': 80.17}
[7 / 20] best valid accuracy: 78.370 at epoch 7 
 best_stats: {'best_valid_epoch': 7, 'best_valid_valid/acc': 77.932, 'best_valid_valid/acc_unbiased': 78.37, 'best_valid_valid/diff': 3.123, 'best_valid_valid/acc_skew': 76.808, 'best_valid_valid/acc_align': 79.931, 'best_valid_test/acc': 76.414, 'best_valid_test/acc_unbiased': 76.697, 'best_valid_test/diff': 6.947, 'best_valid_test/acc_skew': 73.223, 'best_valid_test/acc_align': 80.17}
[7 / 20] best test accuracy: 76.697 at epoch 7 
 best_stats: {'best_test_epoch': 7, 'best_test_valid/acc': 77.932, 'best_test_valid/acc_unbiased': 78.37, 'best_test_valid/diff': 3.123, 'best_test_valid/acc_skew': 76.808, 'best_test_valid/acc_align': 79.931, 'best_test_test/acc': 76.414, 'best_test_test/acc_unbiased': 76.697, 'best_test_test/diff': 6.947, 'best_test_test/acc_skew': 73.223, 'best_test_test/acc_align': 80.17}
[8 / 20] Learning rate: 0.0001 weight: 0.01
[8 / 20] Loss: 4.609335967771829 CE Loss: 0.49069518016686725 Con Loss: 4.604429010416369
[8 / 20] tensor([[0.794, 0.702],
        [0.792, 0.844]]) {'epoch': 8, 'valid/acc': 78.734, 'valid/acc_unbiased': 79.095, 'valid/diff': 5.082, 'valid/acc_skew': 76.554, 'valid/acc_align': 81.636, 'test/acc': 78.143, 'test/acc_unbiased': 78.293, 'test/diff': 7.203, 'test/acc_skew': 74.692, 'test/acc_align': 81.894}
[8 / 20] best valid accuracy: 79.095 at epoch 8 
 best_stats: {'best_valid_epoch': 8, 'best_valid_valid/acc': 78.734, 'best_valid_valid/acc_unbiased': 79.095, 'best_valid_valid/diff': 5.082, 'best_valid_valid/acc_skew': 76.554, 'best_valid_valid/acc_align': 81.636, 'best_valid_test/acc': 78.143, 'best_valid_test/acc_unbiased': 78.293, 'best_valid_test/diff': 7.203, 'best_valid_test/acc_skew': 74.692, 'best_valid_test/acc_align': 81.894}
[8 / 20] best test accuracy: 78.293 at epoch 8 
 best_stats: {'best_test_epoch': 8, 'best_test_valid/acc': 78.734, 'best_test_valid/acc_unbiased': 79.095, 'best_test_valid/diff': 5.082, 'best_test_valid/acc_skew': 76.554, 'best_test_valid/acc_align': 81.636, 'best_test_test/acc': 78.143, 'best_test_test/acc_unbiased': 78.293, 'best_test_test/diff': 7.203, 'best_test_test/acc_skew': 74.692, 'best_test_test/acc_align': 81.894}
[9 / 20] Learning rate: 0.0001 weight: 0.01
[9 / 20] Loss: 4.56677635243138 CE Loss: 0.48738685455364156 Con Loss: 4.561902490227673
[9 / 20] tensor([[0.808, 0.737],
        [0.768, 0.819]]) {'epoch': 9, 'valid/acc': 80.211, 'valid/acc_unbiased': 80.343, 'valid/diff': 3.627, 'valid/acc_skew': 78.529, 'valid/acc_align': 82.157, 'test/acc': 78.312, 'test/acc_unbiased': 78.311, 'test/diff': 6.075, 'test/acc_skew': 75.274, 'test/acc_align': 81.348}
[9 / 20] best valid accuracy: 80.343 at epoch 9 
 best_stats: {'best_valid_epoch': 9, 'best_valid_valid/acc': 80.211, 'best_valid_valid/acc_unbiased': 80.343, 'best_valid_valid/diff': 3.627, 'best_valid_valid/acc_skew': 78.529, 'best_valid_valid/acc_align': 82.157, 'best_valid_test/acc': 78.312, 'best_valid_test/acc_unbiased': 78.311, 'best_valid_test/diff': 6.075, 'best_valid_test/acc_skew': 75.274, 'best_valid_test/acc_align': 81.348}
[9 / 20] best test accuracy: 78.311 at epoch 9 
 best_stats: {'best_test_epoch': 9, 'best_test_valid/acc': 80.211, 'best_test_valid/acc_unbiased': 80.343, 'best_test_valid/diff': 3.627, 'best_test_valid/acc_skew': 78.529, 'best_test_valid/acc_align': 82.157, 'best_test_test/acc': 78.312, 'best_test_test/acc_unbiased': 78.311, 'best_test_test/diff': 6.075, 'best_test_test/acc_skew': 75.274, 'best_test_test/acc_align': 81.348}
[10 / 20] Learning rate: 0.0001 weight: 0.01
[10 / 20] Loss: 4.56510988754898 CE Loss: 0.4791209182836999 Con Loss: 4.5603186801446824
[10 / 20] tensor([[0.823, 0.734],
        [0.753, 0.807]]) {'epoch': 10, 'valid/acc': 80.169, 'valid/acc_unbiased': 80.127, 'valid/diff': 5.31, 'valid/acc_skew': 77.473, 'valid/acc_align': 82.782, 'test/acc': 77.932, 'test/acc_unbiased': 77.92, 'test/diff': 7.102, 'test/acc_skew': 74.368, 'test/acc_align': 81.471}
[10 / 20] best valid accuracy: 80.343 at epoch 9 
 best_stats: {'best_valid_epoch': 9, 'best_valid_valid/acc': 80.211, 'best_valid_valid/acc_unbiased': 80.343, 'best_valid_valid/diff': 3.627, 'best_valid_valid/acc_skew': 78.529, 'best_valid_valid/acc_align': 82.157, 'best_valid_test/acc': 78.312, 'best_valid_test/acc_unbiased': 78.311, 'best_valid_test/diff': 6.075, 'best_valid_test/acc_skew': 75.274, 'best_valid_test/acc_align': 81.348}
[10 / 20] best test accuracy: 78.311 at epoch 9 
 best_stats: {'best_test_epoch': 9, 'best_test_valid/acc': 80.211, 'best_test_valid/acc_unbiased': 80.343, 'best_test_valid/diff': 3.627, 'best_test_valid/acc_skew': 78.529, 'best_test_valid/acc_align': 82.157, 'best_test_test/acc': 78.312, 'best_test_test/acc_unbiased': 78.311, 'best_test_test/diff': 6.075, 'best_test_test/acc_skew': 75.274, 'best_test_test/acc_align': 81.348}
[11 / 20] Learning rate: 0.0001 weight: 0.01
[11 / 20] Loss: 4.543232266410727 CE Loss: 0.4790815913485224 Con Loss: 4.53844145625437
[11 / 20] tensor([[0.801, 0.733],
        [0.779, 0.844]]) {'epoch': 11, 'valid/acc': 80.506, 'valid/acc_unbiased': 80.645, 'valid/diff': 4.451, 'valid/acc_skew': 78.42, 'valid/acc_align': 82.87, 'test/acc': 78.945, 'test/acc_unbiased': 78.923, 'test/diff': 6.66, 'test/acc_skew': 75.593, 'test/acc_align': 82.253}
[11 / 20] best valid accuracy: 80.645 at epoch 11 
 best_stats: {'best_valid_epoch': 11, 'best_valid_valid/acc': 80.506, 'best_valid_valid/acc_unbiased': 80.645, 'best_valid_valid/diff': 4.451, 'best_valid_valid/acc_skew': 78.42, 'best_valid_valid/acc_align': 82.87, 'best_valid_test/acc': 78.945, 'best_valid_test/acc_unbiased': 78.923, 'best_valid_test/diff': 6.66, 'best_valid_test/acc_skew': 75.593, 'best_valid_test/acc_align': 82.253}
[11 / 20] best test accuracy: 78.923 at epoch 11 
 best_stats: {'best_test_epoch': 11, 'best_test_valid/acc': 80.506, 'best_test_valid/acc_unbiased': 80.645, 'best_test_valid/diff': 4.451, 'best_test_valid/acc_skew': 78.42, 'best_test_valid/acc_align': 82.87, 'best_test_test/acc': 78.945, 'best_test_test/acc_unbiased': 78.923, 'best_test_test/diff': 6.66, 'best_test_test/acc_skew': 75.593, 'best_test_test/acc_align': 82.253}
[12 / 20] Learning rate: 0.0001 weight: 0.01
[12 / 20] Loss: 4.529172913396341 CE Loss: 0.4634890048866914 Con Loss: 4.524538009442487
[12 / 20] tensor([[0.842, 0.770],
        [0.751, 0.808]]) {'epoch': 12, 'valid/acc': 80.802, 'valid/acc_unbiased': 80.457, 'valid/diff': 6.327, 'valid/acc_skew': 77.294, 'valid/acc_align': 83.621, 'test/acc': 79.409, 'test/acc_unbiased': 79.282, 'test/diff': 6.498, 'test/acc_skew': 76.033, 'test/acc_align': 82.531}
[12 / 20] best valid accuracy: 80.645 at epoch 11 
 best_stats: {'best_valid_epoch': 11, 'best_valid_valid/acc': 80.506, 'best_valid_valid/acc_unbiased': 80.645, 'best_valid_valid/diff': 4.451, 'best_valid_valid/acc_skew': 78.42, 'best_valid_valid/acc_align': 82.87, 'best_valid_test/acc': 78.945, 'best_valid_test/acc_unbiased': 78.923, 'best_valid_test/diff': 6.66, 'best_valid_test/acc_skew': 75.593, 'best_valid_test/acc_align': 82.253}
[12 / 20] best test accuracy: 79.282 at epoch 12 
 best_stats: {'best_test_epoch': 12, 'best_test_valid/acc': 80.802, 'best_test_valid/acc_unbiased': 80.457, 'best_test_valid/diff': 6.327, 'best_test_valid/acc_skew': 77.294, 'best_test_valid/acc_align': 83.621, 'best_test_test/acc': 79.409, 'best_test_test/acc_unbiased': 79.282, 'best_test_test/diff': 6.498, 'best_test_test/acc_skew': 76.033, 'best_test_test/acc_align': 82.531}
[13 / 20] Learning rate: 0.0001 weight: 0.01
[13 / 20] Loss: 4.5210485500263085 CE Loss: 0.47092137975539156 Con Loss: 4.5163393376686916
[13 / 20] tensor([[0.862, 0.784],
        [0.727, 0.795]]) {'epoch': 13, 'valid/acc': 79.958, 'valid/acc_unbiased': 79.831, 'valid/diff': 6.1, 'valid/acc_skew': 76.781, 'valid/acc_align': 82.88, 'test/acc': 79.451, 'test/acc_unbiased': 79.214, 'test/diff': 7.267, 'test/acc_skew': 75.581, 'test/acc_align': 82.848}
[13 / 20] best valid accuracy: 80.645 at epoch 11 
 best_stats: {'best_valid_epoch': 11, 'best_valid_valid/acc': 80.506, 'best_valid_valid/acc_unbiased': 80.645, 'best_valid_valid/diff': 4.451, 'best_valid_valid/acc_skew': 78.42, 'best_valid_valid/acc_align': 82.87, 'best_valid_test/acc': 78.945, 'best_valid_test/acc_unbiased': 78.923, 'best_valid_test/diff': 6.66, 'best_valid_test/acc_skew': 75.593, 'best_valid_test/acc_align': 82.253}
[13 / 20] best test accuracy: 79.282 at epoch 12 
 best_stats: {'best_test_epoch': 12, 'best_test_valid/acc': 80.802, 'best_test_valid/acc_unbiased': 80.457, 'best_test_valid/diff': 6.327, 'best_test_valid/acc_skew': 77.294, 'best_test_valid/acc_align': 83.621, 'best_test_test/acc': 79.409, 'best_test_test/acc_unbiased': 79.282, 'best_test_test/diff': 6.498, 'best_test_test/acc_skew': 76.033, 'best_test_test/acc_align': 82.531}
[14 / 20] Learning rate: 1e-05 weight: 0.01
[14 / 20] Loss: 4.515657266446472 CE Loss: 0.47263098269221027 Con Loss: 4.510930942406941
[14 / 20] tensor([[0.801, 0.710],
        [0.792, 0.844]]) {'epoch': 14, 'valid/acc': 79.705, 'valid/acc_unbiased': 79.912, 'valid/diff': 7.807, 'valid/acc_skew': 76.008, 'valid/acc_align': 83.816, 'test/acc': 78.565, 'test/acc_unbiased': 78.694, 'test/diff': 7.118, 'test/acc_skew': 75.135, 'test/acc_align': 82.253}
[14 / 20] best valid accuracy: 80.645 at epoch 11 
 best_stats: {'best_valid_epoch': 11, 'best_valid_valid/acc': 80.506, 'best_valid_valid/acc_unbiased': 80.645, 'best_valid_valid/diff': 4.451, 'best_valid_valid/acc_skew': 78.42, 'best_valid_valid/acc_align': 82.87, 'best_valid_test/acc': 78.945, 'best_valid_test/acc_unbiased': 78.923, 'best_valid_test/diff': 6.66, 'best_valid_test/acc_skew': 75.593, 'best_valid_test/acc_align': 82.253}
[14 / 20] best test accuracy: 79.282 at epoch 12 
 best_stats: {'best_test_epoch': 12, 'best_test_valid/acc': 80.802, 'best_test_valid/acc_unbiased': 80.457, 'best_test_valid/diff': 6.327, 'best_test_valid/acc_skew': 77.294, 'best_test_valid/acc_align': 83.621, 'best_test_test/acc': 79.409, 'best_test_test/acc_unbiased': 79.282, 'best_test_test/diff': 6.498, 'best_test_test/acc_skew': 76.033, 'best_test_test/acc_align': 82.531}
[15 / 20] Learning rate: 1e-05 weight: 0.01
[15 / 20] Loss: 4.488673911087684 CE Loss: 0.4598822826260529 Con Loss: 4.484075112014703
[15 / 20] tensor([[0.787, 0.696],
        [0.805, 0.857]]) {'epoch': 15, 'valid/acc': 79.451, 'valid/acc_unbiased': 79.792, 'valid/diff': 7.498, 'valid/acc_skew': 76.043, 'valid/acc_align': 83.542, 'test/acc': 78.439, 'test/acc_unbiased': 78.625, 'test/diff': 7.159, 'test/acc_skew': 75.046, 'test/acc_align': 82.205}
[15 / 20] best valid accuracy: 80.645 at epoch 11 
 best_stats: {'best_valid_epoch': 11, 'best_valid_valid/acc': 80.506, 'best_valid_valid/acc_unbiased': 80.645, 'best_valid_valid/diff': 4.451, 'best_valid_valid/acc_skew': 78.42, 'best_valid_valid/acc_align': 82.87, 'best_valid_test/acc': 78.945, 'best_valid_test/acc_unbiased': 78.923, 'best_valid_test/diff': 6.66, 'best_valid_test/acc_skew': 75.593, 'best_valid_test/acc_align': 82.253}
[15 / 20] best test accuracy: 79.282 at epoch 12 
 best_stats: {'best_test_epoch': 12, 'best_test_valid/acc': 80.802, 'best_test_valid/acc_unbiased': 80.457, 'best_test_valid/diff': 6.327, 'best_test_valid/acc_skew': 77.294, 'best_test_valid/acc_align': 83.621, 'best_test_test/acc': 79.409, 'best_test_test/acc_unbiased': 79.282, 'best_test_test/diff': 6.498, 'best_test_test/acc_skew': 76.033, 'best_test_test/acc_align': 82.531}
[16 / 20] Learning rate: 1e-05 weight: 0.01
[16 / 20] Loss: 4.489034883099803 CE Loss: 0.46171910513197867 Con Loss: 4.484417712880438
[16 / 20] tensor([[0.796, 0.700],
        [0.794, 0.847]]) {'epoch': 16, 'valid/acc': 78.987, 'valid/acc_unbiased': 79.146, 'valid/diff': 7.88, 'valid/acc_skew': 75.206, 'valid/acc_align': 83.086, 'test/acc': 78.27, 'test/acc_unbiased': 78.429, 'test/diff': 7.407, 'test/acc_skew': 74.726, 'test/acc_align': 82.133}
[16 / 20] best valid accuracy: 80.645 at epoch 11 
 best_stats: {'best_valid_epoch': 11, 'best_valid_valid/acc': 80.506, 'best_valid_valid/acc_unbiased': 80.645, 'best_valid_valid/diff': 4.451, 'best_valid_valid/acc_skew': 78.42, 'best_valid_valid/acc_align': 82.87, 'best_valid_test/acc': 78.945, 'best_valid_test/acc_unbiased': 78.923, 'best_valid_test/diff': 6.66, 'best_valid_test/acc_skew': 75.593, 'best_valid_test/acc_align': 82.253}
[16 / 20] best test accuracy: 79.282 at epoch 12 
 best_stats: {'best_test_epoch': 12, 'best_test_valid/acc': 80.802, 'best_test_valid/acc_unbiased': 80.457, 'best_test_valid/diff': 6.327, 'best_test_valid/acc_skew': 77.294, 'best_test_valid/acc_align': 83.621, 'best_test_test/acc': 79.409, 'best_test_test/acc_unbiased': 79.282, 'best_test_test/diff': 6.498, 'best_test_test/acc_skew': 76.033, 'best_test_test/acc_align': 82.531}
[17 / 20] Learning rate: 1e-05 weight: 0.01
[17 / 20] Loss: 4.506986198453219 CE Loss: 0.4620231173136224 Con Loss: 4.502365945897026
[17 / 20] tensor([[0.808, 0.706],
        [0.792, 0.847]]) {'epoch': 17, 'valid/acc': 79.536, 'valid/acc_unbiased': 79.69, 'valid/diff': 7.289, 'valid/acc_skew': 76.045, 'valid/acc_align': 83.334, 'test/acc': 78.692, 'test/acc_unbiased': 78.837, 'test/diff': 7.847, 'test/acc_skew': 74.913, 'test/acc_align': 82.76}
[17 / 20] best valid accuracy: 80.645 at epoch 11 
 best_stats: {'best_valid_epoch': 11, 'best_valid_valid/acc': 80.506, 'best_valid_valid/acc_unbiased': 80.645, 'best_valid_valid/diff': 4.451, 'best_valid_valid/acc_skew': 78.42, 'best_valid_valid/acc_align': 82.87, 'best_valid_test/acc': 78.945, 'best_valid_test/acc_unbiased': 78.923, 'best_valid_test/diff': 6.66, 'best_valid_test/acc_skew': 75.593, 'best_valid_test/acc_align': 82.253}
[17 / 20] best test accuracy: 79.282 at epoch 12 
 best_stats: {'best_test_epoch': 12, 'best_test_valid/acc': 80.802, 'best_test_valid/acc_unbiased': 80.457, 'best_test_valid/diff': 6.327, 'best_test_valid/acc_skew': 77.294, 'best_test_valid/acc_align': 83.621, 'best_test_test/acc': 79.409, 'best_test_test/acc_unbiased': 79.282, 'best_test_test/diff': 6.498, 'best_test_test/acc_skew': 76.033, 'best_test_test/acc_align': 82.531}
[18 / 20] Learning rate: 1e-05 weight: 0.01
[18 / 20] Loss: 4.469807885227231 CE Loss: 0.4536989619232725 Con Loss: 4.465270906730417
[18 / 20] tensor([[0.815, 0.727],
        [0.786, 0.837]]) {'epoch': 18, 'valid/acc': 79.789, 'valid/acc_unbiased': 79.857, 'valid/diff': 7.913, 'valid/acc_skew': 75.901, 'valid/acc_align': 83.813, 'test/acc': 79.03, 'test/acc_unbiased': 79.11, 'test/diff': 6.976, 'test/acc_skew': 75.622, 'test/acc_align': 82.598}
[18 / 20] best valid accuracy: 80.645 at epoch 11 
 best_stats: {'best_valid_epoch': 11, 'best_valid_valid/acc': 80.506, 'best_valid_valid/acc_unbiased': 80.645, 'best_valid_valid/diff': 4.451, 'best_valid_valid/acc_skew': 78.42, 'best_valid_valid/acc_align': 82.87, 'best_valid_test/acc': 78.945, 'best_valid_test/acc_unbiased': 78.923, 'best_valid_test/diff': 6.66, 'best_valid_test/acc_skew': 75.593, 'best_valid_test/acc_align': 82.253}
[18 / 20] best test accuracy: 79.282 at epoch 12 
 best_stats: {'best_test_epoch': 12, 'best_test_valid/acc': 80.802, 'best_test_valid/acc_unbiased': 80.457, 'best_test_valid/diff': 6.327, 'best_test_valid/acc_skew': 77.294, 'best_test_valid/acc_align': 83.621, 'best_test_test/acc': 79.409, 'best_test_test/acc_unbiased': 79.282, 'best_test_test/diff': 6.498, 'best_test_test/acc_skew': 76.033, 'best_test_test/acc_align': 82.531}
[19 / 20] Learning rate: 1e-05 weight: 0.01
[19 / 20] Loss: 4.491321876492368 CE Loss: 0.46636648844834827 Con Loss: 4.48665821360285
[19 / 20] tensor([[0.815, 0.719],
        [0.786, 0.842]]) {'epoch': 19, 'valid/acc': 79.831, 'valid/acc_unbiased': 79.911, 'valid/diff': 7.29, 'valid/acc_skew': 76.266, 'valid/acc_align': 83.556, 'test/acc': 78.987, 'test/acc_unbiased': 79.074, 'test/diff': 7.642, 'test/acc_skew': 75.253, 'test/acc_align': 82.895}
[19 / 20] best valid accuracy: 80.645 at epoch 11 
 best_stats: {'best_valid_epoch': 11, 'best_valid_valid/acc': 80.506, 'best_valid_valid/acc_unbiased': 80.645, 'best_valid_valid/diff': 4.451, 'best_valid_valid/acc_skew': 78.42, 'best_valid_valid/acc_align': 82.87, 'best_valid_test/acc': 78.945, 'best_valid_test/acc_unbiased': 78.923, 'best_valid_test/diff': 6.66, 'best_valid_test/acc_skew': 75.593, 'best_valid_test/acc_align': 82.253}
[19 / 20] best test accuracy: 79.282 at epoch 12 
 best_stats: {'best_test_epoch': 12, 'best_test_valid/acc': 80.802, 'best_test_valid/acc_unbiased': 80.457, 'best_test_valid/diff': 6.327, 'best_test_valid/acc_skew': 77.294, 'best_test_valid/acc_align': 83.621, 'best_test_test/acc': 79.409, 'best_test_test/acc_unbiased': 79.282, 'best_test_test/diff': 6.498, 'best_test_test/acc_skew': 76.033, 'best_test_test/acc_align': 82.531}
[20 / 20] Learning rate: 1e-05 weight: 0.01
[20 / 20] Loss: 4.485977100942006 CE Loss: 0.4548731342852552 Con Loss: 4.481428400489282
[20 / 20] tensor([[0.794, 0.678],
        [0.803, 0.851]]) {'epoch': 20, 'valid/acc': 79.325, 'valid/acc_unbiased': 79.595, 'valid/diff': 7.395, 'valid/acc_skew': 75.898, 'valid/acc_align': 83.293, 'test/acc': 77.89, 'test/acc_unbiased': 78.158, 'test/diff': 8.215, 'test/acc_skew': 74.051, 'test/acc_align': 82.266}
[20 / 20] best valid accuracy: 80.645 at epoch 11 
 best_stats: {'best_valid_epoch': 11, 'best_valid_valid/acc': 80.506, 'best_valid_valid/acc_unbiased': 80.645, 'best_valid_valid/diff': 4.451, 'best_valid_valid/acc_skew': 78.42, 'best_valid_valid/acc_align': 82.87, 'best_valid_test/acc': 78.945, 'best_valid_test/acc_unbiased': 78.923, 'best_valid_test/diff': 6.66, 'best_valid_test/acc_skew': 75.593, 'best_valid_test/acc_align': 82.253}
[20 / 20] best test accuracy: 79.282 at epoch 12 
 best_stats: {'best_test_epoch': 12, 'best_test_valid/acc': 80.802, 'best_test_valid/acc_unbiased': 80.457, 'best_test_valid/diff': 6.327, 'best_test_valid/acc_skew': 77.294, 'best_test_valid/acc_align': 83.621, 'best_test_test/acc': 79.409, 'best_test_test/acc_unbiased': 79.282, 'best_test_test/diff': 6.498, 'best_test_test/acc_skew': 76.033, 'best_test_test/acc_align': 82.531}
Total training time: 0:16:28
