Log level set to: INFO
Set seed: 1
=======> Using Fixed Random Seed: 1 <========
save_path: exp_results/bc-bb0-celeba_black-crop_test-lr0.001-bs128-cbs64-w0.01-ratio30-aug1-seed1
get_celeba - split:train, aug: False, given_y: True, ratio: 0
use existing black indices from data/celeba/pickles/black
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [60539, 38593]
Target 1: [8008, 16048]
Binary Target 1
---------------------------
Target 0: [60539, 38593]
Target 1: [8008, 16048]
===================================
Normal Label Distribution: 
Target 0: [60539, 38593]
Target 1: [8008, 16048]
===================================
Use BiasedCelebASplit 
 target_attr: black split: train 
 tensor([[60539.,  8008.],
        [38593., 16048.]])
get_celeba - split:train, aug: 1, given_y: True, ratio: 30
use existing black indices from data/celeba/pickles/black
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [60508, 38612]
Target 1: [8008, 16060]
Binary Target 1
---------------------------
Target 0: [60508, 38612]
Target 1: [8008, 16060]
===================================
Normal Label Distribution: 
Target 0: [60508, 38612]
Target 1: [8008, 16060]
===================================
Use BiasedCelebASplit 
 target_attr: black split: train 
 tensor([[60508.,  8008.],
        [38612., 16060.]])
get_celeba - split:train_valid, aug: False, given_y: True, ratio: 0
use existing black indices from data/celeba/pickles/black
Use BiasedCelebASplit 
 target_attr: black split: train_valid 
 tensor([[15227.,  1970.],
        [ 9563.,  4038.]])
get_celeba - split:valid, aug: False, given_y: True, ratio: 0
Use BiasedCelebASplit 
 target_attr: black split: valid 
 tensor([[9752., 1657.],
        [5971., 2487.]])
decay_epochs: [3, 6]
[1 / 10] Learning rate: 0.001 weight: 0.01
[1 / 10] Loss: 4.790332506588381 CE Loss: 0.2981928358949864 Con Loss: 4.787350582264382
[1 / 10] tensor([[0.976, 0.960],
        [0.613, 0.580]]) {'epoch': 1, 'valid/acc': 88.934, 'valid/acc_unbiased': 76.286, 'valid/diff': 0.712, 'valid/acc_skew': 75.93, 'valid/acc_align': 76.642, 'test/acc': 89.108, 'test/acc_unbiased': 78.203, 'test/diff': 2.42, 'test/acc_skew': 78.61, 'test/acc_align': 77.796}
[1 / 10] best valid accuracy: 76.286 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 88.934, 'best_valid_valid/acc_unbiased': 76.286, 'best_valid_valid/diff': 0.712, 'best_valid_valid/acc_skew': 75.93, 'best_valid_valid/acc_align': 76.642, 'best_valid_test/acc': 89.108, 'best_valid_test/acc_unbiased': 78.203, 'best_valid_test/diff': 2.42, 'best_valid_test/acc_skew': 78.61, 'best_valid_test/acc_align': 77.796}
[1 / 10] best test accuracy: 78.203 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 88.934, 'best_test_valid/acc_unbiased': 76.286, 'best_test_valid/diff': 0.712, 'best_test_valid/acc_skew': 75.93, 'best_test_valid/acc_align': 76.642, 'best_test_test/acc': 89.108, 'best_test_test/acc_unbiased': 78.203, 'best_test_test/diff': 2.42, 'best_test_test/acc_skew': 78.61, 'best_test_test/acc_align': 77.796}
[2 / 10] Learning rate: 0.001 weight: 0.01
[2 / 10] Loss: 4.773412017507646 CE Loss: 0.2722816625088342 Con Loss: 4.770689207535887
[2 / 10] tensor([[0.854, 0.763],
        [0.902, 0.899]]) {'epoch': 2, 'valid/acc': 83.437, 'valid/acc_unbiased': 85.283, 'valid/diff': 4.743, 'valid/acc_skew': 84.045, 'valid/acc_align': 86.52, 'test/acc': 83.631, 'test/acc_unbiased': 85.458, 'test/diff': 4.706, 'test/acc_skew': 83.263, 'test/acc_align': 87.653}
[2 / 10] best valid accuracy: 85.283 at epoch 2 
 best_stats: {'best_valid_epoch': 2, 'best_valid_valid/acc': 83.437, 'best_valid_valid/acc_unbiased': 85.283, 'best_valid_valid/diff': 4.743, 'best_valid_valid/acc_skew': 84.045, 'best_valid_valid/acc_align': 86.52, 'best_valid_test/acc': 83.631, 'best_valid_test/acc_unbiased': 85.458, 'best_valid_test/diff': 4.706, 'best_valid_test/acc_skew': 83.263, 'best_valid_test/acc_align': 87.653}
[2 / 10] best test accuracy: 85.458 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 83.437, 'best_test_valid/acc_unbiased': 85.283, 'best_test_valid/diff': 4.743, 'best_test_valid/acc_skew': 84.045, 'best_test_valid/acc_align': 86.52, 'best_test_test/acc': 83.631, 'best_test_test/acc_unbiased': 85.458, 'best_test_test/diff': 4.706, 'best_test_test/acc_skew': 83.263, 'best_test_test/acc_align': 87.653}
[3 / 10] Learning rate: 0.001 weight: 0.01
[3 / 10] Loss: 4.765417889588436 CE Loss: 0.2672995768617367 Con Loss: 4.76274489675183
[3 / 10] tensor([[0.970, 0.952],
        [0.595, 0.586]]) {'epoch': 3, 'valid/acc': 88.681, 'valid/acc_unbiased': 76.131, 'valid/diff': 2.183, 'valid/acc_skew': 75.04, 'valid/acc_align': 77.223, 'test/acc': 88.554, 'test/acc_unbiased': 77.597, 'test/diff': 1.358, 'test/acc_skew': 77.358, 'test/acc_align': 77.836}
[3 / 10] best valid accuracy: 85.283 at epoch 2 
 best_stats: {'best_valid_epoch': 2, 'best_valid_valid/acc': 83.437, 'best_valid_valid/acc_unbiased': 85.283, 'best_valid_valid/diff': 4.743, 'best_valid_valid/acc_skew': 84.045, 'best_valid_valid/acc_align': 86.52, 'best_valid_test/acc': 83.631, 'best_valid_test/acc_unbiased': 85.458, 'best_valid_test/diff': 4.706, 'best_valid_test/acc_skew': 83.263, 'best_valid_test/acc_align': 87.653}
[3 / 10] best test accuracy: 85.458 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 83.437, 'best_test_valid/acc_unbiased': 85.283, 'best_test_valid/diff': 4.743, 'best_test_valid/acc_skew': 84.045, 'best_test_valid/acc_align': 86.52, 'best_test_test/acc': 83.631, 'best_test_test/acc_unbiased': 85.458, 'best_test_test/diff': 4.706, 'best_test_test/acc_skew': 83.263, 'best_test_test/acc_align': 87.653}
[4 / 10] Learning rate: 0.0001 weight: 0.01
[4 / 10] Loss: 4.7391527547315135 CE Loss: 0.2361425357427822 Con Loss: 4.73679132799392
[4 / 10] tensor([[0.946, 0.920],
        [0.795, 0.775]]) {'epoch': 4, 'valid/acc': 90.373, 'valid/acc_unbiased': 85.316, 'valid/diff': 2.641, 'valid/acc_skew': 85.196, 'valid/acc_align': 85.436, 'test/acc': 90.441, 'test/acc_unbiased': 85.929, 'test/diff': 2.29, 'test/acc_skew': 85.793, 'test/acc_align': 86.065}
[4 / 10] best valid accuracy: 85.316 at epoch 4 
 best_stats: {'best_valid_epoch': 4, 'best_valid_valid/acc': 90.373, 'best_valid_valid/acc_unbiased': 85.316, 'best_valid_valid/diff': 2.641, 'best_valid_valid/acc_skew': 85.196, 'best_valid_valid/acc_align': 85.436, 'best_valid_test/acc': 90.441, 'best_valid_test/acc_unbiased': 85.929, 'best_valid_test/diff': 2.29, 'best_valid_test/acc_skew': 85.793, 'best_valid_test/acc_align': 86.065}
[4 / 10] best test accuracy: 85.929 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 90.373, 'best_test_valid/acc_unbiased': 85.316, 'best_test_valid/diff': 2.641, 'best_test_valid/acc_skew': 85.196, 'best_test_valid/acc_align': 85.436, 'best_test_test/acc': 90.441, 'best_test_test/acc_unbiased': 85.929, 'best_test_test/diff': 2.29, 'best_test_test/acc_skew': 85.793, 'best_test_test/acc_align': 86.065}
[5 / 10] Learning rate: 0.0001 weight: 0.01
[5 / 10] Loss: 4.73413289860982 CE Loss: 0.2279333974397364 Con Loss: 4.731853551902094
[5 / 10] tensor([[0.963, 0.938],
        [0.736, 0.731]]) {'epoch': 5, 'valid/acc': 90.814, 'valid/acc_unbiased': 83.636, 'valid/diff': 2.202, 'valid/acc_skew': 83.671, 'valid/acc_align': 83.601, 'test/acc': 90.759, 'test/acc_unbiased': 84.206, 'test/diff': 1.543, 'test/acc_skew': 83.698, 'test/acc_align': 84.715}
[5 / 10] best valid accuracy: 85.316 at epoch 4 
 best_stats: {'best_valid_epoch': 4, 'best_valid_valid/acc': 90.373, 'best_valid_valid/acc_unbiased': 85.316, 'best_valid_valid/diff': 2.641, 'best_valid_valid/acc_skew': 85.196, 'best_valid_valid/acc_align': 85.436, 'best_valid_test/acc': 90.441, 'best_valid_test/acc_unbiased': 85.929, 'best_valid_test/diff': 2.29, 'best_valid_test/acc_skew': 85.793, 'best_valid_test/acc_align': 86.065}
[5 / 10] best test accuracy: 85.929 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 90.373, 'best_test_valid/acc_unbiased': 85.316, 'best_test_valid/diff': 2.641, 'best_test_valid/acc_skew': 85.196, 'best_test_valid/acc_align': 85.436, 'best_test_test/acc': 90.441, 'best_test_test/acc_unbiased': 85.929, 'best_test_test/diff': 2.29, 'best_test_test/acc_skew': 85.793, 'best_test_test/acc_align': 86.065}
[6 / 10] Learning rate: 0.0001 weight: 0.01
[6 / 10] Loss: 4.729179890019462 CE Loss: 0.2259921843632555 Con Loss: 4.726919967524281
[6 / 10] tensor([[0.959, 0.947],
        [0.768, 0.725]]) {'epoch': 6, 'valid/acc': 90.921, 'valid/acc_unbiased': 84.374, 'valid/diff': 3.734, 'valid/acc_skew': 85.628, 'valid/acc_align': 83.119, 'test/acc': 91.01, 'test/acc_unbiased': 84.977, 'test/diff': 2.749, 'test/acc_skew': 85.767, 'test/acc_align': 84.187}
[6 / 10] best valid accuracy: 85.316 at epoch 4 
 best_stats: {'best_valid_epoch': 4, 'best_valid_valid/acc': 90.373, 'best_valid_valid/acc_unbiased': 85.316, 'best_valid_valid/diff': 2.641, 'best_valid_valid/acc_skew': 85.196, 'best_valid_valid/acc_align': 85.436, 'best_valid_test/acc': 90.441, 'best_valid_test/acc_unbiased': 85.929, 'best_valid_test/diff': 2.29, 'best_valid_test/acc_skew': 85.793, 'best_valid_test/acc_align': 86.065}
[6 / 10] best test accuracy: 85.929 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 90.373, 'best_test_valid/acc_unbiased': 85.316, 'best_test_valid/diff': 2.641, 'best_test_valid/acc_skew': 85.196, 'best_test_valid/acc_align': 85.436, 'best_test_test/acc': 90.441, 'best_test_test/acc_unbiased': 85.929, 'best_test_test/diff': 2.29, 'best_test_test/acc_skew': 85.793, 'best_test_test/acc_align': 86.065}
[7 / 10] Learning rate: 1e-05 weight: 0.01
[7 / 10] Loss: 4.724167955228678 CE Loss: 0.22181852405454933 Con Loss: 4.721949776322067
[7 / 10] tensor([[0.959, 0.935],
        [0.767, 0.773]]) {'epoch': 7, 'valid/acc': 91.308, 'valid/acc_unbiased': 85.443, 'valid/diff': 2.369, 'valid/acc_skew': 85.394, 'valid/acc_align': 85.492, 'test/acc': 91.222, 'test/acc_unbiased': 85.829, 'test/diff': 1.502, 'test/acc_skew': 85.078, 'test/acc_align': 86.58}
[7 / 10] best valid accuracy: 85.443 at epoch 7 
 best_stats: {'best_valid_epoch': 7, 'best_valid_valid/acc': 91.308, 'best_valid_valid/acc_unbiased': 85.443, 'best_valid_valid/diff': 2.369, 'best_valid_valid/acc_skew': 85.394, 'best_valid_valid/acc_align': 85.492, 'best_valid_test/acc': 91.222, 'best_valid_test/acc_unbiased': 85.829, 'best_valid_test/diff': 1.502, 'best_valid_test/acc_skew': 85.078, 'best_valid_test/acc_align': 86.58}
[7 / 10] best test accuracy: 85.929 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 90.373, 'best_test_valid/acc_unbiased': 85.316, 'best_test_valid/diff': 2.641, 'best_test_valid/acc_skew': 85.196, 'best_test_valid/acc_align': 85.436, 'best_test_test/acc': 90.441, 'best_test_test/acc_unbiased': 85.929, 'best_test_test/diff': 2.29, 'best_test_test/acc_skew': 85.793, 'best_test_test/acc_align': 86.065}
[8 / 10] Learning rate: 1e-05 weight: 0.01
[8 / 10] Loss: 4.72221698806507 CE Loss: 0.2195638228518338 Con Loss: 4.720021353211694
[8 / 10] tensor([[0.952, 0.934],
        [0.795, 0.771]]) {'epoch': 8, 'valid/acc': 91.184, 'valid/acc_unbiased': 86.048, 'valid/diff': 3.529, 'valid/acc_skew': 86.855, 'valid/acc_align': 85.242, 'test/acc': 91.096, 'test/acc_unbiased': 86.303, 'test/diff': 2.117, 'test/acc_skew': 86.424, 'test/acc_align': 86.182}
[8 / 10] best valid accuracy: 86.048 at epoch 8 
 best_stats: {'best_valid_epoch': 8, 'best_valid_valid/acc': 91.184, 'best_valid_valid/acc_unbiased': 86.048, 'best_valid_valid/diff': 3.529, 'best_valid_valid/acc_skew': 86.855, 'best_valid_valid/acc_align': 85.242, 'best_valid_test/acc': 91.096, 'best_valid_test/acc_unbiased': 86.303, 'best_valid_test/diff': 2.117, 'best_valid_test/acc_skew': 86.424, 'best_valid_test/acc_align': 86.182}
[8 / 10] best test accuracy: 86.303 at epoch 8 
 best_stats: {'best_test_epoch': 8, 'best_test_valid/acc': 91.184, 'best_test_valid/acc_unbiased': 86.048, 'best_test_valid/diff': 3.529, 'best_test_valid/acc_skew': 86.855, 'best_test_valid/acc_align': 85.242, 'best_test_test/acc': 91.096, 'best_test_test/acc_unbiased': 86.303, 'best_test_test/diff': 2.117, 'best_test_test/acc_skew': 86.424, 'best_test_test/acc_align': 86.182}
[9 / 10] Learning rate: 1e-05 weight: 0.01
[9 / 10] Loss: 4.720580649537715 CE Loss: 0.21932074333592413 Con Loss: 4.718387445211449
[9 / 10] tensor([[0.958, 0.939],
        [0.768, 0.759]]) {'epoch': 9, 'valid/acc': 91.347, 'valid/acc_unbiased': 85.401, 'valid/diff': 2.775, 'valid/acc_skew': 85.584, 'valid/acc_align': 85.217, 'test/acc': 91.176, 'test/acc_unbiased': 85.614, 'test/diff': 1.434, 'test/acc_skew': 85.373, 'test/acc_align': 85.856}
[9 / 10] best valid accuracy: 86.048 at epoch 8 
 best_stats: {'best_valid_epoch': 8, 'best_valid_valid/acc': 91.184, 'best_valid_valid/acc_unbiased': 86.048, 'best_valid_valid/diff': 3.529, 'best_valid_valid/acc_skew': 86.855, 'best_valid_valid/acc_align': 85.242, 'best_valid_test/acc': 91.096, 'best_valid_test/acc_unbiased': 86.303, 'best_valid_test/diff': 2.117, 'best_valid_test/acc_skew': 86.424, 'best_valid_test/acc_align': 86.182}
[9 / 10] best test accuracy: 86.303 at epoch 8 
 best_stats: {'best_test_epoch': 8, 'best_test_valid/acc': 91.184, 'best_test_valid/acc_unbiased': 86.048, 'best_test_valid/diff': 3.529, 'best_test_valid/acc_skew': 86.855, 'best_test_valid/acc_align': 85.242, 'best_test_test/acc': 91.096, 'best_test_test/acc_unbiased': 86.303, 'best_test_test/diff': 2.117, 'best_test_test/acc_skew': 86.424, 'best_test_test/acc_align': 86.182}
[10 / 10] Learning rate: 1e-05 weight: 0.01
[10 / 10] Loss: 4.720309398249921 CE Loss: 0.2189452472582968 Con Loss: 4.718119944164218
[10 / 10] tensor([[0.966, 0.949],
        [0.722, 0.718]]) {'epoch': 10, 'valid/acc': 91.357, 'valid/acc_unbiased': 83.807, 'valid/diff': 1.938, 'valid/acc_skew': 83.992, 'valid/acc_align': 83.621, 'test/acc': 90.975, 'test/acc_unbiased': 83.895, 'test/diff': 1.075, 'test/acc_skew': 83.591, 'test/acc_align': 84.2}
[10 / 10] best valid accuracy: 86.048 at epoch 8 
 best_stats: {'best_valid_epoch': 8, 'best_valid_valid/acc': 91.184, 'best_valid_valid/acc_unbiased': 86.048, 'best_valid_valid/diff': 3.529, 'best_valid_valid/acc_skew': 86.855, 'best_valid_valid/acc_align': 85.242, 'best_valid_test/acc': 91.096, 'best_valid_test/acc_unbiased': 86.303, 'best_valid_test/diff': 2.117, 'best_valid_test/acc_skew': 86.424, 'best_valid_test/acc_align': 86.182}
[10 / 10] best test accuracy: 86.303 at epoch 8 
 best_stats: {'best_test_epoch': 8, 'best_test_valid/acc': 91.184, 'best_test_valid/acc_unbiased': 86.048, 'best_test_valid/diff': 3.529, 'best_test_valid/acc_skew': 86.855, 'best_test_valid/acc_align': 85.242, 'best_test_test/acc': 91.096, 'best_test_test/acc_unbiased': 86.303, 'best_test_test/diff': 2.117, 'best_test_test/acc_skew': 86.424, 'best_test_test/acc_align': 86.182}
Total training time: 2:19:23
