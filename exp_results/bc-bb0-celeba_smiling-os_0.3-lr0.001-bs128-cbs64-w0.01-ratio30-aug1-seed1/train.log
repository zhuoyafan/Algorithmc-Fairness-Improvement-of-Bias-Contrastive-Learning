Log level set to: INFO
Set seed: 1
=======> Using Fixed Random Seed: 1 <========
save_path: exp_results/bc-bb0-celeba_smiling-os_0.3-lr0.001-bs128-cbs64-w0.01-ratio30-aug1-seed1
get_celeba - split:train, aug: False, given_y: True, ratio: 0
use existing smiling indices from data/celeba/pickles/smiling
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [12183, 12183]
Target 1: [12183, 12183]
Binary Target 1
---------------------------
Target 0: [12183, 12183]
Target 1: [12183, 12183]
===================================
Normal Label Distribution: 
Target 0: [12183, 12183]
Target 1: [12183, 12183]
===================================
Use BiasedCelebASplit 
 target_attr: smiling split: train 
 tensor([[12183., 12183.],
        [12183., 12183.]])
get_celeba - split:train, aug: 1, given_y: True, ratio: 30
use existing smiling indices from data/celeba/pickles/smiling
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [12210, 12210]
Target 1: [12210, 12210]
Binary Target 1
---------------------------
Target 0: [12210, 12210]
Target 1: [12210, 12210]
===================================
Normal Label Distribution: 
Target 0: [12210, 12210]
Target 1: [12210, 12210]
===================================
Use BiasedCelebASplit 
 target_attr: smiling split: train 
 tensor([[12210., 12210.],
        [12210., 12210.]])
get_celeba - split:train_valid, aug: False, given_y: True, ratio: 0
use existing smiling indices from data/celeba/pickles/smiling
Use BiasedCelebASplit 
 target_attr: smiling split: train_valid 
 tensor([[ 2019., 10233.],
        [ 8156.,  1957.]])
get_celeba - split:valid, aug: False, given_y: True, ratio: 0
Use BiasedCelebASplit 
 target_attr: smiling split: valid 
 tensor([[5252., 6157.],
        [5013., 3445.]])
decay_epochs: [3, 6]
[1 / 10] Learning rate: 0.001 weight: 0.01
[1 / 10] Loss: 4.677526546837729 CE Loss: 0.27809370049753773 Con Loss: 4.674745614096359
[1 / 10] tensor([[0.948, 0.925],
        [0.886, 0.888]]) {'epoch': 1, 'valid/acc': 90.637, 'valid/acc_unbiased': 91.289, 'valid/diff': 1.481, 'valid/acc_skew': 91.836, 'valid/acc_align': 90.742, 'test/acc': 91.262, 'test/acc_unbiased': 91.177, 'test/diff': 1.281, 'test/acc_skew': 91.727, 'test/acc_align': 90.627}
[1 / 10] best valid accuracy: 91.289 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 90.637, 'best_valid_valid/acc_unbiased': 91.289, 'best_valid_valid/diff': 1.481, 'best_valid_valid/acc_skew': 91.836, 'best_valid_valid/acc_align': 90.742, 'best_valid_test/acc': 91.262, 'best_valid_test/acc_unbiased': 91.177, 'best_valid_test/diff': 1.281, 'best_valid_test/acc_skew': 91.727, 'best_valid_test/acc_align': 90.627}
[1 / 10] best test accuracy: 91.177 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 90.637, 'best_test_valid/acc_unbiased': 91.289, 'best_test_valid/diff': 1.481, 'best_test_valid/acc_skew': 91.836, 'best_test_valid/acc_align': 90.742, 'best_test_test/acc': 91.262, 'best_test_test/acc_unbiased': 91.177, 'best_test_test/diff': 1.281, 'best_test_test/acc_skew': 91.727, 'best_test_test/acc_align': 90.627}
[2 / 10] Learning rate: 0.001 weight: 0.01
[2 / 10] Loss: 4.622083016219989 CE Loss: 0.24526405592549075 Con Loss: 4.619630375313933
[2 / 10] tensor([[0.962, 0.945],
        [0.877, 0.857]]) {'epoch': 2, 'valid/acc': 90.727, 'valid/acc_unbiased': 90.687, 'valid/diff': 2.459, 'valid/acc_skew': 91.916, 'valid/acc_align': 89.457, 'test/acc': 91.307, 'test/acc_unbiased': 91.014, 'test/diff': 1.885, 'test/acc_skew': 91.957, 'test/acc_align': 90.072}
[2 / 10] best valid accuracy: 91.289 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 90.637, 'best_valid_valid/acc_unbiased': 91.289, 'best_valid_valid/diff': 1.481, 'best_valid_valid/acc_skew': 91.836, 'best_valid_valid/acc_align': 90.742, 'best_valid_test/acc': 91.262, 'best_valid_test/acc_unbiased': 91.177, 'best_valid_test/diff': 1.281, 'best_valid_test/acc_skew': 91.727, 'best_valid_test/acc_align': 90.627}
[2 / 10] best test accuracy: 91.177 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 90.637, 'best_test_valid/acc_unbiased': 91.289, 'best_test_valid/diff': 1.481, 'best_test_valid/acc_skew': 91.836, 'best_test_valid/acc_align': 90.742, 'best_test_test/acc': 91.262, 'best_test_test/acc_unbiased': 91.177, 'best_test_test/diff': 1.281, 'best_test_test/acc_skew': 91.727, 'best_test_test/acc_align': 90.627}
[3 / 10] Learning rate: 0.001 weight: 0.01
[3 / 10] Loss: 4.607672890996068 CE Loss: 0.23211316216767916 Con Loss: 4.6053517650111715
[3 / 10] tensor([[0.902, 0.890],
        [0.933, 0.924]]) {'epoch': 3, 'valid/acc': 91.129, 'valid/acc_unbiased': 91.26, 'valid/diff': 1.669, 'valid/acc_skew': 92.095, 'valid/acc_align': 90.425, 'test/acc': 91.237, 'test/acc_unbiased': 91.225, 'test/diff': 1.037, 'test/acc_skew': 91.743, 'test/acc_align': 90.706}
[3 / 10] best valid accuracy: 91.289 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 90.637, 'best_valid_valid/acc_unbiased': 91.289, 'best_valid_valid/diff': 1.481, 'best_valid_valid/acc_skew': 91.836, 'best_valid_valid/acc_align': 90.742, 'best_valid_test/acc': 91.262, 'best_valid_test/acc_unbiased': 91.177, 'best_valid_test/diff': 1.281, 'best_valid_test/acc_skew': 91.727, 'best_valid_test/acc_align': 90.627}
[3 / 10] best test accuracy: 91.225 at epoch 3 
 best_stats: {'best_test_epoch': 3, 'best_test_valid/acc': 91.129, 'best_test_valid/acc_unbiased': 91.26, 'best_test_valid/diff': 1.669, 'best_test_valid/acc_skew': 92.095, 'best_test_valid/acc_align': 90.425, 'best_test_test/acc': 91.237, 'best_test_test/acc_unbiased': 91.225, 'best_test_test/diff': 1.037, 'best_test_test/acc_skew': 91.743, 'best_test_test/acc_align': 90.706}
[4 / 10] Learning rate: 0.0001 weight: 0.01
[4 / 10] Loss: 4.565078024538164 CE Loss: 0.20546046508500448 Con Loss: 4.563023422500785
[4 / 10] tensor([[0.942, 0.927],
        [0.916, 0.909]]) {'epoch': 4, 'valid/acc': 91.97, 'valid/acc_unbiased': 92.361, 'valid/diff': 1.161, 'valid/acc_skew': 92.942, 'valid/acc_align': 91.781, 'test/acc': 92.435, 'test/acc_unbiased': 92.341, 'test/diff': 1.108, 'test/acc_skew': 92.895, 'test/acc_align': 91.787}
[4 / 10] best valid accuracy: 92.361 at epoch 4 
 best_stats: {'best_valid_epoch': 4, 'best_valid_valid/acc': 91.97, 'best_valid_valid/acc_unbiased': 92.361, 'best_valid_valid/diff': 1.161, 'best_valid_valid/acc_skew': 92.942, 'best_valid_valid/acc_align': 91.781, 'best_valid_test/acc': 92.435, 'best_valid_test/acc_unbiased': 92.341, 'best_valid_test/diff': 1.108, 'best_valid_test/acc_skew': 92.895, 'best_valid_test/acc_align': 91.787}
[4 / 10] best test accuracy: 92.341 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 91.97, 'best_test_valid/acc_unbiased': 92.361, 'best_test_valid/diff': 1.161, 'best_test_valid/acc_skew': 92.942, 'best_test_valid/acc_align': 91.781, 'best_test_test/acc': 92.435, 'best_test_test/acc_unbiased': 92.341, 'best_test_test/diff': 1.108, 'best_test_test/acc_skew': 92.895, 'best_test_test/acc_align': 91.787}
[5 / 10] Learning rate: 0.0001 weight: 0.01
[5 / 10] Loss: 4.548029619631955 CE Loss: 0.19777393431024268 Con Loss: 4.546051878867689
[5 / 10] tensor([[0.922, 0.906],
        [0.939, 0.928]]) {'epoch': 5, 'valid/acc': 92.233, 'valid/acc_unbiased': 92.328, 'valid/diff': 1.534, 'valid/acc_skew': 93.095, 'valid/acc_align': 91.561, 'test/acc': 92.415, 'test/acc_unbiased': 92.361, 'test/diff': 1.366, 'test/acc_skew': 93.045, 'test/acc_align': 91.678}
[5 / 10] best valid accuracy: 92.361 at epoch 4 
 best_stats: {'best_valid_epoch': 4, 'best_valid_valid/acc': 91.97, 'best_valid_valid/acc_unbiased': 92.361, 'best_valid_valid/diff': 1.161, 'best_valid_valid/acc_skew': 92.942, 'best_valid_valid/acc_align': 91.781, 'best_valid_test/acc': 92.435, 'best_valid_test/acc_unbiased': 92.341, 'best_valid_test/diff': 1.108, 'best_valid_test/acc_skew': 92.895, 'best_valid_test/acc_align': 91.787}
[5 / 10] best test accuracy: 92.361 at epoch 5 
 best_stats: {'best_test_epoch': 5, 'best_test_valid/acc': 92.233, 'best_test_valid/acc_unbiased': 92.328, 'best_test_valid/diff': 1.534, 'best_test_valid/acc_skew': 93.095, 'best_test_valid/acc_align': 91.561, 'best_test_test/acc': 92.415, 'best_test_test/acc_unbiased': 92.361, 'best_test_test/diff': 1.366, 'best_test_test/acc_skew': 93.045, 'best_test_test/acc_align': 91.678}
[6 / 10] Learning rate: 0.0001 weight: 0.01
[6 / 10] Loss: 4.551196165882503 CE Loss: 0.19505578304324392 Con Loss: 4.549245611255142
[6 / 10] tensor([[0.941, 0.932],
        [0.922, 0.902]]) {'epoch': 6, 'valid/acc': 92.515, 'valid/acc_unbiased': 92.741, 'valid/diff': 1.227, 'valid/acc_skew': 93.355, 'valid/acc_align': 92.127, 'test/acc': 92.576, 'test/acc_unbiased': 92.393, 'test/diff': 1.448, 'test/acc_skew': 93.117, 'test/acc_align': 91.669}
[6 / 10] best valid accuracy: 92.741 at epoch 6 
 best_stats: {'best_valid_epoch': 6, 'best_valid_valid/acc': 92.515, 'best_valid_valid/acc_unbiased': 92.741, 'best_valid_valid/diff': 1.227, 'best_valid_valid/acc_skew': 93.355, 'best_valid_valid/acc_align': 92.127, 'best_valid_test/acc': 92.576, 'best_valid_test/acc_unbiased': 92.393, 'best_valid_test/diff': 1.448, 'best_valid_test/acc_skew': 93.117, 'best_valid_test/acc_align': 91.669}
[6 / 10] best test accuracy: 92.393 at epoch 6 
 best_stats: {'best_test_epoch': 6, 'best_test_valid/acc': 92.515, 'best_test_valid/acc_unbiased': 92.741, 'best_test_valid/diff': 1.227, 'best_test_valid/acc_skew': 93.355, 'best_test_valid/acc_align': 92.127, 'best_test_test/acc': 92.576, 'best_test_test/acc_unbiased': 92.393, 'best_test_test/diff': 1.448, 'best_test_test/acc_skew': 93.117, 'best_test_test/acc_align': 91.669}
[7 / 10] Learning rate: 1e-05 weight: 0.01
[7 / 10] Loss: 4.54542035687824 CE Loss: 0.1897136793794239 Con Loss: 4.543523225938512
[7 / 10] tensor([[0.948, 0.931],
        [0.920, 0.912]]) {'epoch': 7, 'valid/acc': 92.189, 'valid/acc_unbiased': 92.577, 'valid/diff': 1.284, 'valid/acc_skew': 93.219, 'valid/acc_align': 91.935, 'test/acc': 92.873, 'test/acc_unbiased': 92.773, 'test/diff': 1.215, 'test/acc_skew': 93.381, 'test/acc_align': 92.166}
[7 / 10] best valid accuracy: 92.741 at epoch 6 
 best_stats: {'best_valid_epoch': 6, 'best_valid_valid/acc': 92.515, 'best_valid_valid/acc_unbiased': 92.741, 'best_valid_valid/diff': 1.227, 'best_valid_valid/acc_skew': 93.355, 'best_valid_valid/acc_align': 92.127, 'best_valid_test/acc': 92.576, 'best_valid_test/acc_unbiased': 92.393, 'best_valid_test/diff': 1.448, 'best_valid_test/acc_skew': 93.117, 'best_valid_test/acc_align': 91.669}
[7 / 10] best test accuracy: 92.773 at epoch 7 
 best_stats: {'best_test_epoch': 7, 'best_test_valid/acc': 92.189, 'best_test_valid/acc_unbiased': 92.577, 'best_test_valid/diff': 1.284, 'best_test_valid/acc_skew': 93.219, 'best_test_valid/acc_align': 91.935, 'best_test_test/acc': 92.873, 'best_test_test/acc_unbiased': 92.773, 'best_test_test/diff': 1.215, 'best_test_test/acc_skew': 93.381, 'best_test_test/acc_align': 92.166}
[8 / 10] Learning rate: 1e-05 weight: 0.01
[8 / 10] Loss: 4.539354104767935 CE Loss: 0.1900950458387255 Con Loss: 4.537453148250147
[8 / 10] tensor([[0.946, 0.928],
        [0.919, 0.913]]) {'epoch': 8, 'valid/acc': 92.242, 'valid/acc_unbiased': 92.738, 'valid/diff': 1.389, 'valid/acc_skew': 93.357, 'valid/acc_align': 92.119, 'test/acc': 92.757, 'test/acc_unbiased': 92.671, 'test/diff': 1.194, 'test/acc_skew': 93.268, 'test/acc_align': 92.074}
[8 / 10] best valid accuracy: 92.741 at epoch 6 
 best_stats: {'best_valid_epoch': 6, 'best_valid_valid/acc': 92.515, 'best_valid_valid/acc_unbiased': 92.741, 'best_valid_valid/diff': 1.227, 'best_valid_valid/acc_skew': 93.355, 'best_valid_valid/acc_align': 92.127, 'best_valid_test/acc': 92.576, 'best_valid_test/acc_unbiased': 92.393, 'best_valid_test/diff': 1.448, 'best_valid_test/acc_skew': 93.117, 'best_valid_test/acc_align': 91.669}
[8 / 10] best test accuracy: 92.773 at epoch 7 
 best_stats: {'best_test_epoch': 7, 'best_test_valid/acc': 92.189, 'best_test_valid/acc_unbiased': 92.577, 'best_test_valid/diff': 1.284, 'best_test_valid/acc_skew': 93.219, 'best_test_valid/acc_align': 91.935, 'best_test_test/acc': 92.873, 'best_test_test/acc_unbiased': 92.773, 'best_test_test/diff': 1.215, 'best_test_test/acc_skew': 93.381, 'best_test_test/acc_align': 92.166}
[9 / 10] Learning rate: 1e-05 weight: 0.01
[9 / 10] Loss: 4.528914270422137 CE Loss: 0.1897578017862131 Con Loss: 4.527016688673052
[9 / 10] tensor([[0.944, 0.930],
        [0.918, 0.908]]) {'epoch': 9, 'valid/acc': 92.372, 'valid/acc_unbiased': 92.747, 'valid/diff': 1.315, 'valid/acc_skew': 93.405, 'valid/acc_align': 92.09, 'test/acc': 92.631, 'test/acc_unbiased': 92.514, 'test/diff': 1.202, 'test/acc_skew': 93.115, 'test/acc_align': 91.913}
[9 / 10] best valid accuracy: 92.747 at epoch 9 
 best_stats: {'best_valid_epoch': 9, 'best_valid_valid/acc': 92.372, 'best_valid_valid/acc_unbiased': 92.747, 'best_valid_valid/diff': 1.315, 'best_valid_valid/acc_skew': 93.405, 'best_valid_valid/acc_align': 92.09, 'best_valid_test/acc': 92.631, 'best_valid_test/acc_unbiased': 92.514, 'best_valid_test/diff': 1.202, 'best_valid_test/acc_skew': 93.115, 'best_valid_test/acc_align': 91.913}
[9 / 10] best test accuracy: 92.773 at epoch 7 
 best_stats: {'best_test_epoch': 7, 'best_test_valid/acc': 92.189, 'best_test_valid/acc_unbiased': 92.577, 'best_test_valid/diff': 1.284, 'best_test_valid/acc_skew': 93.219, 'best_test_valid/acc_align': 91.935, 'best_test_test/acc': 92.873, 'best_test_test/acc_unbiased': 92.773, 'best_test_test/diff': 1.215, 'best_test_test/acc_skew': 93.381, 'best_test_test/acc_align': 92.166}
[10 / 10] Learning rate: 1e-05 weight: 0.01
[10 / 10] Loss: 4.53089375915878 CE Loss: 0.18735226022657048 Con Loss: 4.529020227333462
[10 / 10] tensor([[0.936, 0.922],
        [0.930, 0.920]]) {'epoch': 10, 'valid/acc': 92.341, 'valid/acc_unbiased': 92.646, 'valid/diff': 1.379, 'valid/acc_skew': 93.336, 'valid/acc_align': 91.957, 'test/acc': 92.777, 'test/acc_unbiased': 92.689, 'test/diff': 1.259, 'test/acc_skew': 93.319, 'test/acc_align': 92.06}
[10 / 10] best valid accuracy: 92.747 at epoch 9 
 best_stats: {'best_valid_epoch': 9, 'best_valid_valid/acc': 92.372, 'best_valid_valid/acc_unbiased': 92.747, 'best_valid_valid/diff': 1.315, 'best_valid_valid/acc_skew': 93.405, 'best_valid_valid/acc_align': 92.09, 'best_valid_test/acc': 92.631, 'best_valid_test/acc_unbiased': 92.514, 'best_valid_test/diff': 1.202, 'best_valid_test/acc_skew': 93.115, 'best_valid_test/acc_align': 91.913}
[10 / 10] best test accuracy: 92.773 at epoch 7 
 best_stats: {'best_test_epoch': 7, 'best_test_valid/acc': 92.189, 'best_test_valid/acc_unbiased': 92.577, 'best_test_valid/diff': 1.284, 'best_test_valid/acc_skew': 93.219, 'best_test_valid/acc_align': 91.935, 'best_test_test/acc': 92.873, 'best_test_test/acc_unbiased': 92.773, 'best_test_test/diff': 1.215, 'best_test_test/acc_skew': 93.381, 'best_test_test/acc_align': 92.166}
Total training time: 0:53:29
