Log level set to: INFO
Set seed: 2
=======> Using Fixed Random Seed: 2 <========
save_path: exp_results/bc-bb0-celeba_smiling-os-lr0.001-bs128-cbs64-w0.01-ratio30-aug1-seed2
get_celeba - split:train, aug: False, given_y: True, ratio: 0
use existing smiling indices from data/celeba/pickles/smiling
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [40611, 40611]
Target 1: [40611, 40611]
Binary Target 1
---------------------------
Target 0: [40611, 40611]
Target 1: [40611, 40611]
===================================
Normal Label Distribution: 
Target 0: [40611, 40611]
Target 1: [40611, 40611]
===================================
Use BiasedCelebASplit 
 target_attr: smiling split: train 
 tensor([[40611., 40611.],
        [40611., 40611.]])
get_celeba - split:train, aug: 1, given_y: True, ratio: 30
use existing smiling indices from data/celeba/pickles/smiling
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [40769, 40769]
Target 1: [40769, 40769]
Binary Target 1
---------------------------
Target 0: [40769, 40769]
Target 1: [40769, 40769]
===================================
Normal Label Distribution: 
Target 0: [40769, 40769]
Target 1: [40769, 40769]
===================================
Use BiasedCelebASplit 
 target_attr: smiling split: train 
 tensor([[40769., 40769.],
        [40769., 40769.]])
get_celeba - split:train_valid, aug: False, given_y: True, ratio: 0
use existing smiling indices from data/celeba/pickles/smiling
Use BiasedCelebASplit 
 target_attr: smiling split: train_valid 
 tensor([[ 1973., 10114.],
        [ 8289.,  1989.]])
get_celeba - split:valid, aug: False, given_y: True, ratio: 0
Use BiasedCelebASplit 
 target_attr: smiling split: valid 
 tensor([[5252., 6157.],
        [5013., 3445.]])
decay_epochs: [3, 6]
[1 / 10] Learning rate: 0.001 weight: 0.01
[1 / 10] Loss: 4.624570619135024 CE Loss: 0.25583882259864943 Con Loss: 4.622012238428413
[1 / 10] tensor([[0.827, 0.801],
        [0.963, 0.966]]) {'epoch': 1, 'valid/acc': 88.643, 'valid/acc_unbiased': 88.711, 'valid/diff': 2.386, 'valid/acc_skew': 89.827, 'valid/acc_align': 87.595, 'test/acc': 88.639, 'test/acc_unbiased': 88.895, 'test/diff': 1.458, 'test/acc_skew': 89.477, 'test/acc_align': 88.313}
[1 / 10] best valid accuracy: 88.711 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 88.643, 'best_valid_valid/acc_unbiased': 88.711, 'best_valid_valid/diff': 2.386, 'best_valid_valid/acc_skew': 89.827, 'best_valid_valid/acc_align': 87.595, 'best_valid_test/acc': 88.639, 'best_valid_test/acc_unbiased': 88.895, 'best_valid_test/diff': 1.458, 'best_valid_test/acc_skew': 89.477, 'best_valid_test/acc_align': 88.313}
[1 / 10] best test accuracy: 88.895 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 88.643, 'best_test_valid/acc_unbiased': 88.711, 'best_test_valid/diff': 2.386, 'best_test_valid/acc_skew': 89.827, 'best_test_valid/acc_align': 87.595, 'best_test_test/acc': 88.639, 'best_test_test/acc_unbiased': 88.895, 'best_test_test/diff': 1.458, 'best_test_test/acc_skew': 89.477, 'best_test_test/acc_align': 88.313}
[2 / 10] Learning rate: 0.001 weight: 0.01
[2 / 10] Loss: 4.59477544042807 CE Loss: 0.2274915783275002 Con Loss: 4.592500529918946
[2 / 10] tensor([[0.986, 0.973],
        [0.815, 0.803]]) {'epoch': 2, 'valid/acc': 88.428, 'valid/acc_unbiased': 89.104, 'valid/diff': 1.387, 'valid/acc_skew': 89.797, 'valid/acc_align': 88.411, 'test/acc': 89.782, 'test/acc_unbiased': 89.412, 'test/diff': 1.218, 'test/acc_skew': 90.022, 'test/acc_align': 88.803}
[2 / 10] best valid accuracy: 89.104 at epoch 2 
 best_stats: {'best_valid_epoch': 2, 'best_valid_valid/acc': 88.428, 'best_valid_valid/acc_unbiased': 89.104, 'best_valid_valid/diff': 1.387, 'best_valid_valid/acc_skew': 89.797, 'best_valid_valid/acc_align': 88.411, 'best_valid_test/acc': 89.782, 'best_valid_test/acc_unbiased': 89.412, 'best_valid_test/diff': 1.218, 'best_valid_test/acc_skew': 90.022, 'best_valid_test/acc_align': 88.803}
[2 / 10] best test accuracy: 89.412 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 88.428, 'best_test_valid/acc_unbiased': 89.104, 'best_test_valid/diff': 1.387, 'best_test_valid/acc_skew': 89.797, 'best_test_valid/acc_align': 88.411, 'best_test_test/acc': 89.782, 'best_test_test/acc_unbiased': 89.412, 'best_test_test/diff': 1.218, 'best_test_test/acc_skew': 90.022, 'best_test_test/acc_align': 88.803}
[3 / 10] Learning rate: 0.001 weight: 0.01
[3 / 10] Loss: 4.5844153280855355 CE Loss: 0.22074823963285764 Con Loss: 4.5822078462910545
[3 / 10] tensor([[0.920, 0.897],
        [0.931, 0.927]]) {'epoch': 3, 'valid/acc': 91.621, 'valid/acc_unbiased': 91.806, 'valid/diff': 1.958, 'valid/acc_skew': 92.785, 'valid/acc_align': 90.827, 'test/acc': 91.876, 'test/acc_unbiased': 91.868, 'test/diff': 1.364, 'test/acc_skew': 92.55, 'test/acc_align': 91.186}
[3 / 10] best valid accuracy: 91.806 at epoch 3 
 best_stats: {'best_valid_epoch': 3, 'best_valid_valid/acc': 91.621, 'best_valid_valid/acc_unbiased': 91.806, 'best_valid_valid/diff': 1.958, 'best_valid_valid/acc_skew': 92.785, 'best_valid_valid/acc_align': 90.827, 'best_valid_test/acc': 91.876, 'best_valid_test/acc_unbiased': 91.868, 'best_valid_test/diff': 1.364, 'best_valid_test/acc_skew': 92.55, 'best_valid_test/acc_align': 91.186}
[3 / 10] best test accuracy: 91.868 at epoch 3 
 best_stats: {'best_test_epoch': 3, 'best_test_valid/acc': 91.621, 'best_test_valid/acc_unbiased': 91.806, 'best_test_valid/diff': 1.958, 'best_test_valid/acc_skew': 92.785, 'best_test_valid/acc_align': 90.827, 'best_test_test/acc': 91.876, 'best_test_test/acc_unbiased': 91.868, 'best_test_test/diff': 1.364, 'best_test_test/acc_skew': 92.55, 'best_test_test/acc_align': 91.186}
[4 / 10] Learning rate: 0.0001 weight: 0.01
[4 / 10] Loss: 4.542837501731685 CE Loss: 0.1955532024265178 Con Loss: 4.540881966526561
[4 / 10] tensor([[0.937, 0.920],
        [0.925, 0.917]]) {'epoch': 4, 'valid/acc': 92.529, 'valid/acc_unbiased': 92.76, 'valid/diff': 1.307, 'valid/acc_skew': 93.414, 'valid/acc_align': 92.106, 'test/acc': 92.561, 'test/acc_unbiased': 92.487, 'test/diff': 1.226, 'test/acc_skew': 93.1, 'test/acc_align': 91.874}
[4 / 10] best valid accuracy: 92.760 at epoch 4 
 best_stats: {'best_valid_epoch': 4, 'best_valid_valid/acc': 92.529, 'best_valid_valid/acc_unbiased': 92.76, 'best_valid_valid/diff': 1.307, 'best_valid_valid/acc_skew': 93.414, 'best_valid_valid/acc_align': 92.106, 'best_valid_test/acc': 92.561, 'best_valid_test/acc_unbiased': 92.487, 'best_valid_test/diff': 1.226, 'best_valid_test/acc_skew': 93.1, 'best_valid_test/acc_align': 91.874}
[4 / 10] best test accuracy: 92.487 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 92.529, 'best_test_valid/acc_unbiased': 92.76, 'best_test_valid/diff': 1.307, 'best_test_valid/acc_skew': 93.414, 'best_test_valid/acc_align': 92.106, 'best_test_test/acc': 92.561, 'best_test_test/acc_unbiased': 92.487, 'best_test_test/diff': 1.226, 'best_test_test/acc_skew': 93.1, 'best_test_test/acc_align': 91.874}
[5 / 10] Learning rate: 0.0001 weight: 0.01
[5 / 10] Loss: 4.529613385899476 CE Loss: 0.18935533387638348 Con Loss: 4.527719836871323
[5 / 10] tensor([[0.957, 0.937],
        [0.907, 0.900]]) {'epoch': 5, 'valid/acc': 92.233, 'valid/acc_unbiased': 92.694, 'valid/diff': 1.374, 'valid/acc_skew': 93.381, 'valid/acc_align': 92.008, 'test/acc': 92.666, 'test/acc_unbiased': 92.537, 'test/diff': 1.314, 'test/acc_skew': 93.194, 'test/acc_align': 91.88}
[5 / 10] best valid accuracy: 92.760 at epoch 4 
 best_stats: {'best_valid_epoch': 4, 'best_valid_valid/acc': 92.529, 'best_valid_valid/acc_unbiased': 92.76, 'best_valid_valid/diff': 1.307, 'best_valid_valid/acc_skew': 93.414, 'best_valid_valid/acc_align': 92.106, 'best_valid_test/acc': 92.561, 'best_valid_test/acc_unbiased': 92.487, 'best_valid_test/diff': 1.226, 'best_valid_test/acc_skew': 93.1, 'best_valid_test/acc_align': 91.874}
[5 / 10] best test accuracy: 92.537 at epoch 5 
 best_stats: {'best_test_epoch': 5, 'best_test_valid/acc': 92.233, 'best_test_valid/acc_unbiased': 92.694, 'best_test_valid/diff': 1.374, 'best_test_valid/acc_skew': 93.381, 'best_test_valid/acc_align': 92.008, 'best_test_test/acc': 92.666, 'best_test_test/acc_unbiased': 92.537, 'best_test_test/diff': 1.314, 'best_test_test/acc_skew': 93.194, 'best_test_test/acc_align': 91.88}
[6 / 10] Learning rate: 0.0001 weight: 0.01
[6 / 10] Loss: 4.525688979535937 CE Loss: 0.1859997145180111 Con Loss: 4.523828981839188
[6 / 10] tensor([[0.946, 0.933],
        [0.924, 0.915]]) {'epoch': 6, 'valid/acc': 92.833, 'valid/acc_unbiased': 92.884, 'valid/diff': 1.582, 'valid/acc_skew': 93.675, 'valid/acc_align': 92.093, 'test/acc': 93.034, 'test/acc_unbiased': 92.932, 'test/diff': 1.06, 'test/acc_skew': 93.462, 'test/acc_align': 92.402}
[6 / 10] best valid accuracy: 92.884 at epoch 6 
 best_stats: {'best_valid_epoch': 6, 'best_valid_valid/acc': 92.833, 'best_valid_valid/acc_unbiased': 92.884, 'best_valid_valid/diff': 1.582, 'best_valid_valid/acc_skew': 93.675, 'best_valid_valid/acc_align': 92.093, 'best_valid_test/acc': 93.034, 'best_valid_test/acc_unbiased': 92.932, 'best_valid_test/diff': 1.06, 'best_valid_test/acc_skew': 93.462, 'best_valid_test/acc_align': 92.402}
[6 / 10] best test accuracy: 92.932 at epoch 6 
 best_stats: {'best_test_epoch': 6, 'best_test_valid/acc': 92.833, 'best_test_valid/acc_unbiased': 92.884, 'best_test_valid/diff': 1.582, 'best_test_valid/acc_skew': 93.675, 'best_test_valid/acc_align': 92.093, 'best_test_test/acc': 93.034, 'best_test_test/acc_unbiased': 92.932, 'best_test_test/diff': 1.06, 'best_test_test/acc_skew': 93.462, 'best_test_test/acc_align': 92.402}
[7 / 10] Learning rate: 1e-05 weight: 0.01
[7 / 10] Loss: 4.518717101692804 CE Loss: 0.1818787791257784 Con Loss: 4.51689831421683
[7 / 10] tensor([[0.945, 0.935],
        [0.922, 0.913]]) {'epoch': 7, 'valid/acc': 93.007, 'valid/acc_unbiased': 93.133, 'valid/diff': 1.677, 'valid/acc_skew': 93.971, 'valid/acc_align': 92.294, 'test/acc': 92.973, 'test/acc_unbiased': 92.864, 'test/diff': 1.008, 'test/acc_skew': 93.368, 'test/acc_align': 92.36}
[7 / 10] best valid accuracy: 93.133 at epoch 7 
 best_stats: {'best_valid_epoch': 7, 'best_valid_valid/acc': 93.007, 'best_valid_valid/acc_unbiased': 93.133, 'best_valid_valid/diff': 1.677, 'best_valid_valid/acc_skew': 93.971, 'best_valid_valid/acc_align': 92.294, 'best_valid_test/acc': 92.973, 'best_valid_test/acc_unbiased': 92.864, 'best_valid_test/diff': 1.008, 'best_valid_test/acc_skew': 93.368, 'best_valid_test/acc_align': 92.36}
[7 / 10] best test accuracy: 92.932 at epoch 6 
 best_stats: {'best_test_epoch': 6, 'best_test_valid/acc': 92.833, 'best_test_valid/acc_unbiased': 92.884, 'best_test_valid/diff': 1.582, 'best_test_valid/acc_skew': 93.675, 'best_test_valid/acc_align': 92.093, 'best_test_test/acc': 93.034, 'best_test_test/acc_unbiased': 92.932, 'best_test_test/diff': 1.06, 'best_test_test/acc_skew': 93.462, 'best_test_test/acc_align': 92.402}
[8 / 10] Learning rate: 1e-05 weight: 0.01
[8 / 10] Loss: 4.51765162388654 CE Loss: 0.18041312923583686 Con Loss: 4.5158474940544
[8 / 10] tensor([[0.947, 0.938],
        [0.920, 0.904]]) {'epoch': 8, 'valid/acc': 93.074, 'valid/acc_unbiased': 93.164, 'valid/diff': 1.499, 'valid/acc_skew': 93.914, 'valid/acc_align': 92.415, 'test/acc': 92.913, 'test/acc_unbiased': 92.745, 'test/diff': 1.281, 'test/acc_skew': 93.385, 'test/acc_align': 92.104}
[8 / 10] best valid accuracy: 93.164 at epoch 8 
 best_stats: {'best_valid_epoch': 8, 'best_valid_valid/acc': 93.074, 'best_valid_valid/acc_unbiased': 93.164, 'best_valid_valid/diff': 1.499, 'best_valid_valid/acc_skew': 93.914, 'best_valid_valid/acc_align': 92.415, 'best_valid_test/acc': 92.913, 'best_valid_test/acc_unbiased': 92.745, 'best_valid_test/diff': 1.281, 'best_valid_test/acc_skew': 93.385, 'best_valid_test/acc_align': 92.104}
[8 / 10] best test accuracy: 92.932 at epoch 6 
 best_stats: {'best_test_epoch': 6, 'best_test_valid/acc': 92.833, 'best_test_valid/acc_unbiased': 92.884, 'best_test_valid/diff': 1.582, 'best_test_valid/acc_skew': 93.675, 'best_test_valid/acc_align': 92.093, 'best_test_test/acc': 93.034, 'best_test_test/acc_unbiased': 92.932, 'best_test_test/diff': 1.06, 'best_test_test/acc_skew': 93.462, 'best_test_test/acc_align': 92.402}
[9 / 10] Learning rate: 1e-05 weight: 0.01
[9 / 10] Loss: 4.513586580032687 CE Loss: 0.1800993147222279 Con Loss: 4.511785585917677
[9 / 10] tensor([[0.955, 0.944],
        [0.915, 0.899]]) {'epoch': 9, 'valid/acc': 92.918, 'valid/acc_unbiased': 92.975, 'valid/diff': 1.298, 'valid/acc_skew': 93.624, 'valid/acc_align': 92.326, 'test/acc': 92.988, 'test/acc_unbiased': 92.807, 'test/diff': 1.331, 'test/acc_skew': 93.472, 'test/acc_align': 92.141}
[9 / 10] best valid accuracy: 93.164 at epoch 8 
 best_stats: {'best_valid_epoch': 8, 'best_valid_valid/acc': 93.074, 'best_valid_valid/acc_unbiased': 93.164, 'best_valid_valid/diff': 1.499, 'best_valid_valid/acc_skew': 93.914, 'best_valid_valid/acc_align': 92.415, 'best_valid_test/acc': 92.913, 'best_valid_test/acc_unbiased': 92.745, 'best_valid_test/diff': 1.281, 'best_valid_test/acc_skew': 93.385, 'best_valid_test/acc_align': 92.104}
[9 / 10] best test accuracy: 92.932 at epoch 6 
 best_stats: {'best_test_epoch': 6, 'best_test_valid/acc': 92.833, 'best_test_valid/acc_unbiased': 92.884, 'best_test_valid/diff': 1.582, 'best_test_valid/acc_skew': 93.675, 'best_test_valid/acc_align': 92.093, 'best_test_test/acc': 93.034, 'best_test_test/acc_unbiased': 92.932, 'best_test_test/diff': 1.06, 'best_test_test/acc_skew': 93.462, 'best_test_test/acc_align': 92.402}
[10 / 10] Learning rate: 1e-05 weight: 0.01
[10 / 10] Loss: 4.515796892615558 CE Loss: 0.1792123351400777 Con Loss: 4.514004773605883
[10 / 10] tensor([[0.953, 0.942],
        [0.919, 0.908]]) {'epoch': 10, 'valid/acc': 92.931, 'valid/acc_unbiased': 93.017, 'valid/diff': 1.72, 'valid/acc_skew': 93.877, 'valid/acc_align': 92.156, 'test/acc': 93.17, 'test/acc_unbiased': 93.034, 'test/diff': 1.086, 'test/acc_skew': 93.577, 'test/acc_align': 92.491}
[10 / 10] best valid accuracy: 93.164 at epoch 8 
 best_stats: {'best_valid_epoch': 8, 'best_valid_valid/acc': 93.074, 'best_valid_valid/acc_unbiased': 93.164, 'best_valid_valid/diff': 1.499, 'best_valid_valid/acc_skew': 93.914, 'best_valid_valid/acc_align': 92.415, 'best_valid_test/acc': 92.913, 'best_valid_test/acc_unbiased': 92.745, 'best_valid_test/diff': 1.281, 'best_valid_test/acc_skew': 93.385, 'best_valid_test/acc_align': 92.104}
[10 / 10] best test accuracy: 93.034 at epoch 10 
 best_stats: {'best_test_epoch': 10, 'best_test_valid/acc': 92.931, 'best_test_valid/acc_unbiased': 93.017, 'best_test_valid/diff': 1.72, 'best_test_valid/acc_skew': 93.877, 'best_test_valid/acc_align': 92.156, 'best_test_test/acc': 93.17, 'best_test_test/acc_unbiased': 93.034, 'best_test_test/diff': 1.086, 'best_test_test/acc_skew': 93.577, 'best_test_test/acc_align': 92.491}
Total training time: 2:25:13
