Log level set to: INFO
Set seed: 3
=======> Using Fixed Random Seed: 3 <========
save_path: exp_results/bc-bb0-utk_face_race-crop_cutout_color-0.9-lr0.001-bs128-cbs64-w0.01-ratio10-aug1-seed3
get_utk_face - split: train, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_race-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [4407, 552]
Target 1: [440, 5529]
Binary Target 1
---------------------------
Target 0: [4407, 552]
Target 1: [440, 5529]
===================================
Normal Label Distribution: 
Target 0: [4407, 552]
Target 1: [440, 5529]
===================================
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [4407, 552]
Target 1: [440, 5529]
Binary Target 1
---------------------------
Target 0: [4407, 552]
Target 1: [440, 5529]
===================================
Normal Label Distribution: 
Target 0: [4407, 552]
Target 1: [440, 5529]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 10928, target_attr: gender, bias_attr: race bias_rate: 0.9
['[train] target_0-bias_0: 4407', '[train] target_0-bias_1: 552', '[train] target_1-bias_0: 440', '[train] target_1-bias_1: 5529']
confusion_matrix - 
 original: tensor([[4407.,  440.],
        [ 552., 5529.]]), 
 normalized: tensor([[0.909, 0.091],
        [0.091, 0.909]]), 
 b|y: tensor([[0.889, 0.111],
        [0.074, 0.926]])
get_utk_face - split: train, aug: 1, given_y: True, ratio: 10
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_race-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [4407, 552]
Target 1: [440, 5529]
Binary Target 1
---------------------------
Target 0: [4407, 552]
Target 1: [440, 5529]
===================================
Normal Label Distribution: 
Target 0: [4407, 552]
Target 1: [440, 5529]
===================================
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [4407, 552]
Target 1: [440, 5529]
Binary Target 1
---------------------------
Target 0: [4407, 552]
Target 1: [440, 5529]
===================================
Normal Label Distribution: 
Target 0: [4407, 552]
Target 1: [440, 5529]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 10928, target_attr: gender, bias_attr: race bias_rate: 0.9
['[train] target_0-bias_0: 4407', '[train] target_0-bias_1: 552', '[train] target_1-bias_0: 440', '[train] target_1-bias_1: 5529']
get_utk_face - split: valid, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_race-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [583, 684]
Target 1: [457, 646]
Binary Target 1
---------------------------
Target 0: [583, 684]
Target 1: [457, 646]
===================================
Normal Label Distribution: 
Target 0: [583, 684]
Target 1: [457, 646]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 2370, target_attr: gender, bias_attr: race bias_rate: 0.9
['[valid] target_0-bias_0: 583', '[valid] target_0-bias_1: 684', '[valid] target_1-bias_0: 457', '[valid] target_1-bias_1: 646']
get_utk_face - split: test, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_race-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [558, 677]
Target 1: [462, 673]
Binary Target 1
---------------------------
Target 0: [558, 677]
Target 1: [462, 673]
===================================
Normal Label Distribution: 
Target 0: [558, 677]
Target 1: [462, 673]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 2370, target_attr: gender, bias_attr: race bias_rate: 0.9
['[test] target_0-bias_0: 558', '[test] target_0-bias_1: 677', '[test] target_1-bias_0: 462', '[test] target_1-bias_1: 673']
decay_epochs: [6, 13]
[1 / 20] Learning rate: 0.001 weight: 0.01
[1 / 20] Loss: 4.914440016795392 CE Loss: 0.6075248314206806 Con Loss: 4.908364763022516
[1 / 20] tensor([[0.695, 0.679],
        [0.755, 0.744]]) {'epoch': 1, 'valid/acc': 71.561, 'valid/acc_unbiased': 71.72, 'valid/diff': 2.745, 'valid/acc_skew': 70.571, 'valid/acc_align': 72.869, 'test/acc': 71.646, 'test/acc_unbiased': 71.866, 'test/diff': 1.343, 'test/acc_skew': 71.744, 'test/acc_align': 71.988}
[1 / 20] best valid accuracy: 71.720 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 71.561, 'best_valid_valid/acc_unbiased': 71.72, 'best_valid_valid/diff': 2.745, 'best_valid_valid/acc_skew': 70.571, 'best_valid_valid/acc_align': 72.869, 'best_valid_test/acc': 71.646, 'best_valid_test/acc_unbiased': 71.866, 'best_valid_test/diff': 1.343, 'best_valid_test/acc_skew': 71.744, 'best_valid_test/acc_align': 71.988}
[1 / 20] best test accuracy: 71.866 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 71.561, 'best_test_valid/acc_unbiased': 71.72, 'best_test_valid/diff': 2.745, 'best_test_valid/acc_skew': 70.571, 'best_test_valid/acc_align': 72.869, 'best_test_test/acc': 71.646, 'best_test_test/acc_unbiased': 71.866, 'best_test_test/diff': 1.343, 'best_test_test/acc_skew': 71.744, 'best_test_test/acc_align': 71.988}
[2 / 20] Learning rate: 0.001 weight: 0.01
[2 / 20] Loss: 4.82130640666621 CE Loss: 0.5220200406335632 Con Loss: 4.81608621407393
[2 / 20] tensor([[0.912, 0.882],
        [0.632, 0.667]]) {'epoch': 2, 'valid/acc': 77.3, 'valid/acc_unbiased': 76.346, 'valid/diff': 2.023, 'valid/acc_skew': 75.335, 'valid/acc_align': 77.358, 'test/acc': 77.932, 'test/acc_unbiased': 77.33, 'test/diff': 3.274, 'test/acc_skew': 75.693, 'test/acc_align': 78.967}
[2 / 20] best valid accuracy: 76.346 at epoch 2 
 best_stats: {'best_valid_epoch': 2, 'best_valid_valid/acc': 77.3, 'best_valid_valid/acc_unbiased': 76.346, 'best_valid_valid/diff': 2.023, 'best_valid_valid/acc_skew': 75.335, 'best_valid_valid/acc_align': 77.358, 'best_valid_test/acc': 77.932, 'best_valid_test/acc_unbiased': 77.33, 'best_valid_test/diff': 3.274, 'best_valid_test/acc_skew': 75.693, 'best_valid_test/acc_align': 78.967}
[2 / 20] best test accuracy: 77.330 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 77.3, 'best_test_valid/acc_unbiased': 76.346, 'best_test_valid/diff': 2.023, 'best_test_valid/acc_skew': 75.335, 'best_test_valid/acc_align': 77.358, 'best_test_test/acc': 77.932, 'best_test_test/acc_unbiased': 77.33, 'best_test_test/diff': 3.274, 'best_test_test/acc_skew': 75.693, 'best_test_test/acc_align': 78.967}
[3 / 20] Learning rate: 0.001 weight: 0.01
[3 / 20] Loss: 4.794399442993879 CE Loss: 0.47490245985251744 Con Loss: 4.789650415082627
[3 / 20] tensor([[0.722, 0.665],
        [0.896, 0.909]]) {'epoch': 3, 'valid/acc': 78.734, 'valid/acc_unbiased': 79.392, 'valid/diff': 3.056, 'valid/acc_skew': 77.864, 'valid/acc_align': 80.921, 'test/acc': 79.283, 'test/acc_unbiased': 79.81, 'test/diff': 3.539, 'test/acc_skew': 78.04, 'test/acc_align': 81.579}
[3 / 20] best valid accuracy: 79.392 at epoch 3 
 best_stats: {'best_valid_epoch': 3, 'best_valid_valid/acc': 78.734, 'best_valid_valid/acc_unbiased': 79.392, 'best_valid_valid/diff': 3.056, 'best_valid_valid/acc_skew': 77.864, 'best_valid_valid/acc_align': 80.921, 'best_valid_test/acc': 79.283, 'best_valid_test/acc_unbiased': 79.81, 'best_valid_test/diff': 3.539, 'best_valid_test/acc_skew': 78.04, 'best_valid_test/acc_align': 81.579}
[3 / 20] best test accuracy: 79.810 at epoch 3 
 best_stats: {'best_test_epoch': 3, 'best_test_valid/acc': 78.734, 'best_test_valid/acc_unbiased': 79.392, 'best_test_valid/diff': 3.056, 'best_test_valid/acc_skew': 77.864, 'best_test_valid/acc_align': 80.921, 'best_test_test/acc': 79.283, 'best_test_test/acc_unbiased': 79.81, 'best_test_test/diff': 3.539, 'best_test_test/acc_skew': 78.04, 'best_test_test/acc_align': 81.579}
[4 / 20] Learning rate: 0.001 weight: 0.01
[4 / 20] Loss: 4.783026931924667 CE Loss: 0.44315499992356644 Con Loss: 4.778595389593747
[4 / 20] tensor([[0.516, 0.570],
        [0.935, 0.951]]) {'epoch': 4, 'valid/acc': 72.236, 'valid/acc_unbiased': 73.591, 'valid/diff': 1.954, 'valid/acc_skew': 74.568, 'valid/acc_align': 72.614, 'test/acc': 73.671, 'test/acc_unbiased': 74.308, 'test/diff': 3.497, 'test/acc_skew': 75.261, 'test/acc_align': 73.355}
[4 / 20] best valid accuracy: 79.392 at epoch 3 
 best_stats: {'best_valid_epoch': 3, 'best_valid_valid/acc': 78.734, 'best_valid_valid/acc_unbiased': 79.392, 'best_valid_valid/diff': 3.056, 'best_valid_valid/acc_skew': 77.864, 'best_valid_valid/acc_align': 80.921, 'best_valid_test/acc': 79.283, 'best_valid_test/acc_unbiased': 79.81, 'best_valid_test/diff': 3.539, 'best_valid_test/acc_skew': 78.04, 'best_valid_test/acc_align': 81.579}
[4 / 20] best test accuracy: 79.810 at epoch 3 
 best_stats: {'best_test_epoch': 3, 'best_test_valid/acc': 78.734, 'best_test_valid/acc_unbiased': 79.392, 'best_test_valid/diff': 3.056, 'best_test_valid/acc_skew': 77.864, 'best_test_valid/acc_align': 80.921, 'best_test_test/acc': 79.283, 'best_test_test/acc_unbiased': 79.81, 'best_test_test/diff': 3.539, 'best_test_test/acc_skew': 78.04, 'best_test_test/acc_align': 81.579}
[5 / 20] Learning rate: 0.001 weight: 0.01
[5 / 20] Loss: 4.766524754715524 CE Loss: 0.43596430997722846 Con Loss: 4.762165112865443
[5 / 20] tensor([[0.876, 0.857],
        [0.745, 0.768]]) {'epoch': 5, 'valid/acc': 81.646, 'valid/acc_unbiased': 81.351, 'valid/diff': 2.735, 'valid/acc_skew': 82.518, 'valid/acc_align': 80.184, 'test/acc': 81.435, 'test/acc_unbiased': 81.146, 'test/diff': 2.162, 'test/acc_skew': 80.065, 'test/acc_align': 82.227}
[5 / 20] best valid accuracy: 81.351 at epoch 5 
 best_stats: {'best_valid_epoch': 5, 'best_valid_valid/acc': 81.646, 'best_valid_valid/acc_unbiased': 81.351, 'best_valid_valid/diff': 2.735, 'best_valid_valid/acc_skew': 82.518, 'best_valid_valid/acc_align': 80.184, 'best_valid_test/acc': 81.435, 'best_valid_test/acc_unbiased': 81.146, 'best_valid_test/diff': 2.162, 'best_valid_test/acc_skew': 80.065, 'best_valid_test/acc_align': 82.227}
[5 / 20] best test accuracy: 81.146 at epoch 5 
 best_stats: {'best_test_epoch': 5, 'best_test_valid/acc': 81.646, 'best_test_valid/acc_unbiased': 81.351, 'best_test_valid/diff': 2.735, 'best_test_valid/acc_skew': 82.518, 'best_test_valid/acc_align': 80.184, 'best_test_test/acc': 81.435, 'best_test_test/acc_unbiased': 81.146, 'best_test_test/diff': 2.162, 'best_test_test/acc_skew': 80.065, 'best_test_test/acc_align': 82.227}
[6 / 20] Learning rate: 0.001 weight: 0.01
[6 / 20] Loss: 4.761110105416785 CE Loss: 0.4319103338795211 Con Loss: 4.756791026840098
[6 / 20] tensor([[0.742, 0.694],
        [0.883, 0.917]]) {'epoch': 6, 'valid/acc': 81.013, 'valid/acc_unbiased': 81.645, 'valid/diff': 0.692, 'valid/acc_skew': 81.991, 'valid/acc_align': 81.299, 'test/acc': 80.549, 'test/acc_unbiased': 80.902, 'test/diff': 4.068, 'test/acc_skew': 78.868, 'test/acc_align': 82.936}
[6 / 20] best valid accuracy: 81.645 at epoch 6 
 best_stats: {'best_valid_epoch': 6, 'best_valid_valid/acc': 81.013, 'best_valid_valid/acc_unbiased': 81.645, 'best_valid_valid/diff': 0.692, 'best_valid_valid/acc_skew': 81.991, 'best_valid_valid/acc_align': 81.299, 'best_valid_test/acc': 80.549, 'best_valid_test/acc_unbiased': 80.902, 'best_valid_test/diff': 4.068, 'best_valid_test/acc_skew': 78.868, 'best_valid_test/acc_align': 82.936}
[6 / 20] best test accuracy: 81.146 at epoch 5 
 best_stats: {'best_test_epoch': 5, 'best_test_valid/acc': 81.646, 'best_test_valid/acc_unbiased': 81.351, 'best_test_valid/diff': 2.735, 'best_test_valid/acc_skew': 82.518, 'best_test_valid/acc_align': 80.184, 'best_test_test/acc': 81.435, 'best_test_test/acc_unbiased': 81.146, 'best_test_test/diff': 2.162, 'best_test_test/acc_skew': 80.065, 'best_test_test/acc_align': 82.227}
[7 / 20] Learning rate: 0.0001 weight: 0.01
[7 / 20] Loss: 4.7193705033767275 CE Loss: 0.3823730881008187 Con Loss: 4.7155467741311385
[7 / 20] tensor([[0.844, 0.806],
        [0.844, 0.880]]) {'epoch': 7, 'valid/acc': 84.008, 'valid/acc_unbiased': 84.157, 'valid/diff': 2.103, 'valid/acc_skew': 83.825, 'valid/acc_align': 84.489, 'test/acc': 84.346, 'test/acc_unbiased': 84.36, 'test/diff': 3.654, 'test/acc_skew': 82.533, 'test/acc_align': 86.186}
[7 / 20] best valid accuracy: 84.157 at epoch 7 
 best_stats: {'best_valid_epoch': 7, 'best_valid_valid/acc': 84.008, 'best_valid_valid/acc_unbiased': 84.157, 'best_valid_valid/diff': 2.103, 'best_valid_valid/acc_skew': 83.825, 'best_valid_valid/acc_align': 84.489, 'best_valid_test/acc': 84.346, 'best_valid_test/acc_unbiased': 84.36, 'best_valid_test/diff': 3.654, 'best_valid_test/acc_skew': 82.533, 'best_valid_test/acc_align': 86.186}
[7 / 20] best test accuracy: 84.360 at epoch 7 
 best_stats: {'best_test_epoch': 7, 'best_test_valid/acc': 84.008, 'best_test_valid/acc_unbiased': 84.157, 'best_test_valid/diff': 2.103, 'best_test_valid/acc_skew': 83.825, 'best_test_valid/acc_align': 84.489, 'best_test_test/acc': 84.346, 'best_test_test/acc_unbiased': 84.36, 'best_test_test/diff': 3.654, 'best_test_test/acc_skew': 82.533, 'best_test_test/acc_align': 86.186}
[8 / 20] Learning rate: 0.0001 weight: 0.01
[8 / 20] Loss: 4.697125445347754 CE Loss: 0.35990769731352656 Con Loss: 4.693526365746516
[8 / 20] tensor([[0.821, 0.777],
        [0.881, 0.909]]) {'epoch': 8, 'valid/acc': 84.388, 'valid/acc_unbiased': 84.703, 'valid/diff': 2.639, 'valid/acc_skew': 83.383, 'valid/acc_align': 86.022, 'test/acc': 84.515, 'test/acc_unbiased': 84.701, 'test/diff': 3.612, 'test/acc_skew': 82.895, 'test/acc_align': 86.507}
[8 / 20] best valid accuracy: 84.703 at epoch 8 
 best_stats: {'best_valid_epoch': 8, 'best_valid_valid/acc': 84.388, 'best_valid_valid/acc_unbiased': 84.703, 'best_valid_valid/diff': 2.639, 'best_valid_valid/acc_skew': 83.383, 'best_valid_valid/acc_align': 86.022, 'best_valid_test/acc': 84.515, 'best_valid_test/acc_unbiased': 84.701, 'best_valid_test/diff': 3.612, 'best_valid_test/acc_skew': 82.895, 'best_valid_test/acc_align': 86.507}
[8 / 20] best test accuracy: 84.701 at epoch 8 
 best_stats: {'best_test_epoch': 8, 'best_test_valid/acc': 84.388, 'best_test_valid/acc_unbiased': 84.703, 'best_test_valid/diff': 2.639, 'best_test_valid/acc_skew': 83.383, 'best_test_valid/acc_align': 86.022, 'best_test_test/acc': 84.515, 'best_test_test/acc_unbiased': 84.701, 'best_test_test/diff': 3.612, 'best_test_test/acc_skew': 82.895, 'best_test_test/acc_align': 86.507}
[9 / 20] Learning rate: 0.0001 weight: 0.01
[9 / 20] Loss: 4.683017730712891 CE Loss: 0.34923856481800664 Con Loss: 4.67952532789194
[9 / 20] tensor([[0.837, 0.783],
        [0.861, 0.900]]) {'epoch': 9, 'valid/acc': 84.726, 'valid/acc_unbiased': 84.971, 'valid/diff': 2.735, 'valid/acc_skew': 83.603, 'valid/acc_align': 86.338, 'test/acc': 84.43, 'test/acc_unbiased': 84.543, 'test/diff': 4.651, 'test/acc_skew': 82.217, 'test/acc_align': 86.868}
[9 / 20] best valid accuracy: 84.971 at epoch 9 
 best_stats: {'best_valid_epoch': 9, 'best_valid_valid/acc': 84.726, 'best_valid_valid/acc_unbiased': 84.971, 'best_valid_valid/diff': 2.735, 'best_valid_valid/acc_skew': 83.603, 'best_valid_valid/acc_align': 86.338, 'best_valid_test/acc': 84.43, 'best_valid_test/acc_unbiased': 84.543, 'best_valid_test/diff': 4.651, 'best_valid_test/acc_skew': 82.217, 'best_valid_test/acc_align': 86.868}
[9 / 20] best test accuracy: 84.701 at epoch 8 
 best_stats: {'best_test_epoch': 8, 'best_test_valid/acc': 84.388, 'best_test_valid/acc_unbiased': 84.703, 'best_test_valid/diff': 2.639, 'best_test_valid/acc_skew': 83.383, 'best_test_valid/acc_align': 86.022, 'best_test_test/acc': 84.515, 'best_test_test/acc_unbiased': 84.701, 'best_test_test/diff': 3.612, 'best_test_test/acc_skew': 82.895, 'best_test_test/acc_align': 86.507}
[10 / 20] Learning rate: 0.0001 weight: 0.01
[10 / 20] Loss: 4.671449798790637 CE Loss: 0.3422559105285265 Con Loss: 4.6680272362068145
[10 / 20] tensor([[0.835, 0.786],
        [0.866, 0.903]]) {'epoch': 10, 'valid/acc': 84.979, 'valid/acc_unbiased': 85.216, 'valid/diff': 2.056, 'valid/acc_skew': 84.188, 'valid/acc_align': 86.244, 'test/acc': 84.641, 'test/acc_unbiased': 84.754, 'test/diff': 4.346, 'test/acc_skew': 82.581, 'test/acc_align': 86.927}
[10 / 20] best valid accuracy: 85.216 at epoch 10 
 best_stats: {'best_valid_epoch': 10, 'best_valid_valid/acc': 84.979, 'best_valid_valid/acc_unbiased': 85.216, 'best_valid_valid/diff': 2.056, 'best_valid_valid/acc_skew': 84.188, 'best_valid_valid/acc_align': 86.244, 'best_valid_test/acc': 84.641, 'best_valid_test/acc_unbiased': 84.754, 'best_valid_test/diff': 4.346, 'best_valid_test/acc_skew': 82.581, 'best_valid_test/acc_align': 86.927}
[10 / 20] best test accuracy: 84.754 at epoch 10 
 best_stats: {'best_test_epoch': 10, 'best_test_valid/acc': 84.979, 'best_test_valid/acc_unbiased': 85.216, 'best_test_valid/diff': 2.056, 'best_test_valid/acc_skew': 84.188, 'best_test_valid/acc_align': 86.244, 'best_test_test/acc': 84.641, 'best_test_test/acc_unbiased': 84.754, 'best_test_test/diff': 4.346, 'best_test_test/acc_skew': 82.581, 'best_test_test/acc_align': 86.927}
[11 / 20] Learning rate: 0.0001 weight: 0.01
[11 / 20] Loss: 4.667079330712426 CE Loss: 0.3372510170910404 Con Loss: 4.663706824161647
[11 / 20] tensor([[0.803, 0.739],
        [0.894, 0.938]]) {'epoch': 11, 'valid/acc': 84.684, 'valid/acc_unbiased': 85.147, 'valid/diff': 2.584, 'valid/acc_skew': 83.855, 'valid/acc_align': 86.439, 'test/acc': 84.051, 'test/acc_unbiased': 84.324, 'test/diff': 5.398, 'test/acc_skew': 81.625, 'test/acc_align': 87.023}
[11 / 20] best valid accuracy: 85.216 at epoch 10 
 best_stats: {'best_valid_epoch': 10, 'best_valid_valid/acc': 84.979, 'best_valid_valid/acc_unbiased': 85.216, 'best_valid_valid/diff': 2.056, 'best_valid_valid/acc_skew': 84.188, 'best_valid_valid/acc_align': 86.244, 'best_valid_test/acc': 84.641, 'best_valid_test/acc_unbiased': 84.754, 'best_valid_test/diff': 4.346, 'best_valid_test/acc_skew': 82.581, 'best_valid_test/acc_align': 86.927}
[11 / 20] best test accuracy: 84.754 at epoch 10 
 best_stats: {'best_test_epoch': 10, 'best_test_valid/acc': 84.979, 'best_test_valid/acc_unbiased': 85.216, 'best_test_valid/diff': 2.056, 'best_test_valid/acc_skew': 84.188, 'best_test_valid/acc_align': 86.244, 'best_test_test/acc': 84.641, 'best_test_test/acc_unbiased': 84.754, 'best_test_test/diff': 4.346, 'best_test_test/acc_skew': 82.581, 'best_test_test/acc_align': 86.927}
[12 / 20] Learning rate: 0.0001 weight: 0.01
[12 / 20] Loss: 4.664996669372737 CE Loss: 0.33752789753073303 Con Loss: 4.661621371614113
[12 / 20] tensor([[0.849, 0.795],
        [0.853, 0.886]]) {'epoch': 12, 'valid/acc': 84.979, 'valid/acc_unbiased': 85.001, 'valid/diff': 3.959, 'valid/acc_skew': 83.022, 'valid/acc_align': 86.98, 'test/acc': 84.473, 'test/acc_unbiased': 84.564, 'test/diff': 4.378, 'test/acc_skew': 82.375, 'test/acc_align': 86.752}
[12 / 20] best valid accuracy: 85.216 at epoch 10 
 best_stats: {'best_valid_epoch': 10, 'best_valid_valid/acc': 84.979, 'best_valid_valid/acc_unbiased': 85.216, 'best_valid_valid/diff': 2.056, 'best_valid_valid/acc_skew': 84.188, 'best_valid_valid/acc_align': 86.244, 'best_valid_test/acc': 84.641, 'best_valid_test/acc_unbiased': 84.754, 'best_valid_test/diff': 4.346, 'best_valid_test/acc_skew': 82.581, 'best_valid_test/acc_align': 86.927}
[12 / 20] best test accuracy: 84.754 at epoch 10 
 best_stats: {'best_test_epoch': 10, 'best_test_valid/acc': 84.979, 'best_test_valid/acc_unbiased': 85.216, 'best_test_valid/diff': 2.056, 'best_test_valid/acc_skew': 84.188, 'best_test_valid/acc_align': 86.244, 'best_test_test/acc': 84.641, 'best_test_test/acc_unbiased': 84.754, 'best_test_test/diff': 4.346, 'best_test_test/acc_skew': 82.581, 'best_test_test/acc_align': 86.927}
[13 / 20] Learning rate: 0.0001 weight: 0.01
[13 / 20] Loss: 4.650679541541751 CE Loss: 0.32711441921803824 Con Loss: 4.647408373708432
[13 / 20] tensor([[0.819, 0.744],
        [0.896, 0.917]]) {'epoch': 13, 'valid/acc': 84.937, 'valid/acc_unbiased': 85.453, 'valid/diff': 2.846, 'valid/acc_skew': 84.22, 'valid/acc_align': 86.686, 'test/acc': 84.051, 'test/acc_unbiased': 84.409, 'test/diff': 4.761, 'test/acc_skew': 82.028, 'test/acc_align': 86.789}
[13 / 20] best valid accuracy: 85.453 at epoch 13 
 best_stats: {'best_valid_epoch': 13, 'best_valid_valid/acc': 84.937, 'best_valid_valid/acc_unbiased': 85.453, 'best_valid_valid/diff': 2.846, 'best_valid_valid/acc_skew': 84.22, 'best_valid_valid/acc_align': 86.686, 'best_valid_test/acc': 84.051, 'best_valid_test/acc_unbiased': 84.409, 'best_valid_test/diff': 4.761, 'best_valid_test/acc_skew': 82.028, 'best_valid_test/acc_align': 86.789}
[13 / 20] best test accuracy: 84.754 at epoch 10 
 best_stats: {'best_test_epoch': 10, 'best_test_valid/acc': 84.979, 'best_test_valid/acc_unbiased': 85.216, 'best_test_valid/diff': 2.056, 'best_test_valid/acc_skew': 84.188, 'best_test_valid/acc_align': 86.244, 'best_test_test/acc': 84.641, 'best_test_test/acc_unbiased': 84.754, 'best_test_test/diff': 4.346, 'best_test_test/acc_skew': 82.581, 'best_test_test/acc_align': 86.927}
[14 / 20] Learning rate: 1e-05 weight: 0.01
[14 / 20] Loss: 4.645555564634622 CE Loss: 0.32903277703818606 Con Loss: 4.642265229064584
[14 / 20] tensor([[0.821, 0.761],
        [0.885, 0.911]]) {'epoch': 14, 'valid/acc': 84.895, 'valid/acc_unbiased': 85.312, 'valid/diff': 2.692, 'valid/acc_skew': 83.966, 'valid/acc_align': 86.658, 'test/acc': 84.177, 'test/acc_unbiased': 84.441, 'test/diff': 4.282, 'test/acc_skew': 82.3, 'test/acc_align': 86.582}
[14 / 20] best valid accuracy: 85.453 at epoch 13 
 best_stats: {'best_valid_epoch': 13, 'best_valid_valid/acc': 84.937, 'best_valid_valid/acc_unbiased': 85.453, 'best_valid_valid/diff': 2.846, 'best_valid_valid/acc_skew': 84.22, 'best_valid_valid/acc_align': 86.686, 'best_valid_test/acc': 84.051, 'best_valid_test/acc_unbiased': 84.409, 'best_valid_test/diff': 4.761, 'best_valid_test/acc_skew': 82.028, 'best_valid_test/acc_align': 86.789}
[14 / 20] best test accuracy: 84.754 at epoch 10 
 best_stats: {'best_test_epoch': 10, 'best_test_valid/acc': 84.979, 'best_test_valid/acc_unbiased': 85.216, 'best_test_valid/diff': 2.056, 'best_test_valid/acc_skew': 84.188, 'best_test_valid/acc_align': 86.244, 'best_test_test/acc': 84.641, 'best_test_test/acc_unbiased': 84.754, 'best_test_test/diff': 4.346, 'best_test_test/acc_skew': 82.581, 'best_test_test/acc_align': 86.927}
[15 / 20] Learning rate: 1e-05 weight: 0.01
[15 / 20] Loss: 4.656546034889724 CE Loss: 0.33017296323315465 Con Loss: 4.653244302004008
[15 / 20] tensor([[0.815, 0.768],
        [0.887, 0.915]]) {'epoch': 15, 'valid/acc': 85.316, 'valid/acc_unbiased': 85.666, 'valid/diff': 2.449, 'valid/acc_skew': 84.441, 'valid/acc_align': 86.891, 'test/acc': 84.43, 'test/acc_unbiased': 84.656, 'test/diff': 3.759, 'test/acc_skew': 82.777, 'test/acc_align': 86.536}
[15 / 20] best valid accuracy: 85.666 at epoch 15 
 best_stats: {'best_valid_epoch': 15, 'best_valid_valid/acc': 85.316, 'best_valid_valid/acc_unbiased': 85.666, 'best_valid_valid/diff': 2.449, 'best_valid_valid/acc_skew': 84.441, 'best_valid_valid/acc_align': 86.891, 'best_valid_test/acc': 84.43, 'best_valid_test/acc_unbiased': 84.656, 'best_valid_test/diff': 3.759, 'best_valid_test/acc_skew': 82.777, 'best_valid_test/acc_align': 86.536}
[15 / 20] best test accuracy: 84.754 at epoch 10 
 best_stats: {'best_test_epoch': 10, 'best_test_valid/acc': 84.979, 'best_test_valid/acc_unbiased': 85.216, 'best_test_valid/diff': 2.056, 'best_test_valid/acc_skew': 84.188, 'best_test_valid/acc_align': 86.244, 'best_test_test/acc': 84.641, 'best_test_test/acc_unbiased': 84.754, 'best_test_test/diff': 4.346, 'best_test_test/acc_skew': 82.581, 'best_test_test/acc_align': 86.927}
[16 / 20] Learning rate: 1e-05 weight: 0.01
[16 / 20] Loss: 4.649467529000859 CE Loss: 0.331041330867072 Con Loss: 4.64615712857002
[16 / 20] tensor([[0.815, 0.758],
        [0.892, 0.918]]) {'epoch': 16, 'valid/acc': 84.937, 'valid/acc_unbiased': 85.338, 'valid/diff': 2.745, 'valid/acc_skew': 83.966, 'valid/acc_align': 86.711, 'test/acc': 84.304, 'test/acc_unbiased': 84.58, 'test/diff': 4.208, 'test/acc_skew': 82.476, 'test/acc_align': 86.684}
[16 / 20] best valid accuracy: 85.666 at epoch 15 
 best_stats: {'best_valid_epoch': 15, 'best_valid_valid/acc': 85.316, 'best_valid_valid/acc_unbiased': 85.666, 'best_valid_valid/diff': 2.449, 'best_valid_valid/acc_skew': 84.441, 'best_valid_valid/acc_align': 86.891, 'best_valid_test/acc': 84.43, 'best_valid_test/acc_unbiased': 84.656, 'best_valid_test/diff': 3.759, 'best_valid_test/acc_skew': 82.777, 'best_valid_test/acc_align': 86.536}
[16 / 20] best test accuracy: 84.754 at epoch 10 
 best_stats: {'best_test_epoch': 10, 'best_test_valid/acc': 84.979, 'best_test_valid/acc_unbiased': 85.216, 'best_test_valid/diff': 2.056, 'best_test_valid/acc_skew': 84.188, 'best_test_valid/acc_align': 86.244, 'best_test_test/acc': 84.641, 'best_test_test/acc_unbiased': 84.754, 'best_test_test/diff': 4.346, 'best_test_test/acc_skew': 82.581, 'best_test_test/acc_align': 86.927}
[17 / 20] Learning rate: 1e-05 weight: 0.01
[17 / 20] Loss: 4.6435472312469255 CE Loss: 0.32403481499691483 Con Loss: 4.6403068804985255
[17 / 20] tensor([[0.828, 0.768],
        [0.883, 0.915]]) {'epoch': 17, 'valid/acc': 84.937, 'valid/acc_unbiased': 85.284, 'valid/diff': 2.781, 'valid/acc_skew': 83.894, 'valid/acc_align': 86.675, 'test/acc': 84.641, 'test/acc_unbiased': 84.862, 'test/diff': 4.603, 'test/acc_skew': 82.561, 'test/acc_align': 87.163}
[17 / 20] best valid accuracy: 85.666 at epoch 15 
 best_stats: {'best_valid_epoch': 15, 'best_valid_valid/acc': 85.316, 'best_valid_valid/acc_unbiased': 85.666, 'best_valid_valid/diff': 2.449, 'best_valid_valid/acc_skew': 84.441, 'best_valid_valid/acc_align': 86.891, 'best_valid_test/acc': 84.43, 'best_valid_test/acc_unbiased': 84.656, 'best_valid_test/diff': 3.759, 'best_valid_test/acc_skew': 82.777, 'best_valid_test/acc_align': 86.536}
[17 / 20] best test accuracy: 84.862 at epoch 17 
 best_stats: {'best_test_epoch': 17, 'best_test_valid/acc': 84.937, 'best_test_valid/acc_unbiased': 85.284, 'best_test_valid/diff': 2.781, 'best_test_valid/acc_skew': 83.894, 'best_test_valid/acc_align': 86.675, 'best_test_test/acc': 84.641, 'best_test_test/acc_unbiased': 84.862, 'best_test_test/diff': 4.603, 'best_test_test/acc_skew': 82.561, 'best_test_test/acc_align': 87.163}
[18 / 20] Learning rate: 1e-05 weight: 0.01
[18 / 20] Loss: 4.649634229316544 CE Loss: 0.3255760292706692 Con Loss: 4.64637845710989
[18 / 20] tensor([[0.832, 0.777],
        [0.877, 0.911]]) {'epoch': 18, 'valid/acc': 85.232, 'valid/acc_unbiased': 85.525, 'valid/diff': 2.969, 'valid/acc_skew': 84.04, 'valid/acc_align': 87.01, 'test/acc': 84.726, 'test/acc_unbiased': 84.899, 'test/diff': 4.44, 'test/acc_skew': 82.679, 'test/acc_align': 87.119}
[18 / 20] best valid accuracy: 85.666 at epoch 15 
 best_stats: {'best_valid_epoch': 15, 'best_valid_valid/acc': 85.316, 'best_valid_valid/acc_unbiased': 85.666, 'best_valid_valid/diff': 2.449, 'best_valid_valid/acc_skew': 84.441, 'best_valid_valid/acc_align': 86.891, 'best_valid_test/acc': 84.43, 'best_valid_test/acc_unbiased': 84.656, 'best_valid_test/diff': 3.759, 'best_valid_test/acc_skew': 82.777, 'best_valid_test/acc_align': 86.536}
[18 / 20] best test accuracy: 84.899 at epoch 18 
 best_stats: {'best_test_epoch': 18, 'best_test_valid/acc': 85.232, 'best_test_valid/acc_unbiased': 85.525, 'best_test_valid/diff': 2.969, 'best_test_valid/acc_skew': 84.04, 'best_test_valid/acc_align': 87.01, 'best_test_test/acc': 84.726, 'best_test_test/acc_unbiased': 84.899, 'best_test_test/diff': 4.44, 'best_test_test/acc_skew': 82.679, 'best_test_test/acc_align': 87.119}
[19 / 20] Learning rate: 1e-05 weight: 0.01
[19 / 20] Loss: 4.640456208023808 CE Loss: 0.3185791086574599 Con Loss: 4.637270414986338
[19 / 20] tensor([[0.830, 0.774],
        [0.879, 0.914]]) {'epoch': 19, 'valid/acc': 85.527, 'valid/acc_unbiased': 85.846, 'valid/diff': 2.809, 'valid/acc_skew': 84.442, 'valid/acc_align': 87.25, 'test/acc': 84.726, 'test/acc_unbiased': 84.909, 'test/diff': 4.539, 'test/acc_skew': 82.64, 'test/acc_align': 87.178}
[19 / 20] best valid accuracy: 85.846 at epoch 19 
 best_stats: {'best_valid_epoch': 19, 'best_valid_valid/acc': 85.527, 'best_valid_valid/acc_unbiased': 85.846, 'best_valid_valid/diff': 2.809, 'best_valid_valid/acc_skew': 84.442, 'best_valid_valid/acc_align': 87.25, 'best_valid_test/acc': 84.726, 'best_valid_test/acc_unbiased': 84.909, 'best_valid_test/diff': 4.539, 'best_valid_test/acc_skew': 82.64, 'best_valid_test/acc_align': 87.178}
[19 / 20] best test accuracy: 84.909 at epoch 19 
 best_stats: {'best_test_epoch': 19, 'best_test_valid/acc': 85.527, 'best_test_valid/acc_unbiased': 85.846, 'best_test_valid/diff': 2.809, 'best_test_valid/acc_skew': 84.442, 'best_test_valid/acc_align': 87.25, 'best_test_test/acc': 84.726, 'best_test_test/acc_unbiased': 84.909, 'best_test_test/diff': 4.539, 'best_test_test/acc_skew': 82.64, 'best_test_test/acc_align': 87.178}
[20 / 20] Learning rate: 1e-05 weight: 0.01
[20 / 20] Loss: 4.644257843581684 CE Loss: 0.32289327011275953 Con Loss: 4.641028891545264
[20 / 20] tensor([[0.828, 0.770],
        [0.879, 0.915]]) {'epoch': 20, 'valid/acc': 85.274, 'valid/acc_unbiased': 85.591, 'valid/diff': 3.612, 'valid/acc_skew': 83.784, 'valid/acc_align': 87.397, 'test/acc': 84.599, 'test/acc_unbiased': 84.791, 'test/diff': 4.745, 'test/acc_skew': 82.418, 'test/acc_align': 87.163}
[20 / 20] best valid accuracy: 85.846 at epoch 19 
 best_stats: {'best_valid_epoch': 19, 'best_valid_valid/acc': 85.527, 'best_valid_valid/acc_unbiased': 85.846, 'best_valid_valid/diff': 2.809, 'best_valid_valid/acc_skew': 84.442, 'best_valid_valid/acc_align': 87.25, 'best_valid_test/acc': 84.726, 'best_valid_test/acc_unbiased': 84.909, 'best_valid_test/diff': 4.539, 'best_valid_test/acc_skew': 82.64, 'best_valid_test/acc_align': 87.178}
[20 / 20] best test accuracy: 84.909 at epoch 19 
 best_stats: {'best_test_epoch': 19, 'best_test_valid/acc': 85.527, 'best_test_valid/acc_unbiased': 85.846, 'best_test_valid/diff': 2.809, 'best_test_valid/acc_skew': 84.442, 'best_test_valid/acc_align': 87.25, 'best_test_test/acc': 84.726, 'best_test_test/acc_unbiased': 84.909, 'best_test_test/diff': 4.539, 'best_test_test/acc_skew': 82.64, 'best_test_test/acc_align': 87.178}
Total training time: 0:17:04
