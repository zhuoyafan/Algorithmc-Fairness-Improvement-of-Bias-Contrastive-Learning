Log level set to: INFO
Set seed: 2
=======> Using Fixed Random Seed: 2 <========
save_path: exp_results/bc-bb0-celeba_blonde-crop_trival-lr0.001-bs128-cbs64-w0.01-ratio30-aug1-seed2
get_celeba - split:train, aug: False, given_y: True, ratio: 0
use existing blonde indices from data/celeba/pickles/blonde
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [1586, 53554]
Target 1: [18282, 1090]
Binary Target 1
---------------------------
Target 0: [1586, 53554]
Target 1: [18282, 1090]
===================================
Normal Label Distribution: 
Target 0: [1586, 53554]
Target 1: [18282, 1090]
===================================
Use BiasedCelebASplit 
 target_attr: blonde split: train 
 tensor([[ 1586., 18282.],
        [53554.,  1090.]])
get_celeba - split:train, aug: 1, given_y: True, ratio: 30
use existing blonde indices from data/celeba/pickles/blonde
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [1615, 53474]
Target 1: [18298, 1125]
Binary Target 1
---------------------------
Target 0: [1615, 53474]
Target 1: [18298, 1125]
===================================
Normal Label Distribution: 
Target 0: [1615, 53474]
Target 1: [18298, 1125]
===================================
Use BiasedCelebASplit 
 target_attr: blonde split: train 
 tensor([[ 1615., 18298.],
        [53474.,  1125.]])
get_celeba - split:train_valid, aug: False, given_y: True, ratio: 0
use existing blonde indices from data/celeba/pickles/blonde
Use BiasedCelebASplit 
 target_attr: blonde split: train_valid 
 tensor([[  403.,  4597.],
        [13344.,   285.]])
get_celeba - split:valid, aug: False, given_y: True, ratio: 0
Use BiasedCelebASplit 
 target_attr: blonde split: valid 
 tensor([[8535., 2874.],
        [8276.,  182.]])
decay_epochs: [3, 6]
[1 / 10] Learning rate: 0.001 weight: 0.01
[1 / 10] Loss: 4.719020298168796 CE Loss: 0.20244259134635717 Con Loss: 4.716995870603726
[1 / 10] tensor([[0.920, 0.958],
        [0.891, 0.846]]) {'epoch': 1, 'valid/acc': 93.462, 'valid/acc_unbiased': 89.813, 'valid/diff': 4.138, 'valid/acc_skew': 87.767, 'valid/acc_align': 91.86, 'test/acc': 93.099, 'test/acc_unbiased': 90.382, 'test/diff': 4.152, 'test/acc_skew': 88.307, 'test/acc_align': 92.458}
[1 / 10] best valid accuracy: 89.813 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 93.462, 'best_valid_valid/acc_unbiased': 89.813, 'best_valid_valid/diff': 4.138, 'best_valid_valid/acc_skew': 87.767, 'best_valid_valid/acc_align': 91.86, 'best_valid_test/acc': 93.099, 'best_valid_test/acc_unbiased': 90.382, 'best_valid_test/diff': 4.152, 'best_valid_test/acc_skew': 88.307, 'best_valid_test/acc_align': 92.458}
[1 / 10] best test accuracy: 90.382 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 93.462, 'best_test_valid/acc_unbiased': 89.813, 'best_test_valid/diff': 4.138, 'best_test_valid/acc_skew': 87.767, 'best_test_valid/acc_align': 91.86, 'best_test_test/acc': 93.099, 'best_test_test/acc_unbiased': 90.382, 'best_test_test/diff': 4.152, 'best_test_test/acc_skew': 88.307, 'best_test_test/acc_align': 92.458}
[2 / 10] Learning rate: 0.001 weight: 0.01
[2 / 10] Loss: 4.688199184778962 CE Loss: 0.18117204863023728 Con Loss: 4.686387459351726
[2 / 10] tensor([[0.886, 0.949],
        [0.923, 0.835]]) {'epoch': 2, 'valid/acc': 93.875, 'valid/acc_unbiased': 91.038, 'valid/diff': 4.48, 'valid/acc_skew': 88.798, 'valid/acc_align': 93.278, 'test/acc': 91.72, 'test/acc_unbiased': 89.829, 'test/diff': 7.554, 'test/acc_skew': 86.052, 'test/acc_align': 93.606}
[2 / 10] best valid accuracy: 91.038 at epoch 2 
 best_stats: {'best_valid_epoch': 2, 'best_valid_valid/acc': 93.875, 'best_valid_valid/acc_unbiased': 91.038, 'best_valid_valid/diff': 4.48, 'best_valid_valid/acc_skew': 88.798, 'best_valid_valid/acc_align': 93.278, 'best_valid_test/acc': 91.72, 'best_valid_test/acc_unbiased': 89.829, 'best_valid_test/diff': 7.554, 'best_valid_test/acc_skew': 86.052, 'best_valid_test/acc_align': 93.606}
[2 / 10] best test accuracy: 90.382 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 93.462, 'best_test_valid/acc_unbiased': 89.813, 'best_test_valid/diff': 4.138, 'best_test_valid/acc_skew': 87.767, 'best_test_valid/acc_align': 91.86, 'best_test_test/acc': 93.099, 'best_test_test/acc_unbiased': 90.382, 'best_test_test/diff': 4.152, 'best_test_test/acc_skew': 88.307, 'best_test_test/acc_align': 92.458}
[3 / 10] Learning rate: 0.001 weight: 0.01
[3 / 10] Loss: 4.673484700571347 CE Loss: 0.16958404543421826 Con Loss: 4.671788849645299
[3 / 10] tensor([[0.933, 0.978],
        [0.858, 0.709]]) {'epoch': 3, 'valid/acc': 94.127, 'valid/acc_unbiased': 87.277, 'valid/diff': 8.801, 'valid/acc_skew': 82.876, 'valid/acc_align': 91.677, 'test/acc': 93.889, 'test/acc_unbiased': 86.943, 'test/diff': 9.685, 'test/acc_skew': 82.1, 'test/acc_align': 91.785}
[3 / 10] best valid accuracy: 91.038 at epoch 2 
 best_stats: {'best_valid_epoch': 2, 'best_valid_valid/acc': 93.875, 'best_valid_valid/acc_unbiased': 91.038, 'best_valid_valid/diff': 4.48, 'best_valid_valid/acc_skew': 88.798, 'best_valid_valid/acc_align': 93.278, 'best_valid_test/acc': 91.72, 'best_valid_test/acc_unbiased': 89.829, 'best_valid_test/diff': 7.554, 'best_valid_test/acc_skew': 86.052, 'best_valid_test/acc_align': 93.606}
[3 / 10] best test accuracy: 90.382 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 93.462, 'best_test_valid/acc_unbiased': 89.813, 'best_test_valid/diff': 4.138, 'best_test_valid/acc_skew': 87.767, 'best_test_valid/acc_align': 91.86, 'best_test_test/acc': 93.099, 'best_test_test/acc_unbiased': 90.382, 'best_test_test/diff': 4.152, 'best_test_test/acc_skew': 88.307, 'best_test_test/acc_align': 92.458}
[4 / 10] Learning rate: 0.0001 weight: 0.01
[4 / 10] Loss: 4.619874235025823 CE Loss: 0.14660053186131403 Con Loss: 4.618408232920923
[4 / 10] tensor([[0.903, 0.960],
        [0.928, 0.868]]) {'epoch': 4, 'valid/acc': 94.632, 'valid/acc_unbiased': 93.555, 'valid/diff': 1.567, 'valid/acc_skew': 93.103, 'valid/acc_align': 94.008, 'test/acc': 92.998, 'test/acc_unbiased': 91.474, 'test/diff': 5.825, 'test/acc_skew': 88.562, 'test/acc_align': 94.387}
[4 / 10] best valid accuracy: 93.555 at epoch 4 
 best_stats: {'best_valid_epoch': 4, 'best_valid_valid/acc': 94.632, 'best_valid_valid/acc_unbiased': 93.555, 'best_valid_valid/diff': 1.567, 'best_valid_valid/acc_skew': 93.103, 'best_valid_valid/acc_align': 94.008, 'best_valid_test/acc': 92.998, 'best_valid_test/acc_unbiased': 91.474, 'best_valid_test/diff': 5.825, 'best_valid_test/acc_skew': 88.562, 'best_valid_test/acc_align': 94.387}
[4 / 10] best test accuracy: 91.474 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 94.632, 'best_test_valid/acc_unbiased': 93.555, 'best_test_valid/diff': 1.567, 'best_test_valid/acc_skew': 93.103, 'best_test_valid/acc_align': 94.008, 'best_test_test/acc': 92.998, 'best_test_test/acc_unbiased': 91.474, 'best_test_test/diff': 5.825, 'best_test_test/acc_skew': 88.562, 'best_test_test/acc_align': 94.387}
[5 / 10] Learning rate: 0.0001 weight: 0.01
[5 / 10] Loss: 4.608692277314864 CE Loss: 0.14377701362814543 Con Loss: 4.607254509867479
[5 / 10] tensor([[0.912, 0.967],
        [0.916, 0.841]]) {'epoch': 5, 'valid/acc': 94.798, 'valid/acc_unbiased': 92.74, 'valid/diff': 3.846, 'valid/acc_skew': 91.69, 'valid/acc_align': 93.79, 'test/acc': 93.482, 'test/acc_unbiased': 90.887, 'test/diff': 6.483, 'test/acc_skew': 87.645, 'test/acc_align': 94.128}
[5 / 10] best valid accuracy: 93.555 at epoch 4 
 best_stats: {'best_valid_epoch': 4, 'best_valid_valid/acc': 94.632, 'best_valid_valid/acc_unbiased': 93.555, 'best_valid_valid/diff': 1.567, 'best_valid_valid/acc_skew': 93.103, 'best_valid_valid/acc_align': 94.008, 'best_valid_test/acc': 92.998, 'best_valid_test/acc_unbiased': 91.474, 'best_valid_test/diff': 5.825, 'best_valid_test/acc_skew': 88.562, 'best_valid_test/acc_align': 94.387}
[5 / 10] best test accuracy: 91.474 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 94.632, 'best_test_valid/acc_unbiased': 93.555, 'best_test_valid/diff': 1.567, 'best_test_valid/acc_skew': 93.103, 'best_test_valid/acc_align': 94.008, 'best_test_test/acc': 92.998, 'best_test_test/acc_unbiased': 91.474, 'best_test_test/diff': 5.825, 'best_test_test/acc_skew': 88.562, 'best_test_test/acc_align': 94.387}
[6 / 10] Learning rate: 0.0001 weight: 0.01
[6 / 10] Loss: 4.590732711974659 CE Loss: 0.13890976803559255 Con Loss: 4.58934361836878
[6 / 10] tensor([[0.918, 0.974],
        [0.914, 0.808]]) {'epoch': 6, 'valid/acc': 95.228, 'valid/acc_unbiased': 91.534, 'valid/diff': 6.246, 'valid/acc_skew': 89.007, 'valid/acc_align': 94.061, 'test/acc': 94.005, 'test/acc_unbiased': 90.368, 'test/diff': 8.144, 'test/acc_skew': 86.296, 'test/acc_align': 94.439}
[6 / 10] best valid accuracy: 93.555 at epoch 4 
 best_stats: {'best_valid_epoch': 4, 'best_valid_valid/acc': 94.632, 'best_valid_valid/acc_unbiased': 93.555, 'best_valid_valid/diff': 1.567, 'best_valid_valid/acc_skew': 93.103, 'best_valid_valid/acc_align': 94.008, 'best_valid_test/acc': 92.998, 'best_valid_test/acc_unbiased': 91.474, 'best_valid_test/diff': 5.825, 'best_valid_test/acc_skew': 88.562, 'best_valid_test/acc_align': 94.387}
[6 / 10] best test accuracy: 91.474 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 94.632, 'best_test_valid/acc_unbiased': 93.555, 'best_test_valid/diff': 1.567, 'best_test_valid/acc_skew': 93.103, 'best_test_valid/acc_align': 94.008, 'best_test_test/acc': 92.998, 'best_test_test/acc_unbiased': 91.474, 'best_test_test/diff': 5.825, 'best_test_test/acc_skew': 88.562, 'best_test_test/acc_align': 94.387}
[7 / 10] Learning rate: 1e-05 weight: 0.01
[7 / 10] Loss: 4.5825240115943275 CE Loss: 0.13117987696630953 Con Loss: 4.5812122030833615
[7 / 10] tensor([[0.918, 0.975],
        [0.901, 0.802]]) {'epoch': 7, 'valid/acc': 95.158, 'valid/acc_unbiased': 91.251, 'valid/diff': 7.09, 'valid/acc_skew': 88.554, 'valid/acc_align': 93.948, 'test/acc': 93.829, 'test/acc_unbiased': 89.912, 'test/diff': 7.77, 'test/acc_skew': 86.027, 'test/acc_align': 93.796}
[7 / 10] best valid accuracy: 93.555 at epoch 4 
 best_stats: {'best_valid_epoch': 4, 'best_valid_valid/acc': 94.632, 'best_valid_valid/acc_unbiased': 93.555, 'best_valid_valid/diff': 1.567, 'best_valid_valid/acc_skew': 93.103, 'best_valid_valid/acc_align': 94.008, 'best_valid_test/acc': 92.998, 'best_valid_test/acc_unbiased': 91.474, 'best_valid_test/diff': 5.825, 'best_valid_test/acc_skew': 88.562, 'best_valid_test/acc_align': 94.387}
[7 / 10] best test accuracy: 91.474 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 94.632, 'best_test_valid/acc_unbiased': 93.555, 'best_test_valid/diff': 1.567, 'best_test_valid/acc_skew': 93.103, 'best_test_valid/acc_align': 94.008, 'best_test_test/acc': 92.998, 'best_test_test/acc_unbiased': 91.474, 'best_test_test/diff': 5.825, 'best_test_test/acc_skew': 88.562, 'best_test_test/acc_align': 94.387}
[8 / 10] Learning rate: 1e-05 weight: 0.01
[8 / 10] Loss: 4.578519451021764 CE Loss: 0.13356852333689545 Con Loss: 4.577183775464583
[8 / 10] tensor([[0.916, 0.973],
        [0.908, 0.813]]) {'epoch': 8, 'valid/acc': 95.239, 'valid/acc_unbiased': 92.416, 'valid/diff': 4.89, 'valid/acc_skew': 90.835, 'valid/acc_align': 93.998, 'test/acc': 93.799, 'test/acc_unbiased': 90.271, 'test/diff': 7.578, 'test/acc_skew': 86.482, 'test/acc_align': 94.061}
[8 / 10] best valid accuracy: 93.555 at epoch 4 
 best_stats: {'best_valid_epoch': 4, 'best_valid_valid/acc': 94.632, 'best_valid_valid/acc_unbiased': 93.555, 'best_valid_valid/diff': 1.567, 'best_valid_valid/acc_skew': 93.103, 'best_valid_valid/acc_align': 94.008, 'best_valid_test/acc': 92.998, 'best_valid_test/acc_unbiased': 91.474, 'best_valid_test/diff': 5.825, 'best_valid_test/acc_skew': 88.562, 'best_valid_test/acc_align': 94.387}
[8 / 10] best test accuracy: 91.474 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 94.632, 'best_test_valid/acc_unbiased': 93.555, 'best_test_valid/diff': 1.567, 'best_test_valid/acc_skew': 93.103, 'best_test_valid/acc_align': 94.008, 'best_test_test/acc': 92.998, 'best_test_test/acc_unbiased': 91.474, 'best_test_test/diff': 5.825, 'best_test_test/acc_skew': 88.562, 'best_test_test/acc_align': 94.387}
[9 / 10] Learning rate: 1e-05 weight: 0.01
[9 / 10] Loss: 4.579921367523213 CE Loss: 0.13257649867754012 Con Loss: 4.578595603666824
[9 / 10] tensor([[0.908, 0.971],
        [0.922, 0.830]]) {'epoch': 9, 'valid/acc': 95.33, 'valid/acc_unbiased': 93.406, 'valid/diff': 4.041, 'valid/acc_skew': 92.413, 'valid/acc_align': 94.399, 'test/acc': 93.557, 'test/acc_unbiased': 90.763, 'test/diff': 7.745, 'test/acc_skew': 86.891, 'test/acc_align': 94.636}
[9 / 10] best valid accuracy: 93.555 at epoch 4 
 best_stats: {'best_valid_epoch': 4, 'best_valid_valid/acc': 94.632, 'best_valid_valid/acc_unbiased': 93.555, 'best_valid_valid/diff': 1.567, 'best_valid_valid/acc_skew': 93.103, 'best_valid_valid/acc_align': 94.008, 'best_valid_test/acc': 92.998, 'best_valid_test/acc_unbiased': 91.474, 'best_valid_test/diff': 5.825, 'best_valid_test/acc_skew': 88.562, 'best_valid_test/acc_align': 94.387}
[9 / 10] best test accuracy: 91.474 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 94.632, 'best_test_valid/acc_unbiased': 93.555, 'best_test_valid/diff': 1.567, 'best_test_valid/acc_skew': 93.103, 'best_test_valid/acc_align': 94.008, 'best_test_test/acc': 92.998, 'best_test_test/acc_unbiased': 91.474, 'best_test_test/diff': 5.825, 'best_test_test/acc_skew': 88.562, 'best_test_test/acc_align': 94.387}
[10 / 10] Learning rate: 1e-05 weight: 0.01
[10 / 10] Loss: 4.574152467177614 CE Loss: 0.13048186903671055 Con Loss: 4.57284764801199
[10 / 10] tensor([[0.927, 0.979],
        [0.896, 0.791]]) {'epoch': 10, 'valid/acc': 95.18, 'valid/acc_unbiased': 91.021, 'valid/diff': 6.793, 'valid/acc_skew': 88.575, 'valid/acc_align': 93.467, 'test/acc': 94.262, 'test/acc_unbiased': 89.805, 'test/diff': 7.836, 'test/acc_skew': 85.887, 'test/acc_align': 93.724}
[10 / 10] best valid accuracy: 93.555 at epoch 4 
 best_stats: {'best_valid_epoch': 4, 'best_valid_valid/acc': 94.632, 'best_valid_valid/acc_unbiased': 93.555, 'best_valid_valid/diff': 1.567, 'best_valid_valid/acc_skew': 93.103, 'best_valid_valid/acc_align': 94.008, 'best_valid_test/acc': 92.998, 'best_valid_test/acc_unbiased': 91.474, 'best_valid_test/diff': 5.825, 'best_valid_test/acc_skew': 88.562, 'best_valid_test/acc_align': 94.387}
[10 / 10] best test accuracy: 91.474 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 94.632, 'best_test_valid/acc_unbiased': 93.555, 'best_test_valid/diff': 1.567, 'best_test_valid/acc_skew': 93.103, 'best_test_valid/acc_align': 94.008, 'best_test_test/acc': 92.998, 'best_test_test/acc_unbiased': 91.474, 'best_test_test/diff': 5.825, 'best_test_test/acc_skew': 88.562, 'best_test_test/acc_align': 94.387}
Total training time: 1:07:10
