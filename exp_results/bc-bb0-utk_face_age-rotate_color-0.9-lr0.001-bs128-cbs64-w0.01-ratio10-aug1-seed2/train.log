Log level set to: INFO
Set seed: 2
=======> Using Fixed Random Seed: 2 <========
save_path: exp_results/bc-bb0-utk_face_age-rotate_color-0.9-lr0.001-bs128-cbs64-w0.01-ratio10-aug1-seed2
get_utk_face - split: train, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_age-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
Binary Target 1
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Normal Label Distribution: 
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
Binary Target 1
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Normal Label Distribution: 
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 10684, target_attr: gender, bias_attr: age bias_rate: 0.9
['[train] target_0-bias_0: 8237', '[train] target_0-bias_1: 147', '[train] target_1-bias_0: 823', '[train] target_1-bias_1: 1477']
confusion_matrix - 
 original: tensor([[8237.,  823.],
        [ 147., 1477.]]), 
 normalized: tensor([[0.909, 0.091],
        [0.091, 0.909]]), 
 b|y: tensor([[0.982, 0.018],
        [0.358, 0.642]])
get_utk_face - split: train, aug: 1, given_y: True, ratio: 10
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_age-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
Binary Target 1
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Normal Label Distribution: 
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
Binary Target 1
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Normal Label Distribution: 
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 10684, target_attr: gender, bias_attr: age bias_rate: 0.9
['[train] target_0-bias_0: 8237', '[train] target_0-bias_1: 147', '[train] target_1-bias_0: 823', '[train] target_1-bias_1: 1477']
get_utk_face - split: valid, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_age-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [1030, 195]
Target 1: [841, 202]
Binary Target 1
---------------------------
Target 0: [1030, 195]
Target 1: [841, 202]
===================================
Normal Label Distribution: 
Target 0: [1030, 195]
Target 1: [841, 202]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 2268, target_attr: gender, bias_attr: age bias_rate: 0.9
['[valid] target_0-bias_0: 1030', '[valid] target_0-bias_1: 195', '[valid] target_1-bias_0: 841', '[valid] target_1-bias_1: 202']
get_utk_face - split: test, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_age-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [1061, 176]
Target 1: [867, 165]
Binary Target 1
---------------------------
Target 0: [1061, 176]
Target 1: [867, 165]
===================================
Normal Label Distribution: 
Target 0: [1061, 176]
Target 1: [867, 165]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 2269, target_attr: gender, bias_attr: age bias_rate: 0.9
['[test] target_0-bias_0: 1061', '[test] target_0-bias_1: 176', '[test] target_1-bias_0: 867', '[test] target_1-bias_1: 165']
decay_epochs: [6, 13]
[1 / 20] Learning rate: 0.001 weight: 0.01
[1 / 20] Loss: 4.821616761205081 CE Loss: 0.5830038395190409 Con Loss: 4.815786742307148
[1 / 20] tensor([[1., 1.],
        [0., 0.]]) {'epoch': 1, 'valid/acc': 54.056, 'valid/acc_unbiased': 50.03, 'valid/diff': 0.059, 'valid/acc_skew': 50.059, 'valid/acc_align': 50.0, 'test/acc': 54.517, 'test/acc_unbiased': 50.0, 'test/diff': 0.0, 'test/acc_skew': 50.0, 'test/acc_align': 50.0}
[1 / 20] best valid accuracy: 50.030 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 54.056, 'best_valid_valid/acc_unbiased': 50.03, 'best_valid_valid/diff': 0.059, 'best_valid_valid/acc_skew': 50.059, 'best_valid_valid/acc_align': 50.0, 'best_valid_test/acc': 54.517, 'best_valid_test/acc_unbiased': 50.0, 'best_valid_test/diff': 0.0, 'best_valid_test/acc_skew': 50.0, 'best_valid_test/acc_align': 50.0}
[1 / 20] best test accuracy: 50.000 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 54.056, 'best_test_valid/acc_unbiased': 50.03, 'best_test_valid/diff': 0.059, 'best_test_valid/acc_skew': 50.059, 'best_test_valid/acc_align': 50.0, 'best_test_test/acc': 54.517, 'best_test_test/acc_unbiased': 50.0, 'best_test_test/diff': 0.0, 'best_test_test/acc_skew': 50.0, 'best_test_test/acc_align': 50.0}
[2 / 20] Learning rate: 0.001 weight: 0.01
[2 / 20] Loss: 4.623254352720968 CE Loss: 0.5549988131851616 Con Loss: 4.617704357917011
[2 / 20] tensor([[0.937, 0.960],
        [0.283, 0.145]]) {'epoch': 2, 'valid/acc': 62.654, 'valid/acc_unbiased': 57.551, 'valid/diff': 7.413, 'valid/acc_skew': 60.4, 'valid/acc_align': 54.702, 'test/acc': 63.112, 'test/acc_unbiased': 58.128, 'test/diff': 8.025, 'test/acc_skew': 62.141, 'test/acc_align': 54.115}
[2 / 20] best valid accuracy: 57.551 at epoch 2 
 best_stats: {'best_valid_epoch': 2, 'best_valid_valid/acc': 62.654, 'best_valid_valid/acc_unbiased': 57.551, 'best_valid_valid/diff': 7.413, 'best_valid_valid/acc_skew': 60.4, 'best_valid_valid/acc_align': 54.702, 'best_valid_test/acc': 63.112, 'best_valid_test/acc_unbiased': 58.128, 'best_valid_test/diff': 8.025, 'best_valid_test/acc_skew': 62.141, 'best_valid_test/acc_align': 54.115}
[2 / 20] best test accuracy: 58.128 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 62.654, 'best_test_valid/acc_unbiased': 57.551, 'best_test_valid/diff': 7.413, 'best_test_valid/acc_skew': 60.4, 'best_test_valid/acc_align': 54.702, 'best_test_test/acc': 63.112, 'best_test_test/acc_unbiased': 58.128, 'best_test_test/diff': 8.025, 'best_test_test/acc_skew': 62.141, 'best_test_test/acc_align': 54.115}
[3 / 20] Learning rate: 0.001 weight: 0.01
[3 / 20] Loss: 4.624236299678298 CE Loss: 0.5244928457146948 Con Loss: 4.618991373719815
[3 / 20] tensor([[0.995, 0.989],
        [0.040, 0.036]]) {'epoch': 3, 'valid/acc': 55.159, 'valid/acc_unbiased': 51.303, 'valid/diff': 1.199, 'valid/acc_skew': 51.902, 'valid/acc_align': 50.704, 'test/acc': 56.016, 'test/acc_unbiased': 51.516, 'test/diff': 0.533, 'test/acc_skew': 51.45, 'test/acc_align': 51.583}
[3 / 20] best valid accuracy: 57.551 at epoch 2 
 best_stats: {'best_valid_epoch': 2, 'best_valid_valid/acc': 62.654, 'best_valid_valid/acc_unbiased': 57.551, 'best_valid_valid/diff': 7.413, 'best_valid_valid/acc_skew': 60.4, 'best_valid_valid/acc_align': 54.702, 'best_valid_test/acc': 63.112, 'best_valid_test/acc_unbiased': 58.128, 'best_valid_test/diff': 8.025, 'best_valid_test/acc_skew': 62.141, 'best_valid_test/acc_align': 54.115}
[3 / 20] best test accuracy: 58.128 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 62.654, 'best_test_valid/acc_unbiased': 57.551, 'best_test_valid/diff': 7.413, 'best_test_valid/acc_skew': 60.4, 'best_test_valid/acc_align': 54.702, 'best_test_test/acc': 63.112, 'best_test_test/acc_unbiased': 58.128, 'best_test_test/diff': 8.025, 'best_test_test/acc_skew': 62.141, 'best_test_test/acc_align': 54.115}
[4 / 20] Learning rate: 0.001 weight: 0.01
[4 / 20] Loss: 4.570976529394541 CE Loss: 0.520263590646656 Con Loss: 4.565773867882401
[4 / 20] tensor([[0.982, 0.966],
        [0.159, 0.109]]) {'epoch': 4, 'valid/acc': 59.965, 'valid/acc_unbiased': 55.783, 'valid/diff': 2.761, 'valid/acc_skew': 56.547, 'valid/acc_align': 55.018, 'test/acc': 60.291, 'test/acc_unbiased': 55.407, 'test/diff': 3.313, 'test/acc_skew': 56.254, 'test/acc_align': 54.559}
[4 / 20] best valid accuracy: 57.551 at epoch 2 
 best_stats: {'best_valid_epoch': 2, 'best_valid_valid/acc': 62.654, 'best_valid_valid/acc_unbiased': 57.551, 'best_valid_valid/diff': 7.413, 'best_valid_valid/acc_skew': 60.4, 'best_valid_valid/acc_align': 54.702, 'best_valid_test/acc': 63.112, 'best_valid_test/acc_unbiased': 58.128, 'best_valid_test/diff': 8.025, 'best_valid_test/acc_skew': 62.141, 'best_valid_test/acc_align': 54.115}
[4 / 20] best test accuracy: 58.128 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 62.654, 'best_test_valid/acc_unbiased': 57.551, 'best_test_valid/diff': 7.413, 'best_test_valid/acc_skew': 60.4, 'best_test_valid/acc_align': 54.702, 'best_test_test/acc': 63.112, 'best_test_test/acc_unbiased': 58.128, 'best_test_test/diff': 8.025, 'best_test_test/acc_skew': 62.141, 'best_test_test/acc_align': 54.115}
[5 / 20] Learning rate: 0.001 weight: 0.01
[5 / 20] Loss: 4.540945302498381 CE Loss: 0.5015935201807354 Con Loss: 4.53592936102704
[5 / 20] tensor([[0.995, 0.989],
        [0.137, 0.133]]) {'epoch': 5, 'valid/acc': 59.303, 'valid/acc_unbiased': 55.812, 'valid/diff': 2.141, 'valid/acc_skew': 54.741, 'valid/acc_align': 56.882, 'test/acc': 60.423, 'test/acc_unbiased': 56.363, 'test/diff': 0.529, 'test/acc_skew': 56.295, 'test/acc_align': 56.431}
[5 / 20] best valid accuracy: 57.551 at epoch 2 
 best_stats: {'best_valid_epoch': 2, 'best_valid_valid/acc': 62.654, 'best_valid_valid/acc_unbiased': 57.551, 'best_valid_valid/diff': 7.413, 'best_valid_valid/acc_skew': 60.4, 'best_valid_valid/acc_align': 54.702, 'best_valid_test/acc': 63.112, 'best_valid_test/acc_unbiased': 58.128, 'best_valid_test/diff': 8.025, 'best_valid_test/acc_skew': 62.141, 'best_valid_test/acc_align': 54.115}
[5 / 20] best test accuracy: 58.128 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 62.654, 'best_test_valid/acc_unbiased': 57.551, 'best_test_valid/diff': 7.413, 'best_test_valid/acc_skew': 60.4, 'best_test_valid/acc_align': 54.702, 'best_test_test/acc': 63.112, 'best_test_test/acc_unbiased': 58.128, 'best_test_test/diff': 8.025, 'best_test_test/acc_skew': 62.141, 'best_test_test/acc_align': 54.115}
[6 / 20] Learning rate: 0.001 weight: 0.01
[6 / 20] Loss: 4.534236561622748 CE Loss: 0.49595412112094633 Con Loss: 4.529277022614188
[6 / 20] tensor([[0.973, 0.920],
        [0.277, 0.309]]) {'epoch': 6, 'valid/acc': 65.608, 'valid/acc_unbiased': 61.973, 'valid/diff': 7.085, 'valid/acc_skew': 58.431, 'valid/acc_align': 65.516, 'test/acc': 65.447, 'test/acc_unbiased': 61.976, 'test/diff': 4.224, 'test/acc_skew': 59.864, 'test/acc_align': 64.088}
[6 / 20] best valid accuracy: 61.973 at epoch 6 
 best_stats: {'best_valid_epoch': 6, 'best_valid_valid/acc': 65.608, 'best_valid_valid/acc_unbiased': 61.973, 'best_valid_valid/diff': 7.085, 'best_valid_valid/acc_skew': 58.431, 'best_valid_valid/acc_align': 65.516, 'best_valid_test/acc': 65.447, 'best_valid_test/acc_unbiased': 61.976, 'best_valid_test/diff': 4.224, 'best_valid_test/acc_skew': 59.864, 'best_valid_test/acc_align': 64.088}
[6 / 20] best test accuracy: 61.976 at epoch 6 
 best_stats: {'best_test_epoch': 6, 'best_test_valid/acc': 65.608, 'best_test_valid/acc_unbiased': 61.973, 'best_test_valid/diff': 7.085, 'best_test_valid/acc_skew': 58.431, 'best_test_valid/acc_align': 65.516, 'best_test_test/acc': 65.447, 'best_test_test/acc_unbiased': 61.976, 'best_test_test/diff': 4.224, 'best_test_test/acc_skew': 59.864, 'best_test_test/acc_align': 64.088}
[7 / 20] Learning rate: 0.0001 weight: 0.01
[7 / 20] Loss: 4.440000238065102 CE Loss: 0.4702188983721396 Con Loss: 4.4352980613351445
[7 / 20] tensor([[0.980, 0.915],
        [0.354, 0.309]]) {'epoch': 7, 'valid/acc': 67.593, 'valid/acc_unbiased': 62.518, 'valid/diff': 7.677, 'valid/acc_skew': 60.515, 'valid/acc_align': 64.521, 'test/acc': 68.709, 'test/acc_unbiased': 63.954, 'test/diff': 5.522, 'test/acc_skew': 63.443, 'test/acc_align': 64.465}
[7 / 20] best valid accuracy: 62.518 at epoch 7 
 best_stats: {'best_valid_epoch': 7, 'best_valid_valid/acc': 67.593, 'best_valid_valid/acc_unbiased': 62.518, 'best_valid_valid/diff': 7.677, 'best_valid_valid/acc_skew': 60.515, 'best_valid_valid/acc_align': 64.521, 'best_valid_test/acc': 68.709, 'best_valid_test/acc_unbiased': 63.954, 'best_valid_test/diff': 5.522, 'best_valid_test/acc_skew': 63.443, 'best_valid_test/acc_align': 64.465}
[7 / 20] best test accuracy: 63.954 at epoch 7 
 best_stats: {'best_test_epoch': 7, 'best_test_valid/acc': 67.593, 'best_test_valid/acc_unbiased': 62.518, 'best_test_valid/diff': 7.677, 'best_test_valid/acc_skew': 60.515, 'best_test_valid/acc_align': 64.521, 'best_test_test/acc': 68.709, 'best_test_test/acc_unbiased': 63.954, 'best_test_test/diff': 5.522, 'best_test_test/acc_skew': 63.443, 'best_test_test/acc_align': 64.465}
[8 / 20] Learning rate: 0.0001 weight: 0.01
[8 / 20] Loss: 4.372071381857761 CE Loss: 0.4566932311110709 Con Loss: 4.3675044415729944
[8 / 20] tensor([[0.966, 0.727],
        [0.448, 0.539]]) {'epoch': 8, 'valid/acc': 69.533, 'valid/acc_unbiased': 63.793, 'valid/diff': 15.356, 'valid/acc_skew': 56.115, 'valid/acc_align': 71.471, 'test/acc': 71.838, 'test/acc_unbiased': 67.006, 'test/diff': 16.534, 'test/acc_skew': 58.74, 'test/acc_align': 75.273}
[8 / 20] best valid accuracy: 63.793 at epoch 8 
 best_stats: {'best_valid_epoch': 8, 'best_valid_valid/acc': 69.533, 'best_valid_valid/acc_unbiased': 63.793, 'best_valid_valid/diff': 15.356, 'best_valid_valid/acc_skew': 56.115, 'best_valid_valid/acc_align': 71.471, 'best_valid_test/acc': 71.838, 'best_valid_test/acc_unbiased': 67.006, 'best_valid_test/diff': 16.534, 'best_valid_test/acc_skew': 58.74, 'best_valid_test/acc_align': 75.273}
[8 / 20] best test accuracy: 67.006 at epoch 8 
 best_stats: {'best_test_epoch': 8, 'best_test_valid/acc': 69.533, 'best_test_valid/acc_unbiased': 63.793, 'best_test_valid/diff': 15.356, 'best_test_valid/acc_skew': 56.115, 'best_test_valid/acc_align': 71.471, 'best_test_test/acc': 71.838, 'best_test_test/acc_unbiased': 67.006, 'best_test_test/diff': 16.534, 'best_test_test/acc_skew': 58.74, 'best_test_test/acc_align': 75.273}
[9 / 20] Learning rate: 0.0001 weight: 0.01
[9 / 20] Loss: 4.2931357717210545 CE Loss: 0.45305413078029966 Con Loss: 4.2886051954914235
[9 / 20] tensor([[0.967, 0.739],
        [0.451, 0.527]]) {'epoch': 9, 'valid/acc': 69.224, 'valid/acc_unbiased': 64.258, 'valid/diff': 16.805, 'valid/acc_skew': 55.855, 'valid/acc_align': 72.66, 'test/acc': 72.014, 'test/acc_unbiased': 67.098, 'test/diff': 15.233, 'test/acc_skew': 59.481, 'test/acc_align': 74.714}
[9 / 20] best valid accuracy: 64.258 at epoch 9 
 best_stats: {'best_valid_epoch': 9, 'best_valid_valid/acc': 69.224, 'best_valid_valid/acc_unbiased': 64.258, 'best_valid_valid/diff': 16.805, 'best_valid_valid/acc_skew': 55.855, 'best_valid_valid/acc_align': 72.66, 'best_valid_test/acc': 72.014, 'best_valid_test/acc_unbiased': 67.098, 'best_valid_test/diff': 15.233, 'best_valid_test/acc_skew': 59.481, 'best_valid_test/acc_align': 74.714}
[9 / 20] best test accuracy: 67.098 at epoch 9 
 best_stats: {'best_test_epoch': 9, 'best_test_valid/acc': 69.224, 'best_test_valid/acc_unbiased': 64.258, 'best_test_valid/diff': 16.805, 'best_test_valid/acc_skew': 55.855, 'best_test_valid/acc_align': 72.66, 'best_test_test/acc': 72.014, 'best_test_test/acc_unbiased': 67.098, 'best_test_test/diff': 15.233, 'best_test_test/acc_skew': 59.481, 'best_test_test/acc_align': 74.714}
[10 / 20] Learning rate: 0.0001 weight: 0.01
[10 / 20] Loss: 4.2641704986712226 CE Loss: 0.44167348619749913 Con Loss: 4.259753759949005
[10 / 20] tensor([[0.981, 0.818],
        [0.364, 0.418]]) {'epoch': 10, 'valid/acc': 67.24, 'valid/acc_unbiased': 63.252, 'valid/diff': 12.43, 'valid/acc_skew': 57.037, 'valid/acc_align': 69.467, 'test/acc': 69.193, 'test/acc_unbiased': 64.55, 'test/diff': 10.834, 'test/acc_skew': 59.133, 'test/acc_align': 69.967}
[10 / 20] best valid accuracy: 64.258 at epoch 9 
 best_stats: {'best_valid_epoch': 9, 'best_valid_valid/acc': 69.224, 'best_valid_valid/acc_unbiased': 64.258, 'best_valid_valid/diff': 16.805, 'best_valid_valid/acc_skew': 55.855, 'best_valid_valid/acc_align': 72.66, 'best_valid_test/acc': 72.014, 'best_valid_test/acc_unbiased': 67.098, 'best_valid_test/diff': 15.233, 'best_valid_test/acc_skew': 59.481, 'best_valid_test/acc_align': 74.714}
[10 / 20] best test accuracy: 67.098 at epoch 9 
 best_stats: {'best_test_epoch': 9, 'best_test_valid/acc': 69.224, 'best_test_valid/acc_unbiased': 64.258, 'best_test_valid/diff': 16.805, 'best_test_valid/acc_skew': 55.855, 'best_test_valid/acc_align': 72.66, 'best_test_test/acc': 72.014, 'best_test_test/acc_unbiased': 67.098, 'best_test_test/diff': 15.233, 'best_test_test/acc_skew': 59.481, 'best_test_test/acc_align': 74.714}
[11 / 20] Learning rate: 0.0001 weight: 0.01
[11 / 20] Loss: 4.202401546626803 CE Loss: 0.43238999852746757 Con Loss: 4.1980776395837
[11 / 20] tensor([[0.979, 0.858],
        [0.379, 0.424]]) {'epoch': 11, 'valid/acc': 67.945, 'valid/acc_unbiased': 64.247, 'valid/diff': 9.954, 'valid/acc_skew': 59.27, 'valid/acc_align': 69.224, 'test/acc': 70.031, 'test/acc_unbiased': 66.023, 'test/diff': 8.304, 'test/acc_skew': 61.871, 'test/acc_align': 70.175}
[11 / 20] best valid accuracy: 64.258 at epoch 9 
 best_stats: {'best_valid_epoch': 9, 'best_valid_valid/acc': 69.224, 'best_valid_valid/acc_unbiased': 64.258, 'best_valid_valid/diff': 16.805, 'best_valid_valid/acc_skew': 55.855, 'best_valid_valid/acc_align': 72.66, 'best_valid_test/acc': 72.014, 'best_valid_test/acc_unbiased': 67.098, 'best_valid_test/diff': 15.233, 'best_valid_test/acc_skew': 59.481, 'best_valid_test/acc_align': 74.714}
[11 / 20] best test accuracy: 67.098 at epoch 9 
 best_stats: {'best_test_epoch': 9, 'best_test_valid/acc': 69.224, 'best_test_valid/acc_unbiased': 64.258, 'best_test_valid/diff': 16.805, 'best_test_valid/acc_skew': 55.855, 'best_test_valid/acc_align': 72.66, 'best_test_test/acc': 72.014, 'best_test_test/acc_unbiased': 67.098, 'best_test_test/diff': 15.233, 'best_test_test/acc_skew': 59.481, 'best_test_test/acc_align': 74.714}
[12 / 20] Learning rate: 0.0001 weight: 0.01
[12 / 20] Loss: 4.275231748071783 CE Loss: 0.4245267228346467 Con Loss: 4.270986465959681
[12 / 20] tensor([[0.965, 0.744],
        [0.487, 0.509]]) {'epoch': 12, 'valid/acc': 70.811, 'valid/acc_unbiased': 64.917, 'valid/diff': 15.381, 'valid/acc_skew': 57.226, 'valid/acc_align': 72.607, 'test/acc': 73.204, 'test/acc_unbiased': 67.632, 'test/diff': 12.158, 'test/acc_skew': 61.553, 'test/acc_align': 73.711}
[12 / 20] best valid accuracy: 64.917 at epoch 12 
 best_stats: {'best_valid_epoch': 12, 'best_valid_valid/acc': 70.811, 'best_valid_valid/acc_unbiased': 64.917, 'best_valid_valid/diff': 15.381, 'best_valid_valid/acc_skew': 57.226, 'best_valid_valid/acc_align': 72.607, 'best_valid_test/acc': 73.204, 'best_valid_test/acc_unbiased': 67.632, 'best_valid_test/diff': 12.158, 'best_valid_test/acc_skew': 61.553, 'best_valid_test/acc_align': 73.711}
[12 / 20] best test accuracy: 67.632 at epoch 12 
 best_stats: {'best_test_epoch': 12, 'best_test_valid/acc': 70.811, 'best_test_valid/acc_unbiased': 64.917, 'best_test_valid/diff': 15.381, 'best_test_valid/acc_skew': 57.226, 'best_test_valid/acc_align': 72.607, 'best_test_test/acc': 73.204, 'best_test_test/acc_unbiased': 67.632, 'best_test_test/diff': 12.158, 'best_test_test/acc_skew': 61.553, 'best_test_test/acc_align': 73.711}
[13 / 20] Learning rate: 0.0001 weight: 0.01
[13 / 20] Loss: 4.175487836261493 CE Loss: 0.42601114976767607 Con Loss: 4.171227745061865
[13 / 20] tensor([[0.972, 0.750],
        [0.435, 0.497]]) {'epoch': 13, 'valid/acc': 69.4, 'valid/acc_unbiased': 63.717, 'valid/diff': 17.857, 'valid/acc_skew': 54.789, 'valid/acc_align': 72.646, 'test/acc': 71.485, 'test/acc_unbiased': 66.338, 'test/diff': 14.193, 'test/acc_skew': 59.242, 'test/acc_align': 73.435}
[13 / 20] best valid accuracy: 64.917 at epoch 12 
 best_stats: {'best_valid_epoch': 12, 'best_valid_valid/acc': 70.811, 'best_valid_valid/acc_unbiased': 64.917, 'best_valid_valid/diff': 15.381, 'best_valid_valid/acc_skew': 57.226, 'best_valid_valid/acc_align': 72.607, 'best_valid_test/acc': 73.204, 'best_valid_test/acc_unbiased': 67.632, 'best_valid_test/diff': 12.158, 'best_valid_test/acc_skew': 61.553, 'best_valid_test/acc_align': 73.711}
[13 / 20] best test accuracy: 67.632 at epoch 12 
 best_stats: {'best_test_epoch': 12, 'best_test_valid/acc': 70.811, 'best_test_valid/acc_unbiased': 64.917, 'best_test_valid/diff': 15.381, 'best_test_valid/acc_skew': 57.226, 'best_test_valid/acc_align': 72.607, 'best_test_test/acc': 73.204, 'best_test_test/acc_unbiased': 67.632, 'best_test_test/diff': 12.158, 'best_test_test/acc_skew': 61.553, 'best_test_test/acc_align': 73.711}
[14 / 20] Learning rate: 1e-05 weight: 0.01
[14 / 20] Loss: 4.170331327801829 CE Loss: 0.41892924957264677 Con Loss: 4.166142058077933
[14 / 20] tensor([[0.968, 0.739],
        [0.444, 0.509]]) {'epoch': 14, 'valid/acc': 69.621, 'valid/acc_unbiased': 64.171, 'valid/diff': 16.357, 'valid/acc_skew': 55.993, 'valid/acc_align': 72.35, 'test/acc': 71.662, 'test/acc_unbiased': 66.494, 'test/diff': 14.717, 'test/acc_skew': 59.135, 'test/acc_align': 73.852}
[14 / 20] best valid accuracy: 64.917 at epoch 12 
 best_stats: {'best_valid_epoch': 12, 'best_valid_valid/acc': 70.811, 'best_valid_valid/acc_unbiased': 64.917, 'best_valid_valid/diff': 15.381, 'best_valid_valid/acc_skew': 57.226, 'best_valid_valid/acc_align': 72.607, 'best_valid_test/acc': 73.204, 'best_valid_test/acc_unbiased': 67.632, 'best_valid_test/diff': 12.158, 'best_valid_test/acc_skew': 61.553, 'best_valid_test/acc_align': 73.711}
[14 / 20] best test accuracy: 67.632 at epoch 12 
 best_stats: {'best_test_epoch': 12, 'best_test_valid/acc': 70.811, 'best_test_valid/acc_unbiased': 64.917, 'best_test_valid/diff': 15.381, 'best_test_valid/acc_skew': 57.226, 'best_test_valid/acc_align': 72.607, 'best_test_test/acc': 73.204, 'best_test_test/acc_unbiased': 67.632, 'best_test_test/diff': 12.158, 'best_test_test/acc_skew': 61.553, 'best_test_test/acc_align': 73.711}
[15 / 20] Learning rate: 1e-05 weight: 0.01
[15 / 20] Loss: 4.14681516805868 CE Loss: 0.4099069627783621 Con Loss: 4.142716102410862
[15 / 20] tensor([[0.972, 0.761],
        [0.429, 0.461]]) {'epoch': 15, 'valid/acc': 69.048, 'valid/acc_unbiased': 63.895, 'valid/diff': 14.629, 'valid/acc_skew': 56.58, 'valid/acc_align': 71.209, 'test/acc': 71.089, 'test/acc_unbiased': 65.569, 'test/diff': 12.095, 'test/acc_skew': 59.521, 'test/acc_align': 71.617}
[15 / 20] best valid accuracy: 64.917 at epoch 12 
 best_stats: {'best_valid_epoch': 12, 'best_valid_valid/acc': 70.811, 'best_valid_valid/acc_unbiased': 64.917, 'best_valid_valid/diff': 15.381, 'best_valid_valid/acc_skew': 57.226, 'best_valid_valid/acc_align': 72.607, 'best_valid_test/acc': 73.204, 'best_valid_test/acc_unbiased': 67.632, 'best_valid_test/diff': 12.158, 'best_valid_test/acc_skew': 61.553, 'best_valid_test/acc_align': 73.711}
[15 / 20] best test accuracy: 67.632 at epoch 12 
 best_stats: {'best_test_epoch': 12, 'best_test_valid/acc': 70.811, 'best_test_valid/acc_unbiased': 64.917, 'best_test_valid/diff': 15.381, 'best_test_valid/acc_skew': 57.226, 'best_test_valid/acc_align': 72.607, 'best_test_test/acc': 73.204, 'best_test_test/acc_unbiased': 67.632, 'best_test_test/diff': 12.158, 'best_test_test/acc_skew': 61.553, 'best_test_test/acc_align': 73.711}
[16 / 20] Learning rate: 1e-05 weight: 0.01
[16 / 20] Loss: 4.093867889909162 CE Loss: 0.4139587714715827 Con Loss: 4.089728269448489
[16 / 20] tensor([[0.974, 0.778],
        [0.421, 0.461]]) {'epoch': 16, 'valid/acc': 69.092, 'valid/acc_unbiased': 64.11, 'valid/diff': 14.392, 'valid/acc_skew': 56.914, 'valid/acc_align': 71.306, 'test/acc': 71.0, 'test/acc_unbiased': 65.84, 'test/diff': 11.741, 'test/acc_skew': 59.97, 'test/acc_align': 71.711}
[16 / 20] best valid accuracy: 64.917 at epoch 12 
 best_stats: {'best_valid_epoch': 12, 'best_valid_valid/acc': 70.811, 'best_valid_valid/acc_unbiased': 64.917, 'best_valid_valid/diff': 15.381, 'best_valid_valid/acc_skew': 57.226, 'best_valid_valid/acc_align': 72.607, 'best_valid_test/acc': 73.204, 'best_valid_test/acc_unbiased': 67.632, 'best_valid_test/diff': 12.158, 'best_valid_test/acc_skew': 61.553, 'best_valid_test/acc_align': 73.711}
[16 / 20] best test accuracy: 67.632 at epoch 12 
 best_stats: {'best_test_epoch': 12, 'best_test_valid/acc': 70.811, 'best_test_valid/acc_unbiased': 64.917, 'best_test_valid/diff': 15.381, 'best_test_valid/acc_skew': 57.226, 'best_test_valid/acc_align': 72.607, 'best_test_test/acc': 73.204, 'best_test_test/acc_unbiased': 67.632, 'best_test_test/diff': 12.158, 'best_test_test/acc_skew': 61.553, 'best_test_test/acc_align': 73.711}
[17 / 20] Learning rate: 1e-05 weight: 0.01
[17 / 20] Loss: 4.16796343588106 CE Loss: 0.40934877672788134 Con Loss: 4.163869935803001
[17 / 20] tensor([[0.975, 0.739],
        [0.419, 0.515]]) {'epoch': 17, 'valid/acc': 68.915, 'valid/acc_unbiased': 63.865, 'valid/diff': 17.455, 'valid/acc_skew': 55.138, 'valid/acc_align': 72.593, 'test/acc': 71.045, 'test/acc_unbiased': 66.176, 'test/diff': 16.619, 'test/acc_skew': 57.866, 'test/acc_align': 74.485}
[17 / 20] best valid accuracy: 64.917 at epoch 12 
 best_stats: {'best_valid_epoch': 12, 'best_valid_valid/acc': 70.811, 'best_valid_valid/acc_unbiased': 64.917, 'best_valid_valid/diff': 15.381, 'best_valid_valid/acc_skew': 57.226, 'best_valid_valid/acc_align': 72.607, 'best_valid_test/acc': 73.204, 'best_valid_test/acc_unbiased': 67.632, 'best_valid_test/diff': 12.158, 'best_valid_test/acc_skew': 61.553, 'best_valid_test/acc_align': 73.711}
[17 / 20] best test accuracy: 67.632 at epoch 12 
 best_stats: {'best_test_epoch': 12, 'best_test_valid/acc': 70.811, 'best_test_valid/acc_unbiased': 64.917, 'best_test_valid/diff': 15.381, 'best_test_valid/acc_skew': 57.226, 'best_test_valid/acc_align': 72.607, 'best_test_test/acc': 73.204, 'best_test_test/acc_unbiased': 67.632, 'best_test_test/diff': 12.158, 'best_test_test/acc_skew': 61.553, 'best_test_test/acc_align': 73.711}
[18 / 20] Learning rate: 1e-05 weight: 0.01
[18 / 20] Loss: 4.100490942647599 CE Loss: 0.4113754508469445 Con Loss: 4.096377193503771
[18 / 20] tensor([[0.975, 0.756],
        [0.422, 0.479]]) {'epoch': 18, 'valid/acc': 69.136, 'valid/acc_unbiased': 63.841, 'valid/diff': 15.823, 'valid/acc_skew': 55.929, 'valid/acc_align': 71.753, 'test/acc': 71.089, 'test/acc_unbiased': 65.803, 'test/diff': 13.823, 'test/acc_skew': 58.891, 'test/acc_align': 72.714}
[18 / 20] best valid accuracy: 64.917 at epoch 12 
 best_stats: {'best_valid_epoch': 12, 'best_valid_valid/acc': 70.811, 'best_valid_valid/acc_unbiased': 64.917, 'best_valid_valid/diff': 15.381, 'best_valid_valid/acc_skew': 57.226, 'best_valid_valid/acc_align': 72.607, 'best_valid_test/acc': 73.204, 'best_valid_test/acc_unbiased': 67.632, 'best_valid_test/diff': 12.158, 'best_valid_test/acc_skew': 61.553, 'best_valid_test/acc_align': 73.711}
[18 / 20] best test accuracy: 67.632 at epoch 12 
 best_stats: {'best_test_epoch': 12, 'best_test_valid/acc': 70.811, 'best_test_valid/acc_unbiased': 64.917, 'best_test_valid/diff': 15.381, 'best_test_valid/acc_skew': 57.226, 'best_test_valid/acc_align': 72.607, 'best_test_test/acc': 73.204, 'best_test_test/acc_unbiased': 67.632, 'best_test_test/diff': 12.158, 'best_test_test/acc_skew': 61.553, 'best_test_test/acc_align': 73.711}
[19 / 20] Learning rate: 1e-05 weight: 0.01
[19 / 20] Loss: 4.112387133376601 CE Loss: 0.4083708146345031 Con Loss: 4.108303415511976
[19 / 20] tensor([[0.971, 0.699],
        [0.444, 0.552]]) {'epoch': 19, 'valid/acc': 69.577, 'valid/acc_unbiased': 64.391, 'valid/diff': 20.469, 'valid/acc_skew': 54.157, 'valid/acc_align': 74.626, 'test/acc': 71.794, 'test/acc_unbiased': 66.631, 'test/diff': 18.969, 'test/acc_skew': 57.146, 'test/acc_align': 76.115}
[19 / 20] best valid accuracy: 64.917 at epoch 12 
 best_stats: {'best_valid_epoch': 12, 'best_valid_valid/acc': 70.811, 'best_valid_valid/acc_unbiased': 64.917, 'best_valid_valid/diff': 15.381, 'best_valid_valid/acc_skew': 57.226, 'best_valid_valid/acc_align': 72.607, 'best_valid_test/acc': 73.204, 'best_valid_test/acc_unbiased': 67.632, 'best_valid_test/diff': 12.158, 'best_valid_test/acc_skew': 61.553, 'best_valid_test/acc_align': 73.711}
[19 / 20] best test accuracy: 67.632 at epoch 12 
 best_stats: {'best_test_epoch': 12, 'best_test_valid/acc': 70.811, 'best_test_valid/acc_unbiased': 64.917, 'best_test_valid/diff': 15.381, 'best_test_valid/acc_skew': 57.226, 'best_test_valid/acc_align': 72.607, 'best_test_test/acc': 73.204, 'best_test_test/acc_unbiased': 67.632, 'best_test_test/diff': 12.158, 'best_test_test/acc_skew': 61.553, 'best_test_test/acc_align': 73.711}
[20 / 20] Learning rate: 1e-05 weight: 0.01
[20 / 20] Loss: 4.069209782205151 CE Loss: 0.4069199992426769 Con Loss: 4.065140602428874
[20 / 20] tensor([[0.977, 0.790],
        [0.420, 0.455]]) {'epoch': 20, 'valid/acc': 68.915, 'valid/acc_unbiased': 63.977, 'valid/diff': 15.746, 'valid/acc_skew': 56.104, 'valid/acc_align': 71.85, 'test/acc': 71.177, 'test/acc_unbiased': 66.038, 'test/diff': 11.116, 'test/acc_skew': 60.481, 'test/acc_align': 71.596}
[20 / 20] best valid accuracy: 64.917 at epoch 12 
 best_stats: {'best_valid_epoch': 12, 'best_valid_valid/acc': 70.811, 'best_valid_valid/acc_unbiased': 64.917, 'best_valid_valid/diff': 15.381, 'best_valid_valid/acc_skew': 57.226, 'best_valid_valid/acc_align': 72.607, 'best_valid_test/acc': 73.204, 'best_valid_test/acc_unbiased': 67.632, 'best_valid_test/diff': 12.158, 'best_valid_test/acc_skew': 61.553, 'best_valid_test/acc_align': 73.711}
[20 / 20] best test accuracy: 67.632 at epoch 12 
 best_stats: {'best_test_epoch': 12, 'best_test_valid/acc': 70.811, 'best_test_valid/acc_unbiased': 64.917, 'best_test_valid/diff': 15.381, 'best_test_valid/acc_skew': 57.226, 'best_test_valid/acc_align': 72.607, 'best_test_test/acc': 73.204, 'best_test_test/acc_unbiased': 67.632, 'best_test_test/diff': 12.158, 'best_test_test/acc_skew': 61.553, 'best_test_test/acc_align': 73.711}
Total training time: 0:16:47
