Log level set to: INFO
Set seed: 1
=======> Using Fixed Random Seed: 1 <========
save_path: exp_results/bc-bb0-celeba_smiling-os_0.7-lr0.001-bs128-cbs64-w0.01-ratio30-aug1-seed1
get_celeba - split:train, aug: False, given_y: True, ratio: 0
use existing smiling indices from data/celeba/pickles/smiling
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [28429, 28429]
Target 1: [28429, 28429]
Binary Target 1
---------------------------
Target 0: [28429, 28429]
Target 1: [28429, 28429]
===================================
Normal Label Distribution: 
Target 0: [28429, 28429]
Target 1: [28429, 28429]
===================================
Use BiasedCelebASplit 
 target_attr: smiling split: train 
 tensor([[28429., 28429.],
        [28429., 28429.]])
get_celeba - split:train, aug: 1, given_y: True, ratio: 30
use existing smiling indices from data/celeba/pickles/smiling
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [28490, 28490]
Target 1: [28490, 28490]
Binary Target 1
---------------------------
Target 0: [28490, 28490]
Target 1: [28490, 28490]
===================================
Normal Label Distribution: 
Target 0: [28490, 28490]
Target 1: [28490, 28490]
===================================
Use BiasedCelebASplit 
 target_attr: smiling split: train 
 tensor([[28490., 28490.],
        [28490., 28490.]])
get_celeba - split:train_valid, aug: False, given_y: True, ratio: 0
use existing smiling indices from data/celeba/pickles/smiling
Use BiasedCelebASplit 
 target_attr: smiling split: train_valid 
 tensor([[ 2019., 10233.],
        [ 8156.,  1957.]])
get_celeba - split:valid, aug: False, given_y: True, ratio: 0
Use BiasedCelebASplit 
 target_attr: smiling split: valid 
 tensor([[5252., 6157.],
        [5013., 3445.]])
decay_epochs: [3, 6]
[1 / 10] Learning rate: 0.001 weight: 0.01
[1 / 10] Loss: 4.641763464020493 CE Loss: 0.2571184179966447 Con Loss: 4.639192287130811
[1 / 10] tensor([[0.916, 0.914],
        [0.920, 0.900]]) {'epoch': 1, 'valid/acc': 91.585, 'valid/acc_unbiased': 91.293, 'valid/diff': 1.142, 'valid/acc_skew': 91.864, 'valid/acc_align': 90.721, 'test/acc': 91.398, 'test/acc_unbiased': 91.251, 'test/diff': 1.114, 'test/acc_skew': 91.808, 'test/acc_align': 90.694}
[1 / 10] best valid accuracy: 91.293 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 91.585, 'best_valid_valid/acc_unbiased': 91.293, 'best_valid_valid/diff': 1.142, 'best_valid_valid/acc_skew': 91.864, 'best_valid_valid/acc_align': 90.721, 'best_valid_test/acc': 91.398, 'best_valid_test/acc_unbiased': 91.251, 'best_valid_test/diff': 1.114, 'best_valid_test/acc_skew': 91.808, 'best_valid_test/acc_align': 90.694}
[1 / 10] best test accuracy: 91.251 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 91.585, 'best_test_valid/acc_unbiased': 91.293, 'best_test_valid/diff': 1.142, 'best_test_valid/acc_skew': 91.864, 'best_test_valid/acc_align': 90.721, 'best_test_test/acc': 91.398, 'best_test_test/acc_unbiased': 91.251, 'best_test_test/diff': 1.114, 'best_test_test/acc_skew': 91.808, 'best_test_test/acc_align': 90.694}
[2 / 10] Learning rate: 0.001 weight: 0.01
[2 / 10] Loss: 4.599532910239336 CE Loss: 0.22968689784884072 Con Loss: 4.59723603860036
[2 / 10] tensor([[0.941, 0.929],
        [0.909, 0.891]]) {'epoch': 2, 'valid/acc': 91.751, 'valid/acc_unbiased': 91.669, 'valid/diff': 2.275, 'valid/acc_skew': 92.807, 'valid/acc_align': 90.532, 'test/acc': 91.951, 'test/acc_unbiased': 91.762, 'test/diff': 1.532, 'test/acc_skew': 92.528, 'test/acc_align': 90.997}
[2 / 10] best valid accuracy: 91.669 at epoch 2 
 best_stats: {'best_valid_epoch': 2, 'best_valid_valid/acc': 91.751, 'best_valid_valid/acc_unbiased': 91.669, 'best_valid_valid/diff': 2.275, 'best_valid_valid/acc_skew': 92.807, 'best_valid_valid/acc_align': 90.532, 'best_valid_test/acc': 91.951, 'best_valid_test/acc_unbiased': 91.762, 'best_valid_test/diff': 1.532, 'best_valid_test/acc_skew': 92.528, 'best_valid_test/acc_align': 90.997}
[2 / 10] best test accuracy: 91.762 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 91.751, 'best_test_valid/acc_unbiased': 91.669, 'best_test_valid/diff': 2.275, 'best_test_valid/acc_skew': 92.807, 'best_test_valid/acc_align': 90.532, 'best_test_test/acc': 91.951, 'best_test_test/acc_unbiased': 91.762, 'best_test_test/diff': 1.532, 'best_test_test/acc_skew': 92.528, 'best_test_test/acc_align': 90.997}
[3 / 10] Learning rate: 0.001 weight: 0.01
[3 / 10] Loss: 4.589345693412141 CE Loss: 0.22635910042654203 Con Loss: 4.587082106630425
[3 / 10] tensor([[0.788, 0.804],
        [0.975, 0.963]]) {'epoch': 3, 'valid/acc': 89.381, 'valid/acc_unbiased': 88.486, 'valid/diff': 0.407, 'valid/acc_skew': 88.598, 'valid/acc_align': 88.374, 'test/acc': 88.03, 'test/acc_unbiased': 88.251, 'test/diff': 1.371, 'test/acc_skew': 88.136, 'test/acc_align': 88.367}
[3 / 10] best valid accuracy: 91.669 at epoch 2 
 best_stats: {'best_valid_epoch': 2, 'best_valid_valid/acc': 91.751, 'best_valid_valid/acc_unbiased': 91.669, 'best_valid_valid/diff': 2.275, 'best_valid_valid/acc_skew': 92.807, 'best_valid_valid/acc_align': 90.532, 'best_valid_test/acc': 91.951, 'best_valid_test/acc_unbiased': 91.762, 'best_valid_test/diff': 1.532, 'best_valid_test/acc_skew': 92.528, 'best_valid_test/acc_align': 90.997}
[3 / 10] best test accuracy: 91.762 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 91.751, 'best_test_valid/acc_unbiased': 91.669, 'best_test_valid/diff': 2.275, 'best_test_valid/acc_skew': 92.807, 'best_test_valid/acc_align': 90.532, 'best_test_test/acc': 91.951, 'best_test_test/acc_unbiased': 91.762, 'best_test_test/diff': 1.532, 'best_test_test/acc_skew': 92.528, 'best_test_test/acc_align': 90.997}
[4 / 10] Learning rate: 0.0001 weight: 0.01
[4 / 10] Loss: 4.54885038059316 CE Loss: 0.20068635243131394 Con Loss: 4.546843522608672
[4 / 10] tensor([[0.952, 0.932],
        [0.911, 0.898]]) {'epoch': 4, 'valid/acc': 92.399, 'valid/acc_unbiased': 92.564, 'valid/diff': 1.726, 'valid/acc_skew': 93.428, 'valid/acc_align': 91.701, 'test/acc': 92.47, 'test/acc_unbiased': 92.305, 'test/diff': 1.67, 'test/acc_skew': 93.14, 'test/acc_align': 91.47}
[4 / 10] best valid accuracy: 92.564 at epoch 4 
 best_stats: {'best_valid_epoch': 4, 'best_valid_valid/acc': 92.399, 'best_valid_valid/acc_unbiased': 92.564, 'best_valid_valid/diff': 1.726, 'best_valid_valid/acc_skew': 93.428, 'best_valid_valid/acc_align': 91.701, 'best_valid_test/acc': 92.47, 'best_valid_test/acc_unbiased': 92.305, 'best_valid_test/diff': 1.67, 'best_valid_test/acc_skew': 93.14, 'best_valid_test/acc_align': 91.47}
[4 / 10] best test accuracy: 92.305 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 92.399, 'best_test_valid/acc_unbiased': 92.564, 'best_test_valid/diff': 1.726, 'best_test_valid/acc_skew': 93.428, 'best_test_valid/acc_align': 91.701, 'best_test_test/acc': 92.47, 'best_test_test/acc_unbiased': 92.305, 'best_test_test/diff': 1.67, 'best_test_test/acc_skew': 93.14, 'best_test_test/acc_align': 91.47}
[5 / 10] Learning rate: 0.0001 weight: 0.01
[5 / 10] Loss: 4.539797352924311 CE Loss: 0.1913439070444831 Con Loss: 4.537883907924489
[5 / 10] tensor([[0.923, 0.910],
        [0.939, 0.925]]) {'epoch': 5, 'valid/acc': 92.698, 'valid/acc_unbiased': 92.587, 'valid/diff': 1.607, 'valid/acc_skew': 93.39, 'valid/acc_align': 91.783, 'test/acc': 92.49, 'test/acc_unbiased': 92.41, 'test/diff': 1.363, 'test/acc_skew': 93.091, 'test/acc_align': 91.728}
[5 / 10] best valid accuracy: 92.587 at epoch 5 
 best_stats: {'best_valid_epoch': 5, 'best_valid_valid/acc': 92.698, 'best_valid_valid/acc_unbiased': 92.587, 'best_valid_valid/diff': 1.607, 'best_valid_valid/acc_skew': 93.39, 'best_valid_valid/acc_align': 91.783, 'best_valid_test/acc': 92.49, 'best_valid_test/acc_unbiased': 92.41, 'best_valid_test/diff': 1.363, 'best_valid_test/acc_skew': 93.091, 'best_valid_test/acc_align': 91.728}
[5 / 10] best test accuracy: 92.410 at epoch 5 
 best_stats: {'best_test_epoch': 5, 'best_test_valid/acc': 92.698, 'best_test_valid/acc_unbiased': 92.587, 'best_test_valid/diff': 1.607, 'best_test_valid/acc_skew': 93.39, 'best_test_valid/acc_align': 91.783, 'best_test_test/acc': 92.49, 'best_test_test/acc_unbiased': 92.41, 'best_test_test/diff': 1.363, 'best_test_test/acc_skew': 93.091, 'best_test_test/acc_align': 91.728}
[6 / 10] Learning rate: 0.0001 weight: 0.01
[6 / 10] Loss: 4.53517974920406 CE Loss: 0.19043488140773596 Con Loss: 4.533275391198499
[6 / 10] tensor([[0.950, 0.934],
        [0.915, 0.897]]) {'epoch': 6, 'valid/acc': 92.56, 'valid/acc_unbiased': 92.955, 'valid/diff': 1.598, 'valid/acc_skew': 93.754, 'valid/acc_align': 92.156, 'test/acc': 92.606, 'test/acc_unbiased': 92.415, 'test/diff': 1.668, 'test/acc_skew': 93.249, 'test/acc_align': 91.581}
[6 / 10] best valid accuracy: 92.955 at epoch 6 
 best_stats: {'best_valid_epoch': 6, 'best_valid_valid/acc': 92.56, 'best_valid_valid/acc_unbiased': 92.955, 'best_valid_valid/diff': 1.598, 'best_valid_valid/acc_skew': 93.754, 'best_valid_valid/acc_align': 92.156, 'best_valid_test/acc': 92.606, 'best_valid_test/acc_unbiased': 92.415, 'best_valid_test/diff': 1.668, 'best_valid_test/acc_skew': 93.249, 'best_valid_test/acc_align': 91.581}
[6 / 10] best test accuracy: 92.415 at epoch 6 
 best_stats: {'best_test_epoch': 6, 'best_test_valid/acc': 92.56, 'best_test_valid/acc_unbiased': 92.955, 'best_test_valid/diff': 1.598, 'best_test_valid/acc_skew': 93.754, 'best_test_valid/acc_align': 92.156, 'best_test_test/acc': 92.606, 'best_test_test/acc_unbiased': 92.415, 'best_test_test/diff': 1.668, 'best_test_test/acc_skew': 93.249, 'best_test_test/acc_align': 91.581}
[7 / 10] Learning rate: 1e-05 weight: 0.01
[7 / 10] Loss: 4.5244814607796755 CE Loss: 0.18693188171278283 Con Loss: 4.5226121456507595
[7 / 10] tensor([[0.947, 0.932],
        [0.921, 0.904]]) {'epoch': 7, 'valid/acc': 92.712, 'valid/acc_unbiased': 93.023, 'valid/diff': 1.137, 'valid/acc_skew': 93.592, 'valid/acc_align': 92.454, 'test/acc': 92.772, 'test/acc_unbiased': 92.598, 'test/diff': 1.596, 'test/acc_skew': 93.396, 'test/acc_align': 91.8}
[7 / 10] best valid accuracy: 93.023 at epoch 7 
 best_stats: {'best_valid_epoch': 7, 'best_valid_valid/acc': 92.712, 'best_valid_valid/acc_unbiased': 93.023, 'best_valid_valid/diff': 1.137, 'best_valid_valid/acc_skew': 93.592, 'best_valid_valid/acc_align': 92.454, 'best_valid_test/acc': 92.772, 'best_valid_test/acc_unbiased': 92.598, 'best_valid_test/diff': 1.596, 'best_valid_test/acc_skew': 93.396, 'best_valid_test/acc_align': 91.8}
[7 / 10] best test accuracy: 92.598 at epoch 7 
 best_stats: {'best_test_epoch': 7, 'best_test_valid/acc': 92.712, 'best_test_valid/acc_unbiased': 93.023, 'best_test_valid/diff': 1.137, 'best_test_valid/acc_skew': 93.592, 'best_test_valid/acc_align': 92.454, 'best_test_test/acc': 92.772, 'best_test_test/acc_unbiased': 92.598, 'best_test_test/diff': 1.596, 'best_test_test/acc_skew': 93.396, 'best_test_test/acc_align': 91.8}
[8 / 10] Learning rate: 1e-05 weight: 0.01
[8 / 10] Loss: 4.5241447561645725 CE Loss: 0.18542253351235868 Con Loss: 4.522290531609169
[8 / 10] tensor([[0.947, 0.934],
        [0.922, 0.905]]) {'epoch': 8, 'valid/acc': 92.73, 'valid/acc_unbiased': 92.923, 'valid/diff': 1.336, 'valid/acc_skew': 93.591, 'valid/acc_align': 92.255, 'test/acc': 92.857, 'test/acc_unbiased': 92.689, 'test/diff': 1.501, 'test/acc_skew': 93.439, 'test/acc_align': 91.938}
[8 / 10] best valid accuracy: 93.023 at epoch 7 
 best_stats: {'best_valid_epoch': 7, 'best_valid_valid/acc': 92.712, 'best_valid_valid/acc_unbiased': 93.023, 'best_valid_valid/diff': 1.137, 'best_valid_valid/acc_skew': 93.592, 'best_valid_valid/acc_align': 92.454, 'best_valid_test/acc': 92.772, 'best_valid_test/acc_unbiased': 92.598, 'best_valid_test/diff': 1.596, 'best_valid_test/acc_skew': 93.396, 'best_valid_test/acc_align': 91.8}
[8 / 10] best test accuracy: 92.689 at epoch 8 
 best_stats: {'best_test_epoch': 8, 'best_test_valid/acc': 92.73, 'best_test_valid/acc_unbiased': 92.923, 'best_test_valid/diff': 1.336, 'best_test_valid/acc_skew': 93.591, 'best_test_valid/acc_align': 92.255, 'best_test_test/acc': 92.857, 'best_test_test/acc_unbiased': 92.689, 'best_test_test/diff': 1.501, 'best_test_test/acc_skew': 93.439, 'best_test_test/acc_align': 91.938}
[9 / 10] Learning rate: 1e-05 weight: 0.01
[9 / 10] Loss: 4.522619315467461 CE Loss: 0.1840753361712222 Con Loss: 4.52077856435866
[9 / 10] tensor([[0.952, 0.938],
        [0.917, 0.901]]) {'epoch': 9, 'valid/acc': 92.819, 'valid/acc_unbiased': 93.083, 'valid/diff': 1.446, 'valid/acc_skew': 93.806, 'valid/acc_align': 92.36, 'test/acc': 92.883, 'test/acc_unbiased': 92.706, 'test/diff': 1.504, 'test/acc_skew': 93.458, 'test/acc_align': 91.953}
[9 / 10] best valid accuracy: 93.083 at epoch 9 
 best_stats: {'best_valid_epoch': 9, 'best_valid_valid/acc': 92.819, 'best_valid_valid/acc_unbiased': 93.083, 'best_valid_valid/diff': 1.446, 'best_valid_valid/acc_skew': 93.806, 'best_valid_valid/acc_align': 92.36, 'best_valid_test/acc': 92.883, 'best_valid_test/acc_unbiased': 92.706, 'best_valid_test/diff': 1.504, 'best_valid_test/acc_skew': 93.458, 'best_valid_test/acc_align': 91.953}
[9 / 10] best test accuracy: 92.706 at epoch 9 
 best_stats: {'best_test_epoch': 9, 'best_test_valid/acc': 92.819, 'best_test_valid/acc_unbiased': 93.083, 'best_test_valid/diff': 1.446, 'best_test_valid/acc_skew': 93.806, 'best_test_valid/acc_align': 92.36, 'best_test_test/acc': 92.883, 'best_test_test/acc_unbiased': 92.706, 'best_test_test/diff': 1.504, 'best_test_test/acc_skew': 93.458, 'best_test_test/acc_align': 91.953}
[10 / 10] Learning rate: 1e-05 weight: 0.01
[10 / 10] Loss: 4.520088137162675 CE Loss: 0.1838830559706729 Con Loss: 4.518249307391118
[10 / 10] tensor([[0.941, 0.929],
        [0.927, 0.911]]) {'epoch': 10, 'valid/acc': 92.922, 'valid/acc_unbiased': 93.182, 'valid/diff': 1.246, 'valid/acc_skew': 93.805, 'valid/acc_align': 92.559, 'test/acc': 92.832, 'test/acc_unbiased': 92.687, 'test/diff': 1.415, 'test/acc_skew': 93.394, 'test/acc_align': 91.979}
[10 / 10] best valid accuracy: 93.182 at epoch 10 
 best_stats: {'best_valid_epoch': 10, 'best_valid_valid/acc': 92.922, 'best_valid_valid/acc_unbiased': 93.182, 'best_valid_valid/diff': 1.246, 'best_valid_valid/acc_skew': 93.805, 'best_valid_valid/acc_align': 92.559, 'best_valid_test/acc': 92.832, 'best_valid_test/acc_unbiased': 92.687, 'best_valid_test/diff': 1.415, 'best_valid_test/acc_skew': 93.394, 'best_valid_test/acc_align': 91.979}
[10 / 10] best test accuracy: 92.706 at epoch 9 
 best_stats: {'best_test_epoch': 9, 'best_test_valid/acc': 92.819, 'best_test_valid/acc_unbiased': 93.083, 'best_test_valid/diff': 1.446, 'best_test_valid/acc_skew': 93.806, 'best_test_valid/acc_align': 92.36, 'best_test_test/acc': 92.883, 'best_test_test/acc_unbiased': 92.706, 'best_test_test/diff': 1.504, 'best_test_test/acc_skew': 93.458, 'best_test_test/acc_align': 91.953}
Total training time: 1:53:20
