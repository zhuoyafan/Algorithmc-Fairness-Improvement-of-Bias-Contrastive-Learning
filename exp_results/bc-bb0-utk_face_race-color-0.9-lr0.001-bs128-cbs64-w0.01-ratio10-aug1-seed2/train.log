Log level set to: INFO
Set seed: 2
=======> Using Fixed Random Seed: 2 <========
save_path: exp_results/bc-bb0-utk_face_race-color-0.9-lr0.001-bs128-cbs64-w0.01-ratio10-aug1-seed2
get_utk_face - split: train, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_race-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [4407, 552]
Target 1: [440, 5529]
Binary Target 1
---------------------------
Target 0: [4407, 552]
Target 1: [440, 5529]
===================================
Normal Label Distribution: 
Target 0: [4407, 552]
Target 1: [440, 5529]
===================================
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [4407, 552]
Target 1: [440, 5529]
Binary Target 1
---------------------------
Target 0: [4407, 552]
Target 1: [440, 5529]
===================================
Normal Label Distribution: 
Target 0: [4407, 552]
Target 1: [440, 5529]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 10928, target_attr: gender, bias_attr: race bias_rate: 0.9
['[train] target_0-bias_0: 4407', '[train] target_0-bias_1: 552', '[train] target_1-bias_0: 440', '[train] target_1-bias_1: 5529']
confusion_matrix - 
 original: tensor([[4407.,  440.],
        [ 552., 5529.]]), 
 normalized: tensor([[0.909, 0.091],
        [0.091, 0.909]]), 
 b|y: tensor([[0.889, 0.111],
        [0.074, 0.926]])
get_utk_face - split: train, aug: 1, given_y: True, ratio: 10
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_race-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [4407, 552]
Target 1: [440, 5529]
Binary Target 1
---------------------------
Target 0: [4407, 552]
Target 1: [440, 5529]
===================================
Normal Label Distribution: 
Target 0: [4407, 552]
Target 1: [440, 5529]
===================================
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [4407, 552]
Target 1: [440, 5529]
Binary Target 1
---------------------------
Target 0: [4407, 552]
Target 1: [440, 5529]
===================================
Normal Label Distribution: 
Target 0: [4407, 552]
Target 1: [440, 5529]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 10928, target_attr: gender, bias_attr: race bias_rate: 0.9
['[train] target_0-bias_0: 4407', '[train] target_0-bias_1: 552', '[train] target_1-bias_0: 440', '[train] target_1-bias_1: 5529']
get_utk_face - split: valid, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_race-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [583, 684]
Target 1: [457, 646]
Binary Target 1
---------------------------
Target 0: [583, 684]
Target 1: [457, 646]
===================================
Normal Label Distribution: 
Target 0: [583, 684]
Target 1: [457, 646]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 2370, target_attr: gender, bias_attr: race bias_rate: 0.9
['[valid] target_0-bias_0: 583', '[valid] target_0-bias_1: 684', '[valid] target_1-bias_0: 457', '[valid] target_1-bias_1: 646']
get_utk_face - split: test, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_race-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [558, 677]
Target 1: [462, 673]
Binary Target 1
---------------------------
Target 0: [558, 677]
Target 1: [462, 673]
===================================
Normal Label Distribution: 
Target 0: [558, 677]
Target 1: [462, 673]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 2370, target_attr: gender, bias_attr: race bias_rate: 0.9
['[test] target_0-bias_0: 558', '[test] target_0-bias_1: 677', '[test] target_1-bias_0: 462', '[test] target_1-bias_1: 673']
decay_epochs: [6, 13]
[1 / 20] Learning rate: 0.001 weight: 0.01
[1 / 20] Loss: 4.918122117725333 CE Loss: 0.5958902518187226 Con Loss: 4.912163219898721
[1 / 20] tensor([[0.955, 0.900],
        [0.515, 0.577]]) {'epoch': 1, 'valid/acc': 75.401, 'valid/acc_unbiased': 73.836, 'valid/diff': 2.462, 'valid/acc_skew': 72.605, 'valid/acc_align': 75.067, 'test/acc': 74.599, 'test/acc_unbiased': 73.661, 'test/diff': 5.851, 'test/acc_skew': 70.735, 'test/acc_align': 76.586}
[1 / 20] best valid accuracy: 73.836 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 75.401, 'best_valid_valid/acc_unbiased': 73.836, 'best_valid_valid/diff': 2.462, 'best_valid_valid/acc_skew': 72.605, 'best_valid_valid/acc_align': 75.067, 'best_valid_test/acc': 74.599, 'best_valid_test/acc_unbiased': 73.661, 'best_valid_test/diff': 5.851, 'best_valid_test/acc_skew': 70.735, 'best_valid_test/acc_align': 76.586}
[1 / 20] best test accuracy: 73.661 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 75.401, 'best_test_valid/acc_unbiased': 73.836, 'best_test_valid/diff': 2.462, 'best_test_valid/acc_skew': 72.605, 'best_test_valid/acc_align': 75.067, 'best_test_test/acc': 74.599, 'best_test_test/acc_unbiased': 73.661, 'best_test_test/diff': 5.851, 'best_test_test/acc_skew': 70.735, 'best_test_test/acc_align': 76.586}
[2 / 20] Learning rate: 0.001 weight: 0.01
[2 / 20] Loss: 4.6895533592425185 CE Loss: 0.5044094230734237 Con Loss: 4.684509232662084
[2 / 20] tensor([[0.961, 0.947],
        [0.340, 0.489]]) {'epoch': 2, 'valid/acc': 71.477, 'valid/acc_unbiased': 69.22, 'valid/diff': 5.113, 'valid/acc_skew': 66.663, 'valid/acc_align': 71.776, 'test/acc': 70.169, 'test/acc_unbiased': 68.402, 'test/diff': 8.139, 'test/acc_skew': 64.333, 'test/acc_align': 72.471}
[2 / 20] best valid accuracy: 73.836 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 75.401, 'best_valid_valid/acc_unbiased': 73.836, 'best_valid_valid/diff': 2.462, 'best_valid_valid/acc_skew': 72.605, 'best_valid_valid/acc_align': 75.067, 'best_valid_test/acc': 74.599, 'best_valid_test/acc_unbiased': 73.661, 'best_valid_test/diff': 5.851, 'best_valid_test/acc_skew': 70.735, 'best_valid_test/acc_align': 76.586}
[2 / 20] best test accuracy: 73.661 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 75.401, 'best_test_valid/acc_unbiased': 73.836, 'best_test_valid/diff': 2.462, 'best_test_valid/acc_skew': 72.605, 'best_test_valid/acc_align': 75.067, 'best_test_test/acc': 74.599, 'best_test_test/acc_unbiased': 73.661, 'best_test_test/diff': 5.851, 'best_test_test/acc_skew': 70.735, 'best_test_test/acc_align': 76.586}
[3 / 20] Learning rate: 0.001 weight: 0.01
[3 / 20] Loss: 4.61873316101588 CE Loss: 0.4895752268252924 Con Loss: 4.613837404097505
[3 / 20] tensor([[0.737, 0.643],
        [0.864, 0.923]]) {'epoch': 3, 'valid/acc': 79.241, 'valid/acc_unbiased': 79.906, 'valid/diff': 3.645, 'valid/acc_skew': 78.083, 'valid/acc_align': 81.728, 'test/acc': 78.734, 'test/acc_unbiased': 79.137, 'test/diff': 7.656, 'test/acc_skew': 75.309, 'test/acc_align': 82.965}
[3 / 20] best valid accuracy: 79.906 at epoch 3 
 best_stats: {'best_valid_epoch': 3, 'best_valid_valid/acc': 79.241, 'best_valid_valid/acc_unbiased': 79.906, 'best_valid_valid/diff': 3.645, 'best_valid_valid/acc_skew': 78.083, 'best_valid_valid/acc_align': 81.728, 'best_valid_test/acc': 78.734, 'best_valid_test/acc_unbiased': 79.137, 'best_valid_test/diff': 7.656, 'best_valid_test/acc_skew': 75.309, 'best_valid_test/acc_align': 82.965}
[3 / 20] best test accuracy: 79.137 at epoch 3 
 best_stats: {'best_test_epoch': 3, 'best_test_valid/acc': 79.241, 'best_test_valid/acc_unbiased': 79.906, 'best_test_valid/diff': 3.645, 'best_test_valid/acc_skew': 78.083, 'best_test_valid/acc_align': 81.728, 'best_test_test/acc': 78.734, 'best_test_test/acc_unbiased': 79.137, 'best_test_test/diff': 7.656, 'best_test_test/acc_skew': 75.309, 'best_test_test/acc_align': 82.965}
[4 / 20] Learning rate: 0.001 weight: 0.01
[4 / 20] Loss: 4.559746481140047 CE Loss: 0.472697552615343 Con Loss: 4.555019525273827
[4 / 20] tensor([[0.704, 0.536],
        [0.916, 0.955]]) {'epoch': 4, 'valid/acc': 77.426, 'valid/acc_unbiased': 78.532, 'valid/diff': 6.973, 'valid/acc_skew': 75.045, 'valid/acc_align': 82.019, 'test/acc': 76.878, 'test/acc_unbiased': 77.787, 'test/diff': 10.398, 'test/acc_skew': 72.589, 'test/acc_align': 82.986}
[4 / 20] best valid accuracy: 79.906 at epoch 3 
 best_stats: {'best_valid_epoch': 3, 'best_valid_valid/acc': 79.241, 'best_valid_valid/acc_unbiased': 79.906, 'best_valid_valid/diff': 3.645, 'best_valid_valid/acc_skew': 78.083, 'best_valid_valid/acc_align': 81.728, 'best_valid_test/acc': 78.734, 'best_valid_test/acc_unbiased': 79.137, 'best_valid_test/diff': 7.656, 'best_valid_test/acc_skew': 75.309, 'best_valid_test/acc_align': 82.965}
[4 / 20] best test accuracy: 79.137 at epoch 3 
 best_stats: {'best_test_epoch': 3, 'best_test_valid/acc': 79.241, 'best_test_valid/acc_unbiased': 79.906, 'best_test_valid/diff': 3.645, 'best_test_valid/acc_skew': 78.083, 'best_test_valid/acc_align': 81.728, 'best_test_test/acc': 78.734, 'best_test_test/acc_unbiased': 79.137, 'best_test_test/diff': 7.656, 'best_test_test/acc_skew': 75.309, 'best_test_test/acc_align': 82.965}
[5 / 20] Learning rate: 0.001 weight: 0.01
[5 / 20] Loss: 4.5259465675577415 CE Loss: 0.46327739430381476 Con Loss: 4.521313776208925
[5 / 20] tensor([[0.808, 0.684],
        [0.792, 0.889]]) {'epoch': 5, 'valid/acc': 78.354, 'valid/acc_unbiased': 78.744, 'valid/diff': 6.353, 'valid/acc_skew': 75.568, 'valid/acc_align': 81.92, 'test/acc': 79.241, 'test/acc_unbiased': 79.323, 'test/diff': 11.035, 'test/acc_skew': 73.805, 'test/acc_align': 84.84}
[5 / 20] best valid accuracy: 79.906 at epoch 3 
 best_stats: {'best_valid_epoch': 3, 'best_valid_valid/acc': 79.241, 'best_valid_valid/acc_unbiased': 79.906, 'best_valid_valid/diff': 3.645, 'best_valid_valid/acc_skew': 78.083, 'best_valid_valid/acc_align': 81.728, 'best_valid_test/acc': 78.734, 'best_valid_test/acc_unbiased': 79.137, 'best_valid_test/diff': 7.656, 'best_valid_test/acc_skew': 75.309, 'best_valid_test/acc_align': 82.965}
[5 / 20] best test accuracy: 79.323 at epoch 5 
 best_stats: {'best_test_epoch': 5, 'best_test_valid/acc': 78.354, 'best_test_valid/acc_unbiased': 78.744, 'best_test_valid/diff': 6.353, 'best_test_valid/acc_skew': 75.568, 'best_test_valid/acc_align': 81.92, 'best_test_test/acc': 79.241, 'best_test_test/acc_unbiased': 79.323, 'best_test_test/diff': 11.035, 'best_test_test/acc_skew': 73.805, 'best_test_test/acc_align': 84.84}
[6 / 20] Learning rate: 0.001 weight: 0.01
[6 / 20] Loss: 4.490435043854386 CE Loss: 0.4449466215569313 Con Loss: 4.485985592553067
[6 / 20] tensor([[0.713, 0.588],
        [0.918, 0.927]]) {'epoch': 6, 'valid/acc': 77.722, 'valid/acc_unbiased': 78.769, 'valid/diff': 5.618, 'valid/acc_skew': 75.96, 'valid/acc_align': 81.577, 'test/acc': 77.806, 'test/acc_unbiased': 78.652, 'test/diff': 6.741, 'test/acc_skew': 75.282, 'test/acc_align': 82.023}
[6 / 20] best valid accuracy: 79.906 at epoch 3 
 best_stats: {'best_valid_epoch': 3, 'best_valid_valid/acc': 79.241, 'best_valid_valid/acc_unbiased': 79.906, 'best_valid_valid/diff': 3.645, 'best_valid_valid/acc_skew': 78.083, 'best_valid_valid/acc_align': 81.728, 'best_valid_test/acc': 78.734, 'best_valid_test/acc_unbiased': 79.137, 'best_valid_test/diff': 7.656, 'best_valid_test/acc_skew': 75.309, 'best_valid_test/acc_align': 82.965}
[6 / 20] best test accuracy: 79.323 at epoch 5 
 best_stats: {'best_test_epoch': 5, 'best_test_valid/acc': 78.354, 'best_test_valid/acc_unbiased': 78.744, 'best_test_valid/diff': 6.353, 'best_test_valid/acc_skew': 75.568, 'best_test_valid/acc_align': 81.92, 'best_test_test/acc': 79.241, 'best_test_test/acc_unbiased': 79.323, 'best_test_test/diff': 11.035, 'best_test_test/acc_skew': 73.805, 'best_test_test/acc_align': 84.84}
[7 / 20] Learning rate: 0.0001 weight: 0.01
[7 / 20] Loss: 4.390455533609907 CE Loss: 0.43211839314261086 Con Loss: 4.386134355693052
[7 / 20] tensor([[0.835, 0.724],
        [0.853, 0.902]]) {'epoch': 7, 'valid/acc': 82.911, 'valid/acc_unbiased': 83.196, 'valid/diff': 7.222, 'valid/acc_skew': 79.585, 'valid/acc_align': 86.807, 'test/acc': 82.574, 'test/acc_unbiased': 82.841, 'test/diff': 8.023, 'test/acc_skew': 78.83, 'test/acc_align': 86.853}
[7 / 20] best valid accuracy: 83.196 at epoch 7 
 best_stats: {'best_valid_epoch': 7, 'best_valid_valid/acc': 82.911, 'best_valid_valid/acc_unbiased': 83.196, 'best_valid_valid/diff': 7.222, 'best_valid_valid/acc_skew': 79.585, 'best_valid_valid/acc_align': 86.807, 'best_valid_test/acc': 82.574, 'best_valid_test/acc_unbiased': 82.841, 'best_valid_test/diff': 8.023, 'best_valid_test/acc_skew': 78.83, 'best_valid_test/acc_align': 86.853}
[7 / 20] best test accuracy: 82.841 at epoch 7 
 best_stats: {'best_test_epoch': 7, 'best_test_valid/acc': 82.911, 'best_test_valid/acc_unbiased': 83.196, 'best_test_valid/diff': 7.222, 'best_test_valid/acc_skew': 79.585, 'best_test_valid/acc_align': 86.807, 'best_test_test/acc': 82.574, 'best_test_test/acc_unbiased': 82.841, 'best_test_test/diff': 8.023, 'best_test_test/acc_skew': 78.83, 'best_test_test/acc_align': 86.853}
[8 / 20] Learning rate: 0.0001 weight: 0.01
[8 / 20] Loss: 4.36676068466544 CE Loss: 0.4048134247345596 Con Loss: 4.362712541052398
[8 / 20] tensor([[0.853, 0.742],
        [0.823, 0.897]]) {'epoch': 8, 'valid/acc': 82.827, 'valid/acc_unbiased': 82.813, 'valid/diff': 9.151, 'valid/acc_skew': 78.237, 'valid/acc_align': 87.388, 'test/acc': 82.785, 'test/acc_unbiased': 82.863, 'test/diff': 9.325, 'test/acc_skew': 78.201, 'test/acc_align': 87.526}
[8 / 20] best valid accuracy: 83.196 at epoch 7 
 best_stats: {'best_valid_epoch': 7, 'best_valid_valid/acc': 82.911, 'best_valid_valid/acc_unbiased': 83.196, 'best_valid_valid/diff': 7.222, 'best_valid_valid/acc_skew': 79.585, 'best_valid_valid/acc_align': 86.807, 'best_valid_test/acc': 82.574, 'best_valid_test/acc_unbiased': 82.841, 'best_valid_test/diff': 8.023, 'best_valid_test/acc_skew': 78.83, 'best_valid_test/acc_align': 86.853}
[8 / 20] best test accuracy: 82.863 at epoch 8 
 best_stats: {'best_test_epoch': 8, 'best_test_valid/acc': 82.827, 'best_test_valid/acc_unbiased': 82.813, 'best_test_valid/diff': 9.151, 'best_test_valid/acc_skew': 78.237, 'best_test_valid/acc_align': 87.388, 'best_test_test/acc': 82.785, 'best_test_test/acc_unbiased': 82.863, 'best_test_test/diff': 9.325, 'best_test_test/acc_skew': 78.201, 'best_test_test/acc_align': 87.526}
[9 / 20] Learning rate: 0.0001 weight: 0.01
[9 / 20] Loss: 4.315321480372639 CE Loss: 0.3976491828003181 Con Loss: 4.311344988698666
[9 / 20] tensor([[0.871, 0.764],
        [0.801, 0.886]]) {'epoch': 9, 'valid/acc': 83.165, 'valid/acc_unbiased': 83.01, 'valid/diff': 9.25, 'valid/acc_skew': 78.386, 'valid/acc_align': 87.635, 'test/acc': 83.08, 'test/acc_unbiased': 83.027, 'test/diff': 9.601, 'test/acc_skew': 78.226, 'test/acc_align': 87.828}
[9 / 20] best valid accuracy: 83.196 at epoch 7 
 best_stats: {'best_valid_epoch': 7, 'best_valid_valid/acc': 82.911, 'best_valid_valid/acc_unbiased': 83.196, 'best_valid_valid/diff': 7.222, 'best_valid_valid/acc_skew': 79.585, 'best_valid_valid/acc_align': 86.807, 'best_valid_test/acc': 82.574, 'best_valid_test/acc_unbiased': 82.841, 'best_valid_test/diff': 8.023, 'best_valid_test/acc_skew': 78.83, 'best_valid_test/acc_align': 86.853}
[9 / 20] best test accuracy: 83.027 at epoch 9 
 best_stats: {'best_test_epoch': 9, 'best_test_valid/acc': 83.165, 'best_test_valid/acc_unbiased': 83.01, 'best_test_valid/diff': 9.25, 'best_test_valid/acc_skew': 78.386, 'best_test_valid/acc_align': 87.635, 'best_test_test/acc': 83.08, 'best_test_test/acc_unbiased': 83.027, 'best_test_test/diff': 9.601, 'best_test_test/acc_skew': 78.226, 'best_test_test/acc_align': 87.828}
[10 / 20] Learning rate: 0.0001 weight: 0.01
[10 / 20] Loss: 4.311116359593404 CE Loss: 0.400419386510095 Con Loss: 4.307112143643604
[10 / 20] tensor([[0.832, 0.706],
        [0.831, 0.909]]) {'epoch': 10, 'valid/acc': 81.899, 'valid/acc_unbiased': 82.068, 'valid/diff': 10.441, 'valid/acc_skew': 76.847, 'valid/acc_align': 87.288, 'test/acc': 81.772, 'test/acc_unbiased': 81.953, 'test/diff': 10.184, 'test/acc_skew': 76.861, 'test/acc_align': 87.045}
[10 / 20] best valid accuracy: 83.196 at epoch 7 
 best_stats: {'best_valid_epoch': 7, 'best_valid_valid/acc': 82.911, 'best_valid_valid/acc_unbiased': 83.196, 'best_valid_valid/diff': 7.222, 'best_valid_valid/acc_skew': 79.585, 'best_valid_valid/acc_align': 86.807, 'best_valid_test/acc': 82.574, 'best_valid_test/acc_unbiased': 82.841, 'best_valid_test/diff': 8.023, 'best_valid_test/acc_skew': 78.83, 'best_valid_test/acc_align': 86.853}
[10 / 20] best test accuracy: 83.027 at epoch 9 
 best_stats: {'best_test_epoch': 9, 'best_test_valid/acc': 83.165, 'best_test_valid/acc_unbiased': 83.01, 'best_test_valid/diff': 9.25, 'best_test_valid/acc_skew': 78.386, 'best_test_valid/acc_align': 87.635, 'best_test_test/acc': 83.08, 'best_test_test/acc_unbiased': 83.027, 'best_test_test/diff': 9.601, 'best_test_test/acc_skew': 78.226, 'best_test_test/acc_align': 87.828}
[11 / 20] Learning rate: 0.0001 weight: 0.01
[11 / 20] Loss: 4.290468079104779 CE Loss: 0.3984442398192069 Con Loss: 4.2864836299052875
[11 / 20] tensor([[0.853, 0.743],
        [0.807, 0.889]]) {'epoch': 11, 'valid/acc': 83.249, 'valid/acc_unbiased': 83.14, 'valid/diff': 10.898, 'valid/acc_skew': 77.691, 'valid/acc_align': 88.589, 'test/acc': 82.278, 'test/acc_unbiased': 82.299, 'test/diff': 9.563, 'test/acc_skew': 77.517, 'test/acc_align': 87.08}
[11 / 20] best valid accuracy: 83.196 at epoch 7 
 best_stats: {'best_valid_epoch': 7, 'best_valid_valid/acc': 82.911, 'best_valid_valid/acc_unbiased': 83.196, 'best_valid_valid/diff': 7.222, 'best_valid_valid/acc_skew': 79.585, 'best_valid_valid/acc_align': 86.807, 'best_valid_test/acc': 82.574, 'best_valid_test/acc_unbiased': 82.841, 'best_valid_test/diff': 8.023, 'best_valid_test/acc_skew': 78.83, 'best_valid_test/acc_align': 86.853}
[11 / 20] best test accuracy: 83.027 at epoch 9 
 best_stats: {'best_test_epoch': 9, 'best_test_valid/acc': 83.165, 'best_test_valid/acc_unbiased': 83.01, 'best_test_valid/diff': 9.25, 'best_test_valid/acc_skew': 78.386, 'best_test_valid/acc_align': 87.635, 'best_test_test/acc': 83.08, 'best_test_test/acc_unbiased': 83.027, 'best_test_test/diff': 9.601, 'best_test_test/acc_skew': 78.226, 'best_test_test/acc_align': 87.828}
[12 / 20] Learning rate: 0.0001 weight: 0.01
[12 / 20] Loss: 4.27689610253665 CE Loss: 0.3902672552346834 Con Loss: 4.272993432655167
[12 / 20] tensor([[0.848, 0.722],
        [0.816, 0.896]]) {'epoch': 12, 'valid/acc': 83.249, 'valid/acc_unbiased': 83.336, 'valid/diff': 10.783, 'valid/acc_skew': 77.944, 'valid/acc_align': 88.727, 'test/acc': 81.941, 'test/acc_unbiased': 82.05, 'test/diff': 10.267, 'test/acc_skew': 76.916, 'test/acc_align': 87.183}
[12 / 20] best valid accuracy: 83.336 at epoch 12 
 best_stats: {'best_valid_epoch': 12, 'best_valid_valid/acc': 83.249, 'best_valid_valid/acc_unbiased': 83.336, 'best_valid_valid/diff': 10.783, 'best_valid_valid/acc_skew': 77.944, 'best_valid_valid/acc_align': 88.727, 'best_valid_test/acc': 81.941, 'best_valid_test/acc_unbiased': 82.05, 'best_valid_test/diff': 10.267, 'best_valid_test/acc_skew': 76.916, 'best_valid_test/acc_align': 87.183}
[12 / 20] best test accuracy: 83.027 at epoch 9 
 best_stats: {'best_test_epoch': 9, 'best_test_valid/acc': 83.165, 'best_test_valid/acc_unbiased': 83.01, 'best_test_valid/diff': 9.25, 'best_test_valid/acc_skew': 78.386, 'best_test_valid/acc_align': 87.635, 'best_test_test/acc': 83.08, 'best_test_test/acc_unbiased': 83.027, 'best_test_test/diff': 9.601, 'best_test_test/acc_skew': 78.226, 'best_test_test/acc_align': 87.828}
[13 / 20] Learning rate: 0.0001 weight: 0.01
[13 / 20] Loss: 4.284077563362624 CE Loss: 0.38231936646939024 Con Loss: 4.2802543751840885
[13 / 20] tensor([[0.894, 0.767],
        [0.766, 0.869]]) {'epoch': 13, 'valid/acc': 83.333, 'valid/acc_unbiased': 83.067, 'valid/diff': 10.162, 'valid/acc_skew': 77.986, 'valid/acc_align': 88.148, 'test/acc': 82.574, 'test/acc_unbiased': 82.409, 'test/diff': 11.533, 'test/acc_skew': 76.643, 'test/acc_align': 88.175}
[13 / 20] best valid accuracy: 83.336 at epoch 12 
 best_stats: {'best_valid_epoch': 12, 'best_valid_valid/acc': 83.249, 'best_valid_valid/acc_unbiased': 83.336, 'best_valid_valid/diff': 10.783, 'best_valid_valid/acc_skew': 77.944, 'best_valid_valid/acc_align': 88.727, 'best_valid_test/acc': 81.941, 'best_valid_test/acc_unbiased': 82.05, 'best_valid_test/diff': 10.267, 'best_valid_test/acc_skew': 76.916, 'best_valid_test/acc_align': 87.183}
[13 / 20] best test accuracy: 83.027 at epoch 9 
 best_stats: {'best_test_epoch': 9, 'best_test_valid/acc': 83.165, 'best_test_valid/acc_unbiased': 83.01, 'best_test_valid/diff': 9.25, 'best_test_valid/acc_skew': 78.386, 'best_test_valid/acc_align': 87.635, 'best_test_test/acc': 83.08, 'best_test_test/acc_unbiased': 83.027, 'best_test_test/diff': 9.601, 'best_test_test/acc_skew': 78.226, 'best_test_test/acc_align': 87.828}
[14 / 20] Learning rate: 1e-05 weight: 0.01
[14 / 20] Loss: 4.262738688623923 CE Loss: 0.3897722065448761 Con Loss: 4.258840986087067
[14 / 20] tensor([[0.871, 0.739],
        [0.805, 0.893]]) {'epoch': 14, 'valid/acc': 83.08, 'valid/acc_unbiased': 83.066, 'valid/diff': 10.753, 'valid/acc_skew': 77.69, 'valid/acc_align': 88.443, 'test/acc': 82.658, 'test/acc_unbiased': 82.693, 'test/diff': 11.012, 'test/acc_skew': 77.187, 'test/acc_align': 88.199}
[14 / 20] best valid accuracy: 83.336 at epoch 12 
 best_stats: {'best_valid_epoch': 12, 'best_valid_valid/acc': 83.249, 'best_valid_valid/acc_unbiased': 83.336, 'best_valid_valid/diff': 10.783, 'best_valid_valid/acc_skew': 77.944, 'best_valid_valid/acc_align': 88.727, 'best_valid_test/acc': 81.941, 'best_valid_test/acc_unbiased': 82.05, 'best_valid_test/diff': 10.267, 'best_valid_test/acc_skew': 76.916, 'best_valid_test/acc_align': 87.183}
[14 / 20] best test accuracy: 83.027 at epoch 9 
 best_stats: {'best_test_epoch': 9, 'best_test_valid/acc': 83.165, 'best_test_valid/acc_unbiased': 83.01, 'best_test_valid/diff': 9.25, 'best_test_valid/acc_skew': 78.386, 'best_test_valid/acc_align': 87.635, 'best_test_test/acc': 83.08, 'best_test_test/acc_unbiased': 83.027, 'best_test_test/diff': 9.601, 'best_test_test/acc_skew': 78.226, 'best_test_test/acc_align': 87.828}
[15 / 20] Learning rate: 1e-05 weight: 0.01
[15 / 20] Loss: 4.257880266728548 CE Loss: 0.37731769366808904 Con Loss: 4.2541070822217275
[15 / 20] tensor([[0.853, 0.710],
        [0.825, 0.908]]) {'epoch': 15, 'valid/acc': 82.827, 'valid/acc_unbiased': 82.949, 'valid/diff': 11.18, 'valid/acc_skew': 77.359, 'valid/acc_align': 88.539, 'test/acc': 82.236, 'test/acc_unbiased': 82.402, 'test/diff': 11.288, 'test/acc_skew': 76.758, 'test/acc_align': 88.046}
[15 / 20] best valid accuracy: 83.336 at epoch 12 
 best_stats: {'best_valid_epoch': 12, 'best_valid_valid/acc': 83.249, 'best_valid_valid/acc_unbiased': 83.336, 'best_valid_valid/diff': 10.783, 'best_valid_valid/acc_skew': 77.944, 'best_valid_valid/acc_align': 88.727, 'best_valid_test/acc': 81.941, 'best_valid_test/acc_unbiased': 82.05, 'best_valid_test/diff': 10.267, 'best_valid_test/acc_skew': 76.916, 'best_valid_test/acc_align': 87.183}
[15 / 20] best test accuracy: 83.027 at epoch 9 
 best_stats: {'best_test_epoch': 9, 'best_test_valid/acc': 83.165, 'best_test_valid/acc_unbiased': 83.01, 'best_test_valid/diff': 9.25, 'best_test_valid/acc_skew': 78.386, 'best_test_valid/acc_align': 87.635, 'best_test_test/acc': 83.08, 'best_test_test/acc_unbiased': 83.027, 'best_test_test/diff': 9.601, 'best_test_test/acc_skew': 78.226, 'best_test_test/acc_align': 87.828}
[16 / 20] Learning rate: 1e-05 weight: 0.01
[16 / 20] Loss: 4.255460996753475 CE Loss: 0.3835008736061666 Con Loss: 4.251625995859395
[16 / 20] tensor([[0.867, 0.733],
        [0.818, 0.895]]) {'epoch': 16, 'valid/acc': 83.418, 'valid/acc_unbiased': 83.458, 'valid/diff': 10.588, 'valid/acc_skew': 78.164, 'valid/acc_align': 88.752, 'test/acc': 82.7, 'test/acc_unbiased': 82.818, 'test/diff': 10.553, 'test/acc_skew': 77.541, 'test/acc_align': 88.094}
[16 / 20] best valid accuracy: 83.458 at epoch 16 
 best_stats: {'best_valid_epoch': 16, 'best_valid_valid/acc': 83.418, 'best_valid_valid/acc_unbiased': 83.458, 'best_valid_valid/diff': 10.588, 'best_valid_valid/acc_skew': 78.164, 'best_valid_valid/acc_align': 88.752, 'best_valid_test/acc': 82.7, 'best_valid_test/acc_unbiased': 82.818, 'best_valid_test/diff': 10.553, 'best_valid_test/acc_skew': 77.541, 'best_valid_test/acc_align': 88.094}
[16 / 20] best test accuracy: 83.027 at epoch 9 
 best_stats: {'best_test_epoch': 9, 'best_test_valid/acc': 83.165, 'best_test_valid/acc_unbiased': 83.01, 'best_test_valid/diff': 9.25, 'best_test_valid/acc_skew': 78.386, 'best_test_valid/acc_align': 87.635, 'best_test_test/acc': 83.08, 'best_test_test/acc_unbiased': 83.027, 'best_test_test/diff': 9.601, 'best_test_test/acc_skew': 78.226, 'best_test_test/acc_align': 87.828}
[17 / 20] Learning rate: 1e-05 weight: 0.01
[17 / 20] Loss: 4.246755624410873 CE Loss: 0.3850165617762687 Con Loss: 4.242905482715255
[17 / 20] tensor([[0.846, 0.718],
        [0.833, 0.906]]) {'epoch': 17, 'valid/acc': 83.165, 'valid/acc_unbiased': 83.32, 'valid/diff': 10.096, 'valid/acc_skew': 78.272, 'valid/acc_align': 88.367, 'test/acc': 82.405, 'test/acc_unbiased': 82.587, 'test/diff': 10.053, 'test/acc_skew': 77.56, 'test/acc_align': 87.613}
[17 / 20] best valid accuracy: 83.458 at epoch 16 
 best_stats: {'best_valid_epoch': 16, 'best_valid_valid/acc': 83.418, 'best_valid_valid/acc_unbiased': 83.458, 'best_valid_valid/diff': 10.588, 'best_valid_valid/acc_skew': 78.164, 'best_valid_valid/acc_align': 88.752, 'best_valid_test/acc': 82.7, 'best_valid_test/acc_unbiased': 82.818, 'best_valid_test/diff': 10.553, 'best_valid_test/acc_skew': 77.541, 'best_valid_test/acc_align': 88.094}
[17 / 20] best test accuracy: 83.027 at epoch 9 
 best_stats: {'best_test_epoch': 9, 'best_test_valid/acc': 83.165, 'best_test_valid/acc_unbiased': 83.01, 'best_test_valid/diff': 9.25, 'best_test_valid/acc_skew': 78.386, 'best_test_valid/acc_align': 87.635, 'best_test_test/acc': 83.08, 'best_test_test/acc_unbiased': 83.027, 'best_test_test/diff': 9.601, 'best_test_test/acc_skew': 78.226, 'best_test_test/acc_align': 87.828}
[18 / 20] Learning rate: 1e-05 weight: 0.01
[18 / 20] Loss: 4.235237757597626 CE Loss: 0.3855514775519839 Con Loss: 4.231382251309441
[18 / 20] tensor([[0.866, 0.730],
        [0.820, 0.897]]) {'epoch': 18, 'valid/acc': 83.165, 'valid/acc_unbiased': 83.17, 'valid/diff': 10.668, 'valid/acc_skew': 77.836, 'valid/acc_align': 88.503, 'test/acc': 82.7, 'test/acc_unbiased': 82.828, 'test/diff': 10.651, 'test/acc_skew': 77.502, 'test/acc_align': 88.153}
[18 / 20] best valid accuracy: 83.458 at epoch 16 
 best_stats: {'best_valid_epoch': 16, 'best_valid_valid/acc': 83.418, 'best_valid_valid/acc_unbiased': 83.458, 'best_valid_valid/diff': 10.588, 'best_valid_valid/acc_skew': 78.164, 'best_valid_valid/acc_align': 88.752, 'best_valid_test/acc': 82.7, 'best_valid_test/acc_unbiased': 82.818, 'best_valid_test/diff': 10.553, 'best_valid_test/acc_skew': 77.541, 'best_valid_test/acc_align': 88.094}
[18 / 20] best test accuracy: 83.027 at epoch 9 
 best_stats: {'best_test_epoch': 9, 'best_test_valid/acc': 83.165, 'best_test_valid/acc_unbiased': 83.01, 'best_test_valid/diff': 9.25, 'best_test_valid/acc_skew': 78.386, 'best_test_valid/acc_align': 87.635, 'best_test_test/acc': 83.08, 'best_test_test/acc_unbiased': 83.027, 'best_test_test/diff': 9.601, 'best_test_test/acc_skew': 78.226, 'best_test_test/acc_align': 87.828}
[19 / 20] Learning rate: 1e-05 weight: 0.01
[19 / 20] Loss: 4.262662430284313 CE Loss: 0.39286487936799036 Con Loss: 4.258733764748971
[19 / 20] tensor([[0.851, 0.721],
        [0.833, 0.900]]) {'epoch': 19, 'valid/acc': 83.207, 'valid/acc_unbiased': 83.32, 'valid/diff': 10.095, 'valid/acc_skew': 78.272, 'valid/acc_align': 88.367, 'test/acc': 82.447, 'test/acc_unbiased': 82.647, 'test/diff': 9.877, 'test/acc_skew': 77.708, 'test/acc_align': 87.585}
[19 / 20] best valid accuracy: 83.458 at epoch 16 
 best_stats: {'best_valid_epoch': 16, 'best_valid_valid/acc': 83.418, 'best_valid_valid/acc_unbiased': 83.458, 'best_valid_valid/diff': 10.588, 'best_valid_valid/acc_skew': 78.164, 'best_valid_valid/acc_align': 88.752, 'best_valid_test/acc': 82.7, 'best_valid_test/acc_unbiased': 82.818, 'best_valid_test/diff': 10.553, 'best_valid_test/acc_skew': 77.541, 'best_valid_test/acc_align': 88.094}
[19 / 20] best test accuracy: 83.027 at epoch 9 
 best_stats: {'best_test_epoch': 9, 'best_test_valid/acc': 83.165, 'best_test_valid/acc_unbiased': 83.01, 'best_test_valid/diff': 9.25, 'best_test_valid/acc_skew': 78.386, 'best_test_valid/acc_align': 87.635, 'best_test_test/acc': 83.08, 'best_test_test/acc_unbiased': 83.027, 'best_test_test/diff': 9.601, 'best_test_test/acc_skew': 78.226, 'best_test_test/acc_align': 87.828}
[20 / 20] Learning rate: 1e-05 weight: 0.01
[20 / 20] Loss: 4.250956308440268 CE Loss: 0.37932190626292417 Con Loss: 4.247163088394991
[20 / 20] tensor([[0.849, 0.702],
        [0.833, 0.906]]) {'epoch': 20, 'valid/acc': 82.954, 'valid/acc_unbiased': 83.172, 'valid/diff': 9.655, 'valid/acc_skew': 78.344, 'valid/acc_align': 87.999, 'test/acc': 82.025, 'test/acc_unbiased': 82.27, 'test/diff': 11.045, 'test/acc_skew': 76.748, 'test/acc_align': 87.793}
[20 / 20] best valid accuracy: 83.458 at epoch 16 
 best_stats: {'best_valid_epoch': 16, 'best_valid_valid/acc': 83.418, 'best_valid_valid/acc_unbiased': 83.458, 'best_valid_valid/diff': 10.588, 'best_valid_valid/acc_skew': 78.164, 'best_valid_valid/acc_align': 88.752, 'best_valid_test/acc': 82.7, 'best_valid_test/acc_unbiased': 82.818, 'best_valid_test/diff': 10.553, 'best_valid_test/acc_skew': 77.541, 'best_valid_test/acc_align': 88.094}
[20 / 20] best test accuracy: 83.027 at epoch 9 
 best_stats: {'best_test_epoch': 9, 'best_test_valid/acc': 83.165, 'best_test_valid/acc_unbiased': 83.01, 'best_test_valid/diff': 9.25, 'best_test_valid/acc_skew': 78.386, 'best_test_valid/acc_align': 87.635, 'best_test_test/acc': 83.08, 'best_test_test/acc_unbiased': 83.027, 'best_test_test/diff': 9.601, 'best_test_test/acc_skew': 78.226, 'best_test_test/acc_align': 87.828}
Total training time: 0:16:50
