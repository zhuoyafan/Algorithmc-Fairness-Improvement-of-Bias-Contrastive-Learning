Log level set to: INFO
Set seed: 3
=======> Using Fixed Random Seed: 3 <========
save_path: exp_results/bc-bb0-utk_face_race-us-0.7-lr0.001-bs128-cbs64-w0.01-ratio10-aug1-seed3
get_utk_face - split: train, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_race-0.7
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [4407, 1658]
Target 1: [1322, 5529]
Binary Target 1
---------------------------
Target 0: [4407, 1658]
Target 1: [1322, 5529]
===================================
Normal Label Distribution: 
Target 0: [4407, 1658]
Target 1: [1322, 5529]
===================================
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [1322, 1322]
Target 1: [1322, 1322]
Binary Target 1
---------------------------
Target 0: [1322, 1322]
Target 1: [1322, 1322]
===================================
Normal Label Distribution: 
Target 0: [1322, 1322]
Target 1: [1322, 1322]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 5288, target_attr: gender, bias_attr: race bias_rate: 0.7
['[train] target_0-bias_0: 1322', '[train] target_0-bias_1: 1322', '[train] target_1-bias_0: 1322', '[train] target_1-bias_1: 1322']
confusion_matrix - 
 original: tensor([[1322., 1322.],
        [1322., 1322.]]), 
 normalized: tensor([[0.500, 0.500],
        [0.500, 0.500]]), 
 b|y: tensor([[0.500, 0.500],
        [0.500, 0.500]])
get_utk_face - split: train, aug: 1, given_y: True, ratio: 10
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_race-0.7
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [4407, 1658]
Target 1: [1322, 5529]
Binary Target 1
---------------------------
Target 0: [4407, 1658]
Target 1: [1322, 5529]
===================================
Normal Label Distribution: 
Target 0: [4407, 1658]
Target 1: [1322, 5529]
===================================
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [1322, 1322]
Target 1: [1322, 1322]
Binary Target 1
---------------------------
Target 0: [1322, 1322]
Target 1: [1322, 1322]
===================================
Normal Label Distribution: 
Target 0: [1322, 1322]
Target 1: [1322, 1322]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 5288, target_attr: gender, bias_attr: race bias_rate: 0.7
['[train] target_0-bias_0: 1322', '[train] target_0-bias_1: 1322', '[train] target_1-bias_0: 1322', '[train] target_1-bias_1: 1322']
get_utk_face - split: valid, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_race-0.7
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [583, 684]
Target 1: [457, 646]
Binary Target 1
---------------------------
Target 0: [583, 684]
Target 1: [457, 646]
===================================
Normal Label Distribution: 
Target 0: [583, 684]
Target 1: [457, 646]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 2370, target_attr: gender, bias_attr: race bias_rate: 0.7
['[valid] target_0-bias_0: 583', '[valid] target_0-bias_1: 684', '[valid] target_1-bias_0: 457', '[valid] target_1-bias_1: 646']
get_utk_face - split: test, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_race-0.7
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [558, 677]
Target 1: [462, 673]
Binary Target 1
---------------------------
Target 0: [558, 677]
Target 1: [462, 673]
===================================
Normal Label Distribution: 
Target 0: [558, 677]
Target 1: [462, 673]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 2370, target_attr: gender, bias_attr: race bias_rate: 0.7
['[test] target_0-bias_0: 558', '[test] target_0-bias_1: 677', '[test] target_1-bias_0: 462', '[test] target_1-bias_1: 673']
decay_epochs: [6, 13]
[1 / 20] Learning rate: 0.001 weight: 0.01
[1 / 20] Loss: 4.973428581197395 CE Loss: 0.6392553042896577 Con Loss: 4.967036019294958
[1 / 20] tensor([[0.857, 0.820],
        [0.723, 0.718]]) {'epoch': 1, 'valid/acc': 77.426, 'valid/acc_unbiased': 76.824, 'valid/diff': 3.284, 'valid/acc_skew': 77.071, 'valid/acc_align': 76.578, 'test/acc': 78.059, 'test/acc_unbiased': 77.926, 'test/diff': 2.105, 'test/acc_skew': 78.979, 'test/acc_align': 76.874}
[1 / 20] best valid accuracy: 76.824 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 77.426, 'best_valid_valid/acc_unbiased': 76.824, 'best_valid_valid/diff': 3.284, 'best_valid_valid/acc_skew': 77.071, 'best_valid_valid/acc_align': 76.578, 'best_valid_test/acc': 78.059, 'best_valid_test/acc_unbiased': 77.926, 'best_valid_test/diff': 2.105, 'best_valid_test/acc_skew': 78.979, 'best_valid_test/acc_align': 76.874}
[1 / 20] best test accuracy: 77.926 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 77.426, 'best_test_valid/acc_unbiased': 76.824, 'best_test_valid/diff': 3.284, 'best_test_valid/acc_skew': 77.071, 'best_test_valid/acc_align': 76.578, 'best_test_test/acc': 78.059, 'best_test_test/acc_unbiased': 77.926, 'best_test_test/diff': 2.105, 'best_test_test/acc_skew': 78.979, 'best_test_test/acc_align': 76.874}
[2 / 20] Learning rate: 0.001 weight: 0.01
[2 / 20] Loss: 4.795159945870312 CE Loss: 0.4958944925742503 Con Loss: 4.790201016886332
[2 / 20] tensor([[0.930, 0.911],
        [0.595, 0.593]]) {'epoch': 2, 'valid/acc': 76.878, 'valid/acc_unbiased': 75.743, 'valid/diff': 1.668, 'valid/acc_skew': 76.577, 'valid/acc_align': 74.91, 'test/acc': 76.371, 'test/acc_unbiased': 75.74, 'test/diff': 1.055, 'test/acc_skew': 76.267, 'test/acc_align': 75.212}
[2 / 20] best valid accuracy: 76.824 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 77.426, 'best_valid_valid/acc_unbiased': 76.824, 'best_valid_valid/diff': 3.284, 'best_valid_valid/acc_skew': 77.071, 'best_valid_valid/acc_align': 76.578, 'best_valid_test/acc': 78.059, 'best_valid_test/acc_unbiased': 77.926, 'best_valid_test/diff': 2.105, 'best_valid_test/acc_skew': 78.979, 'best_valid_test/acc_align': 76.874}
[2 / 20] best test accuracy: 77.926 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 77.426, 'best_test_valid/acc_unbiased': 76.824, 'best_test_valid/diff': 3.284, 'best_test_valid/acc_skew': 77.071, 'best_test_valid/acc_align': 76.578, 'best_test_test/acc': 78.059, 'best_test_test/acc_unbiased': 77.926, 'best_test_test/diff': 2.105, 'best_test_test/acc_skew': 78.979, 'best_test_test/acc_align': 76.874}
[3 / 20] Learning rate: 0.001 weight: 0.01
[3 / 20] Loss: 4.7936877078981155 CE Loss: 0.4798519943196907 Con Loss: 4.788889183038663
[3 / 20] tensor([[0.950, 0.938],
        [0.591, 0.557]]) {'epoch': 3, 'valid/acc': 76.878, 'valid/acc_unbiased': 75.813, 'valid/diff': 3.14, 'valid/acc_skew': 77.086, 'valid/acc_align': 74.54, 'test/acc': 76.498, 'test/acc_unbiased': 75.897, 'test/diff': 2.278, 'test/acc_skew': 77.036, 'test/acc_align': 74.758}
[3 / 20] best valid accuracy: 76.824 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 77.426, 'best_valid_valid/acc_unbiased': 76.824, 'best_valid_valid/diff': 3.284, 'best_valid_valid/acc_skew': 77.071, 'best_valid_valid/acc_align': 76.578, 'best_valid_test/acc': 78.059, 'best_valid_test/acc_unbiased': 77.926, 'best_valid_test/diff': 2.105, 'best_valid_test/acc_skew': 78.979, 'best_valid_test/acc_align': 76.874}
[3 / 20] best test accuracy: 77.926 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 77.426, 'best_test_valid/acc_unbiased': 76.824, 'best_test_valid/diff': 3.284, 'best_test_valid/acc_skew': 77.071, 'best_test_valid/acc_align': 76.578, 'best_test_test/acc': 78.059, 'best_test_test/acc_unbiased': 77.926, 'best_test_test/diff': 2.105, 'best_test_test/acc_skew': 78.979, 'best_test_test/acc_align': 76.874}
[4 / 20] Learning rate: 0.001 weight: 0.01
[4 / 20] Loss: 4.751387484315304 CE Loss: 0.4394058445398097 Con Loss: 4.746993445772987
[4 / 20] tensor([[0.642, 0.671],
        [0.948, 0.920]]) {'epoch': 4, 'valid/acc': 77.679, 'valid/acc_unbiased': 78.661, 'valid/diff': 6.797, 'valid/acc_skew': 77.377, 'valid/acc_align': 79.945, 'test/acc': 78.861, 'test/acc_unbiased': 79.5, 'test/diff': 2.866, 'test/acc_skew': 79.481, 'test/acc_align': 79.518}
[4 / 20] best valid accuracy: 78.661 at epoch 4 
 best_stats: {'best_valid_epoch': 4, 'best_valid_valid/acc': 77.679, 'best_valid_valid/acc_unbiased': 78.661, 'best_valid_valid/diff': 6.797, 'best_valid_valid/acc_skew': 77.377, 'best_valid_valid/acc_align': 79.945, 'best_valid_test/acc': 78.861, 'best_valid_test/acc_unbiased': 79.5, 'best_valid_test/diff': 2.866, 'best_valid_test/acc_skew': 79.481, 'best_valid_test/acc_align': 79.518}
[4 / 20] best test accuracy: 79.500 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 77.679, 'best_test_valid/acc_unbiased': 78.661, 'best_test_valid/diff': 6.797, 'best_test_valid/acc_skew': 77.377, 'best_test_valid/acc_align': 79.945, 'best_test_test/acc': 78.861, 'best_test_test/acc_unbiased': 79.5, 'best_test_test/diff': 2.866, 'best_test_test/acc_skew': 79.481, 'best_test_test/acc_align': 79.518}
[5 / 20] Learning rate: 0.001 weight: 0.01
[5 / 20] Loss: 4.762072333770152 CE Loss: 0.4483243157571455 Con Loss: 4.757589074017962
[5 / 20] tensor([[0.878, 0.818],
        [0.786, 0.844]]) {'epoch': 5, 'valid/acc': 83.587, 'valid/acc_unbiased': 83.48, 'valid/diff': 1.653, 'valid/acc_skew': 84.306, 'valid/acc_align': 82.654, 'test/acc': 83.333, 'test/acc_unbiased': 83.154, 'test/diff': 5.904, 'test/acc_skew': 83.193, 'test/acc_align': 83.115}
[5 / 20] best valid accuracy: 83.480 at epoch 5 
 best_stats: {'best_valid_epoch': 5, 'best_valid_valid/acc': 83.587, 'best_valid_valid/acc_unbiased': 83.48, 'best_valid_valid/diff': 1.653, 'best_valid_valid/acc_skew': 84.306, 'best_valid_valid/acc_align': 82.654, 'best_valid_test/acc': 83.333, 'best_valid_test/acc_unbiased': 83.154, 'best_valid_test/diff': 5.904, 'best_valid_test/acc_skew': 83.193, 'best_valid_test/acc_align': 83.115}
[5 / 20] best test accuracy: 83.154 at epoch 5 
 best_stats: {'best_test_epoch': 5, 'best_test_valid/acc': 83.587, 'best_test_valid/acc_unbiased': 83.48, 'best_test_valid/diff': 1.653, 'best_test_valid/acc_skew': 84.306, 'best_test_valid/acc_align': 82.654, 'best_test_test/acc': 83.333, 'best_test_test/acc_unbiased': 83.154, 'best_test_test/diff': 5.904, 'best_test_test/acc_skew': 83.193, 'best_test_test/acc_align': 83.115}
[6 / 20] Learning rate: 0.001 weight: 0.01
[6 / 20] Loss: 4.7342918406095515 CE Loss: 0.4177046424502143 Con Loss: 4.730114819963833
[6 / 20] tensor([[0.566, 0.567],
        [0.961, 0.975]]) {'epoch': 6, 'valid/acc': 75.063, 'valid/acc_unbiased': 76.458, 'valid/diff': 1.914, 'valid/acc_skew': 76.046, 'valid/acc_align': 76.87, 'test/acc': 75.949, 'test/acc_unbiased': 76.732, 'test/diff': 0.73, 'test/acc_skew': 76.367, 'test/acc_align': 77.097}
[6 / 20] best valid accuracy: 83.480 at epoch 5 
 best_stats: {'best_valid_epoch': 5, 'best_valid_valid/acc': 83.587, 'best_valid_valid/acc_unbiased': 83.48, 'best_valid_valid/diff': 1.653, 'best_valid_valid/acc_skew': 84.306, 'best_valid_valid/acc_align': 82.654, 'best_valid_test/acc': 83.333, 'best_valid_test/acc_unbiased': 83.154, 'best_valid_test/diff': 5.904, 'best_valid_test/acc_skew': 83.193, 'best_valid_test/acc_align': 83.115}
[6 / 20] best test accuracy: 83.154 at epoch 5 
 best_stats: {'best_test_epoch': 5, 'best_test_valid/acc': 83.587, 'best_test_valid/acc_unbiased': 83.48, 'best_test_valid/diff': 1.653, 'best_test_valid/acc_skew': 84.306, 'best_test_valid/acc_align': 82.654, 'best_test_test/acc': 83.333, 'best_test_test/acc_unbiased': 83.154, 'best_test_test/diff': 5.904, 'best_test_test/acc_skew': 83.193, 'best_test_test/acc_align': 83.115}
[7 / 20] Learning rate: 0.0001 weight: 0.01
[7 / 20] Loss: 4.713352512123004 CE Loss: 0.3973118777354438 Con Loss: 4.709379375792487
[7 / 20] tensor([[0.842, 0.796],
        [0.864, 0.903]]) {'epoch': 7, 'valid/acc': 84.937, 'valid/acc_unbiased': 85.302, 'valid/diff': 1.71, 'valid/acc_skew': 86.157, 'valid/acc_align': 84.447, 'test/acc': 85.063, 'test/acc_unbiased': 85.138, 'test/diff': 4.296, 'test/acc_skew': 85.297, 'test/acc_align': 84.979}
[7 / 20] best valid accuracy: 85.302 at epoch 7 
 best_stats: {'best_valid_epoch': 7, 'best_valid_valid/acc': 84.937, 'best_valid_valid/acc_unbiased': 85.302, 'best_valid_valid/diff': 1.71, 'best_valid_valid/acc_skew': 86.157, 'best_valid_valid/acc_align': 84.447, 'best_valid_test/acc': 85.063, 'best_valid_test/acc_unbiased': 85.138, 'best_valid_test/diff': 4.296, 'best_valid_test/acc_skew': 85.297, 'best_valid_test/acc_align': 84.979}
[7 / 20] best test accuracy: 85.138 at epoch 7 
 best_stats: {'best_test_epoch': 7, 'best_test_valid/acc': 84.937, 'best_test_valid/acc_unbiased': 85.302, 'best_test_valid/diff': 1.71, 'best_test_valid/acc_skew': 86.157, 'best_test_valid/acc_align': 84.447, 'best_test_test/acc': 85.063, 'best_test_test/acc_unbiased': 85.138, 'best_test_test/diff': 4.296, 'best_test_test/acc_skew': 85.297, 'best_test_test/acc_align': 84.979}
[8 / 20] Learning rate: 0.0001 weight: 0.01
[8 / 20] Loss: 4.686901031932744 CE Loss: 0.3763952507734659 Con Loss: 4.683137078508848
[8 / 20] tensor([[0.817, 0.783],
        [0.874, 0.909]]) {'epoch': 8, 'valid/acc': 84.641, 'valid/acc_unbiased': 85.091, 'valid/diff': 2.647, 'valid/acc_skew': 86.414, 'valid/acc_align': 83.768, 'test/acc': 84.473, 'test/acc_unbiased': 84.597, 'test/diff': 3.462, 'test/acc_skew': 84.583, 'test/acc_align': 84.611}
[8 / 20] best valid accuracy: 85.302 at epoch 7 
 best_stats: {'best_valid_epoch': 7, 'best_valid_valid/acc': 84.937, 'best_valid_valid/acc_unbiased': 85.302, 'best_valid_valid/diff': 1.71, 'best_valid_valid/acc_skew': 86.157, 'best_valid_valid/acc_align': 84.447, 'best_valid_test/acc': 85.063, 'best_valid_test/acc_unbiased': 85.138, 'best_valid_test/diff': 4.296, 'best_valid_test/acc_skew': 85.297, 'best_valid_test/acc_align': 84.979}
[8 / 20] best test accuracy: 85.138 at epoch 7 
 best_stats: {'best_test_epoch': 7, 'best_test_valid/acc': 84.937, 'best_test_valid/acc_unbiased': 85.302, 'best_test_valid/diff': 1.71, 'best_test_valid/acc_skew': 86.157, 'best_test_valid/acc_align': 84.447, 'best_test_test/acc': 85.063, 'best_test_test/acc_unbiased': 85.138, 'best_test_test/diff': 4.296, 'best_test_test/acc_skew': 85.297, 'best_test_test/acc_align': 84.979}
[9 / 20] Learning rate: 0.0001 weight: 0.01
[9 / 20] Loss: 4.674802424507314 CE Loss: 0.3669331593160009 Con Loss: 4.67113306951595
[9 / 20] tensor([[0.885, 0.842],
        [0.846, 0.859]]) {'epoch': 9, 'valid/acc': 86.203, 'valid/acc_unbiased': 86.256, 'valid/diff': 1.228, 'valid/acc_skew': 86.87, 'valid/acc_align': 85.642, 'test/acc': 85.781, 'test/acc_unbiased': 85.81, 'test/diff': 2.794, 'test/acc_skew': 86.581, 'test/acc_align': 85.04}
[9 / 20] best valid accuracy: 86.256 at epoch 9 
 best_stats: {'best_valid_epoch': 9, 'best_valid_valid/acc': 86.203, 'best_valid_valid/acc_unbiased': 86.256, 'best_valid_valid/diff': 1.228, 'best_valid_valid/acc_skew': 86.87, 'best_valid_valid/acc_align': 85.642, 'best_valid_test/acc': 85.781, 'best_valid_test/acc_unbiased': 85.81, 'best_valid_test/diff': 2.794, 'best_valid_test/acc_skew': 86.581, 'best_valid_test/acc_align': 85.04}
[9 / 20] best test accuracy: 85.810 at epoch 9 
 best_stats: {'best_test_epoch': 9, 'best_test_valid/acc': 86.203, 'best_test_valid/acc_unbiased': 86.256, 'best_test_valid/diff': 1.228, 'best_test_valid/acc_skew': 86.87, 'best_test_valid/acc_align': 85.642, 'best_test_test/acc': 85.781, 'best_test_test/acc_unbiased': 85.81, 'best_test_test/diff': 2.794, 'best_test_test/acc_skew': 86.581, 'best_test_test/acc_align': 85.04}
[10 / 20] Learning rate: 0.0001 weight: 0.01
[10 / 20] Loss: 4.655312918318201 CE Loss: 0.368830485666754 Con Loss: 4.651624613197777
[10 / 20] tensor([[0.905, 0.871],
        [0.812, 0.842]]) {'epoch': 10, 'valid/acc': 86.456, 'valid/acc_unbiased': 86.433, 'valid/diff': 3.241, 'valid/acc_skew': 88.053, 'valid/acc_align': 84.813, 'test/acc': 85.949, 'test/acc_unbiased': 85.767, 'test/diff': 3.217, 'test/acc_skew': 85.835, 'test/acc_align': 85.699}
[10 / 20] best valid accuracy: 86.433 at epoch 10 
 best_stats: {'best_valid_epoch': 10, 'best_valid_valid/acc': 86.456, 'best_valid_valid/acc_unbiased': 86.433, 'best_valid_valid/diff': 3.241, 'best_valid_valid/acc_skew': 88.053, 'best_valid_valid/acc_align': 84.813, 'best_valid_test/acc': 85.949, 'best_valid_test/acc_unbiased': 85.767, 'best_valid_test/diff': 3.217, 'best_valid_test/acc_skew': 85.835, 'best_valid_test/acc_align': 85.699}
[10 / 20] best test accuracy: 85.810 at epoch 9 
 best_stats: {'best_test_epoch': 9, 'best_test_valid/acc': 86.203, 'best_test_valid/acc_unbiased': 86.256, 'best_test_valid/diff': 1.228, 'best_test_valid/acc_skew': 86.87, 'best_test_valid/acc_align': 85.642, 'best_test_test/acc': 85.781, 'best_test_test/acc_unbiased': 85.81, 'best_test_test/diff': 2.794, 'best_test_test/acc_skew': 86.581, 'best_test_test/acc_align': 85.04}
[11 / 20] Learning rate: 0.0001 weight: 0.01
[11 / 20] Loss: 4.635311783893026 CE Loss: 0.35600210219035533 Con Loss: 4.631751754460645
[11 / 20] tensor([[0.869, 0.848],
        [0.853, 0.877]]) {'epoch': 11, 'valid/acc': 86.667, 'valid/acc_unbiased': 86.837, 'valid/diff': 2.208, 'valid/acc_skew': 87.941, 'valid/acc_align': 85.733, 'test/acc': 86.203, 'test/acc_unbiased': 86.163, 'test/diff': 2.259, 'test/acc_skew': 86.099, 'test/acc_align': 86.226}
[11 / 20] best valid accuracy: 86.837 at epoch 11 
 best_stats: {'best_valid_epoch': 11, 'best_valid_valid/acc': 86.667, 'best_valid_valid/acc_unbiased': 86.837, 'best_valid_valid/diff': 2.208, 'best_valid_valid/acc_skew': 87.941, 'best_valid_valid/acc_align': 85.733, 'best_valid_test/acc': 86.203, 'best_valid_test/acc_unbiased': 86.163, 'best_valid_test/diff': 2.259, 'best_valid_test/acc_skew': 86.099, 'best_valid_test/acc_align': 86.226}
[11 / 20] best test accuracy: 86.163 at epoch 11 
 best_stats: {'best_test_epoch': 11, 'best_test_valid/acc': 86.667, 'best_test_valid/acc_unbiased': 86.837, 'best_test_valid/diff': 2.208, 'best_test_valid/acc_skew': 87.941, 'best_test_valid/acc_align': 85.733, 'best_test_test/acc': 86.203, 'best_test_test/acc_unbiased': 86.163, 'best_test_test/diff': 2.259, 'best_test_test/acc_skew': 86.099, 'best_test_test/acc_align': 86.226}
[12 / 20] Learning rate: 0.0001 weight: 0.01
[12 / 20] Loss: 4.658273813764194 CE Loss: 0.3487108607696152 Con Loss: 4.6547867014620925
[12 / 20] tensor([[0.841, 0.818],
        [0.870, 0.893]]) {'epoch': 12, 'valid/acc': 86.329, 'valid/acc_unbiased': 86.687, 'valid/diff': 3.027, 'valid/acc_skew': 88.201, 'valid/acc_align': 85.174, 'test/acc': 85.485, 'test/acc_unbiased': 85.549, 'test/diff': 2.254, 'test/acc_skew': 85.532, 'test/acc_align': 85.567}
[12 / 20] best valid accuracy: 86.837 at epoch 11 
 best_stats: {'best_valid_epoch': 11, 'best_valid_valid/acc': 86.667, 'best_valid_valid/acc_unbiased': 86.837, 'best_valid_valid/diff': 2.208, 'best_valid_valid/acc_skew': 87.941, 'best_valid_valid/acc_align': 85.733, 'best_valid_test/acc': 86.203, 'best_valid_test/acc_unbiased': 86.163, 'best_valid_test/diff': 2.259, 'best_valid_test/acc_skew': 86.099, 'best_valid_test/acc_align': 86.226}
[12 / 20] best test accuracy: 86.163 at epoch 11 
 best_stats: {'best_test_epoch': 11, 'best_test_valid/acc': 86.667, 'best_test_valid/acc_unbiased': 86.837, 'best_test_valid/diff': 2.208, 'best_test_valid/acc_skew': 87.941, 'best_test_valid/acc_align': 85.733, 'best_test_test/acc': 86.203, 'best_test_test/acc_unbiased': 86.163, 'best_test_test/diff': 2.259, 'best_test_test/acc_skew': 86.099, 'best_test_test/acc_align': 86.226}
[13 / 20] Learning rate: 0.0001 weight: 0.01
[13 / 20] Loss: 4.654772309059455 CE Loss: 0.33863851883407803 Con Loss: 4.651385934919164
[13 / 20] tensor([[0.882, 0.857],
        [0.851, 0.865]]) {'epoch': 13, 'valid/acc': 86.414, 'valid/acc_unbiased': 86.596, 'valid/diff': 3.327, 'valid/acc_skew': 88.26, 'valid/acc_align': 84.933, 'test/acc': 86.371, 'test/acc_unbiased': 86.347, 'test/diff': 1.957, 'test/acc_skew': 86.618, 'test/acc_align': 86.075}
[13 / 20] best valid accuracy: 86.837 at epoch 11 
 best_stats: {'best_valid_epoch': 11, 'best_valid_valid/acc': 86.667, 'best_valid_valid/acc_unbiased': 86.837, 'best_valid_valid/diff': 2.208, 'best_valid_valid/acc_skew': 87.941, 'best_valid_valid/acc_align': 85.733, 'best_valid_test/acc': 86.203, 'best_valid_test/acc_unbiased': 86.163, 'best_valid_test/diff': 2.259, 'best_valid_test/acc_skew': 86.099, 'best_valid_test/acc_align': 86.226}
[13 / 20] best test accuracy: 86.347 at epoch 13 
 best_stats: {'best_test_epoch': 13, 'best_test_valid/acc': 86.414, 'best_test_valid/acc_unbiased': 86.596, 'best_test_valid/diff': 3.327, 'best_test_valid/acc_skew': 88.26, 'best_test_valid/acc_align': 84.933, 'best_test_test/acc': 86.371, 'best_test_test/acc_unbiased': 86.347, 'best_test_test/diff': 1.957, 'best_test_test/acc_skew': 86.618, 'best_test_test/acc_align': 86.075}
[14 / 20] Learning rate: 1e-05 weight: 0.01
[14 / 20] Loss: 4.630256517211175 CE Loss: 0.3351575397236805 Con Loss: 4.626904942805395
[14 / 20] tensor([[0.892, 0.861],
        [0.842, 0.854]]) {'epoch': 14, 'valid/acc': 86.962, 'valid/acc_unbiased': 87.11, 'valid/diff': 3.796, 'valid/acc_skew': 89.008, 'valid/acc_align': 85.212, 'test/acc': 86.287, 'test/acc_unbiased': 86.25, 'test/diff': 2.186, 'test/acc_skew': 86.723, 'test/acc_align': 85.777}
[14 / 20] best valid accuracy: 87.110 at epoch 14 
 best_stats: {'best_valid_epoch': 14, 'best_valid_valid/acc': 86.962, 'best_valid_valid/acc_unbiased': 87.11, 'best_valid_valid/diff': 3.796, 'best_valid_valid/acc_skew': 89.008, 'best_valid_valid/acc_align': 85.212, 'best_valid_test/acc': 86.287, 'best_valid_test/acc_unbiased': 86.25, 'best_valid_test/diff': 2.186, 'best_valid_test/acc_skew': 86.723, 'best_valid_test/acc_align': 85.777}
[14 / 20] best test accuracy: 86.347 at epoch 13 
 best_stats: {'best_test_epoch': 13, 'best_test_valid/acc': 86.414, 'best_test_valid/acc_unbiased': 86.596, 'best_test_valid/diff': 3.327, 'best_test_valid/acc_skew': 88.26, 'best_test_valid/acc_align': 84.933, 'best_test_test/acc': 86.371, 'best_test_test/acc_unbiased': 86.347, 'best_test_test/diff': 1.957, 'best_test_test/acc_skew': 86.618, 'best_test_test/acc_align': 86.075}
[15 / 20] Learning rate: 1e-05 weight: 0.01
[15 / 20] Loss: 4.642206158111388 CE Loss: 0.3348301058908454 Con Loss: 4.63885785591945
[15 / 20] tensor([[0.885, 0.860],
        [0.846, 0.872]]) {'epoch': 15, 'valid/acc': 86.498, 'valid/acc_unbiased': 86.674, 'valid/diff': 3.172, 'valid/acc_skew': 88.26, 'valid/acc_align': 85.088, 'test/acc': 86.667, 'test/acc_unbiased': 86.588, 'test/diff': 2.576, 'test/acc_skew': 86.581, 'test/acc_align': 86.594}
[15 / 20] best valid accuracy: 87.110 at epoch 14 
 best_stats: {'best_valid_epoch': 14, 'best_valid_valid/acc': 86.962, 'best_valid_valid/acc_unbiased': 87.11, 'best_valid_valid/diff': 3.796, 'best_valid_valid/acc_skew': 89.008, 'best_valid_valid/acc_align': 85.212, 'best_valid_test/acc': 86.287, 'best_valid_test/acc_unbiased': 86.25, 'best_valid_test/diff': 2.186, 'best_valid_test/acc_skew': 86.723, 'best_valid_test/acc_align': 85.777}
[15 / 20] best test accuracy: 86.588 at epoch 15 
 best_stats: {'best_test_epoch': 15, 'best_test_valid/acc': 86.498, 'best_test_valid/acc_unbiased': 86.674, 'best_test_valid/diff': 3.172, 'best_test_valid/acc_skew': 88.26, 'best_test_valid/acc_align': 85.088, 'best_test_test/acc': 86.667, 'best_test_test/acc_unbiased': 86.588, 'best_test_test/diff': 2.576, 'best_test_test/acc_skew': 86.581, 'best_test_test/acc_align': 86.594}
[16 / 20] Learning rate: 1e-05 weight: 0.01
[16 / 20] Loss: 4.616983827772732 CE Loss: 0.34717362442824556 Con Loss: 4.613512083189209
[16 / 20] tensor([[0.864, 0.836],
        [0.846, 0.893]]) {'epoch': 16, 'valid/acc': 87.257, 'valid/acc_unbiased': 87.437, 'valid/diff': 1.586, 'valid/acc_skew': 88.23, 'valid/acc_align': 86.644, 'test/acc': 86.076, 'test/acc_unbiased': 85.979, 'test/diff': 3.723, 'test/acc_skew': 85.506, 'test/acc_align': 86.453}
[16 / 20] best valid accuracy: 87.437 at epoch 16 
 best_stats: {'best_valid_epoch': 16, 'best_valid_valid/acc': 87.257, 'best_valid_valid/acc_unbiased': 87.437, 'best_valid_valid/diff': 1.586, 'best_valid_valid/acc_skew': 88.23, 'best_valid_valid/acc_align': 86.644, 'best_valid_test/acc': 86.076, 'best_valid_test/acc_unbiased': 85.979, 'best_valid_test/diff': 3.723, 'best_valid_test/acc_skew': 85.506, 'best_valid_test/acc_align': 86.453}
[16 / 20] best test accuracy: 86.588 at epoch 15 
 best_stats: {'best_test_epoch': 15, 'best_test_valid/acc': 86.498, 'best_test_valid/acc_unbiased': 86.674, 'best_test_valid/diff': 3.172, 'best_test_valid/acc_skew': 88.26, 'best_test_valid/acc_align': 85.088, 'best_test_test/acc': 86.667, 'best_test_test/acc_unbiased': 86.588, 'best_test_test/diff': 2.576, 'best_test_test/acc_skew': 86.581, 'best_test_test/acc_align': 86.594}
[17 / 20] Learning rate: 1e-05 weight: 0.01
[17 / 20] Loss: 4.636587317520118 CE Loss: 0.32859197723342504 Con Loss: 4.633301421842128
[17 / 20] tensor([[0.864, 0.832],
        [0.848, 0.890]]) {'epoch': 17, 'valid/acc': 87.257, 'valid/acc_unbiased': 87.441, 'valid/diff': 1.283, 'valid/acc_skew': 88.082, 'valid/acc_align': 86.799, 'test/acc': 85.907, 'test/acc_unbiased': 85.848, 'test/diff': 3.687, 'test/acc_skew': 85.614, 'test/acc_align': 86.083}
[17 / 20] best valid accuracy: 87.441 at epoch 17 
 best_stats: {'best_valid_epoch': 17, 'best_valid_valid/acc': 87.257, 'best_valid_valid/acc_unbiased': 87.441, 'best_valid_valid/diff': 1.283, 'best_valid_valid/acc_skew': 88.082, 'best_valid_valid/acc_align': 86.799, 'best_valid_test/acc': 85.907, 'best_valid_test/acc_unbiased': 85.848, 'best_valid_test/diff': 3.687, 'best_valid_test/acc_skew': 85.614, 'best_valid_test/acc_align': 86.083}
[17 / 20] best test accuracy: 86.588 at epoch 15 
 best_stats: {'best_test_epoch': 15, 'best_test_valid/acc': 86.498, 'best_test_valid/acc_unbiased': 86.674, 'best_test_valid/diff': 3.172, 'best_test_valid/acc_skew': 88.26, 'best_test_valid/acc_align': 85.088, 'best_test_test/acc': 86.667, 'best_test_test/acc_unbiased': 86.588, 'best_test_test/diff': 2.576, 'best_test_test/acc_skew': 86.581, 'best_test_test/acc_align': 86.594}
[18 / 20] Learning rate: 1e-05 weight: 0.01
[18 / 20] Loss: 4.635062910244432 CE Loss: 0.3362922550329823 Con Loss: 4.6316999689353215
[18 / 20] tensor([[0.867, 0.845],
        [0.848, 0.887]]) {'epoch': 18, 'valid/acc': 87.089, 'valid/acc_unbiased': 87.225, 'valid/diff': 1.479, 'valid/acc_skew': 87.964, 'valid/acc_align': 86.485, 'test/acc': 86.287, 'test/acc_unbiased': 86.196, 'test/diff': 3.053, 'test/acc_skew': 85.793, 'test/acc_align': 86.599}
[18 / 20] best valid accuracy: 87.441 at epoch 17 
 best_stats: {'best_valid_epoch': 17, 'best_valid_valid/acc': 87.257, 'best_valid_valid/acc_unbiased': 87.441, 'best_valid_valid/diff': 1.283, 'best_valid_valid/acc_skew': 88.082, 'best_valid_valid/acc_align': 86.799, 'best_valid_test/acc': 85.907, 'best_valid_test/acc_unbiased': 85.848, 'best_valid_test/diff': 3.687, 'best_valid_test/acc_skew': 85.614, 'best_valid_test/acc_align': 86.083}
[18 / 20] best test accuracy: 86.588 at epoch 15 
 best_stats: {'best_test_epoch': 15, 'best_test_valid/acc': 86.498, 'best_test_valid/acc_unbiased': 86.674, 'best_test_valid/diff': 3.172, 'best_test_valid/acc_skew': 88.26, 'best_test_valid/acc_align': 85.088, 'best_test_test/acc': 86.667, 'best_test_test/acc_unbiased': 86.588, 'best_test_test/diff': 2.576, 'best_test_test/acc_skew': 86.581, 'best_test_test/acc_align': 86.594}
[19 / 20] Learning rate: 1e-05 weight: 0.01
[19 / 20] Loss: 4.640455874300219 CE Loss: 0.32636760387135705 Con Loss: 4.637192211064557
[19 / 20] tensor([[0.871, 0.849],
        [0.851, 0.886]]) {'epoch': 19, 'valid/acc': 87.173, 'valid/acc_unbiased': 87.347, 'valid/diff': 2.359, 'valid/acc_skew': 88.526, 'valid/acc_align': 86.167, 'test/acc': 86.498, 'test/acc_unbiased': 86.413, 'test/diff': 2.828, 'test/acc_skew': 86.081, 'test/acc_align': 86.746}
[19 / 20] best valid accuracy: 87.441 at epoch 17 
 best_stats: {'best_valid_epoch': 17, 'best_valid_valid/acc': 87.257, 'best_valid_valid/acc_unbiased': 87.441, 'best_valid_valid/diff': 1.283, 'best_valid_valid/acc_skew': 88.082, 'best_valid_valid/acc_align': 86.799, 'best_valid_test/acc': 85.907, 'best_valid_test/acc_unbiased': 85.848, 'best_valid_test/diff': 3.687, 'best_valid_test/acc_skew': 85.614, 'best_valid_test/acc_align': 86.083}
[19 / 20] best test accuracy: 86.588 at epoch 15 
 best_stats: {'best_test_epoch': 15, 'best_test_valid/acc': 86.498, 'best_test_valid/acc_unbiased': 86.674, 'best_test_valid/diff': 3.172, 'best_test_valid/acc_skew': 88.26, 'best_test_valid/acc_align': 85.088, 'best_test_test/acc': 86.667, 'best_test_test/acc_unbiased': 86.588, 'best_test_test/diff': 2.576, 'best_test_test/acc_skew': 86.581, 'best_test_test/acc_align': 86.594}
[20 / 20] Learning rate: 1e-05 weight: 0.01
[20 / 20] Loss: 4.615727540764975 CE Loss: 0.33562358578106277 Con Loss: 4.612371273011916
[20 / 20] tensor([[0.866, 0.832],
        [0.851, 0.889]]) {'epoch': 20, 'valid/acc': 87.342, 'valid/acc_unbiased': 87.539, 'valid/diff': 1.944, 'valid/acc_skew': 88.511, 'valid/acc_align': 86.567, 'test/acc': 85.949, 'test/acc_unbiased': 85.91, 'test/diff': 3.595, 'test/acc_skew': 85.812, 'test/acc_align': 86.008}
[20 / 20] best valid accuracy: 87.539 at epoch 20 
 best_stats: {'best_valid_epoch': 20, 'best_valid_valid/acc': 87.342, 'best_valid_valid/acc_unbiased': 87.539, 'best_valid_valid/diff': 1.944, 'best_valid_valid/acc_skew': 88.511, 'best_valid_valid/acc_align': 86.567, 'best_valid_test/acc': 85.949, 'best_valid_test/acc_unbiased': 85.91, 'best_valid_test/diff': 3.595, 'best_valid_test/acc_skew': 85.812, 'best_valid_test/acc_align': 86.008}
[20 / 20] best test accuracy: 86.588 at epoch 15 
 best_stats: {'best_test_epoch': 15, 'best_test_valid/acc': 86.498, 'best_test_valid/acc_unbiased': 86.674, 'best_test_valid/diff': 3.172, 'best_test_valid/acc_skew': 88.26, 'best_test_valid/acc_align': 85.088, 'best_test_test/acc': 86.667, 'best_test_test/acc_unbiased': 86.588, 'best_test_test/diff': 2.576, 'best_test_test/acc_skew': 86.581, 'best_test_test/acc_align': 86.594}
Total training time: 0:23:15
