Log level set to: INFO
Set seed: 1
=======> Using Fixed Random Seed: 1 <========
save_path: exp_results/bc-bb0-utk_face_age-crop_cutout_color_test-0.9-lr0.001-bs128-cbs64-w0.01-ratio10-aug1-seed1
get_utk_face - split: train, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_age-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
Binary Target 1
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Normal Label Distribution: 
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
Binary Target 1
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Normal Label Distribution: 
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 10684, target_attr: gender, bias_attr: age bias_rate: 0.9
['[train] target_0-bias_0: 8237', '[train] target_0-bias_1: 147', '[train] target_1-bias_0: 823', '[train] target_1-bias_1: 1477']
confusion_matrix - 
 original: tensor([[8237.,  823.],
        [ 147., 1477.]]), 
 normalized: tensor([[0.909, 0.091],
        [0.091, 0.909]]), 
 b|y: tensor([[0.982, 0.018],
        [0.358, 0.642]])
get_utk_face - split: train, aug: 1, given_y: True, ratio: 10
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_age-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
Binary Target 1
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Normal Label Distribution: 
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
Binary Target 1
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Normal Label Distribution: 
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 10684, target_attr: gender, bias_attr: age bias_rate: 0.9
['[train] target_0-bias_0: 8237', '[train] target_0-bias_1: 147', '[train] target_1-bias_0: 823', '[train] target_1-bias_1: 1477']
get_utk_face - split: valid, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_age-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [1030, 195]
Target 1: [841, 202]
Binary Target 1
---------------------------
Target 0: [1030, 195]
Target 1: [841, 202]
===================================
Normal Label Distribution: 
Target 0: [1030, 195]
Target 1: [841, 202]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 2268, target_attr: gender, bias_attr: age bias_rate: 0.9
['[valid] target_0-bias_0: 1030', '[valid] target_0-bias_1: 195', '[valid] target_1-bias_0: 841', '[valid] target_1-bias_1: 202']
get_utk_face - split: test, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_age-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [1061, 176]
Target 1: [867, 165]
Binary Target 1
---------------------------
Target 0: [1061, 176]
Target 1: [867, 165]
===================================
Normal Label Distribution: 
Target 0: [1061, 176]
Target 1: [867, 165]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 2269, target_attr: gender, bias_attr: age bias_rate: 0.9
['[test] target_0-bias_0: 1061', '[test] target_0-bias_1: 176', '[test] target_1-bias_0: 867', '[test] target_1-bias_1: 165']
decay_epochs: [6, 13]
[1 / 20] Learning rate: 0.001 weight: 0.01
[1 / 20] Loss: 4.859779236156902 CE Loss: 0.5571508044743083 Con Loss: 4.854207737978725
[1 / 20] tensor([[1.000, 1.000],
        [0.005, 0.000]]) {'epoch': 1, 'valid/acc': 54.101, 'valid/acc_unbiased': 50.059, 'valid/diff': 0.119, 'valid/acc_skew': 50.119, 'valid/acc_align': 50.0, 'test/acc': 54.694, 'test/acc_unbiased': 50.115, 'test/diff': 0.231, 'test/acc_skew': 50.231, 'test/acc_align': 50.0}
[1 / 20] best valid accuracy: 50.059 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 54.101, 'best_valid_valid/acc_unbiased': 50.059, 'best_valid_valid/diff': 0.119, 'best_valid_valid/acc_skew': 50.119, 'best_valid_valid/acc_align': 50.0, 'best_valid_test/acc': 54.694, 'best_valid_test/acc_unbiased': 50.115, 'best_valid_test/diff': 0.231, 'best_valid_test/acc_skew': 50.231, 'best_valid_test/acc_align': 50.0}
[1 / 20] best test accuracy: 50.115 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 54.101, 'best_test_valid/acc_unbiased': 50.059, 'best_test_valid/diff': 0.119, 'best_test_valid/acc_skew': 50.119, 'best_test_valid/acc_align': 50.0, 'best_test_test/acc': 54.694, 'best_test_test/acc_unbiased': 50.115, 'best_test_test/diff': 0.231, 'best_test_test/acc_skew': 50.231, 'best_test_test/acc_align': 50.0}
[2 / 20] Learning rate: 0.001 weight: 0.01
[2 / 20] Loss: 4.6745596560410725 CE Loss: 0.5278264210269675 Con Loss: 4.669281397540665
[2 / 20] tensor([[0.997, 0.989],
        [0.053, 0.048]]) {'epoch': 2, 'valid/acc': 56.261, 'valid/acc_unbiased': 53.127, 'valid/diff': 2.366, 'valid/acc_skew': 51.943, 'valid/acc_align': 54.31, 'test/acc': 56.677, 'test/acc_unbiased': 52.184, 'test/diff': 0.655, 'test/acc_skew': 52.085, 'test/acc_align': 52.283}
[2 / 20] best valid accuracy: 53.127 at epoch 2 
 best_stats: {'best_valid_epoch': 2, 'best_valid_valid/acc': 56.261, 'best_valid_valid/acc_unbiased': 53.127, 'best_valid_valid/diff': 2.366, 'best_valid_valid/acc_skew': 51.943, 'best_valid_valid/acc_align': 54.31, 'best_valid_test/acc': 56.677, 'best_valid_test/acc_unbiased': 52.184, 'best_valid_test/diff': 0.655, 'best_valid_test/acc_skew': 52.085, 'best_valid_test/acc_align': 52.283}
[2 / 20] best test accuracy: 52.184 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 56.261, 'best_test_valid/acc_unbiased': 53.127, 'best_test_valid/diff': 2.366, 'best_test_valid/acc_skew': 51.943, 'best_test_valid/acc_align': 54.31, 'best_test_test/acc': 56.677, 'best_test_test/acc_unbiased': 52.184, 'best_test_test/diff': 0.655, 'best_test_test/acc_skew': 52.085, 'best_test_test/acc_align': 52.283}
[3 / 20] Learning rate: 0.001 weight: 0.01
[3 / 20] Loss: 4.565415945806471 CE Loss: 0.5142547547237027 Con Loss: 4.560273415048843
[3 / 20] tensor([[0.936, 0.858],
        [0.549, 0.248]]) {'epoch': 3, 'valid/acc': 70.547, 'valid/acc_unbiased': 64.213, 'valid/diff': 14.549, 'valid/acc_skew': 68.642, 'valid/acc_align': 59.784, 'test/acc': 73.204, 'test/acc_unbiased': 64.784, 'test/diff': 18.924, 'test/acc_skew': 70.349, 'test/acc_align': 59.22}
[3 / 20] best valid accuracy: 64.213 at epoch 3 
 best_stats: {'best_valid_epoch': 3, 'best_valid_valid/acc': 70.547, 'best_valid_valid/acc_unbiased': 64.213, 'best_valid_valid/diff': 14.549, 'best_valid_valid/acc_skew': 68.642, 'best_valid_valid/acc_align': 59.784, 'best_valid_test/acc': 73.204, 'best_valid_test/acc_unbiased': 64.784, 'best_valid_test/diff': 18.924, 'best_valid_test/acc_skew': 70.349, 'best_valid_test/acc_align': 59.22}
[3 / 20] best test accuracy: 64.784 at epoch 3 
 best_stats: {'best_test_epoch': 3, 'best_test_valid/acc': 70.547, 'best_test_valid/acc_unbiased': 64.213, 'best_test_valid/diff': 14.549, 'best_test_valid/acc_skew': 68.642, 'best_test_valid/acc_align': 59.784, 'best_test_test/acc': 73.204, 'best_test_test/acc_unbiased': 64.784, 'best_test_test/diff': 18.924, 'best_test_test/acc_skew': 70.349, 'best_test_test/acc_align': 59.22}
[4 / 20] Learning rate: 0.001 weight: 0.01
[4 / 20] Loss: 4.597200723588801 CE Loss: 0.4970275993116872 Con Loss: 4.592230455297872
[4 / 20] tensor([[0.988, 0.960],
        [0.367, 0.127]]) {'epoch': 4, 'valid/acc': 67.549, 'valid/acc_unbiased': 61.248, 'valid/diff': 11.764, 'valid/acc_skew': 65.647, 'valid/acc_align': 56.848, 'test/acc': 68.576, 'test/acc_unbiased': 61.051, 'test/diff': 13.351, 'test/acc_skew': 66.35, 'test/acc_align': 55.751}
[4 / 20] best valid accuracy: 64.213 at epoch 3 
 best_stats: {'best_valid_epoch': 3, 'best_valid_valid/acc': 70.547, 'best_valid_valid/acc_unbiased': 64.213, 'best_valid_valid/diff': 14.549, 'best_valid_valid/acc_skew': 68.642, 'best_valid_valid/acc_align': 59.784, 'best_valid_test/acc': 73.204, 'best_valid_test/acc_unbiased': 64.784, 'best_valid_test/diff': 18.924, 'best_valid_test/acc_skew': 70.349, 'best_valid_test/acc_align': 59.22}
[4 / 20] best test accuracy: 64.784 at epoch 3 
 best_stats: {'best_test_epoch': 3, 'best_test_valid/acc': 70.547, 'best_test_valid/acc_unbiased': 64.213, 'best_test_valid/diff': 14.549, 'best_test_valid/acc_skew': 68.642, 'best_test_valid/acc_align': 59.784, 'best_test_test/acc': 73.204, 'best_test_test/acc_unbiased': 64.784, 'best_test_test/diff': 18.924, 'best_test_test/acc_skew': 70.349, 'best_test_test/acc_align': 59.22}
[5 / 20] Learning rate: 0.001 weight: 0.01
[5 / 20] Loss: 4.579434027612901 CE Loss: 0.47825885923646977 Con Loss: 4.574651439463945
[5 / 20] tensor([[0.982, 0.977],
        [0.388, 0.115]]) {'epoch': 5, 'valid/acc': 68.21, 'valid/acc_unbiased': 62.572, 'valid/diff': 10.06, 'valid/acc_skew': 67.602, 'valid/acc_align': 57.542, 'test/acc': 69.149, 'test/acc_unbiased': 61.551, 'test/diff': 13.861, 'test/acc_skew': 68.241, 'test/acc_align': 54.862}
[5 / 20] best valid accuracy: 64.213 at epoch 3 
 best_stats: {'best_valid_epoch': 3, 'best_valid_valid/acc': 70.547, 'best_valid_valid/acc_unbiased': 64.213, 'best_valid_valid/diff': 14.549, 'best_valid_valid/acc_skew': 68.642, 'best_valid_valid/acc_align': 59.784, 'best_valid_test/acc': 73.204, 'best_valid_test/acc_unbiased': 64.784, 'best_valid_test/diff': 18.924, 'best_valid_test/acc_skew': 70.349, 'best_valid_test/acc_align': 59.22}
[5 / 20] best test accuracy: 64.784 at epoch 3 
 best_stats: {'best_test_epoch': 3, 'best_test_valid/acc': 70.547, 'best_test_valid/acc_unbiased': 64.213, 'best_test_valid/diff': 14.549, 'best_test_valid/acc_skew': 68.642, 'best_test_valid/acc_align': 59.784, 'best_test_test/acc': 73.204, 'best_test_test/acc_unbiased': 64.784, 'best_test_test/diff': 18.924, 'best_test_test/acc_skew': 70.349, 'best_test_test/acc_align': 59.22}
[6 / 20] Learning rate: 0.001 weight: 0.01
[6 / 20] Loss: 4.528853104204687 CE Loss: 0.4748431903309074 Con Loss: 4.524104686052957
[6 / 20] tensor([[0.892, 0.824],
        [0.739, 0.455]]) {'epoch': 6, 'valid/acc': 77.293, 'valid/acc_unbiased': 71.485, 'valid/diff': 15.904, 'valid/acc_skew': 76.066, 'valid/acc_align': 66.903, 'test/acc': 79.639, 'test/acc_unbiased': 72.734, 'test/diff': 17.627, 'test/acc_skew': 78.16, 'test/acc_align': 67.308}
[6 / 20] best valid accuracy: 71.485 at epoch 6 
 best_stats: {'best_valid_epoch': 6, 'best_valid_valid/acc': 77.293, 'best_valid_valid/acc_unbiased': 71.485, 'best_valid_valid/diff': 15.904, 'best_valid_valid/acc_skew': 76.066, 'best_valid_valid/acc_align': 66.903, 'best_valid_test/acc': 79.639, 'best_valid_test/acc_unbiased': 72.734, 'best_valid_test/diff': 17.627, 'best_valid_test/acc_skew': 78.16, 'best_valid_test/acc_align': 67.308}
[6 / 20] best test accuracy: 72.734 at epoch 6 
 best_stats: {'best_test_epoch': 6, 'best_test_valid/acc': 77.293, 'best_test_valid/acc_unbiased': 71.485, 'best_test_valid/diff': 15.904, 'best_test_valid/acc_skew': 76.066, 'best_test_valid/acc_align': 66.903, 'best_test_test/acc': 79.639, 'best_test_test/acc_unbiased': 72.734, 'best_test_test/diff': 17.627, 'best_test_test/acc_skew': 78.16, 'best_test_test/acc_align': 67.308}
[7 / 20] Learning rate: 0.0001 weight: 0.01
[7 / 20] Loss: 4.526828153710917 CE Loss: 0.4363885090753676 Con Loss: 4.522464267505058
[7 / 20] tensor([[0.970, 0.841],
        [0.631, 0.436]]) {'epoch': 7, 'valid/acc': 76.764, 'valid/acc_unbiased': 71.336, 'valid/diff': 12.088, 'valid/acc_skew': 70.652, 'valid/acc_align': 72.02, 'test/acc': 79.154, 'test/acc_unbiased': 71.951, 'test/diff': 16.174, 'test/acc_skew': 73.591, 'test/acc_align': 70.31}
[7 / 20] best valid accuracy: 71.485 at epoch 6 
 best_stats: {'best_valid_epoch': 6, 'best_valid_valid/acc': 77.293, 'best_valid_valid/acc_unbiased': 71.485, 'best_valid_valid/diff': 15.904, 'best_valid_valid/acc_skew': 76.066, 'best_valid_valid/acc_align': 66.903, 'best_valid_test/acc': 79.639, 'best_valid_test/acc_unbiased': 72.734, 'best_valid_test/diff': 17.627, 'best_valid_test/acc_skew': 78.16, 'best_valid_test/acc_align': 67.308}
[7 / 20] best test accuracy: 72.734 at epoch 6 
 best_stats: {'best_test_epoch': 6, 'best_test_valid/acc': 77.293, 'best_test_valid/acc_unbiased': 71.485, 'best_test_valid/diff': 15.904, 'best_test_valid/acc_skew': 76.066, 'best_test_valid/acc_align': 66.903, 'best_test_test/acc': 79.639, 'best_test_test/acc_unbiased': 72.734, 'best_test_test/diff': 17.627, 'best_test_test/acc_skew': 78.16, 'best_test_test/acc_align': 67.308}
[8 / 20] Learning rate: 0.0001 weight: 0.01
[8 / 20] Loss: 4.480384285018847 CE Loss: 0.42933884655791066 Con Loss: 4.476090901623679
[8 / 20] tensor([[0.960, 0.869],
        [0.663, 0.424]]) {'epoch': 8, 'valid/acc': 77.557, 'valid/acc_unbiased': 72.515, 'valid/diff': 11.352, 'valid/acc_skew': 73.695, 'valid/acc_align': 71.335, 'test/acc': 80.079, 'test/acc_unbiased': 72.93, 'test/diff': 16.503, 'test/acc_skew': 76.626, 'test/acc_align': 69.233}
[8 / 20] best valid accuracy: 72.515 at epoch 8 
 best_stats: {'best_valid_epoch': 8, 'best_valid_valid/acc': 77.557, 'best_valid_valid/acc_unbiased': 72.515, 'best_valid_valid/diff': 11.352, 'best_valid_valid/acc_skew': 73.695, 'best_valid_valid/acc_align': 71.335, 'best_valid_test/acc': 80.079, 'best_valid_test/acc_unbiased': 72.93, 'best_valid_test/diff': 16.503, 'best_valid_test/acc_skew': 76.626, 'best_valid_test/acc_align': 69.233}
[8 / 20] best test accuracy: 72.930 at epoch 8 
 best_stats: {'best_test_epoch': 8, 'best_test_valid/acc': 77.557, 'best_test_valid/acc_unbiased': 72.515, 'best_test_valid/diff': 11.352, 'best_test_valid/acc_skew': 73.695, 'best_test_valid/acc_align': 71.335, 'best_test_test/acc': 80.079, 'best_test_test/acc_unbiased': 72.93, 'best_test_test/diff': 16.503, 'best_test_test/acc_skew': 76.626, 'best_test_test/acc_align': 69.233}
[9 / 20] Learning rate: 0.0001 weight: 0.01
[9 / 20] Loss: 4.472602648754684 CE Loss: 0.4072736467997352 Con Loss: 4.468529915818557
[9 / 20] tensor([[0.963, 0.807],
        [0.664, 0.521]]) {'epoch': 9, 'valid/acc': 77.954, 'valid/acc_unbiased': 72.293, 'valid/diff': 13.278, 'valid/acc_skew': 68.649, 'valid/acc_align': 75.936, 'test/acc': 80.476, 'test/acc_unbiased': 73.891, 'test/diff': 14.979, 'test/acc_skew': 73.559, 'test/acc_align': 74.223}
[9 / 20] best valid accuracy: 72.515 at epoch 8 
 best_stats: {'best_valid_epoch': 8, 'best_valid_valid/acc': 77.557, 'best_valid_valid/acc_unbiased': 72.515, 'best_valid_valid/diff': 11.352, 'best_valid_valid/acc_skew': 73.695, 'best_valid_valid/acc_align': 71.335, 'best_valid_test/acc': 80.079, 'best_valid_test/acc_unbiased': 72.93, 'best_valid_test/diff': 16.503, 'best_valid_test/acc_skew': 76.626, 'best_valid_test/acc_align': 69.233}
[9 / 20] best test accuracy: 73.891 at epoch 9 
 best_stats: {'best_test_epoch': 9, 'best_test_valid/acc': 77.954, 'best_test_valid/acc_unbiased': 72.293, 'best_test_valid/diff': 13.278, 'best_test_valid/acc_skew': 68.649, 'best_test_valid/acc_align': 75.936, 'best_test_test/acc': 80.476, 'best_test_test/acc_unbiased': 73.891, 'best_test_test/diff': 14.979, 'best_test_test/acc_skew': 73.559, 'best_test_test/acc_align': 74.223}
[10 / 20] Learning rate: 0.0001 weight: 0.01
[10 / 20] Loss: 4.421007689801284 CE Loss: 0.4187068709024817 Con Loss: 4.416820606815819
[10 / 20] tensor([[0.955, 0.790],
        [0.693, 0.545]]) {'epoch': 10, 'valid/acc': 78.351, 'valid/acc_unbiased': 72.805, 'valid/diff': 13.347, 'valid/acc_skew': 69.266, 'valid/acc_align': 76.344, 'test/acc': 81.225, 'test/acc_unbiased': 74.58, 'test/diff': 15.636, 'test/acc_skew': 74.148, 'test/acc_align': 75.011}
[10 / 20] best valid accuracy: 72.805 at epoch 10 
 best_stats: {'best_valid_epoch': 10, 'best_valid_valid/acc': 78.351, 'best_valid_valid/acc_unbiased': 72.805, 'best_valid_valid/diff': 13.347, 'best_valid_valid/acc_skew': 69.266, 'best_valid_valid/acc_align': 76.344, 'best_valid_test/acc': 81.225, 'best_valid_test/acc_unbiased': 74.58, 'best_valid_test/diff': 15.636, 'best_valid_test/acc_skew': 74.148, 'best_valid_test/acc_align': 75.011}
[10 / 20] best test accuracy: 74.580 at epoch 10 
 best_stats: {'best_test_epoch': 10, 'best_test_valid/acc': 78.351, 'best_test_valid/acc_unbiased': 72.805, 'best_test_valid/diff': 13.347, 'best_test_valid/acc_skew': 69.266, 'best_test_valid/acc_align': 76.344, 'best_test_test/acc': 81.225, 'best_test_test/acc_unbiased': 74.58, 'best_test_test/diff': 15.636, 'best_test_test/acc_skew': 74.148, 'best_test_test/acc_align': 75.011}
[11 / 20] Learning rate: 0.0001 weight: 0.01
[11 / 20] Loss: 4.378995458716447 CE Loss: 0.40375027668605534 Con Loss: 4.374957946568828
[11 / 20] tensor([[0.973, 0.784],
        [0.649, 0.570]]) {'epoch': 11, 'valid/acc': 77.866, 'valid/acc_unbiased': 72.314, 'valid/diff': 12.366, 'valid/acc_skew': 66.828, 'valid/acc_align': 77.8, 'test/acc': 80.52, 'test/acc_unbiased': 74.396, 'test/diff': 13.412, 'test/acc_skew': 71.673, 'test/acc_align': 77.118}
[11 / 20] best valid accuracy: 72.805 at epoch 10 
 best_stats: {'best_valid_epoch': 10, 'best_valid_valid/acc': 78.351, 'best_valid_valid/acc_unbiased': 72.805, 'best_valid_valid/diff': 13.347, 'best_valid_valid/acc_skew': 69.266, 'best_valid_valid/acc_align': 76.344, 'best_valid_test/acc': 81.225, 'best_valid_test/acc_unbiased': 74.58, 'best_valid_test/diff': 15.636, 'best_valid_test/acc_skew': 74.148, 'best_valid_test/acc_align': 75.011}
[11 / 20] best test accuracy: 74.580 at epoch 10 
 best_stats: {'best_test_epoch': 10, 'best_test_valid/acc': 78.351, 'best_test_valid/acc_unbiased': 72.805, 'best_test_valid/diff': 13.347, 'best_test_valid/acc_skew': 69.266, 'best_test_valid/acc_align': 76.344, 'best_test_test/acc': 81.225, 'best_test_test/acc_unbiased': 74.58, 'best_test_test/diff': 15.636, 'best_test_test/acc_skew': 74.148, 'best_test_test/acc_align': 75.011}
[12 / 20] Learning rate: 0.0001 weight: 0.01
[12 / 20] Loss: 4.41658325116762 CE Loss: 0.3930232492291227 Con Loss: 4.4126530154195
[12 / 20] tensor([[0.969, 0.744],
        [0.689, 0.624]]) {'epoch': 12, 'valid/acc': 79.145, 'valid/acc_unbiased': 72.453, 'valid/diff': 16.412, 'valid/acc_skew': 64.728, 'valid/acc_align': 80.178, 'test/acc': 81.93, 'test/acc_unbiased': 75.651, 'test/diff': 14.446, 'test/acc_skew': 71.645, 'test/acc_align': 79.657}
[12 / 20] best valid accuracy: 72.805 at epoch 10 
 best_stats: {'best_valid_epoch': 10, 'best_valid_valid/acc': 78.351, 'best_valid_valid/acc_unbiased': 72.805, 'best_valid_valid/diff': 13.347, 'best_valid_valid/acc_skew': 69.266, 'best_valid_valid/acc_align': 76.344, 'best_valid_test/acc': 81.225, 'best_valid_test/acc_unbiased': 74.58, 'best_valid_test/diff': 15.636, 'best_valid_test/acc_skew': 74.148, 'best_valid_test/acc_align': 75.011}
[12 / 20] best test accuracy: 75.651 at epoch 12 
 best_stats: {'best_test_epoch': 12, 'best_test_valid/acc': 79.145, 'best_test_valid/acc_unbiased': 72.453, 'best_test_valid/diff': 16.412, 'best_test_valid/acc_skew': 64.728, 'best_test_valid/acc_align': 80.178, 'best_test_test/acc': 81.93, 'best_test_test/acc_unbiased': 75.651, 'best_test_test/diff': 14.446, 'best_test_test/acc_skew': 71.645, 'best_test_test/acc_align': 79.657}
[13 / 20] Learning rate: 0.0001 weight: 0.01
[13 / 20] Loss: 4.4046688760009785 CE Loss: 0.38012991541559354 Con Loss: 4.400867603906127
[13 / 20] tensor([[0.971, 0.693],
        [0.664, 0.648]]) {'epoch': 13, 'valid/acc': 78.483, 'valid/acc_unbiased': 72.284, 'valid/diff': 19.459, 'valid/acc_skew': 62.554, 'valid/acc_align': 82.013, 'test/acc': 80.873, 'test/acc_unbiased': 74.42, 'test/diff': 14.674, 'test/acc_skew': 67.877, 'test/acc_align': 80.963}
[13 / 20] best valid accuracy: 72.805 at epoch 10 
 best_stats: {'best_valid_epoch': 10, 'best_valid_valid/acc': 78.351, 'best_valid_valid/acc_unbiased': 72.805, 'best_valid_valid/diff': 13.347, 'best_valid_valid/acc_skew': 69.266, 'best_valid_valid/acc_align': 76.344, 'best_valid_test/acc': 81.225, 'best_valid_test/acc_unbiased': 74.58, 'best_valid_test/diff': 15.636, 'best_valid_test/acc_skew': 74.148, 'best_valid_test/acc_align': 75.011}
[13 / 20] best test accuracy: 75.651 at epoch 12 
 best_stats: {'best_test_epoch': 12, 'best_test_valid/acc': 79.145, 'best_test_valid/acc_unbiased': 72.453, 'best_test_valid/diff': 16.412, 'best_test_valid/acc_skew': 64.728, 'best_test_valid/acc_align': 80.178, 'best_test_test/acc': 81.93, 'best_test_test/acc_unbiased': 75.651, 'best_test_test/diff': 14.446, 'best_test_test/acc_skew': 71.645, 'best_test_test/acc_align': 79.657}
[14 / 20] Learning rate: 1e-05 weight: 0.01
[14 / 20] Loss: 4.361756103934085 CE Loss: 0.376669089899488 Con Loss: 4.357989434399706
[14 / 20] tensor([[0.975, 0.739],
        [0.655, 0.630]]) {'epoch': 14, 'valid/acc': 78.968, 'valid/acc_unbiased': 73.474, 'valid/diff': 17.068, 'valid/acc_skew': 64.94, 'valid/acc_align': 82.008, 'test/acc': 80.917, 'test/acc_unbiased': 74.966, 'test/diff': 13.037, 'test/acc_skew': 69.688, 'test/acc_align': 80.243}
[14 / 20] best valid accuracy: 73.474 at epoch 14 
 best_stats: {'best_valid_epoch': 14, 'best_valid_valid/acc': 78.968, 'best_valid_valid/acc_unbiased': 73.474, 'best_valid_valid/diff': 17.068, 'best_valid_valid/acc_skew': 64.94, 'best_valid_valid/acc_align': 82.008, 'best_valid_test/acc': 80.917, 'best_valid_test/acc_unbiased': 74.966, 'best_valid_test/diff': 13.037, 'best_valid_test/acc_skew': 69.688, 'best_valid_test/acc_align': 80.243}
[14 / 20] best test accuracy: 75.651 at epoch 12 
 best_stats: {'best_test_epoch': 12, 'best_test_valid/acc': 79.145, 'best_test_valid/acc_unbiased': 72.453, 'best_test_valid/diff': 16.412, 'best_test_valid/acc_skew': 64.728, 'best_test_valid/acc_align': 80.178, 'best_test_test/acc': 81.93, 'best_test_test/acc_unbiased': 75.651, 'best_test_test/diff': 14.446, 'best_test_test/acc_skew': 71.645, 'best_test_test/acc_align': 79.657}
[15 / 20] Learning rate: 1e-05 weight: 0.01
[15 / 20] Loss: 4.344822603502063 CE Loss: 0.37691637315762616 Con Loss: 4.341053438383022
[15 / 20] tensor([[0.973, 0.727],
        [0.674, 0.648]]) {'epoch': 15, 'valid/acc': 79.277, 'valid/acc_unbiased': 73.691, 'valid/diff': 17.732, 'valid/acc_skew': 64.825, 'valid/acc_align': 82.556, 'test/acc': 81.578, 'test/acc_unbiased': 75.55, 'test/diff': 13.525, 'test/acc_skew': 70.043, 'test/acc_align': 81.058}
[15 / 20] best valid accuracy: 73.691 at epoch 15 
 best_stats: {'best_valid_epoch': 15, 'best_valid_valid/acc': 79.277, 'best_valid_valid/acc_unbiased': 73.691, 'best_valid_valid/diff': 17.732, 'best_valid_valid/acc_skew': 64.825, 'best_valid_valid/acc_align': 82.556, 'best_valid_test/acc': 81.578, 'best_valid_test/acc_unbiased': 75.55, 'best_valid_test/diff': 13.525, 'best_valid_test/acc_skew': 70.043, 'best_valid_test/acc_align': 81.058}
[15 / 20] best test accuracy: 75.651 at epoch 12 
 best_stats: {'best_test_epoch': 12, 'best_test_valid/acc': 79.145, 'best_test_valid/acc_unbiased': 72.453, 'best_test_valid/diff': 16.412, 'best_test_valid/acc_skew': 64.728, 'best_test_valid/acc_align': 80.178, 'best_test_test/acc': 81.93, 'best_test_test/acc_unbiased': 75.651, 'best_test_test/diff': 14.446, 'best_test_test/acc_skew': 71.645, 'best_test_test/acc_align': 79.657}
[16 / 20] Learning rate: 1e-05 weight: 0.01
[16 / 20] Loss: 4.29959174837793 CE Loss: 0.3766179379119002 Con Loss: 4.29582556549952
[16 / 20] tensor([[0.972, 0.716],
        [0.700, 0.661]]) {'epoch': 16, 'valid/acc': 79.982, 'valid/acc_unbiased': 73.692, 'valid/diff': 18.233, 'valid/acc_skew': 64.576, 'valid/acc_align': 82.809, 'test/acc': 82.547, 'test/acc_unbiased': 76.209, 'test/diff': 14.766, 'test/acc_skew': 70.801, 'test/acc_align': 81.617}
[16 / 20] best valid accuracy: 73.692 at epoch 16 
 best_stats: {'best_valid_epoch': 16, 'best_valid_valid/acc': 79.982, 'best_valid_valid/acc_unbiased': 73.692, 'best_valid_valid/diff': 18.233, 'best_valid_valid/acc_skew': 64.576, 'best_valid_valid/acc_align': 82.809, 'best_valid_test/acc': 82.547, 'best_valid_test/acc_unbiased': 76.209, 'best_valid_test/diff': 14.766, 'best_valid_test/acc_skew': 70.801, 'best_valid_test/acc_align': 81.617}
[16 / 20] best test accuracy: 76.209 at epoch 16 
 best_stats: {'best_test_epoch': 16, 'best_test_valid/acc': 79.982, 'best_test_valid/acc_unbiased': 73.692, 'best_test_valid/diff': 18.233, 'best_test_valid/acc_skew': 64.576, 'best_test_valid/acc_align': 82.809, 'best_test_test/acc': 82.547, 'best_test_test/acc_unbiased': 76.209, 'best_test_test/diff': 14.766, 'best_test_test/acc_skew': 70.801, 'best_test_test/acc_align': 81.617}
[17 / 20] Learning rate: 1e-05 weight: 0.01
[17 / 20] Loss: 4.315317160536046 CE Loss: 0.37410786198971646 Con Loss: 4.311576063469616
[17 / 20] tensor([[0.971, 0.682],
        [0.685, 0.667]]) {'epoch': 17, 'valid/acc': 79.541, 'valid/acc_unbiased': 73.66, 'valid/diff': 19.677, 'valid/acc_skew': 63.821, 'valid/acc_align': 83.498, 'test/acc': 81.71, 'test/acc_unbiased': 75.11, 'test/diff': 15.371, 'test/acc_skew': 68.347, 'test/acc_align': 81.872}
[17 / 20] best valid accuracy: 73.692 at epoch 16 
 best_stats: {'best_valid_epoch': 16, 'best_valid_valid/acc': 79.982, 'best_valid_valid/acc_unbiased': 73.692, 'best_valid_valid/diff': 18.233, 'best_valid_valid/acc_skew': 64.576, 'best_valid_valid/acc_align': 82.809, 'best_valid_test/acc': 82.547, 'best_valid_test/acc_unbiased': 76.209, 'best_valid_test/diff': 14.766, 'best_valid_test/acc_skew': 70.801, 'best_valid_test/acc_align': 81.617}
[17 / 20] best test accuracy: 76.209 at epoch 16 
 best_stats: {'best_test_epoch': 16, 'best_test_valid/acc': 79.982, 'best_test_valid/acc_unbiased': 73.692, 'best_test_valid/diff': 18.233, 'best_test_valid/acc_skew': 64.576, 'best_test_valid/acc_align': 82.809, 'best_test_test/acc': 82.547, 'best_test_test/acc_unbiased': 76.209, 'best_test_test/diff': 14.766, 'best_test_test/acc_skew': 70.801, 'best_test_test/acc_align': 81.617}
[18 / 20] Learning rate: 1e-05 weight: 0.01
[18 / 20] Loss: 4.3389252659445265 CE Loss: 0.38369210086168754 Con Loss: 4.3350883365703945
[18 / 20] tensor([[0.975, 0.744],
        [0.671, 0.673]]) {'epoch': 18, 'valid/acc': 78.968, 'valid/acc_unbiased': 73.278, 'valid/diff': 17.858, 'valid/acc_skew': 64.349, 'valid/acc_align': 82.207, 'test/acc': 81.886, 'test/acc_unbiased': 76.572, 'test/diff': 11.584, 'test/acc_skew': 70.78, 'test/acc_align': 82.364}
[18 / 20] best valid accuracy: 73.692 at epoch 16 
 best_stats: {'best_valid_epoch': 16, 'best_valid_valid/acc': 79.982, 'best_valid_valid/acc_unbiased': 73.692, 'best_valid_valid/diff': 18.233, 'best_valid_valid/acc_skew': 64.576, 'best_valid_valid/acc_align': 82.809, 'best_valid_test/acc': 82.547, 'best_valid_test/acc_unbiased': 76.209, 'best_valid_test/diff': 14.766, 'best_valid_test/acc_skew': 70.801, 'best_valid_test/acc_align': 81.617}
[18 / 20] best test accuracy: 76.572 at epoch 18 
 best_stats: {'best_test_epoch': 18, 'best_test_valid/acc': 78.968, 'best_test_valid/acc_unbiased': 73.278, 'best_test_valid/diff': 17.858, 'best_test_valid/acc_skew': 64.349, 'best_test_valid/acc_align': 82.207, 'best_test_test/acc': 81.886, 'best_test_test/acc_unbiased': 76.572, 'best_test_test/diff': 11.584, 'best_test_test/acc_skew': 70.78, 'best_test_test/acc_align': 82.364}
[19 / 20] Learning rate: 1e-05 weight: 0.01
[19 / 20] Loss: 4.361564812076445 CE Loss: 0.3738168681082945 Con Loss: 4.357826662438499
[19 / 20] tensor([[0.974, 0.733],
        [0.686, 0.667]]) {'epoch': 19, 'valid/acc': 79.674, 'valid/acc_unbiased': 73.657, 'valid/diff': 17.895, 'valid/acc_skew': 64.71, 'valid/acc_align': 82.605, 'test/acc': 82.283, 'test/acc_unbiased': 76.488, 'test/diff': 13.013, 'test/acc_skew': 70.961, 'test/acc_align': 82.014}
[19 / 20] best valid accuracy: 73.692 at epoch 16 
 best_stats: {'best_valid_epoch': 16, 'best_valid_valid/acc': 79.982, 'best_valid_valid/acc_unbiased': 73.692, 'best_valid_valid/diff': 18.233, 'best_valid_valid/acc_skew': 64.576, 'best_valid_valid/acc_align': 82.809, 'best_valid_test/acc': 82.547, 'best_valid_test/acc_unbiased': 76.209, 'best_valid_test/diff': 14.766, 'best_valid_test/acc_skew': 70.801, 'best_valid_test/acc_align': 81.617}
[19 / 20] best test accuracy: 76.572 at epoch 18 
 best_stats: {'best_test_epoch': 18, 'best_test_valid/acc': 78.968, 'best_test_valid/acc_unbiased': 73.278, 'best_test_valid/diff': 17.858, 'best_test_valid/acc_skew': 64.349, 'best_test_valid/acc_align': 82.207, 'best_test_test/acc': 81.886, 'best_test_test/acc_unbiased': 76.572, 'best_test_test/diff': 11.584, 'best_test_test/acc_skew': 70.78, 'best_test_test/acc_align': 82.364}
[20 / 20] Learning rate: 1e-05 weight: 0.01
[20 / 20] Loss: 4.340797430029169 CE Loss: 0.366114758844904 Con Loss: 4.337136278970105
[20 / 20] tensor([[0.973, 0.716],
        [0.690, 0.661]]) {'epoch': 20, 'valid/acc': 79.938, 'valid/acc_unbiased': 73.847, 'valid/diff': 17.323, 'valid/acc_skew': 65.185, 'valid/acc_align': 82.508, 'test/acc': 82.195, 'test/acc_unbiased': 75.973, 'test/diff': 14.294, 'test/acc_skew': 70.282, 'test/acc_align': 81.664}
[20 / 20] best valid accuracy: 73.847 at epoch 20 
 best_stats: {'best_valid_epoch': 20, 'best_valid_valid/acc': 79.938, 'best_valid_valid/acc_unbiased': 73.847, 'best_valid_valid/diff': 17.323, 'best_valid_valid/acc_skew': 65.185, 'best_valid_valid/acc_align': 82.508, 'best_valid_test/acc': 82.195, 'best_valid_test/acc_unbiased': 75.973, 'best_valid_test/diff': 14.294, 'best_valid_test/acc_skew': 70.282, 'best_valid_test/acc_align': 81.664}
[20 / 20] best test accuracy: 76.572 at epoch 18 
 best_stats: {'best_test_epoch': 18, 'best_test_valid/acc': 78.968, 'best_test_valid/acc_unbiased': 73.278, 'best_test_valid/diff': 17.858, 'best_test_valid/acc_skew': 64.349, 'best_test_valid/acc_align': 82.207, 'best_test_test/acc': 81.886, 'best_test_test/acc_unbiased': 76.572, 'best_test_test/diff': 11.584, 'best_test_test/acc_skew': 70.78, 'best_test_test/acc_align': 82.364}
Total training time: 0:17:15
