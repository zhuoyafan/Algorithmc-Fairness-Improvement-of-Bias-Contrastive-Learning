Log level set to: INFO
Set seed: 1
=======> Using Fixed Random Seed: 1 <========
save_path: exp_results/bc-bb0-utk_face_race-uw-0.997-lr0.001-bs128-cbs64-w0.01-ratio10-aug1-seed1
get_utk_face - split: train, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_race-0.997
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [4407, 16]
Target 1: [13, 5529]
Binary Target 1
---------------------------
Target 0: [4407, 16]
Target 1: [13, 5529]
===================================
Normal Label Distribution: 
Target 0: [4407, 16]
Target 1: [13, 5529]
===================================
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [4407, 16]
Target 1: [13, 5529]
Binary Target 1
---------------------------
Target 0: [4407, 16]
Target 1: [13, 5529]
===================================
Normal Label Distribution: 
Target 0: [4407, 16]
Target 1: [13, 5529]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 9965, target_attr: gender, bias_attr: race bias_rate: 0.997
['[train] target_0-bias_0: 4407', '[train] target_0-bias_1: 16', '[train] target_1-bias_0: 13', '[train] target_1-bias_1: 5529']
confusion_matrix - 
 original: tensor([[4407.,   13.],
        [  16., 5529.]]), 
 normalized: tensor([[0.997, 0.003],
        [0.003, 0.997]]), 
 b|y: tensor([[0.996, 0.004],
        [0.002, 0.998]])
get_utk_face - split: train, aug: 1, given_y: True, ratio: 10
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_race-0.997
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [4407, 16]
Target 1: [13, 5529]
Binary Target 1
---------------------------
Target 0: [4407, 16]
Target 1: [13, 5529]
===================================
Normal Label Distribution: 
Target 0: [4407, 16]
Target 1: [13, 5529]
===================================
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [4407, 16]
Target 1: [13, 5529]
Binary Target 1
---------------------------
Target 0: [4407, 16]
Target 1: [13, 5529]
===================================
Normal Label Distribution: 
Target 0: [4407, 16]
Target 1: [13, 5529]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 9965, target_attr: gender, bias_attr: race bias_rate: 0.997
['[train] target_0-bias_0: 4407', '[train] target_0-bias_1: 16', '[train] target_1-bias_0: 13', '[train] target_1-bias_1: 5529']
get_utk_face - split: valid, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_race-0.997
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [583, 684]
Target 1: [457, 646]
Binary Target 1
---------------------------
Target 0: [583, 684]
Target 1: [457, 646]
===================================
Normal Label Distribution: 
Target 0: [583, 684]
Target 1: [457, 646]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 2370, target_attr: gender, bias_attr: race bias_rate: 0.997
['[valid] target_0-bias_0: 583', '[valid] target_0-bias_1: 684', '[valid] target_1-bias_0: 457', '[valid] target_1-bias_1: 646']
get_utk_face - split: test, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_race-0.997
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [558, 677]
Target 1: [462, 673]
Binary Target 1
---------------------------
Target 0: [558, 677]
Target 1: [462, 673]
===================================
Normal Label Distribution: 
Target 0: [558, 677]
Target 1: [462, 673]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 2370, target_attr: gender, bias_attr: race bias_rate: 0.997
['[test] target_0-bias_0: 558', '[test] target_0-bias_1: 677', '[test] target_1-bias_0: 462', '[test] target_1-bias_1: 673']
decay_epochs: [6, 13]
[1 / 20] Learning rate: 0.001 weight: 0.01
[1 / 20] Loss: 3.2353853986781265 CE Loss: 2.9027327096228976 Con Loss: 3.2063580556066564
[1 / 20] tensor([[1., 1.],
        [0., 0.]]) {'epoch': 1, 'valid/acc': 53.46, 'valid/acc_unbiased': 50.0, 'valid/diff': 0.0, 'valid/acc_skew': 50.0, 'valid/acc_align': 50.0, 'test/acc': 52.11, 'test/acc_unbiased': 50.0, 'test/diff': 0.0, 'test/acc_skew': 50.0, 'test/acc_align': 50.0}
[1 / 20] best valid accuracy: 50.000 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 53.46, 'best_valid_valid/acc_unbiased': 50.0, 'best_valid_valid/diff': 0.0, 'best_valid_valid/acc_skew': 50.0, 'best_valid_valid/acc_align': 50.0, 'best_valid_test/acc': 52.11, 'best_valid_test/acc_unbiased': 50.0, 'best_valid_test/diff': 0.0, 'best_valid_test/acc_skew': 50.0, 'best_valid_test/acc_align': 50.0}
[1 / 20] best test accuracy: 50.000 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 53.46, 'best_test_valid/acc_unbiased': 50.0, 'best_test_valid/diff': 0.0, 'best_test_valid/acc_skew': 50.0, 'best_test_valid/acc_align': 50.0, 'best_test_test/acc': 52.11, 'best_test_test/acc_unbiased': 50.0, 'best_test_test/diff': 0.0, 'best_test_test/acc_skew': 50.0, 'best_test_test/acc_align': 50.0}
[2 / 20] Learning rate: 0.001 weight: 0.01
[2 / 20] Loss: 3.069033309077116 CE Loss: 2.9658427936972176 Con Loss: 3.0393748925070754
[2 / 20] tensor([[1., 1.],
        [0., 0.]]) {'epoch': 2, 'valid/acc': 53.46, 'valid/acc_unbiased': 50.0, 'valid/diff': 0.0, 'valid/acc_skew': 50.0, 'valid/acc_align': 50.0, 'test/acc': 52.11, 'test/acc_unbiased': 50.0, 'test/diff': 0.0, 'test/acc_skew': 50.0, 'test/acc_align': 50.0}
[2 / 20] best valid accuracy: 50.000 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 53.46, 'best_valid_valid/acc_unbiased': 50.0, 'best_valid_valid/diff': 0.0, 'best_valid_valid/acc_skew': 50.0, 'best_valid_valid/acc_align': 50.0, 'best_valid_test/acc': 52.11, 'best_valid_test/acc_unbiased': 50.0, 'best_valid_test/diff': 0.0, 'best_valid_test/acc_skew': 50.0, 'best_valid_test/acc_align': 50.0}
[2 / 20] best test accuracy: 50.000 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 53.46, 'best_test_valid/acc_unbiased': 50.0, 'best_test_valid/diff': 0.0, 'best_test_valid/acc_skew': 50.0, 'best_test_valid/acc_align': 50.0, 'best_test_test/acc': 52.11, 'best_test_test/acc_unbiased': 50.0, 'best_test_test/diff': 0.0, 'best_test_test/acc_skew': 50.0, 'best_test_test/acc_align': 50.0}
[3 / 20] Learning rate: 0.001 weight: 0.01
[3 / 20] Loss: 2.7559600675997276 CE Loss: 2.8884039610878522 Con Loss: 2.7270760251479236
[3 / 20] tensor([[1., 1.],
        [0., 0.]]) {'epoch': 3, 'valid/acc': 53.46, 'valid/acc_unbiased': 50.0, 'valid/diff': 0.0, 'valid/acc_skew': 50.0, 'valid/acc_align': 50.0, 'test/acc': 52.11, 'test/acc_unbiased': 50.0, 'test/diff': 0.0, 'test/acc_skew': 50.0, 'test/acc_align': 50.0}
[3 / 20] best valid accuracy: 50.000 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 53.46, 'best_valid_valid/acc_unbiased': 50.0, 'best_valid_valid/diff': 0.0, 'best_valid_valid/acc_skew': 50.0, 'best_valid_valid/acc_align': 50.0, 'best_valid_test/acc': 52.11, 'best_valid_test/acc_unbiased': 50.0, 'best_valid_test/diff': 0.0, 'best_valid_test/acc_skew': 50.0, 'best_valid_test/acc_align': 50.0}
[3 / 20] best test accuracy: 50.000 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 53.46, 'best_test_valid/acc_unbiased': 50.0, 'best_test_valid/diff': 0.0, 'best_test_valid/acc_skew': 50.0, 'best_test_valid/acc_align': 50.0, 'best_test_test/acc': 52.11, 'best_test_test/acc_unbiased': 50.0, 'best_test_test/diff': 0.0, 'best_test_test/acc_skew': 50.0, 'best_test_test/acc_align': 50.0}
[4 / 20] Learning rate: 0.001 weight: 0.01
[4 / 20] Loss: 2.7860206333405397 CE Loss: 3.2693156650780555 Con Loss: 2.753327483527934
[4 / 20] tensor([[0.995, 0.981],
        [0.002, 0.016]]) {'epoch': 4, 'valid/acc': 53.586, 'valid/acc_unbiased': 50.206, 'valid/diff': 0.123, 'valid/acc_skew': 50.145, 'valid/acc_align': 50.268, 'test/acc': 51.941, 'test/acc_unbiased': 49.848, 'test/diff': 1.4, 'test/acc_skew': 49.148, 'test/acc_align': 50.548}
[4 / 20] best valid accuracy: 50.206 at epoch 4 
 best_stats: {'best_valid_epoch': 4, 'best_valid_valid/acc': 53.586, 'best_valid_valid/acc_unbiased': 50.206, 'best_valid_valid/diff': 0.123, 'best_valid_valid/acc_skew': 50.145, 'best_valid_valid/acc_align': 50.268, 'best_valid_test/acc': 51.941, 'best_valid_test/acc_unbiased': 49.848, 'best_valid_test/diff': 1.4, 'best_valid_test/acc_skew': 49.148, 'best_valid_test/acc_align': 50.548}
[4 / 20] best test accuracy: 50.000 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 53.46, 'best_test_valid/acc_unbiased': 50.0, 'best_test_valid/diff': 0.0, 'best_test_valid/acc_skew': 50.0, 'best_test_valid/acc_align': 50.0, 'best_test_test/acc': 52.11, 'best_test_test/acc_unbiased': 50.0, 'best_test_test/diff': 0.0, 'best_test_test/acc_skew': 50.0, 'best_test_test/acc_align': 50.0}
[5 / 20] Learning rate: 0.001 weight: 0.01
[5 / 20] Loss: 2.95306110048318 CE Loss: 3.045015256607048 Con Loss: 2.9226109365691983
[5 / 20] tensor([[0., 0.],
        [1., 1.]]) {'epoch': 5, 'valid/acc': 46.54, 'valid/acc_unbiased': 50.0, 'valid/diff': 0.0, 'valid/acc_skew': 50.0, 'valid/acc_align': 50.0, 'test/acc': 47.89, 'test/acc_unbiased': 50.0, 'test/diff': 0.0, 'test/acc_skew': 50.0, 'test/acc_align': 50.0}
[5 / 20] best valid accuracy: 50.206 at epoch 4 
 best_stats: {'best_valid_epoch': 4, 'best_valid_valid/acc': 53.586, 'best_valid_valid/acc_unbiased': 50.206, 'best_valid_valid/diff': 0.123, 'best_valid_valid/acc_skew': 50.145, 'best_valid_valid/acc_align': 50.268, 'best_valid_test/acc': 51.941, 'best_valid_test/acc_unbiased': 49.848, 'best_valid_test/diff': 1.4, 'best_valid_test/acc_skew': 49.148, 'best_valid_test/acc_align': 50.548}
[5 / 20] best test accuracy: 50.000 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 53.46, 'best_test_valid/acc_unbiased': 50.0, 'best_test_valid/diff': 0.0, 'best_test_valid/acc_skew': 50.0, 'best_test_valid/acc_align': 50.0, 'best_test_test/acc': 52.11, 'best_test_test/acc_unbiased': 50.0, 'best_test_test/diff': 0.0, 'best_test_test/acc_skew': 50.0, 'best_test_test/acc_align': 50.0}
[6 / 20] Learning rate: 0.001 weight: 0.01
[6 / 20] Loss: 2.8516135407881826 CE Loss: 2.8805002255829746 Con Loss: 2.8228085448259814
[6 / 20] tensor([[0.986, 0.988],
        [0.009, 0.018]]) {'epoch': 6, 'valid/acc': 53.08, 'valid/acc_unbiased': 49.694, 'valid/diff': 0.34, 'valid/acc_skew': 49.524, 'valid/acc_align': 49.864, 'test/acc': 52.11, 'test/acc_unbiased': 50.008, 'test/diff': 0.585, 'test/acc_skew': 49.842, 'test/acc_align': 50.175}
[6 / 20] best valid accuracy: 50.206 at epoch 4 
 best_stats: {'best_valid_epoch': 4, 'best_valid_valid/acc': 53.586, 'best_valid_valid/acc_unbiased': 50.206, 'best_valid_valid/diff': 0.123, 'best_valid_valid/acc_skew': 50.145, 'best_valid_valid/acc_align': 50.268, 'best_valid_test/acc': 51.941, 'best_valid_test/acc_unbiased': 49.848, 'best_valid_test/diff': 1.4, 'best_valid_test/acc_skew': 49.148, 'best_valid_test/acc_align': 50.548}
[6 / 20] best test accuracy: 50.008 at epoch 6 
 best_stats: {'best_test_epoch': 6, 'best_test_valid/acc': 53.08, 'best_test_valid/acc_unbiased': 49.694, 'best_test_valid/diff': 0.34, 'best_test_valid/acc_skew': 49.524, 'best_test_valid/acc_align': 49.864, 'best_test_test/acc': 52.11, 'best_test_test/acc_unbiased': 50.008, 'best_test_test/diff': 0.585, 'best_test_test/acc_skew': 49.842, 'best_test_test/acc_align': 50.175}
[7 / 20] Learning rate: 0.0001 weight: 0.01
[7 / 20] Loss: 3.113644185571053 CE Loss: 2.7975855680308745 Con Loss: 3.085668340234139
[7 / 20] tensor([[0.973, 0.968],
        [0.030, 0.059]]) {'epoch': 7, 'valid/acc': 53.671, 'valid/acc_unbiased': 50.367, 'valid/diff': 1.835, 'valid/acc_skew': 49.449, 'valid/acc_align': 51.284, 'test/acc': 52.827, 'test/acc_unbiased': 50.759, 'test/diff': 1.737, 'test/acc_skew': 49.89, 'test/acc_align': 51.628}
[7 / 20] best valid accuracy: 50.367 at epoch 7 
 best_stats: {'best_valid_epoch': 7, 'best_valid_valid/acc': 53.671, 'best_valid_valid/acc_unbiased': 50.367, 'best_valid_valid/diff': 1.835, 'best_valid_valid/acc_skew': 49.449, 'best_valid_valid/acc_align': 51.284, 'best_valid_test/acc': 52.827, 'best_valid_test/acc_unbiased': 50.759, 'best_valid_test/diff': 1.737, 'best_valid_test/acc_skew': 49.89, 'best_valid_test/acc_align': 51.628}
[7 / 20] best test accuracy: 50.759 at epoch 7 
 best_stats: {'best_test_epoch': 7, 'best_test_valid/acc': 53.671, 'best_test_valid/acc_unbiased': 50.367, 'best_test_valid/diff': 1.835, 'best_test_valid/acc_skew': 49.449, 'best_test_valid/acc_align': 51.284, 'best_test_test/acc': 52.827, 'best_test_test/acc_unbiased': 50.759, 'best_test_test/diff': 1.737, 'best_test_test/acc_skew': 49.89, 'best_test_test/acc_align': 51.628}
[8 / 20] Learning rate: 0.0001 weight: 0.01
[8 / 20] Loss: 3.0281604454018516 CE Loss: 2.789295187931951 Con Loss: 3.000267481098089
[8 / 20] tensor([[0.962, 0.942],
        [0.074, 0.108]]) {'epoch': 8, 'valid/acc': 54.473, 'valid/acc_unbiased': 51.29, 'valid/diff': 4.052, 'valid/acc_skew': 49.264, 'valid/acc_align': 53.316, 'test/acc': 54.093, 'test/acc_unbiased': 52.171, 'test/diff': 2.742, 'test/acc_skew': 50.799, 'test/acc_align': 53.542}
[8 / 20] best valid accuracy: 51.290 at epoch 8 
 best_stats: {'best_valid_epoch': 8, 'best_valid_valid/acc': 54.473, 'best_valid_valid/acc_unbiased': 51.29, 'best_valid_valid/diff': 4.052, 'best_valid_valid/acc_skew': 49.264, 'best_valid_valid/acc_align': 53.316, 'best_valid_test/acc': 54.093, 'best_valid_test/acc_unbiased': 52.171, 'best_valid_test/diff': 2.742, 'best_valid_test/acc_skew': 50.799, 'best_valid_test/acc_align': 53.542}
[8 / 20] best test accuracy: 52.171 at epoch 8 
 best_stats: {'best_test_epoch': 8, 'best_test_valid/acc': 54.473, 'best_test_valid/acc_unbiased': 51.29, 'best_test_valid/diff': 4.052, 'best_test_valid/acc_skew': 49.264, 'best_test_valid/acc_align': 53.316, 'best_test_test/acc': 54.093, 'best_test_test/acc_unbiased': 52.171, 'best_test_test/diff': 2.742, 'best_test_test/acc_skew': 50.799, 'best_test_test/acc_align': 53.542}
[9 / 20] Learning rate: 0.0001 weight: 0.01
[9 / 20] Loss: 2.889390959359268 CE Loss: 2.7885778935184087 Con Loss: 2.8615051866714163
[9 / 20] tensor([[0.849, 0.793],
        [0.232, 0.404]]) {'epoch': 9, 'valid/acc': 58.987, 'valid/acc_unbiased': 56.892, 'valid/diff': 7.482, 'valid/acc_skew': 53.151, 'valid/acc_align': 60.633, 'test/acc': 58.65, 'test/acc_unbiased': 56.961, 'test/diff': 11.441, 'test/acc_skew': 51.24, 'test/acc_align': 62.681}
[9 / 20] best valid accuracy: 56.892 at epoch 9 
 best_stats: {'best_valid_epoch': 9, 'best_valid_valid/acc': 58.987, 'best_valid_valid/acc_unbiased': 56.892, 'best_valid_valid/diff': 7.482, 'best_valid_valid/acc_skew': 53.151, 'best_valid_valid/acc_align': 60.633, 'best_valid_test/acc': 58.65, 'best_valid_test/acc_unbiased': 56.961, 'best_valid_test/diff': 11.441, 'best_valid_test/acc_skew': 51.24, 'best_valid_test/acc_align': 62.681}
[9 / 20] best test accuracy: 56.961 at epoch 9 
 best_stats: {'best_test_epoch': 9, 'best_test_valid/acc': 58.987, 'best_test_valid/acc_unbiased': 56.892, 'best_test_valid/diff': 7.482, 'best_test_valid/acc_skew': 53.151, 'best_test_valid/acc_align': 60.633, 'best_test_test/acc': 58.65, 'best_test_test/acc_unbiased': 56.961, 'best_test_test/diff': 11.441, 'best_test_test/acc_skew': 51.24, 'best_test_test/acc_align': 62.681}
[10 / 20] Learning rate: 0.0001 weight: 0.01
[10 / 20] Loss: 2.7703853559446165 CE Loss: 2.769835707486962 Con Loss: 2.7426870004411805
[10 / 20] tensor([[0.962, 0.945],
        [0.071, 0.107]]) {'epoch': 10, 'valid/acc': 55.105, 'valid/acc_unbiased': 51.916, 'valid/diff': 3.624, 'valid/acc_skew': 50.104, 'valid/acc_align': 53.728, 'test/acc': 54.093, 'test/acc_unbiased': 52.153, 'test/diff': 2.629, 'test/acc_skew': 50.839, 'test/acc_align': 53.467}
[10 / 20] best valid accuracy: 56.892 at epoch 9 
 best_stats: {'best_valid_epoch': 9, 'best_valid_valid/acc': 58.987, 'best_valid_valid/acc_unbiased': 56.892, 'best_valid_valid/diff': 7.482, 'best_valid_valid/acc_skew': 53.151, 'best_valid_valid/acc_align': 60.633, 'best_valid_test/acc': 58.65, 'best_valid_test/acc_unbiased': 56.961, 'best_valid_test/diff': 11.441, 'best_valid_test/acc_skew': 51.24, 'best_valid_test/acc_align': 62.681}
[10 / 20] best test accuracy: 56.961 at epoch 9 
 best_stats: {'best_test_epoch': 9, 'best_test_valid/acc': 58.987, 'best_test_valid/acc_unbiased': 56.892, 'best_test_valid/diff': 7.482, 'best_test_valid/acc_skew': 53.151, 'best_test_valid/acc_align': 60.633, 'best_test_test/acc': 58.65, 'best_test_test/acc_unbiased': 56.961, 'best_test_test/diff': 11.441, 'best_test_test/acc_skew': 51.24, 'best_test_test/acc_align': 62.681}
[11 / 20] Learning rate: 0.0001 weight: 0.01
[11 / 20] Loss: 2.938332283742094 CE Loss: 2.7778529260245866 Con Loss: 2.9105537444218523
[11 / 20] tensor([[0.935, 0.916],
        [0.121, 0.192]]) {'epoch': 11, 'valid/acc': 56.076, 'valid/acc_unbiased': 53.021, 'valid/diff': 6.719, 'valid/acc_skew': 49.662, 'valid/acc_align': 56.38, 'test/acc': 55.992, 'test/acc_unbiased': 54.105, 'test/diff': 4.507, 'test/acc_skew': 51.851, 'test/acc_align': 56.358}
[11 / 20] best valid accuracy: 56.892 at epoch 9 
 best_stats: {'best_valid_epoch': 9, 'best_valid_valid/acc': 58.987, 'best_valid_valid/acc_unbiased': 56.892, 'best_valid_valid/diff': 7.482, 'best_valid_valid/acc_skew': 53.151, 'best_valid_valid/acc_align': 60.633, 'best_valid_test/acc': 58.65, 'best_valid_test/acc_unbiased': 56.961, 'best_valid_test/diff': 11.441, 'best_valid_test/acc_skew': 51.24, 'best_valid_test/acc_align': 62.681}
[11 / 20] best test accuracy: 56.961 at epoch 9 
 best_stats: {'best_test_epoch': 9, 'best_test_valid/acc': 58.987, 'best_test_valid/acc_unbiased': 56.892, 'best_test_valid/diff': 7.482, 'best_test_valid/acc_skew': 53.151, 'best_test_valid/acc_align': 60.633, 'best_test_test/acc': 58.65, 'best_test_test/acc_unbiased': 56.961, 'best_test_test/diff': 11.441, 'best_test_test/acc_skew': 51.24, 'best_test_test/acc_align': 62.681}
[12 / 20] Learning rate: 0.0001 weight: 0.01
[12 / 20] Loss: 2.7782848223931693 CE Loss: 2.7764353345281445 Con Loss: 2.7505204715144975
[12 / 20] tensor([[0.934, 0.913],
        [0.115, 0.210]]) {'epoch': 12, 'valid/acc': 57.173, 'valid/acc_unbiased': 54.226, 'valid/diff': 5.48, 'valid/acc_skew': 51.486, 'valid/acc_align': 56.966, 'test/acc': 56.245, 'test/acc_unbiased': 54.269, 'test/diff': 5.782, 'test/acc_skew': 51.378, 'test/acc_align': 57.16}
[12 / 20] best valid accuracy: 56.892 at epoch 9 
 best_stats: {'best_valid_epoch': 9, 'best_valid_valid/acc': 58.987, 'best_valid_valid/acc_unbiased': 56.892, 'best_valid_valid/diff': 7.482, 'best_valid_valid/acc_skew': 53.151, 'best_valid_valid/acc_align': 60.633, 'best_valid_test/acc': 58.65, 'best_valid_test/acc_unbiased': 56.961, 'best_valid_test/diff': 11.441, 'best_valid_test/acc_skew': 51.24, 'best_valid_test/acc_align': 62.681}
[12 / 20] best test accuracy: 56.961 at epoch 9 
 best_stats: {'best_test_epoch': 9, 'best_test_valid/acc': 58.987, 'best_test_valid/acc_unbiased': 56.892, 'best_test_valid/diff': 7.482, 'best_test_valid/acc_skew': 53.151, 'best_test_valid/acc_align': 60.633, 'best_test_test/acc': 58.65, 'best_test_test/acc_unbiased': 56.961, 'best_test_test/diff': 11.441, 'best_test_test/acc_skew': 51.24, 'best_test_test/acc_align': 62.681}
[13 / 20] Learning rate: 0.0001 weight: 0.01
[13 / 20] Loss: 2.847376370126343 CE Loss: 2.769190573106145 Con Loss: 2.819684487135639
[13 / 20] tensor([[0.785, 0.716],
        [0.370, 0.452]]) {'epoch': 13, 'valid/acc': 59.198, 'valid/acc_unbiased': 57.728, 'valid/diff': 4.644, 'valid/acc_skew': 55.406, 'valid/acc_align': 60.05, 'test/acc': 58.987, 'test/acc_unbiased': 58.08, 'test/diff': 7.506, 'test/acc_skew': 54.326, 'test/acc_align': 61.833}
[13 / 20] best valid accuracy: 57.728 at epoch 13 
 best_stats: {'best_valid_epoch': 13, 'best_valid_valid/acc': 59.198, 'best_valid_valid/acc_unbiased': 57.728, 'best_valid_valid/diff': 4.644, 'best_valid_valid/acc_skew': 55.406, 'best_valid_valid/acc_align': 60.05, 'best_valid_test/acc': 58.987, 'best_valid_test/acc_unbiased': 58.08, 'best_valid_test/diff': 7.506, 'best_valid_test/acc_skew': 54.326, 'best_valid_test/acc_align': 61.833}
[13 / 20] best test accuracy: 58.080 at epoch 13 
 best_stats: {'best_test_epoch': 13, 'best_test_valid/acc': 59.198, 'best_test_valid/acc_unbiased': 57.728, 'best_test_valid/diff': 4.644, 'best_test_valid/acc_skew': 55.406, 'best_test_valid/acc_align': 60.05, 'best_test_test/acc': 58.987, 'best_test_test/acc_unbiased': 58.08, 'best_test_test/diff': 7.506, 'best_test_test/acc_skew': 54.326, 'best_test_test/acc_align': 61.833}
[14 / 20] Learning rate: 1e-05 weight: 0.01
[14 / 20] Loss: 2.844690973903447 CE Loss: 2.760855056554064 Con Loss: 2.8170824049946295
[14 / 20] tensor([[0.082, 0.108],
        [0.935, 0.906]]) {'epoch': 14, 'valid/acc': 47.468, 'valid/acc_unbiased': 50.525, 'valid/diff': 4.078, 'valid/acc_skew': 52.564, 'valid/acc_align': 48.485, 'test/acc': 48.987, 'test/acc_unbiased': 50.793, 'test/diff': 2.703, 'test/acc_skew': 52.145, 'test/acc_align': 49.441}
[14 / 20] best valid accuracy: 57.728 at epoch 13 
 best_stats: {'best_valid_epoch': 13, 'best_valid_valid/acc': 59.198, 'best_valid_valid/acc_unbiased': 57.728, 'best_valid_valid/diff': 4.644, 'best_valid_valid/acc_skew': 55.406, 'best_valid_valid/acc_align': 60.05, 'best_valid_test/acc': 58.987, 'best_valid_test/acc_unbiased': 58.08, 'best_valid_test/diff': 7.506, 'best_valid_test/acc_skew': 54.326, 'best_valid_test/acc_align': 61.833}
[14 / 20] best test accuracy: 58.080 at epoch 13 
 best_stats: {'best_test_epoch': 13, 'best_test_valid/acc': 59.198, 'best_test_valid/acc_unbiased': 57.728, 'best_test_valid/diff': 4.644, 'best_test_valid/acc_skew': 55.406, 'best_test_valid/acc_align': 60.05, 'best_test_test/acc': 58.987, 'best_test_test/acc_unbiased': 58.08, 'best_test_test/diff': 7.506, 'best_test_test/acc_skew': 54.326, 'best_test_test/acc_align': 61.833}
[15 / 20] Learning rate: 1e-05 weight: 0.01
[15 / 20] Loss: 2.762993320255978 CE Loss: 2.7618756836404526 Con Loss: 2.735374583039999
[15 / 20] tensor([[0.703, 0.610],
        [0.500, 0.599]]) {'epoch': 15, 'valid/acc': 59.662, 'valid/acc_unbiased': 59.134, 'valid/diff': 4.929, 'valid/acc_skew': 56.669, 'valid/acc_align': 61.598, 'test/acc': 60.717, 'test/acc_unbiased': 60.284, 'test/diff': 9.564, 'test/acc_skew': 55.502, 'test/acc_align': 65.066}
[15 / 20] best valid accuracy: 59.134 at epoch 15 
 best_stats: {'best_valid_epoch': 15, 'best_valid_valid/acc': 59.662, 'best_valid_valid/acc_unbiased': 59.134, 'best_valid_valid/diff': 4.929, 'best_valid_valid/acc_skew': 56.669, 'best_valid_valid/acc_align': 61.598, 'best_valid_test/acc': 60.717, 'best_valid_test/acc_unbiased': 60.284, 'best_valid_test/diff': 9.564, 'best_valid_test/acc_skew': 55.502, 'best_valid_test/acc_align': 65.066}
[15 / 20] best test accuracy: 60.284 at epoch 15 
 best_stats: {'best_test_epoch': 15, 'best_test_valid/acc': 59.662, 'best_test_valid/acc_unbiased': 59.134, 'best_test_valid/diff': 4.929, 'best_test_valid/acc_skew': 56.669, 'best_test_valid/acc_align': 61.598, 'best_test_test/acc': 60.717, 'best_test_test/acc_unbiased': 60.284, 'best_test_test/diff': 9.564, 'best_test_test/acc_skew': 55.502, 'best_test_test/acc_align': 65.066}
[16 / 20] Learning rate: 1e-05 weight: 0.01
[16 / 20] Loss: 2.710405920584239 CE Loss: 2.7593669203257236 Con Loss: 2.6828122559589054
[16 / 20] tensor([[0.776, 0.697],
        [0.379, 0.492]]) {'epoch': 16, 'valid/acc': 60.0, 'valid/acc_unbiased': 58.738, 'valid/diff': 4.042, 'valid/acc_skew': 56.717, 'valid/acc_align': 60.759, 'test/acc': 59.536, 'test/acc_unbiased': 58.595, 'test/diff': 9.592, 'test/acc_skew': 53.799, 'test/acc_align': 63.391}
[16 / 20] best valid accuracy: 59.134 at epoch 15 
 best_stats: {'best_valid_epoch': 15, 'best_valid_valid/acc': 59.662, 'best_valid_valid/acc_unbiased': 59.134, 'best_valid_valid/diff': 4.929, 'best_valid_valid/acc_skew': 56.669, 'best_valid_valid/acc_align': 61.598, 'best_valid_test/acc': 60.717, 'best_valid_test/acc_unbiased': 60.284, 'best_valid_test/diff': 9.564, 'best_valid_test/acc_skew': 55.502, 'best_valid_test/acc_align': 65.066}
[16 / 20] best test accuracy: 60.284 at epoch 15 
 best_stats: {'best_test_epoch': 15, 'best_test_valid/acc': 59.662, 'best_test_valid/acc_unbiased': 59.134, 'best_test_valid/diff': 4.929, 'best_test_valid/acc_skew': 56.669, 'best_test_valid/acc_align': 61.598, 'best_test_test/acc': 60.717, 'best_test_test/acc_unbiased': 60.284, 'best_test_test/diff': 9.564, 'best_test_test/acc_skew': 55.502, 'best_test_test/acc_align': 65.066}
[17 / 20] Learning rate: 1e-05 weight: 0.01
[17 / 20] Loss: 3.04597102178142 CE Loss: 2.762119933270475 Con Loss: 3.018349823518668
[17 / 20] tensor([[0.738, 0.651],
        [0.444, 0.530]]) {'epoch': 17, 'valid/acc': 59.705, 'valid/acc_unbiased': 58.66, 'valid/diff': 4.332, 'valid/acc_skew': 56.494, 'valid/acc_align': 60.826, 'test/acc': 59.705, 'test/acc_unbiased': 59.098, 'test/diff': 8.684, 'test/acc_skew': 54.756, 'test/acc_align': 63.441}
[17 / 20] best valid accuracy: 59.134 at epoch 15 
 best_stats: {'best_valid_epoch': 15, 'best_valid_valid/acc': 59.662, 'best_valid_valid/acc_unbiased': 59.134, 'best_valid_valid/diff': 4.929, 'best_valid_valid/acc_skew': 56.669, 'best_valid_valid/acc_align': 61.598, 'best_valid_test/acc': 60.717, 'best_valid_test/acc_unbiased': 60.284, 'best_valid_test/diff': 9.564, 'best_valid_test/acc_skew': 55.502, 'best_valid_test/acc_align': 65.066}
[17 / 20] best test accuracy: 60.284 at epoch 15 
 best_stats: {'best_test_epoch': 15, 'best_test_valid/acc': 59.662, 'best_test_valid/acc_unbiased': 59.134, 'best_test_valid/diff': 4.929, 'best_test_valid/acc_skew': 56.669, 'best_test_valid/acc_align': 61.598, 'best_test_test/acc': 60.717, 'best_test_test/acc_unbiased': 60.284, 'best_test_test/diff': 9.564, 'best_test_test/acc_skew': 55.502, 'best_test_test/acc_align': 65.066}
[18 / 20] Learning rate: 1e-05 weight: 0.01
[18 / 20] Loss: 3.084902661922166 CE Loss: 2.760170032926618 Con Loss: 3.0573009695291398
[18 / 20] tensor([[0.880, 0.827],
        [0.232, 0.328]]) {'epoch': 18, 'valid/acc': 58.565, 'valid/acc_unbiased': 56.315, 'valid/diff': 4.934, 'valid/acc_skew': 53.848, 'valid/acc_align': 58.782, 'test/acc': 58.186, 'test/acc_unbiased': 56.677, 'test/diff': 7.476, 'test/acc_skew': 52.939, 'test/acc_align': 60.415}
[18 / 20] best valid accuracy: 59.134 at epoch 15 
 best_stats: {'best_valid_epoch': 15, 'best_valid_valid/acc': 59.662, 'best_valid_valid/acc_unbiased': 59.134, 'best_valid_valid/diff': 4.929, 'best_valid_valid/acc_skew': 56.669, 'best_valid_valid/acc_align': 61.598, 'best_valid_test/acc': 60.717, 'best_valid_test/acc_unbiased': 60.284, 'best_valid_test/diff': 9.564, 'best_valid_test/acc_skew': 55.502, 'best_valid_test/acc_align': 65.066}
[18 / 20] best test accuracy: 60.284 at epoch 15 
 best_stats: {'best_test_epoch': 15, 'best_test_valid/acc': 59.662, 'best_test_valid/acc_unbiased': 59.134, 'best_test_valid/diff': 4.929, 'best_test_valid/acc_skew': 56.669, 'best_test_valid/acc_align': 61.598, 'best_test_test/acc': 60.717, 'best_test_test/acc_unbiased': 60.284, 'best_test_test/diff': 9.564, 'best_test_test/acc_skew': 55.502, 'best_test_test/acc_align': 65.066}
[19 / 20] Learning rate: 1e-05 weight: 0.01
[19 / 20] Loss: 2.8667410252265335 CE Loss: 2.753175627868258 Con Loss: 2.8392092539925584
[19 / 20] tensor([[0.882, 0.842],
        [0.234, 0.328]]) {'epoch': 19, 'valid/acc': 58.734, 'valid/acc_unbiased': 56.489, 'valid/diff': 4.552, 'valid/acc_skew': 54.213, 'valid/acc_align': 58.765, 'test/acc': 58.692, 'test/acc_unbiased': 57.145, 'test/diff': 6.719, 'test/acc_skew': 53.786, 'test/acc_align': 60.505}
[19 / 20] best valid accuracy: 59.134 at epoch 15 
 best_stats: {'best_valid_epoch': 15, 'best_valid_valid/acc': 59.662, 'best_valid_valid/acc_unbiased': 59.134, 'best_valid_valid/diff': 4.929, 'best_valid_valid/acc_skew': 56.669, 'best_valid_valid/acc_align': 61.598, 'best_valid_test/acc': 60.717, 'best_valid_test/acc_unbiased': 60.284, 'best_valid_test/diff': 9.564, 'best_valid_test/acc_skew': 55.502, 'best_valid_test/acc_align': 65.066}
[19 / 20] best test accuracy: 60.284 at epoch 15 
 best_stats: {'best_test_epoch': 15, 'best_test_valid/acc': 59.662, 'best_test_valid/acc_unbiased': 59.134, 'best_test_valid/diff': 4.929, 'best_test_valid/acc_skew': 56.669, 'best_test_valid/acc_align': 61.598, 'best_test_test/acc': 60.717, 'best_test_test/acc_unbiased': 60.284, 'best_test_test/diff': 9.564, 'best_test_test/acc_skew': 55.502, 'best_test_test/acc_align': 65.066}
[20 / 20] Learning rate: 1e-05 weight: 0.01
[20 / 20] Loss: 2.9225176828205437 CE Loss: 2.753681571843692 Con Loss: 2.8949808703555093
[20 / 20] tensor([[0.873, 0.832],
        [0.251, 0.355]]) {'epoch': 20, 'valid/acc': 58.819, 'valid/acc_unbiased': 56.629, 'valid/diff': 4.979, 'valid/acc_skew': 54.139, 'valid/acc_align': 59.119, 'test/acc': 59.283, 'test/acc_unbiased': 57.764, 'test/diff': 7.26, 'test/acc_skew': 54.135, 'test/acc_align': 61.394}
[20 / 20] best valid accuracy: 59.134 at epoch 15 
 best_stats: {'best_valid_epoch': 15, 'best_valid_valid/acc': 59.662, 'best_valid_valid/acc_unbiased': 59.134, 'best_valid_valid/diff': 4.929, 'best_valid_valid/acc_skew': 56.669, 'best_valid_valid/acc_align': 61.598, 'best_valid_test/acc': 60.717, 'best_valid_test/acc_unbiased': 60.284, 'best_valid_test/diff': 9.564, 'best_valid_test/acc_skew': 55.502, 'best_valid_test/acc_align': 65.066}
[20 / 20] best test accuracy: 60.284 at epoch 15 
 best_stats: {'best_test_epoch': 15, 'best_test_valid/acc': 59.662, 'best_test_valid/acc_unbiased': 59.134, 'best_test_valid/diff': 4.929, 'best_test_valid/acc_skew': 56.669, 'best_test_valid/acc_align': 61.598, 'best_test_test/acc': 60.717, 'best_test_test/acc_unbiased': 60.284, 'best_test_test/diff': 9.564, 'best_test_test/acc_skew': 55.502, 'best_test_test/acc_align': 65.066}
Total training time: 1:06:24
