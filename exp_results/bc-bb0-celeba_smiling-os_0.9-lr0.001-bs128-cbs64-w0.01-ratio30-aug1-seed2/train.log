Log level set to: INFO
Set seed: 2
=======> Using Fixed Random Seed: 2 <========
save_path: exp_results/bc-bb0-celeba_smiling-os_0.9-lr0.001-bs128-cbs64-w0.01-ratio30-aug1-seed2
get_celeba - split:train, aug: False, given_y: True, ratio: 0
use existing smiling indices from data/celeba/pickles/smiling
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [36549, 36549]
Target 1: [36549, 36549]
Binary Target 1
---------------------------
Target 0: [36549, 36549]
Target 1: [36549, 36549]
===================================
Normal Label Distribution: 
Target 0: [36549, 36549]
Target 1: [36549, 36549]
===================================
Use BiasedCelebASplit 
 target_attr: smiling split: train 
 tensor([[36549., 36549.],
        [36549., 36549.]])
get_celeba - split:train, aug: 1, given_y: True, ratio: 30
use existing smiling indices from data/celeba/pickles/smiling
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [36692, 36692]
Target 1: [36692, 36692]
Binary Target 1
---------------------------
Target 0: [36692, 36692]
Target 1: [36692, 36692]
===================================
Normal Label Distribution: 
Target 0: [36692, 36692]
Target 1: [36692, 36692]
===================================
Use BiasedCelebASplit 
 target_attr: smiling split: train 
 tensor([[36692., 36692.],
        [36692., 36692.]])
get_celeba - split:train_valid, aug: False, given_y: True, ratio: 0
use existing smiling indices from data/celeba/pickles/smiling
Use BiasedCelebASplit 
 target_attr: smiling split: train_valid 
 tensor([[ 1973., 10114.],
        [ 8289.,  1989.]])
get_celeba - split:valid, aug: False, given_y: True, ratio: 0
Use BiasedCelebASplit 
 target_attr: smiling split: valid 
 tensor([[5252., 6157.],
        [5013., 3445.]])
decay_epochs: [3, 6]
[1 / 10] Learning rate: 0.001 weight: 0.01
[1 / 10] Loss: 4.630307374181505 CE Loss: 0.25118385358281936 Con Loss: 4.627795534573057
[1 / 10] tensor([[0.924, 0.894],
        [0.923, 0.922]]) {'epoch': 1, 'valid/acc': 91.509, 'valid/acc_unbiased': 91.827, 'valid/diff': 1.302, 'valid/acc_skew': 92.463, 'valid/acc_align': 91.192, 'test/acc': 91.579, 'test/acc_unbiased': 91.579, 'test/diff': 1.51, 'test/acc_skew': 92.335, 'test/acc_align': 90.824}
[1 / 10] best valid accuracy: 91.827 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 91.509, 'best_valid_valid/acc_unbiased': 91.827, 'best_valid_valid/diff': 1.302, 'best_valid_valid/acc_skew': 92.463, 'best_valid_valid/acc_align': 91.192, 'best_valid_test/acc': 91.579, 'best_valid_test/acc_unbiased': 91.579, 'best_valid_test/diff': 1.51, 'best_valid_test/acc_skew': 92.335, 'best_valid_test/acc_align': 90.824}
[1 / 10] best test accuracy: 91.579 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 91.509, 'best_test_valid/acc_unbiased': 91.827, 'best_test_valid/diff': 1.302, 'best_test_valid/acc_skew': 92.463, 'best_test_valid/acc_align': 91.192, 'best_test_test/acc': 91.579, 'best_test_test/acc_unbiased': 91.579, 'best_test_test/diff': 1.51, 'best_test_test/acc_skew': 92.335, 'best_test_test/acc_align': 90.824}
[2 / 10] Learning rate: 0.001 weight: 0.01
[2 / 10] Loss: 4.595976186831277 CE Loss: 0.22755368867322695 Con Loss: 4.593700641998531
[2 / 10] tensor([[0.964, 0.948],
        [0.878, 0.857]]) {'epoch': 2, 'valid/acc': 91.066, 'valid/acc_unbiased': 91.252, 'valid/diff': 1.427, 'valid/acc_skew': 91.965, 'valid/acc_align': 90.538, 'test/acc': 91.453, 'test/acc_unbiased': 91.157, 'test/diff': 1.822, 'test/acc_skew': 92.068, 'test/acc_align': 90.246}
[2 / 10] best valid accuracy: 91.827 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 91.509, 'best_valid_valid/acc_unbiased': 91.827, 'best_valid_valid/diff': 1.302, 'best_valid_valid/acc_skew': 92.463, 'best_valid_valid/acc_align': 91.192, 'best_valid_test/acc': 91.579, 'best_valid_test/acc_unbiased': 91.579, 'best_valid_test/diff': 1.51, 'best_valid_test/acc_skew': 92.335, 'best_valid_test/acc_align': 90.824}
[2 / 10] best test accuracy: 91.579 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 91.509, 'best_test_valid/acc_unbiased': 91.827, 'best_test_valid/diff': 1.302, 'best_test_valid/acc_skew': 92.463, 'best_test_valid/acc_align': 91.192, 'best_test_test/acc': 91.579, 'best_test_test/acc_unbiased': 91.579, 'best_test_test/diff': 1.51, 'best_test_test/acc_skew': 92.335, 'best_test_test/acc_align': 90.824}
[3 / 10] Learning rate: 0.001 weight: 0.01
[3 / 10] Loss: 4.582998624594613 CE Loss: 0.22010492650762087 Con Loss: 4.580797569634777
[3 / 10] tensor([[0.909, 0.902],
        [0.939, 0.918]]) {'epoch': 3, 'valid/acc': 92.166, 'valid/acc_unbiased': 91.861, 'valid/diff': 1.16, 'valid/acc_skew': 92.441, 'valid/acc_align': 91.281, 'test/acc': 91.821, 'test/acc_unbiased': 91.712, 'test/diff': 1.405, 'test/acc_skew': 92.415, 'test/acc_align': 91.01}
[3 / 10] best valid accuracy: 91.861 at epoch 3 
 best_stats: {'best_valid_epoch': 3, 'best_valid_valid/acc': 92.166, 'best_valid_valid/acc_unbiased': 91.861, 'best_valid_valid/diff': 1.16, 'best_valid_valid/acc_skew': 92.441, 'best_valid_valid/acc_align': 91.281, 'best_valid_test/acc': 91.821, 'best_valid_test/acc_unbiased': 91.712, 'best_valid_test/diff': 1.405, 'best_valid_test/acc_skew': 92.415, 'best_valid_test/acc_align': 91.01}
[3 / 10] best test accuracy: 91.712 at epoch 3 
 best_stats: {'best_test_epoch': 3, 'best_test_valid/acc': 92.166, 'best_test_valid/acc_unbiased': 91.861, 'best_test_valid/diff': 1.16, 'best_test_valid/acc_skew': 92.441, 'best_test_valid/acc_align': 91.281, 'best_test_test/acc': 91.821, 'best_test_test/acc_unbiased': 91.712, 'best_test_test/diff': 1.405, 'best_test_test/acc_skew': 92.415, 'best_test_test/acc_align': 91.01}
[4 / 10] Learning rate: 0.0001 weight: 0.01
[4 / 10] Loss: 4.543222067062498 CE Loss: 0.1948895748295847 Con Loss: 4.541273173504663
[4 / 10] tensor([[0.936, 0.922],
        [0.925, 0.911]]) {'epoch': 4, 'valid/acc': 92.689, 'valid/acc_unbiased': 92.686, 'valid/diff': 1.167, 'valid/acc_skew': 93.27, 'valid/acc_align': 92.103, 'test/acc': 92.47, 'test/acc_unbiased': 92.345, 'test/diff': 1.41, 'test/acc_skew': 93.049, 'test/acc_align': 91.64}
[4 / 10] best valid accuracy: 92.686 at epoch 4 
 best_stats: {'best_valid_epoch': 4, 'best_valid_valid/acc': 92.689, 'best_valid_valid/acc_unbiased': 92.686, 'best_valid_valid/diff': 1.167, 'best_valid_valid/acc_skew': 93.27, 'best_valid_valid/acc_align': 92.103, 'best_valid_test/acc': 92.47, 'best_valid_test/acc_unbiased': 92.345, 'best_valid_test/diff': 1.41, 'best_valid_test/acc_skew': 93.049, 'best_valid_test/acc_align': 91.64}
[4 / 10] best test accuracy: 92.345 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 92.689, 'best_test_valid/acc_unbiased': 92.686, 'best_test_valid/diff': 1.167, 'best_test_valid/acc_skew': 93.27, 'best_test_valid/acc_align': 92.103, 'best_test_test/acc': 92.47, 'best_test_test/acc_unbiased': 92.345, 'best_test_test/diff': 1.41, 'best_test_test/acc_skew': 93.049, 'best_test_test/acc_align': 91.64}
[5 / 10] Learning rate: 0.0001 weight: 0.01
[5 / 10] Loss: 4.532487369150551 CE Loss: 0.1893281844178317 Con Loss: 4.530594085224311
[5 / 10] tensor([[0.929, 0.924],
        [0.934, 0.914]]) {'epoch': 5, 'valid/acc': 93.163, 'valid/acc_unbiased': 92.815, 'valid/diff': 1.365, 'valid/acc_skew': 93.497, 'valid/acc_align': 92.132, 'test/acc': 92.681, 'test/acc_unbiased': 92.539, 'test/diff': 1.23, 'test/acc_skew': 93.153, 'test/acc_align': 91.924}
[5 / 10] best valid accuracy: 92.815 at epoch 5 
 best_stats: {'best_valid_epoch': 5, 'best_valid_valid/acc': 93.163, 'best_valid_valid/acc_unbiased': 92.815, 'best_valid_valid/diff': 1.365, 'best_valid_valid/acc_skew': 93.497, 'best_valid_valid/acc_align': 92.132, 'best_valid_test/acc': 92.681, 'best_valid_test/acc_unbiased': 92.539, 'best_valid_test/diff': 1.23, 'best_valid_test/acc_skew': 93.153, 'best_valid_test/acc_align': 91.924}
[5 / 10] best test accuracy: 92.539 at epoch 5 
 best_stats: {'best_test_epoch': 5, 'best_test_valid/acc': 93.163, 'best_test_valid/acc_unbiased': 92.815, 'best_test_valid/diff': 1.365, 'best_test_valid/acc_skew': 93.497, 'best_test_valid/acc_align': 92.132, 'best_test_test/acc': 92.681, 'best_test_test/acc_unbiased': 92.539, 'best_test_test/diff': 1.23, 'best_test_test/acc_skew': 93.153, 'best_test_test/acc_align': 91.924}
[6 / 10] Learning rate: 0.0001 weight: 0.01
[6 / 10] Loss: 4.525624462425042 CE Loss: 0.1861431891370098 Con Loss: 4.523763027956732
[6 / 10] tensor([[0.936, 0.935],
        [0.927, 0.907]]) {'epoch': 6, 'valid/acc': 93.078, 'valid/acc_unbiased': 92.935, 'valid/diff': 1.326, 'valid/acc_skew': 93.598, 'valid/acc_align': 92.272, 'test/acc': 92.797, 'test/acc_unbiased': 92.623, 'test/diff': 1.096, 'test/acc_skew': 93.171, 'test/acc_align': 92.075}
[6 / 10] best valid accuracy: 92.935 at epoch 6 
 best_stats: {'best_valid_epoch': 6, 'best_valid_valid/acc': 93.078, 'best_valid_valid/acc_unbiased': 92.935, 'best_valid_valid/diff': 1.326, 'best_valid_valid/acc_skew': 93.598, 'best_valid_valid/acc_align': 92.272, 'best_valid_test/acc': 92.797, 'best_valid_test/acc_unbiased': 92.623, 'best_valid_test/diff': 1.096, 'best_valid_test/acc_skew': 93.171, 'best_valid_test/acc_align': 92.075}
[6 / 10] best test accuracy: 92.623 at epoch 6 
 best_stats: {'best_test_epoch': 6, 'best_test_valid/acc': 93.078, 'best_test_valid/acc_unbiased': 92.935, 'best_test_valid/diff': 1.326, 'best_test_valid/acc_skew': 93.598, 'best_test_valid/acc_align': 92.272, 'best_test_test/acc': 92.797, 'best_test_test/acc_unbiased': 92.623, 'best_test_test/diff': 1.096, 'best_test_test/acc_skew': 93.171, 'best_test_test/acc_align': 92.075}
[7 / 10] Learning rate: 1e-05 weight: 0.01
[7 / 10] Loss: 4.518391085843902 CE Loss: 0.18124718542259097 Con Loss: 4.5165786114061
[7 / 10] tensor([[0.940, 0.932],
        [0.926, 0.913]]) {'epoch': 7, 'valid/acc': 93.119, 'valid/acc_unbiased': 93.144, 'valid/diff': 1.486, 'valid/acc_skew': 93.887, 'valid/acc_align': 92.401, 'test/acc': 92.888, 'test/acc_unbiased': 92.766, 'test/diff': 1.063, 'test/acc_skew': 93.298, 'test/acc_align': 92.235}
[7 / 10] best valid accuracy: 93.144 at epoch 7 
 best_stats: {'best_valid_epoch': 7, 'best_valid_valid/acc': 93.119, 'best_valid_valid/acc_unbiased': 93.144, 'best_valid_valid/diff': 1.486, 'best_valid_valid/acc_skew': 93.887, 'best_valid_valid/acc_align': 92.401, 'best_valid_test/acc': 92.888, 'best_valid_test/acc_unbiased': 92.766, 'best_valid_test/diff': 1.063, 'best_valid_test/acc_skew': 93.298, 'best_valid_test/acc_align': 92.235}
[7 / 10] best test accuracy: 92.766 at epoch 7 
 best_stats: {'best_test_epoch': 7, 'best_test_valid/acc': 93.119, 'best_test_valid/acc_unbiased': 93.144, 'best_test_valid/diff': 1.486, 'best_test_valid/acc_skew': 93.887, 'best_test_valid/acc_align': 92.401, 'best_test_test/acc': 92.888, 'best_test_test/acc_unbiased': 92.766, 'best_test_test/diff': 1.063, 'best_test_test/acc_skew': 93.298, 'best_test_test/acc_align': 92.235}
[8 / 10] Learning rate: 1e-05 weight: 0.01
[8 / 10] Loss: 4.515584506924337 CE Loss: 0.18050231202065337 Con Loss: 4.513779486066199
[8 / 10] tensor([[0.947, 0.935],
        [0.921, 0.904]]) {'epoch': 8, 'valid/acc': 92.967, 'valid/acc_unbiased': 93.051, 'valid/diff': 1.507, 'valid/acc_skew': 93.804, 'valid/acc_align': 92.297, 'test/acc': 92.847, 'test/acc_unbiased': 92.672, 'test/diff': 1.464, 'test/acc_skew': 93.404, 'test/acc_align': 91.94}
[8 / 10] best valid accuracy: 93.144 at epoch 7 
 best_stats: {'best_valid_epoch': 7, 'best_valid_valid/acc': 93.119, 'best_valid_valid/acc_unbiased': 93.144, 'best_valid_valid/diff': 1.486, 'best_valid_valid/acc_skew': 93.887, 'best_valid_valid/acc_align': 92.401, 'best_valid_test/acc': 92.888, 'best_valid_test/acc_unbiased': 92.766, 'best_valid_test/diff': 1.063, 'best_valid_test/acc_skew': 93.298, 'best_valid_test/acc_align': 92.235}
[8 / 10] best test accuracy: 92.766 at epoch 7 
 best_stats: {'best_test_epoch': 7, 'best_test_valid/acc': 93.119, 'best_test_valid/acc_unbiased': 93.144, 'best_test_valid/diff': 1.486, 'best_test_valid/acc_skew': 93.887, 'best_test_valid/acc_align': 92.401, 'best_test_test/acc': 92.888, 'best_test_test/acc_unbiased': 92.766, 'best_test_test/diff': 1.063, 'best_test_test/acc_skew': 93.298, 'best_test_test/acc_align': 92.235}
[9 / 10] Learning rate: 1e-05 weight: 0.01
[9 / 10] Loss: 4.517148991492696 CE Loss: 0.18022665269883859 Con Loss: 4.515346723710624
[9 / 10] tensor([[0.940, 0.928],
        [0.930, 0.912]]) {'epoch': 9, 'valid/acc': 93.15, 'valid/acc_unbiased': 93.104, 'valid/diff': 1.271, 'valid/acc_skew': 93.739, 'valid/acc_align': 92.468, 'test/acc': 92.888, 'test/acc_unbiased': 92.737, 'test/diff': 1.499, 'test/acc_skew': 93.486, 'test/acc_align': 91.987}
[9 / 10] best valid accuracy: 93.144 at epoch 7 
 best_stats: {'best_valid_epoch': 7, 'best_valid_valid/acc': 93.119, 'best_valid_valid/acc_unbiased': 93.144, 'best_valid_valid/diff': 1.486, 'best_valid_valid/acc_skew': 93.887, 'best_valid_valid/acc_align': 92.401, 'best_valid_test/acc': 92.888, 'best_valid_test/acc_unbiased': 92.766, 'best_valid_test/diff': 1.063, 'best_valid_test/acc_skew': 93.298, 'best_valid_test/acc_align': 92.235}
[9 / 10] best test accuracy: 92.766 at epoch 7 
 best_stats: {'best_test_epoch': 7, 'best_test_valid/acc': 93.119, 'best_test_valid/acc_unbiased': 93.144, 'best_test_valid/diff': 1.486, 'best_test_valid/acc_skew': 93.887, 'best_test_valid/acc_align': 92.401, 'best_test_test/acc': 92.888, 'best_test_test/acc_unbiased': 92.766, 'best_test_test/diff': 1.063, 'best_test_test/acc_skew': 93.298, 'best_test_test/acc_align': 92.235}
[10 / 10] Learning rate: 1e-05 weight: 0.01
[10 / 10] Loss: 4.511349344296594 CE Loss: 0.18032738409636562 Con Loss: 4.509546066674949
[10 / 10] tensor([[0.943, 0.928],
        [0.928, 0.911]]) {'epoch': 10, 'valid/acc': 93.235, 'valid/acc_unbiased': 93.39, 'valid/diff': 1.27, 'valid/acc_skew': 94.024, 'valid/acc_align': 92.755, 'test/acc': 92.883, 'test/acc_unbiased': 92.735, 'test/diff': 1.554, 'test/acc_skew': 93.513, 'test/acc_align': 91.958}
[10 / 10] best valid accuracy: 93.390 at epoch 10 
 best_stats: {'best_valid_epoch': 10, 'best_valid_valid/acc': 93.235, 'best_valid_valid/acc_unbiased': 93.39, 'best_valid_valid/diff': 1.27, 'best_valid_valid/acc_skew': 94.024, 'best_valid_valid/acc_align': 92.755, 'best_valid_test/acc': 92.883, 'best_valid_test/acc_unbiased': 92.735, 'best_valid_test/diff': 1.554, 'best_valid_test/acc_skew': 93.513, 'best_valid_test/acc_align': 91.958}
[10 / 10] best test accuracy: 92.766 at epoch 7 
 best_stats: {'best_test_epoch': 7, 'best_test_valid/acc': 93.119, 'best_test_valid/acc_unbiased': 93.144, 'best_test_valid/diff': 1.486, 'best_test_valid/acc_skew': 93.887, 'best_test_valid/acc_align': 92.401, 'best_test_test/acc': 92.888, 'best_test_test/acc_unbiased': 92.766, 'best_test_test/diff': 1.063, 'best_test_test/acc_skew': 93.298, 'best_test_test/acc_align': 92.235}
Total training time: 2:53:09
