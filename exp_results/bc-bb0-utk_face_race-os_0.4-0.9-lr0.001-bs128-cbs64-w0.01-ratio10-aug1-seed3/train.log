Log level set to: INFO
Set seed: 3
=======> Using Fixed Random Seed: 3 <========
save_path: exp_results/bc-bb0-utk_face_race-os_0.4-0.9-lr0.001-bs128-cbs64-w0.01-ratio10-aug1-seed3
get_utk_face - split: train, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_race-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [4407, 552]
Target 1: [440, 5529]
Binary Target 1
---------------------------
Target 0: [4407, 552]
Target 1: [440, 5529]
===================================
Normal Label Distribution: 
Target 0: [4407, 552]
Target 1: [440, 5529]
===================================
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [2211, 2211]
Target 1: [2211, 2211]
Binary Target 1
---------------------------
Target 0: [2211, 2211]
Target 1: [2211, 2211]
===================================
Normal Label Distribution: 
Target 0: [2211, 2211]
Target 1: [2211, 2211]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 8844, target_attr: gender, bias_attr: race bias_rate: 0.9
['[train] target_0-bias_0: 2211', '[train] target_0-bias_1: 2211', '[train] target_1-bias_0: 2211', '[train] target_1-bias_1: 2211']
confusion_matrix - 
 original: tensor([[2211., 2211.],
        [2211., 2211.]]), 
 normalized: tensor([[0.500, 0.500],
        [0.500, 0.500]]), 
 b|y: tensor([[0.500, 0.500],
        [0.500, 0.500]])
get_utk_face - split: train, aug: 1, given_y: True, ratio: 10
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_race-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [4407, 552]
Target 1: [440, 5529]
Binary Target 1
---------------------------
Target 0: [4407, 552]
Target 1: [440, 5529]
===================================
Normal Label Distribution: 
Target 0: [4407, 552]
Target 1: [440, 5529]
===================================
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [2211, 2211]
Target 1: [2211, 2211]
Binary Target 1
---------------------------
Target 0: [2211, 2211]
Target 1: [2211, 2211]
===================================
Normal Label Distribution: 
Target 0: [2211, 2211]
Target 1: [2211, 2211]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 8844, target_attr: gender, bias_attr: race bias_rate: 0.9
['[train] target_0-bias_0: 2211', '[train] target_0-bias_1: 2211', '[train] target_1-bias_0: 2211', '[train] target_1-bias_1: 2211']
get_utk_face - split: valid, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_race-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [583, 684]
Target 1: [457, 646]
Binary Target 1
---------------------------
Target 0: [583, 684]
Target 1: [457, 646]
===================================
Normal Label Distribution: 
Target 0: [583, 684]
Target 1: [457, 646]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 2370, target_attr: gender, bias_attr: race bias_rate: 0.9
['[valid] target_0-bias_0: 583', '[valid] target_0-bias_1: 684', '[valid] target_1-bias_0: 457', '[valid] target_1-bias_1: 646']
get_utk_face - split: test, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_race-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [558, 677]
Target 1: [462, 673]
Binary Target 1
---------------------------
Target 0: [558, 677]
Target 1: [462, 673]
===================================
Normal Label Distribution: 
Target 0: [558, 677]
Target 1: [462, 673]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 2370, target_attr: gender, bias_attr: race bias_rate: 0.9
['[test] target_0-bias_0: 558', '[test] target_0-bias_1: 677', '[test] target_1-bias_0: 462', '[test] target_1-bias_1: 673']
decay_epochs: [6, 13]
[1 / 20] Learning rate: 0.001 weight: 0.01
[1 / 20] Loss: 4.926281241689101 CE Loss: 0.6165556751026496 Con Loss: 4.920115672749451
[1 / 20] tensor([[0.529, 0.520],
        [0.946, 0.929]]) {'epoch': 1, 'valid/acc': 71.73, 'valid/acc_unbiased': 73.16, 'valid/diff': 2.741, 'valid/acc_skew': 73.08, 'valid/acc_align': 73.241, 'test/acc': 72.11, 'test/acc_unbiased': 73.079, 'test/diff': 1.297, 'test/acc_skew': 73.728, 'test/acc_align': 72.431}
[1 / 20] best valid accuracy: 73.160 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 71.73, 'best_valid_valid/acc_unbiased': 73.16, 'best_valid_valid/diff': 2.741, 'best_valid_valid/acc_skew': 73.08, 'best_valid_valid/acc_align': 73.241, 'best_valid_test/acc': 72.11, 'best_valid_test/acc_unbiased': 73.079, 'best_valid_test/diff': 1.297, 'best_valid_test/acc_skew': 73.728, 'best_valid_test/acc_align': 72.431}
[1 / 20] best test accuracy: 73.079 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 71.73, 'best_test_valid/acc_unbiased': 73.16, 'best_test_valid/diff': 2.741, 'best_test_valid/acc_skew': 73.08, 'best_test_valid/acc_align': 73.241, 'best_test_test/acc': 72.11, 'best_test_test/acc_unbiased': 73.079, 'best_test_test/diff': 1.297, 'best_test_test/acc_skew': 73.728, 'best_test_test/acc_align': 72.431}
[2 / 20] Learning rate: 0.001 weight: 0.01
[2 / 20] Loss: 4.780463558362653 CE Loss: 0.4961621713605956 Con Loss: 4.775501927548757
[2 / 20] tensor([[0.916, 0.867],
        [0.690, 0.712]]) {'epoch': 2, 'valid/acc': 80.0, 'valid/acc_unbiased': 79.579, 'valid/diff': 3.026, 'valid/acc_skew': 81.092, 'valid/acc_align': 78.066, 'test/acc': 80.0, 'test/acc_unbiased': 79.626, 'test/diff': 3.499, 'test/acc_skew': 80.312, 'test/acc_align': 78.94}
[2 / 20] best valid accuracy: 79.579 at epoch 2 
 best_stats: {'best_valid_epoch': 2, 'best_valid_valid/acc': 80.0, 'best_valid_valid/acc_unbiased': 79.579, 'best_valid_valid/diff': 3.026, 'best_valid_valid/acc_skew': 81.092, 'best_valid_valid/acc_align': 78.066, 'best_valid_test/acc': 80.0, 'best_valid_test/acc_unbiased': 79.626, 'best_valid_test/diff': 3.499, 'best_valid_test/acc_skew': 80.312, 'best_valid_test/acc_align': 78.94}
[2 / 20] best test accuracy: 79.626 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 80.0, 'best_test_valid/acc_unbiased': 79.579, 'best_test_valid/diff': 3.026, 'best_test_valid/acc_skew': 81.092, 'best_test_valid/acc_align': 78.066, 'best_test_test/acc': 80.0, 'best_test_test/acc_unbiased': 79.626, 'best_test_test/diff': 3.499, 'best_test_test/acc_skew': 80.312, 'best_test_test/acc_align': 78.94}
[3 / 20] Learning rate: 0.001 weight: 0.01
[3 / 20] Loss: 4.745947779168483 CE Loss: 0.4446505854661947 Con Loss: 4.741501263394608
[3 / 20] tensor([[0.753, 0.737],
        [0.877, 0.883]]) {'epoch': 3, 'valid/acc': 80.169, 'valid/acc_unbiased': 80.746, 'valid/diff': 1.104, 'valid/acc_skew': 81.298, 'valid/acc_align': 80.194, 'test/acc': 80.928, 'test/acc_unbiased': 81.225, 'test/diff': 1.08, 'test/acc_skew': 81.466, 'test/acc_align': 80.985}
[3 / 20] best valid accuracy: 80.746 at epoch 3 
 best_stats: {'best_valid_epoch': 3, 'best_valid_valid/acc': 80.169, 'best_valid_valid/acc_unbiased': 80.746, 'best_valid_valid/diff': 1.104, 'best_valid_valid/acc_skew': 81.298, 'best_valid_valid/acc_align': 80.194, 'best_valid_test/acc': 80.928, 'best_valid_test/acc_unbiased': 81.225, 'best_valid_test/diff': 1.08, 'best_valid_test/acc_skew': 81.466, 'best_valid_test/acc_align': 80.985}
[3 / 20] best test accuracy: 81.225 at epoch 3 
 best_stats: {'best_test_epoch': 3, 'best_test_valid/acc': 80.169, 'best_test_valid/acc_unbiased': 80.746, 'best_test_valid/diff': 1.104, 'best_test_valid/acc_skew': 81.298, 'best_test_valid/acc_align': 80.194, 'best_test_test/acc': 80.928, 'best_test_test/acc_unbiased': 81.225, 'best_test_test/diff': 1.08, 'best_test_test/acc_skew': 81.466, 'best_test_test/acc_align': 80.985}
[4 / 20] Learning rate: 0.001 weight: 0.01
[4 / 20] Loss: 4.724008609136808 CE Loss: 0.4335774579559285 Con Loss: 4.719672851571127
[4 / 20] tensor([[0.901, 0.888],
        [0.747, 0.727]]) {'epoch': 4, 'valid/acc': 81.181, 'valid/acc_unbiased': 80.693, 'valid/diff': 1.173, 'valid/acc_skew': 81.187, 'valid/acc_align': 80.199, 'test/acc': 81.772, 'test/acc_unbiased': 81.563, 'test/diff': 1.692, 'test/acc_skew': 82.409, 'test/acc_align': 80.717}
[4 / 20] best valid accuracy: 80.746 at epoch 3 
 best_stats: {'best_valid_epoch': 3, 'best_valid_valid/acc': 80.169, 'best_valid_valid/acc_unbiased': 80.746, 'best_valid_valid/diff': 1.104, 'best_valid_valid/acc_skew': 81.298, 'best_valid_valid/acc_align': 80.194, 'best_valid_test/acc': 80.928, 'best_valid_test/acc_unbiased': 81.225, 'best_valid_test/diff': 1.08, 'best_valid_test/acc_skew': 81.466, 'best_valid_test/acc_align': 80.985}
[4 / 20] best test accuracy: 81.563 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 81.181, 'best_test_valid/acc_unbiased': 80.693, 'best_test_valid/diff': 1.173, 'best_test_valid/acc_skew': 81.187, 'best_test_valid/acc_align': 80.199, 'best_test_test/acc': 81.772, 'best_test_test/acc_unbiased': 81.563, 'best_test_test/diff': 1.692, 'best_test_test/acc_skew': 82.409, 'best_test_test/acc_align': 80.717}
[5 / 20] Learning rate: 0.001 weight: 0.01
[5 / 20] Loss: 4.697089970785803 CE Loss: 0.41017854731312603 Con Loss: 4.692988178299758
[5 / 20] tensor([[0.910, 0.877],
        [0.740, 0.774]]) {'epoch': 5, 'valid/acc': 82.574, 'valid/acc_unbiased': 82.127, 'valid/diff': 3.377, 'valid/acc_skew': 83.612, 'valid/acc_align': 80.642, 'test/acc': 82.911, 'test/acc_unbiased': 82.555, 'test/diff': 3.344, 'test/acc_skew': 82.533, 'test/acc_align': 82.577}
[5 / 20] best valid accuracy: 82.127 at epoch 5 
 best_stats: {'best_valid_epoch': 5, 'best_valid_valid/acc': 82.574, 'best_valid_valid/acc_unbiased': 82.127, 'best_valid_valid/diff': 3.377, 'best_valid_valid/acc_skew': 83.612, 'best_valid_valid/acc_align': 80.642, 'best_valid_test/acc': 82.911, 'best_valid_test/acc_unbiased': 82.555, 'best_valid_test/diff': 3.344, 'best_valid_test/acc_skew': 82.533, 'best_valid_test/acc_align': 82.577}
[5 / 20] best test accuracy: 82.555 at epoch 5 
 best_stats: {'best_test_epoch': 5, 'best_test_valid/acc': 82.574, 'best_test_valid/acc_unbiased': 82.127, 'best_test_valid/diff': 3.377, 'best_test_valid/acc_skew': 83.612, 'best_test_valid/acc_align': 80.642, 'best_test_test/acc': 82.911, 'best_test_test/acc_unbiased': 82.555, 'best_test_test/diff': 3.344, 'best_test_test/acc_skew': 82.533, 'best_test_test/acc_align': 82.577}
[6 / 20] Learning rate: 0.001 weight: 0.01
[6 / 20] Loss: 4.694760352764018 CE Loss: 0.4042974424033292 Con Loss: 4.690717383565433
[6 / 20] tensor([[0.919, 0.898],
        [0.719, 0.753]]) {'epoch': 6, 'valid/acc': 84.093, 'valid/acc_unbiased': 83.521, 'valid/diff': 1.999, 'valid/acc_skew': 84.026, 'valid/acc_align': 83.015, 'test/acc': 82.7, 'test/acc_unbiased': 82.235, 'test/diff': 2.8, 'test/acc_skew': 81.898, 'test/acc_align': 82.571}
[6 / 20] best valid accuracy: 83.521 at epoch 6 
 best_stats: {'best_valid_epoch': 6, 'best_valid_valid/acc': 84.093, 'best_valid_valid/acc_unbiased': 83.521, 'best_valid_valid/diff': 1.999, 'best_valid_valid/acc_skew': 84.026, 'best_valid_valid/acc_align': 83.015, 'best_valid_test/acc': 82.7, 'best_valid_test/acc_unbiased': 82.235, 'best_valid_test/diff': 2.8, 'best_valid_test/acc_skew': 81.898, 'best_valid_test/acc_align': 82.571}
[6 / 20] best test accuracy: 82.555 at epoch 5 
 best_stats: {'best_test_epoch': 5, 'best_test_valid/acc': 82.574, 'best_test_valid/acc_unbiased': 82.127, 'best_test_valid/diff': 3.377, 'best_test_valid/acc_skew': 83.612, 'best_test_valid/acc_align': 80.642, 'best_test_test/acc': 82.911, 'best_test_test/acc_unbiased': 82.555, 'best_test_test/diff': 3.344, 'best_test_test/acc_skew': 82.533, 'best_test_test/acc_align': 82.577}
[7 / 20] Learning rate: 0.0001 weight: 0.01
[7 / 20] Loss: 4.665099389625318 CE Loss: 0.3670715400262528 Con Loss: 4.6614286749678895
[7 / 20] tensor([[0.869, 0.815],
        [0.851, 0.857]]) {'epoch': 7, 'valid/acc': 86.034, 'valid/acc_unbiased': 86.21, 'valid/diff': 3.13, 'valid/acc_skew': 87.775, 'valid/acc_align': 84.645, 'test/acc': 84.684, 'test/acc_unbiased': 84.814, 'test/diff': 3.026, 'test/acc_skew': 85.991, 'test/acc_align': 83.636}
[7 / 20] best valid accuracy: 86.210 at epoch 7 
 best_stats: {'best_valid_epoch': 7, 'best_valid_valid/acc': 86.034, 'best_valid_valid/acc_unbiased': 86.21, 'best_valid_valid/diff': 3.13, 'best_valid_valid/acc_skew': 87.775, 'best_valid_valid/acc_align': 84.645, 'best_valid_test/acc': 84.684, 'best_valid_test/acc_unbiased': 84.814, 'best_valid_test/diff': 3.026, 'best_valid_test/acc_skew': 85.991, 'best_valid_test/acc_align': 83.636}
[7 / 20] best test accuracy: 84.814 at epoch 7 
 best_stats: {'best_test_epoch': 7, 'best_test_valid/acc': 86.034, 'best_test_valid/acc_unbiased': 86.21, 'best_test_valid/diff': 3.13, 'best_test_valid/acc_skew': 87.775, 'best_test_valid/acc_align': 84.645, 'best_test_test/acc': 84.684, 'best_test_test/acc_unbiased': 84.814, 'best_test_test/diff': 3.026, 'best_test_test/acc_skew': 85.991, 'best_test_test/acc_align': 83.636}
[8 / 20] Learning rate: 0.0001 weight: 0.01
[8 / 20] Loss: 4.6176496127890765 CE Loss: 0.33582293818785236 Con Loss: 4.614291375495362
[8 / 20] tensor([[0.867, 0.820],
        [0.835, 0.863]]) {'epoch': 8, 'valid/acc': 86.371, 'valid/acc_unbiased': 86.517, 'valid/diff': 3.195, 'valid/acc_skew': 87.541, 'valid/acc_align': 85.492, 'test/acc': 84.641, 'test/acc_unbiased': 84.649, 'test/diff': 3.77, 'test/acc_skew': 85.144, 'test/acc_align': 84.155}
[8 / 20] best valid accuracy: 86.517 at epoch 8 
 best_stats: {'best_valid_epoch': 8, 'best_valid_valid/acc': 86.371, 'best_valid_valid/acc_unbiased': 86.517, 'best_valid_valid/diff': 3.195, 'best_valid_valid/acc_skew': 87.541, 'best_valid_valid/acc_align': 85.492, 'best_valid_test/acc': 84.641, 'best_valid_test/acc_unbiased': 84.649, 'best_valid_test/diff': 3.77, 'best_valid_test/acc_skew': 85.144, 'best_valid_test/acc_align': 84.155}
[8 / 20] best test accuracy: 84.814 at epoch 7 
 best_stats: {'best_test_epoch': 7, 'best_test_valid/acc': 86.034, 'best_test_valid/acc_unbiased': 86.21, 'best_test_valid/diff': 3.13, 'best_test_valid/acc_skew': 87.775, 'best_test_valid/acc_align': 84.645, 'best_test_test/acc': 84.684, 'best_test_test/acc_unbiased': 84.814, 'best_test_test/diff': 3.026, 'best_test_test/acc_skew': 85.991, 'best_test_test/acc_align': 83.636}
[9 / 20] Learning rate: 0.0001 weight: 0.01
[9 / 20] Loss: 4.616734704406269 CE Loss: 0.32988146719809625 Con Loss: 4.6134359035379795
[9 / 20] tensor([[0.875, 0.840],
        [0.842, 0.845]]) {'epoch': 9, 'valid/acc': 86.709, 'valid/acc_unbiased': 86.675, 'valid/diff': 2.631, 'valid/acc_skew': 87.562, 'valid/acc_align': 85.789, 'test/acc': 85.021, 'test/acc_unbiased': 85.062, 'test/diff': 1.878, 'test/acc_skew': 85.827, 'test/acc_align': 84.297}
[9 / 20] best valid accuracy: 86.675 at epoch 9 
 best_stats: {'best_valid_epoch': 9, 'best_valid_valid/acc': 86.709, 'best_valid_valid/acc_unbiased': 86.675, 'best_valid_valid/diff': 2.631, 'best_valid_valid/acc_skew': 87.562, 'best_valid_valid/acc_align': 85.789, 'best_valid_test/acc': 85.021, 'best_valid_test/acc_unbiased': 85.062, 'best_valid_test/diff': 1.878, 'best_valid_test/acc_skew': 85.827, 'best_valid_test/acc_align': 84.297}
[9 / 20] best test accuracy: 85.062 at epoch 9 
 best_stats: {'best_test_epoch': 9, 'best_test_valid/acc': 86.709, 'best_test_valid/acc_unbiased': 86.675, 'best_test_valid/diff': 2.631, 'best_test_valid/acc_skew': 87.562, 'best_test_valid/acc_align': 85.789, 'best_test_test/acc': 85.021, 'best_test_test/acc_unbiased': 85.062, 'best_test_test/diff': 1.878, 'best_test_test/acc_skew': 85.827, 'best_test_test/acc_align': 84.297}
[10 / 20] Learning rate: 0.0001 weight: 0.01
[10 / 20] Loss: 4.592078895172023 CE Loss: 0.3184206304858573 Con Loss: 4.588894704303716
[10 / 20] tensor([[0.878, 0.833],
        [0.846, 0.856]]) {'epoch': 10, 'valid/acc': 86.878, 'valid/acc_unbiased': 86.901, 'valid/diff': 2.354, 'valid/acc_skew': 87.533, 'valid/acc_align': 86.27, 'test/acc': 85.274, 'test/acc_unbiased': 85.335, 'test/diff': 2.73, 'test/acc_skew': 86.223, 'test/acc_align': 84.448}
[10 / 20] best valid accuracy: 86.901 at epoch 10 
 best_stats: {'best_valid_epoch': 10, 'best_valid_valid/acc': 86.878, 'best_valid_valid/acc_unbiased': 86.901, 'best_valid_valid/diff': 2.354, 'best_valid_valid/acc_skew': 87.533, 'best_valid_valid/acc_align': 86.27, 'best_valid_test/acc': 85.274, 'best_valid_test/acc_unbiased': 85.335, 'best_valid_test/diff': 2.73, 'best_valid_test/acc_skew': 86.223, 'best_valid_test/acc_align': 84.448}
[10 / 20] best test accuracy: 85.335 at epoch 10 
 best_stats: {'best_test_epoch': 10, 'best_test_valid/acc': 86.878, 'best_test_valid/acc_unbiased': 86.901, 'best_test_valid/diff': 2.354, 'best_test_valid/acc_skew': 87.533, 'best_test_valid/acc_align': 86.27, 'best_test_test/acc': 85.274, 'best_test_test/acc_unbiased': 85.335, 'best_test_test/diff': 2.73, 'best_test_test/acc_skew': 86.223, 'best_test_test/acc_align': 84.448}
[11 / 20] Learning rate: 0.0001 weight: 0.01
[11 / 20] Loss: 4.5795001727000235 CE Loss: 0.31104510606063107 Con Loss: 4.576389713882591
[11 / 20] tensor([[0.876, 0.824],
        [0.833, 0.866]]) {'epoch': 11, 'valid/acc': 86.709, 'valid/acc_unbiased': 86.713, 'valid/diff': 3.146, 'valid/acc_skew': 87.056, 'valid/acc_align': 86.369, 'test/acc': 85.021, 'test/acc_unbiased': 85.004, 'test/diff': 4.253, 'test/acc_skew': 85.484, 'test/acc_align': 84.525}
[11 / 20] best valid accuracy: 86.901 at epoch 10 
 best_stats: {'best_valid_epoch': 10, 'best_valid_valid/acc': 86.878, 'best_valid_valid/acc_unbiased': 86.901, 'best_valid_valid/diff': 2.354, 'best_valid_valid/acc_skew': 87.533, 'best_valid_valid/acc_align': 86.27, 'best_valid_test/acc': 85.274, 'best_valid_test/acc_unbiased': 85.335, 'best_valid_test/diff': 2.73, 'best_valid_test/acc_skew': 86.223, 'best_valid_test/acc_align': 84.448}
[11 / 20] best test accuracy: 85.335 at epoch 10 
 best_stats: {'best_test_epoch': 10, 'best_test_valid/acc': 86.878, 'best_test_valid/acc_unbiased': 86.901, 'best_test_valid/diff': 2.354, 'best_test_valid/acc_skew': 87.533, 'best_test_valid/acc_align': 86.27, 'best_test_test/acc': 85.274, 'best_test_test/acc_unbiased': 85.335, 'best_test_test/diff': 2.73, 'best_test_test/acc_skew': 86.223, 'best_test_test/acc_align': 84.448}
[12 / 20] Learning rate: 0.0001 weight: 0.01
[12 / 20] Loss: 4.569768099049431 CE Loss: 0.30530372102947484 Con Loss: 4.566715045516602
[12 / 20] tensor([[0.884, 0.851],
        [0.838, 0.853]]) {'epoch': 12, 'valid/acc': 86.582, 'valid/acc_unbiased': 86.585, 'valid/diff': 2.231, 'valid/acc_skew': 87.29, 'valid/acc_align': 85.879, 'test/acc': 85.654, 'test/acc_unbiased': 85.622, 'test/diff': 2.397, 'test/acc_skew': 86.059, 'test/acc_align': 85.185}
[12 / 20] best valid accuracy: 86.901 at epoch 10 
 best_stats: {'best_valid_epoch': 10, 'best_valid_valid/acc': 86.878, 'best_valid_valid/acc_unbiased': 86.901, 'best_valid_valid/diff': 2.354, 'best_valid_valid/acc_skew': 87.533, 'best_valid_valid/acc_align': 86.27, 'best_valid_test/acc': 85.274, 'best_valid_test/acc_unbiased': 85.335, 'best_valid_test/diff': 2.73, 'best_valid_test/acc_skew': 86.223, 'best_valid_test/acc_align': 84.448}
[12 / 20] best test accuracy: 85.622 at epoch 12 
 best_stats: {'best_test_epoch': 12, 'best_test_valid/acc': 86.582, 'best_test_valid/acc_unbiased': 86.585, 'best_test_valid/diff': 2.231, 'best_test_valid/acc_skew': 87.29, 'best_test_valid/acc_align': 85.879, 'best_test_test/acc': 85.654, 'best_test_test/acc_unbiased': 85.622, 'best_test_test/diff': 2.397, 'best_test_test/acc_skew': 86.059, 'best_test_test/acc_align': 85.185}
[13 / 20] Learning rate: 0.0001 weight: 0.01
[13 / 20] Loss: 4.552630263181468 CE Loss: 0.29970216381096937 Con Loss: 4.549633253866167
[13 / 20] tensor([[0.844, 0.787],
        [0.864, 0.895]]) {'epoch': 13, 'valid/acc': 85.949, 'valid/acc_unbiased': 86.15, 'valid/diff': 2.61, 'valid/acc_skew': 86.778, 'valid/acc_align': 85.522, 'test/acc': 84.599, 'test/acc_unbiased': 84.738, 'test/diff': 4.383, 'test/acc_skew': 85.386, 'test/acc_align': 84.09}
[13 / 20] best valid accuracy: 86.901 at epoch 10 
 best_stats: {'best_valid_epoch': 10, 'best_valid_valid/acc': 86.878, 'best_valid_valid/acc_unbiased': 86.901, 'best_valid_valid/diff': 2.354, 'best_valid_valid/acc_skew': 87.533, 'best_valid_valid/acc_align': 86.27, 'best_valid_test/acc': 85.274, 'best_valid_test/acc_unbiased': 85.335, 'best_valid_test/diff': 2.73, 'best_valid_test/acc_skew': 86.223, 'best_valid_test/acc_align': 84.448}
[13 / 20] best test accuracy: 85.622 at epoch 12 
 best_stats: {'best_test_epoch': 12, 'best_test_valid/acc': 86.582, 'best_test_valid/acc_unbiased': 86.585, 'best_test_valid/diff': 2.231, 'best_test_valid/acc_skew': 87.29, 'best_test_valid/acc_align': 85.879, 'best_test_test/acc': 85.654, 'best_test_test/acc_unbiased': 85.622, 'best_test_test/diff': 2.397, 'best_test_test/acc_skew': 86.059, 'best_test_test/acc_align': 85.185}
[14 / 20] Learning rate: 1e-05 weight: 0.01
[14 / 20] Loss: 4.547405966910126 CE Loss: 0.29468485424552016 Con Loss: 4.544459129016036
[14 / 20] tensor([[0.844, 0.784],
        [0.861, 0.895]]) {'epoch': 14, 'valid/acc': 86.076, 'valid/acc_unbiased': 86.301, 'valid/diff': 2.912, 'valid/acc_skew': 86.911, 'valid/acc_align': 85.69, 'test/acc': 84.473, 'test/acc_unbiased': 84.61, 'test/diff': 4.639, 'test/acc_skew': 85.278, 'test/acc_align': 83.942}
[14 / 20] best valid accuracy: 86.901 at epoch 10 
 best_stats: {'best_valid_epoch': 10, 'best_valid_valid/acc': 86.878, 'best_valid_valid/acc_unbiased': 86.901, 'best_valid_valid/diff': 2.354, 'best_valid_valid/acc_skew': 87.533, 'best_valid_valid/acc_align': 86.27, 'best_valid_test/acc': 85.274, 'best_valid_test/acc_unbiased': 85.335, 'best_valid_test/diff': 2.73, 'best_valid_test/acc_skew': 86.223, 'best_valid_test/acc_align': 84.448}
[14 / 20] best test accuracy: 85.622 at epoch 12 
 best_stats: {'best_test_epoch': 12, 'best_test_valid/acc': 86.582, 'best_test_valid/acc_unbiased': 86.585, 'best_test_valid/diff': 2.231, 'best_test_valid/acc_skew': 87.29, 'best_test_valid/acc_align': 85.879, 'best_test_test/acc': 85.654, 'best_test_test/acc_unbiased': 85.622, 'best_test_test/diff': 2.397, 'best_test_test/acc_skew': 86.059, 'best_test_test/acc_align': 85.185}
[15 / 20] Learning rate: 1e-05 weight: 0.01
[15 / 20] Loss: 4.541401739737288 CE Loss: 0.289025805725441 Con Loss: 4.53851148263732
[15 / 20] tensor([[0.867, 0.818],
        [0.851, 0.875]]) {'epoch': 15, 'valid/acc': 86.329, 'valid/acc_unbiased': 86.454, 'valid/diff': 3.288, 'valid/acc_skew': 87.26, 'valid/acc_align': 85.647, 'test/acc': 85.232, 'test/acc_unbiased': 85.288, 'test/diff': 3.68, 'test/acc_skew': 85.902, 'test/acc_align': 84.675}
[15 / 20] best valid accuracy: 86.901 at epoch 10 
 best_stats: {'best_valid_epoch': 10, 'best_valid_valid/acc': 86.878, 'best_valid_valid/acc_unbiased': 86.901, 'best_valid_valid/diff': 2.354, 'best_valid_valid/acc_skew': 87.533, 'best_valid_valid/acc_align': 86.27, 'best_valid_test/acc': 85.274, 'best_valid_test/acc_unbiased': 85.335, 'best_valid_test/diff': 2.73, 'best_valid_test/acc_skew': 86.223, 'best_valid_test/acc_align': 84.448}
[15 / 20] best test accuracy: 85.622 at epoch 12 
 best_stats: {'best_test_epoch': 12, 'best_test_valid/acc': 86.582, 'best_test_valid/acc_unbiased': 86.585, 'best_test_valid/diff': 2.231, 'best_test_valid/acc_skew': 87.29, 'best_test_valid/acc_align': 85.879, 'best_test_test/acc': 85.654, 'best_test_test/acc_unbiased': 85.622, 'best_test_test/diff': 2.397, 'best_test_test/acc_skew': 86.059, 'best_test_test/acc_align': 85.185}
[16 / 20] Learning rate: 1e-05 weight: 0.01
[16 / 20] Loss: 4.52705336673828 CE Loss: 0.2929814236970683 Con Loss: 4.524123528703528
[16 / 20] tensor([[0.889, 0.830],
        [0.835, 0.866]]) {'epoch': 16, 'valid/acc': 86.962, 'valid/acc_unbiased': 86.933, 'valid/diff': 2.635, 'valid/acc_skew': 87.376, 'valid/acc_align': 86.49, 'test/acc': 85.527, 'test/acc_unbiased': 85.52, 'test/diff': 4.476, 'test/acc_skew': 86.219, 'test/acc_align': 84.82}
[16 / 20] best valid accuracy: 86.933 at epoch 16 
 best_stats: {'best_valid_epoch': 16, 'best_valid_valid/acc': 86.962, 'best_valid_valid/acc_unbiased': 86.933, 'best_valid_valid/diff': 2.635, 'best_valid_valid/acc_skew': 87.376, 'best_valid_valid/acc_align': 86.49, 'best_valid_test/acc': 85.527, 'best_valid_test/acc_unbiased': 85.52, 'best_valid_test/diff': 4.476, 'best_valid_test/acc_skew': 86.219, 'best_valid_test/acc_align': 84.82}
[16 / 20] best test accuracy: 85.622 at epoch 12 
 best_stats: {'best_test_epoch': 12, 'best_test_valid/acc': 86.582, 'best_test_valid/acc_unbiased': 86.585, 'best_test_valid/diff': 2.231, 'best_test_valid/acc_skew': 87.29, 'best_test_valid/acc_align': 85.879, 'best_test_test/acc': 85.654, 'best_test_test/acc_unbiased': 85.622, 'best_test_test/diff': 2.397, 'best_test_test/acc_skew': 86.059, 'best_test_test/acc_align': 85.185}
[17 / 20] Learning rate: 1e-05 weight: 0.01
[17 / 20] Loss: 4.551734237420726 CE Loss: 0.2887030435007441 Con Loss: 4.548847217896253
[17 / 20] tensor([[0.866, 0.812],
        [0.853, 0.881]]) {'epoch': 17, 'valid/acc': 86.92, 'valid/acc_unbiased': 87.049, 'valid/diff': 3.092, 'valid/acc_skew': 87.932, 'valid/acc_align': 86.167, 'test/acc': 85.232, 'test/acc_unbiased': 85.299, 'test/diff': 4.075, 'test/acc_skew': 85.92, 'test/acc_align': 84.677}
[17 / 20] best valid accuracy: 87.049 at epoch 17 
 best_stats: {'best_valid_epoch': 17, 'best_valid_valid/acc': 86.92, 'best_valid_valid/acc_unbiased': 87.049, 'best_valid_valid/diff': 3.092, 'best_valid_valid/acc_skew': 87.932, 'best_valid_valid/acc_align': 86.167, 'best_valid_test/acc': 85.232, 'best_valid_test/acc_unbiased': 85.299, 'best_valid_test/diff': 4.075, 'best_valid_test/acc_skew': 85.92, 'best_valid_test/acc_align': 84.677}
[17 / 20] best test accuracy: 85.622 at epoch 12 
 best_stats: {'best_test_epoch': 12, 'best_test_valid/acc': 86.582, 'best_test_valid/acc_unbiased': 86.585, 'best_test_valid/diff': 2.231, 'best_test_valid/acc_skew': 87.29, 'best_test_valid/acc_align': 85.879, 'best_test_test/acc': 85.654, 'best_test_test/acc_unbiased': 85.622, 'best_test_test/diff': 2.397, 'best_test_test/acc_skew': 86.059, 'best_test_test/acc_align': 85.185}
[18 / 20] Learning rate: 1e-05 weight: 0.01
[18 / 20] Loss: 4.537703950175437 CE Loss: 0.2889158319478011 Con Loss: 4.534814756955027
[18 / 20] tensor([[0.873, 0.814],
        [0.851, 0.880]]) {'epoch': 18, 'valid/acc': 87.004, 'valid/acc_unbiased': 87.118, 'valid/diff': 2.645, 'valid/acc_skew': 87.932, 'valid/acc_align': 86.305, 'test/acc': 85.359, 'test/acc_unbiased': 85.423, 'test/diff': 4.393, 'test/acc_skew': 86.17, 'test/acc_align': 84.676}
[18 / 20] best valid accuracy: 87.118 at epoch 18 
 best_stats: {'best_valid_epoch': 18, 'best_valid_valid/acc': 87.004, 'best_valid_valid/acc_unbiased': 87.118, 'best_valid_valid/diff': 2.645, 'best_valid_valid/acc_skew': 87.932, 'best_valid_valid/acc_align': 86.305, 'best_valid_test/acc': 85.359, 'best_valid_test/acc_unbiased': 85.423, 'best_valid_test/diff': 4.393, 'best_valid_test/acc_skew': 86.17, 'best_valid_test/acc_align': 84.676}
[18 / 20] best test accuracy: 85.622 at epoch 12 
 best_stats: {'best_test_epoch': 12, 'best_test_valid/acc': 86.582, 'best_test_valid/acc_unbiased': 86.585, 'best_test_valid/diff': 2.231, 'best_test_valid/acc_skew': 87.29, 'best_test_valid/acc_align': 85.879, 'best_test_test/acc': 85.654, 'best_test_test/acc_unbiased': 85.622, 'best_test_test/diff': 2.397, 'best_test_test/acc_skew': 86.059, 'best_test_test/acc_align': 85.185}
[19 / 20] Learning rate: 1e-05 weight: 0.01
[19 / 20] Loss: 4.534392879646539 CE Loss: 0.2936740226197814 Con Loss: 4.531456142246103
[19 / 20] tensor([[0.866, 0.806],
        [0.855, 0.880]]) {'epoch': 19, 'valid/acc': 86.878, 'valid/acc_unbiased': 87.045, 'valid/diff': 1.916, 'valid/acc_skew': 87.855, 'valid/acc_align': 86.236, 'test/acc': 85.063, 'test/acc_unbiased': 85.168, 'test/diff': 4.188, 'test/acc_skew': 86.028, 'test/acc_align': 84.307}
[19 / 20] best valid accuracy: 87.118 at epoch 18 
 best_stats: {'best_valid_epoch': 18, 'best_valid_valid/acc': 87.004, 'best_valid_valid/acc_unbiased': 87.118, 'best_valid_valid/diff': 2.645, 'best_valid_valid/acc_skew': 87.932, 'best_valid_valid/acc_align': 86.305, 'best_valid_test/acc': 85.359, 'best_valid_test/acc_unbiased': 85.423, 'best_valid_test/diff': 4.393, 'best_valid_test/acc_skew': 86.17, 'best_valid_test/acc_align': 84.676}
[19 / 20] best test accuracy: 85.622 at epoch 12 
 best_stats: {'best_test_epoch': 12, 'best_test_valid/acc': 86.582, 'best_test_valid/acc_unbiased': 86.585, 'best_test_valid/diff': 2.231, 'best_test_valid/acc_skew': 87.29, 'best_test_valid/acc_align': 85.879, 'best_test_test/acc': 85.654, 'best_test_test/acc_unbiased': 85.622, 'best_test_test/diff': 2.397, 'best_test_test/acc_skew': 86.059, 'best_test_test/acc_align': 85.185}
[20 / 20] Learning rate: 1e-05 weight: 0.01
[20 / 20] Loss: 4.545155348792868 CE Loss: 0.2954631773717044 Con Loss: 4.54220073226349
[20 / 20] tensor([[0.876, 0.817],
        [0.846, 0.868]]) {'epoch': 20, 'valid/acc': 86.878, 'valid/acc_unbiased': 86.968, 'valid/diff': 2.343, 'valid/acc_skew': 87.799, 'valid/acc_align': 86.137, 'test/acc': 85.105, 'test/acc_unbiased': 85.181, 'test/diff': 4.047, 'test/acc_skew': 86.133, 'test/acc_align': 84.23}
[20 / 20] best valid accuracy: 87.118 at epoch 18 
 best_stats: {'best_valid_epoch': 18, 'best_valid_valid/acc': 87.004, 'best_valid_valid/acc_unbiased': 87.118, 'best_valid_valid/diff': 2.645, 'best_valid_valid/acc_skew': 87.932, 'best_valid_valid/acc_align': 86.305, 'best_valid_test/acc': 85.359, 'best_valid_test/acc_unbiased': 85.423, 'best_valid_test/diff': 4.393, 'best_valid_test/acc_skew': 86.17, 'best_valid_test/acc_align': 84.676}
[20 / 20] best test accuracy: 85.622 at epoch 12 
 best_stats: {'best_test_epoch': 12, 'best_test_valid/acc': 86.582, 'best_test_valid/acc_unbiased': 86.585, 'best_test_valid/diff': 2.231, 'best_test_valid/acc_skew': 87.29, 'best_test_valid/acc_align': 85.879, 'best_test_test/acc': 85.654, 'best_test_test/acc_unbiased': 85.622, 'best_test_test/diff': 2.397, 'best_test_test/acc_skew': 86.059, 'best_test_test/acc_align': 85.185}
Total training time: 0:25:51
