Log level set to: INFO
Set seed: 3
=======> Using Fixed Random Seed: 3 <========
save_path: exp_results/bc-bb0-celeba_blonde-os-lr0.001-bs128-cbs64-w0.01-ratio30-aug1-seed3
get_celeba - split:train, aug: False, given_y: True, ratio: 0
use existing blonde indices from data/celeba/pickles/blonde
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [53486, 53486]
Target 1: [53486, 53486]
Binary Target 1
---------------------------
Target 0: [53486, 53486]
Target 1: [53486, 53486]
===================================
Normal Label Distribution: 
Target 0: [53486, 53486]
Target 1: [53486, 53486]
===================================
Use BiasedCelebASplit 
 target_attr: blonde split: train 
 tensor([[53486., 53486.],
        [53486., 53486.]])
get_celeba - split:train, aug: 1, given_y: True, ratio: 30
use existing blonde indices from data/celeba/pickles/blonde
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [53508, 53508]
Target 1: [53508, 53508]
Binary Target 1
---------------------------
Target 0: [53508, 53508]
Target 1: [53508, 53508]
===================================
Normal Label Distribution: 
Target 0: [53508, 53508]
Target 1: [53508, 53508]
===================================
Use BiasedCelebASplit 
 target_attr: blonde split: train 
 tensor([[53508., 53508.],
        [53508., 53508.]])
get_celeba - split:train_valid, aug: False, given_y: True, ratio: 0
use existing blonde indices from data/celeba/pickles/blonde
Use BiasedCelebASplit 
 target_attr: blonde split: train_valid 
 tensor([[  386.,  4517.],
        [13446.,   280.]])
get_celeba - split:valid, aug: False, given_y: True, ratio: 0
Use BiasedCelebASplit 
 target_attr: blonde split: valid 
 tensor([[8535., 2874.],
        [8276.,  182.]])
decay_epochs: [3, 6]
[1 / 10] Learning rate: 0.001 weight: 0.01
[1 / 10] Loss: 4.609721869603593 CE Loss: 0.2376350771213832 Con Loss: 4.607345522820752
[1 / 10] tensor([[0.859, 0.934],
        [0.945, 0.835]]) {'epoch': 1, 'valid/acc': 92.963, 'valid/acc_unbiased': 92.699, 'valid/diff': 3.214, 'valid/acc_skew': 94.305, 'valid/acc_align': 91.092, 'test/acc': 90.23, 'test/acc_unbiased': 89.32, 'test/diff': 9.229, 'test/acc_skew': 90.198, 'test/acc_align': 88.441}
[1 / 10] best valid accuracy: 92.699 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 92.963, 'best_valid_valid/acc_unbiased': 92.699, 'best_valid_valid/diff': 3.214, 'best_valid_valid/acc_skew': 94.305, 'best_valid_valid/acc_align': 91.092, 'best_valid_test/acc': 90.23, 'best_valid_test/acc_unbiased': 89.32, 'best_valid_test/diff': 9.229, 'best_valid_test/acc_skew': 90.198, 'best_valid_test/acc_align': 88.441}
[1 / 10] best test accuracy: 89.320 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 92.963, 'best_test_valid/acc_unbiased': 92.699, 'best_test_valid/diff': 3.214, 'best_test_valid/acc_skew': 94.305, 'best_test_valid/acc_align': 91.092, 'best_test_test/acc': 90.23, 'best_test_test/acc_unbiased': 89.32, 'best_test_test/diff': 9.229, 'best_test_test/acc_skew': 90.198, 'best_test_test/acc_align': 88.441}
[2 / 10] Learning rate: 0.001 weight: 0.01
[2 / 10] Loss: 4.553483648788366 CE Loss: 0.20044968706175273 Con Loss: 4.551479155679507
[2 / 10] tensor([[0.865, 0.923],
        [0.940, 0.896]]) {'epoch': 2, 'valid/acc': 92.453, 'valid/acc_unbiased': 93.565, 'valid/diff': 1.851, 'valid/acc_skew': 94.49, 'valid/acc_align': 92.639, 'test/acc': 90.039, 'test/acc_unbiased': 90.598, 'test/diff': 5.11, 'test/acc_skew': 90.271, 'test/acc_align': 90.926}
[2 / 10] best valid accuracy: 93.565 at epoch 2 
 best_stats: {'best_valid_epoch': 2, 'best_valid_valid/acc': 92.453, 'best_valid_valid/acc_unbiased': 93.565, 'best_valid_valid/diff': 1.851, 'best_valid_valid/acc_skew': 94.49, 'best_valid_valid/acc_align': 92.639, 'best_valid_test/acc': 90.039, 'best_valid_test/acc_unbiased': 90.598, 'best_valid_test/diff': 5.11, 'best_valid_test/acc_skew': 90.271, 'best_valid_test/acc_align': 90.926}
[2 / 10] best test accuracy: 90.598 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 92.453, 'best_test_valid/acc_unbiased': 93.565, 'best_test_valid/diff': 1.851, 'best_test_valid/acc_skew': 94.49, 'best_test_valid/acc_align': 92.639, 'best_test_test/acc': 90.039, 'best_test_test/acc_unbiased': 90.598, 'best_test_test/diff': 5.11, 'best_test_test/acc_skew': 90.271, 'best_test_test/acc_align': 90.926}
[3 / 10] Learning rate: 0.001 weight: 0.01
[3 / 10] Loss: 4.519800544939611 CE Loss: 0.18235881251499914 Con Loss: 4.51797695635626
[3 / 10] tensor([[0.834, 0.934],
        [0.962, 0.901]]) {'epoch': 3, 'valid/acc': 93.972, 'valid/acc_unbiased': 94.185, 'valid/diff': 1.656, 'valid/acc_skew': 95.013, 'valid/acc_align': 93.357, 'test/acc': 89.505, 'test/acc_unbiased': 90.789, 'test/diff': 8.034, 'test/acc_skew': 89.803, 'test/acc_align': 91.774}
[3 / 10] best valid accuracy: 94.185 at epoch 3 
 best_stats: {'best_valid_epoch': 3, 'best_valid_valid/acc': 93.972, 'best_valid_valid/acc_unbiased': 94.185, 'best_valid_valid/diff': 1.656, 'best_valid_valid/acc_skew': 95.013, 'best_valid_valid/acc_align': 93.357, 'best_valid_test/acc': 89.505, 'best_valid_test/acc_unbiased': 90.789, 'best_valid_test/diff': 8.034, 'best_valid_test/acc_skew': 89.803, 'best_valid_test/acc_align': 91.774}
[3 / 10] best test accuracy: 90.789 at epoch 3 
 best_stats: {'best_test_epoch': 3, 'best_test_valid/acc': 93.972, 'best_test_valid/acc_unbiased': 94.185, 'best_test_valid/diff': 1.656, 'best_test_valid/acc_skew': 95.013, 'best_test_valid/acc_align': 93.357, 'best_test_test/acc': 89.505, 'best_test_test/acc_unbiased': 90.789, 'best_test_test/diff': 8.034, 'best_test_test/acc_skew': 89.803, 'best_test_test/acc_align': 91.774}
[4 / 10] Learning rate: 0.0001 weight: 0.01
[4 / 10] Loss: 4.439639220904409 CE Loss: 0.1410327095329289 Con Loss: 4.438228892338587
[4 / 10] tensor([[0.856, 0.945],
        [0.960, 0.923]]) {'epoch': 4, 'valid/acc': 94.552, 'valid/acc_unbiased': 96.071, 'valid/diff': 2.31, 'valid/acc_skew': 97.226, 'valid/acc_align': 94.916, 'test/acc': 90.854, 'test/acc_unbiased': 92.096, 'test/diff': 6.331, 'test/acc_skew': 90.794, 'test/acc_align': 93.399}
[4 / 10] best valid accuracy: 96.071 at epoch 4 
 best_stats: {'best_valid_epoch': 4, 'best_valid_valid/acc': 94.552, 'best_valid_valid/acc_unbiased': 96.071, 'best_valid_valid/diff': 2.31, 'best_valid_valid/acc_skew': 97.226, 'best_valid_valid/acc_align': 94.916, 'best_valid_test/acc': 90.854, 'best_valid_test/acc_unbiased': 92.096, 'best_valid_test/diff': 6.331, 'best_valid_test/acc_skew': 90.794, 'best_valid_test/acc_align': 93.399}
[4 / 10] best test accuracy: 92.096 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 94.552, 'best_test_valid/acc_unbiased': 96.071, 'best_test_valid/diff': 2.31, 'best_test_valid/acc_skew': 97.226, 'best_test_valid/acc_align': 94.916, 'best_test_test/acc': 90.854, 'best_test_test/acc_unbiased': 92.096, 'best_test_test/diff': 6.331, 'best_test_test/acc_skew': 90.794, 'best_test_test/acc_align': 93.399}
[5 / 10] Learning rate: 0.0001 weight: 0.01
[5 / 10] Loss: 4.406106524097845 CE Loss: 0.12798403090598967 Con Loss: 4.404826686710639
[5 / 10] tensor([[0.796, 0.931],
        [0.979, 0.940]]) {'epoch': 5, 'valid/acc': 93.956, 'valid/acc_unbiased': 96.247, 'valid/diff': 3.041, 'valid/acc_skew': 97.767, 'valid/acc_align': 94.726, 'test/acc': 87.97, 'test/acc_unbiased': 91.128, 'test/diff': 8.744, 'test/acc_skew': 88.751, 'test/acc_align': 93.504}
[5 / 10] best valid accuracy: 96.247 at epoch 5 
 best_stats: {'best_valid_epoch': 5, 'best_valid_valid/acc': 93.956, 'best_valid_valid/acc_unbiased': 96.247, 'best_valid_valid/diff': 3.041, 'best_valid_valid/acc_skew': 97.767, 'best_valid_valid/acc_align': 94.726, 'best_valid_test/acc': 87.97, 'best_valid_test/acc_unbiased': 91.128, 'best_valid_test/diff': 8.744, 'best_valid_test/acc_skew': 88.751, 'best_valid_test/acc_align': 93.504}
[5 / 10] best test accuracy: 92.096 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 94.552, 'best_test_valid/acc_unbiased': 96.071, 'best_test_valid/diff': 2.31, 'best_test_valid/acc_skew': 97.226, 'best_test_valid/acc_align': 94.916, 'best_test_test/acc': 90.854, 'best_test_test/acc_unbiased': 92.096, 'best_test_test/diff': 6.331, 'best_test_test/acc_skew': 90.794, 'best_test_test/acc_align': 93.399}
[6 / 10] Learning rate: 0.0001 weight: 0.01
[6 / 10] Loss: 4.3859297019695465 CE Loss: 0.12115381423552364 Con Loss: 4.384718159688187
[6 / 10] tensor([[0.820, 0.945],
        [0.973, 0.907]]) {'epoch': 6, 'valid/acc': 94.938, 'valid/acc_unbiased': 96.49, 'valid/diff': 3.356, 'valid/acc_skew': 98.168, 'valid/acc_align': 94.812, 'test/acc': 89.47, 'test/acc_unbiased': 91.095, 'test/diff': 9.562, 'test/acc_skew': 89.627, 'test/acc_align': 92.563}
[6 / 10] best valid accuracy: 96.490 at epoch 6 
 best_stats: {'best_valid_epoch': 6, 'best_valid_valid/acc': 94.938, 'best_valid_valid/acc_unbiased': 96.49, 'best_valid_valid/diff': 3.356, 'best_valid_valid/acc_skew': 98.168, 'best_valid_valid/acc_align': 94.812, 'best_valid_test/acc': 89.47, 'best_valid_test/acc_unbiased': 91.095, 'best_valid_test/diff': 9.562, 'best_valid_test/acc_skew': 89.627, 'best_valid_test/acc_align': 92.563}
[6 / 10] best test accuracy: 92.096 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 94.552, 'best_test_valid/acc_unbiased': 96.071, 'best_test_valid/diff': 2.31, 'best_test_valid/acc_skew': 97.226, 'best_test_valid/acc_align': 94.916, 'best_test_test/acc': 90.854, 'best_test_test/acc_unbiased': 92.096, 'best_test_test/diff': 6.331, 'best_test_test/acc_skew': 90.794, 'best_test_test/acc_align': 93.399}
[7 / 10] Learning rate: 1e-05 weight: 0.01
[7 / 10] Loss: 4.368002563390691 CE Loss: 0.11519437687525069 Con Loss: 4.366850620511983
[7 / 10] tensor([[0.811, 0.954],
        [0.975, 0.846]]) {'epoch': 7, 'valid/acc': 95.824, 'valid/acc_unbiased': 96.908, 'valid/diff': 2.378, 'valid/acc_skew': 98.097, 'valid/acc_align': 95.719, 'test/acc': 89.48, 'test/acc_unbiased': 89.669, 'test/diff': 13.587, 'test/acc_skew': 89.333, 'test/acc_align': 90.006}
[7 / 10] best valid accuracy: 96.908 at epoch 7 
 best_stats: {'best_valid_epoch': 7, 'best_valid_valid/acc': 95.824, 'best_valid_valid/acc_unbiased': 96.908, 'best_valid_valid/diff': 2.378, 'best_valid_valid/acc_skew': 98.097, 'best_valid_valid/acc_align': 95.719, 'best_valid_test/acc': 89.48, 'best_valid_test/acc_unbiased': 89.669, 'best_valid_test/diff': 13.587, 'best_valid_test/acc_skew': 89.333, 'best_valid_test/acc_align': 90.006}
[7 / 10] best test accuracy: 92.096 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 94.552, 'best_test_valid/acc_unbiased': 96.071, 'best_test_valid/diff': 2.31, 'best_test_valid/acc_skew': 97.226, 'best_test_valid/acc_align': 94.916, 'best_test_test/acc': 90.854, 'best_test_test/acc_unbiased': 92.096, 'best_test_test/diff': 6.331, 'best_test_test/acc_skew': 90.794, 'best_test_test/acc_align': 93.399}
[8 / 10] Learning rate: 1e-05 weight: 0.01
[8 / 10] Loss: 4.363439366174066 CE Loss: 0.11288319593601566 Con Loss: 4.362310533787805
[8 / 10] tensor([[0.821, 0.956],
        [0.974, 0.852]]) {'epoch': 8, 'valid/acc': 95.915, 'valid/acc_unbiased': 96.88, 'valid/diff': 2.887, 'valid/acc_skew': 98.323, 'valid/acc_align': 95.436, 'test/acc': 89.988, 'test/acc_unbiased': 90.078, 'test/diff': 12.848, 'test/acc_skew': 89.767, 'test/acc_align': 90.389}
[8 / 10] best valid accuracy: 96.908 at epoch 7 
 best_stats: {'best_valid_epoch': 7, 'best_valid_valid/acc': 95.824, 'best_valid_valid/acc_unbiased': 96.908, 'best_valid_valid/diff': 2.378, 'best_valid_valid/acc_skew': 98.097, 'best_valid_valid/acc_align': 95.719, 'best_valid_test/acc': 89.48, 'best_valid_test/acc_unbiased': 89.669, 'best_valid_test/diff': 13.587, 'best_valid_test/acc_skew': 89.333, 'best_valid_test/acc_align': 90.006}
[8 / 10] best test accuracy: 92.096 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 94.552, 'best_test_valid/acc_unbiased': 96.071, 'best_test_valid/diff': 2.31, 'best_test_valid/acc_skew': 97.226, 'best_test_valid/acc_align': 94.916, 'best_test_test/acc': 90.854, 'best_test_test/acc_unbiased': 92.096, 'best_test_test/diff': 6.331, 'best_test_test/acc_skew': 90.794, 'best_test_test/acc_align': 93.399}
[9 / 10] Learning rate: 1e-05 weight: 0.01
[9 / 10] Loss: 4.360493241976155 CE Loss: 0.11123801180009456 Con Loss: 4.3593808607303925
[9 / 10] tensor([[0.808, 0.953],
        [0.973, 0.874]]) {'epoch': 9, 'valid/acc': 95.845, 'valid/acc_unbiased': 96.837, 'valid/diff': 2.979, 'valid/acc_skew': 98.326, 'valid/acc_align': 95.347, 'test/acc': 89.289, 'test/acc_unbiased': 90.195, 'test/diff': 12.195, 'test/acc_skew': 89.076, 'test/acc_align': 91.313}
[9 / 10] best valid accuracy: 96.908 at epoch 7 
 best_stats: {'best_valid_epoch': 7, 'best_valid_valid/acc': 95.824, 'best_valid_valid/acc_unbiased': 96.908, 'best_valid_valid/diff': 2.378, 'best_valid_valid/acc_skew': 98.097, 'best_valid_valid/acc_align': 95.719, 'best_valid_test/acc': 89.48, 'best_valid_test/acc_unbiased': 89.669, 'best_valid_test/diff': 13.587, 'best_valid_test/acc_skew': 89.333, 'best_valid_test/acc_align': 90.006}
[9 / 10] best test accuracy: 92.096 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 94.552, 'best_test_valid/acc_unbiased': 96.071, 'best_test_valid/diff': 2.31, 'best_test_valid/acc_skew': 97.226, 'best_test_valid/acc_align': 94.916, 'best_test_test/acc': 90.854, 'best_test_test/acc_unbiased': 92.096, 'best_test_test/diff': 6.331, 'best_test_test/acc_skew': 90.794, 'best_test_test/acc_align': 93.399}
[10 / 10] Learning rate: 1e-05 weight: 0.01
[10 / 10] Loss: 4.35524419462815 CE Loss: 0.11075615841390102 Con Loss: 4.354136635512487
[10 / 10] tensor([[0.820, 0.957],
        [0.972, 0.835]]) {'epoch': 10, 'valid/acc': 96.103, 'valid/acc_unbiased': 96.85, 'valid/diff': 2.902, 'valid/acc_skew': 98.301, 'valid/acc_align': 95.399, 'test/acc': 89.923, 'test/acc_unbiased': 89.609, 'test/diff': 13.733, 'test/acc_skew': 89.592, 'test/acc_align': 89.626}
[10 / 10] best valid accuracy: 96.908 at epoch 7 
 best_stats: {'best_valid_epoch': 7, 'best_valid_valid/acc': 95.824, 'best_valid_valid/acc_unbiased': 96.908, 'best_valid_valid/diff': 2.378, 'best_valid_valid/acc_skew': 98.097, 'best_valid_valid/acc_align': 95.719, 'best_valid_test/acc': 89.48, 'best_valid_test/acc_unbiased': 89.669, 'best_valid_test/diff': 13.587, 'best_valid_test/acc_skew': 89.333, 'best_valid_test/acc_align': 90.006}
[10 / 10] best test accuracy: 92.096 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 94.552, 'best_test_valid/acc_unbiased': 96.071, 'best_test_valid/diff': 2.31, 'best_test_valid/acc_skew': 97.226, 'best_test_valid/acc_align': 94.916, 'best_test_test/acc': 90.854, 'best_test_test/acc_unbiased': 92.096, 'best_test_test/diff': 6.331, 'best_test_test/acc_skew': 90.794, 'best_test_test/acc_align': 93.399}
Total training time: 3:05:57
