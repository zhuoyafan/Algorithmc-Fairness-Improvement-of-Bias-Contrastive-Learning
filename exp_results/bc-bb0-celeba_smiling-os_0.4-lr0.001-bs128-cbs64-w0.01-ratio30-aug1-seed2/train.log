Log level set to: INFO
Set seed: 2
=======> Using Fixed Random Seed: 2 <========
save_path: exp_results/bc-bb0-celeba_smiling-os_0.4-lr0.001-bs128-cbs64-w0.01-ratio30-aug1-seed2
get_celeba - split:train, aug: False, given_y: True, ratio: 0
use existing smiling indices from data/celeba/pickles/smiling
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [16244, 16244]
Target 1: [16244, 16244]
Binary Target 1
---------------------------
Target 0: [16244, 16244]
Target 1: [16244, 16244]
===================================
Normal Label Distribution: 
Target 0: [16244, 16244]
Target 1: [16244, 16244]
===================================
Use BiasedCelebASplit 
 target_attr: smiling split: train 
 tensor([[16244., 16244.],
        [16244., 16244.]])
get_celeba - split:train, aug: 1, given_y: True, ratio: 30
use existing smiling indices from data/celeba/pickles/smiling
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [16307, 16307]
Target 1: [16307, 16307]
Binary Target 1
---------------------------
Target 0: [16307, 16307]
Target 1: [16307, 16307]
===================================
Normal Label Distribution: 
Target 0: [16307, 16307]
Target 1: [16307, 16307]
===================================
Use BiasedCelebASplit 
 target_attr: smiling split: train 
 tensor([[16307., 16307.],
        [16307., 16307.]])
get_celeba - split:train_valid, aug: False, given_y: True, ratio: 0
use existing smiling indices from data/celeba/pickles/smiling
Use BiasedCelebASplit 
 target_attr: smiling split: train_valid 
 tensor([[ 1973., 10114.],
        [ 8289.,  1989.]])
get_celeba - split:valid, aug: False, given_y: True, ratio: 0
Use BiasedCelebASplit 
 target_attr: smiling split: valid 
 tensor([[5252., 6157.],
        [5013., 3445.]])
decay_epochs: [3, 6]
[1 / 10] Learning rate: 0.001 weight: 0.01
[1 / 10] Loss: 4.65680341795729 CE Loss: 0.2746781278231907 Con Loss: 4.654056641833003
[1 / 10] tensor([[0.909, 0.897],
        [0.922, 0.909]]) {'epoch': 1, 'valid/acc': 90.637, 'valid/acc_unbiased': 90.662, 'valid/diff': 2.081, 'valid/acc_skew': 91.702, 'valid/acc_align': 89.621, 'test/acc': 90.99, 'test/acc_unbiased': 90.911, 'test/diff': 1.298, 'test/acc_skew': 91.559, 'test/acc_align': 90.262}
[1 / 10] best valid accuracy: 90.662 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 90.637, 'best_valid_valid/acc_unbiased': 90.662, 'best_valid_valid/diff': 2.081, 'best_valid_valid/acc_skew': 91.702, 'best_valid_valid/acc_align': 89.621, 'best_valid_test/acc': 90.99, 'best_valid_test/acc_unbiased': 90.911, 'best_valid_test/diff': 1.298, 'best_valid_test/acc_skew': 91.559, 'best_valid_test/acc_align': 90.262}
[1 / 10] best test accuracy: 90.911 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 90.637, 'best_test_valid/acc_unbiased': 90.662, 'best_test_valid/diff': 2.081, 'best_test_valid/acc_skew': 91.702, 'best_test_valid/acc_align': 89.621, 'best_test_test/acc': 90.99, 'best_test_test/acc_unbiased': 90.911, 'best_test_test/diff': 1.298, 'best_test_test/acc_skew': 91.559, 'best_test_test/acc_align': 90.262}
[2 / 10] Learning rate: 0.001 weight: 0.01
[2 / 10] Loss: 4.612843700419268 CE Loss: 0.24144242913800487 Con Loss: 4.610429276506527
[2 / 10] tensor([[0.968, 0.960],
        [0.860, 0.836]]) {'epoch': 2, 'valid/acc': 90.414, 'valid/acc_unbiased': 90.593, 'valid/diff': 1.658, 'valid/acc_skew': 91.422, 'valid/acc_align': 89.764, 'test/acc': 90.99, 'test/acc_unbiased': 90.627, 'test/diff': 1.634, 'test/acc_skew': 91.444, 'test/acc_align': 89.809}
[2 / 10] best valid accuracy: 90.662 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 90.637, 'best_valid_valid/acc_unbiased': 90.662, 'best_valid_valid/diff': 2.081, 'best_valid_valid/acc_skew': 91.702, 'best_valid_valid/acc_align': 89.621, 'best_valid_test/acc': 90.99, 'best_valid_test/acc_unbiased': 90.911, 'best_valid_test/diff': 1.298, 'best_valid_test/acc_skew': 91.559, 'best_valid_test/acc_align': 90.262}
[2 / 10] best test accuracy: 90.911 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 90.637, 'best_test_valid/acc_unbiased': 90.662, 'best_test_valid/diff': 2.081, 'best_test_valid/acc_skew': 91.702, 'best_test_valid/acc_align': 89.621, 'best_test_test/acc': 90.99, 'best_test_test/acc_unbiased': 90.911, 'best_test_test/diff': 1.298, 'best_test_test/acc_skew': 91.559, 'best_test_test/acc_align': 90.262}
[3 / 10] Learning rate: 0.001 weight: 0.01
[3 / 10] Loss: 4.597407537562247 CE Loss: 0.23644519345392237 Con Loss: 4.595043089729728
[3 / 10] tensor([[0.984, 0.974],
        [0.809, 0.801]]) {'epoch': 3, 'valid/acc': 88.343, 'valid/acc_unbiased': 88.837, 'valid/diff': 1.546, 'valid/acc_skew': 89.61, 'valid/acc_align': 88.064, 'test/acc': 89.566, 'test/acc_unbiased': 89.212, 'test/diff': 0.911, 'test/acc_skew': 89.668, 'test/acc_align': 88.757}
[3 / 10] best valid accuracy: 90.662 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 90.637, 'best_valid_valid/acc_unbiased': 90.662, 'best_valid_valid/diff': 2.081, 'best_valid_valid/acc_skew': 91.702, 'best_valid_valid/acc_align': 89.621, 'best_valid_test/acc': 90.99, 'best_valid_test/acc_unbiased': 90.911, 'best_valid_test/diff': 1.298, 'best_valid_test/acc_skew': 91.559, 'best_valid_test/acc_align': 90.262}
[3 / 10] best test accuracy: 90.911 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 90.637, 'best_test_valid/acc_unbiased': 90.662, 'best_test_valid/diff': 2.081, 'best_test_valid/acc_skew': 91.702, 'best_test_valid/acc_align': 89.621, 'best_test_test/acc': 90.99, 'best_test_test/acc_unbiased': 90.911, 'best_test_test/diff': 1.298, 'best_test_test/acc_skew': 91.559, 'best_test_test/acc_align': 90.262}
[4 / 10] Learning rate: 0.0001 weight: 0.01
[4 / 10] Loss: 4.565198290321634 CE Loss: 0.20430853282603922 Con Loss: 4.563155202905523
[4 / 10] tensor([[0.946, 0.928],
        [0.917, 0.907]]) {'epoch': 4, 'valid/acc': 92.336, 'valid/acc_unbiased': 92.414, 'valid/diff': 1.35, 'valid/acc_skew': 93.089, 'valid/acc_align': 91.739, 'test/acc': 92.54, 'test/acc_unbiased': 92.423, 'test/diff': 1.376, 'test/acc_skew': 93.111, 'test/acc_align': 91.735}
[4 / 10] best valid accuracy: 92.414 at epoch 4 
 best_stats: {'best_valid_epoch': 4, 'best_valid_valid/acc': 92.336, 'best_valid_valid/acc_unbiased': 92.414, 'best_valid_valid/diff': 1.35, 'best_valid_valid/acc_skew': 93.089, 'best_valid_valid/acc_align': 91.739, 'best_valid_test/acc': 92.54, 'best_valid_test/acc_unbiased': 92.423, 'best_valid_test/diff': 1.376, 'best_valid_test/acc_skew': 93.111, 'best_valid_test/acc_align': 91.735}
[4 / 10] best test accuracy: 92.423 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 92.336, 'best_test_valid/acc_unbiased': 92.414, 'best_test_valid/diff': 1.35, 'best_test_valid/acc_skew': 93.089, 'best_test_valid/acc_align': 91.739, 'best_test_test/acc': 92.54, 'best_test_test/acc_unbiased': 92.423, 'best_test_test/diff': 1.376, 'best_test_test/acc_skew': 93.111, 'best_test_test/acc_align': 91.735}
[5 / 10] Learning rate: 0.0001 weight: 0.01
[5 / 10] Loss: 4.54455442259506 CE Loss: 0.20081324332293488 Con Loss: 4.542546285311302
[5 / 10] tensor([[0.939, 0.915],
        [0.927, 0.922]]) {'epoch': 5, 'valid/acc': 92.336, 'valid/acc_unbiased': 92.506, 'valid/diff': 1.108, 'valid/acc_skew': 93.06, 'valid/acc_align': 91.953, 'test/acc': 92.631, 'test/acc_unbiased': 92.573, 'test/diff': 1.462, 'test/acc_skew': 93.304, 'test/acc_align': 91.842}
[5 / 10] best valid accuracy: 92.506 at epoch 5 
 best_stats: {'best_valid_epoch': 5, 'best_valid_valid/acc': 92.336, 'best_valid_valid/acc_unbiased': 92.506, 'best_valid_valid/diff': 1.108, 'best_valid_valid/acc_skew': 93.06, 'best_valid_valid/acc_align': 91.953, 'best_valid_test/acc': 92.631, 'best_valid_test/acc_unbiased': 92.573, 'best_valid_test/diff': 1.462, 'best_valid_test/acc_skew': 93.304, 'best_valid_test/acc_align': 91.842}
[5 / 10] best test accuracy: 92.573 at epoch 5 
 best_stats: {'best_test_epoch': 5, 'best_test_valid/acc': 92.336, 'best_test_valid/acc_unbiased': 92.506, 'best_test_valid/diff': 1.108, 'best_test_valid/acc_skew': 93.06, 'best_test_valid/acc_align': 91.953, 'best_test_test/acc': 92.631, 'best_test_test/acc_unbiased': 92.573, 'best_test_test/diff': 1.462, 'best_test_test/acc_skew': 93.304, 'best_test_test/acc_align': 91.842}
[6 / 10] Learning rate: 0.0001 weight: 0.01
[6 / 10] Loss: 4.538274182148445 CE Loss: 0.19866432148639393 Con Loss: 4.536287540345613
[6 / 10] tensor([[0.950, 0.948],
        [0.913, 0.889]]) {'epoch': 6, 'valid/acc': 92.6, 'valid/acc_unbiased': 92.388, 'valid/diff': 1.351, 'valid/acc_skew': 93.064, 'valid/acc_align': 91.713, 'test/acc': 92.757, 'test/acc_unbiased': 92.515, 'test/diff': 1.256, 'test/acc_skew': 93.143, 'test/acc_align': 91.887}
[6 / 10] best valid accuracy: 92.506 at epoch 5 
 best_stats: {'best_valid_epoch': 5, 'best_valid_valid/acc': 92.336, 'best_valid_valid/acc_unbiased': 92.506, 'best_valid_valid/diff': 1.108, 'best_valid_valid/acc_skew': 93.06, 'best_valid_valid/acc_align': 91.953, 'best_valid_test/acc': 92.631, 'best_valid_test/acc_unbiased': 92.573, 'best_valid_test/diff': 1.462, 'best_valid_test/acc_skew': 93.304, 'best_valid_test/acc_align': 91.842}
[6 / 10] best test accuracy: 92.573 at epoch 5 
 best_stats: {'best_test_epoch': 5, 'best_test_valid/acc': 92.336, 'best_test_valid/acc_unbiased': 92.506, 'best_test_valid/diff': 1.108, 'best_test_valid/acc_skew': 93.06, 'best_test_valid/acc_align': 91.953, 'best_test_test/acc': 92.631, 'best_test_test/acc_unbiased': 92.573, 'best_test_test/diff': 1.462, 'best_test_test/acc_skew': 93.304, 'best_test_test/acc_align': 91.842}
[7 / 10] Learning rate: 1e-05 weight: 0.01
[7 / 10] Loss: 4.539456464715323 CE Loss: 0.19403774862041676 Con Loss: 4.537516093494798
[7 / 10] tensor([[0.933, 0.925],
        [0.930, 0.916]]) {'epoch': 7, 'valid/acc': 92.743, 'valid/acc_unbiased': 92.581, 'valid/diff': 1.016, 'valid/acc_skew': 93.089, 'valid/acc_align': 92.073, 'test/acc': 92.727, 'test/acc_unbiased': 92.614, 'test/diff': 1.107, 'test/acc_skew': 93.168, 'test/acc_align': 92.061}
[7 / 10] best valid accuracy: 92.581 at epoch 7 
 best_stats: {'best_valid_epoch': 7, 'best_valid_valid/acc': 92.743, 'best_valid_valid/acc_unbiased': 92.581, 'best_valid_valid/diff': 1.016, 'best_valid_valid/acc_skew': 93.089, 'best_valid_valid/acc_align': 92.073, 'best_valid_test/acc': 92.727, 'best_valid_test/acc_unbiased': 92.614, 'best_valid_test/diff': 1.107, 'best_valid_test/acc_skew': 93.168, 'best_valid_test/acc_align': 92.061}
[7 / 10] best test accuracy: 92.614 at epoch 7 
 best_stats: {'best_test_epoch': 7, 'best_test_valid/acc': 92.743, 'best_test_valid/acc_unbiased': 92.581, 'best_test_valid/diff': 1.016, 'best_test_valid/acc_skew': 93.089, 'best_test_valid/acc_align': 92.073, 'best_test_test/acc': 92.727, 'best_test_test/acc_unbiased': 92.614, 'best_test_test/diff': 1.107, 'best_test_test/acc_skew': 93.168, 'best_test_test/acc_align': 92.061}
[8 / 10] Learning rate: 1e-05 weight: 0.01
[8 / 10] Loss: 4.538853792802538 CE Loss: 0.1933007053746522 Con Loss: 4.536920780443963
[8 / 10] tensor([[0.937, 0.930],
        [0.931, 0.913]]) {'epoch': 8, 'valid/acc': 92.636, 'valid/acc_unbiased': 92.486, 'valid/diff': 1.232, 'valid/acc_skew': 93.102, 'valid/acc_align': 91.87, 'test/acc': 92.903, 'test/acc_unbiased': 92.76, 'test/diff': 1.24, 'test/acc_skew': 93.38, 'test/acc_align': 92.14}
[8 / 10] best valid accuracy: 92.581 at epoch 7 
 best_stats: {'best_valid_epoch': 7, 'best_valid_valid/acc': 92.743, 'best_valid_valid/acc_unbiased': 92.581, 'best_valid_valid/diff': 1.016, 'best_valid_valid/acc_skew': 93.089, 'best_valid_valid/acc_align': 92.073, 'best_valid_test/acc': 92.727, 'best_valid_test/acc_unbiased': 92.614, 'best_valid_test/diff': 1.107, 'best_valid_test/acc_skew': 93.168, 'best_valid_test/acc_align': 92.061}
[8 / 10] best test accuracy: 92.760 at epoch 8 
 best_stats: {'best_test_epoch': 8, 'best_test_valid/acc': 92.636, 'best_test_valid/acc_unbiased': 92.486, 'best_test_valid/diff': 1.232, 'best_test_valid/acc_skew': 93.102, 'best_test_valid/acc_align': 91.87, 'best_test_test/acc': 92.903, 'best_test_test/acc_unbiased': 92.76, 'best_test_test/diff': 1.24, 'best_test_test/acc_skew': 93.38, 'best_test_test/acc_align': 92.14}
[9 / 10] Learning rate: 1e-05 weight: 0.01
[9 / 10] Loss: 4.526053974646648 CE Loss: 0.192676579374687 Con Loss: 4.5241272048508705
[9 / 10] tensor([[0.938, 0.927],
        [0.928, 0.913]]) {'epoch': 9, 'valid/acc': 92.658, 'valid/acc_unbiased': 92.492, 'valid/diff': 1.171, 'valid/acc_skew': 93.077, 'valid/acc_align': 91.906, 'test/acc': 92.752, 'test/acc_unbiased': 92.624, 'test/diff': 1.296, 'test/acc_skew': 93.272, 'test/acc_align': 91.975}
[9 / 10] best valid accuracy: 92.581 at epoch 7 
 best_stats: {'best_valid_epoch': 7, 'best_valid_valid/acc': 92.743, 'best_valid_valid/acc_unbiased': 92.581, 'best_valid_valid/diff': 1.016, 'best_valid_valid/acc_skew': 93.089, 'best_valid_valid/acc_align': 92.073, 'best_valid_test/acc': 92.727, 'best_valid_test/acc_unbiased': 92.614, 'best_valid_test/diff': 1.107, 'best_valid_test/acc_skew': 93.168, 'best_valid_test/acc_align': 92.061}
[9 / 10] best test accuracy: 92.760 at epoch 8 
 best_stats: {'best_test_epoch': 8, 'best_test_valid/acc': 92.636, 'best_test_valid/acc_unbiased': 92.486, 'best_test_valid/diff': 1.232, 'best_test_valid/acc_skew': 93.102, 'best_test_valid/acc_align': 91.87, 'best_test_test/acc': 92.903, 'best_test_test/acc_unbiased': 92.76, 'best_test_test/diff': 1.24, 'best_test_test/acc_skew': 93.38, 'best_test_test/acc_align': 92.14}
[10 / 10] Learning rate: 1e-05 weight: 0.01
[10 / 10] Loss: 4.534261867407653 CE Loss: 0.19155551224939638 Con Loss: 4.53234630087801
[10 / 10] tensor([[0.941, 0.927],
        [0.928, 0.912]]) {'epoch': 10, 'valid/acc': 92.743, 'valid/acc_unbiased': 92.77, 'valid/diff': 1.486, 'valid/acc_skew': 93.513, 'valid/acc_align': 92.027, 'test/acc': 92.837, 'test/acc_unbiased': 92.699, 'test/diff': 1.494, 'test/acc_skew': 93.446, 'test/acc_align': 91.952}
[10 / 10] best valid accuracy: 92.770 at epoch 10 
 best_stats: {'best_valid_epoch': 10, 'best_valid_valid/acc': 92.743, 'best_valid_valid/acc_unbiased': 92.77, 'best_valid_valid/diff': 1.486, 'best_valid_valid/acc_skew': 93.513, 'best_valid_valid/acc_align': 92.027, 'best_valid_test/acc': 92.837, 'best_valid_test/acc_unbiased': 92.699, 'best_valid_test/diff': 1.494, 'best_valid_test/acc_skew': 93.446, 'best_valid_test/acc_align': 91.952}
[10 / 10] best test accuracy: 92.760 at epoch 8 
 best_stats: {'best_test_epoch': 8, 'best_test_valid/acc': 92.636, 'best_test_valid/acc_unbiased': 92.486, 'best_test_valid/diff': 1.232, 'best_test_valid/acc_skew': 93.102, 'best_test_valid/acc_align': 91.87, 'best_test_test/acc': 92.903, 'best_test_test/acc_unbiased': 92.76, 'best_test_test/diff': 1.24, 'best_test_test/acc_skew': 93.38, 'best_test_test/acc_align': 92.14}
Total training time: 1:10:26
