Log level set to: INFO
Set seed: 2
=======> Using Fixed Random Seed: 2 <========
save_path: exp_results/bc-bb0-utk_face_race-test-0.995-lr0.001-bs128-cbs64-w0.01-ratio10-aug1-seed2
get_utk_face - split: train, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_race-0.995
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [4407, 27]
Target 1: [22, 5529]
Binary Target 1
---------------------------
Target 0: [4407, 27]
Target 1: [22, 5529]
===================================
Normal Label Distribution: 
Target 0: [4407, 27]
Target 1: [22, 5529]
===================================
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [4407, 27]
Target 1: [22, 5529]
Binary Target 1
---------------------------
Target 0: [4407, 27]
Target 1: [22, 5529]
===================================
Normal Label Distribution: 
Target 0: [4407, 27]
Target 1: [22, 5529]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 9985, target_attr: gender, bias_attr: race bias_rate: 0.995
['[train] target_0-bias_0: 4407', '[train] target_0-bias_1: 27', '[train] target_1-bias_0: 22', '[train] target_1-bias_1: 5529']
confusion_matrix - 
 original: tensor([[4407.,   22.],
        [  27., 5529.]]), 
 normalized: tensor([[0.995, 0.005],
        [0.005, 0.995]]), 
 b|y: tensor([[0.994, 0.006],
        [0.004, 0.996]])
get_utk_face - split: train, aug: 1, given_y: True, ratio: 10
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_race-0.995
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [4407, 27]
Target 1: [22, 5529]
Binary Target 1
---------------------------
Target 0: [4407, 27]
Target 1: [22, 5529]
===================================
Normal Label Distribution: 
Target 0: [4407, 27]
Target 1: [22, 5529]
===================================
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [4407, 27]
Target 1: [22, 5529]
Binary Target 1
---------------------------
Target 0: [4407, 27]
Target 1: [22, 5529]
===================================
Normal Label Distribution: 
Target 0: [4407, 27]
Target 1: [22, 5529]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 9985, target_attr: gender, bias_attr: race bias_rate: 0.995
['[train] target_0-bias_0: 4407', '[train] target_0-bias_1: 27', '[train] target_1-bias_0: 22', '[train] target_1-bias_1: 5529']
get_utk_face - split: valid, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_race-0.995
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [583, 684]
Target 1: [457, 646]
Binary Target 1
---------------------------
Target 0: [583, 684]
Target 1: [457, 646]
===================================
Normal Label Distribution: 
Target 0: [583, 684]
Target 1: [457, 646]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 2370, target_attr: gender, bias_attr: race bias_rate: 0.995
['[valid] target_0-bias_0: 583', '[valid] target_0-bias_1: 684', '[valid] target_1-bias_0: 457', '[valid] target_1-bias_1: 646']
get_utk_face - split: test, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_race-0.995
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [558, 677]
Target 1: [462, 673]
Binary Target 1
---------------------------
Target 0: [558, 677]
Target 1: [462, 673]
===================================
Normal Label Distribution: 
Target 0: [558, 677]
Target 1: [462, 673]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 2370, target_attr: gender, bias_attr: race bias_rate: 0.995
['[test] target_0-bias_0: 558', '[test] target_0-bias_1: 677', '[test] target_1-bias_0: 462', '[test] target_1-bias_1: 673']
decay_epochs: [6, 13]
[1 / 20] Learning rate: 0.001 weight: 0.01
[1 / 20] Loss: 3.940116428851365 CE Loss: 0.6868238643401255 Con Loss: 3.933248194205982
[1 / 20] tensor([[0.000, 0.001],
        [1.000, 0.999]]) {'epoch': 1, 'valid/acc': 46.667, 'valid/acc_unbiased': 50.122, 'valid/diff': 0.098, 'valid/acc_skew': 50.073, 'valid/acc_align': 50.172, 'test/acc': 47.89, 'test/acc_unbiased': 50.0, 'test/diff': 0.148, 'test/acc_skew': 50.074, 'test/acc_align': 49.926}
[1 / 20] best valid accuracy: 50.122 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 46.667, 'best_valid_valid/acc_unbiased': 50.122, 'best_valid_valid/diff': 0.098, 'best_valid_valid/acc_skew': 50.073, 'best_valid_valid/acc_align': 50.172, 'best_valid_test/acc': 47.89, 'best_valid_test/acc_unbiased': 50.0, 'best_valid_test/diff': 0.148, 'best_valid_test/acc_skew': 50.074, 'best_valid_test/acc_align': 49.926}
[1 / 20] best test accuracy: 50.000 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 46.667, 'best_test_valid/acc_unbiased': 50.122, 'best_test_valid/diff': 0.098, 'best_test_valid/acc_skew': 50.073, 'best_test_valid/acc_align': 50.172, 'best_test_test/acc': 47.89, 'best_test_test/acc_unbiased': 50.0, 'best_test_test/diff': 0.148, 'best_test_test/acc_skew': 50.074, 'best_test_test/acc_align': 49.926}
[2 / 20] Learning rate: 0.001 weight: 0.01
[2 / 20] Loss: 3.7876303172075696 CE Loss: 0.6848416621140617 Con Loss: 3.7807818855472846
[2 / 20] tensor([[0., 0.],
        [1., 1.]]) {'epoch': 2, 'valid/acc': 46.54, 'valid/acc_unbiased': 50.0, 'valid/diff': 0.0, 'valid/acc_skew': 50.0, 'valid/acc_align': 50.0, 'test/acc': 47.89, 'test/acc_unbiased': 50.0, 'test/diff': 0.0, 'test/acc_skew': 50.0, 'test/acc_align': 50.0}
[2 / 20] best valid accuracy: 50.122 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 46.667, 'best_valid_valid/acc_unbiased': 50.122, 'best_valid_valid/diff': 0.098, 'best_valid_valid/acc_skew': 50.073, 'best_valid_valid/acc_align': 50.172, 'best_valid_test/acc': 47.89, 'best_valid_test/acc_unbiased': 50.0, 'best_valid_test/diff': 0.148, 'best_valid_test/acc_skew': 50.074, 'best_valid_test/acc_align': 49.926}
[2 / 20] best test accuracy: 50.000 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 46.54, 'best_test_valid/acc_unbiased': 50.0, 'best_test_valid/diff': 0.0, 'best_test_valid/acc_skew': 50.0, 'best_test_valid/acc_align': 50.0, 'best_test_test/acc': 47.89, 'best_test_test/acc_unbiased': 50.0, 'best_test_test/diff': 0.0, 'best_test_test/acc_skew': 50.0, 'best_test_test/acc_align': 50.0}
[3 / 20] Learning rate: 0.001 weight: 0.01
[3 / 20] Loss: 3.5800636278311493 CE Loss: 0.6744911406538041 Con Loss: 3.573318754605908
[3 / 20] tensor([[0.039, 0.032],
        [0.987, 0.987]]) {'epoch': 3, 'valid/acc': 47.679, 'valid/acc_unbiased': 51.018, 'valid/diff': 1.254, 'valid/acc_skew': 51.645, 'valid/acc_align': 50.391, 'test/acc': 49.114, 'test/acc_unbiased': 51.139, 'test/diff': 0.366, 'test/acc_skew': 50.975, 'test/acc_align': 51.303}
[3 / 20] best valid accuracy: 51.018 at epoch 3 
 best_stats: {'best_valid_epoch': 3, 'best_valid_valid/acc': 47.679, 'best_valid_valid/acc_unbiased': 51.018, 'best_valid_valid/diff': 1.254, 'best_valid_valid/acc_skew': 51.645, 'best_valid_valid/acc_align': 50.391, 'best_valid_test/acc': 49.114, 'best_valid_test/acc_unbiased': 51.139, 'best_valid_test/diff': 0.366, 'best_valid_test/acc_skew': 50.975, 'best_valid_test/acc_align': 51.303}
[3 / 20] best test accuracy: 51.139 at epoch 3 
 best_stats: {'best_test_epoch': 3, 'best_test_valid/acc': 47.679, 'best_test_valid/acc_unbiased': 51.018, 'best_test_valid/diff': 1.254, 'best_test_valid/acc_skew': 51.645, 'best_test_valid/acc_align': 50.391, 'best_test_test/acc': 49.114, 'best_test_test/acc_unbiased': 51.139, 'best_test_test/diff': 0.366, 'best_test_test/acc_skew': 50.975, 'best_test_test/acc_align': 51.303}
[4 / 20] Learning rate: 0.001 weight: 0.01
[4 / 20] Loss: 3.762546555680756 CE Loss: 0.6994374046220622 Con Loss: 3.755552179740558
[4 / 20] tensor([[0.916, 0.877],
        [0.093, 0.152]]) {'epoch': 4, 'valid/acc': 54.599, 'valid/acc_unbiased': 51.766, 'valid/diff': 4.58, 'valid/acc_skew': 49.476, 'valid/acc_align': 54.056, 'test/acc': 52.743, 'test/acc_unbiased': 50.945, 'test/diff': 4.843, 'test/acc_skew': 48.524, 'test/acc_align': 53.367}
[4 / 20] best valid accuracy: 51.766 at epoch 4 
 best_stats: {'best_valid_epoch': 4, 'best_valid_valid/acc': 54.599, 'best_valid_valid/acc_unbiased': 51.766, 'best_valid_valid/diff': 4.58, 'best_valid_valid/acc_skew': 49.476, 'best_valid_valid/acc_align': 54.056, 'best_valid_test/acc': 52.743, 'best_valid_test/acc_unbiased': 50.945, 'best_valid_test/diff': 4.843, 'best_valid_test/acc_skew': 48.524, 'best_valid_test/acc_align': 53.367}
[4 / 20] best test accuracy: 51.139 at epoch 3 
 best_stats: {'best_test_epoch': 3, 'best_test_valid/acc': 47.679, 'best_test_valid/acc_unbiased': 51.018, 'best_test_valid/diff': 1.254, 'best_test_valid/acc_skew': 51.645, 'best_test_valid/acc_align': 50.391, 'best_test_test/acc': 49.114, 'best_test_test/acc_unbiased': 51.139, 'best_test_test/diff': 0.366, 'best_test_test/acc_skew': 50.975, 'best_test_test/acc_align': 51.303}
[5 / 20] Learning rate: 0.001 weight: 0.01
[5 / 20] Loss: 3.792381664037585 CE Loss: 0.7081257349440737 Con Loss: 3.7853004127725938
[5 / 20] tensor([[0., 0.],
        [1., 1.]]) {'epoch': 5, 'valid/acc': 46.54, 'valid/acc_unbiased': 50.0, 'valid/diff': 0.0, 'valid/acc_skew': 50.0, 'valid/acc_align': 50.0, 'test/acc': 47.89, 'test/acc_unbiased': 50.0, 'test/diff': 0.0, 'test/acc_skew': 50.0, 'test/acc_align': 50.0}
[5 / 20] best valid accuracy: 51.766 at epoch 4 
 best_stats: {'best_valid_epoch': 4, 'best_valid_valid/acc': 54.599, 'best_valid_valid/acc_unbiased': 51.766, 'best_valid_valid/diff': 4.58, 'best_valid_valid/acc_skew': 49.476, 'best_valid_valid/acc_align': 54.056, 'best_valid_test/acc': 52.743, 'best_valid_test/acc_unbiased': 50.945, 'best_valid_test/diff': 4.843, 'best_valid_test/acc_skew': 48.524, 'best_valid_test/acc_align': 53.367}
[5 / 20] best test accuracy: 51.139 at epoch 3 
 best_stats: {'best_test_epoch': 3, 'best_test_valid/acc': 47.679, 'best_test_valid/acc_unbiased': 51.018, 'best_test_valid/diff': 1.254, 'best_test_valid/acc_skew': 51.645, 'best_test_valid/acc_align': 50.391, 'best_test_test/acc': 49.114, 'best_test_test/acc_unbiased': 51.139, 'best_test_test/diff': 0.366, 'best_test_test/acc_skew': 50.975, 'best_test_test/acc_align': 51.303}
[6 / 20] Learning rate: 0.001 weight: 0.01
[6 / 20] Loss: 3.9379024947113432 CE Loss: 0.6873899402711531 Con Loss: 3.9310285723442187
[6 / 20] tensor([[0.014, 0.015],
        [0.994, 0.982]]) {'epoch': 6, 'valid/acc': 46.751, 'valid/acc_unbiased': 50.112, 'valid/diff': 0.22, 'valid/acc_skew': 50.001, 'valid/acc_align': 50.222, 'test/acc': 48.017, 'test/acc_unbiased': 50.12, 'test/diff': 0.589, 'test/acc_skew': 50.414, 'test/acc_align': 49.825}
[6 / 20] best valid accuracy: 51.766 at epoch 4 
 best_stats: {'best_valid_epoch': 4, 'best_valid_valid/acc': 54.599, 'best_valid_valid/acc_unbiased': 51.766, 'best_valid_valid/diff': 4.58, 'best_valid_valid/acc_skew': 49.476, 'best_valid_valid/acc_align': 54.056, 'best_valid_test/acc': 52.743, 'best_valid_test/acc_unbiased': 50.945, 'best_valid_test/diff': 4.843, 'best_valid_test/acc_skew': 48.524, 'best_valid_test/acc_align': 53.367}
[6 / 20] best test accuracy: 51.139 at epoch 3 
 best_stats: {'best_test_epoch': 3, 'best_test_valid/acc': 47.679, 'best_test_valid/acc_unbiased': 51.018, 'best_test_valid/diff': 1.254, 'best_test_valid/acc_skew': 51.645, 'best_test_valid/acc_align': 50.391, 'best_test_test/acc': 49.114, 'best_test_test/acc_unbiased': 51.139, 'best_test_test/diff': 0.366, 'best_test_test/acc_skew': 50.975, 'best_test_test/acc_align': 51.303}
[7 / 20] Learning rate: 0.0001 weight: 0.01
[7 / 20] Loss: 3.4241605684228342 CE Loss: 0.6813235476038488 Con Loss: 3.41734736456415
[7 / 20] tensor([[0.013, 0.012],
        [0.998, 0.988]]) {'epoch': 7, 'valid/acc': 46.92, 'valid/acc_unbiased': 50.305, 'valid/diff': 0.231, 'valid/acc_skew': 50.293, 'valid/acc_align': 50.316, 'test/acc': 48.143, 'test/acc_unbiased': 50.258, 'test/diff': 0.523, 'test/acc_skew': 50.483, 'test/acc_align': 50.033}
[7 / 20] best valid accuracy: 51.766 at epoch 4 
 best_stats: {'best_valid_epoch': 4, 'best_valid_valid/acc': 54.599, 'best_valid_valid/acc_unbiased': 51.766, 'best_valid_valid/diff': 4.58, 'best_valid_valid/acc_skew': 49.476, 'best_valid_valid/acc_align': 54.056, 'best_valid_test/acc': 52.743, 'best_valid_test/acc_unbiased': 50.945, 'best_valid_test/diff': 4.843, 'best_valid_test/acc_skew': 48.524, 'best_valid_test/acc_align': 53.367}
[7 / 20] best test accuracy: 51.139 at epoch 3 
 best_stats: {'best_test_epoch': 3, 'best_test_valid/acc': 47.679, 'best_test_valid/acc_unbiased': 51.018, 'best_test_valid/diff': 1.254, 'best_test_valid/acc_skew': 51.645, 'best_test_valid/acc_align': 50.391, 'best_test_test/acc': 49.114, 'best_test_test/acc_unbiased': 51.139, 'best_test_test/diff': 0.366, 'best_test_test/acc_skew': 50.975, 'best_test_test/acc_align': 51.303}
[8 / 20] Learning rate: 0.0001 weight: 0.01
[8 / 20] Loss: 3.6633425200886887 CE Loss: 0.6784056409275645 Con Loss: 3.6565584507953184
[8 / 20] tensor([[0.065, 0.046],
        [0.970, 0.960]]) {'epoch': 8, 'valid/acc': 47.046, 'valid/acc_unbiased': 50.176, 'valid/diff': 2.021, 'valid/acc_skew': 49.165, 'valid/acc_align': 51.186, 'test/acc': 48.987, 'test/acc_unbiased': 50.997, 'test/diff': 1.427, 'test/acc_skew': 50.774, 'test/acc_align': 51.22}
[8 / 20] best valid accuracy: 51.766 at epoch 4 
 best_stats: {'best_valid_epoch': 4, 'best_valid_valid/acc': 54.599, 'best_valid_valid/acc_unbiased': 51.766, 'best_valid_valid/diff': 4.58, 'best_valid_valid/acc_skew': 49.476, 'best_valid_valid/acc_align': 54.056, 'best_valid_test/acc': 52.743, 'best_valid_test/acc_unbiased': 50.945, 'best_valid_test/diff': 4.843, 'best_valid_test/acc_skew': 48.524, 'best_valid_test/acc_align': 53.367}
[8 / 20] best test accuracy: 51.139 at epoch 3 
 best_stats: {'best_test_epoch': 3, 'best_test_valid/acc': 47.679, 'best_test_valid/acc_unbiased': 51.018, 'best_test_valid/diff': 1.254, 'best_test_valid/acc_skew': 51.645, 'best_test_valid/acc_align': 50.391, 'best_test_test/acc': 49.114, 'best_test_test/acc_unbiased': 51.139, 'best_test_test/diff': 0.366, 'best_test_test/acc_skew': 50.975, 'best_test_test/acc_align': 51.303}
[9 / 20] Learning rate: 0.0001 weight: 0.01
[9 / 20] Loss: 3.5162499697553438 CE Loss: 0.676706848012607 Con Loss: 3.5094829071266505
[9 / 20] tensor([[0.029, 0.021],
        [0.989, 0.988]]) {'epoch': 9, 'valid/acc': 47.384, 'valid/acc_unbiased': 50.731, 'valid/diff': 1.604, 'valid/acc_skew': 49.929, 'valid/acc_align': 51.533, 'test/acc': 48.608, 'test/acc_unbiased': 50.666, 'test/diff': 0.453, 'test/acc_skew': 50.493, 'test/acc_align': 50.839}
[9 / 20] best valid accuracy: 51.766 at epoch 4 
 best_stats: {'best_valid_epoch': 4, 'best_valid_valid/acc': 54.599, 'best_valid_valid/acc_unbiased': 51.766, 'best_valid_valid/diff': 4.58, 'best_valid_valid/acc_skew': 49.476, 'best_valid_valid/acc_align': 54.056, 'best_valid_test/acc': 52.743, 'best_valid_test/acc_unbiased': 50.945, 'best_valid_test/diff': 4.843, 'best_valid_test/acc_skew': 48.524, 'best_valid_test/acc_align': 53.367}
[9 / 20] best test accuracy: 51.139 at epoch 3 
 best_stats: {'best_test_epoch': 3, 'best_test_valid/acc': 47.679, 'best_test_valid/acc_unbiased': 51.018, 'best_test_valid/diff': 1.254, 'best_test_valid/acc_skew': 51.645, 'best_test_valid/acc_align': 50.391, 'best_test_test/acc': 49.114, 'best_test_test/acc_unbiased': 51.139, 'best_test_test/diff': 0.366, 'best_test_test/acc_skew': 50.975, 'best_test_test/acc_align': 51.303}
[10 / 20] Learning rate: 0.0001 weight: 0.01
[10 / 20] Loss: 3.7371598021889785 CE Loss: 0.6682611425100832 Con Loss: 3.7304771670234995
[10 / 20] tensor([[0.127, 0.081],
        [0.905, 0.930]]) {'epoch': 10, 'valid/acc': 47.89, 'valid/acc_unbiased': 50.817, 'valid/diff': 4.537, 'valid/acc_skew': 48.548, 'valid/acc_align': 53.085, 'test/acc': 49.367, 'test/acc_unbiased': 51.085, 'test/diff': 3.57, 'test/acc_skew': 49.3, 'test/acc_align': 52.87}
[10 / 20] best valid accuracy: 51.766 at epoch 4 
 best_stats: {'best_valid_epoch': 4, 'best_valid_valid/acc': 54.599, 'best_valid_valid/acc_unbiased': 51.766, 'best_valid_valid/diff': 4.58, 'best_valid_valid/acc_skew': 49.476, 'best_valid_valid/acc_align': 54.056, 'best_valid_test/acc': 52.743, 'best_valid_test/acc_unbiased': 50.945, 'best_valid_test/diff': 4.843, 'best_valid_test/acc_skew': 48.524, 'best_valid_test/acc_align': 53.367}
[10 / 20] best test accuracy: 51.139 at epoch 3 
 best_stats: {'best_test_epoch': 3, 'best_test_valid/acc': 47.679, 'best_test_valid/acc_unbiased': 51.018, 'best_test_valid/diff': 1.254, 'best_test_valid/acc_skew': 51.645, 'best_test_valid/acc_align': 50.391, 'best_test_test/acc': 49.114, 'best_test_test/acc_unbiased': 51.139, 'best_test_test/diff': 0.366, 'best_test_test/acc_skew': 50.975, 'best_test_test/acc_align': 51.303}
[11 / 20] Learning rate: 0.0001 weight: 0.01
[11 / 20] Loss: 3.82773759764212 CE Loss: 0.66408214792945 Con Loss: 3.821096788004272
[11 / 20] tensor([[0.072, 0.040],
        [0.957, 0.966]]) {'epoch': 11, 'valid/acc': 47.342, 'valid/acc_unbiased': 50.575, 'valid/diff': 2.749, 'valid/acc_skew': 49.201, 'valid/acc_align': 51.949, 'test/acc': 48.903, 'test/acc_unbiased': 50.853, 'test/diff': 2.046, 'test/acc_skew': 49.83, 'test/acc_align': 51.875}
[11 / 20] best valid accuracy: 51.766 at epoch 4 
 best_stats: {'best_valid_epoch': 4, 'best_valid_valid/acc': 54.599, 'best_valid_valid/acc_unbiased': 51.766, 'best_valid_valid/diff': 4.58, 'best_valid_valid/acc_skew': 49.476, 'best_valid_valid/acc_align': 54.056, 'best_valid_test/acc': 52.743, 'best_valid_test/acc_unbiased': 50.945, 'best_valid_test/diff': 4.843, 'best_valid_test/acc_skew': 48.524, 'best_valid_test/acc_align': 53.367}
[11 / 20] best test accuracy: 51.139 at epoch 3 
 best_stats: {'best_test_epoch': 3, 'best_test_valid/acc': 47.679, 'best_test_valid/acc_unbiased': 51.018, 'best_test_valid/diff': 1.254, 'best_test_valid/acc_skew': 51.645, 'best_test_valid/acc_align': 50.391, 'best_test_test/acc': 49.114, 'best_test_test/acc_unbiased': 51.139, 'best_test_test/diff': 0.366, 'best_test_test/acc_skew': 50.975, 'best_test_test/acc_align': 51.303}
[12 / 20] Learning rate: 0.0001 weight: 0.01
[12 / 20] Loss: 3.749104704370962 CE Loss: 0.6613438580951873 Con Loss: 3.7424912585935175
[12 / 20] tensor([[0.281, 0.192],
        [0.831, 0.892]]) {'epoch': 12, 'valid/acc': 51.266, 'valid/acc_unbiased': 53.488, 'valid/diff': 8.837, 'valid/acc_skew': 49.069, 'valid/acc_align': 57.907, 'test/acc': 53.629, 'test/acc_unbiased': 54.902, 'test/diff': 7.485, 'test/acc_skew': 51.16, 'test/acc_align': 58.645}
[12 / 20] best valid accuracy: 53.488 at epoch 12 
 best_stats: {'best_valid_epoch': 12, 'best_valid_valid/acc': 51.266, 'best_valid_valid/acc_unbiased': 53.488, 'best_valid_valid/diff': 8.837, 'best_valid_valid/acc_skew': 49.069, 'best_valid_valid/acc_align': 57.907, 'best_valid_test/acc': 53.629, 'best_valid_test/acc_unbiased': 54.902, 'best_valid_test/diff': 7.485, 'best_valid_test/acc_skew': 51.16, 'best_valid_test/acc_align': 58.645}
[12 / 20] best test accuracy: 54.902 at epoch 12 
 best_stats: {'best_test_epoch': 12, 'best_test_valid/acc': 51.266, 'best_test_valid/acc_unbiased': 53.488, 'best_test_valid/diff': 8.837, 'best_test_valid/acc_skew': 49.069, 'best_test_valid/acc_align': 57.907, 'best_test_test/acc': 53.629, 'best_test_test/acc_unbiased': 54.902, 'best_test_test/diff': 7.485, 'best_test_test/acc_skew': 51.16, 'best_test_test/acc_align': 58.645}
[13 / 20] Learning rate: 0.0001 weight: 0.01
[13 / 20] Loss: 3.720376571363727 CE Loss: 0.6542057955987345 Con Loss: 3.713834480530152
[13 / 20] tensor([[0.226, 0.154],
        [0.896, 0.932]]) {'epoch': 13, 'valid/acc': 51.688, 'valid/acc_unbiased': 54.246, 'valid/diff': 6.858, 'valid/acc_skew': 50.817, 'valid/acc_align': 57.675, 'test/acc': 53.629, 'test/acc_unbiased': 55.179, 'test/diff': 5.387, 'test/acc_skew': 52.486, 'test/acc_align': 57.873}
[13 / 20] best valid accuracy: 54.246 at epoch 13 
 best_stats: {'best_valid_epoch': 13, 'best_valid_valid/acc': 51.688, 'best_valid_valid/acc_unbiased': 54.246, 'best_valid_valid/diff': 6.858, 'best_valid_valid/acc_skew': 50.817, 'best_valid_valid/acc_align': 57.675, 'best_valid_test/acc': 53.629, 'best_valid_test/acc_unbiased': 55.179, 'best_valid_test/diff': 5.387, 'best_valid_test/acc_skew': 52.486, 'best_valid_test/acc_align': 57.873}
[13 / 20] best test accuracy: 55.179 at epoch 13 
 best_stats: {'best_test_epoch': 13, 'best_test_valid/acc': 51.688, 'best_test_valid/acc_unbiased': 54.246, 'best_test_valid/diff': 6.858, 'best_test_valid/acc_skew': 50.817, 'best_test_valid/acc_align': 57.675, 'best_test_test/acc': 53.629, 'best_test_test/acc_unbiased': 55.179, 'best_test_test/diff': 5.387, 'best_test_test/acc_skew': 52.486, 'best_test_test/acc_align': 57.873}
[14 / 20] Learning rate: 1e-05 weight: 0.01
[14 / 20] Loss: 3.3295459030254833 CE Loss: 0.6488104039332123 Con Loss: 3.323057813649185
[14 / 20] tensor([[0.272, 0.183],
        [0.844, 0.912]]) {'epoch': 14, 'valid/acc': 52.616, 'valid/acc_unbiased': 54.891, 'valid/diff': 7.776, 'valid/acc_skew': 51.003, 'valid/acc_align': 58.779, 'test/acc': 54.008, 'test/acc_unbiased': 55.301, 'test/diff': 7.871, 'test/acc_skew': 51.366, 'test/acc_align': 59.237}
[14 / 20] best valid accuracy: 54.891 at epoch 14 
 best_stats: {'best_valid_epoch': 14, 'best_valid_valid/acc': 52.616, 'best_valid_valid/acc_unbiased': 54.891, 'best_valid_valid/diff': 7.776, 'best_valid_valid/acc_skew': 51.003, 'best_valid_valid/acc_align': 58.779, 'best_valid_test/acc': 54.008, 'best_valid_test/acc_unbiased': 55.301, 'best_valid_test/diff': 7.871, 'best_valid_test/acc_skew': 51.366, 'best_valid_test/acc_align': 59.237}
[14 / 20] best test accuracy: 55.301 at epoch 14 
 best_stats: {'best_test_epoch': 14, 'best_test_valid/acc': 52.616, 'best_test_valid/acc_unbiased': 54.891, 'best_test_valid/diff': 7.776, 'best_test_valid/acc_skew': 51.003, 'best_test_valid/acc_align': 58.779, 'best_test_test/acc': 54.008, 'best_test_test/acc_unbiased': 55.301, 'best_test_test/diff': 7.871, 'best_test_test/acc_skew': 51.366, 'best_test_test/acc_align': 59.237}
[15 / 20] Learning rate: 1e-05 weight: 0.01
[15 / 20] Loss: 3.5240661880285904 CE Loss: 0.6442912387919534 Con Loss: 3.5176232634512377
[15 / 20] tensor([[0.303, 0.210],
        [0.820, 0.903]]) {'epoch': 15, 'valid/acc': 52.869, 'valid/acc_unbiased': 55.082, 'valid/diff': 7.937, 'valid/acc_skew': 51.114, 'valid/acc_align': 59.051, 'test/acc': 54.768, 'test/acc_unbiased': 55.91, 'test/diff': 8.809, 'test/acc_skew': 51.505, 'test/acc_align': 60.314}
[15 / 20] best valid accuracy: 55.082 at epoch 15 
 best_stats: {'best_valid_epoch': 15, 'best_valid_valid/acc': 52.869, 'best_valid_valid/acc_unbiased': 55.082, 'best_valid_valid/diff': 7.937, 'best_valid_valid/acc_skew': 51.114, 'best_valid_valid/acc_align': 59.051, 'best_valid_test/acc': 54.768, 'best_valid_test/acc_unbiased': 55.91, 'best_valid_test/diff': 8.809, 'best_valid_test/acc_skew': 51.505, 'best_valid_test/acc_align': 60.314}
[15 / 20] best test accuracy: 55.910 at epoch 15 
 best_stats: {'best_test_epoch': 15, 'best_test_valid/acc': 52.869, 'best_test_valid/acc_unbiased': 55.082, 'best_test_valid/diff': 7.937, 'best_test_valid/acc_skew': 51.114, 'best_test_valid/acc_align': 59.051, 'best_test_test/acc': 54.768, 'best_test_test/acc_unbiased': 55.91, 'best_test_test/diff': 8.809, 'best_test_test/acc_skew': 51.505, 'best_test_test/acc_align': 60.314}
[16 / 20] Learning rate: 1e-05 weight: 0.01
[16 / 20] Loss: 3.8308399075260744 CE Loss: 0.6415406434250642 Con Loss: 3.8244245200618003
[16 / 20] tensor([[0.289, 0.194],
        [0.864, 0.920]]) {'epoch': 16, 'valid/acc': 53.122, 'valid/acc_unbiased': 55.376, 'valid/diff': 8.161, 'valid/acc_skew': 51.295, 'valid/acc_align': 59.457, 'test/acc': 55.274, 'test/acc_unbiased': 56.636, 'test/diff': 7.558, 'test/acc_skew': 52.857, 'test/acc_align': 60.415}
[16 / 20] best valid accuracy: 55.376 at epoch 16 
 best_stats: {'best_valid_epoch': 16, 'best_valid_valid/acc': 53.122, 'best_valid_valid/acc_unbiased': 55.376, 'best_valid_valid/diff': 8.161, 'best_valid_valid/acc_skew': 51.295, 'best_valid_valid/acc_align': 59.457, 'best_valid_test/acc': 55.274, 'best_valid_test/acc_unbiased': 56.636, 'best_valid_test/diff': 7.558, 'best_valid_test/acc_skew': 52.857, 'best_valid_test/acc_align': 60.415}
[16 / 20] best test accuracy: 56.636 at epoch 16 
 best_stats: {'best_test_epoch': 16, 'best_test_valid/acc': 53.122, 'best_test_valid/acc_unbiased': 55.376, 'best_test_valid/diff': 8.161, 'best_test_valid/acc_skew': 51.295, 'best_test_valid/acc_align': 59.457, 'best_test_test/acc': 55.274, 'best_test_test/acc_unbiased': 56.636, 'best_test_test/diff': 7.558, 'best_test_test/acc_skew': 52.857, 'best_test_test/acc_align': 60.415}
[17 / 20] Learning rate: 1e-05 weight: 0.01
[17 / 20] Loss: 3.2537408314290857 CE Loss: 0.6454616498278569 Con Loss: 3.2472862093222994
[17 / 20] tensor([[0.323, 0.217],
        [0.840, 0.899]]) {'epoch': 17, 'valid/acc': 53.755, 'valid/acc_unbiased': 55.836, 'valid/diff': 9.296, 'valid/acc_skew': 51.188, 'valid/acc_align': 60.484, 'test/acc': 55.696, 'test/acc_unbiased': 56.963, 'test/diff': 8.229, 'test/acc_skew': 52.848, 'test/acc_align': 61.077}
[17 / 20] best valid accuracy: 55.836 at epoch 17 
 best_stats: {'best_valid_epoch': 17, 'best_valid_valid/acc': 53.755, 'best_valid_valid/acc_unbiased': 55.836, 'best_valid_valid/diff': 9.296, 'best_valid_valid/acc_skew': 51.188, 'best_valid_valid/acc_align': 60.484, 'best_valid_test/acc': 55.696, 'best_valid_test/acc_unbiased': 56.963, 'best_valid_test/diff': 8.229, 'best_valid_test/acc_skew': 52.848, 'best_valid_test/acc_align': 61.077}
[17 / 20] best test accuracy: 56.963 at epoch 17 
 best_stats: {'best_test_epoch': 17, 'best_test_valid/acc': 53.755, 'best_test_valid/acc_unbiased': 55.836, 'best_test_valid/diff': 9.296, 'best_test_valid/acc_skew': 51.188, 'best_test_valid/acc_align': 60.484, 'best_test_test/acc': 55.696, 'best_test_test/acc_unbiased': 56.963, 'best_test_test/diff': 8.229, 'best_test_test/acc_skew': 52.848, 'best_test_test/acc_align': 61.077}
[18 / 20] Learning rate: 1e-05 weight: 0.01
[18 / 20] Loss: 3.501364247089753 CE Loss: 0.6411591656039701 Con Loss: 3.4949526536566173
[18 / 20] tensor([[0.409, 0.300],
        [0.736, 0.871]]) {'epoch': 18, 'valid/acc': 55.485, 'valid/acc_unbiased': 56.955, 'valid/diff': 9.835, 'valid/acc_skew': 52.037, 'valid/acc_align': 61.873, 'test/acc': 57.257, 'test/acc_unbiased': 57.878, 'test/diff': 12.177, 'test/acc_skew': 51.789, 'test/acc_align': 63.967}
[18 / 20] best valid accuracy: 56.955 at epoch 18 
 best_stats: {'best_valid_epoch': 18, 'best_valid_valid/acc': 55.485, 'best_valid_valid/acc_unbiased': 56.955, 'best_valid_valid/diff': 9.835, 'best_valid_valid/acc_skew': 52.037, 'best_valid_valid/acc_align': 61.873, 'best_valid_test/acc': 57.257, 'best_valid_test/acc_unbiased': 57.878, 'best_valid_test/diff': 12.177, 'best_valid_test/acc_skew': 51.789, 'best_valid_test/acc_align': 63.967}
[18 / 20] best test accuracy: 57.878 at epoch 18 
 best_stats: {'best_test_epoch': 18, 'best_test_valid/acc': 55.485, 'best_test_valid/acc_unbiased': 56.955, 'best_test_valid/diff': 9.835, 'best_test_valid/acc_skew': 52.037, 'best_test_valid/acc_align': 61.873, 'best_test_test/acc': 57.257, 'best_test_test/acc_unbiased': 57.878, 'best_test_test/diff': 12.177, 'best_test_test/acc_skew': 51.789, 'best_test_test/acc_align': 63.967}
[19 / 20] Learning rate: 1e-05 weight: 0.01
[19 / 20] Loss: 3.2545667892822814 CE Loss: 0.6441280424565032 Con Loss: 3.2481255046594244
[19 / 20] tensor([[0.405, 0.292],
        [0.773, 0.878]]) {'epoch': 19, 'valid/acc': 56.54, 'valid/acc_unbiased': 58.166, 'valid/diff': 10.217, 'valid/acc_skew': 53.057, 'valid/acc_align': 63.274, 'test/acc': 57.89, 'test/acc_unbiased': 58.709, 'test/diff': 10.899, 'test/acc_skew': 53.26, 'test/acc_align': 64.159}
[19 / 20] best valid accuracy: 58.166 at epoch 19 
 best_stats: {'best_valid_epoch': 19, 'best_valid_valid/acc': 56.54, 'best_valid_valid/acc_unbiased': 58.166, 'best_valid_valid/diff': 10.217, 'best_valid_valid/acc_skew': 53.057, 'best_valid_valid/acc_align': 63.274, 'best_valid_test/acc': 57.89, 'best_valid_test/acc_unbiased': 58.709, 'best_valid_test/diff': 10.899, 'best_valid_test/acc_skew': 53.26, 'best_valid_test/acc_align': 64.159}
[19 / 20] best test accuracy: 58.709 at epoch 19 
 best_stats: {'best_test_epoch': 19, 'best_test_valid/acc': 56.54, 'best_test_valid/acc_unbiased': 58.166, 'best_test_valid/diff': 10.217, 'best_test_valid/acc_skew': 53.057, 'best_test_valid/acc_align': 63.274, 'best_test_test/acc': 57.89, 'best_test_test/acc_unbiased': 58.709, 'best_test_test/diff': 10.899, 'best_test_test/acc_skew': 53.26, 'best_test_test/acc_align': 64.159}
[20 / 20] Learning rate: 1e-05 weight: 0.01
[20 / 20] Loss: 3.2270065616474906 CE Loss: 0.6411953907103675 Con Loss: 3.220594630948173
[20 / 20] tensor([[0.427, 0.318],
        [0.764, 0.869]]) {'epoch': 20, 'valid/acc': 57.468, 'valid/acc_unbiased': 59.049, 'valid/diff': 9.935, 'valid/acc_skew': 54.081, 'valid/acc_align': 64.017, 'test/acc': 58.692, 'test/acc_unbiased': 59.435, 'test/diff': 10.706, 'test/acc_skew': 54.082, 'test/acc_align': 64.788}
[20 / 20] best valid accuracy: 59.049 at epoch 20 
 best_stats: {'best_valid_epoch': 20, 'best_valid_valid/acc': 57.468, 'best_valid_valid/acc_unbiased': 59.049, 'best_valid_valid/diff': 9.935, 'best_valid_valid/acc_skew': 54.081, 'best_valid_valid/acc_align': 64.017, 'best_valid_test/acc': 58.692, 'best_valid_test/acc_unbiased': 59.435, 'best_valid_test/diff': 10.706, 'best_valid_test/acc_skew': 54.082, 'best_valid_test/acc_align': 64.788}
[20 / 20] best test accuracy: 59.435 at epoch 20 
 best_stats: {'best_test_epoch': 20, 'best_test_valid/acc': 57.468, 'best_test_valid/acc_unbiased': 59.049, 'best_test_valid/diff': 9.935, 'best_test_valid/acc_skew': 54.081, 'best_test_valid/acc_align': 64.017, 'best_test_test/acc': 58.692, 'best_test_test/acc_unbiased': 59.435, 'best_test_test/diff': 10.706, 'best_test_test/acc_skew': 54.082, 'best_test_test/acc_align': 64.788}
Total training time: 0:35:56
