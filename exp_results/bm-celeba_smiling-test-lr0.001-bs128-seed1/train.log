Log level set to: INFO
Set seed: 1
=======> Using Fixed Random Seed: 1 <========
save_path: exp_results/bm-celeba_smiling-test-lr0.001-bs128-seed1
get_celeba - split:train, aug: False, given_y: True, ratio: 0
get_celeba - split:train_valid, aug: False, given_y: True, ratio: 0
get_celeba - split:valid, aug: False, given_y: True, ratio: 0
decay_epochs: [3, 6]
[1 / 10] Learning rate: 0.001
[1 / 10] Loss: 0.1541
[1 / 10] tensor([[0.972, 0.964],
        [0.868, 0.833]]) {'epoch': 1, 'valid/acc': 90.91, 'valid/acc_unbiased': 91.015, 'valid/diff': 2.887, 'valid/acc_skew': 90.584, 'valid/acc_align': 91.445, 'test/acc': 91.352, 'test/acc_unbiased': 90.911, 'test/diff': 2.121, 'test/acc_skew': 90.207, 'test/acc_align': 91.614}
[1 / 10] best valid accuracy: 91.015 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 90.91, 'best_valid_valid/acc_unbiased': 91.015, 'best_valid_valid/diff': 2.887, 'best_valid_valid/acc_skew': 90.584, 'best_valid_valid/acc_align': 91.445, 'best_valid_test/acc': 91.352, 'best_valid_test/acc_unbiased': 90.911, 'best_valid_test/diff': 2.121, 'best_valid_test/acc_skew': 90.207, 'best_valid_test/acc_align': 91.614}
[1 / 10] best test accuracy: 90.911 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 90.91, 'best_test_valid/acc_unbiased': 91.015, 'best_test_valid/diff': 2.887, 'best_test_valid/acc_skew': 90.584, 'best_test_valid/acc_align': 91.445, 'best_test_test/acc': 91.352, 'best_test_test/acc_unbiased': 90.911, 'best_test_test/diff': 2.121, 'best_test_test/acc_skew': 90.207, 'best_test_test/acc_align': 91.614}
[2 / 10] Learning rate: 0.001
[2 / 10] Loss: 0.1405
[2 / 10] tensor([[0.942, 0.908],
        [0.922, 0.925]]) {'epoch': 2, 'valid/acc': 91.889, 'valid/acc_unbiased': 92.365, 'valid/diff': 3.11, 'valid/acc_skew': 93.248, 'valid/acc_align': 91.483, 'test/acc': 92.415, 'test/acc_unbiased': 92.41, 'test/diff': 1.884, 'test/acc_skew': 93.351, 'test/acc_align': 91.468}
[2 / 10] best valid accuracy: 92.365 at epoch 2 
 best_stats: {'best_valid_epoch': 2, 'best_valid_valid/acc': 91.889, 'best_valid_valid/acc_unbiased': 92.365, 'best_valid_valid/diff': 3.11, 'best_valid_valid/acc_skew': 93.248, 'best_valid_valid/acc_align': 91.483, 'best_valid_test/acc': 92.415, 'best_valid_test/acc_unbiased': 92.41, 'best_valid_test/diff': 1.884, 'best_valid_test/acc_skew': 93.351, 'best_valid_test/acc_align': 91.468}
[2 / 10] best test accuracy: 92.410 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 91.889, 'best_test_valid/acc_unbiased': 92.365, 'best_test_valid/diff': 3.11, 'best_test_valid/acc_skew': 93.248, 'best_test_valid/acc_align': 91.483, 'best_test_test/acc': 92.415, 'best_test_test/acc_unbiased': 92.41, 'best_test_test/diff': 1.884, 'best_test_test/acc_skew': 93.351, 'best_test_test/acc_align': 91.468}
[3 / 10] Learning rate: 0.001
[3 / 10] Loss: 0.1385
[3 / 10] tensor([[0.963, 0.950],
        [0.897, 0.879]]) {'epoch': 3, 'valid/acc': 92.412, 'valid/acc_unbiased': 92.457, 'valid/diff': 2.647, 'valid/acc_skew': 92.249, 'valid/acc_align': 92.665, 'test/acc': 92.46, 'test/acc_unbiased': 92.218, 'test/diff': 1.519, 'test/acc_skew': 92.096, 'test/acc_align': 92.34}
[3 / 10] best valid accuracy: 92.457 at epoch 3 
 best_stats: {'best_valid_epoch': 3, 'best_valid_valid/acc': 92.412, 'best_valid_valid/acc_unbiased': 92.457, 'best_valid_valid/diff': 2.647, 'best_valid_valid/acc_skew': 92.249, 'best_valid_valid/acc_align': 92.665, 'best_valid_test/acc': 92.46, 'best_valid_test/acc_unbiased': 92.218, 'best_valid_test/diff': 1.519, 'best_valid_test/acc_skew': 92.096, 'best_valid_test/acc_align': 92.34}
[3 / 10] best test accuracy: 92.410 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 91.889, 'best_test_valid/acc_unbiased': 92.365, 'best_test_valid/diff': 3.11, 'best_test_valid/acc_skew': 93.248, 'best_test_valid/acc_align': 91.483, 'best_test_test/acc': 92.415, 'best_test_test/acc_unbiased': 92.41, 'best_test_test/diff': 1.884, 'best_test_test/acc_skew': 93.351, 'best_test_test/acc_align': 91.468}
[4 / 10] Learning rate: 0.0001
[4 / 10] Loss: 0.1206
[4 / 10] tensor([[0.936, 0.930],
        [0.938, 0.922]]) {'epoch': 4, 'valid/acc': 93.655, 'valid/acc_unbiased': 93.47, 'valid/diff': 2.515, 'valid/acc_skew': 93.249, 'valid/acc_align': 93.691, 'test/acc': 93.28, 'test/acc_unbiased': 93.161, 'test/diff': 1.124, 'test/acc_skew': 92.912, 'test/acc_align': 93.411}
[4 / 10] best valid accuracy: 93.470 at epoch 4 
 best_stats: {'best_valid_epoch': 4, 'best_valid_valid/acc': 93.655, 'best_valid_valid/acc_unbiased': 93.47, 'best_valid_valid/diff': 2.515, 'best_valid_valid/acc_skew': 93.249, 'best_valid_valid/acc_align': 93.691, 'best_valid_test/acc': 93.28, 'best_valid_test/acc_unbiased': 93.161, 'best_valid_test/diff': 1.124, 'best_valid_test/acc_skew': 92.912, 'best_valid_test/acc_align': 93.411}
[4 / 10] best test accuracy: 93.161 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 93.655, 'best_test_valid/acc_unbiased': 93.47, 'best_test_valid/diff': 2.515, 'best_test_valid/acc_skew': 93.249, 'best_test_valid/acc_align': 93.691, 'best_test_test/acc': 93.28, 'best_test_test/acc_unbiased': 93.161, 'best_test_test/diff': 1.124, 'best_test_test/acc_skew': 92.912, 'best_test_test/acc_align': 93.411}
[5 / 10] Learning rate: 0.0001
[5 / 10] Loss: 0.1141
[5 / 10] tensor([[0.949, 0.946],
        [0.926, 0.904]]) {'epoch': 5, 'valid/acc': 93.803, 'valid/acc_unbiased': 93.6, 'valid/diff': 2.855, 'valid/acc_skew': 93.209, 'valid/acc_align': 93.992, 'test/acc': 93.336, 'test/acc_unbiased': 93.134, 'test/diff': 1.223, 'test/acc_skew': 92.674, 'test/acc_align': 93.594}
[5 / 10] best valid accuracy: 93.600 at epoch 5 
 best_stats: {'best_valid_epoch': 5, 'best_valid_valid/acc': 93.803, 'best_valid_valid/acc_unbiased': 93.6, 'best_valid_valid/diff': 2.855, 'best_valid_valid/acc_skew': 93.209, 'best_valid_valid/acc_align': 93.992, 'best_valid_test/acc': 93.336, 'best_valid_test/acc_unbiased': 93.134, 'best_valid_test/diff': 1.223, 'best_valid_test/acc_skew': 92.674, 'best_valid_test/acc_align': 93.594}
[5 / 10] best test accuracy: 93.161 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 93.655, 'best_test_valid/acc_unbiased': 93.47, 'best_test_valid/diff': 2.515, 'best_test_valid/acc_skew': 93.249, 'best_test_valid/acc_align': 93.691, 'best_test_test/acc': 93.28, 'best_test_test/acc_unbiased': 93.161, 'best_test_test/diff': 1.124, 'best_test_test/acc_skew': 92.912, 'best_test_test/acc_align': 93.411}
[6 / 10] Learning rate: 0.0001
[6 / 10] Loss: 0.1095
[6 / 10] tensor([[0.943, 0.928],
        [0.934, 0.919]]) {'epoch': 6, 'valid/acc': 93.615, 'valid/acc_unbiased': 93.846, 'valid/diff': 2.5, 'valid/acc_skew': 94.246, 'valid/acc_align': 93.446, 'test/acc': 93.245, 'test/acc_unbiased': 93.114, 'test/diff': 1.517, 'test/acc_skew': 93.09, 'test/acc_align': 93.138}
[6 / 10] best valid accuracy: 93.846 at epoch 6 
 best_stats: {'best_valid_epoch': 6, 'best_valid_valid/acc': 93.615, 'best_valid_valid/acc_unbiased': 93.846, 'best_valid_valid/diff': 2.5, 'best_valid_valid/acc_skew': 94.246, 'best_valid_valid/acc_align': 93.446, 'best_valid_test/acc': 93.245, 'best_valid_test/acc_unbiased': 93.114, 'best_valid_test/diff': 1.517, 'best_valid_test/acc_skew': 93.09, 'best_valid_test/acc_align': 93.138}
[6 / 10] best test accuracy: 93.161 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 93.655, 'best_test_valid/acc_unbiased': 93.47, 'best_test_valid/diff': 2.515, 'best_test_valid/acc_skew': 93.249, 'best_test_valid/acc_align': 93.691, 'best_test_test/acc': 93.28, 'best_test_test/acc_unbiased': 93.161, 'best_test_test/diff': 1.124, 'best_test_test/acc_skew': 92.912, 'best_test_test/acc_align': 93.411}
[7 / 10] Learning rate: 1e-05
[7 / 10] Loss: 0.1013
[7 / 10] tensor([[0.950, 0.940],
        [0.932, 0.909]]) {'epoch': 7, 'valid/acc': 94.013, 'valid/acc_unbiased': 93.968, 'valid/diff': 2.406, 'valid/acc_skew': 93.843, 'valid/acc_align': 94.093, 'test/acc': 93.492, 'test/acc_unbiased': 93.283, 'test/diff': 1.694, 'test/acc_skew': 92.953, 'test/acc_align': 93.613}
[7 / 10] best valid accuracy: 93.968 at epoch 7 
 best_stats: {'best_valid_epoch': 7, 'best_valid_valid/acc': 94.013, 'best_valid_valid/acc_unbiased': 93.968, 'best_valid_valid/diff': 2.406, 'best_valid_valid/acc_skew': 93.843, 'best_valid_valid/acc_align': 94.093, 'best_valid_test/acc': 93.492, 'best_valid_test/acc_unbiased': 93.283, 'best_valid_test/diff': 1.694, 'best_valid_test/acc_skew': 92.953, 'best_valid_test/acc_align': 93.613}
[7 / 10] best test accuracy: 93.283 at epoch 7 
 best_stats: {'best_test_epoch': 7, 'best_test_valid/acc': 94.013, 'best_test_valid/acc_unbiased': 93.968, 'best_test_valid/diff': 2.406, 'best_test_valid/acc_skew': 93.843, 'best_test_valid/acc_align': 94.093, 'best_test_test/acc': 93.492, 'best_test_test/acc_unbiased': 93.283, 'best_test_test/diff': 1.694, 'best_test_test/acc_skew': 92.953, 'best_test_test/acc_align': 93.613}
[8 / 10] Learning rate: 1e-05
[8 / 10] Loss: 0.0985
[8 / 10] tensor([[0.949, 0.939],
        [0.932, 0.907]]) {'epoch': 8, 'valid/acc': 93.986, 'valid/acc_unbiased': 93.983, 'valid/diff': 2.475, 'valid/acc_skew': 93.944, 'valid/acc_align': 94.022, 'test/acc': 93.406, 'test/acc_unbiased': 93.188, 'test/diff': 1.749, 'test/acc_skew': 92.804, 'test/acc_align': 93.572}
[8 / 10] best valid accuracy: 93.983 at epoch 8 
 best_stats: {'best_valid_epoch': 8, 'best_valid_valid/acc': 93.986, 'best_valid_valid/acc_unbiased': 93.983, 'best_valid_valid/diff': 2.475, 'best_valid_valid/acc_skew': 93.944, 'best_valid_valid/acc_align': 94.022, 'best_valid_test/acc': 93.406, 'best_valid_test/acc_unbiased': 93.188, 'best_valid_test/diff': 1.749, 'best_valid_test/acc_skew': 92.804, 'best_valid_test/acc_align': 93.572}
[8 / 10] best test accuracy: 93.283 at epoch 7 
 best_stats: {'best_test_epoch': 7, 'best_test_valid/acc': 94.013, 'best_test_valid/acc_unbiased': 93.968, 'best_test_valid/diff': 2.406, 'best_test_valid/acc_skew': 93.843, 'best_test_valid/acc_align': 94.093, 'best_test_test/acc': 93.492, 'best_test_test/acc_unbiased': 93.283, 'best_test_test/diff': 1.694, 'best_test_test/acc_skew': 92.953, 'best_test_test/acc_align': 93.613}
[9 / 10] Learning rate: 1e-05
[9 / 10] Loss: 0.0977
[9 / 10] tensor([[0.940, 0.933],
        [0.940, 0.917]]) {'epoch': 9, 'valid/acc': 94.107, 'valid/acc_unbiased': 94.197, 'valid/diff': 2.425, 'valid/acc_skew': 94.373, 'valid/acc_align': 94.02, 'test/acc': 93.406, 'test/acc_unbiased': 93.232, 'test/diff': 1.509, 'test/acc_skew': 92.841, 'test/acc_align': 93.624}
[9 / 10] best valid accuracy: 94.197 at epoch 9 
 best_stats: {'best_valid_epoch': 9, 'best_valid_valid/acc': 94.107, 'best_valid_valid/acc_unbiased': 94.197, 'best_valid_valid/diff': 2.425, 'best_valid_valid/acc_skew': 94.373, 'best_valid_valid/acc_align': 94.02, 'best_valid_test/acc': 93.406, 'best_valid_test/acc_unbiased': 93.232, 'best_valid_test/diff': 1.509, 'best_valid_test/acc_skew': 92.841, 'best_valid_test/acc_align': 93.624}
[9 / 10] best test accuracy: 93.283 at epoch 7 
 best_stats: {'best_test_epoch': 7, 'best_test_valid/acc': 94.013, 'best_test_valid/acc_unbiased': 93.968, 'best_test_valid/diff': 2.406, 'best_test_valid/acc_skew': 93.843, 'best_test_valid/acc_align': 94.093, 'best_test_test/acc': 93.492, 'best_test_test/acc_unbiased': 93.283, 'best_test_test/diff': 1.694, 'best_test_test/acc_skew': 92.953, 'best_test_test/acc_align': 93.613}
[10 / 10] Learning rate: 1e-05
[10 / 10] Loss: 0.0961
[10 / 10] tensor([[0.947, 0.938],
        [0.933, 0.909]]) {'epoch': 10, 'valid/acc': 94.161, 'valid/acc_unbiased': 94.175, 'valid/diff': 2.493, 'valid/acc_skew': 94.173, 'valid/acc_align': 94.176, 'test/acc': 93.371, 'test/acc_unbiased': 93.167, 'test/diff': 1.652, 'test/acc_skew': 92.806, 'test/acc_align': 93.528}
[10 / 10] best valid accuracy: 94.197 at epoch 9 
 best_stats: {'best_valid_epoch': 9, 'best_valid_valid/acc': 94.107, 'best_valid_valid/acc_unbiased': 94.197, 'best_valid_valid/diff': 2.425, 'best_valid_valid/acc_skew': 94.373, 'best_valid_valid/acc_align': 94.02, 'best_valid_test/acc': 93.406, 'best_valid_test/acc_unbiased': 93.232, 'best_valid_test/diff': 1.509, 'best_valid_test/acc_skew': 92.841, 'best_valid_test/acc_align': 93.624}
[10 / 10] best test accuracy: 93.283 at epoch 7 
 best_stats: {'best_test_epoch': 7, 'best_test_valid/acc': 94.013, 'best_test_valid/acc_unbiased': 93.968, 'best_test_valid/diff': 2.406, 'best_test_valid/acc_skew': 93.843, 'best_test_valid/acc_align': 94.093, 'best_test_test/acc': 93.492, 'best_test_test/acc_unbiased': 93.283, 'best_test_test/diff': 1.694, 'best_test_test/acc_skew': 92.953, 'best_test_test/acc_align': 93.613}
Total training time: 0:46:20
