Log level set to: INFO
Set seed: 2
=======> Using Fixed Random Seed: 2 <========
save_path: exp_results/bc-bb0-utk_face_age-crop_rotate_blur-0.9-lr0.001-bs128-cbs64-w0.01-ratio10-aug1-seed2
get_utk_face - split: train, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_age-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
Binary Target 1
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Normal Label Distribution: 
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
Binary Target 1
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Normal Label Distribution: 
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 10684, target_attr: gender, bias_attr: age bias_rate: 0.9
['[train] target_0-bias_0: 8237', '[train] target_0-bias_1: 147', '[train] target_1-bias_0: 823', '[train] target_1-bias_1: 1477']
confusion_matrix - 
 original: tensor([[8237.,  823.],
        [ 147., 1477.]]), 
 normalized: tensor([[0.909, 0.091],
        [0.091, 0.909]]), 
 b|y: tensor([[0.982, 0.018],
        [0.358, 0.642]])
get_utk_face - split: train, aug: 1, given_y: True, ratio: 10
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_age-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
Binary Target 1
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Normal Label Distribution: 
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
Binary Target 1
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Normal Label Distribution: 
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 10684, target_attr: gender, bias_attr: age bias_rate: 0.9
['[train] target_0-bias_0: 8237', '[train] target_0-bias_1: 147', '[train] target_1-bias_0: 823', '[train] target_1-bias_1: 1477']
get_utk_face - split: valid, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_age-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [1030, 195]
Target 1: [841, 202]
Binary Target 1
---------------------------
Target 0: [1030, 195]
Target 1: [841, 202]
===================================
Normal Label Distribution: 
Target 0: [1030, 195]
Target 1: [841, 202]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 2268, target_attr: gender, bias_attr: age bias_rate: 0.9
['[valid] target_0-bias_0: 1030', '[valid] target_0-bias_1: 195', '[valid] target_1-bias_0: 841', '[valid] target_1-bias_1: 202']
get_utk_face - split: test, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_age-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [1061, 176]
Target 1: [867, 165]
Binary Target 1
---------------------------
Target 0: [1061, 176]
Target 1: [867, 165]
===================================
Normal Label Distribution: 
Target 0: [1061, 176]
Target 1: [867, 165]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 2269, target_attr: gender, bias_attr: age bias_rate: 0.9
['[test] target_0-bias_0: 1061', '[test] target_0-bias_1: 176', '[test] target_1-bias_0: 867', '[test] target_1-bias_1: 165']
decay_epochs: [6, 13]
[1 / 20] Learning rate: 0.001 weight: 0.01
[1 / 20] Loss: 4.857396657258908 CE Loss: 0.569024597078796 Con Loss: 4.851706389316857
[1 / 20] tensor([[1., 1.],
        [0., 0.]]) {'epoch': 1, 'valid/acc': 54.012, 'valid/acc_unbiased': 50.0, 'valid/diff': 0.0, 'valid/acc_skew': 50.0, 'valid/acc_align': 50.0, 'test/acc': 54.517, 'test/acc_unbiased': 50.0, 'test/diff': 0.0, 'test/acc_skew': 50.0, 'test/acc_align': 50.0}
[1 / 20] best valid accuracy: 50.000 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 54.012, 'best_valid_valid/acc_unbiased': 50.0, 'best_valid_valid/diff': 0.0, 'best_valid_valid/acc_skew': 50.0, 'best_valid_valid/acc_align': 50.0, 'best_valid_test/acc': 54.517, 'best_valid_test/acc_unbiased': 50.0, 'best_valid_test/diff': 0.0, 'best_valid_test/acc_skew': 50.0, 'best_valid_test/acc_align': 50.0}
[1 / 20] best test accuracy: 50.000 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 54.012, 'best_test_valid/acc_unbiased': 50.0, 'best_test_valid/diff': 0.0, 'best_test_valid/acc_skew': 50.0, 'best_test_valid/acc_align': 50.0, 'best_test_test/acc': 54.517, 'best_test_test/acc_unbiased': 50.0, 'best_test_test/diff': 0.0, 'best_test_test/acc_skew': 50.0, 'best_test_test/acc_align': 50.0}
[2 / 20] Learning rate: 0.001 weight: 0.01
[2 / 20] Loss: 4.71513093414935 CE Loss: 0.5412222391342412 Con Loss: 4.709718701010204
[2 / 20] tensor([[0.982, 1.000],
        [0.060, 0.018]]) {'epoch': 2, 'valid/acc': 55.511, 'valid/acc_unbiased': 51.523, 'valid/diff': 3.493, 'valid/acc_skew': 53.27, 'valid/acc_align': 49.777, 'test/acc': 56.104, 'test/acc_unbiased': 51.506, 'test/diff': 2.985, 'test/acc_skew': 52.999, 'test/acc_align': 50.014}
[2 / 20] best valid accuracy: 51.523 at epoch 2 
 best_stats: {'best_valid_epoch': 2, 'best_valid_valid/acc': 55.511, 'best_valid_valid/acc_unbiased': 51.523, 'best_valid_valid/diff': 3.493, 'best_valid_valid/acc_skew': 53.27, 'best_valid_valid/acc_align': 49.777, 'best_valid_test/acc': 56.104, 'best_valid_test/acc_unbiased': 51.506, 'best_valid_test/diff': 2.985, 'best_valid_test/acc_skew': 52.999, 'best_valid_test/acc_align': 50.014}
[2 / 20] best test accuracy: 51.506 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 55.511, 'best_test_valid/acc_unbiased': 51.523, 'best_test_valid/diff': 3.493, 'best_test_valid/acc_skew': 53.27, 'best_test_valid/acc_align': 49.777, 'best_test_test/acc': 56.104, 'best_test_test/acc_unbiased': 51.506, 'best_test_test/diff': 2.985, 'best_test_test/acc_skew': 52.999, 'best_test_test/acc_align': 50.014}
[3 / 20] Learning rate: 0.001 weight: 0.01
[3 / 20] Loss: 4.700773441760293 CE Loss: 0.5317838347748128 Con Loss: 4.695455607560993
[3 / 20] tensor([[0.978, 0.983],
        [0.076, 0.048]]) {'epoch': 3, 'valid/acc': 56.349, 'valid/acc_unbiased': 52.913, 'valid/diff': 1.428, 'valid/acc_skew': 53.627, 'valid/acc_align': 52.198, 'test/acc': 56.633, 'test/acc_unbiased': 52.147, 'test/diff': 1.614, 'test/acc_skew': 52.954, 'test/acc_align': 51.34}
[3 / 20] best valid accuracy: 52.913 at epoch 3 
 best_stats: {'best_valid_epoch': 3, 'best_valid_valid/acc': 56.349, 'best_valid_valid/acc_unbiased': 52.913, 'best_valid_valid/diff': 1.428, 'best_valid_valid/acc_skew': 53.627, 'best_valid_valid/acc_align': 52.198, 'best_valid_test/acc': 56.633, 'best_valid_test/acc_unbiased': 52.147, 'best_valid_test/diff': 1.614, 'best_valid_test/acc_skew': 52.954, 'best_valid_test/acc_align': 51.34}
[3 / 20] best test accuracy: 52.147 at epoch 3 
 best_stats: {'best_test_epoch': 3, 'best_test_valid/acc': 56.349, 'best_test_valid/acc_unbiased': 52.913, 'best_test_valid/diff': 1.428, 'best_test_valid/acc_skew': 53.627, 'best_test_valid/acc_align': 52.198, 'best_test_test/acc': 56.633, 'best_test_test/acc_unbiased': 52.147, 'best_test_test/diff': 1.614, 'best_test_test/acc_skew': 52.954, 'best_test_test/acc_align': 51.34}
[4 / 20] Learning rate: 0.001 weight: 0.01
[4 / 20] Loss: 4.679875509339921 CE Loss: 0.528003206919392 Con Loss: 4.674595482560947
[4 / 20] tensor([[0.998, 1.000],
        [0.014, 0.018]]) {'epoch': 4, 'valid/acc': 54.63, 'valid/acc_unbiased': 50.516, 'valid/diff': 0.633, 'valid/acc_skew': 50.832, 'valid/acc_align': 50.199, 'test/acc': 55.09, 'test/acc_unbiased': 50.753, 'test/diff': 0.311, 'test/acc_skew': 50.692, 'test/acc_align': 50.815}
[4 / 20] best valid accuracy: 52.913 at epoch 3 
 best_stats: {'best_valid_epoch': 3, 'best_valid_valid/acc': 56.349, 'best_valid_valid/acc_unbiased': 52.913, 'best_valid_valid/diff': 1.428, 'best_valid_valid/acc_skew': 53.627, 'best_valid_valid/acc_align': 52.198, 'best_valid_test/acc': 56.633, 'best_valid_test/acc_unbiased': 52.147, 'best_valid_test/diff': 1.614, 'best_valid_test/acc_skew': 52.954, 'best_valid_test/acc_align': 51.34}
[4 / 20] best test accuracy: 52.147 at epoch 3 
 best_stats: {'best_test_epoch': 3, 'best_test_valid/acc': 56.349, 'best_test_valid/acc_unbiased': 52.913, 'best_test_valid/diff': 1.428, 'best_test_valid/acc_skew': 53.627, 'best_test_valid/acc_align': 52.198, 'best_test_test/acc': 56.633, 'best_test_test/acc_unbiased': 52.147, 'best_test_test/diff': 1.614, 'best_test_test/acc_skew': 52.954, 'best_test_test/acc_align': 51.34}
[5 / 20] Learning rate: 0.001 weight: 0.01
[5 / 20] Loss: 4.642501273524757 CE Loss: 0.5123483116976646 Con Loss: 4.637377769658736
[5 / 20] tensor([[0.948, 0.955],
        [0.219, 0.109]]) {'epoch': 5, 'valid/acc': 62.213, 'valid/acc_unbiased': 57.123, 'valid/diff': 6.557, 'valid/acc_skew': 58.379, 'valid/acc_align': 55.868, 'test/acc': 60.908, 'test/acc_unbiased': 55.774, 'test/diff': 5.822, 'test/acc_skew': 58.685, 'test/acc_align': 52.863}
[5 / 20] best valid accuracy: 57.123 at epoch 5 
 best_stats: {'best_valid_epoch': 5, 'best_valid_valid/acc': 62.213, 'best_valid_valid/acc_unbiased': 57.123, 'best_valid_valid/diff': 6.557, 'best_valid_valid/acc_skew': 58.379, 'best_valid_valid/acc_align': 55.868, 'best_valid_test/acc': 60.908, 'best_valid_test/acc_unbiased': 55.774, 'best_valid_test/diff': 5.822, 'best_valid_test/acc_skew': 58.685, 'best_valid_test/acc_align': 52.863}
[5 / 20] best test accuracy: 55.774 at epoch 5 
 best_stats: {'best_test_epoch': 5, 'best_test_valid/acc': 62.213, 'best_test_valid/acc_unbiased': 57.123, 'best_test_valid/diff': 6.557, 'best_test_valid/acc_skew': 58.379, 'best_test_valid/acc_align': 55.868, 'best_test_test/acc': 60.908, 'best_test_test/acc_unbiased': 55.774, 'best_test_test/diff': 5.822, 'best_test_test/acc_skew': 58.685, 'best_test_test/acc_align': 52.863}
[6 / 20] Learning rate: 0.001 weight: 0.01
[6 / 20] Loss: 4.645020692547535 CE Loss: 0.5038289496154207 Con Loss: 4.6399823963218125
[6 / 20] tensor([[0.930, 0.881],
        [0.256, 0.261]]) {'epoch': 6, 'valid/acc': 61.684, 'valid/acc_unbiased': 58.462, 'valid/diff': 3.905, 'valid/acc_skew': 56.51, 'valid/acc_align': 60.415, 'test/acc': 62.01, 'test/acc_unbiased': 58.19, 'test/diff': 2.706, 'test/acc_skew': 56.837, 'test/acc_align': 59.543}
[6 / 20] best valid accuracy: 58.462 at epoch 6 
 best_stats: {'best_valid_epoch': 6, 'best_valid_valid/acc': 61.684, 'best_valid_valid/acc_unbiased': 58.462, 'best_valid_valid/diff': 3.905, 'best_valid_valid/acc_skew': 56.51, 'best_valid_valid/acc_align': 60.415, 'best_valid_test/acc': 62.01, 'best_valid_test/acc_unbiased': 58.19, 'best_valid_test/diff': 2.706, 'best_valid_test/acc_skew': 56.837, 'best_valid_test/acc_align': 59.543}
[6 / 20] best test accuracy: 58.190 at epoch 6 
 best_stats: {'best_test_epoch': 6, 'best_test_valid/acc': 61.684, 'best_test_valid/acc_unbiased': 58.462, 'best_test_valid/diff': 3.905, 'best_test_valid/acc_skew': 56.51, 'best_test_valid/acc_align': 60.415, 'best_test_test/acc': 62.01, 'best_test_test/acc_unbiased': 58.19, 'best_test_test/diff': 2.706, 'best_test_test/acc_skew': 56.837, 'best_test_test/acc_align': 59.543}
[7 / 20] Learning rate: 0.0001 weight: 0.01
[7 / 20] Loss: 4.595197049029888 CE Loss: 0.49217030873507517 Con Loss: 4.590275353681992
[7 / 20] tensor([[0.955, 0.949],
        [0.286, 0.170]]) {'epoch': 7, 'valid/acc': 62.963, 'valid/acc_unbiased': 58.545, 'valid/diff': 5.034, 'valid/acc_skew': 58.583, 'valid/acc_align': 58.508, 'test/acc': 64.169, 'test/acc_unbiased': 58.984, 'test/diff': 6.112, 'test/acc_skew': 61.745, 'test/acc_align': 56.223}
[7 / 20] best valid accuracy: 58.545 at epoch 7 
 best_stats: {'best_valid_epoch': 7, 'best_valid_valid/acc': 62.963, 'best_valid_valid/acc_unbiased': 58.545, 'best_valid_valid/diff': 5.034, 'best_valid_valid/acc_skew': 58.583, 'best_valid_valid/acc_align': 58.508, 'best_valid_test/acc': 64.169, 'best_valid_test/acc_unbiased': 58.984, 'best_valid_test/diff': 6.112, 'best_valid_test/acc_skew': 61.745, 'best_valid_test/acc_align': 56.223}
[7 / 20] best test accuracy: 58.984 at epoch 7 
 best_stats: {'best_test_epoch': 7, 'best_test_valid/acc': 62.963, 'best_test_valid/acc_unbiased': 58.545, 'best_test_valid/diff': 5.034, 'best_test_valid/acc_skew': 58.583, 'best_test_valid/acc_align': 58.508, 'best_test_test/acc': 64.169, 'best_test_test/acc_unbiased': 58.984, 'best_test_test/diff': 6.112, 'best_test_test/acc_skew': 61.745, 'best_test_test/acc_align': 56.223}
[8 / 20] Learning rate: 0.0001 weight: 0.01
[8 / 20] Loss: 4.551585656790553 CE Loss: 0.48776633378630135 Con Loss: 4.546707993096423
[8 / 20] tensor([[0.967, 0.949],
        [0.278, 0.164]]) {'epoch': 8, 'valid/acc': 62.963, 'valid/acc_unbiased': 57.958, 'valid/diff': 6.813, 'valid/acc_skew': 58.899, 'valid/acc_align': 57.018, 'test/acc': 64.39, 'test/acc_unbiased': 58.937, 'test/diff': 6.624, 'test/acc_skew': 61.342, 'test/acc_align': 56.532}
[8 / 20] best valid accuracy: 58.545 at epoch 7 
 best_stats: {'best_valid_epoch': 7, 'best_valid_valid/acc': 62.963, 'best_valid_valid/acc_unbiased': 58.545, 'best_valid_valid/diff': 5.034, 'best_valid_valid/acc_skew': 58.583, 'best_valid_valid/acc_align': 58.508, 'best_valid_test/acc': 64.169, 'best_valid_test/acc_unbiased': 58.984, 'best_valid_test/diff': 6.112, 'best_valid_test/acc_skew': 61.745, 'best_valid_test/acc_align': 56.223}
[8 / 20] best test accuracy: 58.984 at epoch 7 
 best_stats: {'best_test_epoch': 7, 'best_test_valid/acc': 62.963, 'best_test_valid/acc_unbiased': 58.545, 'best_test_valid/diff': 5.034, 'best_test_valid/acc_skew': 58.583, 'best_test_valid/acc_align': 58.508, 'best_test_test/acc': 64.169, 'best_test_test/acc_unbiased': 58.984, 'best_test_test/diff': 6.112, 'best_test_test/acc_skew': 61.745, 'best_test_test/acc_align': 56.223}
[9 / 20] Learning rate: 0.0001 weight: 0.01
[9 / 20] Loss: 4.528505635056233 CE Loss: 0.471648177072735 Con Loss: 4.5237891558893875
[9 / 20] tensor([[0.964, 0.903],
        [0.340, 0.248]]) {'epoch': 9, 'valid/acc': 65.653, 'valid/acc_unbiased': 61.14, 'valid/diff': 5.875, 'valid/acc_skew': 59.72, 'valid/acc_align': 62.56, 'test/acc': 66.902, 'test/acc_unbiased': 61.408, 'test/diff': 7.627, 'test/acc_skew': 62.183, 'test/acc_align': 60.633}
[9 / 20] best valid accuracy: 61.140 at epoch 9 
 best_stats: {'best_valid_epoch': 9, 'best_valid_valid/acc': 65.653, 'best_valid_valid/acc_unbiased': 61.14, 'best_valid_valid/diff': 5.875, 'best_valid_valid/acc_skew': 59.72, 'best_valid_valid/acc_align': 62.56, 'best_valid_test/acc': 66.902, 'best_valid_test/acc_unbiased': 61.408, 'best_valid_test/diff': 7.627, 'best_valid_test/acc_skew': 62.183, 'best_valid_test/acc_align': 60.633}
[9 / 20] best test accuracy: 61.408 at epoch 9 
 best_stats: {'best_test_epoch': 9, 'best_test_valid/acc': 65.653, 'best_test_valid/acc_unbiased': 61.14, 'best_test_valid/diff': 5.875, 'best_test_valid/acc_skew': 59.72, 'best_test_valid/acc_align': 62.56, 'best_test_test/acc': 66.902, 'best_test_test/acc_unbiased': 61.408, 'best_test_test/diff': 7.627, 'best_test_test/acc_skew': 62.183, 'best_test_test/acc_align': 60.633}
[10 / 20] Learning rate: 0.0001 weight: 0.01
[10 / 20] Loss: 4.4878986994901515 CE Loss: 0.4646819220839793 Con Loss: 4.483251887999506
[10 / 20] tensor([[0.959, 0.920],
        [0.346, 0.255]]) {'epoch': 10, 'valid/acc': 65.697, 'valid/acc_unbiased': 61.28, 'valid/diff': 5.66, 'valid/acc_skew': 59.898, 'valid/acc_align': 62.662, 'test/acc': 67.078, 'test/acc_unbiased': 62.012, 'test/diff': 6.525, 'test/acc_skew': 63.324, 'test/acc_align': 60.701}
[10 / 20] best valid accuracy: 61.280 at epoch 10 
 best_stats: {'best_valid_epoch': 10, 'best_valid_valid/acc': 65.697, 'best_valid_valid/acc_unbiased': 61.28, 'best_valid_valid/diff': 5.66, 'best_valid_valid/acc_skew': 59.898, 'best_valid_valid/acc_align': 62.662, 'best_valid_test/acc': 67.078, 'best_valid_test/acc_unbiased': 62.012, 'best_valid_test/diff': 6.525, 'best_valid_test/acc_skew': 63.324, 'best_valid_test/acc_align': 60.701}
[10 / 20] best test accuracy: 62.012 at epoch 10 
 best_stats: {'best_test_epoch': 10, 'best_test_valid/acc': 65.697, 'best_test_valid/acc_unbiased': 61.28, 'best_test_valid/diff': 5.66, 'best_test_valid/acc_skew': 59.898, 'best_test_valid/acc_align': 62.662, 'best_test_test/acc': 67.078, 'best_test_test/acc_unbiased': 62.012, 'best_test_test/diff': 6.525, 'best_test_test/acc_skew': 63.324, 'best_test_test/acc_align': 60.701}
[11 / 20] Learning rate: 0.0001 weight: 0.01
[11 / 20] Loss: 4.458285830878712 CE Loss: 0.4653413978822666 Con Loss: 4.453632394547143
[11 / 20] tensor([[0.969, 0.898],
        [0.307, 0.218]]) {'epoch': 11, 'valid/acc': 65.388, 'valid/acc_unbiased': 60.903, 'valid/diff': 5.418, 'valid/acc_skew': 58.512, 'valid/acc_align': 63.293, 'test/acc': 65.58, 'test/acc_unbiased': 59.79, 'test/diff': 7.99, 'test/acc_skew': 60.227, 'test/acc_align': 59.354}
[11 / 20] best valid accuracy: 61.280 at epoch 10 
 best_stats: {'best_valid_epoch': 10, 'best_valid_valid/acc': 65.697, 'best_valid_valid/acc_unbiased': 61.28, 'best_valid_valid/diff': 5.66, 'best_valid_valid/acc_skew': 59.898, 'best_valid_valid/acc_align': 62.662, 'best_valid_test/acc': 67.078, 'best_valid_test/acc_unbiased': 62.012, 'best_valid_test/diff': 6.525, 'best_valid_test/acc_skew': 63.324, 'best_valid_test/acc_align': 60.701}
[11 / 20] best test accuracy: 62.012 at epoch 10 
 best_stats: {'best_test_epoch': 10, 'best_test_valid/acc': 65.697, 'best_test_valid/acc_unbiased': 61.28, 'best_test_valid/diff': 5.66, 'best_test_valid/acc_skew': 59.898, 'best_test_valid/acc_align': 62.662, 'best_test_test/acc': 67.078, 'best_test_test/acc_unbiased': 62.012, 'best_test_test/diff': 6.525, 'best_test_test/acc_skew': 63.324, 'best_test_test/acc_align': 60.701}
[12 / 20] Learning rate: 0.0001 weight: 0.01
[12 / 20] Loss: 4.50781107948586 CE Loss: 0.46384426642339 Con Loss: 4.503172622196508
[12 / 20] tensor([[0.949, 0.864],
        [0.411, 0.339]]) {'epoch': 12, 'valid/acc': 68.166, 'valid/acc_unbiased': 63.804, 'valid/diff': 6.376, 'valid/acc_skew': 61.374, 'valid/acc_align': 66.234, 'test/acc': 69.238, 'test/acc_unbiased': 64.069, 'test/diff': 7.834, 'test/acc_skew': 63.712, 'test/acc_align': 64.425}
[12 / 20] best valid accuracy: 63.804 at epoch 12 
 best_stats: {'best_valid_epoch': 12, 'best_valid_valid/acc': 68.166, 'best_valid_valid/acc_unbiased': 63.804, 'best_valid_valid/diff': 6.376, 'best_valid_valid/acc_skew': 61.374, 'best_valid_valid/acc_align': 66.234, 'best_valid_test/acc': 69.238, 'best_valid_test/acc_unbiased': 64.069, 'best_valid_test/diff': 7.834, 'best_valid_test/acc_skew': 63.712, 'best_valid_test/acc_align': 64.425}
[12 / 20] best test accuracy: 64.069 at epoch 12 
 best_stats: {'best_test_epoch': 12, 'best_test_valid/acc': 68.166, 'best_test_valid/acc_unbiased': 63.804, 'best_test_valid/diff': 6.376, 'best_test_valid/acc_skew': 61.374, 'best_test_valid/acc_align': 66.234, 'best_test_test/acc': 69.238, 'best_test_test/acc_unbiased': 64.069, 'best_test_test/diff': 7.834, 'best_test_test/acc_skew': 63.712, 'best_test_test/acc_align': 64.425}
[13 / 20] Learning rate: 0.0001 weight: 0.01
[13 / 20] Loss: 4.473952692039715 CE Loss: 0.4584476192963342 Con Loss: 4.4693682085749185
[13 / 20] tensor([[0.943, 0.830],
        [0.443, 0.364]]) {'epoch': 13, 'valid/acc': 69.224, 'valid/acc_unbiased': 64.607, 'valid/diff': 7.593, 'valid/acc_skew': 61.44, 'valid/acc_align': 67.773, 'test/acc': 70.119, 'test/acc_unbiased': 64.488, 'test/diff': 9.659, 'test/acc_skew': 63.623, 'test/acc_align': 65.354}
[13 / 20] best valid accuracy: 64.607 at epoch 13 
 best_stats: {'best_valid_epoch': 13, 'best_valid_valid/acc': 69.224, 'best_valid_valid/acc_unbiased': 64.607, 'best_valid_valid/diff': 7.593, 'best_valid_valid/acc_skew': 61.44, 'best_valid_valid/acc_align': 67.773, 'best_valid_test/acc': 70.119, 'best_valid_test/acc_unbiased': 64.488, 'best_valid_test/diff': 9.659, 'best_valid_test/acc_skew': 63.623, 'best_valid_test/acc_align': 65.354}
[13 / 20] best test accuracy: 64.488 at epoch 13 
 best_stats: {'best_test_epoch': 13, 'best_test_valid/acc': 69.224, 'best_test_valid/acc_unbiased': 64.607, 'best_test_valid/diff': 7.593, 'best_test_valid/acc_skew': 61.44, 'best_test_valid/acc_align': 67.773, 'best_test_test/acc': 70.119, 'best_test_test/acc_unbiased': 64.488, 'best_test_test/diff': 9.659, 'best_test_test/acc_skew': 63.623, 'best_test_test/acc_align': 65.354}
[14 / 20] Learning rate: 1e-05 weight: 0.01
[14 / 20] Loss: 4.475413653967489 CE Loss: 0.44555026735763165 Con Loss: 4.470958154329152
[14 / 20] tensor([[0.955, 0.869],
        [0.408, 0.327]]) {'epoch': 14, 'valid/acc': 68.122, 'valid/acc_unbiased': 63.547, 'valid/diff': 6.923, 'valid/acc_skew': 60.17, 'valid/acc_align': 66.923, 'test/acc': 69.37, 'test/acc_unbiased': 63.991, 'test/diff': 8.324, 'test/acc_skew': 63.881, 'test/acc_align': 64.102}
[14 / 20] best valid accuracy: 64.607 at epoch 13 
 best_stats: {'best_valid_epoch': 13, 'best_valid_valid/acc': 69.224, 'best_valid_valid/acc_unbiased': 64.607, 'best_valid_valid/diff': 7.593, 'best_valid_valid/acc_skew': 61.44, 'best_valid_valid/acc_align': 67.773, 'best_valid_test/acc': 70.119, 'best_valid_test/acc_unbiased': 64.488, 'best_valid_test/diff': 9.659, 'best_valid_test/acc_skew': 63.623, 'best_valid_test/acc_align': 65.354}
[14 / 20] best test accuracy: 64.488 at epoch 13 
 best_stats: {'best_test_epoch': 13, 'best_test_valid/acc': 69.224, 'best_test_valid/acc_unbiased': 64.607, 'best_test_valid/diff': 7.593, 'best_test_valid/acc_skew': 61.44, 'best_test_valid/acc_align': 67.773, 'best_test_test/acc': 70.119, 'best_test_test/acc_unbiased': 64.488, 'best_test_test/diff': 9.659, 'best_test_test/acc_skew': 63.623, 'best_test_test/acc_align': 65.354}
[15 / 20] Learning rate: 1e-05 weight: 0.01
[15 / 20] Loss: 4.460037612058125 CE Loss: 0.45000217059987707 Con Loss: 4.4555376071422925
[15 / 20] tensor([[0.957, 0.864],
        [0.427, 0.297]]) {'epoch': 15, 'valid/acc': 68.342, 'valid/acc_unbiased': 63.619, 'valid/diff': 7.492, 'valid/acc_skew': 61.552, 'valid/acc_align': 65.686, 'test/acc': 69.899, 'test/acc_unbiased': 63.6, 'test/diff': 11.14, 'test/acc_skew': 64.52, 'test/acc_align': 62.681}
[15 / 20] best valid accuracy: 64.607 at epoch 13 
 best_stats: {'best_valid_epoch': 13, 'best_valid_valid/acc': 69.224, 'best_valid_valid/acc_unbiased': 64.607, 'best_valid_valid/diff': 7.593, 'best_valid_valid/acc_skew': 61.44, 'best_valid_valid/acc_align': 67.773, 'best_valid_test/acc': 70.119, 'best_valid_test/acc_unbiased': 64.488, 'best_valid_test/diff': 9.659, 'best_valid_test/acc_skew': 63.623, 'best_valid_test/acc_align': 65.354}
[15 / 20] best test accuracy: 64.488 at epoch 13 
 best_stats: {'best_test_epoch': 13, 'best_test_valid/acc': 69.224, 'best_test_valid/acc_unbiased': 64.607, 'best_test_valid/diff': 7.593, 'best_test_valid/acc_skew': 61.44, 'best_test_valid/acc_align': 67.773, 'best_test_test/acc': 70.119, 'best_test_test/acc_unbiased': 64.488, 'best_test_test/diff': 9.659, 'best_test_test/acc_skew': 63.623, 'best_test_test/acc_align': 65.354}
[16 / 20] Learning rate: 1e-05 weight: 0.01
[16 / 20] Loss: 4.4187362759089215 CE Loss: 0.4479559955303252 Con Loss: 4.414256708401502
[16 / 20] tensor([[0.958, 0.869],
        [0.423, 0.297]]) {'epoch': 16, 'valid/acc': 68.474, 'valid/acc_unbiased': 64.091, 'valid/diff': 6.473, 'valid/acc_skew': 61.355, 'valid/acc_align': 66.826, 'test/acc': 69.855, 'test/acc_unbiased': 63.679, 'test/diff': 10.73, 'test/acc_skew': 64.631, 'test/acc_align': 62.728}
[16 / 20] best valid accuracy: 64.607 at epoch 13 
 best_stats: {'best_valid_epoch': 13, 'best_valid_valid/acc': 69.224, 'best_valid_valid/acc_unbiased': 64.607, 'best_valid_valid/diff': 7.593, 'best_valid_valid/acc_skew': 61.44, 'best_valid_valid/acc_align': 67.773, 'best_valid_test/acc': 70.119, 'best_valid_test/acc_unbiased': 64.488, 'best_valid_test/diff': 9.659, 'best_valid_test/acc_skew': 63.623, 'best_valid_test/acc_align': 65.354}
[16 / 20] best test accuracy: 64.488 at epoch 13 
 best_stats: {'best_test_epoch': 13, 'best_test_valid/acc': 69.224, 'best_test_valid/acc_unbiased': 64.607, 'best_test_valid/diff': 7.593, 'best_test_valid/acc_skew': 61.44, 'best_test_valid/acc_align': 67.773, 'best_test_test/acc': 70.119, 'best_test_test/acc_unbiased': 64.488, 'best_test_test/diff': 9.659, 'best_test_test/acc_skew': 63.623, 'best_test_test/acc_align': 65.354}
[17 / 20] Learning rate: 1e-05 weight: 0.01
[17 / 20] Loss: 4.470462297598819 CE Loss: 0.44722164515161816 Con Loss: 4.465990067242416
[17 / 20] tensor([[0.967, 0.881],
        [0.391, 0.285]]) {'epoch': 17, 'valid/acc': 67.284, 'valid/acc_unbiased': 62.788, 'valid/diff': 6.288, 'valid/acc_skew': 60.341, 'valid/acc_align': 65.235, 'test/acc': 69.061, 'test/acc_unbiased': 63.089, 'test/diff': 9.624, 'test/acc_skew': 63.584, 'test/acc_align': 62.593}
[17 / 20] best valid accuracy: 64.607 at epoch 13 
 best_stats: {'best_valid_epoch': 13, 'best_valid_valid/acc': 69.224, 'best_valid_valid/acc_unbiased': 64.607, 'best_valid_valid/diff': 7.593, 'best_valid_valid/acc_skew': 61.44, 'best_valid_valid/acc_align': 67.773, 'best_valid_test/acc': 70.119, 'best_valid_test/acc_unbiased': 64.488, 'best_valid_test/diff': 9.659, 'best_valid_test/acc_skew': 63.623, 'best_valid_test/acc_align': 65.354}
[17 / 20] best test accuracy: 64.488 at epoch 13 
 best_stats: {'best_test_epoch': 13, 'best_test_valid/acc': 69.224, 'best_test_valid/acc_unbiased': 64.607, 'best_test_valid/diff': 7.593, 'best_test_valid/acc_skew': 61.44, 'best_test_valid/acc_align': 67.773, 'best_test_test/acc': 70.119, 'best_test_test/acc_unbiased': 64.488, 'best_test_test/diff': 9.659, 'best_test_test/acc_skew': 63.623, 'best_test_test/acc_align': 65.354}
[18 / 20] Learning rate: 1e-05 weight: 0.01
[18 / 20] Loss: 4.445571201742923 CE Loss: 0.44564847442283473 Con Loss: 4.4411147416463645
[18 / 20] tensor([[0.953, 0.869],
        [0.446, 0.303]]) {'epoch': 18, 'valid/acc': 68.915, 'valid/acc_unbiased': 64.113, 'valid/diff': 8.039, 'valid/acc_skew': 61.793, 'valid/acc_align': 66.433, 'test/acc': 70.56, 'test/acc_unbiased': 64.29, 'test/diff': 11.345, 'test/acc_skew': 65.784, 'test/acc_align': 62.795}
[18 / 20] best valid accuracy: 64.607 at epoch 13 
 best_stats: {'best_valid_epoch': 13, 'best_valid_valid/acc': 69.224, 'best_valid_valid/acc_unbiased': 64.607, 'best_valid_valid/diff': 7.593, 'best_valid_valid/acc_skew': 61.44, 'best_valid_valid/acc_align': 67.773, 'best_valid_test/acc': 70.119, 'best_valid_test/acc_unbiased': 64.488, 'best_valid_test/diff': 9.659, 'best_valid_test/acc_skew': 63.623, 'best_valid_test/acc_align': 65.354}
[18 / 20] best test accuracy: 64.488 at epoch 13 
 best_stats: {'best_test_epoch': 13, 'best_test_valid/acc': 69.224, 'best_test_valid/acc_unbiased': 64.607, 'best_test_valid/diff': 7.593, 'best_test_valid/acc_skew': 61.44, 'best_test_valid/acc_align': 67.773, 'best_test_test/acc': 70.119, 'best_test_test/acc_unbiased': 64.488, 'best_test_test/diff': 9.659, 'best_test_test/acc_skew': 63.623, 'best_test_test/acc_align': 65.354}
[19 / 20] Learning rate: 1e-05 weight: 0.01
[19 / 20] Loss: 4.427884847026155 CE Loss: 0.4477251050781106 Con Loss: 4.4234075790842295
[19 / 20] tensor([[0.955, 0.841],
        [0.436, 0.303]]) {'epoch': 19, 'valid/acc': 68.959, 'valid/acc_unbiased': 64.387, 'valid/diff': 7.101, 'valid/acc_skew': 61.258, 'valid/acc_align': 67.516, 'test/acc': 70.031, 'test/acc_unbiased': 63.367, 'test/diff': 12.34, 'test/acc_skew': 63.845, 'test/acc_align': 62.889}
[19 / 20] best valid accuracy: 64.607 at epoch 13 
 best_stats: {'best_valid_epoch': 13, 'best_valid_valid/acc': 69.224, 'best_valid_valid/acc_unbiased': 64.607, 'best_valid_valid/diff': 7.593, 'best_valid_valid/acc_skew': 61.44, 'best_valid_valid/acc_align': 67.773, 'best_valid_test/acc': 70.119, 'best_valid_test/acc_unbiased': 64.488, 'best_valid_test/diff': 9.659, 'best_valid_test/acc_skew': 63.623, 'best_valid_test/acc_align': 65.354}
[19 / 20] best test accuracy: 64.488 at epoch 13 
 best_stats: {'best_test_epoch': 13, 'best_test_valid/acc': 69.224, 'best_test_valid/acc_unbiased': 64.607, 'best_test_valid/diff': 7.593, 'best_test_valid/acc_skew': 61.44, 'best_test_valid/acc_align': 67.773, 'best_test_test/acc': 70.119, 'best_test_test/acc_unbiased': 64.488, 'best_test_test/diff': 9.659, 'best_test_test/acc_skew': 63.623, 'best_test_test/acc_align': 65.354}
[20 / 20] Learning rate: 1e-05 weight: 0.01
[20 / 20] Loss: 4.399804318991103 CE Loss: 0.4366871530712432 Con Loss: 4.395437461613091
[20 / 20] tensor([[0.959, 0.869],
        [0.424, 0.267]]) {'epoch': 20, 'valid/acc': 68.563, 'valid/acc_unbiased': 63.631, 'valid/diff': 8.028, 'valid/acc_skew': 61.236, 'valid/acc_align': 66.026, 'test/acc': 69.766, 'test/acc_unbiased': 62.998, 'test/diff': 12.397, 'test/acc_skew': 64.689, 'test/acc_align': 61.307}
[20 / 20] best valid accuracy: 64.607 at epoch 13 
 best_stats: {'best_valid_epoch': 13, 'best_valid_valid/acc': 69.224, 'best_valid_valid/acc_unbiased': 64.607, 'best_valid_valid/diff': 7.593, 'best_valid_valid/acc_skew': 61.44, 'best_valid_valid/acc_align': 67.773, 'best_valid_test/acc': 70.119, 'best_valid_test/acc_unbiased': 64.488, 'best_valid_test/diff': 9.659, 'best_valid_test/acc_skew': 63.623, 'best_valid_test/acc_align': 65.354}
[20 / 20] best test accuracy: 64.488 at epoch 13 
 best_stats: {'best_test_epoch': 13, 'best_test_valid/acc': 69.224, 'best_test_valid/acc_unbiased': 64.607, 'best_test_valid/diff': 7.593, 'best_test_valid/acc_skew': 61.44, 'best_test_valid/acc_align': 67.773, 'best_test_test/acc': 70.119, 'best_test_test/acc_unbiased': 64.488, 'best_test_test/diff': 9.659, 'best_test_test/acc_skew': 63.623, 'best_test_test/acc_align': 65.354}
Total training time: 0:15:28
