Log level set to: INFO
Set seed: 2
=======> Using Fixed Random Seed: 2 <========
save_path: exp_results/bc-bb0-utk_face_age-test-0.997-lr0.001-bs128-cbs64-w0.01-ratio10-aug1-seed2
get_utk_face - split: train, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_age-0.997
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [8237, 4]
Target 1: [24, 1477]
Binary Target 1
---------------------------
Target 0: [8237, 4]
Target 1: [24, 1477]
===================================
Normal Label Distribution: 
Target 0: [8237, 4]
Target 1: [24, 1477]
===================================
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [8237, 4]
Target 1: [24, 1477]
Binary Target 1
---------------------------
Target 0: [8237, 4]
Target 1: [24, 1477]
===================================
Normal Label Distribution: 
Target 0: [8237, 4]
Target 1: [24, 1477]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 9742, target_attr: gender, bias_attr: age bias_rate: 0.997
['[train] target_0-bias_0: 8237', '[train] target_0-bias_1: 4', '[train] target_1-bias_0: 24', '[train] target_1-bias_1: 1477']
confusion_matrix - 
 original: tensor([[8.237e+03, 2.400e+01],
        [4.000e+00, 1.477e+03]]), 
 normalized: tensor([[0.997, 0.003],
        [0.003, 0.997]]), 
 b|y: tensor([[9.995e-01, 4.854e-04],
        [1.599e-02, 9.840e-01]])
get_utk_face - split: train, aug: 1, given_y: True, ratio: 10
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_age-0.997
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [8237, 4]
Target 1: [24, 1477]
Binary Target 1
---------------------------
Target 0: [8237, 4]
Target 1: [24, 1477]
===================================
Normal Label Distribution: 
Target 0: [8237, 4]
Target 1: [24, 1477]
===================================
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [8237, 4]
Target 1: [24, 1477]
Binary Target 1
---------------------------
Target 0: [8237, 4]
Target 1: [24, 1477]
===================================
Normal Label Distribution: 
Target 0: [8237, 4]
Target 1: [24, 1477]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 9742, target_attr: gender, bias_attr: age bias_rate: 0.997
['[train] target_0-bias_0: 8237', '[train] target_0-bias_1: 4', '[train] target_1-bias_0: 24', '[train] target_1-bias_1: 1477']
get_utk_face - split: valid, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_age-0.997
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [1030, 195]
Target 1: [841, 202]
Binary Target 1
---------------------------
Target 0: [1030, 195]
Target 1: [841, 202]
===================================
Normal Label Distribution: 
Target 0: [1030, 195]
Target 1: [841, 202]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 2268, target_attr: gender, bias_attr: age bias_rate: 0.997
['[valid] target_0-bias_0: 1030', '[valid] target_0-bias_1: 195', '[valid] target_1-bias_0: 841', '[valid] target_1-bias_1: 202']
get_utk_face - split: test, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_age-0.997
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [1061, 176]
Target 1: [867, 165]
Binary Target 1
---------------------------
Target 0: [1061, 176]
Target 1: [867, 165]
===================================
Normal Label Distribution: 
Target 0: [1061, 176]
Target 1: [867, 165]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 2269, target_attr: gender, bias_attr: age bias_rate: 0.997
['[test] target_0-bias_0: 1061', '[test] target_0-bias_1: 176', '[test] target_1-bias_0: 867', '[test] target_1-bias_1: 165']
decay_epochs: [6, 13]
[1 / 20] Learning rate: 0.001 weight: 0.01
[1 / 20] Loss: 1.913291434109061 CE Loss: 0.4565632469451934 Con Loss: 1.9087257925623669
[1 / 20] tensor([[1., 1.],
        [0., 0.]]) {'epoch': 1, 'valid/acc': 54.012, 'valid/acc_unbiased': 50.0, 'valid/diff': 0.0, 'valid/acc_skew': 50.0, 'valid/acc_align': 50.0, 'test/acc': 54.517, 'test/acc_unbiased': 50.0, 'test/diff': 0.0, 'test/acc_skew': 50.0, 'test/acc_align': 50.0}
[1 / 20] best valid accuracy: 50.000 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 54.012, 'best_valid_valid/acc_unbiased': 50.0, 'best_valid_valid/diff': 0.0, 'best_valid_valid/acc_skew': 50.0, 'best_valid_valid/acc_align': 50.0, 'best_valid_test/acc': 54.517, 'best_valid_test/acc_unbiased': 50.0, 'best_valid_test/diff': 0.0, 'best_valid_test/acc_skew': 50.0, 'best_valid_test/acc_align': 50.0}
[1 / 20] best test accuracy: 50.000 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 54.012, 'best_test_valid/acc_unbiased': 50.0, 'best_test_valid/diff': 0.0, 'best_test_valid/acc_skew': 50.0, 'best_test_valid/acc_align': 50.0, 'best_test_test/acc': 54.517, 'best_test_test/acc_unbiased': 50.0, 'best_test_test/diff': 0.0, 'best_test_test/acc_skew': 50.0, 'best_test_test/acc_align': 50.0}
[2 / 20] Learning rate: 0.001 weight: 0.01
[2 / 20] Loss: 1.351262125602381 CE Loss: 0.4315486098921683 Con Loss: 1.3469466329036957
[2 / 20] tensor([[0.981, 0.972],
        [0.012, 0.012]]) {'epoch': 2, 'valid/acc': 53.968, 'valid/acc_unbiased': 50.236, 'valid/diff': 0.501, 'valid/acc_skew': 50.457, 'valid/acc_align': 50.014, 'test/acc': 53.944, 'test/acc_unbiased': 49.41, 'test/diff': 0.507, 'test/acc_skew': 49.156, 'test/acc_align': 49.664}
[2 / 20] best valid accuracy: 50.236 at epoch 2 
 best_stats: {'best_valid_epoch': 2, 'best_valid_valid/acc': 53.968, 'best_valid_valid/acc_unbiased': 50.236, 'best_valid_valid/diff': 0.501, 'best_valid_valid/acc_skew': 50.457, 'best_valid_valid/acc_align': 50.014, 'best_valid_test/acc': 53.944, 'best_valid_test/acc_unbiased': 49.41, 'best_valid_test/diff': 0.507, 'best_valid_test/acc_skew': 49.156, 'best_valid_test/acc_align': 49.664}
[2 / 20] best test accuracy: 50.000 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 54.012, 'best_test_valid/acc_unbiased': 50.0, 'best_test_valid/diff': 0.0, 'best_test_valid/acc_skew': 50.0, 'best_test_valid/acc_align': 50.0, 'best_test_test/acc': 54.517, 'best_test_test/acc_unbiased': 50.0, 'best_test_test/diff': 0.0, 'best_test_test/acc_skew': 50.0, 'best_test_test/acc_align': 50.0}
[3 / 20] Learning rate: 0.001 weight: 0.01
[3 / 20] Loss: 1.3335892226943928 CE Loss: 0.4338243883588774 Con Loss: 1.3292509774436356
[3 / 20] tensor([[1., 1.],
        [0., 0.]]) {'epoch': 3, 'valid/acc': 54.012, 'valid/acc_unbiased': 50.0, 'valid/diff': 0.0, 'valid/acc_skew': 50.0, 'valid/acc_align': 50.0, 'test/acc': 54.517, 'test/acc_unbiased': 50.0, 'test/diff': 0.0, 'test/acc_skew': 50.0, 'test/acc_align': 50.0}
[3 / 20] best valid accuracy: 50.236 at epoch 2 
 best_stats: {'best_valid_epoch': 2, 'best_valid_valid/acc': 53.968, 'best_valid_valid/acc_unbiased': 50.236, 'best_valid_valid/diff': 0.501, 'best_valid_valid/acc_skew': 50.457, 'best_valid_valid/acc_align': 50.014, 'best_valid_test/acc': 53.944, 'best_valid_test/acc_unbiased': 49.41, 'best_valid_test/diff': 0.507, 'best_valid_test/acc_skew': 49.156, 'best_valid_test/acc_align': 49.664}
[3 / 20] best test accuracy: 50.000 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 54.012, 'best_test_valid/acc_unbiased': 50.0, 'best_test_valid/diff': 0.0, 'best_test_valid/acc_skew': 50.0, 'best_test_valid/acc_align': 50.0, 'best_test_test/acc': 54.517, 'best_test_test/acc_unbiased': 50.0, 'best_test_test/diff': 0.0, 'best_test_test/acc_skew': 50.0, 'best_test_test/acc_align': 50.0}
[4 / 20] Learning rate: 0.001 weight: 0.01
[4 / 20] Loss: 1.5177922195496734 CE Loss: 0.4197074046090407 Con Loss: 1.51359516285548
[4 / 20] tensor([[1., 1.],
        [0., 0.]]) {'epoch': 4, 'valid/acc': 54.012, 'valid/acc_unbiased': 50.0, 'valid/diff': 0.0, 'valid/acc_skew': 50.0, 'valid/acc_align': 50.0, 'test/acc': 54.517, 'test/acc_unbiased': 50.0, 'test/diff': 0.0, 'test/acc_skew': 50.0, 'test/acc_align': 50.0}
[4 / 20] best valid accuracy: 50.236 at epoch 2 
 best_stats: {'best_valid_epoch': 2, 'best_valid_valid/acc': 53.968, 'best_valid_valid/acc_unbiased': 50.236, 'best_valid_valid/diff': 0.501, 'best_valid_valid/acc_skew': 50.457, 'best_valid_valid/acc_align': 50.014, 'best_valid_test/acc': 53.944, 'best_valid_test/acc_unbiased': 49.41, 'best_valid_test/diff': 0.507, 'best_valid_test/acc_skew': 49.156, 'best_valid_test/acc_align': 49.664}
[4 / 20] best test accuracy: 50.000 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 54.012, 'best_test_valid/acc_unbiased': 50.0, 'best_test_valid/diff': 0.0, 'best_test_valid/acc_skew': 50.0, 'best_test_valid/acc_align': 50.0, 'best_test_test/acc': 54.517, 'best_test_test/acc_unbiased': 50.0, 'best_test_test/diff': 0.0, 'best_test_test/acc_skew': 50.0, 'best_test_test/acc_align': 50.0}
[5 / 20] Learning rate: 0.001 weight: 0.01
[5 / 20] Loss: 1.6873372382475007 CE Loss: 0.41896428685735515 Con Loss: 1.6831475989428468
[5 / 20] tensor([[0.991, 0.989],
        [0.012, 0.018]]) {'epoch': 5, 'valid/acc': 54.189, 'valid/acc_unbiased': 50.258, 'valid/diff': 0.399, 'valid/acc_skew': 50.457, 'valid/acc_align': 50.058, 'test/acc': 54.561, 'test/acc_unbiased': 50.223, 'test/diff': 0.429, 'test/acc_skew': 50.009, 'test/acc_align': 50.438}
[5 / 20] best valid accuracy: 50.258 at epoch 5 
 best_stats: {'best_valid_epoch': 5, 'best_valid_valid/acc': 54.189, 'best_valid_valid/acc_unbiased': 50.258, 'best_valid_valid/diff': 0.399, 'best_valid_valid/acc_skew': 50.457, 'best_valid_valid/acc_align': 50.058, 'best_valid_test/acc': 54.561, 'best_valid_test/acc_unbiased': 50.223, 'best_valid_test/diff': 0.429, 'best_valid_test/acc_skew': 50.009, 'best_valid_test/acc_align': 50.438}
[5 / 20] best test accuracy: 50.223 at epoch 5 
 best_stats: {'best_test_epoch': 5, 'best_test_valid/acc': 54.189, 'best_test_valid/acc_unbiased': 50.258, 'best_test_valid/diff': 0.399, 'best_test_valid/acc_skew': 50.457, 'best_test_valid/acc_align': 50.058, 'best_test_test/acc': 54.561, 'best_test_test/acc_unbiased': 50.223, 'best_test_test/diff': 0.429, 'best_test_test/acc_skew': 50.009, 'best_test_test/acc_align': 50.438}
[6 / 20] Learning rate: 0.001 weight: 0.01
[6 / 20] Loss: 1.6244755660733803 CE Loss: 0.4447843178944577 Con Loss: 1.6200277320268193
[6 / 20] tensor([[0.977, 0.989],
        [0.027, 0.024]]) {'epoch': 6, 'valid/acc': 54.541, 'valid/acc_unbiased': 50.554, 'valid/diff': 2.458, 'valid/acc_skew': 51.784, 'valid/acc_align': 49.325, 'test/acc': 54.561, 'test/acc_unbiased': 50.42, 'test/diff': 0.677, 'test/acc_skew': 50.758, 'test/acc_align': 50.081}
[6 / 20] best valid accuracy: 50.554 at epoch 6 
 best_stats: {'best_valid_epoch': 6, 'best_valid_valid/acc': 54.541, 'best_valid_valid/acc_unbiased': 50.554, 'best_valid_valid/diff': 2.458, 'best_valid_valid/acc_skew': 51.784, 'best_valid_valid/acc_align': 49.325, 'best_valid_test/acc': 54.561, 'best_valid_test/acc_unbiased': 50.42, 'best_valid_test/diff': 0.677, 'best_valid_test/acc_skew': 50.758, 'best_valid_test/acc_align': 50.081}
[6 / 20] best test accuracy: 50.420 at epoch 6 
 best_stats: {'best_test_epoch': 6, 'best_test_valid/acc': 54.541, 'best_test_valid/acc_unbiased': 50.554, 'best_test_valid/diff': 2.458, 'best_test_valid/acc_skew': 51.784, 'best_test_valid/acc_align': 49.325, 'best_test_test/acc': 54.561, 'best_test_test/acc_unbiased': 50.42, 'best_test_test/diff': 0.677, 'best_test_test/acc_skew': 50.758, 'best_test_test/acc_align': 50.081}
[7 / 20] Learning rate: 0.0001 weight: 0.01
[7 / 20] Loss: 1.4405299611244327 CE Loss: 0.4314871070762357 Con Loss: 1.4362150864590366
[7 / 20] tensor([[0.996, 1.000],
        [0.003, 0.006]]) {'epoch': 7, 'valid/acc': 54.056, 'valid/acc_unbiased': 50.052, 'valid/diff': 0.491, 'valid/acc_skew': 50.297, 'valid/acc_align': 49.806, 'test/acc': 54.517, 'test/acc_unbiased': 50.144, 'test/diff': 0.319, 'test/acc_skew': 50.173, 'test/acc_align': 50.115}
[7 / 20] best valid accuracy: 50.554 at epoch 6 
 best_stats: {'best_valid_epoch': 6, 'best_valid_valid/acc': 54.541, 'best_valid_valid/acc_unbiased': 50.554, 'best_valid_valid/diff': 2.458, 'best_valid_valid/acc_skew': 51.784, 'best_valid_valid/acc_align': 49.325, 'best_valid_test/acc': 54.561, 'best_valid_test/acc_unbiased': 50.42, 'best_valid_test/diff': 0.677, 'best_valid_test/acc_skew': 50.758, 'best_valid_test/acc_align': 50.081}
[7 / 20] best test accuracy: 50.420 at epoch 6 
 best_stats: {'best_test_epoch': 6, 'best_test_valid/acc': 54.541, 'best_test_valid/acc_unbiased': 50.554, 'best_test_valid/diff': 2.458, 'best_test_valid/acc_skew': 51.784, 'best_test_valid/acc_align': 49.325, 'best_test_test/acc': 54.561, 'best_test_test/acc_unbiased': 50.42, 'best_test_test/diff': 0.677, 'best_test_test/acc_skew': 50.758, 'best_test_test/acc_align': 50.081}
[8 / 20] Learning rate: 0.0001 weight: 0.01
[8 / 20] Loss: 1.2519533256165571 CE Loss: 0.43249886441808344 Con Loss: 1.2476283353203694
[8 / 20] tensor([[0.985, 0.994],
        [0.008, 0.012]]) {'epoch': 8, 'valid/acc': 54.101, 'valid/acc_unbiased': 50.142, 'valid/diff': 1.343, 'valid/acc_skew': 50.814, 'valid/acc_align': 49.471, 'test/acc': 54.165, 'test/acc_unbiased': 49.986, 'test/diff': 0.672, 'test/acc_skew': 50.12, 'test/acc_align': 49.852}
[8 / 20] best valid accuracy: 50.554 at epoch 6 
 best_stats: {'best_valid_epoch': 6, 'best_valid_valid/acc': 54.541, 'best_valid_valid/acc_unbiased': 50.554, 'best_valid_valid/diff': 2.458, 'best_valid_valid/acc_skew': 51.784, 'best_valid_valid/acc_align': 49.325, 'best_valid_test/acc': 54.561, 'best_valid_test/acc_unbiased': 50.42, 'best_valid_test/diff': 0.677, 'best_valid_test/acc_skew': 50.758, 'best_valid_test/acc_align': 50.081}
[8 / 20] best test accuracy: 50.420 at epoch 6 
 best_stats: {'best_test_epoch': 6, 'best_test_valid/acc': 54.541, 'best_test_valid/acc_unbiased': 50.554, 'best_test_valid/diff': 2.458, 'best_test_valid/acc_skew': 51.784, 'best_test_valid/acc_align': 49.325, 'best_test_test/acc': 54.561, 'best_test_test/acc_unbiased': 50.42, 'best_test_test/diff': 0.677, 'best_test_test/acc_skew': 50.758, 'best_test_test/acc_align': 50.081}
[9 / 20] Learning rate: 0.0001 weight: 0.01
[9 / 20] Loss: 0.8886448815046251 CE Loss: 0.42088014043728394 Con Loss: 0.8844360808918936
[9 / 20] tensor([[0.986, 0.983],
        [0.016, 0.018]]) {'epoch': 9, 'valid/acc': 54.189, 'valid/acc_unbiased': 50.18, 'valid/diff': 1.03, 'valid/acc_skew': 50.695, 'valid/acc_align': 49.665, 'test/acc': 54.473, 'test/acc_unbiased': 50.079, 'test/diff': 0.247, 'test/acc_skew': 49.955, 'test/acc_align': 50.202}
[9 / 20] best valid accuracy: 50.554 at epoch 6 
 best_stats: {'best_valid_epoch': 6, 'best_valid_valid/acc': 54.541, 'best_valid_valid/acc_unbiased': 50.554, 'best_valid_valid/diff': 2.458, 'best_valid_valid/acc_skew': 51.784, 'best_valid_valid/acc_align': 49.325, 'best_valid_test/acc': 54.561, 'best_valid_test/acc_unbiased': 50.42, 'best_valid_test/diff': 0.677, 'best_valid_test/acc_skew': 50.758, 'best_valid_test/acc_align': 50.081}
[9 / 20] best test accuracy: 50.420 at epoch 6 
 best_stats: {'best_test_epoch': 6, 'best_test_valid/acc': 54.541, 'best_test_valid/acc_unbiased': 50.554, 'best_test_valid/diff': 2.458, 'best_test_valid/acc_skew': 51.784, 'best_test_valid/acc_align': 49.325, 'best_test_test/acc': 54.561, 'best_test_test/acc_unbiased': 50.42, 'best_test_test/diff': 0.677, 'best_test_test/acc_skew': 50.758, 'best_test_test/acc_align': 50.081}
[10 / 20] Learning rate: 0.0001 weight: 0.01
[10 / 20] Loss: 1.280570748619073 CE Loss: 0.41877039287142187 Con Loss: 1.2763830332314545
[10 / 20] tensor([[0.981, 0.983],
        [0.030, 0.030]]) {'epoch': 10, 'valid/acc': 54.453, 'valid/acc_unbiased': 49.965, 'valid/diff': 2.018, 'valid/acc_skew': 50.067, 'valid/acc_align': 49.864, 'test/acc': 54.87, 'test/acc_unbiased': 50.61, 'test/diff': 0.106, 'test/acc_skew': 50.647, 'test/acc_align': 50.573}
[10 / 20] best valid accuracy: 50.554 at epoch 6 
 best_stats: {'best_valid_epoch': 6, 'best_valid_valid/acc': 54.541, 'best_valid_valid/acc_unbiased': 50.554, 'best_valid_valid/diff': 2.458, 'best_valid_valid/acc_skew': 51.784, 'best_valid_valid/acc_align': 49.325, 'best_valid_test/acc': 54.561, 'best_valid_test/acc_unbiased': 50.42, 'best_valid_test/diff': 0.677, 'best_valid_test/acc_skew': 50.758, 'best_valid_test/acc_align': 50.081}
[10 / 20] best test accuracy: 50.610 at epoch 10 
 best_stats: {'best_test_epoch': 10, 'best_test_valid/acc': 54.453, 'best_test_valid/acc_unbiased': 49.965, 'best_test_valid/diff': 2.018, 'best_test_valid/acc_skew': 50.067, 'best_test_valid/acc_align': 49.864, 'best_test_test/acc': 54.87, 'best_test_test/acc_unbiased': 50.61, 'best_test_test/diff': 0.106, 'best_test_test/acc_skew': 50.647, 'best_test_test/acc_align': 50.573}
[11 / 20] Learning rate: 0.0001 weight: 0.01
[11 / 20] Loss: 1.539278414338258 CE Loss: 0.41606637581592465 Con Loss: 1.5351177539406458
[11 / 20] tensor([[0.970, 0.915],
        [0.063, 0.127]]) {'epoch': 11, 'valid/acc': 55.071, 'valid/acc_unbiased': 49.425, 'valid/diff': 6.171, 'valid/acc_skew': 47.986, 'valid/acc_align': 50.864, 'test/acc': 55.796, 'test/acc_unbiased': 51.883, 'test/diff': 5.945, 'test/acc_skew': 48.91, 'test/acc_align': 54.856}
[11 / 20] best valid accuracy: 50.554 at epoch 6 
 best_stats: {'best_valid_epoch': 6, 'best_valid_valid/acc': 54.541, 'best_valid_valid/acc_unbiased': 50.554, 'best_valid_valid/diff': 2.458, 'best_valid_valid/acc_skew': 51.784, 'best_valid_valid/acc_align': 49.325, 'best_valid_test/acc': 54.561, 'best_valid_test/acc_unbiased': 50.42, 'best_valid_test/diff': 0.677, 'best_valid_test/acc_skew': 50.758, 'best_valid_test/acc_align': 50.081}
[11 / 20] best test accuracy: 51.883 at epoch 11 
 best_stats: {'best_test_epoch': 11, 'best_test_valid/acc': 55.071, 'best_test_valid/acc_unbiased': 49.425, 'best_test_valid/diff': 6.171, 'best_test_valid/acc_skew': 47.986, 'best_test_valid/acc_align': 50.864, 'best_test_test/acc': 55.796, 'best_test_test/acc_unbiased': 51.883, 'best_test_test/diff': 5.945, 'best_test_test/acc_skew': 48.91, 'best_test_test/acc_align': 54.856}
[12 / 20] Learning rate: 0.0001 weight: 0.01
[12 / 20] Loss: 1.0947882661221575 CE Loss: 0.4052598453833322 Con Loss: 1.0907356680675444
[12 / 20] tensor([[0.993, 0.966],
        [0.016, 0.097]]) {'epoch': 12, 'valid/acc': 54.497, 'valid/acc_unbiased': 50.107, 'valid/diff': 6.435, 'valid/acc_skew': 46.89, 'valid/acc_align': 53.325, 'test/acc': 55.267, 'test/acc_unbiased': 51.811, 'test/diff': 5.416, 'test/acc_skew': 49.103, 'test/acc_align': 54.519}
[12 / 20] best valid accuracy: 50.554 at epoch 6 
 best_stats: {'best_valid_epoch': 6, 'best_valid_valid/acc': 54.541, 'best_valid_valid/acc_unbiased': 50.554, 'best_valid_valid/diff': 2.458, 'best_valid_valid/acc_skew': 51.784, 'best_valid_valid/acc_align': 49.325, 'best_valid_test/acc': 54.561, 'best_valid_test/acc_unbiased': 50.42, 'best_valid_test/diff': 0.677, 'best_valid_test/acc_skew': 50.758, 'best_valid_test/acc_align': 50.081}
[12 / 20] best test accuracy: 51.883 at epoch 11 
 best_stats: {'best_test_epoch': 11, 'best_test_valid/acc': 55.071, 'best_test_valid/acc_unbiased': 49.425, 'best_test_valid/diff': 6.171, 'best_test_valid/acc_skew': 47.986, 'best_test_valid/acc_align': 50.864, 'best_test_test/acc': 55.796, 'best_test_test/acc_unbiased': 51.883, 'best_test_test/diff': 5.945, 'best_test_test/acc_skew': 48.91, 'best_test_test/acc_align': 54.856}
[13 / 20] Learning rate: 0.0001 weight: 0.01
[13 / 20] Loss: 1.3092105305952302 CE Loss: 0.4127781636916595 Con Loss: 1.305082745141891
[13 / 20] tensor([[0.979, 0.886],
        [0.059, 0.145]]) {'epoch': 13, 'valid/acc': 55.688, 'valid/acc_unbiased': 50.651, 'valid/diff': 6.356, 'valid/acc_skew': 47.473, 'valid/acc_align': 53.829, 'test/acc': 55.972, 'test/acc_unbiased': 51.748, 'test/diff': 8.977, 'test/acc_skew': 47.259, 'test/acc_align': 56.236}
[13 / 20] best valid accuracy: 50.651 at epoch 13 
 best_stats: {'best_valid_epoch': 13, 'best_valid_valid/acc': 55.688, 'best_valid_valid/acc_unbiased': 50.651, 'best_valid_valid/diff': 6.356, 'best_valid_valid/acc_skew': 47.473, 'best_valid_valid/acc_align': 53.829, 'best_valid_test/acc': 55.972, 'best_valid_test/acc_unbiased': 51.748, 'best_valid_test/diff': 8.977, 'best_valid_test/acc_skew': 47.259, 'best_valid_test/acc_align': 56.236}
[13 / 20] best test accuracy: 51.883 at epoch 11 
 best_stats: {'best_test_epoch': 11, 'best_test_valid/acc': 55.071, 'best_test_valid/acc_unbiased': 49.425, 'best_test_valid/diff': 6.171, 'best_test_valid/acc_skew': 47.986, 'best_test_valid/acc_align': 50.864, 'best_test_test/acc': 55.796, 'best_test_test/acc_unbiased': 51.883, 'best_test_test/diff': 5.945, 'best_test_test/acc_skew': 48.91, 'best_test_test/acc_align': 54.856}
[14 / 20] Learning rate: 1e-05 weight: 0.01
[14 / 20] Loss: 1.1610808068325427 CE Loss: 0.3955641788174499 Con Loss: 1.1571251593241088
[14 / 20] tensor([[0.978, 0.875],
        [0.082, 0.176]]) {'epoch': 14, 'valid/acc': 55.996, 'valid/acc_unbiased': 50.656, 'valid/diff': 8.53, 'valid/acc_skew': 46.391, 'valid/acc_align': 54.921, 'test/acc': 56.941, 'test/acc_unbiased': 52.774, 'test/diff': 9.859, 'test/acc_skew': 47.845, 'test/acc_align': 57.704}
[14 / 20] best valid accuracy: 50.656 at epoch 14 
 best_stats: {'best_valid_epoch': 14, 'best_valid_valid/acc': 55.996, 'best_valid_valid/acc_unbiased': 50.656, 'best_valid_valid/diff': 8.53, 'best_valid_valid/acc_skew': 46.391, 'best_valid_valid/acc_align': 54.921, 'best_valid_test/acc': 56.941, 'best_valid_test/acc_unbiased': 52.774, 'best_valid_test/diff': 9.859, 'best_valid_test/acc_skew': 47.845, 'best_valid_test/acc_align': 57.704}
[14 / 20] best test accuracy: 52.774 at epoch 14 
 best_stats: {'best_test_epoch': 14, 'best_test_valid/acc': 55.996, 'best_test_valid/acc_unbiased': 50.656, 'best_test_valid/diff': 8.53, 'best_test_valid/acc_skew': 46.391, 'best_test_valid/acc_align': 54.921, 'best_test_test/acc': 56.941, 'best_test_test/acc_unbiased': 52.774, 'best_test_test/diff': 9.859, 'best_test_test/acc_skew': 47.845, 'best_test_test/acc_align': 57.704}
[15 / 20] Learning rate: 1e-05 weight: 0.01
[15 / 20] Loss: 1.260180397032223 CE Loss: 0.4019561473580754 Con Loss: 1.2561608439621508
[15 / 20] tensor([[0.970, 0.886],
        [0.084, 0.206]]) {'epoch': 15, 'valid/acc': 55.908, 'valid/acc_unbiased': 50.343, 'valid/diff': 7.584, 'valid/acc_skew': 46.551, 'valid/acc_align': 54.135, 'test/acc': 56.941, 'test/acc_unbiased': 53.662, 'test/diff': 10.267, 'test/acc_skew': 48.528, 'test/acc_align': 58.795}
[15 / 20] best valid accuracy: 50.656 at epoch 14 
 best_stats: {'best_valid_epoch': 14, 'best_valid_valid/acc': 55.996, 'best_valid_valid/acc_unbiased': 50.656, 'best_valid_valid/diff': 8.53, 'best_valid_valid/acc_skew': 46.391, 'best_valid_valid/acc_align': 54.921, 'best_valid_test/acc': 56.941, 'best_valid_test/acc_unbiased': 52.774, 'best_valid_test/diff': 9.859, 'best_valid_test/acc_skew': 47.845, 'best_valid_test/acc_align': 57.704}
[15 / 20] best test accuracy: 53.662 at epoch 15 
 best_stats: {'best_test_epoch': 15, 'best_test_valid/acc': 55.908, 'best_test_valid/acc_unbiased': 50.343, 'best_test_valid/diff': 7.584, 'best_test_valid/acc_skew': 46.551, 'best_test_valid/acc_align': 54.135, 'best_test_test/acc': 56.941, 'best_test_test/acc_unbiased': 53.662, 'best_test_test/diff': 10.267, 'best_test_test/acc_skew': 48.528, 'best_test_test/acc_align': 58.795}
[16 / 20] Learning rate: 1e-05 weight: 0.01
[16 / 20] Loss: 1.2551734374426542 CE Loss: 0.40138831223777816 Con Loss: 1.251159553862137
[16 / 20] tensor([[0.969, 0.869],
        [0.083, 0.194]]) {'epoch': 16, 'valid/acc': 55.864, 'valid/acc_unbiased': 50.322, 'valid/diff': 6.635, 'valid/acc_skew': 47.004, 'valid/acc_align': 53.64, 'test/acc': 56.633, 'test/acc_unbiased': 52.88, 'test/diff': 10.524, 'test/acc_skew': 47.618, 'test/acc_align': 58.142}
[16 / 20] best valid accuracy: 50.656 at epoch 14 
 best_stats: {'best_valid_epoch': 14, 'best_valid_valid/acc': 55.996, 'best_valid_valid/acc_unbiased': 50.656, 'best_valid_valid/diff': 8.53, 'best_valid_valid/acc_skew': 46.391, 'best_valid_valid/acc_align': 54.921, 'best_valid_test/acc': 56.941, 'best_valid_test/acc_unbiased': 52.774, 'best_valid_test/diff': 9.859, 'best_valid_test/acc_skew': 47.845, 'best_valid_test/acc_align': 57.704}
[16 / 20] best test accuracy: 53.662 at epoch 15 
 best_stats: {'best_test_epoch': 15, 'best_test_valid/acc': 55.908, 'best_test_valid/acc_unbiased': 50.343, 'best_test_valid/diff': 7.584, 'best_test_valid/acc_skew': 46.551, 'best_test_valid/acc_align': 54.135, 'best_test_test/acc': 56.941, 'best_test_test/acc_unbiased': 53.662, 'best_test_test/diff': 10.267, 'best_test_test/acc_skew': 48.528, 'best_test_test/acc_align': 58.795}
[17 / 20] Learning rate: 1e-05 weight: 0.01
[17 / 20] Loss: 1.0889837908147664 CE Loss: 0.3925309424416482 Con Loss: 1.0850584822204221
[17 / 20] tensor([[0.975, 0.864],
        [0.098, 0.224]]) {'epoch': 17, 'valid/acc': 56.261, 'valid/acc_unbiased': 50.82, 'valid/diff': 9.289, 'valid/acc_skew': 46.176, 'valid/acc_align': 55.465, 'test/acc': 57.647, 'test/acc_unbiased': 54.012, 'test/diff': 11.856, 'test/acc_skew': 48.084, 'test/acc_align': 59.94}
[17 / 20] best valid accuracy: 50.820 at epoch 17 
 best_stats: {'best_valid_epoch': 17, 'best_valid_valid/acc': 56.261, 'best_valid_valid/acc_unbiased': 50.82, 'best_valid_valid/diff': 9.289, 'best_valid_valid/acc_skew': 46.176, 'best_valid_valid/acc_align': 55.465, 'best_valid_test/acc': 57.647, 'best_valid_test/acc_unbiased': 54.012, 'best_valid_test/diff': 11.856, 'best_valid_test/acc_skew': 48.084, 'best_valid_test/acc_align': 59.94}
[17 / 20] best test accuracy: 54.012 at epoch 17 
 best_stats: {'best_test_epoch': 17, 'best_test_valid/acc': 56.261, 'best_test_valid/acc_unbiased': 50.82, 'best_test_valid/diff': 9.289, 'best_test_valid/acc_skew': 46.176, 'best_test_valid/acc_align': 55.465, 'best_test_test/acc': 57.647, 'best_test_test/acc_unbiased': 54.012, 'best_test_test/diff': 11.856, 'best_test_test/acc_skew': 48.084, 'best_test_test/acc_align': 59.94}
[18 / 20] Learning rate: 1e-05 weight: 0.01
[18 / 20] Loss: 1.1400968612182607 CE Loss: 0.3890804735157089 Con Loss: 1.1362060608988154
[18 / 20] tensor([[0.977, 0.858],
        [0.095, 0.230]]) {'epoch': 18, 'valid/acc': 56.041, 'valid/acc_unbiased': 50.278, 'valid/diff': 10.374, 'valid/acc_skew': 45.091, 'valid/acc_align': 55.465, 'test/acc': 57.647, 'test/acc_unbiased': 54.005, 'test/diff': 12.757, 'test/acc_skew': 47.627, 'test/acc_align': 60.384}
[18 / 20] best valid accuracy: 50.820 at epoch 17 
 best_stats: {'best_valid_epoch': 17, 'best_valid_valid/acc': 56.261, 'best_valid_valid/acc_unbiased': 50.82, 'best_valid_valid/diff': 9.289, 'best_valid_valid/acc_skew': 46.176, 'best_valid_valid/acc_align': 55.465, 'best_valid_test/acc': 57.647, 'best_valid_test/acc_unbiased': 54.012, 'best_valid_test/diff': 11.856, 'best_valid_test/acc_skew': 48.084, 'best_valid_test/acc_align': 59.94}
[18 / 20] best test accuracy: 54.012 at epoch 17 
 best_stats: {'best_test_epoch': 17, 'best_test_valid/acc': 56.261, 'best_test_valid/acc_unbiased': 50.82, 'best_test_valid/diff': 9.289, 'best_test_valid/acc_skew': 46.176, 'best_test_valid/acc_align': 55.465, 'best_test_test/acc': 57.647, 'best_test_test/acc_unbiased': 54.012, 'best_test_test/diff': 11.856, 'best_test_test/acc_skew': 48.084, 'best_test_test/acc_align': 59.94}
[19 / 20] Learning rate: 1e-05 weight: 0.01
[19 / 20] Loss: 1.271394212377852 CE Loss: 0.3887873924848016 Con Loss: 1.267506326304596
[19 / 20] tensor([[0.978, 0.852],
        [0.089, 0.218]]) {'epoch': 19, 'valid/acc': 56.129, 'valid/acc_unbiased': 50.639, 'valid/diff': 9.952, 'valid/acc_skew': 45.663, 'valid/acc_align': 55.615, 'test/acc': 57.338, 'test/acc_unbiased': 53.44, 'test/diff': 12.771, 'test/acc_skew': 47.054, 'test/acc_align': 59.825}
[19 / 20] best valid accuracy: 50.820 at epoch 17 
 best_stats: {'best_valid_epoch': 17, 'best_valid_valid/acc': 56.261, 'best_valid_valid/acc_unbiased': 50.82, 'best_valid_valid/diff': 9.289, 'best_valid_valid/acc_skew': 46.176, 'best_valid_valid/acc_align': 55.465, 'best_valid_test/acc': 57.647, 'best_valid_test/acc_unbiased': 54.012, 'best_valid_test/diff': 11.856, 'best_valid_test/acc_skew': 48.084, 'best_valid_test/acc_align': 59.94}
[19 / 20] best test accuracy: 54.012 at epoch 17 
 best_stats: {'best_test_epoch': 17, 'best_test_valid/acc': 56.261, 'best_test_valid/acc_unbiased': 50.82, 'best_test_valid/diff': 9.289, 'best_test_valid/acc_skew': 46.176, 'best_test_valid/acc_align': 55.465, 'best_test_test/acc': 57.647, 'best_test_test/acc_unbiased': 54.012, 'best_test_test/diff': 11.856, 'best_test_test/acc_skew': 48.084, 'best_test_test/acc_align': 59.94}
[20 / 20] Learning rate: 1e-05 weight: 0.01
[20 / 20] Loss: 1.6284183731829942 CE Loss: 0.387003587907992 Con Loss: 1.6245483375628413
[20 / 20] tensor([[0.973, 0.852],
        [0.104, 0.242]]) {'epoch': 20, 'valid/acc': 56.085, 'valid/acc_unbiased': 50.314, 'valid/diff': 12.69, 'valid/acc_skew': 43.968, 'valid/acc_align': 56.659, 'test/acc': 57.823, 'test/acc_unbiased': 54.279, 'test/diff': 12.951, 'test/acc_skew': 47.804, 'test/acc_align': 60.755}
[20 / 20] best valid accuracy: 50.820 at epoch 17 
 best_stats: {'best_valid_epoch': 17, 'best_valid_valid/acc': 56.261, 'best_valid_valid/acc_unbiased': 50.82, 'best_valid_valid/diff': 9.289, 'best_valid_valid/acc_skew': 46.176, 'best_valid_valid/acc_align': 55.465, 'best_valid_test/acc': 57.647, 'best_valid_test/acc_unbiased': 54.012, 'best_valid_test/diff': 11.856, 'best_valid_test/acc_skew': 48.084, 'best_valid_test/acc_align': 59.94}
[20 / 20] best test accuracy: 54.279 at epoch 20 
 best_stats: {'best_test_epoch': 20, 'best_test_valid/acc': 56.085, 'best_test_valid/acc_unbiased': 50.314, 'best_test_valid/diff': 12.69, 'best_test_valid/acc_skew': 43.968, 'best_test_valid/acc_align': 56.659, 'best_test_test/acc': 57.823, 'best_test_test/acc_unbiased': 54.279, 'best_test_test/diff': 12.951, 'best_test_test/acc_skew': 47.804, 'best_test_test/acc_align': 60.755}
Total training time: 0:31:41
