Log level set to: INFO
Set seed: 3
=======> Using Fixed Random Seed: 3 <========
save_path: exp_results/bc-bb0-celeba_black-crop_auto2-lr0.001-bs128-cbs64-w0.01-ratio30-aug1-seed3
get_celeba - split:train, aug: False, given_y: True, ratio: 0
use existing black indices from data/celeba/pickles/black
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [60544, 38546]
Target 1: [8005, 16093]
Binary Target 1
---------------------------
Target 0: [60544, 38546]
Target 1: [8005, 16093]
===================================
Normal Label Distribution: 
Target 0: [60544, 38546]
Target 1: [8005, 16093]
===================================
Use BiasedCelebASplit 
 target_attr: black split: train 
 tensor([[60544.,  8005.],
        [38546., 16093.]])
get_celeba - split:train, aug: 1, given_y: True, ratio: 30
use existing black indices from data/celeba/pickles/black
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [60623, 38503]
Target 1: [7983, 16079]
Binary Target 1
---------------------------
Target 0: [60623, 38503]
Target 1: [7983, 16079]
===================================
Normal Label Distribution: 
Target 0: [60623, 38503]
Target 1: [7983, 16079]
===================================
Use BiasedCelebASplit 
 target_attr: black split: train 
 tensor([[60623.,  7983.],
        [38503., 16079.]])
get_celeba - split:train_valid, aug: False, given_y: True, ratio: 0
use existing black indices from data/celeba/pickles/black
Use BiasedCelebASplit 
 target_attr: black split: train_valid 
 tensor([[15141.,  1962.],
        [ 9689.,  4006.]])
get_celeba - split:valid, aug: False, given_y: True, ratio: 0
Use BiasedCelebASplit 
 target_attr: black split: valid 
 tensor([[9752., 1657.],
        [5971., 2487.]])
decay_epochs: [3, 6]
[1 / 10] Learning rate: 0.001 weight: 0.01
[1 / 10] Loss: 4.8333527785050165 CE Loss: 0.3466882991605747 Con Loss: 4.829885891917062
[1 / 10] tensor([[1.000, 1.000],
        [0.004, 0.002]]) {'epoch': 1, 'valid/acc': 80.651, 'valid/acc_unbiased': 50.091, 'valid/diff': 0.021, 'valid/acc_skew': 50.102, 'valid/acc_align': 50.081, 'test/acc': 79.197, 'test/acc_unbiased': 50.148, 'test/diff': 0.066, 'test/acc_skew': 50.181, 'test/acc_align': 50.116}
[1 / 10] best valid accuracy: 50.091 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 80.651, 'best_valid_valid/acc_unbiased': 50.091, 'best_valid_valid/diff': 0.021, 'best_valid_valid/acc_skew': 50.102, 'best_valid_valid/acc_align': 50.081, 'best_valid_test/acc': 79.197, 'best_valid_test/acc_unbiased': 50.148, 'best_valid_test/diff': 0.066, 'best_valid_test/acc_skew': 50.181, 'best_valid_test/acc_align': 50.116}
[1 / 10] best test accuracy: 50.148 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 80.651, 'best_test_valid/acc_unbiased': 50.091, 'best_test_valid/diff': 0.021, 'best_test_valid/acc_skew': 50.102, 'best_test_valid/acc_align': 50.081, 'best_test_test/acc': 79.197, 'best_test_test/acc_unbiased': 50.148, 'best_test_test/diff': 0.066, 'best_test_test/acc_skew': 50.181, 'best_test_test/acc_align': 50.116}
[2 / 10] Learning rate: 0.001 weight: 0.01
[2 / 10] Loss: 4.81994996747634 CE Loss: 0.30710258459442563 Con Loss: 4.8168789409958634
[2 / 10] tensor([[0.869, 0.841],
        [0.824, 0.772]]) {'epoch': 2, 'valid/acc': 83.989, 'valid/acc_unbiased': 81.792, 'valid/diff': 4.207, 'valid/acc_skew': 82.968, 'valid/acc_align': 80.616, 'test/acc': 84.487, 'test/acc_unbiased': 82.671, 'test/diff': 4.043, 'test/acc_skew': 83.247, 'test/acc_align': 82.094}
[2 / 10] best valid accuracy: 81.792 at epoch 2 
 best_stats: {'best_valid_epoch': 2, 'best_valid_valid/acc': 83.989, 'best_valid_valid/acc_unbiased': 81.792, 'best_valid_valid/diff': 4.207, 'best_valid_valid/acc_skew': 82.968, 'best_valid_valid/acc_align': 80.616, 'best_valid_test/acc': 84.487, 'best_valid_test/acc_unbiased': 82.671, 'best_valid_test/diff': 4.043, 'best_valid_test/acc_skew': 83.247, 'best_valid_test/acc_align': 82.094}
[2 / 10] best test accuracy: 82.671 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 83.989, 'best_test_valid/acc_unbiased': 81.792, 'best_test_valid/diff': 4.207, 'best_test_valid/acc_skew': 82.968, 'best_test_valid/acc_align': 80.616, 'best_test_test/acc': 84.487, 'best_test_test/acc_unbiased': 82.671, 'best_test_test/diff': 4.043, 'best_test_test/acc_skew': 83.247, 'best_test_test/acc_align': 82.094}
[3 / 10] Learning rate: 0.001 weight: 0.01
[3 / 10] Loss: 4.816377019496669 CE Loss: 0.30231262340086423 Con Loss: 4.813353890106462
[3 / 10] tensor([[0.924, 0.915],
        [0.751, 0.645]]) {'epoch': 3, 'valid/acc': 86.655, 'valid/acc_unbiased': 79.983, 'valid/diff': 4.93, 'valid/acc_skew': 82.213, 'valid/acc_align': 77.753, 'test/acc': 87.16, 'test/acc_unbiased': 80.849, 'test/diff': 5.727, 'test/acc_skew': 83.275, 'test/acc_align': 78.423}
[3 / 10] best valid accuracy: 81.792 at epoch 2 
 best_stats: {'best_valid_epoch': 2, 'best_valid_valid/acc': 83.989, 'best_valid_valid/acc_unbiased': 81.792, 'best_valid_valid/diff': 4.207, 'best_valid_valid/acc_skew': 82.968, 'best_valid_valid/acc_align': 80.616, 'best_valid_test/acc': 84.487, 'best_valid_test/acc_unbiased': 82.671, 'best_valid_test/diff': 4.043, 'best_valid_test/acc_skew': 83.247, 'best_valid_test/acc_align': 82.094}
[3 / 10] best test accuracy: 82.671 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 83.989, 'best_test_valid/acc_unbiased': 81.792, 'best_test_valid/diff': 4.207, 'best_test_valid/acc_skew': 82.968, 'best_test_valid/acc_align': 80.616, 'best_test_test/acc': 84.487, 'best_test_test/acc_unbiased': 82.671, 'best_test_test/diff': 4.043, 'best_test_test/acc_skew': 83.247, 'best_test_test/acc_align': 82.094}
[4 / 10] Learning rate: 0.0001 weight: 0.01
[4 / 10] Loss: 4.791691338895578 CE Loss: 0.26903078423930743 Con Loss: 4.789001028650081
[4 / 10] tensor([[0.960, 0.923],
        [0.685, 0.702]]) {'epoch': 4, 'valid/acc': 89.132, 'valid/acc_unbiased': 80.922, 'valid/diff': 1.967, 'valid/acc_skew': 80.376, 'valid/acc_align': 81.468, 'test/acc': 89.379, 'test/acc_unbiased': 81.753, 'test/diff': 2.68, 'test/acc_skew': 80.413, 'test/acc_align': 83.093}
[4 / 10] best valid accuracy: 81.792 at epoch 2 
 best_stats: {'best_valid_epoch': 2, 'best_valid_valid/acc': 83.989, 'best_valid_valid/acc_unbiased': 81.792, 'best_valid_valid/diff': 4.207, 'best_valid_valid/acc_skew': 82.968, 'best_valid_valid/acc_align': 80.616, 'best_valid_test/acc': 84.487, 'best_valid_test/acc_unbiased': 82.671, 'best_valid_test/diff': 4.043, 'best_valid_test/acc_skew': 83.247, 'best_valid_test/acc_align': 82.094}
[4 / 10] best test accuracy: 82.671 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 83.989, 'best_test_valid/acc_unbiased': 81.792, 'best_test_valid/diff': 4.207, 'best_test_valid/acc_skew': 82.968, 'best_test_valid/acc_align': 80.616, 'best_test_test/acc': 84.487, 'best_test_test/acc_unbiased': 82.671, 'best_test_test/diff': 4.043, 'best_test_test/acc_skew': 83.247, 'best_test_test/acc_align': 82.094}
[5 / 10] Learning rate: 0.0001 weight: 0.01
[5 / 10] Loss: 4.77766014802927 CE Loss: 0.256486122544781 Con Loss: 4.775095287699179
[5 / 10] tensor([[0.970, 0.942],
        [0.652, 0.686]]) {'epoch': 5, 'valid/acc': 89.691, 'valid/acc_unbiased': 80.339, 'valid/diff': 1.955, 'valid/acc_skew': 79.361, 'valid/acc_align': 81.316, 'test/acc': 89.978, 'test/acc_unbiased': 81.267, 'test/diff': 3.15, 'test/acc_skew': 79.692, 'test/acc_align': 82.842}
[5 / 10] best valid accuracy: 81.792 at epoch 2 
 best_stats: {'best_valid_epoch': 2, 'best_valid_valid/acc': 83.989, 'best_valid_valid/acc_unbiased': 81.792, 'best_valid_valid/diff': 4.207, 'best_valid_valid/acc_skew': 82.968, 'best_valid_valid/acc_align': 80.616, 'best_valid_test/acc': 84.487, 'best_valid_test/acc_unbiased': 82.671, 'best_valid_test/diff': 4.043, 'best_valid_test/acc_skew': 83.247, 'best_valid_test/acc_align': 82.094}
[5 / 10] best test accuracy: 82.671 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 83.989, 'best_test_valid/acc_unbiased': 81.792, 'best_test_valid/diff': 4.207, 'best_test_valid/acc_skew': 82.968, 'best_test_valid/acc_align': 80.616, 'best_test_test/acc': 84.487, 'best_test_test/acc_unbiased': 82.671, 'best_test_test/diff': 4.043, 'best_test_test/acc_skew': 83.247, 'best_test_test/acc_align': 82.094}
[6 / 10] Learning rate: 0.0001 weight: 0.01
[6 / 10] Loss: 4.776567779531973 CE Loss: 0.24849896759581527 Con Loss: 4.774082795038554
[6 / 10] tensor([[0.965, 0.935],
        [0.649, 0.693]]) {'epoch': 6, 'valid/acc': 89.408, 'valid/acc_unbiased': 80.2, 'valid/diff': 2.256, 'valid/acc_skew': 79.072, 'valid/acc_align': 81.328, 'test/acc': 89.551, 'test/acc_unbiased': 81.049, 'test/diff': 3.686, 'test/acc_skew': 79.206, 'test/acc_align': 82.891}
[6 / 10] best valid accuracy: 81.792 at epoch 2 
 best_stats: {'best_valid_epoch': 2, 'best_valid_valid/acc': 83.989, 'best_valid_valid/acc_unbiased': 81.792, 'best_valid_valid/diff': 4.207, 'best_valid_valid/acc_skew': 82.968, 'best_valid_valid/acc_align': 80.616, 'best_valid_test/acc': 84.487, 'best_valid_test/acc_unbiased': 82.671, 'best_valid_test/diff': 4.043, 'best_valid_test/acc_skew': 83.247, 'best_valid_test/acc_align': 82.094}
[6 / 10] best test accuracy: 82.671 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 83.989, 'best_test_valid/acc_unbiased': 81.792, 'best_test_valid/diff': 4.207, 'best_test_valid/acc_skew': 82.968, 'best_test_valid/acc_align': 80.616, 'best_test_test/acc': 84.487, 'best_test_test/acc_unbiased': 82.671, 'best_test_test/diff': 4.043, 'best_test_test/acc_skew': 83.247, 'best_test_test/acc_align': 82.094}
[7 / 10] Learning rate: 1e-05 weight: 0.01
[7 / 10] Loss: 4.774060391573085 CE Loss: 0.24245473628489736 Con Loss: 4.771635840712273
[7 / 10] tensor([[0.956, 0.925],
        [0.707, 0.737]]) {'epoch': 7, 'valid/acc': 89.736, 'valid/acc_unbiased': 82.856, 'valid/diff': 1.576, 'valid/acc_skew': 82.308, 'valid/acc_align': 83.404, 'test/acc': 89.863, 'test/acc_unbiased': 83.135, 'test/diff': 3.076, 'test/acc_skew': 81.597, 'test/acc_align': 84.673}
[7 / 10] best valid accuracy: 82.856 at epoch 7 
 best_stats: {'best_valid_epoch': 7, 'best_valid_valid/acc': 89.736, 'best_valid_valid/acc_unbiased': 82.856, 'best_valid_valid/diff': 1.576, 'best_valid_valid/acc_skew': 82.308, 'best_valid_valid/acc_align': 83.404, 'best_valid_test/acc': 89.863, 'best_valid_test/acc_unbiased': 83.135, 'best_valid_test/diff': 3.076, 'best_valid_test/acc_skew': 81.597, 'best_valid_test/acc_align': 84.673}
[7 / 10] best test accuracy: 83.135 at epoch 7 
 best_stats: {'best_test_epoch': 7, 'best_test_valid/acc': 89.736, 'best_test_valid/acc_unbiased': 82.856, 'best_test_valid/diff': 1.576, 'best_test_valid/acc_skew': 82.308, 'best_test_valid/acc_align': 83.404, 'best_test_test/acc': 89.863, 'best_test_test/acc_unbiased': 83.135, 'best_test_test/diff': 3.076, 'best_test_test/acc_skew': 81.597, 'best_test_test/acc_align': 84.673}
[8 / 10] Learning rate: 1e-05 weight: 0.01
[8 / 10] Loss: 4.768792182132595 CE Loss: 0.24055110108319377 Con Loss: 4.76638667066403
[8 / 10] tensor([[0.960, 0.929],
        [0.696, 0.722]]) {'epoch': 8, 'valid/acc': 89.756, 'valid/acc_unbiased': 82.267, 'valid/diff': 1.837, 'valid/acc_skew': 81.975, 'valid/acc_align': 82.559, 'test/acc': 89.888, 'test/acc_unbiased': 82.675, 'test/diff': 2.867, 'test/acc_skew': 81.241, 'test/acc_align': 84.108}
[8 / 10] best valid accuracy: 82.856 at epoch 7 
 best_stats: {'best_valid_epoch': 7, 'best_valid_valid/acc': 89.736, 'best_valid_valid/acc_unbiased': 82.856, 'best_valid_valid/diff': 1.576, 'best_valid_valid/acc_skew': 82.308, 'best_valid_valid/acc_align': 83.404, 'best_valid_test/acc': 89.863, 'best_valid_test/acc_unbiased': 83.135, 'best_valid_test/diff': 3.076, 'best_valid_test/acc_skew': 81.597, 'best_valid_test/acc_align': 84.673}
[8 / 10] best test accuracy: 83.135 at epoch 7 
 best_stats: {'best_test_epoch': 7, 'best_test_valid/acc': 89.736, 'best_test_valid/acc_unbiased': 82.856, 'best_test_valid/diff': 1.576, 'best_test_valid/acc_skew': 82.308, 'best_test_valid/acc_align': 83.404, 'best_test_test/acc': 89.863, 'best_test_test/acc_unbiased': 83.135, 'best_test_test/diff': 3.076, 'best_test_test/acc_skew': 81.597, 'best_test_test/acc_align': 84.673}
[9 / 10] Learning rate: 1e-05 weight: 0.01
[9 / 10] Loss: 4.767693646740603 CE Loss: 0.23771511504740073 Con Loss: 4.765316502662488
[9 / 10] tensor([[0.962, 0.931],
        [0.702, 0.735]]) {'epoch': 9, 'valid/acc': 90.006, 'valid/acc_unbiased': 82.644, 'valid/diff': 1.522, 'valid/acc_skew': 82.2, 'valid/acc_align': 83.087, 'test/acc': 90.245, 'test/acc_unbiased': 83.247, 'test/diff': 3.224, 'test/acc_skew': 81.635, 'test/acc_align': 84.859}
[9 / 10] best valid accuracy: 82.856 at epoch 7 
 best_stats: {'best_valid_epoch': 7, 'best_valid_valid/acc': 89.736, 'best_valid_valid/acc_unbiased': 82.856, 'best_valid_valid/diff': 1.576, 'best_valid_valid/acc_skew': 82.308, 'best_valid_valid/acc_align': 83.404, 'best_valid_test/acc': 89.863, 'best_valid_test/acc_unbiased': 83.135, 'best_valid_test/diff': 3.076, 'best_valid_test/acc_skew': 81.597, 'best_valid_test/acc_align': 84.673}
[9 / 10] best test accuracy: 83.247 at epoch 9 
 best_stats: {'best_test_epoch': 9, 'best_test_valid/acc': 90.006, 'best_test_valid/acc_unbiased': 82.644, 'best_test_valid/diff': 1.522, 'best_test_valid/acc_skew': 82.2, 'best_test_valid/acc_align': 83.087, 'best_test_test/acc': 90.245, 'best_test_test/acc_unbiased': 83.247, 'best_test_test/diff': 3.224, 'best_test_test/acc_skew': 81.635, 'best_test_test/acc_align': 84.859}
[10 / 10] Learning rate: 1e-05 weight: 0.01
[10 / 10] Loss: 4.769234662397065 CE Loss: 0.23789440512359114 Con Loss: 4.766855715451181
[10 / 10] tensor([[0.964, 0.931],
        [0.672, 0.721]]) {'epoch': 10, 'valid/acc': 89.931, 'valid/acc_unbiased': 81.98, 'valid/diff': 1.772, 'valid/acc_skew': 81.094, 'valid/acc_align': 82.866, 'test/acc': 89.923, 'test/acc_unbiased': 82.198, 'test/diff': 4.1, 'test/acc_skew': 80.148, 'test/acc_align': 84.248}
[10 / 10] best valid accuracy: 82.856 at epoch 7 
 best_stats: {'best_valid_epoch': 7, 'best_valid_valid/acc': 89.736, 'best_valid_valid/acc_unbiased': 82.856, 'best_valid_valid/diff': 1.576, 'best_valid_valid/acc_skew': 82.308, 'best_valid_valid/acc_align': 83.404, 'best_valid_test/acc': 89.863, 'best_valid_test/acc_unbiased': 83.135, 'best_valid_test/diff': 3.076, 'best_valid_test/acc_skew': 81.597, 'best_valid_test/acc_align': 84.673}
[10 / 10] best test accuracy: 83.247 at epoch 9 
 best_stats: {'best_test_epoch': 9, 'best_test_valid/acc': 90.006, 'best_test_valid/acc_unbiased': 82.644, 'best_test_valid/diff': 1.522, 'best_test_valid/acc_skew': 82.2, 'best_test_valid/acc_align': 83.087, 'best_test_test/acc': 90.245, 'best_test_test/acc_unbiased': 83.247, 'best_test_test/diff': 3.224, 'best_test_test/acc_skew': 81.635, 'best_test_test/acc_align': 84.859}
Total training time: 1:44:48
