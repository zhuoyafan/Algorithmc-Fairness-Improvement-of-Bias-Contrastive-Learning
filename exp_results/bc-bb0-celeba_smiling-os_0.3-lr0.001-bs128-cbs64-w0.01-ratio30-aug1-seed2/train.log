Log level set to: INFO
Set seed: 2
=======> Using Fixed Random Seed: 2 <========
save_path: exp_results/bc-bb0-celeba_smiling-os_0.3-lr0.001-bs128-cbs64-w0.01-ratio30-aug1-seed2
get_celeba - split:train, aug: False, given_y: True, ratio: 0
use existing smiling indices from data/celeba/pickles/smiling
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [12183, 12183]
Target 1: [12183, 12183]
Binary Target 1
---------------------------
Target 0: [12183, 12183]
Target 1: [12183, 12183]
===================================
Normal Label Distribution: 
Target 0: [12183, 12183]
Target 1: [12183, 12183]
===================================
Use BiasedCelebASplit 
 target_attr: smiling split: train 
 tensor([[12183., 12183.],
        [12183., 12183.]])
get_celeba - split:train, aug: 1, given_y: True, ratio: 30
use existing smiling indices from data/celeba/pickles/smiling
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [12230, 12230]
Target 1: [12230, 12230]
Binary Target 1
---------------------------
Target 0: [12230, 12230]
Target 1: [12230, 12230]
===================================
Normal Label Distribution: 
Target 0: [12230, 12230]
Target 1: [12230, 12230]
===================================
Use BiasedCelebASplit 
 target_attr: smiling split: train 
 tensor([[12230., 12230.],
        [12230., 12230.]])
get_celeba - split:train_valid, aug: False, given_y: True, ratio: 0
use existing smiling indices from data/celeba/pickles/smiling
Use BiasedCelebASplit 
 target_attr: smiling split: train_valid 
 tensor([[ 1973., 10114.],
        [ 8289.,  1989.]])
get_celeba - split:valid, aug: False, given_y: True, ratio: 0
Use BiasedCelebASplit 
 target_attr: smiling split: valid 
 tensor([[5252., 6157.],
        [5013., 3445.]])
decay_epochs: [3, 6]
[1 / 10] Learning rate: 0.001 weight: 0.01
[1 / 10] Loss: 4.662091538049529 CE Loss: 0.27796225334284275 Con Loss: 4.659311904780415
[1 / 10] tensor([[0.948, 0.926],
        [0.887, 0.881]]) {'epoch': 1, 'valid/acc': 90.557, 'valid/acc_unbiased': 91.132, 'valid/diff': 1.256, 'valid/acc_skew': 91.717, 'valid/acc_align': 90.547, 'test/acc': 91.186, 'test/acc_unbiased': 91.043, 'test/diff': 1.428, 'test/acc_skew': 91.757, 'test/acc_align': 90.329}
[1 / 10] best valid accuracy: 91.132 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 90.557, 'best_valid_valid/acc_unbiased': 91.132, 'best_valid_valid/diff': 1.256, 'best_valid_valid/acc_skew': 91.717, 'best_valid_valid/acc_align': 90.547, 'best_valid_test/acc': 91.186, 'best_valid_test/acc_unbiased': 91.043, 'best_valid_test/diff': 1.428, 'best_valid_test/acc_skew': 91.757, 'best_valid_test/acc_align': 90.329}
[1 / 10] best test accuracy: 91.043 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 90.557, 'best_test_valid/acc_unbiased': 91.132, 'best_test_valid/diff': 1.256, 'best_test_valid/acc_skew': 91.717, 'best_test_valid/acc_align': 90.547, 'best_test_test/acc': 91.186, 'best_test_test/acc_unbiased': 91.043, 'best_test_test/diff': 1.428, 'best_test_test/acc_skew': 91.757, 'best_test_test/acc_align': 90.329}
[2 / 10] Learning rate: 0.001 weight: 0.01
[2 / 10] Loss: 4.608250637433314 CE Loss: 0.23801428417795292 Con Loss: 4.605870511196599
[2 / 10] tensor([[0.921, 0.911],
        [0.922, 0.904]]) {'epoch': 2, 'valid/acc': 91.473, 'valid/acc_unbiased': 91.431, 'valid/diff': 1.196, 'valid/acc_skew': 92.029, 'valid/acc_align': 90.833, 'test/acc': 91.594, 'test/acc_unbiased': 91.464, 'test/diff': 1.395, 'test/acc_skew': 92.162, 'test/acc_align': 90.767}
[2 / 10] best valid accuracy: 91.431 at epoch 2 
 best_stats: {'best_valid_epoch': 2, 'best_valid_valid/acc': 91.473, 'best_valid_valid/acc_unbiased': 91.431, 'best_valid_valid/diff': 1.196, 'best_valid_valid/acc_skew': 92.029, 'best_valid_valid/acc_align': 90.833, 'best_valid_test/acc': 91.594, 'best_valid_test/acc_unbiased': 91.464, 'best_valid_test/diff': 1.395, 'best_valid_test/acc_skew': 92.162, 'best_valid_test/acc_align': 90.767}
[2 / 10] best test accuracy: 91.464 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 91.473, 'best_test_valid/acc_unbiased': 91.431, 'best_test_valid/diff': 1.196, 'best_test_valid/acc_skew': 92.029, 'best_test_valid/acc_align': 90.833, 'best_test_test/acc': 91.594, 'best_test_test/acc_unbiased': 91.464, 'best_test_test/diff': 1.395, 'best_test_test/acc_skew': 92.162, 'best_test_test/acc_align': 90.767}
[3 / 10] Learning rate: 0.001 weight: 0.01
[3 / 10] Loss: 4.601290646106614 CE Loss: 0.23224000041266435 Con Loss: 4.598968252548197
[3 / 10] tensor([[0.907, 0.892],
        [0.936, 0.929]]) {'epoch': 3, 'valid/acc': 91.455, 'valid/acc_unbiased': 91.335, 'valid/diff': 1.437, 'valid/acc_skew': 92.053, 'valid/acc_align': 90.616, 'test/acc': 91.629, 'test/acc_unbiased': 91.626, 'test/diff': 1.126, 'test/acc_skew': 92.188, 'test/acc_align': 91.063}
[3 / 10] best valid accuracy: 91.431 at epoch 2 
 best_stats: {'best_valid_epoch': 2, 'best_valid_valid/acc': 91.473, 'best_valid_valid/acc_unbiased': 91.431, 'best_valid_valid/diff': 1.196, 'best_valid_valid/acc_skew': 92.029, 'best_valid_valid/acc_align': 90.833, 'best_valid_test/acc': 91.594, 'best_valid_test/acc_unbiased': 91.464, 'best_valid_test/diff': 1.395, 'best_valid_test/acc_skew': 92.162, 'best_valid_test/acc_align': 90.767}
[3 / 10] best test accuracy: 91.626 at epoch 3 
 best_stats: {'best_test_epoch': 3, 'best_test_valid/acc': 91.455, 'best_test_valid/acc_unbiased': 91.335, 'best_test_valid/diff': 1.437, 'best_test_valid/acc_skew': 92.053, 'best_test_valid/acc_align': 90.616, 'best_test_test/acc': 91.629, 'best_test_test/acc_unbiased': 91.626, 'best_test_test/diff': 1.126, 'best_test_test/acc_skew': 92.188, 'best_test_test/acc_align': 91.063}
[4 / 10] Learning rate: 0.0001 weight: 0.01
[4 / 10] Loss: 4.556766864653244 CE Loss: 0.2037422628685689 Con Loss: 4.554729455955547
[4 / 10] tensor([[0.941, 0.932],
        [0.920, 0.902]]) {'epoch': 4, 'valid/acc': 92.269, 'valid/acc_unbiased': 92.199, 'valid/diff': 1.213, 'valid/acc_skew': 92.806, 'valid/acc_align': 91.592, 'test/acc': 92.54, 'test/acc_unbiased': 92.375, 'test/diff': 1.326, 'test/acc_skew': 93.038, 'test/acc_align': 91.712}
[4 / 10] best valid accuracy: 92.199 at epoch 4 
 best_stats: {'best_valid_epoch': 4, 'best_valid_valid/acc': 92.269, 'best_valid_valid/acc_unbiased': 92.199, 'best_valid_valid/diff': 1.213, 'best_valid_valid/acc_skew': 92.806, 'best_valid_valid/acc_align': 91.592, 'best_valid_test/acc': 92.54, 'best_valid_test/acc_unbiased': 92.375, 'best_valid_test/diff': 1.326, 'best_valid_test/acc_skew': 93.038, 'best_valid_test/acc_align': 91.712}
[4 / 10] best test accuracy: 92.375 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 92.269, 'best_test_valid/acc_unbiased': 92.199, 'best_test_valid/diff': 1.213, 'best_test_valid/acc_skew': 92.806, 'best_test_valid/acc_align': 91.592, 'best_test_test/acc': 92.54, 'best_test_test/acc_unbiased': 92.375, 'best_test_test/diff': 1.326, 'best_test_test/acc_skew': 93.038, 'best_test_test/acc_align': 91.712}
[5 / 10] Learning rate: 0.0001 weight: 0.01
[5 / 10] Loss: 4.535425241148297 CE Loss: 0.19863944159253305 Con Loss: 4.533438851012783
[5 / 10] tensor([[0.931, 0.909],
        [0.931, 0.928]]) {'epoch': 5, 'valid/acc': 92.046, 'valid/acc_unbiased': 92.23, 'valid/diff': 1.365, 'valid/acc_skew': 92.912, 'valid/acc_align': 91.547, 'test/acc': 92.49, 'test/acc_unbiased': 92.474, 'test/diff': 1.204, 'test/acc_skew': 93.077, 'test/acc_align': 91.872}
[5 / 10] best valid accuracy: 92.230 at epoch 5 
 best_stats: {'best_valid_epoch': 5, 'best_valid_valid/acc': 92.046, 'best_valid_valid/acc_unbiased': 92.23, 'best_valid_valid/diff': 1.365, 'best_valid_valid/acc_skew': 92.912, 'best_valid_valid/acc_align': 91.547, 'best_valid_test/acc': 92.49, 'best_valid_test/acc_unbiased': 92.474, 'best_valid_test/diff': 1.204, 'best_valid_test/acc_skew': 93.077, 'best_valid_test/acc_align': 91.872}
[5 / 10] best test accuracy: 92.474 at epoch 5 
 best_stats: {'best_test_epoch': 5, 'best_test_valid/acc': 92.046, 'best_test_valid/acc_unbiased': 92.23, 'best_test_valid/diff': 1.365, 'best_test_valid/acc_skew': 92.912, 'best_test_valid/acc_align': 91.547, 'best_test_test/acc': 92.49, 'best_test_test/acc_unbiased': 92.474, 'best_test_test/diff': 1.204, 'best_test_test/acc_skew': 93.077, 'best_test_test/acc_align': 91.872}
[6 / 10] Learning rate: 0.0001 weight: 0.01
[6 / 10] Loss: 4.536563457472418 CE Loss: 0.19430526654620306 Con Loss: 4.53462040284423
[6 / 10] tensor([[0.932, 0.920],
        [0.929, 0.920]]) {'epoch': 6, 'valid/acc': 92.609, 'valid/acc_unbiased': 92.584, 'valid/diff': 1.15, 'valid/acc_skew': 93.159, 'valid/acc_align': 92.009, 'test/acc': 92.601, 'test/acc_unbiased': 92.532, 'test/diff': 1.037, 'test/acc_skew': 93.051, 'test/acc_align': 92.014}
[6 / 10] best valid accuracy: 92.584 at epoch 6 
 best_stats: {'best_valid_epoch': 6, 'best_valid_valid/acc': 92.609, 'best_valid_valid/acc_unbiased': 92.584, 'best_valid_valid/diff': 1.15, 'best_valid_valid/acc_skew': 93.159, 'best_valid_valid/acc_align': 92.009, 'best_valid_test/acc': 92.601, 'best_valid_test/acc_unbiased': 92.532, 'best_valid_test/diff': 1.037, 'best_valid_test/acc_skew': 93.051, 'best_valid_test/acc_align': 92.014}
[6 / 10] best test accuracy: 92.532 at epoch 6 
 best_stats: {'best_test_epoch': 6, 'best_test_valid/acc': 92.609, 'best_test_valid/acc_unbiased': 92.584, 'best_test_valid/diff': 1.15, 'best_test_valid/acc_skew': 93.159, 'best_test_valid/acc_align': 92.009, 'best_test_test/acc': 92.601, 'best_test_test/acc_unbiased': 92.532, 'best_test_test/diff': 1.037, 'best_test_test/acc_skew': 93.051, 'best_test_test/acc_align': 92.014}
[7 / 10] Learning rate: 1e-05 weight: 0.01
[7 / 10] Loss: 4.536139977973425 CE Loss: 0.18998342226029694 Con Loss: 4.534240132666648
[7 / 10] tensor([[0.941, 0.928],
        [0.921, 0.917]]) {'epoch': 7, 'valid/acc': 92.649, 'valid/acc_unbiased': 92.652, 'valid/diff': 1.342, 'valid/acc_skew': 93.323, 'valid/acc_align': 91.981, 'test/acc': 92.737, 'test/acc_unbiased': 92.672, 'test/diff': 0.896, 'test/acc_skew': 93.12, 'test/acc_align': 92.224}
[7 / 10] best valid accuracy: 92.652 at epoch 7 
 best_stats: {'best_valid_epoch': 7, 'best_valid_valid/acc': 92.649, 'best_valid_valid/acc_unbiased': 92.652, 'best_valid_valid/diff': 1.342, 'best_valid_valid/acc_skew': 93.323, 'best_valid_valid/acc_align': 91.981, 'best_valid_test/acc': 92.737, 'best_valid_test/acc_unbiased': 92.672, 'best_valid_test/diff': 0.896, 'best_valid_test/acc_skew': 93.12, 'best_valid_test/acc_align': 92.224}
[7 / 10] best test accuracy: 92.672 at epoch 7 
 best_stats: {'best_test_epoch': 7, 'best_test_valid/acc': 92.649, 'best_test_valid/acc_unbiased': 92.652, 'best_test_valid/diff': 1.342, 'best_test_valid/acc_skew': 93.323, 'best_test_valid/acc_align': 91.981, 'best_test_test/acc': 92.737, 'best_test_test/acc_unbiased': 92.672, 'best_test_test/diff': 0.896, 'best_test_test/acc_skew': 93.12, 'best_test_test/acc_align': 92.224}
[8 / 10] Learning rate: 1e-05 weight: 0.01
[8 / 10] Loss: 4.53060471106464 CE Loss: 0.18865110025116838 Con Loss: 4.528718193558004
[8 / 10] tensor([[0.937, 0.930],
        [0.924, 0.914]]) {'epoch': 8, 'valid/acc': 92.689, 'valid/acc_unbiased': 92.703, 'valid/diff': 1.268, 'valid/acc_skew': 93.337, 'valid/acc_align': 92.069, 'test/acc': 92.717, 'test/acc_unbiased': 92.623, 'test/diff': 0.851, 'test/acc_skew': 93.048, 'test/acc_align': 92.198}
[8 / 10] best valid accuracy: 92.703 at epoch 8 
 best_stats: {'best_valid_epoch': 8, 'best_valid_valid/acc': 92.689, 'best_valid_valid/acc_unbiased': 92.703, 'best_valid_valid/diff': 1.268, 'best_valid_valid/acc_skew': 93.337, 'best_valid_valid/acc_align': 92.069, 'best_valid_test/acc': 92.717, 'best_valid_test/acc_unbiased': 92.623, 'best_valid_test/diff': 0.851, 'best_valid_test/acc_skew': 93.048, 'best_valid_test/acc_align': 92.198}
[8 / 10] best test accuracy: 92.672 at epoch 7 
 best_stats: {'best_test_epoch': 7, 'best_test_valid/acc': 92.649, 'best_test_valid/acc_unbiased': 92.652, 'best_test_valid/diff': 1.342, 'best_test_valid/acc_skew': 93.323, 'best_test_valid/acc_align': 91.981, 'best_test_test/acc': 92.737, 'best_test_test/acc_unbiased': 92.672, 'best_test_test/diff': 0.896, 'best_test_test/acc_skew': 93.12, 'best_test_test/acc_align': 92.224}
[9 / 10] Learning rate: 1e-05 weight: 0.01
[9 / 10] Loss: 4.529016661759443 CE Loss: 0.1874718808520166 Con Loss: 4.52714193970036
[9 / 10] tensor([[0.940, 0.929],
        [0.921, 0.912]]) {'epoch': 9, 'valid/acc': 92.649, 'valid/acc_unbiased': 92.637, 'valid/diff': 1.394, 'valid/acc_skew': 93.334, 'valid/acc_align': 91.94, 'test/acc': 92.641, 'test/acc_unbiased': 92.543, 'test/diff': 0.991, 'test/acc_skew': 93.038, 'test/acc_align': 92.047}
[9 / 10] best valid accuracy: 92.703 at epoch 8 
 best_stats: {'best_valid_epoch': 8, 'best_valid_valid/acc': 92.689, 'best_valid_valid/acc_unbiased': 92.703, 'best_valid_valid/diff': 1.268, 'best_valid_valid/acc_skew': 93.337, 'best_valid_valid/acc_align': 92.069, 'best_valid_test/acc': 92.717, 'best_valid_test/acc_unbiased': 92.623, 'best_valid_test/diff': 0.851, 'best_valid_test/acc_skew': 93.048, 'best_valid_test/acc_align': 92.198}
[9 / 10] best test accuracy: 92.672 at epoch 7 
 best_stats: {'best_test_epoch': 7, 'best_test_valid/acc': 92.649, 'best_test_valid/acc_unbiased': 92.652, 'best_test_valid/diff': 1.342, 'best_test_valid/acc_skew': 93.323, 'best_test_valid/acc_align': 91.981, 'best_test_test/acc': 92.737, 'best_test_test/acc_unbiased': 92.672, 'best_test_test/diff': 0.896, 'best_test_test/acc_skew': 93.12, 'best_test_test/acc_align': 92.224}
[10 / 10] Learning rate: 1e-05 weight: 0.01
[10 / 10] Loss: 4.521586105739954 CE Loss: 0.1888225014834219 Con Loss: 4.519697879204792
[10 / 10] tensor([[0.936, 0.923],
        [0.927, 0.923]]) {'epoch': 10, 'valid/acc': 92.613, 'valid/acc_unbiased': 92.717, 'valid/diff': 1.403, 'valid/acc_skew': 93.419, 'valid/acc_align': 92.016, 'test/acc': 92.772, 'test/acc_unbiased': 92.726, 'test/diff': 0.893, 'test/acc_skew': 93.173, 'test/acc_align': 92.279}
[10 / 10] best valid accuracy: 92.717 at epoch 10 
 best_stats: {'best_valid_epoch': 10, 'best_valid_valid/acc': 92.613, 'best_valid_valid/acc_unbiased': 92.717, 'best_valid_valid/diff': 1.403, 'best_valid_valid/acc_skew': 93.419, 'best_valid_valid/acc_align': 92.016, 'best_valid_test/acc': 92.772, 'best_valid_test/acc_unbiased': 92.726, 'best_valid_test/diff': 0.893, 'best_valid_test/acc_skew': 93.173, 'best_valid_test/acc_align': 92.279}
[10 / 10] best test accuracy: 92.726 at epoch 10 
 best_stats: {'best_test_epoch': 10, 'best_test_valid/acc': 92.613, 'best_test_valid/acc_unbiased': 92.717, 'best_test_valid/diff': 1.403, 'best_test_valid/acc_skew': 93.419, 'best_test_valid/acc_align': 92.016, 'best_test_test/acc': 92.772, 'best_test_test/acc_unbiased': 92.726, 'best_test_test/diff': 0.893, 'best_test_test/acc_skew': 93.173, 'best_test_test/acc_align': 92.279}
Total training time: 0:54:12
