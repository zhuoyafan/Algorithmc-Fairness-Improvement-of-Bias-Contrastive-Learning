Log level set to: INFO
Set seed: 1
=======> Using Fixed Random Seed: 1 <========
save_path: exp_results/bc-bb0-utk_face_age-crop_rotate_blur-0.9-lr0.001-bs128-cbs64-w0.01-ratio10-aug1-seed1
get_utk_face - split: train, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_age-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
Binary Target 1
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Normal Label Distribution: 
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
Binary Target 1
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Normal Label Distribution: 
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 10684, target_attr: gender, bias_attr: age bias_rate: 0.9
['[train] target_0-bias_0: 8237', '[train] target_0-bias_1: 147', '[train] target_1-bias_0: 823', '[train] target_1-bias_1: 1477']
confusion_matrix - 
 original: tensor([[8237.,  823.],
        [ 147., 1477.]]), 
 normalized: tensor([[0.909, 0.091],
        [0.091, 0.909]]), 
 b|y: tensor([[0.982, 0.018],
        [0.358, 0.642]])
get_utk_face - split: train, aug: 1, given_y: True, ratio: 10
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_age-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
Binary Target 1
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Normal Label Distribution: 
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
Binary Target 1
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Normal Label Distribution: 
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 10684, target_attr: gender, bias_attr: age bias_rate: 0.9
['[train] target_0-bias_0: 8237', '[train] target_0-bias_1: 147', '[train] target_1-bias_0: 823', '[train] target_1-bias_1: 1477']
get_utk_face - split: valid, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_age-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [1030, 195]
Target 1: [841, 202]
Binary Target 1
---------------------------
Target 0: [1030, 195]
Target 1: [841, 202]
===================================
Normal Label Distribution: 
Target 0: [1030, 195]
Target 1: [841, 202]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 2268, target_attr: gender, bias_attr: age bias_rate: 0.9
['[valid] target_0-bias_0: 1030', '[valid] target_0-bias_1: 195', '[valid] target_1-bias_0: 841', '[valid] target_1-bias_1: 202']
get_utk_face - split: test, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_age-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [1061, 176]
Target 1: [867, 165]
Binary Target 1
---------------------------
Target 0: [1061, 176]
Target 1: [867, 165]
===================================
Normal Label Distribution: 
Target 0: [1061, 176]
Target 1: [867, 165]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 2269, target_attr: gender, bias_attr: age bias_rate: 0.9
['[test] target_0-bias_0: 1061', '[test] target_0-bias_1: 176', '[test] target_1-bias_0: 867', '[test] target_1-bias_1: 165']
decay_epochs: [6, 13]
[1 / 20] Learning rate: 0.001 weight: 0.01
[1 / 20] Loss: 4.821876962905249 CE Loss: 0.5584800453812654 Con Loss: 4.816292165415602
[1 / 20] tensor([[0.964, 0.994],
        [0.155, 0.067]]) {'epoch': 1, 'valid/acc': 57.319, 'valid/acc_unbiased': 53.268, 'valid/diff': 2.596, 'valid/acc_skew': 54.567, 'valid/acc_align': 51.97, 'test/acc': 59.189, 'test/acc_unbiased': 54.493, 'test/diff': 5.901, 'test/acc_skew': 57.444, 'test/acc_align': 51.543}
[1 / 20] best valid accuracy: 53.268 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 57.319, 'best_valid_valid/acc_unbiased': 53.268, 'best_valid_valid/diff': 2.596, 'best_valid_valid/acc_skew': 54.567, 'best_valid_valid/acc_align': 51.97, 'best_valid_test/acc': 59.189, 'best_valid_test/acc_unbiased': 54.493, 'best_valid_test/diff': 5.901, 'best_valid_test/acc_skew': 57.444, 'best_valid_test/acc_align': 51.543}
[1 / 20] best test accuracy: 54.493 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 57.319, 'best_test_valid/acc_unbiased': 53.268, 'best_test_valid/diff': 2.596, 'best_test_valid/acc_skew': 54.567, 'best_test_valid/acc_align': 51.97, 'best_test_test/acc': 59.189, 'best_test_test/acc_unbiased': 54.493, 'best_test_test/diff': 5.901, 'best_test_test/acc_skew': 57.444, 'best_test_test/acc_align': 51.543}
[2 / 20] Learning rate: 0.001 weight: 0.01
[2 / 20] Loss: 4.705706453912493 CE Loss: 0.5137322361618336 Con Loss: 4.700569148368936
[2 / 20] tensor([[0.983, 0.989],
        [0.051, 0.109]]) {'epoch': 2, 'valid/acc': 55.952, 'valid/acc_unbiased': 52.693, 'valid/diff': 1.574, 'valid/acc_skew': 51.906, 'valid/acc_align': 53.48, 'test/acc': 56.368, 'test/acc_unbiased': 53.288, 'test/diff': 3.197, 'test/acc_skew': 51.969, 'test/acc_align': 54.606}
[2 / 20] best valid accuracy: 53.268 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 57.319, 'best_valid_valid/acc_unbiased': 53.268, 'best_valid_valid/diff': 2.596, 'best_valid_valid/acc_skew': 54.567, 'best_valid_valid/acc_align': 51.97, 'best_valid_test/acc': 59.189, 'best_valid_test/acc_unbiased': 54.493, 'best_valid_test/diff': 5.901, 'best_valid_test/acc_skew': 57.444, 'best_valid_test/acc_align': 51.543}
[2 / 20] best test accuracy: 54.493 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 57.319, 'best_test_valid/acc_unbiased': 53.268, 'best_test_valid/diff': 2.596, 'best_test_valid/acc_skew': 54.567, 'best_test_valid/acc_align': 51.97, 'best_test_test/acc': 59.189, 'best_test_test/acc_unbiased': 54.493, 'best_test_test/diff': 5.901, 'best_test_test/acc_skew': 57.444, 'best_test_test/acc_align': 51.543}
[3 / 20] Learning rate: 0.001 weight: 0.01
[3 / 20] Loss: 4.611492502783086 CE Loss: 0.5174035895009114 Con Loss: 4.606318472387727
[3 / 20] tensor([[0.994, 0.955],
        [0.081, 0.067]]) {'epoch': 3, 'valid/acc': 57.496, 'valid/acc_unbiased': 53.394, 'valid/diff': 1.45, 'valid/acc_skew': 52.921, 'valid/acc_align': 53.868, 'test/acc': 57.47, 'test/acc_unbiased': 52.407, 'test/diff': 2.694, 'test/acc_skew': 51.764, 'test/acc_align': 53.051}
[3 / 20] best valid accuracy: 53.394 at epoch 3 
 best_stats: {'best_valid_epoch': 3, 'best_valid_valid/acc': 57.496, 'best_valid_valid/acc_unbiased': 53.394, 'best_valid_valid/diff': 1.45, 'best_valid_valid/acc_skew': 52.921, 'best_valid_valid/acc_align': 53.868, 'best_valid_test/acc': 57.47, 'best_valid_test/acc_unbiased': 52.407, 'best_valid_test/diff': 2.694, 'best_valid_test/acc_skew': 51.764, 'best_valid_test/acc_align': 53.051}
[3 / 20] best test accuracy: 54.493 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 57.319, 'best_test_valid/acc_unbiased': 53.268, 'best_test_valid/diff': 2.596, 'best_test_valid/acc_skew': 54.567, 'best_test_valid/acc_align': 51.97, 'best_test_test/acc': 59.189, 'best_test_test/acc_unbiased': 54.493, 'best_test_test/diff': 5.901, 'best_test_test/acc_skew': 57.444, 'best_test_test/acc_align': 51.543}
[4 / 20] Learning rate: 0.001 weight: 0.01
[4 / 20] Loss: 4.6525400153531065 CE Loss: 0.5079041960332242 Con Loss: 4.647460975347053
[4 / 20] tensor([[0.997, 0.994],
        [0.040, 0.073]]) {'epoch': 4, 'valid/acc': 55.908, 'valid/acc_unbiased': 52.724, 'valid/diff': 2.192, 'valid/acc_skew': 51.627, 'valid/acc_align': 53.82, 'test/acc': 56.413, 'test/acc_unbiased': 52.615, 'test/diff': 1.761, 'test/acc_skew': 51.734, 'test/acc_align': 53.495}
[4 / 20] best valid accuracy: 53.394 at epoch 3 
 best_stats: {'best_valid_epoch': 3, 'best_valid_valid/acc': 57.496, 'best_valid_valid/acc_unbiased': 53.394, 'best_valid_valid/diff': 1.45, 'best_valid_valid/acc_skew': 52.921, 'best_valid_valid/acc_align': 53.868, 'best_valid_test/acc': 57.47, 'best_valid_test/acc_unbiased': 52.407, 'best_valid_test/diff': 2.694, 'best_valid_test/acc_skew': 51.764, 'best_valid_test/acc_align': 53.051}
[4 / 20] best test accuracy: 54.493 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 57.319, 'best_test_valid/acc_unbiased': 53.268, 'best_test_valid/diff': 2.596, 'best_test_valid/acc_skew': 54.567, 'best_test_valid/acc_align': 51.97, 'best_test_test/acc': 59.189, 'best_test_test/acc_unbiased': 54.493, 'best_test_test/diff': 5.901, 'best_test_test/acc_skew': 57.444, 'best_test_test/acc_align': 51.543}
[5 / 20] Learning rate: 0.001 weight: 0.01
[5 / 20] Loss: 4.660807180208287 CE Loss: 0.48989528660826004 Con Loss: 4.655908222905441
[5 / 20] tensor([[0.966, 0.960],
        [0.225, 0.103]]) {'epoch': 5, 'valid/acc': 60.847, 'valid/acc_unbiased': 56.434, 'valid/diff': 4.099, 'valid/acc_skew': 57.937, 'valid/acc_align': 54.931, 'test/acc': 61.966, 'test/acc_unbiased': 56.356, 'test/diff': 6.386, 'test/acc_skew': 59.257, 'test/acc_align': 53.455}
[5 / 20] best valid accuracy: 56.434 at epoch 5 
 best_stats: {'best_valid_epoch': 5, 'best_valid_valid/acc': 60.847, 'best_valid_valid/acc_unbiased': 56.434, 'best_valid_valid/diff': 4.099, 'best_valid_valid/acc_skew': 57.937, 'best_valid_valid/acc_align': 54.931, 'best_valid_test/acc': 61.966, 'best_valid_test/acc_unbiased': 56.356, 'best_valid_test/diff': 6.386, 'best_valid_test/acc_skew': 59.257, 'best_valid_test/acc_align': 53.455}
[5 / 20] best test accuracy: 56.356 at epoch 5 
 best_stats: {'best_test_epoch': 5, 'best_test_valid/acc': 60.847, 'best_test_valid/acc_unbiased': 56.434, 'best_test_valid/diff': 4.099, 'best_test_valid/acc_skew': 57.937, 'best_test_valid/acc_align': 54.931, 'best_test_test/acc': 61.966, 'best_test_test/acc_unbiased': 56.356, 'best_test_test/diff': 6.386, 'best_test_test/acc_skew': 59.257, 'best_test_test/acc_align': 53.455}
[6 / 20] Learning rate: 0.001 weight: 0.01
[6 / 20] Loss: 4.584822000434273 CE Loss: 0.4891261618622052 Con Loss: 4.579930726618679
[6 / 20] tensor([[0.998, 0.983],
        [0.042, 0.042]]) {'epoch': 6, 'valid/acc': 55.732, 'valid/acc_unbiased': 51.548, 'valid/diff': 1.152, 'valid/acc_skew': 51.806, 'valid/acc_align': 51.291, 'test/acc': 56.192, 'test/acc_unbiased': 51.625, 'test/diff': 0.803, 'test/acc_skew': 51.224, 'test/acc_align': 52.027}
[6 / 20] best valid accuracy: 56.434 at epoch 5 
 best_stats: {'best_valid_epoch': 5, 'best_valid_valid/acc': 60.847, 'best_valid_valid/acc_unbiased': 56.434, 'best_valid_valid/diff': 4.099, 'best_valid_valid/acc_skew': 57.937, 'best_valid_valid/acc_align': 54.931, 'best_valid_test/acc': 61.966, 'best_valid_test/acc_unbiased': 56.356, 'best_valid_test/diff': 6.386, 'best_valid_test/acc_skew': 59.257, 'best_valid_test/acc_align': 53.455}
[6 / 20] best test accuracy: 56.356 at epoch 5 
 best_stats: {'best_test_epoch': 5, 'best_test_valid/acc': 60.847, 'best_test_valid/acc_unbiased': 56.434, 'best_test_valid/diff': 4.099, 'best_test_valid/acc_skew': 57.937, 'best_test_valid/acc_align': 54.931, 'best_test_test/acc': 61.966, 'best_test_test/acc_unbiased': 56.356, 'best_test_test/diff': 6.386, 'best_test_test/acc_skew': 59.257, 'best_test_test/acc_align': 53.455}
[7 / 20] Learning rate: 0.0001 weight: 0.01
[7 / 20] Loss: 4.610933678554534 CE Loss: 0.47387927000730595 Con Loss: 4.606194895869647
[7 / 20] tensor([[0.970, 0.932],
        [0.268, 0.230]]) {'epoch': 7, 'valid/acc': 63.051, 'valid/acc_unbiased': 59.691, 'valid/diff': 2.662, 'valid/acc_skew': 58.36, 'valid/acc_align': 61.022, 'test/acc': 64.478, 'test/acc_unbiased': 59.989, 'test/diff': 3.765, 'test/acc_skew': 59.97, 'test/acc_align': 60.007}
[7 / 20] best valid accuracy: 59.691 at epoch 7 
 best_stats: {'best_valid_epoch': 7, 'best_valid_valid/acc': 63.051, 'best_valid_valid/acc_unbiased': 59.691, 'best_valid_valid/diff': 2.662, 'best_valid_valid/acc_skew': 58.36, 'best_valid_valid/acc_align': 61.022, 'best_valid_test/acc': 64.478, 'best_valid_test/acc_unbiased': 59.989, 'best_valid_test/diff': 3.765, 'best_valid_test/acc_skew': 59.97, 'best_valid_test/acc_align': 60.007}
[7 / 20] best test accuracy: 59.989 at epoch 7 
 best_stats: {'best_test_epoch': 7, 'best_test_valid/acc': 63.051, 'best_test_valid/acc_unbiased': 59.691, 'best_test_valid/diff': 2.662, 'best_test_valid/acc_skew': 58.36, 'best_test_valid/acc_align': 61.022, 'best_test_test/acc': 64.478, 'best_test_test/acc_unbiased': 59.989, 'best_test_test/diff': 3.765, 'best_test_test/acc_skew': 59.97, 'best_test_test/acc_align': 60.007}
[8 / 20] Learning rate: 0.0001 weight: 0.01
[8 / 20] Loss: 4.533055554700228 CE Loss: 0.4729026468092027 Con Loss: 4.528326539411299
[8 / 20] tensor([[0.968, 0.881],
        [0.272, 0.339]]) {'epoch': 8, 'valid/acc': 64.727, 'valid/acc_unbiased': 62.398, 'valid/diff': 6.449, 'valid/acc_skew': 59.174, 'valid/acc_align': 65.623, 'test/acc': 64.963, 'test/acc_unbiased': 61.506, 'test/diff': 7.723, 'test/acc_skew': 57.644, 'test/acc_align': 65.367}
[8 / 20] best valid accuracy: 62.398 at epoch 8 
 best_stats: {'best_valid_epoch': 8, 'best_valid_valid/acc': 64.727, 'best_valid_valid/acc_unbiased': 62.398, 'best_valid_valid/diff': 6.449, 'best_valid_valid/acc_skew': 59.174, 'best_valid_valid/acc_align': 65.623, 'best_valid_test/acc': 64.963, 'best_valid_test/acc_unbiased': 61.506, 'best_valid_test/diff': 7.723, 'best_valid_test/acc_skew': 57.644, 'best_valid_test/acc_align': 65.367}
[8 / 20] best test accuracy: 61.506 at epoch 8 
 best_stats: {'best_test_epoch': 8, 'best_test_valid/acc': 64.727, 'best_test_valid/acc_unbiased': 62.398, 'best_test_valid/diff': 6.449, 'best_test_valid/acc_skew': 59.174, 'best_test_valid/acc_align': 65.623, 'best_test_test/acc': 64.963, 'best_test_test/acc_unbiased': 61.506, 'best_test_test/diff': 7.723, 'best_test_test/acc_skew': 57.644, 'best_test_test/acc_align': 65.367}
[9 / 20] Learning rate: 0.0001 weight: 0.01
[9 / 20] Loss: 4.533227230537611 CE Loss: 0.4683948724803653 Con Loss: 4.5285432825192045
[9 / 20] tensor([[0.972, 0.841],
        [0.300, 0.364]]) {'epoch': 9, 'valid/acc': 65.123, 'valid/acc_unbiased': 62.047, 'valid/diff': 11.811, 'valid/acc_skew': 56.142, 'valid/acc_align': 67.953, 'test/acc': 66.064, 'test/acc_unbiased': 61.904, 'test/diff': 9.728, 'test/acc_skew': 57.04, 'test/acc_align': 66.768}
[9 / 20] best valid accuracy: 62.398 at epoch 8 
 best_stats: {'best_valid_epoch': 8, 'best_valid_valid/acc': 64.727, 'best_valid_valid/acc_unbiased': 62.398, 'best_valid_valid/diff': 6.449, 'best_valid_valid/acc_skew': 59.174, 'best_valid_valid/acc_align': 65.623, 'best_valid_test/acc': 64.963, 'best_valid_test/acc_unbiased': 61.506, 'best_valid_test/diff': 7.723, 'best_valid_test/acc_skew': 57.644, 'best_valid_test/acc_align': 65.367}
[9 / 20] best test accuracy: 61.904 at epoch 9 
 best_stats: {'best_test_epoch': 9, 'best_test_valid/acc': 65.123, 'best_test_valid/acc_unbiased': 62.047, 'best_test_valid/diff': 11.811, 'best_test_valid/acc_skew': 56.142, 'best_test_valid/acc_align': 67.953, 'best_test_test/acc': 66.064, 'best_test_test/acc_unbiased': 61.904, 'best_test_test/diff': 9.728, 'best_test_test/acc_skew': 57.04, 'best_test_test/acc_align': 66.768}
[10 / 20] Learning rate: 0.0001 weight: 0.01
[10 / 20] Loss: 4.501424419170281 CE Loss: 0.4630435832606322 Con Loss: 4.496794003844038
[10 / 20] tensor([[0.970, 0.886],
        [0.311, 0.339]]) {'epoch': 10, 'valid/acc': 65.741, 'valid/acc_unbiased': 61.987, 'valid/diff': 7.068, 'valid/acc_skew': 58.453, 'valid/acc_align': 65.521, 'test/acc': 66.593, 'test/acc_unbiased': 62.675, 'test/diff': 5.573, 'test/acc_skew': 59.889, 'test/acc_align': 65.462}
[10 / 20] best valid accuracy: 62.398 at epoch 8 
 best_stats: {'best_valid_epoch': 8, 'best_valid_valid/acc': 64.727, 'best_valid_valid/acc_unbiased': 62.398, 'best_valid_valid/diff': 6.449, 'best_valid_valid/acc_skew': 59.174, 'best_valid_valid/acc_align': 65.623, 'best_valid_test/acc': 64.963, 'best_valid_test/acc_unbiased': 61.506, 'best_valid_test/diff': 7.723, 'best_valid_test/acc_skew': 57.644, 'best_valid_test/acc_align': 65.367}
[10 / 20] best test accuracy: 62.675 at epoch 10 
 best_stats: {'best_test_epoch': 10, 'best_test_valid/acc': 65.741, 'best_test_valid/acc_unbiased': 61.987, 'best_test_valid/diff': 7.068, 'best_test_valid/acc_skew': 58.453, 'best_test_valid/acc_align': 65.521, 'best_test_test/acc': 66.593, 'best_test_test/acc_unbiased': 62.675, 'best_test_test/diff': 5.573, 'best_test_test/acc_skew': 59.889, 'best_test_test/acc_align': 65.462}
[11 / 20] Learning rate: 0.0001 weight: 0.01
[11 / 20] Loss: 4.473334802843934 CE Loss: 0.45975963032142986 Con Loss: 4.4687372039472155
[11 / 20] tensor([[0.975, 0.858],
        [0.306, 0.388]]) {'epoch': 11, 'valid/acc': 66.138, 'valid/acc_unbiased': 62.957, 'valid/diff': 12.048, 'valid/acc_skew': 56.933, 'valid/acc_align': 68.982, 'test/acc': 66.725, 'test/acc_unbiased': 63.151, 'test/diff': 9.941, 'test/acc_skew': 58.18, 'test/acc_align': 68.122}
[11 / 20] best valid accuracy: 62.957 at epoch 11 
 best_stats: {'best_valid_epoch': 11, 'best_valid_valid/acc': 66.138, 'best_valid_valid/acc_unbiased': 62.957, 'best_valid_valid/diff': 12.048, 'best_valid_valid/acc_skew': 56.933, 'best_valid_valid/acc_align': 68.982, 'best_valid_test/acc': 66.725, 'best_valid_test/acc_unbiased': 63.151, 'best_valid_test/diff': 9.941, 'best_valid_test/acc_skew': 58.18, 'best_valid_test/acc_align': 68.122}
[11 / 20] best test accuracy: 63.151 at epoch 11 
 best_stats: {'best_test_epoch': 11, 'best_test_valid/acc': 66.138, 'best_test_valid/acc_unbiased': 62.957, 'best_test_valid/diff': 12.048, 'best_test_valid/acc_skew': 56.933, 'best_test_valid/acc_align': 68.982, 'best_test_test/acc': 66.725, 'best_test_test/acc_unbiased': 63.151, 'best_test_test/diff': 9.941, 'best_test_test/acc_skew': 58.18, 'best_test_test/acc_align': 68.122}
[12 / 20] Learning rate: 0.0001 weight: 0.01
[12 / 20] Loss: 4.4806283031764975 CE Loss: 0.45381078405221364 Con Loss: 4.476090198418301
[12 / 20] tensor([[0.973, 0.784],
        [0.370, 0.394]]) {'epoch': 12, 'valid/acc': 66.887, 'valid/acc_unbiased': 62.696, 'valid/diff': 14.269, 'valid/acc_skew': 55.562, 'valid/acc_align': 69.831, 'test/acc': 68.576, 'test/acc_unbiased': 63.023, 'test/diff': 10.614, 'test/acc_skew': 57.717, 'test/acc_align': 68.33}
[12 / 20] best valid accuracy: 62.957 at epoch 11 
 best_stats: {'best_valid_epoch': 11, 'best_valid_valid/acc': 66.138, 'best_valid_valid/acc_unbiased': 62.957, 'best_valid_valid/diff': 12.048, 'best_valid_valid/acc_skew': 56.933, 'best_valid_valid/acc_align': 68.982, 'best_valid_test/acc': 66.725, 'best_valid_test/acc_unbiased': 63.151, 'best_valid_test/diff': 9.941, 'best_valid_test/acc_skew': 58.18, 'best_valid_test/acc_align': 68.122}
[12 / 20] best test accuracy: 63.151 at epoch 11 
 best_stats: {'best_test_epoch': 11, 'best_test_valid/acc': 66.138, 'best_test_valid/acc_unbiased': 62.957, 'best_test_valid/diff': 12.048, 'best_test_valid/acc_skew': 56.933, 'best_test_valid/acc_align': 68.982, 'best_test_test/acc': 66.725, 'best_test_test/acc_unbiased': 63.151, 'best_test_test/diff': 9.941, 'best_test_test/acc_skew': 58.18, 'best_test_test/acc_align': 68.122}
[13 / 20] Learning rate: 0.0001 weight: 0.01
[13 / 20] Loss: 4.47713271012158 CE Loss: 0.4473333344259587 Con Loss: 4.472659368097269
[13 / 20] tensor([[0.961, 0.801],
        [0.403, 0.442]]) {'epoch': 13, 'valid/acc': 68.695, 'valid/acc_unbiased': 64.438, 'valid/diff': 11.495, 'valid/acc_skew': 58.691, 'valid/acc_align': 70.185, 'test/acc': 69.766, 'test/acc_unbiased': 65.186, 'test/diff': 10.005, 'test/acc_skew': 60.184, 'test/acc_align': 70.189}
[13 / 20] best valid accuracy: 64.438 at epoch 13 
 best_stats: {'best_valid_epoch': 13, 'best_valid_valid/acc': 68.695, 'best_valid_valid/acc_unbiased': 64.438, 'best_valid_valid/diff': 11.495, 'best_valid_valid/acc_skew': 58.691, 'best_valid_valid/acc_align': 70.185, 'best_valid_test/acc': 69.766, 'best_valid_test/acc_unbiased': 65.186, 'best_valid_test/diff': 10.005, 'best_valid_test/acc_skew': 60.184, 'best_valid_test/acc_align': 70.189}
[13 / 20] best test accuracy: 65.186 at epoch 13 
 best_stats: {'best_test_epoch': 13, 'best_test_valid/acc': 68.695, 'best_test_valid/acc_unbiased': 64.438, 'best_test_valid/diff': 11.495, 'best_test_valid/acc_skew': 58.691, 'best_test_valid/acc_align': 70.185, 'best_test_test/acc': 69.766, 'best_test_test/acc_unbiased': 65.186, 'best_test_test/diff': 10.005, 'best_test_test/acc_skew': 60.184, 'best_test_test/acc_align': 70.189}
[14 / 20] Learning rate: 1e-05 weight: 0.01
[14 / 20] Loss: 4.459557275654269 CE Loss: 0.4427779517183586 Con Loss: 4.4551294946974025
[14 / 20] tensor([[0.968, 0.841],
        [0.360, 0.406]]) {'epoch': 14, 'valid/acc': 67.504, 'valid/acc_unbiased': 63.116, 'valid/diff': 10.449, 'valid/acc_skew': 57.892, 'valid/acc_align': 68.341, 'test/acc': 68.488, 'test/acc_unbiased': 64.37, 'test/diff': 8.662, 'test/acc_skew': 60.039, 'test/acc_align': 68.701}
[14 / 20] best valid accuracy: 64.438 at epoch 13 
 best_stats: {'best_valid_epoch': 13, 'best_valid_valid/acc': 68.695, 'best_valid_valid/acc_unbiased': 64.438, 'best_valid_valid/diff': 11.495, 'best_valid_valid/acc_skew': 58.691, 'best_valid_valid/acc_align': 70.185, 'best_valid_test/acc': 69.766, 'best_valid_test/acc_unbiased': 65.186, 'best_valid_test/diff': 10.005, 'best_valid_test/acc_skew': 60.184, 'best_valid_test/acc_align': 70.189}
[14 / 20] best test accuracy: 65.186 at epoch 13 
 best_stats: {'best_test_epoch': 13, 'best_test_valid/acc': 68.695, 'best_test_valid/acc_unbiased': 64.438, 'best_test_valid/diff': 11.495, 'best_test_valid/acc_skew': 58.691, 'best_test_valid/acc_align': 70.185, 'best_test_test/acc': 69.766, 'best_test_test/acc_unbiased': 65.186, 'best_test_test/diff': 10.005, 'best_test_test/acc_skew': 60.184, 'best_test_test/acc_align': 70.189}
[15 / 20] Learning rate: 1e-05 weight: 0.01
[15 / 20] Loss: 4.431723908510426 CE Loss: 0.44088415380320445 Con Loss: 4.427315042867771
[15 / 20] tensor([[0.963, 0.818],
        [0.378, 0.418]]) {'epoch': 15, 'valid/acc': 68.474, 'valid/acc_unbiased': 64.534, 'valid/diff': 11.777, 'valid/acc_skew': 58.646, 'valid/acc_align': 70.423, 'test/acc': 68.885, 'test/acc_unbiased': 64.448, 'test/diff': 9.246, 'test/acc_skew': 59.825, 'test/acc_align': 69.071}
[15 / 20] best valid accuracy: 64.534 at epoch 15 
 best_stats: {'best_valid_epoch': 15, 'best_valid_valid/acc': 68.474, 'best_valid_valid/acc_unbiased': 64.534, 'best_valid_valid/diff': 11.777, 'best_valid_valid/acc_skew': 58.646, 'best_valid_valid/acc_align': 70.423, 'best_valid_test/acc': 68.885, 'best_valid_test/acc_unbiased': 64.448, 'best_valid_test/diff': 9.246, 'best_valid_test/acc_skew': 59.825, 'best_valid_test/acc_align': 69.071}
[15 / 20] best test accuracy: 65.186 at epoch 13 
 best_stats: {'best_test_epoch': 13, 'best_test_valid/acc': 68.695, 'best_test_valid/acc_unbiased': 64.438, 'best_test_valid/diff': 11.495, 'best_test_valid/acc_skew': 58.691, 'best_test_valid/acc_align': 70.185, 'best_test_test/acc': 69.766, 'best_test_test/acc_unbiased': 65.186, 'best_test_test/diff': 10.005, 'best_test_test/acc_skew': 60.184, 'best_test_test/acc_align': 70.189}
[16 / 20] Learning rate: 1e-05 weight: 0.01
[16 / 20] Loss: 4.384751094052605 CE Loss: 0.43862120784297504 Con Loss: 4.380364859876272
[16 / 20] tensor([[0.962, 0.830],
        [0.385, 0.406]]) {'epoch': 16, 'valid/acc': 68.519, 'valid/acc_unbiased': 64.21, 'valid/diff': 10.058, 'valid/acc_skew': 59.181, 'valid/acc_align': 69.239, 'test/acc': 69.105, 'test/acc_unbiased': 64.579, 'test/diff': 7.679, 'test/acc_skew': 60.739, 'test/acc_align': 68.418}
[16 / 20] best valid accuracy: 64.534 at epoch 15 
 best_stats: {'best_valid_epoch': 15, 'best_valid_valid/acc': 68.474, 'best_valid_valid/acc_unbiased': 64.534, 'best_valid_valid/diff': 11.777, 'best_valid_valid/acc_skew': 58.646, 'best_valid_valid/acc_align': 70.423, 'best_valid_test/acc': 68.885, 'best_valid_test/acc_unbiased': 64.448, 'best_valid_test/diff': 9.246, 'best_valid_test/acc_skew': 59.825, 'best_valid_test/acc_align': 69.071}
[16 / 20] best test accuracy: 65.186 at epoch 13 
 best_stats: {'best_test_epoch': 13, 'best_test_valid/acc': 68.695, 'best_test_valid/acc_unbiased': 64.438, 'best_test_valid/diff': 11.495, 'best_test_valid/acc_skew': 58.691, 'best_test_valid/acc_align': 70.185, 'best_test_test/acc': 69.766, 'best_test_test/acc_unbiased': 65.186, 'best_test_test/diff': 10.005, 'best_test_test/acc_skew': 60.184, 'best_test_test/acc_align': 70.189}
[17 / 20] Learning rate: 1e-05 weight: 0.01
[17 / 20] Loss: 4.405245660262713 CE Loss: 0.4370221427454568 Con Loss: 4.400875434675542
[17 / 20] tensor([[0.959, 0.807],
        [0.390, 0.442]]) {'epoch': 17, 'valid/acc': 68.827, 'valid/acc_unbiased': 64.812, 'valid/diff': 11.337, 'valid/acc_skew': 59.144, 'valid/acc_align': 70.481, 'test/acc': 69.193, 'test/acc_unbiased': 64.941, 'test/diff': 10.214, 'test/acc_skew': 59.833, 'test/acc_align': 70.048}
[17 / 20] best valid accuracy: 64.812 at epoch 17 
 best_stats: {'best_valid_epoch': 17, 'best_valid_valid/acc': 68.827, 'best_valid_valid/acc_unbiased': 64.812, 'best_valid_valid/diff': 11.337, 'best_valid_valid/acc_skew': 59.144, 'best_valid_valid/acc_align': 70.481, 'best_valid_test/acc': 69.193, 'best_valid_test/acc_unbiased': 64.941, 'best_valid_test/diff': 10.214, 'best_valid_test/acc_skew': 59.833, 'best_valid_test/acc_align': 70.048}
[17 / 20] best test accuracy: 65.186 at epoch 13 
 best_stats: {'best_test_epoch': 13, 'best_test_valid/acc': 68.695, 'best_test_valid/acc_unbiased': 64.438, 'best_test_valid/diff': 11.495, 'best_test_valid/acc_skew': 58.691, 'best_test_valid/acc_align': 70.185, 'best_test_test/acc': 69.766, 'best_test_test/acc_unbiased': 65.186, 'best_test_test/diff': 10.005, 'best_test_test/acc_skew': 60.184, 'best_test_test/acc_align': 70.189}
[18 / 20] Learning rate: 1e-05 weight: 0.01
[18 / 20] Loss: 4.430199052010168 CE Loss: 0.43234125207042656 Con Loss: 4.425875657330466
[18 / 20] tensor([[0.973, 0.847],
        [0.331, 0.418]]) {'epoch': 18, 'valid/acc': 67.637, 'valid/acc_unbiased': 63.563, 'valid/diff': 11.031, 'valid/acc_skew': 58.048, 'valid/acc_align': 69.079, 'test/acc': 67.739, 'test/acc_unbiased': 64.212, 'test/diff': 10.662, 'test/acc_skew': 58.881, 'test/acc_align': 69.542}
[18 / 20] best valid accuracy: 64.812 at epoch 17 
 best_stats: {'best_valid_epoch': 17, 'best_valid_valid/acc': 68.827, 'best_valid_valid/acc_unbiased': 64.812, 'best_valid_valid/diff': 11.337, 'best_valid_valid/acc_skew': 59.144, 'best_valid_valid/acc_align': 70.481, 'best_valid_test/acc': 69.193, 'best_valid_test/acc_unbiased': 64.941, 'best_valid_test/diff': 10.214, 'best_valid_test/acc_skew': 59.833, 'best_valid_test/acc_align': 70.048}
[18 / 20] best test accuracy: 65.186 at epoch 13 
 best_stats: {'best_test_epoch': 13, 'best_test_valid/acc': 68.695, 'best_test_valid/acc_unbiased': 64.438, 'best_test_valid/diff': 11.495, 'best_test_valid/acc_skew': 58.691, 'best_test_valid/acc_align': 70.185, 'best_test_test/acc': 69.766, 'best_test_test/acc_unbiased': 65.186, 'best_test_test/diff': 10.005, 'best_test_test/acc_skew': 60.184, 'best_test_test/acc_align': 70.189}
[19 / 20] Learning rate: 1e-05 weight: 0.01
[19 / 20] Loss: 4.435392210698672 CE Loss: 0.4363305471845889 Con Loss: 4.4310289027315095
[19 / 20] tensor([[0.964, 0.761],
        [0.367, 0.461]]) {'epoch': 19, 'valid/acc': 68.342, 'valid/acc_unbiased': 64.503, 'valid/diff': 15.898, 'valid/acc_skew': 56.554, 'valid/acc_align': 72.452, 'test/acc': 68.356, 'test/acc_unbiased': 63.823, 'test/diff': 14.832, 'test/acc_skew': 56.407, 'test/acc_align': 71.24}
[19 / 20] best valid accuracy: 64.812 at epoch 17 
 best_stats: {'best_valid_epoch': 17, 'best_valid_valid/acc': 68.827, 'best_valid_valid/acc_unbiased': 64.812, 'best_valid_valid/diff': 11.337, 'best_valid_valid/acc_skew': 59.144, 'best_valid_valid/acc_align': 70.481, 'best_valid_test/acc': 69.193, 'best_valid_test/acc_unbiased': 64.941, 'best_valid_test/diff': 10.214, 'best_valid_test/acc_skew': 59.833, 'best_valid_test/acc_align': 70.048}
[19 / 20] best test accuracy: 65.186 at epoch 13 
 best_stats: {'best_test_epoch': 13, 'best_test_valid/acc': 68.695, 'best_test_valid/acc_unbiased': 64.438, 'best_test_valid/diff': 11.495, 'best_test_valid/acc_skew': 58.691, 'best_test_valid/acc_align': 70.185, 'best_test_test/acc': 69.766, 'best_test_test/acc_unbiased': 65.186, 'best_test_test/diff': 10.005, 'best_test_test/acc_skew': 60.184, 'best_test_test/acc_align': 70.189}
[20 / 20] Learning rate: 1e-05 weight: 0.01
[20 / 20] Loss: 4.426093967163531 CE Loss: 0.4314226675283503 Con Loss: 4.421779731470563
[20 / 20] tensor([[0.968, 0.801],
        [0.358, 0.436]]) {'epoch': 20, 'valid/acc': 68.166, 'valid/acc_unbiased': 63.929, 'valid/diff': 11.793, 'valid/acc_skew': 58.033, 'valid/acc_align': 69.826, 'test/acc': 68.312, 'test/acc_unbiased': 64.075, 'test/diff': 12.281, 'test/acc_skew': 57.935, 'test/acc_align': 70.216}
[20 / 20] best valid accuracy: 64.812 at epoch 17 
 best_stats: {'best_valid_epoch': 17, 'best_valid_valid/acc': 68.827, 'best_valid_valid/acc_unbiased': 64.812, 'best_valid_valid/diff': 11.337, 'best_valid_valid/acc_skew': 59.144, 'best_valid_valid/acc_align': 70.481, 'best_valid_test/acc': 69.193, 'best_valid_test/acc_unbiased': 64.941, 'best_valid_test/diff': 10.214, 'best_valid_test/acc_skew': 59.833, 'best_valid_test/acc_align': 70.048}
[20 / 20] best test accuracy: 65.186 at epoch 13 
 best_stats: {'best_test_epoch': 13, 'best_test_valid/acc': 68.695, 'best_test_valid/acc_unbiased': 64.438, 'best_test_valid/diff': 11.495, 'best_test_valid/acc_skew': 58.691, 'best_test_valid/acc_align': 70.185, 'best_test_test/acc': 69.766, 'best_test_test/acc_unbiased': 65.186, 'best_test_test/diff': 10.005, 'best_test_test/acc_skew': 60.184, 'best_test_test/acc_align': 70.189}
Total training time: 0:12:00
