Log level set to: INFO
Set seed: 1
=======> Using Fixed Random Seed: 1 <========
save_path: exp_results/bc-bb0-celeba_smiling-os_0.4-lr0.001-bs128-cbs64-w0.01-ratio30-aug1-seed1
get_celeba - split:train, aug: False, given_y: True, ratio: 0
use existing smiling indices from data/celeba/pickles/smiling
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [16245, 16245]
Target 1: [16245, 16245]
Binary Target 1
---------------------------
Target 0: [16245, 16245]
Target 1: [16245, 16245]
===================================
Normal Label Distribution: 
Target 0: [16245, 16245]
Target 1: [16245, 16245]
===================================
Use BiasedCelebASplit 
 target_attr: smiling split: train 
 tensor([[16245., 16245.],
        [16245., 16245.]])
get_celeba - split:train, aug: 1, given_y: True, ratio: 30
use existing smiling indices from data/celeba/pickles/smiling
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [16280, 16280]
Target 1: [16280, 16280]
Binary Target 1
---------------------------
Target 0: [16280, 16280]
Target 1: [16280, 16280]
===================================
Normal Label Distribution: 
Target 0: [16280, 16280]
Target 1: [16280, 16280]
===================================
Use BiasedCelebASplit 
 target_attr: smiling split: train 
 tensor([[16280., 16280.],
        [16280., 16280.]])
get_celeba - split:train_valid, aug: False, given_y: True, ratio: 0
use existing smiling indices from data/celeba/pickles/smiling
Use BiasedCelebASplit 
 target_attr: smiling split: train_valid 
 tensor([[ 2019., 10233.],
        [ 8156.,  1957.]])
get_celeba - split:valid, aug: False, given_y: True, ratio: 0
Use BiasedCelebASplit 
 target_attr: smiling split: valid 
 tensor([[5252., 6157.],
        [5013., 3445.]])
decay_epochs: [3, 6]
[1 / 10] Learning rate: 0.001 weight: 0.01
[1 / 10] Loss: 4.646204806533583 CE Loss: 0.26535227590797494 Con Loss: 4.643551277285101
[1 / 10] tensor([[0.956, 0.935],
        [0.878, 0.868]]) {'epoch': 1, 'valid/acc': 90.279, 'valid/acc_unbiased': 90.586, 'valid/diff': 1.494, 'valid/acc_skew': 91.333, 'valid/acc_align': 89.839, 'test/acc': 91.136, 'test/acc_unbiased': 90.935, 'test/diff': 1.532, 'test/acc_skew': 91.701, 'test/acc_align': 90.169}
[1 / 10] best valid accuracy: 90.586 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 90.279, 'best_valid_valid/acc_unbiased': 90.586, 'best_valid_valid/diff': 1.494, 'best_valid_valid/acc_skew': 91.333, 'best_valid_valid/acc_align': 89.839, 'best_valid_test/acc': 91.136, 'best_valid_test/acc_unbiased': 90.935, 'best_valid_test/diff': 1.532, 'best_valid_test/acc_skew': 91.701, 'best_valid_test/acc_align': 90.169}
[1 / 10] best test accuracy: 90.935 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 90.279, 'best_test_valid/acc_unbiased': 90.586, 'best_test_valid/diff': 1.494, 'best_test_valid/acc_skew': 91.333, 'best_test_valid/acc_align': 89.839, 'best_test_test/acc': 91.136, 'best_test_test/acc_unbiased': 90.935, 'best_test_test/diff': 1.532, 'best_test_test/acc_skew': 91.701, 'best_test_test/acc_align': 90.169}
[2 / 10] Learning rate: 0.001 weight: 0.01
[2 / 10] Loss: 4.610131855163621 CE Loss: 0.23022148358928274 Con Loss: 4.607829647234456
[2 / 10] tensor([[0.964, 0.938],
        [0.874, 0.872]]) {'epoch': 2, 'valid/acc': 90.279, 'valid/acc_unbiased': 91.19, 'valid/diff': 1.82, 'valid/acc_skew': 91.884, 'valid/acc_align': 90.495, 'test/acc': 91.352, 'test/acc_unbiased': 91.19, 'test/diff': 1.434, 'test/acc_skew': 91.907, 'test/acc_align': 90.473}
[2 / 10] best valid accuracy: 91.190 at epoch 2 
 best_stats: {'best_valid_epoch': 2, 'best_valid_valid/acc': 90.279, 'best_valid_valid/acc_unbiased': 91.19, 'best_valid_valid/diff': 1.82, 'best_valid_valid/acc_skew': 91.884, 'best_valid_valid/acc_align': 90.495, 'best_valid_test/acc': 91.352, 'best_valid_test/acc_unbiased': 91.19, 'best_valid_test/diff': 1.434, 'best_valid_test/acc_skew': 91.907, 'best_valid_test/acc_align': 90.473}
[2 / 10] best test accuracy: 91.190 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 90.279, 'best_test_valid/acc_unbiased': 91.19, 'best_test_valid/diff': 1.82, 'best_test_valid/acc_skew': 91.884, 'best_test_valid/acc_align': 90.495, 'best_test_test/acc': 91.352, 'best_test_test/acc_unbiased': 91.19, 'best_test_test/diff': 1.434, 'best_test_test/acc_skew': 91.907, 'best_test_test/acc_align': 90.473}
[3 / 10] Learning rate: 0.001 weight: 0.01
[3 / 10] Loss: 4.592445664627437 CE Loss: 0.23080172572237925 Con Loss: 4.590137652376315
[3 / 10] tensor([[0.943, 0.937],
        [0.908, 0.881]]) {'epoch': 3, 'valid/acc': 91.795, 'valid/acc_unbiased': 91.813, 'valid/diff': 1.906, 'valid/acc_skew': 92.766, 'valid/acc_align': 90.86, 'test/acc': 91.977, 'test/acc_unbiased': 91.716, 'test/diff': 1.596, 'test/acc_skew': 92.514, 'test/acc_align': 90.917}
[3 / 10] best valid accuracy: 91.813 at epoch 3 
 best_stats: {'best_valid_epoch': 3, 'best_valid_valid/acc': 91.795, 'best_valid_valid/acc_unbiased': 91.813, 'best_valid_valid/diff': 1.906, 'best_valid_valid/acc_skew': 92.766, 'best_valid_valid/acc_align': 90.86, 'best_valid_test/acc': 91.977, 'best_valid_test/acc_unbiased': 91.716, 'best_valid_test/diff': 1.596, 'best_valid_test/acc_skew': 92.514, 'best_valid_test/acc_align': 90.917}
[3 / 10] best test accuracy: 91.716 at epoch 3 
 best_stats: {'best_test_epoch': 3, 'best_test_valid/acc': 91.795, 'best_test_valid/acc_unbiased': 91.813, 'best_test_valid/diff': 1.906, 'best_test_valid/acc_skew': 92.766, 'best_test_valid/acc_align': 90.86, 'best_test_test/acc': 91.977, 'best_test_test/acc_unbiased': 91.716, 'best_test_test/diff': 1.596, 'best_test_test/acc_skew': 92.514, 'best_test_test/acc_align': 90.917}
[4 / 10] Learning rate: 0.0001 weight: 0.01
[4 / 10] Loss: 4.554344985887945 CE Loss: 0.20238542365235304 Con Loss: 4.552321123115537
[4 / 10] tensor([[0.945, 0.933],
        [0.917, 0.904]]) {'epoch': 4, 'valid/acc': 92.256, 'valid/acc_unbiased': 92.369, 'valid/diff': 1.629, 'valid/acc_skew': 93.183, 'valid/acc_align': 91.554, 'test/acc': 92.626, 'test/acc_unbiased': 92.477, 'test/diff': 1.293, 'test/acc_skew': 93.123, 'test/acc_align': 91.83}
[4 / 10] best valid accuracy: 92.369 at epoch 4 
 best_stats: {'best_valid_epoch': 4, 'best_valid_valid/acc': 92.256, 'best_valid_valid/acc_unbiased': 92.369, 'best_valid_valid/diff': 1.629, 'best_valid_valid/acc_skew': 93.183, 'best_valid_valid/acc_align': 91.554, 'best_valid_test/acc': 92.626, 'best_valid_test/acc_unbiased': 92.477, 'best_valid_test/diff': 1.293, 'best_valid_test/acc_skew': 93.123, 'best_valid_test/acc_align': 91.83}
[4 / 10] best test accuracy: 92.477 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 92.256, 'best_test_valid/acc_unbiased': 92.369, 'best_test_valid/diff': 1.629, 'best_test_valid/acc_skew': 93.183, 'best_test_valid/acc_align': 91.554, 'best_test_test/acc': 92.626, 'best_test_test/acc_unbiased': 92.477, 'best_test_test/diff': 1.293, 'best_test_test/acc_skew': 93.123, 'best_test_test/acc_align': 91.83}
[5 / 10] Learning rate: 0.0001 weight: 0.01
[5 / 10] Loss: 4.533993331466538 CE Loss: 0.19221256908525794 Con Loss: 4.532071205049927
[5 / 10] tensor([[0.925, 0.908],
        [0.933, 0.923]]) {'epoch': 5, 'valid/acc': 92.318, 'valid/acc_unbiased': 92.613, 'valid/diff': 1.931, 'valid/acc_skew': 93.578, 'valid/acc_align': 91.647, 'test/acc': 92.309, 'test/acc_unbiased': 92.248, 'test/diff': 1.345, 'test/acc_skew': 92.921, 'test/acc_align': 91.576}
[5 / 10] best valid accuracy: 92.613 at epoch 5 
 best_stats: {'best_valid_epoch': 5, 'best_valid_valid/acc': 92.318, 'best_valid_valid/acc_unbiased': 92.613, 'best_valid_valid/diff': 1.931, 'best_valid_valid/acc_skew': 93.578, 'best_valid_valid/acc_align': 91.647, 'best_valid_test/acc': 92.309, 'best_valid_test/acc_unbiased': 92.248, 'best_valid_test/diff': 1.345, 'best_valid_test/acc_skew': 92.921, 'best_valid_test/acc_align': 91.576}
[5 / 10] best test accuracy: 92.477 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 92.256, 'best_test_valid/acc_unbiased': 92.369, 'best_test_valid/diff': 1.629, 'best_test_valid/acc_skew': 93.183, 'best_test_valid/acc_align': 91.554, 'best_test_test/acc': 92.626, 'best_test_test/acc_unbiased': 92.477, 'best_test_test/diff': 1.293, 'best_test_test/acc_skew': 93.123, 'best_test_test/acc_align': 91.83}
[6 / 10] Learning rate: 0.0001 weight: 0.01
[6 / 10] Loss: 4.530254975609796 CE Loss: 0.19152892185527018 Con Loss: 4.528339687410814
[6 / 10] tensor([[0.915, 0.890],
        [0.941, 0.938]]) {'epoch': 6, 'valid/acc': 92.166, 'valid/acc_unbiased': 92.554, 'valid/diff': 1.901, 'valid/acc_skew': 93.505, 'valid/acc_align': 91.604, 'test/acc': 92.072, 'test/acc_unbiased': 92.1, 'test/diff': 1.415, 'test/acc_skew': 92.808, 'test/acc_align': 91.393}
[6 / 10] best valid accuracy: 92.613 at epoch 5 
 best_stats: {'best_valid_epoch': 5, 'best_valid_valid/acc': 92.318, 'best_valid_valid/acc_unbiased': 92.613, 'best_valid_valid/diff': 1.931, 'best_valid_valid/acc_skew': 93.578, 'best_valid_valid/acc_align': 91.647, 'best_valid_test/acc': 92.309, 'best_valid_test/acc_unbiased': 92.248, 'best_valid_test/diff': 1.345, 'best_valid_test/acc_skew': 92.921, 'best_valid_test/acc_align': 91.576}
[6 / 10] best test accuracy: 92.477 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 92.256, 'best_test_valid/acc_unbiased': 92.369, 'best_test_valid/diff': 1.629, 'best_test_valid/acc_skew': 93.183, 'best_test_valid/acc_align': 91.554, 'best_test_test/acc': 92.626, 'best_test_test/acc_unbiased': 92.477, 'best_test_test/diff': 1.293, 'best_test_test/acc_skew': 93.123, 'best_test_test/acc_align': 91.83}
[7 / 10] Learning rate: 1e-05 weight: 0.01
[7 / 10] Loss: 4.529318452842714 CE Loss: 0.18744766013499 Con Loss: 4.527443981200007
[7 / 10] tensor([[0.938, 0.924],
        [0.929, 0.921]]) {'epoch': 7, 'valid/acc': 92.605, 'valid/acc_unbiased': 92.723, 'valid/diff': 1.708, 'valid/acc_skew': 93.577, 'valid/acc_align': 91.869, 'test/acc': 92.863, 'test/acc_unbiased': 92.794, 'test/diff': 1.075, 'test/acc_skew': 93.331, 'test/acc_align': 92.257}
[7 / 10] best valid accuracy: 92.723 at epoch 7 
 best_stats: {'best_valid_epoch': 7, 'best_valid_valid/acc': 92.605, 'best_valid_valid/acc_unbiased': 92.723, 'best_valid_valid/diff': 1.708, 'best_valid_valid/acc_skew': 93.577, 'best_valid_valid/acc_align': 91.869, 'best_valid_test/acc': 92.863, 'best_valid_test/acc_unbiased': 92.794, 'best_valid_test/diff': 1.075, 'best_valid_test/acc_skew': 93.331, 'best_valid_test/acc_align': 92.257}
[7 / 10] best test accuracy: 92.794 at epoch 7 
 best_stats: {'best_test_epoch': 7, 'best_test_valid/acc': 92.605, 'best_test_valid/acc_unbiased': 92.723, 'best_test_valid/diff': 1.708, 'best_test_valid/acc_skew': 93.577, 'best_test_valid/acc_align': 91.869, 'best_test_test/acc': 92.863, 'best_test_test/acc_unbiased': 92.794, 'best_test_test/diff': 1.075, 'best_test_test/acc_skew': 93.331, 'best_test_test/acc_align': 92.257}
[8 / 10] Learning rate: 1e-05 weight: 0.01
[8 / 10] Loss: 4.525907633421274 CE Loss: 0.1855232055369213 Con Loss: 4.5240524048657
[8 / 10] tensor([[0.953, 0.937],
        [0.913, 0.904]]) {'epoch': 8, 'valid/acc': 92.497, 'valid/acc_unbiased': 92.858, 'valid/diff': 1.706, 'valid/acc_skew': 93.711, 'valid/acc_align': 92.005, 'test/acc': 92.812, 'test/acc_unbiased': 92.68, 'test/diff': 1.232, 'test/acc_skew': 93.296, 'test/acc_align': 92.064}
[8 / 10] best valid accuracy: 92.858 at epoch 8 
 best_stats: {'best_valid_epoch': 8, 'best_valid_valid/acc': 92.497, 'best_valid_valid/acc_unbiased': 92.858, 'best_valid_valid/diff': 1.706, 'best_valid_valid/acc_skew': 93.711, 'best_valid_valid/acc_align': 92.005, 'best_valid_test/acc': 92.812, 'best_valid_test/acc_unbiased': 92.68, 'best_valid_test/diff': 1.232, 'best_valid_test/acc_skew': 93.296, 'best_valid_test/acc_align': 92.064}
[8 / 10] best test accuracy: 92.794 at epoch 7 
 best_stats: {'best_test_epoch': 7, 'best_test_valid/acc': 92.605, 'best_test_valid/acc_unbiased': 92.723, 'best_test_valid/diff': 1.708, 'best_test_valid/acc_skew': 93.577, 'best_test_valid/acc_align': 91.869, 'best_test_test/acc': 92.863, 'best_test_test/acc_unbiased': 92.794, 'best_test_test/diff': 1.075, 'best_test_test/acc_skew': 93.331, 'best_test_test/acc_align': 92.257}
[9 / 10] Learning rate: 1e-05 weight: 0.01
[9 / 10] Loss: 4.525435870814301 CE Loss: 0.18470039549113126 Con Loss: 4.523588863113323
[9 / 10] tensor([[0.954, 0.935],
        [0.916, 0.907]]) {'epoch': 9, 'valid/acc': 92.345, 'valid/acc_unbiased': 92.719, 'valid/diff': 1.943, 'valid/acc_skew': 93.69, 'valid/acc_align': 91.747, 'test/acc': 92.933, 'test/acc_unbiased': 92.807, 'test/diff': 1.417, 'test/acc_skew': 93.515, 'test/acc_align': 92.099}
[9 / 10] best valid accuracy: 92.858 at epoch 8 
 best_stats: {'best_valid_epoch': 8, 'best_valid_valid/acc': 92.497, 'best_valid_valid/acc_unbiased': 92.858, 'best_valid_valid/diff': 1.706, 'best_valid_valid/acc_skew': 93.711, 'best_valid_valid/acc_align': 92.005, 'best_valid_test/acc': 92.812, 'best_valid_test/acc_unbiased': 92.68, 'best_valid_test/diff': 1.232, 'best_valid_test/acc_skew': 93.296, 'best_valid_test/acc_align': 92.064}
[9 / 10] best test accuracy: 92.807 at epoch 9 
 best_stats: {'best_test_epoch': 9, 'best_test_valid/acc': 92.345, 'best_test_valid/acc_unbiased': 92.719, 'best_test_valid/diff': 1.943, 'best_test_valid/acc_skew': 93.69, 'best_test_valid/acc_align': 91.747, 'best_test_test/acc': 92.933, 'best_test_test/acc_unbiased': 92.807, 'best_test_test/diff': 1.417, 'best_test_test/acc_skew': 93.515, 'best_test_test/acc_align': 92.099}
[10 / 10] Learning rate: 1e-05 weight: 0.01
[10 / 10] Loss: 4.527310973602135 CE Loss: 0.18519795533692737 Con Loss: 4.525458995317745
[10 / 10] tensor([[0.943, 0.926],
        [0.920, 0.911]]) {'epoch': 10, 'valid/acc': 92.649, 'valid/acc_unbiased': 92.881, 'valid/diff': 1.932, 'valid/acc_skew': 93.847, 'valid/acc_align': 91.915, 'test/acc': 92.636, 'test/acc_unbiased': 92.529, 'test/diff': 1.329, 'test/acc_skew': 93.193, 'test/acc_align': 91.864}
[10 / 10] best valid accuracy: 92.881 at epoch 10 
 best_stats: {'best_valid_epoch': 10, 'best_valid_valid/acc': 92.649, 'best_valid_valid/acc_unbiased': 92.881, 'best_valid_valid/diff': 1.932, 'best_valid_valid/acc_skew': 93.847, 'best_valid_valid/acc_align': 91.915, 'best_valid_test/acc': 92.636, 'best_valid_test/acc_unbiased': 92.529, 'best_valid_test/diff': 1.329, 'best_valid_test/acc_skew': 93.193, 'best_valid_test/acc_align': 91.864}
[10 / 10] best test accuracy: 92.807 at epoch 9 
 best_stats: {'best_test_epoch': 9, 'best_test_valid/acc': 92.345, 'best_test_valid/acc_unbiased': 92.719, 'best_test_valid/diff': 1.943, 'best_test_valid/acc_skew': 93.69, 'best_test_valid/acc_align': 91.747, 'best_test_test/acc': 92.933, 'best_test_test/acc_unbiased': 92.807, 'best_test_test/diff': 1.417, 'best_test_test/acc_skew': 93.515, 'best_test_test/acc_align': 92.099}
Total training time: 1:09:40
