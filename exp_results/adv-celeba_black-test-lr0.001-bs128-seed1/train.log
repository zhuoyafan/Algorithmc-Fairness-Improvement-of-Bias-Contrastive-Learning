Log level set to: INFO
Set seed: 1
=======> Using Fixed Random Seed: 1 <========
save_path: exp_results/adv-celeba_black-test-lr0.001-bs128-seed1
get_celeba - split:train, aug: False, given_y: True, ratio: 0
get_celeba - split:train_valid, aug: False, given_y: True, ratio: 0
get_celeba - split:valid, aug: False, given_y: True, ratio: 0
decay_epochs: [3, 6]
[1 / 10] Learning rate: 0.001
[1 / 10] Loss: 0.6520
[1 / 10] tensor([[0.916, 0.820],
        [0.128, 0.151]]) {'epoch': 1, 'valid/acc': 73.612, 'valid/acc_unbiased': 50.661, 'valid/diff': 5.124, 'valid/acc_skew': 48.099, 'valid/acc_align': 53.223, 'test/acc': 72.588, 'test/acc_unbiased': 50.388, 'test/diff': 5.985, 'test/acc_skew': 47.395, 'test/acc_align': 53.381}
[1 / 10] best valid accuracy: 50.661 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 73.612, 'best_valid_valid/acc_unbiased': 50.661, 'best_valid_valid/diff': 5.124, 'best_valid_valid/acc_skew': 48.099, 'best_valid_valid/acc_align': 53.223, 'best_valid_test/acc': 72.588, 'best_valid_test/acc_unbiased': 50.388, 'best_valid_test/diff': 5.985, 'best_valid_test/acc_skew': 47.395, 'best_valid_test/acc_align': 53.381}
[1 / 10] best test accuracy: 50.388 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 73.612, 'best_test_valid/acc_unbiased': 50.661, 'best_test_valid/diff': 5.124, 'best_test_valid/acc_skew': 48.099, 'best_test_valid/acc_align': 53.223, 'best_test_test/acc': 72.588, 'best_test_test/acc_unbiased': 50.388, 'best_test_test/diff': 5.985, 'best_test_test/acc_skew': 47.395, 'best_test_test/acc_align': 53.381}
[2 / 10] Learning rate: 0.001
[2 / 10] Loss: 0.2435
[2 / 10] tensor([[0.984, 0.942],
        [0.547, 0.731]]) {'epoch': 2, 'valid/acc': 90.707, 'valid/acc_unbiased': 80.043, 'valid/diff': 6.869, 'valid/acc_skew': 76.608, 'valid/acc_align': 83.478, 'test/acc': 90.331, 'test/acc_unbiased': 80.092, 'test/diff': 11.286, 'test/acc_skew': 74.45, 'test/acc_align': 85.735}
[2 / 10] best valid accuracy: 80.043 at epoch 2 
 best_stats: {'best_valid_epoch': 2, 'best_valid_valid/acc': 90.707, 'best_valid_valid/acc_unbiased': 80.043, 'best_valid_valid/diff': 6.869, 'best_valid_valid/acc_skew': 76.608, 'best_valid_valid/acc_align': 83.478, 'best_valid_test/acc': 90.331, 'best_valid_test/acc_unbiased': 80.092, 'best_valid_test/diff': 11.286, 'best_valid_test/acc_skew': 74.45, 'best_valid_test/acc_align': 85.735}
[2 / 10] best test accuracy: 80.092 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 90.707, 'best_test_valid/acc_unbiased': 80.043, 'best_test_valid/diff': 6.869, 'best_test_valid/acc_skew': 76.608, 'best_test_valid/acc_align': 83.478, 'best_test_test/acc': 90.331, 'best_test_test/acc_unbiased': 80.092, 'best_test_test/diff': 11.286, 'best_test_test/acc_skew': 74.45, 'best_test_test/acc_align': 85.735}
[3 / 10] Learning rate: 0.001
[3 / 10] Loss: 0.2215
[3 / 10] tensor([[0.982, 0.938],
        [0.563, 0.741]]) {'epoch': 3, 'valid/acc': 90.678, 'valid/acc_unbiased': 80.439, 'valid/diff': 7.246, 'valid/acc_skew': 76.816, 'valid/acc_align': 84.063, 'test/acc': 90.331, 'test/acc_unbiased': 80.572, 'test/diff': 11.085, 'test/acc_skew': 75.03, 'test/acc_align': 86.115}
[3 / 10] best valid accuracy: 80.439 at epoch 3 
 best_stats: {'best_valid_epoch': 3, 'best_valid_valid/acc': 90.678, 'best_valid_valid/acc_unbiased': 80.439, 'best_valid_valid/diff': 7.246, 'best_valid_valid/acc_skew': 76.816, 'best_valid_valid/acc_align': 84.063, 'best_valid_test/acc': 90.331, 'best_valid_test/acc_unbiased': 80.572, 'best_valid_test/diff': 11.085, 'best_valid_test/acc_skew': 75.03, 'best_valid_test/acc_align': 86.115}
[3 / 10] best test accuracy: 80.572 at epoch 3 
 best_stats: {'best_test_epoch': 3, 'best_test_valid/acc': 90.678, 'best_test_valid/acc_unbiased': 80.439, 'best_test_valid/diff': 7.246, 'best_test_valid/acc_skew': 76.816, 'best_test_valid/acc_align': 84.063, 'best_test_test/acc': 90.331, 'best_test_test/acc_unbiased': 80.572, 'best_test_test/diff': 11.085, 'best_test_test/acc_skew': 75.03, 'best_test_test/acc_align': 86.115}
[4 / 10] Learning rate: 0.0001
[4 / 10] Loss: 0.2020
[4 / 10] tensor([[0.975, 0.921],
        [0.716, 0.834]]) {'epoch': 4, 'valid/acc': 91.999, 'valid/acc_unbiased': 85.812, 'valid/diff': 5.379, 'valid/acc_skew': 83.123, 'valid/acc_align': 88.502, 'test/acc': 91.972, 'test/acc_unbiased': 86.169, 'test/diff': 8.574, 'test/acc_skew': 81.882, 'test/acc_align': 90.456}
[4 / 10] best valid accuracy: 85.812 at epoch 4 
 best_stats: {'best_valid_epoch': 4, 'best_valid_valid/acc': 91.999, 'best_valid_valid/acc_unbiased': 85.812, 'best_valid_valid/diff': 5.379, 'best_valid_valid/acc_skew': 83.123, 'best_valid_valid/acc_align': 88.502, 'best_valid_test/acc': 91.972, 'best_valid_test/acc_unbiased': 86.169, 'best_valid_test/diff': 8.574, 'best_valid_test/acc_skew': 81.882, 'best_valid_test/acc_align': 90.456}
[4 / 10] best test accuracy: 86.169 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 91.999, 'best_test_valid/acc_unbiased': 85.812, 'best_test_valid/diff': 5.379, 'best_test_valid/acc_skew': 83.123, 'best_test_valid/acc_align': 88.502, 'best_test_test/acc': 91.972, 'best_test_test/acc_unbiased': 86.169, 'best_test_test/diff': 8.574, 'best_test_test/acc_skew': 81.882, 'best_test_test/acc_align': 90.456}
[5 / 10] Learning rate: 0.0001
[5 / 10] Loss: 0.1931
[5 / 10] tensor([[0.975, 0.924],
        [0.710, 0.825]]) {'epoch': 5, 'valid/acc': 92.116, 'valid/acc_unbiased': 85.505, 'valid/diff': 5.659, 'valid/acc_skew': 82.675, 'valid/acc_align': 88.334, 'test/acc': 91.881, 'test/acc_unbiased': 85.859, 'test/diff': 8.299, 'test/acc_skew': 81.709, 'test/acc_align': 90.008}
[5 / 10] best valid accuracy: 85.812 at epoch 4 
 best_stats: {'best_valid_epoch': 4, 'best_valid_valid/acc': 91.999, 'best_valid_valid/acc_unbiased': 85.812, 'best_valid_valid/diff': 5.379, 'best_valid_valid/acc_skew': 83.123, 'best_valid_valid/acc_align': 88.502, 'best_valid_test/acc': 91.972, 'best_valid_test/acc_unbiased': 86.169, 'best_valid_test/diff': 8.574, 'best_valid_test/acc_skew': 81.882, 'best_valid_test/acc_align': 90.456}
[5 / 10] best test accuracy: 86.169 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 91.999, 'best_test_valid/acc_unbiased': 85.812, 'best_test_valid/diff': 5.379, 'best_test_valid/acc_skew': 83.123, 'best_test_valid/acc_align': 88.502, 'best_test_test/acc': 91.972, 'best_test_test/acc_unbiased': 86.169, 'best_test_test/diff': 8.574, 'best_test_test/acc_skew': 81.882, 'best_test_test/acc_align': 90.456}
[6 / 10] Learning rate: 0.0001
[6 / 10] Loss: 0.1922
[6 / 10] tensor([[0.980, 0.934],
        [0.678, 0.787]]) {'epoch': 6, 'valid/acc': 92.279, 'valid/acc_unbiased': 84.784, 'valid/diff': 5.361, 'valid/acc_skew': 82.103, 'valid/acc_align': 87.464, 'test/acc': 91.71, 'test/acc_unbiased': 84.497, 'test/diff': 7.726, 'test/acc_skew': 80.634, 'test/acc_align': 88.36}
[6 / 10] best valid accuracy: 85.812 at epoch 4 
 best_stats: {'best_valid_epoch': 4, 'best_valid_valid/acc': 91.999, 'best_valid_valid/acc_unbiased': 85.812, 'best_valid_valid/diff': 5.379, 'best_valid_valid/acc_skew': 83.123, 'best_valid_valid/acc_align': 88.502, 'best_valid_test/acc': 91.972, 'best_valid_test/acc_unbiased': 86.169, 'best_valid_test/diff': 8.574, 'best_valid_test/acc_skew': 81.882, 'best_valid_test/acc_align': 90.456}
[6 / 10] best test accuracy: 86.169 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 91.999, 'best_test_valid/acc_unbiased': 85.812, 'best_test_valid/diff': 5.379, 'best_test_valid/acc_skew': 83.123, 'best_test_valid/acc_align': 88.502, 'best_test_test/acc': 91.972, 'best_test_test/acc_unbiased': 86.169, 'best_test_test/diff': 8.574, 'best_test_test/acc_skew': 81.882, 'best_test_test/acc_align': 90.456}
[7 / 10] Learning rate: 1e-05
[7 / 10] Loss: 0.1843
[7 / 10] tensor([[0.971, 0.918],
        [0.747, 0.830]]) {'epoch': 7, 'valid/acc': 92.425, 'valid/acc_unbiased': 87.268, 'valid/diff': 3.973, 'valid/acc_skew': 85.282, 'valid/acc_align': 89.255, 'test/acc': 91.851, 'test/acc_unbiased': 86.631, 'test/diff': 6.848, 'test/acc_skew': 83.207, 'test/acc_align': 90.055}
[7 / 10] best valid accuracy: 87.268 at epoch 7 
 best_stats: {'best_valid_epoch': 7, 'best_valid_valid/acc': 92.425, 'best_valid_valid/acc_unbiased': 87.268, 'best_valid_valid/diff': 3.973, 'best_valid_valid/acc_skew': 85.282, 'best_valid_valid/acc_align': 89.255, 'best_valid_test/acc': 91.851, 'best_valid_test/acc_unbiased': 86.631, 'best_valid_test/diff': 6.848, 'best_valid_test/acc_skew': 83.207, 'best_valid_test/acc_align': 90.055}
[7 / 10] best test accuracy: 86.631 at epoch 7 
 best_stats: {'best_test_epoch': 7, 'best_test_valid/acc': 92.425, 'best_test_valid/acc_unbiased': 87.268, 'best_test_valid/diff': 3.973, 'best_test_valid/acc_skew': 85.282, 'best_test_valid/acc_align': 89.255, 'best_test_test/acc': 91.851, 'best_test_test/acc_unbiased': 86.631, 'best_test_test/diff': 6.848, 'best_test_test/acc_skew': 83.207, 'best_test_test/acc_align': 90.055}
[8 / 10] Learning rate: 1e-05
[8 / 10] Loss: 0.1798
[8 / 10] tensor([[0.974, 0.919],
        [0.713, 0.842]]) {'epoch': 8, 'valid/acc': 92.808, 'valid/acc_unbiased': 87.41, 'valid/diff': 5.544, 'valid/acc_skew': 84.638, 'valid/acc_align': 90.182, 'test/acc': 91.936, 'test/acc_unbiased': 86.214, 'test/diff': 9.217, 'test/acc_skew': 81.606, 'test/acc_align': 90.822}
[8 / 10] best valid accuracy: 87.410 at epoch 8 
 best_stats: {'best_valid_epoch': 8, 'best_valid_valid/acc': 92.808, 'best_valid_valid/acc_unbiased': 87.41, 'best_valid_valid/diff': 5.544, 'best_valid_valid/acc_skew': 84.638, 'best_valid_valid/acc_align': 90.182, 'best_valid_test/acc': 91.936, 'best_valid_test/acc_unbiased': 86.214, 'best_valid_test/diff': 9.217, 'best_valid_test/acc_skew': 81.606, 'best_valid_test/acc_align': 90.822}
[8 / 10] best test accuracy: 86.631 at epoch 7 
 best_stats: {'best_test_epoch': 7, 'best_test_valid/acc': 92.425, 'best_test_valid/acc_unbiased': 87.268, 'best_test_valid/diff': 3.973, 'best_test_valid/acc_skew': 85.282, 'best_test_valid/acc_align': 89.255, 'best_test_test/acc': 91.851, 'best_test_test/acc_unbiased': 86.631, 'best_test_test/diff': 6.848, 'best_test_test/acc_skew': 83.207, 'best_test_test/acc_align': 90.055}
[9 / 10] Learning rate: 1e-05
[9 / 10] Loss: 0.1758
[9 / 10] tensor([[0.979, 0.928],
        [0.683, 0.826]]) {'epoch': 9, 'valid/acc': 92.827, 'valid/acc_unbiased': 86.899, 'valid/diff': 4.633, 'valid/acc_skew': 84.583, 'valid/acc_align': 89.216, 'test/acc': 91.997, 'test/acc_unbiased': 85.399, 'test/diff': 9.71, 'test/acc_skew': 80.544, 'test/acc_align': 90.254}
[9 / 10] best valid accuracy: 87.410 at epoch 8 
 best_stats: {'best_valid_epoch': 8, 'best_valid_valid/acc': 92.808, 'best_valid_valid/acc_unbiased': 87.41, 'best_valid_valid/diff': 5.544, 'best_valid_valid/acc_skew': 84.638, 'best_valid_valid/acc_align': 90.182, 'best_valid_test/acc': 91.936, 'best_valid_test/acc_unbiased': 86.214, 'best_valid_test/diff': 9.217, 'best_valid_test/acc_skew': 81.606, 'best_valid_test/acc_align': 90.822}
[9 / 10] best test accuracy: 86.631 at epoch 7 
 best_stats: {'best_test_epoch': 7, 'best_test_valid/acc': 92.425, 'best_test_valid/acc_unbiased': 87.268, 'best_test_valid/diff': 3.973, 'best_test_valid/acc_skew': 85.282, 'best_test_valid/acc_align': 89.255, 'best_test_test/acc': 91.851, 'best_test_test/acc_unbiased': 86.631, 'best_test_test/diff': 6.848, 'best_test_test/acc_skew': 83.207, 'best_test_test/acc_align': 90.055}
[10 / 10] Learning rate: 1e-05
[10 / 10] Loss: 0.1762
[10 / 10] tensor([[0.978, 0.931],
        [0.690, 0.821]]) {'epoch': 10, 'valid/acc': 92.912, 'valid/acc_unbiased': 86.991, 'valid/diff': 4.556, 'valid/acc_skew': 84.713, 'valid/acc_align': 89.268, 'test/acc': 92.032, 'test/acc_unbiased': 85.505, 'test/diff': 8.913, 'test/acc_skew': 81.048, 'test/acc_align': 89.961}
[10 / 10] best valid accuracy: 87.410 at epoch 8 
 best_stats: {'best_valid_epoch': 8, 'best_valid_valid/acc': 92.808, 'best_valid_valid/acc_unbiased': 87.41, 'best_valid_valid/diff': 5.544, 'best_valid_valid/acc_skew': 84.638, 'best_valid_valid/acc_align': 90.182, 'best_valid_test/acc': 91.936, 'best_valid_test/acc_unbiased': 86.214, 'best_valid_test/diff': 9.217, 'best_valid_test/acc_skew': 81.606, 'best_valid_test/acc_align': 90.822}
[10 / 10] best test accuracy: 86.631 at epoch 7 
 best_stats: {'best_test_epoch': 7, 'best_test_valid/acc': 92.425, 'best_test_valid/acc_unbiased': 87.268, 'best_test_valid/diff': 3.973, 'best_test_valid/acc_skew': 85.282, 'best_test_valid/acc_align': 89.255, 'best_test_test/acc': 91.851, 'best_test_test/acc_unbiased': 86.631, 'best_test_test/diff': 6.848, 'best_test_test/acc_skew': 83.207, 'best_test_test/acc_align': 90.055}
Total training time: 0:41:42
