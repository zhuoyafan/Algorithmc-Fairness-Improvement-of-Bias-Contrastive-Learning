Log level set to: INFO
Set seed: 2
=======> Using Fixed Random Seed: 2 <========
save_path: exp_results/bc-bb0-utk_face_race-uw-0.99-lr0.001-bs128-cbs64-w0.01-ratio10-aug1-seed2
get_utk_face - split: train, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_race-0.99
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [4407, 55]
Target 1: [44, 5529]
Binary Target 1
---------------------------
Target 0: [4407, 55]
Target 1: [44, 5529]
===================================
Normal Label Distribution: 
Target 0: [4407, 55]
Target 1: [44, 5529]
===================================
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [4407, 55]
Target 1: [44, 5529]
Binary Target 1
---------------------------
Target 0: [4407, 55]
Target 1: [44, 5529]
===================================
Normal Label Distribution: 
Target 0: [4407, 55]
Target 1: [44, 5529]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 10035, target_attr: gender, bias_attr: race bias_rate: 0.99
['[train] target_0-bias_0: 4407', '[train] target_0-bias_1: 55', '[train] target_1-bias_0: 44', '[train] target_1-bias_1: 5529']
confusion_matrix - 
 original: tensor([[4407.,   44.],
        [  55., 5529.]]), 
 normalized: tensor([[0.990, 0.010],
        [0.010, 0.990]]), 
 b|y: tensor([[0.988, 0.012],
        [0.008, 0.992]])
get_utk_face - split: train, aug: 1, given_y: True, ratio: 10
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_race-0.99
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [4407, 55]
Target 1: [44, 5529]
Binary Target 1
---------------------------
Target 0: [4407, 55]
Target 1: [44, 5529]
===================================
Normal Label Distribution: 
Target 0: [4407, 55]
Target 1: [44, 5529]
===================================
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [4407, 55]
Target 1: [44, 5529]
Binary Target 1
---------------------------
Target 0: [4407, 55]
Target 1: [44, 5529]
===================================
Normal Label Distribution: 
Target 0: [4407, 55]
Target 1: [44, 5529]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 10035, target_attr: gender, bias_attr: race bias_rate: 0.99
['[train] target_0-bias_0: 4407', '[train] target_0-bias_1: 55', '[train] target_1-bias_0: 44', '[train] target_1-bias_1: 5529']
get_utk_face - split: valid, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_race-0.99
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [583, 684]
Target 1: [457, 646]
Binary Target 1
---------------------------
Target 0: [583, 684]
Target 1: [457, 646]
===================================
Normal Label Distribution: 
Target 0: [583, 684]
Target 1: [457, 646]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 2370, target_attr: gender, bias_attr: race bias_rate: 0.99
['[valid] target_0-bias_0: 583', '[valid] target_0-bias_1: 684', '[valid] target_1-bias_0: 457', '[valid] target_1-bias_1: 646']
get_utk_face - split: test, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_race-0.99
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [558, 677]
Target 1: [462, 673]
Binary Target 1
---------------------------
Target 0: [558, 677]
Target 1: [462, 673]
===================================
Normal Label Distribution: 
Target 0: [558, 677]
Target 1: [462, 673]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 2370, target_attr: gender, bias_attr: race bias_rate: 0.99
['[test] target_0-bias_0: 558', '[test] target_0-bias_1: 677', '[test] target_1-bias_0: 462', '[test] target_1-bias_1: 673']
decay_epochs: [6, 13]
[1 / 20] Learning rate: 0.001 weight: 0.01
[1 / 20] Loss: 4.787916545578064 CE Loss: 2.9264013197508745 Con Loss: 4.758652552598498
[1 / 20] tensor([[0.409, 0.326],
        [0.814, 0.877]]) {'epoch': 1, 'valid/acc': 58.861, 'valid/acc_unbiased': 60.372, 'valid/diff': 6.374, 'valid/acc_skew': 57.185, 'valid/acc_align': 63.559, 'test/acc': 59.705, 'test/acc_unbiased': 60.639, 'test/diff': 7.249, 'test/acc_skew': 57.015, 'test/acc_align': 64.264}
[1 / 20] best valid accuracy: 60.372 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 58.861, 'best_valid_valid/acc_unbiased': 60.372, 'best_valid_valid/diff': 6.374, 'best_valid_valid/acc_skew': 57.185, 'best_valid_valid/acc_align': 63.559, 'best_valid_test/acc': 59.705, 'best_valid_test/acc_unbiased': 60.639, 'best_valid_test/diff': 7.249, 'best_valid_test/acc_skew': 57.015, 'best_valid_test/acc_align': 64.264}
[1 / 20] best test accuracy: 60.639 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 58.861, 'best_test_valid/acc_unbiased': 60.372, 'best_test_valid/diff': 6.374, 'best_test_valid/acc_skew': 57.185, 'best_test_valid/acc_align': 63.559, 'best_test_test/acc': 59.705, 'best_test_test/acc_unbiased': 60.639, 'best_test_test/diff': 7.249, 'best_test_test/acc_skew': 57.015, 'best_test_test/acc_align': 64.264}
[2 / 20] Learning rate: 0.001 weight: 0.01
[2 / 20] Loss: 4.588482147458185 CE Loss: 2.6302095484246526 Con Loss: 4.562180060846151
[2 / 20] tensor([[0.464, 0.390],
        [0.853, 0.921]]) {'epoch': 2, 'valid/acc': 64.135, 'valid/acc_unbiased': 65.657, 'valid/diff': 2.485, 'valid/acc_skew': 64.415, 'valid/acc_align': 66.899, 'test/acc': 64.852, 'test/acc_unbiased': 65.704, 'test/diff': 7.132, 'test/acc_skew': 62.138, 'test/acc_align': 69.27}
[2 / 20] best valid accuracy: 65.657 at epoch 2 
 best_stats: {'best_valid_epoch': 2, 'best_valid_valid/acc': 64.135, 'best_valid_valid/acc_unbiased': 65.657, 'best_valid_valid/diff': 2.485, 'best_valid_valid/acc_skew': 64.415, 'best_valid_valid/acc_align': 66.899, 'best_valid_test/acc': 64.852, 'best_valid_test/acc_unbiased': 65.704, 'best_valid_test/diff': 7.132, 'best_valid_test/acc_skew': 62.138, 'best_valid_test/acc_align': 69.27}
[2 / 20] best test accuracy: 65.704 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 64.135, 'best_test_valid/acc_unbiased': 65.657, 'best_test_valid/diff': 2.485, 'best_test_valid/acc_skew': 64.415, 'best_test_valid/acc_align': 66.899, 'best_test_test/acc': 64.852, 'best_test_test/acc_unbiased': 65.704, 'best_test_test/diff': 7.132, 'best_test_test/acc_skew': 62.138, 'best_test_test/acc_align': 69.27}
[3 / 20] Learning rate: 0.001 weight: 0.01
[3 / 20] Loss: 4.310300918829993 CE Loss: 2.498849748971157 Con Loss: 4.285312440660265
[3 / 20] tensor([[0.695, 0.616],
        [0.792, 0.844]]) {'epoch': 3, 'valid/acc': 73.755, 'valid/acc_unbiased': 74.105, 'valid/diff': 8.247, 'valid/acc_skew': 69.982, 'valid/acc_align': 78.228, 'test/acc': 73.376, 'test/acc_unbiased': 73.687, 'test/diff': 6.558, 'test/acc_skew': 70.408, 'test/acc_align': 76.966}
[3 / 20] best valid accuracy: 74.105 at epoch 3 
 best_stats: {'best_valid_epoch': 3, 'best_valid_valid/acc': 73.755, 'best_valid_valid/acc_unbiased': 74.105, 'best_valid_valid/diff': 8.247, 'best_valid_valid/acc_skew': 69.982, 'best_valid_valid/acc_align': 78.228, 'best_valid_test/acc': 73.376, 'best_valid_test/acc_unbiased': 73.687, 'best_valid_test/diff': 6.558, 'best_valid_test/acc_skew': 70.408, 'best_valid_test/acc_align': 76.966}
[3 / 20] best test accuracy: 73.687 at epoch 3 
 best_stats: {'best_test_epoch': 3, 'best_test_valid/acc': 73.755, 'best_test_valid/acc_unbiased': 74.105, 'best_test_valid/diff': 8.247, 'best_test_valid/acc_skew': 69.982, 'best_test_valid/acc_align': 78.228, 'best_test_test/acc': 73.376, 'best_test_test/acc_unbiased': 73.687, 'best_test_test/diff': 6.558, 'best_test_test/acc_skew': 70.408, 'best_test_test/acc_align': 76.966}
[4 / 20] Learning rate: 0.001 weight: 0.01
[4 / 20] Loss: 4.588997627385647 CE Loss: 2.0532125769768657 Con Loss: 4.568465537815825
[4 / 20] tensor([[0.880, 0.879],
        [0.530, 0.545]]) {'epoch': 4, 'valid/acc': 72.363, 'valid/acc_unbiased': 71.137, 'valid/diff': 0.607, 'valid/acc_skew': 71.104, 'valid/acc_align': 71.17, 'test/acc': 71.646, 'test/acc_unbiased': 70.861, 'test/diff': 0.803, 'test/acc_skew': 70.459, 'test/acc_align': 71.262}
[4 / 20] best valid accuracy: 74.105 at epoch 3 
 best_stats: {'best_valid_epoch': 3, 'best_valid_valid/acc': 73.755, 'best_valid_valid/acc_unbiased': 74.105, 'best_valid_valid/diff': 8.247, 'best_valid_valid/acc_skew': 69.982, 'best_valid_valid/acc_align': 78.228, 'best_valid_test/acc': 73.376, 'best_valid_test/acc_unbiased': 73.687, 'best_valid_test/diff': 6.558, 'best_valid_test/acc_skew': 70.408, 'best_valid_test/acc_align': 76.966}
[4 / 20] best test accuracy: 73.687 at epoch 3 
 best_stats: {'best_test_epoch': 3, 'best_test_valid/acc': 73.755, 'best_test_valid/acc_unbiased': 74.105, 'best_test_valid/diff': 8.247, 'best_test_valid/acc_skew': 69.982, 'best_test_valid/acc_align': 78.228, 'best_test_test/acc': 73.376, 'best_test_test/acc_unbiased': 73.687, 'best_test_test/diff': 6.558, 'best_test_test/acc_skew': 70.408, 'best_test_test/acc_align': 76.966}
[5 / 20] Learning rate: 0.001 weight: 0.01
[5 / 20] Loss: 4.274742065119874 CE Loss: 2.164329454420096 Con Loss: 4.253098756232307
[5 / 20] tensor([[0.464, 0.480],
        [0.926, 0.936]]) {'epoch': 5, 'valid/acc': 69.451, 'valid/acc_unbiased': 70.817, 'valid/diff': 3.121, 'valid/acc_skew': 72.378, 'valid/acc_align': 69.257, 'test/acc': 69.283, 'test/acc_unbiased': 70.168, 'test/diff': 1.28, 'test/acc_skew': 70.323, 'test/acc_align': 70.013}
[5 / 20] best valid accuracy: 74.105 at epoch 3 
 best_stats: {'best_valid_epoch': 3, 'best_valid_valid/acc': 73.755, 'best_valid_valid/acc_unbiased': 74.105, 'best_valid_valid/diff': 8.247, 'best_valid_valid/acc_skew': 69.982, 'best_valid_valid/acc_align': 78.228, 'best_valid_test/acc': 73.376, 'best_valid_test/acc_unbiased': 73.687, 'best_valid_test/diff': 6.558, 'best_valid_test/acc_skew': 70.408, 'best_valid_test/acc_align': 76.966}
[5 / 20] best test accuracy: 73.687 at epoch 3 
 best_stats: {'best_test_epoch': 3, 'best_test_valid/acc': 73.755, 'best_test_valid/acc_unbiased': 74.105, 'best_test_valid/diff': 8.247, 'best_test_valid/acc_skew': 69.982, 'best_test_valid/acc_align': 78.228, 'best_test_test/acc': 73.376, 'best_test_test/acc_unbiased': 73.687, 'best_test_test/diff': 6.558, 'best_test_test/acc_skew': 70.408, 'best_test_test/acc_align': 76.966}
[6 / 20] Learning rate: 0.001 weight: 0.01
[6 / 20] Loss: 4.496411824998537 CE Loss: 2.1483971109661106 Con Loss: 4.474927863542512
[6 / 20] tensor([[0.699, 0.539],
        [0.725, 0.834]]) {'epoch': 6, 'valid/acc': 70.084, 'valid/acc_unbiased': 70.679, 'valid/diff': 8.556, 'valid/acc_skew': 66.401, 'valid/acc_align': 74.957, 'test/acc': 69.662, 'test/acc_unbiased': 69.919, 'test/diff': 13.413, 'test/acc_skew': 63.213, 'test/acc_align': 76.625}
[6 / 20] best valid accuracy: 74.105 at epoch 3 
 best_stats: {'best_valid_epoch': 3, 'best_valid_valid/acc': 73.755, 'best_valid_valid/acc_unbiased': 74.105, 'best_valid_valid/diff': 8.247, 'best_valid_valid/acc_skew': 69.982, 'best_valid_valid/acc_align': 78.228, 'best_valid_test/acc': 73.376, 'best_valid_test/acc_unbiased': 73.687, 'best_valid_test/diff': 6.558, 'best_valid_test/acc_skew': 70.408, 'best_valid_test/acc_align': 76.966}
[6 / 20] best test accuracy: 73.687 at epoch 3 
 best_stats: {'best_test_epoch': 3, 'best_test_valid/acc': 73.755, 'best_test_valid/acc_unbiased': 74.105, 'best_test_valid/diff': 8.247, 'best_test_valid/acc_skew': 69.982, 'best_test_valid/acc_align': 78.228, 'best_test_test/acc': 73.376, 'best_test_test/acc_unbiased': 73.687, 'best_test_test/diff': 6.558, 'best_test_test/acc_skew': 70.408, 'best_test_test/acc_align': 76.966}
[7 / 20] Learning rate: 0.0001 weight: 0.01
[7 / 20] Loss: 4.204029313093641 CE Loss: 1.779382283258747 Con Loss: 4.186235468863965
[7 / 20] tensor([[0.799, 0.750],
        [0.727, 0.801]]) {'epoch': 7, 'valid/acc': 76.962, 'valid/acc_unbiased': 76.809, 'valid/diff': 3.562, 'valid/acc_skew': 75.028, 'valid/acc_align': 78.59, 'test/acc': 77.173, 'test/acc_unbiased': 76.945, 'test/diff': 6.127, 'test/acc_skew': 73.882, 'test/acc_align': 80.009}
[7 / 20] best valid accuracy: 76.809 at epoch 7 
 best_stats: {'best_valid_epoch': 7, 'best_valid_valid/acc': 76.962, 'best_valid_valid/acc_unbiased': 76.809, 'best_valid_valid/diff': 3.562, 'best_valid_valid/acc_skew': 75.028, 'best_valid_valid/acc_align': 78.59, 'best_valid_test/acc': 77.173, 'best_valid_test/acc_unbiased': 76.945, 'best_valid_test/diff': 6.127, 'best_valid_test/acc_skew': 73.882, 'best_valid_test/acc_align': 80.009}
[7 / 20] best test accuracy: 76.945 at epoch 7 
 best_stats: {'best_test_epoch': 7, 'best_test_valid/acc': 76.962, 'best_test_valid/acc_unbiased': 76.809, 'best_test_valid/diff': 3.562, 'best_test_valid/acc_skew': 75.028, 'best_test_valid/acc_align': 78.59, 'best_test_test/acc': 77.173, 'best_test_test/acc_unbiased': 76.945, 'best_test_test/diff': 6.127, 'best_test_test/acc_skew': 73.882, 'best_test_test/acc_align': 80.009}
[8 / 20] Learning rate: 0.0001 weight: 0.01
[8 / 20] Loss: 4.19444165127635 CE Loss: 1.5132799253810623 Con Loss: 4.179308877801444
[8 / 20] tensor([[0.762, 0.688],
        [0.773, 0.866]]) {'epoch': 8, 'valid/acc': 77.089, 'valid/acc_unbiased': 77.24, 'valid/diff': 6.697, 'valid/acc_skew': 73.891, 'valid/acc_align': 80.588, 'test/acc': 77.257, 'test/acc_unbiased': 77.224, 'test/diff': 8.343, 'test/acc_skew': 73.053, 'test/acc_align': 81.396}
[8 / 20] best valid accuracy: 77.240 at epoch 8 
 best_stats: {'best_valid_epoch': 8, 'best_valid_valid/acc': 77.089, 'best_valid_valid/acc_unbiased': 77.24, 'best_valid_valid/diff': 6.697, 'best_valid_valid/acc_skew': 73.891, 'best_valid_valid/acc_align': 80.588, 'best_valid_test/acc': 77.257, 'best_valid_test/acc_unbiased': 77.224, 'best_valid_test/diff': 8.343, 'best_valid_test/acc_skew': 73.053, 'best_valid_test/acc_align': 81.396}
[8 / 20] best test accuracy: 77.224 at epoch 8 
 best_stats: {'best_test_epoch': 8, 'best_test_valid/acc': 77.089, 'best_test_valid/acc_unbiased': 77.24, 'best_test_valid/diff': 6.697, 'best_test_valid/acc_skew': 73.891, 'best_test_valid/acc_align': 80.588, 'best_test_test/acc': 77.257, 'best_test_test/acc_unbiased': 77.224, 'best_test_test/diff': 8.343, 'best_test_test/acc_skew': 73.053, 'best_test_test/acc_align': 81.396}
[9 / 20] Learning rate: 0.0001 weight: 0.01
[9 / 20] Loss: 4.085672769323177 CE Loss: 1.4746779910236314 Con Loss: 4.070925983054518
[9 / 20] tensor([[0.751, 0.685],
        [0.814, 0.871]]) {'epoch': 9, 'valid/acc': 78.523, 'valid/acc_unbiased': 78.9, 'valid/diff': 4.839, 'valid/acc_skew': 76.481, 'valid/acc_align': 81.32, 'test/acc': 77.848, 'test/acc_unbiased': 78.021, 'test/diff': 6.12, 'test/acc_skew': 74.961, 'test/acc_align': 81.081}
[9 / 20] best valid accuracy: 78.900 at epoch 9 
 best_stats: {'best_valid_epoch': 9, 'best_valid_valid/acc': 78.523, 'best_valid_valid/acc_unbiased': 78.9, 'best_valid_valid/diff': 4.839, 'best_valid_valid/acc_skew': 76.481, 'best_valid_valid/acc_align': 81.32, 'best_valid_test/acc': 77.848, 'best_valid_test/acc_unbiased': 78.021, 'best_valid_test/diff': 6.12, 'best_valid_test/acc_skew': 74.961, 'best_valid_test/acc_align': 81.081}
[9 / 20] best test accuracy: 78.021 at epoch 9 
 best_stats: {'best_test_epoch': 9, 'best_test_valid/acc': 78.523, 'best_test_valid/acc_unbiased': 78.9, 'best_test_valid/diff': 4.839, 'best_test_valid/acc_skew': 76.481, 'best_test_valid/acc_align': 81.32, 'best_test_test/acc': 77.848, 'best_test_test/acc_unbiased': 78.021, 'best_test_test/diff': 6.12, 'best_test_test/acc_skew': 74.961, 'best_test_test/acc_align': 81.081}
[10 / 20] Learning rate: 0.0001 weight: 0.01
[10 / 20] Loss: 4.034280712734008 CE Loss: 1.668802429665127 Con Loss: 4.01759266898474
[10 / 20] tensor([[0.781, 0.716],
        [0.753, 0.877]]) {'epoch': 10, 'valid/acc': 78.27, 'valid/acc_unbiased': 78.311, 'valid/diff': 8.106, 'valid/acc_skew': 74.258, 'valid/acc_align': 82.364, 'test/acc': 78.439, 'test/acc_unbiased': 78.192, 'test/diff': 9.42, 'test/acc_skew': 73.482, 'test/acc_align': 82.902}
[10 / 20] best valid accuracy: 78.900 at epoch 9 
 best_stats: {'best_valid_epoch': 9, 'best_valid_valid/acc': 78.523, 'best_valid_valid/acc_unbiased': 78.9, 'best_valid_valid/diff': 4.839, 'best_valid_valid/acc_skew': 76.481, 'best_valid_valid/acc_align': 81.32, 'best_valid_test/acc': 77.848, 'best_valid_test/acc_unbiased': 78.021, 'best_valid_test/diff': 6.12, 'best_valid_test/acc_skew': 74.961, 'best_valid_test/acc_align': 81.081}
[10 / 20] best test accuracy: 78.192 at epoch 10 
 best_stats: {'best_test_epoch': 10, 'best_test_valid/acc': 78.27, 'best_test_valid/acc_unbiased': 78.311, 'best_test_valid/diff': 8.106, 'best_test_valid/acc_skew': 74.258, 'best_test_valid/acc_align': 82.364, 'best_test_test/acc': 78.439, 'best_test_test/acc_unbiased': 78.192, 'best_test_test/diff': 9.42, 'best_test_test/acc_skew': 73.482, 'best_test_test/acc_align': 82.902}
[11 / 20] Learning rate: 0.0001 weight: 0.01
[11 / 20] Loss: 4.025331934209956 CE Loss: 1.5089195932626842 Con Loss: 4.010242767790151
[11 / 20] tensor([[0.746, 0.644],
        [0.825, 0.905]]) {'epoch': 11, 'valid/acc': 78.059, 'valid/acc_unbiased': 78.574, 'valid/diff': 4.776, 'valid/acc_skew': 76.186, 'valid/acc_align': 80.962, 'test/acc': 77.722, 'test/acc_unbiased': 77.978, 'test/diff': 9.087, 'test/acc_skew': 73.435, 'test/acc_align': 82.521}
[11 / 20] best valid accuracy: 78.900 at epoch 9 
 best_stats: {'best_valid_epoch': 9, 'best_valid_valid/acc': 78.523, 'best_valid_valid/acc_unbiased': 78.9, 'best_valid_valid/diff': 4.839, 'best_valid_valid/acc_skew': 76.481, 'best_valid_valid/acc_align': 81.32, 'best_valid_test/acc': 77.848, 'best_valid_test/acc_unbiased': 78.021, 'best_valid_test/diff': 6.12, 'best_valid_test/acc_skew': 74.961, 'best_valid_test/acc_align': 81.081}
[11 / 20] best test accuracy: 78.192 at epoch 10 
 best_stats: {'best_test_epoch': 10, 'best_test_valid/acc': 78.27, 'best_test_valid/acc_unbiased': 78.311, 'best_test_valid/diff': 8.106, 'best_test_valid/acc_skew': 74.258, 'best_test_valid/acc_align': 82.364, 'best_test_test/acc': 78.439, 'best_test_test/acc_unbiased': 78.192, 'best_test_test/diff': 9.42, 'best_test_test/acc_skew': 73.482, 'best_test_test/acc_align': 82.902}
[12 / 20] Learning rate: 0.0001 weight: 0.01
[12 / 20] Loss: 3.836290301050662 CE Loss: 1.2957006301936904 Con Loss: 3.8233332856353623
[12 / 20] tensor([[0.760, 0.623],
        [0.805, 0.908]]) {'epoch': 12, 'valid/acc': 76.793, 'valid/acc_unbiased': 77.271, 'valid/diff': 8.45, 'valid/acc_skew': 73.046, 'valid/acc_align': 81.496, 'test/acc': 77.173, 'test/acc_unbiased': 77.407, 'test/diff': 11.96, 'test/acc_skew': 71.427, 'test/acc_align': 83.387}
[12 / 20] best valid accuracy: 78.900 at epoch 9 
 best_stats: {'best_valid_epoch': 9, 'best_valid_valid/acc': 78.523, 'best_valid_valid/acc_unbiased': 78.9, 'best_valid_valid/diff': 4.839, 'best_valid_valid/acc_skew': 76.481, 'best_valid_valid/acc_align': 81.32, 'best_valid_test/acc': 77.848, 'best_valid_test/acc_unbiased': 78.021, 'best_valid_test/diff': 6.12, 'best_valid_test/acc_skew': 74.961, 'best_valid_test/acc_align': 81.081}
[12 / 20] best test accuracy: 78.192 at epoch 10 
 best_stats: {'best_test_epoch': 10, 'best_test_valid/acc': 78.27, 'best_test_valid/acc_unbiased': 78.311, 'best_test_valid/diff': 8.106, 'best_test_valid/acc_skew': 74.258, 'best_test_valid/acc_align': 82.364, 'best_test_test/acc': 78.439, 'best_test_test/acc_unbiased': 78.192, 'best_test_test/diff': 9.42, 'best_test_test/acc_skew': 73.482, 'best_test_test/acc_align': 82.902}
[13 / 20] Learning rate: 0.0001 weight: 0.01
[13 / 20] Loss: 3.858246422502967 CE Loss: 1.2890354802374466 Con Loss: 3.845356103728883
[13 / 20] tensor([[0.774, 0.668],
        [0.786, 0.897]]) {'epoch': 13, 'valid/acc': 77.595, 'valid/acc_unbiased': 77.726, 'valid/diff': 9.133, 'valid/acc_skew': 73.16, 'valid/acc_align': 82.293, 'test/acc': 78.101, 'test/acc_unbiased': 78.126, 'test/diff': 10.915, 'test/acc_skew': 72.668, 'test/acc_align': 83.583}
[13 / 20] best valid accuracy: 78.900 at epoch 9 
 best_stats: {'best_valid_epoch': 9, 'best_valid_valid/acc': 78.523, 'best_valid_valid/acc_unbiased': 78.9, 'best_valid_valid/diff': 4.839, 'best_valid_valid/acc_skew': 76.481, 'best_valid_valid/acc_align': 81.32, 'best_valid_test/acc': 77.848, 'best_valid_test/acc_unbiased': 78.021, 'best_valid_test/diff': 6.12, 'best_valid_test/acc_skew': 74.961, 'best_valid_test/acc_align': 81.081}
[13 / 20] best test accuracy: 78.192 at epoch 10 
 best_stats: {'best_test_epoch': 10, 'best_test_valid/acc': 78.27, 'best_test_valid/acc_unbiased': 78.311, 'best_test_valid/diff': 8.106, 'best_test_valid/acc_skew': 74.258, 'best_test_valid/acc_align': 82.364, 'best_test_test/acc': 78.439, 'best_test_test/acc_unbiased': 78.192, 'best_test_test/diff': 9.42, 'best_test_test/acc_skew': 73.482, 'best_test_test/acc_align': 82.902}
[14 / 20] Learning rate: 1e-05 weight: 0.01
[14 / 20] Loss: 3.5768796095399042 CE Loss: 1.168452771813583 Con Loss: 3.565195079258442
[14 / 20] tensor([[0.803, 0.669],
        [0.805, 0.895]]) {'epoch': 14, 'valid/acc': 78.354, 'valid/acc_unbiased': 78.562, 'valid/diff': 8.249, 'valid/acc_skew': 74.437, 'valid/acc_align': 82.686, 'test/acc': 79.114, 'test/acc_unbiased': 79.292, 'test/diff': 11.152, 'test/acc_skew': 73.716, 'test/acc_align': 84.868}
[14 / 20] best valid accuracy: 78.900 at epoch 9 
 best_stats: {'best_valid_epoch': 9, 'best_valid_valid/acc': 78.523, 'best_valid_valid/acc_unbiased': 78.9, 'best_valid_valid/diff': 4.839, 'best_valid_valid/acc_skew': 76.481, 'best_valid_valid/acc_align': 81.32, 'best_valid_test/acc': 77.848, 'best_valid_test/acc_unbiased': 78.021, 'best_valid_test/diff': 6.12, 'best_valid_test/acc_skew': 74.961, 'best_valid_test/acc_align': 81.081}
[14 / 20] best test accuracy: 79.292 at epoch 14 
 best_stats: {'best_test_epoch': 14, 'best_test_valid/acc': 78.354, 'best_test_valid/acc_unbiased': 78.562, 'best_test_valid/diff': 8.249, 'best_test_valid/acc_skew': 74.437, 'best_test_valid/acc_align': 82.686, 'best_test_test/acc': 79.114, 'best_test_test/acc_unbiased': 79.292, 'best_test_test/diff': 11.152, 'best_test_test/acc_skew': 73.716, 'best_test_test/acc_align': 84.868}
[15 / 20] Learning rate: 1e-05 weight: 0.01
[15 / 20] Loss: 3.5726026288418846 CE Loss: 1.1588787835928476 Con Loss: 3.5610138390393296
[15 / 20] tensor([[0.810, 0.672],
        [0.803, 0.896]]) {'epoch': 15, 'valid/acc': 78.903, 'valid/acc_unbiased': 79.129, 'valid/diff': 8.143, 'valid/acc_skew': 75.058, 'valid/acc_align': 83.201, 'test/acc': 79.367, 'test/acc_unbiased': 79.528, 'test/diff': 11.546, 'test/acc_skew': 73.756, 'test/acc_align': 85.301}
[15 / 20] best valid accuracy: 79.129 at epoch 15 
 best_stats: {'best_valid_epoch': 15, 'best_valid_valid/acc': 78.903, 'best_valid_valid/acc_unbiased': 79.129, 'best_valid_valid/diff': 8.143, 'best_valid_valid/acc_skew': 75.058, 'best_valid_valid/acc_align': 83.201, 'best_valid_test/acc': 79.367, 'best_valid_test/acc_unbiased': 79.528, 'best_valid_test/diff': 11.546, 'best_valid_test/acc_skew': 73.756, 'best_valid_test/acc_align': 85.301}
[15 / 20] best test accuracy: 79.528 at epoch 15 
 best_stats: {'best_test_epoch': 15, 'best_test_valid/acc': 78.903, 'best_test_valid/acc_unbiased': 79.129, 'best_test_valid/diff': 8.143, 'best_test_valid/acc_skew': 75.058, 'best_test_valid/acc_align': 83.201, 'best_test_test/acc': 79.367, 'best_test_test/acc_unbiased': 79.528, 'best_test_test/diff': 11.546, 'best_test_test/acc_skew': 73.756, 'best_test_test/acc_align': 85.301}
[16 / 20] Learning rate: 1e-05 weight: 0.01
[16 / 20] Loss: 3.655641253480403 CE Loss: 1.2875571586388406 Con Loss: 3.6427656878864343
[16 / 20] tensor([[0.772, 0.641],
        [0.814, 0.915]]) {'epoch': 16, 'valid/acc': 77.932, 'valid/acc_unbiased': 78.238, 'valid/diff': 9.211, 'valid/acc_skew': 73.632, 'valid/acc_align': 82.843, 'test/acc': 78.354, 'test/acc_unbiased': 78.566, 'test/diff': 11.639, 'test/acc_skew': 72.746, 'test/acc_align': 84.385}
[16 / 20] best valid accuracy: 79.129 at epoch 15 
 best_stats: {'best_valid_epoch': 15, 'best_valid_valid/acc': 78.903, 'best_valid_valid/acc_unbiased': 79.129, 'best_valid_valid/diff': 8.143, 'best_valid_valid/acc_skew': 75.058, 'best_valid_valid/acc_align': 83.201, 'best_valid_test/acc': 79.367, 'best_valid_test/acc_unbiased': 79.528, 'best_valid_test/diff': 11.546, 'best_valid_test/acc_skew': 73.756, 'best_valid_test/acc_align': 85.301}
[16 / 20] best test accuracy: 79.528 at epoch 15 
 best_stats: {'best_test_epoch': 15, 'best_test_valid/acc': 78.903, 'best_test_valid/acc_unbiased': 79.129, 'best_test_valid/diff': 8.143, 'best_test_valid/acc_skew': 75.058, 'best_test_valid/acc_align': 83.201, 'best_test_test/acc': 79.367, 'best_test_test/acc_unbiased': 79.528, 'best_test_test/diff': 11.546, 'best_test_test/acc_skew': 73.756, 'best_test_test/acc_align': 85.301}
[17 / 20] Learning rate: 1e-05 weight: 0.01
[17 / 20] Loss: 3.5372439605416384 CE Loss: 1.2308626422730025 Con Loss: 3.524935324963017
[17 / 20] tensor([[0.819, 0.679],
        [0.781, 0.890]]) {'epoch': 17, 'valid/acc': 78.903, 'valid/acc_unbiased': 79.069, 'valid/diff': 9.188, 'valid/acc_skew': 74.475, 'valid/acc_align': 83.663, 'test/acc': 79.198, 'test/acc_unbiased': 79.247, 'test/diff': 12.409, 'test/acc_skew': 73.043, 'test/acc_align': 85.452}
[17 / 20] best valid accuracy: 79.129 at epoch 15 
 best_stats: {'best_valid_epoch': 15, 'best_valid_valid/acc': 78.903, 'best_valid_valid/acc_unbiased': 79.129, 'best_valid_valid/diff': 8.143, 'best_valid_valid/acc_skew': 75.058, 'best_valid_valid/acc_align': 83.201, 'best_valid_test/acc': 79.367, 'best_valid_test/acc_unbiased': 79.528, 'best_valid_test/diff': 11.546, 'best_valid_test/acc_skew': 73.756, 'best_valid_test/acc_align': 85.301}
[17 / 20] best test accuracy: 79.528 at epoch 15 
 best_stats: {'best_test_epoch': 15, 'best_test_valid/acc': 78.903, 'best_test_valid/acc_unbiased': 79.129, 'best_test_valid/diff': 8.143, 'best_test_valid/acc_skew': 75.058, 'best_test_valid/acc_align': 83.201, 'best_test_test/acc': 79.367, 'best_test_test/acc_unbiased': 79.528, 'best_test_test/diff': 11.546, 'best_test_test/acc_skew': 73.756, 'best_test_test/acc_align': 85.301}
[18 / 20] Learning rate: 1e-05 weight: 0.01
[18 / 20] Loss: 3.656420060895721 CE Loss: 1.2394732246781441 Con Loss: 3.6440253339718987
[18 / 20] tensor([[0.796, 0.666],
        [0.803, 0.902]]) {'epoch': 18, 'valid/acc': 78.439, 'valid/acc_unbiased': 78.722, 'valid/diff': 8.133, 'valid/acc_skew': 74.656, 'valid/acc_align': 82.789, 'test/acc': 79.03, 'test/acc_unbiased': 79.171, 'test/diff': 11.421, 'test/acc_skew': 73.46, 'test/acc_align': 84.882}
[18 / 20] best valid accuracy: 79.129 at epoch 15 
 best_stats: {'best_valid_epoch': 15, 'best_valid_valid/acc': 78.903, 'best_valid_valid/acc_unbiased': 79.129, 'best_valid_valid/diff': 8.143, 'best_valid_valid/acc_skew': 75.058, 'best_valid_valid/acc_align': 83.201, 'best_valid_test/acc': 79.367, 'best_valid_test/acc_unbiased': 79.528, 'best_valid_test/diff': 11.546, 'best_valid_test/acc_skew': 73.756, 'best_valid_test/acc_align': 85.301}
[18 / 20] best test accuracy: 79.528 at epoch 15 
 best_stats: {'best_test_epoch': 15, 'best_test_valid/acc': 78.903, 'best_test_valid/acc_unbiased': 79.129, 'best_test_valid/diff': 8.143, 'best_test_valid/acc_skew': 75.058, 'best_test_valid/acc_align': 83.201, 'best_test_test/acc': 79.367, 'best_test_test/acc_unbiased': 79.528, 'best_test_test/diff': 11.546, 'best_test_test/acc_skew': 73.756, 'best_test_test/acc_align': 85.301}
[19 / 20] Learning rate: 1e-05 weight: 0.01
[19 / 20] Loss: 3.5415787035158517 CE Loss: 1.2414382616144304 Con Loss: 3.5291643313762853
[19 / 20] tensor([[0.805, 0.665],
        [0.803, 0.903]]) {'epoch': 19, 'valid/acc': 78.945, 'valid/acc_unbiased': 79.161, 'valid/diff': 9.009, 'valid/acc_skew': 74.656, 'valid/acc_align': 83.665, 'test/acc': 79.241, 'test/acc_unbiased': 79.395, 'test/diff': 12.017, 'test/acc_skew': 73.386, 'test/acc_align': 85.404}
[19 / 20] best valid accuracy: 79.161 at epoch 19 
 best_stats: {'best_valid_epoch': 19, 'best_valid_valid/acc': 78.945, 'best_valid_valid/acc_unbiased': 79.161, 'best_valid_valid/diff': 9.009, 'best_valid_valid/acc_skew': 74.656, 'best_valid_valid/acc_align': 83.665, 'best_valid_test/acc': 79.241, 'best_valid_test/acc_unbiased': 79.395, 'best_valid_test/diff': 12.017, 'best_valid_test/acc_skew': 73.386, 'best_valid_test/acc_align': 85.404}
[19 / 20] best test accuracy: 79.528 at epoch 15 
 best_stats: {'best_test_epoch': 15, 'best_test_valid/acc': 78.903, 'best_test_valid/acc_unbiased': 79.129, 'best_test_valid/diff': 8.143, 'best_test_valid/acc_skew': 75.058, 'best_test_valid/acc_align': 83.201, 'best_test_test/acc': 79.367, 'best_test_test/acc_unbiased': 79.528, 'best_test_test/diff': 11.546, 'best_test_test/acc_skew': 73.756, 'best_test_test/acc_align': 85.301}
[20 / 20] Learning rate: 1e-05 weight: 0.01
[20 / 20] Loss: 3.4666047281332735 CE Loss: 1.4808913115428701 Con Loss: 3.4517958171342698
[20 / 20] tensor([[0.772, 0.634],
        [0.823, 0.918]]) {'epoch': 20, 'valid/acc': 78.65, 'valid/acc_unbiased': 79.109, 'valid/diff': 7.451, 'valid/acc_skew': 75.383, 'valid/acc_align': 82.835, 'test/acc': 78.397, 'test/acc_unbiased': 78.672, 'test/diff': 11.724, 'test/acc_skew': 72.809, 'test/acc_align': 84.534}
[20 / 20] best valid accuracy: 79.161 at epoch 19 
 best_stats: {'best_valid_epoch': 19, 'best_valid_valid/acc': 78.945, 'best_valid_valid/acc_unbiased': 79.161, 'best_valid_valid/diff': 9.009, 'best_valid_valid/acc_skew': 74.656, 'best_valid_valid/acc_align': 83.665, 'best_valid_test/acc': 79.241, 'best_valid_test/acc_unbiased': 79.395, 'best_valid_test/diff': 12.017, 'best_valid_test/acc_skew': 73.386, 'best_valid_test/acc_align': 85.404}
[20 / 20] best test accuracy: 79.528 at epoch 15 
 best_stats: {'best_test_epoch': 15, 'best_test_valid/acc': 78.903, 'best_test_valid/acc_unbiased': 79.129, 'best_test_valid/diff': 8.143, 'best_test_valid/acc_skew': 75.058, 'best_test_valid/acc_align': 83.201, 'best_test_test/acc': 79.367, 'best_test_test/acc_unbiased': 79.528, 'best_test_test/diff': 11.546, 'best_test_test/acc_skew': 73.756, 'best_test_test/acc_align': 85.301}
Total training time: 1:09:31
