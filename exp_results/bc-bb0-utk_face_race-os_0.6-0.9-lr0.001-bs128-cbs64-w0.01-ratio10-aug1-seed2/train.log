Log level set to: INFO
Set seed: 2
=======> Using Fixed Random Seed: 2 <========
save_path: exp_results/bc-bb0-utk_face_race-os_0.6-0.9-lr0.001-bs128-cbs64-w0.01-ratio10-aug1-seed2
get_utk_face - split: train, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_race-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [4407, 552]
Target 1: [440, 5529]
Binary Target 1
---------------------------
Target 0: [4407, 552]
Target 1: [440, 5529]
===================================
Normal Label Distribution: 
Target 0: [4407, 552]
Target 1: [440, 5529]
===================================
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [3317, 3317]
Target 1: [3317, 3317]
Binary Target 1
---------------------------
Target 0: [3317, 3317]
Target 1: [3317, 3317]
===================================
Normal Label Distribution: 
Target 0: [3317, 3317]
Target 1: [3317, 3317]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 13268, target_attr: gender, bias_attr: race bias_rate: 0.9
['[train] target_0-bias_0: 3317', '[train] target_0-bias_1: 3317', '[train] target_1-bias_0: 3317', '[train] target_1-bias_1: 3317']
confusion_matrix - 
 original: tensor([[3317., 3317.],
        [3317., 3317.]]), 
 normalized: tensor([[0.500, 0.500],
        [0.500, 0.500]]), 
 b|y: tensor([[0.500, 0.500],
        [0.500, 0.500]])
get_utk_face - split: train, aug: 1, given_y: True, ratio: 10
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_race-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [4407, 552]
Target 1: [440, 5529]
Binary Target 1
---------------------------
Target 0: [4407, 552]
Target 1: [440, 5529]
===================================
Normal Label Distribution: 
Target 0: [4407, 552]
Target 1: [440, 5529]
===================================
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [3317, 3317]
Target 1: [3317, 3317]
Binary Target 1
---------------------------
Target 0: [3317, 3317]
Target 1: [3317, 3317]
===================================
Normal Label Distribution: 
Target 0: [3317, 3317]
Target 1: [3317, 3317]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 13268, target_attr: gender, bias_attr: race bias_rate: 0.9
['[train] target_0-bias_0: 3317', '[train] target_0-bias_1: 3317', '[train] target_1-bias_0: 3317', '[train] target_1-bias_1: 3317']
get_utk_face - split: valid, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_race-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [583, 684]
Target 1: [457, 646]
Binary Target 1
---------------------------
Target 0: [583, 684]
Target 1: [457, 646]
===================================
Normal Label Distribution: 
Target 0: [583, 684]
Target 1: [457, 646]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 2370, target_attr: gender, bias_attr: race bias_rate: 0.9
['[valid] target_0-bias_0: 583', '[valid] target_0-bias_1: 684', '[valid] target_1-bias_0: 457', '[valid] target_1-bias_1: 646']
get_utk_face - split: test, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_race-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [558, 677]
Target 1: [462, 673]
Binary Target 1
---------------------------
Target 0: [558, 677]
Target 1: [462, 673]
===================================
Normal Label Distribution: 
Target 0: [558, 677]
Target 1: [462, 673]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 2370, target_attr: gender, bias_attr: race bias_rate: 0.9
['[test] target_0-bias_0: 558', '[test] target_0-bias_1: 677', '[test] target_1-bias_0: 462', '[test] target_1-bias_1: 673']
decay_epochs: [6, 13]
[1 / 20] Learning rate: 0.001 weight: 0.01
[1 / 20] Loss: 4.876455136225243 CE Loss: 0.5640792126823773 Con Loss: 4.870814353757714
[1 / 20] tensor([[0.891, 0.877],
        [0.690, 0.652]]) {'epoch': 1, 'valid/acc': 79.451, 'valid/acc_unbiased': 79.105, 'valid/diff': 4.803, 'valid/acc_skew': 81.506, 'valid/acc_align': 76.703, 'test/acc': 78.017, 'test/acc_unbiased': 77.772, 'test/diff': 2.573, 'test/acc_skew': 79.058, 'test/acc_align': 76.485}
[1 / 20] best valid accuracy: 79.105 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 79.451, 'best_valid_valid/acc_unbiased': 79.105, 'best_valid_valid/diff': 4.803, 'best_valid_valid/acc_skew': 81.506, 'best_valid_valid/acc_align': 76.703, 'best_valid_test/acc': 78.017, 'best_valid_test/acc_unbiased': 77.772, 'best_valid_test/diff': 2.573, 'best_valid_test/acc_skew': 79.058, 'best_valid_test/acc_align': 76.485}
[1 / 20] best test accuracy: 77.772 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 79.451, 'best_test_valid/acc_unbiased': 79.105, 'best_test_valid/diff': 4.803, 'best_test_valid/acc_skew': 81.506, 'best_test_valid/acc_align': 76.703, 'best_test_test/acc': 78.017, 'best_test_test/acc_unbiased': 77.772, 'best_test_test/diff': 2.573, 'best_test_test/acc_skew': 79.058, 'best_test_test/acc_align': 76.485}
[2 / 20] Learning rate: 0.001 weight: 0.01
[2 / 20] Loss: 4.740962935888447 CE Loss: 0.44266292801419405 Con Loss: 4.73653632242492
[2 / 20] tensor([[0.921, 0.879],
        [0.745, 0.737]]) {'epoch': 2, 'valid/acc': 83.122, 'valid/acc_unbiased': 82.688, 'valid/diff': 1.634, 'valid/acc_skew': 83.505, 'valid/acc_align': 81.871, 'test/acc': 82.236, 'test/acc_unbiased': 82.04, 'test/diff': 2.493, 'test/acc_skew': 83.287, 'test/acc_align': 80.794}
[2 / 20] best valid accuracy: 82.688 at epoch 2 
 best_stats: {'best_valid_epoch': 2, 'best_valid_valid/acc': 83.122, 'best_valid_valid/acc_unbiased': 82.688, 'best_valid_valid/diff': 1.634, 'best_valid_valid/acc_skew': 83.505, 'best_valid_valid/acc_align': 81.871, 'best_valid_test/acc': 82.236, 'best_valid_test/acc_unbiased': 82.04, 'best_valid_test/diff': 2.493, 'best_valid_test/acc_skew': 83.287, 'best_valid_test/acc_align': 80.794}
[2 / 20] best test accuracy: 82.040 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 83.122, 'best_test_valid/acc_unbiased': 82.688, 'best_test_valid/diff': 1.634, 'best_test_valid/acc_skew': 83.505, 'best_test_valid/acc_align': 81.871, 'best_test_test/acc': 82.236, 'best_test_test/acc_unbiased': 82.04, 'best_test_test/diff': 2.493, 'best_test_test/acc_skew': 83.287, 'best_test_test/acc_align': 80.794}
[3 / 20] Learning rate: 0.001 weight: 0.01
[3 / 20] Loss: 4.717621296257867 CE Loss: 0.41289441564696217 Con Loss: 4.713492336566454
[3 / 20] tensor([[0.754, 0.708],
        [0.911, 0.906]]) {'epoch': 3, 'valid/acc': 81.181, 'valid/acc_unbiased': 81.779, 'valid/diff': 0.086, 'valid/acc_skew': 81.807, 'valid/acc_align': 81.751, 'test/acc': 81.477, 'test/acc_unbiased': 81.991, 'test/diff': 2.591, 'test/acc_skew': 83.287, 'test/acc_align': 80.696}
[3 / 20] best valid accuracy: 82.688 at epoch 2 
 best_stats: {'best_valid_epoch': 2, 'best_valid_valid/acc': 83.122, 'best_valid_valid/acc_unbiased': 82.688, 'best_valid_valid/diff': 1.634, 'best_valid_valid/acc_skew': 83.505, 'best_valid_valid/acc_align': 81.871, 'best_valid_test/acc': 82.236, 'best_valid_test/acc_unbiased': 82.04, 'best_valid_test/diff': 2.493, 'best_valid_test/acc_skew': 83.287, 'best_valid_test/acc_align': 80.794}
[3 / 20] best test accuracy: 82.040 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 83.122, 'best_test_valid/acc_unbiased': 82.688, 'best_test_valid/diff': 1.634, 'best_test_valid/acc_skew': 83.505, 'best_test_valid/acc_align': 81.871, 'best_test_test/acc': 82.236, 'best_test_test/acc_unbiased': 82.04, 'best_test_test/diff': 2.493, 'best_test_test/acc_skew': 83.287, 'best_test_test/acc_align': 80.794}
[4 / 20] Learning rate: 0.001 weight: 0.01
[4 / 20] Loss: 4.6892973560865725 CE Loss: 0.4074554164293914 Con Loss: 4.685222803845548
[4 / 20] tensor([[0.808, 0.768],
        [0.823, 0.872]]) {'epoch': 4, 'valid/acc': 82.321, 'valid/acc_unbiased': 82.713, 'valid/diff': 2.672, 'valid/acc_skew': 84.049, 'valid/acc_align': 81.377, 'test/acc': 81.772, 'test/acc_unbiased': 81.777, 'test/diff': 4.493, 'test/acc_skew': 81.538, 'test/acc_align': 82.015}
[4 / 20] best valid accuracy: 82.713 at epoch 4 
 best_stats: {'best_valid_epoch': 4, 'best_valid_valid/acc': 82.321, 'best_valid_valid/acc_unbiased': 82.713, 'best_valid_valid/diff': 2.672, 'best_valid_valid/acc_skew': 84.049, 'best_valid_valid/acc_align': 81.377, 'best_valid_test/acc': 81.772, 'best_valid_test/acc_unbiased': 81.777, 'best_valid_test/diff': 4.493, 'best_valid_test/acc_skew': 81.538, 'best_valid_test/acc_align': 82.015}
[4 / 20] best test accuracy: 82.040 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 83.122, 'best_test_valid/acc_unbiased': 82.688, 'best_test_valid/diff': 1.634, 'best_test_valid/acc_skew': 83.505, 'best_test_valid/acc_align': 81.871, 'best_test_test/acc': 82.236, 'best_test_test/acc_unbiased': 82.04, 'best_test_test/diff': 2.493, 'best_test_test/acc_skew': 83.287, 'best_test_test/acc_align': 80.794}
[5 / 20] Learning rate: 0.001 weight: 0.01
[5 / 20] Loss: 4.674968634091625 CE Loss: 0.3843769436774572 Con Loss: 4.671124849040572
[5 / 20] tensor([[0.742, 0.648],
        [0.924, 0.932]]) {'epoch': 5, 'valid/acc': 79.747, 'valid/acc_unbiased': 80.756, 'valid/diff': 1.851, 'valid/acc_skew': 81.546, 'valid/acc_align': 79.966, 'test/acc': 80.464, 'test/acc_unbiased': 81.157, 'test/diff': 5.045, 'test/acc_skew': 83.309, 'test/acc_align': 79.005}
[5 / 20] best valid accuracy: 82.713 at epoch 4 
 best_stats: {'best_valid_epoch': 4, 'best_valid_valid/acc': 82.321, 'best_valid_valid/acc_unbiased': 82.713, 'best_valid_valid/diff': 2.672, 'best_valid_valid/acc_skew': 84.049, 'best_valid_valid/acc_align': 81.377, 'best_valid_test/acc': 81.772, 'best_valid_test/acc_unbiased': 81.777, 'best_valid_test/diff': 4.493, 'best_valid_test/acc_skew': 81.538, 'best_valid_test/acc_align': 82.015}
[5 / 20] best test accuracy: 82.040 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 83.122, 'best_test_valid/acc_unbiased': 82.688, 'best_test_valid/diff': 1.634, 'best_test_valid/acc_skew': 83.505, 'best_test_valid/acc_align': 81.871, 'best_test_test/acc': 82.236, 'best_test_test/acc_unbiased': 82.04, 'best_test_test/diff': 2.493, 'best_test_test/acc_skew': 83.287, 'best_test_test/acc_align': 80.794}
[6 / 20] Learning rate: 0.001 weight: 0.01
[6 / 20] Loss: 4.657685822954658 CE Loss: 0.3609884286954671 Con Loss: 4.654075937383247
[6 / 20] tensor([[0.717, 0.631],
        [0.931, 0.933]]) {'epoch': 6, 'valid/acc': 79.705, 'valid/acc_unbiased': 80.812, 'valid/diff': 1.675, 'valid/acc_skew': 81.65, 'valid/acc_align': 79.975, 'test/acc': 79.536, 'test/acc_unbiased': 80.286, 'test/diff': 4.426, 'test/acc_skew': 82.379, 'test/acc_align': 78.193}
[6 / 20] best valid accuracy: 82.713 at epoch 4 
 best_stats: {'best_valid_epoch': 4, 'best_valid_valid/acc': 82.321, 'best_valid_valid/acc_unbiased': 82.713, 'best_valid_valid/diff': 2.672, 'best_valid_valid/acc_skew': 84.049, 'best_valid_valid/acc_align': 81.377, 'best_valid_test/acc': 81.772, 'best_valid_test/acc_unbiased': 81.777, 'best_valid_test/diff': 4.493, 'best_valid_test/acc_skew': 81.538, 'best_valid_test/acc_align': 82.015}
[6 / 20] best test accuracy: 82.040 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 83.122, 'best_test_valid/acc_unbiased': 82.688, 'best_test_valid/diff': 1.634, 'best_test_valid/acc_skew': 83.505, 'best_test_valid/acc_align': 81.871, 'best_test_test/acc': 82.236, 'best_test_test/acc_unbiased': 82.04, 'best_test_test/diff': 2.493, 'best_test_test/acc_skew': 83.287, 'best_test_test/acc_align': 80.794}
[7 / 20] Learning rate: 0.0001 weight: 0.01
[7 / 20] Loss: 4.595878899942006 CE Loss: 0.3243476449275254 Con Loss: 4.592635404858777
[7 / 20] tensor([[0.860, 0.823],
        [0.853, 0.868]]) {'epoch': 7, 'valid/acc': 87.004, 'valid/acc_unbiased': 87.232, 'valid/diff': 2.121, 'valid/acc_skew': 88.292, 'valid/acc_align': 86.171, 'test/acc': 85.021, 'test/acc_unbiased': 85.088, 'test/diff': 2.621, 'test/acc_skew': 85.651, 'test/acc_align': 84.525}
[7 / 20] best valid accuracy: 87.232 at epoch 7 
 best_stats: {'best_valid_epoch': 7, 'best_valid_valid/acc': 87.004, 'best_valid_valid/acc_unbiased': 87.232, 'best_valid_valid/diff': 2.121, 'best_valid_valid/acc_skew': 88.292, 'best_valid_valid/acc_align': 86.171, 'best_valid_test/acc': 85.021, 'best_valid_test/acc_unbiased': 85.088, 'best_valid_test/diff': 2.621, 'best_valid_test/acc_skew': 85.651, 'best_valid_test/acc_align': 84.525}
[7 / 20] best test accuracy: 85.088 at epoch 7 
 best_stats: {'best_test_epoch': 7, 'best_test_valid/acc': 87.004, 'best_test_valid/acc_unbiased': 87.232, 'best_test_valid/diff': 2.121, 'best_test_valid/acc_skew': 88.292, 'best_test_valid/acc_align': 86.171, 'best_test_test/acc': 85.021, 'best_test_test/acc_unbiased': 85.088, 'best_test_test/diff': 2.621, 'best_test_test/acc_skew': 85.651, 'best_test_test/acc_align': 84.525}
[8 / 20] Learning rate: 0.0001 weight: 0.01
[8 / 20] Loss: 4.581915933898245 CE Loss: 0.3092872994309777 Con Loss: 4.578823077236632
[8 / 20] tensor([[0.871, 0.827],
        [0.825, 0.863]]) {'epoch': 8, 'valid/acc': 86.962, 'valid/acc_unbiased': 87.084, 'valid/diff': 2.283, 'valid/acc_skew': 88.103, 'valid/acc_align': 86.064, 'test/acc': 84.726, 'test/acc_unbiased': 84.653, 'test/diff': 4.121, 'test/acc_skew': 84.782, 'test/acc_align': 84.524}
[8 / 20] best valid accuracy: 87.232 at epoch 7 
 best_stats: {'best_valid_epoch': 7, 'best_valid_valid/acc': 87.004, 'best_valid_valid/acc_unbiased': 87.232, 'best_valid_valid/diff': 2.121, 'best_valid_valid/acc_skew': 88.292, 'best_valid_valid/acc_align': 86.171, 'best_valid_test/acc': 85.021, 'best_valid_test/acc_unbiased': 85.088, 'best_valid_test/diff': 2.621, 'best_valid_test/acc_skew': 85.651, 'best_valid_test/acc_align': 84.525}
[8 / 20] best test accuracy: 85.088 at epoch 7 
 best_stats: {'best_test_epoch': 7, 'best_test_valid/acc': 87.004, 'best_test_valid/acc_unbiased': 87.232, 'best_test_valid/diff': 2.121, 'best_test_valid/acc_skew': 88.292, 'best_test_valid/acc_align': 86.171, 'best_test_test/acc': 85.021, 'best_test_test/acc_unbiased': 85.088, 'best_test_test/diff': 2.621, 'best_test_test/acc_skew': 85.651, 'best_test_test/acc_align': 84.525}
[9 / 20] Learning rate: 0.0001 weight: 0.01
[9 / 20] Loss: 4.557964239560375 CE Loss: 0.2914355045562413 Con Loss: 4.555049889771235
[9 / 20] tensor([[0.880, 0.833],
        [0.846, 0.869]]) {'epoch': 9, 'valid/acc': 86.962, 'valid/acc_unbiased': 87.102, 'valid/diff': 1.801, 'valid/acc_skew': 88.003, 'valid/acc_align': 86.201, 'test/acc': 85.696, 'test/acc_unbiased': 85.714, 'test/diff': 3.488, 'test/acc_skew': 86.312, 'test/acc_align': 85.116}
[9 / 20] best valid accuracy: 87.232 at epoch 7 
 best_stats: {'best_valid_epoch': 7, 'best_valid_valid/acc': 87.004, 'best_valid_valid/acc_unbiased': 87.232, 'best_valid_valid/diff': 2.121, 'best_valid_valid/acc_skew': 88.292, 'best_valid_valid/acc_align': 86.171, 'best_valid_test/acc': 85.021, 'best_valid_test/acc_unbiased': 85.088, 'best_valid_test/diff': 2.621, 'best_valid_test/acc_skew': 85.651, 'best_valid_test/acc_align': 84.525}
[9 / 20] best test accuracy: 85.714 at epoch 9 
 best_stats: {'best_test_epoch': 9, 'best_test_valid/acc': 86.962, 'best_test_valid/acc_unbiased': 87.102, 'best_test_valid/diff': 1.801, 'best_test_valid/acc_skew': 88.003, 'best_test_valid/acc_align': 86.201, 'best_test_test/acc': 85.696, 'best_test_test/acc_unbiased': 85.714, 'best_test_test/diff': 3.488, 'best_test_test/acc_skew': 86.312, 'best_test_test/acc_align': 85.116}
[10 / 20] Learning rate: 0.0001 weight: 0.01
[10 / 20] Loss: 4.538637262171279 CE Loss: 0.27858549119263915 Con Loss: 4.535851391173286
[10 / 20] tensor([[0.894, 0.846],
        [0.823, 0.862]]) {'epoch': 10, 'valid/acc': 87.426, 'valid/acc_unbiased': 87.377, 'valid/diff': 2.18, 'valid/acc_skew': 88.467, 'valid/acc_align': 86.287, 'test/acc': 85.738, 'test/acc_unbiased': 85.624, 'test/diff': 4.359, 'test/acc_skew': 85.839, 'test/acc_align': 85.41}
[10 / 20] best valid accuracy: 87.377 at epoch 10 
 best_stats: {'best_valid_epoch': 10, 'best_valid_valid/acc': 87.426, 'best_valid_valid/acc_unbiased': 87.377, 'best_valid_valid/diff': 2.18, 'best_valid_valid/acc_skew': 88.467, 'best_valid_valid/acc_align': 86.287, 'best_valid_test/acc': 85.738, 'best_valid_test/acc_unbiased': 85.624, 'best_valid_test/diff': 4.359, 'best_valid_test/acc_skew': 85.839, 'best_valid_test/acc_align': 85.41}
[10 / 20] best test accuracy: 85.714 at epoch 9 
 best_stats: {'best_test_epoch': 9, 'best_test_valid/acc': 86.962, 'best_test_valid/acc_unbiased': 87.102, 'best_test_valid/diff': 1.801, 'best_test_valid/acc_skew': 88.003, 'best_test_valid/acc_align': 86.201, 'best_test_test/acc': 85.696, 'best_test_test/acc_unbiased': 85.714, 'best_test_test/diff': 3.488, 'best_test_test/acc_skew': 86.312, 'best_test_test/acc_align': 85.116}
[11 / 20] Learning rate: 0.0001 weight: 0.01
[11 / 20] Loss: 4.527309970608453 CE Loss: 0.27870288607151994 Con Loss: 4.5245229649479075
[11 / 20] tensor([[0.878, 0.845],
        [0.851, 0.872]]) {'epoch': 11, 'valid/acc': 87.004, 'valid/acc_unbiased': 87.051, 'valid/diff': 1.778, 'valid/acc_skew': 87.923, 'valid/acc_align': 86.18, 'test/acc': 86.16, 'test/acc_unbiased': 86.148, 'test/diff': 2.74, 'test/acc_skew': 86.439, 'test/acc_align': 85.856}
[11 / 20] best valid accuracy: 87.377 at epoch 10 
 best_stats: {'best_valid_epoch': 10, 'best_valid_valid/acc': 87.426, 'best_valid_valid/acc_unbiased': 87.377, 'best_valid_valid/diff': 2.18, 'best_valid_valid/acc_skew': 88.467, 'best_valid_valid/acc_align': 86.287, 'best_valid_test/acc': 85.738, 'best_valid_test/acc_unbiased': 85.624, 'best_valid_test/diff': 4.359, 'best_valid_test/acc_skew': 85.839, 'best_valid_test/acc_align': 85.41}
[11 / 20] best test accuracy: 86.148 at epoch 11 
 best_stats: {'best_test_epoch': 11, 'best_test_valid/acc': 87.004, 'best_test_valid/acc_unbiased': 87.051, 'best_test_valid/diff': 1.778, 'best_test_valid/acc_skew': 87.923, 'best_test_valid/acc_align': 86.18, 'best_test_test/acc': 86.16, 'best_test_test/acc_unbiased': 86.148, 'best_test_test/diff': 2.74, 'best_test_test/acc_skew': 86.439, 'best_test_test/acc_align': 85.856}
[12 / 20] Learning rate: 0.0001 weight: 0.01
[12 / 20] Loss: 4.536276024366165 CE Loss: 0.2757859139655202 Con Loss: 4.533518158818068
[12 / 20] tensor([[0.862, 0.817],
        [0.868, 0.890]]) {'epoch': 12, 'valid/acc': 87.089, 'valid/acc_unbiased': 87.373, 'valid/diff': 1.904, 'valid/acc_skew': 88.325, 'valid/acc_align': 86.421, 'test/acc': 85.823, 'test/acc_unbiased': 85.921, 'test/diff': 3.362, 'test/acc_skew': 86.499, 'test/acc_align': 85.344}
[12 / 20] best valid accuracy: 87.377 at epoch 10 
 best_stats: {'best_valid_epoch': 10, 'best_valid_valid/acc': 87.426, 'best_valid_valid/acc_unbiased': 87.377, 'best_valid_valid/diff': 2.18, 'best_valid_valid/acc_skew': 88.467, 'best_valid_valid/acc_align': 86.287, 'best_valid_test/acc': 85.738, 'best_valid_test/acc_unbiased': 85.624, 'best_valid_test/diff': 4.359, 'best_valid_test/acc_skew': 85.839, 'best_valid_test/acc_align': 85.41}
[12 / 20] best test accuracy: 86.148 at epoch 11 
 best_stats: {'best_test_epoch': 11, 'best_test_valid/acc': 87.004, 'best_test_valid/acc_unbiased': 87.051, 'best_test_valid/diff': 1.778, 'best_test_valid/acc_skew': 87.923, 'best_test_valid/acc_align': 86.18, 'best_test_test/acc': 86.16, 'best_test_test/acc_unbiased': 86.148, 'best_test_test/diff': 2.74, 'best_test_test/acc_skew': 86.439, 'best_test_test/acc_align': 85.856}
[13 / 20] Learning rate: 0.0001 weight: 0.01
[13 / 20] Loss: 4.518975005870057 CE Loss: 0.26451507182429634 Con Loss: 4.516329873711508
[13 / 20] tensor([[0.855, 0.809],
        [0.874, 0.899]]) {'epoch': 13, 'valid/acc': 86.498, 'valid/acc_unbiased': 86.956, 'valid/diff': 3.117, 'valid/acc_skew': 88.514, 'valid/acc_align': 85.397, 'test/acc': 85.823, 'test/acc_unbiased': 85.943, 'test/diff': 3.494, 'test/acc_skew': 86.465, 'test/acc_align': 85.421}
[13 / 20] best valid accuracy: 87.377 at epoch 10 
 best_stats: {'best_valid_epoch': 10, 'best_valid_valid/acc': 87.426, 'best_valid_valid/acc_unbiased': 87.377, 'best_valid_valid/diff': 2.18, 'best_valid_valid/acc_skew': 88.467, 'best_valid_valid/acc_align': 86.287, 'best_valid_test/acc': 85.738, 'best_valid_test/acc_unbiased': 85.624, 'best_valid_test/diff': 4.359, 'best_valid_test/acc_skew': 85.839, 'best_valid_test/acc_align': 85.41}
[13 / 20] best test accuracy: 86.148 at epoch 11 
 best_stats: {'best_test_epoch': 11, 'best_test_valid/acc': 87.004, 'best_test_valid/acc_unbiased': 87.051, 'best_test_valid/diff': 1.778, 'best_test_valid/acc_skew': 87.923, 'best_test_valid/acc_align': 86.18, 'best_test_test/acc': 86.16, 'best_test_test/acc_unbiased': 86.148, 'best_test_test/diff': 2.74, 'best_test_test/acc_skew': 86.439, 'best_test_test/acc_align': 85.856}
[14 / 20] Learning rate: 1e-05 weight: 0.01
[14 / 20] Loss: 4.502380031111875 CE Loss: 0.25956072397069613 Con Loss: 4.499784437547005
[14 / 20] tensor([[0.878, 0.829],
        [0.844, 0.883]]) {'epoch': 14, 'valid/acc': 86.962, 'valid/acc_unbiased': 87.25, 'valid/diff': 3.085, 'valid/acc_skew': 88.792, 'valid/acc_align': 85.707, 'test/acc': 85.865, 'test/acc_unbiased': 85.839, 'test/diff': 4.397, 'test/acc_skew': 86.115, 'test/acc_align': 85.564}
[14 / 20] best valid accuracy: 87.377 at epoch 10 
 best_stats: {'best_valid_epoch': 10, 'best_valid_valid/acc': 87.426, 'best_valid_valid/acc_unbiased': 87.377, 'best_valid_valid/diff': 2.18, 'best_valid_valid/acc_skew': 88.467, 'best_valid_valid/acc_align': 86.287, 'best_valid_test/acc': 85.738, 'best_valid_test/acc_unbiased': 85.624, 'best_valid_test/diff': 4.359, 'best_valid_test/acc_skew': 85.839, 'best_valid_test/acc_align': 85.41}
[14 / 20] best test accuracy: 86.148 at epoch 11 
 best_stats: {'best_test_epoch': 11, 'best_test_valid/acc': 87.004, 'best_test_valid/acc_unbiased': 87.051, 'best_test_valid/diff': 1.778, 'best_test_valid/acc_skew': 87.923, 'best_test_valid/acc_align': 86.18, 'best_test_test/acc': 86.16, 'best_test_test/acc_unbiased': 86.148, 'best_test_test/diff': 2.74, 'best_test_test/acc_skew': 86.439, 'best_test_test/acc_align': 85.856}
[15 / 20] Learning rate: 1e-05 weight: 0.01
[15 / 20] Loss: 4.501691903628101 CE Loss: 0.2612972554175438 Con Loss: 4.4990789271421665
[15 / 20] tensor([[0.871, 0.829],
        [0.846, 0.883]]) {'epoch': 15, 'valid/acc': 87.089, 'valid/acc_unbiased': 87.341, 'valid/diff': 2.683, 'valid/acc_skew': 88.683, 'valid/acc_align': 85.999, 'test/acc': 85.738, 'test/acc_unbiased': 85.714, 'test/diff': 3.93, 'test/acc_skew': 85.864, 'test/acc_align': 85.564}
[15 / 20] best valid accuracy: 87.377 at epoch 10 
 best_stats: {'best_valid_epoch': 10, 'best_valid_valid/acc': 87.426, 'best_valid_valid/acc_unbiased': 87.377, 'best_valid_valid/diff': 2.18, 'best_valid_valid/acc_skew': 88.467, 'best_valid_valid/acc_align': 86.287, 'best_valid_test/acc': 85.738, 'best_valid_test/acc_unbiased': 85.624, 'best_valid_test/diff': 4.359, 'best_valid_test/acc_skew': 85.839, 'best_valid_test/acc_align': 85.41}
[15 / 20] best test accuracy: 86.148 at epoch 11 
 best_stats: {'best_test_epoch': 11, 'best_test_valid/acc': 87.004, 'best_test_valid/acc_unbiased': 87.051, 'best_test_valid/diff': 1.778, 'best_test_valid/acc_skew': 87.923, 'best_test_valid/acc_align': 86.18, 'best_test_test/acc': 86.16, 'best_test_test/acc_unbiased': 86.148, 'best_test_test/diff': 2.74, 'best_test_test/acc_skew': 86.439, 'best_test_test/acc_align': 85.856}
[16 / 20] Learning rate: 1e-05 weight: 0.01
[16 / 20] Loss: 4.4956716507861945 CE Loss: 0.25930492083081863 Con Loss: 4.493078587462754
[16 / 20] tensor([[0.864, 0.817],
        [0.855, 0.893]]) {'epoch': 16, 'valid/acc': 87.046, 'valid/acc_unbiased': 87.421, 'valid/diff': 3.54, 'valid/acc_skew': 89.191, 'valid/acc_align': 85.651, 'test/acc': 85.696, 'test/acc_unbiased': 85.716, 'test/diff': 4.25, 'test/acc_skew': 85.939, 'test/acc_align': 85.493}
[16 / 20] best valid accuracy: 87.421 at epoch 16 
 best_stats: {'best_valid_epoch': 16, 'best_valid_valid/acc': 87.046, 'best_valid_valid/acc_unbiased': 87.421, 'best_valid_valid/diff': 3.54, 'best_valid_valid/acc_skew': 89.191, 'best_valid_valid/acc_align': 85.651, 'best_valid_test/acc': 85.696, 'best_valid_test/acc_unbiased': 85.716, 'best_valid_test/diff': 4.25, 'best_valid_test/acc_skew': 85.939, 'best_valid_test/acc_align': 85.493}
[16 / 20] best test accuracy: 86.148 at epoch 11 
 best_stats: {'best_test_epoch': 11, 'best_test_valid/acc': 87.004, 'best_test_valid/acc_unbiased': 87.051, 'best_test_valid/diff': 1.778, 'best_test_valid/acc_skew': 87.923, 'best_test_valid/acc_align': 86.18, 'best_test_test/acc': 86.16, 'best_test_test/acc_unbiased': 86.148, 'best_test_test/diff': 2.74, 'best_test_test/acc_skew': 86.439, 'best_test_test/acc_align': 85.856}
[17 / 20] Learning rate: 1e-05 weight: 0.01
[17 / 20] Loss: 4.504723195394264 CE Loss: 0.255785186974658 Con Loss: 4.502165343267643
[17 / 20] tensor([[0.880, 0.832],
        [0.846, 0.878]]) {'epoch': 17, 'valid/acc': 87.342, 'valid/acc_unbiased': 87.576, 'valid/diff': 2.852, 'valid/acc_skew': 89.002, 'valid/acc_align': 86.15, 'test/acc': 85.907, 'test/acc_unbiased': 85.9, 'test/diff': 4.008, 'test/acc_skew': 86.312, 'test/acc_align': 85.488}
[17 / 20] best valid accuracy: 87.576 at epoch 17 
 best_stats: {'best_valid_epoch': 17, 'best_valid_valid/acc': 87.342, 'best_valid_valid/acc_unbiased': 87.576, 'best_valid_valid/diff': 2.852, 'best_valid_valid/acc_skew': 89.002, 'best_valid_valid/acc_align': 86.15, 'best_valid_test/acc': 85.907, 'best_valid_test/acc_unbiased': 85.9, 'best_valid_test/diff': 4.008, 'best_valid_test/acc_skew': 86.312, 'best_valid_test/acc_align': 85.488}
[17 / 20] best test accuracy: 86.148 at epoch 11 
 best_stats: {'best_test_epoch': 11, 'best_test_valid/acc': 87.004, 'best_test_valid/acc_unbiased': 87.051, 'best_test_valid/diff': 1.778, 'best_test_valid/acc_skew': 87.923, 'best_test_valid/acc_align': 86.18, 'best_test_test/acc': 86.16, 'best_test_test/acc_unbiased': 86.148, 'best_test_test/diff': 2.74, 'best_test_test/acc_skew': 86.439, 'best_test_test/acc_align': 85.856}
[18 / 20] Learning rate: 1e-05 weight: 0.01
[18 / 20] Loss: 4.497013429004024 CE Loss: 0.2649603080311057 Con Loss: 4.494363828491726
[18 / 20] tensor([[0.864, 0.823],
        [0.851, 0.890]]) {'epoch': 18, 'valid/acc': 87.3, 'valid/acc_unbiased': 87.601, 'valid/diff': 2.868, 'valid/acc_skew': 89.035, 'valid/acc_align': 86.167, 'test/acc': 85.696, 'test/acc_unbiased': 85.681, 'test/diff': 4.022, 'test/acc_skew': 85.722, 'test/acc_align': 85.64}
[18 / 20] best valid accuracy: 87.601 at epoch 18 
 best_stats: {'best_valid_epoch': 18, 'best_valid_valid/acc': 87.3, 'best_valid_valid/acc_unbiased': 87.601, 'best_valid_valid/diff': 2.868, 'best_valid_valid/acc_skew': 89.035, 'best_valid_valid/acc_align': 86.167, 'best_valid_test/acc': 85.696, 'best_valid_test/acc_unbiased': 85.681, 'best_valid_test/diff': 4.022, 'best_valid_test/acc_skew': 85.722, 'best_valid_test/acc_align': 85.64}
[18 / 20] best test accuracy: 86.148 at epoch 11 
 best_stats: {'best_test_epoch': 11, 'best_test_valid/acc': 87.004, 'best_test_valid/acc_unbiased': 87.051, 'best_test_valid/diff': 1.778, 'best_test_valid/acc_skew': 87.923, 'best_test_valid/acc_align': 86.18, 'best_test_test/acc': 86.16, 'best_test_test/acc_unbiased': 86.148, 'best_test_test/diff': 2.74, 'best_test_test/acc_skew': 86.439, 'best_test_test/acc_align': 85.856}
[19 / 20] Learning rate: 1e-05 weight: 0.01
[19 / 20] Loss: 4.4942036362200355 CE Loss: 0.25614214371154204 Con Loss: 4.491642195954896
[19 / 20] tensor([[0.867, 0.818],
        [0.855, 0.893]]) {'epoch': 19, 'valid/acc': 87.342, 'valid/acc_unbiased': 87.682, 'valid/diff': 3.314, 'valid/acc_skew': 89.339, 'valid/acc_align': 86.025, 'test/acc': 85.823, 'test/acc_unbiased': 85.842, 'test/diff': 4.355, 'test/acc_skew': 86.118, 'test/acc_align': 85.567}
[19 / 20] best valid accuracy: 87.682 at epoch 19 
 best_stats: {'best_valid_epoch': 19, 'best_valid_valid/acc': 87.342, 'best_valid_valid/acc_unbiased': 87.682, 'best_valid_valid/diff': 3.314, 'best_valid_valid/acc_skew': 89.339, 'best_valid_valid/acc_align': 86.025, 'best_valid_test/acc': 85.823, 'best_valid_test/acc_unbiased': 85.842, 'best_valid_test/diff': 4.355, 'best_valid_test/acc_skew': 86.118, 'best_valid_test/acc_align': 85.567}
[19 / 20] best test accuracy: 86.148 at epoch 11 
 best_stats: {'best_test_epoch': 11, 'best_test_valid/acc': 87.004, 'best_test_valid/acc_unbiased': 87.051, 'best_test_valid/diff': 1.778, 'best_test_valid/acc_skew': 87.923, 'best_test_valid/acc_align': 86.18, 'best_test_test/acc': 86.16, 'best_test_test/acc_unbiased': 86.148, 'best_test_test/diff': 2.74, 'best_test_test/acc_skew': 86.439, 'best_test_test/acc_align': 85.856}
[20 / 20] Learning rate: 1e-05 weight: 0.01
[20 / 20] Loss: 4.492250818713156 CE Loss: 0.2549982351291097 Con Loss: 4.489700818227147
[20 / 20] tensor([[0.871, 0.818],
        [0.855, 0.887]]) {'epoch': 20, 'valid/acc': 87.384, 'valid/acc_unbiased': 87.697, 'valid/diff': 3.018, 'valid/acc_skew': 89.206, 'valid/acc_align': 86.189, 'test/acc': 85.738, 'test/acc_unbiased': 85.783, 'test/diff': 4.237, 'test/acc_skew': 86.297, 'test/acc_align': 85.269}
[20 / 20] best valid accuracy: 87.697 at epoch 20 
 best_stats: {'best_valid_epoch': 20, 'best_valid_valid/acc': 87.384, 'best_valid_valid/acc_unbiased': 87.697, 'best_valid_valid/diff': 3.018, 'best_valid_valid/acc_skew': 89.206, 'best_valid_valid/acc_align': 86.189, 'best_valid_test/acc': 85.738, 'best_valid_test/acc_unbiased': 85.783, 'best_valid_test/diff': 4.237, 'best_valid_test/acc_skew': 86.297, 'best_valid_test/acc_align': 85.269}
[20 / 20] best test accuracy: 86.148 at epoch 11 
 best_stats: {'best_test_epoch': 11, 'best_test_valid/acc': 87.004, 'best_test_valid/acc_unbiased': 87.051, 'best_test_valid/diff': 1.778, 'best_test_valid/acc_skew': 87.923, 'best_test_valid/acc_align': 86.18, 'best_test_test/acc': 86.16, 'best_test_test/acc_unbiased': 86.148, 'best_test_test/diff': 2.74, 'best_test_test/acc_skew': 86.439, 'best_test_test/acc_align': 85.856}
Total training time: 0:31:40
