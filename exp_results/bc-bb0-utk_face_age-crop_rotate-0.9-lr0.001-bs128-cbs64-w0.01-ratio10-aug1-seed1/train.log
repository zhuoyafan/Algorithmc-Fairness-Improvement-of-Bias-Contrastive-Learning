Log level set to: INFO
Set seed: 1
=======> Using Fixed Random Seed: 1 <========
save_path: exp_results/bc-bb0-utk_face_age-crop_rotate-0.9-lr0.001-bs128-cbs64-w0.01-ratio10-aug1-seed1
get_utk_face - split: train, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_age-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
Binary Target 1
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Normal Label Distribution: 
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
Binary Target 1
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Normal Label Distribution: 
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 10684, target_attr: gender, bias_attr: age bias_rate: 0.9
['[train] target_0-bias_0: 8237', '[train] target_0-bias_1: 147', '[train] target_1-bias_0: 823', '[train] target_1-bias_1: 1477']
confusion_matrix - 
 original: tensor([[8237.,  823.],
        [ 147., 1477.]]), 
 normalized: tensor([[0.909, 0.091],
        [0.091, 0.909]]), 
 b|y: tensor([[0.982, 0.018],
        [0.358, 0.642]])
get_utk_face - split: train, aug: 1, given_y: True, ratio: 10
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_age-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
Binary Target 1
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Normal Label Distribution: 
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
Binary Target 1
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Normal Label Distribution: 
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 10684, target_attr: gender, bias_attr: age bias_rate: 0.9
['[train] target_0-bias_0: 8237', '[train] target_0-bias_1: 147', '[train] target_1-bias_0: 823', '[train] target_1-bias_1: 1477']
get_utk_face - split: valid, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_age-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [1030, 195]
Target 1: [841, 202]
Binary Target 1
---------------------------
Target 0: [1030, 195]
Target 1: [841, 202]
===================================
Normal Label Distribution: 
Target 0: [1030, 195]
Target 1: [841, 202]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 2268, target_attr: gender, bias_attr: age bias_rate: 0.9
['[valid] target_0-bias_0: 1030', '[valid] target_0-bias_1: 195', '[valid] target_1-bias_0: 841', '[valid] target_1-bias_1: 202']
get_utk_face - split: test, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_age-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [1061, 176]
Target 1: [867, 165]
Binary Target 1
---------------------------
Target 0: [1061, 176]
Target 1: [867, 165]
===================================
Normal Label Distribution: 
Target 0: [1061, 176]
Target 1: [867, 165]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 2269, target_attr: gender, bias_attr: age bias_rate: 0.9
['[test] target_0-bias_0: 1061', '[test] target_0-bias_1: 176', '[test] target_1-bias_0: 867', '[test] target_1-bias_1: 165']
decay_epochs: [6, 13]
[1 / 20] Learning rate: 0.001 weight: 0.01
[1 / 20] Loss: 4.828172229194141 CE Loss: 0.5605467538492638 Con Loss: 4.822566760786907
[1 / 20] tensor([[0.969, 0.983],
        [0.176, 0.061]]) {'epoch': 1, 'valid/acc': 59.127, 'valid/acc_unbiased': 54.171, 'valid/diff': 5.703, 'valid/acc_skew': 57.023, 'valid/acc_align': 51.32, 'test/acc': 60.115, 'test/acc_unbiased': 54.723, 'test/diff': 6.496, 'test/acc_skew': 57.971, 'test/acc_align': 51.475}
[1 / 20] best valid accuracy: 54.171 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 59.127, 'best_valid_valid/acc_unbiased': 54.171, 'best_valid_valid/diff': 5.703, 'best_valid_valid/acc_skew': 57.023, 'best_valid_valid/acc_align': 51.32, 'best_valid_test/acc': 60.115, 'best_valid_test/acc_unbiased': 54.723, 'best_valid_test/diff': 6.496, 'best_valid_test/acc_skew': 57.971, 'best_valid_test/acc_align': 51.475}
[1 / 20] best test accuracy: 54.723 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 59.127, 'best_test_valid/acc_unbiased': 54.171, 'best_test_valid/diff': 5.703, 'best_test_valid/acc_skew': 57.023, 'best_test_valid/acc_align': 51.32, 'best_test_test/acc': 60.115, 'best_test_test/acc_unbiased': 54.723, 'best_test_test/diff': 6.496, 'best_test_test/acc_skew': 57.971, 'best_test_test/acc_align': 51.475}
[2 / 20] Learning rate: 0.001 weight: 0.01
[2 / 20] Loss: 4.693916343473308 CE Loss: 0.5369931164639401 Con Loss: 4.688546405665127
[2 / 20] tensor([[0.999, 0.994],
        [0.018, 0.012]]) {'epoch': 2, 'valid/acc': 55.071, 'valid/acc_unbiased': 50.724, 'valid/diff': 1.643, 'valid/acc_skew': 51.546, 'valid/acc_align': 49.903, 'test/acc': 55.223, 'test/acc_unbiased': 50.599, 'test/diff': 0.554, 'test/acc_skew': 50.639, 'test/acc_align': 50.559}
[2 / 20] best valid accuracy: 54.171 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 59.127, 'best_valid_valid/acc_unbiased': 54.171, 'best_valid_valid/diff': 5.703, 'best_valid_valid/acc_skew': 57.023, 'best_valid_valid/acc_align': 51.32, 'best_valid_test/acc': 60.115, 'best_valid_test/acc_unbiased': 54.723, 'best_valid_test/diff': 6.496, 'best_valid_test/acc_skew': 57.971, 'best_valid_test/acc_align': 51.475}
[2 / 20] best test accuracy: 54.723 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 59.127, 'best_test_valid/acc_unbiased': 54.171, 'best_test_valid/diff': 5.703, 'best_test_valid/acc_skew': 57.023, 'best_test_valid/acc_align': 51.32, 'best_test_test/acc': 60.115, 'best_test_test/acc_unbiased': 54.723, 'best_test_test/diff': 6.496, 'best_test_test/acc_skew': 57.971, 'best_test_test/acc_align': 51.475}
[3 / 20] Learning rate: 0.001 weight: 0.01
[3 / 20] Loss: 4.590409272442771 CE Loss: 0.5208519897359178 Con Loss: 4.585200766774431
[3 / 20] tensor([[0.988, 0.972],
        [0.114, 0.145]]) {'epoch': 3, 'valid/acc': 58.333, 'valid/acc_unbiased': 54.835, 'valid/diff': 2.833, 'valid/acc_skew': 53.418, 'valid/acc_align': 56.251, 'test/acc': 59.145, 'test/acc_unbiased': 55.474, 'test/diff': 2.371, 'test/acc_skew': 54.289, 'test/acc_align': 56.66}
[3 / 20] best valid accuracy: 54.835 at epoch 3 
 best_stats: {'best_valid_epoch': 3, 'best_valid_valid/acc': 58.333, 'best_valid_valid/acc_unbiased': 54.835, 'best_valid_valid/diff': 2.833, 'best_valid_valid/acc_skew': 53.418, 'best_valid_valid/acc_align': 56.251, 'best_valid_test/acc': 59.145, 'best_valid_test/acc_unbiased': 55.474, 'best_valid_test/diff': 2.371, 'best_valid_test/acc_skew': 54.289, 'best_valid_test/acc_align': 56.66}
[3 / 20] best test accuracy: 55.474 at epoch 3 
 best_stats: {'best_test_epoch': 3, 'best_test_valid/acc': 58.333, 'best_test_valid/acc_unbiased': 54.835, 'best_test_valid/diff': 2.833, 'best_test_valid/acc_skew': 53.418, 'best_test_valid/acc_align': 56.251, 'best_test_test/acc': 59.145, 'best_test_test/acc_unbiased': 55.474, 'best_test_test/diff': 2.371, 'best_test_test/acc_skew': 54.289, 'best_test_test/acc_align': 56.66}
[4 / 20] Learning rate: 0.001 weight: 0.01
[4 / 20] Loss: 4.608798180569071 CE Loss: 0.5265425834504909 Con Loss: 4.603532758110786
[4 / 20] tensor([[1.000, 1.000],
        [0.021, 0.006]]) {'epoch': 4, 'valid/acc': 55.159, 'valid/acc_unbiased': 50.867, 'valid/diff': 1.239, 'valid/acc_skew': 51.486, 'valid/acc_align': 50.248, 'test/acc': 55.355, 'test/acc_unbiased': 50.671, 'test/diff': 0.735, 'test/acc_skew': 51.038, 'test/acc_align': 50.303}
[4 / 20] best valid accuracy: 54.835 at epoch 3 
 best_stats: {'best_valid_epoch': 3, 'best_valid_valid/acc': 58.333, 'best_valid_valid/acc_unbiased': 54.835, 'best_valid_valid/diff': 2.833, 'best_valid_valid/acc_skew': 53.418, 'best_valid_valid/acc_align': 56.251, 'best_valid_test/acc': 59.145, 'best_valid_test/acc_unbiased': 55.474, 'best_valid_test/diff': 2.371, 'best_valid_test/acc_skew': 54.289, 'best_valid_test/acc_align': 56.66}
[4 / 20] best test accuracy: 55.474 at epoch 3 
 best_stats: {'best_test_epoch': 3, 'best_test_valid/acc': 58.333, 'best_test_valid/acc_unbiased': 54.835, 'best_test_valid/diff': 2.833, 'best_test_valid/acc_skew': 53.418, 'best_test_valid/acc_align': 56.251, 'best_test_test/acc': 59.145, 'best_test_test/acc_unbiased': 55.474, 'best_test_test/diff': 2.371, 'best_test_test/acc_skew': 54.289, 'best_test_test/acc_align': 56.66}
[5 / 20] Learning rate: 0.001 weight: 0.01
[5 / 20] Loss: 4.607453477645983 CE Loss: 0.5165946098000581 Con Loss: 4.602287535986977
[5 / 20] tensor([[1.000, 1.000],
        [0.002, 0.006]]) {'epoch': 5, 'valid/acc': 54.145, 'valid/acc_unbiased': 50.183, 'valid/diff': 0.129, 'valid/acc_skew': 50.119, 'valid/acc_align': 50.248, 'test/acc': 54.65, 'test/acc_unbiased': 50.209, 'test/diff': 0.188, 'test/acc_skew': 50.115, 'test/acc_align': 50.303}
[5 / 20] best valid accuracy: 54.835 at epoch 3 
 best_stats: {'best_valid_epoch': 3, 'best_valid_valid/acc': 58.333, 'best_valid_valid/acc_unbiased': 54.835, 'best_valid_valid/diff': 2.833, 'best_valid_valid/acc_skew': 53.418, 'best_valid_valid/acc_align': 56.251, 'best_valid_test/acc': 59.145, 'best_valid_test/acc_unbiased': 55.474, 'best_valid_test/diff': 2.371, 'best_valid_test/acc_skew': 54.289, 'best_valid_test/acc_align': 56.66}
[5 / 20] best test accuracy: 55.474 at epoch 3 
 best_stats: {'best_test_epoch': 3, 'best_test_valid/acc': 58.333, 'best_test_valid/acc_unbiased': 54.835, 'best_test_valid/diff': 2.833, 'best_test_valid/acc_skew': 53.418, 'best_test_valid/acc_align': 56.251, 'best_test_test/acc': 59.145, 'best_test_test/acc_unbiased': 55.474, 'best_test_test/diff': 2.371, 'best_test_test/acc_skew': 54.289, 'best_test_test/acc_align': 56.66}
[6 / 20] Learning rate: 0.001 weight: 0.01
[6 / 20] Loss: 4.539666128890517 CE Loss: 0.4924801973446796 Con Loss: 4.53474133722526
[6 / 20] tensor([[0.893, 0.864],
        [0.446, 0.339]]) {'epoch': 6, 'valid/acc': 67.549, 'valid/acc_unbiased': 63.42, 'valid/diff': 6.634, 'valid/acc_skew': 62.644, 'valid/acc_align': 64.195, 'test/acc': 68.004, 'test/acc_unbiased': 63.572, 'test/diff': 6.842, 'test/acc_skew': 65.5, 'test/acc_align': 61.645}
[6 / 20] best valid accuracy: 63.420 at epoch 6 
 best_stats: {'best_valid_epoch': 6, 'best_valid_valid/acc': 67.549, 'best_valid_valid/acc_unbiased': 63.42, 'best_valid_valid/diff': 6.634, 'best_valid_valid/acc_skew': 62.644, 'best_valid_valid/acc_align': 64.195, 'best_valid_test/acc': 68.004, 'best_valid_test/acc_unbiased': 63.572, 'best_valid_test/diff': 6.842, 'best_valid_test/acc_skew': 65.5, 'best_valid_test/acc_align': 61.645}
[6 / 20] best test accuracy: 63.572 at epoch 6 
 best_stats: {'best_test_epoch': 6, 'best_test_valid/acc': 67.549, 'best_test_valid/acc_unbiased': 63.42, 'best_test_valid/diff': 6.634, 'best_test_valid/acc_skew': 62.644, 'best_test_valid/acc_align': 64.195, 'best_test_test/acc': 68.004, 'best_test_test/acc_unbiased': 63.572, 'best_test_test/diff': 6.842, 'best_test_test/acc_skew': 65.5, 'best_test_test/acc_align': 61.645}
[7 / 20] Learning rate: 0.0001 weight: 0.01
[7 / 20] Loss: 4.552993155293409 CE Loss: 0.4778272794543559 Con Loss: 4.548214870997022
[7 / 20] tensor([[0.933, 0.892],
        [0.390, 0.297]]) {'epoch': 7, 'valid/acc': 67.196, 'valid/acc_unbiased': 63.357, 'valid/diff': 4.775, 'valid/acc_skew': 63.737, 'valid/acc_align': 62.978, 'test/acc': 67.607, 'test/acc_unbiased': 62.799, 'test/diff': 6.696, 'test/acc_skew': 64.095, 'test/acc_align': 61.503}
[7 / 20] best valid accuracy: 63.420 at epoch 6 
 best_stats: {'best_valid_epoch': 6, 'best_valid_valid/acc': 67.549, 'best_valid_valid/acc_unbiased': 63.42, 'best_valid_valid/diff': 6.634, 'best_valid_valid/acc_skew': 62.644, 'best_valid_valid/acc_align': 64.195, 'best_valid_test/acc': 68.004, 'best_valid_test/acc_unbiased': 63.572, 'best_valid_test/diff': 6.842, 'best_valid_test/acc_skew': 65.5, 'best_valid_test/acc_align': 61.645}
[7 / 20] best test accuracy: 63.572 at epoch 6 
 best_stats: {'best_test_epoch': 6, 'best_test_valid/acc': 67.549, 'best_test_valid/acc_unbiased': 63.42, 'best_test_valid/diff': 6.634, 'best_test_valid/acc_skew': 62.644, 'best_test_valid/acc_align': 64.195, 'best_test_test/acc': 68.004, 'best_test_test/acc_unbiased': 63.572, 'best_test_test/diff': 6.842, 'best_test_test/acc_skew': 65.5, 'best_test_test/acc_align': 61.645}
[8 / 20] Learning rate: 0.0001 weight: 0.01
[8 / 20] Loss: 4.492898295854906 CE Loss: 0.4721397328403549 Con Loss: 4.488176915673271
[8 / 20] tensor([[0.959, 0.915],
        [0.378, 0.261]]) {'epoch': 8, 'valid/acc': 68.166, 'valid/acc_unbiased': 64.081, 'valid/diff': 5.269, 'valid/acc_skew': 63.224, 'valid/acc_align': 64.938, 'test/acc': 68.268, 'test/acc_unbiased': 62.806, 'test/diff': 8.073, 'test/acc_skew': 64.654, 'test/acc_align': 60.957}
[8 / 20] best valid accuracy: 64.081 at epoch 8 
 best_stats: {'best_valid_epoch': 8, 'best_valid_valid/acc': 68.166, 'best_valid_valid/acc_unbiased': 64.081, 'best_valid_valid/diff': 5.269, 'best_valid_valid/acc_skew': 63.224, 'best_valid_valid/acc_align': 64.938, 'best_valid_test/acc': 68.268, 'best_valid_test/acc_unbiased': 62.806, 'best_valid_test/diff': 8.073, 'best_valid_test/acc_skew': 64.654, 'best_valid_test/acc_align': 60.957}
[8 / 20] best test accuracy: 63.572 at epoch 6 
 best_stats: {'best_test_epoch': 6, 'best_test_valid/acc': 67.549, 'best_test_valid/acc_unbiased': 63.42, 'best_test_valid/diff': 6.634, 'best_test_valid/acc_skew': 62.644, 'best_test_valid/acc_align': 64.195, 'best_test_test/acc': 68.004, 'best_test_test/acc_unbiased': 63.572, 'best_test_test/diff': 6.842, 'best_test_test/acc_skew': 65.5, 'best_test_test/acc_align': 61.645}
[9 / 20] Learning rate: 0.0001 weight: 0.01
[9 / 20] Loss: 4.494050429403805 CE Loss: 0.46510151498373953 Con Loss: 4.489399401358744
[9 / 20] tensor([[0.965, 0.875],
        [0.336, 0.352]]) {'epoch': 9, 'valid/acc': 66.182, 'valid/acc_unbiased': 62.274, 'valid/diff': 9.173, 'valid/acc_skew': 57.687, 'valid/acc_align': 66.861, 'test/acc': 67.298, 'test/acc_unbiased': 63.182, 'test/diff': 5.3, 'test/acc_skew': 60.532, 'test/acc_align': 65.832}
[9 / 20] best valid accuracy: 64.081 at epoch 8 
 best_stats: {'best_valid_epoch': 8, 'best_valid_valid/acc': 68.166, 'best_valid_valid/acc_unbiased': 64.081, 'best_valid_valid/diff': 5.269, 'best_valid_valid/acc_skew': 63.224, 'best_valid_valid/acc_align': 64.938, 'best_valid_test/acc': 68.268, 'best_valid_test/acc_unbiased': 62.806, 'best_valid_test/diff': 8.073, 'best_valid_test/acc_skew': 64.654, 'best_valid_test/acc_align': 60.957}
[9 / 20] best test accuracy: 63.572 at epoch 6 
 best_stats: {'best_test_epoch': 6, 'best_test_valid/acc': 67.549, 'best_test_valid/acc_unbiased': 63.42, 'best_test_valid/diff': 6.634, 'best_test_valid/acc_skew': 62.644, 'best_test_valid/acc_align': 64.195, 'best_test_test/acc': 68.004, 'best_test_test/acc_unbiased': 63.572, 'best_test_test/diff': 6.842, 'best_test_test/acc_skew': 65.5, 'best_test_test/acc_align': 61.645}
[10 / 20] Learning rate: 0.0001 weight: 0.01
[10 / 20] Loss: 4.439853467552102 CE Loss: 0.45588177454824175 Con Loss: 4.435294652244028
[10 / 20] tensor([[0.966, 0.830],
        [0.354, 0.394]]) {'epoch': 10, 'valid/acc': 67.857, 'valid/acc_unbiased': 63.834, 'valid/diff': 10.896, 'valid/acc_skew': 58.386, 'valid/acc_align': 69.282, 'test/acc': 68.004, 'test/acc_unbiased': 63.591, 'test/diff': 8.818, 'test/acc_skew': 59.182, 'test/acc_align': 68.0}
[10 / 20] best valid accuracy: 64.081 at epoch 8 
 best_stats: {'best_valid_epoch': 8, 'best_valid_valid/acc': 68.166, 'best_valid_valid/acc_unbiased': 64.081, 'best_valid_valid/diff': 5.269, 'best_valid_valid/acc_skew': 63.224, 'best_valid_valid/acc_align': 64.938, 'best_valid_test/acc': 68.268, 'best_valid_test/acc_unbiased': 62.806, 'best_valid_test/diff': 8.073, 'best_valid_test/acc_skew': 64.654, 'best_valid_test/acc_align': 60.957}
[10 / 20] best test accuracy: 63.591 at epoch 10 
 best_stats: {'best_test_epoch': 10, 'best_test_valid/acc': 67.857, 'best_test_valid/acc_unbiased': 63.834, 'best_test_valid/diff': 10.896, 'best_test_valid/acc_skew': 58.386, 'best_test_valid/acc_align': 69.282, 'best_test_test/acc': 68.004, 'best_test_test/acc_unbiased': 63.591, 'best_test_test/diff': 8.818, 'best_test_test/acc_skew': 59.182, 'best_test_test/acc_align': 68.0}
[11 / 20] Learning rate: 0.0001 weight: 0.01
[11 / 20] Loss: 4.419508846722842 CE Loss: 0.4486957382325687 Con Loss: 4.415021882794494
[11 / 20] tensor([[0.958, 0.830],
        [0.422, 0.394]]) {'epoch': 11, 'valid/acc': 69.4, 'valid/acc_unbiased': 65.785, 'valid/diff': 9.887, 'valid/acc_skew': 60.842, 'valid/acc_align': 70.729, 'test/acc': 70.207, 'test/acc_unbiased': 65.08, 'test/diff': 7.812, 'test/acc_skew': 62.585, 'test/acc_align': 67.576}
[11 / 20] best valid accuracy: 65.785 at epoch 11 
 best_stats: {'best_valid_epoch': 11, 'best_valid_valid/acc': 69.4, 'best_valid_valid/acc_unbiased': 65.785, 'best_valid_valid/diff': 9.887, 'best_valid_valid/acc_skew': 60.842, 'best_valid_valid/acc_align': 70.729, 'best_valid_test/acc': 70.207, 'best_valid_test/acc_unbiased': 65.08, 'best_valid_test/diff': 7.812, 'best_valid_test/acc_skew': 62.585, 'best_valid_test/acc_align': 67.576}
[11 / 20] best test accuracy: 65.080 at epoch 11 
 best_stats: {'best_test_epoch': 11, 'best_test_valid/acc': 69.4, 'best_test_valid/acc_unbiased': 65.785, 'best_test_valid/diff': 9.887, 'best_test_valid/acc_skew': 60.842, 'best_test_valid/acc_align': 70.729, 'best_test_test/acc': 70.207, 'best_test_test/acc_unbiased': 65.08, 'best_test_test/diff': 7.812, 'best_test_test/acc_skew': 62.585, 'best_test_test/acc_align': 67.576}
[12 / 20] Learning rate: 0.0001 weight: 0.01
[12 / 20] Loss: 4.432156879327932 CE Loss: 0.44775551383480156 Con Loss: 4.427679303610918
[12 / 20] tensor([[0.952, 0.705],
        [0.435, 0.521]]) {'epoch': 12, 'valid/acc': 69.4, 'valid/acc_unbiased': 64.841, 'valid/diff': 18.21, 'valid/acc_skew': 55.736, 'valid/acc_align': 73.946, 'test/acc': 70.383, 'test/acc_unbiased': 65.313, 'test/diff': 16.688, 'test/acc_skew': 56.969, 'test/acc_align': 73.657}
[12 / 20] best valid accuracy: 65.785 at epoch 11 
 best_stats: {'best_valid_epoch': 11, 'best_valid_valid/acc': 69.4, 'best_valid_valid/acc_unbiased': 65.785, 'best_valid_valid/diff': 9.887, 'best_valid_valid/acc_skew': 60.842, 'best_valid_valid/acc_align': 70.729, 'best_valid_test/acc': 70.207, 'best_valid_test/acc_unbiased': 65.08, 'best_valid_test/diff': 7.812, 'best_valid_test/acc_skew': 62.585, 'best_valid_test/acc_align': 67.576}
[12 / 20] best test accuracy: 65.313 at epoch 12 
 best_stats: {'best_test_epoch': 12, 'best_test_valid/acc': 69.4, 'best_test_valid/acc_unbiased': 64.841, 'best_test_valid/diff': 18.21, 'best_test_valid/acc_skew': 55.736, 'best_test_valid/acc_align': 73.946, 'best_test_test/acc': 70.383, 'best_test_test/acc_unbiased': 65.313, 'best_test_test/diff': 16.688, 'best_test_test/acc_skew': 56.969, 'best_test_test/acc_align': 73.657}
[13 / 20] Learning rate: 0.0001 weight: 0.01
[13 / 20] Loss: 4.429556785742025 CE Loss: 0.4359626392776356 Con Loss: 4.425197148224871
[13 / 20] tensor([[0.960, 0.824],
        [0.389, 0.412]]) {'epoch': 13, 'valid/acc': 68.342, 'valid/acc_unbiased': 64.179, 'valid/diff': 10.314, 'valid/acc_skew': 59.021, 'valid/acc_align': 69.336, 'test/acc': 69.149, 'test/acc_unbiased': 64.627, 'test/diff': 7.999, 'test/acc_skew': 60.628, 'test/acc_align': 68.627}
[13 / 20] best valid accuracy: 65.785 at epoch 11 
 best_stats: {'best_valid_epoch': 11, 'best_valid_valid/acc': 69.4, 'best_valid_valid/acc_unbiased': 65.785, 'best_valid_valid/diff': 9.887, 'best_valid_valid/acc_skew': 60.842, 'best_valid_valid/acc_align': 70.729, 'best_valid_test/acc': 70.207, 'best_valid_test/acc_unbiased': 65.08, 'best_valid_test/diff': 7.812, 'best_valid_test/acc_skew': 62.585, 'best_valid_test/acc_align': 67.576}
[13 / 20] best test accuracy: 65.313 at epoch 12 
 best_stats: {'best_test_epoch': 12, 'best_test_valid/acc': 69.4, 'best_test_valid/acc_unbiased': 64.841, 'best_test_valid/diff': 18.21, 'best_test_valid/acc_skew': 55.736, 'best_test_valid/acc_align': 73.946, 'best_test_test/acc': 70.383, 'best_test_test/acc_unbiased': 65.313, 'best_test_test/diff': 16.688, 'best_test_test/acc_skew': 56.969, 'best_test_test/acc_align': 73.657}
[14 / 20] Learning rate: 1e-05 weight: 0.01
[14 / 20] Loss: 4.385495715175216 CE Loss: 0.44052185226986357 Con Loss: 4.3810905064147585
[14 / 20] tensor([[0.959, 0.801],
        [0.381, 0.424]]) {'epoch': 14, 'valid/acc': 68.607, 'valid/acc_unbiased': 64.138, 'valid/diff': 12.871, 'valid/acc_skew': 57.702, 'valid/acc_align': 70.573, 'test/acc': 68.665, 'test/acc_unbiased': 64.113, 'test/diff': 10.051, 'test/acc_skew': 59.088, 'test/acc_align': 69.139}
[14 / 20] best valid accuracy: 65.785 at epoch 11 
 best_stats: {'best_valid_epoch': 11, 'best_valid_valid/acc': 69.4, 'best_valid_valid/acc_unbiased': 65.785, 'best_valid_valid/diff': 9.887, 'best_valid_valid/acc_skew': 60.842, 'best_valid_valid/acc_align': 70.729, 'best_valid_test/acc': 70.207, 'best_valid_test/acc_unbiased': 65.08, 'best_valid_test/diff': 7.812, 'best_valid_test/acc_skew': 62.585, 'best_valid_test/acc_align': 67.576}
[14 / 20] best test accuracy: 65.313 at epoch 12 
 best_stats: {'best_test_epoch': 12, 'best_test_valid/acc': 69.4, 'best_test_valid/acc_unbiased': 64.841, 'best_test_valid/diff': 18.21, 'best_test_valid/acc_skew': 55.736, 'best_test_valid/acc_align': 73.946, 'best_test_test/acc': 70.383, 'best_test_test/acc_unbiased': 65.313, 'best_test_test/diff': 16.688, 'best_test_test/acc_skew': 56.969, 'best_test_test/acc_align': 73.657}
[15 / 20] Learning rate: 1e-05 weight: 0.01
[15 / 20] Loss: 4.368994859219133 CE Loss: 0.438746617533035 Con Loss: 4.364607376447111
[15 / 20] tensor([[0.959, 0.784],
        [0.388, 0.430]]) {'epoch': 15, 'valid/acc': 68.519, 'valid/acc_unbiased': 63.989, 'valid/diff': 12.179, 'valid/acc_skew': 57.899, 'valid/acc_align': 70.078, 'test/acc': 68.885, 'test/acc_unbiased': 64.035, 'test/diff': 10.907, 'test/acc_skew': 58.582, 'test/acc_align': 69.489}
[15 / 20] best valid accuracy: 65.785 at epoch 11 
 best_stats: {'best_valid_epoch': 11, 'best_valid_valid/acc': 69.4, 'best_valid_valid/acc_unbiased': 65.785, 'best_valid_valid/diff': 9.887, 'best_valid_valid/acc_skew': 60.842, 'best_valid_valid/acc_align': 70.729, 'best_valid_test/acc': 70.207, 'best_valid_test/acc_unbiased': 65.08, 'best_valid_test/diff': 7.812, 'best_valid_test/acc_skew': 62.585, 'best_valid_test/acc_align': 67.576}
[15 / 20] best test accuracy: 65.313 at epoch 12 
 best_stats: {'best_test_epoch': 12, 'best_test_valid/acc': 69.4, 'best_test_valid/acc_unbiased': 64.841, 'best_test_valid/diff': 18.21, 'best_test_valid/acc_skew': 55.736, 'best_test_valid/acc_align': 73.946, 'best_test_test/acc': 70.383, 'best_test_test/acc_unbiased': 65.313, 'best_test_test/diff': 16.688, 'best_test_test/acc_skew': 56.969, 'best_test_test/acc_align': 73.657}
[16 / 20] Learning rate: 1e-05 weight: 0.01
[16 / 20] Loss: 4.331377532856155 CE Loss: 0.43565092164673014 Con Loss: 4.32702103253832
[16 / 20] tensor([[0.956, 0.778],
        [0.411, 0.455]]) {'epoch': 16, 'valid/acc': 69.092, 'valid/acc_unbiased': 64.46, 'valid/diff': 14.809, 'valid/acc_skew': 57.055, 'valid/acc_align': 71.864, 'test/acc': 69.722, 'test/acc_unbiased': 64.982, 'test/diff': 11.061, 'test/acc_skew': 59.451, 'test/acc_align': 70.512}
[16 / 20] best valid accuracy: 65.785 at epoch 11 
 best_stats: {'best_valid_epoch': 11, 'best_valid_valid/acc': 69.4, 'best_valid_valid/acc_unbiased': 65.785, 'best_valid_valid/diff': 9.887, 'best_valid_valid/acc_skew': 60.842, 'best_valid_valid/acc_align': 70.729, 'best_valid_test/acc': 70.207, 'best_valid_test/acc_unbiased': 65.08, 'best_valid_test/diff': 7.812, 'best_valid_test/acc_skew': 62.585, 'best_valid_test/acc_align': 67.576}
[16 / 20] best test accuracy: 65.313 at epoch 12 
 best_stats: {'best_test_epoch': 12, 'best_test_valid/acc': 69.4, 'best_test_valid/acc_unbiased': 64.841, 'best_test_valid/diff': 18.21, 'best_test_valid/acc_skew': 55.736, 'best_test_valid/acc_align': 73.946, 'best_test_test/acc': 70.383, 'best_test_test/acc_unbiased': 65.313, 'best_test_test/diff': 16.688, 'best_test_test/acc_skew': 56.969, 'best_test_test/acc_align': 73.657}
[17 / 20] Learning rate: 1e-05 weight: 0.01
[17 / 20] Loss: 4.352272456078795 CE Loss: 0.436596691563798 Con Loss: 4.347906479715899
[17 / 20] tensor([[0.956, 0.750],
        [0.412, 0.473]]) {'epoch': 17, 'valid/acc': 69.444, 'valid/acc_unbiased': 64.961, 'valid/diff': 16.874, 'valid/acc_skew': 56.524, 'valid/acc_align': 73.398, 'test/acc': 69.678, 'test/acc_unbiased': 64.755, 'test/diff': 13.333, 'test/acc_skew': 58.088, 'test/acc_align': 71.421}
[17 / 20] best valid accuracy: 65.785 at epoch 11 
 best_stats: {'best_valid_epoch': 11, 'best_valid_valid/acc': 69.4, 'best_valid_valid/acc_unbiased': 65.785, 'best_valid_valid/diff': 9.887, 'best_valid_valid/acc_skew': 60.842, 'best_valid_valid/acc_align': 70.729, 'best_valid_test/acc': 70.207, 'best_valid_test/acc_unbiased': 65.08, 'best_valid_test/diff': 7.812, 'best_valid_test/acc_skew': 62.585, 'best_valid_test/acc_align': 67.576}
[17 / 20] best test accuracy: 65.313 at epoch 12 
 best_stats: {'best_test_epoch': 12, 'best_test_valid/acc': 69.4, 'best_test_valid/acc_unbiased': 64.841, 'best_test_valid/diff': 18.21, 'best_test_valid/acc_skew': 55.736, 'best_test_valid/acc_align': 73.946, 'best_test_test/acc': 70.383, 'best_test_test/acc_unbiased': 65.313, 'best_test_test/diff': 16.688, 'best_test_test/acc_skew': 56.969, 'best_test_test/acc_align': 73.657}
[18 / 20] Learning rate: 1e-05 weight: 0.01
[18 / 20] Loss: 4.366860772643094 CE Loss: 0.4332289090543952 Con Loss: 4.3625284449878325
[18 / 20] tensor([[0.963, 0.778],
        [0.382, 0.448]]) {'epoch': 18, 'valid/acc': 68.651, 'valid/acc_unbiased': 64.304, 'valid/diff': 15.694, 'valid/acc_skew': 56.457, 'valid/acc_align': 72.151, 'test/acc': 68.929, 'test/acc_unbiased': 64.298, 'test/diff': 12.577, 'test/acc_skew': 58.009, 'test/acc_align': 70.586}
[18 / 20] best valid accuracy: 65.785 at epoch 11 
 best_stats: {'best_valid_epoch': 11, 'best_valid_valid/acc': 69.4, 'best_valid_valid/acc_unbiased': 65.785, 'best_valid_valid/diff': 9.887, 'best_valid_valid/acc_skew': 60.842, 'best_valid_valid/acc_align': 70.729, 'best_valid_test/acc': 70.207, 'best_valid_test/acc_unbiased': 65.08, 'best_valid_test/diff': 7.812, 'best_valid_test/acc_skew': 62.585, 'best_valid_test/acc_align': 67.576}
[18 / 20] best test accuracy: 65.313 at epoch 12 
 best_stats: {'best_test_epoch': 12, 'best_test_valid/acc': 69.4, 'best_test_valid/acc_unbiased': 64.841, 'best_test_valid/diff': 18.21, 'best_test_valid/acc_skew': 55.736, 'best_test_valid/acc_align': 73.946, 'best_test_test/acc': 70.383, 'best_test_test/acc_unbiased': 65.313, 'best_test_test/diff': 16.688, 'best_test_test/acc_skew': 56.969, 'best_test_test/acc_align': 73.657}
[19 / 20] Learning rate: 1e-05 weight: 0.01
[19 / 20] Loss: 4.3656135032079675 CE Loss: 0.4342505429979122 Con Loss: 4.361270998444552
[19 / 20] tensor([[0.952, 0.744],
        [0.441, 0.509]]) {'epoch': 19, 'valid/acc': 69.356, 'valid/acc_unbiased': 64.303, 'valid/diff': 19.579, 'valid/acc_skew': 54.514, 'valid/acc_align': 74.092, 'test/acc': 70.824, 'test/acc_unbiased': 66.149, 'test/diff': 13.805, 'test/acc_skew': 59.246, 'test/acc_align': 73.051}
[19 / 20] best valid accuracy: 65.785 at epoch 11 
 best_stats: {'best_valid_epoch': 11, 'best_valid_valid/acc': 69.4, 'best_valid_valid/acc_unbiased': 65.785, 'best_valid_valid/diff': 9.887, 'best_valid_valid/acc_skew': 60.842, 'best_valid_valid/acc_align': 70.729, 'best_valid_test/acc': 70.207, 'best_valid_test/acc_unbiased': 65.08, 'best_valid_test/diff': 7.812, 'best_valid_test/acc_skew': 62.585, 'best_valid_test/acc_align': 67.576}
[19 / 20] best test accuracy: 66.149 at epoch 19 
 best_stats: {'best_test_epoch': 19, 'best_test_valid/acc': 69.356, 'best_test_valid/acc_unbiased': 64.303, 'best_test_valid/diff': 19.579, 'best_test_valid/acc_skew': 54.514, 'best_test_valid/acc_align': 74.092, 'best_test_test/acc': 70.824, 'best_test_test/acc_unbiased': 66.149, 'best_test_test/diff': 13.805, 'best_test_test/acc_skew': 59.246, 'best_test_test/acc_align': 73.051}
[20 / 20] Learning rate: 1e-05 weight: 0.01
[20 / 20] Loss: 4.3834142322533145 CE Loss: 0.42539739345441996 Con Loss: 4.379160258351351
[20 / 20] tensor([[0.956, 0.756],
        [0.414, 0.485]]) {'epoch': 20, 'valid/acc': 69.665, 'valid/acc_unbiased': 65.018, 'valid/diff': 14.974, 'valid/acc_skew': 57.531, 'valid/acc_align': 72.505, 'test/acc': 69.899, 'test/acc_unbiased': 65.258, 'test/diff': 13.54, 'test/acc_skew': 58.488, 'test/acc_align': 72.028}
[20 / 20] best valid accuracy: 65.785 at epoch 11 
 best_stats: {'best_valid_epoch': 11, 'best_valid_valid/acc': 69.4, 'best_valid_valid/acc_unbiased': 65.785, 'best_valid_valid/diff': 9.887, 'best_valid_valid/acc_skew': 60.842, 'best_valid_valid/acc_align': 70.729, 'best_valid_test/acc': 70.207, 'best_valid_test/acc_unbiased': 65.08, 'best_valid_test/diff': 7.812, 'best_valid_test/acc_skew': 62.585, 'best_valid_test/acc_align': 67.576}
[20 / 20] best test accuracy: 66.149 at epoch 19 
 best_stats: {'best_test_epoch': 19, 'best_test_valid/acc': 69.356, 'best_test_valid/acc_unbiased': 64.303, 'best_test_valid/diff': 19.579, 'best_test_valid/acc_skew': 54.514, 'best_test_valid/acc_align': 74.092, 'best_test_test/acc': 70.824, 'best_test_test/acc_unbiased': 66.149, 'best_test_test/diff': 13.805, 'best_test_test/acc_skew': 59.246, 'best_test_test/acc_align': 73.051}
Total training time: 0:16:03
