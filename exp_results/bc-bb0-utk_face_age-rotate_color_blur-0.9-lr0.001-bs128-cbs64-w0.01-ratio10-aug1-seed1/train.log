Log level set to: INFO
Set seed: 1
=======> Using Fixed Random Seed: 1 <========
save_path: exp_results/bc-bb0-utk_face_age-rotate_color_blur-0.9-lr0.001-bs128-cbs64-w0.01-ratio10-aug1-seed1
get_utk_face - split: train, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_age-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
Binary Target 1
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Normal Label Distribution: 
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
Binary Target 1
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Normal Label Distribution: 
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 10684, target_attr: gender, bias_attr: age bias_rate: 0.9
['[train] target_0-bias_0: 8237', '[train] target_0-bias_1: 147', '[train] target_1-bias_0: 823', '[train] target_1-bias_1: 1477']
confusion_matrix - 
 original: tensor([[8237.,  823.],
        [ 147., 1477.]]), 
 normalized: tensor([[0.909, 0.091],
        [0.091, 0.909]]), 
 b|y: tensor([[0.982, 0.018],
        [0.358, 0.642]])
get_utk_face - split: train, aug: 1, given_y: True, ratio: 10
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_age-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
Binary Target 1
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Normal Label Distribution: 
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
Binary Target 1
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Normal Label Distribution: 
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 10684, target_attr: gender, bias_attr: age bias_rate: 0.9
['[train] target_0-bias_0: 8237', '[train] target_0-bias_1: 147', '[train] target_1-bias_0: 823', '[train] target_1-bias_1: 1477']
get_utk_face - split: valid, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_age-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [1030, 195]
Target 1: [841, 202]
Binary Target 1
---------------------------
Target 0: [1030, 195]
Target 1: [841, 202]
===================================
Normal Label Distribution: 
Target 0: [1030, 195]
Target 1: [841, 202]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 2268, target_attr: gender, bias_attr: age bias_rate: 0.9
['[valid] target_0-bias_0: 1030', '[valid] target_0-bias_1: 195', '[valid] target_1-bias_0: 841', '[valid] target_1-bias_1: 202']
get_utk_face - split: test, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_age-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [1061, 176]
Target 1: [867, 165]
Binary Target 1
---------------------------
Target 0: [1061, 176]
Target 1: [867, 165]
===================================
Normal Label Distribution: 
Target 0: [1061, 176]
Target 1: [867, 165]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 2269, target_attr: gender, bias_attr: age bias_rate: 0.9
['[test] target_0-bias_0: 1061', '[test] target_0-bias_1: 176', '[test] target_1-bias_0: 867', '[test] target_1-bias_1: 165']
decay_epochs: [6, 13]
[1 / 20] Learning rate: 0.001 weight: 0.01
[1 / 20] Loss: 4.882094877393716 CE Loss: 0.553268305776004 Con Loss: 4.876562188154568
[1 / 20] tensor([[0.998, 1.000],
        [0.000, 0.000]]) {'epoch': 1, 'valid/acc': 54.012, 'valid/acc_unbiased': 49.902, 'valid/diff': 0.316, 'valid/acc_skew': 49.803, 'valid/acc_align': 50.0, 'test/acc': 54.429, 'test/acc_unbiased': 49.953, 'test/diff': 0.094, 'test/acc_skew': 50.0, 'test/acc_align': 49.906}
[1 / 20] best valid accuracy: 49.902 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 54.012, 'best_valid_valid/acc_unbiased': 49.902, 'best_valid_valid/diff': 0.316, 'best_valid_valid/acc_skew': 49.803, 'best_valid_valid/acc_align': 50.0, 'best_valid_test/acc': 54.429, 'best_valid_test/acc_unbiased': 49.953, 'best_valid_test/diff': 0.094, 'best_valid_test/acc_skew': 50.0, 'best_valid_test/acc_align': 49.906}
[1 / 20] best test accuracy: 49.953 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 54.012, 'best_test_valid/acc_unbiased': 49.902, 'best_test_valid/diff': 0.316, 'best_test_valid/acc_skew': 49.803, 'best_test_valid/acc_align': 50.0, 'best_test_test/acc': 54.429, 'best_test_test/acc_unbiased': 49.953, 'best_test_test/diff': 0.094, 'best_test_test/acc_skew': 50.0, 'best_test_test/acc_align': 49.906}
[2 / 20] Learning rate: 0.001 weight: 0.01
[2 / 20] Loss: 4.742244210237869 CE Loss: 0.5338589293775555 Con Loss: 4.736905598542254
[2 / 20] tensor([[1., 1.],
        [0., 0.]]) {'epoch': 2, 'valid/acc': 54.012, 'valid/acc_unbiased': 50.0, 'valid/diff': 0.0, 'valid/acc_skew': 50.0, 'valid/acc_align': 50.0, 'test/acc': 54.517, 'test/acc_unbiased': 50.0, 'test/diff': 0.0, 'test/acc_skew': 50.0, 'test/acc_align': 50.0}
[2 / 20] best valid accuracy: 50.000 at epoch 2 
 best_stats: {'best_valid_epoch': 2, 'best_valid_valid/acc': 54.012, 'best_valid_valid/acc_unbiased': 50.0, 'best_valid_valid/diff': 0.0, 'best_valid_valid/acc_skew': 50.0, 'best_valid_valid/acc_align': 50.0, 'best_valid_test/acc': 54.517, 'best_valid_test/acc_unbiased': 50.0, 'best_valid_test/diff': 0.0, 'best_valid_test/acc_skew': 50.0, 'best_valid_test/acc_align': 50.0}
[2 / 20] best test accuracy: 50.000 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 54.012, 'best_test_valid/acc_unbiased': 50.0, 'best_test_valid/diff': 0.0, 'best_test_valid/acc_skew': 50.0, 'best_test_valid/acc_align': 50.0, 'best_test_test/acc': 54.517, 'best_test_test/acc_unbiased': 50.0, 'best_test_test/diff': 0.0, 'best_test_test/acc_skew': 50.0, 'best_test_test/acc_align': 50.0}
[3 / 20] Learning rate: 0.001 weight: 0.01
[3 / 20] Loss: 4.647115182358868 CE Loss: 0.5306678171106065 Con Loss: 4.641808530535425
[3 / 20] tensor([[0.998, 1.000],
        [0.002, 0.000]]) {'epoch': 3, 'valid/acc': 54.145, 'valid/acc_unbiased': 50.189, 'valid/diff': 0.118, 'valid/acc_skew': 50.178, 'valid/acc_align': 50.199, 'test/acc': 54.517, 'test/acc_unbiased': 50.011, 'test/diff': 0.21, 'test/acc_skew': 50.115, 'test/acc_align': 49.906}
[3 / 20] best valid accuracy: 50.189 at epoch 3 
 best_stats: {'best_valid_epoch': 3, 'best_valid_valid/acc': 54.145, 'best_valid_valid/acc_unbiased': 50.189, 'best_valid_valid/diff': 0.118, 'best_valid_valid/acc_skew': 50.178, 'best_valid_valid/acc_align': 50.199, 'best_valid_test/acc': 54.517, 'best_valid_test/acc_unbiased': 50.011, 'best_valid_test/diff': 0.21, 'best_valid_test/acc_skew': 50.115, 'best_valid_test/acc_align': 49.906}
[3 / 20] best test accuracy: 50.011 at epoch 3 
 best_stats: {'best_test_epoch': 3, 'best_test_valid/acc': 54.145, 'best_test_valid/acc_unbiased': 50.189, 'best_test_valid/diff': 0.118, 'best_test_valid/acc_skew': 50.178, 'best_test_valid/acc_align': 50.199, 'best_test_test/acc': 54.517, 'best_test_test/acc_unbiased': 50.011, 'best_test_test/diff': 0.21, 'best_test_test/acc_skew': 50.115, 'best_test_test/acc_align': 49.906}
[4 / 20] Learning rate: 0.001 weight: 0.01
[4 / 20] Loss: 4.666873376675644 CE Loss: 0.529900691630643 Con Loss: 4.661574398699168
[4 / 20] tensor([[1.000, 1.000],
        [0.002, 0.006]]) {'epoch': 4, 'valid/acc': 54.056, 'valid/acc_unbiased': 50.03, 'valid/diff': 0.059, 'valid/acc_skew': 50.059, 'valid/acc_align': 50.0, 'test/acc': 54.65, 'test/acc_unbiased': 50.209, 'test/diff': 0.188, 'test/acc_skew': 50.115, 'test/acc_align': 50.303}
[4 / 20] best valid accuracy: 50.189 at epoch 3 
 best_stats: {'best_valid_epoch': 3, 'best_valid_valid/acc': 54.145, 'best_valid_valid/acc_unbiased': 50.189, 'best_valid_valid/diff': 0.118, 'best_valid_valid/acc_skew': 50.178, 'best_valid_valid/acc_align': 50.199, 'best_valid_test/acc': 54.517, 'best_valid_test/acc_unbiased': 50.011, 'best_valid_test/diff': 0.21, 'best_valid_test/acc_skew': 50.115, 'best_valid_test/acc_align': 49.906}
[4 / 20] best test accuracy: 50.209 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 54.056, 'best_test_valid/acc_unbiased': 50.03, 'best_test_valid/diff': 0.059, 'best_test_valid/acc_skew': 50.059, 'best_test_valid/acc_align': 50.0, 'best_test_test/acc': 54.65, 'best_test_test/acc_unbiased': 50.209, 'best_test_test/diff': 0.188, 'best_test_test/acc_skew': 50.115, 'best_test_test/acc_align': 50.303}
[5 / 20] Learning rate: 0.001 weight: 0.01
[5 / 20] Loss: 4.667981786881436 CE Loss: 0.5396089400748821 Con Loss: 4.6625856997948025
[5 / 20] tensor([[0.999, 1.000],
        [0.001, 0.000]]) {'epoch': 5, 'valid/acc': 54.101, 'valid/acc_unbiased': 50.164, 'valid/diff': 0.166, 'valid/acc_skew': 50.178, 'valid/acc_align': 50.15, 'test/acc': 54.517, 'test/acc_unbiased': 50.005, 'test/diff': 0.105, 'test/acc_skew': 50.058, 'test/acc_align': 49.953}
[5 / 20] best valid accuracy: 50.189 at epoch 3 
 best_stats: {'best_valid_epoch': 3, 'best_valid_valid/acc': 54.145, 'best_valid_valid/acc_unbiased': 50.189, 'best_valid_valid/diff': 0.118, 'best_valid_valid/acc_skew': 50.178, 'best_valid_valid/acc_align': 50.199, 'best_valid_test/acc': 54.517, 'best_valid_test/acc_unbiased': 50.011, 'best_valid_test/diff': 0.21, 'best_valid_test/acc_skew': 50.115, 'best_valid_test/acc_align': 49.906}
[5 / 20] best test accuracy: 50.209 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 54.056, 'best_test_valid/acc_unbiased': 50.03, 'best_test_valid/diff': 0.059, 'best_test_valid/acc_skew': 50.059, 'best_test_valid/acc_align': 50.0, 'best_test_test/acc': 54.65, 'best_test_test/acc_unbiased': 50.209, 'best_test_test/diff': 0.188, 'best_test_test/acc_skew': 50.115, 'best_test_test/acc_align': 50.303}
[6 / 20] Learning rate: 0.001 weight: 0.01
[6 / 20] Loss: 4.5934526837305025 CE Loss: 0.5167236521265471 Con Loss: 4.58828542510118
[6 / 20] tensor([[0.978, 0.949],
        [0.211, 0.085]]) {'epoch': 6, 'valid/acc': 59.921, 'valid/acc_unbiased': 55.241, 'valid/diff': 4.701, 'valid/acc_skew': 56.789, 'valid/acc_align': 53.693, 'test/acc': 61.789, 'test/acc_unbiased': 55.578, 'test/diff': 7.784, 'test/acc_skew': 57.997, 'test/acc_align': 53.159}
[6 / 20] best valid accuracy: 55.241 at epoch 6 
 best_stats: {'best_valid_epoch': 6, 'best_valid_valid/acc': 59.921, 'best_valid_valid/acc_unbiased': 55.241, 'best_valid_valid/diff': 4.701, 'best_valid_valid/acc_skew': 56.789, 'best_valid_valid/acc_align': 53.693, 'best_valid_test/acc': 61.789, 'best_valid_test/acc_unbiased': 55.578, 'best_valid_test/diff': 7.784, 'best_valid_test/acc_skew': 57.997, 'best_valid_test/acc_align': 53.159}
[6 / 20] best test accuracy: 55.578 at epoch 6 
 best_stats: {'best_test_epoch': 6, 'best_test_valid/acc': 59.921, 'best_test_valid/acc_unbiased': 55.241, 'best_test_valid/diff': 4.701, 'best_test_valid/acc_skew': 56.789, 'best_test_valid/acc_align': 53.693, 'best_test_test/acc': 61.789, 'best_test_test/acc_unbiased': 55.578, 'best_test_test/diff': 7.784, 'best_test_test/acc_skew': 57.997, 'best_test_test/acc_align': 53.159}
[7 / 20] Learning rate: 0.0001 weight: 0.01
[7 / 20] Loss: 4.583562555852252 CE Loss: 0.501053429796918 Con Loss: 4.578552044718866
[7 / 20] tensor([[0.960, 0.858],
        [0.341, 0.224]]) {'epoch': 7, 'valid/acc': 64.198, 'valid/acc_unbiased': 58.373, 'valid/diff': 9.854, 'valid/acc_skew': 57.647, 'valid/acc_align': 59.1, 'test/acc': 66.241, 'test/acc_unbiased': 59.6, 'test/diff': 10.981, 'test/acc_skew': 59.968, 'test/acc_align': 59.233}
[7 / 20] best valid accuracy: 58.373 at epoch 7 
 best_stats: {'best_valid_epoch': 7, 'best_valid_valid/acc': 64.198, 'best_valid_valid/acc_unbiased': 58.373, 'best_valid_valid/diff': 9.854, 'best_valid_valid/acc_skew': 57.647, 'best_valid_valid/acc_align': 59.1, 'best_valid_test/acc': 66.241, 'best_valid_test/acc_unbiased': 59.6, 'best_valid_test/diff': 10.981, 'best_valid_test/acc_skew': 59.968, 'best_valid_test/acc_align': 59.233}
[7 / 20] best test accuracy: 59.600 at epoch 7 
 best_stats: {'best_test_epoch': 7, 'best_test_valid/acc': 64.198, 'best_test_valid/acc_unbiased': 58.373, 'best_test_valid/diff': 9.854, 'best_test_valid/acc_skew': 57.647, 'best_test_valid/acc_align': 59.1, 'best_test_test/acc': 66.241, 'best_test_test/acc_unbiased': 59.6, 'best_test_test/diff': 10.981, 'best_test_test/acc_skew': 59.968, 'best_test_test/acc_align': 59.233}
[8 / 20] Learning rate: 0.0001 weight: 0.01
[8 / 20] Loss: 4.503617103159629 CE Loss: 0.49138584024492876 Con Loss: 4.498703266966436
[8 / 20] tensor([[0.971, 0.852],
        [0.311, 0.236]]) {'epoch': 8, 'valid/acc': 64.286, 'valid/acc_unbiased': 59.203, 'valid/diff': 6.969, 'valid/acc_skew': 57.442, 'valid/acc_align': 60.964, 'test/acc': 65.624, 'test/acc_unbiased': 59.271, 'test/diff': 9.678, 'test/acc_skew': 58.185, 'test/acc_align': 60.357}
[8 / 20] best valid accuracy: 59.203 at epoch 8 
 best_stats: {'best_valid_epoch': 8, 'best_valid_valid/acc': 64.286, 'best_valid_valid/acc_unbiased': 59.203, 'best_valid_valid/diff': 6.969, 'best_valid_valid/acc_skew': 57.442, 'best_valid_valid/acc_align': 60.964, 'best_valid_test/acc': 65.624, 'best_valid_test/acc_unbiased': 59.271, 'best_valid_test/diff': 9.678, 'best_valid_test/acc_skew': 58.185, 'best_valid_test/acc_align': 60.357}
[8 / 20] best test accuracy: 59.600 at epoch 7 
 best_stats: {'best_test_epoch': 7, 'best_test_valid/acc': 64.198, 'best_test_valid/acc_unbiased': 58.373, 'best_test_valid/diff': 9.854, 'best_test_valid/acc_skew': 57.647, 'best_test_valid/acc_align': 59.1, 'best_test_test/acc': 66.241, 'best_test_test/acc_unbiased': 59.6, 'best_test_test/diff': 10.981, 'best_test_test/acc_skew': 59.968, 'best_test_test/acc_align': 59.233}
[9 / 20] Learning rate: 0.0001 weight: 0.01
[9 / 20] Loss: 4.502516915940114 CE Loss: 0.47379598693203184 Con Loss: 4.497778931970857
[9 / 20] tensor([[0.972, 0.784],
        [0.313, 0.315]]) {'epoch': 9, 'valid/acc': 64.065, 'valid/acc_unbiased': 58.885, 'valid/diff': 12.079, 'valid/acc_skew': 52.846, 'valid/acc_align': 64.924, 'test/acc': 65.756, 'test/acc_unbiased': 59.588, 'test/diff': 9.511, 'test/acc_skew': 54.833, 'test/acc_align': 64.344}
[9 / 20] best valid accuracy: 59.203 at epoch 8 
 best_stats: {'best_valid_epoch': 8, 'best_valid_valid/acc': 64.286, 'best_valid_valid/acc_unbiased': 59.203, 'best_valid_valid/diff': 6.969, 'best_valid_valid/acc_skew': 57.442, 'best_valid_valid/acc_align': 60.964, 'best_valid_test/acc': 65.624, 'best_valid_test/acc_unbiased': 59.271, 'best_valid_test/diff': 9.678, 'best_valid_test/acc_skew': 58.185, 'best_valid_test/acc_align': 60.357}
[9 / 20] best test accuracy: 59.600 at epoch 7 
 best_stats: {'best_test_epoch': 7, 'best_test_valid/acc': 64.198, 'best_test_valid/acc_unbiased': 58.373, 'best_test_valid/diff': 9.854, 'best_test_valid/acc_skew': 57.647, 'best_test_valid/acc_align': 59.1, 'best_test_test/acc': 66.241, 'best_test_test/acc_unbiased': 59.6, 'best_test_test/diff': 10.981, 'best_test_test/acc_skew': 59.968, 'best_test_test/acc_align': 59.233}
[10 / 20] Learning rate: 0.0001 weight: 0.01
[10 / 20] Loss: 4.446755576696078 CE Loss: 0.46862141666944357 Con Loss: 4.44206936606661
[10 / 20] tensor([[0.958, 0.688],
        [0.414, 0.461]]) {'epoch': 10, 'valid/acc': 66.843, 'valid/acc_unbiased': 60.793, 'valid/diff': 13.048, 'valid/acc_skew': 54.268, 'valid/acc_align': 67.317, 'test/acc': 69.282, 'test/acc_unbiased': 62.994, 'test/diff': 15.831, 'test/acc_skew': 55.079, 'test/acc_align': 70.91}
[10 / 20] best valid accuracy: 60.793 at epoch 10 
 best_stats: {'best_valid_epoch': 10, 'best_valid_valid/acc': 66.843, 'best_valid_valid/acc_unbiased': 60.793, 'best_valid_valid/diff': 13.048, 'best_valid_valid/acc_skew': 54.268, 'best_valid_valid/acc_align': 67.317, 'best_valid_test/acc': 69.282, 'best_valid_test/acc_unbiased': 62.994, 'best_valid_test/diff': 15.831, 'best_valid_test/acc_skew': 55.079, 'best_valid_test/acc_align': 70.91}
[10 / 20] best test accuracy: 62.994 at epoch 10 
 best_stats: {'best_test_epoch': 10, 'best_test_valid/acc': 66.843, 'best_test_valid/acc_unbiased': 60.793, 'best_test_valid/diff': 13.048, 'best_test_valid/acc_skew': 54.268, 'best_test_valid/acc_align': 67.317, 'best_test_test/acc': 69.282, 'best_test_test/acc_unbiased': 62.994, 'best_test_test/diff': 15.831, 'best_test_test/acc_skew': 55.079, 'best_test_test/acc_align': 70.91}
[11 / 20] Learning rate: 0.0001 weight: 0.01
[11 / 20] Loss: 4.39675753467407 CE Loss: 0.46436233080446565 Con Loss: 4.392113888410985
[11 / 20] tensor([[0.978, 0.756],
        [0.321, 0.352]]) {'epoch': 11, 'valid/acc': 65.388, 'valid/acc_unbiased': 60.281, 'valid/diff': 9.49, 'valid/acc_skew': 55.536, 'valid/acc_align': 65.026, 'test/acc': 66.417, 'test/acc_unbiased': 60.154, 'test/diff': 12.675, 'test/acc_skew': 53.816, 'test/acc_align': 66.492}
[11 / 20] best valid accuracy: 60.793 at epoch 10 
 best_stats: {'best_valid_epoch': 10, 'best_valid_valid/acc': 66.843, 'best_valid_valid/acc_unbiased': 60.793, 'best_valid_valid/diff': 13.048, 'best_valid_valid/acc_skew': 54.268, 'best_valid_valid/acc_align': 67.317, 'best_valid_test/acc': 69.282, 'best_valid_test/acc_unbiased': 62.994, 'best_valid_test/diff': 15.831, 'best_valid_test/acc_skew': 55.079, 'best_valid_test/acc_align': 70.91}
[11 / 20] best test accuracy: 62.994 at epoch 10 
 best_stats: {'best_test_epoch': 10, 'best_test_valid/acc': 66.843, 'best_test_valid/acc_unbiased': 60.793, 'best_test_valid/diff': 13.048, 'best_test_valid/acc_skew': 54.268, 'best_test_valid/acc_align': 67.317, 'best_test_test/acc': 69.282, 'best_test_test/acc_unbiased': 62.994, 'best_test_test/diff': 15.831, 'best_test_test/acc_skew': 55.079, 'best_test_test/acc_align': 70.91}
[12 / 20] Learning rate: 0.0001 weight: 0.01
[12 / 20] Loss: 4.407811672577738 CE Loss: 0.45388916192854534 Con Loss: 4.40327278481401
[12 / 20] tensor([[0.977, 0.761],
        [0.300, 0.424]]) {'epoch': 12, 'valid/acc': 65.212, 'valid/acc_unbiased': 60.475, 'valid/diff': 15.527, 'valid/acc_skew': 52.712, 'valid/acc_align': 68.239, 'test/acc': 66.152, 'test/acc_unbiased': 61.572, 'test/diff': 17.019, 'test/acc_skew': 53.062, 'test/acc_align': 70.081}
[12 / 20] best valid accuracy: 60.793 at epoch 10 
 best_stats: {'best_valid_epoch': 10, 'best_valid_valid/acc': 66.843, 'best_valid_valid/acc_unbiased': 60.793, 'best_valid_valid/diff': 13.048, 'best_valid_valid/acc_skew': 54.268, 'best_valid_valid/acc_align': 67.317, 'best_valid_test/acc': 69.282, 'best_valid_test/acc_unbiased': 62.994, 'best_valid_test/diff': 15.831, 'best_valid_test/acc_skew': 55.079, 'best_valid_test/acc_align': 70.91}
[12 / 20] best test accuracy: 62.994 at epoch 10 
 best_stats: {'best_test_epoch': 10, 'best_test_valid/acc': 66.843, 'best_test_valid/acc_unbiased': 60.793, 'best_test_valid/diff': 13.048, 'best_test_valid/acc_skew': 54.268, 'best_test_valid/acc_align': 67.317, 'best_test_test/acc': 69.282, 'best_test_test/acc_unbiased': 62.994, 'best_test_test/diff': 15.831, 'best_test_test/acc_skew': 55.079, 'best_test_test/acc_align': 70.91}
[13 / 20] Learning rate: 0.0001 weight: 0.01
[13 / 20] Loss: 4.403583662467965 CE Loss: 0.44113629114668007 Con Loss: 4.399172270177501
[13 / 20] tensor([[0.966, 0.614],
        [0.360, 0.539]]) {'epoch': 13, 'valid/acc': 66.623, 'valid/acc_unbiased': 61.34, 'valid/diff': 20.661, 'valid/acc_skew': 51.009, 'valid/acc_align': 71.67, 'test/acc': 67.607, 'test/acc_unbiased': 61.974, 'test/diff': 26.598, 'test/acc_skew': 48.675, 'test/acc_align': 75.273}
[13 / 20] best valid accuracy: 61.340 at epoch 13 
 best_stats: {'best_valid_epoch': 13, 'best_valid_valid/acc': 66.623, 'best_valid_valid/acc_unbiased': 61.34, 'best_valid_valid/diff': 20.661, 'best_valid_valid/acc_skew': 51.009, 'best_valid_valid/acc_align': 71.67, 'best_valid_test/acc': 67.607, 'best_valid_test/acc_unbiased': 61.974, 'best_valid_test/diff': 26.598, 'best_valid_test/acc_skew': 48.675, 'best_valid_test/acc_align': 75.273}
[13 / 20] best test accuracy: 62.994 at epoch 10 
 best_stats: {'best_test_epoch': 10, 'best_test_valid/acc': 66.843, 'best_test_valid/acc_unbiased': 60.793, 'best_test_valid/diff': 13.048, 'best_test_valid/acc_skew': 54.268, 'best_test_valid/acc_align': 67.317, 'best_test_test/acc': 69.282, 'best_test_test/acc_unbiased': 62.994, 'best_test_test/diff': 15.831, 'best_test_test/acc_skew': 55.079, 'best_test_test/acc_align': 70.91}
[14 / 20] Learning rate: 1e-05 weight: 0.01
[14 / 20] Loss: 4.346204202659832 CE Loss: 0.43626990543907834 Con Loss: 4.341841503101893
[14 / 20] tensor([[0.970, 0.665],
        [0.362, 0.436]]) {'epoch': 14, 'valid/acc': 66.138, 'valid/acc_unbiased': 60.663, 'valid/diff': 17.063, 'valid/acc_skew': 52.132, 'valid/acc_align': 69.195, 'test/acc': 67.519, 'test/acc_unbiased': 60.829, 'test/diff': 18.963, 'test/acc_skew': 51.347, 'test/acc_align': 70.31}
[14 / 20] best valid accuracy: 61.340 at epoch 13 
 best_stats: {'best_valid_epoch': 13, 'best_valid_valid/acc': 66.623, 'best_valid_valid/acc_unbiased': 61.34, 'best_valid_valid/diff': 20.661, 'best_valid_valid/acc_skew': 51.009, 'best_valid_valid/acc_align': 71.67, 'best_valid_test/acc': 67.607, 'best_valid_test/acc_unbiased': 61.974, 'best_valid_test/diff': 26.598, 'best_valid_test/acc_skew': 48.675, 'best_valid_test/acc_align': 75.273}
[14 / 20] best test accuracy: 62.994 at epoch 10 
 best_stats: {'best_test_epoch': 10, 'best_test_valid/acc': 66.843, 'best_test_valid/acc_unbiased': 60.793, 'best_test_valid/diff': 13.048, 'best_test_valid/acc_skew': 54.268, 'best_test_valid/acc_align': 67.317, 'best_test_test/acc': 69.282, 'best_test_test/acc_unbiased': 62.994, 'best_test_test/diff': 15.831, 'best_test_test/acc_skew': 55.079, 'best_test_test/acc_align': 70.91}
[15 / 20] Learning rate: 1e-05 weight: 0.01
[15 / 20] Loss: 4.324978996242579 CE Loss: 0.43233720502439216 Con Loss: 4.32065558585278
[15 / 20] tensor([[0.964, 0.648],
        [0.392, 0.491]]) {'epoch': 15, 'valid/acc': 67.725, 'valid/acc_unbiased': 62.094, 'valid/diff': 16.871, 'valid/acc_skew': 53.659, 'valid/acc_align': 70.53, 'test/acc': 68.665, 'test/acc_unbiased': 62.374, 'test/diff': 20.76, 'test/acc_skew': 51.994, 'test/acc_align': 72.755}
[15 / 20] best valid accuracy: 62.094 at epoch 15 
 best_stats: {'best_valid_epoch': 15, 'best_valid_valid/acc': 67.725, 'best_valid_valid/acc_unbiased': 62.094, 'best_valid_valid/diff': 16.871, 'best_valid_valid/acc_skew': 53.659, 'best_valid_valid/acc_align': 70.53, 'best_valid_test/acc': 68.665, 'best_valid_test/acc_unbiased': 62.374, 'best_valid_test/diff': 20.76, 'best_valid_test/acc_skew': 51.994, 'best_valid_test/acc_align': 72.755}
[15 / 20] best test accuracy: 62.994 at epoch 10 
 best_stats: {'best_test_epoch': 10, 'best_test_valid/acc': 66.843, 'best_test_valid/acc_unbiased': 60.793, 'best_test_valid/diff': 13.048, 'best_test_valid/acc_skew': 54.268, 'best_test_valid/acc_align': 67.317, 'best_test_test/acc': 69.282, 'best_test_test/acc_unbiased': 62.994, 'best_test_test/diff': 15.831, 'best_test_test/acc_skew': 55.079, 'best_test_test/acc_align': 70.91}
[16 / 20] Learning rate: 1e-05 weight: 0.01
[16 / 20] Loss: 4.281942280791128 CE Loss: 0.429494159782214 Con Loss: 4.2776473658399965
[16 / 20] tensor([[0.965, 0.648],
        [0.412, 0.479]]) {'epoch': 16, 'valid/acc': 68.034, 'valid/acc_unbiased': 62.22, 'valid/diff': 16.327, 'valid/acc_skew': 54.057, 'valid/acc_align': 70.384, 'test/acc': 69.37, 'test/acc_unbiased': 62.585, 'test/diff': 19.221, 'test/acc_skew': 52.975, 'test/acc_align': 72.196}
[16 / 20] best valid accuracy: 62.220 at epoch 16 
 best_stats: {'best_valid_epoch': 16, 'best_valid_valid/acc': 68.034, 'best_valid_valid/acc_unbiased': 62.22, 'best_valid_valid/diff': 16.327, 'best_valid_valid/acc_skew': 54.057, 'best_valid_valid/acc_align': 70.384, 'best_valid_test/acc': 69.37, 'best_valid_test/acc_unbiased': 62.585, 'best_valid_test/diff': 19.221, 'best_valid_test/acc_skew': 52.975, 'best_valid_test/acc_align': 72.196}
[16 / 20] best test accuracy: 62.994 at epoch 10 
 best_stats: {'best_test_epoch': 10, 'best_test_valid/acc': 66.843, 'best_test_valid/acc_unbiased': 60.793, 'best_test_valid/diff': 13.048, 'best_test_valid/acc_skew': 54.268, 'best_test_valid/acc_align': 67.317, 'best_test_test/acc': 69.282, 'best_test_test/acc_unbiased': 62.994, 'best_test_test/diff': 15.831, 'best_test_test/acc_skew': 55.079, 'best_test_test/acc_align': 70.91}
[17 / 20] Learning rate: 1e-05 weight: 0.01
[17 / 20] Loss: 4.283835527290793 CE Loss: 0.4284404479845862 Con Loss: 4.279551096330284
[17 / 20] tensor([[0.965, 0.659],
        [0.385, 0.509]]) {'epoch': 17, 'valid/acc': 67.196, 'valid/acc_unbiased': 61.459, 'valid/diff': 17.851, 'valid/acc_skew': 52.533, 'valid/acc_align': 70.384, 'test/acc': 68.665, 'test/acc_unbiased': 62.964, 'test/diff': 21.495, 'test/acc_skew': 52.216, 'test/acc_align': 73.711}
[17 / 20] best valid accuracy: 62.220 at epoch 16 
 best_stats: {'best_valid_epoch': 16, 'best_valid_valid/acc': 68.034, 'best_valid_valid/acc_unbiased': 62.22, 'best_valid_valid/diff': 16.327, 'best_valid_valid/acc_skew': 54.057, 'best_valid_valid/acc_align': 70.384, 'best_valid_test/acc': 69.37, 'best_valid_test/acc_unbiased': 62.585, 'best_valid_test/diff': 19.221, 'best_valid_test/acc_skew': 52.975, 'best_valid_test/acc_align': 72.196}
[17 / 20] best test accuracy: 62.994 at epoch 10 
 best_stats: {'best_test_epoch': 10, 'best_test_valid/acc': 66.843, 'best_test_valid/acc_unbiased': 60.793, 'best_test_valid/diff': 13.048, 'best_test_valid/acc_skew': 54.268, 'best_test_valid/acc_align': 67.317, 'best_test_test/acc': 69.282, 'best_test_test/acc_unbiased': 62.994, 'best_test_test/diff': 15.831, 'best_test_test/acc_skew': 55.079, 'best_test_test/acc_align': 70.91}
[18 / 20] Learning rate: 1e-05 weight: 0.01
[18 / 20] Loss: 4.286146685051499 CE Loss: 0.42734419759495434 Con Loss: 4.281873227772486
[18 / 20] tensor([[0.966, 0.670],
        [0.374, 0.485]]) {'epoch': 18, 'valid/acc': 67.24, 'valid/acc_unbiased': 61.964, 'valid/diff': 17.131, 'valid/acc_skew': 53.399, 'valid/acc_align': 70.53, 'test/acc': 68.18, 'test/acc_unbiased': 62.377, 'test/diff': 20.338, 'test/acc_skew': 52.208, 'test/acc_align': 72.546}
[18 / 20] best valid accuracy: 62.220 at epoch 16 
 best_stats: {'best_valid_epoch': 16, 'best_valid_valid/acc': 68.034, 'best_valid_valid/acc_unbiased': 62.22, 'best_valid_valid/diff': 16.327, 'best_valid_valid/acc_skew': 54.057, 'best_valid_valid/acc_align': 70.384, 'best_valid_test/acc': 69.37, 'best_valid_test/acc_unbiased': 62.585, 'best_valid_test/diff': 19.221, 'best_valid_test/acc_skew': 52.975, 'best_valid_test/acc_align': 72.196}
[18 / 20] best test accuracy: 62.994 at epoch 10 
 best_stats: {'best_test_epoch': 10, 'best_test_valid/acc': 66.843, 'best_test_valid/acc_unbiased': 60.793, 'best_test_valid/diff': 13.048, 'best_test_valid/acc_skew': 54.268, 'best_test_valid/acc_align': 67.317, 'best_test_test/acc': 69.282, 'best_test_test/acc_unbiased': 62.994, 'best_test_test/diff': 15.831, 'best_test_test/acc_skew': 55.079, 'best_test_test/acc_align': 70.91}
[19 / 20] Learning rate: 1e-05 weight: 0.01
[19 / 20] Loss: 4.301154526375242 CE Loss: 0.42366858622814463 Con Loss: 4.296917824654131
[19 / 20] tensor([[0.961, 0.619],
        [0.409, 0.533]]) {'epoch': 19, 'valid/acc': 68.474, 'valid/acc_unbiased': 62.895, 'valid/diff': 17.357, 'valid/acc_skew': 54.216, 'valid/acc_align': 71.573, 'test/acc': 69.282, 'test/acc_unbiased': 63.087, 'test/diff': 23.296, 'test/acc_skew': 51.439, 'test/acc_align': 74.735}
[19 / 20] best valid accuracy: 62.895 at epoch 19 
 best_stats: {'best_valid_epoch': 19, 'best_valid_valid/acc': 68.474, 'best_valid_valid/acc_unbiased': 62.895, 'best_valid_valid/diff': 17.357, 'best_valid_valid/acc_skew': 54.216, 'best_valid_valid/acc_align': 71.573, 'best_valid_test/acc': 69.282, 'best_valid_test/acc_unbiased': 63.087, 'best_valid_test/diff': 23.296, 'best_valid_test/acc_skew': 51.439, 'best_valid_test/acc_align': 74.735}
[19 / 20] best test accuracy: 63.087 at epoch 19 
 best_stats: {'best_test_epoch': 19, 'best_test_valid/acc': 68.474, 'best_test_valid/acc_unbiased': 62.895, 'best_test_valid/diff': 17.357, 'best_test_valid/acc_skew': 54.216, 'best_test_valid/acc_align': 71.573, 'best_test_test/acc': 69.282, 'best_test_test/acc_unbiased': 63.087, 'best_test_test/diff': 23.296, 'best_test_test/acc_skew': 51.439, 'best_test_test/acc_align': 74.735}
[20 / 20] Learning rate: 1e-05 weight: 0.01
[20 / 20] Loss: 4.302891018238018 CE Loss: 0.43704127373877466 Con Loss: 4.298520591275962
[20 / 20] tensor([[0.964, 0.631],
        [0.403, 0.533]]) {'epoch': 20, 'valid/acc': 68.21, 'valid/acc_unbiased': 62.42, 'valid/diff': 17.908, 'valid/acc_skew': 53.466, 'valid/acc_align': 71.374, 'test/acc': 69.238, 'test/acc_unbiased': 63.268, 'test/diff': 23.215, 'test/acc_skew': 51.661, 'test/acc_align': 74.876}
[20 / 20] best valid accuracy: 62.895 at epoch 19 
 best_stats: {'best_valid_epoch': 19, 'best_valid_valid/acc': 68.474, 'best_valid_valid/acc_unbiased': 62.895, 'best_valid_valid/diff': 17.357, 'best_valid_valid/acc_skew': 54.216, 'best_valid_valid/acc_align': 71.573, 'best_valid_test/acc': 69.282, 'best_valid_test/acc_unbiased': 63.087, 'best_valid_test/diff': 23.296, 'best_valid_test/acc_skew': 51.439, 'best_valid_test/acc_align': 74.735}
[20 / 20] best test accuracy: 63.268 at epoch 20 
 best_stats: {'best_test_epoch': 20, 'best_test_valid/acc': 68.21, 'best_test_valid/acc_unbiased': 62.42, 'best_test_valid/diff': 17.908, 'best_test_valid/acc_skew': 53.466, 'best_test_valid/acc_align': 71.374, 'best_test_test/acc': 69.238, 'best_test_test/acc_unbiased': 63.268, 'best_test_test/diff': 23.215, 'best_test_test/acc_skew': 51.661, 'best_test_test/acc_align': 74.876}
Total training time: 0:17:42
