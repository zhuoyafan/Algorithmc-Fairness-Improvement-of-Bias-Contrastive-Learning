Log level set to: INFO
Set seed: 2
=======> Using Fixed Random Seed: 2 <========
save_path: exp_results/bc-bb0-celeba_smiling-os_0.1-lr0.001-bs128-cbs64-w0.01-ratio30-aug1-seed2
get_celeba - split:train, aug: False, given_y: True, ratio: 0
use existing smiling indices from data/celeba/pickles/smiling
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [4061, 4061]
Target 1: [4061, 4061]
Binary Target 1
---------------------------
Target 0: [4061, 4061]
Target 1: [4061, 4061]
===================================
Normal Label Distribution: 
Target 0: [4061, 4061]
Target 1: [4061, 4061]
===================================
Use BiasedCelebASplit 
 target_attr: smiling split: train 
 tensor([[4061., 4061.],
        [4061., 4061.]])
get_celeba - split:train, aug: 1, given_y: True, ratio: 30
use existing smiling indices from data/celeba/pickles/smiling
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [4076, 4076]
Target 1: [4076, 4076]
Binary Target 1
---------------------------
Target 0: [4076, 4076]
Target 1: [4076, 4076]
===================================
Normal Label Distribution: 
Target 0: [4076, 4076]
Target 1: [4076, 4076]
===================================
Use BiasedCelebASplit 
 target_attr: smiling split: train 
 tensor([[4076., 4076.],
        [4076., 4076.]])
get_celeba - split:train_valid, aug: False, given_y: True, ratio: 0
use existing smiling indices from data/celeba/pickles/smiling
Use BiasedCelebASplit 
 target_attr: smiling split: train_valid 
 tensor([[ 1973., 10114.],
        [ 8289.,  1989.]])
get_celeba - split:valid, aug: False, given_y: True, ratio: 0
Use BiasedCelebASplit 
 target_attr: smiling split: valid 
 tensor([[5252., 6157.],
        [5013., 3445.]])
decay_epochs: [3, 6]
[1 / 10] Learning rate: 0.001 weight: 0.01
[1 / 10] Loss: 4.711178285269513 CE Loss: 0.34137056314777897 Con Loss: 4.707764594550792
[1 / 10] tensor([[0.899, 0.908],
        [0.929, 0.880]]) {'epoch': 1, 'valid/acc': 91.281, 'valid/acc_unbiased': 90.203, 'valid/diff': 3.062, 'valid/acc_skew': 91.302, 'valid/acc_align': 89.104, 'test/acc': 90.733, 'test/acc_unbiased': 90.405, 'test/diff': 2.889, 'test/acc_skew': 91.422, 'test/acc_align': 89.388}
[1 / 10] best valid accuracy: 90.203 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 91.281, 'best_valid_valid/acc_unbiased': 90.203, 'best_valid_valid/diff': 3.062, 'best_valid_valid/acc_skew': 91.302, 'best_valid_valid/acc_align': 89.104, 'best_valid_test/acc': 90.733, 'best_valid_test/acc_unbiased': 90.405, 'best_valid_test/diff': 2.889, 'best_valid_test/acc_skew': 91.422, 'best_valid_test/acc_align': 89.388}
[1 / 10] best test accuracy: 90.405 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 91.281, 'best_test_valid/acc_unbiased': 90.203, 'best_test_valid/diff': 3.062, 'best_test_valid/acc_skew': 91.302, 'best_test_valid/acc_align': 89.104, 'best_test_test/acc': 90.733, 'best_test_test/acc_unbiased': 90.405, 'best_test_test/diff': 2.889, 'best_test_test/acc_skew': 91.422, 'best_test_test/acc_align': 89.388}
[2 / 10] Learning rate: 0.001 weight: 0.01
[2 / 10] Loss: 4.640766387912212 CE Loss: 0.26371211689025187 Con Loss: 4.638129262259604
[2 / 10] tensor([[0.901, 0.906],
        [0.928, 0.891]]) {'epoch': 2, 'valid/acc': 91.29, 'valid/acc_unbiased': 90.401, 'valid/diff': 2.471, 'valid/acc_skew': 91.636, 'valid/acc_align': 89.165, 'test/acc': 90.884, 'test/acc_unbiased': 90.644, 'test/diff': 2.085, 'test/acc_skew': 91.453, 'test/acc_align': 89.835}
[2 / 10] best valid accuracy: 90.401 at epoch 2 
 best_stats: {'best_valid_epoch': 2, 'best_valid_valid/acc': 91.29, 'best_valid_valid/acc_unbiased': 90.401, 'best_valid_valid/diff': 2.471, 'best_valid_valid/acc_skew': 91.636, 'best_valid_valid/acc_align': 89.165, 'best_valid_test/acc': 90.884, 'best_valid_test/acc_unbiased': 90.644, 'best_valid_test/diff': 2.085, 'best_valid_test/acc_skew': 91.453, 'best_valid_test/acc_align': 89.835}
[2 / 10] best test accuracy: 90.644 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 91.29, 'best_test_valid/acc_unbiased': 90.401, 'best_test_valid/diff': 2.471, 'best_test_valid/acc_skew': 91.636, 'best_test_valid/acc_align': 89.165, 'best_test_test/acc': 90.884, 'best_test_test/acc_unbiased': 90.644, 'best_test_test/diff': 2.085, 'best_test_test/acc_skew': 91.453, 'best_test_test/acc_align': 89.835}
[3 / 10] Learning rate: 0.001 weight: 0.01
[3 / 10] Loss: 4.6394650484651985 CE Loss: 0.2622385426009121 Con Loss: 4.636842652748031
[3 / 10] tensor([[0.868, 0.867],
        [0.949, 0.935]]) {'epoch': 3, 'valid/acc': 91.263, 'valid/acc_unbiased': 90.965, 'valid/diff': 1.181, 'valid/acc_skew': 91.555, 'valid/acc_align': 90.374, 'test/acc': 90.436, 'test/acc_unbiased': 90.466, 'test/diff': 0.76, 'test/acc_skew': 90.846, 'test/acc_align': 90.086}
[3 / 10] best valid accuracy: 90.965 at epoch 3 
 best_stats: {'best_valid_epoch': 3, 'best_valid_valid/acc': 91.263, 'best_valid_valid/acc_unbiased': 90.965, 'best_valid_valid/diff': 1.181, 'best_valid_valid/acc_skew': 91.555, 'best_valid_valid/acc_align': 90.374, 'best_valid_test/acc': 90.436, 'best_valid_test/acc_unbiased': 90.466, 'best_valid_test/diff': 0.76, 'best_valid_test/acc_skew': 90.846, 'best_valid_test/acc_align': 90.086}
[3 / 10] best test accuracy: 90.644 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 91.29, 'best_test_valid/acc_unbiased': 90.401, 'best_test_valid/diff': 2.471, 'best_test_valid/acc_skew': 91.636, 'best_test_valid/acc_align': 89.165, 'best_test_test/acc': 90.884, 'best_test_test/acc_unbiased': 90.644, 'best_test_test/diff': 2.085, 'best_test_test/acc_skew': 91.453, 'best_test_test/acc_align': 89.835}
[4 / 10] Learning rate: 0.0001 weight: 0.01
[4 / 10] Loss: 4.581335562668655 CE Loss: 0.2192259813963677 Con Loss: 4.579143284048772
[4 / 10] tensor([[0.909, 0.897],
        [0.934, 0.929]]) {'epoch': 4, 'valid/acc': 91.594, 'valid/acc_unbiased': 91.425, 'valid/diff': 1.76, 'valid/acc_skew': 92.305, 'valid/acc_align': 90.545, 'test/acc': 91.715, 'test/acc_unbiased': 91.722, 'test/diff': 0.829, 'test/acc_skew': 92.136, 'test/acc_align': 91.307}
[4 / 10] best valid accuracy: 91.425 at epoch 4 
 best_stats: {'best_valid_epoch': 4, 'best_valid_valid/acc': 91.594, 'best_valid_valid/acc_unbiased': 91.425, 'best_valid_valid/diff': 1.76, 'best_valid_valid/acc_skew': 92.305, 'best_valid_valid/acc_align': 90.545, 'best_valid_test/acc': 91.715, 'best_valid_test/acc_unbiased': 91.722, 'best_valid_test/diff': 0.829, 'best_valid_test/acc_skew': 92.136, 'best_valid_test/acc_align': 91.307}
[4 / 10] best test accuracy: 91.722 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 91.594, 'best_test_valid/acc_unbiased': 91.425, 'best_test_valid/diff': 1.76, 'best_test_valid/acc_skew': 92.305, 'best_test_valid/acc_align': 90.545, 'best_test_test/acc': 91.715, 'best_test_test/acc_unbiased': 91.722, 'best_test_test/diff': 0.829, 'best_test_test/acc_skew': 92.136, 'best_test_test/acc_align': 91.307}
[5 / 10] Learning rate: 0.0001 weight: 0.01
[5 / 10] Loss: 4.56410557881449 CE Loss: 0.21317769832885256 Con Loss: 4.561973788062506
[5 / 10] tensor([[0.947, 0.928],
        [0.908, 0.896]]) {'epoch': 5, 'valid/acc': 91.782, 'valid/acc_unbiased': 91.848, 'valid/diff': 1.751, 'valid/acc_skew': 92.724, 'valid/acc_align': 90.973, 'test/acc': 92.097, 'test/acc_unbiased': 91.942, 'test/diff': 1.575, 'test/acc_skew': 92.73, 'test/acc_align': 91.154}
[5 / 10] best valid accuracy: 91.848 at epoch 5 
 best_stats: {'best_valid_epoch': 5, 'best_valid_valid/acc': 91.782, 'best_valid_valid/acc_unbiased': 91.848, 'best_valid_valid/diff': 1.751, 'best_valid_valid/acc_skew': 92.724, 'best_valid_valid/acc_align': 90.973, 'best_valid_test/acc': 92.097, 'best_valid_test/acc_unbiased': 91.942, 'best_valid_test/diff': 1.575, 'best_valid_test/acc_skew': 92.73, 'best_valid_test/acc_align': 91.154}
[5 / 10] best test accuracy: 91.942 at epoch 5 
 best_stats: {'best_test_epoch': 5, 'best_test_valid/acc': 91.782, 'best_test_valid/acc_unbiased': 91.848, 'best_test_valid/diff': 1.751, 'best_test_valid/acc_skew': 92.724, 'best_test_valid/acc_align': 90.973, 'best_test_test/acc': 92.097, 'best_test_test/acc_unbiased': 91.942, 'best_test_test/diff': 1.575, 'best_test_test/acc_skew': 92.73, 'best_test_test/acc_align': 91.154}
[6 / 10] Learning rate: 0.0001 weight: 0.01
[6 / 10] Loss: 4.561186974109085 CE Loss: 0.20984485574806008 Con Loss: 4.559088545636983
[6 / 10] tensor([[0.949, 0.939],
        [0.910, 0.894]]) {'epoch': 6, 'valid/acc': 92.122, 'valid/acc_unbiased': 92.048, 'valid/diff': 1.97, 'valid/acc_skew': 93.033, 'valid/acc_align': 91.063, 'test/acc': 92.475, 'test/acc_unbiased': 92.29, 'test/diff': 1.289, 'test/acc_skew': 92.935, 'test/acc_align': 91.646}
[6 / 10] best valid accuracy: 92.048 at epoch 6 
 best_stats: {'best_valid_epoch': 6, 'best_valid_valid/acc': 92.122, 'best_valid_valid/acc_unbiased': 92.048, 'best_valid_valid/diff': 1.97, 'best_valid_valid/acc_skew': 93.033, 'best_valid_valid/acc_align': 91.063, 'best_valid_test/acc': 92.475, 'best_valid_test/acc_unbiased': 92.29, 'best_valid_test/diff': 1.289, 'best_valid_test/acc_skew': 92.935, 'best_valid_test/acc_align': 91.646}
[6 / 10] best test accuracy: 92.290 at epoch 6 
 best_stats: {'best_test_epoch': 6, 'best_test_valid/acc': 92.122, 'best_test_valid/acc_unbiased': 92.048, 'best_test_valid/diff': 1.97, 'best_test_valid/acc_skew': 93.033, 'best_test_valid/acc_align': 91.063, 'best_test_test/acc': 92.475, 'best_test_test/acc_unbiased': 92.29, 'best_test_test/diff': 1.289, 'best_test_test/acc_skew': 92.935, 'best_test_test/acc_align': 91.646}
[7 / 10] Learning rate: 1e-05 weight: 0.01
[7 / 10] Loss: 4.554529338950331 CE Loss: 0.201808315989596 Con Loss: 4.552511253958117
[7 / 10] tensor([[0.939, 0.920],
        [0.920, 0.911]]) {'epoch': 7, 'valid/acc': 92.153, 'valid/acc_unbiased': 92.081, 'valid/diff': 2.144, 'valid/acc_skew': 93.154, 'valid/acc_align': 91.009, 'test/acc': 92.349, 'test/acc_unbiased': 92.247, 'test/diff': 1.435, 'test/acc_skew': 92.965, 'test/acc_align': 91.53}
[7 / 10] best valid accuracy: 92.081 at epoch 7 
 best_stats: {'best_valid_epoch': 7, 'best_valid_valid/acc': 92.153, 'best_valid_valid/acc_unbiased': 92.081, 'best_valid_valid/diff': 2.144, 'best_valid_valid/acc_skew': 93.154, 'best_valid_valid/acc_align': 91.009, 'best_valid_test/acc': 92.349, 'best_valid_test/acc_unbiased': 92.247, 'best_valid_test/diff': 1.435, 'best_valid_test/acc_skew': 92.965, 'best_valid_test/acc_align': 91.53}
[7 / 10] best test accuracy: 92.290 at epoch 6 
 best_stats: {'best_test_epoch': 6, 'best_test_valid/acc': 92.122, 'best_test_valid/acc_unbiased': 92.048, 'best_test_valid/diff': 1.97, 'best_test_valid/acc_skew': 93.033, 'best_test_valid/acc_align': 91.063, 'best_test_test/acc': 92.475, 'best_test_test/acc_unbiased': 92.29, 'best_test_test/diff': 1.289, 'best_test_test/acc_skew': 92.935, 'best_test_test/acc_align': 91.646}
[8 / 10] Learning rate: 1e-05 weight: 0.01
[8 / 10] Loss: 4.54608128276901 CE Loss: 0.2039016625419446 Con Loss: 4.544042297373614
[8 / 10] tensor([[0.929, 0.913],
        [0.927, 0.921]]) {'epoch': 8, 'valid/acc': 92.421, 'valid/acc_unbiased': 92.367, 'valid/diff': 2.23, 'valid/acc_skew': 93.482, 'valid/acc_align': 91.253, 'test/acc': 92.279, 'test/acc_unbiased': 92.233, 'test/diff': 1.128, 'test/acc_skew': 92.797, 'test/acc_align': 91.669}
[8 / 10] best valid accuracy: 92.367 at epoch 8 
 best_stats: {'best_valid_epoch': 8, 'best_valid_valid/acc': 92.421, 'best_valid_valid/acc_unbiased': 92.367, 'best_valid_valid/diff': 2.23, 'best_valid_valid/acc_skew': 93.482, 'best_valid_valid/acc_align': 91.253, 'best_valid_test/acc': 92.279, 'best_valid_test/acc_unbiased': 92.233, 'best_valid_test/diff': 1.128, 'best_valid_test/acc_skew': 92.797, 'best_valid_test/acc_align': 91.669}
[8 / 10] best test accuracy: 92.290 at epoch 6 
 best_stats: {'best_test_epoch': 6, 'best_test_valid/acc': 92.122, 'best_test_valid/acc_unbiased': 92.048, 'best_test_valid/diff': 1.97, 'best_test_valid/acc_skew': 93.033, 'best_test_valid/acc_align': 91.063, 'best_test_test/acc': 92.475, 'best_test_test/acc_unbiased': 92.29, 'best_test_test/diff': 1.289, 'best_test_test/acc_skew': 92.935, 'best_test_test/acc_align': 91.646}
[9 / 10] Learning rate: 1e-05 weight: 0.01
[9 / 10] Loss: 4.5460739549055855 CE Loss: 0.20037512959326703 Con Loss: 4.544070203326013
[9 / 10] tensor([[0.940, 0.920],
        [0.923, 0.911]]) {'epoch': 9, 'valid/acc': 92.265, 'valid/acc_unbiased': 92.267, 'valid/diff': 2.166, 'valid/acc_skew': 93.35, 'valid/acc_align': 91.184, 'test/acc': 92.465, 'test/acc_unbiased': 92.354, 'test/diff': 1.58, 'test/acc_skew': 93.144, 'test/acc_align': 91.564}
[9 / 10] best valid accuracy: 92.367 at epoch 8 
 best_stats: {'best_valid_epoch': 8, 'best_valid_valid/acc': 92.421, 'best_valid_valid/acc_unbiased': 92.367, 'best_valid_valid/diff': 2.23, 'best_valid_valid/acc_skew': 93.482, 'best_valid_valid/acc_align': 91.253, 'best_valid_test/acc': 92.279, 'best_valid_test/acc_unbiased': 92.233, 'best_valid_test/diff': 1.128, 'best_valid_test/acc_skew': 92.797, 'best_valid_test/acc_align': 91.669}
[9 / 10] best test accuracy: 92.354 at epoch 9 
 best_stats: {'best_test_epoch': 9, 'best_test_valid/acc': 92.265, 'best_test_valid/acc_unbiased': 92.267, 'best_test_valid/diff': 2.166, 'best_test_valid/acc_skew': 93.35, 'best_test_valid/acc_align': 91.184, 'best_test_test/acc': 92.465, 'best_test_test/acc_unbiased': 92.354, 'best_test_test/diff': 1.58, 'best_test_test/acc_skew': 93.144, 'best_test_test/acc_align': 91.564}
[10 / 10] Learning rate: 1e-05 weight: 0.01
[10 / 10] Loss: 4.566354602347803 CE Loss: 0.2013872271723361 Con Loss: 4.564340729515003
[10 / 10] tensor([[0.938, 0.924],
        [0.923, 0.911]]) {'epoch': 10, 'valid/acc': 92.229, 'valid/acc_unbiased': 92.139, 'valid/diff': 2.123, 'valid/acc_skew': 93.201, 'valid/acc_align': 91.078, 'test/acc': 92.495, 'test/acc_unbiased': 92.383, 'test/diff': 1.318, 'test/acc_skew': 93.042, 'test/acc_align': 91.724}
[10 / 10] best valid accuracy: 92.367 at epoch 8 
 best_stats: {'best_valid_epoch': 8, 'best_valid_valid/acc': 92.421, 'best_valid_valid/acc_unbiased': 92.367, 'best_valid_valid/diff': 2.23, 'best_valid_valid/acc_skew': 93.482, 'best_valid_valid/acc_align': 91.253, 'best_valid_test/acc': 92.279, 'best_valid_test/acc_unbiased': 92.233, 'best_valid_test/diff': 1.128, 'best_valid_test/acc_skew': 92.797, 'best_valid_test/acc_align': 91.669}
[10 / 10] best test accuracy: 92.383 at epoch 10 
 best_stats: {'best_test_epoch': 10, 'best_test_valid/acc': 92.229, 'best_test_valid/acc_unbiased': 92.139, 'best_test_valid/diff': 2.123, 'best_test_valid/acc_skew': 93.201, 'best_test_valid/acc_align': 91.078, 'best_test_test/acc': 92.495, 'best_test_test/acc_unbiased': 92.383, 'best_test_test/diff': 1.318, 'best_test_test/acc_skew': 93.042, 'best_test_test/acc_align': 91.724}
Total training time: 0:23:46
