Log level set to: INFO
Set seed: 3
=======> Using Fixed Random Seed: 3 <========
save_path: exp_results/bc-bb0-utk_face_age-crop_rotate-0.9-lr0.001-bs128-cbs64-w0.01-ratio10-aug1-seed3
get_utk_face - split: train, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_age-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
Binary Target 1
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Normal Label Distribution: 
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
Binary Target 1
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Normal Label Distribution: 
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 10684, target_attr: gender, bias_attr: age bias_rate: 0.9
['[train] target_0-bias_0: 8237', '[train] target_0-bias_1: 147', '[train] target_1-bias_0: 823', '[train] target_1-bias_1: 1477']
confusion_matrix - 
 original: tensor([[8237.,  823.],
        [ 147., 1477.]]), 
 normalized: tensor([[0.909, 0.091],
        [0.091, 0.909]]), 
 b|y: tensor([[0.982, 0.018],
        [0.358, 0.642]])
get_utk_face - split: train, aug: 1, given_y: True, ratio: 10
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_age-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
Binary Target 1
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Normal Label Distribution: 
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
Binary Target 1
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Normal Label Distribution: 
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 10684, target_attr: gender, bias_attr: age bias_rate: 0.9
['[train] target_0-bias_0: 8237', '[train] target_0-bias_1: 147', '[train] target_1-bias_0: 823', '[train] target_1-bias_1: 1477']
get_utk_face - split: valid, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_age-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [1030, 195]
Target 1: [841, 202]
Binary Target 1
---------------------------
Target 0: [1030, 195]
Target 1: [841, 202]
===================================
Normal Label Distribution: 
Target 0: [1030, 195]
Target 1: [841, 202]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 2268, target_attr: gender, bias_attr: age bias_rate: 0.9
['[valid] target_0-bias_0: 1030', '[valid] target_0-bias_1: 195', '[valid] target_1-bias_0: 841', '[valid] target_1-bias_1: 202']
get_utk_face - split: test, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_age-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [1061, 176]
Target 1: [867, 165]
Binary Target 1
---------------------------
Target 0: [1061, 176]
Target 1: [867, 165]
===================================
Normal Label Distribution: 
Target 0: [1061, 176]
Target 1: [867, 165]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 2269, target_attr: gender, bias_attr: age bias_rate: 0.9
['[test] target_0-bias_0: 1061', '[test] target_0-bias_1: 176', '[test] target_1-bias_0: 867', '[test] target_1-bias_1: 165']
decay_epochs: [6, 13]
[1 / 20] Learning rate: 0.001 weight: 0.01
[1 / 20] Loss: 4.838574215607981 CE Loss: 0.6061226406913266 Con Loss: 4.832513001026709
[1 / 20] tensor([[0.992, 1.000],
        [0.021, 0.006]]) {'epoch': 1, 'valid/acc': 54.674, 'valid/acc_unbiased': 50.678, 'valid/diff': 1.142, 'valid/acc_skew': 51.249, 'valid/acc_align': 50.107, 'test/acc': 54.958, 'test/acc_unbiased': 50.458, 'test/diff': 1.159, 'test/acc_skew': 51.038, 'test/acc_align': 49.879}
[1 / 20] best valid accuracy: 50.678 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 54.674, 'best_valid_valid/acc_unbiased': 50.678, 'best_valid_valid/diff': 1.142, 'best_valid_valid/acc_skew': 51.249, 'best_valid_valid/acc_align': 50.107, 'best_valid_test/acc': 54.958, 'best_valid_test/acc_unbiased': 50.458, 'best_valid_test/diff': 1.159, 'best_valid_test/acc_skew': 51.038, 'best_valid_test/acc_align': 49.879}
[1 / 20] best test accuracy: 50.458 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 54.674, 'best_test_valid/acc_unbiased': 50.678, 'best_test_valid/diff': 1.142, 'best_test_valid/acc_skew': 51.249, 'best_test_valid/acc_align': 50.107, 'best_test_test/acc': 54.958, 'best_test_test/acc_unbiased': 50.458, 'best_test_test/diff': 1.159, 'best_test_test/acc_skew': 51.038, 'best_test_test/acc_align': 49.879}
[2 / 20] Learning rate: 0.001 weight: 0.01
[2 / 20] Loss: 4.635481310979743 CE Loss: 0.5540803882210766 Con Loss: 4.629940486766568
[2 / 20] tensor([[0.996, 1.000],
        [0.009, 0.000]]) {'epoch': 2, 'valid/acc': 54.277, 'valid/acc_unbiased': 50.091, 'valid/diff': 0.694, 'valid/acc_skew': 50.279, 'valid/acc_align': 49.903, 'test/acc': 54.694, 'test/acc_unbiased': 50.136, 'test/diff': 0.65, 'test/acc_skew': 50.461, 'test/acc_align': 49.811}
[2 / 20] best valid accuracy: 50.678 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 54.674, 'best_valid_valid/acc_unbiased': 50.678, 'best_valid_valid/diff': 1.142, 'best_valid_valid/acc_skew': 51.249, 'best_valid_valid/acc_align': 50.107, 'best_valid_test/acc': 54.958, 'best_valid_test/acc_unbiased': 50.458, 'best_valid_test/diff': 1.159, 'best_valid_test/acc_skew': 51.038, 'best_valid_test/acc_align': 49.879}
[2 / 20] best test accuracy: 50.458 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 54.674, 'best_test_valid/acc_unbiased': 50.678, 'best_test_valid/diff': 1.142, 'best_test_valid/acc_skew': 51.249, 'best_test_valid/acc_align': 50.107, 'best_test_test/acc': 54.958, 'best_test_test/acc_unbiased': 50.458, 'best_test_test/diff': 1.159, 'best_test_test/acc_skew': 51.038, 'best_test_test/acc_align': 49.879}
[3 / 20] Learning rate: 0.001 weight: 0.01
[3 / 20] Loss: 4.622621949001985 CE Loss: 0.5331329082179632 Con Loss: 4.617290610724377
[3 / 20] tensor([[0.992, 0.977],
        [0.063, 0.121]]) {'epoch': 3, 'valid/acc': 56.79, 'valid/acc_unbiased': 52.997, 'valid/diff': 2.926, 'valid/acc_skew': 51.534, 'valid/acc_align': 54.46, 'test/acc': 57.294, 'test/acc_unbiased': 53.86, 'test/diff': 3.648, 'test/acc_skew': 52.035, 'test/acc_align': 55.684}
[3 / 20] best valid accuracy: 52.997 at epoch 3 
 best_stats: {'best_valid_epoch': 3, 'best_valid_valid/acc': 56.79, 'best_valid_valid/acc_unbiased': 52.997, 'best_valid_valid/diff': 2.926, 'best_valid_valid/acc_skew': 51.534, 'best_valid_valid/acc_align': 54.46, 'best_valid_test/acc': 57.294, 'best_valid_test/acc_unbiased': 53.86, 'best_valid_test/diff': 3.648, 'best_valid_test/acc_skew': 52.035, 'best_valid_test/acc_align': 55.684}
[3 / 20] best test accuracy: 53.860 at epoch 3 
 best_stats: {'best_test_epoch': 3, 'best_test_valid/acc': 56.79, 'best_test_valid/acc_unbiased': 52.997, 'best_test_valid/diff': 2.926, 'best_test_valid/acc_skew': 51.534, 'best_test_valid/acc_align': 54.46, 'best_test_test/acc': 57.294, 'best_test_test/acc_unbiased': 53.86, 'best_test_test/diff': 3.648, 'best_test_test/acc_skew': 52.035, 'best_test_test/acc_align': 55.684}
[4 / 20] Learning rate: 0.001 weight: 0.01
[4 / 20] Loss: 4.594715876420398 CE Loss: 0.5187957794065557 Con Loss: 4.589527927414392
[4 / 20] tensor([[0.997, 0.989],
        [0.046, 0.085]]) {'epoch': 4, 'valid/acc': 56.085, 'valid/acc_unbiased': 53.123, 'valid/diff': 2.666, 'valid/acc_skew': 52.081, 'valid/acc_align': 54.164, 'test/acc': 56.677, 'test/acc_unbiased': 52.92, 'test/diff': 2.362, 'test/acc_skew': 51.739, 'test/acc_align': 54.101}
[4 / 20] best valid accuracy: 53.123 at epoch 4 
 best_stats: {'best_valid_epoch': 4, 'best_valid_valid/acc': 56.085, 'best_valid_valid/acc_unbiased': 53.123, 'best_valid_valid/diff': 2.666, 'best_valid_valid/acc_skew': 52.081, 'best_valid_valid/acc_align': 54.164, 'best_valid_test/acc': 56.677, 'best_valid_test/acc_unbiased': 52.92, 'best_valid_test/diff': 2.362, 'best_valid_test/acc_skew': 51.739, 'best_valid_test/acc_align': 54.101}
[4 / 20] best test accuracy: 53.860 at epoch 3 
 best_stats: {'best_test_epoch': 3, 'best_test_valid/acc': 56.79, 'best_test_valid/acc_unbiased': 52.997, 'best_test_valid/diff': 2.926, 'best_test_valid/acc_skew': 51.534, 'best_test_valid/acc_align': 54.46, 'best_test_test/acc': 57.294, 'best_test_test/acc_unbiased': 53.86, 'best_test_test/diff': 3.648, 'best_test_test/acc_skew': 52.035, 'best_test_test/acc_align': 55.684}
[5 / 20] Learning rate: 0.001 weight: 0.01
[5 / 20] Loss: 4.597624396528032 CE Loss: 0.512119632899114 Con Loss: 4.592503194191267
[5 / 20] tensor([[0.967, 0.966],
        [0.245, 0.200]]) {'epoch': 5, 'valid/acc': 62.61, 'valid/acc_unbiased': 58.942, 'valid/diff': 2.239, 'valid/acc_skew': 58.892, 'valid/acc_align': 58.993, 'test/acc': 63.508, 'test/acc_unbiased': 59.436, 'test/diff': 2.281, 'test/acc_skew': 60.522, 'test/acc_align': 58.351}
[5 / 20] best valid accuracy: 58.942 at epoch 5 
 best_stats: {'best_valid_epoch': 5, 'best_valid_valid/acc': 62.61, 'best_valid_valid/acc_unbiased': 58.942, 'best_valid_valid/diff': 2.239, 'best_valid_valid/acc_skew': 58.892, 'best_valid_valid/acc_align': 58.993, 'best_valid_test/acc': 63.508, 'best_valid_test/acc_unbiased': 59.436, 'best_valid_test/diff': 2.281, 'best_valid_test/acc_skew': 60.522, 'best_valid_test/acc_align': 58.351}
[5 / 20] best test accuracy: 59.436 at epoch 5 
 best_stats: {'best_test_epoch': 5, 'best_test_valid/acc': 62.61, 'best_test_valid/acc_unbiased': 58.942, 'best_test_valid/diff': 2.239, 'best_test_valid/acc_skew': 58.892, 'best_test_valid/acc_align': 58.993, 'best_test_test/acc': 63.508, 'best_test_test/acc_unbiased': 59.436, 'best_test_test/diff': 2.281, 'best_test_test/acc_skew': 60.522, 'best_test_test/acc_align': 58.351}
[6 / 20] Learning rate: 0.001 weight: 0.01
[6 / 20] Loss: 4.623378932900038 CE Loss: 0.5115457483888431 Con Loss: 4.61826347813808
[6 / 20] tensor([[0.968, 0.983],
        [0.190, 0.115]]) {'epoch': 6, 'valid/acc': 60.406, 'valid/acc_unbiased': 56.407, 'valid/diff': 2.542, 'valid/acc_skew': 57.242, 'valid/acc_align': 55.571, 'test/acc': 60.996, 'test/acc_unbiased': 56.409, 'test/diff': 4.508, 'test/acc_skew': 58.663, 'test/acc_align': 54.155}
[6 / 20] best valid accuracy: 58.942 at epoch 5 
 best_stats: {'best_valid_epoch': 5, 'best_valid_valid/acc': 62.61, 'best_valid_valid/acc_unbiased': 58.942, 'best_valid_valid/diff': 2.239, 'best_valid_valid/acc_skew': 58.892, 'best_valid_valid/acc_align': 58.993, 'best_valid_test/acc': 63.508, 'best_valid_test/acc_unbiased': 59.436, 'best_valid_test/diff': 2.281, 'best_valid_test/acc_skew': 60.522, 'best_valid_test/acc_align': 58.351}
[6 / 20] best test accuracy: 59.436 at epoch 5 
 best_stats: {'best_test_epoch': 5, 'best_test_valid/acc': 62.61, 'best_test_valid/acc_unbiased': 58.942, 'best_test_valid/diff': 2.239, 'best_test_valid/acc_skew': 58.892, 'best_test_valid/acc_align': 58.993, 'best_test_test/acc': 63.508, 'best_test_test/acc_unbiased': 59.436, 'best_test_test/diff': 2.281, 'best_test_test/acc_skew': 60.522, 'best_test_test/acc_align': 58.351}
[7 / 20] Learning rate: 0.0001 weight: 0.01
[7 / 20] Loss: 4.566959313621506 CE Loss: 0.49350032681206646 Con Loss: 4.562024304323185
[7 / 20] tensor([[0.968, 0.943],
        [0.278, 0.194]]) {'epoch': 7, 'valid/acc': 63.095, 'valid/acc_unbiased': 58.631, 'valid/diff': 4.729, 'valid/acc_skew': 57.435, 'valid/acc_align': 59.828, 'test/acc': 64.61, 'test/acc_unbiased': 59.576, 'test/diff': 5.44, 'test/acc_skew': 61.058, 'test/acc_align': 58.095}
[7 / 20] best valid accuracy: 58.942 at epoch 5 
 best_stats: {'best_valid_epoch': 5, 'best_valid_valid/acc': 62.61, 'best_valid_valid/acc_unbiased': 58.942, 'best_valid_valid/diff': 2.239, 'best_valid_valid/acc_skew': 58.892, 'best_valid_valid/acc_align': 58.993, 'best_valid_test/acc': 63.508, 'best_valid_test/acc_unbiased': 59.436, 'best_valid_test/diff': 2.281, 'best_valid_test/acc_skew': 60.522, 'best_valid_test/acc_align': 58.351}
[7 / 20] best test accuracy: 59.576 at epoch 7 
 best_stats: {'best_test_epoch': 7, 'best_test_valid/acc': 63.095, 'best_test_valid/acc_unbiased': 58.631, 'best_test_valid/diff': 4.729, 'best_test_valid/acc_skew': 57.435, 'best_test_valid/acc_align': 59.828, 'best_test_test/acc': 64.61, 'best_test_test/acc_unbiased': 59.576, 'best_test_test/diff': 5.44, 'best_test_test/acc_skew': 61.058, 'best_test_test/acc_align': 58.095}
[8 / 20] Learning rate: 0.0001 weight: 0.01
[8 / 20] Loss: 4.528455038188504 CE Loss: 0.4927473516666858 Con Loss: 4.52352756955837
[8 / 20] tensor([[0.971, 0.938],
        [0.294, 0.291]]) {'epoch': 8, 'valid/acc': 64.991, 'valid/acc_unbiased': 61.005, 'valid/diff': 4.168, 'valid/acc_skew': 58.921, 'valid/acc_align': 63.089, 'test/acc': 66.02, 'test/acc_unbiased': 62.333, 'test/diff': 1.825, 'test/acc_skew': 61.581, 'test/acc_align': 63.085}
[8 / 20] best valid accuracy: 61.005 at epoch 8 
 best_stats: {'best_valid_epoch': 8, 'best_valid_valid/acc': 64.991, 'best_valid_valid/acc_unbiased': 61.005, 'best_valid_valid/diff': 4.168, 'best_valid_valid/acc_skew': 58.921, 'best_valid_valid/acc_align': 63.089, 'best_valid_test/acc': 66.02, 'best_valid_test/acc_unbiased': 62.333, 'best_valid_test/diff': 1.825, 'best_valid_test/acc_skew': 61.581, 'best_valid_test/acc_align': 63.085}
[8 / 20] best test accuracy: 62.333 at epoch 8 
 best_stats: {'best_test_epoch': 8, 'best_test_valid/acc': 64.991, 'best_test_valid/acc_unbiased': 61.005, 'best_test_valid/diff': 4.168, 'best_test_valid/acc_skew': 58.921, 'best_test_valid/acc_align': 63.089, 'best_test_test/acc': 66.02, 'best_test_test/acc_unbiased': 62.333, 'best_test_test/diff': 1.825, 'best_test_test/acc_skew': 61.581, 'best_test_test/acc_align': 63.085}
[9 / 20] Learning rate: 0.0001 weight: 0.01
[9 / 20] Loss: 4.498992023553709 CE Loss: 0.4786646398365252 Con Loss: 4.4942053804144075
[9 / 20] tensor([[0.976, 0.886],
        [0.280, 0.309]]) {'epoch': 9, 'valid/acc': 64.55, 'valid/acc_unbiased': 60.548, 'valid/diff': 9.927, 'valid/acc_skew': 55.584, 'valid/acc_align': 65.511, 'test/acc': 65.491, 'test/acc_unbiased': 61.304, 'test/diff': 5.944, 'test/acc_skew': 58.332, 'test/acc_align': 64.276}
[9 / 20] best valid accuracy: 61.005 at epoch 8 
 best_stats: {'best_valid_epoch': 8, 'best_valid_valid/acc': 64.991, 'best_valid_valid/acc_unbiased': 61.005, 'best_valid_valid/diff': 4.168, 'best_valid_valid/acc_skew': 58.921, 'best_valid_valid/acc_align': 63.089, 'best_valid_test/acc': 66.02, 'best_valid_test/acc_unbiased': 62.333, 'best_valid_test/diff': 1.825, 'best_valid_test/acc_skew': 61.581, 'best_valid_test/acc_align': 63.085}
[9 / 20] best test accuracy: 62.333 at epoch 8 
 best_stats: {'best_test_epoch': 8, 'best_test_valid/acc': 64.991, 'best_test_valid/acc_unbiased': 61.005, 'best_test_valid/diff': 4.168, 'best_test_valid/acc_skew': 58.921, 'best_test_valid/acc_align': 63.089, 'best_test_test/acc': 66.02, 'best_test_test/acc_unbiased': 62.333, 'best_test_test/diff': 1.825, 'best_test_test/acc_skew': 61.581, 'best_test_test/acc_align': 63.085}
[10 / 20] Learning rate: 0.0001 weight: 0.01
[10 / 20] Loss: 4.49319638834603 CE Loss: 0.466616297584935 Con Loss: 4.488530218623542
[10 / 20] tensor([[0.983, 0.903],
        [0.271, 0.358]]) {'epoch': 10, 'valid/acc': 64.771, 'valid/acc_unbiased': 61.164, 'valid/diff': 9.977, 'valid/acc_skew': 56.175, 'valid/acc_align': 66.152, 'test/acc': 65.932, 'test/acc_unbiased': 62.877, 'test/diff': 8.308, 'test/acc_skew': 58.723, 'test/acc_align': 67.031}
[10 / 20] best valid accuracy: 61.164 at epoch 10 
 best_stats: {'best_valid_epoch': 10, 'best_valid_valid/acc': 64.771, 'best_valid_valid/acc_unbiased': 61.164, 'best_valid_valid/diff': 9.977, 'best_valid_valid/acc_skew': 56.175, 'best_valid_valid/acc_align': 66.152, 'best_valid_test/acc': 65.932, 'best_valid_test/acc_unbiased': 62.877, 'best_valid_test/diff': 8.308, 'best_valid_test/acc_skew': 58.723, 'best_valid_test/acc_align': 67.031}
[10 / 20] best test accuracy: 62.877 at epoch 10 
 best_stats: {'best_test_epoch': 10, 'best_test_valid/acc': 64.771, 'best_test_valid/acc_unbiased': 61.164, 'best_test_valid/diff': 9.977, 'best_test_valid/acc_skew': 56.175, 'best_test_valid/acc_align': 66.152, 'best_test_test/acc': 65.932, 'best_test_test/acc_unbiased': 62.877, 'best_test_test/diff': 8.308, 'best_test_test/acc_skew': 58.723, 'best_test_test/acc_align': 67.031}
[11 / 20] Learning rate: 0.0001 weight: 0.01
[11 / 20] Loss: 4.461387780666887 CE Loss: 0.45815645123143983 Con Loss: 4.456806223207715
[11 / 20] tensor([[0.956, 0.767],
        [0.405, 0.442]]) {'epoch': 11, 'valid/acc': 68.739, 'valid/acc_unbiased': 64.709, 'valid/diff': 14.408, 'valid/acc_skew': 57.505, 'valid/acc_align': 71.913, 'test/acc': 69.326, 'test/acc_unbiased': 64.25, 'test/diff': 11.312, 'test/acc_skew': 58.594, 'test/acc_align': 69.906}
[11 / 20] best valid accuracy: 64.709 at epoch 11 
 best_stats: {'best_valid_epoch': 11, 'best_valid_valid/acc': 68.739, 'best_valid_valid/acc_unbiased': 64.709, 'best_valid_valid/diff': 14.408, 'best_valid_valid/acc_skew': 57.505, 'best_valid_valid/acc_align': 71.913, 'best_valid_test/acc': 69.326, 'best_valid_test/acc_unbiased': 64.25, 'best_valid_test/diff': 11.312, 'best_valid_test/acc_skew': 58.594, 'best_valid_test/acc_align': 69.906}
[11 / 20] best test accuracy: 64.250 at epoch 11 
 best_stats: {'best_test_epoch': 11, 'best_test_valid/acc': 68.739, 'best_test_valid/acc_unbiased': 64.709, 'best_test_valid/diff': 14.408, 'best_test_valid/acc_skew': 57.505, 'best_test_valid/acc_align': 71.913, 'best_test_test/acc': 69.326, 'best_test_test/acc_unbiased': 64.25, 'best_test_test/diff': 11.312, 'best_test_test/acc_skew': 58.594, 'best_test_test/acc_align': 69.906}
[12 / 20] Learning rate: 0.0001 weight: 0.01
[12 / 20] Loss: 4.4174937125405584 CE Loss: 0.4617392067291548 Con Loss: 4.412876334452799
[12 / 20] tensor([[0.980, 0.824],
        [0.315, 0.388]]) {'epoch': 12, 'valid/acc': 66.182, 'valid/acc_unbiased': 62.869, 'valid/diff': 13.41, 'valid/acc_skew': 56.164, 'valid/acc_align': 69.574, 'test/acc': 67.078, 'test/acc_unbiased': 62.671, 'test/diff': 11.467, 'test/acc_skew': 56.937, 'test/acc_align': 68.404}
[12 / 20] best valid accuracy: 64.709 at epoch 11 
 best_stats: {'best_valid_epoch': 11, 'best_valid_valid/acc': 68.739, 'best_valid_valid/acc_unbiased': 64.709, 'best_valid_valid/diff': 14.408, 'best_valid_valid/acc_skew': 57.505, 'best_valid_valid/acc_align': 71.913, 'best_valid_test/acc': 69.326, 'best_valid_test/acc_unbiased': 64.25, 'best_valid_test/diff': 11.312, 'best_valid_test/acc_skew': 58.594, 'best_valid_test/acc_align': 69.906}
[12 / 20] best test accuracy: 64.250 at epoch 11 
 best_stats: {'best_test_epoch': 11, 'best_test_valid/acc': 68.739, 'best_test_valid/acc_unbiased': 64.709, 'best_test_valid/diff': 14.408, 'best_test_valid/acc_skew': 57.505, 'best_test_valid/acc_align': 71.913, 'best_test_test/acc': 69.326, 'best_test_test/acc_unbiased': 64.25, 'best_test_test/diff': 11.312, 'best_test_test/acc_skew': 58.594, 'best_test_test/acc_align': 69.906}
[13 / 20] Learning rate: 0.0001 weight: 0.01
[13 / 20] Loss: 4.4495534764742946 CE Loss: 0.44961099205549093 Con Loss: 4.445057354094785
[13 / 20] tensor([[0.975, 0.824],
        [0.328, 0.400]]) {'epoch': 13, 'valid/acc': 67.416, 'valid/acc_unbiased': 63.316, 'valid/diff': 13.613, 'valid/acc_skew': 56.509, 'valid/acc_align': 70.122, 'test/acc': 67.431, 'test/acc_unbiased': 63.173, 'test/diff': 11.203, 'test/acc_skew': 57.571, 'test/acc_align': 68.775}
[13 / 20] best valid accuracy: 64.709 at epoch 11 
 best_stats: {'best_valid_epoch': 11, 'best_valid_valid/acc': 68.739, 'best_valid_valid/acc_unbiased': 64.709, 'best_valid_valid/diff': 14.408, 'best_valid_valid/acc_skew': 57.505, 'best_valid_valid/acc_align': 71.913, 'best_valid_test/acc': 69.326, 'best_valid_test/acc_unbiased': 64.25, 'best_valid_test/diff': 11.312, 'best_valid_test/acc_skew': 58.594, 'best_valid_test/acc_align': 69.906}
[13 / 20] best test accuracy: 64.250 at epoch 11 
 best_stats: {'best_test_epoch': 11, 'best_test_valid/acc': 68.739, 'best_test_valid/acc_unbiased': 64.709, 'best_test_valid/diff': 14.408, 'best_test_valid/acc_skew': 57.505, 'best_test_valid/acc_align': 71.913, 'best_test_test/acc': 69.326, 'best_test_test/acc_unbiased': 64.25, 'best_test_test/diff': 11.312, 'best_test_test/acc_skew': 58.594, 'best_test_test/acc_align': 69.906}
[14 / 20] Learning rate: 1e-05 weight: 0.01
[14 / 20] Loss: 4.401260354196655 CE Loss: 0.45065279270950126 Con Loss: 4.396753840480391
[14 / 20] tensor([[0.975, 0.795],
        [0.360, 0.430]]) {'epoch': 14, 'valid/acc': 68.21, 'valid/acc_unbiased': 64.022, 'valid/diff': 15.568, 'valid/acc_skew': 56.238, 'valid/acc_align': 71.806, 'test/acc': 68.621, 'test/acc_unbiased': 64.004, 'test/diff': 12.477, 'test/acc_skew': 57.766, 'test/acc_align': 70.243}
[14 / 20] best valid accuracy: 64.709 at epoch 11 
 best_stats: {'best_valid_epoch': 11, 'best_valid_valid/acc': 68.739, 'best_valid_valid/acc_unbiased': 64.709, 'best_valid_valid/diff': 14.408, 'best_valid_valid/acc_skew': 57.505, 'best_valid_valid/acc_align': 71.913, 'best_valid_test/acc': 69.326, 'best_valid_test/acc_unbiased': 64.25, 'best_valid_test/diff': 11.312, 'best_valid_test/acc_skew': 58.594, 'best_valid_test/acc_align': 69.906}
[14 / 20] best test accuracy: 64.250 at epoch 11 
 best_stats: {'best_test_epoch': 11, 'best_test_valid/acc': 68.739, 'best_test_valid/acc_unbiased': 64.709, 'best_test_valid/diff': 14.408, 'best_test_valid/acc_skew': 57.505, 'best_test_valid/acc_align': 71.913, 'best_test_test/acc': 69.326, 'best_test_test/acc_unbiased': 64.25, 'best_test_test/diff': 11.312, 'best_test_test/acc_skew': 58.594, 'best_test_test/acc_align': 69.906}
[15 / 20] Learning rate: 1e-05 weight: 0.01
[15 / 20] Loss: 4.419679621371916 CE Loss: 0.44148028011805823 Con Loss: 4.4152648203473825
[15 / 20] tensor([[0.970, 0.801],
        [0.367, 0.442]]) {'epoch': 15, 'valid/acc': 68.034, 'valid/acc_unbiased': 64.098, 'valid/diff': 16.708, 'valid/acc_skew': 55.744, 'valid/acc_align': 72.452, 'test/acc': 68.797, 'test/acc_unbiased': 64.505, 'test/diff': 12.217, 'test/acc_skew': 58.396, 'test/acc_align': 70.613}
[15 / 20] best valid accuracy: 64.709 at epoch 11 
 best_stats: {'best_valid_epoch': 11, 'best_valid_valid/acc': 68.739, 'best_valid_valid/acc_unbiased': 64.709, 'best_valid_valid/diff': 14.408, 'best_valid_valid/acc_skew': 57.505, 'best_valid_valid/acc_align': 71.913, 'best_valid_test/acc': 69.326, 'best_valid_test/acc_unbiased': 64.25, 'best_valid_test/diff': 11.312, 'best_valid_test/acc_skew': 58.594, 'best_valid_test/acc_align': 69.906}
[15 / 20] best test accuracy: 64.505 at epoch 15 
 best_stats: {'best_test_epoch': 15, 'best_test_valid/acc': 68.034, 'best_test_valid/acc_unbiased': 64.098, 'best_test_valid/diff': 16.708, 'best_test_valid/acc_skew': 55.744, 'best_test_valid/acc_align': 72.452, 'best_test_test/acc': 68.797, 'best_test_test/acc_unbiased': 64.505, 'best_test_test/diff': 12.217, 'best_test_test/acc_skew': 58.396, 'best_test_test/acc_align': 70.613}
[16 / 20] Learning rate: 1e-05 weight: 0.01
[16 / 20] Loss: 4.398033692300297 CE Loss: 0.4445478076436733 Con Loss: 4.393588226951048
[16 / 20] tensor([[0.975, 0.807],
        [0.361, 0.430]]) {'epoch': 16, 'valid/acc': 67.989, 'valid/acc_unbiased': 63.863, 'valid/diff': 16.081, 'valid/acc_skew': 55.822, 'valid/acc_align': 71.903, 'test/acc': 68.753, 'test/acc_unbiased': 64.317, 'test/diff': 11.851, 'test/acc_skew': 58.392, 'test/acc_align': 70.243}
[16 / 20] best valid accuracy: 64.709 at epoch 11 
 best_stats: {'best_valid_epoch': 11, 'best_valid_valid/acc': 68.739, 'best_valid_valid/acc_unbiased': 64.709, 'best_valid_valid/diff': 14.408, 'best_valid_valid/acc_skew': 57.505, 'best_valid_valid/acc_align': 71.913, 'best_valid_test/acc': 69.326, 'best_valid_test/acc_unbiased': 64.25, 'best_valid_test/diff': 11.312, 'best_valid_test/acc_skew': 58.594, 'best_valid_test/acc_align': 69.906}
[16 / 20] best test accuracy: 64.505 at epoch 15 
 best_stats: {'best_test_epoch': 15, 'best_test_valid/acc': 68.034, 'best_test_valid/acc_unbiased': 64.098, 'best_test_valid/diff': 16.708, 'best_test_valid/acc_skew': 55.744, 'best_test_valid/acc_align': 72.452, 'best_test_test/acc': 68.797, 'best_test_test/acc_unbiased': 64.505, 'best_test_test/diff': 12.217, 'best_test_test/acc_skew': 58.396, 'best_test_test/acc_align': 70.613}
[17 / 20] Learning rate: 1e-05 weight: 0.01
[17 / 20] Loss: 4.3161343965848165 CE Loss: 0.4407260261841456 Con Loss: 4.311727129980135
[17 / 20] tensor([[0.976, 0.807],
        [0.343, 0.424]]) {'epoch': 17, 'valid/acc': 67.019, 'valid/acc_unbiased': 63.473, 'valid/diff': 18.238, 'valid/acc_skew': 54.354, 'valid/acc_align': 72.593, 'test/acc': 68.092, 'test/acc_unbiased': 63.751, 'test/diff': 12.565, 'test/acc_skew': 57.469, 'test/acc_align': 70.034}
[17 / 20] best valid accuracy: 64.709 at epoch 11 
 best_stats: {'best_valid_epoch': 11, 'best_valid_valid/acc': 68.739, 'best_valid_valid/acc_unbiased': 64.709, 'best_valid_valid/diff': 14.408, 'best_valid_valid/acc_skew': 57.505, 'best_valid_valid/acc_align': 71.913, 'best_valid_test/acc': 69.326, 'best_valid_test/acc_unbiased': 64.25, 'best_valid_test/diff': 11.312, 'best_valid_test/acc_skew': 58.594, 'best_valid_test/acc_align': 69.906}
[17 / 20] best test accuracy: 64.505 at epoch 15 
 best_stats: {'best_test_epoch': 15, 'best_test_valid/acc': 68.034, 'best_test_valid/acc_unbiased': 64.098, 'best_test_valid/diff': 16.708, 'best_test_valid/acc_skew': 55.744, 'best_test_valid/acc_align': 72.452, 'best_test_test/acc': 68.797, 'best_test_test/acc_unbiased': 64.505, 'best_test_test/diff': 12.217, 'best_test_test/acc_skew': 58.396, 'best_test_test/acc_align': 70.613}
[18 / 20] Learning rate: 1e-05 weight: 0.01
[18 / 20] Loss: 4.39687480876527 CE Loss: 0.4390418911105191 Con Loss: 4.392484377672145
[18 / 20] tensor([[0.975, 0.812],
        [0.355, 0.430]]) {'epoch': 18, 'valid/acc': 67.725, 'valid/acc_unbiased': 63.482, 'valid/diff': 16.94, 'valid/acc_skew': 55.012, 'valid/acc_align': 71.952, 'test/acc': 68.621, 'test/acc_unbiased': 64.339, 'test/diff': 11.902, 'test/acc_skew': 58.387, 'test/acc_align': 70.29}
[18 / 20] best valid accuracy: 64.709 at epoch 11 
 best_stats: {'best_valid_epoch': 11, 'best_valid_valid/acc': 68.739, 'best_valid_valid/acc_unbiased': 64.709, 'best_valid_valid/diff': 14.408, 'best_valid_valid/acc_skew': 57.505, 'best_valid_valid/acc_align': 71.913, 'best_valid_test/acc': 69.326, 'best_valid_test/acc_unbiased': 64.25, 'best_valid_test/diff': 11.312, 'best_valid_test/acc_skew': 58.594, 'best_valid_test/acc_align': 69.906}
[18 / 20] best test accuracy: 64.505 at epoch 15 
 best_stats: {'best_test_epoch': 15, 'best_test_valid/acc': 68.034, 'best_test_valid/acc_unbiased': 64.098, 'best_test_valid/diff': 16.708, 'best_test_valid/acc_skew': 55.744, 'best_test_valid/acc_align': 72.452, 'best_test_test/acc': 68.797, 'best_test_test/acc_unbiased': 64.505, 'best_test_test/diff': 12.217, 'best_test_test/acc_skew': 58.396, 'best_test_test/acc_align': 70.613}
[19 / 20] Learning rate: 1e-05 weight: 0.01
[19 / 20] Loss: 4.399122698929193 CE Loss: 0.4328585865010219 Con Loss: 4.394794116346901
[19 / 20] tensor([[0.981, 0.801],
        [0.328, 0.430]]) {'epoch': 19, 'valid/acc': 66.843, 'valid/acc_unbiased': 62.881, 'valid/diff': 17.841, 'valid/acc_skew': 53.96, 'valid/acc_align': 71.801, 'test/acc': 67.739, 'test/acc_unbiased': 63.504, 'test/diff': 14.138, 'test/acc_skew': 56.435, 'test/acc_align': 70.573}
[19 / 20] best valid accuracy: 64.709 at epoch 11 
 best_stats: {'best_valid_epoch': 11, 'best_valid_valid/acc': 68.739, 'best_valid_valid/acc_unbiased': 64.709, 'best_valid_valid/diff': 14.408, 'best_valid_valid/acc_skew': 57.505, 'best_valid_valid/acc_align': 71.913, 'best_valid_test/acc': 69.326, 'best_valid_test/acc_unbiased': 64.25, 'best_valid_test/diff': 11.312, 'best_valid_test/acc_skew': 58.594, 'best_valid_test/acc_align': 69.906}
[19 / 20] best test accuracy: 64.505 at epoch 15 
 best_stats: {'best_test_epoch': 15, 'best_test_valid/acc': 68.034, 'best_test_valid/acc_unbiased': 64.098, 'best_test_valid/diff': 16.708, 'best_test_valid/acc_skew': 55.744, 'best_test_valid/acc_align': 72.452, 'best_test_test/acc': 68.797, 'best_test_test/acc_unbiased': 64.505, 'best_test_test/diff': 12.217, 'best_test_test/acc_skew': 58.396, 'best_test_test/acc_align': 70.613}
[20 / 20] Learning rate: 1e-05 weight: 0.01
[20 / 20] Loss: 4.378493272066563 CE Loss: 0.4373125386501421 Con Loss: 4.374120139932865
[20 / 20] tensor([[0.974, 0.812],
        [0.360, 0.430]]) {'epoch': 20, 'valid/acc': 67.593, 'valid/acc_unbiased': 63.669, 'valid/diff': 18.147, 'valid/acc_skew': 54.596, 'valid/acc_align': 72.743, 'test/acc': 68.709, 'test/acc_unbiased': 64.407, 'test/diff': 11.578, 'test/acc_skew': 58.618, 'test/acc_align': 70.196}
[20 / 20] best valid accuracy: 64.709 at epoch 11 
 best_stats: {'best_valid_epoch': 11, 'best_valid_valid/acc': 68.739, 'best_valid_valid/acc_unbiased': 64.709, 'best_valid_valid/diff': 14.408, 'best_valid_valid/acc_skew': 57.505, 'best_valid_valid/acc_align': 71.913, 'best_valid_test/acc': 69.326, 'best_valid_test/acc_unbiased': 64.25, 'best_valid_test/diff': 11.312, 'best_valid_test/acc_skew': 58.594, 'best_valid_test/acc_align': 69.906}
[20 / 20] best test accuracy: 64.505 at epoch 15 
 best_stats: {'best_test_epoch': 15, 'best_test_valid/acc': 68.034, 'best_test_valid/acc_unbiased': 64.098, 'best_test_valid/diff': 16.708, 'best_test_valid/acc_skew': 55.744, 'best_test_valid/acc_align': 72.452, 'best_test_test/acc': 68.797, 'best_test_test/acc_unbiased': 64.505, 'best_test_test/diff': 12.217, 'best_test_test/acc_skew': 58.396, 'best_test_test/acc_align': 70.613}
Total training time: 0:15:57
