Log level set to: INFO
Set seed: 1
=======> Using Fixed Random Seed: 1 <========
save_path: exp_results/bc-bb0-celeba_black-crop_rand-lr0.001-bs128-cbs64-w0.01-ratio30-aug1-seed1
get_celeba - split:train, aug: False, given_y: True, ratio: 0
use existing black indices from data/celeba/pickles/black
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [60539, 38593]
Target 1: [8008, 16048]
Binary Target 1
---------------------------
Target 0: [60539, 38593]
Target 1: [8008, 16048]
===================================
Normal Label Distribution: 
Target 0: [60539, 38593]
Target 1: [8008, 16048]
===================================
Use BiasedCelebASplit 
 target_attr: black split: train 
 tensor([[60539.,  8008.],
        [38593., 16048.]])
get_celeba - split:train, aug: 1, given_y: True, ratio: 30
use existing black indices from data/celeba/pickles/black
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [60508, 38612]
Target 1: [8008, 16060]
Binary Target 1
---------------------------
Target 0: [60508, 38612]
Target 1: [8008, 16060]
===================================
Normal Label Distribution: 
Target 0: [60508, 38612]
Target 1: [8008, 16060]
===================================
Use BiasedCelebASplit 
 target_attr: black split: train 
 tensor([[60508.,  8008.],
        [38612., 16060.]])
get_celeba - split:train_valid, aug: False, given_y: True, ratio: 0
use existing black indices from data/celeba/pickles/black
Use BiasedCelebASplit 
 target_attr: black split: train_valid 
 tensor([[15227.,  1970.],
        [ 9563.,  4038.]])
get_celeba - split:valid, aug: False, given_y: True, ratio: 0
Use BiasedCelebASplit 
 target_attr: black split: valid 
 tensor([[9752., 1657.],
        [5971., 2487.]])
decay_epochs: [3, 6]
[1 / 10] Learning rate: 0.001 weight: 0.01
[1 / 10] Loss: 4.809447030794753 CE Loss: 0.30950339864477977 Con Loss: 4.806351993936848
[1 / 10] tensor([[0.994, 0.991],
        [0.293, 0.249]]) {'epoch': 1, 'valid/acc': 84.879, 'valid/acc_unbiased': 62.429, 'valid/diff': 1.471, 'valid/acc_skew': 63.164, 'valid/acc_align': 61.693, 'test/acc': 84.114, 'test/acc_unbiased': 63.153, 'test/diff': 2.338, 'test/acc_skew': 64.174, 'test/acc_align': 62.132}
[1 / 10] best valid accuracy: 62.429 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 84.879, 'best_valid_valid/acc_unbiased': 62.429, 'best_valid_valid/diff': 1.471, 'best_valid_valid/acc_skew': 63.164, 'best_valid_valid/acc_align': 61.693, 'best_valid_test/acc': 84.114, 'best_valid_test/acc_unbiased': 63.153, 'best_valid_test/diff': 2.338, 'best_valid_test/acc_skew': 64.174, 'best_valid_test/acc_align': 62.132}
[1 / 10] best test accuracy: 63.153 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 84.879, 'best_test_valid/acc_unbiased': 62.429, 'best_test_valid/diff': 1.471, 'best_test_valid/acc_skew': 63.164, 'best_test_valid/acc_align': 61.693, 'best_test_test/acc': 84.114, 'best_test_test/acc_unbiased': 63.153, 'best_test_test/diff': 2.338, 'best_test_test/acc_skew': 64.174, 'best_test_test/acc_align': 62.132}
[2 / 10] Learning rate: 0.001 weight: 0.01
[2 / 10] Loss: 4.794873210514203 CE Loss: 0.2799723292165837 Con Loss: 4.792073481182861
[2 / 10] tensor([[0.942, 0.918],
        [0.733, 0.659]]) {'epoch': 2, 'valid/acc': 87.934, 'valid/acc_unbiased': 79.848, 'valid/diff': 5.594, 'valid/acc_skew': 81.364, 'valid/acc_align': 78.331, 'test/acc': 88.197, 'test/acc_unbiased': 81.3, 'test/diff': 4.881, 'test/acc_skew': 82.521, 'test/acc_align': 80.08}
[2 / 10] best valid accuracy: 79.848 at epoch 2 
 best_stats: {'best_valid_epoch': 2, 'best_valid_valid/acc': 87.934, 'best_valid_valid/acc_unbiased': 79.848, 'best_valid_valid/diff': 5.594, 'best_valid_valid/acc_skew': 81.364, 'best_valid_valid/acc_align': 78.331, 'best_valid_test/acc': 88.197, 'best_valid_test/acc_unbiased': 81.3, 'best_valid_test/diff': 4.881, 'best_valid_test/acc_skew': 82.521, 'best_valid_test/acc_align': 80.08}
[2 / 10] best test accuracy: 81.300 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 87.934, 'best_test_valid/acc_unbiased': 79.848, 'best_test_valid/diff': 5.594, 'best_test_valid/acc_skew': 81.364, 'best_test_valid/acc_align': 78.331, 'best_test_test/acc': 88.197, 'best_test_test/acc_unbiased': 81.3, 'best_test_test/diff': 4.881, 'best_test_test/acc_skew': 82.521, 'best_test_test/acc_align': 80.08}
[3 / 10] Learning rate: 0.001 weight: 0.01
[3 / 10] Loss: 4.7874633297965286 CE Loss: 0.2724260152766204 Con Loss: 4.784739070671481
[3 / 10] tensor([[0.963, 0.920],
        [0.703, 0.749]]) {'epoch': 3, 'valid/acc': 89.827, 'valid/acc_unbiased': 81.985, 'valid/diff': 4.277, 'valid/acc_skew': 79.847, 'valid/acc_align': 84.124, 'test/acc': 90.139, 'test/acc_unbiased': 83.372, 'test/diff': 4.474, 'test/acc_skew': 81.134, 'test/acc_align': 85.609}
[3 / 10] best valid accuracy: 81.985 at epoch 3 
 best_stats: {'best_valid_epoch': 3, 'best_valid_valid/acc': 89.827, 'best_valid_valid/acc_unbiased': 81.985, 'best_valid_valid/diff': 4.277, 'best_valid_valid/acc_skew': 79.847, 'best_valid_valid/acc_align': 84.124, 'best_valid_test/acc': 90.139, 'best_valid_test/acc_unbiased': 83.372, 'best_valid_test/diff': 4.474, 'best_valid_test/acc_skew': 81.134, 'best_valid_test/acc_align': 85.609}
[3 / 10] best test accuracy: 83.372 at epoch 3 
 best_stats: {'best_test_epoch': 3, 'best_test_valid/acc': 89.827, 'best_test_valid/acc_unbiased': 81.985, 'best_test_valid/diff': 4.277, 'best_test_valid/acc_skew': 79.847, 'best_test_valid/acc_align': 84.124, 'best_test_test/acc': 90.139, 'best_test_test/acc_unbiased': 83.372, 'best_test_test/diff': 4.474, 'best_test_test/acc_skew': 81.134, 'best_test_test/acc_align': 85.609}
[4 / 10] Learning rate: 0.0001 weight: 0.01
[4 / 10] Loss: 4.762303516307922 CE Loss: 0.2394045390415862 Con Loss: 4.7599094705921985
[4 / 10] tensor([[0.953, 0.920],
        [0.742, 0.740]]) {'epoch': 4, 'valid/acc': 90.227, 'valid/acc_unbiased': 83.373, 'valid/diff': 1.963, 'valid/acc_skew': 83.019, 'valid/acc_align': 83.728, 'test/acc': 89.888, 'test/acc_unbiased': 83.879, 'test/diff': 1.705, 'test/acc_skew': 83.099, 'test/acc_align': 84.659}
[4 / 10] best valid accuracy: 83.373 at epoch 4 
 best_stats: {'best_valid_epoch': 4, 'best_valid_valid/acc': 90.227, 'best_valid_valid/acc_unbiased': 83.373, 'best_valid_valid/diff': 1.963, 'best_valid_valid/acc_skew': 83.019, 'best_valid_valid/acc_align': 83.728, 'best_valid_test/acc': 89.888, 'best_valid_test/acc_unbiased': 83.879, 'best_valid_test/diff': 1.705, 'best_valid_test/acc_skew': 83.099, 'best_valid_test/acc_align': 84.659}
[4 / 10] best test accuracy: 83.879 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 90.227, 'best_test_valid/acc_unbiased': 83.373, 'best_test_valid/diff': 1.963, 'best_test_valid/acc_skew': 83.019, 'best_test_valid/acc_align': 83.728, 'best_test_test/acc': 89.888, 'best_test_test/acc_unbiased': 83.879, 'best_test_test/diff': 1.705, 'best_test_test/acc_skew': 83.099, 'best_test_test/acc_align': 84.659}
[5 / 10] Learning rate: 0.0001 weight: 0.01
[5 / 10] Loss: 4.75711730526969 CE Loss: 0.23284583595163516 Con Loss: 4.754788843343741
[5 / 10] tensor([[0.968, 0.945],
        [0.689, 0.712]]) {'epoch': 5, 'valid/acc': 90.626, 'valid/acc_unbiased': 81.853, 'valid/diff': 1.708, 'valid/acc_skew': 81.0, 'valid/acc_align': 82.707, 'test/acc': 90.603, 'test/acc_unbiased': 82.853, 'test/diff': 2.306, 'test/acc_skew': 81.7, 'test/acc_align': 84.006}
[5 / 10] best valid accuracy: 83.373 at epoch 4 
 best_stats: {'best_valid_epoch': 4, 'best_valid_valid/acc': 90.227, 'best_valid_valid/acc_unbiased': 83.373, 'best_valid_valid/diff': 1.963, 'best_valid_valid/acc_skew': 83.019, 'best_valid_valid/acc_align': 83.728, 'best_valid_test/acc': 89.888, 'best_valid_test/acc_unbiased': 83.879, 'best_valid_test/diff': 1.705, 'best_valid_test/acc_skew': 83.099, 'best_valid_test/acc_align': 84.659}
[5 / 10] best test accuracy: 83.879 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 90.227, 'best_test_valid/acc_unbiased': 83.373, 'best_test_valid/diff': 1.963, 'best_test_valid/acc_skew': 83.019, 'best_test_valid/acc_align': 83.728, 'best_test_test/acc': 89.888, 'best_test_test/acc_unbiased': 83.879, 'best_test_test/diff': 1.705, 'best_test_test/acc_skew': 83.099, 'best_test_test/acc_align': 84.659}
[6 / 10] Learning rate: 0.0001 weight: 0.01
[6 / 10] Loss: 4.751963124366713 CE Loss: 0.22970081404725828 Con Loss: 4.749666116321017
[6 / 10] tensor([[0.960, 0.947],
        [0.722, 0.700]]) {'epoch': 6, 'valid/acc': 90.331, 'valid/acc_unbiased': 82.571, 'valid/diff': 3.266, 'valid/acc_skew': 83.75, 'valid/acc_align': 81.393, 'test/acc': 90.356, 'test/acc_unbiased': 83.21, 'test/diff': 1.759, 'test/acc_skew': 83.418, 'test/acc_align': 83.002}
[6 / 10] best valid accuracy: 83.373 at epoch 4 
 best_stats: {'best_valid_epoch': 4, 'best_valid_valid/acc': 90.227, 'best_valid_valid/acc_unbiased': 83.373, 'best_valid_valid/diff': 1.963, 'best_valid_valid/acc_skew': 83.019, 'best_valid_valid/acc_align': 83.728, 'best_valid_test/acc': 89.888, 'best_valid_test/acc_unbiased': 83.879, 'best_valid_test/diff': 1.705, 'best_valid_test/acc_skew': 83.099, 'best_valid_test/acc_align': 84.659}
[6 / 10] best test accuracy: 83.879 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 90.227, 'best_test_valid/acc_unbiased': 83.373, 'best_test_valid/diff': 1.963, 'best_test_valid/acc_skew': 83.019, 'best_test_valid/acc_align': 83.728, 'best_test_test/acc': 89.888, 'best_test_test/acc_unbiased': 83.879, 'best_test_test/diff': 1.705, 'best_test_test/acc_skew': 83.099, 'best_test_test/acc_align': 84.659}
[7 / 10] Learning rate: 1e-05 weight: 0.01
[7 / 10] Loss: 4.745949277987119 CE Loss: 0.22567738354134476 Con Loss: 4.743692510092488
[7 / 10] tensor([[0.963, 0.938],
        [0.723, 0.745]]) {'epoch': 7, 'valid/acc': 90.921, 'valid/acc_unbiased': 83.602, 'valid/diff': 1.08, 'valid/acc_skew': 83.068, 'valid/acc_align': 84.136, 'test/acc': 90.819, 'test/acc_unbiased': 84.215, 'test/diff': 2.377, 'test/acc_skew': 83.026, 'test/acc_align': 85.403}
[7 / 10] best valid accuracy: 83.602 at epoch 7 
 best_stats: {'best_valid_epoch': 7, 'best_valid_valid/acc': 90.921, 'best_valid_valid/acc_unbiased': 83.602, 'best_valid_valid/diff': 1.08, 'best_valid_valid/acc_skew': 83.068, 'best_valid_valid/acc_align': 84.136, 'best_valid_test/acc': 90.819, 'best_valid_test/acc_unbiased': 84.215, 'best_valid_test/diff': 2.377, 'best_valid_test/acc_skew': 83.026, 'best_valid_test/acc_align': 85.403}
[7 / 10] best test accuracy: 84.215 at epoch 7 
 best_stats: {'best_test_epoch': 7, 'best_test_valid/acc': 90.921, 'best_test_valid/acc_unbiased': 83.602, 'best_test_valid/diff': 1.08, 'best_test_valid/acc_skew': 83.068, 'best_test_valid/acc_align': 84.136, 'best_test_test/acc': 90.819, 'best_test_test/acc_unbiased': 84.215, 'best_test_test/diff': 2.377, 'best_test_test/acc_skew': 83.026, 'best_test_test/acc_align': 85.403}
[8 / 10] Learning rate: 1e-05 weight: 0.01
[8 / 10] Loss: 4.7448778397100915 CE Loss: 0.22205039125009532 Con Loss: 4.742657336475872
[8 / 10] tensor([[0.961, 0.935],
        [0.742, 0.746]]) {'epoch': 8, 'valid/acc': 90.883, 'valid/acc_unbiased': 84.187, 'valid/diff': 2.31, 'valid/acc_skew': 84.334, 'valid/acc_align': 84.04, 'test/acc': 90.824, 'test/acc_unbiased': 84.624, 'test/diff': 1.515, 'test/acc_skew': 83.866, 'test/acc_align': 85.381}
[8 / 10] best valid accuracy: 84.187 at epoch 8 
 best_stats: {'best_valid_epoch': 8, 'best_valid_valid/acc': 90.883, 'best_valid_valid/acc_unbiased': 84.187, 'best_valid_valid/diff': 2.31, 'best_valid_valid/acc_skew': 84.334, 'best_valid_valid/acc_align': 84.04, 'best_valid_test/acc': 90.824, 'best_valid_test/acc_unbiased': 84.624, 'best_valid_test/diff': 1.515, 'best_valid_test/acc_skew': 83.866, 'best_valid_test/acc_align': 85.381}
[8 / 10] best test accuracy: 84.624 at epoch 8 
 best_stats: {'best_test_epoch': 8, 'best_test_valid/acc': 90.883, 'best_test_valid/acc_unbiased': 84.187, 'best_test_valid/diff': 2.31, 'best_test_valid/acc_skew': 84.334, 'best_test_valid/acc_align': 84.04, 'best_test_test/acc': 90.824, 'best_test_test/acc_unbiased': 84.624, 'best_test_test/diff': 1.515, 'best_test_test/acc_skew': 83.866, 'best_test_test/acc_align': 85.381}
[9 / 10] Learning rate: 1e-05 weight: 0.01
[9 / 10] Loss: 4.743154952227034 CE Loss: 0.221522574584879 Con Loss: 4.740939723170686
[9 / 10] tensor([[0.961, 0.932],
        [0.742, 0.763]]) {'epoch': 9, 'valid/acc': 90.918, 'valid/acc_unbiased': 84.249, 'valid/diff': 1.291, 'valid/acc_skew': 83.694, 'valid/acc_align': 84.805, 'test/acc': 90.935, 'test/acc_unbiased': 84.949, 'test/diff': 2.493, 'test/acc_skew': 83.702, 'test/acc_align': 86.195}
[9 / 10] best valid accuracy: 84.249 at epoch 9 
 best_stats: {'best_valid_epoch': 9, 'best_valid_valid/acc': 90.918, 'best_valid_valid/acc_unbiased': 84.249, 'best_valid_valid/diff': 1.291, 'best_valid_valid/acc_skew': 83.694, 'best_valid_valid/acc_align': 84.805, 'best_valid_test/acc': 90.935, 'best_valid_test/acc_unbiased': 84.949, 'best_valid_test/diff': 2.493, 'best_valid_test/acc_skew': 83.702, 'best_valid_test/acc_align': 86.195}
[9 / 10] best test accuracy: 84.949 at epoch 9 
 best_stats: {'best_test_epoch': 9, 'best_test_valid/acc': 90.918, 'best_test_valid/acc_unbiased': 84.249, 'best_test_valid/diff': 1.291, 'best_test_valid/acc_skew': 83.694, 'best_test_valid/acc_align': 84.805, 'best_test_test/acc': 90.935, 'best_test_test/acc_unbiased': 84.949, 'best_test_test/diff': 2.493, 'best_test_test/acc_skew': 83.702, 'best_test_test/acc_align': 86.195}
[10 / 10] Learning rate: 1e-05 weight: 0.01
[10 / 10] Loss: 4.741407882100085 CE Loss: 0.2201245241676379 Con Loss: 4.739206620593015
[10 / 10] tensor([[0.971, 0.949],
        [0.672, 0.704]]) {'epoch': 10, 'valid/acc': 90.853, 'valid/acc_unbiased': 82.136, 'valid/diff': 1.612, 'valid/acc_skew': 81.33, 'valid/acc_align': 82.942, 'test/acc': 90.603, 'test/acc_unbiased': 82.411, 'test/diff': 2.733, 'test/acc_skew': 81.044, 'test/acc_align': 83.777}
[10 / 10] best valid accuracy: 84.249 at epoch 9 
 best_stats: {'best_valid_epoch': 9, 'best_valid_valid/acc': 90.918, 'best_valid_valid/acc_unbiased': 84.249, 'best_valid_valid/diff': 1.291, 'best_valid_valid/acc_skew': 83.694, 'best_valid_valid/acc_align': 84.805, 'best_valid_test/acc': 90.935, 'best_valid_test/acc_unbiased': 84.949, 'best_valid_test/diff': 2.493, 'best_valid_test/acc_skew': 83.702, 'best_valid_test/acc_align': 86.195}
[10 / 10] best test accuracy: 84.949 at epoch 9 
 best_stats: {'best_test_epoch': 9, 'best_test_valid/acc': 90.918, 'best_test_valid/acc_unbiased': 84.249, 'best_test_valid/diff': 1.291, 'best_test_valid/acc_skew': 83.694, 'best_test_valid/acc_align': 84.805, 'best_test_test/acc': 90.935, 'best_test_test/acc_unbiased': 84.949, 'best_test_test/diff': 2.493, 'best_test_test/acc_skew': 83.702, 'best_test_test/acc_align': 86.195}
Total training time: 2:02:28
