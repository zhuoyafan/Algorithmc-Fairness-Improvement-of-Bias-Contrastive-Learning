Log level set to: INFO
Set seed: 1
=======> Using Fixed Random Seed: 1 <========
save_path: exp_results/bc-bb0-celeba_black-crop_auto1-lr0.001-bs128-cbs64-w0.01-ratio30-aug1-seed1
get_celeba - split:train, aug: False, given_y: True, ratio: 0
use existing black indices from data/celeba/pickles/black
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [60539, 38593]
Target 1: [8008, 16048]
Binary Target 1
---------------------------
Target 0: [60539, 38593]
Target 1: [8008, 16048]
===================================
Normal Label Distribution: 
Target 0: [60539, 38593]
Target 1: [8008, 16048]
===================================
Use BiasedCelebASplit 
 target_attr: black split: train 
 tensor([[60539.,  8008.],
        [38593., 16048.]])
get_celeba - split:train, aug: 1, given_y: True, ratio: 30
use existing black indices from data/celeba/pickles/black
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [60508, 38612]
Target 1: [8008, 16060]
Binary Target 1
---------------------------
Target 0: [60508, 38612]
Target 1: [8008, 16060]
===================================
Normal Label Distribution: 
Target 0: [60508, 38612]
Target 1: [8008, 16060]
===================================
Use BiasedCelebASplit 
 target_attr: black split: train 
 tensor([[60508.,  8008.],
        [38612., 16060.]])
get_celeba - split:train_valid, aug: False, given_y: True, ratio: 0
use existing black indices from data/celeba/pickles/black
Use BiasedCelebASplit 
 target_attr: black split: train_valid 
 tensor([[15227.,  1970.],
        [ 9563.,  4038.]])
get_celeba - split:valid, aug: False, given_y: True, ratio: 0
Use BiasedCelebASplit 
 target_attr: black split: valid 
 tensor([[9752., 1657.],
        [5971., 2487.]])
decay_epochs: [3, 6]
[1 / 10] Learning rate: 0.001 weight: 0.01
[1 / 10] Loss: 4.819031103635007 CE Loss: 0.31353889684667524 Con Loss: 4.815895711895274
[1 / 10] tensor([[0.990, 0.973],
        [0.301, 0.392]]) {'epoch': 1, 'valid/acc': 85.424, 'valid/acc_unbiased': 64.543, 'valid/diff': 4.283, 'valid/acc_skew': 62.402, 'valid/acc_align': 66.685, 'test/acc': 85.247, 'test/acc_unbiased': 66.388, 'test/diff': 5.392, 'test/acc_skew': 63.692, 'test/acc_align': 69.084}
[1 / 10] best valid accuracy: 64.543 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 85.424, 'best_valid_valid/acc_unbiased': 64.543, 'best_valid_valid/diff': 4.283, 'best_valid_valid/acc_skew': 62.402, 'best_valid_valid/acc_align': 66.685, 'best_valid_test/acc': 85.247, 'best_valid_test/acc_unbiased': 66.388, 'best_valid_test/diff': 5.392, 'best_valid_test/acc_skew': 63.692, 'best_valid_test/acc_align': 69.084}
[1 / 10] best test accuracy: 66.388 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 85.424, 'best_test_valid/acc_unbiased': 64.543, 'best_test_valid/diff': 4.283, 'best_test_valid/acc_skew': 62.402, 'best_test_valid/acc_align': 66.685, 'best_test_test/acc': 85.247, 'best_test_test/acc_unbiased': 66.388, 'best_test_test/diff': 5.392, 'best_test_test/acc_skew': 63.692, 'best_test_test/acc_align': 69.084}
[2 / 10] Learning rate: 0.001 weight: 0.01
[2 / 10] Loss: 4.807552541142629 CE Loss: 0.28723047318120093 Con Loss: 4.804680225450226
[2 / 10] tensor([[0.974, 0.950],
        [0.533, 0.554]]) {'epoch': 2, 'valid/acc': 87.999, 'valid/acc_unbiased': 74.083, 'valid/diff': 1.097, 'valid/acc_skew': 73.534, 'valid/acc_align': 74.631, 'test/acc': 87.749, 'test/acc_unbiased': 75.296, 'test/diff': 2.251, 'test/acc_skew': 74.171, 'test/acc_align': 76.422}
[2 / 10] best valid accuracy: 74.083 at epoch 2 
 best_stats: {'best_valid_epoch': 2, 'best_valid_valid/acc': 87.999, 'best_valid_valid/acc_unbiased': 74.083, 'best_valid_valid/diff': 1.097, 'best_valid_valid/acc_skew': 73.534, 'best_valid_valid/acc_align': 74.631, 'best_valid_test/acc': 87.749, 'best_valid_test/acc_unbiased': 75.296, 'best_valid_test/diff': 2.251, 'best_valid_test/acc_skew': 74.171, 'best_valid_test/acc_align': 76.422}
[2 / 10] best test accuracy: 75.296 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 87.999, 'best_test_valid/acc_unbiased': 74.083, 'best_test_valid/diff': 1.097, 'best_test_valid/acc_skew': 73.534, 'best_test_valid/acc_align': 74.631, 'best_test_test/acc': 87.749, 'best_test_test/acc_unbiased': 75.296, 'best_test_test/diff': 2.251, 'best_test_test/acc_skew': 74.171, 'best_test_test/acc_align': 76.422}
[3 / 10] Learning rate: 0.001 weight: 0.01
[3 / 10] Loss: 4.802744059995129 CE Loss: 0.28124179214410405 Con Loss: 4.7999316481145495
[3 / 10] tensor([[0.977, 0.965],
        [0.485, 0.503]]) {'epoch': 3, 'valid/acc': 87.483, 'valid/acc_unbiased': 71.661, 'valid/diff': 1.482, 'valid/acc_skew': 70.92, 'valid/acc_align': 72.402, 'test/acc': 87.311, 'test/acc_unbiased': 73.265, 'test/diff': 1.525, 'test/acc_skew': 72.502, 'test/acc_align': 74.028}
[3 / 10] best valid accuracy: 74.083 at epoch 2 
 best_stats: {'best_valid_epoch': 2, 'best_valid_valid/acc': 87.999, 'best_valid_valid/acc_unbiased': 74.083, 'best_valid_valid/diff': 1.097, 'best_valid_valid/acc_skew': 73.534, 'best_valid_valid/acc_align': 74.631, 'best_valid_test/acc': 87.749, 'best_valid_test/acc_unbiased': 75.296, 'best_valid_test/diff': 2.251, 'best_valid_test/acc_skew': 74.171, 'best_valid_test/acc_align': 76.422}
[3 / 10] best test accuracy: 75.296 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 87.999, 'best_test_valid/acc_unbiased': 74.083, 'best_test_valid/diff': 1.097, 'best_test_valid/acc_skew': 73.534, 'best_test_valid/acc_align': 74.631, 'best_test_test/acc': 87.749, 'best_test_test/acc_unbiased': 75.296, 'best_test_test/diff': 2.251, 'best_test_test/acc_skew': 74.171, 'best_test_test/acc_align': 76.422}
[4 / 10] Learning rate: 0.0001 weight: 0.01
[4 / 10] Loss: 4.775391456650949 CE Loss: 0.24590120831443438 Con Loss: 4.7729324430685
[4 / 10] tensor([[0.957, 0.920],
        [0.720, 0.739]]) {'epoch': 4, 'valid/acc': 90.012, 'valid/acc_unbiased': 82.535, 'valid/diff': 2.037, 'valid/acc_skew': 81.516, 'valid/acc_align': 83.553, 'test/acc': 89.898, 'test/acc_unbiased': 83.412, 'test/diff': 2.865, 'test/acc_skew': 81.979, 'test/acc_align': 84.844}
[4 / 10] best valid accuracy: 82.535 at epoch 4 
 best_stats: {'best_valid_epoch': 4, 'best_valid_valid/acc': 90.012, 'best_valid_valid/acc_unbiased': 82.535, 'best_valid_valid/diff': 2.037, 'best_valid_valid/acc_skew': 81.516, 'best_valid_valid/acc_align': 83.553, 'best_valid_test/acc': 89.898, 'best_valid_test/acc_unbiased': 83.412, 'best_valid_test/diff': 2.865, 'best_valid_test/acc_skew': 81.979, 'best_valid_test/acc_align': 84.844}
[4 / 10] best test accuracy: 83.412 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 90.012, 'best_test_valid/acc_unbiased': 82.535, 'best_test_valid/diff': 2.037, 'best_test_valid/acc_skew': 81.516, 'best_test_valid/acc_align': 83.553, 'best_test_test/acc': 89.898, 'best_test_test/acc_unbiased': 83.412, 'best_test_test/diff': 2.865, 'best_test_test/acc_skew': 81.979, 'best_test_test/acc_align': 84.844}
[5 / 10] Learning rate: 0.0001 weight: 0.01
[5 / 10] Loss: 4.770130339429669 CE Loss: 0.23490298642920035 Con Loss: 4.767781301911444
[5 / 10] tensor([[0.970, 0.939],
        [0.670, 0.700]]) {'epoch': 5, 'valid/acc': 90.214, 'valid/acc_unbiased': 80.803, 'valid/diff': 2.859, 'valid/acc_skew': 79.374, 'valid/acc_align': 82.233, 'test/acc': 90.185, 'test/acc_unbiased': 81.979, 'test/diff': 3.082, 'test/acc_skew': 80.438, 'test/acc_align': 83.52}
[5 / 10] best valid accuracy: 82.535 at epoch 4 
 best_stats: {'best_valid_epoch': 4, 'best_valid_valid/acc': 90.012, 'best_valid_valid/acc_unbiased': 82.535, 'best_valid_valid/diff': 2.037, 'best_valid_valid/acc_skew': 81.516, 'best_valid_valid/acc_align': 83.553, 'best_valid_test/acc': 89.898, 'best_valid_test/acc_unbiased': 83.412, 'best_valid_test/diff': 2.865, 'best_valid_test/acc_skew': 81.979, 'best_valid_test/acc_align': 84.844}
[5 / 10] best test accuracy: 83.412 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 90.012, 'best_test_valid/acc_unbiased': 82.535, 'best_test_valid/diff': 2.037, 'best_test_valid/acc_skew': 81.516, 'best_test_valid/acc_align': 83.553, 'best_test_test/acc': 89.898, 'best_test_test/acc_unbiased': 83.412, 'best_test_test/diff': 2.865, 'best_test_test/acc_skew': 81.979, 'best_test_test/acc_align': 84.844}
[6 / 10] Learning rate: 0.0001 weight: 0.01
[6 / 10] Loss: 4.763967439734046 CE Loss: 0.2292433143335569 Con Loss: 4.761675000419112
[6 / 10] tensor([[0.960, 0.942],
        [0.736, 0.698]]) {'epoch': 6, 'valid/acc': 90.392, 'valid/acc_unbiased': 82.705, 'valid/diff': 2.623, 'valid/acc_skew': 83.245, 'valid/acc_align': 82.165, 'test/acc': 90.311, 'test/acc_unbiased': 83.414, 'test/diff': 2.779, 'test/acc_skew': 83.916, 'test/acc_align': 82.912}
[6 / 10] best valid accuracy: 82.705 at epoch 6 
 best_stats: {'best_valid_epoch': 6, 'best_valid_valid/acc': 90.392, 'best_valid_valid/acc_unbiased': 82.705, 'best_valid_valid/diff': 2.623, 'best_valid_valid/acc_skew': 83.245, 'best_valid_valid/acc_align': 82.165, 'best_valid_test/acc': 90.311, 'best_valid_test/acc_unbiased': 83.414, 'best_valid_test/diff': 2.779, 'best_valid_test/acc_skew': 83.916, 'best_valid_test/acc_align': 82.912}
[6 / 10] best test accuracy: 83.414 at epoch 6 
 best_stats: {'best_test_epoch': 6, 'best_test_valid/acc': 90.392, 'best_test_valid/acc_unbiased': 82.705, 'best_test_valid/diff': 2.623, 'best_test_valid/acc_skew': 83.245, 'best_test_valid/acc_align': 82.165, 'best_test_test/acc': 90.311, 'best_test_test/acc_unbiased': 83.414, 'best_test_test/diff': 2.779, 'best_test_test/acc_skew': 83.916, 'best_test_test/acc_align': 82.912}
[7 / 10] Learning rate: 1e-05 weight: 0.01
[7 / 10] Loss: 4.758405135429366 CE Loss: 0.22629985954346013 Con Loss: 4.7561421379174575
[7 / 10] tensor([[0.959, 0.937],
        [0.734, 0.730]]) {'epoch': 7, 'valid/acc': 90.72, 'valid/acc_unbiased': 83.389, 'valid/diff': 1.102, 'valid/acc_skew': 83.054, 'valid/acc_align': 83.725, 'test/acc': 90.517, 'test/acc_unbiased': 84.004, 'test/diff': 1.326, 'test/acc_skew': 83.544, 'test/acc_align': 84.465}
[7 / 10] best valid accuracy: 83.389 at epoch 7 
 best_stats: {'best_valid_epoch': 7, 'best_valid_valid/acc': 90.72, 'best_valid_valid/acc_unbiased': 83.389, 'best_valid_valid/diff': 1.102, 'best_valid_valid/acc_skew': 83.054, 'best_valid_valid/acc_align': 83.725, 'best_valid_test/acc': 90.517, 'best_valid_test/acc_unbiased': 84.004, 'best_valid_test/diff': 1.326, 'best_valid_test/acc_skew': 83.544, 'best_valid_test/acc_align': 84.465}
[7 / 10] best test accuracy: 84.004 at epoch 7 
 best_stats: {'best_test_epoch': 7, 'best_test_valid/acc': 90.72, 'best_test_valid/acc_unbiased': 83.389, 'best_test_valid/diff': 1.102, 'best_test_valid/acc_skew': 83.054, 'best_test_valid/acc_align': 83.725, 'best_test_test/acc': 90.517, 'best_test_test/acc_unbiased': 84.004, 'best_test_test/diff': 1.326, 'best_test_test/acc_skew': 83.544, 'best_test_test/acc_align': 84.465}
[8 / 10] Learning rate: 1e-05 weight: 0.01
[8 / 10] Loss: 4.757240425871887 CE Loss: 0.223364310425884 Con Loss: 4.755006786661922
[8 / 10] tensor([[0.957, 0.930],
        [0.747, 0.745]]) {'epoch': 8, 'valid/acc': 90.759, 'valid/acc_unbiased': 84.104, 'valid/diff': 1.663, 'valid/acc_skew': 83.899, 'valid/acc_align': 84.309, 'test/acc': 90.492, 'test/acc_unbiased': 84.468, 'test/diff': 1.462, 'test/acc_skew': 83.809, 'test/acc_align': 85.126}
[8 / 10] best valid accuracy: 84.104 at epoch 8 
 best_stats: {'best_valid_epoch': 8, 'best_valid_valid/acc': 90.759, 'best_valid_valid/acc_unbiased': 84.104, 'best_valid_valid/diff': 1.663, 'best_valid_valid/acc_skew': 83.899, 'best_valid_valid/acc_align': 84.309, 'best_valid_test/acc': 90.492, 'best_valid_test/acc_unbiased': 84.468, 'best_valid_test/diff': 1.462, 'best_valid_test/acc_skew': 83.809, 'best_valid_test/acc_align': 85.126}
[8 / 10] best test accuracy: 84.468 at epoch 8 
 best_stats: {'best_test_epoch': 8, 'best_test_valid/acc': 90.759, 'best_test_valid/acc_unbiased': 84.104, 'best_test_valid/diff': 1.663, 'best_test_valid/acc_skew': 83.899, 'best_test_valid/acc_align': 84.309, 'best_test_test/acc': 90.492, 'best_test_test/acc_unbiased': 84.468, 'best_test_test/diff': 1.462, 'best_test_test/acc_skew': 83.809, 'best_test_test/acc_align': 85.126}
[9 / 10] Learning rate: 1e-05 weight: 0.01
[9 / 10] Loss: 4.753429879676786 CE Loss: 0.22257772545435253 Con Loss: 4.751204103503355
[9 / 10] tensor([[0.960, 0.936],
        [0.721, 0.739]]) {'epoch': 9, 'valid/acc': 90.827, 'valid/acc_unbiased': 83.477, 'valid/diff': 1.255, 'valid/acc_skew': 82.849, 'valid/acc_align': 84.104, 'test/acc': 90.517, 'test/acc_unbiased': 83.904, 'test/diff': 2.087, 'test/acc_skew': 82.86, 'test/acc_align': 84.947}
[9 / 10] best valid accuracy: 84.104 at epoch 8 
 best_stats: {'best_valid_epoch': 8, 'best_valid_valid/acc': 90.759, 'best_valid_valid/acc_unbiased': 84.104, 'best_valid_valid/diff': 1.663, 'best_valid_valid/acc_skew': 83.899, 'best_valid_valid/acc_align': 84.309, 'best_valid_test/acc': 90.492, 'best_valid_test/acc_unbiased': 84.468, 'best_valid_test/diff': 1.462, 'best_valid_test/acc_skew': 83.809, 'best_valid_test/acc_align': 85.126}
[9 / 10] best test accuracy: 84.468 at epoch 8 
 best_stats: {'best_test_epoch': 8, 'best_test_valid/acc': 90.759, 'best_test_valid/acc_unbiased': 84.104, 'best_test_valid/diff': 1.663, 'best_test_valid/acc_skew': 83.899, 'best_test_valid/acc_align': 84.309, 'best_test_test/acc': 90.492, 'best_test_test/acc_unbiased': 84.468, 'best_test_test/diff': 1.462, 'best_test_test/acc_skew': 83.809, 'best_test_test/acc_align': 85.126}
[10 / 10] Learning rate: 1e-05 weight: 0.01
[10 / 10] Loss: 4.753322394524286 CE Loss: 0.22136057873095352 Con Loss: 4.751108784317471
[10 / 10] tensor([[0.968, 0.946],
        [0.684, 0.706]]) {'epoch': 10, 'valid/acc': 90.785, 'valid/acc_unbiased': 82.132, 'valid/diff': 1.453, 'valid/acc_skew': 81.405, 'valid/acc_align': 82.858, 'test/acc': 90.482, 'test/acc_unbiased': 82.613, 'test/diff': 2.181, 'test/acc_skew': 81.522, 'test/acc_align': 83.704}
[10 / 10] best valid accuracy: 84.104 at epoch 8 
 best_stats: {'best_valid_epoch': 8, 'best_valid_valid/acc': 90.759, 'best_valid_valid/acc_unbiased': 84.104, 'best_valid_valid/diff': 1.663, 'best_valid_valid/acc_skew': 83.899, 'best_valid_valid/acc_align': 84.309, 'best_valid_test/acc': 90.492, 'best_valid_test/acc_unbiased': 84.468, 'best_valid_test/diff': 1.462, 'best_valid_test/acc_skew': 83.809, 'best_valid_test/acc_align': 85.126}
[10 / 10] best test accuracy: 84.468 at epoch 8 
 best_stats: {'best_test_epoch': 8, 'best_test_valid/acc': 90.759, 'best_test_valid/acc_unbiased': 84.104, 'best_test_valid/diff': 1.663, 'best_test_valid/acc_skew': 83.899, 'best_test_valid/acc_align': 84.309, 'best_test_test/acc': 90.492, 'best_test_test/acc_unbiased': 84.468, 'best_test_test/diff': 1.462, 'best_test_test/acc_skew': 83.809, 'best_test_test/acc_align': 85.126}
Total training time: 1:51:59
