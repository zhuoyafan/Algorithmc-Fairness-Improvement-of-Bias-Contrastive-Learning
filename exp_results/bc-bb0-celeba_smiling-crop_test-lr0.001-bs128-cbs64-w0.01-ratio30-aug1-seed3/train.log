Log level set to: INFO
Set seed: 3
=======> Using Fixed Random Seed: 3 <========
save_path: exp_results/bc-bb0-celeba_smiling-crop_test-lr0.001-bs128-cbs64-w0.01-ratio30-aug1-seed3
get_celeba - split:train, aug: False, given_y: True, ratio: 0
use existing smiling indices from data/celeba/pickles/smiling
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [8009, 32847]
Target 1: [40621, 7981]
Binary Target 1
---------------------------
Target 0: [8009, 32847]
Target 1: [40621, 7981]
===================================
Normal Label Distribution: 
Target 0: [8009, 32847]
Target 1: [40621, 7981]
===================================
Use BiasedCelebASplit 
 target_attr: smiling split: train 
 tensor([[ 8009., 40621.],
        [32847.,  7981.]])
get_celeba - split:train, aug: 1, given_y: True, ratio: 30
use existing smiling indices from data/celeba/pickles/smiling
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [8017, 32729]
Target 1: [40802, 7910]
Binary Target 1
---------------------------
Target 0: [8017, 32729]
Target 1: [40802, 7910]
===================================
Normal Label Distribution: 
Target 0: [8017, 32729]
Target 1: [40802, 7910]
===================================
Use BiasedCelebASplit 
 target_attr: smiling split: train 
 tensor([[ 8017., 40802.],
        [32729.,  7910.]])
get_celeba - split:train_valid, aug: False, given_y: True, ratio: 0
use existing smiling indices from data/celeba/pickles/smiling
Use BiasedCelebASplit 
 target_attr: smiling split: train_valid 
 tensor([[ 1944., 10217.],
        [ 8222.,  1982.]])
get_celeba - split:valid, aug: False, given_y: True, ratio: 0
Use BiasedCelebASplit 
 target_attr: smiling split: valid 
 tensor([[5252., 6157.],
        [5013., 3445.]])
decay_epochs: [3, 6]
[1 / 10] Learning rate: 0.001 weight: 0.01
[1 / 10] Loss: 4.634661348264391 CE Loss: 0.26066398579595546 Con Loss: 4.632054707401089
[1 / 10] tensor([[0.944, 0.939],
        [0.893, 0.863]]) {'epoch': 1, 'valid/acc': 90.651, 'valid/acc_unbiased': 90.56, 'valid/diff': 1.608, 'valid/acc_skew': 90.056, 'valid/acc_align': 91.064, 'test/acc': 91.312, 'test/acc_unbiased': 90.999, 'test/diff': 1.734, 'test/acc_skew': 90.365, 'test/acc_align': 91.632}
[1 / 10] best valid accuracy: 90.560 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 90.651, 'best_valid_valid/acc_unbiased': 90.56, 'best_valid_valid/diff': 1.608, 'best_valid_valid/acc_skew': 90.056, 'best_valid_valid/acc_align': 91.064, 'best_valid_test/acc': 91.312, 'best_valid_test/acc_unbiased': 90.999, 'best_valid_test/diff': 1.734, 'best_valid_test/acc_skew': 90.365, 'best_valid_test/acc_align': 91.632}
[1 / 10] best test accuracy: 90.999 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 90.651, 'best_test_valid/acc_unbiased': 90.56, 'best_test_valid/diff': 1.608, 'best_test_valid/acc_skew': 90.056, 'best_test_valid/acc_align': 91.064, 'best_test_test/acc': 91.312, 'best_test_test/acc_unbiased': 90.999, 'best_test_test/diff': 1.734, 'best_test_test/acc_skew': 90.365, 'best_test_test/acc_align': 91.632}
[2 / 10] Learning rate: 0.001 weight: 0.01
[2 / 10] Loss: 4.597036903038674 CE Loss: 0.22357840383739633 Con Loss: 4.594801115433736
[2 / 10] tensor([[0.948, 0.928],
        [0.905, 0.903]]) {'epoch': 2, 'valid/acc': 91.724, 'valid/acc_unbiased': 92.179, 'valid/diff': 1.114, 'valid/acc_skew': 92.736, 'valid/acc_align': 91.622, 'test/acc': 92.188, 'test/acc_unbiased': 92.103, 'test/diff': 1.123, 'test/acc_skew': 92.544, 'test/acc_align': 91.663}
[2 / 10] best valid accuracy: 92.179 at epoch 2 
 best_stats: {'best_valid_epoch': 2, 'best_valid_valid/acc': 91.724, 'best_valid_valid/acc_unbiased': 92.179, 'best_valid_valid/diff': 1.114, 'best_valid_valid/acc_skew': 92.736, 'best_valid_valid/acc_align': 91.622, 'best_valid_test/acc': 92.188, 'best_valid_test/acc_unbiased': 92.103, 'best_valid_test/diff': 1.123, 'best_valid_test/acc_skew': 92.544, 'best_valid_test/acc_align': 91.663}
[2 / 10] best test accuracy: 92.103 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 91.724, 'best_test_valid/acc_unbiased': 92.179, 'best_test_valid/diff': 1.114, 'best_test_valid/acc_skew': 92.736, 'best_test_valid/acc_align': 91.622, 'best_test_test/acc': 92.188, 'best_test_test/acc_unbiased': 92.103, 'best_test_test/diff': 1.123, 'best_test_test/acc_skew': 92.544, 'best_test_test/acc_align': 91.663}
[3 / 10] Learning rate: 0.001 weight: 0.01
[3 / 10] Loss: 4.590661716774603 CE Loss: 0.21266273849260298 Con Loss: 4.588535088739521
[3 / 10] tensor([[0.970, 0.955],
        [0.873, 0.851]]) {'epoch': 3, 'valid/acc': 90.834, 'valid/acc_unbiased': 91.231, 'valid/diff': 1.135, 'valid/acc_skew': 91.216, 'valid/acc_align': 91.247, 'test/acc': 91.544, 'test/acc_unbiased': 91.212, 'test/diff': 1.882, 'test/acc_skew': 91.021, 'test/acc_align': 91.403}
[3 / 10] best valid accuracy: 92.179 at epoch 2 
 best_stats: {'best_valid_epoch': 2, 'best_valid_valid/acc': 91.724, 'best_valid_valid/acc_unbiased': 92.179, 'best_valid_valid/diff': 1.114, 'best_valid_valid/acc_skew': 92.736, 'best_valid_valid/acc_align': 91.622, 'best_valid_test/acc': 92.188, 'best_valid_test/acc_unbiased': 92.103, 'best_valid_test/diff': 1.123, 'best_valid_test/acc_skew': 92.544, 'best_valid_test/acc_align': 91.663}
[3 / 10] best test accuracy: 92.103 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 91.724, 'best_test_valid/acc_unbiased': 92.179, 'best_test_valid/diff': 1.114, 'best_test_valid/acc_skew': 92.736, 'best_test_valid/acc_align': 91.622, 'best_test_test/acc': 92.188, 'best_test_test/acc_unbiased': 92.103, 'best_test_test/diff': 1.123, 'best_test_test/acc_skew': 92.544, 'best_test_test/acc_align': 91.663}
[4 / 10] Learning rate: 0.0001 weight: 0.01
[4 / 10] Loss: 4.557746440635264 CE Loss: 0.18456247889469743 Con Loss: 4.555900814883487
[4 / 10] tensor([[0.924, 0.921],
        [0.937, 0.915]]) {'epoch': 4, 'valid/acc': 92.824, 'valid/acc_unbiased': 92.426, 'valid/diff': 1.433, 'valid/acc_skew': 91.931, 'valid/acc_align': 92.92, 'test/acc': 92.586, 'test/acc_unbiased': 92.44, 'test/diff': 1.216, 'test/acc_skew': 91.944, 'test/acc_align': 92.936}
[4 / 10] best valid accuracy: 92.426 at epoch 4 
 best_stats: {'best_valid_epoch': 4, 'best_valid_valid/acc': 92.824, 'best_valid_valid/acc_unbiased': 92.426, 'best_valid_valid/diff': 1.433, 'best_valid_valid/acc_skew': 91.931, 'best_valid_valid/acc_align': 92.92, 'best_valid_test/acc': 92.586, 'best_valid_test/acc_unbiased': 92.44, 'best_valid_test/diff': 1.216, 'best_valid_test/acc_skew': 91.944, 'best_valid_test/acc_align': 92.936}
[4 / 10] best test accuracy: 92.440 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 92.824, 'best_test_valid/acc_unbiased': 92.426, 'best_test_valid/diff': 1.433, 'best_test_valid/acc_skew': 91.931, 'best_test_valid/acc_align': 92.92, 'best_test_test/acc': 92.586, 'best_test_test/acc_unbiased': 92.44, 'best_test_test/diff': 1.216, 'best_test_test/acc_skew': 91.944, 'best_test_test/acc_align': 92.936}
[5 / 10] Learning rate: 0.0001 weight: 0.01
[5 / 10] Loss: 4.544225187117634 CE Loss: 0.1817899472229773 Con Loss: 4.542407278462476
[5 / 10] tensor([[0.932, 0.938],
        [0.935, 0.906]]) {'epoch': 5, 'valid/acc': 93.056, 'valid/acc_unbiased': 92.637, 'valid/diff': 1.347, 'valid/acc_skew': 91.963, 'valid/acc_align': 93.31, 'test/acc': 92.963, 'test/acc_unbiased': 92.744, 'test/diff': 1.739, 'test/acc_skew': 91.875, 'test/acc_align': 93.614}
[5 / 10] best valid accuracy: 92.637 at epoch 5 
 best_stats: {'best_valid_epoch': 5, 'best_valid_valid/acc': 93.056, 'best_valid_valid/acc_unbiased': 92.637, 'best_valid_valid/diff': 1.347, 'best_valid_valid/acc_skew': 91.963, 'best_valid_valid/acc_align': 93.31, 'best_valid_test/acc': 92.963, 'best_valid_test/acc_unbiased': 92.744, 'best_valid_test/diff': 1.739, 'best_valid_test/acc_skew': 91.875, 'best_valid_test/acc_align': 93.614}
[5 / 10] best test accuracy: 92.744 at epoch 5 
 best_stats: {'best_test_epoch': 5, 'best_test_valid/acc': 93.056, 'best_test_valid/acc_unbiased': 92.637, 'best_test_valid/diff': 1.347, 'best_test_valid/acc_skew': 91.963, 'best_test_valid/acc_align': 93.31, 'best_test_test/acc': 92.963, 'best_test_test/acc_unbiased': 92.744, 'best_test_test/diff': 1.739, 'best_test_test/acc_skew': 91.875, 'best_test_test/acc_align': 93.614}
[6 / 10] Learning rate: 0.0001 weight: 0.01
[6 / 10] Loss: 4.531691070245693 CE Loss: 0.17904250928943669 Con Loss: 4.529900635103523
[6 / 10] tensor([[0.945, 0.942],
        [0.924, 0.894]]) {'epoch': 6, 'valid/acc': 92.765, 'valid/acc_unbiased': 92.691, 'valid/diff': 1.21, 'valid/acc_skew': 92.407, 'valid/acc_align': 92.975, 'test/acc': 92.878, 'test/acc_unbiased': 92.615, 'test/diff': 1.629, 'test/acc_skew': 91.932, 'test/acc_align': 93.297}
[6 / 10] best valid accuracy: 92.691 at epoch 6 
 best_stats: {'best_valid_epoch': 6, 'best_valid_valid/acc': 92.765, 'best_valid_valid/acc_unbiased': 92.691, 'best_valid_valid/diff': 1.21, 'best_valid_valid/acc_skew': 92.407, 'best_valid_valid/acc_align': 92.975, 'best_valid_test/acc': 92.878, 'best_valid_test/acc_unbiased': 92.615, 'best_valid_test/diff': 1.629, 'best_valid_test/acc_skew': 91.932, 'best_valid_test/acc_align': 93.297}
[6 / 10] best test accuracy: 92.744 at epoch 5 
 best_stats: {'best_test_epoch': 5, 'best_test_valid/acc': 93.056, 'best_test_valid/acc_unbiased': 92.637, 'best_test_valid/diff': 1.347, 'best_test_valid/acc_skew': 91.963, 'best_test_valid/acc_align': 93.31, 'best_test_test/acc': 92.963, 'best_test_test/acc_unbiased': 92.744, 'best_test_test/diff': 1.739, 'best_test_test/acc_skew': 91.875, 'best_test_test/acc_align': 93.614}
[7 / 10] Learning rate: 1e-05 weight: 0.01
[7 / 10] Loss: 4.533004100063298 CE Loss: 0.17469546130417302 Con Loss: 4.531257140916018
[7 / 10] tensor([[0.930, 0.935],
        [0.938, 0.907]]) {'epoch': 7, 'valid/acc': 93.262, 'valid/acc_unbiased': 92.833, 'valid/diff': 1.237, 'valid/acc_skew': 92.214, 'valid/acc_align': 93.452, 'test/acc': 92.983, 'test/acc_unbiased': 92.759, 'test/diff': 1.795, 'test/acc_skew': 91.862, 'test/acc_align': 93.656}
[7 / 10] best valid accuracy: 92.833 at epoch 7 
 best_stats: {'best_valid_epoch': 7, 'best_valid_valid/acc': 93.262, 'best_valid_valid/acc_unbiased': 92.833, 'best_valid_valid/diff': 1.237, 'best_valid_valid/acc_skew': 92.214, 'best_valid_valid/acc_align': 93.452, 'best_valid_test/acc': 92.983, 'best_valid_test/acc_unbiased': 92.759, 'best_valid_test/diff': 1.795, 'best_valid_test/acc_skew': 91.862, 'best_valid_test/acc_align': 93.656}
[7 / 10] best test accuracy: 92.759 at epoch 7 
 best_stats: {'best_test_epoch': 7, 'best_test_valid/acc': 93.262, 'best_test_valid/acc_unbiased': 92.833, 'best_test_valid/diff': 1.237, 'best_test_valid/acc_skew': 92.214, 'best_test_valid/acc_align': 93.452, 'best_test_test/acc': 92.983, 'best_test_test/acc_unbiased': 92.759, 'best_test_test/diff': 1.795, 'best_test_test/acc_skew': 91.862, 'best_test_test/acc_align': 93.656}
[8 / 10] Learning rate: 1e-05 weight: 0.01
[8 / 10] Loss: 4.532626966176537 CE Loss: 0.1713952959575266 Con Loss: 4.5309130252813485
[8 / 10] tensor([[0.936, 0.937],
        [0.933, 0.906]]) {'epoch': 8, 'valid/acc': 93.043, 'valid/acc_unbiased': 92.76, 'valid/diff': 1.012, 'valid/acc_skew': 92.318, 'valid/acc_align': 93.203, 'test/acc': 93.034, 'test/acc_unbiased': 92.822, 'test/diff': 1.417, 'test/acc_skew': 92.113, 'test/acc_align': 93.53}
[8 / 10] best valid accuracy: 92.833 at epoch 7 
 best_stats: {'best_valid_epoch': 7, 'best_valid_valid/acc': 93.262, 'best_valid_valid/acc_unbiased': 92.833, 'best_valid_valid/diff': 1.237, 'best_valid_valid/acc_skew': 92.214, 'best_valid_valid/acc_align': 93.452, 'best_valid_test/acc': 92.983, 'best_valid_test/acc_unbiased': 92.759, 'best_valid_test/diff': 1.795, 'best_valid_test/acc_skew': 91.862, 'best_valid_test/acc_align': 93.656}
[8 / 10] best test accuracy: 92.822 at epoch 8 
 best_stats: {'best_test_epoch': 8, 'best_test_valid/acc': 93.043, 'best_test_valid/acc_unbiased': 92.76, 'best_test_valid/diff': 1.012, 'best_test_valid/acc_skew': 92.318, 'best_test_valid/acc_align': 93.203, 'best_test_test/acc': 93.034, 'best_test_test/acc_unbiased': 92.822, 'best_test_test/diff': 1.417, 'best_test_test/acc_skew': 92.113, 'best_test_test/acc_align': 93.53}
[9 / 10] Learning rate: 1e-05 weight: 0.01
[9 / 10] Loss: 4.521531465934176 CE Loss: 0.1710058888695514 Con Loss: 4.519821408347757
[9 / 10] tensor([[0.939, 0.942],
        [0.932, 0.893]]) {'epoch': 9, 'valid/acc': 93.315, 'valid/acc_unbiased': 92.992, 'valid/diff': 1.201, 'valid/acc_skew': 92.426, 'valid/acc_align': 93.558, 'test/acc': 92.943, 'test/acc_unbiased': 92.631, 'test/diff': 2.076, 'test/acc_skew': 91.593, 'test/acc_align': 93.669}
[9 / 10] best valid accuracy: 92.992 at epoch 9 
 best_stats: {'best_valid_epoch': 9, 'best_valid_valid/acc': 93.315, 'best_valid_valid/acc_unbiased': 92.992, 'best_valid_valid/diff': 1.201, 'best_valid_valid/acc_skew': 92.426, 'best_valid_valid/acc_align': 93.558, 'best_valid_test/acc': 92.943, 'best_valid_test/acc_unbiased': 92.631, 'best_valid_test/diff': 2.076, 'best_valid_test/acc_skew': 91.593, 'best_valid_test/acc_align': 93.669}
[9 / 10] best test accuracy: 92.822 at epoch 8 
 best_stats: {'best_test_epoch': 8, 'best_test_valid/acc': 93.043, 'best_test_valid/acc_unbiased': 92.76, 'best_test_valid/diff': 1.012, 'best_test_valid/acc_skew': 92.318, 'best_test_valid/acc_align': 93.203, 'best_test_test/acc': 93.034, 'best_test_test/acc_unbiased': 92.822, 'best_test_test/diff': 1.417, 'best_test_test/acc_skew': 92.113, 'best_test_test/acc_align': 93.53}
[10 / 10] Learning rate: 1e-05 weight: 0.01
[10 / 10] Loss: 4.524780667516563 CE Loss: 0.16894569520655392 Con Loss: 4.523091210150357
[10 / 10] tensor([[0.935, 0.937],
        [0.935, 0.904]]) {'epoch': 10, 'valid/acc': 93.222, 'valid/acc_unbiased': 92.884, 'valid/diff': 1.035, 'valid/acc_skew': 92.367, 'valid/acc_align': 93.402, 'test/acc': 93.014, 'test/acc_unbiased': 92.774, 'test/diff': 1.64, 'test/acc_skew': 91.954, 'test/acc_align': 93.594}
[10 / 10] best valid accuracy: 92.992 at epoch 9 
 best_stats: {'best_valid_epoch': 9, 'best_valid_valid/acc': 93.315, 'best_valid_valid/acc_unbiased': 92.992, 'best_valid_valid/diff': 1.201, 'best_valid_valid/acc_skew': 92.426, 'best_valid_valid/acc_align': 93.558, 'best_valid_test/acc': 92.943, 'best_valid_test/acc_unbiased': 92.631, 'best_valid_test/diff': 2.076, 'best_valid_test/acc_skew': 91.593, 'best_valid_test/acc_align': 93.669}
[10 / 10] best test accuracy: 92.822 at epoch 8 
 best_stats: {'best_test_epoch': 8, 'best_test_valid/acc': 93.043, 'best_test_valid/acc_unbiased': 92.76, 'best_test_valid/diff': 1.012, 'best_test_valid/acc_skew': 92.318, 'best_test_valid/acc_align': 93.203, 'best_test_test/acc': 93.034, 'best_test_test/acc_unbiased': 92.822, 'best_test_test/diff': 1.417, 'best_test_test/acc_skew': 92.113, 'best_test_test/acc_align': 93.53}
Total training time: 1:25:35
