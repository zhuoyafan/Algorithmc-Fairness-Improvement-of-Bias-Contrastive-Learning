Log level set to: INFO
Set seed: 3
=======> Using Fixed Random Seed: 3 <========
save_path: exp_results/bc-bb0-celeba_blonde-os_0.9-lr0.001-bs128-cbs64-w0.01-ratio30-aug1-seed3
get_celeba - split:train, aug: False, given_y: True, ratio: 0
use existing blonde indices from data/celeba/pickles/blonde
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [48137, 48137]
Target 1: [48137, 48137]
Binary Target 1
---------------------------
Target 0: [48137, 48137]
Target 1: [48137, 48137]
===================================
Normal Label Distribution: 
Target 0: [48137, 48137]
Target 1: [48137, 48137]
===================================
Use BiasedCelebASplit 
 target_attr: blonde split: train 
 tensor([[48137., 48137.],
        [48137., 48137.]])
get_celeba - split:train, aug: 1, given_y: True, ratio: 30
use existing blonde indices from data/celeba/pickles/blonde
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [48157, 48157]
Target 1: [48157, 48157]
Binary Target 1
---------------------------
Target 0: [48157, 48157]
Target 1: [48157, 48157]
===================================
Normal Label Distribution: 
Target 0: [48157, 48157]
Target 1: [48157, 48157]
===================================
Use BiasedCelebASplit 
 target_attr: blonde split: train 
 tensor([[48157., 48157.],
        [48157., 48157.]])
get_celeba - split:train_valid, aug: False, given_y: True, ratio: 0
use existing blonde indices from data/celeba/pickles/blonde
Use BiasedCelebASplit 
 target_attr: blonde split: train_valid 
 tensor([[  386.,  4517.],
        [13446.,   280.]])
get_celeba - split:valid, aug: False, given_y: True, ratio: 0
Use BiasedCelebASplit 
 target_attr: blonde split: valid 
 tensor([[8535., 2874.],
        [8276.,  182.]])
decay_epochs: [3, 6]
[1 / 10] Learning rate: 0.001 weight: 0.01
[1 / 10] Loss: 4.615227200976683 CE Loss: 0.23907100753357782 Con Loss: 4.612836490757264
[1 / 10] tensor([[0.926, 0.963],
        [0.880, 0.852]]) {'epoch': 1, 'valid/acc': 93.575, 'valid/acc_unbiased': 90.212, 'valid/diff': 4.954, 'valid/acc_skew': 92.69, 'valid/acc_align': 87.735, 'test/acc': 93.396, 'test/acc_unbiased': 90.509, 'test/diff': 3.281, 'test/acc_skew': 90.284, 'test/acc_align': 90.734}
[1 / 10] best valid accuracy: 90.212 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 93.575, 'best_valid_valid/acc_unbiased': 90.212, 'best_valid_valid/diff': 4.954, 'best_valid_valid/acc_skew': 92.69, 'best_valid_valid/acc_align': 87.735, 'best_valid_test/acc': 93.396, 'best_valid_test/acc_unbiased': 90.509, 'best_valid_test/diff': 3.281, 'best_valid_test/acc_skew': 90.284, 'best_valid_test/acc_align': 90.734}
[1 / 10] best test accuracy: 90.509 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 93.575, 'best_test_valid/acc_unbiased': 90.212, 'best_test_valid/diff': 4.954, 'best_test_valid/acc_skew': 92.69, 'best_test_valid/acc_align': 87.735, 'best_test_test/acc': 93.396, 'best_test_test/acc_unbiased': 90.509, 'best_test_test/diff': 3.281, 'best_test_test/acc_skew': 90.284, 'best_test_test/acc_align': 90.734}
[2 / 10] Learning rate: 0.001 weight: 0.01
[2 / 10] Loss: 4.564114991367998 CE Loss: 0.20573311171687297 Con Loss: 4.562057661356903
[2 / 10] tensor([[0.840, 0.924],
        [0.963, 0.896]]) {'epoch': 2, 'valid/acc': 93.118, 'valid/acc_unbiased': 93.164, 'valid/diff': 2.44, 'valid/acc_skew': 94.384, 'valid/acc_align': 91.944, 'test/acc': 89.339, 'test/acc_unbiased': 90.567, 'test/diff': 7.555, 'test/acc_skew': 90.148, 'test/acc_align': 90.986}
[2 / 10] best valid accuracy: 93.164 at epoch 2 
 best_stats: {'best_valid_epoch': 2, 'best_valid_valid/acc': 93.118, 'best_valid_valid/acc_unbiased': 93.164, 'best_valid_valid/diff': 2.44, 'best_valid_valid/acc_skew': 94.384, 'best_valid_valid/acc_align': 91.944, 'best_valid_test/acc': 89.339, 'best_valid_test/acc_unbiased': 90.567, 'best_valid_test/diff': 7.555, 'best_valid_test/acc_skew': 90.148, 'best_valid_test/acc_align': 90.986}
[2 / 10] best test accuracy: 90.567 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 93.118, 'best_test_valid/acc_unbiased': 93.164, 'best_test_valid/diff': 2.44, 'best_test_valid/acc_skew': 94.384, 'best_test_valid/acc_align': 91.944, 'best_test_test/acc': 89.339, 'best_test_test/acc_unbiased': 90.567, 'best_test_test/diff': 7.555, 'best_test_test/acc_skew': 90.148, 'best_test_test/acc_align': 90.986}
[3 / 10] Learning rate: 0.001 weight: 0.01
[3 / 10] Loss: 4.536538626409343 CE Loss: 0.19104151326861085 Con Loss: 4.534628214238699
[3 / 10] tensor([[0.893, 0.968],
        [0.931, 0.819]]) {'epoch': 3, 'valid/acc': 95.228, 'valid/acc_unbiased': 92.019, 'valid/diff': 5.732, 'valid/acc_skew': 94.885, 'valid/acc_align': 89.153, 'test/acc': 92.893, 'test/acc_unbiased': 90.255, 'test/diff': 9.351, 'test/acc_skew': 91.184, 'test/acc_align': 89.327}
[3 / 10] best valid accuracy: 93.164 at epoch 2 
 best_stats: {'best_valid_epoch': 2, 'best_valid_valid/acc': 93.118, 'best_valid_valid/acc_unbiased': 93.164, 'best_valid_valid/diff': 2.44, 'best_valid_valid/acc_skew': 94.384, 'best_valid_valid/acc_align': 91.944, 'best_valid_test/acc': 89.339, 'best_valid_test/acc_unbiased': 90.567, 'best_valid_test/diff': 7.555, 'best_valid_test/acc_skew': 90.148, 'best_valid_test/acc_align': 90.986}
[3 / 10] best test accuracy: 90.567 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 93.118, 'best_test_valid/acc_unbiased': 93.164, 'best_test_valid/diff': 2.44, 'best_test_valid/acc_skew': 94.384, 'best_test_valid/acc_align': 91.944, 'best_test_test/acc': 89.339, 'best_test_test/acc_unbiased': 90.567, 'best_test_test/diff': 7.555, 'best_test_test/acc_skew': 90.148, 'best_test_test/acc_align': 90.986}
[4 / 10] Learning rate: 0.0001 weight: 0.01
[4 / 10] Loss: 4.4556914435580675 CE Loss: 0.15401961204784906 Con Loss: 4.454151247967056
[4 / 10] tensor([[0.855, 0.949],
        [0.962, 0.874]]) {'epoch': 4, 'valid/acc': 94.852, 'valid/acc_unbiased': 95.699, 'valid/diff': 2.535, 'valid/acc_skew': 96.967, 'valid/acc_align': 94.432, 'test/acc': 91.005, 'test/acc_unbiased': 91.012, 'test/diff': 9.131, 'test/acc_skew': 90.886, 'test/acc_align': 91.138}
[4 / 10] best valid accuracy: 95.699 at epoch 4 
 best_stats: {'best_valid_epoch': 4, 'best_valid_valid/acc': 94.852, 'best_valid_valid/acc_unbiased': 95.699, 'best_valid_valid/diff': 2.535, 'best_valid_valid/acc_skew': 96.967, 'best_valid_valid/acc_align': 94.432, 'best_valid_test/acc': 91.005, 'best_valid_test/acc_unbiased': 91.012, 'best_valid_test/diff': 9.131, 'best_valid_test/acc_skew': 90.886, 'best_valid_test/acc_align': 91.138}
[4 / 10] best test accuracy: 91.012 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 94.852, 'best_test_valid/acc_unbiased': 95.699, 'best_test_valid/diff': 2.535, 'best_test_valid/acc_skew': 96.967, 'best_test_valid/acc_align': 94.432, 'best_test_test/acc': 91.005, 'best_test_test/acc_unbiased': 91.012, 'best_test_test/diff': 9.131, 'best_test_test/acc_skew': 90.886, 'best_test_test/acc_align': 91.138}
[5 / 10] Learning rate: 0.0001 weight: 0.01
[5 / 10] Loss: 4.427133687351768 CE Loss: 0.13835965369484804 Con Loss: 4.425750090880405
[5 / 10] tensor([[0.826, 0.949],
        [0.969, 0.879]]) {'epoch': 5, 'valid/acc': 95.276, 'valid/acc_unbiased': 96.123, 'valid/diff': 3.114, 'valid/acc_skew': 97.68, 'valid/acc_align': 94.566, 'test/acc': 89.822, 'test/acc_unbiased': 90.568, 'test/diff': 10.669, 'test/acc_skew': 89.729, 'test/acc_align': 91.407}
[5 / 10] best valid accuracy: 96.123 at epoch 5 
 best_stats: {'best_valid_epoch': 5, 'best_valid_valid/acc': 95.276, 'best_valid_valid/acc_unbiased': 96.123, 'best_valid_valid/diff': 3.114, 'best_valid_valid/acc_skew': 97.68, 'best_valid_valid/acc_align': 94.566, 'best_valid_test/acc': 89.822, 'best_valid_test/acc_unbiased': 90.568, 'best_valid_test/diff': 10.669, 'best_valid_test/acc_skew': 89.729, 'best_valid_test/acc_align': 91.407}
[5 / 10] best test accuracy: 91.012 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 94.852, 'best_test_valid/acc_unbiased': 95.699, 'best_test_valid/diff': 2.535, 'best_test_valid/acc_skew': 96.967, 'best_test_valid/acc_align': 94.432, 'best_test_test/acc': 91.005, 'best_test_test/acc_unbiased': 91.012, 'best_test_test/diff': 9.131, 'best_test_test/acc_skew': 90.886, 'best_test_test/acc_align': 91.138}
[6 / 10] Learning rate: 0.0001 weight: 0.01
[6 / 10] Loss: 4.40201353151614 CE Loss: 0.13204101372595245 Con Loss: 4.400693114239671
[6 / 10] tensor([[0.817, 0.949],
        [0.971, 0.874]]) {'epoch': 6, 'valid/acc': 95.142, 'valid/acc_unbiased': 96.154, 'valid/diff': 1.607, 'valid/acc_skew': 96.958, 'valid/acc_align': 95.351, 'test/acc': 89.47, 'test/acc_unbiased': 90.263, 'test/diff': 11.487, 'test/acc_skew': 89.394, 'test/acc_align': 91.132}
[6 / 10] best valid accuracy: 96.154 at epoch 6 
 best_stats: {'best_valid_epoch': 6, 'best_valid_valid/acc': 95.142, 'best_valid_valid/acc_unbiased': 96.154, 'best_valid_valid/diff': 1.607, 'best_valid_valid/acc_skew': 96.958, 'best_valid_valid/acc_align': 95.351, 'best_valid_test/acc': 89.47, 'best_valid_test/acc_unbiased': 90.263, 'best_valid_test/diff': 11.487, 'best_valid_test/acc_skew': 89.394, 'best_valid_test/acc_align': 91.132}
[6 / 10] best test accuracy: 91.012 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 94.852, 'best_test_valid/acc_unbiased': 95.699, 'best_test_valid/diff': 2.535, 'best_test_valid/acc_skew': 96.967, 'best_test_valid/acc_align': 94.432, 'best_test_test/acc': 91.005, 'best_test_test/acc_unbiased': 91.012, 'best_test_test/diff': 9.131, 'best_test_test/acc_skew': 90.886, 'best_test_test/acc_align': 91.138}
[7 / 10] Learning rate: 1e-05 weight: 0.01
[7 / 10] Loss: 4.384866851277114 CE Loss: 0.12428319529353635 Con Loss: 4.383624016695034
[7 / 10] tensor([[0.839, 0.962],
        [0.965, 0.819]]) {'epoch': 7, 'valid/acc': 96.033, 'valid/acc_unbiased': 96.792, 'valid/diff': 2.287, 'valid/acc_skew': 97.935, 'valid/acc_align': 95.648, 'test/acc': 90.839, 'test/acc_unbiased': 89.627, 'test/diff': 13.461, 'test/acc_skew': 90.223, 'test/acc_align': 89.031}
[7 / 10] best valid accuracy: 96.792 at epoch 7 
 best_stats: {'best_valid_epoch': 7, 'best_valid_valid/acc': 96.033, 'best_valid_valid/acc_unbiased': 96.792, 'best_valid_valid/diff': 2.287, 'best_valid_valid/acc_skew': 97.935, 'best_valid_valid/acc_align': 95.648, 'best_valid_test/acc': 90.839, 'best_valid_test/acc_unbiased': 89.627, 'best_valid_test/diff': 13.461, 'best_valid_test/acc_skew': 90.223, 'best_valid_test/acc_align': 89.031}
[7 / 10] best test accuracy: 91.012 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 94.852, 'best_test_valid/acc_unbiased': 95.699, 'best_test_valid/diff': 2.535, 'best_test_valid/acc_skew': 96.967, 'best_test_valid/acc_align': 94.432, 'best_test_test/acc': 91.005, 'best_test_test/acc_unbiased': 91.012, 'best_test_test/diff': 9.131, 'best_test_test/acc_skew': 90.886, 'best_test_test/acc_align': 91.138}
[8 / 10] Learning rate: 1e-05 weight: 0.01
[8 / 10] Loss: 4.377864912752522 CE Loss: 0.12253924680072656 Con Loss: 4.376639519155423
[8 / 10] tensor([[0.827, 0.957],
        [0.972, 0.852]]) {'epoch': 8, 'valid/acc': 95.679, 'valid/acc_unbiased': 96.536, 'valid/diff': 2.355, 'valid/acc_skew': 97.713, 'valid/acc_align': 95.358, 'test/acc': 90.245, 'test/acc_unbiased': 90.194, 'test/diff': 12.481, 'test/acc_skew': 89.962, 'test/acc_align': 90.426}
[8 / 10] best valid accuracy: 96.792 at epoch 7 
 best_stats: {'best_valid_epoch': 7, 'best_valid_valid/acc': 96.033, 'best_valid_valid/acc_unbiased': 96.792, 'best_valid_valid/diff': 2.287, 'best_valid_valid/acc_skew': 97.935, 'best_valid_valid/acc_align': 95.648, 'best_valid_test/acc': 90.839, 'best_valid_test/acc_unbiased': 89.627, 'best_valid_test/diff': 13.461, 'best_valid_test/acc_skew': 90.223, 'best_valid_test/acc_align': 89.031}
[8 / 10] best test accuracy: 91.012 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 94.852, 'best_test_valid/acc_unbiased': 95.699, 'best_test_valid/diff': 2.535, 'best_test_valid/acc_skew': 96.967, 'best_test_valid/acc_align': 94.432, 'best_test_test/acc': 91.005, 'best_test_test/acc_unbiased': 91.012, 'best_test_test/diff': 9.131, 'best_test_test/acc_skew': 90.886, 'best_test_test/acc_align': 91.138}
[9 / 10] Learning rate: 1e-05 weight: 0.01
[9 / 10] Loss: 4.376347587653284 CE Loss: 0.12061274569493761 Con Loss: 4.375141457338303
[9 / 10] tensor([[0.834, 0.961],
        [0.968, 0.813]]) {'epoch': 9, 'valid/acc': 96.017, 'valid/acc_unbiased': 96.613, 'valid/diff': 2.369, 'valid/acc_skew': 97.798, 'valid/acc_align': 95.429, 'test/acc': 90.592, 'test/acc_unbiased': 89.394, 'test/diff': 14.095, 'test/acc_skew': 90.087, 'test/acc_align': 88.702}
[9 / 10] best valid accuracy: 96.792 at epoch 7 
 best_stats: {'best_valid_epoch': 7, 'best_valid_valid/acc': 96.033, 'best_valid_valid/acc_unbiased': 96.792, 'best_valid_valid/diff': 2.287, 'best_valid_valid/acc_skew': 97.935, 'best_valid_valid/acc_align': 95.648, 'best_valid_test/acc': 90.839, 'best_valid_test/acc_unbiased': 89.627, 'best_valid_test/diff': 13.461, 'best_valid_test/acc_skew': 90.223, 'best_valid_test/acc_align': 89.031}
[9 / 10] best test accuracy: 91.012 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 94.852, 'best_test_valid/acc_unbiased': 95.699, 'best_test_valid/diff': 2.535, 'best_test_valid/acc_skew': 96.967, 'best_test_valid/acc_align': 94.432, 'best_test_test/acc': 91.005, 'best_test_test/acc_unbiased': 91.012, 'best_test_test/diff': 9.131, 'best_test_test/acc_skew': 90.886, 'best_test_test/acc_align': 91.138}
[10 / 10] Learning rate: 1e-05 weight: 0.01
[10 / 10] Loss: 4.3733728916566745 CE Loss: 0.12036792112081654 Con Loss: 4.372169207022906
[10 / 10] tensor([[0.831, 0.961],
        [0.970, 0.824]]) {'epoch': 10, 'valid/acc': 95.995, 'valid/acc_unbiased': 96.679, 'valid/diff': 2.15, 'valid/acc_skew': 97.754, 'valid/acc_align': 95.604, 'test/acc': 90.537, 'test/acc_unbiased': 89.666, 'test/diff': 13.821, 'test/acc_skew': 90.05, 'test/acc_align': 89.282}
[10 / 10] best valid accuracy: 96.792 at epoch 7 
 best_stats: {'best_valid_epoch': 7, 'best_valid_valid/acc': 96.033, 'best_valid_valid/acc_unbiased': 96.792, 'best_valid_valid/diff': 2.287, 'best_valid_valid/acc_skew': 97.935, 'best_valid_valid/acc_align': 95.648, 'best_valid_test/acc': 90.839, 'best_valid_test/acc_unbiased': 89.627, 'best_valid_test/diff': 13.461, 'best_valid_test/acc_skew': 90.223, 'best_valid_test/acc_align': 89.031}
[10 / 10] best test accuracy: 91.012 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 94.852, 'best_test_valid/acc_unbiased': 95.699, 'best_test_valid/diff': 2.535, 'best_test_valid/acc_skew': 96.967, 'best_test_valid/acc_align': 94.432, 'best_test_test/acc': 91.005, 'best_test_test/acc_unbiased': 91.012, 'best_test_test/diff': 9.131, 'best_test_test/acc_skew': 90.886, 'best_test_test/acc_align': 91.138}
Total training time: 3:11:54
