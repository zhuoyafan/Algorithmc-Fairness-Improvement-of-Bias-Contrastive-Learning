Log level set to: INFO
Set seed: 2
=======> Using Fixed Random Seed: 2 <========
save_path: exp_results/bc-bb0-utk_face_age-crop_cutout_rotate-0.9-lr0.001-bs128-cbs64-w0.01-ratio10-aug1-seed2
get_utk_face - split: train, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_age-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
Binary Target 1
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Normal Label Distribution: 
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
Binary Target 1
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Normal Label Distribution: 
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 10684, target_attr: gender, bias_attr: age bias_rate: 0.9
['[train] target_0-bias_0: 8237', '[train] target_0-bias_1: 147', '[train] target_1-bias_0: 823', '[train] target_1-bias_1: 1477']
confusion_matrix - 
 original: tensor([[8237.,  823.],
        [ 147., 1477.]]), 
 normalized: tensor([[0.909, 0.091],
        [0.091, 0.909]]), 
 b|y: tensor([[0.982, 0.018],
        [0.358, 0.642]])
get_utk_face - split: train, aug: 1, given_y: True, ratio: 10
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_age-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
Binary Target 1
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Normal Label Distribution: 
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
Binary Target 1
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Normal Label Distribution: 
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 10684, target_attr: gender, bias_attr: age bias_rate: 0.9
['[train] target_0-bias_0: 8237', '[train] target_0-bias_1: 147', '[train] target_1-bias_0: 823', '[train] target_1-bias_1: 1477']
get_utk_face - split: valid, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_age-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [1030, 195]
Target 1: [841, 202]
Binary Target 1
---------------------------
Target 0: [1030, 195]
Target 1: [841, 202]
===================================
Normal Label Distribution: 
Target 0: [1030, 195]
Target 1: [841, 202]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 2268, target_attr: gender, bias_attr: age bias_rate: 0.9
['[valid] target_0-bias_0: 1030', '[valid] target_0-bias_1: 195', '[valid] target_1-bias_0: 841', '[valid] target_1-bias_1: 202']
get_utk_face - split: test, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_age-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [1061, 176]
Target 1: [867, 165]
Binary Target 1
---------------------------
Target 0: [1061, 176]
Target 1: [867, 165]
===================================
Normal Label Distribution: 
Target 0: [1061, 176]
Target 1: [867, 165]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 2269, target_attr: gender, bias_attr: age bias_rate: 0.9
['[test] target_0-bias_0: 1061', '[test] target_0-bias_1: 176', '[test] target_1-bias_0: 867', '[test] target_1-bias_1: 165']
decay_epochs: [6, 13]
[1 / 20] Learning rate: 0.001 weight: 0.01
[1 / 20] Loss: 4.854686108299607 CE Loss: 0.5639346906171225 Con Loss: 4.8490467628527565
[1 / 20] tensor([[1., 1.],
        [0., 0.]]) {'epoch': 1, 'valid/acc': 54.012, 'valid/acc_unbiased': 50.0, 'valid/diff': 0.0, 'valid/acc_skew': 50.0, 'valid/acc_align': 50.0, 'test/acc': 54.517, 'test/acc_unbiased': 50.0, 'test/diff': 0.0, 'test/acc_skew': 50.0, 'test/acc_align': 50.0}
[1 / 20] best valid accuracy: 50.000 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 54.012, 'best_valid_valid/acc_unbiased': 50.0, 'best_valid_valid/diff': 0.0, 'best_valid_valid/acc_skew': 50.0, 'best_valid_valid/acc_align': 50.0, 'best_valid_test/acc': 54.517, 'best_valid_test/acc_unbiased': 50.0, 'best_valid_test/diff': 0.0, 'best_valid_test/acc_skew': 50.0, 'best_valid_test/acc_align': 50.0}
[1 / 20] best test accuracy: 50.000 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 54.012, 'best_test_valid/acc_unbiased': 50.0, 'best_test_valid/diff': 0.0, 'best_test_valid/acc_skew': 50.0, 'best_test_valid/acc_align': 50.0, 'best_test_test/acc': 54.517, 'best_test_test/acc_unbiased': 50.0, 'best_test_test/diff': 0.0, 'best_test_test/acc_skew': 50.0, 'best_test_test/acc_align': 50.0}
[2 / 20] Learning rate: 0.001 weight: 0.01
[2 / 20] Loss: 4.720165444063096 CE Loss: 0.538480739096317 Con Loss: 4.714780635576666
[2 / 20] tensor([[0.988, 0.994],
        [0.029, 0.018]]) {'epoch': 2, 'valid/acc': 54.541, 'valid/acc_unbiased': 50.782, 'valid/diff': 0.457, 'valid/acc_skew': 51.011, 'valid/acc_align': 50.553, 'test/acc': 55.134, 'test/acc_unbiased': 50.727, 'test/diff': 0.861, 'test/acc_skew': 51.158, 'test/acc_align': 50.296}
[2 / 20] best valid accuracy: 50.782 at epoch 2 
 best_stats: {'best_valid_epoch': 2, 'best_valid_valid/acc': 54.541, 'best_valid_valid/acc_unbiased': 50.782, 'best_valid_valid/diff': 0.457, 'best_valid_valid/acc_skew': 51.011, 'best_valid_valid/acc_align': 50.553, 'best_valid_test/acc': 55.134, 'best_valid_test/acc_unbiased': 50.727, 'best_valid_test/diff': 0.861, 'best_valid_test/acc_skew': 51.158, 'best_valid_test/acc_align': 50.296}
[2 / 20] best test accuracy: 50.727 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 54.541, 'best_test_valid/acc_unbiased': 50.782, 'best_test_valid/diff': 0.457, 'best_test_valid/acc_skew': 51.011, 'best_test_valid/acc_align': 50.553, 'best_test_test/acc': 55.134, 'best_test_test/acc_unbiased': 50.727, 'best_test_test/diff': 0.861, 'best_test_test/acc_skew': 51.158, 'best_test_test/acc_align': 50.296}
[3 / 20] Learning rate: 0.001 weight: 0.01
[3 / 20] Loss: 4.747358567078254 CE Loss: 0.5352651469942248 Con Loss: 4.742005908770403
[3 / 20] tensor([[0.979, 0.994],
        [0.036, 0.006]]) {'epoch': 3, 'valid/acc': 54.497, 'valid/acc_unbiased': 50.52, 'valid/diff': 1.895, 'valid/acc_skew': 51.468, 'valid/acc_align': 49.573, 'test/acc': 54.914, 'test/acc_unbiased': 50.385, 'test/diff': 2.237, 'test/acc_skew': 51.504, 'test/acc_align': 49.266}
[3 / 20] best valid accuracy: 50.782 at epoch 2 
 best_stats: {'best_valid_epoch': 2, 'best_valid_valid/acc': 54.541, 'best_valid_valid/acc_unbiased': 50.782, 'best_valid_valid/diff': 0.457, 'best_valid_valid/acc_skew': 51.011, 'best_valid_valid/acc_align': 50.553, 'best_valid_test/acc': 55.134, 'best_valid_test/acc_unbiased': 50.727, 'best_valid_test/diff': 0.861, 'best_valid_test/acc_skew': 51.158, 'best_valid_test/acc_align': 50.296}
[3 / 20] best test accuracy: 50.727 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 54.541, 'best_test_valid/acc_unbiased': 50.782, 'best_test_valid/diff': 0.457, 'best_test_valid/acc_skew': 51.011, 'best_test_valid/acc_align': 50.553, 'best_test_test/acc': 55.134, 'best_test_test/acc_unbiased': 50.727, 'best_test_test/diff': 0.861, 'best_test_test/acc_skew': 51.158, 'best_test_test/acc_align': 50.296}
[4 / 20] Learning rate: 0.001 weight: 0.01
[4 / 20] Loss: 4.711686562438531 CE Loss: 0.5309399580161074 Con Loss: 4.706377176701108
[4 / 20] tensor([[0.994, 0.994],
        [0.016, 0.012]]) {'epoch': 4, 'valid/acc': 54.409, 'valid/acc_unbiased': 50.291, 'valid/diff': 0.618, 'valid/acc_skew': 50.379, 'valid/acc_align': 50.204, 'test/acc': 54.914, 'test/acc_unbiased': 50.423, 'test/diff': 0.203, 'test/acc_skew': 50.523, 'test/acc_align': 50.323}
[4 / 20] best valid accuracy: 50.782 at epoch 2 
 best_stats: {'best_valid_epoch': 2, 'best_valid_valid/acc': 54.541, 'best_valid_valid/acc_unbiased': 50.782, 'best_valid_valid/diff': 0.457, 'best_valid_valid/acc_skew': 51.011, 'best_valid_valid/acc_align': 50.553, 'best_valid_test/acc': 55.134, 'best_valid_test/acc_unbiased': 50.727, 'best_valid_test/diff': 0.861, 'best_valid_test/acc_skew': 51.158, 'best_valid_test/acc_align': 50.296}
[4 / 20] best test accuracy: 50.727 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 54.541, 'best_test_valid/acc_unbiased': 50.782, 'best_test_valid/diff': 0.457, 'best_test_valid/acc_skew': 51.011, 'best_test_valid/acc_align': 50.553, 'best_test_test/acc': 55.134, 'best_test_test/acc_unbiased': 50.727, 'best_test_test/diff': 0.861, 'best_test_test/acc_skew': 51.158, 'best_test_test/acc_align': 50.296}
[5 / 20] Learning rate: 0.001 weight: 0.01
[5 / 20] Loss: 4.675731940824679 CE Loss: 0.5319561814824457 Con Loss: 4.670412346023337
[5 / 20] tensor([[0.993, 1.000],
        [0.022, 0.012]]) {'epoch': 5, 'valid/acc': 55.071, 'valid/acc_unbiased': 51.045, 'valid/diff': 1.478, 'valid/acc_skew': 51.784, 'valid/acc_align': 50.306, 'test/acc': 55.134, 'test/acc_unbiased': 50.686, 'test/diff': 0.82, 'test/acc_skew': 51.096, 'test/acc_align': 50.276}
[5 / 20] best valid accuracy: 51.045 at epoch 5 
 best_stats: {'best_valid_epoch': 5, 'best_valid_valid/acc': 55.071, 'best_valid_valid/acc_unbiased': 51.045, 'best_valid_valid/diff': 1.478, 'best_valid_valid/acc_skew': 51.784, 'best_valid_valid/acc_align': 50.306, 'best_valid_test/acc': 55.134, 'best_valid_test/acc_unbiased': 50.686, 'best_valid_test/diff': 0.82, 'best_valid_test/acc_skew': 51.096, 'best_valid_test/acc_align': 50.276}
[5 / 20] best test accuracy: 50.727 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 54.541, 'best_test_valid/acc_unbiased': 50.782, 'best_test_valid/diff': 0.457, 'best_test_valid/acc_skew': 51.011, 'best_test_valid/acc_align': 50.553, 'best_test_test/acc': 55.134, 'best_test_test/acc_unbiased': 50.727, 'best_test_test/diff': 0.861, 'best_test_test/acc_skew': 51.158, 'best_test_test/acc_align': 50.296}
[6 / 20] Learning rate: 0.001 weight: 0.01
[6 / 20] Loss: 4.679385098836164 CE Loss: 0.5260069308121166 Con Loss: 4.67412504548216
[6 / 20] tensor([[1.000, 1.000],
        [0.003, 0.000]]) {'epoch': 6, 'valid/acc': 54.101, 'valid/acc_unbiased': 49.966, 'valid/diff': 0.446, 'valid/acc_skew': 49.981, 'valid/acc_align': 49.951, 'test/acc': 54.65, 'test/acc_unbiased': 50.087, 'test/diff': 0.173, 'test/acc_skew': 50.173, 'test/acc_align': 50.0}
[6 / 20] best valid accuracy: 51.045 at epoch 5 
 best_stats: {'best_valid_epoch': 5, 'best_valid_valid/acc': 55.071, 'best_valid_valid/acc_unbiased': 51.045, 'best_valid_valid/diff': 1.478, 'best_valid_valid/acc_skew': 51.784, 'best_valid_valid/acc_align': 50.306, 'best_valid_test/acc': 55.134, 'best_valid_test/acc_unbiased': 50.686, 'best_valid_test/diff': 0.82, 'best_valid_test/acc_skew': 51.096, 'best_valid_test/acc_align': 50.276}
[6 / 20] best test accuracy: 50.727 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 54.541, 'best_test_valid/acc_unbiased': 50.782, 'best_test_valid/diff': 0.457, 'best_test_valid/acc_skew': 51.011, 'best_test_valid/acc_align': 50.553, 'best_test_test/acc': 55.134, 'best_test_test/acc_unbiased': 50.727, 'best_test_test/diff': 0.861, 'best_test_test/acc_skew': 51.158, 'best_test_test/acc_align': 50.296}
[7 / 20] Learning rate: 0.0001 weight: 0.01
[7 / 20] Loss: 4.656912717244367 CE Loss: 0.5146157889051948 Con Loss: 4.651766565666356
[7 / 20] tensor([[0.988, 1.000],
        [0.075, 0.055]]) {'epoch': 7, 'valid/acc': 56.437, 'valid/acc_unbiased': 52.07, 'valid/diff': 2.23, 'valid/acc_skew': 52.839, 'valid/acc_align': 51.301, 'test/acc': 57.206, 'test/acc_unbiased': 52.932, 'test/diff': 1.634, 'test/acc_skew': 53.749, 'test/acc_align': 52.115}
[7 / 20] best valid accuracy: 52.070 at epoch 7 
 best_stats: {'best_valid_epoch': 7, 'best_valid_valid/acc': 56.437, 'best_valid_valid/acc_unbiased': 52.07, 'best_valid_valid/diff': 2.23, 'best_valid_valid/acc_skew': 52.839, 'best_valid_valid/acc_align': 51.301, 'best_valid_test/acc': 57.206, 'best_valid_test/acc_unbiased': 52.932, 'best_valid_test/diff': 1.634, 'best_valid_test/acc_skew': 53.749, 'best_valid_test/acc_align': 52.115}
[7 / 20] best test accuracy: 52.932 at epoch 7 
 best_stats: {'best_test_epoch': 7, 'best_test_valid/acc': 56.437, 'best_test_valid/acc_unbiased': 52.07, 'best_test_valid/diff': 2.23, 'best_test_valid/acc_skew': 52.839, 'best_test_valid/acc_align': 51.301, 'best_test_test/acc': 57.206, 'best_test_test/acc_unbiased': 52.932, 'best_test_test/diff': 1.634, 'best_test_test/acc_skew': 53.749, 'best_test_test/acc_align': 52.115}
[8 / 20] Learning rate: 0.0001 weight: 0.01
[8 / 20] Loss: 4.616727527631262 CE Loss: 0.5093758502331445 Con Loss: 4.611633778689551
[8 / 20] tensor([[0.958, 0.983],
        [0.236, 0.115]]) {'epoch': 8, 'valid/acc': 59.7, 'valid/acc_unbiased': 55.534, 'valid/diff': 4.613, 'valid/acc_skew': 57.84, 'valid/acc_align': 53.227, 'test/acc': 62.274, 'test/acc_unbiased': 57.304, 'test/diff': 7.333, 'test/acc_skew': 60.97, 'test/acc_align': 53.637}
[8 / 20] best valid accuracy: 55.534 at epoch 8 
 best_stats: {'best_valid_epoch': 8, 'best_valid_valid/acc': 59.7, 'best_valid_valid/acc_unbiased': 55.534, 'best_valid_valid/diff': 4.613, 'best_valid_valid/acc_skew': 57.84, 'best_valid_valid/acc_align': 53.227, 'best_valid_test/acc': 62.274, 'best_valid_test/acc_unbiased': 57.304, 'best_valid_test/diff': 7.333, 'best_valid_test/acc_skew': 60.97, 'best_valid_test/acc_align': 53.637}
[8 / 20] best test accuracy: 57.304 at epoch 8 
 best_stats: {'best_test_epoch': 8, 'best_test_valid/acc': 59.7, 'best_test_valid/acc_unbiased': 55.534, 'best_test_valid/diff': 4.613, 'best_test_valid/acc_skew': 57.84, 'best_test_valid/acc_align': 53.227, 'best_test_test/acc': 62.274, 'best_test_test/acc_unbiased': 57.304, 'best_test_test/diff': 7.333, 'best_test_test/acc_skew': 60.97, 'best_test_test/acc_align': 53.637}
[9 / 20] Learning rate: 0.0001 weight: 0.01
[9 / 20] Loss: 4.570826367464283 CE Loss: 0.5037992265241417 Con Loss: 4.565788386333127
[9 / 20] tensor([[0.964, 0.972],
        [0.264, 0.176]]) {'epoch': 9, 'valid/acc': 61.728, 'valid/acc_unbiased': 58.01, 'valid/diff': 2.866, 'valid/acc_skew': 59.23, 'valid/acc_align': 56.789, 'test/acc': 63.993, 'test/acc_unbiased': 59.392, 'test/diff': 4.789, 'test/acc_skew': 61.786, 'test/acc_align': 56.997}
[9 / 20] best valid accuracy: 58.010 at epoch 9 
 best_stats: {'best_valid_epoch': 9, 'best_valid_valid/acc': 61.728, 'best_valid_valid/acc_unbiased': 58.01, 'best_valid_valid/diff': 2.866, 'best_valid_valid/acc_skew': 59.23, 'best_valid_valid/acc_align': 56.789, 'best_valid_test/acc': 63.993, 'best_valid_test/acc_unbiased': 59.392, 'best_valid_test/diff': 4.789, 'best_valid_test/acc_skew': 61.786, 'best_valid_test/acc_align': 56.997}
[9 / 20] best test accuracy: 59.392 at epoch 9 
 best_stats: {'best_test_epoch': 9, 'best_test_valid/acc': 61.728, 'best_test_valid/acc_unbiased': 58.01, 'best_test_valid/diff': 2.866, 'best_test_valid/acc_skew': 59.23, 'best_test_valid/acc_align': 56.789, 'best_test_test/acc': 63.993, 'best_test_test/acc_unbiased': 59.392, 'best_test_test/diff': 4.789, 'best_test_test/acc_skew': 61.786, 'best_test_test/acc_align': 56.997}
[10 / 20] Learning rate: 0.0001 weight: 0.01
[10 / 20] Loss: 4.552845749592612 CE Loss: 0.5008823996021345 Con Loss: 4.547836931936306
[10 / 20] tensor([[0.958, 0.949],
        [0.299, 0.200]]) {'epoch': 10, 'valid/acc': 63.757, 'valid/acc_unbiased': 60.131, 'valid/diff': 3.185, 'valid/acc_skew': 61.095, 'valid/acc_align': 59.168, 'test/acc': 65.007, 'test/acc_unbiased': 60.13, 'test/diff': 5.373, 'test/acc_skew': 62.38, 'test/acc_align': 57.879}
[10 / 20] best valid accuracy: 60.131 at epoch 10 
 best_stats: {'best_valid_epoch': 10, 'best_valid_valid/acc': 63.757, 'best_valid_valid/acc_unbiased': 60.131, 'best_valid_valid/diff': 3.185, 'best_valid_valid/acc_skew': 61.095, 'best_valid_valid/acc_align': 59.168, 'best_valid_test/acc': 65.007, 'best_valid_test/acc_unbiased': 60.13, 'best_valid_test/diff': 5.373, 'best_valid_test/acc_skew': 62.38, 'best_valid_test/acc_align': 57.879}
[10 / 20] best test accuracy: 60.130 at epoch 10 
 best_stats: {'best_test_epoch': 10, 'best_test_valid/acc': 63.757, 'best_test_valid/acc_unbiased': 60.131, 'best_test_valid/diff': 3.185, 'best_test_valid/acc_skew': 61.095, 'best_test_valid/acc_align': 59.168, 'best_test_test/acc': 65.007, 'best_test_test/acc_unbiased': 60.13, 'best_test_test/diff': 5.373, 'best_test_test/acc_skew': 62.38, 'best_test_test/acc_align': 57.879}
[11 / 20] Learning rate: 0.0001 weight: 0.01
[11 / 20] Loss: 4.518677584913418 CE Loss: 0.4927818923574938 Con Loss: 4.513749774945715
[11 / 20] tensor([[0.959, 0.932],
        [0.294, 0.224]]) {'epoch': 11, 'valid/acc': 63.977, 'valid/acc_unbiased': 61.003, 'valid/diff': 2.067, 'valid/acc_skew': 59.969, 'valid/acc_align': 62.036, 'test/acc': 64.963, 'test/acc_unbiased': 60.241, 'test/diff': 4.876, 'test/acc_skew': 61.297, 'test/acc_align': 59.186}
[11 / 20] best valid accuracy: 61.003 at epoch 11 
 best_stats: {'best_valid_epoch': 11, 'best_valid_valid/acc': 63.977, 'best_valid_valid/acc_unbiased': 61.003, 'best_valid_valid/diff': 2.067, 'best_valid_valid/acc_skew': 59.969, 'best_valid_valid/acc_align': 62.036, 'best_valid_test/acc': 64.963, 'best_valid_test/acc_unbiased': 60.241, 'best_valid_test/diff': 4.876, 'best_valid_test/acc_skew': 61.297, 'best_valid_test/acc_align': 59.186}
[11 / 20] best test accuracy: 60.241 at epoch 11 
 best_stats: {'best_test_epoch': 11, 'best_test_valid/acc': 63.977, 'best_test_valid/acc_unbiased': 61.003, 'best_test_valid/diff': 2.067, 'best_test_valid/acc_skew': 59.969, 'best_test_valid/acc_align': 62.036, 'best_test_test/acc': 64.963, 'best_test_test/acc_unbiased': 60.241, 'best_test_test/diff': 4.876, 'best_test_test/acc_skew': 61.297, 'best_test_test/acc_align': 59.186}
[12 / 20] Learning rate: 0.0001 weight: 0.01
[12 / 20] Loss: 4.567041184472841 CE Loss: 0.4884220676469428 Con Loss: 4.562156947531177
[12 / 20] tensor([[0.954, 0.932],
        [0.301, 0.279]]) {'epoch': 12, 'valid/acc': 63.757, 'valid/acc_unbiased': 60.438, 'valid/diff': 5.672, 'valid/acc_skew': 57.602, 'valid/acc_align': 63.274, 'test/acc': 65.359, 'test/acc_unbiased': 61.637, 'test/diff': 2.212, 'test/acc_skew': 61.643, 'test/acc_align': 61.63}
[12 / 20] best valid accuracy: 61.003 at epoch 11 
 best_stats: {'best_valid_epoch': 11, 'best_valid_valid/acc': 63.977, 'best_valid_valid/acc_unbiased': 61.003, 'best_valid_valid/diff': 2.067, 'best_valid_valid/acc_skew': 59.969, 'best_valid_valid/acc_align': 62.036, 'best_valid_test/acc': 64.963, 'best_valid_test/acc_unbiased': 60.241, 'best_valid_test/diff': 4.876, 'best_valid_test/acc_skew': 61.297, 'best_valid_test/acc_align': 59.186}
[12 / 20] best test accuracy: 61.637 at epoch 12 
 best_stats: {'best_test_epoch': 12, 'best_test_valid/acc': 63.757, 'best_test_valid/acc_unbiased': 60.438, 'best_test_valid/diff': 5.672, 'best_test_valid/acc_skew': 57.602, 'best_test_valid/acc_align': 63.274, 'best_test_test/acc': 65.359, 'best_test_test/acc_unbiased': 61.637, 'best_test_test/diff': 2.212, 'best_test_test/acc_skew': 61.643, 'best_test_test/acc_align': 61.63}
[13 / 20] Learning rate: 0.0001 weight: 0.01
[13 / 20] Loss: 4.54190105697449 CE Loss: 0.4864057724460686 Con Loss: 4.537037004294444
[13 / 20] tensor([[0.965, 0.943],
        [0.257, 0.236]]) {'epoch': 13, 'valid/acc': 63.404, 'valid/acc_unbiased': 60.398, 'valid/diff': 1.578, 'valid/acc_skew': 59.609, 'valid/acc_align': 61.187, 'test/acc': 63.993, 'test/acc_unbiased': 60.047, 'test/diff': 2.14, 'test/acc_skew': 60.02, 'test/acc_align': 60.075}
[13 / 20] best valid accuracy: 61.003 at epoch 11 
 best_stats: {'best_valid_epoch': 11, 'best_valid_valid/acc': 63.977, 'best_valid_valid/acc_unbiased': 61.003, 'best_valid_valid/diff': 2.067, 'best_valid_valid/acc_skew': 59.969, 'best_valid_valid/acc_align': 62.036, 'best_valid_test/acc': 64.963, 'best_valid_test/acc_unbiased': 60.241, 'best_valid_test/diff': 4.876, 'best_valid_test/acc_skew': 61.297, 'best_valid_test/acc_align': 59.186}
[13 / 20] best test accuracy: 61.637 at epoch 12 
 best_stats: {'best_test_epoch': 12, 'best_test_valid/acc': 63.757, 'best_test_valid/acc_unbiased': 60.438, 'best_test_valid/diff': 5.672, 'best_test_valid/acc_skew': 57.602, 'best_test_valid/acc_align': 63.274, 'best_test_test/acc': 65.359, 'best_test_test/acc_unbiased': 61.637, 'best_test_test/diff': 2.212, 'best_test_test/acc_skew': 61.643, 'best_test_test/acc_align': 61.63}
[14 / 20] Learning rate: 1e-05 weight: 0.01
[14 / 20] Loss: 4.528601605362859 CE Loss: 0.4796249063239924 Con Loss: 4.523805350143335
[14 / 20] tensor([[0.959, 0.903],
        [0.303, 0.255]]) {'epoch': 14, 'valid/acc': 64.815, 'valid/acc_unbiased': 61.551, 'valid/diff': 3.349, 'valid/acc_skew': 59.876, 'valid/acc_align': 63.225, 'test/acc': 65.271, 'test/acc_unbiased': 60.496, 'test/diff': 5.196, 'test/acc_skew': 60.338, 'test/acc_align': 60.654}
[14 / 20] best valid accuracy: 61.551 at epoch 14 
 best_stats: {'best_valid_epoch': 14, 'best_valid_valid/acc': 64.815, 'best_valid_valid/acc_unbiased': 61.551, 'best_valid_valid/diff': 3.349, 'best_valid_valid/acc_skew': 59.876, 'best_valid_valid/acc_align': 63.225, 'best_valid_test/acc': 65.271, 'best_valid_test/acc_unbiased': 60.496, 'best_valid_test/diff': 5.196, 'best_valid_test/acc_skew': 60.338, 'best_valid_test/acc_align': 60.654}
[14 / 20] best test accuracy: 61.637 at epoch 12 
 best_stats: {'best_test_epoch': 12, 'best_test_valid/acc': 63.757, 'best_test_valid/acc_unbiased': 60.438, 'best_test_valid/diff': 5.672, 'best_test_valid/acc_skew': 57.602, 'best_test_valid/acc_align': 63.274, 'best_test_test/acc': 65.359, 'best_test_test/acc_unbiased': 61.637, 'best_test_test/diff': 2.212, 'best_test_test/acc_skew': 61.643, 'best_test_test/acc_align': 61.63}
[15 / 20] Learning rate: 1e-05 weight: 0.01
[15 / 20] Loss: 4.531058299679829 CE Loss: 0.4827481185796331 Con Loss: 4.526230812965373
[15 / 20] tensor([[0.956, 0.943],
        [0.293, 0.248]]) {'epoch': 15, 'valid/acc': 64.991, 'valid/acc_unbiased': 61.774, 'valid/diff': 2.05, 'valid/acc_skew': 61.415, 'valid/acc_align': 62.133, 'test/acc': 65.007, 'test/acc_unbiased': 61.008, 'test/diff': 2.85, 'test/acc_skew': 61.807, 'test/acc_align': 60.209}
[15 / 20] best valid accuracy: 61.774 at epoch 15 
 best_stats: {'best_valid_epoch': 15, 'best_valid_valid/acc': 64.991, 'best_valid_valid/acc_unbiased': 61.774, 'best_valid_valid/diff': 2.05, 'best_valid_valid/acc_skew': 61.415, 'best_valid_valid/acc_align': 62.133, 'best_valid_test/acc': 65.007, 'best_valid_test/acc_unbiased': 61.008, 'best_valid_test/diff': 2.85, 'best_valid_test/acc_skew': 61.807, 'best_valid_test/acc_align': 60.209}
[15 / 20] best test accuracy: 61.637 at epoch 12 
 best_stats: {'best_test_epoch': 12, 'best_test_valid/acc': 63.757, 'best_test_valid/acc_unbiased': 60.438, 'best_test_valid/diff': 5.672, 'best_test_valid/acc_skew': 57.602, 'best_test_valid/acc_align': 63.274, 'best_test_test/acc': 65.359, 'best_test_test/acc_unbiased': 61.637, 'best_test_test/diff': 2.212, 'best_test_test/acc_skew': 61.643, 'best_test_test/acc_align': 61.63}
[16 / 20] Learning rate: 1e-05 weight: 0.01
[16 / 20] Loss: 4.494132576074461 CE Loss: 0.4838563468473228 Con Loss: 4.48929401891859
[16 / 20] tensor([[0.960, 0.938],
        [0.276, 0.248]]) {'epoch': 16, 'valid/acc': 64.242, 'valid/acc_unbiased': 61.429, 'valid/diff': 2.883, 'valid/acc_skew': 59.988, 'valid/acc_align': 62.871, 'test/acc': 64.522, 'test/acc_unbiased': 60.552, 'test/diff': 2.505, 'test/acc_skew': 60.658, 'test/acc_align': 60.445}
[16 / 20] best valid accuracy: 61.774 at epoch 15 
 best_stats: {'best_valid_epoch': 15, 'best_valid_valid/acc': 64.991, 'best_valid_valid/acc_unbiased': 61.774, 'best_valid_valid/diff': 2.05, 'best_valid_valid/acc_skew': 61.415, 'best_valid_valid/acc_align': 62.133, 'best_valid_test/acc': 65.007, 'best_valid_test/acc_unbiased': 61.008, 'best_valid_test/diff': 2.85, 'best_valid_test/acc_skew': 61.807, 'best_valid_test/acc_align': 60.209}
[16 / 20] best test accuracy: 61.637 at epoch 12 
 best_stats: {'best_test_epoch': 12, 'best_test_valid/acc': 63.757, 'best_test_valid/acc_unbiased': 60.438, 'best_test_valid/diff': 5.672, 'best_test_valid/acc_skew': 57.602, 'best_test_valid/acc_align': 63.274, 'best_test_test/acc': 65.359, 'best_test_test/acc_unbiased': 61.637, 'best_test_test/diff': 2.212, 'best_test_test/acc_skew': 61.643, 'best_test_test/acc_align': 61.63}
[17 / 20] Learning rate: 1e-05 weight: 0.01
[17 / 20] Loss: 4.5367788772197395 CE Loss: 0.48202504614282304 Con Loss: 4.531958630717859
[17 / 20] tensor([[0.964, 0.938],
        [0.276, 0.267]]) {'epoch': 17, 'valid/acc': 64.242, 'valid/acc_unbiased': 61.226, 'valid/diff': 2.989, 'valid/acc_skew': 59.731, 'valid/acc_align': 62.72, 'test/acc': 64.83, 'test/acc_unbiased': 61.1, 'test/diff': 1.784, 'test/acc_skew': 60.658, 'test/acc_align': 61.543}
[17 / 20] best valid accuracy: 61.774 at epoch 15 
 best_stats: {'best_valid_epoch': 15, 'best_valid_valid/acc': 64.991, 'best_valid_valid/acc_unbiased': 61.774, 'best_valid_valid/diff': 2.05, 'best_valid_valid/acc_skew': 61.415, 'best_valid_valid/acc_align': 62.133, 'best_valid_test/acc': 65.007, 'best_valid_test/acc_unbiased': 61.008, 'best_valid_test/diff': 2.85, 'best_valid_test/acc_skew': 61.807, 'best_valid_test/acc_align': 60.209}
[17 / 20] best test accuracy: 61.637 at epoch 12 
 best_stats: {'best_test_epoch': 12, 'best_test_valid/acc': 63.757, 'best_test_valid/acc_unbiased': 60.438, 'best_test_valid/diff': 5.672, 'best_test_valid/acc_skew': 57.602, 'best_test_valid/acc_align': 63.274, 'best_test_test/acc': 65.359, 'best_test_test/acc_unbiased': 61.637, 'best_test_test/diff': 2.212, 'best_test_test/acc_skew': 61.643, 'best_test_test/acc_align': 61.63}
[18 / 20] Learning rate: 1e-05 weight: 0.01
[18 / 20] Loss: 4.511807185529725 CE Loss: 0.472464428618355 Con Loss: 4.507082544610278
[18 / 20] tensor([[0.953, 0.892],
        [0.343, 0.291]]) {'epoch': 18, 'valid/acc': 66.138, 'valid/acc_unbiased': 62.612, 'valid/diff': 3.799, 'valid/acc_skew': 60.712, 'valid/acc_align': 64.511, 'test/acc': 66.681, 'test/acc_unbiased': 61.96, 'test/diff': 5.624, 'test/acc_skew': 61.73, 'test/acc_align': 62.189}
[18 / 20] best valid accuracy: 62.612 at epoch 18 
 best_stats: {'best_valid_epoch': 18, 'best_valid_valid/acc': 66.138, 'best_valid_valid/acc_unbiased': 62.612, 'best_valid_valid/diff': 3.799, 'best_valid_valid/acc_skew': 60.712, 'best_valid_valid/acc_align': 64.511, 'best_valid_test/acc': 66.681, 'best_valid_test/acc_unbiased': 61.96, 'best_valid_test/diff': 5.624, 'best_valid_test/acc_skew': 61.73, 'best_valid_test/acc_align': 62.189}
[18 / 20] best test accuracy: 61.960 at epoch 18 
 best_stats: {'best_test_epoch': 18, 'best_test_valid/acc': 66.138, 'best_test_valid/acc_unbiased': 62.612, 'best_test_valid/diff': 3.799, 'best_test_valid/acc_skew': 60.712, 'best_test_valid/acc_align': 64.511, 'best_test_test/acc': 66.681, 'best_test_test/acc_unbiased': 61.96, 'best_test_test/diff': 5.624, 'best_test_test/acc_skew': 61.73, 'best_test_test/acc_align': 62.189}
[19 / 20] Learning rate: 1e-05 weight: 0.01
[19 / 20] Loss: 4.500530182578866 CE Loss: 0.475600303156641 Con Loss: 4.49577415109975
[19 / 20] tensor([[0.955, 0.881],
        [0.338, 0.309]]) {'epoch': 19, 'valid/acc': 65.741, 'valid/acc_unbiased': 62.174, 'valid/diff': 4.188, 'valid/acc_skew': 60.08, 'valid/acc_align': 64.268, 'test/acc': 66.637, 'test/acc_unbiased': 62.062, 'test/diff': 5.147, 'test/acc_skew': 60.931, 'test/acc_align': 63.193}
[19 / 20] best valid accuracy: 62.612 at epoch 18 
 best_stats: {'best_valid_epoch': 18, 'best_valid_valid/acc': 66.138, 'best_valid_valid/acc_unbiased': 62.612, 'best_valid_valid/diff': 3.799, 'best_valid_valid/acc_skew': 60.712, 'best_valid_valid/acc_align': 64.511, 'best_valid_test/acc': 66.681, 'best_valid_test/acc_unbiased': 61.96, 'best_valid_test/diff': 5.624, 'best_valid_test/acc_skew': 61.73, 'best_valid_test/acc_align': 62.189}
[19 / 20] best test accuracy: 62.062 at epoch 19 
 best_stats: {'best_test_epoch': 19, 'best_test_valid/acc': 65.741, 'best_test_valid/acc_unbiased': 62.174, 'best_test_valid/diff': 4.188, 'best_test_valid/acc_skew': 60.08, 'best_test_valid/acc_align': 64.268, 'best_test_test/acc': 66.637, 'best_test_test/acc_unbiased': 62.062, 'best_test_test/diff': 5.147, 'best_test_test/acc_skew': 60.931, 'best_test_test/acc_align': 63.193}
[20 / 20] Learning rate: 1e-05 weight: 0.01
[20 / 20] Loss: 4.491333509821518 CE Loss: 0.46884100767879705 Con Loss: 4.486645115131477
[20 / 20] tensor([[0.957, 0.892],
        [0.326, 0.315]]) {'epoch': 20, 'valid/acc': 65.697, 'valid/acc_unbiased': 62.189, 'valid/diff': 5.13, 'valid/acc_skew': 59.623, 'valid/acc_align': 64.754, 'test/acc': 66.417, 'test/acc_unbiased': 62.256, 'test/diff': 3.793, 'test/acc_skew': 60.923, 'test/acc_align': 63.59}
[20 / 20] best valid accuracy: 62.612 at epoch 18 
 best_stats: {'best_valid_epoch': 18, 'best_valid_valid/acc': 66.138, 'best_valid_valid/acc_unbiased': 62.612, 'best_valid_valid/diff': 3.799, 'best_valid_valid/acc_skew': 60.712, 'best_valid_valid/acc_align': 64.511, 'best_valid_test/acc': 66.681, 'best_valid_test/acc_unbiased': 61.96, 'best_valid_test/diff': 5.624, 'best_valid_test/acc_skew': 61.73, 'best_valid_test/acc_align': 62.189}
[20 / 20] best test accuracy: 62.256 at epoch 20 
 best_stats: {'best_test_epoch': 20, 'best_test_valid/acc': 65.697, 'best_test_valid/acc_unbiased': 62.189, 'best_test_valid/diff': 5.13, 'best_test_valid/acc_skew': 59.623, 'best_test_valid/acc_align': 64.754, 'best_test_test/acc': 66.417, 'best_test_test/acc_unbiased': 62.256, 'best_test_test/diff': 3.793, 'best_test_test/acc_skew': 60.923, 'best_test_test/acc_align': 63.59}
Total training time: 0:16:35
