Log level set to: INFO
Set seed: 3
=======> Using Fixed Random Seed: 3 <========
save_path: exp_results/bc-bb0-utk_face_age-rotate_color-0.9-lr0.001-bs128-cbs64-w0.01-ratio10-aug1-seed3
get_utk_face - split: train, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_age-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
Binary Target 1
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Normal Label Distribution: 
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
Binary Target 1
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Normal Label Distribution: 
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 10684, target_attr: gender, bias_attr: age bias_rate: 0.9
['[train] target_0-bias_0: 8237', '[train] target_0-bias_1: 147', '[train] target_1-bias_0: 823', '[train] target_1-bias_1: 1477']
confusion_matrix - 
 original: tensor([[8237.,  823.],
        [ 147., 1477.]]), 
 normalized: tensor([[0.909, 0.091],
        [0.091, 0.909]]), 
 b|y: tensor([[0.982, 0.018],
        [0.358, 0.642]])
get_utk_face - split: train, aug: 1, given_y: True, ratio: 10
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_age-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
Binary Target 1
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Normal Label Distribution: 
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
Binary Target 1
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Normal Label Distribution: 
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 10684, target_attr: gender, bias_attr: age bias_rate: 0.9
['[train] target_0-bias_0: 8237', '[train] target_0-bias_1: 147', '[train] target_1-bias_0: 823', '[train] target_1-bias_1: 1477']
get_utk_face - split: valid, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_age-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [1030, 195]
Target 1: [841, 202]
Binary Target 1
---------------------------
Target 0: [1030, 195]
Target 1: [841, 202]
===================================
Normal Label Distribution: 
Target 0: [1030, 195]
Target 1: [841, 202]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 2268, target_attr: gender, bias_attr: age bias_rate: 0.9
['[valid] target_0-bias_0: 1030', '[valid] target_0-bias_1: 195', '[valid] target_1-bias_0: 841', '[valid] target_1-bias_1: 202']
get_utk_face - split: test, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_age-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [1061, 176]
Target 1: [867, 165]
Binary Target 1
---------------------------
Target 0: [1061, 176]
Target 1: [867, 165]
===================================
Normal Label Distribution: 
Target 0: [1061, 176]
Target 1: [867, 165]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 2269, target_attr: gender, bias_attr: age bias_rate: 0.9
['[test] target_0-bias_0: 1061', '[test] target_0-bias_1: 176', '[test] target_1-bias_0: 867', '[test] target_1-bias_1: 165']
decay_epochs: [6, 13]
[1 / 20] Learning rate: 0.001 weight: 0.01
[1 / 20] Loss: 4.825855689653963 CE Loss: 0.6059610771802605 Con Loss: 4.819796082501285
[1 / 20] tensor([[1., 1.],
        [0., 0.]]) {'epoch': 1, 'valid/acc': 54.189, 'valid/acc_unbiased': 50.119, 'valid/diff': 0.238, 'valid/acc_skew': 50.238, 'valid/acc_align': 50.0, 'test/acc': 54.517, 'test/acc_unbiased': 50.0, 'test/diff': 0.0, 'test/acc_skew': 50.0, 'test/acc_align': 50.0}
[1 / 20] best valid accuracy: 50.119 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 54.189, 'best_valid_valid/acc_unbiased': 50.119, 'best_valid_valid/diff': 0.238, 'best_valid_valid/acc_skew': 50.238, 'best_valid_valid/acc_align': 50.0, 'best_valid_test/acc': 54.517, 'best_valid_test/acc_unbiased': 50.0, 'best_valid_test/diff': 0.0, 'best_valid_test/acc_skew': 50.0, 'best_valid_test/acc_align': 50.0}
[1 / 20] best test accuracy: 50.000 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 54.189, 'best_test_valid/acc_unbiased': 50.119, 'best_test_valid/diff': 0.238, 'best_test_valid/acc_skew': 50.238, 'best_test_valid/acc_align': 50.0, 'best_test_test/acc': 54.517, 'best_test_test/acc_unbiased': 50.0, 'best_test_test/diff': 0.0, 'best_test_test/acc_skew': 50.0, 'best_test_test/acc_align': 50.0}
[2 / 20] Learning rate: 0.001 weight: 0.01
[2 / 20] Loss: 4.592554501226805 CE Loss: 0.5525845853588814 Con Loss: 4.5870286462370355
[2 / 20] tensor([[0.997, 0.994],
        [0.015, 0.000]]) {'epoch': 2, 'valid/acc': 54.806, 'valid/acc_unbiased': 50.656, 'valid/diff': 1.303, 'valid/acc_skew': 51.308, 'valid/acc_align': 50.005, 'test/acc': 54.914, 'test/acc_unbiased': 50.162, 'test/diff': 0.892, 'test/acc_skew': 50.466, 'test/acc_align': 49.859}
[2 / 20] best valid accuracy: 50.656 at epoch 2 
 best_stats: {'best_valid_epoch': 2, 'best_valid_valid/acc': 54.806, 'best_valid_valid/acc_unbiased': 50.656, 'best_valid_valid/diff': 1.303, 'best_valid_valid/acc_skew': 51.308, 'best_valid_valid/acc_align': 50.005, 'best_valid_test/acc': 54.914, 'best_valid_test/acc_unbiased': 50.162, 'best_valid_test/diff': 0.892, 'best_valid_test/acc_skew': 50.466, 'best_valid_test/acc_align': 49.859}
[2 / 20] best test accuracy: 50.162 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 54.806, 'best_test_valid/acc_unbiased': 50.656, 'best_test_valid/diff': 1.303, 'best_test_valid/acc_skew': 51.308, 'best_test_valid/acc_align': 50.005, 'best_test_test/acc': 54.914, 'best_test_test/acc_unbiased': 50.162, 'best_test_test/diff': 0.892, 'best_test_test/acc_skew': 50.466, 'best_test_test/acc_align': 49.859}
[3 / 20] Learning rate: 0.001 weight: 0.01
[3 / 20] Loss: 4.556162391071327 CE Loss: 0.5333359805397754 Con Loss: 4.55082907296441
[3 / 20] tensor([[0.983, 0.994],
        [0.105, 0.024]]) {'epoch': 3, 'valid/acc': 56.922, 'valid/acc_unbiased': 52.514, 'valid/diff': 4.009, 'valid/acc_skew': 54.518, 'valid/acc_align': 50.509, 'test/acc': 57.867, 'test/acc_unbiased': 52.664, 'test/diff': 4.6, 'test/acc_skew': 54.964, 'test/acc_align': 50.364}
[3 / 20] best valid accuracy: 52.514 at epoch 3 
 best_stats: {'best_valid_epoch': 3, 'best_valid_valid/acc': 56.922, 'best_valid_valid/acc_unbiased': 52.514, 'best_valid_valid/diff': 4.009, 'best_valid_valid/acc_skew': 54.518, 'best_valid_valid/acc_align': 50.509, 'best_valid_test/acc': 57.867, 'best_valid_test/acc_unbiased': 52.664, 'best_valid_test/diff': 4.6, 'best_valid_test/acc_skew': 54.964, 'best_valid_test/acc_align': 50.364}
[3 / 20] best test accuracy: 52.664 at epoch 3 
 best_stats: {'best_test_epoch': 3, 'best_test_valid/acc': 56.922, 'best_test_valid/acc_unbiased': 52.514, 'best_test_valid/diff': 4.009, 'best_test_valid/acc_skew': 54.518, 'best_test_valid/acc_align': 50.509, 'best_test_test/acc': 57.867, 'best_test_test/acc_unbiased': 52.664, 'best_test_test/diff': 4.6, 'best_test_test/acc_skew': 54.964, 'best_test_test/acc_align': 50.364}
[4 / 20] Learning rate: 0.001 weight: 0.01
[4 / 20] Loss: 4.5551058709599115 CE Loss: 0.535347869928657 Con Loss: 4.549752380552474
[4 / 20] tensor([[0.990, 0.989],
        [0.116, 0.067]]) {'epoch': 4, 'valid/acc': 59.303, 'valid/acc_unbiased': 55.01, 'valid/diff': 3.178, 'valid/acc_skew': 56.599, 'valid/acc_align': 53.422, 'test/acc': 58.881, 'test/acc_unbiased': 54.036, 'test/diff': 2.541, 'test/acc_skew': 55.257, 'test/acc_align': 52.815}
[4 / 20] best valid accuracy: 55.010 at epoch 4 
 best_stats: {'best_valid_epoch': 4, 'best_valid_valid/acc': 59.303, 'best_valid_valid/acc_unbiased': 55.01, 'best_valid_valid/diff': 3.178, 'best_valid_valid/acc_skew': 56.599, 'best_valid_valid/acc_align': 53.422, 'best_valid_test/acc': 58.881, 'best_valid_test/acc_unbiased': 54.036, 'best_valid_test/diff': 2.541, 'best_valid_test/acc_skew': 55.257, 'best_valid_test/acc_align': 52.815}
[4 / 20] best test accuracy: 54.036 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 59.303, 'best_test_valid/acc_unbiased': 55.01, 'best_test_valid/diff': 3.178, 'best_test_valid/acc_skew': 56.599, 'best_test_valid/acc_align': 53.422, 'best_test_test/acc': 58.881, 'best_test_test/acc_unbiased': 54.036, 'best_test_test/diff': 2.541, 'best_test_test/acc_skew': 55.257, 'best_test_test/acc_align': 52.815}
[5 / 20] Learning rate: 0.001 weight: 0.01
[5 / 20] Loss: 4.531134647003768 CE Loss: 0.5146064217819877 Con Loss: 4.525988562729242
[5 / 20] tensor([[0.910, 0.716],
        [0.493, 0.430]]) {'epoch': 5, 'valid/acc': 69.929, 'valid/acc_unbiased': 64.901, 'valid/diff': 14.934, 'valid/acc_skew': 57.434, 'valid/acc_align': 72.369, 'test/acc': 70.075, 'test/acc_unbiased': 63.729, 'test/diff': 12.838, 'test/acc_skew': 60.421, 'test/acc_align': 67.038}
[5 / 20] best valid accuracy: 64.901 at epoch 5 
 best_stats: {'best_valid_epoch': 5, 'best_valid_valid/acc': 69.929, 'best_valid_valid/acc_unbiased': 64.901, 'best_valid_valid/diff': 14.934, 'best_valid_valid/acc_skew': 57.434, 'best_valid_valid/acc_align': 72.369, 'best_valid_test/acc': 70.075, 'best_valid_test/acc_unbiased': 63.729, 'best_valid_test/diff': 12.838, 'best_valid_test/acc_skew': 60.421, 'best_valid_test/acc_align': 67.038}
[5 / 20] best test accuracy: 63.729 at epoch 5 
 best_stats: {'best_test_epoch': 5, 'best_test_valid/acc': 69.929, 'best_test_valid/acc_unbiased': 64.901, 'best_test_valid/diff': 14.934, 'best_test_valid/acc_skew': 57.434, 'best_test_valid/acc_align': 72.369, 'best_test_test/acc': 70.075, 'best_test_test/acc_unbiased': 63.729, 'best_test_test/diff': 12.838, 'best_test_test/acc_skew': 60.421, 'best_test_test/acc_align': 67.038}
[6 / 20] Learning rate: 0.001 weight: 0.01
[6 / 20] Loss: 4.520710719296746 CE Loss: 0.49767139825156814 Con Loss: 4.5157340202203
[6 / 20] tensor([[0.996, 0.977],
        [0.142, 0.085]]) {'epoch': 6, 'valid/acc': 58.995, 'valid/acc_unbiased': 54.499, 'valid/diff': 3.164, 'valid/acc_skew': 54.882, 'valid/acc_align': 54.116, 'test/acc': 60.203, 'test/acc_unbiased': 55.005, 'test/diff': 3.799, 'test/acc_skew': 55.957, 'test/acc_align': 54.054}
[6 / 20] best valid accuracy: 64.901 at epoch 5 
 best_stats: {'best_valid_epoch': 5, 'best_valid_valid/acc': 69.929, 'best_valid_valid/acc_unbiased': 64.901, 'best_valid_valid/diff': 14.934, 'best_valid_valid/acc_skew': 57.434, 'best_valid_valid/acc_align': 72.369, 'best_valid_test/acc': 70.075, 'best_valid_test/acc_unbiased': 63.729, 'best_valid_test/diff': 12.838, 'best_valid_test/acc_skew': 60.421, 'best_valid_test/acc_align': 67.038}
[6 / 20] best test accuracy: 63.729 at epoch 5 
 best_stats: {'best_test_epoch': 5, 'best_test_valid/acc': 69.929, 'best_test_valid/acc_unbiased': 64.901, 'best_test_valid/diff': 14.934, 'best_test_valid/acc_skew': 57.434, 'best_test_valid/acc_align': 72.369, 'best_test_test/acc': 70.075, 'best_test_test/acc_unbiased': 63.729, 'best_test_test/diff': 12.838, 'best_test_test/acc_skew': 60.421, 'best_test_test/acc_align': 67.038}
[7 / 20] Learning rate: 0.0001 weight: 0.01
[7 / 20] Loss: 4.442051010246091 CE Loss: 0.48405649559589775 Con Loss: 4.437210471832721
[7 / 20] tensor([[0.984, 0.938],
        [0.332, 0.230]]) {'epoch': 7, 'valid/acc': 66.314, 'valid/acc_unbiased': 61.715, 'valid/diff': 5.857, 'valid/acc_skew': 61.927, 'valid/acc_align': 61.502, 'test/acc': 67.651, 'test/acc_unbiased': 62.099, 'test/diff': 7.418, 'test/acc_skew': 63.484, 'test/acc_align': 60.714}
[7 / 20] best valid accuracy: 64.901 at epoch 5 
 best_stats: {'best_valid_epoch': 5, 'best_valid_valid/acc': 69.929, 'best_valid_valid/acc_unbiased': 64.901, 'best_valid_valid/diff': 14.934, 'best_valid_valid/acc_skew': 57.434, 'best_valid_valid/acc_align': 72.369, 'best_valid_test/acc': 70.075, 'best_valid_test/acc_unbiased': 63.729, 'best_valid_test/diff': 12.838, 'best_valid_test/acc_skew': 60.421, 'best_valid_test/acc_align': 67.038}
[7 / 20] best test accuracy: 63.729 at epoch 5 
 best_stats: {'best_test_epoch': 5, 'best_test_valid/acc': 69.929, 'best_test_valid/acc_unbiased': 64.901, 'best_test_valid/diff': 14.934, 'best_test_valid/acc_skew': 57.434, 'best_test_valid/acc_align': 72.369, 'best_test_test/acc': 70.075, 'best_test_test/acc_unbiased': 63.729, 'best_test_test/diff': 12.838, 'best_test_test/acc_skew': 60.421, 'best_test_test/acc_align': 67.038}
[8 / 20] Learning rate: 0.0001 weight: 0.01
[8 / 20] Loss: 4.367947550758982 CE Loss: 0.4734350645734058 Con Loss: 4.363213189038299
[8 / 20] tensor([[0.979, 0.886],
        [0.375, 0.297]]) {'epoch': 8, 'valid/acc': 68.078, 'valid/acc_unbiased': 63.368, 'valid/diff': 6.865, 'valid/acc_skew': 61.86, 'valid/acc_align': 64.876, 'test/acc': 69.149, 'test/acc_unbiased': 63.436, 'test/diff': 8.539, 'test/acc_skew': 63.061, 'test/acc_align': 63.812}
[8 / 20] best valid accuracy: 64.901 at epoch 5 
 best_stats: {'best_valid_epoch': 5, 'best_valid_valid/acc': 69.929, 'best_valid_valid/acc_unbiased': 64.901, 'best_valid_valid/diff': 14.934, 'best_valid_valid/acc_skew': 57.434, 'best_valid_valid/acc_align': 72.369, 'best_valid_test/acc': 70.075, 'best_valid_test/acc_unbiased': 63.729, 'best_valid_test/diff': 12.838, 'best_valid_test/acc_skew': 60.421, 'best_valid_test/acc_align': 67.038}
[8 / 20] best test accuracy: 63.729 at epoch 5 
 best_stats: {'best_test_epoch': 5, 'best_test_valid/acc': 69.929, 'best_test_valid/acc_unbiased': 64.901, 'best_test_valid/diff': 14.934, 'best_test_valid/acc_skew': 57.434, 'best_test_valid/acc_align': 72.369, 'best_test_test/acc': 70.075, 'best_test_test/acc_unbiased': 63.729, 'best_test_test/diff': 12.838, 'best_test_test/acc_skew': 60.421, 'best_test_test/acc_align': 67.038}
[9 / 20] Learning rate: 0.0001 weight: 0.01
[9 / 20] Loss: 4.311763803060026 CE Loss: 0.46064053052420567 Con Loss: 4.30715738222957
[9 / 20] tensor([[0.980, 0.903],
        [0.398, 0.303]]) {'epoch': 9, 'valid/acc': 68.915, 'valid/acc_unbiased': 64.013, 'valid/diff': 7.715, 'valid/acc_skew': 62.161, 'valid/acc_align': 65.866, 'test/acc': 70.251, 'test/acc_unbiased': 64.614, 'test/diff': 8.585, 'test/acc_skew': 65.067, 'test/acc_align': 64.162}
[9 / 20] best valid accuracy: 64.901 at epoch 5 
 best_stats: {'best_valid_epoch': 5, 'best_valid_valid/acc': 69.929, 'best_valid_valid/acc_unbiased': 64.901, 'best_valid_valid/diff': 14.934, 'best_valid_valid/acc_skew': 57.434, 'best_valid_valid/acc_align': 72.369, 'best_valid_test/acc': 70.075, 'best_valid_test/acc_unbiased': 63.729, 'best_valid_test/diff': 12.838, 'best_valid_test/acc_skew': 60.421, 'best_valid_test/acc_align': 67.038}
[9 / 20] best test accuracy: 64.614 at epoch 9 
 best_stats: {'best_test_epoch': 9, 'best_test_valid/acc': 68.915, 'best_test_valid/acc_unbiased': 64.013, 'best_test_valid/diff': 7.715, 'best_test_valid/acc_skew': 62.161, 'best_test_valid/acc_align': 65.866, 'best_test_test/acc': 70.251, 'best_test_test/acc_unbiased': 64.614, 'best_test_test/diff': 8.585, 'best_test_test/acc_skew': 65.067, 'best_test_test/acc_align': 64.162}
[10 / 20] Learning rate: 0.0001 weight: 0.01
[10 / 20] Loss: 4.290134464208217 CE Loss: 0.4444207845221562 Con Loss: 4.285690235493559
[10 / 20] tensor([[0.983, 0.881],
        [0.371, 0.327]]) {'epoch': 10, 'valid/acc': 68.298, 'valid/acc_unbiased': 63.743, 'valid/diff': 6.41, 'valid/acc_skew': 60.538, 'valid/acc_align': 66.948, 'test/acc': 69.37, 'test/acc_unbiased': 64.06, 'test/diff': 7.324, 'test/acc_skew': 62.604, 'test/acc_align': 65.515}
[10 / 20] best valid accuracy: 64.901 at epoch 5 
 best_stats: {'best_valid_epoch': 5, 'best_valid_valid/acc': 69.929, 'best_valid_valid/acc_unbiased': 64.901, 'best_valid_valid/diff': 14.934, 'best_valid_valid/acc_skew': 57.434, 'best_valid_valid/acc_align': 72.369, 'best_valid_test/acc': 70.075, 'best_valid_test/acc_unbiased': 63.729, 'best_valid_test/diff': 12.838, 'best_valid_test/acc_skew': 60.421, 'best_valid_test/acc_align': 67.038}
[10 / 20] best test accuracy: 64.614 at epoch 9 
 best_stats: {'best_test_epoch': 9, 'best_test_valid/acc': 68.915, 'best_test_valid/acc_unbiased': 64.013, 'best_test_valid/diff': 7.715, 'best_test_valid/acc_skew': 62.161, 'best_test_valid/acc_align': 65.866, 'best_test_test/acc': 70.251, 'best_test_test/acc_unbiased': 64.614, 'best_test_test/diff': 8.585, 'best_test_test/acc_skew': 65.067, 'best_test_test/acc_align': 64.162}
[11 / 20] Learning rate: 0.0001 weight: 0.01
[11 / 20] Loss: 4.239335652997279 CE Loss: 0.43562210368244264 Con Loss: 4.234979430284004
[11 / 20] tensor([[0.980, 0.812],
        [0.422, 0.430]]) {'epoch': 11, 'valid/acc': 70.326, 'valid/acc_unbiased': 65.865, 'valid/diff': 9.407, 'valid/acc_skew': 61.162, 'valid/acc_align': 70.569, 'test/acc': 71.397, 'test/acc_unbiased': 66.129, 'test/diff': 8.793, 'test/acc_skew': 61.732, 'test/acc_align': 70.526}
[11 / 20] best valid accuracy: 65.865 at epoch 11 
 best_stats: {'best_valid_epoch': 11, 'best_valid_valid/acc': 70.326, 'best_valid_valid/acc_unbiased': 65.865, 'best_valid_valid/diff': 9.407, 'best_valid_valid/acc_skew': 61.162, 'best_valid_valid/acc_align': 70.569, 'best_valid_test/acc': 71.397, 'best_valid_test/acc_unbiased': 66.129, 'best_valid_test/diff': 8.793, 'best_valid_test/acc_skew': 61.732, 'best_valid_test/acc_align': 70.526}
[11 / 20] best test accuracy: 66.129 at epoch 11 
 best_stats: {'best_test_epoch': 11, 'best_test_valid/acc': 70.326, 'best_test_valid/acc_unbiased': 65.865, 'best_test_valid/diff': 9.407, 'best_test_valid/acc_skew': 61.162, 'best_test_valid/acc_align': 70.569, 'best_test_test/acc': 71.397, 'best_test_test/acc_unbiased': 66.129, 'best_test_test/diff': 8.793, 'best_test_test/acc_skew': 61.732, 'best_test_test/acc_align': 70.526}
[12 / 20] Learning rate: 0.0001 weight: 0.01
[12 / 20] Loss: 4.198863272450917 CE Loss: 0.437451909260998 Con Loss: 4.194488776395135
[12 / 20] tensor([[0.977, 0.847],
        [0.434, 0.327]]) {'epoch': 12, 'valid/acc': 69.885, 'valid/acc_unbiased': 64.933, 'valid/diff': 8.157, 'valid/acc_skew': 62.068, 'valid/acc_align': 67.797, 'test/acc': 71.221, 'test/acc_unbiased': 64.623, 'test/diff': 11.86, 'test/acc_skew': 64.014, 'test/acc_align': 65.233}
[12 / 20] best valid accuracy: 65.865 at epoch 11 
 best_stats: {'best_valid_epoch': 11, 'best_valid_valid/acc': 70.326, 'best_valid_valid/acc_unbiased': 65.865, 'best_valid_valid/diff': 9.407, 'best_valid_valid/acc_skew': 61.162, 'best_valid_valid/acc_align': 70.569, 'best_valid_test/acc': 71.397, 'best_valid_test/acc_unbiased': 66.129, 'best_valid_test/diff': 8.793, 'best_valid_test/acc_skew': 61.732, 'best_valid_test/acc_align': 70.526}
[12 / 20] best test accuracy: 66.129 at epoch 11 
 best_stats: {'best_test_epoch': 11, 'best_test_valid/acc': 70.326, 'best_test_valid/acc_unbiased': 65.865, 'best_test_valid/diff': 9.407, 'best_test_valid/acc_skew': 61.162, 'best_test_valid/acc_align': 70.569, 'best_test_test/acc': 71.397, 'best_test_test/acc_unbiased': 66.129, 'best_test_test/diff': 8.793, 'best_test_test/acc_skew': 61.732, 'best_test_test/acc_align': 70.526}
[13 / 20] Learning rate: 0.0001 weight: 0.01
[13 / 20] Loss: 4.202102428337734 CE Loss: 0.4235360512613848 Con Loss: 4.1978670680447046
[13 / 20] tensor([[0.975, 0.807],
        [0.449, 0.400]]) {'epoch': 13, 'valid/acc': 71.34, 'valid/acc_unbiased': 66.183, 'valid/diff': 9.333, 'valid/acc_skew': 61.842, 'valid/acc_align': 70.525, 'test/acc': 71.926, 'test/acc_unbiased': 65.775, 'test/diff': 10.868, 'test/acc_skew': 62.775, 'test/acc_align': 68.775}
[13 / 20] best valid accuracy: 66.183 at epoch 13 
 best_stats: {'best_valid_epoch': 13, 'best_valid_valid/acc': 71.34, 'best_valid_valid/acc_unbiased': 66.183, 'best_valid_valid/diff': 9.333, 'best_valid_valid/acc_skew': 61.842, 'best_valid_valid/acc_align': 70.525, 'best_valid_test/acc': 71.926, 'best_valid_test/acc_unbiased': 65.775, 'best_valid_test/diff': 10.868, 'best_valid_test/acc_skew': 62.775, 'best_valid_test/acc_align': 68.775}
[13 / 20] best test accuracy: 66.129 at epoch 11 
 best_stats: {'best_test_epoch': 11, 'best_test_valid/acc': 70.326, 'best_test_valid/acc_unbiased': 65.865, 'best_test_valid/diff': 9.407, 'best_test_valid/acc_skew': 61.162, 'best_test_valid/acc_align': 70.569, 'best_test_test/acc': 71.397, 'best_test_test/acc_unbiased': 66.129, 'best_test_test/diff': 8.793, 'best_test_test/acc_skew': 61.732, 'best_test_test/acc_align': 70.526}
[14 / 20] Learning rate: 1e-05 weight: 0.01
[14 / 20] Loss: 4.1476594883152185 CE Loss: 0.4211445065059719 Con Loss: 4.1434480305782015
[14 / 20] tensor([[0.976, 0.801],
        [0.430, 0.382]]) {'epoch': 14, 'valid/acc': 70.767, 'valid/acc_unbiased': 65.977, 'valid/diff': 9.386, 'valid/acc_skew': 61.284, 'valid/acc_align': 70.67, 'test/acc': 71.089, 'test/acc_unbiased': 64.74, 'test/diff': 11.185, 'test/acc_skew': 61.568, 'test/acc_align': 67.913}
[14 / 20] best valid accuracy: 66.183 at epoch 13 
 best_stats: {'best_valid_epoch': 13, 'best_valid_valid/acc': 71.34, 'best_valid_valid/acc_unbiased': 66.183, 'best_valid_valid/diff': 9.333, 'best_valid_valid/acc_skew': 61.842, 'best_valid_valid/acc_align': 70.525, 'best_valid_test/acc': 71.926, 'best_valid_test/acc_unbiased': 65.775, 'best_valid_test/diff': 10.868, 'best_valid_test/acc_skew': 62.775, 'best_valid_test/acc_align': 68.775}
[14 / 20] best test accuracy: 66.129 at epoch 11 
 best_stats: {'best_test_epoch': 11, 'best_test_valid/acc': 70.326, 'best_test_valid/acc_unbiased': 65.865, 'best_test_valid/diff': 9.407, 'best_test_valid/acc_skew': 61.162, 'best_test_valid/acc_align': 70.569, 'best_test_test/acc': 71.397, 'best_test_test/acc_unbiased': 66.129, 'best_test_test/diff': 8.793, 'best_test_test/acc_skew': 61.732, 'best_test_test/acc_align': 70.526}
[15 / 20] Learning rate: 1e-05 weight: 0.01
[15 / 20] Loss: 4.149639394925088 CE Loss: 0.41963629106018524 Con Loss: 4.145443017631825
[15 / 20] tensor([[0.974, 0.784],
        [0.438, 0.394]]) {'epoch': 15, 'valid/acc': 70.635, 'valid/acc_unbiased': 65.006, 'valid/diff': 10.833, 'valid/acc_skew': 59.59, 'valid/acc_align': 70.423, 'test/acc': 71.221, 'test/acc_unbiased': 64.748, 'test/diff': 11.694, 'test/acc_skew': 61.119, 'test/acc_align': 68.377}
[15 / 20] best valid accuracy: 66.183 at epoch 13 
 best_stats: {'best_valid_epoch': 13, 'best_valid_valid/acc': 71.34, 'best_valid_valid/acc_unbiased': 66.183, 'best_valid_valid/diff': 9.333, 'best_valid_valid/acc_skew': 61.842, 'best_valid_valid/acc_align': 70.525, 'best_valid_test/acc': 71.926, 'best_valid_test/acc_unbiased': 65.775, 'best_valid_test/diff': 10.868, 'best_valid_test/acc_skew': 62.775, 'best_valid_test/acc_align': 68.775}
[15 / 20] best test accuracy: 66.129 at epoch 11 
 best_stats: {'best_test_epoch': 11, 'best_test_valid/acc': 70.326, 'best_test_valid/acc_unbiased': 65.865, 'best_test_valid/diff': 9.407, 'best_test_valid/acc_skew': 61.162, 'best_test_valid/acc_align': 70.569, 'best_test_test/acc': 71.397, 'best_test_test/acc_unbiased': 66.129, 'best_test_test/diff': 8.793, 'best_test_test/acc_skew': 61.732, 'best_test_test/acc_align': 70.526}
[16 / 20] Learning rate: 1e-05 weight: 0.01
[16 / 20] Loss: 4.147195658760542 CE Loss: 0.4132684074573774 Con Loss: 4.1430629859118815
[16 / 20] tensor([[0.976, 0.795],
        [0.401, 0.376]]) {'epoch': 16, 'valid/acc': 69.621, 'valid/acc_unbiased': 64.696, 'valid/diff': 10.153, 'valid/acc_skew': 59.619, 'valid/acc_align': 69.773, 'test/acc': 69.899, 'test/acc_unbiased': 63.726, 'test/diff': 10.33, 'test/acc_skew': 59.842, 'test/acc_align': 67.61}
[16 / 20] best valid accuracy: 66.183 at epoch 13 
 best_stats: {'best_valid_epoch': 13, 'best_valid_valid/acc': 71.34, 'best_valid_valid/acc_unbiased': 66.183, 'best_valid_valid/diff': 9.333, 'best_valid_valid/acc_skew': 61.842, 'best_valid_valid/acc_align': 70.525, 'best_valid_test/acc': 71.926, 'best_valid_test/acc_unbiased': 65.775, 'best_valid_test/diff': 10.868, 'best_valid_test/acc_skew': 62.775, 'best_valid_test/acc_align': 68.775}
[16 / 20] best test accuracy: 66.129 at epoch 11 
 best_stats: {'best_test_epoch': 11, 'best_test_valid/acc': 70.326, 'best_test_valid/acc_unbiased': 65.865, 'best_test_valid/diff': 9.407, 'best_test_valid/acc_skew': 61.162, 'best_test_valid/acc_align': 70.569, 'best_test_test/acc': 71.397, 'best_test_test/acc_unbiased': 66.129, 'best_test_test/diff': 8.793, 'best_test_test/acc_skew': 61.732, 'best_test_test/acc_align': 70.526}
[17 / 20] Learning rate: 1e-05 weight: 0.01
[17 / 20] Loss: 4.034960453539741 CE Loss: 0.4158864205738705 Con Loss: 4.030801583121931
[17 / 20] tensor([[0.977, 0.795],
        [0.401, 0.388]]) {'epoch': 17, 'valid/acc': 69.533, 'valid/acc_unbiased': 64.35, 'valid/diff': 9.855, 'valid/acc_skew': 59.423, 'valid/acc_align': 69.278, 'test/acc': 70.031, 'test/acc_unbiased': 64.052, 'test/diff': 9.772, 'test/acc_skew': 59.842, 'test/acc_align': 68.263}
[17 / 20] best valid accuracy: 66.183 at epoch 13 
 best_stats: {'best_valid_epoch': 13, 'best_valid_valid/acc': 71.34, 'best_valid_valid/acc_unbiased': 66.183, 'best_valid_valid/diff': 9.333, 'best_valid_valid/acc_skew': 61.842, 'best_valid_valid/acc_align': 70.525, 'best_valid_test/acc': 71.926, 'best_valid_test/acc_unbiased': 65.775, 'best_valid_test/diff': 10.868, 'best_valid_test/acc_skew': 62.775, 'best_valid_test/acc_align': 68.775}
[17 / 20] best test accuracy: 66.129 at epoch 11 
 best_stats: {'best_test_epoch': 11, 'best_test_valid/acc': 70.326, 'best_test_valid/acc_unbiased': 65.865, 'best_test_valid/diff': 9.407, 'best_test_valid/acc_skew': 61.162, 'best_test_valid/acc_align': 70.569, 'best_test_test/acc': 71.397, 'best_test_test/acc_unbiased': 66.129, 'best_test_test/diff': 8.793, 'best_test_test/acc_skew': 61.732, 'best_test_test/acc_align': 70.526}
[18 / 20] Learning rate: 1e-05 weight: 0.01
[18 / 20] Loss: 4.142424688942644 CE Loss: 0.4114735792723991 Con Loss: 4.138309955061352
[18 / 20] tensor([[0.975, 0.801],
        [0.409, 0.388]]) {'epoch': 18, 'valid/acc': 69.885, 'valid/acc_unbiased': 65.087, 'valid/diff': 8.683, 'valid/acc_skew': 60.745, 'valid/acc_align': 69.428, 'test/acc': 70.295, 'test/acc_unbiased': 64.349, 'test/diff': 9.797, 'test/acc_skew': 60.53, 'test/acc_align': 68.169}
[18 / 20] best valid accuracy: 66.183 at epoch 13 
 best_stats: {'best_valid_epoch': 13, 'best_valid_valid/acc': 71.34, 'best_valid_valid/acc_unbiased': 66.183, 'best_valid_valid/diff': 9.333, 'best_valid_valid/acc_skew': 61.842, 'best_valid_valid/acc_align': 70.525, 'best_valid_test/acc': 71.926, 'best_valid_test/acc_unbiased': 65.775, 'best_valid_test/diff': 10.868, 'best_valid_test/acc_skew': 62.775, 'best_valid_test/acc_align': 68.775}
[18 / 20] best test accuracy: 66.129 at epoch 11 
 best_stats: {'best_test_epoch': 11, 'best_test_valid/acc': 70.326, 'best_test_valid/acc_unbiased': 65.865, 'best_test_valid/diff': 9.407, 'best_test_valid/acc_skew': 61.162, 'best_test_valid/acc_align': 70.569, 'best_test_test/acc': 71.397, 'best_test_test/acc_unbiased': 66.129, 'best_test_test/diff': 8.793, 'best_test_test/acc_skew': 61.732, 'best_test_test/acc_align': 70.526}
[19 / 20] Learning rate: 1e-05 weight: 0.01
[19 / 20] Loss: 4.1194406466196645 CE Loss: 0.4043913987503209 Con Loss: 4.1153967242167715
[19 / 20] tensor([[0.976, 0.778],
        [0.419, 0.376]]) {'epoch': 19, 'valid/acc': 70.15, 'valid/acc_unbiased': 65.447, 'valid/diff': 11.136, 'valid/acc_skew': 59.88, 'valid/acc_align': 71.015, 'test/acc': 70.428, 'test/acc_unbiased': 63.732, 'test/diff': 12.048, 'test/acc_skew': 59.855, 'test/acc_align': 67.61}
[19 / 20] best valid accuracy: 66.183 at epoch 13 
 best_stats: {'best_valid_epoch': 13, 'best_valid_valid/acc': 71.34, 'best_valid_valid/acc_unbiased': 66.183, 'best_valid_valid/diff': 9.333, 'best_valid_valid/acc_skew': 61.842, 'best_valid_valid/acc_align': 70.525, 'best_valid_test/acc': 71.926, 'best_valid_test/acc_unbiased': 65.775, 'best_valid_test/diff': 10.868, 'best_valid_test/acc_skew': 62.775, 'best_valid_test/acc_align': 68.775}
[19 / 20] best test accuracy: 66.129 at epoch 11 
 best_stats: {'best_test_epoch': 11, 'best_test_valid/acc': 70.326, 'best_test_valid/acc_unbiased': 65.865, 'best_test_valid/diff': 9.407, 'best_test_valid/acc_skew': 61.162, 'best_test_valid/acc_align': 70.569, 'best_test_test/acc': 71.397, 'best_test_test/acc_unbiased': 66.129, 'best_test_test/diff': 8.793, 'best_test_test/acc_skew': 61.732, 'best_test_test/acc_align': 70.526}
[20 / 20] Learning rate: 1e-05 weight: 0.01
[20 / 20] Loss: 4.106741227714456 CE Loss: 0.4050007144729103 Con Loss: 4.10269123193076
[20 / 20] tensor([[0.976, 0.773],
        [0.423, 0.400]]) {'epoch': 20, 'valid/acc': 70.106, 'valid/acc_unbiased': 65.112, 'valid/diff': 12.398, 'valid/acc_skew': 58.913, 'valid/acc_align': 71.311, 'test/acc': 70.736, 'test/acc_unbiased': 64.312, 'test/diff': 11.35, 'test/acc_skew': 59.801, 'test/acc_align': 68.822}
[20 / 20] best valid accuracy: 66.183 at epoch 13 
 best_stats: {'best_valid_epoch': 13, 'best_valid_valid/acc': 71.34, 'best_valid_valid/acc_unbiased': 66.183, 'best_valid_valid/diff': 9.333, 'best_valid_valid/acc_skew': 61.842, 'best_valid_valid/acc_align': 70.525, 'best_valid_test/acc': 71.926, 'best_valid_test/acc_unbiased': 65.775, 'best_valid_test/diff': 10.868, 'best_valid_test/acc_skew': 62.775, 'best_valid_test/acc_align': 68.775}
[20 / 20] best test accuracy: 66.129 at epoch 11 
 best_stats: {'best_test_epoch': 11, 'best_test_valid/acc': 70.326, 'best_test_valid/acc_unbiased': 65.865, 'best_test_valid/diff': 9.407, 'best_test_valid/acc_skew': 61.162, 'best_test_valid/acc_align': 70.569, 'best_test_test/acc': 71.397, 'best_test_test/acc_unbiased': 66.129, 'best_test_test/diff': 8.793, 'best_test_test/acc_skew': 61.732, 'best_test_test/acc_align': 70.526}
Total training time: 0:16:17
