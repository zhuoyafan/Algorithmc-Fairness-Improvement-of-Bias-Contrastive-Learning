Log level set to: INFO
Set seed: 2
=======> Using Fixed Random Seed: 2 <========
save_path: exp_results/bc-bb0-celeba_blonde-os_0.8-lr0.001-bs128-cbs64-w0.01-ratio30-aug1-seed2
get_celeba - split:train, aug: False, given_y: True, ratio: 0
use existing blonde indices from data/celeba/pickles/blonde
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [42843, 42843]
Target 1: [42843, 42843]
Binary Target 1
---------------------------
Target 0: [42843, 42843]
Target 1: [42843, 42843]
===================================
Normal Label Distribution: 
Target 0: [42843, 42843]
Target 1: [42843, 42843]
===================================
Use BiasedCelebASplit 
 target_attr: blonde split: train 
 tensor([[42843., 42843.],
        [42843., 42843.]])
get_celeba - split:train, aug: 1, given_y: True, ratio: 30
use existing blonde indices from data/celeba/pickles/blonde
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [42779, 42779]
Target 1: [42779, 42779]
Binary Target 1
---------------------------
Target 0: [42779, 42779]
Target 1: [42779, 42779]
===================================
Normal Label Distribution: 
Target 0: [42779, 42779]
Target 1: [42779, 42779]
===================================
Use BiasedCelebASplit 
 target_attr: blonde split: train 
 tensor([[42779., 42779.],
        [42779., 42779.]])
get_celeba - split:train_valid, aug: False, given_y: True, ratio: 0
use existing blonde indices from data/celeba/pickles/blonde
Use BiasedCelebASplit 
 target_attr: blonde split: train_valid 
 tensor([[  403.,  4597.],
        [13344.,   285.]])
get_celeba - split:valid, aug: False, given_y: True, ratio: 0
Use BiasedCelebASplit 
 target_attr: blonde split: valid 
 tensor([[8535., 2874.],
        [8276.,  182.]])
decay_epochs: [3, 6]
[1 / 10] Learning rate: 0.001 weight: 0.01
[1 / 10] Loss: 4.620702544494751 CE Loss: 0.24263291584272037 Con Loss: 4.618276222550791
[1 / 10] tensor([[0.869, 0.926],
        [0.944, 0.885]]) {'epoch': 1, 'valid/acc': 92.565, 'valid/acc_unbiased': 92.944, 'valid/diff': 2.605, 'valid/acc_skew': 94.247, 'valid/acc_align': 91.642, 'test/acc': 90.386, 'test/acc_unbiased': 90.603, 'test/diff': 5.844, 'test/acc_skew': 90.667, 'test/acc_align': 90.539}
[1 / 10] best valid accuracy: 92.944 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 92.565, 'best_valid_valid/acc_unbiased': 92.944, 'best_valid_valid/diff': 2.605, 'best_valid_valid/acc_skew': 94.247, 'best_valid_valid/acc_align': 91.642, 'best_valid_test/acc': 90.386, 'best_valid_test/acc_unbiased': 90.603, 'best_valid_test/diff': 5.844, 'best_valid_test/acc_skew': 90.667, 'best_valid_test/acc_align': 90.539}
[1 / 10] best test accuracy: 90.603 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 92.565, 'best_test_valid/acc_unbiased': 92.944, 'best_test_valid/diff': 2.605, 'best_test_valid/acc_skew': 94.247, 'best_test_valid/acc_align': 91.642, 'best_test_test/acc': 90.386, 'best_test_test/acc_unbiased': 90.603, 'best_test_test/diff': 5.844, 'best_test_test/acc_skew': 90.667, 'best_test_test/acc_align': 90.539}
[2 / 10] Learning rate: 0.001 weight: 0.01
[2 / 10] Loss: 4.568926730426512 CE Loss: 0.20612309822706637 Con Loss: 4.566865497762559
[2 / 10] tensor([[0.860, 0.935],
        [0.953, 0.852]]) {'epoch': 2, 'valid/acc': 93.736, 'valid/acc_unbiased': 93.414, 'valid/diff': 2.278, 'valid/acc_skew': 94.553, 'valid/acc_align': 92.275, 'test/acc': 90.482, 'test/acc_unbiased': 90.009, 'test/diff': 8.855, 'test/acc_skew': 90.668, 'test/acc_align': 89.35}
[2 / 10] best valid accuracy: 93.414 at epoch 2 
 best_stats: {'best_valid_epoch': 2, 'best_valid_valid/acc': 93.736, 'best_valid_valid/acc_unbiased': 93.414, 'best_valid_valid/diff': 2.278, 'best_valid_valid/acc_skew': 94.553, 'best_valid_valid/acc_align': 92.275, 'best_valid_test/acc': 90.482, 'best_valid_test/acc_unbiased': 90.009, 'best_valid_test/diff': 8.855, 'best_valid_test/acc_skew': 90.668, 'best_valid_test/acc_align': 89.35}
[2 / 10] best test accuracy: 90.603 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 92.565, 'best_test_valid/acc_unbiased': 92.944, 'best_test_valid/diff': 2.605, 'best_test_valid/acc_skew': 94.247, 'best_test_valid/acc_align': 91.642, 'best_test_test/acc': 90.386, 'best_test_test/acc_unbiased': 90.603, 'best_test_test/diff': 5.844, 'best_test_test/acc_skew': 90.667, 'best_test_test/acc_align': 90.539}
[3 / 10] Learning rate: 0.001 weight: 0.01
[3 / 10] Loss: 4.538958055856245 CE Loss: 0.18958660634474753 Con Loss: 4.537062188878552
[3 / 10] tensor([[0.872, 0.949],
        [0.948, 0.857]]) {'epoch': 3, 'valid/acc': 94.246, 'valid/acc_unbiased': 93.351, 'valid/diff': 2.67, 'valid/acc_skew': 94.686, 'valid/acc_align': 92.016, 'test/acc': 91.483, 'test/acc_unbiased': 90.65, 'test/diff': 8.368, 'test/acc_skew': 91.016, 'test/acc_align': 90.283}
[3 / 10] best valid accuracy: 93.414 at epoch 2 
 best_stats: {'best_valid_epoch': 2, 'best_valid_valid/acc': 93.736, 'best_valid_valid/acc_unbiased': 93.414, 'best_valid_valid/diff': 2.278, 'best_valid_valid/acc_skew': 94.553, 'best_valid_valid/acc_align': 92.275, 'best_valid_test/acc': 90.482, 'best_valid_test/acc_unbiased': 90.009, 'best_valid_test/diff': 8.855, 'best_valid_test/acc_skew': 90.668, 'best_valid_test/acc_align': 89.35}
[3 / 10] best test accuracy: 90.650 at epoch 3 
 best_stats: {'best_test_epoch': 3, 'best_test_valid/acc': 94.246, 'best_test_valid/acc_unbiased': 93.351, 'best_test_valid/diff': 2.67, 'best_test_valid/acc_skew': 94.686, 'best_test_valid/acc_align': 92.016, 'best_test_test/acc': 91.483, 'best_test_test/acc_unbiased': 90.65, 'best_test_test/diff': 8.368, 'best_test_test/acc_skew': 91.016, 'best_test_test/acc_align': 90.283}
[4 / 10] Learning rate: 0.0001 weight: 0.01
[4 / 10] Loss: 4.459888505620693 CE Loss: 0.14758569814371378 Con Loss: 4.458412659456785
[4 / 10] tensor([[0.854, 0.944],
        [0.963, 0.896]]) {'epoch': 4, 'valid/acc': 94.868, 'valid/acc_unbiased': 95.687, 'valid/diff': 1.714, 'valid/acc_skew': 96.545, 'valid/acc_align': 94.83, 'test/acc': 90.754, 'test/acc_unbiased': 91.416, 'test/diff': 7.871, 'test/acc_skew': 90.874, 'test/acc_align': 91.959}
[4 / 10] best valid accuracy: 95.687 at epoch 4 
 best_stats: {'best_valid_epoch': 4, 'best_valid_valid/acc': 94.868, 'best_valid_valid/acc_unbiased': 95.687, 'best_valid_valid/diff': 1.714, 'best_valid_valid/acc_skew': 96.545, 'best_valid_valid/acc_align': 94.83, 'best_valid_test/acc': 90.754, 'best_valid_test/acc_unbiased': 91.416, 'best_valid_test/diff': 7.871, 'best_valid_test/acc_skew': 90.874, 'best_valid_test/acc_align': 91.959}
[4 / 10] best test accuracy: 91.416 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 94.868, 'best_test_valid/acc_unbiased': 95.687, 'best_test_valid/diff': 1.714, 'best_test_valid/acc_skew': 96.545, 'best_test_valid/acc_align': 94.83, 'best_test_test/acc': 90.754, 'best_test_test/acc_unbiased': 91.416, 'best_test_test/diff': 7.871, 'best_test_test/acc_skew': 90.874, 'best_test_test/acc_align': 91.959}
[5 / 10] Learning rate: 0.0001 weight: 0.01
[5 / 10] Loss: 4.434361158342078 CE Loss: 0.13586653616502223 Con Loss: 4.433002493805159
[5 / 10] tensor([[0.836, 0.940],
        [0.971, 0.879]]) {'epoch': 5, 'valid/acc': 94.777, 'valid/acc_unbiased': 96.33, 'valid/diff': 1.687, 'valid/acc_skew': 97.173, 'valid/acc_align': 95.486, 'test/acc': 89.908, 'test/acc_unbiased': 90.639, 'test/diff': 9.781, 'test/acc_skew': 90.331, 'test/acc_align': 90.947}
[5 / 10] best valid accuracy: 96.330 at epoch 5 
 best_stats: {'best_valid_epoch': 5, 'best_valid_valid/acc': 94.777, 'best_valid_valid/acc_unbiased': 96.33, 'best_valid_valid/diff': 1.687, 'best_valid_valid/acc_skew': 97.173, 'best_valid_valid/acc_align': 95.486, 'best_valid_test/acc': 89.908, 'best_valid_test/acc_unbiased': 90.639, 'best_valid_test/diff': 9.781, 'best_valid_test/acc_skew': 90.331, 'best_valid_test/acc_align': 90.947}
[5 / 10] best test accuracy: 91.416 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 94.868, 'best_test_valid/acc_unbiased': 95.687, 'best_test_valid/diff': 1.714, 'best_test_valid/acc_skew': 96.545, 'best_test_valid/acc_align': 94.83, 'best_test_test/acc': 90.754, 'best_test_test/acc_unbiased': 91.416, 'best_test_test/diff': 7.871, 'best_test_test/acc_skew': 90.874, 'best_test_test/acc_align': 91.959}
[6 / 10] Learning rate: 0.0001 weight: 0.01
[6 / 10] Loss: 4.411387355972638 CE Loss: 0.12819161937515478 Con Loss: 4.4101054363189744
[6 / 10] tensor([[0.853, 0.952],
        [0.962, 0.885]]) {'epoch': 6, 'valid/acc': 95.523, 'valid/acc_unbiased': 96.235, 'valid/diff': 1.969, 'valid/acc_skew': 97.219, 'valid/acc_align': 95.25, 'test/acc': 91.056, 'test/acc_unbiased': 91.313, 'test/diff': 8.856, 'test/acc_skew': 90.775, 'test/acc_align': 91.85}
[6 / 10] best valid accuracy: 96.330 at epoch 5 
 best_stats: {'best_valid_epoch': 5, 'best_valid_valid/acc': 94.777, 'best_valid_valid/acc_unbiased': 96.33, 'best_valid_valid/diff': 1.687, 'best_valid_valid/acc_skew': 97.173, 'best_valid_valid/acc_align': 95.486, 'best_valid_test/acc': 89.908, 'best_valid_test/acc_unbiased': 90.639, 'best_valid_test/diff': 9.781, 'best_valid_test/acc_skew': 90.331, 'best_valid_test/acc_align': 90.947}
[6 / 10] best test accuracy: 91.416 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 94.868, 'best_test_valid/acc_unbiased': 95.687, 'best_test_valid/diff': 1.714, 'best_test_valid/acc_skew': 96.545, 'best_test_valid/acc_align': 94.83, 'best_test_test/acc': 90.754, 'best_test_test/acc_unbiased': 91.416, 'best_test_test/diff': 7.871, 'best_test_test/acc_skew': 90.874, 'best_test_test/acc_align': 91.959}
[7 / 10] Learning rate: 1e-05 weight: 0.01
[7 / 10] Loss: 4.391787523549191 CE Loss: 0.12226261851287724 Con Loss: 4.390564907744349
[7 / 10] tensor([[0.855, 0.955],
        [0.959, 0.885]]) {'epoch': 7, 'valid/acc': 95.829, 'valid/acc_unbiased': 96.67, 'valid/diff': 1.412, 'valid/acc_skew': 97.376, 'valid/acc_align': 95.964, 'test/acc': 91.217, 'test/acc_unbiased': 91.351, 'test/diff': 8.722, 'test/acc_skew': 90.706, 'test/acc_align': 91.995}
[7 / 10] best valid accuracy: 96.670 at epoch 7 
 best_stats: {'best_valid_epoch': 7, 'best_valid_valid/acc': 95.829, 'best_valid_valid/acc_unbiased': 96.67, 'best_valid_valid/diff': 1.412, 'best_valid_valid/acc_skew': 97.376, 'best_valid_valid/acc_align': 95.964, 'best_valid_test/acc': 91.217, 'best_valid_test/acc_unbiased': 91.351, 'best_valid_test/diff': 8.722, 'best_valid_test/acc_skew': 90.706, 'best_valid_test/acc_align': 91.995}
[7 / 10] best test accuracy: 91.416 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 94.868, 'best_test_valid/acc_unbiased': 95.687, 'best_test_valid/diff': 1.714, 'best_test_valid/acc_skew': 96.545, 'best_test_valid/acc_align': 94.83, 'best_test_test/acc': 90.754, 'best_test_test/acc_unbiased': 91.416, 'best_test_test/diff': 7.871, 'best_test_test/acc_skew': 90.874, 'best_test_test/acc_align': 91.959}
[8 / 10] Learning rate: 1e-05 weight: 0.01
[8 / 10] Loss: 4.388748185662382 CE Loss: 0.11975668061434983 Con Loss: 4.387550623369098
[8 / 10] tensor([[0.847, 0.954],
        [0.965, 0.879]]) {'epoch': 8, 'valid/acc': 95.781, 'valid/acc_unbiased': 96.557, 'valid/diff': 1.695, 'valid/acc_skew': 97.404, 'valid/acc_align': 95.71, 'test/acc': 90.879, 'test/acc_unbiased': 91.117, 'test/diff': 9.648, 'test/acc_skew': 90.58, 'test/acc_align': 91.654}
[8 / 10] best valid accuracy: 96.670 at epoch 7 
 best_stats: {'best_valid_epoch': 7, 'best_valid_valid/acc': 95.829, 'best_valid_valid/acc_unbiased': 96.67, 'best_valid_valid/diff': 1.412, 'best_valid_valid/acc_skew': 97.376, 'best_valid_valid/acc_align': 95.964, 'best_valid_test/acc': 91.217, 'best_valid_test/acc_unbiased': 91.351, 'best_valid_test/diff': 8.722, 'best_valid_test/acc_skew': 90.706, 'best_valid_test/acc_align': 91.995}
[8 / 10] best test accuracy: 91.416 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 94.868, 'best_test_valid/acc_unbiased': 95.687, 'best_test_valid/diff': 1.714, 'best_test_valid/acc_skew': 96.545, 'best_test_valid/acc_align': 94.83, 'best_test_test/acc': 90.754, 'best_test_test/acc_unbiased': 91.416, 'best_test_test/diff': 7.871, 'best_test_test/acc_skew': 90.874, 'best_test_test/acc_align': 91.959}
[9 / 10] Learning rate: 1e-05 weight: 0.01
[9 / 10] Loss: 4.382609957554393 CE Loss: 0.11777211391206961 Con Loss: 4.381432238879014
[9 / 10] tensor([[0.849, 0.953],
        [0.964, 0.868]]) {'epoch': 9, 'valid/acc': 95.872, 'valid/acc_unbiased': 96.801, 'valid/diff': 2.025, 'valid/acc_skew': 97.813, 'valid/acc_align': 95.788, 'test/acc': 90.93, 'test/acc_unbiased': 90.866, 'test/diff': 10.009, 'test/acc_skew': 90.663, 'test/acc_align': 91.069}
[9 / 10] best valid accuracy: 96.801 at epoch 9 
 best_stats: {'best_valid_epoch': 9, 'best_valid_valid/acc': 95.872, 'best_valid_valid/acc_unbiased': 96.801, 'best_valid_valid/diff': 2.025, 'best_valid_valid/acc_skew': 97.813, 'best_valid_valid/acc_align': 95.788, 'best_valid_test/acc': 90.93, 'best_valid_test/acc_unbiased': 90.866, 'best_valid_test/diff': 10.009, 'best_valid_test/acc_skew': 90.663, 'best_valid_test/acc_align': 91.069}
[9 / 10] best test accuracy: 91.416 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 94.868, 'best_test_valid/acc_unbiased': 95.687, 'best_test_valid/diff': 1.714, 'best_test_valid/acc_skew': 96.545, 'best_test_valid/acc_align': 94.83, 'best_test_test/acc': 90.754, 'best_test_test/acc_unbiased': 91.416, 'best_test_test/diff': 7.871, 'best_test_test/acc_skew': 90.874, 'best_test_test/acc_align': 91.959}
[10 / 10] Learning rate: 1e-05 weight: 0.01
[10 / 10] Loss: 4.380946684848627 CE Loss: 0.11764800449254129 Con Loss: 4.379770209279918
[10 / 10] tensor([[0.847, 0.954],
        [0.961, 0.852]]) {'epoch': 10, 'valid/acc': 95.824, 'valid/acc_unbiased': 96.873, 'valid/diff': 1.902, 'valid/acc_skew': 97.824, 'valid/acc_align': 95.922, 'test/acc': 90.794, 'test/acc_unbiased': 90.332, 'test/diff': 10.824, 'test/acc_skew': 90.389, 'test/acc_align': 90.275}
[10 / 10] best valid accuracy: 96.873 at epoch 10 
 best_stats: {'best_valid_epoch': 10, 'best_valid_valid/acc': 95.824, 'best_valid_valid/acc_unbiased': 96.873, 'best_valid_valid/diff': 1.902, 'best_valid_valid/acc_skew': 97.824, 'best_valid_valid/acc_align': 95.922, 'best_valid_test/acc': 90.794, 'best_valid_test/acc_unbiased': 90.332, 'best_valid_test/diff': 10.824, 'best_valid_test/acc_skew': 90.389, 'best_valid_test/acc_align': 90.275}
[10 / 10] best test accuracy: 91.416 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 94.868, 'best_test_valid/acc_unbiased': 95.687, 'best_test_valid/diff': 1.714, 'best_test_valid/acc_skew': 96.545, 'best_test_valid/acc_align': 94.83, 'best_test_test/acc': 90.754, 'best_test_test/acc_unbiased': 91.416, 'best_test_test/diff': 7.871, 'best_test_test/acc_skew': 90.874, 'best_test_test/acc_align': 91.959}
Total training time: 2:20:25
