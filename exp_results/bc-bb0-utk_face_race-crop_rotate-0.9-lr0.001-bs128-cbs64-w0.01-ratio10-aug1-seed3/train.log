Log level set to: INFO
Set seed: 3
=======> Using Fixed Random Seed: 3 <========
save_path: exp_results/bc-bb0-utk_face_race-crop_rotate-0.9-lr0.001-bs128-cbs64-w0.01-ratio10-aug1-seed3
get_utk_face - split: train, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_race-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [4407, 552]
Target 1: [440, 5529]
Binary Target 1
---------------------------
Target 0: [4407, 552]
Target 1: [440, 5529]
===================================
Normal Label Distribution: 
Target 0: [4407, 552]
Target 1: [440, 5529]
===================================
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [4407, 552]
Target 1: [440, 5529]
Binary Target 1
---------------------------
Target 0: [4407, 552]
Target 1: [440, 5529]
===================================
Normal Label Distribution: 
Target 0: [4407, 552]
Target 1: [440, 5529]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 10928, target_attr: gender, bias_attr: race bias_rate: 0.9
['[train] target_0-bias_0: 4407', '[train] target_0-bias_1: 552', '[train] target_1-bias_0: 440', '[train] target_1-bias_1: 5529']
confusion_matrix - 
 original: tensor([[4407.,  440.],
        [ 552., 5529.]]), 
 normalized: tensor([[0.909, 0.091],
        [0.091, 0.909]]), 
 b|y: tensor([[0.889, 0.111],
        [0.074, 0.926]])
get_utk_face - split: train, aug: 1, given_y: True, ratio: 10
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_race-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [4407, 552]
Target 1: [440, 5529]
Binary Target 1
---------------------------
Target 0: [4407, 552]
Target 1: [440, 5529]
===================================
Normal Label Distribution: 
Target 0: [4407, 552]
Target 1: [440, 5529]
===================================
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [4407, 552]
Target 1: [440, 5529]
Binary Target 1
---------------------------
Target 0: [4407, 552]
Target 1: [440, 5529]
===================================
Normal Label Distribution: 
Target 0: [4407, 552]
Target 1: [440, 5529]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 10928, target_attr: gender, bias_attr: race bias_rate: 0.9
['[train] target_0-bias_0: 4407', '[train] target_0-bias_1: 552', '[train] target_1-bias_0: 440', '[train] target_1-bias_1: 5529']
get_utk_face - split: valid, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_race-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [583, 684]
Target 1: [457, 646]
Binary Target 1
---------------------------
Target 0: [583, 684]
Target 1: [457, 646]
===================================
Normal Label Distribution: 
Target 0: [583, 684]
Target 1: [457, 646]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 2370, target_attr: gender, bias_attr: race bias_rate: 0.9
['[valid] target_0-bias_0: 583', '[valid] target_0-bias_1: 684', '[valid] target_1-bias_0: 457', '[valid] target_1-bias_1: 646']
get_utk_face - split: test, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_race-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [558, 677]
Target 1: [462, 673]
Binary Target 1
---------------------------
Target 0: [558, 677]
Target 1: [462, 673]
===================================
Normal Label Distribution: 
Target 0: [558, 677]
Target 1: [462, 673]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 2370, target_attr: gender, bias_attr: race bias_rate: 0.9
['[test] target_0-bias_0: 558', '[test] target_0-bias_1: 677', '[test] target_1-bias_0: 462', '[test] target_1-bias_1: 673']
decay_epochs: [6, 13]
[1 / 20] Learning rate: 0.001 weight: 0.01
[1 / 20] Loss: 4.918082349645969 CE Loss: 0.6431634517749267 Con Loss: 4.911650716298496
[1 / 20] tensor([[0.767, 0.736],
        [0.571, 0.698]]) {'epoch': 1, 'valid/acc': 70.591, 'valid/acc_unbiased': 70.019, 'valid/diff': 2.821, 'valid/acc_skew': 68.609, 'valid/acc_align': 71.43, 'test/acc': 70.042, 'test/acc_unbiased': 69.31, 'test/diff': 7.918, 'test/acc_skew': 65.351, 'test/acc_align': 73.27}
[1 / 20] best valid accuracy: 70.019 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 70.591, 'best_valid_valid/acc_unbiased': 70.019, 'best_valid_valid/diff': 2.821, 'best_valid_valid/acc_skew': 68.609, 'best_valid_valid/acc_align': 71.43, 'best_valid_test/acc': 70.042, 'best_valid_test/acc_unbiased': 69.31, 'best_valid_test/diff': 7.918, 'best_valid_test/acc_skew': 65.351, 'best_valid_test/acc_align': 73.27}
[1 / 20] best test accuracy: 69.310 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 70.591, 'best_test_valid/acc_unbiased': 70.019, 'best_test_valid/diff': 2.821, 'best_test_valid/acc_skew': 68.609, 'best_test_valid/acc_align': 71.43, 'best_test_test/acc': 70.042, 'best_test_test/acc_unbiased': 69.31, 'best_test_test/diff': 7.918, 'best_test_test/acc_skew': 65.351, 'best_test_test/acc_align': 73.27}
[2 / 20] Learning rate: 0.001 weight: 0.01
[2 / 20] Loss: 4.829032552364455 CE Loss: 0.5607520469285733 Con Loss: 4.82342504372883
[2 / 20] tensor([[0.661, 0.579],
        [0.779, 0.829]]) {'epoch': 2, 'valid/acc': 71.814, 'valid/acc_unbiased': 72.371, 'valid/diff': 1.644, 'valid/acc_skew': 71.549, 'valid/acc_align': 73.193, 'test/acc': 70.844, 'test/acc_unbiased': 71.216, 'test/diff': 6.608, 'test/acc_skew': 67.912, 'test/acc_align': 74.521}
[2 / 20] best valid accuracy: 72.371 at epoch 2 
 best_stats: {'best_valid_epoch': 2, 'best_valid_valid/acc': 71.814, 'best_valid_valid/acc_unbiased': 72.371, 'best_valid_valid/diff': 1.644, 'best_valid_valid/acc_skew': 71.549, 'best_valid_valid/acc_align': 73.193, 'best_valid_test/acc': 70.844, 'best_valid_test/acc_unbiased': 71.216, 'best_valid_test/diff': 6.608, 'best_valid_test/acc_skew': 67.912, 'best_valid_test/acc_align': 74.521}
[2 / 20] best test accuracy: 71.216 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 71.814, 'best_test_valid/acc_unbiased': 72.371, 'best_test_valid/diff': 1.644, 'best_test_valid/acc_skew': 71.549, 'best_test_valid/acc_align': 73.193, 'best_test_test/acc': 70.844, 'best_test_test/acc_unbiased': 71.216, 'best_test_test/diff': 6.608, 'best_test_test/acc_skew': 67.912, 'best_test_test/acc_align': 74.521}
[3 / 20] Learning rate: 0.001 weight: 0.01
[3 / 20] Loss: 4.818794919316975 CE Loss: 0.5684584755325038 Con Loss: 4.813110333410573
[3 / 20] tensor([[0.235, 0.288],
        [0.950, 0.949]]) {'epoch': 3, 'valid/acc': 57.806, 'valid/acc_unbiased': 60.192, 'valid/diff': 5.938, 'valid/acc_skew': 63.161, 'valid/acc_align': 57.223, 'test/acc': 59.241, 'test/acc_unbiased': 60.562, 'test/diff': 2.7, 'test/acc_skew': 61.913, 'test/acc_align': 59.212}
[3 / 20] best valid accuracy: 72.371 at epoch 2 
 best_stats: {'best_valid_epoch': 2, 'best_valid_valid/acc': 71.814, 'best_valid_valid/acc_unbiased': 72.371, 'best_valid_valid/diff': 1.644, 'best_valid_valid/acc_skew': 71.549, 'best_valid_valid/acc_align': 73.193, 'best_valid_test/acc': 70.844, 'best_valid_test/acc_unbiased': 71.216, 'best_valid_test/diff': 6.608, 'best_valid_test/acc_skew': 67.912, 'best_valid_test/acc_align': 74.521}
[3 / 20] best test accuracy: 71.216 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 71.814, 'best_test_valid/acc_unbiased': 72.371, 'best_test_valid/diff': 1.644, 'best_test_valid/acc_skew': 71.549, 'best_test_valid/acc_align': 73.193, 'best_test_test/acc': 70.844, 'best_test_test/acc_unbiased': 71.216, 'best_test_test/diff': 6.608, 'best_test_test/acc_skew': 67.912, 'best_test_test/acc_align': 74.521}
[4 / 20] Learning rate: 0.001 weight: 0.01
[4 / 20] Loss: 4.809010870809262 CE Loss: 0.5641659317568141 Con Loss: 4.803369204436005
[4 / 20] tensor([[0.663, 0.498],
        [0.747, 0.856]]) {'epoch': 4, 'valid/acc': 68.312, 'valid/acc_unbiased': 69.18, 'valid/diff': 8.927, 'valid/acc_skew': 64.716, 'valid/acc_align': 73.643, 'test/acc': 68.692, 'test/acc_unbiased': 69.087, 'test/diff': 13.721, 'test/acc_skew': 62.227, 'test/acc_align': 75.948}
[4 / 20] best valid accuracy: 72.371 at epoch 2 
 best_stats: {'best_valid_epoch': 2, 'best_valid_valid/acc': 71.814, 'best_valid_valid/acc_unbiased': 72.371, 'best_valid_valid/diff': 1.644, 'best_valid_valid/acc_skew': 71.549, 'best_valid_valid/acc_align': 73.193, 'best_valid_test/acc': 70.844, 'best_valid_test/acc_unbiased': 71.216, 'best_valid_test/diff': 6.608, 'best_valid_test/acc_skew': 67.912, 'best_valid_test/acc_align': 74.521}
[4 / 20] best test accuracy: 71.216 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 71.814, 'best_test_valid/acc_unbiased': 72.371, 'best_test_valid/diff': 1.644, 'best_test_valid/acc_skew': 71.549, 'best_test_valid/acc_align': 73.193, 'best_test_test/acc': 70.844, 'best_test_test/acc_unbiased': 71.216, 'best_test_test/diff': 6.608, 'best_test_test/acc_skew': 67.912, 'best_test_test/acc_align': 74.521}
[5 / 20] Learning rate: 0.001 weight: 0.01
[5 / 20] Loss: 4.788872425587599 CE Loss: 0.5652365725525651 Con Loss: 4.78322003840702
[5 / 20] tensor([[0.303, 0.318],
        [0.868, 0.926]]) {'epoch': 5, 'valid/acc': 59.114, 'valid/acc_unbiased': 61.014, 'valid/diff': 5.862, 'valid/acc_skew': 62.619, 'valid/acc_align': 59.409, 'test/acc': 59.409, 'test/acc_unbiased': 60.353, 'test/diff': 3.623, 'test/acc_skew': 59.277, 'test/acc_align': 61.429}
[5 / 20] best valid accuracy: 72.371 at epoch 2 
 best_stats: {'best_valid_epoch': 2, 'best_valid_valid/acc': 71.814, 'best_valid_valid/acc_unbiased': 72.371, 'best_valid_valid/diff': 1.644, 'best_valid_valid/acc_skew': 71.549, 'best_valid_valid/acc_align': 73.193, 'best_valid_test/acc': 70.844, 'best_valid_test/acc_unbiased': 71.216, 'best_valid_test/diff': 6.608, 'best_valid_test/acc_skew': 67.912, 'best_valid_test/acc_align': 74.521}
[5 / 20] best test accuracy: 71.216 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 71.814, 'best_test_valid/acc_unbiased': 72.371, 'best_test_valid/diff': 1.644, 'best_test_valid/acc_skew': 71.549, 'best_test_valid/acc_align': 73.193, 'best_test_test/acc': 70.844, 'best_test_test/acc_unbiased': 71.216, 'best_test_test/diff': 6.608, 'best_test_test/acc_skew': 67.912, 'best_test_test/acc_align': 74.521}
[6 / 20] Learning rate: 0.001 weight: 0.01
[6 / 20] Loss: 4.791340638742963 CE Loss: 0.5412840407728974 Con Loss: 4.785927803240618
[6 / 20] tensor([[0.500, 0.474],
        [0.874, 0.890]]) {'epoch': 6, 'valid/acc': 67.89, 'valid/acc_unbiased': 69.233, 'valid/diff': 0.569, 'valid/acc_skew': 69.201, 'valid/acc_align': 69.265, 'test/acc': 67.637, 'test/acc_unbiased': 68.466, 'test/diff': 2.072, 'test/acc_skew': 67.43, 'test/acc_align': 69.502}
[6 / 20] best valid accuracy: 72.371 at epoch 2 
 best_stats: {'best_valid_epoch': 2, 'best_valid_valid/acc': 71.814, 'best_valid_valid/acc_unbiased': 72.371, 'best_valid_valid/diff': 1.644, 'best_valid_valid/acc_skew': 71.549, 'best_valid_valid/acc_align': 73.193, 'best_valid_test/acc': 70.844, 'best_valid_test/acc_unbiased': 71.216, 'best_valid_test/diff': 6.608, 'best_valid_test/acc_skew': 67.912, 'best_valid_test/acc_align': 74.521}
[6 / 20] best test accuracy: 71.216 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 71.814, 'best_test_valid/acc_unbiased': 72.371, 'best_test_valid/diff': 1.644, 'best_test_valid/acc_skew': 71.549, 'best_test_valid/acc_align': 73.193, 'best_test_test/acc': 70.844, 'best_test_test/acc_unbiased': 71.216, 'best_test_test/diff': 6.608, 'best_test_test/acc_skew': 67.912, 'best_test_test/acc_align': 74.521}
[7 / 20] Learning rate: 0.0001 weight: 0.01
[7 / 20] Loss: 4.7629608256226925 CE Loss: 0.4827077729984747 Con Loss: 4.75813374791627
[7 / 20] tensor([[0.814, 0.750],
        [0.771, 0.804]]) {'epoch': 7, 'valid/acc': 76.582, 'valid/acc_unbiased': 76.707, 'valid/diff': 1.83, 'valid/acc_skew': 75.792, 'valid/acc_align': 77.622, 'test/acc': 78.439, 'test/acc_unbiased': 78.46, 'test/diff': 4.828, 'test/acc_skew': 76.047, 'test/acc_align': 80.874}
[7 / 20] best valid accuracy: 76.707 at epoch 7 
 best_stats: {'best_valid_epoch': 7, 'best_valid_valid/acc': 76.582, 'best_valid_valid/acc_unbiased': 76.707, 'best_valid_valid/diff': 1.83, 'best_valid_valid/acc_skew': 75.792, 'best_valid_valid/acc_align': 77.622, 'best_valid_test/acc': 78.439, 'best_valid_test/acc_unbiased': 78.46, 'best_valid_test/diff': 4.828, 'best_valid_test/acc_skew': 76.047, 'best_valid_test/acc_align': 80.874}
[7 / 20] best test accuracy: 78.460 at epoch 7 
 best_stats: {'best_test_epoch': 7, 'best_test_valid/acc': 76.582, 'best_test_valid/acc_unbiased': 76.707, 'best_test_valid/diff': 1.83, 'best_test_valid/acc_skew': 75.792, 'best_test_valid/acc_align': 77.622, 'best_test_test/acc': 78.439, 'best_test_test/acc_unbiased': 78.46, 'best_test_test/diff': 4.828, 'best_test_test/acc_skew': 76.047, 'best_test_test/acc_align': 80.874}
[8 / 20] Learning rate: 0.0001 weight: 0.01
[8 / 20] Loss: 4.733125901676027 CE Loss: 0.46746332701268345 Con Loss: 4.728451266644814
[8 / 20] tensor([[0.783, 0.718],
        [0.794, 0.828]]) {'epoch': 8, 'valid/acc': 77.637, 'valid/acc_unbiased': 77.8, 'valid/diff': 2.705, 'valid/acc_skew': 76.448, 'valid/acc_align': 79.153, 'test/acc': 77.932, 'test/acc_unbiased': 78.076, 'test/diff': 4.927, 'test/acc_skew': 75.612, 'test/acc_align': 80.54}
[8 / 20] best valid accuracy: 77.800 at epoch 8 
 best_stats: {'best_valid_epoch': 8, 'best_valid_valid/acc': 77.637, 'best_valid_valid/acc_unbiased': 77.8, 'best_valid_valid/diff': 2.705, 'best_valid_valid/acc_skew': 76.448, 'best_valid_valid/acc_align': 79.153, 'best_valid_test/acc': 77.932, 'best_valid_test/acc_unbiased': 78.076, 'best_valid_test/diff': 4.927, 'best_valid_test/acc_skew': 75.612, 'best_valid_test/acc_align': 80.54}
[8 / 20] best test accuracy: 78.460 at epoch 7 
 best_stats: {'best_test_epoch': 7, 'best_test_valid/acc': 76.582, 'best_test_valid/acc_unbiased': 76.707, 'best_test_valid/diff': 1.83, 'best_test_valid/acc_skew': 75.792, 'best_test_valid/acc_align': 77.622, 'best_test_test/acc': 78.439, 'best_test_test/acc_unbiased': 78.46, 'best_test_test/diff': 4.828, 'best_test_test/acc_skew': 76.047, 'best_test_test/acc_align': 80.874}
[9 / 20] Learning rate: 0.0001 weight: 0.01
[9 / 20] Loss: 4.731319461001484 CE Loss: 0.465423346962098 Con Loss: 4.726665240604741
[9 / 20] tensor([[0.789, 0.699],
        [0.814, 0.842]]) {'epoch': 9, 'valid/acc': 78.481, 'valid/acc_unbiased': 78.787, 'valid/diff': 3.879, 'valid/acc_skew': 76.847, 'valid/acc_align': 80.726, 'test/acc': 78.312, 'test/acc_unbiased': 78.589, 'test/diff': 5.925, 'test/acc_skew': 75.626, 'test/acc_align': 81.551}
[9 / 20] best valid accuracy: 78.787 at epoch 9 
 best_stats: {'best_valid_epoch': 9, 'best_valid_valid/acc': 78.481, 'best_valid_valid/acc_unbiased': 78.787, 'best_valid_valid/diff': 3.879, 'best_valid_valid/acc_skew': 76.847, 'best_valid_valid/acc_align': 80.726, 'best_valid_test/acc': 78.312, 'best_valid_test/acc_unbiased': 78.589, 'best_valid_test/diff': 5.925, 'best_valid_test/acc_skew': 75.626, 'best_valid_test/acc_align': 81.551}
[9 / 20] best test accuracy: 78.589 at epoch 9 
 best_stats: {'best_test_epoch': 9, 'best_test_valid/acc': 78.481, 'best_test_valid/acc_unbiased': 78.787, 'best_test_valid/diff': 3.879, 'best_test_valid/acc_skew': 76.847, 'best_test_valid/acc_align': 80.726, 'best_test_test/acc': 78.312, 'best_test_test/acc_unbiased': 78.589, 'best_test_test/diff': 5.925, 'best_test_test/acc_skew': 75.626, 'best_test_test/acc_align': 81.551}
[10 / 20] Learning rate: 0.0001 weight: 0.01
[10 / 20] Loss: 4.710301687567335 CE Loss: 0.4604986863289885 Con Loss: 4.705696700083563
[10 / 20] tensor([[0.832, 0.764],
        [0.777, 0.795]]) {'epoch': 10, 'valid/acc': 78.523, 'valid/acc_unbiased': 78.584, 'valid/diff': 3.464, 'valid/acc_skew': 76.851, 'valid/acc_align': 80.316, 'test/acc': 79.114, 'test/acc_unbiased': 79.18, 'test/diff': 4.288, 'test/acc_skew': 77.036, 'test/acc_align': 81.324}
[10 / 20] best valid accuracy: 78.787 at epoch 9 
 best_stats: {'best_valid_epoch': 9, 'best_valid_valid/acc': 78.481, 'best_valid_valid/acc_unbiased': 78.787, 'best_valid_valid/diff': 3.879, 'best_valid_valid/acc_skew': 76.847, 'best_valid_valid/acc_align': 80.726, 'best_valid_test/acc': 78.312, 'best_valid_test/acc_unbiased': 78.589, 'best_valid_test/diff': 5.925, 'best_valid_test/acc_skew': 75.626, 'best_valid_test/acc_align': 81.551}
[10 / 20] best test accuracy: 79.180 at epoch 10 
 best_stats: {'best_test_epoch': 10, 'best_test_valid/acc': 78.523, 'best_test_valid/acc_unbiased': 78.584, 'best_test_valid/diff': 3.464, 'best_test_valid/acc_skew': 76.851, 'best_test_valid/acc_align': 80.316, 'best_test_test/acc': 79.114, 'best_test_test/acc_unbiased': 79.18, 'best_test_test/diff': 4.288, 'best_test_test/acc_skew': 77.036, 'best_test_test/acc_align': 81.324}
[11 / 20] Learning rate: 0.0001 weight: 0.01
[11 / 20] Loss: 4.713468121574704 CE Loss: 0.4518504028002654 Con Loss: 4.708949626626591
[11 / 20] tensor([[0.778, 0.700],
        [0.831, 0.837]]) {'epoch': 11, 'valid/acc': 78.481, 'valid/acc_unbiased': 78.934, 'valid/diff': 2.278, 'valid/acc_skew': 77.795, 'valid/acc_align': 80.073, 'test/acc': 78.27, 'test/acc_unbiased': 78.641, 'test/diff': 4.151, 'test/acc_skew': 76.566, 'test/acc_align': 80.717}
[11 / 20] best valid accuracy: 78.934 at epoch 11 
 best_stats: {'best_valid_epoch': 11, 'best_valid_valid/acc': 78.481, 'best_valid_valid/acc_unbiased': 78.934, 'best_valid_valid/diff': 2.278, 'best_valid_valid/acc_skew': 77.795, 'best_valid_valid/acc_align': 80.073, 'best_valid_test/acc': 78.27, 'best_valid_test/acc_unbiased': 78.641, 'best_valid_test/diff': 4.151, 'best_valid_test/acc_skew': 76.566, 'best_valid_test/acc_align': 80.717}
[11 / 20] best test accuracy: 79.180 at epoch 10 
 best_stats: {'best_test_epoch': 10, 'best_test_valid/acc': 78.523, 'best_test_valid/acc_unbiased': 78.584, 'best_test_valid/diff': 3.464, 'best_test_valid/acc_skew': 76.851, 'best_test_valid/acc_align': 80.316, 'best_test_test/acc': 79.114, 'best_test_test/acc_unbiased': 79.18, 'best_test_test/diff': 4.288, 'best_test_test/acc_skew': 77.036, 'best_test_test/acc_align': 81.324}
[12 / 20] Learning rate: 0.0001 weight: 0.01
[12 / 20] Loss: 4.708058694445721 CE Loss: 0.44874979330889475 Con Loss: 4.703571184138777
[12 / 20] tensor([[0.835, 0.761],
        [0.794, 0.811]]) {'epoch': 12, 'valid/acc': 79.325, 'valid/acc_unbiased': 79.449, 'valid/diff': 2.713, 'valid/acc_skew': 78.092, 'valid/acc_align': 80.805, 'test/acc': 79.916, 'test/acc_unbiased': 80.037, 'test/diff': 4.567, 'test/acc_skew': 77.754, 'test/acc_align': 82.321}
[12 / 20] best valid accuracy: 79.449 at epoch 12 
 best_stats: {'best_valid_epoch': 12, 'best_valid_valid/acc': 79.325, 'best_valid_valid/acc_unbiased': 79.449, 'best_valid_valid/diff': 2.713, 'best_valid_valid/acc_skew': 78.092, 'best_valid_valid/acc_align': 80.805, 'best_valid_test/acc': 79.916, 'best_valid_test/acc_unbiased': 80.037, 'best_valid_test/diff': 4.567, 'best_valid_test/acc_skew': 77.754, 'best_valid_test/acc_align': 82.321}
[12 / 20] best test accuracy: 80.037 at epoch 12 
 best_stats: {'best_test_epoch': 12, 'best_test_valid/acc': 79.325, 'best_test_valid/acc_unbiased': 79.449, 'best_test_valid/diff': 2.713, 'best_test_valid/acc_skew': 78.092, 'best_test_valid/acc_align': 80.805, 'best_test_test/acc': 79.916, 'best_test_test/acc_unbiased': 80.037, 'best_test_test/diff': 4.567, 'best_test_test/acc_skew': 77.754, 'best_test_test/acc_align': 82.321}
[13 / 20] Learning rate: 0.0001 weight: 0.01
[13 / 20] Loss: 4.696685346991566 CE Loss: 0.44298853178673575 Con Loss: 4.692255435541469
[13 / 20] tensor([[0.842, 0.761],
        [0.797, 0.811]]) {'epoch': 13, 'valid/acc': 79.662, 'valid/acc_unbiased': 79.896, 'valid/diff': 2.37, 'valid/acc_skew': 78.711, 'valid/acc_align': 81.081, 'test/acc': 80.127, 'test/acc_unbiased': 80.271, 'test/diff': 4.817, 'test/acc_skew': 77.862, 'test/acc_align': 82.679}
[13 / 20] best valid accuracy: 79.896 at epoch 13 
 best_stats: {'best_valid_epoch': 13, 'best_valid_valid/acc': 79.662, 'best_valid_valid/acc_unbiased': 79.896, 'best_valid_valid/diff': 2.37, 'best_valid_valid/acc_skew': 78.711, 'best_valid_valid/acc_align': 81.081, 'best_valid_test/acc': 80.127, 'best_valid_test/acc_unbiased': 80.271, 'best_valid_test/diff': 4.817, 'best_valid_test/acc_skew': 77.862, 'best_valid_test/acc_align': 82.679}
[13 / 20] best test accuracy: 80.271 at epoch 13 
 best_stats: {'best_test_epoch': 13, 'best_test_valid/acc': 79.662, 'best_test_valid/acc_unbiased': 79.896, 'best_test_valid/diff': 2.37, 'best_test_valid/acc_skew': 78.711, 'best_test_valid/acc_align': 81.081, 'best_test_test/acc': 80.127, 'best_test_test/acc_unbiased': 80.271, 'best_test_test/diff': 4.817, 'best_test_test/acc_skew': 77.862, 'best_test_test/acc_align': 82.679}
[14 / 20] Learning rate: 1e-05 weight: 0.01
[14 / 20] Loss: 4.687380523318602 CE Loss: 0.4389589788449456 Con Loss: 4.682990941261303
[14 / 20] tensor([[0.824, 0.734],
        [0.835, 0.841]]) {'epoch': 14, 'valid/acc': 79.831, 'valid/acc_unbiased': 80.194, 'valid/diff': 2.896, 'valid/acc_skew': 78.746, 'valid/acc_align': 81.642, 'test/acc': 80.549, 'test/acc_unbiased': 80.875, 'test/diff': 4.788, 'test/acc_skew': 78.481, 'test/acc_align': 83.269}
[14 / 20] best valid accuracy: 80.194 at epoch 14 
 best_stats: {'best_valid_epoch': 14, 'best_valid_valid/acc': 79.831, 'best_valid_valid/acc_unbiased': 80.194, 'best_valid_valid/diff': 2.896, 'best_valid_valid/acc_skew': 78.746, 'best_valid_valid/acc_align': 81.642, 'best_valid_test/acc': 80.549, 'best_valid_test/acc_unbiased': 80.875, 'best_valid_test/diff': 4.788, 'best_valid_test/acc_skew': 78.481, 'best_valid_test/acc_align': 83.269}
[14 / 20] best test accuracy: 80.875 at epoch 14 
 best_stats: {'best_test_epoch': 14, 'best_test_valid/acc': 79.831, 'best_test_valid/acc_unbiased': 80.194, 'best_test_valid/diff': 2.896, 'best_test_valid/acc_skew': 78.746, 'best_test_valid/acc_align': 81.642, 'best_test_test/acc': 80.549, 'best_test_test/acc_unbiased': 80.875, 'best_test_test/diff': 4.788, 'best_test_test/acc_skew': 78.481, 'best_test_test/acc_align': 83.269}
[15 / 20] Learning rate: 1e-05 weight: 0.01
[15 / 20] Loss: 4.688001254990719 CE Loss: 0.4365972422314249 Con Loss: 4.683635262758805
[15 / 20] tensor([[0.824, 0.731],
        [0.827, 0.840]]) {'epoch': 15, 'valid/acc': 79.916, 'valid/acc_unbiased': 80.294, 'valid/diff': 2.856, 'valid/acc_skew': 78.928, 'valid/acc_align': 81.659, 'test/acc': 80.253, 'test/acc_unbiased': 80.548, 'test/diff': 5.295, 'test/acc_skew': 77.9, 'test/acc_align': 83.195}
[15 / 20] best valid accuracy: 80.294 at epoch 15 
 best_stats: {'best_valid_epoch': 15, 'best_valid_valid/acc': 79.916, 'best_valid_valid/acc_unbiased': 80.294, 'best_valid_valid/diff': 2.856, 'best_valid_valid/acc_skew': 78.928, 'best_valid_valid/acc_align': 81.659, 'best_valid_test/acc': 80.253, 'best_valid_test/acc_unbiased': 80.548, 'best_valid_test/diff': 5.295, 'best_valid_test/acc_skew': 77.9, 'best_valid_test/acc_align': 83.195}
[15 / 20] best test accuracy: 80.875 at epoch 14 
 best_stats: {'best_test_epoch': 14, 'best_test_valid/acc': 79.831, 'best_test_valid/acc_unbiased': 80.194, 'best_test_valid/diff': 2.896, 'best_test_valid/acc_skew': 78.746, 'best_test_valid/acc_align': 81.642, 'best_test_test/acc': 80.549, 'best_test_test/acc_unbiased': 80.875, 'best_test_test/diff': 4.788, 'best_test_test/acc_skew': 78.481, 'best_test_test/acc_align': 83.269}
[16 / 20] Learning rate: 1e-05 weight: 0.01
[16 / 20] Loss: 4.672908112733989 CE Loss: 0.43931375707923753 Con Loss: 4.668514986862026
[16 / 20] tensor([[0.826, 0.746],
        [0.814, 0.826]]) {'epoch': 16, 'valid/acc': 80.127, 'valid/acc_unbiased': 80.44, 'valid/diff': 3.313, 'valid/acc_skew': 78.783, 'valid/acc_align': 82.096, 'test/acc': 80.084, 'test/acc_unbiased': 80.303, 'test/diff': 4.626, 'test/acc_skew': 77.99, 'test/acc_align': 82.616}
[16 / 20] best valid accuracy: 80.440 at epoch 16 
 best_stats: {'best_valid_epoch': 16, 'best_valid_valid/acc': 80.127, 'best_valid_valid/acc_unbiased': 80.44, 'best_valid_valid/diff': 3.313, 'best_valid_valid/acc_skew': 78.783, 'best_valid_valid/acc_align': 82.096, 'best_valid_test/acc': 80.084, 'best_valid_test/acc_unbiased': 80.303, 'best_valid_test/diff': 4.626, 'best_valid_test/acc_skew': 77.99, 'best_valid_test/acc_align': 82.616}
[16 / 20] best test accuracy: 80.875 at epoch 14 
 best_stats: {'best_test_epoch': 14, 'best_test_valid/acc': 79.831, 'best_test_valid/acc_unbiased': 80.194, 'best_test_valid/diff': 2.896, 'best_test_valid/acc_skew': 78.746, 'best_test_valid/acc_align': 81.642, 'best_test_test/acc': 80.549, 'best_test_test/acc_unbiased': 80.875, 'best_test_test/diff': 4.788, 'best_test_test/acc_skew': 78.481, 'best_test_test/acc_align': 83.269}
[17 / 20] Learning rate: 1e-05 weight: 0.01
[17 / 20] Loss: 4.676394365542455 CE Loss: 0.4296438147260713 Con Loss: 4.672097901474156
[17 / 20] tensor([[0.828, 0.749],
        [0.818, 0.835]]) {'epoch': 17, 'valid/acc': 80.127, 'valid/acc_unbiased': 80.395, 'valid/diff': 3.369, 'valid/acc_skew': 78.71, 'valid/acc_align': 82.079, 'test/acc': 80.549, 'test/acc_unbiased': 80.752, 'test/diff': 4.797, 'test/acc_skew': 78.354, 'test/acc_align': 83.151}
[17 / 20] best valid accuracy: 80.440 at epoch 16 
 best_stats: {'best_valid_epoch': 16, 'best_valid_valid/acc': 80.127, 'best_valid_valid/acc_unbiased': 80.44, 'best_valid_valid/diff': 3.313, 'best_valid_valid/acc_skew': 78.783, 'best_valid_valid/acc_align': 82.096, 'best_valid_test/acc': 80.084, 'best_valid_test/acc_unbiased': 80.303, 'best_valid_test/diff': 4.626, 'best_valid_test/acc_skew': 77.99, 'best_valid_test/acc_align': 82.616}
[17 / 20] best test accuracy: 80.875 at epoch 14 
 best_stats: {'best_test_epoch': 14, 'best_test_valid/acc': 79.831, 'best_test_valid/acc_unbiased': 80.194, 'best_test_valid/diff': 2.896, 'best_test_valid/acc_skew': 78.746, 'best_test_valid/acc_align': 81.642, 'best_test_test/acc': 80.549, 'best_test_test/acc_unbiased': 80.875, 'best_test_test/diff': 4.788, 'best_test_test/acc_skew': 78.481, 'best_test_test/acc_align': 83.269}
[18 / 20] Learning rate: 1e-05 weight: 0.01
[18 / 20] Loss: 4.690105084269846 CE Loss: 0.43865755658547667 Con Loss: 4.685718522413932
[18 / 20] tensor([[0.844, 0.761],
        [0.794, 0.819]]) {'epoch': 18, 'valid/acc': 80.338, 'valid/acc_unbiased': 80.558, 'valid/diff': 3.985, 'valid/acc_skew': 78.565, 'valid/acc_align': 82.55, 'test/acc': 80.338, 'test/acc_unbiased': 80.447, 'test/diff': 5.386, 'test/acc_skew': 77.754, 'test/acc_align': 83.14}
[18 / 20] best valid accuracy: 80.558 at epoch 18 
 best_stats: {'best_valid_epoch': 18, 'best_valid_valid/acc': 80.338, 'best_valid_valid/acc_unbiased': 80.558, 'best_valid_valid/diff': 3.985, 'best_valid_valid/acc_skew': 78.565, 'best_valid_valid/acc_align': 82.55, 'best_valid_test/acc': 80.338, 'best_valid_test/acc_unbiased': 80.447, 'best_valid_test/diff': 5.386, 'best_valid_test/acc_skew': 77.754, 'best_valid_test/acc_align': 83.14}
[18 / 20] best test accuracy: 80.875 at epoch 14 
 best_stats: {'best_test_epoch': 14, 'best_test_valid/acc': 79.831, 'best_test_valid/acc_unbiased': 80.194, 'best_test_valid/diff': 2.896, 'best_test_valid/acc_skew': 78.746, 'best_test_valid/acc_align': 81.642, 'best_test_test/acc': 80.549, 'best_test_test/acc_unbiased': 80.875, 'best_test_test/diff': 4.788, 'best_test_test/acc_skew': 78.481, 'best_test_test/acc_align': 83.269}
[19 / 20] Learning rate: 1e-05 weight: 0.01
[19 / 20] Loss: 4.686738169210722 CE Loss: 0.42757558909900717 Con Loss: 4.6824624123021765
[19 / 20] tensor([[0.832, 0.737],
        [0.812, 0.834]]) {'epoch': 19, 'valid/acc': 80.253, 'valid/acc_unbiased': 80.508, 'valid/diff': 4.106, 'valid/acc_skew': 78.455, 'valid/acc_align': 82.56, 'test/acc': 80.127, 'test/acc_unbiased': 80.347, 'test/diff': 5.818, 'test/acc_skew': 77.438, 'test/acc_align': 83.256}
[19 / 20] best valid accuracy: 80.558 at epoch 18 
 best_stats: {'best_valid_epoch': 18, 'best_valid_valid/acc': 80.338, 'best_valid_valid/acc_unbiased': 80.558, 'best_valid_valid/diff': 3.985, 'best_valid_valid/acc_skew': 78.565, 'best_valid_valid/acc_align': 82.55, 'best_valid_test/acc': 80.338, 'best_valid_test/acc_unbiased': 80.447, 'best_valid_test/diff': 5.386, 'best_valid_test/acc_skew': 77.754, 'best_valid_test/acc_align': 83.14}
[19 / 20] best test accuracy: 80.875 at epoch 14 
 best_stats: {'best_test_epoch': 14, 'best_test_valid/acc': 79.831, 'best_test_valid/acc_unbiased': 80.194, 'best_test_valid/diff': 2.896, 'best_test_valid/acc_skew': 78.746, 'best_test_valid/acc_align': 81.642, 'best_test_test/acc': 80.549, 'best_test_test/acc_unbiased': 80.875, 'best_test_test/diff': 4.788, 'best_test_test/acc_skew': 78.481, 'best_test_test/acc_align': 83.269}
[20 / 20] Learning rate: 1e-05 weight: 0.01
[20 / 20] Loss: 4.676945595580698 CE Loss: 0.4284183537453893 Con Loss: 4.672661415479892
[20 / 20] tensor([[0.839, 0.749],
        [0.797, 0.831]]) {'epoch': 20, 'valid/acc': 80.253, 'valid/acc_unbiased': 80.434, 'valid/diff': 4.833, 'valid/acc_skew': 78.018, 'valid/acc_align': 82.851, 'test/acc': 80.253, 'test/acc_unbiased': 80.369, 'test/diff': 6.194, 'test/acc_skew': 77.271, 'test/acc_align': 83.466}
[20 / 20] best valid accuracy: 80.558 at epoch 18 
 best_stats: {'best_valid_epoch': 18, 'best_valid_valid/acc': 80.338, 'best_valid_valid/acc_unbiased': 80.558, 'best_valid_valid/diff': 3.985, 'best_valid_valid/acc_skew': 78.565, 'best_valid_valid/acc_align': 82.55, 'best_valid_test/acc': 80.338, 'best_valid_test/acc_unbiased': 80.447, 'best_valid_test/diff': 5.386, 'best_valid_test/acc_skew': 77.754, 'best_valid_test/acc_align': 83.14}
[20 / 20] best test accuracy: 80.875 at epoch 14 
 best_stats: {'best_test_epoch': 14, 'best_test_valid/acc': 79.831, 'best_test_valid/acc_unbiased': 80.194, 'best_test_valid/diff': 2.896, 'best_test_valid/acc_skew': 78.746, 'best_test_valid/acc_align': 81.642, 'best_test_test/acc': 80.549, 'best_test_test/acc_unbiased': 80.875, 'best_test_test/diff': 4.788, 'best_test_test/acc_skew': 78.481, 'best_test_test/acc_align': 83.269}
Total training time: 0:16:34
