Log level set to: INFO
Set seed: 2
=======> Using Fixed Random Seed: 2 <========
save_path: exp_results/bc-bb0-utk_face_race-rotate_color-0.9-lr0.001-bs128-cbs64-w0.01-ratio10-aug1-seed2
get_utk_face - split: train, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_race-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [4407, 552]
Target 1: [440, 5529]
Binary Target 1
---------------------------
Target 0: [4407, 552]
Target 1: [440, 5529]
===================================
Normal Label Distribution: 
Target 0: [4407, 552]
Target 1: [440, 5529]
===================================
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [4407, 552]
Target 1: [440, 5529]
Binary Target 1
---------------------------
Target 0: [4407, 552]
Target 1: [440, 5529]
===================================
Normal Label Distribution: 
Target 0: [4407, 552]
Target 1: [440, 5529]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 10928, target_attr: gender, bias_attr: race bias_rate: 0.9
['[train] target_0-bias_0: 4407', '[train] target_0-bias_1: 552', '[train] target_1-bias_0: 440', '[train] target_1-bias_1: 5529']
confusion_matrix - 
 original: tensor([[4407.,  440.],
        [ 552., 5529.]]), 
 normalized: tensor([[0.909, 0.091],
        [0.091, 0.909]]), 
 b|y: tensor([[0.889, 0.111],
        [0.074, 0.926]])
get_utk_face - split: train, aug: 1, given_y: True, ratio: 10
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_race-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [4407, 552]
Target 1: [440, 5529]
Binary Target 1
---------------------------
Target 0: [4407, 552]
Target 1: [440, 5529]
===================================
Normal Label Distribution: 
Target 0: [4407, 552]
Target 1: [440, 5529]
===================================
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [4407, 552]
Target 1: [440, 5529]
Binary Target 1
---------------------------
Target 0: [4407, 552]
Target 1: [440, 5529]
===================================
Normal Label Distribution: 
Target 0: [4407, 552]
Target 1: [440, 5529]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 10928, target_attr: gender, bias_attr: race bias_rate: 0.9
['[train] target_0-bias_0: 4407', '[train] target_0-bias_1: 552', '[train] target_1-bias_0: 440', '[train] target_1-bias_1: 5529']
get_utk_face - split: valid, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_race-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [583, 684]
Target 1: [457, 646]
Binary Target 1
---------------------------
Target 0: [583, 684]
Target 1: [457, 646]
===================================
Normal Label Distribution: 
Target 0: [583, 684]
Target 1: [457, 646]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 2370, target_attr: gender, bias_attr: race bias_rate: 0.9
['[valid] target_0-bias_0: 583', '[valid] target_0-bias_1: 684', '[valid] target_1-bias_0: 457', '[valid] target_1-bias_1: 646']
get_utk_face - split: test, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_race-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [558, 677]
Target 1: [462, 673]
Binary Target 1
---------------------------
Target 0: [558, 677]
Target 1: [462, 673]
===================================
Normal Label Distribution: 
Target 0: [558, 677]
Target 1: [462, 673]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 2370, target_attr: gender, bias_attr: race bias_rate: 0.9
['[test] target_0-bias_0: 558', '[test] target_0-bias_1: 677', '[test] target_1-bias_0: 462', '[test] target_1-bias_1: 673']
decay_epochs: [6, 13]
[1 / 20] Learning rate: 0.001 weight: 0.01
[1 / 20] Loss: 4.9149190866406105 CE Loss: 0.6373957764700949 Con Loss: 4.908545128946598
[1 / 20] tensor([[0.905, 0.883],
        [0.465, 0.441]]) {'epoch': 1, 'valid/acc': 68.481, 'valid/acc_unbiased': 67.011, 'valid/diff': 2.719, 'valid/acc_skew': 68.37, 'valid/acc_align': 65.652, 'test/acc': 68.143, 'test/acc_unbiased': 67.375, 'test/diff': 2.288, 'test/acc_skew': 67.434, 'test/acc_align': 67.316}
[1 / 20] best valid accuracy: 67.011 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 68.481, 'best_valid_valid/acc_unbiased': 67.011, 'best_valid_valid/diff': 2.719, 'best_valid_valid/acc_skew': 68.37, 'best_valid_valid/acc_align': 65.652, 'best_valid_test/acc': 68.143, 'best_valid_test/acc_unbiased': 67.375, 'best_valid_test/diff': 2.288, 'best_valid_test/acc_skew': 67.434, 'best_valid_test/acc_align': 67.316}
[1 / 20] best test accuracy: 67.375 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 68.481, 'best_test_valid/acc_unbiased': 67.011, 'best_test_valid/diff': 2.719, 'best_test_valid/acc_skew': 68.37, 'best_test_valid/acc_align': 65.652, 'best_test_test/acc': 68.143, 'best_test_test/acc_unbiased': 67.375, 'best_test_test/diff': 2.288, 'best_test_test/acc_skew': 67.434, 'best_test_test/acc_align': 67.316}
[2 / 20] Learning rate: 0.001 weight: 0.01
[2 / 20] Loss: 4.807695307110274 CE Loss: 0.5835724813348203 Con Loss: 4.801859581976649
[2 / 20] tensor([[0.629, 0.561],
        [0.859, 0.834]]) {'epoch': 2, 'valid/acc': 71.983, 'valid/acc_unbiased': 72.887, 'valid/diff': 0.308, 'valid/acc_skew': 73.042, 'valid/acc_align': 72.733, 'test/acc': 71.266, 'test/acc_unbiased': 72.081, 'test/diff': 4.673, 'test/acc_skew': 71.03, 'test/acc_align': 73.131}
[2 / 20] best valid accuracy: 72.887 at epoch 2 
 best_stats: {'best_valid_epoch': 2, 'best_valid_valid/acc': 71.983, 'best_valid_valid/acc_unbiased': 72.887, 'best_valid_valid/diff': 0.308, 'best_valid_valid/acc_skew': 73.042, 'best_valid_valid/acc_align': 72.733, 'best_valid_test/acc': 71.266, 'best_valid_test/acc_unbiased': 72.081, 'best_valid_test/diff': 4.673, 'best_valid_test/acc_skew': 71.03, 'best_valid_test/acc_align': 73.131}
[2 / 20] best test accuracy: 72.081 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 71.983, 'best_test_valid/acc_unbiased': 72.887, 'best_test_valid/diff': 0.308, 'best_test_valid/acc_skew': 73.042, 'best_test_valid/acc_align': 72.733, 'best_test_test/acc': 71.266, 'best_test_test/acc_unbiased': 72.081, 'best_test_test/diff': 4.673, 'best_test_test/acc_skew': 71.03, 'best_test_test/acc_align': 73.131}
[3 / 20] Learning rate: 0.001 weight: 0.01
[3 / 20] Loss: 4.784005382923221 CE Loss: 0.5837303865182801 Con Loss: 4.778168073684894
[3 / 20] tensor([[0.810, 0.762],
        [0.669, 0.713]]) {'epoch': 3, 'valid/acc': 74.262, 'valid/acc_unbiased': 73.871, 'valid/diff': 4.321, 'valid/acc_skew': 71.71, 'valid/acc_align': 76.032, 'test/acc': 74.135, 'test/acc_unbiased': 73.857, 'test/diff': 4.612, 'test/acc_skew': 71.551, 'test/acc_align': 76.163}
[3 / 20] best valid accuracy: 73.871 at epoch 3 
 best_stats: {'best_valid_epoch': 3, 'best_valid_valid/acc': 74.262, 'best_valid_valid/acc_unbiased': 73.871, 'best_valid_valid/diff': 4.321, 'best_valid_valid/acc_skew': 71.71, 'best_valid_valid/acc_align': 76.032, 'best_valid_test/acc': 74.135, 'best_valid_test/acc_unbiased': 73.857, 'best_valid_test/diff': 4.612, 'best_valid_test/acc_skew': 71.551, 'best_valid_test/acc_align': 76.163}
[3 / 20] best test accuracy: 73.857 at epoch 3 
 best_stats: {'best_test_epoch': 3, 'best_test_valid/acc': 74.262, 'best_test_valid/acc_unbiased': 73.871, 'best_test_valid/diff': 4.321, 'best_test_valid/acc_skew': 71.71, 'best_test_valid/acc_align': 76.032, 'best_test_test/acc': 74.135, 'best_test_test/acc_unbiased': 73.857, 'best_test_test/diff': 4.612, 'best_test_test/acc_skew': 71.551, 'best_test_test/acc_align': 76.163}
[4 / 20] Learning rate: 0.001 weight: 0.01
[4 / 20] Loss: 4.76903221582773 CE Loss: 0.5557248395585386 Con Loss: 4.763474976859365
[4 / 20] tensor([[0.616, 0.514],
        [0.861, 0.893]]) {'epoch': 4, 'valid/acc': 71.899, 'valid/acc_unbiased': 72.892, 'valid/diff': 3.795, 'valid/acc_skew': 70.994, 'valid/acc_align': 74.79, 'test/acc': 71.35, 'test/acc_unbiased': 72.125, 'test/diff': 6.7, 'test/acc_skew': 68.775, 'test/acc_align': 75.475}
[4 / 20] best valid accuracy: 73.871 at epoch 3 
 best_stats: {'best_valid_epoch': 3, 'best_valid_valid/acc': 74.262, 'best_valid_valid/acc_unbiased': 73.871, 'best_valid_valid/diff': 4.321, 'best_valid_valid/acc_skew': 71.71, 'best_valid_valid/acc_align': 76.032, 'best_valid_test/acc': 74.135, 'best_valid_test/acc_unbiased': 73.857, 'best_valid_test/diff': 4.612, 'best_valid_test/acc_skew': 71.551, 'best_valid_test/acc_align': 76.163}
[4 / 20] best test accuracy: 73.857 at epoch 3 
 best_stats: {'best_test_epoch': 3, 'best_test_valid/acc': 74.262, 'best_test_valid/acc_unbiased': 73.871, 'best_test_valid/diff': 4.321, 'best_test_valid/acc_skew': 71.71, 'best_test_valid/acc_align': 76.032, 'best_test_test/acc': 74.135, 'best_test_test/acc_unbiased': 73.857, 'best_test_test/diff': 4.612, 'best_test_test/acc_skew': 71.551, 'best_test_test/acc_align': 76.163}
[5 / 20] Learning rate: 0.001 weight: 0.01
[5 / 20] Loss: 4.7586066132932245 CE Loss: 0.5647192638405595 Con Loss: 4.752959406393339
[5 / 20] tensor([[0.541, 0.422],
        [0.918, 0.936]]) {'epoch': 5, 'valid/acc': 67.553, 'valid/acc_unbiased': 69.163, 'valid/diff': 1.54, 'valid/acc_skew': 68.393, 'valid/acc_align': 69.933, 'test/acc': 69.283, 'test/acc_unbiased': 70.438, 'test/diff': 6.856, 'test/acc_skew': 67.01, 'test/acc_align': 73.866}
[5 / 20] best valid accuracy: 73.871 at epoch 3 
 best_stats: {'best_valid_epoch': 3, 'best_valid_valid/acc': 74.262, 'best_valid_valid/acc_unbiased': 73.871, 'best_valid_valid/diff': 4.321, 'best_valid_valid/acc_skew': 71.71, 'best_valid_valid/acc_align': 76.032, 'best_valid_test/acc': 74.135, 'best_valid_test/acc_unbiased': 73.857, 'best_valid_test/diff': 4.612, 'best_valid_test/acc_skew': 71.551, 'best_valid_test/acc_align': 76.163}
[5 / 20] best test accuracy: 73.857 at epoch 3 
 best_stats: {'best_test_epoch': 3, 'best_test_valid/acc': 74.262, 'best_test_valid/acc_unbiased': 73.871, 'best_test_valid/diff': 4.321, 'best_test_valid/acc_skew': 71.71, 'best_test_valid/acc_align': 76.032, 'best_test_test/acc': 74.135, 'best_test_test/acc_unbiased': 73.857, 'best_test_test/diff': 4.612, 'best_test_test/acc_skew': 71.551, 'best_test_test/acc_align': 76.163}
[6 / 20] Learning rate: 0.001 weight: 0.01
[6 / 20] Loss: 4.747591173666288 CE Loss: 0.5503761802375927 Con Loss: 4.742087409576595
[6 / 20] tensor([[0.452, 0.402],
        [0.911, 0.947]]) {'epoch': 6, 'valid/acc': 65.232, 'valid/acc_unbiased': 66.985, 'valid/diff': 0.929, 'valid/acc_skew': 66.748, 'valid/acc_align': 67.222, 'test/acc': 66.751, 'test/acc_unbiased': 67.779, 'test/diff': 4.255, 'test/acc_skew': 65.651, 'test/acc_align': 69.906}
[6 / 20] best valid accuracy: 73.871 at epoch 3 
 best_stats: {'best_valid_epoch': 3, 'best_valid_valid/acc': 74.262, 'best_valid_valid/acc_unbiased': 73.871, 'best_valid_valid/diff': 4.321, 'best_valid_valid/acc_skew': 71.71, 'best_valid_valid/acc_align': 76.032, 'best_valid_test/acc': 74.135, 'best_valid_test/acc_unbiased': 73.857, 'best_valid_test/diff': 4.612, 'best_valid_test/acc_skew': 71.551, 'best_valid_test/acc_align': 76.163}
[6 / 20] best test accuracy: 73.857 at epoch 3 
 best_stats: {'best_test_epoch': 3, 'best_test_valid/acc': 74.262, 'best_test_valid/acc_unbiased': 73.871, 'best_test_valid/diff': 4.321, 'best_test_valid/acc_skew': 71.71, 'best_test_valid/acc_align': 76.032, 'best_test_test/acc': 74.135, 'best_test_test/acc_unbiased': 73.857, 'best_test_test/diff': 4.612, 'best_test_test/acc_skew': 71.551, 'best_test_test/acc_align': 76.163}
[7 / 20] Learning rate: 0.0001 weight: 0.01
[7 / 20] Loss: 4.668204661518728 CE Loss: 0.5259739267005753 Con Loss: 4.662944916575754
[7 / 20] tensor([[0.747, 0.699],
        [0.827, 0.865]]) {'epoch': 7, 'valid/acc': 77.215, 'valid/acc_unbiased': 77.569, 'valid/diff': 1.373, 'valid/acc_skew': 76.883, 'valid/acc_align': 78.256, 'test/acc': 78.228, 'test/acc_unbiased': 78.44, 'test/diff': 4.329, 'test/acc_skew': 76.276, 'test/acc_align': 80.605}
[7 / 20] best valid accuracy: 77.569 at epoch 7 
 best_stats: {'best_valid_epoch': 7, 'best_valid_valid/acc': 77.215, 'best_valid_valid/acc_unbiased': 77.569, 'best_valid_valid/diff': 1.373, 'best_valid_valid/acc_skew': 76.883, 'best_valid_valid/acc_align': 78.256, 'best_valid_test/acc': 78.228, 'best_valid_test/acc_unbiased': 78.44, 'best_valid_test/diff': 4.329, 'best_valid_test/acc_skew': 76.276, 'best_valid_test/acc_align': 80.605}
[7 / 20] best test accuracy: 78.440 at epoch 7 
 best_stats: {'best_test_epoch': 7, 'best_test_valid/acc': 77.215, 'best_test_valid/acc_unbiased': 77.569, 'best_test_valid/diff': 1.373, 'best_test_valid/acc_skew': 76.883, 'best_test_valid/acc_align': 78.256, 'best_test_test/acc': 78.228, 'best_test_test/acc_unbiased': 78.44, 'best_test_test/diff': 4.329, 'best_test_test/acc_skew': 76.276, 'best_test_test/acc_align': 80.605}
[8 / 20] Learning rate: 0.0001 weight: 0.01
[8 / 20] Loss: 4.669760252336807 CE Loss: 0.512480654967826 Con Loss: 4.664635445328094
[8 / 20] tensor([[0.767, 0.705],
        [0.814, 0.866]]) {'epoch': 8, 'valid/acc': 78.143, 'valid/acc_unbiased': 78.47, 'valid/diff': 3.466, 'valid/acc_skew': 76.737, 'valid/acc_align': 80.203, 'test/acc': 78.65, 'test/acc_unbiased': 78.793, 'test/diff': 5.743, 'test/acc_skew': 75.922, 'test/acc_align': 81.665}
[8 / 20] best valid accuracy: 78.470 at epoch 8 
 best_stats: {'best_valid_epoch': 8, 'best_valid_valid/acc': 78.143, 'best_valid_valid/acc_unbiased': 78.47, 'best_valid_valid/diff': 3.466, 'best_valid_valid/acc_skew': 76.737, 'best_valid_valid/acc_align': 80.203, 'best_valid_test/acc': 78.65, 'best_valid_test/acc_unbiased': 78.793, 'best_valid_test/diff': 5.743, 'best_valid_test/acc_skew': 75.922, 'best_valid_test/acc_align': 81.665}
[8 / 20] best test accuracy: 78.793 at epoch 8 
 best_stats: {'best_test_epoch': 8, 'best_test_valid/acc': 78.143, 'best_test_valid/acc_unbiased': 78.47, 'best_test_valid/diff': 3.466, 'best_test_valid/acc_skew': 76.737, 'best_test_valid/acc_align': 80.203, 'best_test_test/acc': 78.65, 'best_test_test/acc_unbiased': 78.793, 'best_test_test/diff': 5.743, 'best_test_test/acc_skew': 75.922, 'best_test_test/acc_align': 81.665}
[9 / 20] Learning rate: 0.0001 weight: 0.01
[9 / 20] Loss: 4.631756759492754 CE Loss: 0.5040753630383995 Con Loss: 4.626715994509562
[9 / 20] tensor([[0.814, 0.759],
        [0.777, 0.841]]) {'epoch': 9, 'valid/acc': 79.747, 'valid/acc_unbiased': 79.717, 'valid/diff': 3.54, 'valid/acc_skew': 77.947, 'valid/acc_align': 81.487, 'test/acc': 79.873, 'test/acc_unbiased': 79.773, 'test/diff': 5.917, 'test/acc_skew': 76.814, 'test/acc_align': 82.732}
[9 / 20] best valid accuracy: 79.717 at epoch 9 
 best_stats: {'best_valid_epoch': 9, 'best_valid_valid/acc': 79.747, 'best_valid_valid/acc_unbiased': 79.717, 'best_valid_valid/diff': 3.54, 'best_valid_valid/acc_skew': 77.947, 'best_valid_valid/acc_align': 81.487, 'best_valid_test/acc': 79.873, 'best_valid_test/acc_unbiased': 79.773, 'best_valid_test/diff': 5.917, 'best_valid_test/acc_skew': 76.814, 'best_valid_test/acc_align': 82.732}
[9 / 20] best test accuracy: 79.773 at epoch 9 
 best_stats: {'best_test_epoch': 9, 'best_test_valid/acc': 79.747, 'best_test_valid/acc_unbiased': 79.717, 'best_test_valid/diff': 3.54, 'best_test_valid/acc_skew': 77.947, 'best_test_valid/acc_align': 81.487, 'best_test_test/acc': 79.873, 'best_test_test/acc_unbiased': 79.773, 'best_test_test/diff': 5.917, 'best_test_test/acc_skew': 76.814, 'best_test_test/acc_align': 82.732}
[10 / 20] Learning rate: 0.0001 weight: 0.01
[10 / 20] Loss: 4.63231706130557 CE Loss: 0.4981901700639795 Con Loss: 4.627335152549241
[10 / 20] tensor([[0.733, 0.681],
        [0.840, 0.890]]) {'epoch': 10, 'valid/acc': 77.679, 'valid/acc_unbiased': 78.151, 'valid/diff': 4.222, 'valid/acc_skew': 76.04, 'valid/acc_align': 80.262, 'test/acc': 78.354, 'test/acc_unbiased': 78.595, 'test/diff': 5.112, 'test/acc_skew': 76.039, 'test/acc_align': 81.151}
[10 / 20] best valid accuracy: 79.717 at epoch 9 
 best_stats: {'best_valid_epoch': 9, 'best_valid_valid/acc': 79.747, 'best_valid_valid/acc_unbiased': 79.717, 'best_valid_valid/diff': 3.54, 'best_valid_valid/acc_skew': 77.947, 'best_valid_valid/acc_align': 81.487, 'best_valid_test/acc': 79.873, 'best_valid_test/acc_unbiased': 79.773, 'best_valid_test/diff': 5.917, 'best_valid_test/acc_skew': 76.814, 'best_valid_test/acc_align': 82.732}
[10 / 20] best test accuracy: 79.773 at epoch 9 
 best_stats: {'best_test_epoch': 9, 'best_test_valid/acc': 79.747, 'best_test_valid/acc_unbiased': 79.717, 'best_test_valid/diff': 3.54, 'best_test_valid/acc_skew': 77.947, 'best_test_valid/acc_align': 81.487, 'best_test_test/acc': 79.873, 'best_test_test/acc_unbiased': 79.773, 'best_test_test/diff': 5.917, 'best_test_test/acc_skew': 76.814, 'best_test_test/acc_align': 82.732}
[11 / 20] Learning rate: 0.0001 weight: 0.01
[11 / 20] Loss: 4.603507967679428 CE Loss: 0.5013095900569094 Con Loss: 4.598494864836619
[11 / 20] tensor([[0.815, 0.762],
        [0.771, 0.841]]) {'epoch': 11, 'valid/acc': 79.662, 'valid/acc_unbiased': 79.689, 'valid/diff': 3.631, 'valid/acc_skew': 77.873, 'valid/acc_align': 81.504, 'test/acc': 79.873, 'test/acc_unbiased': 79.729, 'test/diff': 6.184, 'test/acc_skew': 76.637, 'test/acc_align': 82.821}
[11 / 20] best valid accuracy: 79.717 at epoch 9 
 best_stats: {'best_valid_epoch': 9, 'best_valid_valid/acc': 79.747, 'best_valid_valid/acc_unbiased': 79.717, 'best_valid_valid/diff': 3.54, 'best_valid_valid/acc_skew': 77.947, 'best_valid_valid/acc_align': 81.487, 'best_valid_test/acc': 79.873, 'best_valid_test/acc_unbiased': 79.773, 'best_valid_test/diff': 5.917, 'best_valid_test/acc_skew': 76.814, 'best_valid_test/acc_align': 82.732}
[11 / 20] best test accuracy: 79.773 at epoch 9 
 best_stats: {'best_test_epoch': 9, 'best_test_valid/acc': 79.747, 'best_test_valid/acc_unbiased': 79.717, 'best_test_valid/diff': 3.54, 'best_test_valid/acc_skew': 77.947, 'best_test_valid/acc_align': 81.487, 'best_test_test/acc': 79.873, 'best_test_test/acc_unbiased': 79.773, 'best_test_test/diff': 5.917, 'best_test_test/acc_skew': 76.814, 'best_test_test/acc_align': 82.732}
[12 / 20] Learning rate: 0.0001 weight: 0.01
[12 / 20] Loss: 4.611514673749664 CE Loss: 0.479292097980072 Con Loss: 4.6067217356289465
[12 / 20] tensor([[0.769, 0.722],
        [0.792, 0.874]]) {'epoch': 12, 'valid/acc': 79.283, 'valid/acc_unbiased': 79.46, 'valid/diff': 5.369, 'valid/acc_skew': 76.775, 'valid/acc_align': 82.144, 'test/acc': 78.987, 'test/acc_unbiased': 78.926, 'test/diff': 6.4, 'test/acc_skew': 75.726, 'test/acc_align': 82.126}
[12 / 20] best valid accuracy: 79.717 at epoch 9 
 best_stats: {'best_valid_epoch': 9, 'best_valid_valid/acc': 79.747, 'best_valid_valid/acc_unbiased': 79.717, 'best_valid_valid/diff': 3.54, 'best_valid_valid/acc_skew': 77.947, 'best_valid_valid/acc_align': 81.487, 'best_valid_test/acc': 79.873, 'best_valid_test/acc_unbiased': 79.773, 'best_valid_test/diff': 5.917, 'best_valid_test/acc_skew': 76.814, 'best_valid_test/acc_align': 82.732}
[12 / 20] best test accuracy: 79.773 at epoch 9 
 best_stats: {'best_test_epoch': 9, 'best_test_valid/acc': 79.747, 'best_test_valid/acc_unbiased': 79.717, 'best_test_valid/diff': 3.54, 'best_test_valid/acc_skew': 77.947, 'best_test_valid/acc_align': 81.487, 'best_test_test/acc': 79.873, 'best_test_test/acc_unbiased': 79.773, 'best_test_test/diff': 5.917, 'best_test_test/acc_skew': 76.814, 'best_test_test/acc_align': 82.732}
[13 / 20] Learning rate: 0.0001 weight: 0.01
[13 / 20] Loss: 4.601350107793403 CE Loss: 0.47728067008153935 Con Loss: 4.596577292480022
[13 / 20] tensor([[0.812, 0.761],
        [0.794, 0.881]]) {'epoch': 13, 'valid/acc': 80.717, 'valid/acc_unbiased': 80.873, 'valid/diff': 4.907, 'valid/acc_skew': 78.419, 'valid/acc_align': 83.326, 'test/acc': 81.35, 'test/acc_unbiased': 81.201, 'test/diff': 6.894, 'test/acc_skew': 77.754, 'test/acc_align': 84.648}
[13 / 20] best valid accuracy: 80.873 at epoch 13 
 best_stats: {'best_valid_epoch': 13, 'best_valid_valid/acc': 80.717, 'best_valid_valid/acc_unbiased': 80.873, 'best_valid_valid/diff': 4.907, 'best_valid_valid/acc_skew': 78.419, 'best_valid_valid/acc_align': 83.326, 'best_valid_test/acc': 81.35, 'best_valid_test/acc_unbiased': 81.201, 'best_valid_test/diff': 6.894, 'best_valid_test/acc_skew': 77.754, 'best_valid_test/acc_align': 84.648}
[13 / 20] best test accuracy: 81.201 at epoch 13 
 best_stats: {'best_test_epoch': 13, 'best_test_valid/acc': 80.717, 'best_test_valid/acc_unbiased': 80.873, 'best_test_valid/diff': 4.907, 'best_test_valid/acc_skew': 78.419, 'best_test_valid/acc_align': 83.326, 'best_test_test/acc': 81.35, 'best_test_test/acc_unbiased': 81.201, 'best_test_test/diff': 6.894, 'best_test_test/acc_skew': 77.754, 'best_test_test/acc_align': 84.648}
[14 / 20] Learning rate: 1e-05 weight: 0.01
[14 / 20] Loss: 4.58562888373044 CE Loss: 0.4793524507809523 Con Loss: 4.580835377314778
[14 / 20] tensor([[0.772, 0.728],
        [0.812, 0.887]]) {'epoch': 14, 'valid/acc': 80.042, 'valid/acc_unbiased': 80.31, 'valid/diff': 5.538, 'valid/acc_skew': 77.541, 'valid/acc_align': 83.079, 'test/acc': 80.0, 'test/acc_unbiased': 79.984, 'test/diff': 5.979, 'test/acc_skew': 76.995, 'test/acc_align': 82.974}
[14 / 20] best valid accuracy: 80.873 at epoch 13 
 best_stats: {'best_valid_epoch': 13, 'best_valid_valid/acc': 80.717, 'best_valid_valid/acc_unbiased': 80.873, 'best_valid_valid/diff': 4.907, 'best_valid_valid/acc_skew': 78.419, 'best_valid_valid/acc_align': 83.326, 'best_valid_test/acc': 81.35, 'best_valid_test/acc_unbiased': 81.201, 'best_valid_test/diff': 6.894, 'best_valid_test/acc_skew': 77.754, 'best_valid_test/acc_align': 84.648}
[14 / 20] best test accuracy: 81.201 at epoch 13 
 best_stats: {'best_test_epoch': 13, 'best_test_valid/acc': 80.717, 'best_test_valid/acc_unbiased': 80.873, 'best_test_valid/diff': 4.907, 'best_test_valid/acc_skew': 78.419, 'best_test_valid/acc_align': 83.326, 'best_test_test/acc': 81.35, 'best_test_test/acc_unbiased': 81.201, 'best_test_test/diff': 6.894, 'best_test_test/acc_skew': 77.754, 'best_test_test/acc_align': 84.648}
[15 / 20] Learning rate: 1e-05 weight: 0.01
[15 / 20] Loss: 4.566214548895684 CE Loss: 0.47037873200057717 Con Loss: 4.561510757680868
[15 / 20] tensor([[0.780, 0.725],
        [0.807, 0.892]]) {'epoch': 15, 'valid/acc': 79.831, 'valid/acc_unbiased': 80.121, 'valid/diff': 5.452, 'valid/acc_skew': 77.395, 'valid/acc_align': 82.847, 'test/acc': 80.127, 'test/acc_unbiased': 80.093, 'test/diff': 6.924, 'test/acc_skew': 76.631, 'test/acc_align': 83.555}
[15 / 20] best valid accuracy: 80.873 at epoch 13 
 best_stats: {'best_valid_epoch': 13, 'best_valid_valid/acc': 80.717, 'best_valid_valid/acc_unbiased': 80.873, 'best_valid_valid/diff': 4.907, 'best_valid_valid/acc_skew': 78.419, 'best_valid_valid/acc_align': 83.326, 'best_valid_test/acc': 81.35, 'best_valid_test/acc_unbiased': 81.201, 'best_valid_test/diff': 6.894, 'best_valid_test/acc_skew': 77.754, 'best_valid_test/acc_align': 84.648}
[15 / 20] best test accuracy: 81.201 at epoch 13 
 best_stats: {'best_test_epoch': 13, 'best_test_valid/acc': 80.717, 'best_test_valid/acc_unbiased': 80.873, 'best_test_valid/diff': 4.907, 'best_test_valid/acc_skew': 78.419, 'best_test_valid/acc_align': 83.326, 'best_test_test/acc': 81.35, 'best_test_test/acc_unbiased': 81.201, 'best_test_test/diff': 6.894, 'best_test_test/acc_skew': 77.754, 'best_test_test/acc_align': 84.648}
[16 / 20] Learning rate: 1e-05 weight: 0.01
[16 / 20] Loss: 4.573124348680935 CE Loss: 0.47132576096633866 Con Loss: 4.568411094028813
[16 / 20] tensor([[0.789, 0.725],
        [0.805, 0.893]]) {'epoch': 16, 'valid/acc': 80.0, 'valid/acc_unbiased': 80.257, 'valid/diff': 4.92, 'valid/acc_skew': 77.797, 'valid/acc_align': 82.717, 'test/acc': 80.338, 'test/acc_unbiased': 80.3, 'test/diff': 7.555, 'test/acc_skew': 76.523, 'test/acc_align': 84.077}
[16 / 20] best valid accuracy: 80.873 at epoch 13 
 best_stats: {'best_valid_epoch': 13, 'best_valid_valid/acc': 80.717, 'best_valid_valid/acc_unbiased': 80.873, 'best_valid_valid/diff': 4.907, 'best_valid_valid/acc_skew': 78.419, 'best_valid_valid/acc_align': 83.326, 'best_valid_test/acc': 81.35, 'best_valid_test/acc_unbiased': 81.201, 'best_valid_test/diff': 6.894, 'best_valid_test/acc_skew': 77.754, 'best_valid_test/acc_align': 84.648}
[16 / 20] best test accuracy: 81.201 at epoch 13 
 best_stats: {'best_test_epoch': 13, 'best_test_valid/acc': 80.717, 'best_test_valid/acc_unbiased': 80.873, 'best_test_valid/diff': 4.907, 'best_test_valid/acc_skew': 78.419, 'best_test_valid/acc_align': 83.326, 'best_test_test/acc': 81.35, 'best_test_test/acc_unbiased': 81.201, 'best_test_test/diff': 6.894, 'best_test_test/acc_skew': 77.754, 'best_test_test/acc_align': 84.648}
[17 / 20] Learning rate: 1e-05 weight: 0.01
[17 / 20] Loss: 4.57567125881748 CE Loss: 0.4737994934419936 Con Loss: 4.570933249824043
[17 / 20] tensor([[0.781, 0.722],
        [0.810, 0.902]]) {'epoch': 17, 'valid/acc': 79.873, 'valid/acc_unbiased': 80.209, 'valid/diff': 4.9, 'valid/acc_skew': 77.759, 'valid/acc_align': 82.659, 'test/acc': 80.422, 'test/acc_unbiased': 80.378, 'test/diff': 7.573, 'test/acc_skew': 76.591, 'test/acc_align': 84.165}
[17 / 20] best valid accuracy: 80.873 at epoch 13 
 best_stats: {'best_valid_epoch': 13, 'best_valid_valid/acc': 80.717, 'best_valid_valid/acc_unbiased': 80.873, 'best_valid_valid/diff': 4.907, 'best_valid_valid/acc_skew': 78.419, 'best_valid_valid/acc_align': 83.326, 'best_valid_test/acc': 81.35, 'best_valid_test/acc_unbiased': 81.201, 'best_valid_test/diff': 6.894, 'best_valid_test/acc_skew': 77.754, 'best_valid_test/acc_align': 84.648}
[17 / 20] best test accuracy: 81.201 at epoch 13 
 best_stats: {'best_test_epoch': 13, 'best_test_valid/acc': 80.717, 'best_test_valid/acc_unbiased': 80.873, 'best_test_valid/diff': 4.907, 'best_test_valid/acc_skew': 78.419, 'best_test_valid/acc_align': 83.326, 'best_test_test/acc': 81.35, 'best_test_test/acc_unbiased': 81.201, 'best_test_test/diff': 6.894, 'best_test_test/acc_skew': 77.754, 'best_test_test/acc_align': 84.648}
[18 / 20] Learning rate: 1e-05 weight: 0.01
[18 / 20] Loss: 4.550956744226146 CE Loss: 0.4651067718579863 Con Loss: 4.5463056794720895
[18 / 20] tensor([[0.808, 0.743],
        [0.797, 0.886]]) {'epoch': 18, 'valid/acc': 80.506, 'valid/acc_unbiased': 80.738, 'valid/diff': 4.712, 'valid/acc_skew': 78.382, 'valid/acc_align': 83.094, 'test/acc': 80.928, 'test/acc_unbiased': 80.834, 'test/diff': 7.716, 'test/acc_skew': 76.976, 'test/acc_align': 84.692}
[18 / 20] best valid accuracy: 80.873 at epoch 13 
 best_stats: {'best_valid_epoch': 13, 'best_valid_valid/acc': 80.717, 'best_valid_valid/acc_unbiased': 80.873, 'best_valid_valid/diff': 4.907, 'best_valid_valid/acc_skew': 78.419, 'best_valid_valid/acc_align': 83.326, 'best_valid_test/acc': 81.35, 'best_valid_test/acc_unbiased': 81.201, 'best_valid_test/diff': 6.894, 'best_valid_test/acc_skew': 77.754, 'best_valid_test/acc_align': 84.648}
[18 / 20] best test accuracy: 81.201 at epoch 13 
 best_stats: {'best_test_epoch': 13, 'best_test_valid/acc': 80.717, 'best_test_valid/acc_unbiased': 80.873, 'best_test_valid/diff': 4.907, 'best_test_valid/acc_skew': 78.419, 'best_test_valid/acc_align': 83.326, 'best_test_test/acc': 81.35, 'best_test_test/acc_unbiased': 81.201, 'best_test_test/diff': 6.894, 'best_test_test/acc_skew': 77.754, 'best_test_test/acc_align': 84.648}
[19 / 20] Learning rate: 1e-05 weight: 0.01
[19 / 20] Loss: 4.584606301906692 CE Loss: 0.47208858544271476 Con Loss: 4.579885417161888
[19 / 20] tensor([[0.774, 0.719],
        [0.814, 0.900]]) {'epoch': 19, 'valid/acc': 79.873, 'valid/acc_unbiased': 80.188, 'valid/diff': 5.733, 'valid/acc_skew': 77.321, 'valid/acc_align': 83.054, 'test/acc': 80.211, 'test/acc_unbiased': 80.196, 'test/diff': 7.072, 'test/acc_skew': 76.66, 'test/acc_align': 83.732}
[19 / 20] best valid accuracy: 80.873 at epoch 13 
 best_stats: {'best_valid_epoch': 13, 'best_valid_valid/acc': 80.717, 'best_valid_valid/acc_unbiased': 80.873, 'best_valid_valid/diff': 4.907, 'best_valid_valid/acc_skew': 78.419, 'best_valid_valid/acc_align': 83.326, 'best_valid_test/acc': 81.35, 'best_valid_test/acc_unbiased': 81.201, 'best_valid_test/diff': 6.894, 'best_valid_test/acc_skew': 77.754, 'best_valid_test/acc_align': 84.648}
[19 / 20] best test accuracy: 81.201 at epoch 13 
 best_stats: {'best_test_epoch': 13, 'best_test_valid/acc': 80.717, 'best_test_valid/acc_unbiased': 80.873, 'best_test_valid/diff': 4.907, 'best_test_valid/acc_skew': 78.419, 'best_test_valid/acc_align': 83.326, 'best_test_test/acc': 81.35, 'best_test_test/acc_unbiased': 81.201, 'best_test_test/diff': 6.894, 'best_test_test/acc_skew': 77.754, 'best_test_test/acc_align': 84.648}
[20 / 20] Learning rate: 1e-05 weight: 0.01
[20 / 20] Loss: 4.568599270866696 CE Loss: 0.4738393013596011 Con Loss: 4.563860847171544
[20 / 20] tensor([[0.771, 0.710],
        [0.818, 0.905]]) {'epoch': 20, 'valid/acc': 79.789, 'valid/acc_unbiased': 80.171, 'valid/diff': 5.921, 'valid/acc_skew': 77.211, 'valid/acc_align': 83.132, 'test/acc': 80.084, 'test/acc_unbiased': 80.105, 'test/diff': 7.342, 'test/acc_skew': 76.433, 'test/acc_align': 83.776}
[20 / 20] best valid accuracy: 80.873 at epoch 13 
 best_stats: {'best_valid_epoch': 13, 'best_valid_valid/acc': 80.717, 'best_valid_valid/acc_unbiased': 80.873, 'best_valid_valid/diff': 4.907, 'best_valid_valid/acc_skew': 78.419, 'best_valid_valid/acc_align': 83.326, 'best_valid_test/acc': 81.35, 'best_valid_test/acc_unbiased': 81.201, 'best_valid_test/diff': 6.894, 'best_valid_test/acc_skew': 77.754, 'best_valid_test/acc_align': 84.648}
[20 / 20] best test accuracy: 81.201 at epoch 13 
 best_stats: {'best_test_epoch': 13, 'best_test_valid/acc': 80.717, 'best_test_valid/acc_unbiased': 80.873, 'best_test_valid/diff': 4.907, 'best_test_valid/acc_skew': 78.419, 'best_test_valid/acc_align': 83.326, 'best_test_test/acc': 81.35, 'best_test_test/acc_unbiased': 81.201, 'best_test_test/diff': 6.894, 'best_test_test/acc_skew': 77.754, 'best_test_test/acc_align': 84.648}
Total training time: 0:17:15
