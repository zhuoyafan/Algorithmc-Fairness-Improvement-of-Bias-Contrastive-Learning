Log level set to: INFO
Set seed: 1
=======> Using Fixed Random Seed: 1 <========
save_path: exp_results/bc-bb0-utk_face_age-uw-0.4-lr0.001-bs128-cbs64-w0.01-ratio10-aug1-seed1
get_utk_face - split: train, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_age-0.4
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [8237, 886]
Target 1: [4942, 1477]
Binary Target 1
---------------------------
Target 0: [8237, 886]
Target 1: [4942, 1477]
===================================
Normal Label Distribution: 
Target 0: [8237, 886]
Target 1: [4942, 1477]
===================================
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [8237, 886]
Target 1: [4942, 1477]
Binary Target 1
---------------------------
Target 0: [8237, 886]
Target 1: [4942, 1477]
===================================
Normal Label Distribution: 
Target 0: [8237, 886]
Target 1: [4942, 1477]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 15542, target_attr: gender, bias_attr: age bias_rate: 0.4
['[train] target_0-bias_0: 8237', '[train] target_0-bias_1: 886', '[train] target_1-bias_0: 4942', '[train] target_1-bias_1: 1477']
confusion_matrix - 
 original: tensor([[8237., 4942.],
        [ 886., 1477.]]), 
 normalized: tensor([[0.625, 0.375],
        [0.375, 0.625]]), 
 b|y: tensor([[0.903, 0.097],
        [0.770, 0.230]])
get_utk_face - split: train, aug: 1, given_y: True, ratio: 10
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_age-0.4
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [8237, 886]
Target 1: [4942, 1477]
Binary Target 1
---------------------------
Target 0: [8237, 886]
Target 1: [4942, 1477]
===================================
Normal Label Distribution: 
Target 0: [8237, 886]
Target 1: [4942, 1477]
===================================
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [8237, 886]
Target 1: [4942, 1477]
Binary Target 1
---------------------------
Target 0: [8237, 886]
Target 1: [4942, 1477]
===================================
Normal Label Distribution: 
Target 0: [8237, 886]
Target 1: [4942, 1477]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 15542, target_attr: gender, bias_attr: age bias_rate: 0.4
['[train] target_0-bias_0: 8237', '[train] target_0-bias_1: 886', '[train] target_1-bias_0: 4942', '[train] target_1-bias_1: 1477']
get_utk_face - split: valid, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_age-0.4
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [1030, 195]
Target 1: [841, 202]
Binary Target 1
---------------------------
Target 0: [1030, 195]
Target 1: [841, 202]
===================================
Normal Label Distribution: 
Target 0: [1030, 195]
Target 1: [841, 202]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 2268, target_attr: gender, bias_attr: age bias_rate: 0.4
['[valid] target_0-bias_0: 1030', '[valid] target_0-bias_1: 195', '[valid] target_1-bias_0: 841', '[valid] target_1-bias_1: 202']
get_utk_face - split: test, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_age-0.4
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [1061, 176]
Target 1: [867, 165]
Binary Target 1
---------------------------
Target 0: [1061, 176]
Target 1: [867, 165]
===================================
Normal Label Distribution: 
Target 0: [1061, 176]
Target 1: [867, 165]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 2269, target_attr: gender, bias_attr: age bias_rate: 0.4
['[test] target_0-bias_0: 1061', '[test] target_0-bias_1: 176', '[test] target_1-bias_0: 867', '[test] target_1-bias_1: 165']
decay_epochs: [6, 13]
[1 / 20] Learning rate: 0.001 weight: 0.01
[1 / 20] Loss: 4.914463482742496 CE Loss: 2.5302269652978655 Con Loss: 4.889161226142252
[1 / 20] tensor([[0.882, 0.812],
        [0.719, 0.600]]) {'epoch': 1, 'valid/acc': 79.189, 'valid/acc_unbiased': 75.002, 'valid/diff': 11.236, 'valid/acc_skew': 69.384, 'valid/acc_align': 80.621, 'test/acc': 79.374, 'test/acc_unbiased': 75.331, 'test/diff': 9.413, 'test/acc_skew': 70.625, 'test/acc_align': 80.038}
[1 / 20] best valid accuracy: 75.002 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 79.189, 'best_valid_valid/acc_unbiased': 75.002, 'best_valid_valid/diff': 11.236, 'best_valid_valid/acc_skew': 69.384, 'best_valid_valid/acc_align': 80.621, 'best_valid_test/acc': 79.374, 'best_valid_test/acc_unbiased': 75.331, 'best_valid_test/diff': 9.413, 'best_valid_test/acc_skew': 70.625, 'best_valid_test/acc_align': 80.038}
[1 / 20] best test accuracy: 75.331 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 79.189, 'best_test_valid/acc_unbiased': 75.002, 'best_test_valid/diff': 11.236, 'best_test_valid/acc_skew': 69.384, 'best_test_valid/acc_align': 80.621, 'best_test_test/acc': 79.374, 'best_test_test/acc_unbiased': 75.331, 'best_test_test/diff': 9.413, 'best_test_test/acc_skew': 70.625, 'best_test_test/acc_align': 80.038}
[2 / 20] Learning rate: 0.001 weight: 0.01
[2 / 20] Loss: 4.84148060267626 CE Loss: 2.190952666062613 Con Loss: 4.819571073812156
[2 / 20] tensor([[0.954, 0.960],
        [0.621, 0.303]]) {'epoch': 2, 'valid/acc': 77.337, 'valid/acc_unbiased': 72.025, 'valid/diff': 12.104, 'valid/acc_skew': 65.974, 'valid/acc_align': 78.077, 'test/acc': 77.964, 'test/acc_unbiased': 70.94, 'test/diff': 16.196, 'test/acc_skew': 63.163, 'test/acc_align': 78.717}
[2 / 20] best valid accuracy: 75.002 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 79.189, 'best_valid_valid/acc_unbiased': 75.002, 'best_valid_valid/diff': 11.236, 'best_valid_valid/acc_skew': 69.384, 'best_valid_valid/acc_align': 80.621, 'best_valid_test/acc': 79.374, 'best_valid_test/acc_unbiased': 75.331, 'best_valid_test/diff': 9.413, 'best_valid_test/acc_skew': 70.625, 'best_valid_test/acc_align': 80.038}
[2 / 20] best test accuracy: 75.331 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 79.189, 'best_test_valid/acc_unbiased': 75.002, 'best_test_valid/diff': 11.236, 'best_test_valid/acc_skew': 69.384, 'best_test_valid/acc_align': 80.621, 'best_test_test/acc': 79.374, 'best_test_test/acc_unbiased': 75.331, 'best_test_test/diff': 9.413, 'best_test_test/acc_skew': 70.625, 'best_test_test/acc_align': 80.038}
[3 / 20] Learning rate: 0.001 weight: 0.01
[3 / 20] Loss: 4.833335755828909 CE Loss: 2.096681825781157 Con Loss: 4.812368939671795
[3 / 20] tensor([[0.702, 0.631],
        [0.907, 0.764]]) {'epoch': 3, 'valid/acc': 77.778, 'valid/acc_unbiased': 74.217, 'valid/diff': 12.781, 'valid/acc_skew': 67.827, 'valid/acc_align': 80.608, 'test/acc': 77.92, 'test/acc_unbiased': 75.077, 'test/diff': 10.721, 'test/acc_skew': 69.716, 'test/acc_align': 80.437}
[3 / 20] best valid accuracy: 75.002 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 79.189, 'best_valid_valid/acc_unbiased': 75.002, 'best_valid_valid/diff': 11.236, 'best_valid_valid/acc_skew': 69.384, 'best_valid_valid/acc_align': 80.621, 'best_valid_test/acc': 79.374, 'best_valid_test/acc_unbiased': 75.331, 'best_valid_test/diff': 9.413, 'best_valid_test/acc_skew': 70.625, 'best_valid_test/acc_align': 80.038}
[3 / 20] best test accuracy: 75.331 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 79.189, 'best_test_valid/acc_unbiased': 75.002, 'best_test_valid/diff': 11.236, 'best_test_valid/acc_skew': 69.384, 'best_test_valid/acc_align': 80.621, 'best_test_test/acc': 79.374, 'best_test_test/acc_unbiased': 75.331, 'best_test_test/diff': 9.413, 'best_test_test/acc_skew': 70.625, 'best_test_test/acc_align': 80.038}
[4 / 20] Learning rate: 0.001 weight: 0.01
[4 / 20] Loss: 4.8238174095222535 CE Loss: 2.1049722077195794 Con Loss: 4.802767717152577
[4 / 20] tensor([[0.889, 0.688],
        [0.800, 0.752]]) {'epoch': 4, 'valid/acc': 80.908, 'valid/acc_unbiased': 74.867, 'valid/diff': 17.332, 'valid/acc_skew': 66.201, 'valid/acc_align': 83.533, 'test/acc': 82.944, 'test/acc_unbiased': 78.207, 'test/diff': 12.512, 'test/acc_skew': 71.951, 'test/acc_align': 84.462}
[4 / 20] best valid accuracy: 75.002 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 79.189, 'best_valid_valid/acc_unbiased': 75.002, 'best_valid_valid/diff': 11.236, 'best_valid_valid/acc_skew': 69.384, 'best_valid_valid/acc_align': 80.621, 'best_valid_test/acc': 79.374, 'best_valid_test/acc_unbiased': 75.331, 'best_valid_test/diff': 9.413, 'best_valid_test/acc_skew': 70.625, 'best_valid_test/acc_align': 80.038}
[4 / 20] best test accuracy: 78.207 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 80.908, 'best_test_valid/acc_unbiased': 74.867, 'best_test_valid/diff': 17.332, 'best_test_valid/acc_skew': 66.201, 'best_test_valid/acc_align': 83.533, 'best_test_test/acc': 82.944, 'best_test_test/acc_unbiased': 78.207, 'best_test_test/diff': 12.512, 'best_test_test/acc_skew': 71.951, 'best_test_test/acc_align': 84.462}
[5 / 20] Learning rate: 0.001 weight: 0.01
[5 / 20] Loss: 4.8128122098503265 CE Loss: 2.013696614969745 Con Loss: 4.792675227613281
[5 / 20] tensor([[0.827, 0.608],
        [0.842, 0.818]]) {'epoch': 5, 'valid/acc': 80.776, 'valid/acc_unbiased': 75.942, 'valid/diff': 14.835, 'valid/acc_skew': 68.525, 'valid/acc_align': 83.36, 'test/acc': 81.49, 'test/acc_unbiased': 77.367, 'test/diff': 12.121, 'test/acc_skew': 71.307, 'test/acc_align': 83.428}
[5 / 20] best valid accuracy: 75.942 at epoch 5 
 best_stats: {'best_valid_epoch': 5, 'best_valid_valid/acc': 80.776, 'best_valid_valid/acc_unbiased': 75.942, 'best_valid_valid/diff': 14.835, 'best_valid_valid/acc_skew': 68.525, 'best_valid_valid/acc_align': 83.36, 'best_valid_test/acc': 81.49, 'best_valid_test/acc_unbiased': 77.367, 'best_valid_test/diff': 12.121, 'best_valid_test/acc_skew': 71.307, 'best_valid_test/acc_align': 83.428}
[5 / 20] best test accuracy: 78.207 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 80.908, 'best_test_valid/acc_unbiased': 74.867, 'best_test_valid/diff': 17.332, 'best_test_valid/acc_skew': 66.201, 'best_test_valid/acc_align': 83.533, 'best_test_test/acc': 82.944, 'best_test_test/acc_unbiased': 78.207, 'best_test_test/diff': 12.512, 'best_test_test/acc_skew': 71.951, 'best_test_test/acc_align': 84.462}
[6 / 20] Learning rate: 0.001 weight: 0.01
[6 / 20] Loss: 4.811725056903148 CE Loss: 2.001959199565455 Con Loss: 4.791705457296876
[6 / 20] tensor([[0.963, 0.898],
        [0.574, 0.333]]) {'epoch': 6, 'valid/acc': 76.235, 'valid/acc_unbiased': 72.003, 'valid/diff': 8.116, 'valid/acc_skew': 67.945, 'valid/acc_align': 76.061, 'test/acc': 76.377, 'test/acc_unbiased': 69.217, 'test/diff': 15.329, 'test/acc_skew': 61.553, 'test/acc_align': 76.882}
[6 / 20] best valid accuracy: 75.942 at epoch 5 
 best_stats: {'best_valid_epoch': 5, 'best_valid_valid/acc': 80.776, 'best_valid_valid/acc_unbiased': 75.942, 'best_valid_valid/diff': 14.835, 'best_valid_valid/acc_skew': 68.525, 'best_valid_valid/acc_align': 83.36, 'best_valid_test/acc': 81.49, 'best_valid_test/acc_unbiased': 77.367, 'best_valid_test/diff': 12.121, 'best_valid_test/acc_skew': 71.307, 'best_valid_test/acc_align': 83.428}
[6 / 20] best test accuracy: 78.207 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 80.908, 'best_test_valid/acc_unbiased': 74.867, 'best_test_valid/diff': 17.332, 'best_test_valid/acc_skew': 66.201, 'best_test_valid/acc_align': 83.533, 'best_test_test/acc': 82.944, 'best_test_test/acc_unbiased': 78.207, 'best_test_test/diff': 12.512, 'best_test_test/acc_skew': 71.951, 'best_test_test/acc_align': 84.462}
[7 / 20] Learning rate: 0.0001 weight: 0.01
[7 / 20] Loss: 4.784381567871934 CE Loss: 1.7874736095576225 Con Loss: 4.766506828314978
[7 / 20] tensor([[0.926, 0.784],
        [0.824, 0.667]]) {'epoch': 7, 'valid/acc': 85.229, 'valid/acc_unbiased': 80.168, 'valid/diff': 14.124, 'valid/acc_skew': 73.106, 'valid/acc_align': 87.23, 'test/acc': 85.677, 'test/acc_unbiased': 79.996, 'test/diff': 14.916, 'test/acc_skew': 72.538, 'test/acc_align': 87.454}
[7 / 20] best valid accuracy: 80.168 at epoch 7 
 best_stats: {'best_valid_epoch': 7, 'best_valid_valid/acc': 85.229, 'best_valid_valid/acc_unbiased': 80.168, 'best_valid_valid/diff': 14.124, 'best_valid_valid/acc_skew': 73.106, 'best_valid_valid/acc_align': 87.23, 'best_valid_test/acc': 85.677, 'best_valid_test/acc_unbiased': 79.996, 'best_valid_test/diff': 14.916, 'best_valid_test/acc_skew': 72.538, 'best_valid_test/acc_align': 87.454}
[7 / 20] best test accuracy: 79.996 at epoch 7 
 best_stats: {'best_test_epoch': 7, 'best_test_valid/acc': 85.229, 'best_test_valid/acc_unbiased': 80.168, 'best_test_valid/diff': 14.124, 'best_test_valid/acc_skew': 73.106, 'best_test_valid/acc_align': 87.23, 'best_test_test/acc': 85.677, 'best_test_test/acc_unbiased': 79.996, 'best_test_test/diff': 14.916, 'best_test_test/acc_skew': 72.538, 'best_test_test/acc_align': 87.454}
[8 / 20] Learning rate: 0.0001 weight: 0.01
[8 / 20] Loss: 4.754163981864633 CE Loss: 1.6958678410237644 Con Loss: 4.737205301529498
[8 / 20] tensor([[0.908, 0.778],
        [0.848, 0.697]]) {'epoch': 8, 'valid/acc': 85.406, 'valid/acc_unbiased': 80.422, 'valid/diff': 14.191, 'valid/acc_skew': 73.327, 'valid/acc_align': 87.518, 'test/acc': 85.941, 'test/acc_unbiased': 80.769, 'test/diff': 14.0, 'test/acc_skew': 73.769, 'test/acc_align': 87.769}
[8 / 20] best valid accuracy: 80.422 at epoch 8 
 best_stats: {'best_valid_epoch': 8, 'best_valid_valid/acc': 85.406, 'best_valid_valid/acc_unbiased': 80.422, 'best_valid_valid/diff': 14.191, 'best_valid_valid/acc_skew': 73.327, 'best_valid_valid/acc_align': 87.518, 'best_valid_test/acc': 85.941, 'best_valid_test/acc_unbiased': 80.769, 'best_valid_test/diff': 14.0, 'best_valid_test/acc_skew': 73.769, 'best_valid_test/acc_align': 87.769}
[8 / 20] best test accuracy: 80.769 at epoch 8 
 best_stats: {'best_test_epoch': 8, 'best_test_valid/acc': 85.406, 'best_test_valid/acc_unbiased': 80.422, 'best_test_valid/diff': 14.191, 'best_test_valid/acc_skew': 73.327, 'best_test_valid/acc_align': 87.518, 'best_test_test/acc': 85.941, 'best_test_test/acc_unbiased': 80.769, 'best_test_test/diff': 14.0, 'best_test_test/acc_skew': 73.769, 'best_test_test/acc_align': 87.769}
[9 / 20] Learning rate: 0.0001 weight: 0.01
[9 / 20] Loss: 4.7416875923543556 CE Loss: 1.6178704927578471 Con Loss: 4.725508890101661
[9 / 20] tensor([[0.915, 0.733],
        [0.836, 0.776]]) {'epoch': 9, 'valid/acc': 85.317, 'valid/acc_unbiased': 80.115, 'valid/diff': 14.85, 'valid/acc_skew': 72.69, 'valid/acc_align': 87.539, 'test/acc': 86.073, 'test/acc_unbiased': 81.503, 'test/diff': 12.134, 'test/acc_skew': 75.436, 'test/acc_align': 87.57}
[9 / 20] best valid accuracy: 80.422 at epoch 8 
 best_stats: {'best_valid_epoch': 8, 'best_valid_valid/acc': 85.406, 'best_valid_valid/acc_unbiased': 80.422, 'best_valid_valid/diff': 14.191, 'best_valid_valid/acc_skew': 73.327, 'best_valid_valid/acc_align': 87.518, 'best_valid_test/acc': 85.941, 'best_valid_test/acc_unbiased': 80.769, 'best_valid_test/diff': 14.0, 'best_valid_test/acc_skew': 73.769, 'best_valid_test/acc_align': 87.769}
[9 / 20] best test accuracy: 81.503 at epoch 9 
 best_stats: {'best_test_epoch': 9, 'best_test_valid/acc': 85.317, 'best_test_valid/acc_unbiased': 80.115, 'best_test_valid/diff': 14.85, 'best_test_valid/acc_skew': 72.69, 'best_test_valid/acc_align': 87.539, 'best_test_test/acc': 86.073, 'best_test_test/acc_unbiased': 81.503, 'best_test_test/diff': 12.134, 'best_test_test/acc_skew': 75.436, 'best_test_test/acc_align': 87.57}
[10 / 20] Learning rate: 0.0001 weight: 0.01
[10 / 20] Loss: 4.733249408553549 CE Loss: 1.6008158807296762 Con Loss: 4.717241244708198
[10 / 20] tensor([[0.909, 0.722],
        [0.874, 0.727]]) {'epoch': 10, 'valid/acc': 85.362, 'valid/acc_unbiased': 79.85, 'valid/diff': 16.213, 'valid/acc_skew': 71.744, 'valid/acc_align': 87.957, 'test/acc': 86.778, 'test/acc_unbiased': 80.793, 'test/diff': 16.7, 'test/acc_skew': 72.443, 'test/acc_align': 89.143}
[10 / 20] best valid accuracy: 80.422 at epoch 8 
 best_stats: {'best_valid_epoch': 8, 'best_valid_valid/acc': 85.406, 'best_valid_valid/acc_unbiased': 80.422, 'best_valid_valid/diff': 14.191, 'best_valid_valid/acc_skew': 73.327, 'best_valid_valid/acc_align': 87.518, 'best_valid_test/acc': 85.941, 'best_valid_test/acc_unbiased': 80.769, 'best_valid_test/diff': 14.0, 'best_valid_test/acc_skew': 73.769, 'best_valid_test/acc_align': 87.769}
[10 / 20] best test accuracy: 81.503 at epoch 9 
 best_stats: {'best_test_epoch': 9, 'best_test_valid/acc': 85.317, 'best_test_valid/acc_unbiased': 80.115, 'best_test_valid/diff': 14.85, 'best_test_valid/acc_skew': 72.69, 'best_test_valid/acc_align': 87.539, 'best_test_test/acc': 86.073, 'best_test_test/acc_unbiased': 81.503, 'best_test_test/diff': 12.134, 'best_test_test/acc_skew': 75.436, 'best_test_test/acc_align': 87.57}
[11 / 20] Learning rate: 0.0001 weight: 0.01
[11 / 20] Loss: 4.728710496767717 CE Loss: 1.5755822742756938 Con Loss: 4.712954686117853
[11 / 20] tensor([[0.916, 0.778],
        [0.860, 0.685]]) {'epoch': 11, 'valid/acc': 85.979, 'valid/acc_unbiased': 80.817, 'valid/diff': 15.034, 'valid/acc_skew': 73.3, 'valid/acc_align': 88.334, 'test/acc': 86.734, 'test/acc_unbiased': 80.995, 'test/diff': 15.665, 'test/acc_skew': 73.163, 'test/acc_align': 88.828}
[11 / 20] best valid accuracy: 80.817 at epoch 11 
 best_stats: {'best_valid_epoch': 11, 'best_valid_valid/acc': 85.979, 'best_valid_valid/acc_unbiased': 80.817, 'best_valid_valid/diff': 15.034, 'best_valid_valid/acc_skew': 73.3, 'best_valid_valid/acc_align': 88.334, 'best_valid_test/acc': 86.734, 'best_valid_test/acc_unbiased': 80.995, 'best_valid_test/diff': 15.665, 'best_valid_test/acc_skew': 73.163, 'best_valid_test/acc_align': 88.828}
[11 / 20] best test accuracy: 81.503 at epoch 9 
 best_stats: {'best_test_epoch': 9, 'best_test_valid/acc': 85.317, 'best_test_valid/acc_unbiased': 80.115, 'best_test_valid/diff': 14.85, 'best_test_valid/acc_skew': 72.69, 'best_test_valid/acc_align': 87.539, 'best_test_test/acc': 86.073, 'best_test_test/acc_unbiased': 81.503, 'best_test_test/diff': 12.134, 'best_test_test/acc_skew': 75.436, 'best_test_test/acc_align': 87.57}
[12 / 20] Learning rate: 0.0001 weight: 0.01
[12 / 20] Loss: 4.719737281242158 CE Loss: 1.5159442539519439 Con Loss: 4.704577857410105
[12 / 20] tensor([[0.898, 0.750],
        [0.892, 0.758]]) {'epoch': 12, 'valid/acc': 85.935, 'valid/acc_unbiased': 80.899, 'valid/diff': 15.004, 'valid/acc_skew': 73.397, 'valid/acc_align': 88.401, 'test/acc': 87.395, 'test/acc_unbiased': 82.434, 'test/diff': 14.111, 'test/acc_skew': 75.379, 'test/acc_align': 89.489}
[12 / 20] best valid accuracy: 80.899 at epoch 12 
 best_stats: {'best_valid_epoch': 12, 'best_valid_valid/acc': 85.935, 'best_valid_valid/acc_unbiased': 80.899, 'best_valid_valid/diff': 15.004, 'best_valid_valid/acc_skew': 73.397, 'best_valid_valid/acc_align': 88.401, 'best_valid_test/acc': 87.395, 'best_valid_test/acc_unbiased': 82.434, 'best_valid_test/diff': 14.111, 'best_valid_test/acc_skew': 75.379, 'best_valid_test/acc_align': 89.489}
[12 / 20] best test accuracy: 82.434 at epoch 12 
 best_stats: {'best_test_epoch': 12, 'best_test_valid/acc': 85.935, 'best_test_valid/acc_unbiased': 80.899, 'best_test_valid/diff': 15.004, 'best_test_valid/acc_skew': 73.397, 'best_test_valid/acc_align': 88.401, 'best_test_test/acc': 87.395, 'best_test_test/acc_unbiased': 82.434, 'best_test_test/diff': 14.111, 'best_test_test/acc_skew': 75.379, 'best_test_test/acc_align': 89.489}
[13 / 20] Learning rate: 0.0001 weight: 0.01
[13 / 20] Loss: 4.709376589179024 CE Loss: 1.4935355863582211 Con Loss: 4.694441226654386
[13 / 20] tensor([[0.928, 0.750],
        [0.863, 0.758]]) {'epoch': 13, 'valid/acc': 86.464, 'valid/acc_unbiased': 81.317, 'valid/diff': 14.637, 'valid/acc_skew': 73.998, 'valid/acc_align': 88.635, 'test/acc': 87.704, 'test/acc_unbiased': 82.467, 'test/diff': 14.177, 'test/acc_skew': 75.379, 'test/acc_align': 89.556}
[13 / 20] best valid accuracy: 81.317 at epoch 13 
 best_stats: {'best_valid_epoch': 13, 'best_valid_valid/acc': 86.464, 'best_valid_valid/acc_unbiased': 81.317, 'best_valid_valid/diff': 14.637, 'best_valid_valid/acc_skew': 73.998, 'best_valid_valid/acc_align': 88.635, 'best_valid_test/acc': 87.704, 'best_valid_test/acc_unbiased': 82.467, 'best_valid_test/diff': 14.177, 'best_valid_test/acc_skew': 75.379, 'best_valid_test/acc_align': 89.556}
[13 / 20] best test accuracy: 82.467 at epoch 13 
 best_stats: {'best_test_epoch': 13, 'best_test_valid/acc': 86.464, 'best_test_valid/acc_unbiased': 81.317, 'best_test_valid/diff': 14.637, 'best_test_valid/acc_skew': 73.998, 'best_test_valid/acc_align': 88.635, 'best_test_test/acc': 87.704, 'best_test_test/acc_unbiased': 82.467, 'best_test_test/diff': 14.177, 'best_test_test/acc_skew': 75.379, 'best_test_test/acc_align': 89.556}
[14 / 20] Learning rate: 1e-05 weight: 0.01
[14 / 20] Loss: 4.691510869336549 CE Loss: 1.4457708912425913 Con Loss: 4.677053150807303
[14 / 20] tensor([[0.915, 0.744],
        [0.873, 0.733]]) {'epoch': 14, 'valid/acc': 86.728, 'valid/acc_unbiased': 81.512, 'valid/diff': 15.026, 'valid/acc_skew': 73.998, 'valid/acc_align': 89.025, 'test/acc': 87.263, 'test/acc_unbiased': 81.649, 'test/diff': 15.532, 'test/acc_skew': 73.883, 'test/acc_align': 89.415}
[14 / 20] best valid accuracy: 81.512 at epoch 14 
 best_stats: {'best_valid_epoch': 14, 'best_valid_valid/acc': 86.728, 'best_valid_valid/acc_unbiased': 81.512, 'best_valid_valid/diff': 15.026, 'best_valid_valid/acc_skew': 73.998, 'best_valid_valid/acc_align': 89.025, 'best_valid_test/acc': 87.263, 'best_valid_test/acc_unbiased': 81.649, 'best_valid_test/diff': 15.532, 'best_valid_test/acc_skew': 73.883, 'best_valid_test/acc_align': 89.415}
[14 / 20] best test accuracy: 82.467 at epoch 13 
 best_stats: {'best_test_epoch': 13, 'best_test_valid/acc': 86.464, 'best_test_valid/acc_unbiased': 81.317, 'best_test_valid/diff': 14.637, 'best_test_valid/acc_skew': 73.998, 'best_test_valid/acc_align': 88.635, 'best_test_test/acc': 87.704, 'best_test_test/acc_unbiased': 82.467, 'best_test_test/diff': 14.177, 'best_test_test/acc_skew': 75.379, 'best_test_test/acc_align': 89.556}
[15 / 20] Learning rate: 1e-05 weight: 0.01
[15 / 20] Loss: 4.692326795516396 CE Loss: 1.4342398632908862 Con Loss: 4.67798439082822
[15 / 20] tensor([[0.916, 0.710],
        [0.881, 0.776]]) {'epoch': 15, 'valid/acc': 86.552, 'valid/acc_unbiased': 80.787, 'valid/diff': 16.69, 'valid/acc_skew': 72.442, 'valid/acc_align': 89.133, 'test/acc': 87.66, 'test/acc_unbiased': 82.083, 'test/diff': 15.567, 'test/acc_skew': 74.299, 'test/acc_align': 89.866}
[15 / 20] best valid accuracy: 81.512 at epoch 14 
 best_stats: {'best_valid_epoch': 14, 'best_valid_valid/acc': 86.728, 'best_valid_valid/acc_unbiased': 81.512, 'best_valid_valid/diff': 15.026, 'best_valid_valid/acc_skew': 73.998, 'best_valid_valid/acc_align': 89.025, 'best_valid_test/acc': 87.263, 'best_valid_test/acc_unbiased': 81.649, 'best_valid_test/diff': 15.532, 'best_valid_test/acc_skew': 73.883, 'best_valid_test/acc_align': 89.415}
[15 / 20] best test accuracy: 82.467 at epoch 13 
 best_stats: {'best_test_epoch': 13, 'best_test_valid/acc': 86.464, 'best_test_valid/acc_unbiased': 81.317, 'best_test_valid/diff': 14.637, 'best_test_valid/acc_skew': 73.998, 'best_test_valid/acc_align': 88.635, 'best_test_test/acc': 87.704, 'best_test_test/acc_unbiased': 82.467, 'best_test_test/diff': 14.177, 'best_test_test/acc_skew': 75.379, 'best_test_test/acc_align': 89.556}
[16 / 20] Learning rate: 1e-05 weight: 0.01
[16 / 20] Loss: 4.6935875575647685 CE Loss: 1.4007479135340635 Con Loss: 4.679580076276803
[16 / 20] tensor([[0.925, 0.744],
        [0.877, 0.770]]) {'epoch': 16, 'valid/acc': 87.081, 'valid/acc_unbiased': 81.814, 'valid/diff': 15.189, 'valid/acc_skew': 74.219, 'valid/acc_align': 89.408, 'test/acc': 88.1, 'test/acc_unbiased': 82.88, 'test/diff': 14.359, 'test/acc_skew': 75.701, 'test/acc_align': 90.059}
[16 / 20] best valid accuracy: 81.814 at epoch 16 
 best_stats: {'best_valid_epoch': 16, 'best_valid_valid/acc': 87.081, 'best_valid_valid/acc_unbiased': 81.814, 'best_valid_valid/diff': 15.189, 'best_valid_valid/acc_skew': 74.219, 'best_valid_valid/acc_align': 89.408, 'best_valid_test/acc': 88.1, 'best_valid_test/acc_unbiased': 82.88, 'best_valid_test/diff': 14.359, 'best_valid_test/acc_skew': 75.701, 'best_valid_test/acc_align': 90.059}
[16 / 20] best test accuracy: 82.880 at epoch 16 
 best_stats: {'best_test_epoch': 16, 'best_test_valid/acc': 87.081, 'best_test_valid/acc_unbiased': 81.814, 'best_test_valid/diff': 15.189, 'best_test_valid/acc_skew': 74.219, 'best_test_valid/acc_align': 89.408, 'best_test_test/acc': 88.1, 'best_test_test/acc_unbiased': 82.88, 'best_test_test/diff': 14.359, 'best_test_test/acc_skew': 75.701, 'best_test_test/acc_align': 90.059}
[17 / 20] Learning rate: 1e-05 weight: 0.01
[17 / 20] Loss: 4.6842083128365966 CE Loss: 1.4340563200720027 Con Loss: 4.669867740820586
[17 / 20] tensor([[0.921, 0.750],
        [0.885, 0.745]]) {'epoch': 17, 'valid/acc': 87.081, 'valid/acc_unbiased': 82.12, 'valid/diff': 14.263, 'valid/acc_skew': 74.989, 'valid/acc_align': 89.252, 'test/acc': 88.1, 'test/acc_unbiased': 82.524, 'test/diff': 15.502, 'test/acc_skew': 74.773, 'test/acc_align': 90.274}
[17 / 20] best valid accuracy: 82.120 at epoch 17 
 best_stats: {'best_valid_epoch': 17, 'best_valid_valid/acc': 87.081, 'best_valid_valid/acc_unbiased': 82.12, 'best_valid_valid/diff': 14.263, 'best_valid_valid/acc_skew': 74.989, 'best_valid_valid/acc_align': 89.252, 'best_valid_test/acc': 88.1, 'best_valid_test/acc_unbiased': 82.524, 'best_valid_test/diff': 15.502, 'best_valid_test/acc_skew': 74.773, 'best_valid_test/acc_align': 90.274}
[17 / 20] best test accuracy: 82.880 at epoch 16 
 best_stats: {'best_test_epoch': 16, 'best_test_valid/acc': 87.081, 'best_test_valid/acc_unbiased': 81.814, 'best_test_valid/diff': 15.189, 'best_test_valid/acc_skew': 74.219, 'best_test_valid/acc_align': 89.408, 'best_test_test/acc': 88.1, 'best_test_test/acc_unbiased': 82.88, 'best_test_test/diff': 14.359, 'best_test_test/acc_skew': 75.701, 'best_test_test/acc_align': 90.059}
[18 / 20] Learning rate: 1e-05 weight: 0.01
[18 / 20] Loss: 4.681557801496628 CE Loss: 1.3955246788119888 Con Loss: 4.667602555875443
[18 / 20] tensor([[0.919, 0.744],
        [0.885, 0.752]]) {'epoch': 18, 'valid/acc': 86.993, 'valid/acc_unbiased': 82.053, 'valid/diff': 14.182, 'valid/acc_skew': 74.962, 'valid/acc_align': 89.144, 'test/acc': 88.012, 'test/acc_unbiased': 82.486, 'test/diff': 15.389, 'test/acc_skew': 74.792, 'test/acc_align': 90.18}
[18 / 20] best valid accuracy: 82.120 at epoch 17 
 best_stats: {'best_valid_epoch': 17, 'best_valid_valid/acc': 87.081, 'best_valid_valid/acc_unbiased': 82.12, 'best_valid_valid/diff': 14.263, 'best_valid_valid/acc_skew': 74.989, 'best_valid_valid/acc_align': 89.252, 'best_valid_test/acc': 88.1, 'best_valid_test/acc_unbiased': 82.524, 'best_valid_test/diff': 15.502, 'best_valid_test/acc_skew': 74.773, 'best_valid_test/acc_align': 90.274}
[18 / 20] best test accuracy: 82.880 at epoch 16 
 best_stats: {'best_test_epoch': 16, 'best_test_valid/acc': 87.081, 'best_test_valid/acc_unbiased': 81.814, 'best_test_valid/diff': 15.189, 'best_test_valid/acc_skew': 74.219, 'best_test_valid/acc_align': 89.408, 'best_test_test/acc': 88.1, 'best_test_test/acc_unbiased': 82.88, 'best_test_test/diff': 14.359, 'best_test_test/acc_skew': 75.701, 'best_test_test/acc_align': 90.059}
[19 / 20] Learning rate: 1e-05 weight: 0.01
[19 / 20] Loss: 4.6757351035026185 CE Loss: 1.4135234651533644 Con Loss: 4.661599858757336
[19 / 20] tensor([[0.919, 0.716],
        [0.890, 0.770]]) {'epoch': 19, 'valid/acc': 87.037, 'valid/acc_unbiased': 81.796, 'valid/diff': 15.259, 'valid/acc_skew': 74.166, 'valid/acc_align': 89.425, 'test/acc': 88.145, 'test/acc_unbiased': 82.374, 'test/diff': 16.188, 'test/acc_skew': 74.28, 'test/acc_align': 90.469}
[19 / 20] best valid accuracy: 82.120 at epoch 17 
 best_stats: {'best_valid_epoch': 17, 'best_valid_valid/acc': 87.081, 'best_valid_valid/acc_unbiased': 82.12, 'best_valid_valid/diff': 14.263, 'best_valid_valid/acc_skew': 74.989, 'best_valid_valid/acc_align': 89.252, 'best_valid_test/acc': 88.1, 'best_valid_test/acc_unbiased': 82.524, 'best_valid_test/diff': 15.502, 'best_valid_test/acc_skew': 74.773, 'best_valid_test/acc_align': 90.274}
[19 / 20] best test accuracy: 82.880 at epoch 16 
 best_stats: {'best_test_epoch': 16, 'best_test_valid/acc': 87.081, 'best_test_valid/acc_unbiased': 81.814, 'best_test_valid/diff': 15.189, 'best_test_valid/acc_skew': 74.219, 'best_test_valid/acc_align': 89.408, 'best_test_test/acc': 88.1, 'best_test_test/acc_unbiased': 82.88, 'best_test_test/diff': 14.359, 'best_test_test/acc_skew': 75.701, 'best_test_test/acc_align': 90.059}
[20 / 20] Learning rate: 1e-05 weight: 0.01
[20 / 20] Loss: 4.679864885509129 CE Loss: 1.3986206093958609 Con Loss: 4.665878670201187
[20 / 20] tensor([[0.919, 0.733],
        [0.888, 0.764]]) {'epoch': 20, 'valid/acc': 87.125, 'valid/acc_unbiased': 82.253, 'valid/diff': 14.106, 'valid/acc_skew': 75.201, 'valid/acc_align': 89.306, 'test/acc': 88.145, 'test/acc_unbiased': 82.591, 'test/diff': 15.524, 'test/acc_skew': 74.83, 'test/acc_align': 90.353}
[20 / 20] best valid accuracy: 82.253 at epoch 20 
 best_stats: {'best_valid_epoch': 20, 'best_valid_valid/acc': 87.125, 'best_valid_valid/acc_unbiased': 82.253, 'best_valid_valid/diff': 14.106, 'best_valid_valid/acc_skew': 75.201, 'best_valid_valid/acc_align': 89.306, 'best_valid_test/acc': 88.145, 'best_valid_test/acc_unbiased': 82.591, 'best_valid_test/diff': 15.524, 'best_valid_test/acc_skew': 74.83, 'best_valid_test/acc_align': 90.353}
[20 / 20] best test accuracy: 82.880 at epoch 16 
 best_stats: {'best_test_epoch': 16, 'best_test_valid/acc': 87.081, 'best_test_valid/acc_unbiased': 81.814, 'best_test_valid/diff': 15.189, 'best_test_valid/acc_skew': 74.219, 'best_test_valid/acc_align': 89.408, 'best_test_test/acc': 88.1, 'best_test_test/acc_unbiased': 82.88, 'best_test_test/diff': 14.359, 'best_test_test/acc_skew': 75.701, 'best_test_test/acc_align': 90.059}
Total training time: 1:20:20
