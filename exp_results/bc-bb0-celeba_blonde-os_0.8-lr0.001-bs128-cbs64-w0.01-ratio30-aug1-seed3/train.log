Log level set to: INFO
Set seed: 3
=======> Using Fixed Random Seed: 3 <========
save_path: exp_results/bc-bb0-celeba_blonde-os_0.8-lr0.001-bs128-cbs64-w0.01-ratio30-aug1-seed3
get_celeba - split:train, aug: False, given_y: True, ratio: 0
use existing blonde indices from data/celeba/pickles/blonde
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [42788, 42788]
Target 1: [42788, 42788]
Binary Target 1
---------------------------
Target 0: [42788, 42788]
Target 1: [42788, 42788]
===================================
Normal Label Distribution: 
Target 0: [42788, 42788]
Target 1: [42788, 42788]
===================================
Use BiasedCelebASplit 
 target_attr: blonde split: train 
 tensor([[42788., 42788.],
        [42788., 42788.]])
get_celeba - split:train, aug: 1, given_y: True, ratio: 30
use existing blonde indices from data/celeba/pickles/blonde
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [42806, 42806]
Target 1: [42806, 42806]
Binary Target 1
---------------------------
Target 0: [42806, 42806]
Target 1: [42806, 42806]
===================================
Normal Label Distribution: 
Target 0: [42806, 42806]
Target 1: [42806, 42806]
===================================
Use BiasedCelebASplit 
 target_attr: blonde split: train 
 tensor([[42806., 42806.],
        [42806., 42806.]])
get_celeba - split:train_valid, aug: False, given_y: True, ratio: 0
use existing blonde indices from data/celeba/pickles/blonde
Use BiasedCelebASplit 
 target_attr: blonde split: train_valid 
 tensor([[  386.,  4517.],
        [13446.,   280.]])
get_celeba - split:valid, aug: False, given_y: True, ratio: 0
Use BiasedCelebASplit 
 target_attr: blonde split: valid 
 tensor([[8535., 2874.],
        [8276.,  182.]])
decay_epochs: [3, 6]
[1 / 10] Learning rate: 0.001 weight: 0.01
[1 / 10] Loss: 4.615629729884043 CE Loss: 0.24057753676508725 Con Loss: 4.613223951041414
[1 / 10] tensor([[0.839, 0.890],
        [0.952, 0.929]]) {'epoch': 1, 'valid/acc': 89.726, 'valid/acc_unbiased': 91.018, 'valid/diff': 4.405, 'valid/acc_skew': 93.22, 'valid/acc_align': 88.816, 'test/acc': 87.738, 'test/acc_unbiased': 90.243, 'test/diff': 3.739, 'test/acc_skew': 89.561, 'test/acc_align': 90.925}
[1 / 10] best valid accuracy: 91.018 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 89.726, 'best_valid_valid/acc_unbiased': 91.018, 'best_valid_valid/diff': 4.405, 'best_valid_valid/acc_skew': 93.22, 'best_valid_valid/acc_align': 88.816, 'best_valid_test/acc': 87.738, 'best_valid_test/acc_unbiased': 90.243, 'best_valid_test/diff': 3.739, 'best_valid_test/acc_skew': 89.561, 'best_valid_test/acc_align': 90.925}
[1 / 10] best test accuracy: 90.243 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 89.726, 'best_test_valid/acc_unbiased': 91.018, 'best_test_valid/diff': 4.405, 'best_test_valid/acc_skew': 93.22, 'best_test_valid/acc_align': 88.816, 'best_test_test/acc': 87.738, 'best_test_test/acc_unbiased': 90.243, 'best_test_test/diff': 3.739, 'best_test_test/acc_skew': 89.561, 'best_test_test/acc_align': 90.925}
[2 / 10] Learning rate: 0.001 weight: 0.01
[2 / 10] Loss: 4.562024927232893 CE Loss: 0.204007780210202 Con Loss: 4.5599848505736755
[2 / 10] tensor([[0.785, 0.899],
        [0.977, 0.951]]) {'epoch': 2, 'valid/acc': 91.234, 'valid/acc_unbiased': 92.455, 'valid/diff': 1.988, 'valid/acc_skew': 92.72, 'valid/acc_align': 92.19, 'test/acc': 86.178, 'test/acc_unbiased': 90.289, 'test/diff': 7.035, 'test/acc_skew': 88.096, 'test/acc_align': 92.483}
[2 / 10] best valid accuracy: 92.455 at epoch 2 
 best_stats: {'best_valid_epoch': 2, 'best_valid_valid/acc': 91.234, 'best_valid_valid/acc_unbiased': 92.455, 'best_valid_valid/diff': 1.988, 'best_valid_valid/acc_skew': 92.72, 'best_valid_valid/acc_align': 92.19, 'best_valid_test/acc': 86.178, 'best_valid_test/acc_unbiased': 90.289, 'best_valid_test/diff': 7.035, 'best_valid_test/acc_skew': 88.096, 'best_valid_test/acc_align': 92.483}
[2 / 10] best test accuracy: 90.289 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 91.234, 'best_test_valid/acc_unbiased': 92.455, 'best_test_valid/diff': 1.988, 'best_test_valid/acc_skew': 92.72, 'best_test_valid/acc_align': 92.19, 'best_test_test/acc': 86.178, 'best_test_test/acc_unbiased': 90.289, 'best_test_test/diff': 7.035, 'best_test_test/acc_skew': 88.096, 'best_test_test/acc_align': 92.483}
[3 / 10] Learning rate: 0.001 weight: 0.01
[3 / 10] Loss: 4.535065650360444 CE Loss: 0.1878320050176041 Con Loss: 4.533187334009495
[3 / 10] tensor([[0.936, 0.974],
        [0.863, 0.802]]) {'epoch': 3, 'valid/acc': 93.929, 'valid/acc_unbiased': 89.835, 'valid/diff': 4.49, 'valid/acc_skew': 92.08, 'valid/acc_align': 87.59, 'test/acc': 93.985, 'test/acc_unbiased': 89.361, 'test/diff': 4.888, 'test/acc_skew': 89.935, 'test/acc_align': 88.787}
[3 / 10] best valid accuracy: 92.455 at epoch 2 
 best_stats: {'best_valid_epoch': 2, 'best_valid_valid/acc': 91.234, 'best_valid_valid/acc_unbiased': 92.455, 'best_valid_valid/diff': 1.988, 'best_valid_valid/acc_skew': 92.72, 'best_valid_valid/acc_align': 92.19, 'best_valid_test/acc': 86.178, 'best_valid_test/acc_unbiased': 90.289, 'best_valid_test/diff': 7.035, 'best_valid_test/acc_skew': 88.096, 'best_valid_test/acc_align': 92.483}
[3 / 10] best test accuracy: 90.289 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 91.234, 'best_test_valid/acc_unbiased': 92.455, 'best_test_valid/diff': 1.988, 'best_test_valid/acc_skew': 92.72, 'best_test_valid/acc_align': 92.19, 'best_test_test/acc': 86.178, 'best_test_test/acc_unbiased': 90.289, 'best_test_test/diff': 7.035, 'best_test_test/acc_skew': 88.096, 'best_test_test/acc_align': 92.483}
[4 / 10] Learning rate: 0.0001 weight: 0.01
[4 / 10] Loss: 4.457550793303901 CE Loss: 0.1493903908666477 Con Loss: 4.456056894047568
[4 / 10] tensor([[0.842, 0.945],
        [0.967, 0.879]]) {'epoch': 4, 'valid/acc': 94.637, 'valid/acc_unbiased': 95.643, 'valid/diff': 2.757, 'valid/acc_skew': 97.022, 'valid/acc_align': 94.265, 'test/acc': 90.311, 'test/acc_unbiased': 90.808, 'test/diff': 9.521, 'test/acc_skew': 90.421, 'test/acc_align': 91.195}
[4 / 10] best valid accuracy: 95.643 at epoch 4 
 best_stats: {'best_valid_epoch': 4, 'best_valid_valid/acc': 94.637, 'best_valid_valid/acc_unbiased': 95.643, 'best_valid_valid/diff': 2.757, 'best_valid_valid/acc_skew': 97.022, 'best_valid_valid/acc_align': 94.265, 'best_valid_test/acc': 90.311, 'best_valid_test/acc_unbiased': 90.808, 'best_valid_test/diff': 9.521, 'best_valid_test/acc_skew': 90.421, 'best_valid_test/acc_align': 91.195}
[4 / 10] best test accuracy: 90.808 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 94.637, 'best_test_valid/acc_unbiased': 95.643, 'best_test_valid/diff': 2.757, 'best_test_valid/acc_skew': 97.022, 'best_test_valid/acc_align': 94.265, 'best_test_test/acc': 90.311, 'best_test_test/acc_unbiased': 90.808, 'best_test_test/diff': 9.521, 'best_test_test/acc_skew': 90.421, 'best_test_test/acc_align': 91.195}
[5 / 10] Learning rate: 0.0001 weight: 0.01
[5 / 10] Loss: 4.41851707216712 CE Loss: 0.13590114879432078 Con Loss: 4.417158063844151
[5 / 10] tensor([[0.838, 0.955],
        [0.972, 0.863]]) {'epoch': 5, 'valid/acc': 95.518, 'valid/acc_unbiased': 95.656, 'valid/diff': 2.79, 'valid/acc_skew': 97.051, 'valid/acc_align': 94.261, 'test/acc': 90.663, 'test/acc_unbiased': 90.704, 'test/diff': 11.314, 'test/acc_skew': 90.506, 'test/acc_align': 90.903}
[5 / 10] best valid accuracy: 95.656 at epoch 5 
 best_stats: {'best_valid_epoch': 5, 'best_valid_valid/acc': 95.518, 'best_valid_valid/acc_unbiased': 95.656, 'best_valid_valid/diff': 2.79, 'best_valid_valid/acc_skew': 97.051, 'best_valid_valid/acc_align': 94.261, 'best_valid_test/acc': 90.663, 'best_valid_test/acc_unbiased': 90.704, 'best_valid_test/diff': 11.314, 'best_valid_test/acc_skew': 90.506, 'best_valid_test/acc_align': 90.903}
[5 / 10] best test accuracy: 90.808 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 94.637, 'best_test_valid/acc_unbiased': 95.643, 'best_test_valid/diff': 2.757, 'best_test_valid/acc_skew': 97.022, 'best_test_valid/acc_align': 94.265, 'best_test_test/acc': 90.311, 'best_test_test/acc_unbiased': 90.808, 'best_test_test/diff': 9.521, 'best_test_test/acc_skew': 90.421, 'best_test_test/acc_align': 91.195}
[6 / 10] Learning rate: 0.0001 weight: 0.01
[6 / 10] Loss: 4.400860228694086 CE Loss: 0.12791448703400163 Con Loss: 4.399581083083939
[6 / 10] tensor([[0.828, 0.952],
        [0.966, 0.863]]) {'epoch': 6, 'valid/acc': 95.115, 'valid/acc_unbiased': 96.056, 'valid/diff': 3.063, 'valid/acc_skew': 97.588, 'valid/acc_align': 94.525, 'test/acc': 89.968, 'test/acc_unbiased': 90.199, 'test/diff': 11.346, 'test/acc_skew': 89.689, 'test/acc_align': 90.709}
[6 / 10] best valid accuracy: 96.056 at epoch 6 
 best_stats: {'best_valid_epoch': 6, 'best_valid_valid/acc': 95.115, 'best_valid_valid/acc_unbiased': 96.056, 'best_valid_valid/diff': 3.063, 'best_valid_valid/acc_skew': 97.588, 'best_valid_valid/acc_align': 94.525, 'best_valid_test/acc': 89.968, 'best_valid_test/acc_unbiased': 90.199, 'best_valid_test/diff': 11.346, 'best_valid_test/acc_skew': 89.689, 'best_valid_test/acc_align': 90.709}
[6 / 10] best test accuracy: 90.808 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 94.637, 'best_test_valid/acc_unbiased': 95.643, 'best_test_valid/diff': 2.757, 'best_test_valid/acc_skew': 97.022, 'best_test_valid/acc_align': 94.265, 'best_test_test/acc': 90.311, 'best_test_test/acc_unbiased': 90.808, 'best_test_test/diff': 9.521, 'best_test_test/acc_skew': 90.421, 'best_test_test/acc_align': 91.195}
[7 / 10] Learning rate: 1e-05 weight: 0.01
[7 / 10] Loss: 4.383327236373458 CE Loss: 0.12290812068044822 Con Loss: 4.38209815991307
[7 / 10] tensor([[0.829, 0.955],
        [0.969, 0.857]]) {'epoch': 7, 'valid/acc': 95.539, 'valid/acc_unbiased': 96.57, 'valid/diff': 3.07, 'valid/acc_skew': 98.105, 'valid/acc_align': 95.035, 'test/acc': 90.18, 'test/acc_unbiased': 90.248, 'test/diff': 11.899, 'test/acc_skew': 89.91, 'test/acc_align': 90.586}
[7 / 10] best valid accuracy: 96.570 at epoch 7 
 best_stats: {'best_valid_epoch': 7, 'best_valid_valid/acc': 95.539, 'best_valid_valid/acc_unbiased': 96.57, 'best_valid_valid/diff': 3.07, 'best_valid_valid/acc_skew': 98.105, 'best_valid_valid/acc_align': 95.035, 'best_valid_test/acc': 90.18, 'best_valid_test/acc_unbiased': 90.248, 'best_valid_test/diff': 11.899, 'best_valid_test/acc_skew': 89.91, 'best_valid_test/acc_align': 90.586}
[7 / 10] best test accuracy: 90.808 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 94.637, 'best_test_valid/acc_unbiased': 95.643, 'best_test_valid/diff': 2.757, 'best_test_valid/acc_skew': 97.022, 'best_test_valid/acc_align': 94.265, 'best_test_test/acc': 90.311, 'best_test_test/acc_unbiased': 90.808, 'best_test_test/diff': 9.521, 'best_test_test/acc_skew': 90.421, 'best_test_test/acc_align': 91.195}
[8 / 10] Learning rate: 1e-05 weight: 0.01
[8 / 10] Loss: 4.378726216134617 CE Loss: 0.1198340069108715 Con Loss: 4.377527874340975
[8 / 10] tensor([[0.810, 0.949],
        [0.975, 0.879]]) {'epoch': 8, 'valid/acc': 95.319, 'valid/acc_unbiased': 96.579, 'valid/diff': 2.754, 'valid/acc_skew': 97.956, 'valid/acc_align': 95.202, 'test/acc': 89.279, 'test/acc_unbiased': 90.355, 'test/diff': 11.768, 'test/acc_skew': 89.28, 'test/acc_align': 91.431}
[8 / 10] best valid accuracy: 96.579 at epoch 8 
 best_stats: {'best_valid_epoch': 8, 'best_valid_valid/acc': 95.319, 'best_valid_valid/acc_unbiased': 96.579, 'best_valid_valid/diff': 2.754, 'best_valid_valid/acc_skew': 97.956, 'best_valid_valid/acc_align': 95.202, 'best_valid_test/acc': 89.279, 'best_valid_test/acc_unbiased': 90.355, 'best_valid_test/diff': 11.768, 'best_valid_test/acc_skew': 89.28, 'best_valid_test/acc_align': 91.431}
[8 / 10] best test accuracy: 90.808 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 94.637, 'best_test_valid/acc_unbiased': 95.643, 'best_test_valid/diff': 2.757, 'best_test_valid/acc_skew': 97.022, 'best_test_valid/acc_align': 94.265, 'best_test_test/acc': 90.311, 'best_test_test/acc_unbiased': 90.808, 'best_test_test/diff': 9.521, 'best_test_test/acc_skew': 90.421, 'best_test_test/acc_align': 91.195}
[9 / 10] Learning rate: 1e-05 weight: 0.01
[9 / 10] Loss: 4.3704611887115625 CE Loss: 0.11727292640933068 Con Loss: 4.369288455975259
[9 / 10] tensor([[0.807, 0.950],
        [0.975, 0.863]]) {'epoch': 9, 'valid/acc': 95.335, 'valid/acc_unbiased': 96.715, 'valid/diff': 2.334, 'valid/acc_skew': 97.882, 'valid/acc_align': 95.548, 'test/acc': 89.163, 'test/acc_unbiased': 89.88, 'test/diff': 12.769, 'test/acc_skew': 89.111, 'test/acc_align': 90.649}
[9 / 10] best valid accuracy: 96.715 at epoch 9 
 best_stats: {'best_valid_epoch': 9, 'best_valid_valid/acc': 95.335, 'best_valid_valid/acc_unbiased': 96.715, 'best_valid_valid/diff': 2.334, 'best_valid_valid/acc_skew': 97.882, 'best_valid_valid/acc_align': 95.548, 'best_valid_test/acc': 89.163, 'best_valid_test/acc_unbiased': 89.88, 'best_valid_test/diff': 12.769, 'best_valid_test/acc_skew': 89.111, 'best_valid_test/acc_align': 90.649}
[9 / 10] best test accuracy: 90.808 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 94.637, 'best_test_valid/acc_unbiased': 95.643, 'best_test_valid/diff': 2.757, 'best_test_valid/acc_skew': 97.022, 'best_test_valid/acc_align': 94.265, 'best_test_test/acc': 90.311, 'best_test_test/acc_unbiased': 90.808, 'best_test_test/diff': 9.521, 'best_test_test/acc_skew': 90.421, 'best_test_test/acc_align': 91.195}
[10 / 10] Learning rate: 1e-05 weight: 0.01
[10 / 10] Loss: 4.369771731705535 CE Loss: 0.11777382596492812 Con Loss: 4.368593996926491
[10 / 10] tensor([[0.815, 0.957],
        [0.973, 0.852]]) {'epoch': 10, 'valid/acc': 95.711, 'valid/acc_unbiased': 96.851, 'valid/diff': 2.382, 'valid/acc_skew': 98.042, 'valid/acc_align': 95.66, 'test/acc': 89.737, 'test/acc_unbiased': 89.921, 'test/diff': 13.154, 'test/acc_skew': 89.422, 'test/acc_align': 90.42}
[10 / 10] best valid accuracy: 96.851 at epoch 10 
 best_stats: {'best_valid_epoch': 10, 'best_valid_valid/acc': 95.711, 'best_valid_valid/acc_unbiased': 96.851, 'best_valid_valid/diff': 2.382, 'best_valid_valid/acc_skew': 98.042, 'best_valid_valid/acc_align': 95.66, 'best_valid_test/acc': 89.737, 'best_valid_test/acc_unbiased': 89.921, 'best_valid_test/diff': 13.154, 'best_valid_test/acc_skew': 89.422, 'best_valid_test/acc_align': 90.42}
[10 / 10] best test accuracy: 90.808 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 94.637, 'best_test_valid/acc_unbiased': 95.643, 'best_test_valid/diff': 2.757, 'best_test_valid/acc_skew': 97.022, 'best_test_valid/acc_align': 94.265, 'best_test_test/acc': 90.311, 'best_test_test/acc_unbiased': 90.808, 'best_test_test/diff': 9.521, 'best_test_test/acc_skew': 90.421, 'best_test_test/acc_align': 91.195}
Total training time: 2:19:09
