Log level set to: INFO
Set seed: 3
=======> Using Fixed Random Seed: 3 <========
save_path: exp_results/bc-bb0-utk_face_age-color-0.9-lr0.001-bs128-cbs64-w0.01-ratio10-aug1-seed3
get_utk_face - split: train, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_age-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
Binary Target 1
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Normal Label Distribution: 
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
Binary Target 1
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Normal Label Distribution: 
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 10684, target_attr: gender, bias_attr: age bias_rate: 0.9
['[train] target_0-bias_0: 8237', '[train] target_0-bias_1: 147', '[train] target_1-bias_0: 823', '[train] target_1-bias_1: 1477']
confusion_matrix - 
 original: tensor([[8237.,  823.],
        [ 147., 1477.]]), 
 normalized: tensor([[0.909, 0.091],
        [0.091, 0.909]]), 
 b|y: tensor([[0.982, 0.018],
        [0.358, 0.642]])
get_utk_face - split: train, aug: 1, given_y: True, ratio: 10
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_age-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
Binary Target 1
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Normal Label Distribution: 
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
Binary Target 1
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Normal Label Distribution: 
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 10684, target_attr: gender, bias_attr: age bias_rate: 0.9
['[train] target_0-bias_0: 8237', '[train] target_0-bias_1: 147', '[train] target_1-bias_0: 823', '[train] target_1-bias_1: 1477']
get_utk_face - split: valid, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_age-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [1030, 195]
Target 1: [841, 202]
Binary Target 1
---------------------------
Target 0: [1030, 195]
Target 1: [841, 202]
===================================
Normal Label Distribution: 
Target 0: [1030, 195]
Target 1: [841, 202]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 2268, target_attr: gender, bias_attr: age bias_rate: 0.9
['[valid] target_0-bias_0: 1030', '[valid] target_0-bias_1: 195', '[valid] target_1-bias_0: 841', '[valid] target_1-bias_1: 202']
get_utk_face - split: test, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_age-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [1061, 176]
Target 1: [867, 165]
Binary Target 1
---------------------------
Target 0: [1061, 176]
Target 1: [867, 165]
===================================
Normal Label Distribution: 
Target 0: [1061, 176]
Target 1: [867, 165]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 2269, target_attr: gender, bias_attr: age bias_rate: 0.9
['[test] target_0-bias_0: 1061', '[test] target_0-bias_1: 176', '[test] target_1-bias_0: 867', '[test] target_1-bias_1: 165']
decay_epochs: [6, 13]
[1 / 20] Learning rate: 0.001 weight: 0.01
[1 / 20] Loss: 4.744839512958191 CE Loss: 0.5580367123263912 Con Loss: 4.739259151071701
[1 / 20] tensor([[0.954, 0.812],
        [0.457, 0.376]]) {'epoch': 1, 'valid/acc': 70.37, 'valid/acc_unbiased': 63.532, 'valid/diff': 14.94, 'valid/acc_skew': 62.417, 'valid/acc_align': 64.647, 'test/acc': 71.089, 'test/acc_unbiased': 64.971, 'test/diff': 11.115, 'test/acc_skew': 63.462, 'test/acc_align': 66.479}
[1 / 20] best valid accuracy: 63.532 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 70.37, 'best_valid_valid/acc_unbiased': 63.532, 'best_valid_valid/diff': 14.94, 'best_valid_valid/acc_skew': 62.417, 'best_valid_valid/acc_align': 64.647, 'best_valid_test/acc': 71.089, 'best_valid_test/acc_unbiased': 64.971, 'best_valid_test/diff': 11.115, 'best_valid_test/acc_skew': 63.462, 'best_valid_test/acc_align': 66.479}
[1 / 20] best test accuracy: 64.971 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 70.37, 'best_test_valid/acc_unbiased': 63.532, 'best_test_valid/diff': 14.94, 'best_test_valid/acc_skew': 62.417, 'best_test_valid/acc_align': 64.647, 'best_test_test/acc': 71.089, 'best_test_test/acc_unbiased': 64.971, 'best_test_test/diff': 11.115, 'best_test_test/acc_skew': 63.462, 'best_test_test/acc_align': 66.479}
[2 / 20] Learning rate: 0.001 weight: 0.01
[2 / 20] Loss: 4.521842737672749 CE Loss: 0.5129935240218899 Con Loss: 4.516712785704401
[2 / 20] tensor([[0.987, 0.920],
        [0.276, 0.255]]) {'epoch': 2, 'valid/acc': 64.242, 'valid/acc_unbiased': 59.119, 'valid/diff': 6.801, 'valid/acc_skew': 56.788, 'valid/acc_align': 61.449, 'test/acc': 65.668, 'test/acc_unbiased': 60.937, 'test/diff': 4.373, 'test/acc_skew': 59.806, 'test/acc_align': 62.068}
[2 / 20] best valid accuracy: 63.532 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 70.37, 'best_valid_valid/acc_unbiased': 63.532, 'best_valid_valid/diff': 14.94, 'best_valid_valid/acc_skew': 62.417, 'best_valid_valid/acc_align': 64.647, 'best_valid_test/acc': 71.089, 'best_valid_test/acc_unbiased': 64.971, 'best_valid_test/diff': 11.115, 'best_valid_test/acc_skew': 63.462, 'best_valid_test/acc_align': 66.479}
[2 / 20] best test accuracy: 64.971 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 70.37, 'best_test_valid/acc_unbiased': 63.532, 'best_test_valid/diff': 14.94, 'best_test_valid/acc_skew': 62.417, 'best_test_valid/acc_align': 64.647, 'best_test_test/acc': 71.089, 'best_test_test/acc_unbiased': 64.971, 'best_test_test/diff': 11.115, 'best_test_test/acc_skew': 63.462, 'best_test_test/acc_align': 66.479}
[3 / 20] Learning rate: 0.001 weight: 0.01
[3 / 20] Loss: 4.304068239205609 CE Loss: 0.4878184482851353 Con Loss: 4.299190073502461
[3 / 20] tensor([[0.989, 0.778],
        [0.352, 0.418]]) {'epoch': 3, 'valid/acc': 67.108, 'valid/acc_unbiased': 63.016, 'valid/diff': 18.348, 'valid/acc_skew': 53.841, 'valid/acc_align': 72.19, 'test/acc': 68.753, 'test/acc_unbiased': 63.427, 'test/diff': 13.834, 'test/acc_skew': 56.51, 'test/acc_align': 70.344}
[3 / 20] best valid accuracy: 63.532 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 70.37, 'best_valid_valid/acc_unbiased': 63.532, 'best_valid_valid/diff': 14.94, 'best_valid_valid/acc_skew': 62.417, 'best_valid_valid/acc_align': 64.647, 'best_valid_test/acc': 71.089, 'best_valid_test/acc_unbiased': 64.971, 'best_valid_test/diff': 11.115, 'best_valid_test/acc_skew': 63.462, 'best_valid_test/acc_align': 66.479}
[3 / 20] best test accuracy: 64.971 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 70.37, 'best_test_valid/acc_unbiased': 63.532, 'best_test_valid/diff': 14.94, 'best_test_valid/acc_skew': 62.417, 'best_test_valid/acc_align': 64.647, 'best_test_test/acc': 71.089, 'best_test_test/acc_unbiased': 64.971, 'best_test_test/diff': 11.115, 'best_test_test/acc_skew': 63.462, 'best_test_test/acc_align': 66.479}
[4 / 20] Learning rate: 0.001 weight: 0.01
[4 / 20] Loss: 4.213934796439356 CE Loss: 0.467580713925849 Con Loss: 4.209258973754689
[4 / 20] tensor([[0.958, 0.511],
        [0.632, 0.752]]) {'epoch': 4, 'valid/acc': 76.014, 'valid/acc_unbiased': 68.822, 'valid/diff': 30.885, 'valid/acc_skew': 53.379, 'valid/acc_align': 84.265, 'test/acc': 78.361, 'test/acc_unbiased': 71.313, 'test/diff': 28.284, 'test/acc_skew': 57.171, 'test/acc_align': 85.455}
[4 / 20] best valid accuracy: 68.822 at epoch 4 
 best_stats: {'best_valid_epoch': 4, 'best_valid_valid/acc': 76.014, 'best_valid_valid/acc_unbiased': 68.822, 'best_valid_valid/diff': 30.885, 'best_valid_valid/acc_skew': 53.379, 'best_valid_valid/acc_align': 84.265, 'best_valid_test/acc': 78.361, 'best_valid_test/acc_unbiased': 71.313, 'best_valid_test/diff': 28.284, 'best_valid_test/acc_skew': 57.171, 'best_valid_test/acc_align': 85.455}
[4 / 20] best test accuracy: 71.313 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 76.014, 'best_test_valid/acc_unbiased': 68.822, 'best_test_valid/diff': 30.885, 'best_test_valid/acc_skew': 53.379, 'best_test_valid/acc_align': 84.265, 'best_test_test/acc': 78.361, 'best_test_test/acc_unbiased': 71.313, 'best_test_test/diff': 28.284, 'best_test_test/acc_skew': 57.171, 'best_test_test/acc_align': 85.455}
[5 / 20] Learning rate: 0.001 weight: 0.01
[5 / 20] Loss: 4.169597454171019 CE Loss: 0.4563204813588206 Con Loss: 4.165034251729008
[5 / 20] tensor([[0.917, 0.705],
        [0.693, 0.648]]) {'epoch': 5, 'valid/acc': 77.16, 'valid/acc_unbiased': 70.035, 'valid/diff': 18.295, 'valid/acc_skew': 61.042, 'valid/acc_align': 79.028, 'test/acc': 79.55, 'test/acc_unbiased': 74.082, 'test/diff': 12.861, 'test/acc_skew': 69.887, 'test/acc_align': 78.277}
[5 / 20] best valid accuracy: 70.035 at epoch 5 
 best_stats: {'best_valid_epoch': 5, 'best_valid_valid/acc': 77.16, 'best_valid_valid/acc_unbiased': 70.035, 'best_valid_valid/diff': 18.295, 'best_valid_valid/acc_skew': 61.042, 'best_valid_valid/acc_align': 79.028, 'best_valid_test/acc': 79.55, 'best_valid_test/acc_unbiased': 74.082, 'best_valid_test/diff': 12.861, 'best_valid_test/acc_skew': 69.887, 'best_valid_test/acc_align': 78.277}
[5 / 20] best test accuracy: 74.082 at epoch 5 
 best_stats: {'best_test_epoch': 5, 'best_test_valid/acc': 77.16, 'best_test_valid/acc_unbiased': 70.035, 'best_test_valid/diff': 18.295, 'best_test_valid/acc_skew': 61.042, 'best_test_valid/acc_align': 79.028, 'best_test_test/acc': 79.55, 'best_test_test/acc_unbiased': 74.082, 'best_test_test/diff': 12.861, 'best_test_test/acc_skew': 69.887, 'best_test_test/acc_align': 78.277}
[6 / 20] Learning rate: 0.001 weight: 0.01
[6 / 20] Loss: 4.098040913874985 CE Loss: 0.41924651426262105 Con Loss: 4.09384844036238
[6 / 20] tensor([[0.937, 0.528],
        [0.740, 0.715]]) {'epoch': 6, 'valid/acc': 78.439, 'valid/acc_unbiased': 70.45, 'valid/diff': 23.097, 'valid/acc_skew': 58.901, 'valid/acc_align': 81.998, 'test/acc': 81.401, 'test/acc_unbiased': 73.022, 'test/diff': 21.689, 'test/acc_skew': 63.445, 'test/acc_align': 82.6}
[6 / 20] best valid accuracy: 70.450 at epoch 6 
 best_stats: {'best_valid_epoch': 6, 'best_valid_valid/acc': 78.439, 'best_valid_valid/acc_unbiased': 70.45, 'best_valid_valid/diff': 23.097, 'best_valid_valid/acc_skew': 58.901, 'best_valid_valid/acc_align': 81.998, 'best_valid_test/acc': 81.401, 'best_valid_test/acc_unbiased': 73.022, 'best_valid_test/diff': 21.689, 'best_valid_test/acc_skew': 63.445, 'best_valid_test/acc_align': 82.6}
[6 / 20] best test accuracy: 74.082 at epoch 5 
 best_stats: {'best_test_epoch': 5, 'best_test_valid/acc': 77.16, 'best_test_valid/acc_unbiased': 70.035, 'best_test_valid/diff': 18.295, 'best_test_valid/acc_skew': 61.042, 'best_test_valid/acc_align': 79.028, 'best_test_test/acc': 79.55, 'best_test_test/acc_unbiased': 74.082, 'best_test_test/diff': 12.861, 'best_test_test/acc_skew': 69.887, 'best_test_test/acc_align': 78.277}
[7 / 20] Learning rate: 0.0001 weight: 0.01
[7 / 20] Loss: 3.931809437939934 CE Loss: 0.38398174230233867 Con Loss: 3.9279696144266816
[7 / 20] tensor([[0.968, 0.494],
        [0.637, 0.770]]) {'epoch': 7, 'valid/acc': 77.072, 'valid/acc_unbiased': 69.741, 'valid/diff': 33.638, 'valid/acc_skew': 52.922, 'valid/acc_align': 86.561, 'test/acc': 79.022, 'test/acc_unbiased': 71.716, 'test/diff': 30.333, 'test/acc_skew': 56.55, 'test/acc_align': 86.883}
[7 / 20] best valid accuracy: 70.450 at epoch 6 
 best_stats: {'best_valid_epoch': 6, 'best_valid_valid/acc': 78.439, 'best_valid_valid/acc_unbiased': 70.45, 'best_valid_valid/diff': 23.097, 'best_valid_valid/acc_skew': 58.901, 'best_valid_valid/acc_align': 81.998, 'best_valid_test/acc': 81.401, 'best_valid_test/acc_unbiased': 73.022, 'best_valid_test/diff': 21.689, 'best_valid_test/acc_skew': 63.445, 'best_valid_test/acc_align': 82.6}
[7 / 20] best test accuracy: 74.082 at epoch 5 
 best_stats: {'best_test_epoch': 5, 'best_test_valid/acc': 77.16, 'best_test_valid/acc_unbiased': 70.035, 'best_test_valid/diff': 18.295, 'best_test_valid/acc_skew': 61.042, 'best_test_valid/acc_align': 79.028, 'best_test_test/acc': 79.55, 'best_test_test/acc_unbiased': 74.082, 'best_test_test/diff': 12.861, 'best_test_test/acc_skew': 69.887, 'best_test_test/acc_align': 78.277}
[8 / 20] Learning rate: 0.0001 weight: 0.01
[8 / 20] Loss: 3.8542731148345957 CE Loss: 0.3469653688245657 Con Loss: 3.850803463434914
[8 / 20] tensor([[0.978, 0.545],
        [0.581, 0.733]]) {'epoch': 8, 'valid/acc': 76.323, 'valid/acc_unbiased': 69.518, 'valid/diff': 30.999, 'valid/acc_skew': 54.019, 'valid/acc_align': 85.017, 'test/acc': 77.523, 'test/acc_unbiased': 70.961, 'test/diff': 29.244, 'test/acc_skew': 56.338, 'test/acc_align': 85.583}
[8 / 20] best valid accuracy: 70.450 at epoch 6 
 best_stats: {'best_valid_epoch': 6, 'best_valid_valid/acc': 78.439, 'best_valid_valid/acc_unbiased': 70.45, 'best_valid_valid/diff': 23.097, 'best_valid_valid/acc_skew': 58.901, 'best_valid_valid/acc_align': 81.998, 'best_valid_test/acc': 81.401, 'best_valid_test/acc_unbiased': 73.022, 'best_valid_test/diff': 21.689, 'best_valid_test/acc_skew': 63.445, 'best_valid_test/acc_align': 82.6}
[8 / 20] best test accuracy: 74.082 at epoch 5 
 best_stats: {'best_test_epoch': 5, 'best_test_valid/acc': 77.16, 'best_test_valid/acc_unbiased': 70.035, 'best_test_valid/diff': 18.295, 'best_test_valid/acc_skew': 61.042, 'best_test_valid/acc_align': 79.028, 'best_test_test/acc': 79.55, 'best_test_test/acc_unbiased': 74.082, 'best_test_test/diff': 12.861, 'best_test_test/acc_skew': 69.887, 'best_test_test/acc_align': 78.277}
[9 / 20] Learning rate: 0.0001 weight: 0.01
[9 / 20] Loss: 3.7928370300280116 CE Loss: 0.3442295331581841 Con Loss: 3.7893947323178225
[9 / 20] tensor([[0.976, 0.494],
        [0.595, 0.764]]) {'epoch': 9, 'valid/acc': 76.058, 'valid/acc_unbiased': 68.704, 'valid/diff': 37.576, 'valid/acc_skew': 49.916, 'valid/acc_align': 87.493, 'test/acc': 77.788, 'test/acc_unbiased': 70.739, 'test/diff': 32.53, 'test/acc_skew': 54.474, 'test/acc_align': 87.004}
[9 / 20] best valid accuracy: 70.450 at epoch 6 
 best_stats: {'best_valid_epoch': 6, 'best_valid_valid/acc': 78.439, 'best_valid_valid/acc_unbiased': 70.45, 'best_valid_valid/diff': 23.097, 'best_valid_valid/acc_skew': 58.901, 'best_valid_valid/acc_align': 81.998, 'best_valid_test/acc': 81.401, 'best_valid_test/acc_unbiased': 73.022, 'best_valid_test/diff': 21.689, 'best_valid_test/acc_skew': 63.445, 'best_valid_test/acc_align': 82.6}
[9 / 20] best test accuracy: 74.082 at epoch 5 
 best_stats: {'best_test_epoch': 5, 'best_test_valid/acc': 77.16, 'best_test_valid/acc_unbiased': 70.035, 'best_test_valid/diff': 18.295, 'best_test_valid/acc_skew': 61.042, 'best_test_valid/acc_align': 79.028, 'best_test_test/acc': 79.55, 'best_test_test/acc_unbiased': 74.082, 'best_test_test/diff': 12.861, 'best_test_test/acc_skew': 69.887, 'best_test_test/acc_align': 78.277}
[10 / 20] Learning rate: 0.0001 weight: 0.01
[10 / 20] Loss: 3.7731980759746704 CE Loss: 0.33222983337350215 Con Loss: 3.7698757829669707
[10 / 20] tensor([[0.977, 0.466],
        [0.570, 0.782]]) {'epoch': 10, 'valid/acc': 75.309, 'valid/acc_unbiased': 68.959, 'valid/diff': 39.639, 'valid/acc_skew': 49.14, 'valid/acc_align': 88.779, 'test/acc': 76.774, 'test/acc_unbiased': 69.872, 'test/diff': 36.175, 'test/acc_skew': 51.784, 'test/acc_align': 87.96}
[10 / 20] best valid accuracy: 70.450 at epoch 6 
 best_stats: {'best_valid_epoch': 6, 'best_valid_valid/acc': 78.439, 'best_valid_valid/acc_unbiased': 70.45, 'best_valid_valid/diff': 23.097, 'best_valid_valid/acc_skew': 58.901, 'best_valid_valid/acc_align': 81.998, 'best_valid_test/acc': 81.401, 'best_valid_test/acc_unbiased': 73.022, 'best_valid_test/diff': 21.689, 'best_valid_test/acc_skew': 63.445, 'best_valid_test/acc_align': 82.6}
[10 / 20] best test accuracy: 74.082 at epoch 5 
 best_stats: {'best_test_epoch': 5, 'best_test_valid/acc': 77.16, 'best_test_valid/acc_unbiased': 70.035, 'best_test_valid/diff': 18.295, 'best_test_valid/acc_skew': 61.042, 'best_test_valid/acc_align': 79.028, 'best_test_test/acc': 79.55, 'best_test_test/acc_unbiased': 74.082, 'best_test_test/diff': 12.861, 'best_test_test/acc_skew': 69.887, 'best_test_test/acc_align': 78.277}
[11 / 20] Learning rate: 0.0001 weight: 0.01
[11 / 20] Loss: 3.717617380355726 CE Loss: 0.3311697491899674 Con Loss: 3.714305692110022
[11 / 20] tensor([[0.974, 0.517],
        [0.593, 0.770]]) {'epoch': 11, 'valid/acc': 76.808, 'valid/acc_unbiased': 69.885, 'valid/diff': 36.303, 'valid/acc_skew': 51.733, 'valid/acc_align': 88.036, 'test/acc': 77.788, 'test/acc_unbiased': 71.33, 'test/diff': 31.671, 'test/acc_skew': 55.495, 'test/acc_align': 87.165}
[11 / 20] best valid accuracy: 70.450 at epoch 6 
 best_stats: {'best_valid_epoch': 6, 'best_valid_valid/acc': 78.439, 'best_valid_valid/acc_unbiased': 70.45, 'best_valid_valid/diff': 23.097, 'best_valid_valid/acc_skew': 58.901, 'best_valid_valid/acc_align': 81.998, 'best_valid_test/acc': 81.401, 'best_valid_test/acc_unbiased': 73.022, 'best_valid_test/diff': 21.689, 'best_valid_test/acc_skew': 63.445, 'best_valid_test/acc_align': 82.6}
[11 / 20] best test accuracy: 74.082 at epoch 5 
 best_stats: {'best_test_epoch': 5, 'best_test_valid/acc': 77.16, 'best_test_valid/acc_unbiased': 70.035, 'best_test_valid/diff': 18.295, 'best_test_valid/acc_skew': 61.042, 'best_test_valid/acc_align': 79.028, 'best_test_test/acc': 79.55, 'best_test_test/acc_unbiased': 74.082, 'best_test_test/diff': 12.861, 'best_test_test/acc_skew': 69.887, 'best_test_test/acc_align': 78.277}
[12 / 20] Learning rate: 0.0001 weight: 0.01
[12 / 20] Loss: 3.6604884357231025 CE Loss: 0.3212460384235896 Con Loss: 3.657275978611097
[12 / 20] tensor([[0.965, 0.455],
        [0.638, 0.848]]) {'epoch': 12, 'valid/acc': 78.263, 'valid/acc_unbiased': 71.037, 'valid/diff': 39.454, 'valid/acc_skew': 51.309, 'valid/acc_align': 90.764, 'test/acc': 79.198, 'test/acc_unbiased': 72.65, 'test/diff': 36.062, 'test/acc_skew': 54.619, 'test/acc_align': 90.681}
[12 / 20] best valid accuracy: 71.037 at epoch 12 
 best_stats: {'best_valid_epoch': 12, 'best_valid_valid/acc': 78.263, 'best_valid_valid/acc_unbiased': 71.037, 'best_valid_valid/diff': 39.454, 'best_valid_valid/acc_skew': 51.309, 'best_valid_valid/acc_align': 90.764, 'best_valid_test/acc': 79.198, 'best_valid_test/acc_unbiased': 72.65, 'best_valid_test/diff': 36.062, 'best_valid_test/acc_skew': 54.619, 'best_valid_test/acc_align': 90.681}
[12 / 20] best test accuracy: 74.082 at epoch 5 
 best_stats: {'best_test_epoch': 5, 'best_test_valid/acc': 77.16, 'best_test_valid/acc_unbiased': 70.035, 'best_test_valid/diff': 18.295, 'best_test_valid/acc_skew': 61.042, 'best_test_valid/acc_align': 79.028, 'best_test_test/acc': 79.55, 'best_test_test/acc_unbiased': 74.082, 'best_test_test/diff': 12.861, 'best_test_test/acc_skew': 69.887, 'best_test_test/acc_align': 78.277}
[13 / 20] Learning rate: 0.0001 weight: 0.01
[13 / 20] Loss: 3.693376702612502 CE Loss: 0.3344271444328177 Con Loss: 3.6900324387659253
[13 / 20] tensor([[0.975, 0.511],
        [0.535, 0.770]]) {'epoch': 13, 'valid/acc': 74.383, 'valid/acc_unbiased': 68.323, 'valid/diff': 40.708, 'valid/acc_skew': 47.969, 'valid/acc_align': 88.677, 'test/acc': 75.584, 'test/acc_unbiased': 69.77, 'test/diff': 34.885, 'test/acc_skew': 52.327, 'test/acc_align': 87.212}
[13 / 20] best valid accuracy: 71.037 at epoch 12 
 best_stats: {'best_valid_epoch': 12, 'best_valid_valid/acc': 78.263, 'best_valid_valid/acc_unbiased': 71.037, 'best_valid_valid/diff': 39.454, 'best_valid_valid/acc_skew': 51.309, 'best_valid_valid/acc_align': 90.764, 'best_valid_test/acc': 79.198, 'best_valid_test/acc_unbiased': 72.65, 'best_valid_test/diff': 36.062, 'best_valid_test/acc_skew': 54.619, 'best_valid_test/acc_align': 90.681}
[13 / 20] best test accuracy: 74.082 at epoch 5 
 best_stats: {'best_test_epoch': 5, 'best_test_valid/acc': 77.16, 'best_test_valid/acc_unbiased': 70.035, 'best_test_valid/diff': 18.295, 'best_test_valid/acc_skew': 61.042, 'best_test_valid/acc_align': 79.028, 'best_test_test/acc': 79.55, 'best_test_test/acc_unbiased': 74.082, 'best_test_test/diff': 12.861, 'best_test_test/acc_skew': 69.887, 'best_test_test/acc_align': 78.277}
[14 / 20] Learning rate: 1e-05 weight: 0.01
[14 / 20] Loss: 3.6605848935783154 CE Loss: 0.32455539313964027 Con Loss: 3.6573393427892733
[14 / 20] tensor([[0.974, 0.460],
        [0.557, 0.794]]) {'epoch': 14, 'valid/acc': 75.353, 'valid/acc_unbiased': 68.502, 'valid/diff': 40.456, 'valid/acc_skew': 48.274, 'valid/acc_align': 88.73, 'test/acc': 76.157, 'test/acc_unbiased': 69.622, 'test/diff': 37.511, 'test/acc_skew': 50.866, 'test/acc_align': 88.377}
[14 / 20] best valid accuracy: 71.037 at epoch 12 
 best_stats: {'best_valid_epoch': 12, 'best_valid_valid/acc': 78.263, 'best_valid_valid/acc_unbiased': 71.037, 'best_valid_valid/diff': 39.454, 'best_valid_valid/acc_skew': 51.309, 'best_valid_valid/acc_align': 90.764, 'best_valid_test/acc': 79.198, 'best_valid_test/acc_unbiased': 72.65, 'best_valid_test/diff': 36.062, 'best_valid_test/acc_skew': 54.619, 'best_valid_test/acc_align': 90.681}
[14 / 20] best test accuracy: 74.082 at epoch 5 
 best_stats: {'best_test_epoch': 5, 'best_test_valid/acc': 77.16, 'best_test_valid/acc_unbiased': 70.035, 'best_test_valid/diff': 18.295, 'best_test_valid/acc_skew': 61.042, 'best_test_valid/acc_align': 79.028, 'best_test_test/acc': 79.55, 'best_test_test/acc_unbiased': 74.082, 'best_test_test/diff': 12.861, 'best_test_test/acc_skew': 69.887, 'best_test_test/acc_align': 78.277}
[15 / 20] Learning rate: 1e-05 weight: 0.01
[15 / 20] Loss: 3.6395136370100096 CE Loss: 0.3235633054037569 Con Loss: 3.6362779992923717
[15 / 20] tensor([[0.967, 0.449],
        [0.603, 0.830]]) {'epoch': 15, 'valid/acc': 76.808, 'valid/acc_unbiased': 69.573, 'valid/diff': 41.789, 'valid/acc_skew': 48.679, 'valid/acc_align': 90.468, 'test/acc': 77.788, 'test/acc_unbiased': 71.235, 'test/diff': 37.261, 'test/acc_skew': 52.605, 'test/acc_align': 89.866}
[15 / 20] best valid accuracy: 71.037 at epoch 12 
 best_stats: {'best_valid_epoch': 12, 'best_valid_valid/acc': 78.263, 'best_valid_valid/acc_unbiased': 71.037, 'best_valid_valid/diff': 39.454, 'best_valid_valid/acc_skew': 51.309, 'best_valid_valid/acc_align': 90.764, 'best_valid_test/acc': 79.198, 'best_valid_test/acc_unbiased': 72.65, 'best_valid_test/diff': 36.062, 'best_valid_test/acc_skew': 54.619, 'best_valid_test/acc_align': 90.681}
[15 / 20] best test accuracy: 74.082 at epoch 5 
 best_stats: {'best_test_epoch': 5, 'best_test_valid/acc': 77.16, 'best_test_valid/acc_unbiased': 70.035, 'best_test_valid/diff': 18.295, 'best_test_valid/acc_skew': 61.042, 'best_test_valid/acc_align': 79.028, 'best_test_test/acc': 79.55, 'best_test_test/acc_unbiased': 74.082, 'best_test_test/diff': 12.861, 'best_test_test/acc_skew': 69.887, 'best_test_test/acc_align': 78.277}
[16 / 20] Learning rate: 1e-05 weight: 0.01
[16 / 20] Loss: 3.6807711029802532 CE Loss: 0.3177416154069429 Con Loss: 3.677593686972518
[16 / 20] tensor([[0.974, 0.477],
        [0.552, 0.788]]) {'epoch': 16, 'valid/acc': 74.956, 'valid/acc_unbiased': 68.33, 'valid/diff': 39.607, 'valid/acc_skew': 48.526, 'valid/acc_align': 88.133, 'test/acc': 76.069, 'test/acc_unbiased': 69.781, 'test/diff': 36.587, 'test/acc_skew': 51.488, 'test/acc_align': 88.074}
[16 / 20] best valid accuracy: 71.037 at epoch 12 
 best_stats: {'best_valid_epoch': 12, 'best_valid_valid/acc': 78.263, 'best_valid_valid/acc_unbiased': 71.037, 'best_valid_valid/diff': 39.454, 'best_valid_valid/acc_skew': 51.309, 'best_valid_valid/acc_align': 90.764, 'best_valid_test/acc': 79.198, 'best_valid_test/acc_unbiased': 72.65, 'best_valid_test/diff': 36.062, 'best_valid_test/acc_skew': 54.619, 'best_valid_test/acc_align': 90.681}
[16 / 20] best test accuracy: 74.082 at epoch 5 
 best_stats: {'best_test_epoch': 5, 'best_test_valid/acc': 77.16, 'best_test_valid/acc_unbiased': 70.035, 'best_test_valid/diff': 18.295, 'best_test_valid/acc_skew': 61.042, 'best_test_valid/acc_align': 79.028, 'best_test_test/acc': 79.55, 'best_test_test/acc_unbiased': 74.082, 'best_test_test/diff': 12.861, 'best_test_test/acc_skew': 69.887, 'best_test_test/acc_align': 78.277}
[17 / 20] Learning rate: 1e-05 weight: 0.01
[17 / 20] Loss: 3.5242298918687998 CE Loss: 0.32145735770408157 Con Loss: 3.5210153097876087
[17 / 20] tensor([[0.973, 0.466],
        [0.561, 0.812]]) {'epoch': 17, 'valid/acc': 74.78, 'valid/acc_unbiased': 68.114, 'valid/diff': 40.833, 'valid/acc_skew': 47.698, 'valid/acc_align': 88.531, 'test/acc': 76.421, 'test/acc_unbiased': 70.281, 'test/diff': 37.916, 'test/acc_skew': 51.323, 'test/acc_align': 89.239}
[17 / 20] best valid accuracy: 71.037 at epoch 12 
 best_stats: {'best_valid_epoch': 12, 'best_valid_valid/acc': 78.263, 'best_valid_valid/acc_unbiased': 71.037, 'best_valid_valid/diff': 39.454, 'best_valid_valid/acc_skew': 51.309, 'best_valid_valid/acc_align': 90.764, 'best_valid_test/acc': 79.198, 'best_valid_test/acc_unbiased': 72.65, 'best_valid_test/diff': 36.062, 'best_valid_test/acc_skew': 54.619, 'best_valid_test/acc_align': 90.681}
[17 / 20] best test accuracy: 74.082 at epoch 5 
 best_stats: {'best_test_epoch': 5, 'best_test_valid/acc': 77.16, 'best_test_valid/acc_unbiased': 70.035, 'best_test_valid/diff': 18.295, 'best_test_valid/acc_skew': 61.042, 'best_test_valid/acc_align': 79.028, 'best_test_test/acc': 79.55, 'best_test_test/acc_unbiased': 74.082, 'best_test_test/diff': 12.861, 'best_test_test/acc_skew': 69.887, 'best_test_test/acc_align': 78.277}
[18 / 20] Learning rate: 1e-05 weight: 0.01
[18 / 20] Loss: 3.683563126735766 CE Loss: 0.32100644968770853 Con Loss: 3.6803530657706482
[18 / 20] tensor([[0.970, 0.449],
        [0.580, 0.842]]) {'epoch': 18, 'valid/acc': 75.705, 'valid/acc_unbiased': 68.529, 'valid/diff': 41.887, 'valid/acc_skew': 47.586, 'valid/acc_align': 89.473, 'test/acc': 77.126, 'test/acc_unbiased': 71.032, 'test/diff': 39.162, 'test/acc_skew': 51.451, 'test/acc_align': 90.613}
[18 / 20] best valid accuracy: 71.037 at epoch 12 
 best_stats: {'best_valid_epoch': 12, 'best_valid_valid/acc': 78.263, 'best_valid_valid/acc_unbiased': 71.037, 'best_valid_valid/diff': 39.454, 'best_valid_valid/acc_skew': 51.309, 'best_valid_valid/acc_align': 90.764, 'best_valid_test/acc': 79.198, 'best_valid_test/acc_unbiased': 72.65, 'best_valid_test/diff': 36.062, 'best_valid_test/acc_skew': 54.619, 'best_valid_test/acc_align': 90.681}
[18 / 20] best test accuracy: 74.082 at epoch 5 
 best_stats: {'best_test_epoch': 5, 'best_test_valid/acc': 77.16, 'best_test_valid/acc_unbiased': 70.035, 'best_test_valid/diff': 18.295, 'best_test_valid/acc_skew': 61.042, 'best_test_valid/acc_align': 79.028, 'best_test_test/acc': 79.55, 'best_test_test/acc_unbiased': 74.082, 'best_test_test/diff': 12.861, 'best_test_test/acc_skew': 69.887, 'best_test_test/acc_align': 78.277}
[19 / 20] Learning rate: 1e-05 weight: 0.01
[19 / 20] Loss: 3.6502494035433046 CE Loss: 0.3166670842101091 Con Loss: 3.647082723958891
[19 / 20] tensor([[0.975, 0.477],
        [0.546, 0.800]]) {'epoch': 19, 'valid/acc': 74.471, 'valid/acc_unbiased': 68.106, 'valid/diff': 39.56, 'valid/acc_skew': 48.326, 'valid/acc_align': 87.886, 'test/acc': 75.981, 'test/acc_unbiased': 69.958, 'test/diff': 37.633, 'test/acc_skew': 51.142, 'test/acc_align': 88.775}
[19 / 20] best valid accuracy: 71.037 at epoch 12 
 best_stats: {'best_valid_epoch': 12, 'best_valid_valid/acc': 78.263, 'best_valid_valid/acc_unbiased': 71.037, 'best_valid_valid/diff': 39.454, 'best_valid_valid/acc_skew': 51.309, 'best_valid_valid/acc_align': 90.764, 'best_valid_test/acc': 79.198, 'best_valid_test/acc_unbiased': 72.65, 'best_valid_test/diff': 36.062, 'best_valid_test/acc_skew': 54.619, 'best_valid_test/acc_align': 90.681}
[19 / 20] best test accuracy: 74.082 at epoch 5 
 best_stats: {'best_test_epoch': 5, 'best_test_valid/acc': 77.16, 'best_test_valid/acc_unbiased': 70.035, 'best_test_valid/diff': 18.295, 'best_test_valid/acc_skew': 61.042, 'best_test_valid/acc_align': 79.028, 'best_test_test/acc': 79.55, 'best_test_test/acc_unbiased': 74.082, 'best_test_test/diff': 12.861, 'best_test_test/acc_skew': 69.887, 'best_test_test/acc_align': 78.277}
[20 / 20] Learning rate: 1e-05 weight: 0.01
[20 / 20] Loss: 3.6392290045018054 CE Loss: 0.306554205707288 Con Loss: 3.63616347393263
[20 / 20] tensor([[0.975, 0.472],
        [0.558, 0.806]]) {'epoch': 20, 'valid/acc': 75.088, 'valid/acc_unbiased': 68.504, 'valid/diff': 40.743, 'valid/acc_skew': 48.133, 'valid/acc_align': 88.876, 'test/acc': 76.421, 'test/acc_unbiased': 70.261, 'test/diff': 37.539, 'test/acc_skew': 51.492, 'test/acc_align': 89.031}
[20 / 20] best valid accuracy: 71.037 at epoch 12 
 best_stats: {'best_valid_epoch': 12, 'best_valid_valid/acc': 78.263, 'best_valid_valid/acc_unbiased': 71.037, 'best_valid_valid/diff': 39.454, 'best_valid_valid/acc_skew': 51.309, 'best_valid_valid/acc_align': 90.764, 'best_valid_test/acc': 79.198, 'best_valid_test/acc_unbiased': 72.65, 'best_valid_test/diff': 36.062, 'best_valid_test/acc_skew': 54.619, 'best_valid_test/acc_align': 90.681}
[20 / 20] best test accuracy: 74.082 at epoch 5 
 best_stats: {'best_test_epoch': 5, 'best_test_valid/acc': 77.16, 'best_test_valid/acc_unbiased': 70.035, 'best_test_valid/diff': 18.295, 'best_test_valid/acc_skew': 61.042, 'best_test_valid/acc_align': 79.028, 'best_test_test/acc': 79.55, 'best_test_test/acc_unbiased': 74.082, 'best_test_test/diff': 12.861, 'best_test_test/acc_skew': 69.887, 'best_test_test/acc_align': 78.277}
Total training time: 0:16:15
