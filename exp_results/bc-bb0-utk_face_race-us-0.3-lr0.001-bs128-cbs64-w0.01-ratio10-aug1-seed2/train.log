Log level set to: INFO
Set seed: 2
=======> Using Fixed Random Seed: 2 <========
save_path: exp_results/bc-bb0-utk_face_race-us-0.3-lr0.001-bs128-cbs64-w0.01-ratio10-aug1-seed2
get_utk_face - split: train, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_race-0.3
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [4407, 3870]
Target 1: [3084, 5529]
Binary Target 1
---------------------------
Target 0: [4407, 3870]
Target 1: [3084, 5529]
===================================
Normal Label Distribution: 
Target 0: [4407, 3870]
Target 1: [3084, 5529]
===================================
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [3084, 3084]
Target 1: [3084, 3084]
Binary Target 1
---------------------------
Target 0: [3084, 3084]
Target 1: [3084, 3084]
===================================
Normal Label Distribution: 
Target 0: [3084, 3084]
Target 1: [3084, 3084]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 12336, target_attr: gender, bias_attr: race bias_rate: 0.3
['[train] target_0-bias_0: 3084', '[train] target_0-bias_1: 3084', '[train] target_1-bias_0: 3084', '[train] target_1-bias_1: 3084']
confusion_matrix - 
 original: tensor([[3084., 3084.],
        [3084., 3084.]]), 
 normalized: tensor([[0.500, 0.500],
        [0.500, 0.500]]), 
 b|y: tensor([[0.500, 0.500],
        [0.500, 0.500]])
get_utk_face - split: train, aug: 1, given_y: True, ratio: 10
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_race-0.3
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [4407, 3870]
Target 1: [3084, 5529]
Binary Target 1
---------------------------
Target 0: [4407, 3870]
Target 1: [3084, 5529]
===================================
Normal Label Distribution: 
Target 0: [4407, 3870]
Target 1: [3084, 5529]
===================================
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [3084, 3084]
Target 1: [3084, 3084]
Binary Target 1
---------------------------
Target 0: [3084, 3084]
Target 1: [3084, 3084]
===================================
Normal Label Distribution: 
Target 0: [3084, 3084]
Target 1: [3084, 3084]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 12336, target_attr: gender, bias_attr: race bias_rate: 0.3
['[train] target_0-bias_0: 3084', '[train] target_0-bias_1: 3084', '[train] target_1-bias_0: 3084', '[train] target_1-bias_1: 3084']
get_utk_face - split: valid, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_race-0.3
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [583, 684]
Target 1: [457, 646]
Binary Target 1
---------------------------
Target 0: [583, 684]
Target 1: [457, 646]
===================================
Normal Label Distribution: 
Target 0: [583, 684]
Target 1: [457, 646]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 2370, target_attr: gender, bias_attr: race bias_rate: 0.3
['[valid] target_0-bias_0: 583', '[valid] target_0-bias_1: 684', '[valid] target_1-bias_0: 457', '[valid] target_1-bias_1: 646']
get_utk_face - split: test, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_race-0.3
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [558, 677]
Target 1: [462, 673]
Binary Target 1
---------------------------
Target 0: [558, 677]
Target 1: [462, 673]
===================================
Normal Label Distribution: 
Target 0: [558, 677]
Target 1: [462, 673]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 2370, target_attr: gender, bias_attr: race bias_rate: 0.3
['[test] target_0-bias_0: 558', '[test] target_0-bias_1: 677', '[test] target_1-bias_0: 462', '[test] target_1-bias_1: 673']
decay_epochs: [6, 13]
[1 / 20] Learning rate: 0.001 weight: 0.01
[1 / 20] Loss: 4.882611981625687 CE Loss: 0.5655733102645082 Con Loss: 4.876956280412687
[1 / 20] tensor([[0.667, 0.665],
        [0.900, 0.906]]) {'epoch': 1, 'valid/acc': 75.57, 'valid/acc_unbiased': 76.632, 'valid/diff': 1.87, 'valid/acc_skew': 77.022, 'valid/acc_align': 76.243, 'test/acc': 77.975, 'test/acc_unbiased': 78.455, 'test/diff': 0.396, 'test/acc_skew': 78.355, 'test/acc_align': 78.554}
[1 / 20] best valid accuracy: 76.632 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 75.57, 'best_valid_valid/acc_unbiased': 76.632, 'best_valid_valid/diff': 1.87, 'best_valid_valid/acc_skew': 77.022, 'best_valid_valid/acc_align': 76.243, 'best_valid_test/acc': 77.975, 'best_valid_test/acc_unbiased': 78.455, 'best_valid_test/diff': 0.396, 'best_valid_test/acc_skew': 78.355, 'best_valid_test/acc_align': 78.554}
[1 / 20] best test accuracy: 78.455 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 75.57, 'best_test_valid/acc_unbiased': 76.632, 'best_test_valid/diff': 1.87, 'best_test_valid/acc_skew': 77.022, 'best_test_valid/acc_align': 76.243, 'best_test_test/acc': 77.975, 'best_test_test/acc_unbiased': 78.455, 'best_test_test/diff': 0.396, 'best_test_test/acc_skew': 78.355, 'best_test_test/acc_align': 78.554}
[2 / 20] Learning rate: 0.001 weight: 0.01
[2 / 20] Loss: 4.768577879968785 CE Loss: 0.4706785501054598 Con Loss: 4.763871089029869
[2 / 20] tensor([[0.898, 0.883],
        [0.639, 0.706]]) {'epoch': 2, 'valid/acc': 79.03, 'valid/acc_unbiased': 78.486, 'valid/diff': 2.742, 'valid/acc_skew': 79.25, 'valid/acc_align': 77.722, 'test/acc': 78.861, 'test/acc_unbiased': 78.137, 'test/diff': 4.09, 'test/acc_skew': 76.819, 'test/acc_align': 79.455}
[2 / 20] best valid accuracy: 78.486 at epoch 2 
 best_stats: {'best_valid_epoch': 2, 'best_valid_valid/acc': 79.03, 'best_valid_valid/acc_unbiased': 78.486, 'best_valid_valid/diff': 2.742, 'best_valid_valid/acc_skew': 79.25, 'best_valid_valid/acc_align': 77.722, 'best_valid_test/acc': 78.861, 'best_valid_test/acc_unbiased': 78.137, 'best_valid_test/diff': 4.09, 'best_valid_test/acc_skew': 76.819, 'best_valid_test/acc_align': 79.455}
[2 / 20] best test accuracy: 78.455 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 75.57, 'best_test_valid/acc_unbiased': 76.632, 'best_test_valid/diff': 1.87, 'best_test_valid/acc_skew': 77.022, 'best_test_valid/acc_align': 76.243, 'best_test_test/acc': 77.975, 'best_test_test/acc_unbiased': 78.455, 'best_test_test/diff': 0.396, 'best_test_test/acc_skew': 78.355, 'best_test_test/acc_align': 78.554}
[3 / 20] Learning rate: 0.001 weight: 0.01
[3 / 20] Loss: 4.7512292237287985 CE Loss: 0.44240951313892074 Con Loss: 4.746805129193455
[3 / 20] tensor([[0.875, 0.880],
        [0.797, 0.795]]) {'epoch': 3, 'valid/acc': 83.418, 'valid/acc_unbiased': 83.248, 'valid/diff': 3.355, 'valid/acc_skew': 84.049, 'valid/acc_align': 82.448, 'test/acc': 83.84, 'test/acc_unbiased': 83.66, 'test/diff': 0.37, 'test/acc_skew': 83.554, 'test/acc_align': 83.765}
[3 / 20] best valid accuracy: 83.248 at epoch 3 
 best_stats: {'best_valid_epoch': 3, 'best_valid_valid/acc': 83.418, 'best_valid_valid/acc_unbiased': 83.248, 'best_valid_valid/diff': 3.355, 'best_valid_valid/acc_skew': 84.049, 'best_valid_valid/acc_align': 82.448, 'best_valid_test/acc': 83.84, 'best_valid_test/acc_unbiased': 83.66, 'best_valid_test/diff': 0.37, 'best_valid_test/acc_skew': 83.554, 'best_valid_test/acc_align': 83.765}
[3 / 20] best test accuracy: 83.660 at epoch 3 
 best_stats: {'best_test_epoch': 3, 'best_test_valid/acc': 83.418, 'best_test_valid/acc_unbiased': 83.248, 'best_test_valid/diff': 3.355, 'best_test_valid/acc_skew': 84.049, 'best_test_valid/acc_align': 82.448, 'best_test_test/acc': 83.84, 'best_test_test/acc_unbiased': 83.66, 'best_test_test/diff': 0.37, 'best_test_test/acc_skew': 83.554, 'best_test_test/acc_align': 83.765}
[4 / 20] Learning rate: 0.001 weight: 0.01
[4 / 20] Loss: 4.721515549141454 CE Loss: 0.41098197780539863 Con Loss: 4.717405734822908
[4 / 20] tensor([[0.907, 0.860],
        [0.775, 0.801]]) {'epoch': 4, 'valid/acc': 82.785, 'valid/acc_unbiased': 82.692, 'valid/diff': 4.117, 'valid/acc_skew': 84.75, 'valid/acc_align': 80.633, 'test/acc': 83.755, 'test/acc_unbiased': 83.557, 'test/diff': 3.657, 'test/acc_skew': 84.085, 'test/acc_align': 83.028}
[4 / 20] best valid accuracy: 83.248 at epoch 3 
 best_stats: {'best_valid_epoch': 3, 'best_valid_valid/acc': 83.418, 'best_valid_valid/acc_unbiased': 83.248, 'best_valid_valid/diff': 3.355, 'best_valid_valid/acc_skew': 84.049, 'best_valid_valid/acc_align': 82.448, 'best_valid_test/acc': 83.84, 'best_valid_test/acc_unbiased': 83.66, 'best_valid_test/diff': 0.37, 'best_valid_test/acc_skew': 83.554, 'best_valid_test/acc_align': 83.765}
[4 / 20] best test accuracy: 83.660 at epoch 3 
 best_stats: {'best_test_epoch': 3, 'best_test_valid/acc': 83.418, 'best_test_valid/acc_unbiased': 83.248, 'best_test_valid/diff': 3.355, 'best_test_valid/acc_skew': 84.049, 'best_test_valid/acc_align': 82.448, 'best_test_test/acc': 83.84, 'best_test_test/acc_unbiased': 83.66, 'best_test_test/diff': 0.37, 'best_test_test/acc_skew': 83.554, 'best_test_test/acc_align': 83.765}
[5 / 20] Learning rate: 0.001 weight: 0.01
[5 / 20] Loss: 4.706586191471758 CE Loss: 0.4054629529419267 Con Loss: 4.70253155853034
[5 / 20] tensor([[0.842, 0.814],
        [0.881, 0.871]]) {'epoch': 5, 'valid/acc': 85.148, 'valid/acc_unbiased': 85.42, 'valid/diff': 2.941, 'valid/acc_skew': 86.406, 'valid/acc_align': 84.434, 'test/acc': 84.979, 'test/acc_unbiased': 85.196, 'test/diff': 1.932, 'test/acc_skew': 86.162, 'test/acc_align': 84.231}
[5 / 20] best valid accuracy: 85.420 at epoch 5 
 best_stats: {'best_valid_epoch': 5, 'best_valid_valid/acc': 85.148, 'best_valid_valid/acc_unbiased': 85.42, 'best_valid_valid/diff': 2.941, 'best_valid_valid/acc_skew': 86.406, 'best_valid_valid/acc_align': 84.434, 'best_valid_test/acc': 84.979, 'best_valid_test/acc_unbiased': 85.196, 'best_valid_test/diff': 1.932, 'best_valid_test/acc_skew': 86.162, 'best_valid_test/acc_align': 84.231}
[5 / 20] best test accuracy: 85.196 at epoch 5 
 best_stats: {'best_test_epoch': 5, 'best_test_valid/acc': 85.148, 'best_test_valid/acc_unbiased': 85.42, 'best_test_valid/diff': 2.941, 'best_test_valid/acc_skew': 86.406, 'best_test_valid/acc_align': 84.434, 'best_test_test/acc': 84.979, 'best_test_test/acc_unbiased': 85.196, 'best_test_test/diff': 1.932, 'best_test_test/acc_skew': 86.162, 'best_test_test/acc_align': 84.231}
[6 / 20] Learning rate: 0.001 weight: 0.01
[6 / 20] Loss: 4.706223079048088 CE Loss: 0.3978197738895466 Con Loss: 4.7022448872468505
[6 / 20] tensor([[0.885, 0.840],
        [0.846, 0.835]]) {'epoch': 6, 'valid/acc': 84.093, 'valid/acc_unbiased': 84.212, 'valid/diff': 3.27, 'valid/acc_skew': 85.847, 'valid/acc_align': 82.577, 'test/acc': 85.063, 'test/acc_unbiased': 85.179, 'test/diff': 2.804, 'test/acc_skew': 86.581, 'test/acc_align': 83.777}
[6 / 20] best valid accuracy: 85.420 at epoch 5 
 best_stats: {'best_valid_epoch': 5, 'best_valid_valid/acc': 85.148, 'best_valid_valid/acc_unbiased': 85.42, 'best_valid_valid/diff': 2.941, 'best_valid_valid/acc_skew': 86.406, 'best_valid_valid/acc_align': 84.434, 'best_valid_test/acc': 84.979, 'best_valid_test/acc_unbiased': 85.196, 'best_valid_test/diff': 1.932, 'best_valid_test/acc_skew': 86.162, 'best_valid_test/acc_align': 84.231}
[6 / 20] best test accuracy: 85.196 at epoch 5 
 best_stats: {'best_test_epoch': 5, 'best_test_valid/acc': 85.148, 'best_test_valid/acc_unbiased': 85.42, 'best_test_valid/diff': 2.941, 'best_test_valid/acc_skew': 86.406, 'best_test_valid/acc_align': 84.434, 'best_test_test/acc': 84.979, 'best_test_test/acc_unbiased': 85.196, 'best_test_test/diff': 1.932, 'best_test_test/acc_skew': 86.162, 'best_test_test/acc_align': 84.231}
[7 / 20] Learning rate: 0.0001 weight: 0.01
[7 / 20] Loss: 4.6761845200287535 CE Loss: 0.36730004311690223 Con Loss: 4.672511534932059
[7 / 20] tensor([[0.846, 0.806],
        [0.890, 0.900]]) {'epoch': 7, 'valid/acc': 85.907, 'valid/acc_unbiased': 86.266, 'valid/diff': 2.451, 'valid/acc_skew': 87.491, 'valid/acc_align': 85.04, 'test/acc': 85.865, 'test/acc_unbiased': 86.061, 'test/diff': 2.511, 'test/acc_skew': 86.774, 'test/acc_align': 85.347}
[7 / 20] best valid accuracy: 86.266 at epoch 7 
 best_stats: {'best_valid_epoch': 7, 'best_valid_valid/acc': 85.907, 'best_valid_valid/acc_unbiased': 86.266, 'best_valid_valid/diff': 2.451, 'best_valid_valid/acc_skew': 87.491, 'best_valid_valid/acc_align': 85.04, 'best_valid_test/acc': 85.865, 'best_valid_test/acc_unbiased': 86.061, 'best_valid_test/diff': 2.511, 'best_valid_test/acc_skew': 86.774, 'best_valid_test/acc_align': 85.347}
[7 / 20] best test accuracy: 86.061 at epoch 7 
 best_stats: {'best_test_epoch': 7, 'best_test_valid/acc': 85.907, 'best_test_valid/acc_unbiased': 86.266, 'best_test_valid/diff': 2.451, 'best_test_valid/acc_skew': 87.491, 'best_test_valid/acc_align': 85.04, 'best_test_test/acc': 85.865, 'best_test_test/acc_unbiased': 86.061, 'best_test_test/diff': 2.511, 'best_test_test/acc_skew': 86.774, 'best_test_test/acc_align': 85.347}
[8 / 20] Learning rate: 0.0001 weight: 0.01
[8 / 20] Loss: 4.65107451833485 CE Loss: 0.34444581700824733 Con Loss: 4.6476300872872
[8 / 20] tensor([[0.907, 0.874],
        [0.831, 0.844]]) {'epoch': 8, 'valid/acc': 87.342, 'valid/acc_unbiased': 87.372, 'valid/diff': 4.018, 'valid/acc_skew': 89.381, 'valid/acc_align': 85.363, 'test/acc': 86.498, 'test/acc_unbiased': 86.41, 'test/diff': 2.259, 'test/acc_skew': 86.899, 'test/acc_align': 85.921}
[8 / 20] best valid accuracy: 87.372 at epoch 8 
 best_stats: {'best_valid_epoch': 8, 'best_valid_valid/acc': 87.342, 'best_valid_valid/acc_unbiased': 87.372, 'best_valid_valid/diff': 4.018, 'best_valid_valid/acc_skew': 89.381, 'best_valid_valid/acc_align': 85.363, 'best_valid_test/acc': 86.498, 'best_valid_test/acc_unbiased': 86.41, 'best_valid_test/diff': 2.259, 'best_valid_test/acc_skew': 86.899, 'best_valid_test/acc_align': 85.921}
[8 / 20] best test accuracy: 86.410 at epoch 8 
 best_stats: {'best_test_epoch': 8, 'best_test_valid/acc': 87.342, 'best_test_valid/acc_unbiased': 87.372, 'best_test_valid/diff': 4.018, 'best_test_valid/acc_skew': 89.381, 'best_test_valid/acc_align': 85.363, 'best_test_test/acc': 86.498, 'best_test_test/acc_unbiased': 86.41, 'best_test_test/diff': 2.259, 'best_test_test/acc_skew': 86.899, 'best_test_test/acc_align': 85.921}
[9 / 20] Learning rate: 0.0001 weight: 0.01
[9 / 20] Loss: 4.649506150207322 CE Loss: 0.33834512259245847 Con Loss: 4.646122700509395
[9 / 20] tensor([[0.876, 0.827],
        [0.890, 0.880]]) {'epoch': 9, 'valid/acc': 87.342, 'valid/acc_unbiased': 87.57, 'valid/diff': 2.273, 'valid/acc_skew': 88.706, 'valid/acc_align': 86.434, 'test/acc': 86.582, 'test/acc_unbiased': 86.819, 'test/diff': 2.957, 'test/acc_skew': 88.298, 'test/acc_align': 85.341}
[9 / 20] best valid accuracy: 87.570 at epoch 9 
 best_stats: {'best_valid_epoch': 9, 'best_valid_valid/acc': 87.342, 'best_valid_valid/acc_unbiased': 87.57, 'best_valid_valid/diff': 2.273, 'best_valid_valid/acc_skew': 88.706, 'best_valid_valid/acc_align': 86.434, 'best_valid_test/acc': 86.582, 'best_valid_test/acc_unbiased': 86.819, 'best_valid_test/diff': 2.957, 'best_valid_test/acc_skew': 88.298, 'best_valid_test/acc_align': 85.341}
[9 / 20] best test accuracy: 86.819 at epoch 9 
 best_stats: {'best_test_epoch': 9, 'best_test_valid/acc': 87.342, 'best_test_valid/acc_unbiased': 87.57, 'best_test_valid/diff': 2.273, 'best_test_valid/acc_skew': 88.706, 'best_test_valid/acc_align': 86.434, 'best_test_test/acc': 86.582, 'best_test_test/acc_unbiased': 86.819, 'best_test_test/diff': 2.957, 'best_test_test/acc_skew': 88.298, 'best_test_test/acc_align': 85.341}
[10 / 20] Learning rate: 0.0001 weight: 0.01
[10 / 20] Loss: 4.640095999577939 CE Loss: 0.32083814829858515 Con Loss: 4.636887612819053
[10 / 20] tensor([[0.891, 0.846],
        [0.877, 0.887]]) {'epoch': 10, 'valid/acc': 87.806, 'valid/acc_unbiased': 88.075, 'valid/diff': 2.061, 'valid/acc_skew': 89.106, 'valid/acc_align': 87.044, 'test/acc': 87.426, 'test/acc_unbiased': 87.519, 'test/diff': 2.737, 'test/acc_skew': 88.365, 'test/acc_align': 86.673}
[10 / 20] best valid accuracy: 88.075 at epoch 10 
 best_stats: {'best_valid_epoch': 10, 'best_valid_valid/acc': 87.806, 'best_valid_valid/acc_unbiased': 88.075, 'best_valid_valid/diff': 2.061, 'best_valid_valid/acc_skew': 89.106, 'best_valid_valid/acc_align': 87.044, 'best_valid_test/acc': 87.426, 'best_valid_test/acc_unbiased': 87.519, 'best_valid_test/diff': 2.737, 'best_valid_test/acc_skew': 88.365, 'best_valid_test/acc_align': 86.673}
[10 / 20] best test accuracy: 87.519 at epoch 10 
 best_stats: {'best_test_epoch': 10, 'best_test_valid/acc': 87.806, 'best_test_valid/acc_unbiased': 88.075, 'best_test_valid/diff': 2.061, 'best_test_valid/acc_skew': 89.106, 'best_test_valid/acc_align': 87.044, 'best_test_test/acc': 87.426, 'best_test_test/acc_unbiased': 87.519, 'best_test_test/diff': 2.737, 'best_test_test/acc_skew': 88.365, 'best_test_test/acc_align': 86.673}
[11 / 20] Learning rate: 0.0001 weight: 0.01
[11 / 20] Loss: 4.632321058389587 CE Loss: 0.31759647771851407 Con Loss: 4.629145074911155
[11 / 20] tensor([[0.918, 0.871],
        [0.853, 0.847]]) {'epoch': 11, 'valid/acc': 87.764, 'valid/acc_unbiased': 87.792, 'valid/diff': 2.853, 'valid/acc_skew': 89.218, 'valid/acc_align': 86.365, 'test/acc': 87.173, 'test/acc_unbiased': 87.221, 'test/diff': 2.597, 'test/acc_skew': 88.519, 'test/acc_align': 85.922}
[11 / 20] best valid accuracy: 88.075 at epoch 10 
 best_stats: {'best_valid_epoch': 10, 'best_valid_valid/acc': 87.806, 'best_valid_valid/acc_unbiased': 88.075, 'best_valid_valid/diff': 2.061, 'best_valid_valid/acc_skew': 89.106, 'best_valid_valid/acc_align': 87.044, 'best_valid_test/acc': 87.426, 'best_valid_test/acc_unbiased': 87.519, 'best_valid_test/diff': 2.737, 'best_valid_test/acc_skew': 88.365, 'best_valid_test/acc_align': 86.673}
[11 / 20] best test accuracy: 87.519 at epoch 10 
 best_stats: {'best_test_epoch': 10, 'best_test_valid/acc': 87.806, 'best_test_valid/acc_unbiased': 88.075, 'best_test_valid/diff': 2.061, 'best_test_valid/acc_skew': 89.106, 'best_test_valid/acc_align': 87.044, 'best_test_test/acc': 87.426, 'best_test_test/acc_unbiased': 87.519, 'best_test_test/diff': 2.737, 'best_test_test/acc_skew': 88.365, 'best_test_test/acc_align': 86.673}
[12 / 20] Learning rate: 0.0001 weight: 0.01
[12 / 20] Loss: 4.622873031057118 CE Loss: 0.3143064892632179 Con Loss: 4.619729961093452
[12 / 20] tensor([[0.907, 0.869],
        [0.874, 0.872]]) {'epoch': 12, 'valid/acc': 88.059, 'valid/acc_unbiased': 88.181, 'valid/diff': 2.282, 'valid/acc_skew': 89.322, 'valid/acc_align': 87.04, 'test/acc': 87.975, 'test/acc_unbiased': 88.051, 'test/diff': 2.026, 'test/acc_skew': 89.063, 'test/acc_align': 87.038}
[12 / 20] best valid accuracy: 88.181 at epoch 12 
 best_stats: {'best_valid_epoch': 12, 'best_valid_valid/acc': 88.059, 'best_valid_valid/acc_unbiased': 88.181, 'best_valid_valid/diff': 2.282, 'best_valid_valid/acc_skew': 89.322, 'best_valid_valid/acc_align': 87.04, 'best_valid_test/acc': 87.975, 'best_valid_test/acc_unbiased': 88.051, 'best_valid_test/diff': 2.026, 'best_valid_test/acc_skew': 89.063, 'best_valid_test/acc_align': 87.038}
[12 / 20] best test accuracy: 88.051 at epoch 12 
 best_stats: {'best_test_epoch': 12, 'best_test_valid/acc': 88.059, 'best_test_valid/acc_unbiased': 88.181, 'best_test_valid/diff': 2.282, 'best_test_valid/acc_skew': 89.322, 'best_test_valid/acc_align': 87.04, 'best_test_test/acc': 87.975, 'best_test_test/acc_unbiased': 88.051, 'best_test_test/diff': 2.026, 'best_test_test/acc_skew': 89.063, 'best_test_test/acc_align': 87.038}
[13 / 20] Learning rate: 0.0001 weight: 0.01
[13 / 20] Loss: 4.602546107444318 CE Loss: 0.31088300793396667 Con Loss: 4.599437263998386
[13 / 20] tensor([[0.862, 0.829],
        [0.916, 0.917]]) {'epoch': 13, 'valid/acc': 87.131, 'valid/acc_unbiased': 87.586, 'valid/diff': 2.607, 'valid/acc_skew': 88.89, 'valid/acc_align': 86.283, 'test/acc': 87.848, 'test/acc_unbiased': 88.076, 'test/diff': 1.728, 'test/acc_skew': 88.88, 'test/acc_align': 87.272}
[13 / 20] best valid accuracy: 88.181 at epoch 12 
 best_stats: {'best_valid_epoch': 12, 'best_valid_valid/acc': 88.059, 'best_valid_valid/acc_unbiased': 88.181, 'best_valid_valid/diff': 2.282, 'best_valid_valid/acc_skew': 89.322, 'best_valid_valid/acc_align': 87.04, 'best_valid_test/acc': 87.975, 'best_valid_test/acc_unbiased': 88.051, 'best_valid_test/diff': 2.026, 'best_valid_test/acc_skew': 89.063, 'best_valid_test/acc_align': 87.038}
[13 / 20] best test accuracy: 88.076 at epoch 13 
 best_stats: {'best_test_epoch': 13, 'best_test_valid/acc': 87.131, 'best_test_valid/acc_unbiased': 87.586, 'best_test_valid/diff': 2.607, 'best_test_valid/acc_skew': 88.89, 'best_test_valid/acc_align': 86.283, 'best_test_test/acc': 87.848, 'best_test_test/acc_unbiased': 88.076, 'best_test_test/diff': 1.728, 'best_test_test/acc_skew': 88.88, 'best_test_test/acc_align': 87.272}
[14 / 20] Learning rate: 1e-05 weight: 0.01
[14 / 20] Loss: 4.615035122006784 CE Loss: 0.3045721167140434 Con Loss: 4.611989387433043
[14 / 20] tensor([[0.885, 0.842],
        [0.900, 0.887]]) {'epoch': 14, 'valid/acc': 87.848, 'valid/acc_unbiased': 88.203, 'valid/diff': 3.367, 'valid/acc_skew': 89.886, 'valid/acc_align': 86.52, 'test/acc': 87.637, 'test/acc_unbiased': 87.869, 'test/diff': 2.836, 'test/acc_skew': 89.287, 'test/acc_align': 86.451}
[14 / 20] best valid accuracy: 88.203 at epoch 14 
 best_stats: {'best_valid_epoch': 14, 'best_valid_valid/acc': 87.848, 'best_valid_valid/acc_unbiased': 88.203, 'best_valid_valid/diff': 3.367, 'best_valid_valid/acc_skew': 89.886, 'best_valid_valid/acc_align': 86.52, 'best_valid_test/acc': 87.637, 'best_valid_test/acc_unbiased': 87.869, 'best_valid_test/diff': 2.836, 'best_valid_test/acc_skew': 89.287, 'best_valid_test/acc_align': 86.451}
[14 / 20] best test accuracy: 88.076 at epoch 13 
 best_stats: {'best_test_epoch': 13, 'best_test_valid/acc': 87.131, 'best_test_valid/acc_unbiased': 87.586, 'best_test_valid/diff': 2.607, 'best_test_valid/acc_skew': 88.89, 'best_test_valid/acc_align': 86.283, 'best_test_test/acc': 87.848, 'best_test_test/acc_unbiased': 88.076, 'best_test_test/diff': 1.728, 'best_test_test/acc_skew': 88.88, 'best_test_test/acc_align': 87.272}
[15 / 20] Learning rate: 1e-05 weight: 0.01
[15 / 20] Loss: 4.598861518073175 CE Loss: 0.3065915163388976 Con Loss: 4.595795605433127
[15 / 20] tensor([[0.896, 0.858],
        [0.885, 0.880]]) {'epoch': 15, 'valid/acc': 88.059, 'valid/acc_unbiased': 88.313, 'valid/diff': 3.252, 'valid/acc_skew': 89.94, 'valid/acc_align': 86.687, 'test/acc': 87.848, 'test/acc_unbiased': 87.98, 'test/diff': 2.175, 'test/acc_skew': 89.067, 'test/acc_align': 86.892}
[15 / 20] best valid accuracy: 88.313 at epoch 15 
 best_stats: {'best_valid_epoch': 15, 'best_valid_valid/acc': 88.059, 'best_valid_valid/acc_unbiased': 88.313, 'best_valid_valid/diff': 3.252, 'best_valid_valid/acc_skew': 89.94, 'best_valid_valid/acc_align': 86.687, 'best_valid_test/acc': 87.848, 'best_valid_test/acc_unbiased': 87.98, 'best_valid_test/diff': 2.175, 'best_valid_test/acc_skew': 89.067, 'best_valid_test/acc_align': 86.892}
[15 / 20] best test accuracy: 88.076 at epoch 13 
 best_stats: {'best_test_epoch': 13, 'best_test_valid/acc': 87.131, 'best_test_valid/acc_unbiased': 87.586, 'best_test_valid/diff': 2.607, 'best_test_valid/acc_skew': 88.89, 'best_test_valid/acc_align': 86.283, 'best_test_test/acc': 87.848, 'best_test_test/acc_unbiased': 88.076, 'best_test_test/diff': 1.728, 'best_test_test/acc_skew': 88.88, 'best_test_test/acc_align': 87.272}
[16 / 20] Learning rate: 1e-05 weight: 0.01
[16 / 20] Loss: 4.609949851005148 CE Loss: 0.3071824706095511 Con Loss: 4.606878033253315
[16 / 20] tensor([[0.900, 0.855],
        [0.885, 0.880]]) {'epoch': 16, 'valid/acc': 88.312, 'valid/acc_unbiased': 88.533, 'valid/diff': 2.642, 'valid/acc_skew': 89.854, 'valid/acc_align': 87.212, 'test/acc': 87.848, 'test/acc_unbiased': 87.995, 'test/diff': 2.502, 'test/acc_skew': 89.246, 'test/acc_align': 86.744}
[16 / 20] best valid accuracy: 88.533 at epoch 16 
 best_stats: {'best_valid_epoch': 16, 'best_valid_valid/acc': 88.312, 'best_valid_valid/acc_unbiased': 88.533, 'best_valid_valid/diff': 2.642, 'best_valid_valid/acc_skew': 89.854, 'best_valid_valid/acc_align': 87.212, 'best_valid_test/acc': 87.848, 'best_valid_test/acc_unbiased': 87.995, 'best_valid_test/diff': 2.502, 'best_valid_test/acc_skew': 89.246, 'best_valid_test/acc_align': 86.744}
[16 / 20] best test accuracy: 88.076 at epoch 13 
 best_stats: {'best_test_epoch': 13, 'best_test_valid/acc': 87.131, 'best_test_valid/acc_unbiased': 87.586, 'best_test_valid/diff': 2.607, 'best_test_valid/acc_skew': 88.89, 'best_test_valid/acc_align': 86.283, 'best_test_test/acc': 87.848, 'best_test_test/acc_unbiased': 88.076, 'best_test_test/diff': 1.728, 'best_test_test/acc_skew': 88.88, 'best_test_test/acc_align': 87.272}
[17 / 20] Learning rate: 1e-05 weight: 0.01
[17 / 20] Loss: 4.608766198931346 CE Loss: 0.2981841859495903 Con Loss: 4.605784366721464
[17 / 20] tensor([[0.892, 0.854],
        [0.883, 0.881]]) {'epoch': 17, 'valid/acc': 88.186, 'valid/acc_unbiased': 88.434, 'valid/diff': 3.183, 'valid/acc_skew': 90.025, 'valid/acc_align': 86.842, 'test/acc': 87.637, 'test/acc_unbiased': 87.762, 'test/diff': 2.035, 'test/acc_skew': 88.779, 'test/acc_align': 86.745}
[17 / 20] best valid accuracy: 88.533 at epoch 16 
 best_stats: {'best_valid_epoch': 16, 'best_valid_valid/acc': 88.312, 'best_valid_valid/acc_unbiased': 88.533, 'best_valid_valid/diff': 2.642, 'best_valid_valid/acc_skew': 89.854, 'best_valid_valid/acc_align': 87.212, 'best_valid_test/acc': 87.848, 'best_valid_test/acc_unbiased': 87.995, 'best_valid_test/diff': 2.502, 'best_valid_test/acc_skew': 89.246, 'best_valid_test/acc_align': 86.744}
[17 / 20] best test accuracy: 88.076 at epoch 13 
 best_stats: {'best_test_epoch': 13, 'best_test_valid/acc': 87.131, 'best_test_valid/acc_unbiased': 87.586, 'best_test_valid/diff': 2.607, 'best_test_valid/acc_skew': 88.89, 'best_test_valid/acc_align': 86.283, 'best_test_test/acc': 87.848, 'best_test_test/acc_unbiased': 88.076, 'best_test_test/diff': 1.728, 'best_test_test/acc_skew': 88.88, 'best_test_test/acc_align': 87.272}
[18 / 20] Learning rate: 1e-05 weight: 0.01
[18 / 20] Loss: 4.608455414283446 CE Loss: 0.29867683882533963 Con Loss: 4.605468637439218
[18 / 20] tensor([[0.900, 0.860],
        [0.881, 0.872]]) {'epoch': 18, 'valid/acc': 88.439, 'valid/acc_unbiased': 88.621, 'valid/diff': 2.543, 'valid/acc_skew': 89.892, 'valid/acc_align': 87.349, 'test/acc': 87.679, 'test/acc_unbiased': 87.812, 'test/diff': 2.435, 'test/acc_skew': 89.03, 'test/acc_align': 86.594}
[18 / 20] best valid accuracy: 88.621 at epoch 18 
 best_stats: {'best_valid_epoch': 18, 'best_valid_valid/acc': 88.439, 'best_valid_valid/acc_unbiased': 88.621, 'best_valid_valid/diff': 2.543, 'best_valid_valid/acc_skew': 89.892, 'best_valid_valid/acc_align': 87.349, 'best_valid_test/acc': 87.679, 'best_valid_test/acc_unbiased': 87.812, 'best_valid_test/diff': 2.435, 'best_valid_test/acc_skew': 89.03, 'best_valid_test/acc_align': 86.594}
[18 / 20] best test accuracy: 88.076 at epoch 13 
 best_stats: {'best_test_epoch': 13, 'best_test_valid/acc': 87.131, 'best_test_valid/acc_unbiased': 87.586, 'best_test_valid/diff': 2.607, 'best_test_valid/acc_skew': 88.89, 'best_test_valid/acc_align': 86.283, 'best_test_test/acc': 87.848, 'best_test_test/acc_unbiased': 88.076, 'best_test_test/diff': 1.728, 'best_test_test/acc_skew': 88.88, 'best_test_test/acc_align': 87.272}
[19 / 20] Learning rate: 1e-05 weight: 0.01
[19 / 20] Loss: 4.595201781133115 CE Loss: 0.30379628860687624 Con Loss: 4.592163821911843
[19 / 20] tensor([[0.896, 0.857],
        [0.879, 0.875]]) {'epoch': 19, 'valid/acc': 88.059, 'valid/acc_unbiased': 88.237, 'valid/diff': 2.653, 'valid/acc_skew': 89.564, 'valid/acc_align': 86.911, 'test/acc': 87.553, 'test/acc_unbiased': 87.669, 'test/diff': 2.147, 'test/acc_skew': 88.742, 'test/acc_align': 86.595}
[19 / 20] best valid accuracy: 88.621 at epoch 18 
 best_stats: {'best_valid_epoch': 18, 'best_valid_valid/acc': 88.439, 'best_valid_valid/acc_unbiased': 88.621, 'best_valid_valid/diff': 2.543, 'best_valid_valid/acc_skew': 89.892, 'best_valid_valid/acc_align': 87.349, 'best_valid_test/acc': 87.679, 'best_valid_test/acc_unbiased': 87.812, 'best_valid_test/diff': 2.435, 'best_valid_test/acc_skew': 89.03, 'best_valid_test/acc_align': 86.594}
[19 / 20] best test accuracy: 88.076 at epoch 13 
 best_stats: {'best_test_epoch': 13, 'best_test_valid/acc': 87.131, 'best_test_valid/acc_unbiased': 87.586, 'best_test_valid/diff': 2.607, 'best_test_valid/acc_skew': 88.89, 'best_test_valid/acc_align': 86.283, 'best_test_test/acc': 87.848, 'best_test_test/acc_unbiased': 88.076, 'best_test_test/diff': 1.728, 'best_test_test/acc_skew': 88.88, 'best_test_test/acc_align': 87.272}
[20 / 20] Learning rate: 1e-05 weight: 0.01
[20 / 20] Loss: 4.588286396130513 CE Loss: 0.29836409686836285 Con Loss: 4.585302749960339
[20 / 20] tensor([[0.892, 0.854],
        [0.890, 0.880]]) {'epoch': 20, 'valid/acc': 88.143, 'valid/acc_unbiased': 88.369, 'valid/diff': 2.752, 'valid/acc_skew': 89.744, 'valid/acc_align': 86.993, 'test/acc': 87.722, 'test/acc_unbiased': 87.887, 'test/diff': 2.434, 'test/acc_skew': 89.104, 'test/acc_align': 86.671}
[20 / 20] best valid accuracy: 88.621 at epoch 18 
 best_stats: {'best_valid_epoch': 18, 'best_valid_valid/acc': 88.439, 'best_valid_valid/acc_unbiased': 88.621, 'best_valid_valid/diff': 2.543, 'best_valid_valid/acc_skew': 89.892, 'best_valid_valid/acc_align': 87.349, 'best_valid_test/acc': 87.679, 'best_valid_test/acc_unbiased': 87.812, 'best_valid_test/diff': 2.435, 'best_valid_test/acc_skew': 89.03, 'best_valid_test/acc_align': 86.594}
[20 / 20] best test accuracy: 88.076 at epoch 13 
 best_stats: {'best_test_epoch': 13, 'best_test_valid/acc': 87.131, 'best_test_valid/acc_unbiased': 87.586, 'best_test_valid/diff': 2.607, 'best_test_valid/acc_skew': 88.89, 'best_test_valid/acc_align': 86.283, 'best_test_test/acc': 87.848, 'best_test_test/acc_unbiased': 88.076, 'best_test_test/diff': 1.728, 'best_test_test/acc_skew': 88.88, 'best_test_test/acc_align': 87.272}
Total training time: 0:32:16
