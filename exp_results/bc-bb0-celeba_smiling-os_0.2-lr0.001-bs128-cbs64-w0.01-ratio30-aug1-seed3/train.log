Log level set to: INFO
Set seed: 3
=======> Using Fixed Random Seed: 3 <========
save_path: exp_results/bc-bb0-celeba_smiling-os_0.2-lr0.001-bs128-cbs64-w0.01-ratio30-aug1-seed3
get_celeba - split:train, aug: False, given_y: True, ratio: 0
use existing smiling indices from data/celeba/pickles/smiling
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [8124, 8124]
Target 1: [8124, 8124]
Binary Target 1
---------------------------
Target 0: [8124, 8124]
Target 1: [8124, 8124]
===================================
Normal Label Distribution: 
Target 0: [8124, 8124]
Target 1: [8124, 8124]
===================================
Use BiasedCelebASplit 
 target_attr: smiling split: train 
 tensor([[8124., 8124.],
        [8124., 8124.]])
get_celeba - split:train, aug: 1, given_y: True, ratio: 30
use existing smiling indices from data/celeba/pickles/smiling
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [8160, 8160]
Target 1: [8160, 8160]
Binary Target 1
---------------------------
Target 0: [8160, 8160]
Target 1: [8160, 8160]
===================================
Normal Label Distribution: 
Target 0: [8160, 8160]
Target 1: [8160, 8160]
===================================
Use BiasedCelebASplit 
 target_attr: smiling split: train 
 tensor([[8160., 8160.],
        [8160., 8160.]])
get_celeba - split:train_valid, aug: False, given_y: True, ratio: 0
use existing smiling indices from data/celeba/pickles/smiling
Use BiasedCelebASplit 
 target_attr: smiling split: train_valid 
 tensor([[ 1944., 10217.],
        [ 8222.,  1982.]])
get_celeba - split:valid, aug: False, given_y: True, ratio: 0
Use BiasedCelebASplit 
 target_attr: smiling split: valid 
 tensor([[5252., 6157.],
        [5013., 3445.]])
decay_epochs: [3, 6]
[1 / 10] Learning rate: 0.001 weight: 0.01
[1 / 10] Loss: 4.675839906135608 CE Loss: 0.2919328597116095 Con Loss: 4.672920577341791
[1 / 10] tensor([[0.903, 0.914],
        [0.917, 0.891]]) {'epoch': 1, 'valid/acc': 90.87, 'valid/acc_unbiased': 90.428, 'valid/diff': 1.362, 'valid/acc_skew': 91.039, 'valid/acc_align': 89.816, 'test/acc': 90.794, 'test/acc_unbiased': 90.614, 'test/diff': 1.843, 'test/acc_skew': 90.998, 'test/acc_align': 90.229}
[1 / 10] best valid accuracy: 90.428 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 90.87, 'best_valid_valid/acc_unbiased': 90.428, 'best_valid_valid/diff': 1.362, 'best_valid_valid/acc_skew': 91.039, 'best_valid_valid/acc_align': 89.816, 'best_valid_test/acc': 90.794, 'best_valid_test/acc_unbiased': 90.614, 'best_valid_test/diff': 1.843, 'best_valid_test/acc_skew': 90.998, 'best_valid_test/acc_align': 90.229}
[1 / 10] best test accuracy: 90.614 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 90.87, 'best_test_valid/acc_unbiased': 90.428, 'best_test_valid/diff': 1.362, 'best_test_valid/acc_skew': 91.039, 'best_test_valid/acc_align': 89.816, 'best_test_test/acc': 90.794, 'best_test_test/acc_unbiased': 90.614, 'best_test_test/diff': 1.843, 'best_test_test/acc_skew': 90.998, 'best_test_test/acc_align': 90.229}
[2 / 10] Learning rate: 0.001 weight: 0.01
[2 / 10] Loss: 4.625269181736581 CE Loss: 0.24443651086470577 Con Loss: 4.6228248306473505
[2 / 10] tensor([[0.931, 0.923],
        [0.906, 0.886]]) {'epoch': 2, 'valid/acc': 90.758, 'valid/acc_unbiased': 90.875, 'valid/diff': 1.82, 'valid/acc_skew': 91.784, 'valid/acc_align': 89.965, 'test/acc': 91.352, 'test/acc_unbiased': 91.159, 'test/diff': 1.416, 'test/acc_skew': 91.867, 'test/acc_align': 90.451}
[2 / 10] best valid accuracy: 90.875 at epoch 2 
 best_stats: {'best_valid_epoch': 2, 'best_valid_valid/acc': 90.758, 'best_valid_valid/acc_unbiased': 90.875, 'best_valid_valid/diff': 1.82, 'best_valid_valid/acc_skew': 91.784, 'best_valid_valid/acc_align': 89.965, 'best_valid_test/acc': 91.352, 'best_valid_test/acc_unbiased': 91.159, 'best_valid_test/diff': 1.416, 'best_valid_test/acc_skew': 91.867, 'best_valid_test/acc_align': 90.451}
[2 / 10] best test accuracy: 91.159 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 90.758, 'best_test_valid/acc_unbiased': 90.875, 'best_test_valid/diff': 1.82, 'best_test_valid/acc_skew': 91.784, 'best_test_valid/acc_align': 89.965, 'best_test_test/acc': 91.352, 'best_test_test/acc_unbiased': 91.159, 'best_test_test/diff': 1.416, 'best_test_test/acc_skew': 91.867, 'best_test_test/acc_align': 90.451}
[3 / 10] Learning rate: 0.001 weight: 0.01
[3 / 10] Loss: 4.604856015190827 CE Loss: 0.23471869514353577 Con Loss: 4.602508821022563
[3 / 10] tensor([[0.852, 0.791],
        [0.958, 0.966]]) {'epoch': 3, 'valid/acc': 88.683, 'valid/acc_unbiased': 89.037, 'valid/diff': 3.53, 'valid/acc_skew': 90.662, 'valid/acc_align': 87.413, 'test/acc': 88.952, 'test/acc_unbiased': 89.204, 'test/diff': 3.468, 'test/acc_skew': 90.535, 'test/acc_align': 87.874}
[3 / 10] best valid accuracy: 90.875 at epoch 2 
 best_stats: {'best_valid_epoch': 2, 'best_valid_valid/acc': 90.758, 'best_valid_valid/acc_unbiased': 90.875, 'best_valid_valid/diff': 1.82, 'best_valid_valid/acc_skew': 91.784, 'best_valid_valid/acc_align': 89.965, 'best_valid_test/acc': 91.352, 'best_valid_test/acc_unbiased': 91.159, 'best_valid_test/diff': 1.416, 'best_valid_test/acc_skew': 91.867, 'best_valid_test/acc_align': 90.451}
[3 / 10] best test accuracy: 91.159 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 90.758, 'best_test_valid/acc_unbiased': 90.875, 'best_test_valid/diff': 1.82, 'best_test_valid/acc_skew': 91.784, 'best_test_valid/acc_align': 89.965, 'best_test_test/acc': 91.352, 'best_test_test/acc_unbiased': 91.159, 'best_test_test/diff': 1.416, 'best_test_test/acc_skew': 91.867, 'best_test_test/acc_align': 90.451}
[4 / 10] Learning rate: 0.0001 weight: 0.01
[4 / 10] Loss: 4.570181765619726 CE Loss: 0.2069937885834747 Con Loss: 4.568111841341711
[4 / 10] tensor([[0.928, 0.906],
        [0.930, 0.922]]) {'epoch': 4, 'valid/acc': 91.795, 'valid/acc_unbiased': 91.804, 'valid/diff': 1.492, 'valid/acc_skew': 92.55, 'valid/acc_align': 91.058, 'test/acc': 92.203, 'test/acc_unbiased': 92.156, 'test/diff': 1.458, 'test/acc_skew': 92.885, 'test/acc_align': 91.427}
[4 / 10] best valid accuracy: 91.804 at epoch 4 
 best_stats: {'best_valid_epoch': 4, 'best_valid_valid/acc': 91.795, 'best_valid_valid/acc_unbiased': 91.804, 'best_valid_valid/diff': 1.492, 'best_valid_valid/acc_skew': 92.55, 'best_valid_valid/acc_align': 91.058, 'best_valid_test/acc': 92.203, 'best_valid_test/acc_unbiased': 92.156, 'best_valid_test/diff': 1.458, 'best_valid_test/acc_skew': 92.885, 'best_valid_test/acc_align': 91.427}
[4 / 10] best test accuracy: 92.156 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 91.795, 'best_test_valid/acc_unbiased': 91.804, 'best_test_valid/diff': 1.492, 'best_test_valid/acc_skew': 92.55, 'best_test_valid/acc_align': 91.058, 'best_test_test/acc': 92.203, 'best_test_test/acc_unbiased': 92.156, 'best_test_test/diff': 1.458, 'best_test_test/acc_skew': 92.885, 'best_test_test/acc_align': 91.427}
[5 / 10] Learning rate: 0.0001 weight: 0.01
[5 / 10] Loss: 4.5607694349284245 CE Loss: 0.19764513524220767 Con Loss: 4.558792995854823
[5 / 10] tensor([[0.942, 0.925],
        [0.920, 0.913]]) {'epoch': 5, 'valid/acc': 91.943, 'valid/acc_unbiased': 92.117, 'valid/diff': 1.574, 'valid/acc_skew': 92.903, 'valid/acc_align': 91.33, 'test/acc': 92.591, 'test/acc_unbiased': 92.503, 'test/diff': 1.176, 'test/acc_skew': 93.091, 'test/acc_align': 91.916}
[5 / 10] best valid accuracy: 92.117 at epoch 5 
 best_stats: {'best_valid_epoch': 5, 'best_valid_valid/acc': 91.943, 'best_valid_valid/acc_unbiased': 92.117, 'best_valid_valid/diff': 1.574, 'best_valid_valid/acc_skew': 92.903, 'best_valid_valid/acc_align': 91.33, 'best_valid_test/acc': 92.591, 'best_valid_test/acc_unbiased': 92.503, 'best_valid_test/diff': 1.176, 'best_valid_test/acc_skew': 93.091, 'best_valid_test/acc_align': 91.916}
[5 / 10] best test accuracy: 92.503 at epoch 5 
 best_stats: {'best_test_epoch': 5, 'best_test_valid/acc': 91.943, 'best_test_valid/acc_unbiased': 92.117, 'best_test_valid/diff': 1.574, 'best_test_valid/acc_skew': 92.903, 'best_test_valid/acc_align': 91.33, 'best_test_test/acc': 92.591, 'best_test_test/acc_unbiased': 92.503, 'best_test_test/diff': 1.176, 'best_test_test/acc_skew': 93.091, 'best_test_test/acc_align': 91.916}
[6 / 10] Learning rate: 0.0001 weight: 0.01
[6 / 10] Loss: 4.552735743060128 CE Loss: 0.19695763504898414 Con Loss: 4.550766169643355
[6 / 10] tensor([[0.936, 0.912],
        [0.926, 0.918]]) {'epoch': 6, 'valid/acc': 91.818, 'valid/acc_unbiased': 92.027, 'valid/diff': 1.584, 'valid/acc_skew': 92.818, 'valid/acc_align': 91.235, 'test/acc': 92.394, 'test/acc_unbiased': 92.325, 'test/diff': 1.584, 'test/acc_skew': 93.117, 'test/acc_align': 91.533}
[6 / 10] best valid accuracy: 92.117 at epoch 5 
 best_stats: {'best_valid_epoch': 5, 'best_valid_valid/acc': 91.943, 'best_valid_valid/acc_unbiased': 92.117, 'best_valid_valid/diff': 1.574, 'best_valid_valid/acc_skew': 92.903, 'best_valid_valid/acc_align': 91.33, 'best_valid_test/acc': 92.591, 'best_valid_test/acc_unbiased': 92.503, 'best_valid_test/diff': 1.176, 'best_valid_test/acc_skew': 93.091, 'best_valid_test/acc_align': 91.916}
[6 / 10] best test accuracy: 92.503 at epoch 5 
 best_stats: {'best_test_epoch': 5, 'best_test_valid/acc': 91.943, 'best_test_valid/acc_unbiased': 92.117, 'best_test_valid/diff': 1.574, 'best_test_valid/acc_skew': 92.903, 'best_test_valid/acc_align': 91.33, 'best_test_test/acc': 92.591, 'best_test_test/acc_unbiased': 92.503, 'best_test_test/diff': 1.176, 'best_test_test/acc_skew': 93.091, 'best_test_test/acc_align': 91.916}
[7 / 10] Learning rate: 1e-05 weight: 0.01
[7 / 10] Loss: 4.54021523774756 CE Loss: 0.1918376419841803 Con Loss: 4.538296865278251
[7 / 10] tensor([[0.940, 0.923],
        [0.921, 0.916]]) {'epoch': 7, 'valid/acc': 92.117, 'valid/acc_unbiased': 92.393, 'valid/diff': 1.637, 'valid/acc_skew': 93.212, 'valid/acc_align': 91.574, 'test/acc': 92.576, 'test/acc_unbiased': 92.512, 'test/diff': 1.074, 'test/acc_skew': 93.049, 'test/acc_align': 91.975}
[7 / 10] best valid accuracy: 92.393 at epoch 7 
 best_stats: {'best_valid_epoch': 7, 'best_valid_valid/acc': 92.117, 'best_valid_valid/acc_unbiased': 92.393, 'best_valid_valid/diff': 1.637, 'best_valid_valid/acc_skew': 93.212, 'best_valid_valid/acc_align': 91.574, 'best_valid_test/acc': 92.576, 'best_valid_test/acc_unbiased': 92.512, 'best_valid_test/diff': 1.074, 'best_valid_test/acc_skew': 93.049, 'best_valid_test/acc_align': 91.975}
[7 / 10] best test accuracy: 92.512 at epoch 7 
 best_stats: {'best_test_epoch': 7, 'best_test_valid/acc': 92.117, 'best_test_valid/acc_unbiased': 92.393, 'best_test_valid/diff': 1.637, 'best_test_valid/acc_skew': 93.212, 'best_test_valid/acc_align': 91.574, 'best_test_test/acc': 92.576, 'best_test_test/acc_unbiased': 92.512, 'best_test_test/diff': 1.074, 'best_test_test/acc_skew': 93.049, 'best_test_test/acc_align': 91.975}
[8 / 10] Learning rate: 1e-05 weight: 0.01
[8 / 10] Loss: 4.538451509367709 CE Loss: 0.19172035391726322 Con Loss: 4.53653430797853
[8 / 10] tensor([[0.937, 0.918],
        [0.926, 0.922]]) {'epoch': 8, 'valid/acc': 92.171, 'valid/acc_unbiased': 92.378, 'valid/diff': 1.755, 'valid/acc_skew': 93.256, 'valid/acc_align': 91.501, 'test/acc': 92.611, 'test/acc_unbiased': 92.566, 'test/diff': 1.138, 'test/acc_skew': 93.135, 'test/acc_align': 91.996}
[8 / 10] best valid accuracy: 92.393 at epoch 7 
 best_stats: {'best_valid_epoch': 7, 'best_valid_valid/acc': 92.117, 'best_valid_valid/acc_unbiased': 92.393, 'best_valid_valid/diff': 1.637, 'best_valid_valid/acc_skew': 93.212, 'best_valid_valid/acc_align': 91.574, 'best_valid_test/acc': 92.576, 'best_valid_test/acc_unbiased': 92.512, 'best_valid_test/diff': 1.074, 'best_valid_test/acc_skew': 93.049, 'best_valid_test/acc_align': 91.975}
[8 / 10] best test accuracy: 92.566 at epoch 8 
 best_stats: {'best_test_epoch': 8, 'best_test_valid/acc': 92.171, 'best_test_valid/acc_unbiased': 92.378, 'best_test_valid/diff': 1.755, 'best_test_valid/acc_skew': 93.256, 'best_test_valid/acc_align': 91.501, 'best_test_test/acc': 92.611, 'best_test_test/acc_unbiased': 92.566, 'best_test_test/diff': 1.138, 'best_test_test/acc_skew': 93.135, 'best_test_test/acc_align': 91.996}
[9 / 10] Learning rate: 1e-05 weight: 0.01
[9 / 10] Loss: 4.5427936521555505 CE Loss: 0.1911381727395417 Con Loss: 4.540882268602305
[9 / 10] tensor([[0.936, 0.920],
        [0.926, 0.920]]) {'epoch': 9, 'valid/acc': 92.22, 'valid/acc_unbiased': 92.487, 'valid/diff': 1.615, 'valid/acc_skew': 93.295, 'valid/acc_align': 91.68, 'test/acc': 92.606, 'test/acc_unbiased': 92.543, 'test/diff': 1.165, 'test/acc_skew': 93.125, 'test/acc_align': 91.96}
[9 / 10] best valid accuracy: 92.487 at epoch 9 
 best_stats: {'best_valid_epoch': 9, 'best_valid_valid/acc': 92.22, 'best_valid_valid/acc_unbiased': 92.487, 'best_valid_valid/diff': 1.615, 'best_valid_valid/acc_skew': 93.295, 'best_valid_valid/acc_align': 91.68, 'best_valid_test/acc': 92.606, 'best_valid_test/acc_unbiased': 92.543, 'best_valid_test/diff': 1.165, 'best_valid_test/acc_skew': 93.125, 'best_valid_test/acc_align': 91.96}
[9 / 10] best test accuracy: 92.566 at epoch 8 
 best_stats: {'best_test_epoch': 8, 'best_test_valid/acc': 92.171, 'best_test_valid/acc_unbiased': 92.378, 'best_test_valid/diff': 1.755, 'best_test_valid/acc_skew': 93.256, 'best_test_valid/acc_align': 91.501, 'best_test_test/acc': 92.611, 'best_test_test/acc_unbiased': 92.566, 'best_test_test/diff': 1.138, 'best_test_test/acc_skew': 93.135, 'best_test_test/acc_align': 91.996}
[10 / 10] Learning rate: 1e-05 weight: 0.01
[10 / 10] Loss: 4.542292749394577 CE Loss: 0.1909980532909954 Con Loss: 4.540382759961983
[10 / 10] tensor([[0.947, 0.926],
        [0.918, 0.913]]) {'epoch': 10, 'valid/acc': 92.068, 'valid/acc_unbiased': 92.318, 'valid/diff': 1.428, 'valid/acc_skew': 93.032, 'valid/acc_align': 91.604, 'test/acc': 92.686, 'test/acc_unbiased': 92.606, 'test/diff': 1.303, 'test/acc_skew': 93.258, 'test/acc_align': 91.955}
[10 / 10] best valid accuracy: 92.487 at epoch 9 
 best_stats: {'best_valid_epoch': 9, 'best_valid_valid/acc': 92.22, 'best_valid_valid/acc_unbiased': 92.487, 'best_valid_valid/diff': 1.615, 'best_valid_valid/acc_skew': 93.295, 'best_valid_valid/acc_align': 91.68, 'best_valid_test/acc': 92.606, 'best_valid_test/acc_unbiased': 92.543, 'best_valid_test/diff': 1.165, 'best_valid_test/acc_skew': 93.125, 'best_valid_test/acc_align': 91.96}
[10 / 10] best test accuracy: 92.606 at epoch 10 
 best_stats: {'best_test_epoch': 10, 'best_test_valid/acc': 92.068, 'best_test_valid/acc_unbiased': 92.318, 'best_test_valid/diff': 1.428, 'best_test_valid/acc_skew': 93.032, 'best_test_valid/acc_align': 91.604, 'best_test_test/acc': 92.686, 'best_test_test/acc_unbiased': 92.606, 'best_test_test/diff': 1.303, 'best_test_test/acc_skew': 93.258, 'best_test_test/acc_align': 91.955}
Total training time: 0:40:08
