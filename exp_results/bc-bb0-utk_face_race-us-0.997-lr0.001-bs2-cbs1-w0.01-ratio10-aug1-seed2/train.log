Log level set to: INFO
Set seed: 2
=======> Using Fixed Random Seed: 2 <========
save_path: exp_results/bc-bb0-utk_face_race-us-0.997-lr0.001-bs2-cbs1-w0.01-ratio10-aug1-seed2
get_utk_face - split: train, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_race-0.997
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [4407, 16]
Target 1: [13, 5529]
Binary Target 1
---------------------------
Target 0: [4407, 16]
Target 1: [13, 5529]
===================================
Normal Label Distribution: 
Target 0: [4407, 16]
Target 1: [13, 5529]
===================================
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [13, 13]
Target 1: [13, 13]
Binary Target 1
---------------------------
Target 0: [13, 13]
Target 1: [13, 13]
===================================
Normal Label Distribution: 
Target 0: [13, 13]
Target 1: [13, 13]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 52, target_attr: gender, bias_attr: race bias_rate: 0.997
['[train] target_0-bias_0: 13', '[train] target_0-bias_1: 13', '[train] target_1-bias_0: 13', '[train] target_1-bias_1: 13']
confusion_matrix - 
 original: tensor([[13., 13.],
        [13., 13.]]), 
 normalized: tensor([[0.500, 0.500],
        [0.500, 0.500]]), 
 b|y: tensor([[0.500, 0.500],
        [0.500, 0.500]])
get_utk_face - split: train, aug: 1, given_y: True, ratio: 10
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_race-0.997
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [4407, 16]
Target 1: [13, 5529]
Binary Target 1
---------------------------
Target 0: [4407, 16]
Target 1: [13, 5529]
===================================
Normal Label Distribution: 
Target 0: [4407, 16]
Target 1: [13, 5529]
===================================
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [13, 13]
Target 1: [13, 13]
Binary Target 1
---------------------------
Target 0: [13, 13]
Target 1: [13, 13]
===================================
Normal Label Distribution: 
Target 0: [13, 13]
Target 1: [13, 13]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 52, target_attr: gender, bias_attr: race bias_rate: 0.997
['[train] target_0-bias_0: 13', '[train] target_0-bias_1: 13', '[train] target_1-bias_0: 13', '[train] target_1-bias_1: 13']
get_utk_face - split: valid, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_race-0.997
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [583, 684]
Target 1: [457, 646]
Binary Target 1
---------------------------
Target 0: [583, 684]
Target 1: [457, 646]
===================================
Normal Label Distribution: 
Target 0: [583, 684]
Target 1: [457, 646]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 2370, target_attr: gender, bias_attr: race bias_rate: 0.997
['[valid] target_0-bias_0: 583', '[valid] target_0-bias_1: 684', '[valid] target_1-bias_0: 457', '[valid] target_1-bias_1: 646']
get_utk_face - split: test, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_race-0.997
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [558, 677]
Target 1: [462, 673]
Binary Target 1
---------------------------
Target 0: [558, 677]
Target 1: [462, 673]
===================================
Normal Label Distribution: 
Target 0: [558, 677]
Target 1: [462, 673]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 2370, target_attr: gender, bias_attr: race bias_rate: 0.997
['[test] target_0-bias_0: 558', '[test] target_0-bias_1: 677', '[test] target_1-bias_0: 462', '[test] target_1-bias_1: 673']
decay_epochs: [6, 13]
[1 / 20] Learning rate: 0.001 weight: 0.01
[1 / 20] Loss: 0.02033188381196501 CE Loss: 2.033188412968929 Con Loss: 0.0
[1 / 20] tensor([[0.892, 0.897],
        [0.177, 0.134]]) {'epoch': 1, 'valid/acc': 53.924, 'valid/acc_unbiased': 51.23, 'valid/diff': 3.364, 'valid/acc_skew': 50.848, 'valid/acc_align': 51.612, 'test/acc': 53.882, 'test/acc_unbiased': 52.507, 'test/diff': 2.394, 'test/acc_skew': 53.498, 'test/acc_align': 51.517}
[1 / 20] best valid accuracy: 51.230 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 53.924, 'best_valid_valid/acc_unbiased': 51.23, 'best_valid_valid/diff': 3.364, 'best_valid_valid/acc_skew': 50.848, 'best_valid_valid/acc_align': 51.612, 'best_valid_test/acc': 53.882, 'best_valid_test/acc_unbiased': 52.507, 'best_valid_test/diff': 2.394, 'best_valid_test/acc_skew': 53.498, 'best_valid_test/acc_align': 51.517}
[1 / 20] best test accuracy: 52.507 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 53.924, 'best_test_valid/acc_unbiased': 51.23, 'best_test_valid/diff': 3.364, 'best_test_valid/acc_skew': 50.848, 'best_test_valid/acc_align': 51.612, 'best_test_test/acc': 53.882, 'best_test_test/acc_unbiased': 52.507, 'best_test_test/diff': 2.394, 'best_test_test/acc_skew': 53.498, 'best_test_test/acc_align': 51.517}
[2 / 20] Learning rate: 0.001 weight: 0.01
[2 / 20] Loss: 0.007834422608049443 CE Loss: 0.7834422794672159 Con Loss: 0.0
[2 / 20] tensor([[0.919, 0.916],
        [0.080, 0.143]]) {'epoch': 2, 'valid/acc': 53.122, 'valid/acc_unbiased': 50.16, 'valid/diff': 2.748, 'valid/acc_skew': 49.494, 'valid/acc_align': 50.826, 'test/acc': 53.418, 'test/acc_unbiased': 51.447, 'test/diff': 3.305, 'test/acc_skew': 49.972, 'test/acc_align': 52.922}
[2 / 20] best valid accuracy: 51.230 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 53.924, 'best_valid_valid/acc_unbiased': 51.23, 'best_valid_valid/diff': 3.364, 'best_valid_valid/acc_skew': 50.848, 'best_valid_valid/acc_align': 51.612, 'best_valid_test/acc': 53.882, 'best_valid_test/acc_unbiased': 52.507, 'best_valid_test/diff': 2.394, 'best_valid_test/acc_skew': 53.498, 'best_valid_test/acc_align': 51.517}
[2 / 20] best test accuracy: 52.507 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 53.924, 'best_test_valid/acc_unbiased': 51.23, 'best_test_valid/diff': 3.364, 'best_test_valid/acc_skew': 50.848, 'best_test_valid/acc_align': 51.612, 'best_test_test/acc': 53.882, 'best_test_test/acc_unbiased': 52.507, 'best_test_test/diff': 2.394, 'best_test_test/acc_skew': 53.498, 'best_test_test/acc_align': 51.517}
[3 / 20] Learning rate: 0.001 weight: 0.01
[3 / 20] Loss: 0.008648710602966066 CE Loss: 0.8648710869825803 Con Loss: 0.0
[3 / 20] tensor([[0.832, 0.835],
        [0.266, 0.290]]) {'epoch': 3, 'valid/acc': 57.089, 'valid/acc_unbiased': 54.835, 'valid/diff': 4.906, 'valid/acc_skew': 52.382, 'valid/acc_align': 57.288, 'test/acc': 56.835, 'test/acc_unbiased': 55.552, 'test/diff': 1.327, 'test/acc_skew': 54.889, 'test/acc_align': 56.216}
[3 / 20] best valid accuracy: 54.835 at epoch 3 
 best_stats: {'best_valid_epoch': 3, 'best_valid_valid/acc': 57.089, 'best_valid_valid/acc_unbiased': 54.835, 'best_valid_valid/diff': 4.906, 'best_valid_valid/acc_skew': 52.382, 'best_valid_valid/acc_align': 57.288, 'best_valid_test/acc': 56.835, 'best_valid_test/acc_unbiased': 55.552, 'best_valid_test/diff': 1.327, 'best_valid_test/acc_skew': 54.889, 'best_valid_test/acc_align': 56.216}
[3 / 20] best test accuracy: 55.552 at epoch 3 
 best_stats: {'best_test_epoch': 3, 'best_test_valid/acc': 57.089, 'best_test_valid/acc_unbiased': 54.835, 'best_test_valid/diff': 4.906, 'best_test_valid/acc_skew': 52.382, 'best_test_valid/acc_align': 57.288, 'best_test_test/acc': 56.835, 'best_test_test/acc_unbiased': 55.552, 'best_test_test/diff': 1.327, 'best_test_test/acc_skew': 54.889, 'best_test_test/acc_align': 56.216}
[4 / 20] Learning rate: 0.001 weight: 0.01
[4 / 20] Loss: 0.007412684955992377 CE Loss: 0.741268515586853 Con Loss: 0.0
[4 / 20] tensor([[0.726, 0.734],
        [0.366, 0.434]]) {'epoch': 4, 'valid/acc': 57.511, 'valid/acc_unbiased': 55.992, 'valid/diff': 5.181, 'valid/acc_skew': 53.402, 'valid/acc_align': 58.583, 'test/acc': 57.511, 'test/acc_unbiased': 56.49, 'test/diff': 3.82, 'test/acc_skew': 54.58, 'test/acc_align': 58.4}
[4 / 20] best valid accuracy: 55.992 at epoch 4 
 best_stats: {'best_valid_epoch': 4, 'best_valid_valid/acc': 57.511, 'best_valid_valid/acc_unbiased': 55.992, 'best_valid_valid/diff': 5.181, 'best_valid_valid/acc_skew': 53.402, 'best_valid_valid/acc_align': 58.583, 'best_valid_test/acc': 57.511, 'best_valid_test/acc_unbiased': 56.49, 'best_valid_test/diff': 3.82, 'best_valid_test/acc_skew': 54.58, 'best_valid_test/acc_align': 58.4}
[4 / 20] best test accuracy: 56.490 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 57.511, 'best_test_valid/acc_unbiased': 55.992, 'best_test_valid/diff': 5.181, 'best_test_valid/acc_skew': 53.402, 'best_test_valid/acc_align': 58.583, 'best_test_test/acc': 57.511, 'best_test_test/acc_unbiased': 56.49, 'best_test_test/diff': 3.82, 'best_test_test/acc_skew': 54.58, 'best_test_test/acc_align': 58.4}
[5 / 20] Learning rate: 0.001 weight: 0.01
[5 / 20] Loss: 0.008379765517579822 CE Loss: 0.8379765657278208 Con Loss: 0.0
[5 / 20] tensor([[0.321, 0.332],
        [0.792, 0.785]]) {'epoch': 5, 'valid/acc': 54.726, 'valid/acc_unbiased': 56.33, 'valid/diff': 2.223, 'valid/acc_skew': 56.253, 'valid/acc_align': 56.407, 'test/acc': 54.768, 'test/acc_unbiased': 55.747, 'test/diff': 0.961, 'test/acc_skew': 55.65, 'test/acc_align': 55.845}
[5 / 20] best valid accuracy: 56.330 at epoch 5 
 best_stats: {'best_valid_epoch': 5, 'best_valid_valid/acc': 54.726, 'best_valid_valid/acc_unbiased': 56.33, 'best_valid_valid/diff': 2.223, 'best_valid_valid/acc_skew': 56.253, 'best_valid_valid/acc_align': 56.407, 'best_valid_test/acc': 54.768, 'best_valid_test/acc_unbiased': 55.747, 'best_valid_test/diff': 0.961, 'best_valid_test/acc_skew': 55.65, 'best_valid_test/acc_align': 55.845}
[5 / 20] best test accuracy: 56.490 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 57.511, 'best_test_valid/acc_unbiased': 55.992, 'best_test_valid/diff': 5.181, 'best_test_valid/acc_skew': 53.402, 'best_test_valid/acc_align': 58.583, 'best_test_test/acc': 57.511, 'best_test_test/acc_unbiased': 56.49, 'best_test_test/diff': 3.82, 'best_test_test/acc_skew': 54.58, 'best_test_test/acc_align': 58.4}
[6 / 20] Learning rate: 0.001 weight: 0.01
[6 / 20] Loss: 0.00861620602126305 CE Loss: 0.8616206187468308 Con Loss: 0.0
[6 / 20] tensor([[0.624, 0.644],
        [0.485, 0.419]]) {'epoch': 6, 'valid/acc': 56.92, 'valid/acc_unbiased': 56.488, 'valid/diff': 5.846, 'valid/acc_skew': 57.864, 'valid/acc_align': 55.113, 'test/acc': 54.43, 'test/acc_unbiased': 54.289, 'test/diff': 4.31, 'test/acc_skew': 55.425, 'test/acc_align': 53.152}
[6 / 20] best valid accuracy: 56.488 at epoch 6 
 best_stats: {'best_valid_epoch': 6, 'best_valid_valid/acc': 56.92, 'best_valid_valid/acc_unbiased': 56.488, 'best_valid_valid/diff': 5.846, 'best_valid_valid/acc_skew': 57.864, 'best_valid_valid/acc_align': 55.113, 'best_valid_test/acc': 54.43, 'best_valid_test/acc_unbiased': 54.289, 'best_valid_test/diff': 4.31, 'best_valid_test/acc_skew': 55.425, 'best_valid_test/acc_align': 53.152}
[6 / 20] best test accuracy: 56.490 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 57.511, 'best_test_valid/acc_unbiased': 55.992, 'best_test_valid/diff': 5.181, 'best_test_valid/acc_skew': 53.402, 'best_test_valid/acc_align': 58.583, 'best_test_test/acc': 57.511, 'best_test_test/acc_unbiased': 56.49, 'best_test_test/diff': 3.82, 'best_test_test/acc_skew': 54.58, 'best_test_test/acc_align': 58.4}
[7 / 20] Learning rate: 0.0001 weight: 0.01
[7 / 20] Loss: 0.0065522841894282745 CE Loss: 0.655228425677006 Con Loss: 0.0
[7 / 20] tensor([[0.858, 0.876],
        [0.249, 0.160]]) {'epoch': 7, 'valid/acc': 55.359, 'valid/acc_unbiased': 53.333, 'valid/diff': 5.561, 'valid/acc_skew': 55.002, 'valid/acc_align': 51.664, 'test/acc': 54.641, 'test/acc_unbiased': 53.593, 'test/diff': 5.297, 'test/acc_skew': 55.367, 'test/acc_align': 51.82}
[7 / 20] best valid accuracy: 56.488 at epoch 6 
 best_stats: {'best_valid_epoch': 6, 'best_valid_valid/acc': 56.92, 'best_valid_valid/acc_unbiased': 56.488, 'best_valid_valid/diff': 5.846, 'best_valid_valid/acc_skew': 57.864, 'best_valid_valid/acc_align': 55.113, 'best_valid_test/acc': 54.43, 'best_valid_test/acc_unbiased': 54.289, 'best_valid_test/diff': 4.31, 'best_valid_test/acc_skew': 55.425, 'best_valid_test/acc_align': 53.152}
[7 / 20] best test accuracy: 56.490 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 57.511, 'best_test_valid/acc_unbiased': 55.992, 'best_test_valid/diff': 5.181, 'best_test_valid/acc_skew': 53.402, 'best_test_valid/acc_align': 58.583, 'best_test_test/acc': 57.511, 'best_test_test/acc_unbiased': 56.49, 'best_test_test/diff': 3.82, 'best_test_test/acc_skew': 54.58, 'best_test_test/acc_align': 58.4}
[8 / 20] Learning rate: 0.0001 weight: 0.01
[8 / 20] Loss: 0.007032466864284988 CE Loss: 0.7032467046609292 Con Loss: 0.0
[8 / 20] tensor([[0.686, 0.737],
        [0.494, 0.364]]) {'epoch': 8, 'valid/acc': 58.27, 'valid/acc_unbiased': 57.464, 'valid/diff': 9.237, 'valid/acc_skew': 58.367, 'valid/acc_align': 56.562, 'test/acc': 57.173, 'test/acc_unbiased': 57.025, 'test/diff': 9.008, 'test/acc_skew': 58.994, 'test/acc_align': 55.056}
[8 / 20] best valid accuracy: 57.464 at epoch 8 
 best_stats: {'best_valid_epoch': 8, 'best_valid_valid/acc': 58.27, 'best_valid_valid/acc_unbiased': 57.464, 'best_valid_valid/diff': 9.237, 'best_valid_valid/acc_skew': 58.367, 'best_valid_valid/acc_align': 56.562, 'best_valid_test/acc': 57.173, 'best_valid_test/acc_unbiased': 57.025, 'best_valid_test/diff': 9.008, 'best_valid_test/acc_skew': 58.994, 'best_valid_test/acc_align': 55.056}
[8 / 20] best test accuracy: 57.025 at epoch 8 
 best_stats: {'best_test_epoch': 8, 'best_test_valid/acc': 58.27, 'best_test_valid/acc_unbiased': 57.464, 'best_test_valid/diff': 9.237, 'best_test_valid/acc_skew': 58.367, 'best_test_valid/acc_align': 56.562, 'best_test_test/acc': 57.173, 'best_test_test/acc_unbiased': 57.025, 'best_test_test/diff': 9.008, 'best_test_test/acc_skew': 58.994, 'best_test_test/acc_align': 55.056}
[9 / 20] Learning rate: 0.0001 weight: 0.01
[9 / 20] Loss: 0.00738131134914091 CE Loss: 0.7381311494570512 Con Loss: 0.0
[9 / 20] tensor([[0.681, 0.727],
        [0.537, 0.395]]) {'epoch': 9, 'valid/acc': 57.595, 'valid/acc_unbiased': 57.125, 'valid/diff': 10.273, 'valid/acc_skew': 59.369, 'valid/acc_align': 54.88, 'test/acc': 58.481, 'test/acc_unbiased': 58.495, 'test/diff': 9.364, 'test/acc_skew': 60.89, 'test/acc_align': 56.099}
[9 / 20] best valid accuracy: 57.464 at epoch 8 
 best_stats: {'best_valid_epoch': 8, 'best_valid_valid/acc': 58.27, 'best_valid_valid/acc_unbiased': 57.464, 'best_valid_valid/diff': 9.237, 'best_valid_valid/acc_skew': 58.367, 'best_valid_valid/acc_align': 56.562, 'best_valid_test/acc': 57.173, 'best_valid_test/acc_unbiased': 57.025, 'best_valid_test/diff': 9.008, 'best_valid_test/acc_skew': 58.994, 'best_valid_test/acc_align': 55.056}
[9 / 20] best test accuracy: 58.495 at epoch 9 
 best_stats: {'best_test_epoch': 9, 'best_test_valid/acc': 57.595, 'best_test_valid/acc_unbiased': 57.125, 'best_test_valid/diff': 10.273, 'best_test_valid/acc_skew': 59.369, 'best_test_valid/acc_align': 54.88, 'best_test_test/acc': 58.481, 'best_test_test/acc_unbiased': 58.495, 'best_test_test/diff': 9.364, 'best_test_test/acc_skew': 60.89, 'best_test_test/acc_align': 56.099}
[10 / 20] Learning rate: 0.0001 weight: 0.01
[10 / 20] Loss: 0.006198082190866654 CE Loss: 0.61980822797005 Con Loss: 0.0
[10 / 20] tensor([[0.473, 0.558],
        [0.684, 0.551]]) {'epoch': 10, 'valid/acc': 56.203, 'valid/acc_unbiased': 56.777, 'valid/diff': 11.226, 'valid/acc_skew': 57.431, 'valid/acc_align': 56.123, 'test/acc': 56.076, 'test/acc_unbiased': 56.668, 'test/diff': 10.897, 'test/acc_skew': 57.855, 'test/acc_align': 55.48}
[10 / 20] best valid accuracy: 57.464 at epoch 8 
 best_stats: {'best_valid_epoch': 8, 'best_valid_valid/acc': 58.27, 'best_valid_valid/acc_unbiased': 57.464, 'best_valid_valid/diff': 9.237, 'best_valid_valid/acc_skew': 58.367, 'best_valid_valid/acc_align': 56.562, 'best_valid_test/acc': 57.173, 'best_valid_test/acc_unbiased': 57.025, 'best_valid_test/diff': 9.008, 'best_valid_test/acc_skew': 58.994, 'best_valid_test/acc_align': 55.056}
[10 / 20] best test accuracy: 58.495 at epoch 9 
 best_stats: {'best_test_epoch': 9, 'best_test_valid/acc': 57.595, 'best_test_valid/acc_unbiased': 57.125, 'best_test_valid/diff': 10.273, 'best_test_valid/acc_skew': 59.369, 'best_test_valid/acc_align': 54.88, 'best_test_test/acc': 58.481, 'best_test_test/acc_unbiased': 58.495, 'best_test_test/diff': 9.364, 'best_test_test/acc_skew': 60.89, 'best_test_test/acc_align': 56.099}
[11 / 20] Learning rate: 0.0001 weight: 0.01
[11 / 20] Loss: 0.006571509248505418 CE Loss: 0.6571509425456707 Con Loss: 0.0
[11 / 20] tensor([[0.550, 0.654],
        [0.626, 0.484]]) {'epoch': 11, 'valid/acc': 57.131, 'valid/acc_unbiased': 57.102, 'valid/diff': 11.178, 'valid/acc_skew': 57.647, 'valid/acc_align': 56.557, 'test/acc': 57.595, 'test/acc_unbiased': 57.862, 'test/diff': 12.266, 'test/acc_skew': 58.786, 'test/acc_align': 56.938}
[11 / 20] best valid accuracy: 57.464 at epoch 8 
 best_stats: {'best_valid_epoch': 8, 'best_valid_valid/acc': 58.27, 'best_valid_valid/acc_unbiased': 57.464, 'best_valid_valid/diff': 9.237, 'best_valid_valid/acc_skew': 58.367, 'best_valid_valid/acc_align': 56.562, 'best_valid_test/acc': 57.173, 'best_valid_test/acc_unbiased': 57.025, 'best_valid_test/diff': 9.008, 'best_valid_test/acc_skew': 58.994, 'best_valid_test/acc_align': 55.056}
[11 / 20] best test accuracy: 58.495 at epoch 9 
 best_stats: {'best_test_epoch': 9, 'best_test_valid/acc': 57.595, 'best_test_valid/acc_unbiased': 57.125, 'best_test_valid/diff': 10.273, 'best_test_valid/acc_skew': 59.369, 'best_test_valid/acc_align': 54.88, 'best_test_test/acc': 58.481, 'best_test_test/acc_unbiased': 58.495, 'best_test_test/diff': 9.364, 'best_test_test/acc_skew': 60.89, 'best_test_test/acc_align': 56.099}
[12 / 20] Learning rate: 0.0001 weight: 0.01
[12 / 20] Loss: 0.006530230936522667 CE Loss: 0.6530231042550161 Con Loss: 0.0
[12 / 20] tensor([[0.556, 0.641],
        [0.632, 0.505]]) {'epoch': 12, 'valid/acc': 57.511, 'valid/acc_unbiased': 57.594, 'valid/diff': 9.752, 'valid/acc_skew': 58.179, 'valid/acc_align': 57.009, 'test/acc': 58.059, 'test/acc_unbiased': 58.346, 'test/diff': 10.617, 'test/acc_skew': 59.38, 'test/acc_align': 57.313}
[12 / 20] best valid accuracy: 57.594 at epoch 12 
 best_stats: {'best_valid_epoch': 12, 'best_valid_valid/acc': 57.511, 'best_valid_valid/acc_unbiased': 57.594, 'best_valid_valid/diff': 9.752, 'best_valid_valid/acc_skew': 58.179, 'best_valid_valid/acc_align': 57.009, 'best_valid_test/acc': 58.059, 'best_valid_test/acc_unbiased': 58.346, 'best_valid_test/diff': 10.617, 'best_valid_test/acc_skew': 59.38, 'best_valid_test/acc_align': 57.313}
[12 / 20] best test accuracy: 58.495 at epoch 9 
 best_stats: {'best_test_epoch': 9, 'best_test_valid/acc': 57.595, 'best_test_valid/acc_unbiased': 57.125, 'best_test_valid/diff': 10.273, 'best_test_valid/acc_skew': 59.369, 'best_test_valid/acc_align': 54.88, 'best_test_test/acc': 58.481, 'best_test_test/acc_unbiased': 58.495, 'best_test_test/diff': 9.364, 'best_test_test/acc_skew': 60.89, 'best_test_test/acc_align': 56.099}
[13 / 20] Learning rate: 0.0001 weight: 0.01
[13 / 20] Loss: 0.00635781017347024 CE Loss: 0.6357810336809891 Con Loss: 0.0
[13 / 20] tensor([[0.516, 0.597],
        [0.652, 0.548]]) {'epoch': 13, 'valid/acc': 57.384, 'valid/acc_unbiased': 57.667, 'valid/diff': 12.667, 'valid/acc_skew': 57.28, 'valid/acc_align': 58.054, 'test/acc': 57.468, 'test/acc_unbiased': 57.817, 'test/diff': 9.192, 'test/acc_skew': 58.382, 'test/acc_align': 57.252}
[13 / 20] best valid accuracy: 57.667 at epoch 13 
 best_stats: {'best_valid_epoch': 13, 'best_valid_valid/acc': 57.384, 'best_valid_valid/acc_unbiased': 57.667, 'best_valid_valid/diff': 12.667, 'best_valid_valid/acc_skew': 57.28, 'best_valid_valid/acc_align': 58.054, 'best_valid_test/acc': 57.468, 'best_valid_test/acc_unbiased': 57.817, 'best_valid_test/diff': 9.192, 'best_valid_test/acc_skew': 58.382, 'best_valid_test/acc_align': 57.252}
[13 / 20] best test accuracy: 58.495 at epoch 9 
 best_stats: {'best_test_epoch': 9, 'best_test_valid/acc': 57.595, 'best_test_valid/acc_unbiased': 57.125, 'best_test_valid/diff': 10.273, 'best_test_valid/acc_skew': 59.369, 'best_test_valid/acc_align': 54.88, 'best_test_test/acc': 58.481, 'best_test_test/acc_unbiased': 58.495, 'best_test_test/diff': 9.364, 'best_test_test/acc_skew': 60.89, 'best_test_test/acc_align': 56.099}
[14 / 20] Learning rate: 1e-05 weight: 0.01
[14 / 20] Loss: 0.006898383439805072 CE Loss: 0.6898383624278582 Con Loss: 0.0
[14 / 20] tensor([[0.634, 0.696],
        [0.526, 0.449]]) {'epoch': 14, 'valid/acc': 58.861, 'valid/acc_unbiased': 58.394, 'valid/diff': 10.36, 'valid/acc_skew': 58.966, 'valid/acc_align': 57.822, 'test/acc': 57.806, 'test/acc_unbiased': 57.621, 'test/diff': 6.927, 'test/acc_skew': 58.019, 'test/acc_align': 57.223}
[14 / 20] best valid accuracy: 58.394 at epoch 14 
 best_stats: {'best_valid_epoch': 14, 'best_valid_valid/acc': 58.861, 'best_valid_valid/acc_unbiased': 58.394, 'best_valid_valid/diff': 10.36, 'best_valid_valid/acc_skew': 58.966, 'best_valid_valid/acc_align': 57.822, 'best_valid_test/acc': 57.806, 'best_valid_test/acc_unbiased': 57.621, 'best_valid_test/diff': 6.927, 'best_valid_test/acc_skew': 58.019, 'best_valid_test/acc_align': 57.223}
[14 / 20] best test accuracy: 58.495 at epoch 9 
 best_stats: {'best_test_epoch': 9, 'best_test_valid/acc': 57.595, 'best_test_valid/acc_unbiased': 57.125, 'best_test_valid/diff': 10.273, 'best_test_valid/acc_skew': 59.369, 'best_test_valid/acc_align': 54.88, 'best_test_test/acc': 58.481, 'best_test_test/acc_unbiased': 58.495, 'best_test_test/diff': 9.364, 'best_test_test/acc_skew': 60.89, 'best_test_test/acc_align': 56.099}
[15 / 20] Learning rate: 1e-05 weight: 0.01
[15 / 20] Loss: 0.006455345285268357 CE Loss: 0.6455345405982091 Con Loss: 0.0
[15 / 20] tensor([[0.701, 0.753],
        [0.470, 0.368]]) {'epoch': 15, 'valid/acc': 57.806, 'valid/acc_unbiased': 57.029, 'valid/diff': 11.714, 'valid/acc_skew': 57.518, 'valid/acc_align': 56.54, 'test/acc': 57.637, 'test/acc_unbiased': 57.306, 'test/diff': 7.69, 'test/acc_skew': 58.521, 'test/acc_align': 56.091}
[15 / 20] best valid accuracy: 58.394 at epoch 14 
 best_stats: {'best_valid_epoch': 14, 'best_valid_valid/acc': 58.861, 'best_valid_valid/acc_unbiased': 58.394, 'best_valid_valid/diff': 10.36, 'best_valid_valid/acc_skew': 58.966, 'best_valid_valid/acc_align': 57.822, 'best_valid_test/acc': 57.806, 'best_valid_test/acc_unbiased': 57.621, 'best_valid_test/diff': 6.927, 'best_valid_test/acc_skew': 58.019, 'best_valid_test/acc_align': 57.223}
[15 / 20] best test accuracy: 58.495 at epoch 9 
 best_stats: {'best_test_epoch': 9, 'best_test_valid/acc': 57.595, 'best_test_valid/acc_unbiased': 57.125, 'best_test_valid/diff': 10.273, 'best_test_valid/acc_skew': 59.369, 'best_test_valid/acc_align': 54.88, 'best_test_test/acc': 58.481, 'best_test_test/acc_unbiased': 58.495, 'best_test_test/diff': 9.364, 'best_test_test/acc_skew': 60.89, 'best_test_test/acc_align': 56.099}
[16 / 20] Learning rate: 1e-05 weight: 0.01
[16 / 20] Loss: 0.006323985683803375 CE Loss: 0.6323985801293299 Con Loss: 0.0
[16 / 20] tensor([[0.563, 0.653],
        [0.597, 0.507]]) {'epoch': 16, 'valid/acc': 58.608, 'valid/acc_unbiased': 58.632, 'valid/diff': 11.622, 'valid/acc_skew': 58.874, 'valid/acc_align': 58.389, 'test/acc': 57.932, 'test/acc_unbiased': 57.992, 'test/diff': 9.044, 'test/acc_skew': 58.006, 'test/acc_align': 57.978}
[16 / 20] best valid accuracy: 58.632 at epoch 16 
 best_stats: {'best_valid_epoch': 16, 'best_valid_valid/acc': 58.608, 'best_valid_valid/acc_unbiased': 58.632, 'best_valid_valid/diff': 11.622, 'best_valid_valid/acc_skew': 58.874, 'best_valid_valid/acc_align': 58.389, 'best_valid_test/acc': 57.932, 'best_valid_test/acc_unbiased': 57.992, 'best_valid_test/diff': 9.044, 'best_valid_test/acc_skew': 58.006, 'best_valid_test/acc_align': 57.978}
[16 / 20] best test accuracy: 58.495 at epoch 9 
 best_stats: {'best_test_epoch': 9, 'best_test_valid/acc': 57.595, 'best_test_valid/acc_unbiased': 57.125, 'best_test_valid/diff': 10.273, 'best_test_valid/acc_skew': 59.369, 'best_test_valid/acc_align': 54.88, 'best_test_test/acc': 58.481, 'best_test_test/acc_unbiased': 58.495, 'best_test_test/diff': 9.364, 'best_test_test/acc_skew': 60.89, 'best_test_test/acc_align': 56.099}
[17 / 20] Learning rate: 1e-05 weight: 0.01
[17 / 20] Loss: 0.005757684407469172 CE Loss: 0.5757684501317831 Con Loss: 0.0
[17 / 20] tensor([[0.681, 0.727],
        [0.485, 0.403]]) {'epoch': 17, 'valid/acc': 58.101, 'valid/acc_unbiased': 57.432, 'valid/diff': 10.247, 'valid/acc_skew': 58.026, 'valid/acc_align': 56.837, 'test/acc': 57.679, 'test/acc_unbiased': 57.382, 'test/diff': 6.395, 'test/acc_skew': 58.293, 'test/acc_align': 56.471}
[17 / 20] best valid accuracy: 58.632 at epoch 16 
 best_stats: {'best_valid_epoch': 16, 'best_valid_valid/acc': 58.608, 'best_valid_valid/acc_unbiased': 58.632, 'best_valid_valid/diff': 11.622, 'best_valid_valid/acc_skew': 58.874, 'best_valid_valid/acc_align': 58.389, 'best_valid_test/acc': 57.932, 'best_valid_test/acc_unbiased': 57.992, 'best_valid_test/diff': 9.044, 'best_valid_test/acc_skew': 58.006, 'best_valid_test/acc_align': 57.978}
[17 / 20] best test accuracy: 58.495 at epoch 9 
 best_stats: {'best_test_epoch': 9, 'best_test_valid/acc': 57.595, 'best_test_valid/acc_unbiased': 57.125, 'best_test_valid/diff': 10.273, 'best_test_valid/acc_skew': 59.369, 'best_test_valid/acc_align': 54.88, 'best_test_test/acc': 58.481, 'best_test_test/acc_unbiased': 58.495, 'best_test_test/diff': 9.364, 'best_test_test/acc_skew': 60.89, 'best_test_test/acc_align': 56.099}
[18 / 20] Learning rate: 1e-05 weight: 0.01
[18 / 20] Loss: 0.006585622349610696 CE Loss: 0.6585622521547171 Con Loss: 0.0
[18 / 20] tensor([[0.695, 0.749],
        [0.485, 0.377]]) {'epoch': 18, 'valid/acc': 58.565, 'valid/acc_unbiased': 57.892, 'valid/diff': 10.569, 'valid/acc_skew': 58.822, 'valid/acc_align': 56.962, 'test/acc': 57.932, 'test/acc_unbiased': 57.662, 'test/diff': 8.049, 'test/acc_skew': 59.009, 'test/acc_align': 56.315}
[18 / 20] best valid accuracy: 58.632 at epoch 16 
 best_stats: {'best_valid_epoch': 16, 'best_valid_valid/acc': 58.608, 'best_valid_valid/acc_unbiased': 58.632, 'best_valid_valid/diff': 11.622, 'best_valid_valid/acc_skew': 58.874, 'best_valid_valid/acc_align': 58.389, 'best_valid_test/acc': 57.932, 'best_valid_test/acc_unbiased': 57.992, 'best_valid_test/diff': 9.044, 'best_valid_test/acc_skew': 58.006, 'best_valid_test/acc_align': 57.978}
[18 / 20] best test accuracy: 58.495 at epoch 9 
 best_stats: {'best_test_epoch': 9, 'best_test_valid/acc': 57.595, 'best_test_valid/acc_unbiased': 57.125, 'best_test_valid/diff': 10.273, 'best_test_valid/acc_skew': 59.369, 'best_test_valid/acc_align': 54.88, 'best_test_test/acc': 58.481, 'best_test_test/acc_unbiased': 58.495, 'best_test_test/diff': 9.364, 'best_test_test/acc_skew': 60.89, 'best_test_test/acc_align': 56.099}
[19 / 20] Learning rate: 1e-05 weight: 0.01
[19 / 20] Loss: 0.007341018895833538 CE Loss: 0.7341019006875845 Con Loss: 0.0
[19 / 20] tensor([[0.530, 0.612],
        [0.621, 0.553]]) {'epoch': 19, 'valid/acc': 58.059, 'valid/acc_unbiased': 58.16, 'valid/diff': 11.319, 'valid/acc_skew': 57.153, 'valid/acc_align': 59.168, 'test/acc': 57.764, 'test/acc_unbiased': 57.899, 'test/diff': 7.476, 'test/acc_skew': 57.584, 'test/acc_align': 58.214}
[19 / 20] best valid accuracy: 58.632 at epoch 16 
 best_stats: {'best_valid_epoch': 16, 'best_valid_valid/acc': 58.608, 'best_valid_valid/acc_unbiased': 58.632, 'best_valid_valid/diff': 11.622, 'best_valid_valid/acc_skew': 58.874, 'best_valid_valid/acc_align': 58.389, 'best_valid_test/acc': 57.932, 'best_valid_test/acc_unbiased': 57.992, 'best_valid_test/diff': 9.044, 'best_valid_test/acc_skew': 58.006, 'best_valid_test/acc_align': 57.978}
[19 / 20] best test accuracy: 58.495 at epoch 9 
 best_stats: {'best_test_epoch': 9, 'best_test_valid/acc': 57.595, 'best_test_valid/acc_unbiased': 57.125, 'best_test_valid/diff': 10.273, 'best_test_valid/acc_skew': 59.369, 'best_test_valid/acc_align': 54.88, 'best_test_test/acc': 58.481, 'best_test_test/acc_unbiased': 58.495, 'best_test_test/diff': 9.364, 'best_test_test/acc_skew': 60.89, 'best_test_test/acc_align': 56.099}
[20 / 20] Learning rate: 1e-05 weight: 0.01
[20 / 20] Loss: 0.006078574896002045 CE Loss: 0.6078575047162863 Con Loss: 0.0
[20 / 20] tensor([[0.692, 0.733],
        [0.483, 0.391]]) {'epoch': 20, 'valid/acc': 58.439, 'valid/acc_unbiased': 57.769, 'valid/diff': 10.303, 'valid/acc_skew': 58.245, 'valid/acc_align': 57.293, 'test/acc': 57.722, 'test/acc_unbiased': 57.447, 'test/diff': 6.639, 'test/acc_skew': 58.722, 'test/acc_align': 56.172}
[20 / 20] best valid accuracy: 58.632 at epoch 16 
 best_stats: {'best_valid_epoch': 16, 'best_valid_valid/acc': 58.608, 'best_valid_valid/acc_unbiased': 58.632, 'best_valid_valid/diff': 11.622, 'best_valid_valid/acc_skew': 58.874, 'best_valid_valid/acc_align': 58.389, 'best_valid_test/acc': 57.932, 'best_valid_test/acc_unbiased': 57.992, 'best_valid_test/diff': 9.044, 'best_valid_test/acc_skew': 58.006, 'best_valid_test/acc_align': 57.978}
[20 / 20] best test accuracy: 58.495 at epoch 9 
 best_stats: {'best_test_epoch': 9, 'best_test_valid/acc': 57.595, 'best_test_valid/acc_unbiased': 57.125, 'best_test_valid/diff': 10.273, 'best_test_valid/acc_skew': 59.369, 'best_test_valid/acc_align': 54.88, 'best_test_test/acc': 58.481, 'best_test_test/acc_unbiased': 58.495, 'best_test_test/diff': 9.364, 'best_test_test/acc_skew': 60.89, 'best_test_test/acc_align': 56.099}
Total training time: 0:13:01
