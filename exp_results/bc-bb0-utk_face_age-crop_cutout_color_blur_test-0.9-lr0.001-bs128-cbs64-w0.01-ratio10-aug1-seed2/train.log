Log level set to: INFO
Set seed: 2
=======> Using Fixed Random Seed: 2 <========
save_path: exp_results/bc-bb0-utk_face_age-crop_cutout_color_blur_test-0.9-lr0.001-bs128-cbs64-w0.01-ratio10-aug1-seed2
get_utk_face - split: train, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_age-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
Binary Target 1
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Normal Label Distribution: 
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
Binary Target 1
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Normal Label Distribution: 
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 10684, target_attr: gender, bias_attr: age bias_rate: 0.9
['[train] target_0-bias_0: 8237', '[train] target_0-bias_1: 147', '[train] target_1-bias_0: 823', '[train] target_1-bias_1: 1477']
confusion_matrix - 
 original: tensor([[8237.,  823.],
        [ 147., 1477.]]), 
 normalized: tensor([[0.909, 0.091],
        [0.091, 0.909]]), 
 b|y: tensor([[0.982, 0.018],
        [0.358, 0.642]])
get_utk_face - split: train, aug: 1, given_y: True, ratio: 10
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_age-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
Binary Target 1
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Normal Label Distribution: 
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
Binary Target 1
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Normal Label Distribution: 
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 10684, target_attr: gender, bias_attr: age bias_rate: 0.9
['[train] target_0-bias_0: 8237', '[train] target_0-bias_1: 147', '[train] target_1-bias_0: 823', '[train] target_1-bias_1: 1477']
get_utk_face - split: valid, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_age-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [1030, 195]
Target 1: [841, 202]
Binary Target 1
---------------------------
Target 0: [1030, 195]
Target 1: [841, 202]
===================================
Normal Label Distribution: 
Target 0: [1030, 195]
Target 1: [841, 202]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 2268, target_attr: gender, bias_attr: age bias_rate: 0.9
['[valid] target_0-bias_0: 1030', '[valid] target_0-bias_1: 195', '[valid] target_1-bias_0: 841', '[valid] target_1-bias_1: 202']
get_utk_face - split: test, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_age-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [1061, 176]
Target 1: [867, 165]
Binary Target 1
---------------------------
Target 0: [1061, 176]
Target 1: [867, 165]
===================================
Normal Label Distribution: 
Target 0: [1061, 176]
Target 1: [867, 165]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 2269, target_attr: gender, bias_attr: age bias_rate: 0.9
['[test] target_0-bias_0: 1061', '[test] target_0-bias_1: 176', '[test] target_1-bias_0: 867', '[test] target_1-bias_1: 165']
decay_epochs: [6, 13]
[1 / 20] Learning rate: 0.001 weight: 0.01
[1 / 20] Loss: 4.889565330906692 CE Loss: 0.5585687867781055 Con Loss: 4.883979641154927
[1 / 20] tensor([[1., 1.],
        [0., 0.]]) {'epoch': 1, 'valid/acc': 54.145, 'valid/acc_unbiased': 50.089, 'valid/diff': 0.178, 'valid/acc_skew': 50.178, 'valid/acc_align': 50.0, 'test/acc': 54.517, 'test/acc_unbiased': 50.0, 'test/diff': 0.0, 'test/acc_skew': 50.0, 'test/acc_align': 50.0}
[1 / 20] best valid accuracy: 50.089 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 54.145, 'best_valid_valid/acc_unbiased': 50.089, 'best_valid_valid/diff': 0.178, 'best_valid_valid/acc_skew': 50.178, 'best_valid_valid/acc_align': 50.0, 'best_valid_test/acc': 54.517, 'best_valid_test/acc_unbiased': 50.0, 'best_valid_test/diff': 0.0, 'best_valid_test/acc_skew': 50.0, 'best_valid_test/acc_align': 50.0}
[1 / 20] best test accuracy: 50.000 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 54.145, 'best_test_valid/acc_unbiased': 50.089, 'best_test_valid/diff': 0.178, 'best_test_valid/acc_skew': 50.178, 'best_test_valid/acc_align': 50.0, 'best_test_test/acc': 54.517, 'best_test_test/acc_unbiased': 50.0, 'best_test_test/diff': 0.0, 'best_test_test/acc_skew': 50.0, 'best_test_test/acc_align': 50.0}
[2 / 20] Learning rate: 0.001 weight: 0.01
[2 / 20] Loss: 4.729203600153322 CE Loss: 0.5301284399741333 Con Loss: 4.723902336714732
[2 / 20] tensor([[0.989, 0.977],
        [0.111, 0.067]]) {'epoch': 2, 'valid/acc': 57.011, 'valid/acc_unbiased': 52.563, 'valid/diff': 2.758, 'valid/acc_skew': 53.277, 'valid/acc_align': 51.849, 'test/acc': 58.528, 'test/acc_unbiased': 53.584, 'test/diff': 2.774, 'test/acc_skew': 54.4, 'test/acc_align': 52.768}
[2 / 20] best valid accuracy: 52.563 at epoch 2 
 best_stats: {'best_valid_epoch': 2, 'best_valid_valid/acc': 57.011, 'best_valid_valid/acc_unbiased': 52.563, 'best_valid_valid/diff': 2.758, 'best_valid_valid/acc_skew': 53.277, 'best_valid_valid/acc_align': 51.849, 'best_valid_test/acc': 58.528, 'best_valid_test/acc_unbiased': 53.584, 'best_valid_test/diff': 2.774, 'best_valid_test/acc_skew': 54.4, 'best_valid_test/acc_align': 52.768}
[2 / 20] best test accuracy: 53.584 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 57.011, 'best_test_valid/acc_unbiased': 52.563, 'best_test_valid/diff': 2.758, 'best_test_valid/acc_skew': 53.277, 'best_test_valid/acc_align': 51.849, 'best_test_test/acc': 58.528, 'best_test_test/acc_unbiased': 53.584, 'best_test_test/diff': 2.774, 'best_test_test/acc_skew': 54.4, 'best_test_test/acc_align': 52.768}
[3 / 20] Learning rate: 0.001 weight: 0.01
[3 / 20] Loss: 4.744906013443067 CE Loss: 0.5192115625742445 Con Loss: 4.7397138896572235
[3 / 20] tensor([[0.968, 0.989],
        [0.135, 0.018]]) {'epoch': 3, 'valid/acc': 58.818, 'valid/acc_unbiased': 53.775, 'valid/diff': 8.384, 'valid/acc_skew': 57.967, 'valid/acc_align': 49.582, 'test/acc': 58.219, 'test/acc_unbiased': 52.743, 'test/diff': 6.872, 'test/acc_skew': 56.179, 'test/acc_align': 49.307}
[3 / 20] best valid accuracy: 53.775 at epoch 3 
 best_stats: {'best_valid_epoch': 3, 'best_valid_valid/acc': 58.818, 'best_valid_valid/acc_unbiased': 53.775, 'best_valid_valid/diff': 8.384, 'best_valid_valid/acc_skew': 57.967, 'best_valid_valid/acc_align': 49.582, 'best_valid_test/acc': 58.219, 'best_valid_test/acc_unbiased': 52.743, 'best_valid_test/diff': 6.872, 'best_valid_test/acc_skew': 56.179, 'best_valid_test/acc_align': 49.307}
[3 / 20] best test accuracy: 53.584 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 57.011, 'best_test_valid/acc_unbiased': 52.563, 'best_test_valid/diff': 2.758, 'best_test_valid/acc_skew': 53.277, 'best_test_valid/acc_align': 51.849, 'best_test_test/acc': 58.528, 'best_test_test/acc_unbiased': 53.584, 'best_test_test/diff': 2.774, 'best_test_test/acc_skew': 54.4, 'best_test_test/acc_align': 52.768}
[4 / 20] Learning rate: 0.001 weight: 0.01
[4 / 20] Loss: 4.703323559205838 CE Loss: 0.5188111350224822 Con Loss: 4.698135457026383
[4 / 20] tensor([[0.933, 0.847],
        [0.518, 0.327]]) {'epoch': 4, 'valid/acc': 70.459, 'valid/acc_unbiased': 64.544, 'valid/diff': 12.683, 'valid/acc_skew': 67.984, 'valid/acc_align': 61.104, 'test/acc': 72.367, 'test/acc_unbiased': 65.621, 'test/diff': 13.855, 'test/acc_skew': 68.223, 'test/acc_align': 63.018}
[4 / 20] best valid accuracy: 64.544 at epoch 4 
 best_stats: {'best_valid_epoch': 4, 'best_valid_valid/acc': 70.459, 'best_valid_valid/acc_unbiased': 64.544, 'best_valid_valid/diff': 12.683, 'best_valid_valid/acc_skew': 67.984, 'best_valid_valid/acc_align': 61.104, 'best_valid_test/acc': 72.367, 'best_valid_test/acc_unbiased': 65.621, 'best_valid_test/diff': 13.855, 'best_valid_test/acc_skew': 68.223, 'best_valid_test/acc_align': 63.018}
[4 / 20] best test accuracy: 65.621 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 70.459, 'best_test_valid/acc_unbiased': 64.544, 'best_test_valid/diff': 12.683, 'best_test_valid/acc_skew': 67.984, 'best_test_valid/acc_align': 61.104, 'best_test_test/acc': 72.367, 'best_test_test/acc_unbiased': 65.621, 'best_test_test/diff': 13.855, 'best_test_test/acc_skew': 68.223, 'best_test_test/acc_align': 63.018}
[5 / 20] Learning rate: 0.001 weight: 0.01
[5 / 20] Loss: 4.696683655692057 CE Loss: 0.4972729512766835 Con Loss: 4.691710923058136
[5 / 20] tensor([[0.844, 0.773],
        [0.693, 0.412]]) {'epoch': 5, 'valid/acc': 73.942, 'valid/acc_unbiased': 67.334, 'valid/diff': 18.319, 'valid/acc_skew': 69.964, 'valid/acc_align': 64.704, 'test/acc': 74.967, 'test/acc_unbiased': 68.063, 'test/diff': 17.642, 'test/acc_skew': 73.296, 'test/acc_align': 62.83}
[5 / 20] best valid accuracy: 67.334 at epoch 5 
 best_stats: {'best_valid_epoch': 5, 'best_valid_valid/acc': 73.942, 'best_valid_valid/acc_unbiased': 67.334, 'best_valid_valid/diff': 18.319, 'best_valid_valid/acc_skew': 69.964, 'best_valid_valid/acc_align': 64.704, 'best_valid_test/acc': 74.967, 'best_valid_test/acc_unbiased': 68.063, 'best_valid_test/diff': 17.642, 'best_valid_test/acc_skew': 73.296, 'best_valid_test/acc_align': 62.83}
[5 / 20] best test accuracy: 68.063 at epoch 5 
 best_stats: {'best_test_epoch': 5, 'best_test_valid/acc': 73.942, 'best_test_valid/acc_unbiased': 67.334, 'best_test_valid/diff': 18.319, 'best_test_valid/acc_skew': 69.964, 'best_test_valid/acc_align': 64.704, 'best_test_test/acc': 74.967, 'best_test_test/acc_unbiased': 68.063, 'best_test_test/diff': 17.642, 'best_test_test/acc_skew': 73.296, 'best_test_test/acc_align': 62.83}
[6 / 20] Learning rate: 0.001 weight: 0.01
[6 / 20] Loss: 4.679864551368522 CE Loss: 0.496555966245954 Con Loss: 4.674898974505402
[6 / 20] tensor([[0.957, 0.960],
        [0.347, 0.139]]) {'epoch': 6, 'valid/acc': 66.005, 'valid/acc_unbiased': 59.264, 'valid/diff': 13.402, 'valid/acc_skew': 63.339, 'valid/acc_align': 55.188, 'test/acc': 66.461, 'test/acc_unbiased': 60.086, 'test/diff': 10.568, 'test/acc_skew': 65.37, 'test/acc_align': 54.802}
[6 / 20] best valid accuracy: 67.334 at epoch 5 
 best_stats: {'best_valid_epoch': 5, 'best_valid_valid/acc': 73.942, 'best_valid_valid/acc_unbiased': 67.334, 'best_valid_valid/diff': 18.319, 'best_valid_valid/acc_skew': 69.964, 'best_valid_valid/acc_align': 64.704, 'best_valid_test/acc': 74.967, 'best_valid_test/acc_unbiased': 68.063, 'best_valid_test/diff': 17.642, 'best_valid_test/acc_skew': 73.296, 'best_valid_test/acc_align': 62.83}
[6 / 20] best test accuracy: 68.063 at epoch 5 
 best_stats: {'best_test_epoch': 5, 'best_test_valid/acc': 73.942, 'best_test_valid/acc_unbiased': 67.334, 'best_test_valid/diff': 18.319, 'best_test_valid/acc_skew': 69.964, 'best_test_valid/acc_align': 64.704, 'best_test_test/acc': 74.967, 'best_test_test/acc_unbiased': 68.063, 'best_test_test/diff': 17.642, 'best_test_test/acc_skew': 73.296, 'best_test_test/acc_align': 62.83}
[7 / 20] Learning rate: 0.0001 weight: 0.01
[7 / 20] Loss: 4.629117737901831 CE Loss: 0.47970743933138177 Con Loss: 4.624320661472677
[7 / 20] tensor([[0.952, 0.943],
        [0.466, 0.206]]) {'epoch': 7, 'valid/acc': 70.326, 'valid/acc_unbiased': 63.673, 'valid/diff': 14.442, 'valid/acc_skew': 66.461, 'valid/acc_align': 60.886, 'test/acc': 71.133, 'test/acc_unbiased': 64.179, 'test/diff': 13.433, 'test/acc_skew': 70.458, 'test/acc_align': 57.9}
[7 / 20] best valid accuracy: 67.334 at epoch 5 
 best_stats: {'best_valid_epoch': 5, 'best_valid_valid/acc': 73.942, 'best_valid_valid/acc_unbiased': 67.334, 'best_valid_valid/diff': 18.319, 'best_valid_valid/acc_skew': 69.964, 'best_valid_valid/acc_align': 64.704, 'best_valid_test/acc': 74.967, 'best_valid_test/acc_unbiased': 68.063, 'best_valid_test/diff': 17.642, 'best_valid_test/acc_skew': 73.296, 'best_valid_test/acc_align': 62.83}
[7 / 20] best test accuracy: 68.063 at epoch 5 
 best_stats: {'best_test_epoch': 5, 'best_test_valid/acc': 73.942, 'best_test_valid/acc_unbiased': 67.334, 'best_test_valid/diff': 18.319, 'best_test_valid/acc_skew': 69.964, 'best_test_valid/acc_align': 64.704, 'best_test_test/acc': 74.967, 'best_test_test/acc_unbiased': 68.063, 'best_test_test/diff': 17.642, 'best_test_test/acc_skew': 73.296, 'best_test_test/acc_align': 62.83}
[8 / 20] Learning rate: 0.0001 weight: 0.01
[8 / 20] Loss: 4.602116187740827 CE Loss: 0.4830495538849011 Con Loss: 4.597285723784406
[8 / 20] tensor([[0.937, 0.898],
        [0.528, 0.279]]) {'epoch': 8, 'valid/acc': 72.178, 'valid/acc_unbiased': 65.449, 'valid/diff': 15.661, 'valid/acc_skew': 67.62, 'valid/acc_align': 63.278, 'test/acc': 72.984, 'test/acc_unbiased': 66.041, 'test/diff': 14.43, 'test/acc_skew': 71.299, 'test/acc_align': 60.782}
[8 / 20] best valid accuracy: 67.334 at epoch 5 
 best_stats: {'best_valid_epoch': 5, 'best_valid_valid/acc': 73.942, 'best_valid_valid/acc_unbiased': 67.334, 'best_valid_valid/diff': 18.319, 'best_valid_valid/acc_skew': 69.964, 'best_valid_valid/acc_align': 64.704, 'best_valid_test/acc': 74.967, 'best_valid_test/acc_unbiased': 68.063, 'best_valid_test/diff': 17.642, 'best_valid_test/acc_skew': 73.296, 'best_valid_test/acc_align': 62.83}
[8 / 20] best test accuracy: 68.063 at epoch 5 
 best_stats: {'best_test_epoch': 5, 'best_test_valid/acc': 73.942, 'best_test_valid/acc_unbiased': 67.334, 'best_test_valid/diff': 18.319, 'best_test_valid/acc_skew': 69.964, 'best_test_valid/acc_align': 64.704, 'best_test_test/acc': 74.967, 'best_test_test/acc_unbiased': 68.063, 'best_test_test/diff': 17.642, 'best_test_test/acc_skew': 73.296, 'best_test_test/acc_align': 62.83}
[9 / 20] Learning rate: 0.0001 weight: 0.01
[9 / 20] Loss: 4.5887041598926634 CE Loss: 0.47154526469949387 Con Loss: 4.583988708487524
[9 / 20] tensor([[0.933, 0.835],
        [0.571, 0.394]]) {'epoch': 9, 'valid/acc': 74.515, 'valid/acc_unbiased': 68.69, 'valid/diff': 13.516, 'valid/acc_skew': 66.074, 'valid/acc_align': 71.306, 'test/acc': 74.791, 'test/acc_unbiased': 68.33, 'test/diff': 13.742, 'test/acc_skew': 70.308, 'test/acc_align': 66.351}
[9 / 20] best valid accuracy: 68.690 at epoch 9 
 best_stats: {'best_valid_epoch': 9, 'best_valid_valid/acc': 74.515, 'best_valid_valid/acc_unbiased': 68.69, 'best_valid_valid/diff': 13.516, 'best_valid_valid/acc_skew': 66.074, 'best_valid_valid/acc_align': 71.306, 'best_valid_test/acc': 74.791, 'best_valid_test/acc_unbiased': 68.33, 'best_valid_test/diff': 13.742, 'best_valid_test/acc_skew': 70.308, 'best_valid_test/acc_align': 66.351}
[9 / 20] best test accuracy: 68.330 at epoch 9 
 best_stats: {'best_test_epoch': 9, 'best_test_valid/acc': 74.515, 'best_test_valid/acc_unbiased': 68.69, 'best_test_valid/diff': 13.516, 'best_test_valid/acc_skew': 66.074, 'best_test_valid/acc_align': 71.306, 'best_test_test/acc': 74.791, 'best_test_test/acc_unbiased': 68.33, 'best_test_test/diff': 13.742, 'best_test_test/acc_skew': 70.308, 'best_test_test/acc_align': 66.351}
[10 / 20] Learning rate: 0.0001 weight: 0.01
[10 / 20] Loss: 4.564728246650995 CE Loss: 0.46838136680650155 Con Loss: 4.5600444410946075
[10 / 20] tensor([[0.948, 0.898],
        [0.536, 0.303]]) {'epoch': 10, 'valid/acc': 73.765, 'valid/acc_unbiased': 67.671, 'valid/diff': 13.669, 'valid/acc_skew': 68.214, 'valid/acc_align': 67.127, 'test/acc': 73.997, 'test/acc_unbiased': 67.131, 'test/diff': 14.187, 'test/acc_skew': 71.703, 'test/acc_align': 62.56}
[10 / 20] best valid accuracy: 68.690 at epoch 9 
 best_stats: {'best_valid_epoch': 9, 'best_valid_valid/acc': 74.515, 'best_valid_valid/acc_unbiased': 68.69, 'best_valid_valid/diff': 13.516, 'best_valid_valid/acc_skew': 66.074, 'best_valid_valid/acc_align': 71.306, 'best_valid_test/acc': 74.791, 'best_valid_test/acc_unbiased': 68.33, 'best_valid_test/diff': 13.742, 'best_valid_test/acc_skew': 70.308, 'best_valid_test/acc_align': 66.351}
[10 / 20] best test accuracy: 68.330 at epoch 9 
 best_stats: {'best_test_epoch': 9, 'best_test_valid/acc': 74.515, 'best_test_valid/acc_unbiased': 68.69, 'best_test_valid/diff': 13.516, 'best_test_valid/acc_skew': 66.074, 'best_test_valid/acc_align': 71.306, 'best_test_test/acc': 74.791, 'best_test_test/acc_unbiased': 68.33, 'best_test_test/diff': 13.742, 'best_test_test/acc_skew': 70.308, 'best_test_test/acc_align': 66.351}
[11 / 20] Learning rate: 0.0001 weight: 0.01
[11 / 20] Loss: 4.512307090645022 CE Loss: 0.4690218799148147 Con Loss: 4.507616892864266
[11 / 20] tensor([[0.948, 0.830],
        [0.570, 0.394]]) {'epoch': 11, 'valid/acc': 74.603, 'valid/acc_unbiased': 68.703, 'valid/diff': 13.4, 'valid/acc_skew': 67.352, 'valid/acc_align': 70.054, 'test/acc': 75.408, 'test/acc_unbiased': 68.536, 'test/diff': 14.723, 'test/acc_skew': 69.966, 'test/acc_align': 67.105}
[11 / 20] best valid accuracy: 68.703 at epoch 11 
 best_stats: {'best_valid_epoch': 11, 'best_valid_valid/acc': 74.603, 'best_valid_valid/acc_unbiased': 68.703, 'best_valid_valid/diff': 13.4, 'best_valid_valid/acc_skew': 67.352, 'best_valid_valid/acc_align': 70.054, 'best_valid_test/acc': 75.408, 'best_valid_test/acc_unbiased': 68.536, 'best_valid_test/diff': 14.723, 'best_valid_test/acc_skew': 69.966, 'best_valid_test/acc_align': 67.105}
[11 / 20] best test accuracy: 68.536 at epoch 11 
 best_stats: {'best_test_epoch': 11, 'best_test_valid/acc': 74.603, 'best_test_valid/acc_unbiased': 68.703, 'best_test_valid/diff': 13.4, 'best_test_valid/acc_skew': 67.352, 'best_test_valid/acc_align': 70.054, 'best_test_test/acc': 75.408, 'best_test_test/acc_unbiased': 68.536, 'best_test_test/diff': 14.723, 'best_test_test/acc_skew': 69.966, 'best_test_test/acc_align': 67.105}
[12 / 20] Learning rate: 0.0001 weight: 0.01
[12 / 20] Loss: 4.574870745995571 CE Loss: 0.45744926353288207 Con Loss: 4.5702962389781385
[12 / 20] tensor([[0.932, 0.858],
        [0.610, 0.455]]) {'epoch': 12, 'valid/acc': 75.661, 'valid/acc_unbiased': 69.251, 'valid/diff': 15.504, 'valid/acc_skew': 68.939, 'valid/acc_align': 69.564, 'test/acc': 76.862, 'test/acc_unbiased': 71.37, 'test/diff': 11.489, 'test/acc_skew': 73.405, 'test/acc_align': 69.334}
[12 / 20] best valid accuracy: 69.251 at epoch 12 
 best_stats: {'best_valid_epoch': 12, 'best_valid_valid/acc': 75.661, 'best_valid_valid/acc_unbiased': 69.251, 'best_valid_valid/diff': 15.504, 'best_valid_valid/acc_skew': 68.939, 'best_valid_valid/acc_align': 69.564, 'best_valid_test/acc': 76.862, 'best_valid_test/acc_unbiased': 71.37, 'best_valid_test/diff': 11.489, 'best_valid_test/acc_skew': 73.405, 'best_valid_test/acc_align': 69.334}
[12 / 20] best test accuracy: 71.370 at epoch 12 
 best_stats: {'best_test_epoch': 12, 'best_test_valid/acc': 75.661, 'best_test_valid/acc_unbiased': 69.251, 'best_test_valid/diff': 15.504, 'best_test_valid/acc_skew': 68.939, 'best_test_valid/acc_align': 69.564, 'best_test_test/acc': 76.862, 'best_test_test/acc_unbiased': 71.37, 'best_test_test/diff': 11.489, 'best_test_test/acc_skew': 73.405, 'best_test_test/acc_align': 69.334}
[13 / 20] Learning rate: 0.0001 weight: 0.01
[13 / 20] Loss: 4.539434049692729 CE Loss: 0.4561064030092247 Con Loss: 4.534873019439457
[13 / 20] tensor([[0.926, 0.722],
        [0.652, 0.612]]) {'epoch': 13, 'valid/acc': 77.205, 'valid/acc_unbiased': 71.57, 'valid/diff': 13.495, 'valid/acc_skew': 66.441, 'valid/acc_align': 76.698, 'test/acc': 78.272, 'test/acc_unbiased': 72.797, 'test/diff': 12.222, 'test/acc_skew': 68.663, 'test/acc_align': 76.93}
[13 / 20] best valid accuracy: 71.570 at epoch 13 
 best_stats: {'best_valid_epoch': 13, 'best_valid_valid/acc': 77.205, 'best_valid_valid/acc_unbiased': 71.57, 'best_valid_valid/diff': 13.495, 'best_valid_valid/acc_skew': 66.441, 'best_valid_valid/acc_align': 76.698, 'best_valid_test/acc': 78.272, 'best_valid_test/acc_unbiased': 72.797, 'best_valid_test/diff': 12.222, 'best_valid_test/acc_skew': 68.663, 'best_valid_test/acc_align': 76.93}
[13 / 20] best test accuracy: 72.797 at epoch 13 
 best_stats: {'best_test_epoch': 13, 'best_test_valid/acc': 77.205, 'best_test_valid/acc_unbiased': 71.57, 'best_test_valid/diff': 13.495, 'best_test_valid/acc_skew': 66.441, 'best_test_valid/acc_align': 76.698, 'best_test_test/acc': 78.272, 'best_test_test/acc_unbiased': 72.797, 'best_test_test/diff': 12.222, 'best_test_test/acc_skew': 68.663, 'best_test_test/acc_align': 76.93}
[14 / 20] Learning rate: 1e-05 weight: 0.01
[14 / 20] Loss: 4.519908917347442 CE Loss: 0.4487018905766936 Con Loss: 4.515421901290134
[14 / 20] tensor([[0.948, 0.761],
        [0.610, 0.533]]) {'epoch': 14, 'valid/acc': 76.455, 'valid/acc_unbiased': 71.005, 'valid/diff': 12.276, 'valid/acc_skew': 65.821, 'valid/acc_align': 76.189, 'test/acc': 77.435, 'test/acc_unbiased': 71.325, 'test/diff': 13.181, 'test/acc_skew': 68.576, 'test/acc_align': 74.075}
[14 / 20] best valid accuracy: 71.570 at epoch 13 
 best_stats: {'best_valid_epoch': 13, 'best_valid_valid/acc': 77.205, 'best_valid_valid/acc_unbiased': 71.57, 'best_valid_valid/diff': 13.495, 'best_valid_valid/acc_skew': 66.441, 'best_valid_valid/acc_align': 76.698, 'best_valid_test/acc': 78.272, 'best_valid_test/acc_unbiased': 72.797, 'best_valid_test/diff': 12.222, 'best_valid_test/acc_skew': 68.663, 'best_valid_test/acc_align': 76.93}
[14 / 20] best test accuracy: 72.797 at epoch 13 
 best_stats: {'best_test_epoch': 13, 'best_test_valid/acc': 77.205, 'best_test_valid/acc_unbiased': 71.57, 'best_test_valid/diff': 13.495, 'best_test_valid/acc_skew': 66.441, 'best_test_valid/acc_align': 76.698, 'best_test_test/acc': 78.272, 'best_test_test/acc_unbiased': 72.797, 'best_test_test/diff': 12.222, 'best_test_test/acc_skew': 68.663, 'best_test_test/acc_align': 76.93}
[15 / 20] Learning rate: 1e-05 weight: 0.01
[15 / 20] Loss: 4.524030024529575 CE Loss: 0.4460985146627494 Con Loss: 4.519569050457896
[15 / 20] tensor([[0.948, 0.773],
        [0.589, 0.491]]) {'epoch': 15, 'valid/acc': 75.926, 'valid/acc_unbiased': 70.717, 'valid/diff': 11.153, 'valid/acc_skew': 65.401, 'valid/acc_align': 76.033, 'test/acc': 76.421, 'test/acc_unbiased': 70.03, 'test/diff': 13.696, 'test/acc_skew': 68.106, 'test/acc_align': 71.954}
[15 / 20] best valid accuracy: 71.570 at epoch 13 
 best_stats: {'best_valid_epoch': 13, 'best_valid_valid/acc': 77.205, 'best_valid_valid/acc_unbiased': 71.57, 'best_valid_valid/diff': 13.495, 'best_valid_valid/acc_skew': 66.441, 'best_valid_valid/acc_align': 76.698, 'best_valid_test/acc': 78.272, 'best_valid_test/acc_unbiased': 72.797, 'best_valid_test/diff': 12.222, 'best_valid_test/acc_skew': 68.663, 'best_valid_test/acc_align': 76.93}
[15 / 20] best test accuracy: 72.797 at epoch 13 
 best_stats: {'best_test_epoch': 13, 'best_test_valid/acc': 77.205, 'best_test_valid/acc_unbiased': 71.57, 'best_test_valid/diff': 13.495, 'best_test_valid/acc_skew': 66.441, 'best_test_valid/acc_align': 76.698, 'best_test_test/acc': 78.272, 'best_test_test/acc_unbiased': 72.797, 'best_test_test/diff': 12.222, 'best_test_test/acc_skew': 68.663, 'best_test_test/acc_align': 76.93}
[16 / 20] Learning rate: 1e-05 weight: 0.01
[16 / 20] Loss: 4.496020171223665 CE Loss: 0.44395528111686333 Con Loss: 4.491580614656243
[16 / 20] tensor([[0.950, 0.773],
        [0.600, 0.509]]) {'epoch': 16, 'valid/acc': 76.058, 'valid/acc_unbiased': 70.794, 'valid/diff': 12.362, 'valid/acc_skew': 64.613, 'valid/acc_align': 76.975, 'test/acc': 77.038, 'test/acc_unbiased': 70.791, 'test/diff': 13.4, 'test/acc_skew': 68.625, 'test/acc_align': 72.957}
[16 / 20] best valid accuracy: 71.570 at epoch 13 
 best_stats: {'best_valid_epoch': 13, 'best_valid_valid/acc': 77.205, 'best_valid_valid/acc_unbiased': 71.57, 'best_valid_valid/diff': 13.495, 'best_valid_valid/acc_skew': 66.441, 'best_valid_valid/acc_align': 76.698, 'best_valid_test/acc': 78.272, 'best_valid_test/acc_unbiased': 72.797, 'best_valid_test/diff': 12.222, 'best_valid_test/acc_skew': 68.663, 'best_valid_test/acc_align': 76.93}
[16 / 20] best test accuracy: 72.797 at epoch 13 
 best_stats: {'best_test_epoch': 13, 'best_test_valid/acc': 77.205, 'best_test_valid/acc_unbiased': 71.57, 'best_test_valid/diff': 13.495, 'best_test_valid/acc_skew': 66.441, 'best_test_valid/acc_align': 76.698, 'best_test_test/acc': 78.272, 'best_test_test/acc_unbiased': 72.797, 'best_test_test/diff': 12.222, 'best_test_test/acc_skew': 68.663, 'best_test_test/acc_align': 76.93}
[17 / 20] Learning rate: 1e-05 weight: 0.01
[17 / 20] Loss: 4.530556567194577 CE Loss: 0.44750907443650695 Con Loss: 4.526081471887701
[17 / 20] tensor([[0.949, 0.767],
        [0.606, 0.509]]) {'epoch': 17, 'valid/acc': 76.102, 'valid/acc_unbiased': 70.558, 'valid/diff': 12.391, 'valid/acc_skew': 65.029, 'valid/acc_align': 76.087, 'test/acc': 77.171, 'test/acc_unbiased': 70.769, 'test/diff': 13.925, 'test/acc_skew': 68.629, 'test/acc_align': 72.91}
[17 / 20] best valid accuracy: 71.570 at epoch 13 
 best_stats: {'best_valid_epoch': 13, 'best_valid_valid/acc': 77.205, 'best_valid_valid/acc_unbiased': 71.57, 'best_valid_valid/diff': 13.495, 'best_valid_valid/acc_skew': 66.441, 'best_valid_valid/acc_align': 76.698, 'best_valid_test/acc': 78.272, 'best_valid_test/acc_unbiased': 72.797, 'best_valid_test/diff': 12.222, 'best_valid_test/acc_skew': 68.663, 'best_valid_test/acc_align': 76.93}
[17 / 20] best test accuracy: 72.797 at epoch 13 
 best_stats: {'best_test_epoch': 13, 'best_test_valid/acc': 77.205, 'best_test_valid/acc_unbiased': 71.57, 'best_test_valid/diff': 13.495, 'best_test_valid/acc_skew': 66.441, 'best_test_valid/acc_align': 76.698, 'best_test_test/acc': 78.272, 'best_test_test/acc_unbiased': 72.797, 'best_test_test/diff': 12.222, 'best_test_test/acc_skew': 68.663, 'best_test_test/acc_align': 76.93}
[18 / 20] Learning rate: 1e-05 weight: 0.01
[18 / 20] Loss: 4.5155434658446145 CE Loss: 0.44307773548848883 Con Loss: 4.511112684616209
[18 / 20] tensor([[0.946, 0.767],
        [0.625, 0.521]]) {'epoch': 18, 'valid/acc': 76.543, 'valid/acc_unbiased': 71.45, 'valid/diff': 11.169, 'valid/acc_skew': 66.018, 'valid/acc_align': 76.883, 'test/acc': 77.876, 'test/acc_unbiased': 71.492, 'test/diff': 14.158, 'test/acc_skew': 69.609, 'test/acc_align': 73.374}
[18 / 20] best valid accuracy: 71.570 at epoch 13 
 best_stats: {'best_valid_epoch': 13, 'best_valid_valid/acc': 77.205, 'best_valid_valid/acc_unbiased': 71.57, 'best_valid_valid/diff': 13.495, 'best_valid_valid/acc_skew': 66.441, 'best_valid_valid/acc_align': 76.698, 'best_valid_test/acc': 78.272, 'best_valid_test/acc_unbiased': 72.797, 'best_valid_test/diff': 12.222, 'best_valid_test/acc_skew': 68.663, 'best_valid_test/acc_align': 76.93}
[18 / 20] best test accuracy: 72.797 at epoch 13 
 best_stats: {'best_test_epoch': 13, 'best_test_valid/acc': 77.205, 'best_test_valid/acc_unbiased': 71.57, 'best_test_valid/diff': 13.495, 'best_test_valid/acc_skew': 66.441, 'best_test_valid/acc_align': 76.698, 'best_test_test/acc': 78.272, 'best_test_test/acc_unbiased': 72.797, 'best_test_test/diff': 12.222, 'best_test_test/acc_skew': 68.663, 'best_test_test/acc_align': 76.93}
[19 / 20] Learning rate: 1e-05 weight: 0.01
[19 / 20] Loss: 4.497869684382888 CE Loss: 0.44014134061376686 Con Loss: 4.493468263898169
[19 / 20] tensor([[0.953, 0.761],
        [0.595, 0.527]]) {'epoch': 19, 'valid/acc': 76.146, 'valid/acc_unbiased': 70.849, 'valid/diff': 12.747, 'valid/acc_skew': 64.476, 'valid/acc_align': 77.222, 'test/acc': 77.038, 'test/acc_unbiased': 70.917, 'test/diff': 12.97, 'test/acc_skew': 67.826, 'test/acc_align': 74.007}
[19 / 20] best valid accuracy: 71.570 at epoch 13 
 best_stats: {'best_valid_epoch': 13, 'best_valid_valid/acc': 77.205, 'best_valid_valid/acc_unbiased': 71.57, 'best_valid_valid/diff': 13.495, 'best_valid_valid/acc_skew': 66.441, 'best_valid_valid/acc_align': 76.698, 'best_valid_test/acc': 78.272, 'best_valid_test/acc_unbiased': 72.797, 'best_valid_test/diff': 12.222, 'best_valid_test/acc_skew': 68.663, 'best_valid_test/acc_align': 76.93}
[19 / 20] best test accuracy: 72.797 at epoch 13 
 best_stats: {'best_test_epoch': 13, 'best_test_valid/acc': 77.205, 'best_test_valid/acc_unbiased': 71.57, 'best_test_valid/diff': 13.495, 'best_test_valid/acc_skew': 66.441, 'best_test_valid/acc_align': 76.698, 'best_test_test/acc': 78.272, 'best_test_test/acc_unbiased': 72.797, 'best_test_test/diff': 12.222, 'best_test_test/acc_skew': 68.663, 'best_test_test/acc_align': 76.93}
[20 / 20] Learning rate: 1e-05 weight: 0.01
[20 / 20] Loss: 4.4574809727799085 CE Loss: 0.43906270873006564 Con Loss: 4.453090335313232
[20 / 20] tensor([[0.952, 0.778],
        [0.595, 0.545]]) {'epoch': 20, 'valid/acc': 76.411, 'valid/acc_unbiased': 71.126, 'valid/diff': 12.193, 'valid/acc_skew': 65.029, 'valid/acc_align': 77.222, 'test/acc': 77.259, 'test/acc_unbiased': 71.774, 'test/diff': 11.161, 'test/acc_skew': 68.678, 'test/acc_align': 74.869}
[20 / 20] best valid accuracy: 71.570 at epoch 13 
 best_stats: {'best_valid_epoch': 13, 'best_valid_valid/acc': 77.205, 'best_valid_valid/acc_unbiased': 71.57, 'best_valid_valid/diff': 13.495, 'best_valid_valid/acc_skew': 66.441, 'best_valid_valid/acc_align': 76.698, 'best_valid_test/acc': 78.272, 'best_valid_test/acc_unbiased': 72.797, 'best_valid_test/diff': 12.222, 'best_valid_test/acc_skew': 68.663, 'best_valid_test/acc_align': 76.93}
[20 / 20] best test accuracy: 72.797 at epoch 13 
 best_stats: {'best_test_epoch': 13, 'best_test_valid/acc': 77.205, 'best_test_valid/acc_unbiased': 71.57, 'best_test_valid/diff': 13.495, 'best_test_valid/acc_skew': 66.441, 'best_test_valid/acc_align': 76.698, 'best_test_test/acc': 78.272, 'best_test_test/acc_unbiased': 72.797, 'best_test_test/diff': 12.222, 'best_test_test/acc_skew': 68.663, 'best_test_test/acc_align': 76.93}
Total training time: 0:17:32
