Log level set to: INFO
Set seed: 1
=======> Using Fixed Random Seed: 1 <========
save_path: exp_results/bc-bb0-utk_face_age-crop_rotate_color-0.9-lr0.001-bs128-cbs64-w0.01-ratio10-aug1-seed1
get_utk_face - split: train, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_age-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
Binary Target 1
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Normal Label Distribution: 
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
Binary Target 1
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Normal Label Distribution: 
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 10684, target_attr: gender, bias_attr: age bias_rate: 0.9
['[train] target_0-bias_0: 8237', '[train] target_0-bias_1: 147', '[train] target_1-bias_0: 823', '[train] target_1-bias_1: 1477']
confusion_matrix - 
 original: tensor([[8237.,  823.],
        [ 147., 1477.]]), 
 normalized: tensor([[0.909, 0.091],
        [0.091, 0.909]]), 
 b|y: tensor([[0.982, 0.018],
        [0.358, 0.642]])
get_utk_face - split: train, aug: 1, given_y: True, ratio: 10
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_age-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
Binary Target 1
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Normal Label Distribution: 
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
Binary Target 1
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Normal Label Distribution: 
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 10684, target_attr: gender, bias_attr: age bias_rate: 0.9
['[train] target_0-bias_0: 8237', '[train] target_0-bias_1: 147', '[train] target_1-bias_0: 823', '[train] target_1-bias_1: 1477']
get_utk_face - split: valid, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_age-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [1030, 195]
Target 1: [841, 202]
Binary Target 1
---------------------------
Target 0: [1030, 195]
Target 1: [841, 202]
===================================
Normal Label Distribution: 
Target 0: [1030, 195]
Target 1: [841, 202]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 2268, target_attr: gender, bias_attr: age bias_rate: 0.9
['[valid] target_0-bias_0: 1030', '[valid] target_0-bias_1: 195', '[valid] target_1-bias_0: 841', '[valid] target_1-bias_1: 202']
get_utk_face - split: test, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_age-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [1061, 176]
Target 1: [867, 165]
Binary Target 1
---------------------------
Target 0: [1061, 176]
Target 1: [867, 165]
===================================
Normal Label Distribution: 
Target 0: [1061, 176]
Target 1: [867, 165]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 2269, target_attr: gender, bias_attr: age bias_rate: 0.9
['[test] target_0-bias_0: 1061', '[test] target_0-bias_1: 176', '[test] target_1-bias_0: 867', '[test] target_1-bias_1: 165']
decay_epochs: [6, 13]
[1 / 20] Learning rate: 0.001 weight: 0.01
[1 / 20] Loss: 4.8812799582272515 CE Loss: 0.5474366120567308 Con Loss: 4.875805603257282
[1 / 20] tensor([[1., 1.],
        [0., 0.]]) {'epoch': 1, 'valid/acc': 54.012, 'valid/acc_unbiased': 50.0, 'valid/diff': 0.0, 'valid/acc_skew': 50.0, 'valid/acc_align': 50.0, 'test/acc': 54.517, 'test/acc_unbiased': 50.0, 'test/diff': 0.0, 'test/acc_skew': 50.0, 'test/acc_align': 50.0}
[1 / 20] best valid accuracy: 50.000 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 54.012, 'best_valid_valid/acc_unbiased': 50.0, 'best_valid_valid/diff': 0.0, 'best_valid_valid/acc_skew': 50.0, 'best_valid_valid/acc_align': 50.0, 'best_valid_test/acc': 54.517, 'best_valid_test/acc_unbiased': 50.0, 'best_valid_test/diff': 0.0, 'best_valid_test/acc_skew': 50.0, 'best_valid_test/acc_align': 50.0}
[1 / 20] best test accuracy: 50.000 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 54.012, 'best_test_valid/acc_unbiased': 50.0, 'best_test_valid/diff': 0.0, 'best_test_valid/acc_skew': 50.0, 'best_test_valid/acc_align': 50.0, 'best_test_test/acc': 54.517, 'best_test_test/acc_unbiased': 50.0, 'best_test_test/diff': 0.0, 'best_test_test/acc_skew': 50.0, 'best_test_test/acc_align': 50.0}
[2 / 20] Learning rate: 0.001 weight: 0.01
[2 / 20] Loss: 4.734625759217589 CE Loss: 0.5328027797923558 Con Loss: 4.729297742197372
[2 / 20] tensor([[1., 1.],
        [0., 0.]]) {'epoch': 2, 'valid/acc': 54.012, 'valid/acc_unbiased': 50.0, 'valid/diff': 0.0, 'valid/acc_skew': 50.0, 'valid/acc_align': 50.0, 'test/acc': 54.517, 'test/acc_unbiased': 50.0, 'test/diff': 0.0, 'test/acc_skew': 50.0, 'test/acc_align': 50.0}
[2 / 20] best valid accuracy: 50.000 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 54.012, 'best_valid_valid/acc_unbiased': 50.0, 'best_valid_valid/diff': 0.0, 'best_valid_valid/acc_skew': 50.0, 'best_valid_valid/acc_align': 50.0, 'best_valid_test/acc': 54.517, 'best_valid_test/acc_unbiased': 50.0, 'best_valid_test/diff': 0.0, 'best_valid_test/acc_skew': 50.0, 'best_valid_test/acc_align': 50.0}
[2 / 20] best test accuracy: 50.000 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 54.012, 'best_test_valid/acc_unbiased': 50.0, 'best_test_valid/diff': 0.0, 'best_test_valid/acc_skew': 50.0, 'best_test_valid/acc_align': 50.0, 'best_test_test/acc': 54.517, 'best_test_test/acc_unbiased': 50.0, 'best_test_test/diff': 0.0, 'best_test_test/acc_skew': 50.0, 'best_test_test/acc_align': 50.0}
[3 / 20] Learning rate: 0.001 weight: 0.01
[3 / 20] Loss: 4.669704477959293 CE Loss: 0.5188313895555436 Con Loss: 4.66451617886805
[3 / 20] tensor([[0.998, 1.000],
        [0.008, 0.000]]) {'epoch': 3, 'valid/acc': 54.497, 'valid/acc_unbiased': 50.521, 'valid/diff': 0.148, 'valid/acc_skew': 50.595, 'valid/acc_align': 50.447, 'test/acc': 54.738, 'test/acc_unbiased': 50.155, 'test/diff': 0.498, 'test/acc_skew': 50.404, 'test/acc_align': 49.906}
[3 / 20] best valid accuracy: 50.521 at epoch 3 
 best_stats: {'best_valid_epoch': 3, 'best_valid_valid/acc': 54.497, 'best_valid_valid/acc_unbiased': 50.521, 'best_valid_valid/diff': 0.148, 'best_valid_valid/acc_skew': 50.595, 'best_valid_valid/acc_align': 50.447, 'best_valid_test/acc': 54.738, 'best_valid_test/acc_unbiased': 50.155, 'best_valid_test/diff': 0.498, 'best_valid_test/acc_skew': 50.404, 'best_valid_test/acc_align': 49.906}
[3 / 20] best test accuracy: 50.155 at epoch 3 
 best_stats: {'best_test_epoch': 3, 'best_test_valid/acc': 54.497, 'best_test_valid/acc_unbiased': 50.521, 'best_test_valid/diff': 0.148, 'best_test_valid/acc_skew': 50.595, 'best_test_valid/acc_align': 50.447, 'best_test_test/acc': 54.738, 'best_test_test/acc_unbiased': 50.155, 'best_test_test/diff': 0.498, 'best_test_test/acc_skew': 50.404, 'best_test_test/acc_align': 49.906}
[4 / 20] Learning rate: 0.001 weight: 0.01
[4 / 20] Loss: 4.698382321568028 CE Loss: 0.5185880825922133 Con Loss: 4.693196437725723
[4 / 20] tensor([[1., 1.],
        [0., 0.]]) {'epoch': 4, 'valid/acc': 54.012, 'valid/acc_unbiased': 50.0, 'valid/diff': 0.0, 'valid/acc_skew': 50.0, 'valid/acc_align': 50.0, 'test/acc': 54.517, 'test/acc_unbiased': 50.0, 'test/diff': 0.0, 'test/acc_skew': 50.0, 'test/acc_align': 50.0}
[4 / 20] best valid accuracy: 50.521 at epoch 3 
 best_stats: {'best_valid_epoch': 3, 'best_valid_valid/acc': 54.497, 'best_valid_valid/acc_unbiased': 50.521, 'best_valid_valid/diff': 0.148, 'best_valid_valid/acc_skew': 50.595, 'best_valid_valid/acc_align': 50.447, 'best_valid_test/acc': 54.738, 'best_valid_test/acc_unbiased': 50.155, 'best_valid_test/diff': 0.498, 'best_valid_test/acc_skew': 50.404, 'best_valid_test/acc_align': 49.906}
[4 / 20] best test accuracy: 50.155 at epoch 3 
 best_stats: {'best_test_epoch': 3, 'best_test_valid/acc': 54.497, 'best_test_valid/acc_unbiased': 50.521, 'best_test_valid/diff': 0.148, 'best_test_valid/acc_skew': 50.595, 'best_test_valid/acc_align': 50.447, 'best_test_test/acc': 54.738, 'best_test_test/acc_unbiased': 50.155, 'best_test_test/diff': 0.498, 'best_test_test/acc_skew': 50.404, 'best_test_test/acc_align': 49.906}
[5 / 20] Learning rate: 0.001 weight: 0.01
[5 / 20] Loss: 4.7065234985837145 CE Loss: 0.5236882205894938 Con Loss: 4.701286625121248
[5 / 20] tensor([[0.997, 1.000],
        [0.030, 0.006]]) {'epoch': 5, 'valid/acc': 55.159, 'valid/acc_unbiased': 50.891, 'valid/diff': 1.322, 'valid/acc_skew': 51.33, 'valid/acc_align': 50.451, 'test/acc': 55.575, 'test/acc_unbiased': 50.831, 'test/diff': 1.338, 'test/acc_skew': 51.499, 'test/acc_align': 50.162}
[5 / 20] best valid accuracy: 50.891 at epoch 5 
 best_stats: {'best_valid_epoch': 5, 'best_valid_valid/acc': 55.159, 'best_valid_valid/acc_unbiased': 50.891, 'best_valid_valid/diff': 1.322, 'best_valid_valid/acc_skew': 51.33, 'best_valid_valid/acc_align': 50.451, 'best_valid_test/acc': 55.575, 'best_valid_test/acc_unbiased': 50.831, 'best_valid_test/diff': 1.338, 'best_valid_test/acc_skew': 51.499, 'best_valid_test/acc_align': 50.162}
[5 / 20] best test accuracy: 50.831 at epoch 5 
 best_stats: {'best_test_epoch': 5, 'best_test_valid/acc': 55.159, 'best_test_valid/acc_unbiased': 50.891, 'best_test_valid/diff': 1.322, 'best_test_valid/acc_skew': 51.33, 'best_test_valid/acc_align': 50.451, 'best_test_test/acc': 55.575, 'best_test_test/acc_unbiased': 50.831, 'best_test_test/diff': 1.338, 'best_test_test/acc_skew': 51.499, 'best_test_test/acc_align': 50.162}
[6 / 20] Learning rate: 0.001 weight: 0.01
[6 / 20] Loss: 4.644520252039262 CE Loss: 0.5109332877569367 Con Loss: 4.639410926000495
[6 / 20] tensor([[1.000, 0.994],
        [0.003, 0.000]]) {'epoch': 6, 'valid/acc': 54.365, 'valid/acc_unbiased': 50.426, 'valid/diff': 0.138, 'valid/acc_skew': 50.357, 'valid/acc_align': 50.495, 'test/acc': 54.606, 'test/acc_unbiased': 49.944, 'test/diff': 0.457, 'test/acc_skew': 49.889, 'test/acc_align': 50.0}
[6 / 20] best valid accuracy: 50.891 at epoch 5 
 best_stats: {'best_valid_epoch': 5, 'best_valid_valid/acc': 55.159, 'best_valid_valid/acc_unbiased': 50.891, 'best_valid_valid/diff': 1.322, 'best_valid_valid/acc_skew': 51.33, 'best_valid_valid/acc_align': 50.451, 'best_valid_test/acc': 55.575, 'best_valid_test/acc_unbiased': 50.831, 'best_valid_test/diff': 1.338, 'best_valid_test/acc_skew': 51.499, 'best_valid_test/acc_align': 50.162}
[6 / 20] best test accuracy: 50.831 at epoch 5 
 best_stats: {'best_test_epoch': 5, 'best_test_valid/acc': 55.159, 'best_test_valid/acc_unbiased': 50.891, 'best_test_valid/diff': 1.322, 'best_test_valid/acc_skew': 51.33, 'best_test_valid/acc_align': 50.451, 'best_test_test/acc': 55.575, 'best_test_test/acc_unbiased': 50.831, 'best_test_test/diff': 1.338, 'best_test_test/acc_skew': 51.499, 'best_test_test/acc_align': 50.162}
[7 / 20] Learning rate: 0.0001 weight: 0.01
[7 / 20] Loss: 4.669080007303881 CE Loss: 0.49895661163312227 Con Loss: 4.66409043523088
[7 / 20] tensor([[0.997, 0.994],
        [0.030, 0.024]]) {'epoch': 7, 'valid/acc': 55.423, 'valid/acc_unbiased': 51.539, 'valid/diff': 0.299, 'valid/acc_skew': 51.39, 'valid/acc_align': 51.689, 'test/acc': 55.663, 'test/acc_unbiased': 51.143, 'test/diff': 0.43, 'test/acc_skew': 51.215, 'test/acc_align': 51.071}
[7 / 20] best valid accuracy: 51.539 at epoch 7 
 best_stats: {'best_valid_epoch': 7, 'best_valid_valid/acc': 55.423, 'best_valid_valid/acc_unbiased': 51.539, 'best_valid_valid/diff': 0.299, 'best_valid_valid/acc_skew': 51.39, 'best_valid_valid/acc_align': 51.689, 'best_valid_test/acc': 55.663, 'best_valid_test/acc_unbiased': 51.143, 'best_valid_test/diff': 0.43, 'best_valid_test/acc_skew': 51.215, 'best_valid_test/acc_align': 51.071}
[7 / 20] best test accuracy: 51.143 at epoch 7 
 best_stats: {'best_test_epoch': 7, 'best_test_valid/acc': 55.423, 'best_test_valid/acc_unbiased': 51.539, 'best_test_valid/diff': 0.299, 'best_test_valid/acc_skew': 51.39, 'best_test_valid/acc_align': 51.689, 'best_test_test/acc': 55.663, 'best_test_test/acc_unbiased': 51.143, 'best_test_test/diff': 0.43, 'best_test_test/acc_skew': 51.215, 'best_test_test/acc_align': 51.071}
[8 / 20] Learning rate: 0.0001 weight: 0.01
[8 / 20] Loss: 4.60902746444068 CE Loss: 0.4964780343891038 Con Loss: 4.604062692363001
[8 / 20] tensor([[0.995, 0.989],
        [0.057, 0.012]]) {'epoch': 8, 'valid/acc': 56.526, 'valid/acc_unbiased': 52.111, 'valid/diff': 2.277, 'valid/acc_skew': 53.173, 'valid/acc_align': 51.048, 'test/acc': 56.457, 'test/acc_unbiased': 51.314, 'test/diff': 2.552, 'test/acc_skew': 52.258, 'test/acc_align': 50.37}
[8 / 20] best valid accuracy: 52.111 at epoch 8 
 best_stats: {'best_valid_epoch': 8, 'best_valid_valid/acc': 56.526, 'best_valid_valid/acc_unbiased': 52.111, 'best_valid_valid/diff': 2.277, 'best_valid_valid/acc_skew': 53.173, 'best_valid_valid/acc_align': 51.048, 'best_valid_test/acc': 56.457, 'best_valid_test/acc_unbiased': 51.314, 'best_valid_test/diff': 2.552, 'best_valid_test/acc_skew': 52.258, 'best_valid_test/acc_align': 50.37}
[8 / 20] best test accuracy: 51.314 at epoch 8 
 best_stats: {'best_test_epoch': 8, 'best_test_valid/acc': 56.526, 'best_test_valid/acc_unbiased': 52.111, 'best_test_valid/diff': 2.277, 'best_test_valid/acc_skew': 53.173, 'best_test_valid/acc_align': 51.048, 'best_test_test/acc': 56.457, 'best_test_test/acc_unbiased': 51.314, 'best_test_test/diff': 2.552, 'best_test_test/acc_skew': 52.258, 'best_test_test/acc_align': 50.37}
[9 / 20] Learning rate: 0.0001 weight: 0.01
[9 / 20] Loss: 4.627758197148879 CE Loss: 0.48789049706758963 Con Loss: 4.622879303961111
[9 / 20] tensor([[0.992, 0.983],
        [0.084, 0.036]]) {'epoch': 9, 'valid/acc': 57.319, 'valid/acc_unbiased': 53.577, 'valid/diff': 0.882, 'valid/acc_skew': 53.136, 'valid/acc_align': 54.019, 'test/acc': 57.47, 'test/acc_unbiased': 52.376, 'test/diff': 2.82, 'test/acc_skew': 53.358, 'test/acc_align': 51.394}
[9 / 20] best valid accuracy: 53.577 at epoch 9 
 best_stats: {'best_valid_epoch': 9, 'best_valid_valid/acc': 57.319, 'best_valid_valid/acc_unbiased': 53.577, 'best_valid_valid/diff': 0.882, 'best_valid_valid/acc_skew': 53.136, 'best_valid_valid/acc_align': 54.019, 'best_valid_test/acc': 57.47, 'best_valid_test/acc_unbiased': 52.376, 'best_valid_test/diff': 2.82, 'best_valid_test/acc_skew': 53.358, 'best_valid_test/acc_align': 51.394}
[9 / 20] best test accuracy: 52.376 at epoch 9 
 best_stats: {'best_test_epoch': 9, 'best_test_valid/acc': 57.319, 'best_test_valid/acc_unbiased': 53.577, 'best_test_valid/diff': 0.882, 'best_test_valid/acc_skew': 53.136, 'best_test_valid/acc_align': 54.019, 'best_test_test/acc': 57.47, 'best_test_test/acc_unbiased': 52.376, 'best_test_test/diff': 2.82, 'best_test_test/acc_skew': 53.358, 'best_test_test/acc_align': 51.394}
[10 / 20] Learning rate: 0.0001 weight: 0.01
[10 / 20] Loss: 4.588919683504265 CE Loss: 0.48308310989403447 Con Loss: 4.584088855002177
[10 / 20] tensor([[0.982, 0.977],
        [0.141, 0.079]]) {'epoch': 10, 'valid/acc': 59.039, 'valid/acc_unbiased': 55.071, 'valid/diff': 1.85, 'valid/acc_skew': 55.221, 'valid/acc_align': 54.921, 'test/acc': 59.454, 'test/acc_unbiased': 54.472, 'test/diff': 3.337, 'test/acc_skew': 55.899, 'test/acc_align': 53.044}
[10 / 20] best valid accuracy: 55.071 at epoch 10 
 best_stats: {'best_valid_epoch': 10, 'best_valid_valid/acc': 59.039, 'best_valid_valid/acc_unbiased': 55.071, 'best_valid_valid/diff': 1.85, 'best_valid_valid/acc_skew': 55.221, 'best_valid_valid/acc_align': 54.921, 'best_valid_test/acc': 59.454, 'best_valid_test/acc_unbiased': 54.472, 'best_valid_test/diff': 3.337, 'best_valid_test/acc_skew': 55.899, 'best_valid_test/acc_align': 53.044}
[10 / 20] best test accuracy: 54.472 at epoch 10 
 best_stats: {'best_test_epoch': 10, 'best_test_valid/acc': 59.039, 'best_test_valid/acc_unbiased': 55.071, 'best_test_valid/diff': 1.85, 'best_test_valid/acc_skew': 55.221, 'best_test_valid/acc_align': 54.921, 'best_test_test/acc': 59.454, 'best_test_test/acc_unbiased': 54.472, 'best_test_test/diff': 3.337, 'best_test_test/acc_skew': 55.899, 'best_test_test/acc_align': 53.044}
[11 / 20] Learning rate: 0.0001 weight: 0.01
[11 / 20] Loss: 4.555695170992013 CE Loss: 0.47610066451190874 Con Loss: 4.550934125313996
[11 / 20] tensor([[0.984, 0.949],
        [0.151, 0.121]]) {'epoch': 11, 'valid/acc': 60.141, 'valid/acc_unbiased': 56.29, 'valid/diff': 1.813, 'valid/acc_skew': 56.469, 'valid/acc_align': 56.11, 'test/acc': 60.026, 'test/acc_unbiased': 55.129, 'test/diff': 3.25, 'test/acc_skew': 54.998, 'test/acc_align': 55.259}
[11 / 20] best valid accuracy: 56.290 at epoch 11 
 best_stats: {'best_valid_epoch': 11, 'best_valid_valid/acc': 60.141, 'best_valid_valid/acc_unbiased': 56.29, 'best_valid_valid/diff': 1.813, 'best_valid_valid/acc_skew': 56.469, 'best_valid_valid/acc_align': 56.11, 'best_valid_test/acc': 60.026, 'best_valid_test/acc_unbiased': 55.129, 'best_valid_test/diff': 3.25, 'best_valid_test/acc_skew': 54.998, 'best_valid_test/acc_align': 55.259}
[11 / 20] best test accuracy: 55.129 at epoch 11 
 best_stats: {'best_test_epoch': 11, 'best_test_valid/acc': 60.141, 'best_test_valid/acc_unbiased': 56.29, 'best_test_valid/diff': 1.813, 'best_test_valid/acc_skew': 56.469, 'best_test_valid/acc_align': 56.11, 'best_test_test/acc': 60.026, 'best_test_test/acc_unbiased': 55.129, 'best_test_test/diff': 3.25, 'best_test_test/acc_skew': 54.998, 'best_test_test/acc_align': 55.259}
[12 / 20] Learning rate: 0.0001 weight: 0.01
[12 / 20] Loss: 4.577018660313625 CE Loss: 0.46527070019049666 Con Loss: 4.572365958786153
[12 / 20] tensor([[0.974, 0.926],
        [0.234, 0.188]]) {'epoch': 12, 'valid/acc': 62.698, 'valid/acc_unbiased': 58.188, 'valid/diff': 4.762, 'valid/acc_skew': 57.985, 'valid/acc_align': 58.391, 'test/acc': 63.023, 'test/acc_unbiased': 58.044, 'test/diff': 4.687, 'test/acc_skew': 58.014, 'test/acc_align': 58.074}
[12 / 20] best valid accuracy: 58.188 at epoch 12 
 best_stats: {'best_valid_epoch': 12, 'best_valid_valid/acc': 62.698, 'best_valid_valid/acc_unbiased': 58.188, 'best_valid_valid/diff': 4.762, 'best_valid_valid/acc_skew': 57.985, 'best_valid_valid/acc_align': 58.391, 'best_valid_test/acc': 63.023, 'best_valid_test/acc_unbiased': 58.044, 'best_valid_test/diff': 4.687, 'best_valid_test/acc_skew': 58.014, 'best_valid_test/acc_align': 58.074}
[12 / 20] best test accuracy: 58.044 at epoch 12 
 best_stats: {'best_test_epoch': 12, 'best_test_valid/acc': 62.698, 'best_test_valid/acc_unbiased': 58.188, 'best_test_valid/diff': 4.762, 'best_test_valid/acc_skew': 57.985, 'best_test_valid/acc_align': 58.391, 'best_test_test/acc': 63.023, 'best_test_test/acc_unbiased': 58.044, 'best_test_test/diff': 4.687, 'best_test_test/acc_skew': 58.014, 'best_test_test/acc_align': 58.074}
[13 / 20] Learning rate: 0.0001 weight: 0.01
[13 / 20] Loss: 4.5769072189531 CE Loss: 0.46110872513165146 Con Loss: 4.572296120262646
[13 / 20] tensor([[0.978, 0.943],
        [0.216, 0.170]]) {'epoch': 13, 'valid/acc': 62.919, 'valid/acc_unbiased': 59.092, 'valid/diff': 2.555, 'valid/acc_skew': 58.457, 'valid/acc_align': 59.726, 'test/acc': 62.539, 'test/acc_unbiased': 57.672, 'test/diff': 4.056, 'test/acc_skew': 57.943, 'test/acc_align': 57.401}
[13 / 20] best valid accuracy: 59.092 at epoch 13 
 best_stats: {'best_valid_epoch': 13, 'best_valid_valid/acc': 62.919, 'best_valid_valid/acc_unbiased': 59.092, 'best_valid_valid/diff': 2.555, 'best_valid_valid/acc_skew': 58.457, 'best_valid_valid/acc_align': 59.726, 'best_valid_test/acc': 62.539, 'best_valid_test/acc_unbiased': 57.672, 'best_valid_test/diff': 4.056, 'best_valid_test/acc_skew': 57.943, 'best_valid_test/acc_align': 57.401}
[13 / 20] best test accuracy: 58.044 at epoch 12 
 best_stats: {'best_test_epoch': 12, 'best_test_valid/acc': 62.698, 'best_test_valid/acc_unbiased': 58.188, 'best_test_valid/diff': 4.762, 'best_test_valid/acc_skew': 57.985, 'best_test_valid/acc_align': 58.391, 'best_test_test/acc': 63.023, 'best_test_test/acc_unbiased': 58.044, 'best_test_test/diff': 4.687, 'best_test_test/acc_skew': 58.014, 'best_test_test/acc_align': 58.074}
[14 / 20] Learning rate: 1e-05 weight: 0.01
[14 / 20] Loss: 4.544314466045841 CE Loss: 0.4498083531432543 Con Loss: 4.539816382046453
[14 / 20] tensor([[0.985, 0.960],
        [0.197, 0.133]]) {'epoch': 14, 'valid/acc': 62.257, 'valid/acc_unbiased': 58.044, 'valid/diff': 3.448, 'valid/acc_skew': 57.309, 'valid/acc_align': 58.78, 'test/acc': 62.01, 'test/acc_unbiased': 56.893, 'test/diff': 4.43, 'test/acc_skew': 57.873, 'test/acc_align': 55.913}
[14 / 20] best valid accuracy: 59.092 at epoch 13 
 best_stats: {'best_valid_epoch': 13, 'best_valid_valid/acc': 62.919, 'best_valid_valid/acc_unbiased': 59.092, 'best_valid_valid/diff': 2.555, 'best_valid_valid/acc_skew': 58.457, 'best_valid_valid/acc_align': 59.726, 'best_valid_test/acc': 62.539, 'best_valid_test/acc_unbiased': 57.672, 'best_valid_test/diff': 4.056, 'best_valid_test/acc_skew': 57.943, 'best_valid_test/acc_align': 57.401}
[14 / 20] best test accuracy: 58.044 at epoch 12 
 best_stats: {'best_test_epoch': 12, 'best_test_valid/acc': 62.698, 'best_test_valid/acc_unbiased': 58.188, 'best_test_valid/diff': 4.762, 'best_test_valid/acc_skew': 57.985, 'best_test_valid/acc_align': 58.391, 'best_test_test/acc': 63.023, 'best_test_test/acc_unbiased': 58.044, 'best_test_test/diff': 4.687, 'best_test_test/acc_skew': 58.014, 'best_test_test/acc_align': 58.074}
[15 / 20] Learning rate: 1e-05 weight: 0.01
[15 / 20] Loss: 4.5433232963687695 CE Loss: 0.44849121440041606 Con Loss: 4.5388383745745475
[15 / 20] tensor([[0.978, 0.943],
        [0.223, 0.139]]) {'epoch': 15, 'valid/acc': 62.743, 'valid/acc_unbiased': 58.78, 'valid/diff': 2.94, 'valid/acc_skew': 58.082, 'valid/acc_align': 59.479, 'test/acc': 62.583, 'test/acc_unbiased': 57.088, 'test/diff': 5.918, 'test/acc_skew': 58.289, 'test/acc_align': 55.886}
[15 / 20] best valid accuracy: 59.092 at epoch 13 
 best_stats: {'best_valid_epoch': 13, 'best_valid_valid/acc': 62.919, 'best_valid_valid/acc_unbiased': 59.092, 'best_valid_valid/diff': 2.555, 'best_valid_valid/acc_skew': 58.457, 'best_valid_valid/acc_align': 59.726, 'best_valid_test/acc': 62.539, 'best_valid_test/acc_unbiased': 57.672, 'best_valid_test/diff': 4.056, 'best_valid_test/acc_skew': 57.943, 'best_valid_test/acc_align': 57.401}
[15 / 20] best test accuracy: 58.044 at epoch 12 
 best_stats: {'best_test_epoch': 12, 'best_test_valid/acc': 62.698, 'best_test_valid/acc_unbiased': 58.188, 'best_test_valid/diff': 4.762, 'best_test_valid/acc_skew': 57.985, 'best_test_valid/acc_align': 58.391, 'best_test_test/acc': 63.023, 'best_test_test/acc_unbiased': 58.044, 'best_test_test/diff': 4.687, 'best_test_test/acc_skew': 58.014, 'best_test_test/acc_align': 58.074}
[16 / 20] Learning rate: 1e-05 weight: 0.01
[16 / 20] Loss: 4.4918544246926375 CE Loss: 0.4465879201331151 Con Loss: 4.4873885644236475
[16 / 20] tensor([[0.976, 0.943],
        [0.253, 0.158]]) {'epoch': 16, 'valid/acc': 63.404, 'valid/acc_unbiased': 59.338, 'valid/diff': 3.597, 'valid/acc_skew': 58.698, 'valid/acc_align': 59.978, 'test/acc': 63.773, 'test/acc_unbiased': 58.245, 'test/diff': 6.414, 'test/acc_skew': 59.789, 'test/acc_align': 56.701}
[16 / 20] best valid accuracy: 59.338 at epoch 16 
 best_stats: {'best_valid_epoch': 16, 'best_valid_valid/acc': 63.404, 'best_valid_valid/acc_unbiased': 59.338, 'best_valid_valid/diff': 3.597, 'best_valid_valid/acc_skew': 58.698, 'best_valid_valid/acc_align': 59.978, 'best_valid_test/acc': 63.773, 'best_valid_test/acc_unbiased': 58.245, 'best_valid_test/diff': 6.414, 'best_valid_test/acc_skew': 59.789, 'best_valid_test/acc_align': 56.701}
[16 / 20] best test accuracy: 58.245 at epoch 16 
 best_stats: {'best_test_epoch': 16, 'best_test_valid/acc': 63.404, 'best_test_valid/acc_unbiased': 59.338, 'best_test_valid/diff': 3.597, 'best_test_valid/acc_skew': 58.698, 'best_test_valid/acc_align': 59.978, 'best_test_test/acc': 63.773, 'best_test_test/acc_unbiased': 58.245, 'best_test_test/diff': 6.414, 'best_test_test/acc_skew': 59.789, 'best_test_test/acc_align': 56.701}
[17 / 20] Learning rate: 1e-05 weight: 0.01
[17 / 20] Loss: 4.508935996362307 CE Loss: 0.4476936248436888 Con Loss: 4.5044590535122815
[17 / 20] tensor([[0.976, 0.943],
        [0.248, 0.158]]) {'epoch': 17, 'valid/acc': 63.183, 'valid/acc_unbiased': 59.1, 'valid/diff': 3.598, 'valid/acc_skew': 58.717, 'valid/acc_align': 59.483, 'test/acc': 63.596, 'test/acc_unbiased': 58.129, 'test/diff': 6.183, 'test/acc_skew': 59.558, 'test/acc_align': 56.701}
[17 / 20] best valid accuracy: 59.338 at epoch 16 
 best_stats: {'best_valid_epoch': 16, 'best_valid_valid/acc': 63.404, 'best_valid_valid/acc_unbiased': 59.338, 'best_valid_valid/diff': 3.597, 'best_valid_valid/acc_skew': 58.698, 'best_valid_valid/acc_align': 59.978, 'best_valid_test/acc': 63.773, 'best_valid_test/acc_unbiased': 58.245, 'best_valid_test/diff': 6.414, 'best_valid_test/acc_skew': 59.789, 'best_valid_test/acc_align': 56.701}
[17 / 20] best test accuracy: 58.245 at epoch 16 
 best_stats: {'best_test_epoch': 16, 'best_test_valid/acc': 63.404, 'best_test_valid/acc_unbiased': 59.338, 'best_test_valid/diff': 3.597, 'best_test_valid/acc_skew': 58.698, 'best_test_valid/acc_align': 59.978, 'best_test_test/acc': 63.773, 'best_test_test/acc_unbiased': 58.245, 'best_test_test/diff': 6.414, 'best_test_test/acc_skew': 59.789, 'best_test_test/acc_align': 56.701}
[18 / 20] Learning rate: 1e-05 weight: 0.01
[18 / 20] Loss: 4.514009469995245 CE Loss: 0.4511276333129437 Con Loss: 4.509498183801352
[18 / 20] tensor([[0.976, 0.943],
        [0.240, 0.164]]) {'epoch': 18, 'valid/acc': 63.272, 'valid/acc_unbiased': 59.326, 'valid/diff': 3.059, 'valid/acc_skew': 58.479, 'valid/acc_align': 60.173, 'test/acc': 63.332, 'test/acc_unbiased': 58.079, 'test/diff': 5.476, 'test/acc_skew': 59.154, 'test/acc_align': 57.004}
[18 / 20] best valid accuracy: 59.338 at epoch 16 
 best_stats: {'best_valid_epoch': 16, 'best_valid_valid/acc': 63.404, 'best_valid_valid/acc_unbiased': 59.338, 'best_valid_valid/diff': 3.597, 'best_valid_valid/acc_skew': 58.698, 'best_valid_valid/acc_align': 59.978, 'best_valid_test/acc': 63.773, 'best_valid_test/acc_unbiased': 58.245, 'best_valid_test/diff': 6.414, 'best_valid_test/acc_skew': 59.789, 'best_valid_test/acc_align': 56.701}
[18 / 20] best test accuracy: 58.245 at epoch 16 
 best_stats: {'best_test_epoch': 16, 'best_test_valid/acc': 63.404, 'best_test_valid/acc_unbiased': 59.338, 'best_test_valid/diff': 3.597, 'best_test_valid/acc_skew': 58.698, 'best_test_valid/acc_align': 59.978, 'best_test_test/acc': 63.773, 'best_test_test/acc_unbiased': 58.245, 'best_test_test/diff': 6.414, 'best_test_test/acc_skew': 59.789, 'best_test_test/acc_align': 56.701}
[19 / 20] Learning rate: 1e-05 weight: 0.01
[19 / 20] Loss: 4.526649427431793 CE Loss: 0.44553121302914234 Con Loss: 4.5221941482703905
[19 / 20] tensor([[0.975, 0.932],
        [0.256, 0.182]]) {'epoch': 19, 'valid/acc': 64.109, 'valid/acc_unbiased': 60.179, 'valid/diff': 3.298, 'valid/acc_skew': 59.293, 'valid/acc_align': 61.066, 'test/acc': 63.905, 'test/acc_unbiased': 58.606, 'test/diff': 5.849, 'test/acc_skew': 59.394, 'test/acc_align': 57.819}
[19 / 20] best valid accuracy: 60.179 at epoch 19 
 best_stats: {'best_valid_epoch': 19, 'best_valid_valid/acc': 64.109, 'best_valid_valid/acc_unbiased': 60.179, 'best_valid_valid/diff': 3.298, 'best_valid_valid/acc_skew': 59.293, 'best_valid_valid/acc_align': 61.066, 'best_valid_test/acc': 63.905, 'best_valid_test/acc_unbiased': 58.606, 'best_valid_test/diff': 5.849, 'best_valid_test/acc_skew': 59.394, 'best_valid_test/acc_align': 57.819}
[19 / 20] best test accuracy: 58.606 at epoch 19 
 best_stats: {'best_test_epoch': 19, 'best_test_valid/acc': 64.109, 'best_test_valid/acc_unbiased': 60.179, 'best_test_valid/diff': 3.298, 'best_test_valid/acc_skew': 59.293, 'best_test_valid/acc_align': 61.066, 'best_test_test/acc': 63.905, 'best_test_test/acc_unbiased': 58.606, 'best_test_test/diff': 5.849, 'best_test_test/acc_skew': 59.394, 'best_test_test/acc_align': 57.819}
[20 / 20] Learning rate: 1e-05 weight: 0.01
[20 / 20] Loss: 4.526340513361478 CE Loss: 0.4462299857613568 Con Loss: 4.521878222676531
[20 / 20] tensor([[0.972, 0.932],
        [0.283, 0.188]]) {'epoch': 20, 'valid/acc': 64.947, 'valid/acc_unbiased': 60.954, 'valid/diff': 3.858, 'valid/acc_skew': 60.541, 'valid/acc_align': 61.366, 'test/acc': 64.83, 'test/acc_unbiased': 59.35, 'test/diff': 6.731, 'test/acc_skew': 60.72, 'test/acc_align': 57.98}
[20 / 20] best valid accuracy: 60.954 at epoch 20 
 best_stats: {'best_valid_epoch': 20, 'best_valid_valid/acc': 64.947, 'best_valid_valid/acc_unbiased': 60.954, 'best_valid_valid/diff': 3.858, 'best_valid_valid/acc_skew': 60.541, 'best_valid_valid/acc_align': 61.366, 'best_valid_test/acc': 64.83, 'best_valid_test/acc_unbiased': 59.35, 'best_valid_test/diff': 6.731, 'best_valid_test/acc_skew': 60.72, 'best_valid_test/acc_align': 57.98}
[20 / 20] best test accuracy: 59.350 at epoch 20 
 best_stats: {'best_test_epoch': 20, 'best_test_valid/acc': 64.947, 'best_test_valid/acc_unbiased': 60.954, 'best_test_valid/diff': 3.858, 'best_test_valid/acc_skew': 60.541, 'best_test_valid/acc_align': 61.366, 'best_test_test/acc': 64.83, 'best_test_test/acc_unbiased': 59.35, 'best_test_test/diff': 6.731, 'best_test_test/acc_skew': 60.72, 'best_test_test/acc_align': 57.98}
Total training time: 0:16:41
