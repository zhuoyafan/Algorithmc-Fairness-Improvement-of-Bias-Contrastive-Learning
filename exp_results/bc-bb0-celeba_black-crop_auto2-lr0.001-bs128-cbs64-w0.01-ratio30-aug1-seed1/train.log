Log level set to: INFO
Set seed: 1
=======> Using Fixed Random Seed: 1 <========
save_path: exp_results/bc-bb0-celeba_black-crop_auto2-lr0.001-bs128-cbs64-w0.01-ratio30-aug1-seed1
get_celeba - split:train, aug: False, given_y: True, ratio: 0
use existing black indices from data/celeba/pickles/black
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [60539, 38593]
Target 1: [8008, 16048]
Binary Target 1
---------------------------
Target 0: [60539, 38593]
Target 1: [8008, 16048]
===================================
Normal Label Distribution: 
Target 0: [60539, 38593]
Target 1: [8008, 16048]
===================================
Use BiasedCelebASplit 
 target_attr: black split: train 
 tensor([[60539.,  8008.],
        [38593., 16048.]])
get_celeba - split:train, aug: 1, given_y: True, ratio: 30
use existing black indices from data/celeba/pickles/black
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [60508, 38612]
Target 1: [8008, 16060]
Binary Target 1
---------------------------
Target 0: [60508, 38612]
Target 1: [8008, 16060]
===================================
Normal Label Distribution: 
Target 0: [60508, 38612]
Target 1: [8008, 16060]
===================================
Use BiasedCelebASplit 
 target_attr: black split: train 
 tensor([[60508.,  8008.],
        [38612., 16060.]])
get_celeba - split:train_valid, aug: False, given_y: True, ratio: 0
use existing black indices from data/celeba/pickles/black
Use BiasedCelebASplit 
 target_attr: black split: train_valid 
 tensor([[15227.,  1970.],
        [ 9563.,  4038.]])
get_celeba - split:valid, aug: False, given_y: True, ratio: 0
Use BiasedCelebASplit 
 target_attr: black split: valid 
 tensor([[9752., 1657.],
        [5971., 2487.]])
decay_epochs: [3, 6]
[1 / 10] Learning rate: 0.001 weight: 0.01
[1 / 10] Loss: 4.833787648419333 CE Loss: 0.33518606565906484 Con Loss: 4.830435795509479
[1 / 10] tensor([[0.946, 0.914],
        [0.708, 0.690]]) {'epoch': 1, 'valid/acc': 87.941, 'valid/acc_unbiased': 80.002, 'valid/diff': 2.576, 'valid/acc_skew': 80.278, 'valid/acc_align': 79.726, 'test/acc': 88.413, 'test/acc_unbiased': 81.426, 'test/diff': 2.494, 'test/acc_skew': 81.074, 'test/acc_align': 81.777}
[1 / 10] best valid accuracy: 80.002 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 87.941, 'best_valid_valid/acc_unbiased': 80.002, 'best_valid_valid/diff': 2.576, 'best_valid_valid/acc_skew': 80.278, 'best_valid_valid/acc_align': 79.726, 'best_valid_test/acc': 88.413, 'best_valid_test/acc_unbiased': 81.426, 'best_valid_test/diff': 2.494, 'best_valid_test/acc_skew': 81.074, 'best_valid_test/acc_align': 81.777}
[1 / 10] best test accuracy: 81.426 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 87.941, 'best_test_valid/acc_unbiased': 80.002, 'best_test_valid/diff': 2.576, 'best_test_valid/acc_skew': 80.278, 'best_test_valid/acc_align': 79.726, 'best_test_test/acc': 88.413, 'best_test_test/acc_unbiased': 81.426, 'best_test_test/diff': 2.494, 'best_test_test/acc_skew': 81.074, 'best_test_test/acc_align': 81.777}
[2 / 10] Learning rate: 0.001 weight: 0.01
[2 / 10] Loss: 4.821524807805848 CE Loss: 0.3061081872058541 Con Loss: 4.818463722397709
[2 / 10] tensor([[0.968, 0.960],
        [0.562, 0.529]]) {'epoch': 2, 'valid/acc': 87.704, 'valid/acc_unbiased': 74.092, 'valid/diff': 2.041, 'valid/acc_skew': 74.709, 'valid/acc_align': 73.474, 'test/acc': 87.663, 'test/acc_unbiased': 75.464, 'test/diff': 2.049, 'test/acc_skew': 76.075, 'test/acc_align': 74.853}
[2 / 10] best valid accuracy: 80.002 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 87.941, 'best_valid_valid/acc_unbiased': 80.002, 'best_valid_valid/diff': 2.576, 'best_valid_valid/acc_skew': 80.278, 'best_valid_valid/acc_align': 79.726, 'best_valid_test/acc': 88.413, 'best_valid_test/acc_unbiased': 81.426, 'best_valid_test/diff': 2.494, 'best_valid_test/acc_skew': 81.074, 'best_valid_test/acc_align': 81.777}
[2 / 10] best test accuracy: 81.426 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 87.941, 'best_test_valid/acc_unbiased': 80.002, 'best_test_valid/diff': 2.576, 'best_test_valid/acc_skew': 80.278, 'best_test_valid/acc_align': 79.726, 'best_test_test/acc': 88.413, 'best_test_test/acc_unbiased': 81.426, 'best_test_test/diff': 2.494, 'best_test_test/acc_skew': 81.074, 'best_test_test/acc_align': 81.777}
[3 / 10] Learning rate: 0.001 weight: 0.01
[3 / 10] Loss: 4.813758679596283 CE Loss: 0.29652833389621214 Con Loss: 4.810793391898859
[3 / 10] tensor([[0.998, 0.989],
        [0.110, 0.238]]) {'epoch': 3, 'valid/acc': 83.999, 'valid/acc_unbiased': 58.547, 'valid/diff': 6.538, 'valid/acc_skew': 55.278, 'valid/acc_align': 61.816, 'test/acc': 82.629, 'test/acc_unbiased': 58.392, 'test/diff': 6.795, 'test/acc_skew': 54.994, 'test/acc_align': 61.789}
[3 / 10] best valid accuracy: 80.002 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 87.941, 'best_valid_valid/acc_unbiased': 80.002, 'best_valid_valid/diff': 2.576, 'best_valid_valid/acc_skew': 80.278, 'best_valid_valid/acc_align': 79.726, 'best_valid_test/acc': 88.413, 'best_valid_test/acc_unbiased': 81.426, 'best_valid_test/diff': 2.494, 'best_valid_test/acc_skew': 81.074, 'best_valid_test/acc_align': 81.777}
[3 / 10] best test accuracy: 81.426 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 87.941, 'best_test_valid/acc_unbiased': 80.002, 'best_test_valid/diff': 2.576, 'best_test_valid/acc_skew': 80.278, 'best_test_valid/acc_align': 79.726, 'best_test_test/acc': 88.413, 'best_test_test/acc_unbiased': 81.426, 'best_test_test/diff': 2.494, 'best_test_test/acc_skew': 81.074, 'best_test_test/acc_align': 81.777}
[4 / 10] Learning rate: 0.0001 weight: 0.01
[4 / 10] Loss: 4.786801083883682 CE Loss: 0.2643759716323325 Con Loss: 4.784157320203366
[4 / 10] tensor([[0.960, 0.922],
        [0.701, 0.728]]) {'epoch': 4, 'valid/acc': 89.632, 'valid/acc_unbiased': 81.233, 'valid/diff': 3.192, 'valid/acc_skew': 79.637, 'valid/acc_align': 82.829, 'test/acc': 89.777, 'test/acc_unbiased': 82.759, 'test/diff': 3.29, 'test/acc_skew': 81.114, 'test/acc_align': 84.405}
[4 / 10] best valid accuracy: 81.233 at epoch 4 
 best_stats: {'best_valid_epoch': 4, 'best_valid_valid/acc': 89.632, 'best_valid_valid/acc_unbiased': 81.233, 'best_valid_valid/diff': 3.192, 'best_valid_valid/acc_skew': 79.637, 'best_valid_valid/acc_align': 82.829, 'best_valid_test/acc': 89.777, 'best_valid_test/acc_unbiased': 82.759, 'best_valid_test/diff': 3.29, 'best_valid_test/acc_skew': 81.114, 'best_valid_test/acc_align': 84.405}
[4 / 10] best test accuracy: 82.759 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 89.632, 'best_test_valid/acc_unbiased': 81.233, 'best_test_valid/diff': 3.192, 'best_test_valid/acc_skew': 79.637, 'best_test_valid/acc_align': 82.829, 'best_test_test/acc': 89.777, 'best_test_test/acc_unbiased': 82.759, 'best_test_test/diff': 3.29, 'best_test_test/acc_skew': 81.114, 'best_test_test/acc_align': 84.405}
[5 / 10] Learning rate: 0.0001 weight: 0.01
[5 / 10] Loss: 4.779846253199837 CE Loss: 0.2517541695129609 Con Loss: 4.777328718411914
[5 / 10] tensor([[0.949, 0.920],
        [0.748, 0.745]]) {'epoch': 5, 'valid/acc': 89.84, 'valid/acc_unbiased': 83.554, 'valid/diff': 1.931, 'valid/acc_skew': 83.155, 'valid/acc_align': 83.954, 'test/acc': 89.762, 'test/acc_unbiased': 84.016, 'test/diff': 1.604, 'test/acc_skew': 83.367, 'test/acc_align': 84.665}
[5 / 10] best valid accuracy: 83.554 at epoch 5 
 best_stats: {'best_valid_epoch': 5, 'best_valid_valid/acc': 89.84, 'best_valid_valid/acc_unbiased': 83.554, 'best_valid_valid/diff': 1.931, 'best_valid_valid/acc_skew': 83.155, 'best_valid_valid/acc_align': 83.954, 'best_valid_test/acc': 89.762, 'best_valid_test/acc_unbiased': 84.016, 'best_valid_test/diff': 1.604, 'best_valid_test/acc_skew': 83.367, 'best_valid_test/acc_align': 84.665}
[5 / 10] best test accuracy: 84.016 at epoch 5 
 best_stats: {'best_test_epoch': 5, 'best_test_valid/acc': 89.84, 'best_test_valid/acc_unbiased': 83.554, 'best_test_valid/diff': 1.931, 'best_test_valid/acc_skew': 83.155, 'best_test_valid/acc_align': 83.954, 'best_test_test/acc': 89.762, 'best_test_test/acc_unbiased': 84.016, 'best_test_test/diff': 1.604, 'best_test_test/acc_skew': 83.367, 'best_test_test/acc_align': 84.665}
[6 / 10] Learning rate: 0.0001 weight: 0.01
[6 / 10] Loss: 4.7737558878570905 CE Loss: 0.24528617168789302 Con Loss: 4.77130303022269
[6 / 10] tensor([[0.959, 0.937],
        [0.698, 0.700]]) {'epoch': 6, 'valid/acc': 89.944, 'valid/acc_unbiased': 81.617, 'valid/diff': 1.379, 'valid/acc_skew': 81.526, 'valid/acc_align': 81.708, 'test/acc': 89.858, 'test/acc_unbiased': 82.374, 'test/diff': 1.246, 'test/acc_skew': 81.751, 'test/acc_align': 82.997}
[6 / 10] best valid accuracy: 83.554 at epoch 5 
 best_stats: {'best_valid_epoch': 5, 'best_valid_valid/acc': 89.84, 'best_valid_valid/acc_unbiased': 83.554, 'best_valid_valid/diff': 1.931, 'best_valid_valid/acc_skew': 83.155, 'best_valid_valid/acc_align': 83.954, 'best_valid_test/acc': 89.762, 'best_valid_test/acc_unbiased': 84.016, 'best_valid_test/diff': 1.604, 'best_valid_test/acc_skew': 83.367, 'best_valid_test/acc_align': 84.665}
[6 / 10] best test accuracy: 84.016 at epoch 5 
 best_stats: {'best_test_epoch': 5, 'best_test_valid/acc': 89.84, 'best_test_valid/acc_unbiased': 83.554, 'best_test_valid/diff': 1.931, 'best_test_valid/acc_skew': 83.155, 'best_test_valid/acc_align': 83.954, 'best_test_test/acc': 89.762, 'best_test_test/acc_unbiased': 84.016, 'best_test_test/diff': 1.604, 'best_test_test/acc_skew': 83.367, 'best_test_test/acc_align': 84.665}
[7 / 10] Learning rate: 1e-05 weight: 0.01
[7 / 10] Loss: 4.768871959852012 CE Loss: 0.2406241144970082 Con Loss: 4.7664657227616845
[7 / 10] tensor([[0.954, 0.926],
        [0.745, 0.741]]) {'epoch': 7, 'valid/acc': 90.207, 'valid/acc_unbiased': 83.67, 'valid/diff': 2.331, 'valid/acc_skew': 83.716, 'valid/acc_align': 83.623, 'test/acc': 90.19, 'test/acc_unbiased': 84.189, 'test/diff': 1.601, 'test/acc_skew': 83.582, 'test/acc_align': 84.796}
[7 / 10] best valid accuracy: 83.670 at epoch 7 
 best_stats: {'best_valid_epoch': 7, 'best_valid_valid/acc': 90.207, 'best_valid_valid/acc_unbiased': 83.67, 'best_valid_valid/diff': 2.331, 'best_valid_valid/acc_skew': 83.716, 'best_valid_valid/acc_align': 83.623, 'best_valid_test/acc': 90.19, 'best_valid_test/acc_unbiased': 84.189, 'best_valid_test/diff': 1.601, 'best_valid_test/acc_skew': 83.582, 'best_valid_test/acc_align': 84.796}
[7 / 10] best test accuracy: 84.189 at epoch 7 
 best_stats: {'best_test_epoch': 7, 'best_test_valid/acc': 90.207, 'best_test_valid/acc_unbiased': 83.67, 'best_test_valid/diff': 2.331, 'best_test_valid/acc_skew': 83.716, 'best_test_valid/acc_align': 83.623, 'best_test_test/acc': 90.19, 'best_test_test/acc_unbiased': 84.189, 'best_test_test/diff': 1.601, 'best_test_test/acc_skew': 83.582, 'best_test_test/acc_align': 84.796}
[8 / 10] Learning rate: 1e-05 weight: 0.01
[8 / 10] Loss: 4.766529735390287 CE Loss: 0.23782632555261612 Con Loss: 4.764151473360743
[8 / 10] tensor([[0.949, 0.924],
        [0.763, 0.752]]) {'epoch': 8, 'valid/acc': 90.061, 'valid/acc_unbiased': 84.019, 'valid/diff': 2.668, 'valid/acc_skew': 84.337, 'valid/acc_align': 83.702, 'test/acc': 90.119, 'test/acc_unbiased': 84.695, 'test/diff': 1.826, 'test/acc_skew': 84.378, 'test/acc_align': 85.012}
[8 / 10] best valid accuracy: 84.019 at epoch 8 
 best_stats: {'best_valid_epoch': 8, 'best_valid_valid/acc': 90.061, 'best_valid_valid/acc_unbiased': 84.019, 'best_valid_valid/diff': 2.668, 'best_valid_valid/acc_skew': 84.337, 'best_valid_valid/acc_align': 83.702, 'best_valid_test/acc': 90.119, 'best_valid_test/acc_unbiased': 84.695, 'best_valid_test/diff': 1.826, 'best_valid_test/acc_skew': 84.378, 'best_valid_test/acc_align': 85.012}
[8 / 10] best test accuracy: 84.695 at epoch 8 
 best_stats: {'best_test_epoch': 8, 'best_test_valid/acc': 90.061, 'best_test_valid/acc_unbiased': 84.019, 'best_test_valid/diff': 2.668, 'best_test_valid/acc_skew': 84.337, 'best_test_valid/acc_align': 83.702, 'best_test_test/acc': 90.119, 'best_test_test/acc_unbiased': 84.695, 'best_test_test/diff': 1.826, 'best_test_test/acc_skew': 84.378, 'best_test_test/acc_align': 85.012}
[9 / 10] Learning rate: 1e-05 weight: 0.01
[9 / 10] Loss: 4.763950745881438 CE Loss: 0.23649619764055327 Con Loss: 4.761585789910964
[9 / 10] tensor([[0.953, 0.928],
        [0.744, 0.735]]) {'epoch': 9, 'valid/acc': 90.269, 'valid/acc_unbiased': 83.689, 'valid/diff': 2.629, 'valid/acc_skew': 84.036, 'valid/acc_align': 83.342, 'test/acc': 90.094, 'test/acc_unbiased': 83.995, 'test/diff': 1.696, 'test/acc_skew': 83.592, 'test/acc_align': 84.398}
[9 / 10] best valid accuracy: 84.019 at epoch 8 
 best_stats: {'best_valid_epoch': 8, 'best_valid_valid/acc': 90.061, 'best_valid_valid/acc_unbiased': 84.019, 'best_valid_valid/diff': 2.668, 'best_valid_valid/acc_skew': 84.337, 'best_valid_valid/acc_align': 83.702, 'best_valid_test/acc': 90.119, 'best_valid_test/acc_unbiased': 84.695, 'best_valid_test/diff': 1.826, 'best_valid_test/acc_skew': 84.378, 'best_valid_test/acc_align': 85.012}
[9 / 10] best test accuracy: 84.695 at epoch 8 
 best_stats: {'best_test_epoch': 8, 'best_test_valid/acc': 90.061, 'best_test_valid/acc_unbiased': 84.019, 'best_test_valid/diff': 2.668, 'best_test_valid/acc_skew': 84.337, 'best_test_valid/acc_align': 83.702, 'best_test_test/acc': 90.119, 'best_test_test/acc_unbiased': 84.695, 'best_test_test/diff': 1.826, 'best_test_test/acc_skew': 84.378, 'best_test_test/acc_align': 85.012}
[10 / 10] Learning rate: 1e-05 weight: 0.01
[10 / 10] Loss: 4.763891696527367 CE Loss: 0.23459601857296256 Con Loss: 4.761545737912161
[10 / 10] tensor([[0.962, 0.939],
        [0.718, 0.711]]) {'epoch': 10, 'valid/acc': 90.447, 'valid/acc_unbiased': 82.697, 'valid/diff': 2.053, 'valid/acc_skew': 82.795, 'valid/acc_align': 82.599, 'test/acc': 90.316, 'test/acc_unbiased': 83.239, 'test/diff': 1.534, 'test/acc_skew': 82.835, 'test/acc_align': 83.643}
[10 / 10] best valid accuracy: 84.019 at epoch 8 
 best_stats: {'best_valid_epoch': 8, 'best_valid_valid/acc': 90.061, 'best_valid_valid/acc_unbiased': 84.019, 'best_valid_valid/diff': 2.668, 'best_valid_valid/acc_skew': 84.337, 'best_valid_valid/acc_align': 83.702, 'best_valid_test/acc': 90.119, 'best_valid_test/acc_unbiased': 84.695, 'best_valid_test/diff': 1.826, 'best_valid_test/acc_skew': 84.378, 'best_valid_test/acc_align': 85.012}
[10 / 10] best test accuracy: 84.695 at epoch 8 
 best_stats: {'best_test_epoch': 8, 'best_test_valid/acc': 90.061, 'best_test_valid/acc_unbiased': 84.019, 'best_test_valid/diff': 2.668, 'best_test_valid/acc_skew': 84.337, 'best_test_valid/acc_align': 83.702, 'best_test_test/acc': 90.119, 'best_test_test/acc_unbiased': 84.695, 'best_test_test/diff': 1.826, 'best_test_test/acc_skew': 84.378, 'best_test_test/acc_align': 85.012}
Total training time: 0:47:55
