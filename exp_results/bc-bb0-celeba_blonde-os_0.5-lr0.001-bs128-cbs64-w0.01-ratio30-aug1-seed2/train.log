Log level set to: INFO
Set seed: 2
=======> Using Fixed Random Seed: 2 <========
save_path: exp_results/bc-bb0-celeba_blonde-os_0.5-lr0.001-bs128-cbs64-w0.01-ratio30-aug1-seed2
get_celeba - split:train, aug: False, given_y: True, ratio: 0
use existing blonde indices from data/celeba/pickles/blonde
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [26777, 26777]
Target 1: [26777, 26777]
Binary Target 1
---------------------------
Target 0: [26777, 26777]
Target 1: [26777, 26777]
===================================
Normal Label Distribution: 
Target 0: [26777, 26777]
Target 1: [26777, 26777]
===================================
Use BiasedCelebASplit 
 target_attr: blonde split: train 
 tensor([[26777., 26777.],
        [26777., 26777.]])
get_celeba - split:train, aug: 1, given_y: True, ratio: 30
use existing blonde indices from data/celeba/pickles/blonde
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [26737, 26737]
Target 1: [26737, 26737]
Binary Target 1
---------------------------
Target 0: [26737, 26737]
Target 1: [26737, 26737]
===================================
Normal Label Distribution: 
Target 0: [26737, 26737]
Target 1: [26737, 26737]
===================================
Use BiasedCelebASplit 
 target_attr: blonde split: train 
 tensor([[26737., 26737.],
        [26737., 26737.]])
get_celeba - split:train_valid, aug: False, given_y: True, ratio: 0
use existing blonde indices from data/celeba/pickles/blonde
Use BiasedCelebASplit 
 target_attr: blonde split: train_valid 
 tensor([[  403.,  4597.],
        [13344.,   285.]])
get_celeba - split:valid, aug: False, given_y: True, ratio: 0
Use BiasedCelebASplit 
 target_attr: blonde split: valid 
 tensor([[8535., 2874.],
        [8276.,  182.]])
decay_epochs: [3, 6]
[1 / 10] Learning rate: 0.001 weight: 0.01
[1 / 10] Loss: 4.634299358055644 CE Loss: 0.2529716735225273 Con Loss: 4.631769648427038
[1 / 10] tensor([[0.854, 0.901],
        [0.947, 0.912]]) {'epoch': 1, 'valid/acc': 90.831, 'valid/acc_unbiased': 91.77, 'valid/diff': 2.789, 'valid/acc_skew': 93.165, 'valid/acc_align': 90.376, 'test/acc': 88.77, 'test/acc_unbiased': 90.362, 'test/diff': 4.127, 'test/acc_skew': 90.05, 'test/acc_align': 90.674}
[1 / 10] best valid accuracy: 91.770 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 90.831, 'best_valid_valid/acc_unbiased': 91.77, 'best_valid_valid/diff': 2.789, 'best_valid_valid/acc_skew': 93.165, 'best_valid_valid/acc_align': 90.376, 'best_valid_test/acc': 88.77, 'best_valid_test/acc_unbiased': 90.362, 'best_valid_test/diff': 4.127, 'best_valid_test/acc_skew': 90.05, 'best_valid_test/acc_align': 90.674}
[1 / 10] best test accuracy: 90.362 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 90.831, 'best_test_valid/acc_unbiased': 91.77, 'best_test_valid/diff': 2.789, 'best_test_valid/acc_skew': 93.165, 'best_test_valid/acc_align': 90.376, 'best_test_test/acc': 88.77, 'best_test_test/acc_unbiased': 90.362, 'best_test_test/diff': 4.127, 'best_test_test/acc_skew': 90.05, 'best_test_test/acc_align': 90.674}
[2 / 10] Learning rate: 0.001 weight: 0.01
[2 / 10] Loss: 4.582483079821026 CE Loss: 0.21469537637946665 Con Loss: 4.580336121593583
[2 / 10] tensor([[0.806, 0.888],
        [0.975, 0.934]]) {'epoch': 2, 'valid/acc': 91.019, 'valid/acc_unbiased': 92.972, 'valid/diff': 0.768, 'valid/acc_skew': 93.355, 'valid/acc_align': 92.588, 'test/acc': 86.566, 'test/acc_unbiased': 90.063, 'test/diff': 6.121, 'test/acc_skew': 89.029, 'test/acc_align': 91.097}
[2 / 10] best valid accuracy: 92.972 at epoch 2 
 best_stats: {'best_valid_epoch': 2, 'best_valid_valid/acc': 91.019, 'best_valid_valid/acc_unbiased': 92.972, 'best_valid_valid/diff': 0.768, 'best_valid_valid/acc_skew': 93.355, 'best_valid_valid/acc_align': 92.588, 'best_valid_test/acc': 86.566, 'best_valid_test/acc_unbiased': 90.063, 'best_valid_test/diff': 6.121, 'best_valid_test/acc_skew': 89.029, 'best_valid_test/acc_align': 91.097}
[2 / 10] best test accuracy: 90.362 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 90.831, 'best_test_valid/acc_unbiased': 91.77, 'best_test_valid/diff': 2.789, 'best_test_valid/acc_skew': 93.165, 'best_test_valid/acc_align': 90.376, 'best_test_test/acc': 88.77, 'best_test_test/acc_unbiased': 90.362, 'best_test_test/diff': 4.127, 'best_test_test/acc_skew': 90.05, 'best_test_test/acc_align': 90.674}
[3 / 10] Learning rate: 0.001 weight: 0.01
[3 / 10] Loss: 4.555060997604767 CE Loss: 0.20263981010849563 Con Loss: 4.553034594075284
[3 / 10] tensor([[0.750, 0.834],
        [0.982, 0.951]]) {'epoch': 3, 'valid/acc': 86.843, 'valid/acc_unbiased': 90.573, 'valid/diff': 0.466, 'valid/acc_skew': 90.806, 'valid/acc_align': 90.341, 'test/acc': 82.056, 'test/acc_unbiased': 87.916, 'test/diff': 5.745, 'test/acc_skew': 86.594, 'test/acc_align': 89.238}
[3 / 10] best valid accuracy: 92.972 at epoch 2 
 best_stats: {'best_valid_epoch': 2, 'best_valid_valid/acc': 91.019, 'best_valid_valid/acc_unbiased': 92.972, 'best_valid_valid/diff': 0.768, 'best_valid_valid/acc_skew': 93.355, 'best_valid_valid/acc_align': 92.588, 'best_valid_test/acc': 86.566, 'best_valid_test/acc_unbiased': 90.063, 'best_valid_test/diff': 6.121, 'best_valid_test/acc_skew': 89.029, 'best_valid_test/acc_align': 91.097}
[3 / 10] best test accuracy: 90.362 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 90.831, 'best_test_valid/acc_unbiased': 91.77, 'best_test_valid/diff': 2.789, 'best_test_valid/acc_skew': 93.165, 'best_test_valid/acc_align': 90.376, 'best_test_test/acc': 88.77, 'best_test_test/acc_unbiased': 90.362, 'best_test_test/diff': 4.127, 'best_test_test/acc_skew': 90.05, 'best_test_test/acc_align': 90.674}
[4 / 10] Learning rate: 0.0001 weight: 0.01
[4 / 10] Loss: 4.480455342661156 CE Loss: 0.16389577979289485 Con Loss: 4.478816394814456
[4 / 10] tensor([[0.846, 0.930],
        [0.968, 0.912]]) {'epoch': 4, 'valid/acc': 93.585, 'valid/acc_unbiased': 95.27, 'valid/diff': 1.195, 'valid/acc_skew': 95.802, 'valid/acc_align': 94.737, 'test/acc': 89.948, 'test/acc_unbiased': 91.41, 'test/diff': 6.972, 'test/acc_skew': 90.702, 'test/acc_align': 92.118}
[4 / 10] best valid accuracy: 95.270 at epoch 4 
 best_stats: {'best_valid_epoch': 4, 'best_valid_valid/acc': 93.585, 'best_valid_valid/acc_unbiased': 95.27, 'best_valid_valid/diff': 1.195, 'best_valid_valid/acc_skew': 95.802, 'best_valid_valid/acc_align': 94.737, 'best_valid_test/acc': 89.948, 'best_valid_test/acc_unbiased': 91.41, 'best_valid_test/diff': 6.972, 'best_valid_test/acc_skew': 90.702, 'best_valid_test/acc_align': 92.118}
[4 / 10] best test accuracy: 91.410 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 93.585, 'best_test_valid/acc_unbiased': 95.27, 'best_test_valid/diff': 1.195, 'best_test_valid/acc_skew': 95.802, 'best_test_valid/acc_align': 94.737, 'best_test_test/acc': 89.948, 'best_test_test/acc_unbiased': 91.41, 'best_test_test/diff': 6.972, 'best_test_test/acc_skew': 90.702, 'best_test_test/acc_align': 92.118}
[5 / 10] Learning rate: 0.0001 weight: 0.01
[5 / 10] Loss: 4.450755231156174 CE Loss: 0.1486499977816 Con Loss: 4.449268727812386
[5 / 10] tensor([[0.859, 0.943],
        [0.964, 0.896]]) {'epoch': 5, 'valid/acc': 94.45, 'valid/acc_unbiased': 95.833, 'valid/diff': 1.919, 'valid/acc_skew': 96.793, 'valid/acc_align': 94.874, 'test/acc': 90.96, 'test/acc_unbiased': 91.547, 'test/diff': 7.606, 'test/acc_skew': 91.172, 'test/acc_align': 91.923}
[5 / 10] best valid accuracy: 95.833 at epoch 5 
 best_stats: {'best_valid_epoch': 5, 'best_valid_valid/acc': 94.45, 'best_valid_valid/acc_unbiased': 95.833, 'best_valid_valid/diff': 1.919, 'best_valid_valid/acc_skew': 96.793, 'best_valid_valid/acc_align': 94.874, 'best_valid_test/acc': 90.96, 'best_valid_test/acc_unbiased': 91.547, 'best_valid_test/diff': 7.606, 'best_valid_test/acc_skew': 91.172, 'best_valid_test/acc_align': 91.923}
[5 / 10] best test accuracy: 91.547 at epoch 5 
 best_stats: {'best_test_epoch': 5, 'best_test_valid/acc': 94.45, 'best_test_valid/acc_unbiased': 95.833, 'best_test_valid/diff': 1.919, 'best_test_valid/acc_skew': 96.793, 'best_test_valid/acc_align': 94.874, 'best_test_test/acc': 90.96, 'best_test_test/acc_unbiased': 91.547, 'best_test_test/diff': 7.606, 'best_test_test/acc_skew': 91.172, 'best_test_test/acc_align': 91.923}
[6 / 10] Learning rate: 0.0001 weight: 0.01
[6 / 10] Loss: 4.438312443633741 CE Loss: 0.14048899993988817 Con Loss: 4.436907550425554
[6 / 10] tensor([[0.858, 0.944],
        [0.962, 0.896]]) {'epoch': 6, 'valid/acc': 94.847, 'valid/acc_unbiased': 96.385, 'valid/diff': 2.19, 'valid/acc_skew': 97.089, 'valid/acc_align': 95.681, 'test/acc': 90.899, 'test/acc_unbiased': 91.478, 'test/diff': 7.62, 'test/acc_skew': 90.992, 'test/acc_align': 91.965}
[6 / 10] best valid accuracy: 96.385 at epoch 6 
 best_stats: {'best_valid_epoch': 6, 'best_valid_valid/acc': 94.847, 'best_valid_valid/acc_unbiased': 96.385, 'best_valid_valid/diff': 2.19, 'best_valid_valid/acc_skew': 97.089, 'best_valid_valid/acc_align': 95.681, 'best_valid_test/acc': 90.899, 'best_valid_test/acc_unbiased': 91.478, 'best_valid_test/diff': 7.62, 'best_valid_test/acc_skew': 90.992, 'best_valid_test/acc_align': 91.965}
[6 / 10] best test accuracy: 91.547 at epoch 5 
 best_stats: {'best_test_epoch': 5, 'best_test_valid/acc': 94.45, 'best_test_valid/acc_unbiased': 95.833, 'best_test_valid/diff': 1.919, 'best_test_valid/acc_skew': 96.793, 'best_test_valid/acc_align': 94.874, 'best_test_test/acc': 90.96, 'best_test_test/acc_unbiased': 91.547, 'best_test_test/diff': 7.606, 'best_test_test/acc_skew': 91.172, 'best_test_test/acc_align': 91.923}
[7 / 10] Learning rate: 1e-05 weight: 0.01
[7 / 10] Loss: 4.419751637777168 CE Loss: 0.1316116983885881 Con Loss: 4.418435520653355
[7 / 10] tensor([[0.856, 0.953],
        [0.961, 0.901]]) {'epoch': 7, 'valid/acc': 95.287, 'valid/acc_unbiased': 96.258, 'valid/diff': 2.331, 'valid/acc_skew': 97.424, 'valid/acc_align': 95.093, 'test/acc': 91.201, 'test/acc_unbiased': 91.784, 'test/diff': 7.858, 'test/acc_skew': 90.869, 'test/acc_align': 92.699}
[7 / 10] best valid accuracy: 96.385 at epoch 6 
 best_stats: {'best_valid_epoch': 6, 'best_valid_valid/acc': 94.847, 'best_valid_valid/acc_unbiased': 96.385, 'best_valid_valid/diff': 2.19, 'best_valid_valid/acc_skew': 97.089, 'best_valid_valid/acc_align': 95.681, 'best_valid_test/acc': 90.899, 'best_valid_test/acc_unbiased': 91.478, 'best_valid_test/diff': 7.62, 'best_valid_test/acc_skew': 90.992, 'best_valid_test/acc_align': 91.965}
[7 / 10] best test accuracy: 91.784 at epoch 7 
 best_stats: {'best_test_epoch': 7, 'best_test_valid/acc': 95.287, 'best_test_valid/acc_unbiased': 96.258, 'best_test_valid/diff': 2.331, 'best_test_valid/acc_skew': 97.424, 'best_test_valid/acc_align': 95.093, 'best_test_test/acc': 91.201, 'best_test_test/acc_unbiased': 91.784, 'best_test_test/diff': 7.858, 'best_test_test/acc_skew': 90.869, 'best_test_test/acc_align': 92.699}
[8 / 10] Learning rate: 1e-05 weight: 0.01
[8 / 10] Loss: 4.406310187170717 CE Loss: 0.1291755799417108 Con Loss: 4.405018422665667
[8 / 10] tensor([[0.850, 0.949],
        [0.963, 0.896]]) {'epoch': 8, 'valid/acc': 95.013, 'valid/acc_unbiased': 96.354, 'valid/diff': 1.652, 'valid/acc_skew': 97.139, 'valid/acc_align': 95.57, 'test/acc': 90.819, 'test/acc_unbiased': 91.459, 'test/diff': 8.33, 'test/acc_skew': 90.686, 'test/acc_align': 92.231}
[8 / 10] best valid accuracy: 96.385 at epoch 6 
 best_stats: {'best_valid_epoch': 6, 'best_valid_valid/acc': 94.847, 'best_valid_valid/acc_unbiased': 96.385, 'best_valid_valid/diff': 2.19, 'best_valid_valid/acc_skew': 97.089, 'best_valid_valid/acc_align': 95.681, 'best_valid_test/acc': 90.899, 'best_valid_test/acc_unbiased': 91.478, 'best_valid_test/diff': 7.62, 'best_valid_test/acc_skew': 90.992, 'best_valid_test/acc_align': 91.965}
[8 / 10] best test accuracy: 91.784 at epoch 7 
 best_stats: {'best_test_epoch': 7, 'best_test_valid/acc': 95.287, 'best_test_valid/acc_unbiased': 96.258, 'best_test_valid/diff': 2.331, 'best_test_valid/acc_skew': 97.424, 'best_test_valid/acc_align': 95.093, 'best_test_test/acc': 91.201, 'best_test_test/acc_unbiased': 91.784, 'best_test_test/diff': 7.858, 'best_test_test/acc_skew': 90.869, 'best_test_test/acc_align': 92.699}
[9 / 10] Learning rate: 1e-05 weight: 0.01
[9 / 10] Loss: 4.406390204887106 CE Loss: 0.1283952574267787 Con Loss: 4.405106256330201
[9 / 10] tensor([[0.847, 0.949],
        [0.967, 0.907]]) {'epoch': 9, 'valid/acc': 95.147, 'valid/acc_unbiased': 96.585, 'valid/diff': 1.748, 'valid/acc_skew': 97.032, 'valid/acc_align': 96.137, 'test/acc': 90.743, 'test/acc_unbiased': 91.747, 'test/diff': 8.089, 'test/acc_skew': 90.737, 'test/acc_align': 92.756}
[9 / 10] best valid accuracy: 96.585 at epoch 9 
 best_stats: {'best_valid_epoch': 9, 'best_valid_valid/acc': 95.147, 'best_valid_valid/acc_unbiased': 96.585, 'best_valid_valid/diff': 1.748, 'best_valid_valid/acc_skew': 97.032, 'best_valid_valid/acc_align': 96.137, 'best_valid_test/acc': 90.743, 'best_valid_test/acc_unbiased': 91.747, 'best_valid_test/diff': 8.089, 'best_valid_test/acc_skew': 90.737, 'best_valid_test/acc_align': 92.756}
[9 / 10] best test accuracy: 91.784 at epoch 7 
 best_stats: {'best_test_epoch': 7, 'best_test_valid/acc': 95.287, 'best_test_valid/acc_unbiased': 96.258, 'best_test_valid/diff': 2.331, 'best_test_valid/acc_skew': 97.424, 'best_test_valid/acc_align': 95.093, 'best_test_test/acc': 91.201, 'best_test_test/acc_unbiased': 91.784, 'best_test_test/diff': 7.858, 'best_test_test/acc_skew': 90.869, 'best_test_test/acc_align': 92.699}
[10 / 10] Learning rate: 1e-05 weight: 0.01
[10 / 10] Loss: 4.407066669083738 CE Loss: 0.12824848293812924 Con Loss: 4.40578419183578
[10 / 10] tensor([[0.849, 0.949],
        [0.961, 0.896]]) {'epoch': 10, 'valid/acc': 95.185, 'valid/acc_unbiased': 96.396, 'valid/diff': 1.778, 'valid/acc_skew': 97.285, 'valid/acc_align': 95.507, 'test/acc': 90.774, 'test/acc_unbiased': 91.398, 'test/diff': 8.291, 'test/acc_skew': 90.541, 'test/acc_align': 92.255}
[10 / 10] best valid accuracy: 96.585 at epoch 9 
 best_stats: {'best_valid_epoch': 9, 'best_valid_valid/acc': 95.147, 'best_valid_valid/acc_unbiased': 96.585, 'best_valid_valid/diff': 1.748, 'best_valid_valid/acc_skew': 97.032, 'best_valid_valid/acc_align': 96.137, 'best_valid_test/acc': 90.743, 'best_valid_test/acc_unbiased': 91.747, 'best_valid_test/diff': 8.089, 'best_valid_test/acc_skew': 90.737, 'best_valid_test/acc_align': 92.756}
[10 / 10] best test accuracy: 91.784 at epoch 7 
 best_stats: {'best_test_epoch': 7, 'best_test_valid/acc': 95.287, 'best_test_valid/acc_unbiased': 96.258, 'best_test_valid/diff': 2.331, 'best_test_valid/acc_skew': 97.424, 'best_test_valid/acc_align': 95.093, 'best_test_test/acc': 91.201, 'best_test_test/acc_unbiased': 91.784, 'best_test_test/diff': 7.858, 'best_test_test/acc_skew': 90.869, 'best_test_test/acc_align': 92.699}
Total training time: 1:33:58
