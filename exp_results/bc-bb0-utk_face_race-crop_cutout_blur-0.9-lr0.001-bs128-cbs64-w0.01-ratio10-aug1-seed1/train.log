Log level set to: INFO
Set seed: 1
=======> Using Fixed Random Seed: 1 <========
save_path: exp_results/bc-bb0-utk_face_race-crop_cutout_blur-0.9-lr0.001-bs128-cbs64-w0.01-ratio10-aug1-seed1
get_utk_face - split: train, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_race-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [4407, 552]
Target 1: [440, 5529]
Binary Target 1
---------------------------
Target 0: [4407, 552]
Target 1: [440, 5529]
===================================
Normal Label Distribution: 
Target 0: [4407, 552]
Target 1: [440, 5529]
===================================
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [4407, 552]
Target 1: [440, 5529]
Binary Target 1
---------------------------
Target 0: [4407, 552]
Target 1: [440, 5529]
===================================
Normal Label Distribution: 
Target 0: [4407, 552]
Target 1: [440, 5529]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 10928, target_attr: gender, bias_attr: race bias_rate: 0.9
['[train] target_0-bias_0: 4407', '[train] target_0-bias_1: 552', '[train] target_1-bias_0: 440', '[train] target_1-bias_1: 5529']
confusion_matrix - 
 original: tensor([[4407.,  440.],
        [ 552., 5529.]]), 
 normalized: tensor([[0.909, 0.091],
        [0.091, 0.909]]), 
 b|y: tensor([[0.889, 0.111],
        [0.074, 0.926]])
get_utk_face - split: train, aug: 1, given_y: True, ratio: 10
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_race-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [4407, 552]
Target 1: [440, 5529]
Binary Target 1
---------------------------
Target 0: [4407, 552]
Target 1: [440, 5529]
===================================
Normal Label Distribution: 
Target 0: [4407, 552]
Target 1: [440, 5529]
===================================
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [4407, 552]
Target 1: [440, 5529]
Binary Target 1
---------------------------
Target 0: [4407, 552]
Target 1: [440, 5529]
===================================
Normal Label Distribution: 
Target 0: [4407, 552]
Target 1: [440, 5529]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 10928, target_attr: gender, bias_attr: race bias_rate: 0.9
['[train] target_0-bias_0: 4407', '[train] target_0-bias_1: 552', '[train] target_1-bias_0: 440', '[train] target_1-bias_1: 5529']
get_utk_face - split: valid, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_race-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [583, 684]
Target 1: [457, 646]
Binary Target 1
---------------------------
Target 0: [583, 684]
Target 1: [457, 646]
===================================
Normal Label Distribution: 
Target 0: [583, 684]
Target 1: [457, 646]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 2370, target_attr: gender, bias_attr: race bias_rate: 0.9
['[valid] target_0-bias_0: 583', '[valid] target_0-bias_1: 684', '[valid] target_1-bias_0: 457', '[valid] target_1-bias_1: 646']
get_utk_face - split: test, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_race-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [558, 677]
Target 1: [462, 673]
Binary Target 1
---------------------------
Target 0: [558, 677]
Target 1: [462, 673]
===================================
Normal Label Distribution: 
Target 0: [558, 677]
Target 1: [462, 673]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 2370, target_attr: gender, bias_attr: race bias_rate: 0.9
['[test] target_0-bias_0: 558', '[test] target_0-bias_1: 677', '[test] target_1-bias_0: 462', '[test] target_1-bias_1: 673']
decay_epochs: [6, 13]
[1 / 20] Learning rate: 0.001 weight: 0.01
[1 / 20] Loss: 4.90389927449373 CE Loss: 0.5916925821000626 Con Loss: 4.89798235230006
[1 / 20] tensor([[0.593, 0.532],
        [0.777, 0.886]]) {'epoch': 1, 'valid/acc': 69.409, 'valid/acc_unbiased': 70.233, 'valid/diff': 2.989, 'valid/acc_skew': 69.463, 'valid/acc_align': 71.003, 'test/acc': 69.451, 'test/acc_unbiased': 69.69, 'test/diff': 8.498, 'test/acc_skew': 65.441, 'test/acc_align': 73.939}
[1 / 20] best valid accuracy: 70.233 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 69.409, 'best_valid_valid/acc_unbiased': 70.233, 'best_valid_valid/diff': 2.989, 'best_valid_valid/acc_skew': 69.463, 'best_valid_valid/acc_align': 71.003, 'best_valid_test/acc': 69.451, 'best_valid_test/acc_unbiased': 69.69, 'best_valid_test/diff': 8.498, 'best_valid_test/acc_skew': 65.441, 'best_valid_test/acc_align': 73.939}
[1 / 20] best test accuracy: 69.690 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 69.409, 'best_test_valid/acc_unbiased': 70.233, 'best_test_valid/diff': 2.989, 'best_test_valid/acc_skew': 69.463, 'best_test_valid/acc_align': 71.003, 'best_test_test/acc': 69.451, 'best_test_test/acc_unbiased': 69.69, 'best_test_test/diff': 8.498, 'best_test_test/acc_skew': 65.441, 'best_test_test/acc_align': 73.939}
[2 / 20] Learning rate: 0.001 weight: 0.01
[2 / 20] Loss: 4.809926813552879 CE Loss: 0.5062840470545114 Con Loss: 4.804863996771035
[2 / 20] tensor([[0.959, 0.935],
        [0.444, 0.475]]) {'epoch': 2, 'valid/acc': 72.194, 'valid/acc_unbiased': 70.362, 'valid/diff': 0.981, 'valid/acc_skew': 69.871, 'valid/acc_align': 70.852, 'test/acc': 71.435, 'test/acc_unbiased': 70.325, 'test/diff': 2.777, 'test/acc_skew': 68.937, 'test/acc_align': 71.713}
[2 / 20] best valid accuracy: 70.362 at epoch 2 
 best_stats: {'best_valid_epoch': 2, 'best_valid_valid/acc': 72.194, 'best_valid_valid/acc_unbiased': 70.362, 'best_valid_valid/diff': 0.981, 'best_valid_valid/acc_skew': 69.871, 'best_valid_valid/acc_align': 70.852, 'best_valid_test/acc': 71.435, 'best_valid_test/acc_unbiased': 70.325, 'best_valid_test/diff': 2.777, 'best_valid_test/acc_skew': 68.937, 'best_valid_test/acc_align': 71.713}
[2 / 20] best test accuracy: 70.325 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 72.194, 'best_test_valid/acc_unbiased': 70.362, 'best_test_valid/diff': 0.981, 'best_test_valid/acc_skew': 69.871, 'best_test_valid/acc_align': 70.852, 'best_test_test/acc': 71.435, 'best_test_test/acc_unbiased': 70.325, 'best_test_test/diff': 2.777, 'best_test_test/acc_skew': 68.937, 'best_test_test/acc_align': 71.713}
[3 / 20] Learning rate: 0.001 weight: 0.01
[3 / 20] Loss: 4.7993112734435766 CE Loss: 0.48120754616850464 Con Loss: 4.794499201795542
[3 / 20] tensor([[0.366, 0.300],
        [0.974, 0.975]]) {'epoch': 3, 'valid/acc': 63.755, 'valid/acc_unbiased': 65.943, 'valid/diff': 0.374, 'valid/acc_skew': 65.756, 'valid/acc_align': 66.13, 'test/acc': 63.84, 'test/acc_unbiased': 65.355, 'test/diff': 3.323, 'test/acc_skew': 63.694, 'test/acc_align': 67.017}
[3 / 20] best valid accuracy: 70.362 at epoch 2 
 best_stats: {'best_valid_epoch': 2, 'best_valid_valid/acc': 72.194, 'best_valid_valid/acc_unbiased': 70.362, 'best_valid_valid/diff': 0.981, 'best_valid_valid/acc_skew': 69.871, 'best_valid_valid/acc_align': 70.852, 'best_valid_test/acc': 71.435, 'best_valid_test/acc_unbiased': 70.325, 'best_valid_test/diff': 2.777, 'best_valid_test/acc_skew': 68.937, 'best_valid_test/acc_align': 71.713}
[3 / 20] best test accuracy: 70.325 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 72.194, 'best_test_valid/acc_unbiased': 70.362, 'best_test_valid/diff': 0.981, 'best_test_valid/acc_skew': 69.871, 'best_test_valid/acc_align': 70.852, 'best_test_test/acc': 71.435, 'best_test_test/acc_unbiased': 70.325, 'best_test_test/diff': 2.777, 'best_test_test/acc_skew': 68.937, 'best_test_test/acc_align': 71.713}
[4 / 20] Learning rate: 0.001 weight: 0.01
[4 / 20] Loss: 4.785016560449781 CE Loss: 0.4555159063238001 Con Loss: 4.780461386042493
[4 / 20] tensor([[0.658, 0.582],
        [0.909, 0.945]]) {'epoch': 4, 'valid/acc': 75.232, 'valid/acc_unbiased': 76.336, 'valid/diff': 1.923, 'valid/acc_skew': 75.375, 'valid/acc_align': 77.298, 'test/acc': 76.667, 'test/acc_unbiased': 77.345, 'test/diff': 5.583, 'test/acc_skew': 74.554, 'test/acc_align': 80.136}
[4 / 20] best valid accuracy: 76.336 at epoch 4 
 best_stats: {'best_valid_epoch': 4, 'best_valid_valid/acc': 75.232, 'best_valid_valid/acc_unbiased': 76.336, 'best_valid_valid/diff': 1.923, 'best_valid_valid/acc_skew': 75.375, 'best_valid_valid/acc_align': 77.298, 'best_valid_test/acc': 76.667, 'best_valid_test/acc_unbiased': 77.345, 'best_valid_test/diff': 5.583, 'best_valid_test/acc_skew': 74.554, 'best_valid_test/acc_align': 80.136}
[4 / 20] best test accuracy: 77.345 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 75.232, 'best_test_valid/acc_unbiased': 76.336, 'best_test_valid/diff': 1.923, 'best_test_valid/acc_skew': 75.375, 'best_test_valid/acc_align': 77.298, 'best_test_test/acc': 76.667, 'best_test_test/acc_unbiased': 77.345, 'best_test_test/diff': 5.583, 'best_test_test/acc_skew': 74.554, 'best_test_test/acc_align': 80.136}
[5 / 20] Learning rate: 0.001 weight: 0.01
[5 / 20] Loss: 4.768528752585281 CE Loss: 0.4349020412778086 Con Loss: 4.764179703082731
[5 / 20] tensor([[0.692, 0.622],
        [0.924, 0.939]]) {'epoch': 5, 'valid/acc': 78.481, 'valid/acc_unbiased': 79.261, 'valid/diff': 1.455, 'valid/acc_skew': 79.14, 'valid/acc_align': 79.381, 'test/acc': 78.734, 'test/acc_unbiased': 79.423, 'test/diff': 4.237, 'test/acc_skew': 77.305, 'test/acc_align': 81.542}
[5 / 20] best valid accuracy: 79.261 at epoch 5 
 best_stats: {'best_valid_epoch': 5, 'best_valid_valid/acc': 78.481, 'best_valid_valid/acc_unbiased': 79.261, 'best_valid_valid/diff': 1.455, 'best_valid_valid/acc_skew': 79.14, 'best_valid_valid/acc_align': 79.381, 'best_valid_test/acc': 78.734, 'best_valid_test/acc_unbiased': 79.423, 'best_valid_test/diff': 4.237, 'best_valid_test/acc_skew': 77.305, 'best_valid_test/acc_align': 81.542}
[5 / 20] best test accuracy: 79.423 at epoch 5 
 best_stats: {'best_test_epoch': 5, 'best_test_valid/acc': 78.481, 'best_test_valid/acc_unbiased': 79.261, 'best_test_valid/diff': 1.455, 'best_test_valid/acc_skew': 79.14, 'best_test_valid/acc_align': 79.381, 'best_test_test/acc': 78.734, 'best_test_test/acc_unbiased': 79.423, 'best_test_test/diff': 4.237, 'best_test_test/acc_skew': 77.305, 'best_test_test/acc_align': 81.542}
[6 / 20] Learning rate: 0.001 weight: 0.01
[6 / 20] Loss: 4.763297804976277 CE Loss: 0.43674801056590995 Con Loss: 4.758930308228879
[6 / 20] tensor([[0.808, 0.739],
        [0.838, 0.871]]) {'epoch': 6, 'valid/acc': 80.464, 'valid/acc_unbiased': 80.726, 'valid/diff': 2.059, 'valid/acc_skew': 79.696, 'valid/acc_align': 81.755, 'test/acc': 81.181, 'test/acc_unbiased': 81.38, 'test/diff': 5.138, 'test/acc_skew': 78.811, 'test/acc_align': 83.949}
[6 / 20] best valid accuracy: 80.726 at epoch 6 
 best_stats: {'best_valid_epoch': 6, 'best_valid_valid/acc': 80.464, 'best_valid_valid/acc_unbiased': 80.726, 'best_valid_valid/diff': 2.059, 'best_valid_valid/acc_skew': 79.696, 'best_valid_valid/acc_align': 81.755, 'best_valid_test/acc': 81.181, 'best_valid_test/acc_unbiased': 81.38, 'best_valid_test/diff': 5.138, 'best_valid_test/acc_skew': 78.811, 'best_valid_test/acc_align': 83.949}
[6 / 20] best test accuracy: 81.380 at epoch 6 
 best_stats: {'best_test_epoch': 6, 'best_test_valid/acc': 80.464, 'best_test_valid/acc_unbiased': 80.726, 'best_test_valid/diff': 2.059, 'best_test_valid/acc_skew': 79.696, 'best_test_valid/acc_align': 81.755, 'best_test_test/acc': 81.181, 'best_test_test/acc_unbiased': 81.38, 'best_test_test/diff': 5.138, 'best_test_test/acc_skew': 78.811, 'best_test_test/acc_align': 83.949}
[7 / 20] Learning rate: 0.0001 weight: 0.01
[7 / 20] Loss: 4.734278159469672 CE Loss: 0.4016989049328543 Con Loss: 4.73026114920397
[7 / 20] tensor([[0.772, 0.736],
        [0.885, 0.905]]) {'epoch': 7, 'valid/acc': 81.435, 'valid/acc_unbiased': 82.119, 'valid/diff': 2.481, 'valid/acc_skew': 82.539, 'valid/acc_align': 81.699, 'test/acc': 82.152, 'test/acc_unbiased': 82.455, 'test/diff': 2.821, 'test/acc_skew': 81.044, 'test/acc_align': 83.865}
[7 / 20] best valid accuracy: 82.119 at epoch 7 
 best_stats: {'best_valid_epoch': 7, 'best_valid_valid/acc': 81.435, 'best_valid_valid/acc_unbiased': 82.119, 'best_valid_valid/diff': 2.481, 'best_valid_valid/acc_skew': 82.539, 'best_valid_valid/acc_align': 81.699, 'best_valid_test/acc': 82.152, 'best_valid_test/acc_unbiased': 82.455, 'best_valid_test/diff': 2.821, 'best_valid_test/acc_skew': 81.044, 'best_valid_test/acc_align': 83.865}
[7 / 20] best test accuracy: 82.455 at epoch 7 
 best_stats: {'best_test_epoch': 7, 'best_test_valid/acc': 81.435, 'best_test_valid/acc_unbiased': 82.119, 'best_test_valid/diff': 2.481, 'best_test_valid/acc_skew': 82.539, 'best_test_valid/acc_align': 81.699, 'best_test_test/acc': 82.152, 'best_test_test/acc_unbiased': 82.455, 'best_test_test/diff': 2.821, 'best_test_test/acc_skew': 81.044, 'best_test_test/acc_align': 83.865}
[8 / 20] Learning rate: 0.0001 weight: 0.01
[8 / 20] Loss: 4.711479728078772 CE Loss: 0.38760281494909987 Con Loss: 4.70760372128354
[8 / 20] tensor([[0.823, 0.759],
        [0.855, 0.883]]) {'epoch': 8, 'valid/acc': 82.405, 'valid/acc_unbiased': 82.702, 'valid/diff': 0.836, 'valid/acc_skew': 82.654, 'valid/acc_align': 82.751, 'test/acc': 82.785, 'test/acc_unbiased': 82.985, 'test/diff': 4.549, 'test/acc_skew': 80.711, 'test/acc_align': 85.26}
[8 / 20] best valid accuracy: 82.702 at epoch 8 
 best_stats: {'best_valid_epoch': 8, 'best_valid_valid/acc': 82.405, 'best_valid_valid/acc_unbiased': 82.702, 'best_valid_valid/diff': 0.836, 'best_valid_valid/acc_skew': 82.654, 'best_valid_valid/acc_align': 82.751, 'best_valid_test/acc': 82.785, 'best_valid_test/acc_unbiased': 82.985, 'best_valid_test/diff': 4.549, 'best_valid_test/acc_skew': 80.711, 'best_valid_test/acc_align': 85.26}
[8 / 20] best test accuracy: 82.985 at epoch 8 
 best_stats: {'best_test_epoch': 8, 'best_test_valid/acc': 82.405, 'best_test_valid/acc_unbiased': 82.702, 'best_test_valid/diff': 0.836, 'best_test_valid/acc_skew': 82.654, 'best_test_valid/acc_align': 82.751, 'best_test_test/acc': 82.785, 'best_test_test/acc_unbiased': 82.985, 'best_test_test/diff': 4.549, 'best_test_test/acc_skew': 80.711, 'best_test_test/acc_align': 85.26}
[9 / 20] Learning rate: 0.0001 weight: 0.01
[9 / 20] Loss: 4.695400948056714 CE Loss: 0.37151083856341083 Con Loss: 4.691685835753144
[9 / 20] tensor([[0.826, 0.784],
        [0.842, 0.880]]) {'epoch': 9, 'valid/acc': 83.249, 'valid/acc_unbiased': 83.4, 'valid/diff': 0.701, 'valid/acc_skew': 83.459, 'valid/acc_align': 83.341, 'test/acc': 83.249, 'test/acc_unbiased': 83.304, 'test/diff': 3.974, 'test/acc_skew': 81.317, 'test/acc_align': 85.29}
[9 / 20] best valid accuracy: 83.400 at epoch 9 
 best_stats: {'best_valid_epoch': 9, 'best_valid_valid/acc': 83.249, 'best_valid_valid/acc_unbiased': 83.4, 'best_valid_valid/diff': 0.701, 'best_valid_valid/acc_skew': 83.459, 'best_valid_valid/acc_align': 83.341, 'best_valid_test/acc': 83.249, 'best_valid_test/acc_unbiased': 83.304, 'best_valid_test/diff': 3.974, 'best_valid_test/acc_skew': 81.317, 'best_valid_test/acc_align': 85.29}
[9 / 20] best test accuracy: 83.304 at epoch 9 
 best_stats: {'best_test_epoch': 9, 'best_test_valid/acc': 83.249, 'best_test_valid/acc_unbiased': 83.4, 'best_test_valid/diff': 0.701, 'best_test_valid/acc_skew': 83.459, 'best_test_valid/acc_align': 83.341, 'best_test_test/acc': 83.249, 'best_test_test/acc_unbiased': 83.304, 'best_test_test/diff': 3.974, 'best_test_test/acc_skew': 81.317, 'best_test_test/acc_align': 85.29}
[10 / 20] Learning rate: 0.0001 weight: 0.01
[10 / 20] Loss: 4.6784977898939815 CE Loss: 0.36249759007861637 Con Loss: 4.674872783755837
[10 / 20] tensor([[0.824, 0.770],
        [0.868, 0.892]]) {'epoch': 10, 'valid/acc': 83.333, 'valid/acc_unbiased': 83.563, 'valid/diff': 0.504, 'valid/acc_skew': 83.311, 'valid/acc_align': 83.816, 'test/acc': 83.629, 'test/acc_unbiased': 83.836, 'test/diff': 3.918, 'test/acc_skew': 81.877, 'test/acc_align': 85.795}
[10 / 20] best valid accuracy: 83.563 at epoch 10 
 best_stats: {'best_valid_epoch': 10, 'best_valid_valid/acc': 83.333, 'best_valid_valid/acc_unbiased': 83.563, 'best_valid_valid/diff': 0.504, 'best_valid_valid/acc_skew': 83.311, 'best_valid_valid/acc_align': 83.816, 'best_valid_test/acc': 83.629, 'best_valid_test/acc_unbiased': 83.836, 'best_valid_test/diff': 3.918, 'best_valid_test/acc_skew': 81.877, 'best_valid_test/acc_align': 85.795}
[10 / 20] best test accuracy: 83.836 at epoch 10 
 best_stats: {'best_test_epoch': 10, 'best_test_valid/acc': 83.333, 'best_test_valid/acc_unbiased': 83.563, 'best_test_valid/diff': 0.504, 'best_test_valid/acc_skew': 83.311, 'best_test_valid/acc_align': 83.816, 'best_test_test/acc': 83.629, 'best_test_test/acc_unbiased': 83.836, 'best_test_test/diff': 3.918, 'best_test_test/acc_skew': 81.877, 'best_test_test/acc_align': 85.795}
[11 / 20] Learning rate: 0.0001 weight: 0.01
[11 / 20] Loss: 4.663756485739355 CE Loss: 0.35696576025178806 Con Loss: 4.660186846469192
[11 / 20] tensor([[0.821, 0.773],
        [0.870, 0.899]]) {'epoch': 11, 'valid/acc': 83.46, 'valid/acc_unbiased': 83.815, 'valid/diff': 1.514, 'valid/acc_skew': 83.419, 'valid/acc_align': 84.211, 'test/acc': 83.882, 'test/acc_unbiased': 84.06, 'test/diff': 3.855, 'test/acc_skew': 82.133, 'test/acc_align': 85.987}
[11 / 20] best valid accuracy: 83.815 at epoch 11 
 best_stats: {'best_valid_epoch': 11, 'best_valid_valid/acc': 83.46, 'best_valid_valid/acc_unbiased': 83.815, 'best_valid_valid/diff': 1.514, 'best_valid_valid/acc_skew': 83.419, 'best_valid_valid/acc_align': 84.211, 'best_valid_test/acc': 83.882, 'best_valid_test/acc_unbiased': 84.06, 'best_valid_test/diff': 3.855, 'best_valid_test/acc_skew': 82.133, 'best_valid_test/acc_align': 85.987}
[11 / 20] best test accuracy: 84.060 at epoch 11 
 best_stats: {'best_test_epoch': 11, 'best_test_valid/acc': 83.46, 'best_test_valid/acc_unbiased': 83.815, 'best_test_valid/diff': 1.514, 'best_test_valid/acc_skew': 83.419, 'best_test_valid/acc_align': 84.211, 'best_test_test/acc': 83.882, 'best_test_test/acc_unbiased': 84.06, 'best_test_test/diff': 3.855, 'best_test_test/acc_skew': 82.133, 'best_test_test/acc_align': 85.987}
[12 / 20] Learning rate: 0.0001 weight: 0.01
[12 / 20] Loss: 4.667207068615044 CE Loss: 0.35777688008974445 Con Loss: 4.663629297281603
[12 / 20] tensor([[0.828, 0.775],
        [0.864, 0.892]]) {'epoch': 12, 'valid/acc': 83.882, 'valid/acc_unbiased': 84.176, 'valid/diff': 1.212, 'valid/acc_skew': 83.712, 'valid/acc_align': 84.64, 'test/acc': 83.797, 'test/acc_unbiased': 83.965, 'test/diff': 4.019, 'test/acc_skew': 81.956, 'test/acc_align': 85.974}
[12 / 20] best valid accuracy: 84.176 at epoch 12 
 best_stats: {'best_valid_epoch': 12, 'best_valid_valid/acc': 83.882, 'best_valid_valid/acc_unbiased': 84.176, 'best_valid_valid/diff': 1.212, 'best_valid_valid/acc_skew': 83.712, 'best_valid_valid/acc_align': 84.64, 'best_valid_test/acc': 83.797, 'best_valid_test/acc_unbiased': 83.965, 'best_valid_test/diff': 4.019, 'best_valid_test/acc_skew': 81.956, 'best_valid_test/acc_align': 85.974}
[12 / 20] best test accuracy: 84.060 at epoch 11 
 best_stats: {'best_test_epoch': 11, 'best_test_valid/acc': 83.46, 'best_test_valid/acc_unbiased': 83.815, 'best_test_valid/diff': 1.514, 'best_test_valid/acc_skew': 83.419, 'best_test_valid/acc_align': 84.211, 'best_test_test/acc': 83.882, 'best_test_test/acc_unbiased': 84.06, 'best_test_test/diff': 3.855, 'best_test_test/acc_skew': 82.133, 'best_test_test/acc_align': 85.987}
[13 / 20] Learning rate: 0.0001 weight: 0.01
[13 / 20] Loss: 4.663477251854334 CE Loss: 0.3526711667701057 Con Loss: 4.659950548174789
[13 / 20] tensor([[0.801, 0.740],
        [0.879, 0.909]]) {'epoch': 13, 'valid/acc': 82.658, 'valid/acc_unbiased': 83.115, 'valid/diff': 1.98, 'valid/acc_skew': 82.396, 'valid/acc_align': 83.834, 'test/acc': 82.954, 'test/acc_unbiased': 83.231, 'test/diff': 4.581, 'test/acc_skew': 80.941, 'test/acc_align': 85.522}
[13 / 20] best valid accuracy: 84.176 at epoch 12 
 best_stats: {'best_valid_epoch': 12, 'best_valid_valid/acc': 83.882, 'best_valid_valid/acc_unbiased': 84.176, 'best_valid_valid/diff': 1.212, 'best_valid_valid/acc_skew': 83.712, 'best_valid_valid/acc_align': 84.64, 'best_valid_test/acc': 83.797, 'best_valid_test/acc_unbiased': 83.965, 'best_valid_test/diff': 4.019, 'best_valid_test/acc_skew': 81.956, 'best_valid_test/acc_align': 85.974}
[13 / 20] best test accuracy: 84.060 at epoch 11 
 best_stats: {'best_test_epoch': 11, 'best_test_valid/acc': 83.46, 'best_test_valid/acc_unbiased': 83.815, 'best_test_valid/diff': 1.514, 'best_test_valid/acc_skew': 83.419, 'best_test_valid/acc_align': 84.211, 'best_test_test/acc': 83.882, 'best_test_test/acc_unbiased': 84.06, 'best_test_test/diff': 3.855, 'best_test_test/acc_skew': 82.133, 'best_test_test/acc_align': 85.987}
[14 / 20] Learning rate: 1e-05 weight: 0.01
[14 / 20] Loss: 4.652066119767911 CE Loss: 0.3410960316745289 Con Loss: 4.64865516673768
[14 / 20] tensor([[0.815, 0.759],
        [0.872, 0.905]]) {'epoch': 14, 'valid/acc': 83.587, 'valid/acc_unbiased': 83.945, 'valid/diff': 1.301, 'valid/acc_skew': 83.456, 'valid/acc_align': 84.435, 'test/acc': 83.587, 'test/acc_unbiased': 83.796, 'test/diff': 4.439, 'test/acc_skew': 81.576, 'test/acc_align': 86.016}
[14 / 20] best valid accuracy: 84.176 at epoch 12 
 best_stats: {'best_valid_epoch': 12, 'best_valid_valid/acc': 83.882, 'best_valid_valid/acc_unbiased': 84.176, 'best_valid_valid/diff': 1.212, 'best_valid_valid/acc_skew': 83.712, 'best_valid_valid/acc_align': 84.64, 'best_valid_test/acc': 83.797, 'best_valid_test/acc_unbiased': 83.965, 'best_valid_test/diff': 4.019, 'best_valid_test/acc_skew': 81.956, 'best_valid_test/acc_align': 85.974}
[14 / 20] best test accuracy: 84.060 at epoch 11 
 best_stats: {'best_test_epoch': 11, 'best_test_valid/acc': 83.46, 'best_test_valid/acc_unbiased': 83.815, 'best_test_valid/diff': 1.514, 'best_test_valid/acc_skew': 83.419, 'best_test_valid/acc_align': 84.211, 'best_test_test/acc': 83.882, 'best_test_test/acc_unbiased': 84.06, 'best_test_test/diff': 3.855, 'best_test_test/acc_skew': 82.133, 'best_test_test/acc_align': 85.987}
[15 / 20] Learning rate: 1e-05 weight: 0.01
[15 / 20] Loss: 4.646638072252623 CE Loss: 0.3406153361409859 Con Loss: 4.6432319043496
[15 / 20] tensor([[0.814, 0.755],
        [0.874, 0.912]]) {'epoch': 15, 'valid/acc': 83.713, 'valid/acc_unbiased': 84.098, 'valid/diff': 0.67, 'valid/acc_skew': 83.82, 'valid/acc_align': 84.376, 'test/acc': 83.671, 'test/acc_unbiased': 83.88, 'test/diff': 4.835, 'test/acc_skew': 81.463, 'test/acc_align': 86.298}
[15 / 20] best valid accuracy: 84.176 at epoch 12 
 best_stats: {'best_valid_epoch': 12, 'best_valid_valid/acc': 83.882, 'best_valid_valid/acc_unbiased': 84.176, 'best_valid_valid/diff': 1.212, 'best_valid_valid/acc_skew': 83.712, 'best_valid_valid/acc_align': 84.64, 'best_valid_test/acc': 83.797, 'best_valid_test/acc_unbiased': 83.965, 'best_valid_test/diff': 4.019, 'best_valid_test/acc_skew': 81.956, 'best_valid_test/acc_align': 85.974}
[15 / 20] best test accuracy: 84.060 at epoch 11 
 best_stats: {'best_test_epoch': 11, 'best_test_valid/acc': 83.46, 'best_test_valid/acc_unbiased': 83.815, 'best_test_valid/diff': 1.514, 'best_test_valid/acc_skew': 83.419, 'best_test_valid/acc_align': 84.211, 'best_test_test/acc': 83.882, 'best_test_test/acc_unbiased': 84.06, 'best_test_test/diff': 3.855, 'best_test_test/acc_skew': 82.133, 'best_test_test/acc_align': 85.987}
[16 / 20] Learning rate: 1e-05 weight: 0.01
[16 / 20] Loss: 4.638672604567834 CE Loss: 0.3329103445500615 Con Loss: 4.63534349648181
[16 / 20] tensor([[0.812, 0.744],
        [0.877, 0.912]]) {'epoch': 16, 'valid/acc': 83.46, 'valid/acc_unbiased': 83.866, 'valid/diff': 0.962, 'valid/acc_skew': 83.674, 'valid/acc_align': 84.058, 'test/acc': 83.376, 'test/acc_unbiased': 83.631, 'test/diff': 5.154, 'test/acc_skew': 81.054, 'test/acc_align': 86.208}
[16 / 20] best valid accuracy: 84.176 at epoch 12 
 best_stats: {'best_valid_epoch': 12, 'best_valid_valid/acc': 83.882, 'best_valid_valid/acc_unbiased': 84.176, 'best_valid_valid/diff': 1.212, 'best_valid_valid/acc_skew': 83.712, 'best_valid_valid/acc_align': 84.64, 'best_valid_test/acc': 83.797, 'best_valid_test/acc_unbiased': 83.965, 'best_valid_test/diff': 4.019, 'best_valid_test/acc_skew': 81.956, 'best_valid_test/acc_align': 85.974}
[16 / 20] best test accuracy: 84.060 at epoch 11 
 best_stats: {'best_test_epoch': 11, 'best_test_valid/acc': 83.46, 'best_test_valid/acc_unbiased': 83.815, 'best_test_valid/diff': 1.514, 'best_test_valid/acc_skew': 83.419, 'best_test_valid/acc_align': 84.211, 'best_test_test/acc': 83.882, 'best_test_test/acc_unbiased': 84.06, 'best_test_test/diff': 3.855, 'best_test_test/acc_skew': 82.133, 'best_test_test/acc_align': 85.987}
[17 / 20] Learning rate: 1e-05 weight: 0.01
[17 / 20] Loss: 4.633202721747961 CE Loss: 0.3384463900528401 Con Loss: 4.629818258662524
[17 / 20] tensor([[0.814, 0.758],
        [0.877, 0.906]]) {'epoch': 17, 'valid/acc': 83.544, 'valid/acc_unbiased': 83.92, 'valid/diff': 0.34, 'valid/acc_skew': 84.04, 'valid/acc_align': 83.801, 'test/acc': 83.629, 'test/acc_unbiased': 83.86, 'test/diff': 4.282, 'test/acc_skew': 81.719, 'test/acc_align': 86.0}
[17 / 20] best valid accuracy: 84.176 at epoch 12 
 best_stats: {'best_valid_epoch': 12, 'best_valid_valid/acc': 83.882, 'best_valid_valid/acc_unbiased': 84.176, 'best_valid_valid/diff': 1.212, 'best_valid_valid/acc_skew': 83.712, 'best_valid_valid/acc_align': 84.64, 'best_valid_test/acc': 83.797, 'best_valid_test/acc_unbiased': 83.965, 'best_valid_test/diff': 4.019, 'best_valid_test/acc_skew': 81.956, 'best_valid_test/acc_align': 85.974}
[17 / 20] best test accuracy: 84.060 at epoch 11 
 best_stats: {'best_test_epoch': 11, 'best_test_valid/acc': 83.46, 'best_test_valid/acc_unbiased': 83.815, 'best_test_valid/diff': 1.514, 'best_test_valid/acc_skew': 83.419, 'best_test_valid/acc_align': 84.211, 'best_test_test/acc': 83.882, 'best_test_test/acc_unbiased': 84.06, 'best_test_test/diff': 3.855, 'best_test_test/acc_skew': 82.133, 'best_test_test/acc_align': 85.987}
[18 / 20] Learning rate: 1e-05 weight: 0.01
[18 / 20] Loss: 4.637484257950789 CE Loss: 0.3395419957260785 Con Loss: 4.6340888415737345
[18 / 20] tensor([[0.817, 0.765],
        [0.874, 0.905]]) {'epoch': 18, 'valid/acc': 83.755, 'valid/acc_unbiased': 84.107, 'valid/diff': 0.73, 'valid/acc_skew': 83.967, 'valid/acc_align': 84.247, 'test/acc': 83.84, 'test/acc_unbiased': 84.043, 'test/diff': 4.125, 'test/acc_skew': 81.98, 'test/acc_align': 86.105}
[18 / 20] best valid accuracy: 84.176 at epoch 12 
 best_stats: {'best_valid_epoch': 12, 'best_valid_valid/acc': 83.882, 'best_valid_valid/acc_unbiased': 84.176, 'best_valid_valid/diff': 1.212, 'best_valid_valid/acc_skew': 83.712, 'best_valid_valid/acc_align': 84.64, 'best_valid_test/acc': 83.797, 'best_valid_test/acc_unbiased': 83.965, 'best_valid_test/diff': 4.019, 'best_valid_test/acc_skew': 81.956, 'best_valid_test/acc_align': 85.974}
[18 / 20] best test accuracy: 84.060 at epoch 11 
 best_stats: {'best_test_epoch': 11, 'best_test_valid/acc': 83.46, 'best_test_valid/acc_unbiased': 83.815, 'best_test_valid/diff': 1.514, 'best_test_valid/acc_skew': 83.419, 'best_test_valid/acc_align': 84.211, 'best_test_test/acc': 83.882, 'best_test_test/acc_unbiased': 84.06, 'best_test_test/diff': 3.855, 'best_test_test/acc_skew': 82.133, 'best_test_test/acc_align': 85.987}
[19 / 20] Learning rate: 1e-05 weight: 0.01
[19 / 20] Loss: 4.637421173023095 CE Loss: 0.3457005906244672 Con Loss: 4.6339641545911485
[19 / 20] tensor([[0.824, 0.773],
        [0.866, 0.903]]) {'epoch': 19, 'valid/acc': 84.051, 'valid/acc_unbiased': 84.381, 'valid/diff': 0.866, 'valid/acc_skew': 84.406, 'valid/acc_align': 84.357, 'test/acc': 84.008, 'test/acc_unbiased': 84.153, 'test/diff': 4.473, 'test/acc_skew': 81.916, 'test/acc_align': 86.39}
[19 / 20] best valid accuracy: 84.381 at epoch 19 
 best_stats: {'best_valid_epoch': 19, 'best_valid_valid/acc': 84.051, 'best_valid_valid/acc_unbiased': 84.381, 'best_valid_valid/diff': 0.866, 'best_valid_valid/acc_skew': 84.406, 'best_valid_valid/acc_align': 84.357, 'best_valid_test/acc': 84.008, 'best_valid_test/acc_unbiased': 84.153, 'best_valid_test/diff': 4.473, 'best_valid_test/acc_skew': 81.916, 'best_valid_test/acc_align': 86.39}
[19 / 20] best test accuracy: 84.153 at epoch 19 
 best_stats: {'best_test_epoch': 19, 'best_test_valid/acc': 84.051, 'best_test_valid/acc_unbiased': 84.381, 'best_test_valid/diff': 0.866, 'best_test_valid/acc_skew': 84.406, 'best_test_valid/acc_align': 84.357, 'best_test_test/acc': 84.008, 'best_test_test/acc_unbiased': 84.153, 'best_test_test/diff': 4.473, 'best_test_test/acc_skew': 81.916, 'best_test_test/acc_align': 86.39}
[20 / 20] Learning rate: 1e-05 weight: 0.01
[20 / 20] Loss: 4.648182297869972 CE Loss: 0.3338868053818168 Con Loss: 4.644843445689926
[20 / 20] tensor([[0.823, 0.762],
        [0.870, 0.905]]) {'epoch': 20, 'valid/acc': 83.966, 'valid/acc_unbiased': 84.33, 'valid/diff': 0.721, 'valid/acc_skew': 84.259, 'valid/acc_align': 84.401, 'test/acc': 83.797, 'test/acc_unbiased': 83.995, 'test/diff': 4.758, 'test/acc_skew': 81.616, 'test/acc_align': 86.374}
[20 / 20] best valid accuracy: 84.381 at epoch 19 
 best_stats: {'best_valid_epoch': 19, 'best_valid_valid/acc': 84.051, 'best_valid_valid/acc_unbiased': 84.381, 'best_valid_valid/diff': 0.866, 'best_valid_valid/acc_skew': 84.406, 'best_valid_valid/acc_align': 84.357, 'best_valid_test/acc': 84.008, 'best_valid_test/acc_unbiased': 84.153, 'best_valid_test/diff': 4.473, 'best_valid_test/acc_skew': 81.916, 'best_valid_test/acc_align': 86.39}
[20 / 20] best test accuracy: 84.153 at epoch 19 
 best_stats: {'best_test_epoch': 19, 'best_test_valid/acc': 84.051, 'best_test_valid/acc_unbiased': 84.381, 'best_test_valid/diff': 0.866, 'best_test_valid/acc_skew': 84.406, 'best_test_valid/acc_align': 84.357, 'best_test_test/acc': 84.008, 'best_test_test/acc_unbiased': 84.153, 'best_test_test/diff': 4.473, 'best_test_test/acc_skew': 81.916, 'best_test_test/acc_align': 86.39}
Total training time: 0:12:41
