Log level set to: INFO
Set seed: 2
=======> Using Fixed Random Seed: 2 <========
save_path: exp_results/bc-bb0-celeba_black-crop_auto3-lr0.001-bs128-cbs64-w0.01-ratio30-aug1-seed2
get_celeba - split:train, aug: False, given_y: True, ratio: 0
use existing black indices from data/celeba/pickles/black
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [60774, 38396]
Target 1: [8027, 15991]
Binary Target 1
---------------------------
Target 0: [60774, 38396]
Target 1: [8027, 15991]
===================================
Normal Label Distribution: 
Target 0: [60774, 38396]
Target 1: [8027, 15991]
===================================
Use BiasedCelebASplit 
 target_attr: black split: train 
 tensor([[60774.,  8027.],
        [38396., 15991.]])
get_celeba - split:train, aug: 1, given_y: True, ratio: 30
use existing black indices from data/celeba/pickles/black
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [60435, 38588]
Target 1: [7963, 16202]
Binary Target 1
---------------------------
Target 0: [60435, 38588]
Target 1: [7963, 16202]
===================================
Normal Label Distribution: 
Target 0: [60435, 38588]
Target 1: [7963, 16202]
===================================
Use BiasedCelebASplit 
 target_attr: black split: train 
 tensor([[60435.,  7963.],
        [38588., 16202.]])
get_celeba - split:train_valid, aug: False, given_y: True, ratio: 0
use existing black indices from data/celeba/pickles/black
Use BiasedCelebASplit 
 target_attr: black split: train_valid 
 tensor([[15020.,  1991.],
        [ 9642.,  4145.]])
get_celeba - split:valid, aug: False, given_y: True, ratio: 0
Use BiasedCelebASplit 
 target_attr: black split: valid 
 tensor([[9752., 1657.],
        [5971., 2487.]])
decay_epochs: [3, 6]
[1 / 10] Learning rate: 0.001 weight: 0.01
[1 / 10] Loss: 4.829366145855646 CE Loss: 0.3536631231190388 Con Loss: 4.82582951065828
[1 / 10] tensor([[0.996, 0.989],
        [0.104, 0.214]]) {'epoch': 1, 'valid/acc': 82.71, 'valid/acc_unbiased': 56.668, 'valid/diff': 4.004, 'valid/acc_skew': 54.666, 'valid/acc_align': 58.67, 'test/acc': 82.176, 'test/acc_unbiased': 57.583, 'test/diff': 5.907, 'test/acc_skew': 54.629, 'test/acc_align': 60.536}
[1 / 10] best valid accuracy: 56.668 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 82.71, 'best_valid_valid/acc_unbiased': 56.668, 'best_valid_valid/diff': 4.004, 'best_valid_valid/acc_skew': 54.666, 'best_valid_valid/acc_align': 58.67, 'best_valid_test/acc': 82.176, 'best_valid_test/acc_unbiased': 57.583, 'best_valid_test/diff': 5.907, 'best_valid_test/acc_skew': 54.629, 'best_valid_test/acc_align': 60.536}
[1 / 10] best test accuracy: 57.583 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 82.71, 'best_test_valid/acc_unbiased': 56.668, 'best_test_valid/diff': 4.004, 'best_test_valid/acc_skew': 54.666, 'best_test_valid/acc_align': 58.67, 'best_test_test/acc': 82.176, 'best_test_test/acc_unbiased': 57.583, 'best_test_test/diff': 5.907, 'best_test_test/acc_skew': 54.629, 'best_test_test/acc_align': 60.536}
[2 / 10] Learning rate: 0.001 weight: 0.01
[2 / 10] Loss: 4.813923802806072 CE Loss: 0.3089358577400182 Con Loss: 4.810834437704521
[2 / 10] tensor([[0.922, 0.911],
        [0.727, 0.655]]) {'epoch': 2, 'valid/acc': 86.58, 'valid/acc_unbiased': 79.121, 'valid/diff': 5.504, 'valid/acc_skew': 81.768, 'valid/acc_align': 76.474, 'test/acc': 86.873, 'test/acc_unbiased': 80.357, 'test/diff': 4.163, 'test/acc_skew': 81.906, 'test/acc_align': 78.808}
[2 / 10] best valid accuracy: 79.121 at epoch 2 
 best_stats: {'best_valid_epoch': 2, 'best_valid_valid/acc': 86.58, 'best_valid_valid/acc_unbiased': 79.121, 'best_valid_valid/diff': 5.504, 'best_valid_valid/acc_skew': 81.768, 'best_valid_valid/acc_align': 76.474, 'best_valid_test/acc': 86.873, 'best_valid_test/acc_unbiased': 80.357, 'best_valid_test/diff': 4.163, 'best_valid_test/acc_skew': 81.906, 'best_valid_test/acc_align': 78.808}
[2 / 10] best test accuracy: 80.357 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 86.58, 'best_test_valid/acc_unbiased': 79.121, 'best_test_valid/diff': 5.504, 'best_test_valid/acc_skew': 81.768, 'best_test_valid/acc_align': 76.474, 'best_test_test/acc': 86.873, 'best_test_test/acc_unbiased': 80.357, 'best_test_test/diff': 4.163, 'best_test_test/acc_skew': 81.906, 'best_test_test/acc_align': 78.808}
[3 / 10] Learning rate: 0.001 weight: 0.01
[3 / 10] Loss: 4.8069976300865305 CE Loss: 0.3023356980103372 Con Loss: 4.803974276994557
[3 / 10] tensor([[0.885, 0.835],
        [0.851, 0.809]]) {'epoch': 3, 'valid/acc': 85.441, 'valid/acc_unbiased': 83.564, 'valid/diff': 4.028, 'valid/acc_skew': 83.674, 'valid/acc_align': 83.454, 'test/acc': 85.775, 'test/acc_unbiased': 84.512, 'test/diff': 4.596, 'test/acc_skew': 84.29, 'test/acc_align': 84.733}
[3 / 10] best valid accuracy: 83.564 at epoch 3 
 best_stats: {'best_valid_epoch': 3, 'best_valid_valid/acc': 85.441, 'best_valid_valid/acc_unbiased': 83.564, 'best_valid_valid/diff': 4.028, 'best_valid_valid/acc_skew': 83.674, 'best_valid_valid/acc_align': 83.454, 'best_valid_test/acc': 85.775, 'best_valid_test/acc_unbiased': 84.512, 'best_valid_test/diff': 4.596, 'best_valid_test/acc_skew': 84.29, 'best_valid_test/acc_align': 84.733}
[3 / 10] best test accuracy: 84.512 at epoch 3 
 best_stats: {'best_test_epoch': 3, 'best_test_valid/acc': 85.441, 'best_test_valid/acc_unbiased': 83.564, 'best_test_valid/diff': 4.028, 'best_test_valid/acc_skew': 83.674, 'best_test_valid/acc_align': 83.454, 'best_test_test/acc': 85.775, 'best_test_test/acc_unbiased': 84.512, 'best_test_test/diff': 4.596, 'best_test_test/acc_skew': 84.29, 'best_test_test/acc_align': 84.733}
[4 / 10] Learning rate: 0.0001 weight: 0.01
[4 / 10] Loss: 4.7837565883117845 CE Loss: 0.27077981020353964 Con Loss: 4.781048784164011
[4 / 10] tensor([[0.975, 0.957],
        [0.573, 0.602]]) {'epoch': 4, 'valid/acc': 88.866, 'valid/acc_unbiased': 76.688, 'valid/diff': 0.909, 'valid/acc_skew': 76.483, 'valid/acc_align': 76.894, 'test/acc': 88.931, 'test/acc_unbiased': 77.668, 'test/diff': 2.334, 'test/acc_skew': 76.501, 'test/acc_align': 78.835}
[4 / 10] best valid accuracy: 83.564 at epoch 3 
 best_stats: {'best_valid_epoch': 3, 'best_valid_valid/acc': 85.441, 'best_valid_valid/acc_unbiased': 83.564, 'best_valid_valid/diff': 4.028, 'best_valid_valid/acc_skew': 83.674, 'best_valid_valid/acc_align': 83.454, 'best_valid_test/acc': 85.775, 'best_valid_test/acc_unbiased': 84.512, 'best_valid_test/diff': 4.596, 'best_valid_test/acc_skew': 84.29, 'best_valid_test/acc_align': 84.733}
[4 / 10] best test accuracy: 84.512 at epoch 3 
 best_stats: {'best_test_epoch': 3, 'best_test_valid/acc': 85.441, 'best_test_valid/acc_unbiased': 83.564, 'best_test_valid/diff': 4.028, 'best_test_valid/acc_skew': 83.674, 'best_test_valid/acc_align': 83.454, 'best_test_test/acc': 85.775, 'best_test_test/acc_unbiased': 84.512, 'best_test_test/diff': 4.596, 'best_test_test/acc_skew': 84.29, 'best_test_test/acc_align': 84.733}
[5 / 10] Learning rate: 0.0001 weight: 0.01
[5 / 10] Loss: 4.77422061613536 CE Loss: 0.2576853481491235 Con Loss: 4.771643759380066
[5 / 10] tensor([[0.946, 0.900],
        [0.730, 0.759]]) {'epoch': 5, 'valid/acc': 89.356, 'valid/acc_unbiased': 83.261, 'valid/diff': 2.235, 'valid/acc_skew': 82.143, 'valid/acc_align': 84.378, 'test/acc': 89.087, 'test/acc_unbiased': 83.386, 'test/diff': 3.78, 'test/acc_skew': 81.496, 'test/acc_align': 85.276}
[5 / 10] best valid accuracy: 83.564 at epoch 3 
 best_stats: {'best_valid_epoch': 3, 'best_valid_valid/acc': 85.441, 'best_valid_valid/acc_unbiased': 83.564, 'best_valid_valid/diff': 4.028, 'best_valid_valid/acc_skew': 83.674, 'best_valid_valid/acc_align': 83.454, 'best_valid_test/acc': 85.775, 'best_valid_test/acc_unbiased': 84.512, 'best_valid_test/diff': 4.596, 'best_valid_test/acc_skew': 84.29, 'best_valid_test/acc_align': 84.733}
[5 / 10] best test accuracy: 84.512 at epoch 3 
 best_stats: {'best_test_epoch': 3, 'best_test_valid/acc': 85.441, 'best_test_valid/acc_unbiased': 83.564, 'best_test_valid/diff': 4.028, 'best_test_valid/acc_skew': 83.674, 'best_test_valid/acc_align': 83.454, 'best_test_test/acc': 85.775, 'best_test_test/acc_unbiased': 84.512, 'best_test_test/diff': 4.596, 'best_test_test/acc_skew': 84.29, 'best_test_test/acc_align': 84.733}
[6 / 10] Learning rate: 0.0001 weight: 0.01
[6 / 10] Loss: 4.770063989668825 CE Loss: 0.24950672907413482 Con Loss: 4.767568922911456
[6 / 10] tensor([[0.958, 0.934],
        [0.696, 0.709]]) {'epoch': 6, 'valid/acc': 89.882, 'valid/acc_unbiased': 82.008, 'valid/diff': 1.995, 'valid/acc_skew': 82.137, 'valid/acc_align': 81.879, 'test/acc': 89.777, 'test/acc_unbiased': 82.437, 'test/diff': 1.861, 'test/acc_skew': 81.506, 'test/acc_align': 83.367}
[6 / 10] best valid accuracy: 83.564 at epoch 3 
 best_stats: {'best_valid_epoch': 3, 'best_valid_valid/acc': 85.441, 'best_valid_valid/acc_unbiased': 83.564, 'best_valid_valid/diff': 4.028, 'best_valid_valid/acc_skew': 83.674, 'best_valid_valid/acc_align': 83.454, 'best_valid_test/acc': 85.775, 'best_valid_test/acc_unbiased': 84.512, 'best_valid_test/diff': 4.596, 'best_valid_test/acc_skew': 84.29, 'best_valid_test/acc_align': 84.733}
[6 / 10] best test accuracy: 84.512 at epoch 3 
 best_stats: {'best_test_epoch': 3, 'best_test_valid/acc': 85.441, 'best_test_valid/acc_unbiased': 83.564, 'best_test_valid/diff': 4.028, 'best_test_valid/acc_skew': 83.674, 'best_test_valid/acc_align': 83.454, 'best_test_test/acc': 85.775, 'best_test_test/acc_unbiased': 84.512, 'best_test_test/diff': 4.596, 'best_test_test/acc_skew': 84.29, 'best_test_test/acc_align': 84.733}
[7 / 10] Learning rate: 1e-05 weight: 0.01
[7 / 10] Loss: 4.765920506269354 CE Loss: 0.2441976584379683 Con Loss: 4.763478527728058
[7 / 10] tensor([[0.958, 0.933],
        [0.700, 0.719]]) {'epoch': 7, 'valid/acc': 90.181, 'valid/acc_unbiased': 82.507, 'valid/diff': 1.657, 'valid/acc_skew': 82.502, 'valid/acc_align': 82.512, 'test/acc': 89.908, 'test/acc_unbiased': 82.747, 'test/diff': 2.154, 'test/acc_skew': 81.67, 'test/acc_align': 83.825}
[7 / 10] best valid accuracy: 83.564 at epoch 3 
 best_stats: {'best_valid_epoch': 3, 'best_valid_valid/acc': 85.441, 'best_valid_valid/acc_unbiased': 83.564, 'best_valid_valid/diff': 4.028, 'best_valid_valid/acc_skew': 83.674, 'best_valid_valid/acc_align': 83.454, 'best_valid_test/acc': 85.775, 'best_valid_test/acc_unbiased': 84.512, 'best_valid_test/diff': 4.596, 'best_valid_test/acc_skew': 84.29, 'best_valid_test/acc_align': 84.733}
[7 / 10] best test accuracy: 84.512 at epoch 3 
 best_stats: {'best_test_epoch': 3, 'best_test_valid/acc': 85.441, 'best_test_valid/acc_unbiased': 83.564, 'best_test_valid/diff': 4.028, 'best_test_valid/acc_skew': 83.674, 'best_test_valid/acc_align': 83.454, 'best_test_test/acc': 85.775, 'best_test_test/acc_unbiased': 84.512, 'best_test_test/diff': 4.596, 'best_test_test/acc_skew': 84.29, 'best_test_test/acc_align': 84.733}
[8 / 10] Learning rate: 1e-05 weight: 0.01
[8 / 10] Loss: 4.763571308654489 CE Loss: 0.24187189255820724 Con Loss: 4.761152584970735
[8 / 10] tensor([[0.960, 0.934],
        [0.699, 0.713]]) {'epoch': 8, 'valid/acc': 90.084, 'valid/acc_unbiased': 82.287, 'valid/diff': 2.324, 'valid/acc_skew': 82.505, 'valid/acc_align': 82.068, 'test/acc': 89.923, 'test/acc_unbiased': 82.619, 'test/diff': 2.002, 'test/acc_skew': 81.618, 'test/acc_align': 83.621}
[8 / 10] best valid accuracy: 83.564 at epoch 3 
 best_stats: {'best_valid_epoch': 3, 'best_valid_valid/acc': 85.441, 'best_valid_valid/acc_unbiased': 83.564, 'best_valid_valid/diff': 4.028, 'best_valid_valid/acc_skew': 83.674, 'best_valid_valid/acc_align': 83.454, 'best_valid_test/acc': 85.775, 'best_valid_test/acc_unbiased': 84.512, 'best_valid_test/diff': 4.596, 'best_valid_test/acc_skew': 84.29, 'best_valid_test/acc_align': 84.733}
[8 / 10] best test accuracy: 84.512 at epoch 3 
 best_stats: {'best_test_epoch': 3, 'best_test_valid/acc': 85.441, 'best_test_valid/acc_unbiased': 83.564, 'best_test_valid/diff': 4.028, 'best_test_valid/acc_skew': 83.674, 'best_test_valid/acc_align': 83.454, 'best_test_test/acc': 85.775, 'best_test_test/acc_unbiased': 84.512, 'best_test_test/diff': 4.596, 'best_test_test/acc_skew': 84.29, 'best_test_test/acc_align': 84.733}
[9 / 10] Learning rate: 1e-05 weight: 0.01
[9 / 10] Loss: 4.758969350066607 CE Loss: 0.23851753014803947 Con Loss: 4.7565841782568
[9 / 10] tensor([[0.965, 0.941],
        [0.681, 0.703]]) {'epoch': 9, 'valid/acc': 90.207, 'valid/acc_unbiased': 81.504, 'valid/diff': 1.145, 'valid/acc_skew': 81.246, 'valid/acc_align': 81.761, 'test/acc': 90.134, 'test/acc_unbiased': 82.26, 'test/diff': 2.247, 'test/acc_skew': 81.137, 'test/acc_align': 83.384}
[9 / 10] best valid accuracy: 83.564 at epoch 3 
 best_stats: {'best_valid_epoch': 3, 'best_valid_valid/acc': 85.441, 'best_valid_valid/acc_unbiased': 83.564, 'best_valid_valid/diff': 4.028, 'best_valid_valid/acc_skew': 83.674, 'best_valid_valid/acc_align': 83.454, 'best_valid_test/acc': 85.775, 'best_valid_test/acc_unbiased': 84.512, 'best_valid_test/diff': 4.596, 'best_valid_test/acc_skew': 84.29, 'best_valid_test/acc_align': 84.733}
[9 / 10] best test accuracy: 84.512 at epoch 3 
 best_stats: {'best_test_epoch': 3, 'best_test_valid/acc': 85.441, 'best_test_valid/acc_unbiased': 83.564, 'best_test_valid/diff': 4.028, 'best_test_valid/acc_skew': 83.674, 'best_test_valid/acc_align': 83.454, 'best_test_test/acc': 85.775, 'best_test_test/acc_unbiased': 84.512, 'best_test_test/diff': 4.596, 'best_test_test/acc_skew': 84.29, 'best_test_test/acc_align': 84.733}
[10 / 10] Learning rate: 1e-05 weight: 0.01
[10 / 10] Loss: 4.763349041256126 CE Loss: 0.23795949158511517 Con Loss: 4.760969446522696
[10 / 10] tensor([[0.960, 0.930],
        [0.697, 0.733]]) {'epoch': 10, 'valid/acc': 90.295, 'valid/acc_unbiased': 82.77, 'valid/diff': 1.154, 'valid/acc_skew': 82.193, 'valid/acc_align': 83.347, 'test/acc': 90.089, 'test/acc_unbiased': 83.018, 'test/diff': 3.298, 'test/acc_skew': 81.369, 'test/acc_align': 84.666}
[10 / 10] best valid accuracy: 83.564 at epoch 3 
 best_stats: {'best_valid_epoch': 3, 'best_valid_valid/acc': 85.441, 'best_valid_valid/acc_unbiased': 83.564, 'best_valid_valid/diff': 4.028, 'best_valid_valid/acc_skew': 83.674, 'best_valid_valid/acc_align': 83.454, 'best_valid_test/acc': 85.775, 'best_valid_test/acc_unbiased': 84.512, 'best_valid_test/diff': 4.596, 'best_valid_test/acc_skew': 84.29, 'best_valid_test/acc_align': 84.733}
[10 / 10] best test accuracy: 84.512 at epoch 3 
 best_stats: {'best_test_epoch': 3, 'best_test_valid/acc': 85.441, 'best_test_valid/acc_unbiased': 83.564, 'best_test_valid/diff': 4.028, 'best_test_valid/acc_skew': 83.674, 'best_test_valid/acc_align': 83.454, 'best_test_test/acc': 85.775, 'best_test_test/acc_unbiased': 84.512, 'best_test_test/diff': 4.596, 'best_test_test/acc_skew': 84.29, 'best_test_test/acc_align': 84.733}
Total training time: 2:10:14
