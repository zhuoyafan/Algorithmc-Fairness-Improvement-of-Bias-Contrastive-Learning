Log level set to: INFO
Set seed: 2
=======> Using Fixed Random Seed: 2 <========
save_path: exp_results/bc-bb0-utk_face_age-test-0.95-lr0.001-bs128-cbs64-w0.01-ratio10-aug1-seed2
get_utk_face - split: train, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_age-0.95
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [8237, 73]
Target 1: [411, 1477]
Binary Target 1
---------------------------
Target 0: [8237, 73]
Target 1: [411, 1477]
===================================
Normal Label Distribution: 
Target 0: [8237, 73]
Target 1: [411, 1477]
===================================
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [8237, 73]
Target 1: [411, 1477]
Binary Target 1
---------------------------
Target 0: [8237, 73]
Target 1: [411, 1477]
===================================
Normal Label Distribution: 
Target 0: [8237, 73]
Target 1: [411, 1477]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 10198, target_attr: gender, bias_attr: age bias_rate: 0.95
['[train] target_0-bias_0: 8237', '[train] target_0-bias_1: 73', '[train] target_1-bias_0: 411', '[train] target_1-bias_1: 1477']
confusion_matrix - 
 original: tensor([[8237.,  411.],
        [  73., 1477.]]), 
 normalized: tensor([[0.952, 0.048],
        [0.047, 0.953]]), 
 b|y: tensor([[0.991, 0.009],
        [0.218, 0.782]])
get_utk_face - split: train, aug: 1, given_y: True, ratio: 10
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_age-0.95
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [8237, 73]
Target 1: [411, 1477]
Binary Target 1
---------------------------
Target 0: [8237, 73]
Target 1: [411, 1477]
===================================
Normal Label Distribution: 
Target 0: [8237, 73]
Target 1: [411, 1477]
===================================
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [8237, 73]
Target 1: [411, 1477]
Binary Target 1
---------------------------
Target 0: [8237, 73]
Target 1: [411, 1477]
===================================
Normal Label Distribution: 
Target 0: [8237, 73]
Target 1: [411, 1477]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 10198, target_attr: gender, bias_attr: age bias_rate: 0.95
['[train] target_0-bias_0: 8237', '[train] target_0-bias_1: 73', '[train] target_1-bias_0: 411', '[train] target_1-bias_1: 1477']
get_utk_face - split: valid, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_age-0.95
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [1030, 195]
Target 1: [841, 202]
Binary Target 1
---------------------------
Target 0: [1030, 195]
Target 1: [841, 202]
===================================
Normal Label Distribution: 
Target 0: [1030, 195]
Target 1: [841, 202]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 2268, target_attr: gender, bias_attr: age bias_rate: 0.95
['[valid] target_0-bias_0: 1030', '[valid] target_0-bias_1: 195', '[valid] target_1-bias_0: 841', '[valid] target_1-bias_1: 202']
get_utk_face - split: test, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_age-0.95
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [1061, 176]
Target 1: [867, 165]
Binary Target 1
---------------------------
Target 0: [1061, 176]
Target 1: [867, 165]
===================================
Normal Label Distribution: 
Target 0: [1061, 176]
Target 1: [867, 165]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 2269, target_attr: gender, bias_attr: age bias_rate: 0.95
['[test] target_0-bias_0: 1061', '[test] target_0-bias_1: 176', '[test] target_1-bias_0: 867', '[test] target_1-bias_1: 165']
decay_epochs: [6, 13]
[1 / 20] Learning rate: 0.001 weight: 0.01
[1 / 20] Loss: 4.658532321534921 CE Loss: 0.5487580990926919 Con Loss: 4.653044731108715
[1 / 20] tensor([[1., 1.],
        [0., 0.]]) {'epoch': 1, 'valid/acc': 54.012, 'valid/acc_unbiased': 50.0, 'valid/diff': 0.0, 'valid/acc_skew': 50.0, 'valid/acc_align': 50.0, 'test/acc': 54.517, 'test/acc_unbiased': 50.0, 'test/diff': 0.0, 'test/acc_skew': 50.0, 'test/acc_align': 50.0}
[1 / 20] best valid accuracy: 50.000 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 54.012, 'best_valid_valid/acc_unbiased': 50.0, 'best_valid_valid/diff': 0.0, 'best_valid_valid/acc_skew': 50.0, 'best_valid_valid/acc_align': 50.0, 'best_valid_test/acc': 54.517, 'best_valid_test/acc_unbiased': 50.0, 'best_valid_test/diff': 0.0, 'best_valid_test/acc_skew': 50.0, 'best_valid_test/acc_align': 50.0}
[1 / 20] best test accuracy: 50.000 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 54.012, 'best_test_valid/acc_unbiased': 50.0, 'best_test_valid/diff': 0.0, 'best_test_valid/acc_skew': 50.0, 'best_test_valid/acc_align': 50.0, 'best_test_test/acc': 54.517, 'best_test_test/acc_unbiased': 50.0, 'best_test_test/diff': 0.0, 'best_test_test/acc_skew': 50.0, 'best_test_test/acc_align': 50.0}
[2 / 20] Learning rate: 0.001 weight: 0.01
[2 / 20] Loss: 4.422358506051763 CE Loss: 0.5172052380383587 Con Loss: 4.417186456513091
[2 / 20] tensor([[0.971, 0.960],
        [0.291, 0.145]]) {'epoch': 2, 'valid/acc': 64.374, 'valid/acc_unbiased': 59.099, 'valid/diff': 7.945, 'valid/acc_skew': 62.574, 'valid/acc_align': 55.625, 'test/acc': 65.007, 'test/acc_unbiased': 59.178, 'test/diff': 7.788, 'test/acc_skew': 62.544, 'test/acc_align': 55.812}
[2 / 20] best valid accuracy: 59.099 at epoch 2 
 best_stats: {'best_valid_epoch': 2, 'best_valid_valid/acc': 64.374, 'best_valid_valid/acc_unbiased': 59.099, 'best_valid_valid/diff': 7.945, 'best_valid_valid/acc_skew': 62.574, 'best_valid_valid/acc_align': 55.625, 'best_valid_test/acc': 65.007, 'best_valid_test/acc_unbiased': 59.178, 'best_valid_test/diff': 7.788, 'best_valid_test/acc_skew': 62.544, 'best_valid_test/acc_align': 55.812}
[2 / 20] best test accuracy: 59.178 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 64.374, 'best_test_valid/acc_unbiased': 59.099, 'best_test_valid/diff': 7.945, 'best_test_valid/acc_skew': 62.574, 'best_test_valid/acc_align': 55.625, 'best_test_test/acc': 65.007, 'best_test_test/acc_unbiased': 59.178, 'best_test_test/diff': 7.788, 'best_test_test/acc_skew': 62.544, 'best_test_test/acc_align': 55.812}
[3 / 20] Learning rate: 0.001 weight: 0.01
[3 / 20] Loss: 4.378435466307756 CE Loss: 0.5093930991438469 Con Loss: 4.3733415371718465
[3 / 20] tensor([[1.000, 1.000],
        [0.001, 0.000]]) {'epoch': 3, 'valid/acc': 54.101, 'valid/acc_unbiased': 50.059, 'valid/diff': 0.119, 'valid/acc_skew': 50.119, 'valid/acc_align': 50.0, 'test/acc': 54.561, 'test/acc_unbiased': 50.029, 'test/diff': 0.058, 'test/acc_skew': 50.058, 'test/acc_align': 50.0}
[3 / 20] best valid accuracy: 59.099 at epoch 2 
 best_stats: {'best_valid_epoch': 2, 'best_valid_valid/acc': 64.374, 'best_valid_valid/acc_unbiased': 59.099, 'best_valid_valid/diff': 7.945, 'best_valid_valid/acc_skew': 62.574, 'best_valid_valid/acc_align': 55.625, 'best_valid_test/acc': 65.007, 'best_valid_test/acc_unbiased': 59.178, 'best_valid_test/diff': 7.788, 'best_valid_test/acc_skew': 62.544, 'best_valid_test/acc_align': 55.812}
[3 / 20] best test accuracy: 59.178 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 64.374, 'best_test_valid/acc_unbiased': 59.099, 'best_test_valid/diff': 7.945, 'best_test_valid/acc_skew': 62.574, 'best_test_valid/acc_align': 55.625, 'best_test_test/acc': 65.007, 'best_test_test/acc_unbiased': 59.178, 'best_test_test/diff': 7.788, 'best_test_test/acc_skew': 62.544, 'best_test_test/acc_align': 55.812}
[4 / 20] Learning rate: 0.001 weight: 0.01
[4 / 20] Loss: 4.341667249451013 CE Loss: 0.5088578546764945 Con Loss: 4.336578687094407
[4 / 20] tensor([[0.986, 0.966],
        [0.269, 0.164]]) {'epoch': 4, 'valid/acc': 63.845, 'valid/acc_unbiased': 58.25, 'valid/diff': 8.279, 'valid/acc_skew': 60.2, 'valid/acc_align': 56.3, 'test/acc': 65.051, 'test/acc_unbiased': 59.604, 'test/diff': 6.253, 'test/acc_skew': 61.733, 'test/acc_align': 57.475}
[4 / 20] best valid accuracy: 59.099 at epoch 2 
 best_stats: {'best_valid_epoch': 2, 'best_valid_valid/acc': 64.374, 'best_valid_valid/acc_unbiased': 59.099, 'best_valid_valid/diff': 7.945, 'best_valid_valid/acc_skew': 62.574, 'best_valid_valid/acc_align': 55.625, 'best_valid_test/acc': 65.007, 'best_valid_test/acc_unbiased': 59.178, 'best_valid_test/diff': 7.788, 'best_valid_test/acc_skew': 62.544, 'best_valid_test/acc_align': 55.812}
[4 / 20] best test accuracy: 59.604 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 63.845, 'best_test_valid/acc_unbiased': 58.25, 'best_test_valid/diff': 8.279, 'best_test_valid/acc_skew': 60.2, 'best_test_valid/acc_align': 56.3, 'best_test_test/acc': 65.051, 'best_test_test/acc_unbiased': 59.604, 'best_test_test/diff': 6.253, 'best_test_test/acc_skew': 61.733, 'best_test_test/acc_align': 57.475}
[5 / 20] Learning rate: 0.001 weight: 0.01
[5 / 20] Loss: 4.3610107729916106 CE Loss: 0.5014644487742513 Con Loss: 4.355996127595245
[5 / 20] tensor([[0.971, 0.955],
        [0.337, 0.188]]) {'epoch': 5, 'valid/acc': 66.446, 'valid/acc_unbiased': 60.891, 'valid/diff': 9.248, 'valid/acc_skew': 61.953, 'valid/acc_align': 59.828, 'test/acc': 67.034, 'test/acc_unbiased': 61.25, 'test/diff': 8.258, 'test/acc_skew': 64.567, 'test/acc_align': 57.933}
[5 / 20] best valid accuracy: 60.891 at epoch 5 
 best_stats: {'best_valid_epoch': 5, 'best_valid_valid/acc': 66.446, 'best_valid_valid/acc_unbiased': 60.891, 'best_valid_valid/diff': 9.248, 'best_valid_valid/acc_skew': 61.953, 'best_valid_valid/acc_align': 59.828, 'best_valid_test/acc': 67.034, 'best_valid_test/acc_unbiased': 61.25, 'best_valid_test/diff': 8.258, 'best_valid_test/acc_skew': 64.567, 'best_valid_test/acc_align': 57.933}
[5 / 20] best test accuracy: 61.250 at epoch 5 
 best_stats: {'best_test_epoch': 5, 'best_test_valid/acc': 66.446, 'best_test_valid/acc_unbiased': 60.891, 'best_test_valid/diff': 9.248, 'best_test_valid/acc_skew': 61.953, 'best_test_valid/acc_align': 59.828, 'best_test_test/acc': 67.034, 'best_test_test/acc_unbiased': 61.25, 'best_test_test/diff': 8.258, 'best_test_test/acc_skew': 64.567, 'best_test_test/acc_align': 57.933}
[6 / 20] Learning rate: 0.001 weight: 0.01
[6 / 20] Loss: 4.322481520855327 CE Loss: 0.4707672127931112 Con Loss: 4.317773849829947
[6 / 20] tensor([[0.911, 0.943],
        [0.501, 0.170]]) {'epoch': 6, 'valid/acc': 71.208, 'valid/acc_unbiased': 64.643, 'valid/diff': 17.436, 'valid/acc_skew': 73.361, 'valid/acc_align': 55.925, 'test/acc': 70.295, 'test/acc_unbiased': 63.121, 'test/diff': 18.133, 'test/acc_skew': 72.188, 'test/acc_align': 54.055}
[6 / 20] best valid accuracy: 64.643 at epoch 6 
 best_stats: {'best_valid_epoch': 6, 'best_valid_valid/acc': 71.208, 'best_valid_valid/acc_unbiased': 64.643, 'best_valid_valid/diff': 17.436, 'best_valid_valid/acc_skew': 73.361, 'best_valid_valid/acc_align': 55.925, 'best_valid_test/acc': 70.295, 'best_valid_test/acc_unbiased': 63.121, 'best_valid_test/diff': 18.133, 'best_valid_test/acc_skew': 72.188, 'best_valid_test/acc_align': 54.055}
[6 / 20] best test accuracy: 63.121 at epoch 6 
 best_stats: {'best_test_epoch': 6, 'best_test_valid/acc': 71.208, 'best_test_valid/acc_unbiased': 64.643, 'best_test_valid/diff': 17.436, 'best_test_valid/acc_skew': 73.361, 'best_test_valid/acc_align': 55.925, 'best_test_test/acc': 70.295, 'best_test_test/acc_unbiased': 63.121, 'best_test_test/diff': 18.133, 'best_test_test/acc_skew': 72.188, 'best_test_test/acc_align': 54.055}
[7 / 20] Learning rate: 0.0001 weight: 0.01
[7 / 20] Loss: 4.2605977234220385 CE Loss: 0.4654226157332804 Con Loss: 4.255943502204328
[7 / 20] tensor([[0.974, 0.886],
        [0.526, 0.267]]) {'epoch': 7, 'valid/acc': 72.928, 'valid/acc_unbiased': 66.74, 'valid/diff': 13.061, 'valid/acc_skew': 69.051, 'valid/acc_align': 64.429, 'test/acc': 74.438, 'test/acc_unbiased': 66.315, 'test/diff': 17.327, 'test/acc_skew': 70.616, 'test/acc_align': 62.014}
[7 / 20] best valid accuracy: 66.740 at epoch 7 
 best_stats: {'best_valid_epoch': 7, 'best_valid_valid/acc': 72.928, 'best_valid_valid/acc_unbiased': 66.74, 'best_valid_valid/diff': 13.061, 'best_valid_valid/acc_skew': 69.051, 'best_valid_valid/acc_align': 64.429, 'best_valid_test/acc': 74.438, 'best_valid_test/acc_unbiased': 66.315, 'best_valid_test/diff': 17.327, 'best_valid_test/acc_skew': 70.616, 'best_valid_test/acc_align': 62.014}
[7 / 20] best test accuracy: 66.315 at epoch 7 
 best_stats: {'best_test_epoch': 7, 'best_test_valid/acc': 72.928, 'best_test_valid/acc_unbiased': 66.74, 'best_test_valid/diff': 13.061, 'best_test_valid/acc_skew': 69.051, 'best_test_valid/acc_align': 64.429, 'best_test_test/acc': 74.438, 'best_test_test/acc_unbiased': 66.315, 'best_test_test/diff': 17.327, 'best_test_test/acc_skew': 70.616, 'best_test_test/acc_align': 62.014}
[8 / 20] Learning rate: 0.0001 weight: 0.01
[8 / 20] Loss: 4.112167334738936 CE Loss: 0.444291932807527 Con Loss: 4.1077244229867516
[8 / 20] tensor([[0.967, 0.784],
        [0.606, 0.388]]) {'epoch': 8, 'valid/acc': 75.176, 'valid/acc_unbiased': 69.074, 'valid/diff': 13.648, 'valid/acc_skew': 66.876, 'valid/acc_align': 71.272, 'test/acc': 77.259, 'test/acc_unbiased': 68.613, 'test/diff': 20.029, 'test/acc_skew': 69.481, 'test/acc_align': 67.745}
[8 / 20] best valid accuracy: 69.074 at epoch 8 
 best_stats: {'best_valid_epoch': 8, 'best_valid_valid/acc': 75.176, 'best_valid_valid/acc_unbiased': 69.074, 'best_valid_valid/diff': 13.648, 'best_valid_valid/acc_skew': 66.876, 'best_valid_valid/acc_align': 71.272, 'best_valid_test/acc': 77.259, 'best_valid_test/acc_unbiased': 68.613, 'best_valid_test/diff': 20.029, 'best_valid_test/acc_skew': 69.481, 'best_valid_test/acc_align': 67.745}
[8 / 20] best test accuracy: 68.613 at epoch 8 
 best_stats: {'best_test_epoch': 8, 'best_test_valid/acc': 75.176, 'best_test_valid/acc_unbiased': 69.074, 'best_test_valid/diff': 13.648, 'best_test_valid/acc_skew': 66.876, 'best_test_valid/acc_align': 71.272, 'best_test_test/acc': 77.259, 'best_test_test/acc_unbiased': 68.613, 'best_test_test/diff': 20.029, 'best_test_test/acc_skew': 69.481, 'best_test_test/acc_align': 67.745}
[9 / 20] Learning rate: 0.0001 weight: 0.01
[9 / 20] Loss: 4.052339413185217 CE Loss: 0.43164399821493155 Con Loss: 4.048022977743319
[9 / 20] tensor([[0.970, 0.733],
        [0.640, 0.491]]) {'epoch': 9, 'valid/acc': 77.116, 'valid/acc_unbiased': 71.16, 'valid/diff': 13.682, 'valid/acc_skew': 64.461, 'valid/acc_align': 77.858, 'test/acc': 79.066, 'test/acc_unbiased': 70.846, 'test/diff': 19.306, 'test/acc_skew': 68.655, 'test/acc_align': 73.037}
[9 / 20] best valid accuracy: 71.160 at epoch 9 
 best_stats: {'best_valid_epoch': 9, 'best_valid_valid/acc': 77.116, 'best_valid_valid/acc_unbiased': 71.16, 'best_valid_valid/diff': 13.682, 'best_valid_valid/acc_skew': 64.461, 'best_valid_valid/acc_align': 77.858, 'best_valid_test/acc': 79.066, 'best_valid_test/acc_unbiased': 70.846, 'best_valid_test/diff': 19.306, 'best_valid_test/acc_skew': 68.655, 'best_valid_test/acc_align': 73.037}
[9 / 20] best test accuracy: 70.846 at epoch 9 
 best_stats: {'best_test_epoch': 9, 'best_test_valid/acc': 77.116, 'best_test_valid/acc_unbiased': 71.16, 'best_test_valid/diff': 13.682, 'best_test_valid/acc_skew': 64.461, 'best_test_valid/acc_align': 77.858, 'best_test_test/acc': 79.066, 'best_test_test/acc_unbiased': 70.846, 'best_test_test/diff': 19.306, 'best_test_test/acc_skew': 68.655, 'best_test_test/acc_align': 73.037}
[10 / 20] Learning rate: 0.0001 weight: 0.01
[10 / 20] Loss: 4.085841885406051 CE Loss: 0.4146884727195142 Con Loss: 4.081695001717758
[10 / 20] tensor([[0.985, 0.869],
        [0.532, 0.309]]) {'epoch': 10, 'valid/acc': 74.383, 'valid/acc_unbiased': 69.353, 'valid/diff': 9.465, 'valid/acc_skew': 68.244, 'valid/acc_align': 70.462, 'test/acc': 75.364, 'test/acc_unbiased': 67.376, 'test/diff': 16.911, 'test/acc_skew': 70.052, 'test/acc_align': 64.701}
[10 / 20] best valid accuracy: 71.160 at epoch 9 
 best_stats: {'best_valid_epoch': 9, 'best_valid_valid/acc': 77.116, 'best_valid_valid/acc_unbiased': 71.16, 'best_valid_valid/diff': 13.682, 'best_valid_valid/acc_skew': 64.461, 'best_valid_valid/acc_align': 77.858, 'best_valid_test/acc': 79.066, 'best_valid_test/acc_unbiased': 70.846, 'best_valid_test/diff': 19.306, 'best_valid_test/acc_skew': 68.655, 'best_valid_test/acc_align': 73.037}
[10 / 20] best test accuracy: 70.846 at epoch 9 
 best_stats: {'best_test_epoch': 9, 'best_test_valid/acc': 77.116, 'best_test_valid/acc_unbiased': 71.16, 'best_test_valid/diff': 13.682, 'best_test_valid/acc_skew': 64.461, 'best_test_valid/acc_align': 77.858, 'best_test_test/acc': 79.066, 'best_test_test/acc_unbiased': 70.846, 'best_test_test/diff': 19.306, 'best_test_test/acc_skew': 68.655, 'best_test_test/acc_align': 73.037}
[11 / 20] Learning rate: 0.0001 weight: 0.01
[11 / 20] Loss: 3.9572920080118728 CE Loss: 0.4115097656755453 Con Loss: 3.9531769240035755
[11 / 20] tensor([[0.981, 0.784],
        [0.562, 0.436]]) {'epoch': 11, 'valid/acc': 75.75, 'valid/acc_unbiased': 70.661, 'valid/diff': 11.88, 'valid/acc_skew': 64.721, 'valid/acc_align': 76.601, 'test/acc': 76.598, 'test/acc_unbiased': 69.083, 'test/diff': 16.12, 'test/acc_skew': 67.29, 'test/acc_align': 70.876}
[11 / 20] best valid accuracy: 71.160 at epoch 9 
 best_stats: {'best_valid_epoch': 9, 'best_valid_valid/acc': 77.116, 'best_valid_valid/acc_unbiased': 71.16, 'best_valid_valid/diff': 13.682, 'best_valid_valid/acc_skew': 64.461, 'best_valid_valid/acc_align': 77.858, 'best_valid_test/acc': 79.066, 'best_valid_test/acc_unbiased': 70.846, 'best_valid_test/diff': 19.306, 'best_valid_test/acc_skew': 68.655, 'best_valid_test/acc_align': 73.037}
[11 / 20] best test accuracy: 70.846 at epoch 9 
 best_stats: {'best_test_epoch': 9, 'best_test_valid/acc': 77.116, 'best_test_valid/acc_unbiased': 71.16, 'best_test_valid/diff': 13.682, 'best_test_valid/acc_skew': 64.461, 'best_test_valid/acc_align': 77.858, 'best_test_test/acc': 79.066, 'best_test_test/acc_unbiased': 70.846, 'best_test_test/diff': 19.306, 'best_test_test/acc_skew': 68.655, 'best_test_test/acc_align': 73.037}
[12 / 20] Learning rate: 0.0001 weight: 0.01
[12 / 20] Loss: 3.8776552086602147 CE Loss: 0.38934706025531324 Con Loss: 3.873761739747668
[12 / 20] tensor([[0.975, 0.778],
        [0.616, 0.527]]) {'epoch': 12, 'valid/acc': 77.646, 'valid/acc_unbiased': 72.277, 'valid/diff': 15.483, 'valid/acc_skew': 64.535, 'valid/acc_align': 80.018, 'test/acc': 79.022, 'test/acc_unbiased': 72.427, 'test/diff': 14.287, 'test/acc_skew': 69.716, 'test/acc_align': 75.138}
[12 / 20] best valid accuracy: 72.277 at epoch 12 
 best_stats: {'best_valid_epoch': 12, 'best_valid_valid/acc': 77.646, 'best_valid_valid/acc_unbiased': 72.277, 'best_valid_valid/diff': 15.483, 'best_valid_valid/acc_skew': 64.535, 'best_valid_valid/acc_align': 80.018, 'best_valid_test/acc': 79.022, 'best_valid_test/acc_unbiased': 72.427, 'best_valid_test/diff': 14.287, 'best_valid_test/acc_skew': 69.716, 'best_valid_test/acc_align': 75.138}
[12 / 20] best test accuracy: 72.427 at epoch 12 
 best_stats: {'best_test_epoch': 12, 'best_test_valid/acc': 77.646, 'best_test_valid/acc_unbiased': 72.277, 'best_test_valid/diff': 15.483, 'best_test_valid/acc_skew': 64.535, 'best_test_valid/acc_align': 80.018, 'best_test_test/acc': 79.022, 'best_test_test/acc_unbiased': 72.427, 'best_test_test/diff': 14.287, 'best_test_test/acc_skew': 69.716, 'best_test_test/acc_align': 75.138}
[13 / 20] Learning rate: 0.0001 weight: 0.01
[13 / 20] Loss: 3.879361976242739 CE Loss: 0.363723898961465 Con Loss: 3.8757247582536793
[13 / 20] tensor([[0.976, 0.670],
        [0.646, 0.612]]) {'epoch': 13, 'valid/acc': 77.778, 'valid/acc_unbiased': 70.967, 'valid/diff': 21.374, 'valid/acc_skew': 60.28, 'valid/acc_align': 81.654, 'test/acc': 79.991, 'test/acc_unbiased': 72.623, 'test/diff': 16.988, 'test/acc_skew': 65.818, 'test/acc_align': 79.428}
[13 / 20] best valid accuracy: 72.277 at epoch 12 
 best_stats: {'best_valid_epoch': 12, 'best_valid_valid/acc': 77.646, 'best_valid_valid/acc_unbiased': 72.277, 'best_valid_valid/diff': 15.483, 'best_valid_valid/acc_skew': 64.535, 'best_valid_valid/acc_align': 80.018, 'best_valid_test/acc': 79.022, 'best_valid_test/acc_unbiased': 72.427, 'best_valid_test/diff': 14.287, 'best_valid_test/acc_skew': 69.716, 'best_valid_test/acc_align': 75.138}
[13 / 20] best test accuracy: 72.623 at epoch 13 
 best_stats: {'best_test_epoch': 13, 'best_test_valid/acc': 77.778, 'best_test_valid/acc_unbiased': 70.967, 'best_test_valid/diff': 21.374, 'best_test_valid/acc_skew': 60.28, 'best_test_valid/acc_align': 81.654, 'best_test_test/acc': 79.991, 'best_test_test/acc_unbiased': 72.623, 'best_test_test/diff': 16.988, 'best_test_test/acc_skew': 65.818, 'best_test_test/acc_align': 79.428}
[14 / 20] Learning rate: 1e-05 weight: 0.01
[14 / 20] Loss: 3.849174994818251 CE Loss: 0.3580329533849751 Con Loss: 3.845594661426114
[14 / 20] tensor([[0.981, 0.722],
        [0.619, 0.558]]) {'epoch': 14, 'valid/acc': 77.601, 'valid/acc_unbiased': 71.427, 'valid/diff': 20.25, 'valid/acc_skew': 61.302, 'valid/acc_align': 81.552, 'test/acc': 79.198, 'test/acc_unbiased': 71.992, 'test/diff': 16.068, 'test/acc_skew': 67.048, 'test/acc_align': 76.936}
[14 / 20] best valid accuracy: 72.277 at epoch 12 
 best_stats: {'best_valid_epoch': 12, 'best_valid_valid/acc': 77.646, 'best_valid_valid/acc_unbiased': 72.277, 'best_valid_valid/diff': 15.483, 'best_valid_valid/acc_skew': 64.535, 'best_valid_valid/acc_align': 80.018, 'best_valid_test/acc': 79.022, 'best_valid_test/acc_unbiased': 72.427, 'best_valid_test/diff': 14.287, 'best_valid_test/acc_skew': 69.716, 'best_valid_test/acc_align': 75.138}
[14 / 20] best test accuracy: 72.623 at epoch 13 
 best_stats: {'best_test_epoch': 13, 'best_test_valid/acc': 77.778, 'best_test_valid/acc_unbiased': 70.967, 'best_test_valid/diff': 21.374, 'best_test_valid/acc_skew': 60.28, 'best_test_valid/acc_align': 81.654, 'best_test_test/acc': 79.991, 'best_test_test/acc_unbiased': 72.623, 'best_test_test/diff': 16.988, 'best_test_test/acc_skew': 65.818, 'best_test_test/acc_align': 79.428}
[15 / 20] Learning rate: 1e-05 weight: 0.01
[15 / 20] Loss: 3.8385481730609063 CE Loss: 0.36240293102232607 Con Loss: 3.834924126961905
[15 / 20] tensor([[0.973, 0.710],
        [0.662, 0.618]]) {'epoch': 15, 'valid/acc': 78.66, 'valid/acc_unbiased': 72.241, 'valid/diff': 21.506, 'valid/acc_skew': 61.488, 'valid/acc_align': 82.993, 'test/acc': 80.784, 'test/acc_unbiased': 74.078, 'test/diff': 15.316, 'test/acc_skew': 68.614, 'test/acc_align': 79.542}
[15 / 20] best valid accuracy: 72.277 at epoch 12 
 best_stats: {'best_valid_epoch': 12, 'best_valid_valid/acc': 77.646, 'best_valid_valid/acc_unbiased': 72.277, 'best_valid_valid/diff': 15.483, 'best_valid_valid/acc_skew': 64.535, 'best_valid_valid/acc_align': 80.018, 'best_valid_test/acc': 79.022, 'best_valid_test/acc_unbiased': 72.427, 'best_valid_test/diff': 14.287, 'best_valid_test/acc_skew': 69.716, 'best_valid_test/acc_align': 75.138}
[15 / 20] best test accuracy: 74.078 at epoch 15 
 best_stats: {'best_test_epoch': 15, 'best_test_valid/acc': 78.66, 'best_test_valid/acc_unbiased': 72.241, 'best_test_valid/diff': 21.506, 'best_test_valid/acc_skew': 61.488, 'best_test_valid/acc_align': 82.993, 'best_test_test/acc': 80.784, 'best_test_test/acc_unbiased': 74.078, 'best_test_test/diff': 15.316, 'best_test_test/acc_skew': 68.614, 'best_test_test/acc_align': 79.542}
[16 / 20] Learning rate: 1e-05 weight: 0.01
[16 / 20] Loss: 3.827091286897332 CE Loss: 0.37200299143253485 Con Loss: 3.823371252234624
[16 / 20] tensor([[0.975, 0.710],
        [0.649, 0.576]]) {'epoch': 16, 'valid/acc': 78.395, 'valid/acc_unbiased': 71.878, 'valid/diff': 20.348, 'valid/acc_skew': 61.703, 'valid/acc_align': 82.052, 'test/acc': 80.079, 'test/acc_unbiased': 72.748, 'test/diff': 16.897, 'test/acc_skew': 67.98, 'test/acc_align': 77.515}
[16 / 20] best valid accuracy: 72.277 at epoch 12 
 best_stats: {'best_valid_epoch': 12, 'best_valid_valid/acc': 77.646, 'best_valid_valid/acc_unbiased': 72.277, 'best_valid_valid/diff': 15.483, 'best_valid_valid/acc_skew': 64.535, 'best_valid_valid/acc_align': 80.018, 'best_valid_test/acc': 79.022, 'best_valid_test/acc_unbiased': 72.427, 'best_valid_test/diff': 14.287, 'best_valid_test/acc_skew': 69.716, 'best_valid_test/acc_align': 75.138}
[16 / 20] best test accuracy: 74.078 at epoch 15 
 best_stats: {'best_test_epoch': 15, 'best_test_valid/acc': 78.66, 'best_test_valid/acc_unbiased': 72.241, 'best_test_valid/diff': 21.506, 'best_test_valid/acc_skew': 61.488, 'best_test_valid/acc_align': 82.993, 'best_test_test/acc': 80.784, 'best_test_test/acc_unbiased': 74.078, 'best_test_test/diff': 15.316, 'best_test_test/acc_skew': 68.614, 'best_test_test/acc_align': 79.542}
[17 / 20] Learning rate: 1e-05 weight: 0.01
[17 / 20] Loss: 3.8711410644218534 CE Loss: 0.3720034647277814 Con Loss: 3.867421023213038
[17 / 20] tensor([[0.971, 0.642],
        [0.653, 0.630]]) {'epoch': 17, 'valid/acc': 78.263, 'valid/acc_unbiased': 71.759, 'valid/diff': 24.846, 'valid/acc_skew': 59.336, 'valid/acc_align': 84.182, 'test/acc': 79.903, 'test/acc_unbiased': 72.399, 'test/diff': 17.563, 'test/acc_skew': 64.744, 'test/acc_align': 80.054}
[17 / 20] best valid accuracy: 72.277 at epoch 12 
 best_stats: {'best_valid_epoch': 12, 'best_valid_valid/acc': 77.646, 'best_valid_valid/acc_unbiased': 72.277, 'best_valid_valid/diff': 15.483, 'best_valid_valid/acc_skew': 64.535, 'best_valid_valid/acc_align': 80.018, 'best_valid_test/acc': 79.022, 'best_valid_test/acc_unbiased': 72.427, 'best_valid_test/diff': 14.287, 'best_valid_test/acc_skew': 69.716, 'best_valid_test/acc_align': 75.138}
[17 / 20] best test accuracy: 74.078 at epoch 15 
 best_stats: {'best_test_epoch': 15, 'best_test_valid/acc': 78.66, 'best_test_valid/acc_unbiased': 72.241, 'best_test_valid/diff': 21.506, 'best_test_valid/acc_skew': 61.488, 'best_test_valid/acc_align': 82.993, 'best_test_test/acc': 80.784, 'best_test_test/acc_unbiased': 74.078, 'best_test_test/diff': 15.316, 'best_test_test/acc_skew': 68.614, 'best_test_test/acc_align': 79.542}
[18 / 20] Learning rate: 1e-05 weight: 0.01
[18 / 20] Loss: 3.8503051164174082 CE Loss: 0.3597294542573905 Con Loss: 3.8467078058362874
[18 / 20] tensor([[0.974, 0.688],
        [0.646, 0.588]]) {'epoch': 18, 'valid/acc': 78.483, 'valid/acc_unbiased': 72.401, 'valid/diff': 21.476, 'valid/acc_skew': 61.663, 'valid/acc_align': 83.139, 'test/acc': 79.815, 'test/acc_unbiased': 72.372, 'test/diff': 17.207, 'test/acc_skew': 66.67, 'test/acc_align': 78.074}
[18 / 20] best valid accuracy: 72.401 at epoch 18 
 best_stats: {'best_valid_epoch': 18, 'best_valid_valid/acc': 78.483, 'best_valid_valid/acc_unbiased': 72.401, 'best_valid_valid/diff': 21.476, 'best_valid_valid/acc_skew': 61.663, 'best_valid_valid/acc_align': 83.139, 'best_valid_test/acc': 79.815, 'best_valid_test/acc_unbiased': 72.372, 'best_valid_test/diff': 17.207, 'best_valid_test/acc_skew': 66.67, 'best_valid_test/acc_align': 78.074}
[18 / 20] best test accuracy: 74.078 at epoch 15 
 best_stats: {'best_test_epoch': 15, 'best_test_valid/acc': 78.66, 'best_test_valid/acc_unbiased': 72.241, 'best_test_valid/diff': 21.506, 'best_test_valid/acc_skew': 61.488, 'best_test_valid/acc_align': 82.993, 'best_test_test/acc': 80.784, 'best_test_test/acc_unbiased': 74.078, 'best_test_test/diff': 15.316, 'best_test_test/acc_skew': 68.614, 'best_test_test/acc_align': 79.542}
[19 / 20] Learning rate: 1e-05 weight: 0.01
[19 / 20] Loss: 3.813873413614863 CE Loss: 0.3593073409955907 Con Loss: 3.810280338271643
[19 / 20] tensor([[0.981, 0.705],
        [0.602, 0.600]]) {'epoch': 19, 'valid/acc': 77.337, 'valid/acc_unbiased': 71.144, 'valid/diff': 20.516, 'valid/acc_skew': 60.886, 'valid/acc_align': 81.402, 'test/acc': 78.713, 'test/acc_unbiased': 72.194, 'test/diff': 13.934, 'test/acc_skew': 65.331, 'test/acc_align': 79.057}
[19 / 20] best valid accuracy: 72.401 at epoch 18 
 best_stats: {'best_valid_epoch': 18, 'best_valid_valid/acc': 78.483, 'best_valid_valid/acc_unbiased': 72.401, 'best_valid_valid/diff': 21.476, 'best_valid_valid/acc_skew': 61.663, 'best_valid_valid/acc_align': 83.139, 'best_valid_test/acc': 79.815, 'best_valid_test/acc_unbiased': 72.372, 'best_valid_test/diff': 17.207, 'best_valid_test/acc_skew': 66.67, 'best_valid_test/acc_align': 78.074}
[19 / 20] best test accuracy: 74.078 at epoch 15 
 best_stats: {'best_test_epoch': 15, 'best_test_valid/acc': 78.66, 'best_test_valid/acc_unbiased': 72.241, 'best_test_valid/diff': 21.506, 'best_test_valid/acc_skew': 61.488, 'best_test_valid/acc_align': 82.993, 'best_test_test/acc': 80.784, 'best_test_test/acc_unbiased': 74.078, 'best_test_test/diff': 15.316, 'best_test_test/acc_skew': 68.614, 'best_test_test/acc_align': 79.542}
[20 / 20] Learning rate: 1e-05 weight: 0.01
[20 / 20] Loss: 3.7515822453787804 CE Loss: 0.3584137901146521 Con Loss: 3.7479981070617807
[20 / 20] tensor([[0.977, 0.705],
        [0.645, 0.594]]) {'epoch': 20, 'valid/acc': 78.616, 'valid/acc_unbiased': 72.589, 'valid/diff': 21.497, 'valid/acc_skew': 61.841, 'valid/acc_align': 83.338, 'test/acc': 80.123, 'test/acc_unbiased': 73.015, 'test/diff': 16.182, 'test/acc_skew': 67.465, 'test/acc_align': 78.566}
[20 / 20] best valid accuracy: 72.589 at epoch 20 
 best_stats: {'best_valid_epoch': 20, 'best_valid_valid/acc': 78.616, 'best_valid_valid/acc_unbiased': 72.589, 'best_valid_valid/diff': 21.497, 'best_valid_valid/acc_skew': 61.841, 'best_valid_valid/acc_align': 83.338, 'best_valid_test/acc': 80.123, 'best_valid_test/acc_unbiased': 73.015, 'best_valid_test/diff': 16.182, 'best_valid_test/acc_skew': 67.465, 'best_valid_test/acc_align': 78.566}
[20 / 20] best test accuracy: 74.078 at epoch 15 
 best_stats: {'best_test_epoch': 15, 'best_test_valid/acc': 78.66, 'best_test_valid/acc_unbiased': 72.241, 'best_test_valid/diff': 21.506, 'best_test_valid/acc_skew': 61.488, 'best_test_valid/acc_align': 82.993, 'best_test_test/acc': 80.784, 'best_test_test/acc_unbiased': 74.078, 'best_test_test/diff': 15.316, 'best_test_test/acc_skew': 68.614, 'best_test_test/acc_align': 79.542}
Total training time: 0:33:02
