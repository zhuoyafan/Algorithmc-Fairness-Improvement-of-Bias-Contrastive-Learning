Log level set to: INFO
Set seed: 1
=======> Using Fixed Random Seed: 1 <========
save_path: exp_results/bc-bb0-utk_face_race-uw-0.4-lr0.001-bs128-cbs64-w0.01-ratio10-aug1-seed1
get_utk_face - split: train, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_race-0.4
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [4407, 3317]
Target 1: [2644, 5529]
Binary Target 1
---------------------------
Target 0: [4407, 3317]
Target 1: [2644, 5529]
===================================
Normal Label Distribution: 
Target 0: [4407, 3317]
Target 1: [2644, 5529]
===================================
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [4407, 3317]
Target 1: [2644, 5529]
Binary Target 1
---------------------------
Target 0: [4407, 3317]
Target 1: [2644, 5529]
===================================
Normal Label Distribution: 
Target 0: [4407, 3317]
Target 1: [2644, 5529]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 15897, target_attr: gender, bias_attr: race bias_rate: 0.4
['[train] target_0-bias_0: 4407', '[train] target_0-bias_1: 3317', '[train] target_1-bias_0: 2644', '[train] target_1-bias_1: 5529']
confusion_matrix - 
 original: tensor([[4407., 2644.],
        [3317., 5529.]]), 
 normalized: tensor([[0.625, 0.375],
        [0.375, 0.625]]), 
 b|y: tensor([[0.571, 0.429],
        [0.324, 0.676]])
get_utk_face - split: train, aug: 1, given_y: True, ratio: 10
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_race-0.4
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [4407, 3317]
Target 1: [2644, 5529]
Binary Target 1
---------------------------
Target 0: [4407, 3317]
Target 1: [2644, 5529]
===================================
Normal Label Distribution: 
Target 0: [4407, 3317]
Target 1: [2644, 5529]
===================================
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [4407, 3317]
Target 1: [2644, 5529]
Binary Target 1
---------------------------
Target 0: [4407, 3317]
Target 1: [2644, 5529]
===================================
Normal Label Distribution: 
Target 0: [4407, 3317]
Target 1: [2644, 5529]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 15897, target_attr: gender, bias_attr: race bias_rate: 0.4
['[train] target_0-bias_0: 4407', '[train] target_0-bias_1: 3317', '[train] target_1-bias_0: 2644', '[train] target_1-bias_1: 5529']
get_utk_face - split: valid, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_race-0.4
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [583, 684]
Target 1: [457, 646]
Binary Target 1
---------------------------
Target 0: [583, 684]
Target 1: [457, 646]
===================================
Normal Label Distribution: 
Target 0: [583, 684]
Target 1: [457, 646]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 2370, target_attr: gender, bias_attr: race bias_rate: 0.4
['[valid] target_0-bias_0: 583', '[valid] target_0-bias_1: 684', '[valid] target_1-bias_0: 457', '[valid] target_1-bias_1: 646']
get_utk_face - split: test, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_race-0.4
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [558, 677]
Target 1: [462, 673]
Binary Target 1
---------------------------
Target 0: [558, 677]
Target 1: [462, 673]
===================================
Normal Label Distribution: 
Target 0: [558, 677]
Target 1: [462, 673]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 2370, target_attr: gender, bias_attr: race bias_rate: 0.4
['[test] target_0-bias_0: 558', '[test] target_0-bias_1: 677', '[test] target_1-bias_0: 462', '[test] target_1-bias_1: 673']
decay_epochs: [6, 13]
[1 / 20] Learning rate: 0.001 weight: 0.01
[1 / 20] Loss: 4.8729677170921875 CE Loss: 2.152637447742139 Con Loss: 4.851441334199326
[1 / 20] tensor([[0.896, 0.895],
        [0.721, 0.695]]) {'epoch': 1, 'valid/acc': 80.127, 'valid/acc_unbiased': 79.601, 'valid/diff': 2.483, 'valid/acc_skew': 80.842, 'valid/acc_align': 78.36, 'test/acc': 80.464, 'test/acc_unbiased': 80.184, 'test/diff': 1.316, 'test/acc_skew': 80.795, 'test/acc_align': 79.573}
[1 / 20] best valid accuracy: 79.601 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 80.127, 'best_valid_valid/acc_unbiased': 79.601, 'best_valid_valid/diff': 2.483, 'best_valid_valid/acc_skew': 80.842, 'best_valid_valid/acc_align': 78.36, 'best_valid_test/acc': 80.464, 'best_valid_test/acc_unbiased': 80.184, 'best_valid_test/diff': 1.316, 'best_valid_test/acc_skew': 80.795, 'best_valid_test/acc_align': 79.573}
[1 / 20] best test accuracy: 80.184 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 80.127, 'best_test_valid/acc_unbiased': 79.601, 'best_test_valid/diff': 2.483, 'best_test_valid/acc_skew': 80.842, 'best_test_valid/acc_align': 78.36, 'best_test_test/acc': 80.464, 'best_test_test/acc_unbiased': 80.184, 'best_test_test/diff': 1.316, 'best_test_test/acc_skew': 80.795, 'best_test_test/acc_align': 79.573}
[2 / 20] Learning rate: 0.001 weight: 0.01
[2 / 20] Loss: 4.764452401696492 CE Loss: 1.7822249130219747 Con Loss: 4.746630151819087
[2 / 20] tensor([[0.787, 0.722],
        [0.861, 0.884]]) {'epoch': 2, 'valid/acc': 81.73, 'valid/acc_unbiased': 82.066, 'valid/diff': 2.697, 'valid/acc_skew': 80.717, 'valid/acc_align': 83.414, 'test/acc': 81.055, 'test/acc_unbiased': 81.365, 'test/diff': 4.353, 'test/acc_skew': 79.189, 'test/acc_align': 83.542}
[2 / 20] best valid accuracy: 82.066 at epoch 2 
 best_stats: {'best_valid_epoch': 2, 'best_valid_valid/acc': 81.73, 'best_valid_valid/acc_unbiased': 82.066, 'best_valid_valid/diff': 2.697, 'best_valid_valid/acc_skew': 80.717, 'best_valid_valid/acc_align': 83.414, 'best_valid_test/acc': 81.055, 'best_valid_test/acc_unbiased': 81.365, 'best_valid_test/diff': 4.353, 'best_valid_test/acc_skew': 79.189, 'best_valid_test/acc_align': 83.542}
[2 / 20] best test accuracy: 81.365 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 81.73, 'best_test_valid/acc_unbiased': 82.066, 'best_test_valid/diff': 2.697, 'best_test_valid/acc_skew': 80.717, 'best_test_valid/acc_align': 83.414, 'best_test_test/acc': 81.055, 'best_test_test/acc_unbiased': 81.365, 'best_test_test/diff': 4.353, 'best_test_test/acc_skew': 79.189, 'best_test_test/acc_align': 83.542}
[3 / 20] Learning rate: 0.001 weight: 0.01
[3 / 20] Loss: 4.737856519711935 CE Loss: 1.6854473294466106 Con Loss: 4.721002042897206
[3 / 20] tensor([[0.910, 0.894],
        [0.760, 0.808]]) {'epoch': 3, 'valid/acc': 84.515, 'valid/acc_unbiased': 84.332, 'valid/diff': 3.114, 'valid/acc_skew': 84.415, 'valid/acc_align': 84.248, 'test/acc': 84.726, 'test/acc_unbiased': 84.303, 'test/diff': 3.266, 'test/acc_skew': 82.669, 'test/acc_align': 85.936}
[3 / 20] best valid accuracy: 84.332 at epoch 3 
 best_stats: {'best_valid_epoch': 3, 'best_valid_valid/acc': 84.515, 'best_valid_valid/acc_unbiased': 84.332, 'best_valid_valid/diff': 3.114, 'best_valid_valid/acc_skew': 84.415, 'best_valid_valid/acc_align': 84.248, 'best_valid_test/acc': 84.726, 'best_valid_test/acc_unbiased': 84.303, 'best_valid_test/diff': 3.266, 'best_valid_test/acc_skew': 82.669, 'best_valid_test/acc_align': 85.936}
[3 / 20] best test accuracy: 84.303 at epoch 3 
 best_stats: {'best_test_epoch': 3, 'best_test_valid/acc': 84.515, 'best_test_valid/acc_unbiased': 84.332, 'best_test_valid/diff': 3.114, 'best_test_valid/acc_skew': 84.415, 'best_test_valid/acc_align': 84.248, 'best_test_test/acc': 84.726, 'best_test_test/acc_unbiased': 84.303, 'best_test_test/diff': 3.266, 'best_test_test/acc_skew': 82.669, 'best_test_test/acc_align': 85.936}
[4 / 20] Learning rate: 0.001 weight: 0.01
[4 / 20] Loss: 4.720333259540766 CE Loss: 1.6394054938271532 Con Loss: 4.703939182905159
[4 / 20] tensor([[0.781, 0.793],
        [0.894, 0.908]]) {'epoch': 4, 'valid/acc': 84.177, 'valid/acc_unbiased': 84.57, 'valid/diff': 1.364, 'valid/acc_skew': 84.551, 'valid/acc_align': 84.59, 'test/acc': 84.262, 'test/acc_unbiased': 84.41, 'test/diff': 1.289, 'test/acc_skew': 84.357, 'test/acc_align': 84.462}
[4 / 20] best valid accuracy: 84.570 at epoch 4 
 best_stats: {'best_valid_epoch': 4, 'best_valid_valid/acc': 84.177, 'best_valid_valid/acc_unbiased': 84.57, 'best_valid_valid/diff': 1.364, 'best_valid_valid/acc_skew': 84.551, 'best_valid_valid/acc_align': 84.59, 'best_valid_test/acc': 84.262, 'best_valid_test/acc_unbiased': 84.41, 'best_valid_test/diff': 1.289, 'best_valid_test/acc_skew': 84.357, 'best_valid_test/acc_align': 84.462}
[4 / 20] best test accuracy: 84.410 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 84.177, 'best_test_valid/acc_unbiased': 84.57, 'best_test_valid/diff': 1.364, 'best_test_valid/acc_skew': 84.551, 'best_test_valid/acc_align': 84.59, 'best_test_test/acc': 84.262, 'best_test_test/acc_unbiased': 84.41, 'best_test_test/diff': 1.289, 'best_test_test/acc_skew': 84.357, 'best_test_test/acc_align': 84.462}
[5 / 20] Learning rate: 0.001 weight: 0.01
[5 / 20] Loss: 4.709206933651869 CE Loss: 1.5350078110680787 Con Loss: 4.6938568526951485
[5 / 20] tensor([[0.806, 0.773],
        [0.885, 0.905]]) {'epoch': 5, 'valid/acc': 83.755, 'valid/acc_unbiased': 84.241, 'valid/diff': 1.647, 'valid/acc_skew': 83.417, 'valid/acc_align': 85.064, 'test/acc': 84.008, 'test/acc_unbiased': 84.229, 'test/diff': 2.677, 'test/acc_skew': 82.89, 'test/acc_align': 85.568}
[5 / 20] best valid accuracy: 84.570 at epoch 4 
 best_stats: {'best_valid_epoch': 4, 'best_valid_valid/acc': 84.177, 'best_valid_valid/acc_unbiased': 84.57, 'best_valid_valid/diff': 1.364, 'best_valid_valid/acc_skew': 84.551, 'best_valid_valid/acc_align': 84.59, 'best_valid_test/acc': 84.262, 'best_valid_test/acc_unbiased': 84.41, 'best_valid_test/diff': 1.289, 'best_valid_test/acc_skew': 84.357, 'best_valid_test/acc_align': 84.462}
[5 / 20] best test accuracy: 84.410 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 84.177, 'best_test_valid/acc_unbiased': 84.57, 'best_test_valid/diff': 1.364, 'best_test_valid/acc_skew': 84.551, 'best_test_valid/acc_align': 84.59, 'best_test_test/acc': 84.262, 'best_test_test/acc_unbiased': 84.41, 'best_test_test/diff': 1.289, 'best_test_test/acc_skew': 84.357, 'best_test_test/acc_align': 84.462}
[6 / 20] Learning rate: 0.001 weight: 0.01
[6 / 20] Loss: 4.704977494122405 CE Loss: 1.5199209338967632 Con Loss: 4.689778302295812
[6 / 20] tensor([[0.837, 0.817],
        [0.877, 0.880]]) {'epoch': 6, 'valid/acc': 86.076, 'valid/acc_unbiased': 86.357, 'valid/diff': 1.611, 'valid/acc_skew': 86.634, 'valid/acc_align': 86.081, 'test/acc': 85.105, 'test/acc_unbiased': 85.251, 'test/diff': 1.155, 'test/acc_skew': 84.673, 'test/acc_align': 85.828}
[6 / 20] best valid accuracy: 86.357 at epoch 6 
 best_stats: {'best_valid_epoch': 6, 'best_valid_valid/acc': 86.076, 'best_valid_valid/acc_unbiased': 86.357, 'best_valid_valid/diff': 1.611, 'best_valid_valid/acc_skew': 86.634, 'best_valid_valid/acc_align': 86.081, 'best_valid_test/acc': 85.105, 'best_valid_test/acc_unbiased': 85.251, 'best_valid_test/diff': 1.155, 'best_valid_test/acc_skew': 84.673, 'best_valid_test/acc_align': 85.828}
[6 / 20] best test accuracy: 85.251 at epoch 6 
 best_stats: {'best_test_epoch': 6, 'best_test_valid/acc': 86.076, 'best_test_valid/acc_unbiased': 86.357, 'best_test_valid/diff': 1.611, 'best_test_valid/acc_skew': 86.634, 'best_test_valid/acc_align': 86.081, 'best_test_test/acc': 85.105, 'best_test_test/acc_unbiased': 85.251, 'best_test_test/diff': 1.155, 'best_test_test/acc_skew': 84.673, 'best_test_test/acc_align': 85.828}
[7 / 20] Learning rate: 0.0001 weight: 0.01
[7 / 20] Loss: 4.667946779196267 CE Loss: 1.3781706270364993 Con Loss: 4.654165088391764
[7 / 20] tensor([[0.871, 0.857],
        [0.892, 0.883]]) {'epoch': 7, 'valid/acc': 87.257, 'valid/acc_unbiased': 87.522, 'valid/diff': 2.977, 'valid/acc_skew': 87.876, 'valid/acc_align': 87.169, 'test/acc': 87.426, 'test/acc_unbiased': 87.552, 'test/diff': 1.17, 'test/acc_skew': 87.425, 'test/acc_align': 87.679}
[7 / 20] best valid accuracy: 87.522 at epoch 7 
 best_stats: {'best_valid_epoch': 7, 'best_valid_valid/acc': 87.257, 'best_valid_valid/acc_unbiased': 87.522, 'best_valid_valid/diff': 2.977, 'best_valid_valid/acc_skew': 87.876, 'best_valid_valid/acc_align': 87.169, 'best_valid_test/acc': 87.426, 'best_valid_test/acc_unbiased': 87.552, 'best_valid_test/diff': 1.17, 'best_valid_test/acc_skew': 87.425, 'best_valid_test/acc_align': 87.679}
[7 / 20] best test accuracy: 87.552 at epoch 7 
 best_stats: {'best_test_epoch': 7, 'best_test_valid/acc': 87.257, 'best_test_valid/acc_unbiased': 87.522, 'best_test_valid/diff': 2.977, 'best_test_valid/acc_skew': 87.876, 'best_test_valid/acc_align': 87.169, 'best_test_test/acc': 87.426, 'best_test_test/acc_unbiased': 87.552, 'best_test_test/diff': 1.17, 'best_test_test/acc_skew': 87.425, 'best_test_test/acc_align': 87.679}
[8 / 20] Learning rate: 0.0001 weight: 0.01
[8 / 20] Loss: 4.635406439638951 CE Loss: 1.2737962720963598 Con Loss: 4.622668469005421
[8 / 20] tensor([[0.871, 0.857],
        [0.890, 0.905]]) {'epoch': 8, 'valid/acc': 87.595, 'valid/acc_unbiased': 87.874, 'valid/diff': 3.474, 'valid/acc_skew': 87.437, 'valid/acc_align': 88.311, 'test/acc': 88.017, 'test/acc_unbiased': 88.055, 'test/diff': 1.477, 'test/acc_skew': 87.317, 'test/acc_align': 88.794}
[8 / 20] best valid accuracy: 87.874 at epoch 8 
 best_stats: {'best_valid_epoch': 8, 'best_valid_valid/acc': 87.595, 'best_valid_valid/acc_unbiased': 87.874, 'best_valid_valid/diff': 3.474, 'best_valid_valid/acc_skew': 87.437, 'best_valid_valid/acc_align': 88.311, 'best_valid_test/acc': 88.017, 'best_valid_test/acc_unbiased': 88.055, 'best_valid_test/diff': 1.477, 'best_valid_test/acc_skew': 87.317, 'best_valid_test/acc_align': 88.794}
[8 / 20] best test accuracy: 88.055 at epoch 8 
 best_stats: {'best_test_epoch': 8, 'best_test_valid/acc': 87.595, 'best_test_valid/acc_unbiased': 87.874, 'best_test_valid/diff': 3.474, 'best_test_valid/acc_skew': 87.437, 'best_test_valid/acc_align': 88.311, 'best_test_test/acc': 88.017, 'best_test_test/acc_unbiased': 88.055, 'best_test_test/diff': 1.477, 'best_test_test/acc_skew': 87.317, 'best_test_test/acc_align': 88.794}
[9 / 20] Learning rate: 0.0001 weight: 0.01
[9 / 20] Loss: 4.633488936477347 CE Loss: 1.258401806882292 Con Loss: 4.620904937153111
[9 / 20] tensor([[0.905, 0.892],
        [0.857, 0.869]]) {'epoch': 9, 'valid/acc': 88.186, 'valid/acc_unbiased': 88.24, 'valid/diff': 3.08, 'valid/acc_skew': 88.5, 'valid/acc_align': 87.98, 'test/acc': 88.186, 'test/acc_unbiased': 88.089, 'test/diff': 1.247, 'test/acc_skew': 87.466, 'test/acc_align': 88.713}
[9 / 20] best valid accuracy: 88.240 at epoch 9 
 best_stats: {'best_valid_epoch': 9, 'best_valid_valid/acc': 88.186, 'best_valid_valid/acc_unbiased': 88.24, 'best_valid_valid/diff': 3.08, 'best_valid_valid/acc_skew': 88.5, 'best_valid_valid/acc_align': 87.98, 'best_valid_test/acc': 88.186, 'best_valid_test/acc_unbiased': 88.089, 'best_valid_test/diff': 1.247, 'best_valid_test/acc_skew': 87.466, 'best_valid_test/acc_align': 88.713}
[9 / 20] best test accuracy: 88.089 at epoch 9 
 best_stats: {'best_test_epoch': 9, 'best_test_valid/acc': 88.186, 'best_test_valid/acc_unbiased': 88.24, 'best_test_valid/diff': 3.08, 'best_test_valid/acc_skew': 88.5, 'best_test_valid/acc_align': 87.98, 'best_test_test/acc': 88.186, 'best_test_test/acc_unbiased': 88.089, 'best_test_test/diff': 1.247, 'best_test_test/acc_skew': 87.466, 'best_test_test/acc_align': 88.713}
[10 / 20] Learning rate: 0.0001 weight: 0.01
[10 / 20] Loss: 4.63263702131618 CE Loss: 1.2209949203127546 Con Loss: 4.620427070612156
[10 / 20] tensor([[0.884, 0.857],
        [0.883, 0.892]]) {'epoch': 10, 'valid/acc': 87.722, 'valid/acc_unbiased': 87.934, 'valid/diff': 3.337, 'valid/acc_skew': 87.438, 'valid/acc_align': 88.43, 'test/acc': 87.806, 'test/acc_unbiased': 87.872, 'test/diff': 1.76, 'test/acc_skew': 86.992, 'test/acc_align': 88.752}
[10 / 20] best valid accuracy: 88.240 at epoch 9 
 best_stats: {'best_valid_epoch': 9, 'best_valid_valid/acc': 88.186, 'best_valid_valid/acc_unbiased': 88.24, 'best_valid_valid/diff': 3.08, 'best_valid_valid/acc_skew': 88.5, 'best_valid_valid/acc_align': 87.98, 'best_valid_test/acc': 88.186, 'best_valid_test/acc_unbiased': 88.089, 'best_valid_test/diff': 1.247, 'best_valid_test/acc_skew': 87.466, 'best_valid_test/acc_align': 88.713}
[10 / 20] best test accuracy: 88.089 at epoch 9 
 best_stats: {'best_test_epoch': 9, 'best_test_valid/acc': 88.186, 'best_test_valid/acc_unbiased': 88.24, 'best_test_valid/diff': 3.08, 'best_test_valid/acc_skew': 88.5, 'best_test_valid/acc_align': 87.98, 'best_test_test/acc': 88.186, 'best_test_test/acc_unbiased': 88.089, 'best_test_test/diff': 1.247, 'best_test_test/acc_skew': 87.466, 'best_test_test/acc_align': 88.713}
[11 / 20] Learning rate: 0.0001 weight: 0.01
[11 / 20] Loss: 4.622294871936228 CE Loss: 1.2288664038649084 Con Loss: 4.610006214215514
[11 / 20] tensor([[0.880, 0.869],
        [0.892, 0.902]]) {'epoch': 11, 'valid/acc': 88.186, 'valid/acc_unbiased': 88.485, 'valid/diff': 2.709, 'valid/acc_skew': 88.313, 'valid/acc_align': 88.656, 'test/acc': 88.523, 'test/acc_unbiased': 88.554, 'test/diff': 1.077, 'test/acc_skew': 88.016, 'test/acc_align': 89.093}
[11 / 20] best valid accuracy: 88.485 at epoch 11 
 best_stats: {'best_valid_epoch': 11, 'best_valid_valid/acc': 88.186, 'best_valid_valid/acc_unbiased': 88.485, 'best_valid_valid/diff': 2.709, 'best_valid_valid/acc_skew': 88.313, 'best_valid_valid/acc_align': 88.656, 'best_valid_test/acc': 88.523, 'best_valid_test/acc_unbiased': 88.554, 'best_valid_test/diff': 1.077, 'best_valid_test/acc_skew': 88.016, 'best_valid_test/acc_align': 89.093}
[11 / 20] best test accuracy: 88.554 at epoch 11 
 best_stats: {'best_test_epoch': 11, 'best_test_valid/acc': 88.186, 'best_test_valid/acc_unbiased': 88.485, 'best_test_valid/diff': 2.709, 'best_test_valid/acc_skew': 88.313, 'best_test_valid/acc_align': 88.656, 'best_test_test/acc': 88.523, 'best_test_test/acc_unbiased': 88.554, 'best_test_test/diff': 1.077, 'best_test_test/acc_skew': 88.016, 'best_test_test/acc_align': 89.093}
[12 / 20] Learning rate: 0.0001 weight: 0.01
[12 / 20] Loss: 4.605800817903201 CE Loss: 1.2073999956852912 Con Loss: 4.5937268220606695
[12 / 20] tensor([[0.896, 0.876],
        [0.883, 0.887]]) {'epoch': 12, 'valid/acc': 88.143, 'valid/acc_unbiased': 88.321, 'valid/diff': 2.906, 'valid/acc_skew': 87.731, 'valid/acc_align': 88.911, 'test/acc': 88.523, 'test/acc_unbiased': 88.554, 'test/diff': 1.205, 'test/acc_skew': 87.952, 'test/acc_align': 89.157}
[12 / 20] best valid accuracy: 88.485 at epoch 11 
 best_stats: {'best_valid_epoch': 11, 'best_valid_valid/acc': 88.186, 'best_valid_valid/acc_unbiased': 88.485, 'best_valid_valid/diff': 2.709, 'best_valid_valid/acc_skew': 88.313, 'best_valid_valid/acc_align': 88.656, 'best_valid_test/acc': 88.523, 'best_valid_test/acc_unbiased': 88.554, 'best_valid_test/diff': 1.077, 'best_valid_test/acc_skew': 88.016, 'best_valid_test/acc_align': 89.093}
[12 / 20] best test accuracy: 88.554 at epoch 11 
 best_stats: {'best_test_epoch': 11, 'best_test_valid/acc': 88.186, 'best_test_valid/acc_unbiased': 88.485, 'best_test_valid/diff': 2.709, 'best_test_valid/acc_skew': 88.313, 'best_test_valid/acc_align': 88.656, 'best_test_test/acc': 88.523, 'best_test_test/acc_unbiased': 88.554, 'best_test_test/diff': 1.077, 'best_test_test/acc_skew': 88.016, 'best_test_test/acc_align': 89.093}
[13 / 20] Learning rate: 0.0001 weight: 0.01
[13 / 20] Loss: 4.609021398926213 CE Loss: 1.2029782368070923 Con Loss: 4.596991618009396
[13 / 20] tensor([[0.903, 0.891],
        [0.890, 0.862]]) {'epoch': 13, 'valid/acc': 87.975, 'valid/acc_unbiased': 88.172, 'valid/diff': 3.985, 'valid/acc_skew': 89.119, 'valid/acc_align': 87.225, 'test/acc': 88.523, 'test/acc_unbiased': 88.634, 'test/diff': 2.016, 'test/acc_skew': 89.015, 'test/acc_align': 88.252}
[13 / 20] best valid accuracy: 88.485 at epoch 11 
 best_stats: {'best_valid_epoch': 11, 'best_valid_valid/acc': 88.186, 'best_valid_valid/acc_unbiased': 88.485, 'best_valid_valid/diff': 2.709, 'best_valid_valid/acc_skew': 88.313, 'best_valid_valid/acc_align': 88.656, 'best_valid_test/acc': 88.523, 'best_valid_test/acc_unbiased': 88.554, 'best_valid_test/diff': 1.077, 'best_valid_test/acc_skew': 88.016, 'best_valid_test/acc_align': 89.093}
[13 / 20] best test accuracy: 88.634 at epoch 13 
 best_stats: {'best_test_epoch': 13, 'best_test_valid/acc': 87.975, 'best_test_valid/acc_unbiased': 88.172, 'best_test_valid/diff': 3.985, 'best_test_valid/acc_skew': 89.119, 'best_test_valid/acc_align': 87.225, 'best_test_test/acc': 88.523, 'best_test_test/acc_unbiased': 88.634, 'best_test_test/diff': 2.016, 'best_test_test/acc_skew': 89.015, 'best_test_test/acc_align': 88.252}
[14 / 20] Learning rate: 1e-05 weight: 0.01
[14 / 20] Loss: 4.607147490954994 CE Loss: 1.1655530752067544 Con Loss: 4.595491968026407
[14 / 20] tensor([[0.894, 0.877],
        [0.900, 0.886]]) {'epoch': 14, 'valid/acc': 88.439, 'valid/acc_unbiased': 88.77, 'valid/diff': 3.994, 'valid/acc_skew': 89.446, 'valid/acc_align': 88.095, 'test/acc': 88.819, 'test/acc_unbiased': 88.942, 'test/diff': 1.586, 'test/acc_skew': 88.892, 'test/acc_align': 88.993}
[14 / 20] best valid accuracy: 88.770 at epoch 14 
 best_stats: {'best_valid_epoch': 14, 'best_valid_valid/acc': 88.439, 'best_valid_valid/acc_unbiased': 88.77, 'best_valid_valid/diff': 3.994, 'best_valid_valid/acc_skew': 89.446, 'best_valid_valid/acc_align': 88.095, 'best_valid_test/acc': 88.819, 'best_valid_test/acc_unbiased': 88.942, 'best_valid_test/diff': 1.586, 'best_valid_test/acc_skew': 88.892, 'best_valid_test/acc_align': 88.993}
[14 / 20] best test accuracy: 88.942 at epoch 14 
 best_stats: {'best_test_epoch': 14, 'best_test_valid/acc': 88.439, 'best_test_valid/acc_unbiased': 88.77, 'best_test_valid/diff': 3.994, 'best_test_valid/acc_skew': 89.446, 'best_test_valid/acc_align': 88.095, 'best_test_test/acc': 88.819, 'best_test_test/acc_unbiased': 88.942, 'best_test_test/diff': 1.586, 'best_test_test/acc_skew': 88.892, 'best_test_test/acc_align': 88.993}
[15 / 20] Learning rate: 1e-05 weight: 0.01
[15 / 20] Loss: 4.6022678539799005 CE Loss: 1.15462381140709 Con Loss: 4.59072158981091
[15 / 20] tensor([[0.896, 0.885],
        [0.894, 0.880]]) {'epoch': 15, 'valid/acc': 88.059, 'valid/acc_unbiased': 88.365, 'valid/diff': 4.74, 'valid/acc_skew': 88.972, 'valid/acc_align': 87.759, 'test/acc': 88.776, 'test/acc_unbiased': 88.861, 'test/diff': 1.278, 'test/acc_skew': 88.936, 'test/acc_align': 88.785}
[15 / 20] best valid accuracy: 88.770 at epoch 14 
 best_stats: {'best_valid_epoch': 14, 'best_valid_valid/acc': 88.439, 'best_valid_valid/acc_unbiased': 88.77, 'best_valid_valid/diff': 3.994, 'best_valid_valid/acc_skew': 89.446, 'best_valid_valid/acc_align': 88.095, 'best_valid_test/acc': 88.819, 'best_valid_test/acc_unbiased': 88.942, 'best_valid_test/diff': 1.586, 'best_valid_test/acc_skew': 88.892, 'best_valid_test/acc_align': 88.993}
[15 / 20] best test accuracy: 88.942 at epoch 14 
 best_stats: {'best_test_epoch': 14, 'best_test_valid/acc': 88.439, 'best_test_valid/acc_unbiased': 88.77, 'best_test_valid/diff': 3.994, 'best_test_valid/acc_skew': 89.446, 'best_test_valid/acc_align': 88.095, 'best_test_test/acc': 88.819, 'best_test_test/acc_unbiased': 88.942, 'best_test_test/diff': 1.586, 'best_test_test/acc_skew': 88.892, 'best_test_test/acc_align': 88.993}
[16 / 20] Learning rate: 1e-05 weight: 0.01
[16 / 20] Loss: 4.612583199844365 CE Loss: 1.1268953323971664 Con Loss: 4.601314250152726
[16 / 20] tensor([[0.910, 0.904],
        [0.877, 0.868]]) {'epoch': 16, 'valid/acc': 88.565, 'valid/acc_unbiased': 88.765, 'valid/diff': 4.438, 'valid/acc_skew': 89.704, 'valid/acc_align': 87.825, 'test/acc': 88.987, 'test/acc_unbiased': 88.969, 'test/diff': 0.764, 'test/acc_skew': 89.031, 'test/acc_align': 88.908}
[16 / 20] best valid accuracy: 88.770 at epoch 14 
 best_stats: {'best_valid_epoch': 14, 'best_valid_valid/acc': 88.439, 'best_valid_valid/acc_unbiased': 88.77, 'best_valid_valid/diff': 3.994, 'best_valid_valid/acc_skew': 89.446, 'best_valid_valid/acc_align': 88.095, 'best_valid_test/acc': 88.819, 'best_valid_test/acc_unbiased': 88.942, 'best_valid_test/diff': 1.586, 'best_valid_test/acc_skew': 88.892, 'best_valid_test/acc_align': 88.993}
[16 / 20] best test accuracy: 88.969 at epoch 16 
 best_stats: {'best_test_epoch': 16, 'best_test_valid/acc': 88.565, 'best_test_valid/acc_unbiased': 88.765, 'best_test_valid/diff': 4.438, 'best_test_valid/acc_skew': 89.704, 'best_test_valid/acc_align': 87.825, 'best_test_test/acc': 88.987, 'best_test_test/acc_unbiased': 88.969, 'best_test_test/diff': 0.764, 'best_test_test/acc_skew': 89.031, 'best_test_test/acc_align': 88.908}
[17 / 20] Learning rate: 1e-05 weight: 0.01
[17 / 20] Loss: 4.603853178765179 CE Loss: 1.1215441317920334 Con Loss: 4.5926377419788915
[17 / 20] tensor([[0.898, 0.894],
        [0.892, 0.878]]) {'epoch': 17, 'valid/acc': 88.439, 'valid/acc_unbiased': 88.723, 'valid/diff': 4.415, 'valid/acc_skew': 89.446, 'valid/acc_align': 87.999, 'test/acc': 88.987, 'test/acc_unbiased': 89.036, 'test/diff': 0.891, 'test/acc_skew': 89.271, 'test/acc_align': 88.8}
[17 / 20] best valid accuracy: 88.770 at epoch 14 
 best_stats: {'best_valid_epoch': 14, 'best_valid_valid/acc': 88.439, 'best_valid_valid/acc_unbiased': 88.77, 'best_valid_valid/diff': 3.994, 'best_valid_valid/acc_skew': 89.446, 'best_valid_valid/acc_align': 88.095, 'best_valid_test/acc': 88.819, 'best_valid_test/acc_unbiased': 88.942, 'best_valid_test/diff': 1.586, 'best_valid_test/acc_skew': 88.892, 'best_valid_test/acc_align': 88.993}
[17 / 20] best test accuracy: 89.036 at epoch 17 
 best_stats: {'best_test_epoch': 17, 'best_test_valid/acc': 88.439, 'best_test_valid/acc_unbiased': 88.723, 'best_test_valid/diff': 4.415, 'best_test_valid/acc_skew': 89.446, 'best_test_valid/acc_align': 87.999, 'best_test_test/acc': 88.987, 'best_test_test/acc_unbiased': 89.036, 'best_test_test/diff': 0.891, 'best_test_test/acc_skew': 89.271, 'best_test_test/acc_align': 88.8}
[18 / 20] Learning rate: 1e-05 weight: 0.01
[18 / 20] Loss: 4.59879883218878 CE Loss: 1.1387340781328295 Con Loss: 4.587411484193703
[18 / 20] tensor([[0.892, 0.889],
        [0.892, 0.884]]) {'epoch': 18, 'valid/acc': 88.354, 'valid/acc_unbiased': 88.615, 'valid/diff': 3.726, 'valid/acc_skew': 89.264, 'valid/acc_align': 87.966, 'test/acc': 88.903, 'test/acc_unbiased': 88.939, 'test/diff': 0.546, 'test/acc_skew': 89.05, 'test/acc_align': 88.829}
[18 / 20] best valid accuracy: 88.770 at epoch 14 
 best_stats: {'best_valid_epoch': 14, 'best_valid_valid/acc': 88.439, 'best_valid_valid/acc_unbiased': 88.77, 'best_valid_valid/diff': 3.994, 'best_valid_valid/acc_skew': 89.446, 'best_valid_valid/acc_align': 88.095, 'best_valid_test/acc': 88.819, 'best_valid_test/acc_unbiased': 88.942, 'best_valid_test/diff': 1.586, 'best_valid_test/acc_skew': 88.892, 'best_valid_test/acc_align': 88.993}
[18 / 20] best test accuracy: 89.036 at epoch 17 
 best_stats: {'best_test_epoch': 17, 'best_test_valid/acc': 88.439, 'best_test_valid/acc_unbiased': 88.723, 'best_test_valid/diff': 4.415, 'best_test_valid/acc_skew': 89.446, 'best_test_valid/acc_align': 87.999, 'best_test_test/acc': 88.987, 'best_test_test/acc_unbiased': 89.036, 'best_test_test/diff': 0.891, 'best_test_test/acc_skew': 89.271, 'best_test_test/acc_align': 88.8}
[19 / 20] Learning rate: 1e-05 weight: 0.01
[19 / 20] Loss: 4.594721539887256 CE Loss: 1.1363447530881379 Con Loss: 4.58335809509072
[19 / 20] tensor([[0.898, 0.880],
        [0.894, 0.889]]) {'epoch': 19, 'valid/acc': 89.072, 'valid/acc_unbiased': 89.333, 'valid/diff': 3.632, 'valid/acc_skew': 89.738, 'valid/acc_align': 88.928, 'test/acc': 88.945, 'test/acc_unbiased': 89.018, 'test/diff': 1.144, 'test/acc_skew': 88.715, 'test/acc_align': 89.32}
[19 / 20] best valid accuracy: 89.333 at epoch 19 
 best_stats: {'best_valid_epoch': 19, 'best_valid_valid/acc': 89.072, 'best_valid_valid/acc_unbiased': 89.333, 'best_valid_valid/diff': 3.632, 'best_valid_valid/acc_skew': 89.738, 'best_valid_valid/acc_align': 88.928, 'best_valid_test/acc': 88.945, 'best_valid_test/acc_unbiased': 89.018, 'best_valid_test/diff': 1.144, 'best_valid_test/acc_skew': 88.715, 'best_valid_test/acc_align': 89.32}
[19 / 20] best test accuracy: 89.036 at epoch 17 
 best_stats: {'best_test_epoch': 17, 'best_test_valid/acc': 88.439, 'best_test_valid/acc_unbiased': 88.723, 'best_test_valid/diff': 4.415, 'best_test_valid/acc_skew': 89.446, 'best_test_valid/acc_align': 87.999, 'best_test_test/acc': 88.987, 'best_test_test/acc_unbiased': 89.036, 'best_test_test/diff': 0.891, 'best_test_test/acc_skew': 89.271, 'best_test_test/acc_align': 88.8}
[20 / 20] Learning rate: 1e-05 weight: 0.01
[20 / 20] Loss: 4.603271318320367 CE Loss: 1.143591469073735 Con Loss: 4.59183539724533
[20 / 20] tensor([[0.876, 0.867],
        [0.913, 0.903]]) {'epoch': 20, 'valid/acc': 88.65, 'valid/acc_unbiased': 89.059, 'valid/diff': 4.168, 'valid/acc_skew': 89.188, 'valid/acc_align': 88.93, 'test/acc': 88.861, 'test/acc_unbiased': 89.006, 'test/diff': 0.964, 'test/acc_skew': 89.024, 'test/acc_align': 88.988}
[20 / 20] best valid accuracy: 89.333 at epoch 19 
 best_stats: {'best_valid_epoch': 19, 'best_valid_valid/acc': 89.072, 'best_valid_valid/acc_unbiased': 89.333, 'best_valid_valid/diff': 3.632, 'best_valid_valid/acc_skew': 89.738, 'best_valid_valid/acc_align': 88.928, 'best_valid_test/acc': 88.945, 'best_valid_test/acc_unbiased': 89.018, 'best_valid_test/diff': 1.144, 'best_valid_test/acc_skew': 88.715, 'best_valid_test/acc_align': 89.32}
[20 / 20] best test accuracy: 89.036 at epoch 17 
 best_stats: {'best_test_epoch': 17, 'best_test_valid/acc': 88.439, 'best_test_valid/acc_unbiased': 88.723, 'best_test_valid/diff': 4.415, 'best_test_valid/acc_skew': 89.446, 'best_test_valid/acc_align': 87.999, 'best_test_test/acc': 88.987, 'best_test_test/acc_unbiased': 89.036, 'best_test_test/diff': 0.891, 'best_test_test/acc_skew': 89.271, 'best_test_test/acc_align': 88.8}
Total training time: 1:18:08
