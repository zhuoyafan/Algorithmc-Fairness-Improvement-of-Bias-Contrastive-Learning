Log level set to: INFO
Set seed: 1
=======> Using Fixed Random Seed: 1 <========
save_path: exp_results/bc-bb0-utk_face_age-os_trival-0.9-lr0.001-bs128-cbs64-w0.01-ratio10-aug1-seed1
get_utk_face - split: train, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_age-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
Binary Target 1
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Normal Label Distribution: 
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [8237, 8237]
Target 1: [8237, 8237]
Binary Target 1
---------------------------
Target 0: [8237, 8237]
Target 1: [8237, 8237]
===================================
Normal Label Distribution: 
Target 0: [8237, 8237]
Target 1: [8237, 8237]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 32948, target_attr: gender, bias_attr: age bias_rate: 0.9
['[train] target_0-bias_0: 8237', '[train] target_0-bias_1: 8237', '[train] target_1-bias_0: 8237', '[train] target_1-bias_1: 8237']
confusion_matrix - 
 original: tensor([[8237., 8237.],
        [8237., 8237.]]), 
 normalized: tensor([[0.500, 0.500],
        [0.500, 0.500]]), 
 b|y: tensor([[0.500, 0.500],
        [0.500, 0.500]])
get_utk_face - split: train, aug: 1, given_y: True, ratio: 10
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_age-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
Binary Target 1
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Normal Label Distribution: 
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [8237, 8237]
Target 1: [8237, 8237]
Binary Target 1
---------------------------
Target 0: [8237, 8237]
Target 1: [8237, 8237]
===================================
Normal Label Distribution: 
Target 0: [8237, 8237]
Target 1: [8237, 8237]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 32948, target_attr: gender, bias_attr: age bias_rate: 0.9
['[train] target_0-bias_0: 8237', '[train] target_0-bias_1: 8237', '[train] target_1-bias_0: 8237', '[train] target_1-bias_1: 8237']
get_utk_face - split: valid, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_age-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [1030, 195]
Target 1: [841, 202]
Binary Target 1
---------------------------
Target 0: [1030, 195]
Target 1: [841, 202]
===================================
Normal Label Distribution: 
Target 0: [1030, 195]
Target 1: [841, 202]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 2268, target_attr: gender, bias_attr: age bias_rate: 0.9
['[valid] target_0-bias_0: 1030', '[valid] target_0-bias_1: 195', '[valid] target_1-bias_0: 841', '[valid] target_1-bias_1: 202']
get_utk_face - split: test, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_age-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [1061, 176]
Target 1: [867, 165]
Binary Target 1
---------------------------
Target 0: [1061, 176]
Target 1: [867, 165]
===================================
Normal Label Distribution: 
Target 0: [1061, 176]
Target 1: [867, 165]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 2269, target_attr: gender, bias_attr: age bias_rate: 0.9
['[test] target_0-bias_0: 1061', '[test] target_0-bias_1: 176', '[test] target_1-bias_0: 867', '[test] target_1-bias_1: 165']
decay_epochs: [6, 13]
[1 / 20] Learning rate: 0.001 weight: 0.01
[1 / 20] Loss: 4.850501386404646 CE Loss: 0.5561303653893026 Con Loss: 4.844940061431436
[1 / 20] tensor([[0.842, 0.562],
        [0.828, 0.764]]) {'epoch': 1, 'valid/acc': 79.718, 'valid/acc_unbiased': 73.258, 'valid/diff': 19.509, 'valid/acc_skew': 83.013, 'valid/acc_align': 63.503, 'test/acc': 80.917, 'test/acc_unbiased': 74.898, 'test/diff': 17.183, 'test/acc_skew': 83.49, 'test/acc_align': 66.307}
[1 / 20] best valid accuracy: 73.258 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 79.718, 'best_valid_valid/acc_unbiased': 73.258, 'best_valid_valid/diff': 19.509, 'best_valid_valid/acc_skew': 83.013, 'best_valid_valid/acc_align': 63.503, 'best_valid_test/acc': 80.917, 'best_valid_test/acc_unbiased': 74.898, 'best_valid_test/diff': 17.183, 'best_valid_test/acc_skew': 83.49, 'best_valid_test/acc_align': 66.307}
[1 / 20] best test accuracy: 74.898 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 79.718, 'best_test_valid/acc_unbiased': 73.258, 'best_test_valid/diff': 19.509, 'best_test_valid/acc_skew': 83.013, 'best_test_valid/acc_align': 63.503, 'best_test_test/acc': 80.917, 'best_test_test/acc_unbiased': 74.898, 'best_test_test/diff': 17.183, 'best_test_test/acc_skew': 83.49, 'best_test_test/acc_align': 66.307}
[2 / 20] Learning rate: 0.001 weight: 0.01
[2 / 20] Loss: 4.78731841428543 CE Loss: 0.45875820203126744 Con Loss: 4.782730831427815
[2 / 20] tensor([[0.784, 0.398],
        [0.904, 0.921]]) {'epoch': 2, 'valid/acc': 80.071, 'valid/acc_unbiased': 72.233, 'valid/diff': 25.342, 'valid/acc_skew': 84.801, 'valid/acc_align': 59.665, 'test/acc': 81.005, 'test/acc_unbiased': 75.184, 'test/diff': 20.169, 'test/acc_skew': 84.422, 'test/acc_align': 65.947}
[2 / 20] best valid accuracy: 73.258 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 79.718, 'best_valid_valid/acc_unbiased': 73.258, 'best_valid_valid/diff': 19.509, 'best_valid_valid/acc_skew': 83.013, 'best_valid_valid/acc_align': 63.503, 'best_valid_test/acc': 80.917, 'best_valid_test/acc_unbiased': 74.898, 'best_valid_test/diff': 17.183, 'best_valid_test/acc_skew': 83.49, 'best_valid_test/acc_align': 66.307}
[2 / 20] best test accuracy: 75.184 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 80.071, 'best_test_valid/acc_unbiased': 72.233, 'best_test_valid/diff': 25.342, 'best_test_valid/acc_skew': 84.801, 'best_test_valid/acc_align': 59.665, 'best_test_test/acc': 81.005, 'best_test_test/acc_unbiased': 75.184, 'best_test_test/diff': 20.169, 'best_test_test/acc_skew': 84.422, 'best_test_test/acc_align': 65.947}
[3 / 20] Learning rate: 0.001 weight: 0.01
[3 / 20] Loss: 4.761969783431453 CE Loss: 0.4146077104805598 Con Loss: 4.757823703270796
[3 / 20] tensor([[0.888, 0.750],
        [0.769, 0.594]]) {'epoch': 3, 'valid/acc': 80.335, 'valid/acc_unbiased': 73.719, 'valid/diff': 18.749, 'valid/acc_skew': 83.094, 'valid/acc_align': 64.345, 'test/acc': 81.049, 'test/acc_unbiased': 75.028, 'test/diff': 15.661, 'test/acc_skew': 82.858, 'test/acc_align': 67.197}
[3 / 20] best valid accuracy: 73.719 at epoch 3 
 best_stats: {'best_valid_epoch': 3, 'best_valid_valid/acc': 80.335, 'best_valid_valid/acc_unbiased': 73.719, 'best_valid_valid/diff': 18.749, 'best_valid_valid/acc_skew': 83.094, 'best_valid_valid/acc_align': 64.345, 'best_valid_test/acc': 81.049, 'best_valid_test/acc_unbiased': 75.028, 'best_valid_test/diff': 15.661, 'best_valid_test/acc_skew': 82.858, 'best_valid_test/acc_align': 67.197}
[3 / 20] best test accuracy: 75.184 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 80.071, 'best_test_valid/acc_unbiased': 72.233, 'best_test_valid/diff': 25.342, 'best_test_valid/acc_skew': 84.801, 'best_test_valid/acc_align': 59.665, 'best_test_test/acc': 81.005, 'best_test_test/acc_unbiased': 75.184, 'best_test_test/diff': 20.169, 'best_test_test/acc_skew': 84.422, 'best_test_test/acc_align': 65.947}
[4 / 20] Learning rate: 0.001 weight: 0.01
[4 / 20] Loss: 4.740087104680194 CE Loss: 0.3891331544920442 Con Loss: 4.736195774872615
[4 / 20] tensor([[0.828, 0.369],
        [0.886, 0.939]]) {'epoch': 4, 'valid/acc': 80.6, 'valid/acc_unbiased': 73.311, 'valid/diff': 25.7, 'valid/acc_skew': 84.641, 'valid/acc_align': 61.981, 'test/acc': 82.283, 'test/acc_unbiased': 75.575, 'test/diff': 25.636, 'test/acc_skew': 85.714, 'test/acc_align': 65.436}
[4 / 20] best valid accuracy: 73.719 at epoch 3 
 best_stats: {'best_valid_epoch': 3, 'best_valid_valid/acc': 80.335, 'best_valid_valid/acc_unbiased': 73.719, 'best_valid_valid/diff': 18.749, 'best_valid_valid/acc_skew': 83.094, 'best_valid_valid/acc_align': 64.345, 'best_valid_test/acc': 81.049, 'best_valid_test/acc_unbiased': 75.028, 'best_valid_test/diff': 15.661, 'best_valid_test/acc_skew': 82.858, 'best_valid_test/acc_align': 67.197}
[4 / 20] best test accuracy: 75.575 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 80.6, 'best_test_valid/acc_unbiased': 73.311, 'best_test_valid/diff': 25.7, 'best_test_valid/acc_skew': 84.641, 'best_test_valid/acc_align': 61.981, 'best_test_test/acc': 82.283, 'best_test_test/acc_unbiased': 75.575, 'best_test_test/diff': 25.636, 'best_test_test/acc_skew': 85.714, 'best_test_test/acc_align': 65.436}
[5 / 20] Learning rate: 0.001 weight: 0.01
[5 / 20] Loss: 4.7213804603447915 CE Loss: 0.3632523436142256 Con Loss: 4.717747928304002
[5 / 20] tensor([[0.962, 0.818],
        [0.666, 0.618]]) {'epoch': 5, 'valid/acc': 80.423, 'valid/acc_unbiased': 75.205, 'valid/diff': 12.119, 'valid/acc_skew': 81.265, 'valid/acc_align': 69.146, 'test/acc': 81.269, 'test/acc_unbiased': 76.604, 'test/diff': 9.572, 'test/acc_skew': 81.391, 'test/acc_align': 71.818}
[5 / 20] best valid accuracy: 75.205 at epoch 5 
 best_stats: {'best_valid_epoch': 5, 'best_valid_valid/acc': 80.423, 'best_valid_valid/acc_unbiased': 75.205, 'best_valid_valid/diff': 12.119, 'best_valid_valid/acc_skew': 81.265, 'best_valid_valid/acc_align': 69.146, 'best_valid_test/acc': 81.269, 'best_valid_test/acc_unbiased': 76.604, 'best_valid_test/diff': 9.572, 'best_valid_test/acc_skew': 81.391, 'best_valid_test/acc_align': 71.818}
[5 / 20] best test accuracy: 76.604 at epoch 5 
 best_stats: {'best_test_epoch': 5, 'best_test_valid/acc': 80.423, 'best_test_valid/acc_unbiased': 75.205, 'best_test_valid/diff': 12.119, 'best_test_valid/acc_skew': 81.265, 'best_test_valid/acc_align': 69.146, 'best_test_test/acc': 81.269, 'best_test_test/acc_unbiased': 76.604, 'best_test_test/diff': 9.572, 'best_test_test/acc_skew': 81.391, 'best_test_test/acc_align': 71.818}
[6 / 20] Learning rate: 0.001 weight: 0.01
[6 / 20] Loss: 4.702534546851533 CE Loss: 0.34416015239773234 Con Loss: 4.699092943257059
[6 / 20] tensor([[0.912, 0.523],
        [0.802, 0.758]]) {'epoch': 6, 'valid/acc': 80.952, 'valid/acc_unbiased': 74.671, 'valid/diff': 24.718, 'valid/acc_skew': 83.418, 'valid/acc_align': 65.925, 'test/acc': 82.856, 'test/acc_unbiased': 74.857, 'test/diff': 21.683, 'test/acc_skew': 85.698, 'test/acc_align': 64.015}
[6 / 20] best valid accuracy: 75.205 at epoch 5 
 best_stats: {'best_valid_epoch': 5, 'best_valid_valid/acc': 80.423, 'best_valid_valid/acc_unbiased': 75.205, 'best_valid_valid/diff': 12.119, 'best_valid_valid/acc_skew': 81.265, 'best_valid_valid/acc_align': 69.146, 'best_valid_test/acc': 81.269, 'best_valid_test/acc_unbiased': 76.604, 'best_valid_test/diff': 9.572, 'best_valid_test/acc_skew': 81.391, 'best_valid_test/acc_align': 71.818}
[6 / 20] best test accuracy: 76.604 at epoch 5 
 best_stats: {'best_test_epoch': 5, 'best_test_valid/acc': 80.423, 'best_test_valid/acc_unbiased': 75.205, 'best_test_valid/diff': 12.119, 'best_test_valid/acc_skew': 81.265, 'best_test_valid/acc_align': 69.146, 'best_test_test/acc': 81.269, 'best_test_test/acc_unbiased': 76.604, 'best_test_test/diff': 9.572, 'best_test_test/acc_skew': 81.391, 'best_test_test/acc_align': 71.818}
[7 / 20] Learning rate: 0.0001 weight: 0.01
[7 / 20] Loss: 4.640831498044982 CE Loss: 0.2883116075776077 Con Loss: 4.637948375253607
[7 / 20] tensor([[0.895, 0.523],
        [0.890, 0.861]]) {'epoch': 7, 'valid/acc': 84.612, 'valid/acc_unbiased': 78.1, 'valid/diff': 24.113, 'valid/acc_skew': 87.834, 'valid/acc_align': 68.365, 'test/acc': 86.205, 'test/acc_unbiased': 79.229, 'test/diff': 20.124, 'test/acc_skew': 89.29, 'test/acc_align': 69.167}
[7 / 20] best valid accuracy: 78.100 at epoch 7 
 best_stats: {'best_valid_epoch': 7, 'best_valid_valid/acc': 84.612, 'best_valid_valid/acc_unbiased': 78.1, 'best_valid_valid/diff': 24.113, 'best_valid_valid/acc_skew': 87.834, 'best_valid_valid/acc_align': 68.365, 'best_valid_test/acc': 86.205, 'best_valid_test/acc_unbiased': 79.229, 'best_valid_test/diff': 20.124, 'best_valid_test/acc_skew': 89.29, 'best_valid_test/acc_align': 69.167}
[7 / 20] best test accuracy: 79.229 at epoch 7 
 best_stats: {'best_test_epoch': 7, 'best_test_valid/acc': 84.612, 'best_test_valid/acc_unbiased': 78.1, 'best_test_valid/diff': 24.113, 'best_test_valid/acc_skew': 87.834, 'best_test_valid/acc_align': 68.365, 'best_test_test/acc': 86.205, 'best_test_test/acc_unbiased': 79.229, 'best_test_test/diff': 20.124, 'best_test_test/acc_skew': 89.29, 'best_test_test/acc_align': 69.167}
[8 / 20] Learning rate: 0.0001 weight: 0.01
[8 / 20] Loss: 4.60239392605108 CE Loss: 0.25656396089081224 Con Loss: 4.599828276021165
[8 / 20] tensor([[0.905, 0.500],
        [0.887, 0.897]]) {'epoch': 8, 'valid/acc': 85.45, 'valid/acc_unbiased': 77.654, 'valid/diff': 27.636, 'valid/acc_skew': 89.259, 'valid/acc_align': 66.048, 'test/acc': 86.602, 'test/acc_unbiased': 79.719, 'test/diff': 20.74, 'test/acc_skew': 89.589, 'test/acc_align': 69.848}
[8 / 20] best valid accuracy: 78.100 at epoch 7 
 best_stats: {'best_valid_epoch': 7, 'best_valid_valid/acc': 84.612, 'best_valid_valid/acc_unbiased': 78.1, 'best_valid_valid/diff': 24.113, 'best_valid_valid/acc_skew': 87.834, 'best_valid_valid/acc_align': 68.365, 'best_valid_test/acc': 86.205, 'best_valid_test/acc_unbiased': 79.229, 'best_valid_test/diff': 20.124, 'best_valid_test/acc_skew': 89.29, 'best_valid_test/acc_align': 69.167}
[8 / 20] best test accuracy: 79.719 at epoch 8 
 best_stats: {'best_test_epoch': 8, 'best_test_valid/acc': 85.45, 'best_test_valid/acc_unbiased': 77.654, 'best_test_valid/diff': 27.636, 'best_test_valid/acc_skew': 89.259, 'best_test_valid/acc_align': 66.048, 'best_test_test/acc': 86.602, 'best_test_test/acc_unbiased': 79.719, 'best_test_test/diff': 20.74, 'best_test_test/acc_skew': 89.589, 'best_test_test/acc_align': 69.848}
[9 / 20] Learning rate: 0.0001 weight: 0.01
[9 / 20] Loss: 4.603070295796285 CE Loss: 0.24396115047767844 Con Loss: 4.600630680594584
[9 / 20] tensor([[0.917, 0.489],
        [0.880, 0.891]]) {'epoch': 9, 'valid/acc': 85.935, 'valid/acc_unbiased': 78.209, 'valid/diff': 26.895, 'valid/acc_skew': 89.582, 'valid/acc_align': 66.835, 'test/acc': 86.778, 'test/acc_unbiased': 79.416, 'test/diff': 21.964, 'test/acc_skew': 89.855, 'test/acc_align': 68.977}
[9 / 20] best valid accuracy: 78.209 at epoch 9 
 best_stats: {'best_valid_epoch': 9, 'best_valid_valid/acc': 85.935, 'best_valid_valid/acc_unbiased': 78.209, 'best_valid_valid/diff': 26.895, 'best_valid_valid/acc_skew': 89.582, 'best_valid_valid/acc_align': 66.835, 'best_valid_test/acc': 86.778, 'best_valid_test/acc_unbiased': 79.416, 'best_valid_test/diff': 21.964, 'best_valid_test/acc_skew': 89.855, 'best_valid_test/acc_align': 68.977}
[9 / 20] best test accuracy: 79.719 at epoch 8 
 best_stats: {'best_test_epoch': 8, 'best_test_valid/acc': 85.45, 'best_test_valid/acc_unbiased': 77.654, 'best_test_valid/diff': 27.636, 'best_test_valid/acc_skew': 89.259, 'best_test_valid/acc_align': 66.048, 'best_test_test/acc': 86.602, 'best_test_test/acc_unbiased': 79.719, 'best_test_test/diff': 20.74, 'best_test_test/acc_skew': 89.589, 'best_test_test/acc_align': 69.848}
[10 / 20] Learning rate: 0.0001 weight: 0.01
[10 / 20] Loss: 4.583267040792217 CE Loss: 0.23482355280771727 Con Loss: 4.58091879278852
[10 / 20] tensor([[0.915, 0.500],
        [0.886, 0.891]]) {'epoch': 10, 'valid/acc': 85.229, 'valid/acc_unbiased': 77.299, 'valid/diff': 27.248, 'valid/acc_skew': 89.037, 'valid/acc_align': 65.562, 'test/acc': 86.999, 'test/acc_unbiased': 79.797, 'test/diff': 21.014, 'test/acc_skew': 90.049, 'test/acc_align': 69.545}
[10 / 20] best valid accuracy: 78.209 at epoch 9 
 best_stats: {'best_valid_epoch': 9, 'best_valid_valid/acc': 85.935, 'best_valid_valid/acc_unbiased': 78.209, 'best_valid_valid/diff': 26.895, 'best_valid_valid/acc_skew': 89.582, 'best_valid_valid/acc_align': 66.835, 'best_valid_test/acc': 86.778, 'best_valid_test/acc_unbiased': 79.416, 'best_valid_test/diff': 21.964, 'best_valid_test/acc_skew': 89.855, 'best_valid_test/acc_align': 68.977}
[10 / 20] best test accuracy: 79.797 at epoch 10 
 best_stats: {'best_test_epoch': 10, 'best_test_valid/acc': 85.229, 'best_test_valid/acc_unbiased': 77.299, 'best_test_valid/diff': 27.248, 'best_test_valid/acc_skew': 89.037, 'best_test_valid/acc_align': 65.562, 'best_test_test/acc': 86.999, 'best_test_test/acc_unbiased': 79.797, 'best_test_test/diff': 21.014, 'best_test_test/acc_skew': 90.049, 'best_test_test/acc_align': 69.545}
[11 / 20] Learning rate: 0.0001 weight: 0.01
[11 / 20] Loss: 4.569708508022263 CE Loss: 0.2311695498308395 Con Loss: 4.567396823187917
[11 / 20] tensor([[0.919, 0.500],
        [0.874, 0.897]]) {'epoch': 11, 'valid/acc': 85.538, 'valid/acc_unbiased': 78.523, 'valid/diff': 27.257, 'valid/acc_skew': 88.69, 'valid/acc_align': 68.356, 'test/acc': 86.778, 'test/acc_unbiased': 79.755, 'test/diff': 22.082, 'test/acc_skew': 89.661, 'test/acc_align': 69.848}
[11 / 20] best valid accuracy: 78.523 at epoch 11 
 best_stats: {'best_valid_epoch': 11, 'best_valid_valid/acc': 85.538, 'best_valid_valid/acc_unbiased': 78.523, 'best_valid_valid/diff': 27.257, 'best_valid_valid/acc_skew': 88.69, 'best_valid_valid/acc_align': 68.356, 'best_valid_test/acc': 86.778, 'best_valid_test/acc_unbiased': 79.755, 'best_valid_test/diff': 22.082, 'best_valid_test/acc_skew': 89.661, 'best_valid_test/acc_align': 69.848}
[11 / 20] best test accuracy: 79.797 at epoch 10 
 best_stats: {'best_test_epoch': 10, 'best_test_valid/acc': 85.229, 'best_test_valid/acc_unbiased': 77.299, 'best_test_valid/diff': 27.248, 'best_test_valid/acc_skew': 89.037, 'best_test_valid/acc_align': 65.562, 'best_test_test/acc': 86.999, 'best_test_test/acc_unbiased': 79.797, 'best_test_test/diff': 21.014, 'best_test_test/acc_skew': 90.049, 'best_test_test/acc_align': 69.545}
[12 / 20] Learning rate: 0.0001 weight: 0.01
[12 / 20] Loss: 4.564294034710812 CE Loss: 0.2198499397005982 Con Loss: 4.562095532504711
[12 / 20] tensor([[0.909, 0.500],
        [0.886, 0.909]]) {'epoch': 12, 'valid/acc': 85.538, 'valid/acc_unbiased': 77.918, 'valid/diff': 25.72, 'valid/acc_skew': 89.248, 'valid/acc_align': 66.588, 'test/acc': 86.822, 'test/acc_unbiased': 80.087, 'test/diff': 21.593, 'test/acc_skew': 89.719, 'test/acc_align': 70.455}
[12 / 20] best valid accuracy: 78.523 at epoch 11 
 best_stats: {'best_valid_epoch': 11, 'best_valid_valid/acc': 85.538, 'best_valid_valid/acc_unbiased': 78.523, 'best_valid_valid/diff': 27.257, 'best_valid_valid/acc_skew': 88.69, 'best_valid_valid/acc_align': 68.356, 'best_valid_test/acc': 86.778, 'best_valid_test/acc_unbiased': 79.755, 'best_valid_test/diff': 22.082, 'best_valid_test/acc_skew': 89.661, 'best_valid_test/acc_align': 69.848}
[12 / 20] best test accuracy: 80.087 at epoch 12 
 best_stats: {'best_test_epoch': 12, 'best_test_valid/acc': 85.538, 'best_test_valid/acc_unbiased': 77.918, 'best_test_valid/diff': 25.72, 'best_test_valid/acc_skew': 89.248, 'best_test_valid/acc_align': 66.588, 'best_test_test/acc': 86.822, 'best_test_test/acc_unbiased': 80.087, 'best_test_test/diff': 21.593, 'best_test_test/acc_skew': 89.719, 'best_test_test/acc_align': 70.455}
[13 / 20] Learning rate: 0.0001 weight: 0.01
[13 / 20] Loss: 4.562912490655312 CE Loss: 0.21962556600230576 Con Loss: 4.560716245798748
[13 / 20] tensor([[0.910, 0.403],
        [0.901, 0.927]]) {'epoch': 13, 'valid/acc': 85.847, 'valid/acc_unbiased': 77.653, 'valid/diff': 30.987, 'valid/acc_skew': 89.814, 'valid/acc_align': 65.491, 'test/acc': 86.822, 'test/acc_unbiased': 78.525, 'test/diff': 26.629, 'test/acc_skew': 90.516, 'test/acc_align': 66.534}
[13 / 20] best valid accuracy: 78.523 at epoch 11 
 best_stats: {'best_valid_epoch': 11, 'best_valid_valid/acc': 85.538, 'best_valid_valid/acc_unbiased': 78.523, 'best_valid_valid/diff': 27.257, 'best_valid_valid/acc_skew': 88.69, 'best_valid_valid/acc_align': 68.356, 'best_valid_test/acc': 86.778, 'best_valid_test/acc_unbiased': 79.755, 'best_valid_test/diff': 22.082, 'best_valid_test/acc_skew': 89.661, 'best_valid_test/acc_align': 69.848}
[13 / 20] best test accuracy: 80.087 at epoch 12 
 best_stats: {'best_test_epoch': 12, 'best_test_valid/acc': 85.538, 'best_test_valid/acc_unbiased': 77.918, 'best_test_valid/diff': 25.72, 'best_test_valid/acc_skew': 89.248, 'best_test_valid/acc_align': 66.588, 'best_test_test/acc': 86.822, 'best_test_test/acc_unbiased': 80.087, 'best_test_test/diff': 21.593, 'best_test_test/acc_skew': 89.719, 'best_test_test/acc_align': 70.455}
[14 / 20] Learning rate: 1e-05 weight: 0.01
[14 / 20] Loss: 4.5505752505008 CE Loss: 0.2085042347516686 Con Loss: 4.548490197331173
[14 / 20] tensor([[0.921, 0.477],
        [0.884, 0.903]]) {'epoch': 14, 'valid/acc': 85.979, 'valid/acc_unbiased': 78.472, 'valid/diff': 29.125, 'valid/acc_skew': 89.375, 'valid/acc_align': 67.569, 'test/acc': 87.087, 'test/acc_unbiased': 79.616, 'test/diff': 23.154, 'test/acc_skew': 90.217, 'test/acc_align': 69.015}
[14 / 20] best valid accuracy: 78.523 at epoch 11 
 best_stats: {'best_valid_epoch': 11, 'best_valid_valid/acc': 85.538, 'best_valid_valid/acc_unbiased': 78.523, 'best_valid_valid/diff': 27.257, 'best_valid_valid/acc_skew': 88.69, 'best_valid_valid/acc_align': 68.356, 'best_valid_test/acc': 86.778, 'best_valid_test/acc_unbiased': 79.755, 'best_valid_test/diff': 22.082, 'best_valid_test/acc_skew': 89.661, 'best_valid_test/acc_align': 69.848}
[14 / 20] best test accuracy: 80.087 at epoch 12 
 best_stats: {'best_test_epoch': 12, 'best_test_valid/acc': 85.538, 'best_test_valid/acc_unbiased': 77.918, 'best_test_valid/diff': 25.72, 'best_test_valid/acc_skew': 89.248, 'best_test_valid/acc_align': 66.588, 'best_test_test/acc': 86.822, 'best_test_test/acc_unbiased': 80.087, 'best_test_test/diff': 21.593, 'best_test_test/acc_skew': 89.719, 'best_test_test/acc_align': 70.455}
[15 / 20] Learning rate: 1e-05 weight: 0.01
[15 / 20] Loss: 4.554074850854645 CE Loss: 0.20994423254030892 Con Loss: 4.5519754104248396
[15 / 20] tensor([[0.923, 0.494],
        [0.882, 0.909]]) {'epoch': 15, 'valid/acc': 86.023, 'valid/acc_unbiased': 78.585, 'valid/diff': 29.588, 'valid/acc_skew': 89.354, 'valid/acc_align': 67.817, 'test/acc': 87.307, 'test/acc_unbiased': 80.212, 'test/diff': 22.757, 'test/acc_skew': 90.253, 'test/acc_align': 70.17}
[15 / 20] best valid accuracy: 78.585 at epoch 15 
 best_stats: {'best_valid_epoch': 15, 'best_valid_valid/acc': 86.023, 'best_valid_valid/acc_unbiased': 78.585, 'best_valid_valid/diff': 29.588, 'best_valid_valid/acc_skew': 89.354, 'best_valid_valid/acc_align': 67.817, 'best_valid_test/acc': 87.307, 'best_valid_test/acc_unbiased': 80.212, 'best_valid_test/diff': 22.757, 'best_valid_test/acc_skew': 90.253, 'best_valid_test/acc_align': 70.17}
[15 / 20] best test accuracy: 80.212 at epoch 15 
 best_stats: {'best_test_epoch': 15, 'best_test_valid/acc': 86.023, 'best_test_valid/acc_unbiased': 78.585, 'best_test_valid/diff': 29.588, 'best_test_valid/acc_skew': 89.354, 'best_test_valid/acc_align': 67.817, 'best_test_test/acc': 87.307, 'best_test_test/acc_unbiased': 80.212, 'best_test_test/diff': 22.757, 'best_test_test/acc_skew': 90.253, 'best_test_test/acc_align': 70.17}
[16 / 20] Learning rate: 1e-05 weight: 0.01
[16 / 20] Loss: 4.545359842954105 CE Loss: 0.20670236792034122 Con Loss: 4.54329281830449
[16 / 20] tensor([[0.917, 0.460],
        [0.895, 0.921]]) {'epoch': 16, 'valid/acc': 85.802, 'valid/acc_unbiased': 78.081, 'valid/diff': 29.917, 'valid/acc_skew': 89.37, 'valid/acc_align': 66.791, 'test/acc': 87.351, 'test/acc_unbiased': 79.838, 'test/diff': 24.15, 'test/acc_skew': 90.605, 'test/acc_align': 69.072}
[16 / 20] best valid accuracy: 78.585 at epoch 15 
 best_stats: {'best_valid_epoch': 15, 'best_valid_valid/acc': 86.023, 'best_valid_valid/acc_unbiased': 78.585, 'best_valid_valid/diff': 29.588, 'best_valid_valid/acc_skew': 89.354, 'best_valid_valid/acc_align': 67.817, 'best_valid_test/acc': 87.307, 'best_valid_test/acc_unbiased': 80.212, 'best_valid_test/diff': 22.757, 'best_valid_test/acc_skew': 90.253, 'best_valid_test/acc_align': 70.17}
[16 / 20] best test accuracy: 80.212 at epoch 15 
 best_stats: {'best_test_epoch': 15, 'best_test_valid/acc': 86.023, 'best_test_valid/acc_unbiased': 78.585, 'best_test_valid/diff': 29.588, 'best_test_valid/acc_skew': 89.354, 'best_test_valid/acc_align': 67.817, 'best_test_test/acc': 87.307, 'best_test_test/acc_unbiased': 80.212, 'best_test_test/diff': 22.757, 'best_test_test/acc_skew': 90.253, 'best_test_test/acc_align': 70.17}
[17 / 20] Learning rate: 1e-05 weight: 0.01
[17 / 20] Loss: 4.538104997613816 CE Loss: 0.2062299103358858 Con Loss: 4.536042704575847
[17 / 20] tensor([[0.920, 0.466],
        [0.890, 0.921]]) {'epoch': 17, 'valid/acc': 85.67, 'valid/acc_unbiased': 77.893, 'valid/diff': 30.293, 'valid/acc_skew': 89.252, 'valid/acc_align': 66.535, 'test/acc': 87.351, 'test/acc_unbiased': 79.936, 'test/diff': 24.238, 'test/acc_skew': 90.516, 'test/acc_align': 69.356}
[17 / 20] best valid accuracy: 78.585 at epoch 15 
 best_stats: {'best_valid_epoch': 15, 'best_valid_valid/acc': 86.023, 'best_valid_valid/acc_unbiased': 78.585, 'best_valid_valid/diff': 29.588, 'best_valid_valid/acc_skew': 89.354, 'best_valid_valid/acc_align': 67.817, 'best_valid_test/acc': 87.307, 'best_valid_test/acc_unbiased': 80.212, 'best_valid_test/diff': 22.757, 'best_valid_test/acc_skew': 90.253, 'best_valid_test/acc_align': 70.17}
[17 / 20] best test accuracy: 80.212 at epoch 15 
 best_stats: {'best_test_epoch': 15, 'best_test_valid/acc': 86.023, 'best_test_valid/acc_unbiased': 78.585, 'best_test_valid/diff': 29.588, 'best_test_valid/acc_skew': 89.354, 'best_test_valid/acc_align': 67.817, 'best_test_test/acc': 87.307, 'best_test_test/acc_unbiased': 80.212, 'best_test_test/diff': 22.757, 'best_test_test/acc_skew': 90.253, 'best_test_test/acc_align': 70.17}
[18 / 20] Learning rate: 1e-05 weight: 0.01
[18 / 20] Loss: 4.542181092876246 CE Loss: 0.20522220040736766 Con Loss: 4.540128858861984
[18 / 20] tensor([[0.921, 0.483],
        [0.884, 0.915]]) {'epoch': 18, 'valid/acc': 85.406, 'valid/acc_unbiased': 77.997, 'valid/diff': 29.483, 'valid/acc_skew': 88.673, 'valid/acc_align': 67.322, 'test/acc': 87.219, 'test/acc_unbiased': 80.061, 'test/diff': 23.476, 'test/acc_skew': 90.217, 'test/acc_align': 69.905}
[18 / 20] best valid accuracy: 78.585 at epoch 15 
 best_stats: {'best_valid_epoch': 15, 'best_valid_valid/acc': 86.023, 'best_valid_valid/acc_unbiased': 78.585, 'best_valid_valid/diff': 29.588, 'best_valid_valid/acc_skew': 89.354, 'best_valid_valid/acc_align': 67.817, 'best_valid_test/acc': 87.307, 'best_valid_test/acc_unbiased': 80.212, 'best_valid_test/diff': 22.757, 'best_valid_test/acc_skew': 90.253, 'best_valid_test/acc_align': 70.17}
[18 / 20] best test accuracy: 80.212 at epoch 15 
 best_stats: {'best_test_epoch': 15, 'best_test_valid/acc': 86.023, 'best_test_valid/acc_unbiased': 78.585, 'best_test_valid/diff': 29.588, 'best_test_valid/acc_skew': 89.354, 'best_test_valid/acc_align': 67.817, 'best_test_test/acc': 87.307, 'best_test_test/acc_unbiased': 80.212, 'best_test_test/diff': 22.757, 'best_test_test/acc_skew': 90.253, 'best_test_test/acc_align': 70.17}
[19 / 20] Learning rate: 1e-05 weight: 0.01
[19 / 20] Loss: 4.541183299978946 CE Loss: 0.20279019353559646 Con Loss: 4.539155399247948
[19 / 20] tensor([[0.918, 0.466],
        [0.888, 0.933]]) {'epoch': 19, 'valid/acc': 85.802, 'valid/acc_unbiased': 78.167, 'valid/diff': 29.541, 'valid/acc_skew': 89.278, 'valid/acc_align': 67.056, 'test/acc': 87.263, 'test/acc_unbiased': 80.134, 'test/diff': 24.865, 'test/acc_skew': 90.306, 'test/acc_align': 69.962}
[19 / 20] best valid accuracy: 78.585 at epoch 15 
 best_stats: {'best_valid_epoch': 15, 'best_valid_valid/acc': 86.023, 'best_valid_valid/acc_unbiased': 78.585, 'best_valid_valid/diff': 29.588, 'best_valid_valid/acc_skew': 89.354, 'best_valid_valid/acc_align': 67.817, 'best_valid_test/acc': 87.307, 'best_valid_test/acc_unbiased': 80.212, 'best_valid_test/diff': 22.757, 'best_valid_test/acc_skew': 90.253, 'best_valid_test/acc_align': 70.17}
[19 / 20] best test accuracy: 80.212 at epoch 15 
 best_stats: {'best_test_epoch': 15, 'best_test_valid/acc': 86.023, 'best_test_valid/acc_unbiased': 78.585, 'best_test_valid/diff': 29.588, 'best_test_valid/acc_skew': 89.354, 'best_test_valid/acc_align': 67.817, 'best_test_test/acc': 87.307, 'best_test_test/acc_unbiased': 80.212, 'best_test_test/diff': 22.757, 'best_test_test/acc_skew': 90.253, 'best_test_test/acc_align': 70.17}
[20 / 20] Learning rate: 1e-05 weight: 0.01
[20 / 20] Loss: 4.544174614788563 CE Loss: 0.20201375559686935 Con Loss: 4.542154473530171
[20 / 20] tensor([[0.920, 0.477],
        [0.886, 0.915]]) {'epoch': 20, 'valid/acc': 85.891, 'valid/acc_unbiased': 78.714, 'valid/diff': 28.545, 'valid/acc_skew': 89.089, 'valid/acc_align': 68.338, 'test/acc': 87.219, 'test/acc_unbiased': 79.953, 'test/diff': 23.598, 'test/acc_skew': 90.285, 'test/acc_align': 69.621}
[20 / 20] best valid accuracy: 78.714 at epoch 20 
 best_stats: {'best_valid_epoch': 20, 'best_valid_valid/acc': 85.891, 'best_valid_valid/acc_unbiased': 78.714, 'best_valid_valid/diff': 28.545, 'best_valid_valid/acc_skew': 89.089, 'best_valid_valid/acc_align': 68.338, 'best_valid_test/acc': 87.219, 'best_valid_test/acc_unbiased': 79.953, 'best_valid_test/diff': 23.598, 'best_valid_test/acc_skew': 90.285, 'best_valid_test/acc_align': 69.621}
[20 / 20] best test accuracy: 80.212 at epoch 15 
 best_stats: {'best_test_epoch': 15, 'best_test_valid/acc': 86.023, 'best_test_valid/acc_unbiased': 78.585, 'best_test_valid/diff': 29.588, 'best_test_valid/acc_skew': 89.354, 'best_test_valid/acc_align': 67.817, 'best_test_test/acc': 87.307, 'best_test_test/acc_unbiased': 80.212, 'best_test_test/diff': 22.757, 'best_test_test/acc_skew': 90.253, 'best_test_test/acc_align': 70.17}
Total training time: 1:34:31
