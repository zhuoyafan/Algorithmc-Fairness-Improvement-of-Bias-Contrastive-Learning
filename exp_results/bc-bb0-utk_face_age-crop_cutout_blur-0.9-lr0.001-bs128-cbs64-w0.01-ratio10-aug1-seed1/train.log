Log level set to: INFO
Set seed: 1
=======> Using Fixed Random Seed: 1 <========
save_path: exp_results/bc-bb0-utk_face_age-crop_cutout_blur-0.9-lr0.001-bs128-cbs64-w0.01-ratio10-aug1-seed1
get_utk_face - split: train, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_age-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
Binary Target 1
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Normal Label Distribution: 
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
Binary Target 1
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Normal Label Distribution: 
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 10684, target_attr: gender, bias_attr: age bias_rate: 0.9
['[train] target_0-bias_0: 8237', '[train] target_0-bias_1: 147', '[train] target_1-bias_0: 823', '[train] target_1-bias_1: 1477']
confusion_matrix - 
 original: tensor([[8237.,  823.],
        [ 147., 1477.]]), 
 normalized: tensor([[0.909, 0.091],
        [0.091, 0.909]]), 
 b|y: tensor([[0.982, 0.018],
        [0.358, 0.642]])
get_utk_face - split: train, aug: 1, given_y: True, ratio: 10
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_age-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
Binary Target 1
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Normal Label Distribution: 
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
Binary Target 1
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Normal Label Distribution: 
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 10684, target_attr: gender, bias_attr: age bias_rate: 0.9
['[train] target_0-bias_0: 8237', '[train] target_0-bias_1: 147', '[train] target_1-bias_0: 823', '[train] target_1-bias_1: 1477']
get_utk_face - split: valid, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_age-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [1030, 195]
Target 1: [841, 202]
Binary Target 1
---------------------------
Target 0: [1030, 195]
Target 1: [841, 202]
===================================
Normal Label Distribution: 
Target 0: [1030, 195]
Target 1: [841, 202]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 2268, target_attr: gender, bias_attr: age bias_rate: 0.9
['[valid] target_0-bias_0: 1030', '[valid] target_0-bias_1: 195', '[valid] target_1-bias_0: 841', '[valid] target_1-bias_1: 202']
get_utk_face - split: test, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_age-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [1061, 176]
Target 1: [867, 165]
Binary Target 1
---------------------------
Target 0: [1061, 176]
Target 1: [867, 165]
===================================
Normal Label Distribution: 
Target 0: [1061, 176]
Target 1: [867, 165]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 2269, target_attr: gender, bias_attr: age bias_rate: 0.9
['[test] target_0-bias_0: 1061', '[test] target_0-bias_1: 176', '[test] target_1-bias_0: 867', '[test] target_1-bias_1: 165']
decay_epochs: [6, 13]
[1 / 20] Learning rate: 0.001 weight: 0.01
[1 / 20] Loss: 4.835798629702186 CE Loss: 0.565111003869127 Con Loss: 4.830147514000496
[1 / 20] tensor([[0.999, 0.994],
        [0.010, 0.024]]) {'epoch': 1, 'valid/acc': 54.233, 'valid/acc_unbiased': 50.248, 'valid/diff': 0.098, 'valid/acc_skew': 50.297, 'valid/acc_align': 50.199, 'test/acc': 55.002, 'test/acc_unbiased': 50.7, 'test/diff': 0.93, 'test/acc_skew': 50.235, 'test/acc_align': 51.165}
[1 / 20] best valid accuracy: 50.248 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 54.233, 'best_valid_valid/acc_unbiased': 50.248, 'best_valid_valid/diff': 0.098, 'best_valid_valid/acc_skew': 50.297, 'best_valid_valid/acc_align': 50.199, 'best_valid_test/acc': 55.002, 'best_valid_test/acc_unbiased': 50.7, 'best_valid_test/diff': 0.93, 'best_valid_test/acc_skew': 50.235, 'best_valid_test/acc_align': 51.165}
[1 / 20] best test accuracy: 50.700 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 54.233, 'best_test_valid/acc_unbiased': 50.248, 'best_test_valid/diff': 0.098, 'best_test_valid/acc_skew': 50.297, 'best_test_valid/acc_align': 50.199, 'best_test_test/acc': 55.002, 'best_test_test/acc_unbiased': 50.7, 'best_test_test/diff': 0.93, 'best_test_test/acc_skew': 50.235, 'best_test_test/acc_align': 51.165}
[2 / 20] Learning rate: 0.001 weight: 0.01
[2 / 20] Loss: 4.672523717762424 CE Loss: 0.5175660993891323 Con Loss: 4.667348049053848
[2 / 20] tensor([[0.910, 0.972],
        [0.419, 0.145]]) {'epoch': 2, 'valid/acc': 65.168, 'valid/acc_unbiased': 59.924, 'valid/diff': 11.26, 'valid/acc_skew': 65.554, 'valid/acc_align': 54.294, 'test/acc': 67.166, 'test/acc_unbiased': 61.155, 'test/diff': 16.718, 'test/acc_skew': 69.514, 'test/acc_align': 52.796}
[2 / 20] best valid accuracy: 59.924 at epoch 2 
 best_stats: {'best_valid_epoch': 2, 'best_valid_valid/acc': 65.168, 'best_valid_valid/acc_unbiased': 59.924, 'best_valid_valid/diff': 11.26, 'best_valid_valid/acc_skew': 65.554, 'best_valid_valid/acc_align': 54.294, 'best_valid_test/acc': 67.166, 'best_valid_test/acc_unbiased': 61.155, 'best_valid_test/diff': 16.718, 'best_valid_test/acc_skew': 69.514, 'best_valid_test/acc_align': 52.796}
[2 / 20] best test accuracy: 61.155 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 65.168, 'best_test_valid/acc_unbiased': 59.924, 'best_test_valid/diff': 11.26, 'best_test_valid/acc_skew': 65.554, 'best_test_valid/acc_align': 54.294, 'best_test_test/acc': 67.166, 'best_test_test/acc_unbiased': 61.155, 'best_test_test/diff': 16.718, 'best_test_test/acc_skew': 69.514, 'best_test_test/acc_align': 52.796}
[3 / 20] Learning rate: 0.001 weight: 0.01
[3 / 20] Loss: 4.580541380243505 CE Loss: 0.49392020229273903 Con Loss: 4.575602170993487
[3 / 20] tensor([[0.960, 0.932],
        [0.277, 0.224]]) {'epoch': 3, 'valid/acc': 64.815, 'valid/acc_unbiased': 61.122, 'valid/diff': 3.256, 'valid/acc_skew': 59.494, 'valid/acc_align': 62.75, 'test/acc': 64.346, 'test/acc_unbiased': 59.832, 'test/diff': 4.059, 'test/acc_skew': 60.432, 'test/acc_align': 59.233}
[3 / 20] best valid accuracy: 61.122 at epoch 3 
 best_stats: {'best_valid_epoch': 3, 'best_valid_valid/acc': 64.815, 'best_valid_valid/acc_unbiased': 61.122, 'best_valid_valid/diff': 3.256, 'best_valid_valid/acc_skew': 59.494, 'best_valid_valid/acc_align': 62.75, 'best_valid_test/acc': 64.346, 'best_valid_test/acc_unbiased': 59.832, 'best_valid_test/diff': 4.059, 'best_valid_test/acc_skew': 60.432, 'best_valid_test/acc_align': 59.233}
[3 / 20] best test accuracy: 61.155 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 65.168, 'best_test_valid/acc_unbiased': 59.924, 'best_test_valid/diff': 11.26, 'best_test_valid/acc_skew': 65.554, 'best_test_valid/acc_align': 54.294, 'best_test_test/acc': 67.166, 'best_test_test/acc_unbiased': 61.155, 'best_test_test/diff': 16.718, 'best_test_test/acc_skew': 69.514, 'best_test_test/acc_align': 52.796}
[4 / 20] Learning rate: 0.001 weight: 0.01
[4 / 20] Loss: 4.614645805487424 CE Loss: 0.4927964235280436 Con Loss: 4.60971782502946
[4 / 20] tensor([[1.000, 1.000],
        [0.001, 0.006]]) {'epoch': 4, 'valid/acc': 54.101, 'valid/acc_unbiased': 50.145, 'valid/diff': 1.196, 'valid/acc_skew': 49.547, 'valid/acc_align': 50.743, 'test/acc': 54.606, 'test/acc_unbiased': 50.18, 'test/diff': 0.245, 'test/acc_skew': 50.058, 'test/acc_align': 50.303}
[4 / 20] best valid accuracy: 61.122 at epoch 3 
 best_stats: {'best_valid_epoch': 3, 'best_valid_valid/acc': 64.815, 'best_valid_valid/acc_unbiased': 61.122, 'best_valid_valid/diff': 3.256, 'best_valid_valid/acc_skew': 59.494, 'best_valid_valid/acc_align': 62.75, 'best_valid_test/acc': 64.346, 'best_valid_test/acc_unbiased': 59.832, 'best_valid_test/diff': 4.059, 'best_valid_test/acc_skew': 60.432, 'best_valid_test/acc_align': 59.233}
[4 / 20] best test accuracy: 61.155 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 65.168, 'best_test_valid/acc_unbiased': 59.924, 'best_test_valid/diff': 11.26, 'best_test_valid/acc_skew': 65.554, 'best_test_valid/acc_align': 54.294, 'best_test_test/acc': 67.166, 'best_test_test/acc_unbiased': 61.155, 'best_test_test/diff': 16.718, 'best_test_test/acc_skew': 69.514, 'best_test_test/acc_align': 52.796}
[5 / 20] Learning rate: 0.001 weight: 0.01
[5 / 20] Loss: 4.5880417302501915 CE Loss: 0.4626444452088319 Con Loss: 4.583415297433617
[5 / 20] tensor([[0.902, 0.841],
        [0.558, 0.309]]) {'epoch': 5, 'valid/acc': 70.547, 'valid/acc_unbiased': 66.043, 'valid/diff': 9.424, 'valid/acc_skew': 67.62, 'valid/acc_align': 64.467, 'test/acc': 72.279, 'test/acc_unbiased': 65.256, 'test/diff': 15.511, 'test/acc_skew': 69.958, 'test/acc_align': 60.554}
[5 / 20] best valid accuracy: 66.043 at epoch 5 
 best_stats: {'best_valid_epoch': 5, 'best_valid_valid/acc': 70.547, 'best_valid_valid/acc_unbiased': 66.043, 'best_valid_valid/diff': 9.424, 'best_valid_valid/acc_skew': 67.62, 'best_valid_valid/acc_align': 64.467, 'best_valid_test/acc': 72.279, 'best_valid_test/acc_unbiased': 65.256, 'best_valid_test/diff': 15.511, 'best_valid_test/acc_skew': 69.958, 'best_valid_test/acc_align': 60.554}
[5 / 20] best test accuracy: 65.256 at epoch 5 
 best_stats: {'best_test_epoch': 5, 'best_test_valid/acc': 70.547, 'best_test_valid/acc_unbiased': 66.043, 'best_test_valid/diff': 9.424, 'best_test_valid/acc_skew': 67.62, 'best_test_valid/acc_align': 64.467, 'best_test_test/acc': 72.279, 'best_test_test/acc_unbiased': 65.256, 'best_test_test/diff': 15.511, 'best_test_test/acc_skew': 69.958, 'best_test_test/acc_align': 60.554}
[6 / 20] Learning rate: 0.001 weight: 0.01
[6 / 20] Loss: 4.512687902154212 CE Loss: 0.45263136355942085 Con Loss: 4.508161568721999
[6 / 20] tensor([[0.970, 0.943],
        [0.408, 0.188]]) {'epoch': 6, 'valid/acc': 68.342, 'valid/acc_unbiased': 61.774, 'valid/diff': 13.384, 'valid/acc_skew': 66.881, 'valid/acc_align': 56.668, 'test/acc': 69.634, 'test/acc_unbiased': 62.73, 'test/diff': 12.354, 'test/acc_skew': 67.574, 'test/acc_align': 57.886}
[6 / 20] best valid accuracy: 66.043 at epoch 5 
 best_stats: {'best_valid_epoch': 5, 'best_valid_valid/acc': 70.547, 'best_valid_valid/acc_unbiased': 66.043, 'best_valid_valid/diff': 9.424, 'best_valid_valid/acc_skew': 67.62, 'best_valid_valid/acc_align': 64.467, 'best_valid_test/acc': 72.279, 'best_valid_test/acc_unbiased': 65.256, 'best_valid_test/diff': 15.511, 'best_valid_test/acc_skew': 69.958, 'best_valid_test/acc_align': 60.554}
[6 / 20] best test accuracy: 65.256 at epoch 5 
 best_stats: {'best_test_epoch': 5, 'best_test_valid/acc': 70.547, 'best_test_valid/acc_unbiased': 66.043, 'best_test_valid/diff': 9.424, 'best_test_valid/acc_skew': 67.62, 'best_test_valid/acc_align': 64.467, 'best_test_test/acc': 72.279, 'best_test_test/acc_unbiased': 65.256, 'best_test_test/diff': 15.511, 'best_test_test/acc_skew': 69.958, 'best_test_test/acc_align': 60.554}
[7 / 20] Learning rate: 0.0001 weight: 0.01
[7 / 20] Loss: 4.554312466771716 CE Loss: 0.44382104287652746 Con Loss: 4.549874261808235
[7 / 20] tensor([[0.946, 0.830],
        [0.572, 0.442]]) {'epoch': 7, 'valid/acc': 74.647, 'valid/acc_unbiased': 68.915, 'valid/diff': 12.727, 'valid/acc_skew': 68.474, 'valid/acc_align': 69.355, 'test/acc': 75.76, 'test/acc_unbiased': 69.758, 'test/diff': 12.32, 'test/acc_skew': 70.082, 'test/acc_align': 69.435}
[7 / 20] best valid accuracy: 68.915 at epoch 7 
 best_stats: {'best_valid_epoch': 7, 'best_valid_valid/acc': 74.647, 'best_valid_valid/acc_unbiased': 68.915, 'best_valid_valid/diff': 12.727, 'best_valid_valid/acc_skew': 68.474, 'best_valid_valid/acc_align': 69.355, 'best_valid_test/acc': 75.76, 'best_valid_test/acc_unbiased': 69.758, 'best_valid_test/diff': 12.32, 'best_valid_test/acc_skew': 70.082, 'best_valid_test/acc_align': 69.435}
[7 / 20] best test accuracy: 69.758 at epoch 7 
 best_stats: {'best_test_epoch': 7, 'best_test_valid/acc': 74.647, 'best_test_valid/acc_unbiased': 68.915, 'best_test_valid/diff': 12.727, 'best_test_valid/acc_skew': 68.474, 'best_test_valid/acc_align': 69.355, 'best_test_test/acc': 75.76, 'best_test_test/acc_unbiased': 69.758, 'best_test_test/diff': 12.32, 'best_test_test/acc_skew': 70.082, 'best_test_test/acc_align': 69.435}
[8 / 20] Learning rate: 0.0001 weight: 0.01
[8 / 20] Loss: 4.483784665422286 CE Loss: 0.42923197575340283 Con Loss: 4.479492311931112
[8 / 20] tensor([[0.962, 0.864],
        [0.557, 0.442]]) {'epoch': 8, 'valid/acc': 74.162, 'valid/acc_unbiased': 68.883, 'valid/diff': 10.613, 'valid/acc_skew': 67.538, 'valid/acc_align': 70.229, 'test/acc': 76.201, 'test/acc_unbiased': 70.636, 'test/diff': 10.667, 'test/acc_skew': 71.036, 'test/acc_align': 70.236}
[8 / 20] best valid accuracy: 68.915 at epoch 7 
 best_stats: {'best_valid_epoch': 7, 'best_valid_valid/acc': 74.647, 'best_valid_valid/acc_unbiased': 68.915, 'best_valid_valid/diff': 12.727, 'best_valid_valid/acc_skew': 68.474, 'best_valid_valid/acc_align': 69.355, 'best_valid_test/acc': 75.76, 'best_valid_test/acc_unbiased': 69.758, 'best_valid_test/diff': 12.32, 'best_valid_test/acc_skew': 70.082, 'best_valid_test/acc_align': 69.435}
[8 / 20] best test accuracy: 70.636 at epoch 8 
 best_stats: {'best_test_epoch': 8, 'best_test_valid/acc': 74.162, 'best_test_valid/acc_unbiased': 68.883, 'best_test_valid/diff': 10.613, 'best_test_valid/acc_skew': 67.538, 'best_test_valid/acc_align': 70.229, 'best_test_test/acc': 76.201, 'best_test_test/acc_unbiased': 70.636, 'best_test_test/diff': 10.667, 'best_test_test/acc_skew': 71.036, 'best_test_test/acc_align': 70.236}
[9 / 20] Learning rate: 0.0001 weight: 0.01
[9 / 20] Loss: 4.475438381839182 CE Loss: 0.4220605761604959 Con Loss: 4.471217770828195
[9 / 20] tensor([[0.960, 0.688],
        [0.591, 0.606]]) {'epoch': 9, 'valid/acc': 75.529, 'valid/acc_unbiased': 69.133, 'valid/diff': 14.579, 'valid/acc_skew': 62.737, 'valid/acc_align': 75.529, 'test/acc': 77.215, 'test/acc_unbiased': 71.113, 'test/diff': 14.422, 'test/acc_skew': 63.902, 'test/acc_align': 78.324}
[9 / 20] best valid accuracy: 69.133 at epoch 9 
 best_stats: {'best_valid_epoch': 9, 'best_valid_valid/acc': 75.529, 'best_valid_valid/acc_unbiased': 69.133, 'best_valid_valid/diff': 14.579, 'best_valid_valid/acc_skew': 62.737, 'best_valid_valid/acc_align': 75.529, 'best_valid_test/acc': 77.215, 'best_valid_test/acc_unbiased': 71.113, 'best_valid_test/diff': 14.422, 'best_valid_test/acc_skew': 63.902, 'best_valid_test/acc_align': 78.324}
[9 / 20] best test accuracy: 71.113 at epoch 9 
 best_stats: {'best_test_epoch': 9, 'best_test_valid/acc': 75.529, 'best_test_valid/acc_unbiased': 69.133, 'best_test_valid/diff': 14.579, 'best_test_valid/acc_skew': 62.737, 'best_test_valid/acc_align': 75.529, 'best_test_test/acc': 77.215, 'best_test_test/acc_unbiased': 71.113, 'best_test_test/diff': 14.422, 'best_test_test/acc_skew': 63.902, 'best_test_test/acc_align': 78.324}
[10 / 20] Learning rate: 0.0001 weight: 0.01
[10 / 20] Loss: 4.406479436509487 CE Loss: 0.4209998084092042 Con Loss: 4.402269432670567
[10 / 20] tensor([[0.959, 0.864],
        [0.577, 0.485]]) {'epoch': 10, 'valid/acc': 74.603, 'valid/acc_unbiased': 68.726, 'valid/diff': 12.951, 'valid/acc_skew': 66.52, 'valid/acc_align': 70.932, 'test/acc': 77.126, 'test/acc_unbiased': 72.116, 'test/diff': 9.384, 'test/acc_skew': 72.017, 'test/acc_align': 72.216}
[10 / 20] best valid accuracy: 69.133 at epoch 9 
 best_stats: {'best_valid_epoch': 9, 'best_valid_valid/acc': 75.529, 'best_valid_valid/acc_unbiased': 69.133, 'best_valid_valid/diff': 14.579, 'best_valid_valid/acc_skew': 62.737, 'best_valid_valid/acc_align': 75.529, 'best_valid_test/acc': 77.215, 'best_valid_test/acc_unbiased': 71.113, 'best_valid_test/diff': 14.422, 'best_valid_test/acc_skew': 63.902, 'best_valid_test/acc_align': 78.324}
[10 / 20] best test accuracy: 72.116 at epoch 10 
 best_stats: {'best_test_epoch': 10, 'best_test_valid/acc': 74.603, 'best_test_valid/acc_unbiased': 68.726, 'best_test_valid/diff': 12.951, 'best_test_valid/acc_skew': 66.52, 'best_test_valid/acc_align': 70.932, 'best_test_test/acc': 77.126, 'best_test_test/acc_unbiased': 72.116, 'best_test_test/diff': 9.384, 'best_test_test/acc_skew': 72.017, 'best_test_test/acc_align': 72.216}
[11 / 20] Learning rate: 0.0001 weight: 0.01
[11 / 20] Loss: 4.376104640139483 CE Loss: 0.4077445832766294 Con Loss: 4.3720272109554035
[11 / 20] tensor([[0.944, 0.653],
        [0.651, 0.709]]) {'epoch': 11, 'valid/acc': 77.381, 'valid/acc_unbiased': 71.477, 'valid/diff': 17.451, 'valid/acc_skew': 62.751, 'valid/acc_align': 80.202, 'test/acc': 79.242, 'test/acc_unbiased': 73.935, 'test/diff': 17.478, 'test/acc_skew': 65.196, 'test/acc_align': 82.674}
[11 / 20] best valid accuracy: 71.477 at epoch 11 
 best_stats: {'best_valid_epoch': 11, 'best_valid_valid/acc': 77.381, 'best_valid_valid/acc_unbiased': 71.477, 'best_valid_valid/diff': 17.451, 'best_valid_valid/acc_skew': 62.751, 'best_valid_valid/acc_align': 80.202, 'best_valid_test/acc': 79.242, 'best_valid_test/acc_unbiased': 73.935, 'best_valid_test/diff': 17.478, 'best_valid_test/acc_skew': 65.196, 'best_valid_test/acc_align': 82.674}
[11 / 20] best test accuracy: 73.935 at epoch 11 
 best_stats: {'best_test_epoch': 11, 'best_test_valid/acc': 77.381, 'best_test_valid/acc_unbiased': 71.477, 'best_test_valid/diff': 17.451, 'best_test_valid/acc_skew': 62.751, 'best_test_valid/acc_align': 80.202, 'best_test_test/acc': 79.242, 'best_test_test/acc_unbiased': 73.935, 'best_test_test/diff': 17.478, 'best_test_test/acc_skew': 65.196, 'best_test_test/acc_align': 82.674}
[12 / 20] Learning rate: 0.0001 weight: 0.01
[12 / 20] Loss: 4.388915642153141 CE Loss: 0.40413727099999913 Con Loss: 4.384874261572583
[12 / 20] tensor([[0.970, 0.716],
        [0.561, 0.618]]) {'epoch': 12, 'valid/acc': 75.573, 'valid/acc_unbiased': 69.881, 'valid/diff': 17.528, 'valid/acc_skew': 61.116, 'valid/acc_align': 78.645, 'test/acc': 76.818, 'test/acc_unbiased': 71.612, 'test/diff': 15.578, 'test/acc_skew': 63.823, 'test/acc_align': 79.401}
[12 / 20] best valid accuracy: 71.477 at epoch 11 
 best_stats: {'best_valid_epoch': 11, 'best_valid_valid/acc': 77.381, 'best_valid_valid/acc_unbiased': 71.477, 'best_valid_valid/diff': 17.451, 'best_valid_valid/acc_skew': 62.751, 'best_valid_valid/acc_align': 80.202, 'best_valid_test/acc': 79.242, 'best_valid_test/acc_unbiased': 73.935, 'best_valid_test/diff': 17.478, 'best_valid_test/acc_skew': 65.196, 'best_valid_test/acc_align': 82.674}
[12 / 20] best test accuracy: 73.935 at epoch 11 
 best_stats: {'best_test_epoch': 11, 'best_test_valid/acc': 77.381, 'best_test_valid/acc_unbiased': 71.477, 'best_test_valid/diff': 17.451, 'best_test_valid/acc_skew': 62.751, 'best_test_valid/acc_align': 80.202, 'best_test_test/acc': 79.242, 'best_test_test/acc_unbiased': 73.935, 'best_test_test/diff': 17.478, 'best_test_test/acc_skew': 65.196, 'best_test_test/acc_align': 82.674}
[13 / 20] Learning rate: 0.0001 weight: 0.01
[13 / 20] Loss: 4.372341325960549 CE Loss: 0.3916959009872131 Con Loss: 4.368424380776231
[13 / 20] tensor([[0.962, 0.653],
        [0.596, 0.661]]) {'epoch': 13, 'valid/acc': 76.896, 'valid/acc_unbiased': 70.93, 'valid/diff': 20.282, 'valid/acc_skew': 60.789, 'valid/acc_align': 81.071, 'test/acc': 77.655, 'test/acc_unbiased': 71.816, 'test/diff': 18.659, 'test/acc_skew': 62.486, 'test/acc_align': 81.145}
[13 / 20] best valid accuracy: 71.477 at epoch 11 
 best_stats: {'best_valid_epoch': 11, 'best_valid_valid/acc': 77.381, 'best_valid_valid/acc_unbiased': 71.477, 'best_valid_valid/diff': 17.451, 'best_valid_valid/acc_skew': 62.751, 'best_valid_valid/acc_align': 80.202, 'best_valid_test/acc': 79.242, 'best_valid_test/acc_unbiased': 73.935, 'best_valid_test/diff': 17.478, 'best_valid_test/acc_skew': 65.196, 'best_valid_test/acc_align': 82.674}
[13 / 20] best test accuracy: 73.935 at epoch 11 
 best_stats: {'best_test_epoch': 11, 'best_test_valid/acc': 77.381, 'best_test_valid/acc_unbiased': 71.477, 'best_test_valid/diff': 17.451, 'best_test_valid/acc_skew': 62.751, 'best_test_valid/acc_align': 80.202, 'best_test_test/acc': 79.242, 'best_test_test/acc_unbiased': 73.935, 'best_test_test/diff': 17.478, 'best_test_test/acc_skew': 65.196, 'best_test_test/acc_align': 82.674}
[14 / 20] Learning rate: 1e-05 weight: 0.01
[14 / 20] Loss: 4.342215443942842 CE Loss: 0.3855191069968583 Con Loss: 4.338360258900061
[14 / 20] tensor([[0.969, 0.733],
        [0.577, 0.588]]) {'epoch': 14, 'valid/acc': 75.838, 'valid/acc_unbiased': 69.747, 'valid/diff': 15.603, 'valid/acc_skew': 61.945, 'valid/acc_align': 77.548, 'test/acc': 77.303, 'test/acc_unbiased': 71.661, 'test/diff': 12.356, 'test/acc_skew': 65.483, 'test/acc_align': 77.839}
[14 / 20] best valid accuracy: 71.477 at epoch 11 
 best_stats: {'best_valid_epoch': 11, 'best_valid_valid/acc': 77.381, 'best_valid_valid/acc_unbiased': 71.477, 'best_valid_valid/diff': 17.451, 'best_valid_valid/acc_skew': 62.751, 'best_valid_valid/acc_align': 80.202, 'best_valid_test/acc': 79.242, 'best_valid_test/acc_unbiased': 73.935, 'best_valid_test/diff': 17.478, 'best_valid_test/acc_skew': 65.196, 'best_valid_test/acc_align': 82.674}
[14 / 20] best test accuracy: 73.935 at epoch 11 
 best_stats: {'best_test_epoch': 11, 'best_test_valid/acc': 77.381, 'best_test_valid/acc_unbiased': 71.477, 'best_test_valid/diff': 17.451, 'best_test_valid/acc_skew': 62.751, 'best_test_valid/acc_align': 80.202, 'best_test_test/acc': 79.242, 'best_test_test/acc_unbiased': 73.935, 'best_test_test/diff': 17.478, 'best_test_test/acc_skew': 65.196, 'best_test_test/acc_align': 82.674}
[15 / 20] Learning rate: 1e-05 weight: 0.01
[15 / 20] Loss: 4.3145590381915095 CE Loss: 0.38823839287907835 Con Loss: 4.310676635226611
[15 / 20] tensor([[0.959, 0.670],
        [0.630, 0.636]]) {'epoch': 15, 'valid/acc': 77.778, 'valid/acc_unbiased': 71.453, 'valid/diff': 16.266, 'valid/acc_skew': 63.32, 'valid/acc_align': 79.586, 'test/acc': 78.713, 'test/acc_unbiased': 72.378, 'test/diff': 14.734, 'test/acc_skew': 65.011, 'test/acc_align': 79.745}
[15 / 20] best valid accuracy: 71.477 at epoch 11 
 best_stats: {'best_valid_epoch': 11, 'best_valid_valid/acc': 77.381, 'best_valid_valid/acc_unbiased': 71.477, 'best_valid_valid/diff': 17.451, 'best_valid_valid/acc_skew': 62.751, 'best_valid_valid/acc_align': 80.202, 'best_valid_test/acc': 79.242, 'best_valid_test/acc_unbiased': 73.935, 'best_valid_test/diff': 17.478, 'best_valid_test/acc_skew': 65.196, 'best_valid_test/acc_align': 82.674}
[15 / 20] best test accuracy: 73.935 at epoch 11 
 best_stats: {'best_test_epoch': 11, 'best_test_valid/acc': 77.381, 'best_test_valid/acc_unbiased': 71.477, 'best_test_valid/diff': 17.451, 'best_test_valid/acc_skew': 62.751, 'best_test_valid/acc_align': 80.202, 'best_test_test/acc': 79.242, 'best_test_test/acc_unbiased': 73.935, 'best_test_test/diff': 17.478, 'best_test_test/acc_skew': 65.196, 'best_test_test/acc_align': 82.674}
[16 / 20] Learning rate: 1e-05 weight: 0.01
[16 / 20] Loss: 4.272847280659421 CE Loss: 0.384646252015252 Con Loss: 4.269000825164293
[16 / 20] tensor([[0.955, 0.659],
        [0.636, 0.655]]) {'epoch': 16, 'valid/acc': 77.778, 'valid/acc_unbiased': 71.867, 'valid/diff': 16.738, 'valid/acc_skew': 63.498, 'valid/acc_align': 80.236, 'test/acc': 78.801, 'test/acc_unbiased': 72.598, 'test/diff': 15.734, 'test/acc_skew': 64.731, 'test/acc_align': 80.465}
[16 / 20] best valid accuracy: 71.867 at epoch 16 
 best_stats: {'best_valid_epoch': 16, 'best_valid_valid/acc': 77.778, 'best_valid_valid/acc_unbiased': 71.867, 'best_valid_valid/diff': 16.738, 'best_valid_valid/acc_skew': 63.498, 'best_valid_valid/acc_align': 80.236, 'best_valid_test/acc': 78.801, 'best_valid_test/acc_unbiased': 72.598, 'best_valid_test/diff': 15.734, 'best_valid_test/acc_skew': 64.731, 'best_valid_test/acc_align': 80.465}
[16 / 20] best test accuracy: 73.935 at epoch 11 
 best_stats: {'best_test_epoch': 11, 'best_test_valid/acc': 77.381, 'best_test_valid/acc_unbiased': 71.477, 'best_test_valid/diff': 17.451, 'best_test_valid/acc_skew': 62.751, 'best_test_valid/acc_align': 80.202, 'best_test_test/acc': 79.242, 'best_test_test/acc_unbiased': 73.935, 'best_test_test/diff': 17.478, 'best_test_test/acc_skew': 65.196, 'best_test_test/acc_align': 82.674}
[17 / 20] Learning rate: 1e-05 weight: 0.01
[17 / 20] Loss: 4.275135591832585 CE Loss: 0.3874655419947368 Con Loss: 4.271260957064499
[17 / 20] tensor([[0.959, 0.653],
        [0.637, 0.655]]) {'epoch': 17, 'valid/acc': 77.646, 'valid/acc_unbiased': 71.27, 'valid/diff': 18.621, 'valid/acc_skew': 61.96, 'valid/acc_align': 80.581, 'test/acc': 78.978, 'test/acc_unbiased': 72.579, 'test/diff': 16.149, 'test/acc_skew': 64.504, 'test/acc_align': 80.654}
[17 / 20] best valid accuracy: 71.867 at epoch 16 
 best_stats: {'best_valid_epoch': 16, 'best_valid_valid/acc': 77.778, 'best_valid_valid/acc_unbiased': 71.867, 'best_valid_valid/diff': 16.738, 'best_valid_valid/acc_skew': 63.498, 'best_valid_valid/acc_align': 80.236, 'best_valid_test/acc': 78.801, 'best_valid_test/acc_unbiased': 72.598, 'best_valid_test/diff': 15.734, 'best_valid_test/acc_skew': 64.731, 'best_valid_test/acc_align': 80.465}
[17 / 20] best test accuracy: 73.935 at epoch 11 
 best_stats: {'best_test_epoch': 11, 'best_test_valid/acc': 77.381, 'best_test_valid/acc_unbiased': 71.477, 'best_test_valid/diff': 17.451, 'best_test_valid/acc_skew': 62.751, 'best_test_valid/acc_align': 80.202, 'best_test_test/acc': 79.242, 'best_test_test/acc_unbiased': 73.935, 'best_test_test/diff': 17.478, 'best_test_test/acc_skew': 65.196, 'best_test_test/acc_align': 82.674}
[18 / 20] Learning rate: 1e-05 weight: 0.01
[18 / 20] Loss: 4.285365513673395 CE Loss: 0.38302269469749967 Con Loss: 4.281535316611532
[18 / 20] tensor([[0.961, 0.665],
        [0.622, 0.661]]) {'epoch': 18, 'valid/acc': 77.337, 'valid/acc_unbiased': 71.048, 'valid/diff': 18.066, 'valid/acc_skew': 62.016, 'valid/acc_align': 80.081, 'test/acc': 78.669, 'test/acc_unbiased': 72.711, 'test/diff': 16.775, 'test/acc_skew': 64.323, 'test/acc_align': 81.098}
[18 / 20] best valid accuracy: 71.867 at epoch 16 
 best_stats: {'best_valid_epoch': 16, 'best_valid_valid/acc': 77.778, 'best_valid_valid/acc_unbiased': 71.867, 'best_valid_valid/diff': 16.738, 'best_valid_valid/acc_skew': 63.498, 'best_valid_valid/acc_align': 80.236, 'best_valid_test/acc': 78.801, 'best_valid_test/acc_unbiased': 72.598, 'best_valid_test/diff': 15.734, 'best_valid_test/acc_skew': 64.731, 'best_valid_test/acc_align': 80.465}
[18 / 20] best test accuracy: 73.935 at epoch 11 
 best_stats: {'best_test_epoch': 11, 'best_test_valid/acc': 77.381, 'best_test_valid/acc_unbiased': 71.477, 'best_test_valid/diff': 17.451, 'best_test_valid/acc_skew': 62.751, 'best_test_valid/acc_align': 80.202, 'best_test_test/acc': 79.242, 'best_test_test/acc_unbiased': 73.935, 'best_test_test/diff': 17.478, 'best_test_test/acc_skew': 65.196, 'best_test_test/acc_align': 82.674}
[19 / 20] Learning rate: 1e-05 weight: 0.01
[19 / 20] Loss: 4.309388412067124 CE Loss: 0.38358887251241963 Con Loss: 4.305552524379557
[19 / 20] tensor([[0.954, 0.631],
        [0.651, 0.697]]) {'epoch': 19, 'valid/acc': 78.219, 'valid/acc_unbiased': 72.161, 'valid/diff': 19.131, 'valid/acc_skew': 62.595, 'valid/acc_align': 81.726, 'test/acc': 79.418, 'test/acc_unbiased': 73.3, 'test/diff': 18.479, 'test/acc_skew': 64.06, 'test/acc_align': 82.539}
[19 / 20] best valid accuracy: 72.161 at epoch 19 
 best_stats: {'best_valid_epoch': 19, 'best_valid_valid/acc': 78.219, 'best_valid_valid/acc_unbiased': 72.161, 'best_valid_valid/diff': 19.131, 'best_valid_valid/acc_skew': 62.595, 'best_valid_valid/acc_align': 81.726, 'best_valid_test/acc': 79.418, 'best_valid_test/acc_unbiased': 73.3, 'best_valid_test/diff': 18.479, 'best_valid_test/acc_skew': 64.06, 'best_valid_test/acc_align': 82.539}
[19 / 20] best test accuracy: 73.935 at epoch 11 
 best_stats: {'best_test_epoch': 11, 'best_test_valid/acc': 77.381, 'best_test_valid/acc_unbiased': 71.477, 'best_test_valid/diff': 17.451, 'best_test_valid/acc_skew': 62.751, 'best_test_valid/acc_align': 80.202, 'best_test_test/acc': 79.242, 'best_test_test/acc_unbiased': 73.935, 'best_test_test/diff': 17.478, 'best_test_test/acc_skew': 65.196, 'best_test_test/acc_align': 82.674}
[20 / 20] Learning rate: 1e-05 weight: 0.01
[20 / 20] Loss: 4.31524578278005 CE Loss: 0.38665481937685875 Con Loss: 4.311379262723533
[20 / 20] tensor([[0.958, 0.653],
        [0.642, 0.691]]) {'epoch': 20, 'valid/acc': 77.734, 'valid/acc_unbiased': 71.042, 'valid/diff': 17.689, 'valid/acc_skew': 62.198, 'valid/acc_align': 79.887, 'test/acc': 79.418, 'test/acc_unbiased': 73.609, 'test/diff': 17.632, 'test/acc_skew': 64.793, 'test/acc_align': 82.425}
[20 / 20] best valid accuracy: 72.161 at epoch 19 
 best_stats: {'best_valid_epoch': 19, 'best_valid_valid/acc': 78.219, 'best_valid_valid/acc_unbiased': 72.161, 'best_valid_valid/diff': 19.131, 'best_valid_valid/acc_skew': 62.595, 'best_valid_valid/acc_align': 81.726, 'best_valid_test/acc': 79.418, 'best_valid_test/acc_unbiased': 73.3, 'best_valid_test/diff': 18.479, 'best_valid_test/acc_skew': 64.06, 'best_valid_test/acc_align': 82.539}
[20 / 20] best test accuracy: 73.935 at epoch 11 
 best_stats: {'best_test_epoch': 11, 'best_test_valid/acc': 77.381, 'best_test_valid/acc_unbiased': 71.477, 'best_test_valid/diff': 17.451, 'best_test_valid/acc_skew': 62.751, 'best_test_valid/acc_align': 80.202, 'best_test_test/acc': 79.242, 'best_test_test/acc_unbiased': 73.935, 'best_test_test/diff': 17.478, 'best_test_test/acc_skew': 65.196, 'best_test_test/acc_align': 82.674}
Total training time: 0:16:31
