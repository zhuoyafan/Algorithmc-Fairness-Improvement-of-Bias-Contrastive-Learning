Log level set to: INFO
Set seed: 2
=======> Using Fixed Random Seed: 2 <========
save_path: exp_results/bc-bb0-utk_face_age-crop_cutout_blur-0.9-lr0.001-bs128-cbs64-w0.01-ratio10-aug1-seed2
get_utk_face - split: train, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_age-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
Binary Target 1
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Normal Label Distribution: 
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
Binary Target 1
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Normal Label Distribution: 
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 10684, target_attr: gender, bias_attr: age bias_rate: 0.9
['[train] target_0-bias_0: 8237', '[train] target_0-bias_1: 147', '[train] target_1-bias_0: 823', '[train] target_1-bias_1: 1477']
confusion_matrix - 
 original: tensor([[8237.,  823.],
        [ 147., 1477.]]), 
 normalized: tensor([[0.909, 0.091],
        [0.091, 0.909]]), 
 b|y: tensor([[0.982, 0.018],
        [0.358, 0.642]])
get_utk_face - split: train, aug: 1, given_y: True, ratio: 10
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_age-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
Binary Target 1
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Normal Label Distribution: 
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
Binary Target 1
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Normal Label Distribution: 
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 10684, target_attr: gender, bias_attr: age bias_rate: 0.9
['[train] target_0-bias_0: 8237', '[train] target_0-bias_1: 147', '[train] target_1-bias_0: 823', '[train] target_1-bias_1: 1477']
get_utk_face - split: valid, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_age-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [1030, 195]
Target 1: [841, 202]
Binary Target 1
---------------------------
Target 0: [1030, 195]
Target 1: [841, 202]
===================================
Normal Label Distribution: 
Target 0: [1030, 195]
Target 1: [841, 202]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 2268, target_attr: gender, bias_attr: age bias_rate: 0.9
['[valid] target_0-bias_0: 1030', '[valid] target_0-bias_1: 195', '[valid] target_1-bias_0: 841', '[valid] target_1-bias_1: 202']
get_utk_face - split: test, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_age-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [1061, 176]
Target 1: [867, 165]
Binary Target 1
---------------------------
Target 0: [1061, 176]
Target 1: [867, 165]
===================================
Normal Label Distribution: 
Target 0: [1061, 176]
Target 1: [867, 165]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 2269, target_attr: gender, bias_attr: age bias_rate: 0.9
['[test] target_0-bias_0: 1061', '[test] target_0-bias_1: 176', '[test] target_1-bias_0: 867', '[test] target_1-bias_1: 165']
decay_epochs: [6, 13]
[1 / 20] Learning rate: 0.001 weight: 0.01
[1 / 20] Loss: 4.825016102242764 CE Loss: 0.5666591987008238 Con Loss: 4.8193494970992194
[1 / 20] tensor([[1.000, 1.000],
        [0.009, 0.024]]) {'epoch': 1, 'valid/acc': 54.453, 'valid/acc_unbiased': 50.684, 'valid/diff': 0.612, 'valid/acc_skew': 50.476, 'valid/acc_align': 50.893, 'test/acc': 55.046, 'test/acc_unbiased': 50.837, 'test/diff': 0.751, 'test/acc_skew': 50.461, 'test/acc_align': 51.212}
[1 / 20] best valid accuracy: 50.684 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 54.453, 'best_valid_valid/acc_unbiased': 50.684, 'best_valid_valid/diff': 0.612, 'best_valid_valid/acc_skew': 50.476, 'best_valid_valid/acc_align': 50.893, 'best_valid_test/acc': 55.046, 'best_valid_test/acc_unbiased': 50.837, 'best_valid_test/diff': 0.751, 'best_valid_test/acc_skew': 50.461, 'best_valid_test/acc_align': 51.212}
[1 / 20] best test accuracy: 50.837 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 54.453, 'best_test_valid/acc_unbiased': 50.684, 'best_test_valid/diff': 0.612, 'best_test_valid/acc_skew': 50.476, 'best_test_valid/acc_align': 50.893, 'best_test_test/acc': 55.046, 'best_test_test/acc_unbiased': 50.837, 'best_test_test/diff': 0.751, 'best_test_test/acc_skew': 50.461, 'best_test_test/acc_align': 51.212}
[2 / 20] Learning rate: 0.001 weight: 0.01
[2 / 20] Loss: 4.667494923824766 CE Loss: 0.5187045571197958 Con Loss: 4.6623078765426405
[2 / 20] tensor([[0.773, 0.665],
        [0.715, 0.594]]) {'epoch': 2, 'valid/acc': 72.487, 'valid/acc_unbiased': 67.899, 'valid/diff': 12.91, 'valid/acc_skew': 65.096, 'valid/acc_align': 70.703, 'test/acc': 72.94, 'test/acc_unbiased': 68.667, 'test/diff': 11.463, 'test/acc_skew': 68.994, 'test/acc_align': 68.34}
[2 / 20] best valid accuracy: 67.899 at epoch 2 
 best_stats: {'best_valid_epoch': 2, 'best_valid_valid/acc': 72.487, 'best_valid_valid/acc_unbiased': 67.899, 'best_valid_valid/diff': 12.91, 'best_valid_valid/acc_skew': 65.096, 'best_valid_valid/acc_align': 70.703, 'best_valid_test/acc': 72.94, 'best_valid_test/acc_unbiased': 68.667, 'best_valid_test/diff': 11.463, 'best_valid_test/acc_skew': 68.994, 'best_valid_test/acc_align': 68.34}
[2 / 20] best test accuracy: 68.667 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 72.487, 'best_test_valid/acc_unbiased': 67.899, 'best_test_valid/diff': 12.91, 'best_test_valid/acc_skew': 65.096, 'best_test_valid/acc_align': 70.703, 'best_test_test/acc': 72.94, 'best_test_test/acc_unbiased': 68.667, 'best_test_test/diff': 11.463, 'best_test_test/acc_skew': 68.994, 'best_test_test/acc_align': 68.34}
[3 / 20] Learning rate: 0.001 weight: 0.01
[3 / 20] Loss: 4.6799761601844025 CE Loss: 0.506022975244847 Con Loss: 4.674915941767548
[3 / 20] tensor([[0.885, 0.835],
        [0.554, 0.406]]) {'epoch': 3, 'valid/acc': 70.855, 'valid/acc_unbiased': 65.511, 'valid/diff': 12.001, 'valid/acc_skew': 65.472, 'valid/acc_align': 65.549, 'test/acc': 71.97, 'test/acc_unbiased': 66.998, 'test/diff': 9.868, 'test/acc_skew': 69.443, 'test/acc_align': 64.554}
[3 / 20] best valid accuracy: 67.899 at epoch 2 
 best_stats: {'best_valid_epoch': 2, 'best_valid_valid/acc': 72.487, 'best_valid_valid/acc_unbiased': 67.899, 'best_valid_valid/diff': 12.91, 'best_valid_valid/acc_skew': 65.096, 'best_valid_valid/acc_align': 70.703, 'best_valid_test/acc': 72.94, 'best_valid_test/acc_unbiased': 68.667, 'best_valid_test/diff': 11.463, 'best_valid_test/acc_skew': 68.994, 'best_valid_test/acc_align': 68.34}
[3 / 20] best test accuracy: 68.667 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 72.487, 'best_test_valid/acc_unbiased': 67.899, 'best_test_valid/diff': 12.91, 'best_test_valid/acc_skew': 65.096, 'best_test_valid/acc_align': 70.703, 'best_test_test/acc': 72.94, 'best_test_test/acc_unbiased': 68.667, 'best_test_test/diff': 11.463, 'best_test_test/acc_skew': 68.994, 'best_test_test/acc_align': 68.34}
[4 / 20] Learning rate: 0.001 weight: 0.01
[4 / 20] Loss: 4.6137027154920345 CE Loss: 0.4994977364398174 Con Loss: 4.608707749678463
[4 / 20] tensor([[0.907, 0.727],
        [0.576, 0.448]]) {'epoch': 4, 'valid/acc': 72.222, 'valid/acc_unbiased': 67.108, 'valid/diff': 10.811, 'valid/acc_skew': 64.089, 'valid/acc_align': 70.126, 'test/acc': 73.292, 'test/acc_unbiased': 66.45, 'test/diff': 15.324, 'test/acc_skew': 65.141, 'test/acc_align': 67.759}
[4 / 20] best valid accuracy: 67.899 at epoch 2 
 best_stats: {'best_valid_epoch': 2, 'best_valid_valid/acc': 72.487, 'best_valid_valid/acc_unbiased': 67.899, 'best_valid_valid/diff': 12.91, 'best_valid_valid/acc_skew': 65.096, 'best_valid_valid/acc_align': 70.703, 'best_valid_test/acc': 72.94, 'best_valid_test/acc_unbiased': 68.667, 'best_valid_test/diff': 11.463, 'best_valid_test/acc_skew': 68.994, 'best_valid_test/acc_align': 68.34}
[4 / 20] best test accuracy: 68.667 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 72.487, 'best_test_valid/acc_unbiased': 67.899, 'best_test_valid/diff': 12.91, 'best_test_valid/acc_skew': 65.096, 'best_test_valid/acc_align': 70.703, 'best_test_test/acc': 72.94, 'best_test_test/acc_unbiased': 68.667, 'best_test_test/diff': 11.463, 'best_test_test/acc_skew': 68.994, 'best_test_test/acc_align': 68.34}
[5 / 20] Learning rate: 0.001 weight: 0.01
[5 / 20] Loss: 4.5893424315115166 CE Loss: 0.48701148163018176 Con Loss: 4.58447231205605
[5 / 20] tensor([[0.888, 0.778],
        [0.625, 0.509]]) {'epoch': 5, 'valid/acc': 73.325, 'valid/acc_unbiased': 67.744, 'valid/diff': 13.34, 'valid/acc_skew': 63.454, 'valid/acc_align': 72.034, 'test/acc': 75.143, 'test/acc_unbiased': 70.012, 'test/diff': 11.274, 'test/acc_skew': 70.178, 'test/acc_align': 69.847}
[5 / 20] best valid accuracy: 67.899 at epoch 2 
 best_stats: {'best_valid_epoch': 2, 'best_valid_valid/acc': 72.487, 'best_valid_valid/acc_unbiased': 67.899, 'best_valid_valid/diff': 12.91, 'best_valid_valid/acc_skew': 65.096, 'best_valid_valid/acc_align': 70.703, 'best_valid_test/acc': 72.94, 'best_valid_test/acc_unbiased': 68.667, 'best_valid_test/diff': 11.463, 'best_valid_test/acc_skew': 68.994, 'best_valid_test/acc_align': 68.34}
[5 / 20] best test accuracy: 70.012 at epoch 5 
 best_stats: {'best_test_epoch': 5, 'best_test_valid/acc': 73.325, 'best_test_valid/acc_unbiased': 67.744, 'best_test_valid/diff': 13.34, 'best_test_valid/acc_skew': 63.454, 'best_test_valid/acc_align': 72.034, 'best_test_test/acc': 75.143, 'best_test_test/acc_unbiased': 70.012, 'best_test_test/diff': 11.274, 'best_test_test/acc_skew': 70.178, 'best_test_test/acc_align': 69.847}
[6 / 20] Learning rate: 0.001 weight: 0.01
[6 / 20] Loss: 4.599669496114225 CE Loss: 0.4698104771368069 Con Loss: 4.594971390441757
[6 / 20] tensor([[0.951, 0.881],
        [0.558, 0.442]]) {'epoch': 6, 'valid/acc': 73.545, 'valid/acc_unbiased': 69.418, 'valid/diff': 7.137, 'valid/acc_skew': 68.344, 'valid/acc_align': 70.491, 'test/acc': 75.848, 'test/acc_unbiased': 70.809, 'test/diff': 9.307, 'test/acc_skew': 71.946, 'test/acc_align': 69.671}
[6 / 20] best valid accuracy: 69.418 at epoch 6 
 best_stats: {'best_valid_epoch': 6, 'best_valid_valid/acc': 73.545, 'best_valid_valid/acc_unbiased': 69.418, 'best_valid_valid/diff': 7.137, 'best_valid_valid/acc_skew': 68.344, 'best_valid_valid/acc_align': 70.491, 'best_valid_test/acc': 75.848, 'best_valid_test/acc_unbiased': 70.809, 'best_valid_test/diff': 9.307, 'best_valid_test/acc_skew': 71.946, 'best_valid_test/acc_align': 69.671}
[6 / 20] best test accuracy: 70.809 at epoch 6 
 best_stats: {'best_test_epoch': 6, 'best_test_valid/acc': 73.545, 'best_test_valid/acc_unbiased': 69.418, 'best_test_valid/diff': 7.137, 'best_test_valid/acc_skew': 68.344, 'best_test_valid/acc_align': 70.491, 'best_test_test/acc': 75.848, 'best_test_test/acc_unbiased': 70.809, 'best_test_test/diff': 9.307, 'best_test_test/acc_skew': 71.946, 'best_test_test/acc_align': 69.671}
[7 / 20] Learning rate: 0.0001 weight: 0.01
[7 / 20] Loss: 4.523179226535753 CE Loss: 0.43825590877174125 Con Loss: 4.518796661202714
[7 / 20] tensor([[0.960, 0.881],
        [0.552, 0.448]]) {'epoch': 7, 'valid/acc': 73.369, 'valid/acc_unbiased': 68.346, 'valid/diff': 9.591, 'valid/acc_skew': 65.818, 'valid/acc_align': 70.874, 'test/acc': 76.113, 'test/acc_unbiased': 71.052, 'test/diff': 9.186, 'test/acc_skew': 71.658, 'test/acc_align': 70.445}
[7 / 20] best valid accuracy: 69.418 at epoch 6 
 best_stats: {'best_valid_epoch': 6, 'best_valid_valid/acc': 73.545, 'best_valid_valid/acc_unbiased': 69.418, 'best_valid_valid/diff': 7.137, 'best_valid_valid/acc_skew': 68.344, 'best_valid_valid/acc_align': 70.491, 'best_valid_test/acc': 75.848, 'best_valid_test/acc_unbiased': 70.809, 'best_valid_test/diff': 9.307, 'best_valid_test/acc_skew': 71.946, 'best_valid_test/acc_align': 69.671}
[7 / 20] best test accuracy: 71.052 at epoch 7 
 best_stats: {'best_test_epoch': 7, 'best_test_valid/acc': 73.369, 'best_test_valid/acc_unbiased': 68.346, 'best_test_valid/diff': 9.591, 'best_test_valid/acc_skew': 65.818, 'best_test_valid/acc_align': 70.874, 'best_test_test/acc': 76.113, 'best_test_test/acc_unbiased': 71.052, 'best_test_test/diff': 9.186, 'best_test_test/acc_skew': 71.658, 'best_test_test/acc_align': 70.445}
[8 / 20] Learning rate: 0.0001 weight: 0.01
[8 / 20] Loss: 4.462405137469464 CE Loss: 0.43222642749358275 Con Loss: 4.458082861063053
[8 / 20] tensor([[0.957, 0.744],
        [0.591, 0.570]]) {'epoch': 8, 'valid/acc': 75.132, 'valid/acc_unbiased': 69.746, 'valid/diff': 13.75, 'valid/acc_skew': 62.871, 'valid/acc_align': 76.621, 'test/acc': 77.215, 'test/acc_unbiased': 71.53, 'test/diff': 11.659, 'test/acc_skew': 66.743, 'test/acc_align': 76.317}
[8 / 20] best valid accuracy: 69.746 at epoch 8 
 best_stats: {'best_valid_epoch': 8, 'best_valid_valid/acc': 75.132, 'best_valid_valid/acc_unbiased': 69.746, 'best_valid_valid/diff': 13.75, 'best_valid_valid/acc_skew': 62.871, 'best_valid_valid/acc_align': 76.621, 'best_valid_test/acc': 77.215, 'best_valid_test/acc_unbiased': 71.53, 'best_valid_test/diff': 11.659, 'best_valid_test/acc_skew': 66.743, 'best_valid_test/acc_align': 76.317}
[8 / 20] best test accuracy: 71.530 at epoch 8 
 best_stats: {'best_test_epoch': 8, 'best_test_valid/acc': 75.132, 'best_test_valid/acc_unbiased': 69.746, 'best_test_valid/diff': 13.75, 'best_test_valid/acc_skew': 62.871, 'best_test_valid/acc_align': 76.621, 'best_test_test/acc': 77.215, 'best_test_test/acc_unbiased': 71.53, 'best_test_test/diff': 11.659, 'best_test_test/acc_skew': 66.743, 'best_test_test/acc_align': 76.317}
[9 / 20] Learning rate: 0.0001 weight: 0.01
[9 / 20] Loss: 4.409031785502946 CE Loss: 0.4243582358680741 Con Loss: 4.404788214541785
[9 / 20] tensor([[0.971, 0.790],
        [0.554, 0.539]]) {'epoch': 9, 'valid/acc': 74.295, 'valid/acc_unbiased': 69.127, 'valid/diff': 13.872, 'valid/acc_skew': 62.191, 'valid/acc_align': 76.063, 'test/acc': 76.598, 'test/acc_unbiased': 71.34, 'test/diff': 9.762, 'test/acc_skew': 67.17, 'test/acc_align': 75.509}
[9 / 20] best valid accuracy: 69.746 at epoch 8 
 best_stats: {'best_valid_epoch': 8, 'best_valid_valid/acc': 75.132, 'best_valid_valid/acc_unbiased': 69.746, 'best_valid_valid/diff': 13.75, 'best_valid_valid/acc_skew': 62.871, 'best_valid_valid/acc_align': 76.621, 'best_valid_test/acc': 77.215, 'best_valid_test/acc_unbiased': 71.53, 'best_valid_test/diff': 11.659, 'best_valid_test/acc_skew': 66.743, 'best_valid_test/acc_align': 76.317}
[9 / 20] best test accuracy: 71.530 at epoch 8 
 best_stats: {'best_test_epoch': 8, 'best_test_valid/acc': 75.132, 'best_test_valid/acc_unbiased': 69.746, 'best_test_valid/diff': 13.75, 'best_test_valid/acc_skew': 62.871, 'best_test_valid/acc_align': 76.621, 'best_test_test/acc': 77.215, 'best_test_test/acc_unbiased': 71.53, 'best_test_test/diff': 11.659, 'best_test_test/acc_skew': 66.743, 'best_test_test/acc_align': 76.317}
[10 / 20] Learning rate: 0.0001 weight: 0.01
[10 / 20] Loss: 4.382888020758592 CE Loss: 0.4155469268660829 Con Loss: 4.378732540597634
[10 / 20] tensor([[0.953, 0.830],
        [0.593, 0.539]]) {'epoch': 10, 'valid/acc': 75.75, 'valid/acc_unbiased': 69.678, 'valid/diff': 13.564, 'valid/acc_skew': 64.472, 'valid/acc_align': 74.883, 'test/acc': 77.567, 'test/acc_unbiased': 72.867, 'test/diff': 8.839, 'test/acc_skew': 71.12, 'test/acc_align': 74.613}
[10 / 20] best valid accuracy: 69.746 at epoch 8 
 best_stats: {'best_valid_epoch': 8, 'best_valid_valid/acc': 75.132, 'best_valid_valid/acc_unbiased': 69.746, 'best_valid_valid/diff': 13.75, 'best_valid_valid/acc_skew': 62.871, 'best_valid_valid/acc_align': 76.621, 'best_valid_test/acc': 77.215, 'best_valid_test/acc_unbiased': 71.53, 'best_valid_test/diff': 11.659, 'best_valid_test/acc_skew': 66.743, 'best_valid_test/acc_align': 76.317}
[10 / 20] best test accuracy: 72.867 at epoch 10 
 best_stats: {'best_test_epoch': 10, 'best_test_valid/acc': 75.75, 'best_test_valid/acc_unbiased': 69.678, 'best_test_valid/diff': 13.564, 'best_test_valid/acc_skew': 64.472, 'best_test_valid/acc_align': 74.883, 'best_test_test/acc': 77.567, 'best_test_test/acc_unbiased': 72.867, 'best_test_test/diff': 8.839, 'best_test_test/acc_skew': 71.12, 'best_test_test/acc_align': 74.613}
[11 / 20] Learning rate: 0.0001 weight: 0.01
[11 / 20] Loss: 4.346542541385366 CE Loss: 0.4152098131934073 Con Loss: 4.342390467459144
[11 / 20] tensor([[0.965, 0.795],
        [0.550, 0.533]]) {'epoch': 11, 'valid/acc': 74.339, 'valid/acc_unbiased': 68.679, 'valid/diff': 14.077, 'valid/acc_skew': 61.641, 'valid/acc_align': 75.718, 'test/acc': 76.201, 'test/acc_unbiased': 71.102, 'test/diff': 9.326, 'test/acc_skew': 67.281, 'test/acc_align': 74.923}
[11 / 20] best valid accuracy: 69.746 at epoch 8 
 best_stats: {'best_valid_epoch': 8, 'best_valid_valid/acc': 75.132, 'best_valid_valid/acc_unbiased': 69.746, 'best_valid_valid/diff': 13.75, 'best_valid_valid/acc_skew': 62.871, 'best_valid_valid/acc_align': 76.621, 'best_valid_test/acc': 77.215, 'best_valid_test/acc_unbiased': 71.53, 'best_valid_test/diff': 11.659, 'best_valid_test/acc_skew': 66.743, 'best_valid_test/acc_align': 76.317}
[11 / 20] best test accuracy: 72.867 at epoch 10 
 best_stats: {'best_test_epoch': 10, 'best_test_valid/acc': 75.75, 'best_test_valid/acc_unbiased': 69.678, 'best_test_valid/diff': 13.564, 'best_test_valid/acc_skew': 64.472, 'best_test_valid/acc_align': 74.883, 'best_test_test/acc': 77.567, 'best_test_test/acc_unbiased': 72.867, 'best_test_test/diff': 8.839, 'best_test_test/acc_skew': 71.12, 'best_test_test/acc_align': 74.613}
[12 / 20] Learning rate: 0.0001 weight: 0.01
[12 / 20] Loss: 4.398065847299019 CE Loss: 0.40355189167484723 Con Loss: 4.394030321407568
[12 / 20] tensor([[0.967, 0.716],
        [0.551, 0.570]]) {'epoch': 12, 'valid/acc': 74.912, 'valid/acc_unbiased': 69.379, 'valid/diff': 19.104, 'valid/acc_skew': 59.827, 'valid/acc_align': 78.931, 'test/acc': 75.981, 'test/acc_unbiased': 70.099, 'test/diff': 13.474, 'test/acc_skew': 63.362, 'test/acc_align': 76.835}
[12 / 20] best valid accuracy: 69.746 at epoch 8 
 best_stats: {'best_valid_epoch': 8, 'best_valid_valid/acc': 75.132, 'best_valid_valid/acc_unbiased': 69.746, 'best_valid_valid/diff': 13.75, 'best_valid_valid/acc_skew': 62.871, 'best_valid_valid/acc_align': 76.621, 'best_valid_test/acc': 77.215, 'best_valid_test/acc_unbiased': 71.53, 'best_valid_test/diff': 11.659, 'best_valid_test/acc_skew': 66.743, 'best_valid_test/acc_align': 76.317}
[12 / 20] best test accuracy: 72.867 at epoch 10 
 best_stats: {'best_test_epoch': 10, 'best_test_valid/acc': 75.75, 'best_test_valid/acc_unbiased': 69.678, 'best_test_valid/diff': 13.564, 'best_test_valid/acc_skew': 64.472, 'best_test_valid/acc_align': 74.883, 'best_test_test/acc': 77.567, 'best_test_test/acc_unbiased': 72.867, 'best_test_test/diff': 8.839, 'best_test_test/acc_skew': 71.12, 'best_test_test/acc_align': 74.613}
[13 / 20] Learning rate: 0.0001 weight: 0.01
[13 / 20] Loss: 4.349256034916771 CE Loss: 0.4028829803452515 Con Loss: 4.34522721205968
[13 / 20] tensor([[0.946, 0.670],
        [0.618, 0.661]]) {'epoch': 13, 'valid/acc': 75.794, 'valid/acc_unbiased': 69.436, 'valid/diff': 21.796, 'valid/acc_skew': 58.537, 'valid/acc_align': 80.334, 'test/acc': 77.876, 'test/acc_unbiased': 72.389, 'test/diff': 15.91, 'test/acc_skew': 64.434, 'test/acc_align': 80.344}
[13 / 20] best valid accuracy: 69.746 at epoch 8 
 best_stats: {'best_valid_epoch': 8, 'best_valid_valid/acc': 75.132, 'best_valid_valid/acc_unbiased': 69.746, 'best_valid_valid/diff': 13.75, 'best_valid_valid/acc_skew': 62.871, 'best_valid_valid/acc_align': 76.621, 'best_valid_test/acc': 77.215, 'best_valid_test/acc_unbiased': 71.53, 'best_valid_test/diff': 11.659, 'best_valid_test/acc_skew': 66.743, 'best_valid_test/acc_align': 76.317}
[13 / 20] best test accuracy: 72.867 at epoch 10 
 best_stats: {'best_test_epoch': 10, 'best_test_valid/acc': 75.75, 'best_test_valid/acc_unbiased': 69.678, 'best_test_valid/diff': 13.564, 'best_test_valid/acc_skew': 64.472, 'best_test_valid/acc_align': 74.883, 'best_test_test/acc': 77.567, 'best_test_test/acc_unbiased': 72.867, 'best_test_test/diff': 8.839, 'best_test_test/acc_skew': 71.12, 'best_test_test/acc_align': 74.613}
[14 / 20] Learning rate: 1e-05 weight: 0.01
[14 / 20] Loss: 4.337025570092867 CE Loss: 0.3940340434844375 Con Loss: 4.333085245427368
[14 / 20] tensor([[0.959, 0.693],
        [0.580, 0.636]]) {'epoch': 14, 'valid/acc': 75.485, 'valid/acc_unbiased': 69.653, 'valid/diff': 22.128, 'valid/acc_skew': 58.59, 'valid/acc_align': 80.717, 'test/acc': 76.994, 'test/acc_unbiased': 71.706, 'test/diff': 16.078, 'test/acc_skew': 63.667, 'test/acc_align': 79.745}
[14 / 20] best valid accuracy: 69.746 at epoch 8 
 best_stats: {'best_valid_epoch': 8, 'best_valid_valid/acc': 75.132, 'best_valid_valid/acc_unbiased': 69.746, 'best_valid_valid/diff': 13.75, 'best_valid_valid/acc_skew': 62.871, 'best_valid_valid/acc_align': 76.621, 'best_valid_test/acc': 77.215, 'best_valid_test/acc_unbiased': 71.53, 'best_valid_test/diff': 11.659, 'best_valid_test/acc_skew': 66.743, 'best_valid_test/acc_align': 76.317}
[14 / 20] best test accuracy: 72.867 at epoch 10 
 best_stats: {'best_test_epoch': 10, 'best_test_valid/acc': 75.75, 'best_test_valid/acc_unbiased': 69.678, 'best_test_valid/diff': 13.564, 'best_test_valid/acc_skew': 64.472, 'best_test_valid/acc_align': 74.883, 'best_test_test/acc': 77.567, 'best_test_test/acc_unbiased': 72.867, 'best_test_test/diff': 8.839, 'best_test_test/acc_skew': 71.12, 'best_test_test/acc_align': 74.613}
[15 / 20] Learning rate: 1e-05 weight: 0.01
[15 / 20] Loss: 4.322543353456006 CE Loss: 0.3936705009091976 Con Loss: 4.318606628723601
[15 / 20] tensor([[0.962, 0.705],
        [0.571, 0.630]]) {'epoch': 15, 'valid/acc': 75.441, 'valid/acc_unbiased': 69.626, 'valid/diff': 20.891, 'valid/acc_skew': 59.18, 'valid/acc_align': 80.072, 'test/acc': 76.862, 'test/acc_unbiased': 71.702, 'test/diff': 15.856, 'test/acc_skew': 63.774, 'test/acc_align': 79.63}
[15 / 20] best valid accuracy: 69.746 at epoch 8 
 best_stats: {'best_valid_epoch': 8, 'best_valid_valid/acc': 75.132, 'best_valid_valid/acc_unbiased': 69.746, 'best_valid_valid/diff': 13.75, 'best_valid_valid/acc_skew': 62.871, 'best_valid_valid/acc_align': 76.621, 'best_valid_test/acc': 77.215, 'best_valid_test/acc_unbiased': 71.53, 'best_valid_test/diff': 11.659, 'best_valid_test/acc_skew': 66.743, 'best_valid_test/acc_align': 76.317}
[15 / 20] best test accuracy: 72.867 at epoch 10 
 best_stats: {'best_test_epoch': 10, 'best_test_valid/acc': 75.75, 'best_test_valid/acc_unbiased': 69.678, 'best_test_valid/diff': 13.564, 'best_test_valid/acc_skew': 64.472, 'best_test_valid/acc_align': 74.883, 'best_test_test/acc': 77.567, 'best_test_test/acc_unbiased': 72.867, 'best_test_test/diff': 8.839, 'best_test_test/acc_skew': 71.12, 'best_test_test/acc_align': 74.613}
[16 / 20] Learning rate: 1e-05 weight: 0.01
[16 / 20] Loss: 4.287041805692935 CE Loss: 0.3990389943256757 Con Loss: 4.283051420266777
[16 / 20] tensor([[0.968, 0.727],
        [0.563, 0.600]]) {'epoch': 16, 'valid/acc': 75.22, 'valid/acc_unbiased': 69.681, 'valid/diff': 18.995, 'valid/acc_skew': 60.184, 'valid/acc_align': 79.179, 'test/acc': 76.774, 'test/acc_unbiased': 71.452, 'test/diff': 13.891, 'test/acc_skew': 64.507, 'test/acc_align': 78.398}
[16 / 20] best valid accuracy: 69.746 at epoch 8 
 best_stats: {'best_valid_epoch': 8, 'best_valid_valid/acc': 75.132, 'best_valid_valid/acc_unbiased': 69.746, 'best_valid_valid/diff': 13.75, 'best_valid_valid/acc_skew': 62.871, 'best_valid_valid/acc_align': 76.621, 'best_valid_test/acc': 77.215, 'best_valid_test/acc_unbiased': 71.53, 'best_valid_test/diff': 11.659, 'best_valid_test/acc_skew': 66.743, 'best_valid_test/acc_align': 76.317}
[16 / 20] best test accuracy: 72.867 at epoch 10 
 best_stats: {'best_test_epoch': 10, 'best_test_valid/acc': 75.75, 'best_test_valid/acc_unbiased': 69.678, 'best_test_valid/diff': 13.564, 'best_test_valid/acc_skew': 64.472, 'best_test_valid/acc_align': 74.883, 'best_test_test/acc': 77.567, 'best_test_test/acc_unbiased': 72.867, 'best_test_test/diff': 8.839, 'best_test_test/acc_skew': 71.12, 'best_test_test/acc_align': 74.613}
[17 / 20] Learning rate: 1e-05 weight: 0.01
[17 / 20] Loss: 4.325368717340707 CE Loss: 0.39872935829382183 Con Loss: 4.3213814435849605
[17 / 20] tensor([[0.962, 0.727],
        [0.576, 0.630]]) {'epoch': 17, 'valid/acc': 75.661, 'valid/acc_unbiased': 69.769, 'valid/diff': 20.702, 'valid/acc_skew': 59.418, 'valid/acc_align': 80.12, 'test/acc': 77.215, 'test/acc_unbiased': 72.386, 'test/diff': 14.489, 'test/acc_skew': 65.141, 'test/acc_align': 79.63}
[17 / 20] best valid accuracy: 69.769 at epoch 17 
 best_stats: {'best_valid_epoch': 17, 'best_valid_valid/acc': 75.661, 'best_valid_valid/acc_unbiased': 69.769, 'best_valid_valid/diff': 20.702, 'best_valid_valid/acc_skew': 59.418, 'best_valid_valid/acc_align': 80.12, 'best_valid_test/acc': 77.215, 'best_valid_test/acc_unbiased': 72.386, 'best_valid_test/diff': 14.489, 'best_valid_test/acc_skew': 65.141, 'best_valid_test/acc_align': 79.63}
[17 / 20] best test accuracy: 72.867 at epoch 10 
 best_stats: {'best_test_epoch': 10, 'best_test_valid/acc': 75.75, 'best_test_valid/acc_unbiased': 69.678, 'best_test_valid/diff': 13.564, 'best_test_valid/acc_skew': 64.472, 'best_test_valid/acc_align': 74.883, 'best_test_test/acc': 77.567, 'best_test_test/acc_unbiased': 72.867, 'best_test_test/diff': 8.839, 'best_test_test/acc_skew': 71.12, 'best_test_test/acc_align': 74.613}
[18 / 20] Learning rate: 1e-05 weight: 0.01
[18 / 20] Loss: 4.285835376619534 CE Loss: 0.3859788084891529 Con Loss: 4.281975577628287
[18 / 20] tensor([[0.959, 0.682],
        [0.596, 0.642]]) {'epoch': 18, 'valid/acc': 75.661, 'valid/acc_unbiased': 69.492, 'valid/diff': 21.761, 'valid/acc_skew': 58.612, 'valid/acc_align': 80.372, 'test/acc': 77.567, 'test/acc_unbiased': 71.977, 'test/diff': 16.141, 'test/acc_skew': 63.906, 'test/acc_align': 80.048}
[18 / 20] best valid accuracy: 69.769 at epoch 17 
 best_stats: {'best_valid_epoch': 17, 'best_valid_valid/acc': 75.661, 'best_valid_valid/acc_unbiased': 69.769, 'best_valid_valid/diff': 20.702, 'best_valid_valid/acc_skew': 59.418, 'best_valid_valid/acc_align': 80.12, 'best_valid_test/acc': 77.215, 'best_valid_test/acc_unbiased': 72.386, 'best_valid_test/diff': 14.489, 'best_valid_test/acc_skew': 65.141, 'best_valid_test/acc_align': 79.63}
[18 / 20] best test accuracy: 72.867 at epoch 10 
 best_stats: {'best_test_epoch': 10, 'best_test_valid/acc': 75.75, 'best_test_valid/acc_unbiased': 69.678, 'best_test_valid/diff': 13.564, 'best_test_valid/acc_skew': 64.472, 'best_test_valid/acc_align': 74.883, 'best_test_test/acc': 77.567, 'best_test_test/acc_unbiased': 72.867, 'best_test_test/diff': 8.839, 'best_test_test/acc_skew': 71.12, 'best_test_test/acc_align': 74.613}
[19 / 20] Learning rate: 1e-05 weight: 0.01
[19 / 20] Loss: 4.284057063763617 CE Loss: 0.383626797936999 Con Loss: 4.280220815457908
[19 / 20] tensor([[0.958, 0.653],
        [0.594, 0.685]]) {'epoch': 19, 'valid/acc': 75.353, 'valid/acc_unbiased': 68.664, 'valid/diff': 25.194, 'valid/acc_skew': 56.066, 'valid/acc_align': 81.261, 'test/acc': 77.523, 'test/acc_unbiased': 72.246, 'test/diff': 19.751, 'test/acc_skew': 62.371, 'test/acc_align': 82.122}
[19 / 20] best valid accuracy: 69.769 at epoch 17 
 best_stats: {'best_valid_epoch': 17, 'best_valid_valid/acc': 75.661, 'best_valid_valid/acc_unbiased': 69.769, 'best_valid_valid/diff': 20.702, 'best_valid_valid/acc_skew': 59.418, 'best_valid_valid/acc_align': 80.12, 'best_valid_test/acc': 77.215, 'best_valid_test/acc_unbiased': 72.386, 'best_valid_test/diff': 14.489, 'best_valid_test/acc_skew': 65.141, 'best_valid_test/acc_align': 79.63}
[19 / 20] best test accuracy: 72.867 at epoch 10 
 best_stats: {'best_test_epoch': 10, 'best_test_valid/acc': 75.75, 'best_test_valid/acc_unbiased': 69.678, 'best_test_valid/diff': 13.564, 'best_test_valid/acc_skew': 64.472, 'best_test_valid/acc_align': 74.883, 'best_test_test/acc': 77.567, 'best_test_test/acc_unbiased': 72.867, 'best_test_test/diff': 8.839, 'best_test_test/acc_skew': 71.12, 'best_test_test/acc_align': 74.613}
[20 / 20] Learning rate: 1e-05 weight: 0.01
[20 / 20] Loss: 4.269667452616176 CE Loss: 0.38575368942236105 Con Loss: 4.265809938015897
[20 / 20] tensor([[0.955, 0.705],
        [0.597, 0.655]]) {'epoch': 20, 'valid/acc': 75.794, 'valid/acc_unbiased': 69.566, 'valid/diff': 22.302, 'valid/acc_skew': 58.415, 'valid/acc_align': 80.717, 'test/acc': 77.699, 'test/acc_unbiased': 72.783, 'test/diff': 15.365, 'test/acc_skew': 65.1, 'test/acc_align': 80.465}
[20 / 20] best valid accuracy: 69.769 at epoch 17 
 best_stats: {'best_valid_epoch': 17, 'best_valid_valid/acc': 75.661, 'best_valid_valid/acc_unbiased': 69.769, 'best_valid_valid/diff': 20.702, 'best_valid_valid/acc_skew': 59.418, 'best_valid_valid/acc_align': 80.12, 'best_valid_test/acc': 77.215, 'best_valid_test/acc_unbiased': 72.386, 'best_valid_test/diff': 14.489, 'best_valid_test/acc_skew': 65.141, 'best_valid_test/acc_align': 79.63}
[20 / 20] best test accuracy: 72.867 at epoch 10 
 best_stats: {'best_test_epoch': 10, 'best_test_valid/acc': 75.75, 'best_test_valid/acc_unbiased': 69.678, 'best_test_valid/diff': 13.564, 'best_test_valid/acc_skew': 64.472, 'best_test_valid/acc_align': 74.883, 'best_test_test/acc': 77.567, 'best_test_test/acc_unbiased': 72.867, 'best_test_test/diff': 8.839, 'best_test_test/acc_skew': 71.12, 'best_test_test/acc_align': 74.613}
Total training time: 0:16:56
