Log level set to: INFO
Set seed: 3
=======> Using Fixed Random Seed: 3 <========
save_path: exp_results/bc-bb0-utk_face_race-cutout_blur-0.9-lr0.001-bs128-cbs64-w0.01-ratio10-aug1-seed3
get_utk_face - split: train, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_race-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [4407, 552]
Target 1: [440, 5529]
Binary Target 1
---------------------------
Target 0: [4407, 552]
Target 1: [440, 5529]
===================================
Normal Label Distribution: 
Target 0: [4407, 552]
Target 1: [440, 5529]
===================================
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [4407, 552]
Target 1: [440, 5529]
Binary Target 1
---------------------------
Target 0: [4407, 552]
Target 1: [440, 5529]
===================================
Normal Label Distribution: 
Target 0: [4407, 552]
Target 1: [440, 5529]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 10928, target_attr: gender, bias_attr: race bias_rate: 0.9
['[train] target_0-bias_0: 4407', '[train] target_0-bias_1: 552', '[train] target_1-bias_0: 440', '[train] target_1-bias_1: 5529']
confusion_matrix - 
 original: tensor([[4407.,  440.],
        [ 552., 5529.]]), 
 normalized: tensor([[0.909, 0.091],
        [0.091, 0.909]]), 
 b|y: tensor([[0.889, 0.111],
        [0.074, 0.926]])
get_utk_face - split: train, aug: 1, given_y: True, ratio: 10
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_race-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [4407, 552]
Target 1: [440, 5529]
Binary Target 1
---------------------------
Target 0: [4407, 552]
Target 1: [440, 5529]
===================================
Normal Label Distribution: 
Target 0: [4407, 552]
Target 1: [440, 5529]
===================================
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [4407, 552]
Target 1: [440, 5529]
Binary Target 1
---------------------------
Target 0: [4407, 552]
Target 1: [440, 5529]
===================================
Normal Label Distribution: 
Target 0: [4407, 552]
Target 1: [440, 5529]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 10928, target_attr: gender, bias_attr: race bias_rate: 0.9
['[train] target_0-bias_0: 4407', '[train] target_0-bias_1: 552', '[train] target_1-bias_0: 440', '[train] target_1-bias_1: 5529']
get_utk_face - split: valid, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_race-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [583, 684]
Target 1: [457, 646]
Binary Target 1
---------------------------
Target 0: [583, 684]
Target 1: [457, 646]
===================================
Normal Label Distribution: 
Target 0: [583, 684]
Target 1: [457, 646]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 2370, target_attr: gender, bias_attr: race bias_rate: 0.9
['[valid] target_0-bias_0: 583', '[valid] target_0-bias_1: 684', '[valid] target_1-bias_0: 457', '[valid] target_1-bias_1: 646']
get_utk_face - split: test, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_race-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [558, 677]
Target 1: [462, 673]
Binary Target 1
---------------------------
Target 0: [558, 677]
Target 1: [462, 673]
===================================
Normal Label Distribution: 
Target 0: [558, 677]
Target 1: [462, 673]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 2370, target_attr: gender, bias_attr: race bias_rate: 0.9
['[test] target_0-bias_0: 558', '[test] target_0-bias_1: 677', '[test] target_1-bias_0: 462', '[test] target_1-bias_1: 673']
decay_epochs: [6, 13]
[1 / 20] Learning rate: 0.001 weight: 0.01
[1 / 20] Loss: 4.913196516246432 CE Loss: 0.5884352059350356 Con Loss: 4.90731216000603
[1 / 20] tensor([[0.862, 0.789],
        [0.703, 0.741]]) {'epoch': 1, 'valid/acc': 77.131, 'valid/acc_unbiased': 76.716, 'valid/diff': 1.978, 'valid/acc_skew': 75.727, 'valid/acc_align': 77.705, 'test/acc': 77.595, 'test/acc_unbiased': 77.393, 'test/diff': 5.561, 'test/acc_skew': 74.612, 'test/acc_align': 80.173}
[1 / 20] best valid accuracy: 76.716 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 77.131, 'best_valid_valid/acc_unbiased': 76.716, 'best_valid_valid/diff': 1.978, 'best_valid_valid/acc_skew': 75.727, 'best_valid_valid/acc_align': 77.705, 'best_valid_test/acc': 77.595, 'best_valid_test/acc_unbiased': 77.393, 'best_valid_test/diff': 5.561, 'best_valid_test/acc_skew': 74.612, 'best_valid_test/acc_align': 80.173}
[1 / 20] best test accuracy: 77.393 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 77.131, 'best_test_valid/acc_unbiased': 76.716, 'best_test_valid/diff': 1.978, 'best_test_valid/acc_skew': 75.727, 'best_test_valid/acc_align': 77.705, 'best_test_test/acc': 77.595, 'best_test_test/acc_unbiased': 77.393, 'best_test_test/diff': 5.561, 'best_test_test/acc_skew': 74.612, 'best_test_test/acc_align': 80.173}
[2 / 20] Learning rate: 0.001 weight: 0.01
[2 / 20] Loss: 4.7509391402081205 CE Loss: 0.5058682158611181 Con Loss: 4.745880445309997
[2 / 20] tensor([[0.733, 0.653],
        [0.827, 0.893]]) {'epoch': 2, 'valid/acc': 78.143, 'valid/acc_unbiased': 78.826, 'valid/diff': 1.916, 'valid/acc_skew': 77.901, 'valid/acc_align': 79.751, 'test/acc': 77.384, 'test/acc_unbiased': 77.643, 'test/diff': 7.314, 'test/acc_skew': 73.986, 'test/acc_align': 81.3}
[2 / 20] best valid accuracy: 78.826 at epoch 2 
 best_stats: {'best_valid_epoch': 2, 'best_valid_valid/acc': 78.143, 'best_valid_valid/acc_unbiased': 78.826, 'best_valid_valid/diff': 1.916, 'best_valid_valid/acc_skew': 77.901, 'best_valid_valid/acc_align': 79.751, 'best_valid_test/acc': 77.384, 'best_valid_test/acc_unbiased': 77.643, 'best_valid_test/diff': 7.314, 'best_valid_test/acc_skew': 73.986, 'best_valid_test/acc_align': 81.3}
[2 / 20] best test accuracy: 77.643 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 78.143, 'best_test_valid/acc_unbiased': 78.826, 'best_test_valid/diff': 1.916, 'best_test_valid/acc_skew': 77.901, 'best_test_valid/acc_align': 79.751, 'best_test_test/acc': 77.384, 'best_test_test/acc_unbiased': 77.643, 'best_test_test/diff': 7.314, 'best_test_test/acc_skew': 73.986, 'best_test_test/acc_align': 81.3}
[3 / 20] Learning rate: 0.001 weight: 0.01
[3 / 20] Loss: 4.7191498108524526 CE Loss: 0.49469106957469117 Con Loss: 4.714202907389114
[3 / 20] tensor([[0.720, 0.634],
        [0.870, 0.903]]) {'epoch': 3, 'valid/acc': 78.861, 'valid/acc_unbiased': 79.587, 'valid/diff': 3.009, 'valid/acc_skew': 78.083, 'valid/acc_align': 81.092, 'test/acc': 77.679, 'test/acc_unbiased': 78.191, 'test/diff': 6.002, 'test/acc_skew': 75.19, 'test/acc_align': 81.192}
[3 / 20] best valid accuracy: 79.587 at epoch 3 
 best_stats: {'best_valid_epoch': 3, 'best_valid_valid/acc': 78.861, 'best_valid_valid/acc_unbiased': 79.587, 'best_valid_valid/diff': 3.009, 'best_valid_valid/acc_skew': 78.083, 'best_valid_valid/acc_align': 81.092, 'best_valid_test/acc': 77.679, 'best_valid_test/acc_unbiased': 78.191, 'best_valid_test/diff': 6.002, 'best_valid_test/acc_skew': 75.19, 'best_valid_test/acc_align': 81.192}
[3 / 20] best test accuracy: 78.191 at epoch 3 
 best_stats: {'best_test_epoch': 3, 'best_test_valid/acc': 78.861, 'best_test_valid/acc_unbiased': 79.587, 'best_test_valid/diff': 3.009, 'best_test_valid/acc_skew': 78.083, 'best_test_valid/acc_align': 81.092, 'best_test_test/acc': 77.679, 'best_test_test/acc_unbiased': 78.191, 'best_test_test/diff': 6.002, 'best_test_test/acc_skew': 75.19, 'best_test_test/acc_align': 81.192}
[4 / 20] Learning rate: 0.001 weight: 0.01
[4 / 20] Loss: 4.689135377613028 CE Loss: 0.4869003603084894 Con Loss: 4.684266379427596
[4 / 20] tensor([[0.932, 0.873],
        [0.530, 0.634]]) {'epoch': 4, 'valid/acc': 75.654, 'valid/acc_unbiased': 74.202, 'valid/diff': 5.32, 'valid/acc_skew': 71.542, 'valid/acc_align': 76.862, 'test/acc': 75.232, 'test/acc_unbiased': 74.241, 'test/diff': 8.155, 'test/acc_skew': 70.164, 'test/acc_align': 78.319}
[4 / 20] best valid accuracy: 79.587 at epoch 3 
 best_stats: {'best_valid_epoch': 3, 'best_valid_valid/acc': 78.861, 'best_valid_valid/acc_unbiased': 79.587, 'best_valid_valid/diff': 3.009, 'best_valid_valid/acc_skew': 78.083, 'best_valid_valid/acc_align': 81.092, 'best_valid_test/acc': 77.679, 'best_valid_test/acc_unbiased': 78.191, 'best_valid_test/diff': 6.002, 'best_valid_test/acc_skew': 75.19, 'best_valid_test/acc_align': 81.192}
[4 / 20] best test accuracy: 78.191 at epoch 3 
 best_stats: {'best_test_epoch': 3, 'best_test_valid/acc': 78.861, 'best_test_valid/acc_unbiased': 79.587, 'best_test_valid/diff': 3.009, 'best_test_valid/acc_skew': 78.083, 'best_test_valid/acc_align': 81.092, 'best_test_test/acc': 77.679, 'best_test_test/acc_unbiased': 78.191, 'best_test_test/diff': 6.002, 'best_test_test/acc_skew': 75.19, 'best_test_test/acc_align': 81.192}
[5 / 20] Learning rate: 0.001 weight: 0.01
[5 / 20] Loss: 4.644394652560724 CE Loss: 0.46836122215928655 Con Loss: 4.639711026740458
[5 / 20] tensor([[0.738, 0.691],
        [0.846, 0.886]]) {'epoch': 5, 'valid/acc': 78.65, 'valid/acc_unbiased': 79.358, 'valid/diff': 1.604, 'valid/acc_skew': 78.594, 'valid/acc_align': 80.122, 'test/acc': 78.776, 'test/acc_unbiased': 79.039, 'test/diff': 4.317, 'test/acc_skew': 76.88, 'test/acc_align': 81.197}
[5 / 20] best valid accuracy: 79.587 at epoch 3 
 best_stats: {'best_valid_epoch': 3, 'best_valid_valid/acc': 78.861, 'best_valid_valid/acc_unbiased': 79.587, 'best_valid_valid/diff': 3.009, 'best_valid_valid/acc_skew': 78.083, 'best_valid_valid/acc_align': 81.092, 'best_valid_test/acc': 77.679, 'best_valid_test/acc_unbiased': 78.191, 'best_valid_test/diff': 6.002, 'best_valid_test/acc_skew': 75.19, 'best_valid_test/acc_align': 81.192}
[5 / 20] best test accuracy: 79.039 at epoch 5 
 best_stats: {'best_test_epoch': 5, 'best_test_valid/acc': 78.65, 'best_test_valid/acc_unbiased': 79.358, 'best_test_valid/diff': 1.604, 'best_test_valid/acc_skew': 78.594, 'best_test_valid/acc_align': 80.122, 'best_test_test/acc': 78.776, 'best_test_test/acc_unbiased': 79.039, 'best_test_test/diff': 4.317, 'best_test_test/acc_skew': 76.88, 'best_test_test/acc_align': 81.197}
[6 / 20] Learning rate: 0.001 weight: 0.01
[6 / 20] Loss: 4.626993030615118 CE Loss: 0.4697503152127496 Con Loss: 4.6222955388171085
[6 / 20] tensor([[0.781, 0.734],
        [0.829, 0.884]]) {'epoch': 6, 'valid/acc': 80.717, 'valid/acc_unbiased': 81.337, 'valid/diff': 2.792, 'valid/acc_skew': 80.056, 'valid/acc_align': 82.617, 'test/acc': 80.633, 'test/acc_unbiased': 80.715, 'test/diff': 5.117, 'test/acc_skew': 78.156, 'test/acc_align': 83.273}
[6 / 20] best valid accuracy: 81.337 at epoch 6 
 best_stats: {'best_valid_epoch': 6, 'best_valid_valid/acc': 80.717, 'best_valid_valid/acc_unbiased': 81.337, 'best_valid_valid/diff': 2.792, 'best_valid_valid/acc_skew': 80.056, 'best_valid_valid/acc_align': 82.617, 'best_valid_test/acc': 80.633, 'best_valid_test/acc_unbiased': 80.715, 'best_valid_test/diff': 5.117, 'best_valid_test/acc_skew': 78.156, 'best_valid_test/acc_align': 83.273}
[6 / 20] best test accuracy: 80.715 at epoch 6 
 best_stats: {'best_test_epoch': 6, 'best_test_valid/acc': 80.717, 'best_test_valid/acc_unbiased': 81.337, 'best_test_valid/diff': 2.792, 'best_test_valid/acc_skew': 80.056, 'best_test_valid/acc_align': 82.617, 'best_test_test/acc': 80.633, 'best_test_test/acc_unbiased': 80.715, 'best_test_test/diff': 5.117, 'best_test_test/acc_skew': 78.156, 'best_test_test/acc_align': 83.273}
[7 / 20] Learning rate: 0.0001 weight: 0.01
[7 / 20] Loss: 4.538838146371688 CE Loss: 0.4395533161753268 Con Loss: 4.534442618162007
[7 / 20] tensor([[0.812, 0.747],
        [0.818, 0.896]]) {'epoch': 7, 'valid/acc': 82.363, 'valid/acc_unbiased': 82.79, 'valid/diff': 4.147, 'valid/acc_skew': 80.716, 'valid/acc_align': 84.864, 'test/acc': 81.857, 'test/acc_unbiased': 81.835, 'test/diff': 7.111, 'test/acc_skew': 78.28, 'test/acc_align': 85.391}
[7 / 20] best valid accuracy: 82.790 at epoch 7 
 best_stats: {'best_valid_epoch': 7, 'best_valid_valid/acc': 82.363, 'best_valid_valid/acc_unbiased': 82.79, 'best_valid_valid/diff': 4.147, 'best_valid_valid/acc_skew': 80.716, 'best_valid_valid/acc_align': 84.864, 'best_valid_test/acc': 81.857, 'best_valid_test/acc_unbiased': 81.835, 'best_valid_test/diff': 7.111, 'best_valid_test/acc_skew': 78.28, 'best_valid_test/acc_align': 85.391}
[7 / 20] best test accuracy: 81.835 at epoch 7 
 best_stats: {'best_test_epoch': 7, 'best_test_valid/acc': 82.363, 'best_test_valid/acc_unbiased': 82.79, 'best_test_valid/diff': 4.147, 'best_test_valid/acc_skew': 80.716, 'best_test_valid/acc_align': 84.864, 'best_test_test/acc': 81.857, 'best_test_test/acc_unbiased': 81.835, 'best_test_test/diff': 7.111, 'best_test_test/acc_skew': 78.28, 'best_test_test/acc_align': 85.391}
[8 / 20] Learning rate: 0.0001 weight: 0.01
[8 / 20] Loss: 4.499418808111858 CE Loss: 0.41504909820298325 Con Loss: 4.495268323236468
[8 / 20] tensor([[0.794, 0.736],
        [0.827, 0.908]]) {'epoch': 8, 'valid/acc': 82.025, 'valid/acc_unbiased': 82.416, 'valid/diff': 6.101, 'valid/acc_skew': 79.365, 'valid/acc_align': 85.466, 'test/acc': 81.603, 'test/acc_unbiased': 81.605, 'test/diff': 6.967, 'test/acc_skew': 78.122, 'test/acc_align': 85.089}
[8 / 20] best valid accuracy: 82.790 at epoch 7 
 best_stats: {'best_valid_epoch': 7, 'best_valid_valid/acc': 82.363, 'best_valid_valid/acc_unbiased': 82.79, 'best_valid_valid/diff': 4.147, 'best_valid_valid/acc_skew': 80.716, 'best_valid_valid/acc_align': 84.864, 'best_valid_test/acc': 81.857, 'best_valid_test/acc_unbiased': 81.835, 'best_valid_test/diff': 7.111, 'best_valid_test/acc_skew': 78.28, 'best_valid_test/acc_align': 85.391}
[8 / 20] best test accuracy: 81.835 at epoch 7 
 best_stats: {'best_test_epoch': 7, 'best_test_valid/acc': 82.363, 'best_test_valid/acc_unbiased': 82.79, 'best_test_valid/diff': 4.147, 'best_test_valid/acc_skew': 80.716, 'best_test_valid/acc_align': 84.864, 'best_test_test/acc': 81.857, 'best_test_test/acc_unbiased': 81.835, 'best_test_test/diff': 7.111, 'best_test_test/acc_skew': 78.28, 'best_test_test/acc_align': 85.391}
[9 / 20] Learning rate: 0.0001 weight: 0.01
[9 / 20] Loss: 4.470327661466808 CE Loss: 0.40458129575451507 Con Loss: 4.466281836413359
[9 / 20] tensor([[0.797, 0.691],
        [0.840, 0.915]]) {'epoch': 9, 'valid/acc': 81.519, 'valid/acc_unbiased': 82.082, 'valid/diff': 7.995, 'valid/acc_skew': 78.084, 'valid/acc_align': 86.079, 'test/acc': 80.886, 'test/acc_unbiased': 81.098, 'test/diff': 9.084, 'test/acc_skew': 76.556, 'test/acc_align': 85.64}
[9 / 20] best valid accuracy: 82.790 at epoch 7 
 best_stats: {'best_valid_epoch': 7, 'best_valid_valid/acc': 82.363, 'best_valid_valid/acc_unbiased': 82.79, 'best_valid_valid/diff': 4.147, 'best_valid_valid/acc_skew': 80.716, 'best_valid_valid/acc_align': 84.864, 'best_valid_test/acc': 81.857, 'best_valid_test/acc_unbiased': 81.835, 'best_valid_test/diff': 7.111, 'best_valid_test/acc_skew': 78.28, 'best_valid_test/acc_align': 85.391}
[9 / 20] best test accuracy: 81.835 at epoch 7 
 best_stats: {'best_test_epoch': 7, 'best_test_valid/acc': 82.363, 'best_test_valid/acc_unbiased': 82.79, 'best_test_valid/diff': 4.147, 'best_test_valid/acc_skew': 80.716, 'best_test_valid/acc_align': 84.864, 'best_test_test/acc': 81.857, 'best_test_test/acc_unbiased': 81.835, 'best_test_test/diff': 7.111, 'best_test_test/acc_skew': 78.28, 'best_test_test/acc_align': 85.391}
[10 / 20] Learning rate: 0.0001 weight: 0.01
[10 / 20] Loss: 4.45914304588061 CE Loss: 0.40519965336403074 Con Loss: 4.45509105894611
[10 / 20] tensor([[0.812, 0.730],
        [0.827, 0.900]]) {'epoch': 10, 'valid/acc': 82.068, 'valid/acc_unbiased': 82.381, 'valid/diff': 6.396, 'valid/acc_skew': 79.183, 'valid/acc_align': 85.579, 'test/acc': 81.646, 'test/acc_unbiased': 81.72, 'test/diff': 7.787, 'test/acc_skew': 77.826, 'test/acc_align': 85.614}
[10 / 20] best valid accuracy: 82.790 at epoch 7 
 best_stats: {'best_valid_epoch': 7, 'best_valid_valid/acc': 82.363, 'best_valid_valid/acc_unbiased': 82.79, 'best_valid_valid/diff': 4.147, 'best_valid_valid/acc_skew': 80.716, 'best_valid_valid/acc_align': 84.864, 'best_valid_test/acc': 81.857, 'best_valid_test/acc_unbiased': 81.835, 'best_valid_test/diff': 7.111, 'best_valid_test/acc_skew': 78.28, 'best_valid_test/acc_align': 85.391}
[10 / 20] best test accuracy: 81.835 at epoch 7 
 best_stats: {'best_test_epoch': 7, 'best_test_valid/acc': 82.363, 'best_test_valid/acc_unbiased': 82.79, 'best_test_valid/diff': 4.147, 'best_test_valid/acc_skew': 80.716, 'best_test_valid/acc_align': 84.864, 'best_test_test/acc': 81.857, 'best_test_test/acc_unbiased': 81.835, 'best_test_test/diff': 7.111, 'best_test_test/acc_skew': 78.28, 'best_test_test/acc_align': 85.391}
[11 / 20] Learning rate: 0.0001 weight: 0.01
[11 / 20] Loss: 4.433368588610938 CE Loss: 0.4087902740364019 Con Loss: 4.4292806804092875
[11 / 20] tensor([[0.772, 0.678],
        [0.840, 0.933]]) {'epoch': 11, 'valid/acc': 80.844, 'valid/acc_unbiased': 81.439, 'valid/diff': 7.514, 'valid/acc_skew': 77.682, 'valid/acc_align': 85.196, 'test/acc': 80.422, 'test/acc_unbiased': 80.584, 'test/diff': 9.386, 'test/acc_skew': 75.891, 'test/acc_align': 85.277}
[11 / 20] best valid accuracy: 82.790 at epoch 7 
 best_stats: {'best_valid_epoch': 7, 'best_valid_valid/acc': 82.363, 'best_valid_valid/acc_unbiased': 82.79, 'best_valid_valid/diff': 4.147, 'best_valid_valid/acc_skew': 80.716, 'best_valid_valid/acc_align': 84.864, 'best_valid_test/acc': 81.857, 'best_valid_test/acc_unbiased': 81.835, 'best_valid_test/diff': 7.111, 'best_valid_test/acc_skew': 78.28, 'best_valid_test/acc_align': 85.391}
[11 / 20] best test accuracy: 81.835 at epoch 7 
 best_stats: {'best_test_epoch': 7, 'best_test_valid/acc': 82.363, 'best_test_valid/acc_unbiased': 82.79, 'best_test_valid/diff': 4.147, 'best_test_valid/acc_skew': 80.716, 'best_test_valid/acc_align': 84.864, 'best_test_test/acc': 81.857, 'best_test_test/acc_unbiased': 81.835, 'best_test_test/diff': 7.111, 'best_test_test/acc_skew': 78.28, 'best_test_test/acc_align': 85.391}
[12 / 20] Learning rate: 0.0001 weight: 0.01
[12 / 20] Loss: 4.423272187329316 CE Loss: 0.411494912549657 Con Loss: 4.419157239039856
[12 / 20] tensor([[0.814, 0.712],
        [0.794, 0.903]]) {'epoch': 12, 'valid/acc': 81.35, 'valid/acc_unbiased': 81.671, 'valid/diff': 8.846, 'valid/acc_skew': 77.248, 'valid/acc_align': 86.094, 'test/acc': 80.633, 'test/acc_unbiased': 80.584, 'test/diff': 10.535, 'test/acc_skew': 75.317, 'test/acc_align': 85.852}
[12 / 20] best valid accuracy: 82.790 at epoch 7 
 best_stats: {'best_valid_epoch': 7, 'best_valid_valid/acc': 82.363, 'best_valid_valid/acc_unbiased': 82.79, 'best_valid_valid/diff': 4.147, 'best_valid_valid/acc_skew': 80.716, 'best_valid_valid/acc_align': 84.864, 'best_valid_test/acc': 81.857, 'best_valid_test/acc_unbiased': 81.835, 'best_valid_test/diff': 7.111, 'best_valid_test/acc_skew': 78.28, 'best_valid_test/acc_align': 85.391}
[12 / 20] best test accuracy: 81.835 at epoch 7 
 best_stats: {'best_test_epoch': 7, 'best_test_valid/acc': 82.363, 'best_test_valid/acc_unbiased': 82.79, 'best_test_valid/diff': 4.147, 'best_test_valid/acc_skew': 80.716, 'best_test_valid/acc_align': 84.864, 'best_test_test/acc': 81.857, 'best_test_test/acc_unbiased': 81.835, 'best_test_test/diff': 7.111, 'best_test_test/acc_skew': 78.28, 'best_test_test/acc_align': 85.391}
[13 / 20] Learning rate: 0.0001 weight: 0.01
[13 / 20] Loss: 4.375651514547636 CE Loss: 0.39241489759301373 Con Loss: 4.371727345104971
[13 / 20] tensor([[0.848, 0.758],
        [0.773, 0.881]]) {'epoch': 13, 'valid/acc': 82.785, 'valid/acc_unbiased': 82.915, 'valid/diff': 7.312, 'valid/acc_skew': 79.259, 'valid/acc_align': 86.57, 'test/acc': 81.688, 'test/acc_unbiased': 81.482, 'test/diff': 9.916, 'test/acc_skew': 76.524, 'test/acc_align': 86.44}
[13 / 20] best valid accuracy: 82.915 at epoch 13 
 best_stats: {'best_valid_epoch': 13, 'best_valid_valid/acc': 82.785, 'best_valid_valid/acc_unbiased': 82.915, 'best_valid_valid/diff': 7.312, 'best_valid_valid/acc_skew': 79.259, 'best_valid_valid/acc_align': 86.57, 'best_valid_test/acc': 81.688, 'best_valid_test/acc_unbiased': 81.482, 'best_valid_test/diff': 9.916, 'best_valid_test/acc_skew': 76.524, 'best_valid_test/acc_align': 86.44}
[13 / 20] best test accuracy: 81.835 at epoch 7 
 best_stats: {'best_test_epoch': 7, 'best_test_valid/acc': 82.363, 'best_test_valid/acc_unbiased': 82.79, 'best_test_valid/diff': 4.147, 'best_test_valid/acc_skew': 80.716, 'best_test_valid/acc_align': 84.864, 'best_test_test/acc': 81.857, 'best_test_test/acc_unbiased': 81.835, 'best_test_test/diff': 7.111, 'best_test_test/acc_skew': 78.28, 'best_test_test/acc_align': 85.391}
[14 / 20] Learning rate: 1e-05 weight: 0.01
[14 / 20] Loss: 4.3638479315169905 CE Loss: 0.3899327721201309 Con Loss: 4.3599486253272035
[14 / 20] tensor([[0.823, 0.727],
        [0.807, 0.909]]) {'epoch': 14, 'valid/acc': 82.025, 'valid/acc_unbiased': 82.345, 'valid/diff': 7.272, 'valid/acc_skew': 78.709, 'valid/acc_align': 85.981, 'test/acc': 81.688, 'test/acc_unbiased': 81.651, 'test/diff': 9.892, 'test/acc_skew': 76.705, 'test/acc_align': 86.597}
[14 / 20] best valid accuracy: 82.915 at epoch 13 
 best_stats: {'best_valid_epoch': 13, 'best_valid_valid/acc': 82.785, 'best_valid_valid/acc_unbiased': 82.915, 'best_valid_valid/diff': 7.312, 'best_valid_valid/acc_skew': 79.259, 'best_valid_valid/acc_align': 86.57, 'best_valid_test/acc': 81.688, 'best_valid_test/acc_unbiased': 81.482, 'best_valid_test/diff': 9.916, 'best_valid_test/acc_skew': 76.524, 'best_valid_test/acc_align': 86.44}
[14 / 20] best test accuracy: 81.835 at epoch 7 
 best_stats: {'best_test_epoch': 7, 'best_test_valid/acc': 82.363, 'best_test_valid/acc_unbiased': 82.79, 'best_test_valid/diff': 4.147, 'best_test_valid/acc_skew': 80.716, 'best_test_valid/acc_align': 84.864, 'best_test_test/acc': 81.857, 'best_test_test/acc_unbiased': 81.835, 'best_test_test/diff': 7.111, 'best_test_test/acc_skew': 78.28, 'best_test_test/acc_align': 85.391}
[15 / 20] Learning rate: 1e-05 weight: 0.01
[15 / 20] Loss: 4.355230740537406 CE Loss: 0.39863898970546696 Con Loss: 4.351244355365089
[15 / 20] tensor([[0.832, 0.724],
        [0.803, 0.903]]) {'epoch': 15, 'valid/acc': 81.814, 'valid/acc_unbiased': 82.149, 'valid/diff': 7.32, 'valid/acc_skew': 78.489, 'valid/acc_align': 85.809, 'test/acc': 81.561, 'test/acc_unbiased': 81.544, 'test/diff': 10.407, 'test/acc_skew': 76.341, 'test/acc_align': 86.748}
[15 / 20] best valid accuracy: 82.915 at epoch 13 
 best_stats: {'best_valid_epoch': 13, 'best_valid_valid/acc': 82.785, 'best_valid_valid/acc_unbiased': 82.915, 'best_valid_valid/diff': 7.312, 'best_valid_valid/acc_skew': 79.259, 'best_valid_valid/acc_align': 86.57, 'best_valid_test/acc': 81.688, 'best_valid_test/acc_unbiased': 81.482, 'best_valid_test/diff': 9.916, 'best_valid_test/acc_skew': 76.524, 'best_valid_test/acc_align': 86.44}
[15 / 20] best test accuracy: 81.835 at epoch 7 
 best_stats: {'best_test_epoch': 7, 'best_test_valid/acc': 82.363, 'best_test_valid/acc_unbiased': 82.79, 'best_test_valid/diff': 4.147, 'best_test_valid/acc_skew': 80.716, 'best_test_valid/acc_align': 84.864, 'best_test_test/acc': 81.857, 'best_test_test/acc_unbiased': 81.835, 'best_test_test/diff': 7.111, 'best_test_test/acc_skew': 78.28, 'best_test_test/acc_align': 85.391}
[16 / 20] Learning rate: 1e-05 weight: 0.01
[16 / 20] Loss: 4.3711949162741535 CE Loss: 0.3998754281076121 Con Loss: 4.367196182904446
[16 / 20] tensor([[0.815, 0.718],
        [0.818, 0.911]]) {'epoch': 16, 'valid/acc': 81.772, 'valid/acc_unbiased': 82.151, 'valid/diff': 8.056, 'valid/acc_skew': 78.123, 'valid/acc_align': 86.179, 'test/acc': 81.519, 'test/acc_unbiased': 81.558, 'test/diff': 9.51, 'test/acc_skew': 76.803, 'test/acc_align': 86.313}
[16 / 20] best valid accuracy: 82.915 at epoch 13 
 best_stats: {'best_valid_epoch': 13, 'best_valid_valid/acc': 82.785, 'best_valid_valid/acc_unbiased': 82.915, 'best_valid_valid/diff': 7.312, 'best_valid_valid/acc_skew': 79.259, 'best_valid_valid/acc_align': 86.57, 'best_valid_test/acc': 81.688, 'best_valid_test/acc_unbiased': 81.482, 'best_valid_test/diff': 9.916, 'best_valid_test/acc_skew': 76.524, 'best_valid_test/acc_align': 86.44}
[16 / 20] best test accuracy: 81.835 at epoch 7 
 best_stats: {'best_test_epoch': 7, 'best_test_valid/acc': 82.363, 'best_test_valid/acc_unbiased': 82.79, 'best_test_valid/diff': 4.147, 'best_test_valid/acc_skew': 80.716, 'best_test_valid/acc_align': 84.864, 'best_test_test/acc': 81.857, 'best_test_test/acc_unbiased': 81.835, 'best_test_test/diff': 7.111, 'best_test_test/acc_skew': 78.28, 'best_test_test/acc_align': 85.391}
[17 / 20] Learning rate: 1e-05 weight: 0.01
[17 / 20] Loss: 4.3664666025041665 CE Loss: 0.3928379848883058 Con Loss: 4.362538202266219
[17 / 20] tensor([[0.833, 0.725],
        [0.810, 0.897]]) {'epoch': 17, 'valid/acc': 82.152, 'valid/acc_unbiased': 82.527, 'valid/diff': 8.075, 'valid/acc_skew': 78.489, 'valid/acc_align': 86.564, 'test/acc': 81.603, 'test/acc_unbiased': 81.64, 'test/diff': 9.801, 'test/acc_skew': 76.739, 'test/acc_align': 86.54}
[17 / 20] best valid accuracy: 82.915 at epoch 13 
 best_stats: {'best_valid_epoch': 13, 'best_valid_valid/acc': 82.785, 'best_valid_valid/acc_unbiased': 82.915, 'best_valid_valid/diff': 7.312, 'best_valid_valid/acc_skew': 79.259, 'best_valid_valid/acc_align': 86.57, 'best_valid_test/acc': 81.688, 'best_valid_test/acc_unbiased': 81.482, 'best_valid_test/diff': 9.916, 'best_valid_test/acc_skew': 76.524, 'best_valid_test/acc_align': 86.44}
[17 / 20] best test accuracy: 81.835 at epoch 7 
 best_stats: {'best_test_epoch': 7, 'best_test_valid/acc': 82.363, 'best_test_valid/acc_unbiased': 82.79, 'best_test_valid/diff': 4.147, 'best_test_valid/acc_skew': 80.716, 'best_test_valid/acc_align': 84.864, 'best_test_test/acc': 81.857, 'best_test_test/acc_unbiased': 81.835, 'best_test_test/diff': 7.111, 'best_test_test/acc_skew': 78.28, 'best_test_test/acc_align': 85.391}
[18 / 20] Learning rate: 1e-05 weight: 0.01
[18 / 20] Loss: 4.364256884657272 CE Loss: 0.3977554951457642 Con Loss: 4.360279338077081
[18 / 20] tensor([[0.841, 0.728],
        [0.788, 0.896]]) {'epoch': 18, 'valid/acc': 81.941, 'valid/acc_unbiased': 82.202, 'valid/diff': 8.155, 'valid/acc_skew': 78.125, 'valid/acc_align': 86.28, 'test/acc': 81.392, 'test/acc_unbiased': 81.315, 'test/diff': 11.02, 'test/acc_skew': 75.805, 'test/acc_align': 86.824}
[18 / 20] best valid accuracy: 82.915 at epoch 13 
 best_stats: {'best_valid_epoch': 13, 'best_valid_valid/acc': 82.785, 'best_valid_valid/acc_unbiased': 82.915, 'best_valid_valid/diff': 7.312, 'best_valid_valid/acc_skew': 79.259, 'best_valid_valid/acc_align': 86.57, 'best_valid_test/acc': 81.688, 'best_valid_test/acc_unbiased': 81.482, 'best_valid_test/diff': 9.916, 'best_valid_test/acc_skew': 76.524, 'best_valid_test/acc_align': 86.44}
[18 / 20] best test accuracy: 81.835 at epoch 7 
 best_stats: {'best_test_epoch': 7, 'best_test_valid/acc': 82.363, 'best_test_valid/acc_unbiased': 82.79, 'best_test_valid/diff': 4.147, 'best_test_valid/acc_skew': 80.716, 'best_test_valid/acc_align': 84.864, 'best_test_test/acc': 81.857, 'best_test_test/acc_unbiased': 81.835, 'best_test_test/diff': 7.111, 'best_test_test/acc_skew': 78.28, 'best_test_test/acc_align': 85.391}
[19 / 20] Learning rate: 1e-05 weight: 0.01
[19 / 20] Loss: 4.353223123452674 CE Loss: 0.3918275532924937 Con Loss: 4.349304849895517
[19 / 20] tensor([[0.841, 0.740],
        [0.788, 0.886]]) {'epoch': 19, 'valid/acc': 82.025, 'valid/acc_unbiased': 82.3, 'valid/diff': 7.838, 'valid/acc_skew': 78.381, 'valid/acc_align': 86.219, 'test/acc': 81.435, 'test/acc_unbiased': 81.35, 'test/diff': 9.909, 'test/acc_skew': 76.395, 'test/acc_align': 86.304}
[19 / 20] best valid accuracy: 82.915 at epoch 13 
 best_stats: {'best_valid_epoch': 13, 'best_valid_valid/acc': 82.785, 'best_valid_valid/acc_unbiased': 82.915, 'best_valid_valid/diff': 7.312, 'best_valid_valid/acc_skew': 79.259, 'best_valid_valid/acc_align': 86.57, 'best_valid_test/acc': 81.688, 'best_valid_test/acc_unbiased': 81.482, 'best_valid_test/diff': 9.916, 'best_valid_test/acc_skew': 76.524, 'best_valid_test/acc_align': 86.44}
[19 / 20] best test accuracy: 81.835 at epoch 7 
 best_stats: {'best_test_epoch': 7, 'best_test_valid/acc': 82.363, 'best_test_valid/acc_unbiased': 82.79, 'best_test_valid/diff': 4.147, 'best_test_valid/acc_skew': 80.716, 'best_test_valid/acc_align': 84.864, 'best_test_test/acc': 81.857, 'best_test_test/acc_unbiased': 81.835, 'best_test_test/diff': 7.111, 'best_test_test/acc_skew': 78.28, 'best_test_test/acc_align': 85.391}
[20 / 20] Learning rate: 1e-05 weight: 0.01
[20 / 20] Loss: 4.358652318030116 CE Loss: 0.3906813322799621 Con Loss: 4.354745507414833
[20 / 20] tensor([[0.826, 0.722],
        [0.803, 0.890]]) {'epoch': 20, 'valid/acc': 81.561, 'valid/acc_unbiased': 81.931, 'valid/diff': 8.564, 'valid/acc_skew': 77.649, 'valid/acc_align': 86.213, 'test/acc': 81.013, 'test/acc_unbiased': 81.039, 'test/diff': 9.544, 'test/acc_skew': 76.267, 'test/acc_align': 85.81}
[20 / 20] best valid accuracy: 82.915 at epoch 13 
 best_stats: {'best_valid_epoch': 13, 'best_valid_valid/acc': 82.785, 'best_valid_valid/acc_unbiased': 82.915, 'best_valid_valid/diff': 7.312, 'best_valid_valid/acc_skew': 79.259, 'best_valid_valid/acc_align': 86.57, 'best_valid_test/acc': 81.688, 'best_valid_test/acc_unbiased': 81.482, 'best_valid_test/diff': 9.916, 'best_valid_test/acc_skew': 76.524, 'best_valid_test/acc_align': 86.44}
[20 / 20] best test accuracy: 81.835 at epoch 7 
 best_stats: {'best_test_epoch': 7, 'best_test_valid/acc': 82.363, 'best_test_valid/acc_unbiased': 82.79, 'best_test_valid/diff': 4.147, 'best_test_valid/acc_skew': 80.716, 'best_test_valid/acc_align': 84.864, 'best_test_test/acc': 81.857, 'best_test_test/acc_unbiased': 81.835, 'best_test_test/diff': 7.111, 'best_test_test/acc_skew': 78.28, 'best_test_test/acc_align': 85.391}
Total training time: 0:16:58
