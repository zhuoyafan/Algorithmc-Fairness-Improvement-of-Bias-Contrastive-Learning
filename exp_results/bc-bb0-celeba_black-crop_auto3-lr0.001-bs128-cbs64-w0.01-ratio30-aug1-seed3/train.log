Log level set to: INFO
Set seed: 3
=======> Using Fixed Random Seed: 3 <========
save_path: exp_results/bc-bb0-celeba_black-crop_auto3-lr0.001-bs128-cbs64-w0.01-ratio30-aug1-seed3
get_celeba - split:train, aug: False, given_y: True, ratio: 0
use existing black indices from data/celeba/pickles/black
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [60544, 38546]
Target 1: [8005, 16093]
Binary Target 1
---------------------------
Target 0: [60544, 38546]
Target 1: [8005, 16093]
===================================
Normal Label Distribution: 
Target 0: [60544, 38546]
Target 1: [8005, 16093]
===================================
Use BiasedCelebASplit 
 target_attr: black split: train 
 tensor([[60544.,  8005.],
        [38546., 16093.]])
get_celeba - split:train, aug: 1, given_y: True, ratio: 30
use existing black indices from data/celeba/pickles/black
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [60623, 38503]
Target 1: [7983, 16079]
Binary Target 1
---------------------------
Target 0: [60623, 38503]
Target 1: [7983, 16079]
===================================
Normal Label Distribution: 
Target 0: [60623, 38503]
Target 1: [7983, 16079]
===================================
Use BiasedCelebASplit 
 target_attr: black split: train 
 tensor([[60623.,  7983.],
        [38503., 16079.]])
get_celeba - split:train_valid, aug: False, given_y: True, ratio: 0
use existing black indices from data/celeba/pickles/black
Use BiasedCelebASplit 
 target_attr: black split: train_valid 
 tensor([[15141.,  1962.],
        [ 9689.,  4006.]])
get_celeba - split:valid, aug: False, given_y: True, ratio: 0
Use BiasedCelebASplit 
 target_attr: black split: valid 
 tensor([[9752., 1657.],
        [5971., 2487.]])
decay_epochs: [3, 6]
[1 / 10] Learning rate: 0.001 weight: 0.01
[1 / 10] Loss: 4.830964164756802 CE Loss: 0.358553907738826 Con Loss: 4.827378616769016
[1 / 10] tensor([[0.986, 0.978],
        [0.220, 0.240]]) {'epoch': 1, 'valid/acc': 83.44, 'valid/acc_unbiased': 59.864, 'valid/diff': 1.681, 'valid/acc_skew': 59.023, 'valid/acc_align': 60.704, 'test/acc': 82.599, 'test/acc_unbiased': 60.566, 'test/diff': 1.408, 'test/acc_skew': 59.862, 'test/acc_align': 61.27}
[1 / 10] best valid accuracy: 59.864 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 83.44, 'best_valid_valid/acc_unbiased': 59.864, 'best_valid_valid/diff': 1.681, 'best_valid_valid/acc_skew': 59.023, 'best_valid_valid/acc_align': 60.704, 'best_valid_test/acc': 82.599, 'best_valid_test/acc_unbiased': 60.566, 'best_valid_test/diff': 1.408, 'best_valid_test/acc_skew': 59.862, 'best_valid_test/acc_align': 61.27}
[1 / 10] best test accuracy: 60.566 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 83.44, 'best_test_valid/acc_unbiased': 59.864, 'best_test_valid/diff': 1.681, 'best_test_valid/acc_skew': 59.023, 'best_test_valid/acc_align': 60.704, 'best_test_test/acc': 82.599, 'best_test_test/acc_unbiased': 60.566, 'best_test_test/diff': 1.408, 'best_test_test/acc_skew': 59.862, 'best_test_test/acc_align': 61.27}
[2 / 10] Learning rate: 0.001 weight: 0.01
[2 / 10] Loss: 4.815307645072805 CE Loss: 0.32157903327949094 Con Loss: 4.812091851097409
[2 / 10] tensor([[0.953, 0.958],
        [0.500, 0.424]]) {'epoch': 2, 'valid/acc': 84.869, 'valid/acc_unbiased': 69.229, 'valid/diff': 5.046, 'valid/acc_skew': 71.752, 'valid/acc_align': 66.706, 'test/acc': 85.086, 'test/acc_unbiased': 70.906, 'test/diff': 4.047, 'test/acc_skew': 72.93, 'test/acc_align': 68.883}
[2 / 10] best valid accuracy: 69.229 at epoch 2 
 best_stats: {'best_valid_epoch': 2, 'best_valid_valid/acc': 84.869, 'best_valid_valid/acc_unbiased': 69.229, 'best_valid_valid/diff': 5.046, 'best_valid_valid/acc_skew': 71.752, 'best_valid_valid/acc_align': 66.706, 'best_valid_test/acc': 85.086, 'best_valid_test/acc_unbiased': 70.906, 'best_valid_test/diff': 4.047, 'best_valid_test/acc_skew': 72.93, 'best_valid_test/acc_align': 68.883}
[2 / 10] best test accuracy: 70.906 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 84.869, 'best_test_valid/acc_unbiased': 69.229, 'best_test_valid/diff': 5.046, 'best_test_valid/acc_skew': 71.752, 'best_test_valid/acc_align': 66.706, 'best_test_test/acc': 85.086, 'best_test_test/acc_unbiased': 70.906, 'best_test_test/diff': 4.047, 'best_test_test/acc_skew': 72.93, 'best_test_test/acc_align': 68.883}
[3 / 10] Learning rate: 0.001 weight: 0.01
[3 / 10] Loss: 4.808235250564621 CE Loss: 0.3155416610175365 Con Loss: 4.805079827932784
[3 / 10] tensor([[0.972, 0.941],
        [0.580, 0.596]]) {'epoch': 3, 'valid/acc': 88.158, 'valid/acc_unbiased': 76.353, 'valid/diff': 1.536, 'valid/acc_skew': 75.876, 'valid/acc_align': 76.83, 'test/acc': 88.292, 'test/acc_unbiased': 77.229, 'test/diff': 2.373, 'test/acc_skew': 76.042, 'test/acc_align': 78.415}
[3 / 10] best valid accuracy: 76.353 at epoch 3 
 best_stats: {'best_valid_epoch': 3, 'best_valid_valid/acc': 88.158, 'best_valid_valid/acc_unbiased': 76.353, 'best_valid_valid/diff': 1.536, 'best_valid_valid/acc_skew': 75.876, 'best_valid_valid/acc_align': 76.83, 'best_valid_test/acc': 88.292, 'best_valid_test/acc_unbiased': 77.229, 'best_valid_test/diff': 2.373, 'best_valid_test/acc_skew': 76.042, 'best_valid_test/acc_align': 78.415}
[3 / 10] best test accuracy: 77.229 at epoch 3 
 best_stats: {'best_test_epoch': 3, 'best_test_valid/acc': 88.158, 'best_test_valid/acc_unbiased': 76.353, 'best_test_valid/diff': 1.536, 'best_test_valid/acc_skew': 75.876, 'best_test_valid/acc_align': 76.83, 'best_test_test/acc': 88.292, 'best_test_test/acc_unbiased': 77.229, 'best_test_test/diff': 2.373, 'best_test_test/acc_skew': 76.042, 'best_test_test/acc_align': 78.415}
[4 / 10] Learning rate: 0.0001 weight: 0.01
[4 / 10] Loss: 4.781927678826358 CE Loss: 0.2799760640764885 Con Loss: 4.779127918574997
[4 / 10] tensor([[0.964, 0.930],
        [0.631, 0.685]]) {'epoch': 4, 'valid/acc': 88.843, 'valid/acc_unbiased': 78.959, 'valid/diff': 1.968, 'valid/acc_skew': 77.974, 'valid/acc_align': 79.943, 'test/acc': 89.108, 'test/acc_unbiased': 80.256, 'test/diff': 4.404, 'test/acc_skew': 78.054, 'test/acc_align': 82.459}
[4 / 10] best valid accuracy: 78.959 at epoch 4 
 best_stats: {'best_valid_epoch': 4, 'best_valid_valid/acc': 88.843, 'best_valid_valid/acc_unbiased': 78.959, 'best_valid_valid/diff': 1.968, 'best_valid_valid/acc_skew': 77.974, 'best_valid_valid/acc_align': 79.943, 'best_valid_test/acc': 89.108, 'best_valid_test/acc_unbiased': 80.256, 'best_valid_test/diff': 4.404, 'best_valid_test/acc_skew': 78.054, 'best_valid_test/acc_align': 82.459}
[4 / 10] best test accuracy: 80.256 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 88.843, 'best_test_valid/acc_unbiased': 78.959, 'best_test_valid/diff': 1.968, 'best_test_valid/acc_skew': 77.974, 'best_test_valid/acc_align': 79.943, 'best_test_test/acc': 89.108, 'best_test_test/acc_unbiased': 80.256, 'best_test_test/diff': 4.404, 'best_test_test/acc_skew': 78.054, 'best_test_test/acc_align': 82.459}
[5 / 10] Learning rate: 0.0001 weight: 0.01
[5 / 10] Loss: 4.770436110727067 CE Loss: 0.2649958286265427 Con Loss: 4.767786147730162
[5 / 10] tensor([[0.968, 0.941],
        [0.635, 0.678]]) {'epoch': 5, 'valid/acc': 89.671, 'valid/acc_unbiased': 79.989, 'valid/diff': 1.855, 'valid/acc_skew': 79.062, 'valid/acc_align': 80.917, 'test/acc': 89.556, 'test/acc_unbiased': 80.521, 'test/diff': 3.5, 'test/acc_skew': 78.771, 'test/acc_align': 82.271}
[5 / 10] best valid accuracy: 79.989 at epoch 5 
 best_stats: {'best_valid_epoch': 5, 'best_valid_valid/acc': 89.671, 'best_valid_valid/acc_unbiased': 79.989, 'best_valid_valid/diff': 1.855, 'best_valid_valid/acc_skew': 79.062, 'best_valid_valid/acc_align': 80.917, 'best_valid_test/acc': 89.556, 'best_valid_test/acc_unbiased': 80.521, 'best_valid_test/diff': 3.5, 'best_valid_test/acc_skew': 78.771, 'best_valid_test/acc_align': 82.271}
[5 / 10] best test accuracy: 80.521 at epoch 5 
 best_stats: {'best_test_epoch': 5, 'best_test_valid/acc': 89.671, 'best_test_valid/acc_unbiased': 79.989, 'best_test_valid/diff': 1.855, 'best_test_valid/acc_skew': 79.062, 'best_test_valid/acc_align': 80.917, 'best_test_test/acc': 89.556, 'best_test_test/acc_unbiased': 80.521, 'best_test_test/diff': 3.5, 'best_test_test/acc_skew': 78.771, 'best_test_test/acc_align': 82.271}
[6 / 10] Learning rate: 0.0001 weight: 0.01
[6 / 10] Loss: 4.7694412478960295 CE Loss: 0.2613690652384574 Con Loss: 4.7668275493737395
[6 / 10] tensor([[0.941, 0.907],
        [0.744, 0.750]]) {'epoch': 6, 'valid/acc': 88.912, 'valid/acc_unbiased': 82.936, 'valid/diff': 2.691, 'valid/acc_skew': 82.855, 'valid/acc_align': 83.018, 'test/acc': 89.052, 'test/acc_unbiased': 83.558, 'test/diff': 1.967, 'test/acc_skew': 82.575, 'test/acc_align': 84.542}
[6 / 10] best valid accuracy: 82.936 at epoch 6 
 best_stats: {'best_valid_epoch': 6, 'best_valid_valid/acc': 88.912, 'best_valid_valid/acc_unbiased': 82.936, 'best_valid_valid/diff': 2.691, 'best_valid_valid/acc_skew': 82.855, 'best_valid_valid/acc_align': 83.018, 'best_valid_test/acc': 89.052, 'best_valid_test/acc_unbiased': 83.558, 'best_valid_test/diff': 1.967, 'best_valid_test/acc_skew': 82.575, 'best_valid_test/acc_align': 84.542}
[6 / 10] best test accuracy: 83.558 at epoch 6 
 best_stats: {'best_test_epoch': 6, 'best_test_valid/acc': 88.912, 'best_test_valid/acc_unbiased': 82.936, 'best_test_valid/diff': 2.691, 'best_test_valid/acc_skew': 82.855, 'best_test_valid/acc_align': 83.018, 'best_test_test/acc': 89.052, 'best_test_test/acc_unbiased': 83.558, 'best_test_test/diff': 1.967, 'best_test_test/acc_skew': 82.575, 'best_test_test/acc_align': 84.542}
[7 / 10] Learning rate: 1e-05 weight: 0.01
[7 / 10] Loss: 4.7678478432927935 CE Loss: 0.2562605284177882 Con Loss: 4.765285234766842
[7 / 10] tensor([[0.953, 0.930],
        [0.710, 0.712]]) {'epoch': 7, 'valid/acc': 89.529, 'valid/acc_unbiased': 82.197, 'valid/diff': 2.904, 'valid/acc_skew': 82.582, 'valid/acc_align': 81.812, 'test/acc': 89.591, 'test/acc_unbiased': 82.636, 'test/diff': 1.283, 'test/acc_skew': 81.994, 'test/acc_align': 83.277}
[7 / 10] best valid accuracy: 82.936 at epoch 6 
 best_stats: {'best_valid_epoch': 6, 'best_valid_valid/acc': 88.912, 'best_valid_valid/acc_unbiased': 82.936, 'best_valid_valid/diff': 2.691, 'best_valid_valid/acc_skew': 82.855, 'best_valid_valid/acc_align': 83.018, 'best_valid_test/acc': 89.052, 'best_valid_test/acc_unbiased': 83.558, 'best_valid_test/diff': 1.967, 'best_valid_test/acc_skew': 82.575, 'best_valid_test/acc_align': 84.542}
[7 / 10] best test accuracy: 83.558 at epoch 6 
 best_stats: {'best_test_epoch': 6, 'best_test_valid/acc': 88.912, 'best_test_valid/acc_unbiased': 82.936, 'best_test_valid/diff': 2.691, 'best_test_valid/acc_skew': 82.855, 'best_test_valid/acc_align': 83.018, 'best_test_test/acc': 89.052, 'best_test_test/acc_unbiased': 83.558, 'best_test_test/diff': 1.967, 'best_test_test/acc_skew': 82.575, 'best_test_test/acc_align': 84.542}
[8 / 10] Learning rate: 1e-05 weight: 0.01
[8 / 10] Loss: 4.762086700711091 CE Loss: 0.25177384255365703 Con Loss: 4.759568961420612
[8 / 10] tensor([[0.957, 0.935],
        [0.695, 0.708]]) {'epoch': 8, 'valid/acc': 89.694, 'valid/acc_unbiased': 81.678, 'valid/diff': 1.943, 'valid/acc_skew': 81.658, 'valid/acc_align': 81.699, 'test/acc': 89.757, 'test/acc_unbiased': 82.394, 'test/diff': 1.745, 'test/acc_skew': 81.521, 'test/acc_align': 83.266}
[8 / 10] best valid accuracy: 82.936 at epoch 6 
 best_stats: {'best_valid_epoch': 6, 'best_valid_valid/acc': 88.912, 'best_valid_valid/acc_unbiased': 82.936, 'best_valid_valid/diff': 2.691, 'best_valid_valid/acc_skew': 82.855, 'best_valid_valid/acc_align': 83.018, 'best_valid_test/acc': 89.052, 'best_valid_test/acc_unbiased': 83.558, 'best_valid_test/diff': 1.967, 'best_valid_test/acc_skew': 82.575, 'best_valid_test/acc_align': 84.542}
[8 / 10] best test accuracy: 83.558 at epoch 6 
 best_stats: {'best_test_epoch': 6, 'best_test_valid/acc': 88.912, 'best_test_valid/acc_unbiased': 82.936, 'best_test_valid/diff': 2.691, 'best_test_valid/acc_skew': 82.855, 'best_test_valid/acc_align': 83.018, 'best_test_test/acc': 89.052, 'best_test_test/acc_unbiased': 83.558, 'best_test_test/diff': 1.967, 'best_test_test/acc_skew': 82.575, 'best_test_test/acc_align': 84.542}
[9 / 10] Learning rate: 1e-05 weight: 0.01
[9 / 10] Loss: 4.764412091816269 CE Loss: 0.24800280919679865 Con Loss: 4.761932068956159
[9 / 10] tensor([[0.961, 0.937],
        [0.693, 0.704]]) {'epoch': 9, 'valid/acc': 89.951, 'valid/acc_unbiased': 81.757, 'valid/diff': 1.776, 'valid/acc_skew': 81.83, 'valid/acc_align': 81.684, 'test/acc': 89.918, 'test/acc_unbiased': 82.364, 'test/diff': 1.71, 'test/acc_skew': 81.509, 'test/acc_align': 83.219}
[9 / 10] best valid accuracy: 82.936 at epoch 6 
 best_stats: {'best_valid_epoch': 6, 'best_valid_valid/acc': 88.912, 'best_valid_valid/acc_unbiased': 82.936, 'best_valid_valid/diff': 2.691, 'best_valid_valid/acc_skew': 82.855, 'best_valid_valid/acc_align': 83.018, 'best_valid_test/acc': 89.052, 'best_valid_test/acc_unbiased': 83.558, 'best_valid_test/diff': 1.967, 'best_valid_test/acc_skew': 82.575, 'best_valid_test/acc_align': 84.542}
[9 / 10] best test accuracy: 83.558 at epoch 6 
 best_stats: {'best_test_epoch': 6, 'best_test_valid/acc': 88.912, 'best_test_valid/acc_unbiased': 82.936, 'best_test_valid/diff': 2.691, 'best_test_valid/acc_skew': 82.855, 'best_test_valid/acc_align': 83.018, 'best_test_test/acc': 89.052, 'best_test_test/acc_unbiased': 83.558, 'best_test_test/diff': 1.967, 'best_test_test/acc_skew': 82.575, 'best_test_test/acc_align': 84.542}
[10 / 10] Learning rate: 1e-05 weight: 0.01
[10 / 10] Loss: 4.764038931353044 CE Loss: 0.24656833859392974 Con Loss: 4.761573252408664
[10 / 10] tensor([[0.962, 0.940],
        [0.684, 0.701]]) {'epoch': 10, 'valid/acc': 89.99, 'valid/acc_unbiased': 81.77, 'valid/diff': 2.121, 'valid/acc_skew': 82.06, 'valid/acc_align': 81.48, 'test/acc': 89.933, 'test/acc_unbiased': 82.165, 'test/diff': 1.939, 'test/acc_skew': 81.196, 'test/acc_align': 83.135}
[10 / 10] best valid accuracy: 82.936 at epoch 6 
 best_stats: {'best_valid_epoch': 6, 'best_valid_valid/acc': 88.912, 'best_valid_valid/acc_unbiased': 82.936, 'best_valid_valid/diff': 2.691, 'best_valid_valid/acc_skew': 82.855, 'best_valid_valid/acc_align': 83.018, 'best_valid_test/acc': 89.052, 'best_valid_test/acc_unbiased': 83.558, 'best_valid_test/diff': 1.967, 'best_valid_test/acc_skew': 82.575, 'best_valid_test/acc_align': 84.542}
[10 / 10] best test accuracy: 83.558 at epoch 6 
 best_stats: {'best_test_epoch': 6, 'best_test_valid/acc': 88.912, 'best_test_valid/acc_unbiased': 82.936, 'best_test_valid/diff': 2.691, 'best_test_valid/acc_skew': 82.855, 'best_test_valid/acc_align': 83.018, 'best_test_test/acc': 89.052, 'best_test_test/acc_unbiased': 83.558, 'best_test_test/diff': 1.967, 'best_test_test/acc_skew': 82.575, 'best_test_test/acc_align': 84.542}
Total training time: 2:08:51
