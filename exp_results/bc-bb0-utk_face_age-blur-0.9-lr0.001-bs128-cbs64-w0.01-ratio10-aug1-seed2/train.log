Log level set to: INFO
Set seed: 2
=======> Using Fixed Random Seed: 2 <========
save_path: exp_results/bc-bb0-utk_face_age-blur-0.9-lr0.001-bs128-cbs64-w0.01-ratio10-aug1-seed2
get_utk_face - split: train, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_age-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
Binary Target 1
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Normal Label Distribution: 
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
Binary Target 1
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Normal Label Distribution: 
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 10684, target_attr: gender, bias_attr: age bias_rate: 0.9
['[train] target_0-bias_0: 8237', '[train] target_0-bias_1: 147', '[train] target_1-bias_0: 823', '[train] target_1-bias_1: 1477']
confusion_matrix - 
 original: tensor([[8237.,  823.],
        [ 147., 1477.]]), 
 normalized: tensor([[0.909, 0.091],
        [0.091, 0.909]]), 
 b|y: tensor([[0.982, 0.018],
        [0.358, 0.642]])
get_utk_face - split: train, aug: 1, given_y: True, ratio: 10
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_age-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
Binary Target 1
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Normal Label Distribution: 
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
Binary Target 1
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Normal Label Distribution: 
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 10684, target_attr: gender, bias_attr: age bias_rate: 0.9
['[train] target_0-bias_0: 8237', '[train] target_0-bias_1: 147', '[train] target_1-bias_0: 823', '[train] target_1-bias_1: 1477']
get_utk_face - split: valid, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_age-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [1030, 195]
Target 1: [841, 202]
Binary Target 1
---------------------------
Target 0: [1030, 195]
Target 1: [841, 202]
===================================
Normal Label Distribution: 
Target 0: [1030, 195]
Target 1: [841, 202]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 2268, target_attr: gender, bias_attr: age bias_rate: 0.9
['[valid] target_0-bias_0: 1030', '[valid] target_0-bias_1: 195', '[valid] target_1-bias_0: 841', '[valid] target_1-bias_1: 202']
get_utk_face - split: test, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_age-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [1061, 176]
Target 1: [867, 165]
Binary Target 1
---------------------------
Target 0: [1061, 176]
Target 1: [867, 165]
===================================
Normal Label Distribution: 
Target 0: [1061, 176]
Target 1: [867, 165]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 2269, target_attr: gender, bias_attr: age bias_rate: 0.9
['[test] target_0-bias_0: 1061', '[test] target_0-bias_1: 176', '[test] target_1-bias_0: 867', '[test] target_1-bias_1: 165']
decay_epochs: [6, 13]
[1 / 20] Learning rate: 0.001 weight: 0.01
[1 / 20] Loss: 4.893264775327956 CE Loss: 0.5456285923440463 Con Loss: 4.887808511249138
[1 / 20] tensor([[1.000, 1.000],
        [0.003, 0.000]]) {'epoch': 1, 'valid/acc': 54.233, 'valid/acc_unbiased': 50.149, 'valid/diff': 0.297, 'valid/acc_skew': 50.297, 'valid/acc_align': 50.0, 'test/acc': 54.65, 'test/acc_unbiased': 50.087, 'test/diff': 0.173, 'test/acc_skew': 50.173, 'test/acc_align': 50.0}
[1 / 20] best valid accuracy: 50.149 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 54.233, 'best_valid_valid/acc_unbiased': 50.149, 'best_valid_valid/diff': 0.297, 'best_valid_valid/acc_skew': 50.297, 'best_valid_valid/acc_align': 50.0, 'best_valid_test/acc': 54.65, 'best_valid_test/acc_unbiased': 50.087, 'best_valid_test/diff': 0.173, 'best_valid_test/acc_skew': 50.173, 'best_valid_test/acc_align': 50.0}
[1 / 20] best test accuracy: 50.087 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 54.233, 'best_test_valid/acc_unbiased': 50.149, 'best_test_valid/diff': 0.297, 'best_test_valid/acc_skew': 50.297, 'best_test_valid/acc_align': 50.0, 'best_test_test/acc': 54.65, 'best_test_test/acc_unbiased': 50.087, 'best_test_test/diff': 0.173, 'best_test_test/acc_skew': 50.173, 'best_test_test/acc_align': 50.0}
[2 / 20] Learning rate: 0.001 weight: 0.01
[2 / 20] Loss: 4.611248281465314 CE Loss: 0.5004877176167857 Con Loss: 4.606243384727955
[2 / 20] tensor([[0.969, 0.898],
        [0.273, 0.158]]) {'epoch': 2, 'valid/acc': 63.713, 'valid/acc_unbiased': 58.252, 'valid/diff': 8.354, 'valid/acc_skew': 60.185, 'valid/acc_align': 56.319, 'test/acc': 63.861, 'test/acc_unbiased': 57.439, 'test/diff': 9.348, 'test/acc_skew': 58.554, 'test/acc_align': 56.324}
[2 / 20] best valid accuracy: 58.252 at epoch 2 
 best_stats: {'best_valid_epoch': 2, 'best_valid_valid/acc': 63.713, 'best_valid_valid/acc_unbiased': 58.252, 'best_valid_valid/diff': 8.354, 'best_valid_valid/acc_skew': 60.185, 'best_valid_valid/acc_align': 56.319, 'best_valid_test/acc': 63.861, 'best_valid_test/acc_unbiased': 57.439, 'best_valid_test/diff': 9.348, 'best_valid_test/acc_skew': 58.554, 'best_valid_test/acc_align': 56.324}
[2 / 20] best test accuracy: 57.439 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 63.713, 'best_test_valid/acc_unbiased': 58.252, 'best_test_valid/diff': 8.354, 'best_test_valid/acc_skew': 60.185, 'best_test_valid/acc_align': 56.319, 'best_test_test/acc': 63.861, 'best_test_test/acc_unbiased': 57.439, 'best_test_test/diff': 9.348, 'best_test_test/acc_skew': 58.554, 'best_test_test/acc_align': 56.324}
[3 / 20] Learning rate: 0.001 weight: 0.01
[3 / 20] Loss: 4.546000969271587 CE Loss: 0.48391045920637293 Con Loss: 4.5411618631549295
[3 / 20] tensor([[0.893, 0.705],
        [0.651, 0.515]]) {'epoch': 3, 'valid/acc': 73.898, 'valid/acc_unbiased': 67.66, 'valid/diff': 15.135, 'valid/acc_skew': 63.651, 'valid/acc_align': 71.67, 'test/acc': 75.804, 'test/acc_unbiased': 69.069, 'test/diff': 16.169, 'test/acc_skew': 67.753, 'test/acc_align': 70.385}
[3 / 20] best valid accuracy: 67.660 at epoch 3 
 best_stats: {'best_valid_epoch': 3, 'best_valid_valid/acc': 73.898, 'best_valid_valid/acc_unbiased': 67.66, 'best_valid_valid/diff': 15.135, 'best_valid_valid/acc_skew': 63.651, 'best_valid_valid/acc_align': 71.67, 'best_valid_test/acc': 75.804, 'best_valid_test/acc_unbiased': 69.069, 'best_valid_test/diff': 16.169, 'best_valid_test/acc_skew': 67.753, 'best_valid_test/acc_align': 70.385}
[3 / 20] best test accuracy: 69.069 at epoch 3 
 best_stats: {'best_test_epoch': 3, 'best_test_valid/acc': 73.898, 'best_test_valid/acc_unbiased': 67.66, 'best_test_valid/diff': 15.135, 'best_test_valid/acc_skew': 63.651, 'best_test_valid/acc_align': 71.67, 'best_test_test/acc': 75.804, 'best_test_test/acc_unbiased': 69.069, 'best_test_test/diff': 16.169, 'best_test_test/acc_skew': 67.753, 'best_test_test/acc_align': 70.385}
[4 / 20] Learning rate: 0.001 weight: 0.01
[4 / 20] Loss: 4.434318608534287 CE Loss: 0.456666245057939 Con Loss: 4.429751922824507
[4 / 20] tensor([[0.949, 0.818],
        [0.548, 0.455]]) {'epoch': 4, 'valid/acc': 72.795, 'valid/acc_unbiased': 67.681, 'valid/diff': 10.33, 'valid/acc_skew': 65.308, 'valid/acc_align': 70.054, 'test/acc': 74.967, 'test/acc_unbiased': 69.242, 'test/diff': 11.212, 'test/acc_skew': 68.302, 'test/acc_align': 70.183}
[4 / 20] best valid accuracy: 67.681 at epoch 4 
 best_stats: {'best_valid_epoch': 4, 'best_valid_valid/acc': 72.795, 'best_valid_valid/acc_unbiased': 67.681, 'best_valid_valid/diff': 10.33, 'best_valid_valid/acc_skew': 65.308, 'best_valid_valid/acc_align': 70.054, 'best_valid_test/acc': 74.967, 'best_valid_test/acc_unbiased': 69.242, 'best_valid_test/diff': 11.212, 'best_valid_test/acc_skew': 68.302, 'best_valid_test/acc_align': 70.183}
[4 / 20] best test accuracy: 69.242 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 72.795, 'best_test_valid/acc_unbiased': 67.681, 'best_test_valid/diff': 10.33, 'best_test_valid/acc_skew': 65.308, 'best_test_valid/acc_align': 70.054, 'best_test_test/acc': 74.967, 'best_test_test/acc_unbiased': 69.242, 'best_test_test/diff': 11.212, 'best_test_test/acc_skew': 68.302, 'best_test_test/acc_align': 70.183}
[5 / 20] Learning rate: 0.001 weight: 0.01
[5 / 20] Loss: 4.341718616935475 CE Loss: 0.42958733207364513 Con Loss: 4.337422723316691
[5 / 20] tensor([[0.959, 0.705],
        [0.544, 0.503]]) {'epoch': 5, 'valid/acc': 73.06, 'valid/acc_unbiased': 66.657, 'valid/diff': 18.074, 'valid/acc_skew': 57.62, 'valid/acc_align': 75.694, 'test/acc': 74.747, 'test/acc_unbiased': 67.763, 'test/diff': 14.768, 'test/acc_skew': 62.448, 'test/acc_align': 73.078}
[5 / 20] best valid accuracy: 67.681 at epoch 4 
 best_stats: {'best_valid_epoch': 4, 'best_valid_valid/acc': 72.795, 'best_valid_valid/acc_unbiased': 67.681, 'best_valid_valid/diff': 10.33, 'best_valid_valid/acc_skew': 65.308, 'best_valid_valid/acc_align': 70.054, 'best_valid_test/acc': 74.967, 'best_valid_test/acc_unbiased': 69.242, 'best_valid_test/diff': 11.212, 'best_valid_test/acc_skew': 68.302, 'best_valid_test/acc_align': 70.183}
[5 / 20] best test accuracy: 69.242 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 72.795, 'best_test_valid/acc_unbiased': 67.681, 'best_test_valid/diff': 10.33, 'best_test_valid/acc_skew': 65.308, 'best_test_valid/acc_align': 70.054, 'best_test_test/acc': 74.967, 'best_test_test/acc_unbiased': 69.242, 'best_test_test/diff': 11.212, 'best_test_test/acc_skew': 68.302, 'best_test_test/acc_align': 70.183}
[6 / 20] Learning rate: 0.001 weight: 0.01
[6 / 20] Loss: 4.3273174383362685 CE Loss: 0.4231624015928073 Con Loss: 4.323085809726922
[6 / 20] tensor([[0.956, 0.705],
        [0.572, 0.515]]) {'epoch': 6, 'valid/acc': 73.765, 'valid/acc_unbiased': 67.274, 'valid/diff': 17.413, 'valid/acc_skew': 58.567, 'valid/acc_align': 75.98, 'test/acc': 75.76, 'test/acc_unbiased': 68.687, 'test/diff': 15.405, 'test/acc_skew': 63.832, 'test/acc_align': 73.543}
[6 / 20] best valid accuracy: 67.681 at epoch 4 
 best_stats: {'best_valid_epoch': 4, 'best_valid_valid/acc': 72.795, 'best_valid_valid/acc_unbiased': 67.681, 'best_valid_valid/diff': 10.33, 'best_valid_valid/acc_skew': 65.308, 'best_valid_valid/acc_align': 70.054, 'best_valid_test/acc': 74.967, 'best_valid_test/acc_unbiased': 69.242, 'best_valid_test/diff': 11.212, 'best_valid_test/acc_skew': 68.302, 'best_valid_test/acc_align': 70.183}
[6 / 20] best test accuracy: 69.242 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 72.795, 'best_test_valid/acc_unbiased': 67.681, 'best_test_valid/diff': 10.33, 'best_test_valid/acc_skew': 65.308, 'best_test_valid/acc_align': 70.054, 'best_test_test/acc': 74.967, 'best_test_test/acc_unbiased': 69.242, 'best_test_test/diff': 11.212, 'best_test_test/acc_skew': 68.302, 'best_test_test/acc_align': 70.183}
[7 / 20] Learning rate: 0.0001 weight: 0.01
[7 / 20] Loss: 4.13187125665514 CE Loss: 0.39169606286369874 Con Loss: 4.12795430763256
[7 / 20] tensor([[0.977, 0.642],
        [0.588, 0.733]]) {'epoch': 7, 'valid/acc': 76.499, 'valid/acc_unbiased': 70.543, 'valid/diff': 29.852, 'valid/acc_skew': 55.617, 'valid/acc_align': 85.469, 'test/acc': 78.493, 'test/acc_unbiased': 73.525, 'test/diff': 24.022, 'test/acc_skew': 61.514, 'test/acc_align': 85.536}
[7 / 20] best valid accuracy: 70.543 at epoch 7 
 best_stats: {'best_valid_epoch': 7, 'best_valid_valid/acc': 76.499, 'best_valid_valid/acc_unbiased': 70.543, 'best_valid_valid/diff': 29.852, 'best_valid_valid/acc_skew': 55.617, 'best_valid_valid/acc_align': 85.469, 'best_valid_test/acc': 78.493, 'best_valid_test/acc_unbiased': 73.525, 'best_valid_test/diff': 24.022, 'best_valid_test/acc_skew': 61.514, 'best_valid_test/acc_align': 85.536}
[7 / 20] best test accuracy: 73.525 at epoch 7 
 best_stats: {'best_test_epoch': 7, 'best_test_valid/acc': 76.499, 'best_test_valid/acc_unbiased': 70.543, 'best_test_valid/diff': 29.852, 'best_test_valid/acc_skew': 55.617, 'best_test_valid/acc_align': 85.469, 'best_test_test/acc': 78.493, 'best_test_test/acc_unbiased': 73.525, 'best_test_test/diff': 24.022, 'best_test_test/acc_skew': 61.514, 'best_test_test/acc_align': 85.536}
[8 / 20] Learning rate: 0.0001 weight: 0.01
[8 / 20] Loss: 4.02022387971596 CE Loss: 0.3540710996639769 Con Loss: 4.016683147534678
[8 / 20] tensor([[0.976, 0.591],
        [0.630, 0.770]]) {'epoch': 8, 'valid/acc': 76.631, 'valid/acc_unbiased': 69.615, 'valid/diff': 30.94, 'valid/acc_skew': 54.145, 'valid/acc_align': 85.085, 'test/acc': 79.903, 'test/acc_unbiased': 74.17, 'test/diff': 26.273, 'test/acc_skew': 61.033, 'test/acc_align': 87.307}
[8 / 20] best valid accuracy: 70.543 at epoch 7 
 best_stats: {'best_valid_epoch': 7, 'best_valid_valid/acc': 76.499, 'best_valid_valid/acc_unbiased': 70.543, 'best_valid_valid/diff': 29.852, 'best_valid_valid/acc_skew': 55.617, 'best_valid_valid/acc_align': 85.469, 'best_valid_test/acc': 78.493, 'best_valid_test/acc_unbiased': 73.525, 'best_valid_test/diff': 24.022, 'best_valid_test/acc_skew': 61.514, 'best_valid_test/acc_align': 85.536}
[8 / 20] best test accuracy: 74.170 at epoch 8 
 best_stats: {'best_test_epoch': 8, 'best_test_valid/acc': 76.631, 'best_test_valid/acc_unbiased': 69.615, 'best_test_valid/diff': 30.94, 'best_test_valid/acc_skew': 54.145, 'best_test_valid/acc_align': 85.085, 'best_test_test/acc': 79.903, 'best_test_test/acc_unbiased': 74.17, 'best_test_test/diff': 26.273, 'best_test_test/acc_skew': 61.033, 'best_test_test/acc_align': 87.307}
[9 / 20] Learning rate: 0.0001 weight: 0.01
[9 / 20] Loss: 3.9193215220218205 CE Loss: 0.3354130708091226 Con Loss: 3.9159673875032492
[9 / 20] tensor([[0.979, 0.602],
        [0.593, 0.709]]) {'epoch': 9, 'valid/acc': 76.102, 'valid/acc_unbiased': 69.329, 'valid/diff': 27.425, 'valid/acc_skew': 55.617, 'valid/acc_align': 83.042, 'test/acc': 78.272, 'test/acc_unbiased': 72.087, 'test/diff': 24.662, 'test/acc_skew': 59.756, 'test/acc_align': 84.418}
[9 / 20] best valid accuracy: 70.543 at epoch 7 
 best_stats: {'best_valid_epoch': 7, 'best_valid_valid/acc': 76.499, 'best_valid_valid/acc_unbiased': 70.543, 'best_valid_valid/diff': 29.852, 'best_valid_valid/acc_skew': 55.617, 'best_valid_valid/acc_align': 85.469, 'best_valid_test/acc': 78.493, 'best_valid_test/acc_unbiased': 73.525, 'best_valid_test/diff': 24.022, 'best_valid_test/acc_skew': 61.514, 'best_valid_test/acc_align': 85.536}
[9 / 20] best test accuracy: 74.170 at epoch 8 
 best_stats: {'best_test_epoch': 8, 'best_test_valid/acc': 76.631, 'best_test_valid/acc_unbiased': 69.615, 'best_test_valid/diff': 30.94, 'best_test_valid/acc_skew': 54.145, 'best_test_valid/acc_align': 85.085, 'best_test_test/acc': 79.903, 'best_test_test/acc_unbiased': 74.17, 'best_test_test/diff': 26.273, 'best_test_test/acc_skew': 61.033, 'best_test_test/acc_align': 87.307}
[10 / 20] Learning rate: 0.0001 weight: 0.01
[10 / 20] Loss: 3.8743232463192556 CE Loss: 0.32678451011105897 Con Loss: 3.8710554039732696
[10 / 20] tensor([[0.977, 0.540],
        [0.596, 0.758]]) {'epoch': 10, 'valid/acc': 76.279, 'valid/acc_unbiased': 69.678, 'valid/diff': 34.552, 'valid/acc_skew': 52.402, 'valid/acc_align': 86.954, 'test/acc': 78.184, 'test/acc_unbiased': 71.776, 'test/diff': 29.944, 'test/acc_skew': 56.804, 'test/acc_align': 86.748}
[10 / 20] best valid accuracy: 70.543 at epoch 7 
 best_stats: {'best_valid_epoch': 7, 'best_valid_valid/acc': 76.499, 'best_valid_valid/acc_unbiased': 70.543, 'best_valid_valid/diff': 29.852, 'best_valid_valid/acc_skew': 55.617, 'best_valid_valid/acc_align': 85.469, 'best_valid_test/acc': 78.493, 'best_valid_test/acc_unbiased': 73.525, 'best_valid_test/diff': 24.022, 'best_valid_test/acc_skew': 61.514, 'best_valid_test/acc_align': 85.536}
[10 / 20] best test accuracy: 74.170 at epoch 8 
 best_stats: {'best_test_epoch': 8, 'best_test_valid/acc': 76.631, 'best_test_valid/acc_unbiased': 69.615, 'best_test_valid/diff': 30.94, 'best_test_valid/acc_skew': 54.145, 'best_test_valid/acc_align': 85.085, 'best_test_test/acc': 79.903, 'best_test_test/acc_unbiased': 74.17, 'best_test_test/diff': 26.273, 'best_test_test/acc_skew': 61.033, 'best_test_test/acc_align': 87.307}
[11 / 20] Learning rate: 0.0001 weight: 0.01
[11 / 20] Loss: 3.8308412124493825 CE Loss: 0.3241567716019201 Con Loss: 3.8275996405995323
[11 / 20] tensor([[0.983, 0.574],
        [0.573, 0.776]]) {'epoch': 11, 'valid/acc': 75.132, 'valid/acc_unbiased': 68.535, 'valid/diff': 35.157, 'valid/acc_skew': 50.957, 'valid/acc_align': 86.114, 'test/acc': 77.964, 'test/acc_unbiased': 72.647, 'test/diff': 30.584, 'test/acc_skew': 57.355, 'test/acc_align': 87.94}
[11 / 20] best valid accuracy: 70.543 at epoch 7 
 best_stats: {'best_valid_epoch': 7, 'best_valid_valid/acc': 76.499, 'best_valid_valid/acc_unbiased': 70.543, 'best_valid_valid/diff': 29.852, 'best_valid_valid/acc_skew': 55.617, 'best_valid_valid/acc_align': 85.469, 'best_valid_test/acc': 78.493, 'best_valid_test/acc_unbiased': 73.525, 'best_valid_test/diff': 24.022, 'best_valid_test/acc_skew': 61.514, 'best_valid_test/acc_align': 85.536}
[11 / 20] best test accuracy: 74.170 at epoch 8 
 best_stats: {'best_test_epoch': 8, 'best_test_valid/acc': 76.631, 'best_test_valid/acc_unbiased': 69.615, 'best_test_valid/diff': 30.94, 'best_test_valid/acc_skew': 54.145, 'best_test_valid/acc_align': 85.085, 'best_test_test/acc': 79.903, 'best_test_test/acc_unbiased': 74.17, 'best_test_test/diff': 26.273, 'best_test_test/acc_skew': 61.033, 'best_test_test/acc_align': 87.307}
[12 / 20] Learning rate: 0.0001 weight: 0.01
[12 / 20] Loss: 3.880312391721725 CE Loss: 0.32361057069318566 Con Loss: 3.8770763092119567
[12 / 20] tensor([[0.977, 0.580],
        [0.608, 0.788]]) {'epoch': 12, 'valid/acc': 77.072, 'valid/acc_unbiased': 70.433, 'valid/diff': 30.964, 'valid/acc_skew': 54.951, 'valid/acc_align': 85.915, 'test/acc': 79.154, 'test/acc_unbiased': 73.816, 'test/diff': 28.894, 'test/acc_skew': 59.369, 'test/acc_align': 88.263}
[12 / 20] best valid accuracy: 70.543 at epoch 7 
 best_stats: {'best_valid_epoch': 7, 'best_valid_valid/acc': 76.499, 'best_valid_valid/acc_unbiased': 70.543, 'best_valid_valid/diff': 29.852, 'best_valid_valid/acc_skew': 55.617, 'best_valid_valid/acc_align': 85.469, 'best_valid_test/acc': 78.493, 'best_valid_test/acc_unbiased': 73.525, 'best_valid_test/diff': 24.022, 'best_valid_test/acc_skew': 61.514, 'best_valid_test/acc_align': 85.536}
[12 / 20] best test accuracy: 74.170 at epoch 8 
 best_stats: {'best_test_epoch': 8, 'best_test_valid/acc': 76.631, 'best_test_valid/acc_unbiased': 69.615, 'best_test_valid/diff': 30.94, 'best_test_valid/acc_skew': 54.145, 'best_test_valid/acc_align': 85.085, 'best_test_test/acc': 79.903, 'best_test_test/acc_unbiased': 74.17, 'best_test_test/diff': 26.273, 'best_test_test/acc_skew': 61.033, 'best_test_test/acc_align': 87.307}
[13 / 20] Learning rate: 0.0001 weight: 0.01
[13 / 20] Loss: 3.792753150247983 CE Loss: 0.31802071240991747 Con Loss: 3.789572947929522
[13 / 20] tensor([[0.977, 0.517],
        [0.639, 0.800]]) {'epoch': 13, 'valid/acc': 77.337, 'valid/acc_unbiased': 70.296, 'valid/diff': 36.597, 'valid/acc_skew': 51.997, 'valid/acc_align': 88.594, 'test/acc': 79.947, 'test/acc_unbiased': 73.335, 'test/diff': 31.067, 'test/acc_skew': 57.802, 'test/acc_align': 88.869}
[13 / 20] best valid accuracy: 70.543 at epoch 7 
 best_stats: {'best_valid_epoch': 7, 'best_valid_valid/acc': 76.499, 'best_valid_valid/acc_unbiased': 70.543, 'best_valid_valid/diff': 29.852, 'best_valid_valid/acc_skew': 55.617, 'best_valid_valid/acc_align': 85.469, 'best_valid_test/acc': 78.493, 'best_valid_test/acc_unbiased': 73.525, 'best_valid_test/diff': 24.022, 'best_valid_test/acc_skew': 61.514, 'best_valid_test/acc_align': 85.536}
[13 / 20] best test accuracy: 74.170 at epoch 8 
 best_stats: {'best_test_epoch': 8, 'best_test_valid/acc': 76.631, 'best_test_valid/acc_unbiased': 69.615, 'best_test_valid/diff': 30.94, 'best_test_valid/acc_skew': 54.145, 'best_test_valid/acc_align': 85.085, 'best_test_test/acc': 79.903, 'best_test_test/acc_unbiased': 74.17, 'best_test_test/diff': 26.273, 'best_test_test/acc_skew': 61.033, 'best_test_test/acc_align': 87.307}
[14 / 20] Learning rate: 1e-05 weight: 0.01
[14 / 20] Loss: 3.7648804566245184 CE Loss: 0.3330777284805358 Con Loss: 3.7615496841810563
[14 / 20] tensor([[0.979, 0.517],
        [0.622, 0.812]]) {'epoch': 14, 'valid/acc': 77.116, 'valid/acc_unbiased': 69.841, 'valid/diff': 37.701, 'valid/acc_skew': 50.99, 'valid/acc_align': 88.691, 'test/acc': 79.462, 'test/acc_unbiased': 73.253, 'test/diff': 32.633, 'test/acc_skew': 56.936, 'test/acc_align': 89.569}
[14 / 20] best valid accuracy: 70.543 at epoch 7 
 best_stats: {'best_valid_epoch': 7, 'best_valid_valid/acc': 76.499, 'best_valid_valid/acc_unbiased': 70.543, 'best_valid_valid/diff': 29.852, 'best_valid_valid/acc_skew': 55.617, 'best_valid_valid/acc_align': 85.469, 'best_valid_test/acc': 78.493, 'best_valid_test/acc_unbiased': 73.525, 'best_valid_test/diff': 24.022, 'best_valid_test/acc_skew': 61.514, 'best_valid_test/acc_align': 85.536}
[14 / 20] best test accuracy: 74.170 at epoch 8 
 best_stats: {'best_test_epoch': 8, 'best_test_valid/acc': 76.631, 'best_test_valid/acc_unbiased': 69.615, 'best_test_valid/diff': 30.94, 'best_test_valid/acc_skew': 54.145, 'best_test_valid/acc_align': 85.085, 'best_test_test/acc': 79.903, 'best_test_test/acc_unbiased': 74.17, 'best_test_test/diff': 26.273, 'best_test_test/acc_skew': 61.033, 'best_test_test/acc_align': 87.307}
[15 / 20] Learning rate: 1e-05 weight: 0.01
[15 / 20] Loss: 3.750439884688514 CE Loss: 0.3234206569949057 Con Loss: 3.7472056674850163
[15 / 20] tensor([[0.982, 0.517],
        [0.606, 0.800]]) {'epoch': 15, 'valid/acc': 77.072, 'valid/acc_unbiased': 69.888, 'valid/diff': 37.996, 'valid/acc_skew': 50.89, 'valid/acc_align': 88.885, 'test/acc': 78.889, 'test/acc_unbiased': 72.617, 'test/diff': 32.976, 'test/acc_skew': 56.129, 'test/acc_align': 89.105}
[15 / 20] best valid accuracy: 70.543 at epoch 7 
 best_stats: {'best_valid_epoch': 7, 'best_valid_valid/acc': 76.499, 'best_valid_valid/acc_unbiased': 70.543, 'best_valid_valid/diff': 29.852, 'best_valid_valid/acc_skew': 55.617, 'best_valid_valid/acc_align': 85.469, 'best_valid_test/acc': 78.493, 'best_valid_test/acc_unbiased': 73.525, 'best_valid_test/diff': 24.022, 'best_valid_test/acc_skew': 61.514, 'best_valid_test/acc_align': 85.536}
[15 / 20] best test accuracy: 74.170 at epoch 8 
 best_stats: {'best_test_epoch': 8, 'best_test_valid/acc': 76.631, 'best_test_valid/acc_unbiased': 69.615, 'best_test_valid/diff': 30.94, 'best_test_valid/acc_skew': 54.145, 'best_test_valid/acc_align': 85.085, 'best_test_test/acc': 79.903, 'best_test_test/acc_unbiased': 74.17, 'best_test_test/diff': 26.273, 'best_test_test/acc_skew': 61.033, 'best_test_test/acc_align': 87.307}
[16 / 20] Learning rate: 1e-05 weight: 0.01
[16 / 20] Loss: 3.704571664221766 CE Loss: 0.3213490809239684 Con Loss: 3.7013581867567926
[16 / 20] tensor([[0.982, 0.528],
        [0.595, 0.800]]) {'epoch': 16, 'valid/acc': 76.72, 'valid/acc_unbiased': 69.555, 'valid/diff': 37.768, 'valid/acc_skew': 50.67, 'valid/acc_align': 88.439, 'test/acc': 78.581, 'test/acc_unbiased': 72.641, 'test/diff': 32.926, 'test/acc_skew': 56.178, 'test/acc_align': 89.105}
[16 / 20] best valid accuracy: 70.543 at epoch 7 
 best_stats: {'best_valid_epoch': 7, 'best_valid_valid/acc': 76.499, 'best_valid_valid/acc_unbiased': 70.543, 'best_valid_valid/diff': 29.852, 'best_valid_valid/acc_skew': 55.617, 'best_valid_valid/acc_align': 85.469, 'best_valid_test/acc': 78.493, 'best_valid_test/acc_unbiased': 73.525, 'best_valid_test/diff': 24.022, 'best_valid_test/acc_skew': 61.514, 'best_valid_test/acc_align': 85.536}
[16 / 20] best test accuracy: 74.170 at epoch 8 
 best_stats: {'best_test_epoch': 8, 'best_test_valid/acc': 76.631, 'best_test_valid/acc_unbiased': 69.615, 'best_test_valid/diff': 30.94, 'best_test_valid/acc_skew': 54.145, 'best_test_valid/acc_align': 85.085, 'best_test_test/acc': 79.903, 'best_test_test/acc_unbiased': 74.17, 'best_test_test/diff': 26.273, 'best_test_test/acc_skew': 61.033, 'best_test_test/acc_align': 87.307}
[17 / 20] Learning rate: 1e-05 weight: 0.01
[17 / 20] Loss: 3.781088281954241 CE Loss: 0.31106152795799125 Con Loss: 3.7779776552829434
[17 / 20] tensor([[0.983, 0.557],
        [0.588, 0.788]]) {'epoch': 17, 'valid/acc': 76.146, 'valid/acc_unbiased': 69.255, 'valid/diff': 38.164, 'valid/acc_skew': 50.173, 'valid/acc_align': 88.337, 'test/acc': 78.493, 'test/acc_unbiased': 72.899, 'test/diff': 31.293, 'test/acc_skew': 57.253, 'test/acc_align': 88.546}
[17 / 20] best valid accuracy: 70.543 at epoch 7 
 best_stats: {'best_valid_epoch': 7, 'best_valid_valid/acc': 76.499, 'best_valid_valid/acc_unbiased': 70.543, 'best_valid_valid/diff': 29.852, 'best_valid_valid/acc_skew': 55.617, 'best_valid_valid/acc_align': 85.469, 'best_valid_test/acc': 78.493, 'best_valid_test/acc_unbiased': 73.525, 'best_valid_test/diff': 24.022, 'best_valid_test/acc_skew': 61.514, 'best_valid_test/acc_align': 85.536}
[17 / 20] best test accuracy: 74.170 at epoch 8 
 best_stats: {'best_test_epoch': 8, 'best_test_valid/acc': 76.631, 'best_test_valid/acc_unbiased': 69.615, 'best_test_valid/diff': 30.94, 'best_test_valid/acc_skew': 54.145, 'best_test_valid/acc_align': 85.085, 'best_test_test/acc': 79.903, 'best_test_test/acc_unbiased': 74.17, 'best_test_test/diff': 26.273, 'best_test_test/acc_skew': 61.033, 'best_test_test/acc_align': 87.307}
[18 / 20] Learning rate: 1e-05 weight: 0.01
[18 / 20] Loss: 3.710150707620487 CE Loss: 0.3170729807502364 Con Loss: 3.7069799779551342
[18 / 20] tensor([[0.981, 0.511],
        [0.601, 0.812]]) {'epoch': 18, 'valid/acc': 76.543, 'valid/acc_unbiased': 69.417, 'valid/diff': 39.626, 'valid/acc_skew': 49.604, 'valid/acc_align': 89.23, 'test/acc': 78.713, 'test/acc_unbiased': 72.639, 'test/diff': 34.049, 'test/acc_skew': 55.614, 'test/acc_align': 89.664}
[18 / 20] best valid accuracy: 70.543 at epoch 7 
 best_stats: {'best_valid_epoch': 7, 'best_valid_valid/acc': 76.499, 'best_valid_valid/acc_unbiased': 70.543, 'best_valid_valid/diff': 29.852, 'best_valid_valid/acc_skew': 55.617, 'best_valid_valid/acc_align': 85.469, 'best_valid_test/acc': 78.493, 'best_valid_test/acc_unbiased': 73.525, 'best_valid_test/diff': 24.022, 'best_valid_test/acc_skew': 61.514, 'best_valid_test/acc_align': 85.536}
[18 / 20] best test accuracy: 74.170 at epoch 8 
 best_stats: {'best_test_epoch': 8, 'best_test_valid/acc': 76.631, 'best_test_valid/acc_unbiased': 69.615, 'best_test_valid/diff': 30.94, 'best_test_valid/acc_skew': 54.145, 'best_test_valid/acc_align': 85.085, 'best_test_test/acc': 79.903, 'best_test_test/acc_unbiased': 74.17, 'best_test_test/diff': 26.273, 'best_test_test/acc_skew': 61.033, 'best_test_test/acc_align': 87.307}
[19 / 20] Learning rate: 1e-05 weight: 0.01
[19 / 20] Loss: 3.722090002036371 CE Loss: 0.3109855663682673 Con Loss: 3.718980136947746
[19 / 20] tensor([[0.974, 0.477],
        [0.630, 0.824]]) {'epoch': 19, 'valid/acc': 77.381, 'valid/acc_unbiased': 69.508, 'valid/diff': 39.949, 'valid/acc_skew': 49.533, 'valid/acc_align': 89.482, 'test/acc': 79.286, 'test/acc_unbiased': 72.622, 'test/diff': 34.541, 'test/acc_skew': 55.352, 'test/acc_align': 89.893}
[19 / 20] best valid accuracy: 70.543 at epoch 7 
 best_stats: {'best_valid_epoch': 7, 'best_valid_valid/acc': 76.499, 'best_valid_valid/acc_unbiased': 70.543, 'best_valid_valid/diff': 29.852, 'best_valid_valid/acc_skew': 55.617, 'best_valid_valid/acc_align': 85.469, 'best_valid_test/acc': 78.493, 'best_valid_test/acc_unbiased': 73.525, 'best_valid_test/diff': 24.022, 'best_valid_test/acc_skew': 61.514, 'best_valid_test/acc_align': 85.536}
[19 / 20] best test accuracy: 74.170 at epoch 8 
 best_stats: {'best_test_epoch': 8, 'best_test_valid/acc': 76.631, 'best_test_valid/acc_unbiased': 69.615, 'best_test_valid/diff': 30.94, 'best_test_valid/acc_skew': 54.145, 'best_test_valid/acc_align': 85.085, 'best_test_test/acc': 79.903, 'best_test_test/acc_unbiased': 74.17, 'best_test_test/diff': 26.273, 'best_test_test/acc_skew': 61.033, 'best_test_test/acc_align': 87.307}
[20 / 20] Learning rate: 1e-05 weight: 0.01
[20 / 20] Loss: 3.691977916340487 CE Loss: 0.31573969954767733 Con Loss: 3.6888205195490853
[20 / 20] tensor([[0.981, 0.528],
        [0.595, 0.794]]) {'epoch': 20, 'valid/acc': 75.838, 'valid/acc_unbiased': 69.053, 'valid/diff': 38.869, 'valid/acc_skew': 49.619, 'valid/acc_align': 88.487, 'test/acc': 78.493, 'test/acc_unbiased': 72.466, 'test/diff': 32.576, 'test/acc_skew': 56.178, 'test/acc_align': 88.754}
[20 / 20] best valid accuracy: 70.543 at epoch 7 
 best_stats: {'best_valid_epoch': 7, 'best_valid_valid/acc': 76.499, 'best_valid_valid/acc_unbiased': 70.543, 'best_valid_valid/diff': 29.852, 'best_valid_valid/acc_skew': 55.617, 'best_valid_valid/acc_align': 85.469, 'best_valid_test/acc': 78.493, 'best_valid_test/acc_unbiased': 73.525, 'best_valid_test/diff': 24.022, 'best_valid_test/acc_skew': 61.514, 'best_valid_test/acc_align': 85.536}
[20 / 20] best test accuracy: 74.170 at epoch 8 
 best_stats: {'best_test_epoch': 8, 'best_test_valid/acc': 76.631, 'best_test_valid/acc_unbiased': 69.615, 'best_test_valid/diff': 30.94, 'best_test_valid/acc_skew': 54.145, 'best_test_valid/acc_align': 85.085, 'best_test_test/acc': 79.903, 'best_test_test/acc_unbiased': 74.17, 'best_test_test/diff': 26.273, 'best_test_test/acc_skew': 61.033, 'best_test_test/acc_align': 87.307}
Total training time: 0:16:18
