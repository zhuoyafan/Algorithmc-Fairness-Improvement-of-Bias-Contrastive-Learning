Log level set to: INFO
Set seed: 3
=======> Using Fixed Random Seed: 3 <========
save_path: exp_results/bc-bb0-utk_face_age-rotate-0.9-lr0.001-bs128-cbs64-w0.01-ratio10-aug1-seed3
get_utk_face - split: train, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_age-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
Binary Target 1
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Normal Label Distribution: 
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
Binary Target 1
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Normal Label Distribution: 
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 10684, target_attr: gender, bias_attr: age bias_rate: 0.9
['[train] target_0-bias_0: 8237', '[train] target_0-bias_1: 147', '[train] target_1-bias_0: 823', '[train] target_1-bias_1: 1477']
confusion_matrix - 
 original: tensor([[8237.,  823.],
        [ 147., 1477.]]), 
 normalized: tensor([[0.909, 0.091],
        [0.091, 0.909]]), 
 b|y: tensor([[0.982, 0.018],
        [0.358, 0.642]])
get_utk_face - split: train, aug: 1, given_y: True, ratio: 10
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_age-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
Binary Target 1
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Normal Label Distribution: 
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
Binary Target 1
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Normal Label Distribution: 
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 10684, target_attr: gender, bias_attr: age bias_rate: 0.9
['[train] target_0-bias_0: 8237', '[train] target_0-bias_1: 147', '[train] target_1-bias_0: 823', '[train] target_1-bias_1: 1477']
get_utk_face - split: valid, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_age-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [1030, 195]
Target 1: [841, 202]
Binary Target 1
---------------------------
Target 0: [1030, 195]
Target 1: [841, 202]
===================================
Normal Label Distribution: 
Target 0: [1030, 195]
Target 1: [841, 202]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 2268, target_attr: gender, bias_attr: age bias_rate: 0.9
['[valid] target_0-bias_0: 1030', '[valid] target_0-bias_1: 195', '[valid] target_1-bias_0: 841', '[valid] target_1-bias_1: 202']
get_utk_face - split: test, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_age-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [1061, 176]
Target 1: [867, 165]
Binary Target 1
---------------------------
Target 0: [1061, 176]
Target 1: [867, 165]
===================================
Normal Label Distribution: 
Target 0: [1061, 176]
Target 1: [867, 165]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 2269, target_attr: gender, bias_attr: age bias_rate: 0.9
['[test] target_0-bias_0: 1061', '[test] target_0-bias_1: 176', '[test] target_1-bias_0: 867', '[test] target_1-bias_1: 165']
decay_epochs: [6, 13]
[1 / 20] Learning rate: 0.001 weight: 0.01
[1 / 20] Loss: 4.79821448949159 CE Loss: 0.609164272386543 Con Loss: 4.792122838917585
[1 / 20] tensor([[0.983, 1.000],
        [0.032, 0.012]]) {'epoch': 1, 'valid/acc': 54.85, 'valid/acc_unbiased': 50.528, 'valid/diff': 1.605, 'valid/acc_skew': 51.193, 'valid/acc_align': 49.864, 'test/acc': 55.046, 'test/acc_unbiased': 50.686, 'test/diff': 1.857, 'test/acc_skew': 51.615, 'test/acc_align': 49.758}
[1 / 20] best valid accuracy: 50.528 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 54.85, 'best_valid_valid/acc_unbiased': 50.528, 'best_valid_valid/diff': 1.605, 'best_valid_valid/acc_skew': 51.193, 'best_valid_valid/acc_align': 49.864, 'best_valid_test/acc': 55.046, 'best_valid_test/acc_unbiased': 50.686, 'best_valid_test/diff': 1.857, 'best_valid_test/acc_skew': 51.615, 'best_valid_test/acc_align': 49.758}
[1 / 20] best test accuracy: 50.686 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 54.85, 'best_test_valid/acc_unbiased': 50.528, 'best_test_valid/diff': 1.605, 'best_test_valid/acc_skew': 51.193, 'best_test_valid/acc_align': 49.864, 'best_test_test/acc': 55.046, 'best_test_test/acc_unbiased': 50.686, 'best_test_test/diff': 1.857, 'best_test_test/acc_skew': 51.615, 'best_test_test/acc_align': 49.758}
[2 / 20] Learning rate: 0.001 weight: 0.01
[2 / 20] Loss: 4.557660069460281 CE Loss: 0.5753723541612886 Con Loss: 4.551906366466092
[2 / 20] tensor([[0.987, 0.989],
        [0.141, 0.055]]) {'epoch': 2, 'valid/acc': 58.907, 'valid/acc_unbiased': 53.962, 'valid/diff': 5.042, 'valid/acc_skew': 56.268, 'valid/acc_align': 51.655, 'test/acc': 59.586, 'test/acc_unbiased': 54.268, 'test/diff': 4.4, 'test/acc_skew': 56.468, 'test/acc_align': 52.068}
[2 / 20] best valid accuracy: 53.962 at epoch 2 
 best_stats: {'best_valid_epoch': 2, 'best_valid_valid/acc': 58.907, 'best_valid_valid/acc_unbiased': 53.962, 'best_valid_valid/diff': 5.042, 'best_valid_valid/acc_skew': 56.268, 'best_valid_valid/acc_align': 51.655, 'best_valid_test/acc': 59.586, 'best_valid_test/acc_unbiased': 54.268, 'best_valid_test/diff': 4.4, 'best_valid_test/acc_skew': 56.468, 'best_valid_test/acc_align': 52.068}
[2 / 20] best test accuracy: 54.268 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 58.907, 'best_test_valid/acc_unbiased': 53.962, 'best_test_valid/diff': 5.042, 'best_test_valid/acc_skew': 56.268, 'best_test_valid/acc_align': 51.655, 'best_test_test/acc': 59.586, 'best_test_test/acc_unbiased': 54.268, 'best_test_test/diff': 4.4, 'best_test_test/acc_skew': 56.468, 'best_test_test/acc_align': 52.068}
[3 / 20] Learning rate: 0.001 weight: 0.01
[3 / 20] Loss: 4.515020059494881 CE Loss: 0.5531162374120489 Con Loss: 4.509488891814363
[3 / 20] tensor([[0.986, 0.972],
        [0.103, 0.055]]) {'epoch': 3, 'valid/acc': 57.011, 'valid/acc_unbiased': 53.39, 'valid/diff': 1.276, 'valid/acc_skew': 54.028, 'valid/acc_align': 52.752, 'test/acc': 57.955, 'test/acc_unbiased': 52.866, 'test/diff': 3.119, 'test/acc_skew': 53.712, 'test/acc_align': 52.02}
[3 / 20] best valid accuracy: 53.962 at epoch 2 
 best_stats: {'best_valid_epoch': 2, 'best_valid_valid/acc': 58.907, 'best_valid_valid/acc_unbiased': 53.962, 'best_valid_valid/diff': 5.042, 'best_valid_valid/acc_skew': 56.268, 'best_valid_valid/acc_align': 51.655, 'best_valid_test/acc': 59.586, 'best_valid_test/acc_unbiased': 54.268, 'best_valid_test/diff': 4.4, 'best_valid_test/acc_skew': 56.468, 'best_valid_test/acc_align': 52.068}
[3 / 20] best test accuracy: 54.268 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 58.907, 'best_test_valid/acc_unbiased': 53.962, 'best_test_valid/diff': 5.042, 'best_test_valid/acc_skew': 56.268, 'best_test_valid/acc_align': 51.655, 'best_test_test/acc': 59.586, 'best_test_test/acc_unbiased': 54.268, 'best_test_test/diff': 4.4, 'best_test_test/acc_skew': 56.468, 'best_test_test/acc_align': 52.068}
[4 / 20] Learning rate: 0.001 weight: 0.01
[4 / 20] Loss: 4.48534118758744 CE Loss: 0.534001606651479 Con Loss: 4.480001176800544
[4 / 20] tensor([[0.928, 0.886],
        [0.423, 0.297]]) {'epoch': 4, 'valid/acc': 68.298, 'valid/acc_unbiased': 63.42, 'valid/diff': 8.543, 'valid/acc_skew': 63.313, 'valid/acc_align': 63.526, 'test/acc': 68.621, 'test/acc_unbiased': 63.375, 'test/diff': 8.417, 'test/acc_skew': 65.483, 'test/acc_align': 61.267}
[4 / 20] best valid accuracy: 63.420 at epoch 4 
 best_stats: {'best_valid_epoch': 4, 'best_valid_valid/acc': 68.298, 'best_valid_valid/acc_unbiased': 63.42, 'best_valid_valid/diff': 8.543, 'best_valid_valid/acc_skew': 63.313, 'best_valid_valid/acc_align': 63.526, 'best_valid_test/acc': 68.621, 'best_valid_test/acc_unbiased': 63.375, 'best_valid_test/diff': 8.417, 'best_valid_test/acc_skew': 65.483, 'best_valid_test/acc_align': 61.267}
[4 / 20] best test accuracy: 63.375 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 68.298, 'best_test_valid/acc_unbiased': 63.42, 'best_test_valid/diff': 8.543, 'best_test_valid/acc_skew': 63.313, 'best_test_valid/acc_align': 63.526, 'best_test_test/acc': 68.621, 'best_test_test/acc_unbiased': 63.375, 'best_test_test/diff': 8.417, 'best_test_test/acc_skew': 65.483, 'best_test_test/acc_align': 61.267}
[5 / 20] Learning rate: 0.001 weight: 0.01
[5 / 20] Loss: 4.455391633738207 CE Loss: 0.5213442334562863 Con Loss: 4.450178200990598
[5 / 20] tensor([[0.945, 0.830],
        [0.467, 0.345]]) {'epoch': 5, 'valid/acc': 70.547, 'valid/acc_unbiased': 65.672, 'valid/diff': 8.77, 'valid/acc_skew': 62.533, 'valid/acc_align': 68.811, 'test/acc': 71.0, 'test/acc_unbiased': 64.687, 'test/diff': 11.873, 'test/acc_skew': 64.834, 'test/acc_align': 64.539}
[5 / 20] best valid accuracy: 65.672 at epoch 5 
 best_stats: {'best_valid_epoch': 5, 'best_valid_valid/acc': 70.547, 'best_valid_valid/acc_unbiased': 65.672, 'best_valid_valid/diff': 8.77, 'best_valid_valid/acc_skew': 62.533, 'best_valid_valid/acc_align': 68.811, 'best_valid_test/acc': 71.0, 'best_valid_test/acc_unbiased': 64.687, 'best_valid_test/diff': 11.873, 'best_valid_test/acc_skew': 64.834, 'best_valid_test/acc_align': 64.539}
[5 / 20] best test accuracy: 64.687 at epoch 5 
 best_stats: {'best_test_epoch': 5, 'best_test_valid/acc': 70.547, 'best_test_valid/acc_unbiased': 65.672, 'best_test_valid/diff': 8.77, 'best_test_valid/acc_skew': 62.533, 'best_test_valid/acc_align': 68.811, 'best_test_test/acc': 71.0, 'best_test_test/acc_unbiased': 64.687, 'best_test_test/diff': 11.873, 'best_test_test/acc_skew': 64.834, 'best_test_test/acc_align': 64.539}
[6 / 20] Learning rate: 0.001 weight: 0.01
[6 / 20] Loss: 4.4314296707059055 CE Loss: 0.49303148610455316 Con Loss: 4.426499358369634
[6 / 20] tensor([[0.996, 1.000],
        [0.131, 0.121]]) {'epoch': 6, 'valid/acc': 59.656, 'valid/acc_unbiased': 56.063, 'valid/diff': 0.262, 'valid/acc_skew': 55.986, 'valid/acc_align': 56.14, 'test/acc': 60.247, 'test/acc_unbiased': 56.223, 'test/diff': 0.702, 'test/acc_skew': 56.574, 'test/acc_align': 55.872}
[6 / 20] best valid accuracy: 65.672 at epoch 5 
 best_stats: {'best_valid_epoch': 5, 'best_valid_valid/acc': 70.547, 'best_valid_valid/acc_unbiased': 65.672, 'best_valid_valid/diff': 8.77, 'best_valid_valid/acc_skew': 62.533, 'best_valid_valid/acc_align': 68.811, 'best_valid_test/acc': 71.0, 'best_valid_test/acc_unbiased': 64.687, 'best_valid_test/diff': 11.873, 'best_valid_test/acc_skew': 64.834, 'best_valid_test/acc_align': 64.539}
[6 / 20] best test accuracy: 64.687 at epoch 5 
 best_stats: {'best_test_epoch': 5, 'best_test_valid/acc': 70.547, 'best_test_valid/acc_unbiased': 65.672, 'best_test_valid/diff': 8.77, 'best_test_valid/acc_skew': 62.533, 'best_test_valid/acc_align': 68.811, 'best_test_test/acc': 71.0, 'best_test_test/acc_unbiased': 64.687, 'best_test_test/diff': 11.873, 'best_test_test/acc_skew': 64.834, 'best_test_test/acc_align': 64.539}
[7 / 20] Learning rate: 0.0001 weight: 0.01
[7 / 20] Loss: 4.3228518140757854 CE Loss: 0.4666701462531259 Con Loss: 4.31818514287985
[7 / 20] tensor([[0.986, 0.852],
        [0.371, 0.436]]) {'epoch': 7, 'valid/acc': 68.298, 'valid/acc_unbiased': 63.983, 'valid/diff': 11.075, 'valid/acc_skew': 58.445, 'valid/acc_align': 69.52, 'test/acc': 70.075, 'test/acc_unbiased': 66.147, 'test/diff': 9.928, 'test/acc_skew': 61.183, 'test/acc_align': 71.111}
[7 / 20] best valid accuracy: 65.672 at epoch 5 
 best_stats: {'best_valid_epoch': 5, 'best_valid_valid/acc': 70.547, 'best_valid_valid/acc_unbiased': 65.672, 'best_valid_valid/diff': 8.77, 'best_valid_valid/acc_skew': 62.533, 'best_valid_valid/acc_align': 68.811, 'best_valid_test/acc': 71.0, 'best_valid_test/acc_unbiased': 64.687, 'best_valid_test/diff': 11.873, 'best_valid_test/acc_skew': 64.834, 'best_valid_test/acc_align': 64.539}
[7 / 20] best test accuracy: 66.147 at epoch 7 
 best_stats: {'best_test_epoch': 7, 'best_test_valid/acc': 68.298, 'best_test_valid/acc_unbiased': 63.983, 'best_test_valid/diff': 11.075, 'best_test_valid/acc_skew': 58.445, 'best_test_valid/acc_align': 69.52, 'best_test_test/acc': 70.075, 'best_test_test/acc_unbiased': 66.147, 'best_test_test/diff': 9.928, 'best_test_test/acc_skew': 61.183, 'best_test_test/acc_align': 71.111}
[8 / 20] Learning rate: 0.0001 weight: 0.01
[8 / 20] Loss: 4.232245267798775 CE Loss: 0.4555412342444827 Con Loss: 4.22768984587172
[8 / 20] tensor([[0.980, 0.733],
        [0.451, 0.552]]) {'epoch': 8, 'valid/acc': 70.414, 'valid/acc_unbiased': 65.667, 'valid/diff': 17.529, 'valid/acc_skew': 56.903, 'valid/acc_align': 74.432, 'test/acc': 72.763, 'test/acc_unbiased': 67.891, 'test/diff': 17.389, 'test/acc_skew': 59.197, 'test/acc_align': 76.586}
[8 / 20] best valid accuracy: 65.672 at epoch 5 
 best_stats: {'best_valid_epoch': 5, 'best_valid_valid/acc': 70.547, 'best_valid_valid/acc_unbiased': 65.672, 'best_valid_valid/diff': 8.77, 'best_valid_valid/acc_skew': 62.533, 'best_valid_valid/acc_align': 68.811, 'best_valid_test/acc': 71.0, 'best_valid_test/acc_unbiased': 64.687, 'best_valid_test/diff': 11.873, 'best_valid_test/acc_skew': 64.834, 'best_valid_test/acc_align': 64.539}
[8 / 20] best test accuracy: 67.891 at epoch 8 
 best_stats: {'best_test_epoch': 8, 'best_test_valid/acc': 70.414, 'best_test_valid/acc_unbiased': 65.667, 'best_test_valid/diff': 17.529, 'best_test_valid/acc_skew': 56.903, 'best_test_valid/acc_align': 74.432, 'best_test_test/acc': 72.763, 'best_test_test/acc_unbiased': 67.891, 'best_test_test/diff': 17.389, 'best_test_test/acc_skew': 59.197, 'best_test_test/acc_align': 76.586}
[9 / 20] Learning rate: 0.0001 weight: 0.01
[9 / 20] Loss: 4.184835651223466 CE Loss: 0.4474682354471827 Con Loss: 4.180360970270406
[9 / 20] tensor([[0.989, 0.756],
        [0.433, 0.515]]) {'epoch': 9, 'valid/acc': 69.929, 'valid/acc_unbiased': 64.761, 'valid/diff': 14.973, 'valid/acc_skew': 57.275, 'valid/acc_align': 72.248, 'test/acc': 72.367, 'test/acc_unbiased': 67.301, 'test/diff': 15.782, 'test/acc_skew': 59.41, 'test/acc_align': 75.192}
[9 / 20] best valid accuracy: 65.672 at epoch 5 
 best_stats: {'best_valid_epoch': 5, 'best_valid_valid/acc': 70.547, 'best_valid_valid/acc_unbiased': 65.672, 'best_valid_valid/diff': 8.77, 'best_valid_valid/acc_skew': 62.533, 'best_valid_valid/acc_align': 68.811, 'best_valid_test/acc': 71.0, 'best_valid_test/acc_unbiased': 64.687, 'best_valid_test/diff': 11.873, 'best_valid_test/acc_skew': 64.834, 'best_valid_test/acc_align': 64.539}
[9 / 20] best test accuracy: 67.891 at epoch 8 
 best_stats: {'best_test_epoch': 8, 'best_test_valid/acc': 70.414, 'best_test_valid/acc_unbiased': 65.667, 'best_test_valid/diff': 17.529, 'best_test_valid/acc_skew': 56.903, 'best_test_valid/acc_align': 74.432, 'best_test_test/acc': 72.763, 'best_test_test/acc_unbiased': 67.891, 'best_test_test/diff': 17.389, 'best_test_test/acc_skew': 59.197, 'best_test_test/acc_align': 76.586}
[10 / 20] Learning rate: 0.0001 weight: 0.01
[10 / 20] Loss: 4.1511477957232445 CE Loss: 0.429370403200533 Con Loss: 4.1468540957160585
[10 / 20] tensor([[0.985, 0.705],
        [0.390, 0.509]]) {'epoch': 10, 'valid/acc': 69.797, 'valid/acc_unbiased': 65.014, 'valid/diff': 18.719, 'valid/acc_skew': 55.654, 'valid/acc_align': 74.374, 'test/acc': 70.119, 'test/acc_unbiased': 64.71, 'test/diff': 19.981, 'test/acc_skew': 54.72, 'test/acc_align': 74.701}
[10 / 20] best valid accuracy: 65.672 at epoch 5 
 best_stats: {'best_valid_epoch': 5, 'best_valid_valid/acc': 70.547, 'best_valid_valid/acc_unbiased': 65.672, 'best_valid_valid/diff': 8.77, 'best_valid_valid/acc_skew': 62.533, 'best_valid_valid/acc_align': 68.811, 'best_valid_test/acc': 71.0, 'best_valid_test/acc_unbiased': 64.687, 'best_valid_test/diff': 11.873, 'best_valid_test/acc_skew': 64.834, 'best_valid_test/acc_align': 64.539}
[10 / 20] best test accuracy: 67.891 at epoch 8 
 best_stats: {'best_test_epoch': 8, 'best_test_valid/acc': 70.414, 'best_test_valid/acc_unbiased': 65.667, 'best_test_valid/diff': 17.529, 'best_test_valid/acc_skew': 56.903, 'best_test_valid/acc_align': 74.432, 'best_test_test/acc': 72.763, 'best_test_test/acc_unbiased': 67.891, 'best_test_test/diff': 17.389, 'best_test_test/acc_skew': 59.197, 'best_test_test/acc_align': 76.586}
[11 / 20] Learning rate: 0.0001 weight: 0.01
[11 / 20] Loss: 4.083109251527204 CE Loss: 0.4268202331574032 Con Loss: 4.0788410449911705
[11 / 20] tensor([[0.982, 0.602],
        [0.426, 0.630]]) {'epoch': 11, 'valid/acc': 70.282, 'valid/acc_unbiased': 64.204, 'valid/diff': 28.367, 'valid/acc_skew': 50.021, 'valid/acc_align': 78.387, 'test/acc': 71.441, 'test/acc_unbiased': 66.007, 'test/diff': 29.226, 'test/acc_skew': 51.394, 'test/acc_align': 80.62}
[11 / 20] best valid accuracy: 65.672 at epoch 5 
 best_stats: {'best_valid_epoch': 5, 'best_valid_valid/acc': 70.547, 'best_valid_valid/acc_unbiased': 65.672, 'best_valid_valid/diff': 8.77, 'best_valid_valid/acc_skew': 62.533, 'best_valid_valid/acc_align': 68.811, 'best_valid_test/acc': 71.0, 'best_valid_test/acc_unbiased': 64.687, 'best_valid_test/diff': 11.873, 'best_valid_test/acc_skew': 64.834, 'best_valid_test/acc_align': 64.539}
[11 / 20] best test accuracy: 67.891 at epoch 8 
 best_stats: {'best_test_epoch': 8, 'best_test_valid/acc': 70.414, 'best_test_valid/acc_unbiased': 65.667, 'best_test_valid/diff': 17.529, 'best_test_valid/acc_skew': 56.903, 'best_test_valid/acc_align': 74.432, 'best_test_test/acc': 72.763, 'best_test_test/acc_unbiased': 67.891, 'best_test_test/diff': 17.389, 'best_test_test/acc_skew': 59.197, 'best_test_test/acc_align': 76.586}
[12 / 20] Learning rate: 0.0001 weight: 0.01
[12 / 20] Loss: 4.048031371079862 CE Loss: 0.4278367038457771 Con Loss: 4.043752999664558
[12 / 20] tensor([[0.989, 0.784],
        [0.368, 0.467]]) {'epoch': 12, 'valid/acc': 69.356, 'valid/acc_unbiased': 64.337, 'valid/diff': 14.414, 'valid/acc_skew': 57.13, 'valid/acc_align': 71.544, 'test/acc': 69.766, 'test/acc_unbiased': 65.185, 'test/diff': 15.167, 'test/acc_skew': 57.601, 'test/acc_align': 72.768}
[12 / 20] best valid accuracy: 65.672 at epoch 5 
 best_stats: {'best_valid_epoch': 5, 'best_valid_valid/acc': 70.547, 'best_valid_valid/acc_unbiased': 65.672, 'best_valid_valid/diff': 8.77, 'best_valid_valid/acc_skew': 62.533, 'best_valid_valid/acc_align': 68.811, 'best_valid_test/acc': 71.0, 'best_valid_test/acc_unbiased': 64.687, 'best_valid_test/diff': 11.873, 'best_valid_test/acc_skew': 64.834, 'best_valid_test/acc_align': 64.539}
[12 / 20] best test accuracy: 67.891 at epoch 8 
 best_stats: {'best_test_epoch': 8, 'best_test_valid/acc': 70.414, 'best_test_valid/acc_unbiased': 65.667, 'best_test_valid/diff': 17.529, 'best_test_valid/acc_skew': 56.903, 'best_test_valid/acc_align': 74.432, 'best_test_test/acc': 72.763, 'best_test_test/acc_unbiased': 67.891, 'best_test_test/diff': 17.389, 'best_test_test/acc_skew': 59.197, 'best_test_test/acc_align': 76.586}
[13 / 20] Learning rate: 0.0001 weight: 0.01
[13 / 20] Loss: 4.047632930877725 CE Loss: 0.4158516043426838 Con Loss: 4.043474424202225
[13 / 20] tensor([[0.987, 0.795],
        [0.362, 0.467]]) {'epoch': 13, 'valid/acc': 69.665, 'valid/acc_unbiased': 64.823, 'valid/diff': 15.423, 'valid/acc_skew': 57.111, 'valid/acc_align': 72.534, 'test/acc': 69.546, 'test/acc_unbiased': 65.277, 'test/diff': 14.792, 'test/acc_skew': 57.881, 'test/acc_align': 72.674}
[13 / 20] best valid accuracy: 65.672 at epoch 5 
 best_stats: {'best_valid_epoch': 5, 'best_valid_valid/acc': 70.547, 'best_valid_valid/acc_unbiased': 65.672, 'best_valid_valid/diff': 8.77, 'best_valid_valid/acc_skew': 62.533, 'best_valid_valid/acc_align': 68.811, 'best_valid_test/acc': 71.0, 'best_valid_test/acc_unbiased': 64.687, 'best_valid_test/diff': 11.873, 'best_valid_test/acc_skew': 64.834, 'best_valid_test/acc_align': 64.539}
[13 / 20] best test accuracy: 67.891 at epoch 8 
 best_stats: {'best_test_epoch': 8, 'best_test_valid/acc': 70.414, 'best_test_valid/acc_unbiased': 65.667, 'best_test_valid/diff': 17.529, 'best_test_valid/acc_skew': 56.903, 'best_test_valid/acc_align': 74.432, 'best_test_test/acc': 72.763, 'best_test_test/acc_unbiased': 67.891, 'best_test_test/diff': 17.389, 'best_test_test/acc_skew': 59.197, 'best_test_test/acc_align': 76.586}
[14 / 20] Learning rate: 1e-05 weight: 0.01
[14 / 20] Loss: 3.998120220088637 CE Loss: 0.4139526604668829 Con Loss: 3.9939807001368823
[14 / 20] tensor([[0.983, 0.767],
        [0.420, 0.497]]) {'epoch': 14, 'valid/acc': 70.811, 'valid/acc_unbiased': 65.103, 'valid/diff': 16.95, 'valid/acc_skew': 56.628, 'valid/acc_align': 73.578, 'test/acc': 71.573, 'test/acc_unbiased': 66.672, 'test/diff': 14.656, 'test/acc_skew': 59.344, 'test/acc_align': 74.0}
[14 / 20] best valid accuracy: 65.672 at epoch 5 
 best_stats: {'best_valid_epoch': 5, 'best_valid_valid/acc': 70.547, 'best_valid_valid/acc_unbiased': 65.672, 'best_valid_valid/diff': 8.77, 'best_valid_valid/acc_skew': 62.533, 'best_valid_valid/acc_align': 68.811, 'best_valid_test/acc': 71.0, 'best_valid_test/acc_unbiased': 64.687, 'best_valid_test/diff': 11.873, 'best_valid_test/acc_skew': 64.834, 'best_valid_test/acc_align': 64.539}
[14 / 20] best test accuracy: 67.891 at epoch 8 
 best_stats: {'best_test_epoch': 8, 'best_test_valid/acc': 70.414, 'best_test_valid/acc_unbiased': 65.667, 'best_test_valid/diff': 17.529, 'best_test_valid/acc_skew': 56.903, 'best_test_valid/acc_align': 74.432, 'best_test_test/acc': 72.763, 'best_test_test/acc_unbiased': 67.891, 'best_test_test/diff': 17.389, 'best_test_test/acc_skew': 59.197, 'best_test_test/acc_align': 76.586}
[15 / 20] Learning rate: 1e-05 weight: 0.01
[15 / 20] Loss: 3.9966865835543297 CE Loss: 0.4062472134214892 Con Loss: 3.9926241035989856
[15 / 20] tensor([[0.979, 0.733],
        [0.458, 0.533]]) {'epoch': 15, 'valid/acc': 71.473, 'valid/acc_unbiased': 65.335, 'valid/diff': 18.864, 'valid/acc_skew': 55.903, 'valid/acc_align': 74.767, 'test/acc': 72.851, 'test/acc_unbiased': 67.586, 'test/diff': 16.087, 'test/acc_skew': 59.543, 'test/acc_align': 75.63}
[15 / 20] best valid accuracy: 65.672 at epoch 5 
 best_stats: {'best_valid_epoch': 5, 'best_valid_valid/acc': 70.547, 'best_valid_valid/acc_unbiased': 65.672, 'best_valid_valid/diff': 8.77, 'best_valid_valid/acc_skew': 62.533, 'best_valid_valid/acc_align': 68.811, 'best_valid_test/acc': 71.0, 'best_valid_test/acc_unbiased': 64.687, 'best_valid_test/diff': 11.873, 'best_valid_test/acc_skew': 64.834, 'best_valid_test/acc_align': 64.539}
[15 / 20] best test accuracy: 67.891 at epoch 8 
 best_stats: {'best_test_epoch': 8, 'best_test_valid/acc': 70.414, 'best_test_valid/acc_unbiased': 65.667, 'best_test_valid/diff': 17.529, 'best_test_valid/acc_skew': 56.903, 'best_test_valid/acc_align': 74.432, 'best_test_test/acc': 72.763, 'best_test_test/acc_unbiased': 67.891, 'best_test_test/diff': 17.389, 'best_test_test/acc_skew': 59.197, 'best_test_test/acc_align': 76.586}
[16 / 20] Learning rate: 1e-05 weight: 0.01
[16 / 20] Loss: 3.9911806823519096 CE Loss: 0.4068787907982801 Con Loss: 3.9871118819387785
[16 / 20] tensor([[0.983, 0.756],
        [0.444, 0.533]]) {'epoch': 16, 'valid/acc': 71.34, 'valid/acc_unbiased': 65.35, 'valid/diff': 18.737, 'valid/acc_skew': 55.981, 'valid/acc_align': 74.718, 'test/acc': 72.675, 'test/acc_unbiased': 67.903, 'test/diff': 15.831, 'test/acc_skew': 59.987, 'test/acc_align': 75.818}
[16 / 20] best valid accuracy: 65.672 at epoch 5 
 best_stats: {'best_valid_epoch': 5, 'best_valid_valid/acc': 70.547, 'best_valid_valid/acc_unbiased': 65.672, 'best_valid_valid/diff': 8.77, 'best_valid_valid/acc_skew': 62.533, 'best_valid_valid/acc_align': 68.811, 'best_valid_test/acc': 71.0, 'best_valid_test/acc_unbiased': 64.687, 'best_valid_test/diff': 11.873, 'best_valid_test/acc_skew': 64.834, 'best_valid_test/acc_align': 64.539}
[16 / 20] best test accuracy: 67.903 at epoch 16 
 best_stats: {'best_test_epoch': 16, 'best_test_valid/acc': 71.34, 'best_test_valid/acc_unbiased': 65.35, 'best_test_valid/diff': 18.737, 'best_test_valid/acc_skew': 55.981, 'best_test_valid/acc_align': 74.718, 'best_test_test/acc': 72.675, 'best_test_test/acc_unbiased': 67.903, 'best_test_test/diff': 15.831, 'best_test_test/acc_skew': 59.987, 'best_test_test/acc_align': 75.818}
[17 / 20] Learning rate: 1e-05 weight: 0.01
[17 / 20] Loss: 3.8838609561006123 CE Loss: 0.4024184369965021 Con Loss: 3.879836766740348
[17 / 20] tensor([[0.982, 0.727],
        [0.433, 0.527]]) {'epoch': 17, 'valid/acc': 70.944, 'valid/acc_unbiased': 65.077, 'valid/diff': 19.38, 'valid/acc_skew': 55.387, 'valid/acc_align': 74.767, 'test/acc': 71.926, 'test/acc_unbiased': 66.729, 'test/diff': 17.478, 'test/acc_skew': 57.99, 'test/acc_align': 75.468}
[17 / 20] best valid accuracy: 65.672 at epoch 5 
 best_stats: {'best_valid_epoch': 5, 'best_valid_valid/acc': 70.547, 'best_valid_valid/acc_unbiased': 65.672, 'best_valid_valid/diff': 8.77, 'best_valid_valid/acc_skew': 62.533, 'best_valid_valid/acc_align': 68.811, 'best_valid_test/acc': 71.0, 'best_valid_test/acc_unbiased': 64.687, 'best_valid_test/diff': 11.873, 'best_valid_test/acc_skew': 64.834, 'best_valid_test/acc_align': 64.539}
[17 / 20] best test accuracy: 67.903 at epoch 16 
 best_stats: {'best_test_epoch': 16, 'best_test_valid/acc': 71.34, 'best_test_valid/acc_unbiased': 65.35, 'best_test_valid/diff': 18.737, 'best_test_valid/acc_skew': 55.981, 'best_test_valid/acc_align': 74.718, 'best_test_test/acc': 72.675, 'best_test_test/acc_unbiased': 67.903, 'best_test_test/diff': 15.831, 'best_test_test/acc_skew': 59.987, 'best_test_test/acc_align': 75.818}
[18 / 20] Learning rate: 1e-05 weight: 0.01
[18 / 20] Loss: 3.988225973487034 CE Loss: 0.39971082551298137 Con Loss: 3.9842288537848445
[18 / 20] tensor([[0.982, 0.727],
        [0.424, 0.533]]) {'epoch': 18, 'valid/acc': 71.076, 'valid/acc_unbiased': 65.25, 'valid/diff': 20.121, 'valid/acc_skew': 55.19, 'valid/acc_align': 75.31, 'test/acc': 71.662, 'test/acc_unbiased': 66.679, 'test/diff': 18.185, 'test/acc_skew': 57.586, 'test/acc_align': 75.771}
[18 / 20] best valid accuracy: 65.672 at epoch 5 
 best_stats: {'best_valid_epoch': 5, 'best_valid_valid/acc': 70.547, 'best_valid_valid/acc_unbiased': 65.672, 'best_valid_valid/diff': 8.77, 'best_valid_valid/acc_skew': 62.533, 'best_valid_valid/acc_align': 68.811, 'best_valid_test/acc': 71.0, 'best_valid_test/acc_unbiased': 64.687, 'best_valid_test/diff': 11.873, 'best_valid_test/acc_skew': 64.834, 'best_valid_test/acc_align': 64.539}
[18 / 20] best test accuracy: 67.903 at epoch 16 
 best_stats: {'best_test_epoch': 16, 'best_test_valid/acc': 71.34, 'best_test_valid/acc_unbiased': 65.35, 'best_test_valid/diff': 18.737, 'best_test_valid/acc_skew': 55.981, 'best_test_valid/acc_align': 74.718, 'best_test_test/acc': 72.675, 'best_test_test/acc_unbiased': 67.903, 'best_test_test/diff': 15.831, 'best_test_test/acc_skew': 59.987, 'best_test_test/acc_align': 75.818}
[19 / 20] Learning rate: 1e-05 weight: 0.01
[19 / 20] Loss: 3.96585532566529 CE Loss: 0.39896526601331506 Con Loss: 3.9618656398740346
[19 / 20] tensor([[0.984, 0.733],
        [0.423, 0.503]]) {'epoch': 19, 'valid/acc': 70.855, 'valid/acc_unbiased': 65.021, 'valid/diff': 18.599, 'valid/acc_skew': 55.721, 'valid/acc_align': 74.32, 'test/acc': 71.529, 'test/acc_unbiased': 66.082, 'test/diff': 16.538, 'test/acc_skew': 57.813, 'test/acc_align': 74.35}
[19 / 20] best valid accuracy: 65.672 at epoch 5 
 best_stats: {'best_valid_epoch': 5, 'best_valid_valid/acc': 70.547, 'best_valid_valid/acc_unbiased': 65.672, 'best_valid_valid/diff': 8.77, 'best_valid_valid/acc_skew': 62.533, 'best_valid_valid/acc_align': 68.811, 'best_valid_test/acc': 71.0, 'best_valid_test/acc_unbiased': 64.687, 'best_valid_test/diff': 11.873, 'best_valid_test/acc_skew': 64.834, 'best_valid_test/acc_align': 64.539}
[19 / 20] best test accuracy: 67.903 at epoch 16 
 best_stats: {'best_test_epoch': 16, 'best_test_valid/acc': 71.34, 'best_test_valid/acc_unbiased': 65.35, 'best_test_valid/diff': 18.737, 'best_test_valid/acc_skew': 55.981, 'best_test_valid/acc_align': 74.718, 'best_test_test/acc': 72.675, 'best_test_test/acc_unbiased': 67.903, 'best_test_test/diff': 15.831, 'best_test_test/acc_skew': 59.987, 'best_test_test/acc_align': 75.818}
[20 / 20] Learning rate: 1e-05 weight: 0.01
[20 / 20] Loss: 3.9487713011674157 CE Loss: 0.3990100841091974 Con Loss: 3.9447811966485093
[20 / 20] tensor([[0.980, 0.705],
        [0.452, 0.552]]) {'epoch': 20, 'valid/acc': 71.208, 'valid/acc_unbiased': 64.848, 'valid/diff': 21.323, 'valid/acc_skew': 54.186, 'valid/acc_align': 75.509, 'test/acc': 72.587, 'test/acc_unbiased': 67.21, 'test/diff': 18.752, 'test/acc_skew': 57.834, 'test/acc_align': 76.586}
[20 / 20] best valid accuracy: 65.672 at epoch 5 
 best_stats: {'best_valid_epoch': 5, 'best_valid_valid/acc': 70.547, 'best_valid_valid/acc_unbiased': 65.672, 'best_valid_valid/diff': 8.77, 'best_valid_valid/acc_skew': 62.533, 'best_valid_valid/acc_align': 68.811, 'best_valid_test/acc': 71.0, 'best_valid_test/acc_unbiased': 64.687, 'best_valid_test/diff': 11.873, 'best_valid_test/acc_skew': 64.834, 'best_valid_test/acc_align': 64.539}
[20 / 20] best test accuracy: 67.903 at epoch 16 
 best_stats: {'best_test_epoch': 16, 'best_test_valid/acc': 71.34, 'best_test_valid/acc_unbiased': 65.35, 'best_test_valid/diff': 18.737, 'best_test_valid/acc_skew': 55.981, 'best_test_valid/acc_align': 74.718, 'best_test_test/acc': 72.675, 'best_test_test/acc_unbiased': 67.903, 'best_test_test/diff': 15.831, 'best_test_test/acc_skew': 59.987, 'best_test_test/acc_align': 75.818}
Total training time: 0:15:52
