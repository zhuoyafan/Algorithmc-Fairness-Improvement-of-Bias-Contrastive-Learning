Log level set to: INFO
Set seed: 3
=======> Using Fixed Random Seed: 3 <========
save_path: exp_results/bc-bb0-utk_face_race-test-0.8-lr0.001-bs128-cbs64-w0.01-ratio10-aug1-seed3
get_utk_face - split: train, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_race-0.8
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [4407, 1105]
Target 1: [881, 5529]
Binary Target 1
---------------------------
Target 0: [4407, 1105]
Target 1: [881, 5529]
===================================
Normal Label Distribution: 
Target 0: [4407, 1105]
Target 1: [881, 5529]
===================================
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [4407, 1105]
Target 1: [881, 5529]
Binary Target 1
---------------------------
Target 0: [4407, 1105]
Target 1: [881, 5529]
===================================
Normal Label Distribution: 
Target 0: [4407, 1105]
Target 1: [881, 5529]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 11922, target_attr: gender, bias_attr: race bias_rate: 0.8
['[train] target_0-bias_0: 4407', '[train] target_0-bias_1: 1105', '[train] target_1-bias_0: 881', '[train] target_1-bias_1: 5529']
confusion_matrix - 
 original: tensor([[4407.,  881.],
        [1105., 5529.]]), 
 normalized: tensor([[0.833, 0.167],
        [0.167, 0.833]]), 
 b|y: tensor([[0.800, 0.200],
        [0.137, 0.863]])
get_utk_face - split: train, aug: 1, given_y: True, ratio: 10
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_race-0.8
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [4407, 1105]
Target 1: [881, 5529]
Binary Target 1
---------------------------
Target 0: [4407, 1105]
Target 1: [881, 5529]
===================================
Normal Label Distribution: 
Target 0: [4407, 1105]
Target 1: [881, 5529]
===================================
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [4407, 1105]
Target 1: [881, 5529]
Binary Target 1
---------------------------
Target 0: [4407, 1105]
Target 1: [881, 5529]
===================================
Normal Label Distribution: 
Target 0: [4407, 1105]
Target 1: [881, 5529]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 11922, target_attr: gender, bias_attr: race bias_rate: 0.8
['[train] target_0-bias_0: 4407', '[train] target_0-bias_1: 1105', '[train] target_1-bias_0: 881', '[train] target_1-bias_1: 5529']
get_utk_face - split: valid, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_race-0.8
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [583, 684]
Target 1: [457, 646]
Binary Target 1
---------------------------
Target 0: [583, 684]
Target 1: [457, 646]
===================================
Normal Label Distribution: 
Target 0: [583, 684]
Target 1: [457, 646]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 2370, target_attr: gender, bias_attr: race bias_rate: 0.8
['[valid] target_0-bias_0: 583', '[valid] target_0-bias_1: 684', '[valid] target_1-bias_0: 457', '[valid] target_1-bias_1: 646']
get_utk_face - split: test, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_race-0.8
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [558, 677]
Target 1: [462, 673]
Binary Target 1
---------------------------
Target 0: [558, 677]
Target 1: [462, 673]
===================================
Normal Label Distribution: 
Target 0: [558, 677]
Target 1: [462, 673]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 2370, target_attr: gender, bias_attr: race bias_rate: 0.8
['[test] target_0-bias_0: 558', '[test] target_0-bias_1: 677', '[test] target_1-bias_0: 462', '[test] target_1-bias_1: 673']
decay_epochs: [6, 13]
[1 / 20] Learning rate: 0.001 weight: 0.01
[1 / 20] Loss: 4.883941520962254 CE Loss: 0.5767048375955706 Con Loss: 4.878174476706728
[1 / 20] tensor([[0.780, 0.778],
        [0.861, 0.801]]) {'epoch': 1, 'valid/acc': 80.422, 'valid/acc_unbiased': 80.756, 'valid/diff': 3.617, 'valid/acc_skew': 81.815, 'valid/acc_align': 79.697, 'test/acc': 80.127, 'test/acc_unbiased': 80.509, 'test/diff': 3.086, 'test/acc_skew': 81.995, 'test/acc_align': 79.023}
[1 / 20] best valid accuracy: 80.756 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 80.422, 'best_valid_valid/acc_unbiased': 80.756, 'best_valid_valid/diff': 3.617, 'best_valid_valid/acc_skew': 81.815, 'best_valid_valid/acc_align': 79.697, 'best_valid_test/acc': 80.127, 'best_valid_test/acc_unbiased': 80.509, 'best_valid_test/diff': 3.086, 'best_valid_test/acc_skew': 81.995, 'best_valid_test/acc_align': 79.023}
[1 / 20] best test accuracy: 80.509 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 80.422, 'best_test_valid/acc_unbiased': 80.756, 'best_test_valid/diff': 3.617, 'best_test_valid/acc_skew': 81.815, 'best_test_valid/acc_align': 79.697, 'best_test_test/acc': 80.127, 'best_test_test/acc_unbiased': 80.509, 'best_test_test/diff': 3.086, 'best_test_test/acc_skew': 81.995, 'best_test_test/acc_align': 79.023}
[2 / 20] Learning rate: 0.001 weight: 0.01
[2 / 20] Loss: 4.761975958730886 CE Loss: 0.45569037806165835 Con Loss: 4.7574190499898155
[2 / 20] tensor([[0.871, 0.838],
        [0.766, 0.796]]) {'epoch': 2, 'valid/acc': 82.236, 'valid/acc_unbiased': 82.075, 'valid/diff': 3.21, 'valid/acc_skew': 81.712, 'valid/acc_align': 82.437, 'test/acc': 81.983, 'test/acc_unbiased': 81.779, 'test/diff': 3.182, 'test/acc_skew': 80.188, 'test/acc_align': 83.37}
[2 / 20] best valid accuracy: 82.075 at epoch 2 
 best_stats: {'best_valid_epoch': 2, 'best_valid_valid/acc': 82.236, 'best_valid_valid/acc_unbiased': 82.075, 'best_valid_valid/diff': 3.21, 'best_valid_valid/acc_skew': 81.712, 'best_valid_valid/acc_align': 82.437, 'best_valid_test/acc': 81.983, 'best_valid_test/acc_unbiased': 81.779, 'best_valid_test/diff': 3.182, 'best_valid_test/acc_skew': 80.188, 'best_valid_test/acc_align': 83.37}
[2 / 20] best test accuracy: 81.779 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 82.236, 'best_test_valid/acc_unbiased': 82.075, 'best_test_valid/diff': 3.21, 'best_test_valid/acc_skew': 81.712, 'best_test_valid/acc_align': 82.437, 'best_test_test/acc': 81.983, 'best_test_test/acc_unbiased': 81.779, 'best_test_test/diff': 3.182, 'best_test_test/acc_skew': 80.188, 'best_test_test/acc_align': 83.37}
[3 / 20] Learning rate: 0.001 weight: 0.01
[3 / 20] Loss: 4.732848315086167 CE Loss: 0.4316830696165312 Con Loss: 4.728531490134585
[3 / 20] tensor([[0.832, 0.780],
        [0.823, 0.866]]) {'epoch': 3, 'valid/acc': 83.544, 'valid/acc_unbiased': 83.66, 'valid/diff': 0.773, 'valid/acc_skew': 83.386, 'valid/acc_align': 83.933, 'test/acc': 82.489, 'test/acc_unbiased': 82.506, 'test/diff': 4.769, 'test/acc_skew': 80.121, 'test/acc_align': 84.891}
[3 / 20] best valid accuracy: 83.660 at epoch 3 
 best_stats: {'best_valid_epoch': 3, 'best_valid_valid/acc': 83.544, 'best_valid_valid/acc_unbiased': 83.66, 'best_valid_valid/diff': 0.773, 'best_valid_valid/acc_skew': 83.386, 'best_valid_valid/acc_align': 83.933, 'best_valid_test/acc': 82.489, 'best_valid_test/acc_unbiased': 82.506, 'best_valid_test/diff': 4.769, 'best_valid_test/acc_skew': 80.121, 'best_valid_test/acc_align': 84.891}
[3 / 20] best test accuracy: 82.506 at epoch 3 
 best_stats: {'best_test_epoch': 3, 'best_test_valid/acc': 83.544, 'best_test_valid/acc_unbiased': 83.66, 'best_test_valid/diff': 0.773, 'best_test_valid/acc_skew': 83.386, 'best_test_valid/acc_align': 83.933, 'best_test_test/acc': 82.489, 'best_test_test/acc_unbiased': 82.506, 'best_test_test/diff': 4.769, 'best_test_test/acc_skew': 80.121, 'best_test_test/acc_align': 84.891}
[4 / 20] Learning rate: 0.001 weight: 0.01
[4 / 20] Loss: 4.7151115861760555 CE Loss: 0.4113343343141195 Con Loss: 4.7109982446223535
[4 / 20] tensor([[0.724, 0.690],
        [0.916, 0.941]]) {'epoch': 4, 'valid/acc': 81.688, 'valid/acc_unbiased': 82.407, 'valid/diff': 1.407, 'valid/acc_skew': 82.099, 'valid/acc_align': 82.715, 'test/acc': 81.308, 'test/acc_unbiased': 81.749, 'test/diff': 2.959, 'test/acc_skew': 80.27, 'test/acc_align': 83.229}
[4 / 20] best valid accuracy: 83.660 at epoch 3 
 best_stats: {'best_valid_epoch': 3, 'best_valid_valid/acc': 83.544, 'best_valid_valid/acc_unbiased': 83.66, 'best_valid_valid/diff': 0.773, 'best_valid_valid/acc_skew': 83.386, 'best_valid_valid/acc_align': 83.933, 'best_valid_test/acc': 82.489, 'best_valid_test/acc_unbiased': 82.506, 'best_valid_test/diff': 4.769, 'best_valid_test/acc_skew': 80.121, 'best_valid_test/acc_align': 84.891}
[4 / 20] best test accuracy: 82.506 at epoch 3 
 best_stats: {'best_test_epoch': 3, 'best_test_valid/acc': 83.544, 'best_test_valid/acc_unbiased': 83.66, 'best_test_valid/diff': 0.773, 'best_test_valid/acc_skew': 83.386, 'best_test_valid/acc_align': 83.933, 'best_test_test/acc': 82.489, 'best_test_test/acc_unbiased': 82.506, 'best_test_test/diff': 4.769, 'best_test_test/acc_skew': 80.121, 'best_test_test/acc_align': 84.891}
[5 / 20] Learning rate: 0.001 weight: 0.01
[5 / 20] Loss: 4.711498117870861 CE Loss: 0.39570481365028193 Con Loss: 4.707541089393092
[5 / 20] tensor([[0.738, 0.719],
        [0.920, 0.929]]) {'epoch': 5, 'valid/acc': 81.983, 'valid/acc_unbiased': 82.684, 'valid/diff': 1.532, 'valid/acc_skew': 83.45, 'valid/acc_align': 81.918, 'test/acc': 82.236, 'test/acc_unbiased': 82.657, 'test/diff': 1.388, 'test/acc_skew': 81.963, 'test/acc_align': 83.351}
[5 / 20] best valid accuracy: 83.660 at epoch 3 
 best_stats: {'best_valid_epoch': 3, 'best_valid_valid/acc': 83.544, 'best_valid_valid/acc_unbiased': 83.66, 'best_valid_valid/diff': 0.773, 'best_valid_valid/acc_skew': 83.386, 'best_valid_valid/acc_align': 83.933, 'best_valid_test/acc': 82.489, 'best_valid_test/acc_unbiased': 82.506, 'best_valid_test/diff': 4.769, 'best_valid_test/acc_skew': 80.121, 'best_valid_test/acc_align': 84.891}
[5 / 20] best test accuracy: 82.657 at epoch 5 
 best_stats: {'best_test_epoch': 5, 'best_test_valid/acc': 81.983, 'best_test_valid/acc_unbiased': 82.684, 'best_test_valid/diff': 1.532, 'best_test_valid/acc_skew': 83.45, 'best_test_valid/acc_align': 81.918, 'best_test_test/acc': 82.236, 'best_test_test/acc_unbiased': 82.657, 'best_test_test/diff': 1.388, 'best_test_test/acc_skew': 81.963, 'best_test_test/acc_align': 83.351}
[6 / 20] Learning rate: 0.001 weight: 0.01
[6 / 20] Loss: 4.693857435531373 CE Loss: 0.39649323218421956 Con Loss: 4.689892487285162
[6 / 20] tensor([[0.830, 0.793],
        [0.855, 0.860]]) {'epoch': 6, 'valid/acc': 82.785, 'valid/acc_unbiased': 83.045, 'valid/diff': 1.263, 'valid/acc_skew': 83.677, 'valid/acc_align': 82.414, 'test/acc': 83.291, 'test/acc_unbiased': 83.456, 'test/diff': 2.095, 'test/acc_skew': 82.409, 'test/acc_align': 84.504}
[6 / 20] best valid accuracy: 83.660 at epoch 3 
 best_stats: {'best_valid_epoch': 3, 'best_valid_valid/acc': 83.544, 'best_valid_valid/acc_unbiased': 83.66, 'best_valid_valid/diff': 0.773, 'best_valid_valid/acc_skew': 83.386, 'best_valid_valid/acc_align': 83.933, 'best_valid_test/acc': 82.489, 'best_valid_test/acc_unbiased': 82.506, 'best_valid_test/diff': 4.769, 'best_valid_test/acc_skew': 80.121, 'best_valid_test/acc_align': 84.891}
[6 / 20] best test accuracy: 83.456 at epoch 6 
 best_stats: {'best_test_epoch': 6, 'best_test_valid/acc': 82.785, 'best_test_valid/acc_unbiased': 83.045, 'best_test_valid/diff': 1.263, 'best_test_valid/acc_skew': 83.677, 'best_test_valid/acc_align': 82.414, 'best_test_test/acc': 83.291, 'best_test_test/acc_unbiased': 83.456, 'best_test_test/diff': 2.095, 'best_test_test/acc_skew': 82.409, 'best_test_test/acc_align': 84.504}
[7 / 20] Learning rate: 0.0001 weight: 0.01
[7 / 20] Loss: 4.669912127715752 CE Loss: 0.3650725922754918 Con Loss: 4.666261425075906
[7 / 20] tensor([[0.853, 0.815],
        [0.872, 0.893]]) {'epoch': 7, 'valid/acc': 86.287, 'valid/acc_unbiased': 86.596, 'valid/diff': 2.724, 'valid/acc_skew': 86.889, 'valid/acc_align': 86.303, 'test/acc': 85.738, 'test/acc_unbiased': 85.843, 'test/diff': 2.92, 'test/acc_skew': 84.383, 'test/acc_align': 87.303}
[7 / 20] best valid accuracy: 86.596 at epoch 7 
 best_stats: {'best_valid_epoch': 7, 'best_valid_valid/acc': 86.287, 'best_valid_valid/acc_unbiased': 86.596, 'best_valid_valid/diff': 2.724, 'best_valid_valid/acc_skew': 86.889, 'best_valid_valid/acc_align': 86.303, 'best_valid_test/acc': 85.738, 'best_valid_test/acc_unbiased': 85.843, 'best_valid_test/diff': 2.92, 'best_valid_test/acc_skew': 84.383, 'best_valid_test/acc_align': 87.303}
[7 / 20] best test accuracy: 85.843 at epoch 7 
 best_stats: {'best_test_epoch': 7, 'best_test_valid/acc': 86.287, 'best_test_valid/acc_unbiased': 86.596, 'best_test_valid/diff': 2.724, 'best_test_valid/acc_skew': 86.889, 'best_test_valid/acc_align': 86.303, 'best_test_test/acc': 85.738, 'best_test_test/acc_unbiased': 85.843, 'best_test_test/diff': 2.92, 'best_test_test/acc_skew': 84.383, 'best_test_test/acc_align': 87.303}
[8 / 20] Learning rate: 0.0001 weight: 0.01
[8 / 20] Loss: 4.633766012170974 CE Loss: 0.34025266458575826 Con Loss: 4.630363480354031
[8 / 20] tensor([[0.862, 0.820],
        [0.870, 0.900]]) {'epoch': 8, 'valid/acc': 86.287, 'valid/acc_unbiased': 86.615, 'valid/diff': 2.686, 'valid/acc_skew': 86.232, 'valid/acc_align': 86.999, 'test/acc': 86.245, 'test/acc_unbiased': 86.309, 'test/diff': 3.626, 'test/acc_skew': 84.496, 'test/acc_align': 88.123}
[8 / 20] best valid accuracy: 86.615 at epoch 8 
 best_stats: {'best_valid_epoch': 8, 'best_valid_valid/acc': 86.287, 'best_valid_valid/acc_unbiased': 86.615, 'best_valid_valid/diff': 2.686, 'best_valid_valid/acc_skew': 86.232, 'best_valid_valid/acc_align': 86.999, 'best_valid_test/acc': 86.245, 'best_valid_test/acc_unbiased': 86.309, 'best_valid_test/diff': 3.626, 'best_valid_test/acc_skew': 84.496, 'best_valid_test/acc_align': 88.123}
[8 / 20] best test accuracy: 86.309 at epoch 8 
 best_stats: {'best_test_epoch': 8, 'best_test_valid/acc': 86.287, 'best_test_valid/acc_unbiased': 86.615, 'best_test_valid/diff': 2.686, 'best_test_valid/acc_skew': 86.232, 'best_test_valid/acc_align': 86.999, 'best_test_test/acc': 86.245, 'best_test_test/acc_unbiased': 86.309, 'best_test_test/diff': 3.626, 'best_test_test/acc_skew': 84.496, 'best_test_test/acc_align': 88.123}
[9 / 20] Learning rate: 0.0001 weight: 0.01
[9 / 20] Loss: 4.6278565721491045 CE Loss: 0.3287082845943523 Con Loss: 4.62456948875961
[9 / 20] tensor([[0.871, 0.809],
        [0.868, 0.903]]) {'epoch': 9, 'valid/acc': 86.751, 'valid/acc_unbiased': 86.989, 'valid/diff': 1.335, 'valid/acc_skew': 87.657, 'valid/acc_align': 86.322, 'test/acc': 86.203, 'test/acc_unbiased': 86.295, 'test/diff': 4.848, 'test/acc_skew': 83.871, 'test/acc_align': 88.719}
[9 / 20] best valid accuracy: 86.989 at epoch 9 
 best_stats: {'best_valid_epoch': 9, 'best_valid_valid/acc': 86.751, 'best_valid_valid/acc_unbiased': 86.989, 'best_valid_valid/diff': 1.335, 'best_valid_valid/acc_skew': 87.657, 'best_valid_valid/acc_align': 86.322, 'best_valid_test/acc': 86.203, 'best_valid_test/acc_unbiased': 86.295, 'best_valid_test/diff': 4.848, 'best_valid_test/acc_skew': 83.871, 'best_valid_test/acc_align': 88.719}
[9 / 20] best test accuracy: 86.309 at epoch 8 
 best_stats: {'best_test_epoch': 8, 'best_test_valid/acc': 86.287, 'best_test_valid/acc_unbiased': 86.615, 'best_test_valid/diff': 2.686, 'best_test_valid/acc_skew': 86.232, 'best_test_valid/acc_align': 86.999, 'best_test_test/acc': 86.245, 'best_test_test/acc_unbiased': 86.309, 'best_test_test/diff': 3.626, 'best_test_test/acc_skew': 84.496, 'best_test_test/acc_align': 88.123}
[10 / 20] Learning rate: 0.0001 weight: 0.01
[10 / 20] Loss: 4.612478592835343 CE Loss: 0.32169701421476815 Con Loss: 4.609261614027249
[10 / 20] tensor([[0.873, 0.821],
        [0.864, 0.897]]) {'epoch': 10, 'valid/acc': 87.342, 'valid/acc_unbiased': 87.494, 'valid/diff': 0.615, 'valid/acc_skew': 87.585, 'valid/acc_align': 87.403, 'test/acc': 86.329, 'test/acc_unbiased': 86.379, 'test/diff': 4.266, 'test/acc_skew': 84.245, 'test/acc_align': 88.512}
[10 / 20] best valid accuracy: 87.494 at epoch 10 
 best_stats: {'best_valid_epoch': 10, 'best_valid_valid/acc': 87.342, 'best_valid_valid/acc_unbiased': 87.494, 'best_valid_valid/diff': 0.615, 'best_valid_valid/acc_skew': 87.585, 'best_valid_valid/acc_align': 87.403, 'best_valid_test/acc': 86.329, 'best_valid_test/acc_unbiased': 86.379, 'best_valid_test/diff': 4.266, 'best_valid_test/acc_skew': 84.245, 'best_valid_test/acc_align': 88.512}
[10 / 20] best test accuracy: 86.379 at epoch 10 
 best_stats: {'best_test_epoch': 10, 'best_test_valid/acc': 87.342, 'best_test_valid/acc_unbiased': 87.494, 'best_test_valid/diff': 0.615, 'best_test_valid/acc_skew': 87.585, 'best_test_valid/acc_align': 87.403, 'best_test_test/acc': 86.329, 'best_test_test/acc_unbiased': 86.379, 'best_test_test/diff': 4.266, 'best_test_test/acc_skew': 84.245, 'best_test_test/acc_align': 88.512}
[11 / 20] Learning rate: 0.0001 weight: 0.01
[11 / 20] Loss: 4.605602303600775 CE Loss: 0.3068448701044434 Con Loss: 4.602533896724123
[11 / 20] tensor([[0.862, 0.820],
        [0.877, 0.906]]) {'epoch': 11, 'valid/acc': 87.173, 'valid/acc_unbiased': 87.431, 'valid/diff': 1.445, 'valid/acc_skew': 86.926, 'valid/acc_align': 87.936, 'test/acc': 86.54, 'test/acc_unbiased': 86.62, 'test/diff': 3.599, 'test/acc_skew': 84.821, 'test/acc_align': 88.42}
[11 / 20] best valid accuracy: 87.494 at epoch 10 
 best_stats: {'best_valid_epoch': 10, 'best_valid_valid/acc': 87.342, 'best_valid_valid/acc_unbiased': 87.494, 'best_valid_valid/diff': 0.615, 'best_valid_valid/acc_skew': 87.585, 'best_valid_valid/acc_align': 87.403, 'best_valid_test/acc': 86.329, 'best_valid_test/acc_unbiased': 86.379, 'best_valid_test/diff': 4.266, 'best_valid_test/acc_skew': 84.245, 'best_valid_test/acc_align': 88.512}
[11 / 20] best test accuracy: 86.620 at epoch 11 
 best_stats: {'best_test_epoch': 11, 'best_test_valid/acc': 87.173, 'best_test_valid/acc_unbiased': 87.431, 'best_test_valid/diff': 1.445, 'best_test_valid/acc_skew': 86.926, 'best_test_valid/acc_align': 87.936, 'best_test_test/acc': 86.54, 'best_test_test/acc_unbiased': 86.62, 'best_test_test/diff': 3.599, 'best_test_test/acc_skew': 84.821, 'best_test_test/acc_align': 88.42}
[12 / 20] Learning rate: 0.0001 weight: 0.01
[12 / 20] Loss: 4.601119887686839 CE Loss: 0.3035538813208318 Con Loss: 4.598084368895332
[12 / 20] tensor([[0.878, 0.842],
        [0.857, 0.890]]) {'epoch': 12, 'valid/acc': 87.553, 'valid/acc_unbiased': 87.673, 'valid/diff': 1.125, 'valid/acc_skew': 87.11, 'valid/acc_align': 88.236, 'test/acc': 86.709, 'test/acc_unbiased': 86.682, 'test/diff': 3.454, 'test/acc_skew': 84.955, 'test/acc_align': 88.409}
[12 / 20] best valid accuracy: 87.673 at epoch 12 
 best_stats: {'best_valid_epoch': 12, 'best_valid_valid/acc': 87.553, 'best_valid_valid/acc_unbiased': 87.673, 'best_valid_valid/diff': 1.125, 'best_valid_valid/acc_skew': 87.11, 'best_valid_valid/acc_align': 88.236, 'best_valid_test/acc': 86.709, 'best_valid_test/acc_unbiased': 86.682, 'best_valid_test/diff': 3.454, 'best_valid_test/acc_skew': 84.955, 'best_valid_test/acc_align': 88.409}
[12 / 20] best test accuracy: 86.682 at epoch 12 
 best_stats: {'best_test_epoch': 12, 'best_test_valid/acc': 87.553, 'best_test_valid/acc_unbiased': 87.673, 'best_test_valid/diff': 1.125, 'best_test_valid/acc_skew': 87.11, 'best_test_valid/acc_align': 88.236, 'best_test_test/acc': 86.709, 'best_test_test/acc_unbiased': 86.682, 'best_test_test/diff': 3.454, 'best_test_test/acc_skew': 84.955, 'best_test_test/acc_align': 88.409}
[13 / 20] Learning rate: 0.0001 weight: 0.01
[13 / 20] Loss: 4.590425703393955 CE Loss: 0.31005865250472114 Con Loss: 4.587325112608891
[13 / 20] tensor([[0.900, 0.842],
        [0.857, 0.880]]) {'epoch': 13, 'valid/acc': 87.722, 'valid/acc_unbiased': 87.819, 'valid/diff': 1.49, 'valid/acc_skew': 87.732, 'valid/acc_align': 87.907, 'test/acc': 86.92, 'test/acc_unbiased': 86.959, 'test/diff': 4.01, 'test/acc_skew': 84.955, 'test/acc_align': 88.964}
[13 / 20] best valid accuracy: 87.819 at epoch 13 
 best_stats: {'best_valid_epoch': 13, 'best_valid_valid/acc': 87.722, 'best_valid_valid/acc_unbiased': 87.819, 'best_valid_valid/diff': 1.49, 'best_valid_valid/acc_skew': 87.732, 'best_valid_valid/acc_align': 87.907, 'best_valid_test/acc': 86.92, 'best_valid_test/acc_unbiased': 86.959, 'best_valid_test/diff': 4.01, 'best_valid_test/acc_skew': 84.955, 'best_valid_test/acc_align': 88.964}
[13 / 20] best test accuracy: 86.959 at epoch 13 
 best_stats: {'best_test_epoch': 13, 'best_test_valid/acc': 87.722, 'best_test_valid/acc_unbiased': 87.819, 'best_test_valid/diff': 1.49, 'best_test_valid/acc_skew': 87.732, 'best_test_valid/acc_align': 87.907, 'best_test_test/acc': 86.92, 'best_test_test/acc_unbiased': 86.959, 'best_test_test/diff': 4.01, 'best_test_test/acc_skew': 84.955, 'best_test_test/acc_align': 88.964}
[14 / 20] Learning rate: 1e-05 weight: 0.01
[14 / 20] Loss: 4.589866415563595 CE Loss: 0.2963118944526459 Con Loss: 4.586903302346754
[14 / 20] tensor([[0.878, 0.830],
        [0.864, 0.893]]) {'epoch': 14, 'valid/acc': 87.722, 'valid/acc_unbiased': 87.948, 'valid/diff': 1.954, 'valid/acc_skew': 87.73, 'valid/acc_align': 88.167, 'test/acc': 86.582, 'test/acc_unbiased': 86.623, 'test/diff': 3.869, 'test/acc_skew': 84.688, 'test/acc_align': 88.558}
[14 / 20] best valid accuracy: 87.948 at epoch 14 
 best_stats: {'best_valid_epoch': 14, 'best_valid_valid/acc': 87.722, 'best_valid_valid/acc_unbiased': 87.948, 'best_valid_valid/diff': 1.954, 'best_valid_valid/acc_skew': 87.73, 'best_valid_valid/acc_align': 88.167, 'best_valid_test/acc': 86.582, 'best_valid_test/acc_unbiased': 86.623, 'best_valid_test/diff': 3.869, 'best_valid_test/acc_skew': 84.688, 'best_valid_test/acc_align': 88.558}
[14 / 20] best test accuracy: 86.959 at epoch 13 
 best_stats: {'best_test_epoch': 13, 'best_test_valid/acc': 87.722, 'best_test_valid/acc_unbiased': 87.819, 'best_test_valid/diff': 1.49, 'best_test_valid/acc_skew': 87.732, 'best_test_valid/acc_align': 87.907, 'best_test_test/acc': 86.92, 'best_test_test/acc_unbiased': 86.959, 'best_test_test/diff': 4.01, 'best_test_test/acc_skew': 84.955, 'best_test_test/acc_align': 88.964}
[15 / 20] Learning rate: 1e-05 weight: 0.01
[15 / 20] Loss: 4.583850915550766 CE Loss: 0.29418669772256123 Con Loss: 4.580909046825197
[15 / 20] tensor([[0.876, 0.824],
        [0.866, 0.900]]) {'epoch': 15, 'valid/acc': 87.848, 'valid/acc_unbiased': 88.074, 'valid/diff': 1.75, 'valid/acc_skew': 87.912, 'valid/acc_align': 88.236, 'test/acc': 86.624, 'test/acc_unbiased': 86.67, 'test/diff': 4.338, 'test/acc_skew': 84.501, 'test/acc_align': 88.839}
[15 / 20] best valid accuracy: 88.074 at epoch 15 
 best_stats: {'best_valid_epoch': 15, 'best_valid_valid/acc': 87.848, 'best_valid_valid/acc_unbiased': 88.074, 'best_valid_valid/diff': 1.75, 'best_valid_valid/acc_skew': 87.912, 'best_valid_valid/acc_align': 88.236, 'best_valid_test/acc': 86.624, 'best_valid_test/acc_unbiased': 86.67, 'best_valid_test/diff': 4.338, 'best_valid_test/acc_skew': 84.501, 'best_valid_test/acc_align': 88.839}
[15 / 20] best test accuracy: 86.959 at epoch 13 
 best_stats: {'best_test_epoch': 13, 'best_test_valid/acc': 87.722, 'best_test_valid/acc_unbiased': 87.819, 'best_test_valid/diff': 1.49, 'best_test_valid/acc_skew': 87.732, 'best_test_valid/acc_align': 87.907, 'best_test_test/acc': 86.92, 'best_test_test/acc_unbiased': 86.959, 'best_test_test/diff': 4.01, 'best_test_test/acc_skew': 84.955, 'best_test_test/acc_align': 88.964}
[16 / 20] Learning rate: 1e-05 weight: 0.01
[16 / 20] Loss: 4.576031850940568 CE Loss: 0.2918638680089622 Con Loss: 4.573113201728825
[16 / 20] tensor([[0.862, 0.809],
        [0.890, 0.924]]) {'epoch': 16, 'valid/acc': 87.257, 'valid/acc_unbiased': 87.597, 'valid/diff': 1.863, 'valid/acc_skew': 86.888, 'valid/acc_align': 88.307, 'test/acc': 87.004, 'test/acc_unbiased': 87.132, 'test/diff': 4.358, 'test/acc_skew': 84.953, 'test/acc_align': 89.311}
[16 / 20] best valid accuracy: 88.074 at epoch 15 
 best_stats: {'best_valid_epoch': 15, 'best_valid_valid/acc': 87.848, 'best_valid_valid/acc_unbiased': 88.074, 'best_valid_valid/diff': 1.75, 'best_valid_valid/acc_skew': 87.912, 'best_valid_valid/acc_align': 88.236, 'best_valid_test/acc': 86.624, 'best_valid_test/acc_unbiased': 86.67, 'best_valid_test/diff': 4.338, 'best_valid_test/acc_skew': 84.501, 'best_valid_test/acc_align': 88.839}
[16 / 20] best test accuracy: 87.132 at epoch 16 
 best_stats: {'best_test_epoch': 16, 'best_test_valid/acc': 87.257, 'best_test_valid/acc_unbiased': 87.597, 'best_test_valid/diff': 1.863, 'best_test_valid/acc_skew': 86.888, 'best_test_valid/acc_align': 88.307, 'best_test_test/acc': 87.004, 'best_test_test/acc_unbiased': 87.132, 'best_test_test/diff': 4.358, 'best_test_test/acc_skew': 84.953, 'best_test_test/acc_align': 89.311}
[17 / 20] Learning rate: 1e-05 weight: 0.01
[17 / 20] Loss: 4.577299345221581 CE Loss: 0.29046822566650915 Con Loss: 4.574394683793095
[17 / 20] tensor([[0.892, 0.839],
        [0.853, 0.892]]) {'epoch': 17, 'valid/acc': 87.975, 'valid/acc_unbiased': 88.053, 'valid/diff': 0.728, 'valid/acc_skew': 87.914, 'valid/acc_align': 88.192, 'test/acc': 86.92, 'test/acc_unbiased': 86.895, 'test/diff': 4.61, 'test/acc_skew': 84.59, 'test/acc_align': 89.2}
[17 / 20] best valid accuracy: 88.074 at epoch 15 
 best_stats: {'best_valid_epoch': 15, 'best_valid_valid/acc': 87.848, 'best_valid_valid/acc_unbiased': 88.074, 'best_valid_valid/diff': 1.75, 'best_valid_valid/acc_skew': 87.912, 'best_valid_valid/acc_align': 88.236, 'best_valid_test/acc': 86.624, 'best_valid_test/acc_unbiased': 86.67, 'best_valid_test/diff': 4.338, 'best_valid_test/acc_skew': 84.501, 'best_valid_test/acc_align': 88.839}
[17 / 20] best test accuracy: 87.132 at epoch 16 
 best_stats: {'best_test_epoch': 16, 'best_test_valid/acc': 87.257, 'best_test_valid/acc_unbiased': 87.597, 'best_test_valid/diff': 1.863, 'best_test_valid/acc_skew': 86.888, 'best_test_valid/acc_align': 88.307, 'best_test_test/acc': 87.004, 'best_test_test/acc_unbiased': 87.132, 'best_test_test/diff': 4.358, 'best_test_test/acc_skew': 84.953, 'best_test_test/acc_align': 89.311}
[18 / 20] Learning rate: 1e-05 weight: 0.01
[18 / 20] Loss: 4.57931492405037 CE Loss: 0.29428979327736277 Con Loss: 4.57637202901701
[18 / 20] tensor([[0.885, 0.830],
        [0.859, 0.899]]) {'epoch': 18, 'valid/acc': 87.89, 'valid/acc_unbiased': 88.031, 'valid/diff': 0.96, 'valid/acc_skew': 88.06, 'valid/acc_align': 88.003, 'test/acc': 86.835, 'test/acc_unbiased': 86.843, 'test/diff': 4.741, 'test/acc_skew': 84.472, 'test/acc_align': 89.213}
[18 / 20] best valid accuracy: 88.074 at epoch 15 
 best_stats: {'best_valid_epoch': 15, 'best_valid_valid/acc': 87.848, 'best_valid_valid/acc_unbiased': 88.074, 'best_valid_valid/diff': 1.75, 'best_valid_valid/acc_skew': 87.912, 'best_valid_valid/acc_align': 88.236, 'best_valid_test/acc': 86.624, 'best_valid_test/acc_unbiased': 86.67, 'best_valid_test/diff': 4.338, 'best_valid_test/acc_skew': 84.501, 'best_valid_test/acc_align': 88.839}
[18 / 20] best test accuracy: 87.132 at epoch 16 
 best_stats: {'best_test_epoch': 16, 'best_test_valid/acc': 87.257, 'best_test_valid/acc_unbiased': 87.597, 'best_test_valid/diff': 1.863, 'best_test_valid/acc_skew': 86.888, 'best_test_valid/acc_align': 88.307, 'best_test_test/acc': 87.004, 'best_test_test/acc_unbiased': 87.132, 'best_test_test/diff': 4.358, 'best_test_test/acc_skew': 84.953, 'best_test_test/acc_align': 89.311}
[19 / 20] Learning rate: 1e-05 weight: 0.01
[19 / 20] Loss: 4.589550341801482 CE Loss: 0.2901172368213687 Con Loss: 4.586649164060002
[19 / 20] tensor([[0.884, 0.823],
        [0.872, 0.908]]) {'epoch': 19, 'valid/acc': 87.89, 'valid/acc_unbiased': 88.073, 'valid/diff': 0.846, 'valid/acc_skew': 88.022, 'valid/acc_align': 88.125, 'test/acc': 87.089, 'test/acc_unbiased': 87.161, 'test/diff': 4.817, 'test/acc_skew': 84.752, 'test/acc_align': 89.569}
[19 / 20] best valid accuracy: 88.074 at epoch 15 
 best_stats: {'best_valid_epoch': 15, 'best_valid_valid/acc': 87.848, 'best_valid_valid/acc_unbiased': 88.074, 'best_valid_valid/diff': 1.75, 'best_valid_valid/acc_skew': 87.912, 'best_valid_valid/acc_align': 88.236, 'best_valid_test/acc': 86.624, 'best_valid_test/acc_unbiased': 86.67, 'best_valid_test/diff': 4.338, 'best_valid_test/acc_skew': 84.501, 'best_valid_test/acc_align': 88.839}
[19 / 20] best test accuracy: 87.161 at epoch 19 
 best_stats: {'best_test_epoch': 19, 'best_test_valid/acc': 87.89, 'best_test_valid/acc_unbiased': 88.073, 'best_test_valid/diff': 0.846, 'best_test_valid/acc_skew': 88.022, 'best_test_valid/acc_align': 88.125, 'best_test_test/acc': 87.089, 'best_test_test/acc_unbiased': 87.161, 'best_test_test/diff': 4.817, 'best_test_test/acc_skew': 84.752, 'best_test_test/acc_align': 89.569}
[20 / 20] Learning rate: 1e-05 weight: 0.01
[20 / 20] Loss: 4.599173928283041 CE Loss: 0.29174641571905247 Con Loss: 4.596256469844312
[20 / 20] tensor([[0.889, 0.838],
        [0.868, 0.899]]) {'epoch': 20, 'valid/acc': 87.975, 'valid/acc_unbiased': 88.113, 'valid/diff': 0.968, 'valid/acc_skew': 88.06, 'valid/acc_align': 88.167, 'test/acc': 87.3, 'test/acc_unbiased': 87.333, 'test/diff': 4.118, 'test/acc_skew': 85.274, 'test/acc_align': 89.392}
[20 / 20] best valid accuracy: 88.113 at epoch 20 
 best_stats: {'best_valid_epoch': 20, 'best_valid_valid/acc': 87.975, 'best_valid_valid/acc_unbiased': 88.113, 'best_valid_valid/diff': 0.968, 'best_valid_valid/acc_skew': 88.06, 'best_valid_valid/acc_align': 88.167, 'best_valid_test/acc': 87.3, 'best_valid_test/acc_unbiased': 87.333, 'best_valid_test/diff': 4.118, 'best_valid_test/acc_skew': 85.274, 'best_valid_test/acc_align': 89.392}
[20 / 20] best test accuracy: 87.333 at epoch 20 
 best_stats: {'best_test_epoch': 20, 'best_test_valid/acc': 87.975, 'best_test_valid/acc_unbiased': 88.113, 'best_test_valid/diff': 0.968, 'best_test_valid/acc_skew': 88.06, 'best_test_valid/acc_align': 88.167, 'best_test_test/acc': 87.3, 'best_test_test/acc_unbiased': 87.333, 'best_test_test/diff': 4.118, 'best_test_test/acc_skew': 85.274, 'best_test_test/acc_align': 89.392}
Total training time: 0:58:10
