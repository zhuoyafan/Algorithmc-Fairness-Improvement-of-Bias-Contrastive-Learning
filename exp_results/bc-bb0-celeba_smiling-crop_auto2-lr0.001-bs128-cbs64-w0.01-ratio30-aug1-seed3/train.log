Log level set to: INFO
Set seed: 3
=======> Using Fixed Random Seed: 3 <========
save_path: exp_results/bc-bb0-celeba_smiling-crop_auto2-lr0.001-bs128-cbs64-w0.01-ratio30-aug1-seed3
get_celeba - split:train, aug: False, given_y: True, ratio: 0
use existing smiling indices from data/celeba/pickles/smiling
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [8009, 32847]
Target 1: [40621, 7981]
Binary Target 1
---------------------------
Target 0: [8009, 32847]
Target 1: [40621, 7981]
===================================
Normal Label Distribution: 
Target 0: [8009, 32847]
Target 1: [40621, 7981]
===================================
Use BiasedCelebASplit 
 target_attr: smiling split: train 
 tensor([[ 8009., 40621.],
        [32847.,  7981.]])
get_celeba - split:train, aug: 1, given_y: True, ratio: 30
use existing smiling indices from data/celeba/pickles/smiling
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [8017, 32729]
Target 1: [40802, 7910]
Binary Target 1
---------------------------
Target 0: [8017, 32729]
Target 1: [40802, 7910]
===================================
Normal Label Distribution: 
Target 0: [8017, 32729]
Target 1: [40802, 7910]
===================================
Use BiasedCelebASplit 
 target_attr: smiling split: train 
 tensor([[ 8017., 40802.],
        [32729.,  7910.]])
get_celeba - split:train_valid, aug: False, given_y: True, ratio: 0
use existing smiling indices from data/celeba/pickles/smiling
Use BiasedCelebASplit 
 target_attr: smiling split: train_valid 
 tensor([[ 1944., 10217.],
        [ 8222.,  1982.]])
get_celeba - split:valid, aug: False, given_y: True, ratio: 0
Use BiasedCelebASplit 
 target_attr: smiling split: valid 
 tensor([[5252., 6157.],
        [5013., 3445.]])
decay_epochs: [3, 6]
[1 / 10] Learning rate: 0.001 weight: 0.01
[1 / 10] Loss: 4.67780588132072 CE Loss: 0.2540506961591985 Con Loss: 4.675265375603964
[1 / 10] tensor([[0.948, 0.959],
        [0.887, 0.825]]) {'epoch': 1, 'valid/acc': 90.843, 'valid/acc_unbiased': 90.356, 'valid/diff': 2.602, 'valid/acc_skew': 89.055, 'valid/acc_align': 91.657, 'test/acc': 91.056, 'test/acc_unbiased': 90.477, 'test/diff': 3.617, 'test/acc_skew': 88.668, 'test/acc_align': 92.285}
[1 / 10] best valid accuracy: 90.356 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 90.843, 'best_valid_valid/acc_unbiased': 90.356, 'best_valid_valid/diff': 2.602, 'best_valid_valid/acc_skew': 89.055, 'best_valid_valid/acc_align': 91.657, 'best_valid_test/acc': 91.056, 'best_valid_test/acc_unbiased': 90.477, 'best_valid_test/diff': 3.617, 'best_valid_test/acc_skew': 88.668, 'best_valid_test/acc_align': 92.285}
[1 / 10] best test accuracy: 90.477 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 90.843, 'best_test_valid/acc_unbiased': 90.356, 'best_test_valid/diff': 2.602, 'best_test_valid/acc_skew': 89.055, 'best_test_valid/acc_align': 91.657, 'best_test_test/acc': 91.056, 'best_test_test/acc_unbiased': 90.477, 'best_test_test/diff': 3.617, 'best_test_test/acc_skew': 88.668, 'best_test_test/acc_align': 92.285}
[2 / 10] Learning rate: 0.001 weight: 0.01
[2 / 10] Loss: 4.6367460834969085 CE Loss: 0.2202318130237305 Con Loss: 4.634543767549262
[2 / 10] tensor([[0.918, 0.921],
        [0.918, 0.898]]) {'epoch': 2, 'valid/acc': 91.795, 'valid/acc_unbiased': 91.442, 'valid/diff': 1.324, 'valid/acc_skew': 90.918, 'valid/acc_align': 91.967, 'test/acc': 91.519, 'test/acc_unbiased': 91.363, 'test/diff': 1.16, 'test/acc_skew': 90.783, 'test/acc_align': 91.943}
[2 / 10] best valid accuracy: 91.442 at epoch 2 
 best_stats: {'best_valid_epoch': 2, 'best_valid_valid/acc': 91.795, 'best_valid_valid/acc_unbiased': 91.442, 'best_valid_valid/diff': 1.324, 'best_valid_valid/acc_skew': 90.918, 'best_valid_valid/acc_align': 91.967, 'best_valid_test/acc': 91.519, 'best_valid_test/acc_unbiased': 91.363, 'best_valid_test/diff': 1.16, 'best_valid_test/acc_skew': 90.783, 'best_valid_test/acc_align': 91.943}
[2 / 10] best test accuracy: 91.363 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 91.795, 'best_test_valid/acc_unbiased': 91.442, 'best_test_valid/diff': 1.324, 'best_test_valid/acc_skew': 90.918, 'best_test_valid/acc_align': 91.967, 'best_test_test/acc': 91.519, 'best_test_test/acc_unbiased': 91.363, 'best_test_test/diff': 1.16, 'best_test_test/acc_skew': 90.783, 'best_test_test/acc_align': 91.943}
[3 / 10] Learning rate: 0.001 weight: 0.01
[3 / 10] Loss: 4.6310786219727795 CE Loss: 0.21521089638955088 Con Loss: 4.628926511853351
[3 / 10] tensor([[0.965, 0.953],
        [0.878, 0.857]]) {'epoch': 3, 'valid/acc': 90.548, 'valid/acc_unbiased': 90.838, 'valid/diff': 1.296, 'valid/acc_skew': 90.752, 'valid/acc_align': 90.924, 'test/acc': 91.644, 'test/acc_unbiased': 91.336, 'test/diff': 1.699, 'test/acc_skew': 91.098, 'test/acc_align': 91.574}
[3 / 10] best valid accuracy: 91.442 at epoch 2 
 best_stats: {'best_valid_epoch': 2, 'best_valid_valid/acc': 91.795, 'best_valid_valid/acc_unbiased': 91.442, 'best_valid_valid/diff': 1.324, 'best_valid_valid/acc_skew': 90.918, 'best_valid_valid/acc_align': 91.967, 'best_valid_test/acc': 91.519, 'best_valid_test/acc_unbiased': 91.363, 'best_valid_test/diff': 1.16, 'best_valid_test/acc_skew': 90.783, 'best_valid_test/acc_align': 91.943}
[3 / 10] best test accuracy: 91.363 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 91.795, 'best_test_valid/acc_unbiased': 91.442, 'best_test_valid/diff': 1.324, 'best_test_valid/acc_skew': 90.918, 'best_test_valid/acc_align': 91.967, 'best_test_test/acc': 91.519, 'best_test_test/acc_unbiased': 91.363, 'best_test_test/diff': 1.16, 'best_test_test/acc_skew': 90.783, 'best_test_test/acc_align': 91.943}
[4 / 10] Learning rate: 0.0001 weight: 0.01
[4 / 10] Loss: 4.5915988913995776 CE Loss: 0.18869314212461558 Con Loss: 4.589711980402447
[4 / 10] tensor([[0.916, 0.925],
        [0.943, 0.908]]) {'epoch': 4, 'valid/acc': 92.985, 'valid/acc_unbiased': 92.207, 'valid/diff': 2.234, 'valid/acc_skew': 91.09, 'valid/acc_align': 93.324, 'test/acc': 92.52, 'test/acc_unbiased': 92.291, 'test/diff': 2.229, 'test/acc_skew': 91.177, 'test/acc_align': 93.406}
[4 / 10] best valid accuracy: 92.207 at epoch 4 
 best_stats: {'best_valid_epoch': 4, 'best_valid_valid/acc': 92.985, 'best_valid_valid/acc_unbiased': 92.207, 'best_valid_valid/diff': 2.234, 'best_valid_valid/acc_skew': 91.09, 'best_valid_valid/acc_align': 93.324, 'best_valid_test/acc': 92.52, 'best_valid_test/acc_unbiased': 92.291, 'best_valid_test/diff': 2.229, 'best_valid_test/acc_skew': 91.177, 'best_valid_test/acc_align': 93.406}
[4 / 10] best test accuracy: 92.291 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 92.985, 'best_test_valid/acc_unbiased': 92.207, 'best_test_valid/diff': 2.234, 'best_test_valid/acc_skew': 91.09, 'best_test_valid/acc_align': 93.324, 'best_test_test/acc': 92.52, 'best_test_test/acc_unbiased': 92.291, 'best_test_test/diff': 2.229, 'best_test_test/acc_skew': 91.177, 'best_test_test/acc_align': 93.406}
[5 / 10] Learning rate: 0.0001 weight: 0.01
[5 / 10] Loss: 4.574092989974894 CE Loss: 0.1788027340268867 Con Loss: 4.57230496037166
[5 / 10] tensor([[0.934, 0.949],
        [0.932, 0.886]]) {'epoch': 5, 'valid/acc': 93.038, 'valid/acc_unbiased': 92.342, 'valid/diff': 2.421, 'valid/acc_skew': 91.132, 'valid/acc_align': 93.553, 'test/acc': 92.878, 'test/acc_unbiased': 92.523, 'test/diff': 3.05, 'test/acc_skew': 90.998, 'test/acc_align': 94.048}
[5 / 10] best valid accuracy: 92.342 at epoch 5 
 best_stats: {'best_valid_epoch': 5, 'best_valid_valid/acc': 93.038, 'best_valid_valid/acc_unbiased': 92.342, 'best_valid_valid/diff': 2.421, 'best_valid_valid/acc_skew': 91.132, 'best_valid_valid/acc_align': 93.553, 'best_valid_test/acc': 92.878, 'best_valid_test/acc_unbiased': 92.523, 'best_valid_test/diff': 3.05, 'best_valid_test/acc_skew': 90.998, 'best_valid_test/acc_align': 94.048}
[5 / 10] best test accuracy: 92.523 at epoch 5 
 best_stats: {'best_test_epoch': 5, 'best_test_valid/acc': 93.038, 'best_test_valid/acc_unbiased': 92.342, 'best_test_valid/diff': 2.421, 'best_test_valid/acc_skew': 91.132, 'best_test_valid/acc_align': 93.553, 'best_test_test/acc': 92.878, 'best_test_test/acc_unbiased': 92.523, 'best_test_test/diff': 3.05, 'best_test_test/acc_skew': 90.998, 'best_test_test/acc_align': 94.048}
[6 / 10] Learning rate: 0.0001 weight: 0.01
[6 / 10] Loss: 4.5678471727799135 CE Loss: 0.17868763013567152 Con Loss: 4.566060292707203
[6 / 10] tensor([[0.920, 0.927],
        [0.943, 0.918]]) {'epoch': 6, 'valid/acc': 92.81, 'valid/acc_unbiased': 92.223, 'valid/diff': 1.641, 'valid/acc_skew': 91.425, 'valid/acc_align': 93.022, 'test/acc': 92.827, 'test/acc_unbiased': 92.676, 'test/diff': 1.573, 'test/acc_skew': 91.89, 'test/acc_align': 93.463}
[6 / 10] best valid accuracy: 92.342 at epoch 5 
 best_stats: {'best_valid_epoch': 5, 'best_valid_valid/acc': 93.038, 'best_valid_valid/acc_unbiased': 92.342, 'best_valid_valid/diff': 2.421, 'best_valid_valid/acc_skew': 91.132, 'best_valid_valid/acc_align': 93.553, 'best_valid_test/acc': 92.878, 'best_valid_test/acc_unbiased': 92.523, 'best_valid_test/diff': 3.05, 'best_valid_test/acc_skew': 90.998, 'best_valid_test/acc_align': 94.048}
[6 / 10] best test accuracy: 92.676 at epoch 6 
 best_stats: {'best_test_epoch': 6, 'best_test_valid/acc': 92.81, 'best_test_valid/acc_unbiased': 92.223, 'best_test_valid/diff': 1.641, 'best_test_valid/acc_skew': 91.425, 'best_test_valid/acc_align': 93.022, 'best_test_test/acc': 92.827, 'best_test_test/acc_unbiased': 92.676, 'best_test_test/diff': 1.573, 'best_test_test/acc_skew': 91.89, 'best_test_test/acc_align': 93.463}
[7 / 10] Learning rate: 1e-05 weight: 0.01
[7 / 10] Loss: 4.563755959150455 CE Loss: 0.17587235445391686 Con Loss: 4.561997250741566
[7 / 10] tensor([[0.917, 0.932],
        [0.944, 0.911]]) {'epoch': 7, 'valid/acc': 93.213, 'valid/acc_unbiased': 92.544, 'valid/diff': 1.89, 'valid/acc_skew': 91.599, 'valid/acc_align': 93.489, 'test/acc': 92.807, 'test/acc_unbiased': 92.593, 'test/diff': 2.428, 'test/acc_skew': 91.379, 'test/acc_align': 93.807}
[7 / 10] best valid accuracy: 92.544 at epoch 7 
 best_stats: {'best_valid_epoch': 7, 'best_valid_valid/acc': 93.213, 'best_valid_valid/acc_unbiased': 92.544, 'best_valid_valid/diff': 1.89, 'best_valid_valid/acc_skew': 91.599, 'best_valid_valid/acc_align': 93.489, 'best_valid_test/acc': 92.807, 'best_valid_test/acc_unbiased': 92.593, 'best_valid_test/diff': 2.428, 'best_valid_test/acc_skew': 91.379, 'best_valid_test/acc_align': 93.807}
[7 / 10] best test accuracy: 92.676 at epoch 6 
 best_stats: {'best_test_epoch': 6, 'best_test_valid/acc': 92.81, 'best_test_valid/acc_unbiased': 92.223, 'best_test_valid/diff': 1.641, 'best_test_valid/acc_skew': 91.425, 'best_test_valid/acc_align': 93.022, 'best_test_test/acc': 92.827, 'best_test_test/acc_unbiased': 92.676, 'best_test_test/diff': 1.573, 'best_test_test/acc_skew': 91.89, 'best_test_test/acc_align': 93.463}
[8 / 10] Learning rate: 1e-05 weight: 0.01
[8 / 10] Loss: 4.562897832983869 CE Loss: 0.1727584247046994 Con Loss: 4.561170249465123
[8 / 10] tensor([[0.928, 0.938],
        [0.939, 0.906]]) {'epoch': 8, 'valid/acc': 93.213, 'valid/acc_unbiased': 92.545, 'valid/diff': 2.034, 'valid/acc_skew': 91.528, 'valid/acc_align': 93.562, 'test/acc': 93.014, 'test/acc_unbiased': 92.774, 'test/diff': 2.189, 'test/acc_skew': 91.68, 'test/acc_align': 93.869}
[8 / 10] best valid accuracy: 92.545 at epoch 8 
 best_stats: {'best_valid_epoch': 8, 'best_valid_valid/acc': 93.213, 'best_valid_valid/acc_unbiased': 92.545, 'best_valid_valid/diff': 2.034, 'best_valid_valid/acc_skew': 91.528, 'best_valid_valid/acc_align': 93.562, 'best_valid_test/acc': 93.014, 'best_valid_test/acc_unbiased': 92.774, 'best_valid_test/diff': 2.189, 'best_valid_test/acc_skew': 91.68, 'best_valid_test/acc_align': 93.869}
[8 / 10] best test accuracy: 92.774 at epoch 8 
 best_stats: {'best_test_epoch': 8, 'best_test_valid/acc': 93.213, 'best_test_valid/acc_unbiased': 92.545, 'best_test_valid/diff': 2.034, 'best_test_valid/acc_skew': 91.528, 'best_test_valid/acc_align': 93.562, 'best_test_test/acc': 93.014, 'best_test_test/acc_unbiased': 92.774, 'best_test_test/diff': 2.189, 'best_test_test/acc_skew': 91.68, 'best_test_test/acc_align': 93.869}
[9 / 10] Learning rate: 1e-05 weight: 0.01
[9 / 10] Loss: 4.556357059006709 CE Loss: 0.1728792692585201 Con Loss: 4.554628267708022
[9 / 10] tensor([[0.925, 0.939],
        [0.939, 0.903]]) {'epoch': 9, 'valid/acc': 93.168, 'valid/acc_unbiased': 92.634, 'valid/diff': 1.65, 'valid/acc_skew': 91.809, 'valid/acc_align': 93.459, 'test/acc': 92.928, 'test/acc_unbiased': 92.673, 'test/diff': 2.476, 'test/acc_skew': 91.435, 'test/acc_align': 93.911}
[9 / 10] best valid accuracy: 92.634 at epoch 9 
 best_stats: {'best_valid_epoch': 9, 'best_valid_valid/acc': 93.168, 'best_valid_valid/acc_unbiased': 92.634, 'best_valid_valid/diff': 1.65, 'best_valid_valid/acc_skew': 91.809, 'best_valid_valid/acc_align': 93.459, 'best_valid_test/acc': 92.928, 'best_valid_test/acc_unbiased': 92.673, 'best_valid_test/diff': 2.476, 'best_valid_test/acc_skew': 91.435, 'best_valid_test/acc_align': 93.911}
[9 / 10] best test accuracy: 92.774 at epoch 8 
 best_stats: {'best_test_epoch': 8, 'best_test_valid/acc': 93.213, 'best_test_valid/acc_unbiased': 92.545, 'best_test_valid/diff': 2.034, 'best_test_valid/acc_skew': 91.528, 'best_test_valid/acc_align': 93.562, 'best_test_test/acc': 93.014, 'best_test_test/acc_unbiased': 92.774, 'best_test_test/diff': 2.189, 'best_test_test/acc_skew': 91.68, 'best_test_test/acc_align': 93.869}
[10 / 10] Learning rate: 1e-05 weight: 0.01
[10 / 10] Loss: 4.555879196257906 CE Loss: 0.17205530522310955 Con Loss: 4.554158645642164
[10 / 10] tensor([[0.918, 0.932],
        [0.944, 0.909]]) {'epoch': 10, 'valid/acc': 93.248, 'valid/acc_unbiased': 92.546, 'valid/diff': 1.996, 'valid/acc_skew': 91.548, 'valid/acc_align': 93.544, 'test/acc': 92.807, 'test/acc_unbiased': 92.578, 'test/diff': 2.478, 'test/acc_skew': 91.339, 'test/acc_align': 93.817}
[10 / 10] best valid accuracy: 92.634 at epoch 9 
 best_stats: {'best_valid_epoch': 9, 'best_valid_valid/acc': 93.168, 'best_valid_valid/acc_unbiased': 92.634, 'best_valid_valid/diff': 1.65, 'best_valid_valid/acc_skew': 91.809, 'best_valid_valid/acc_align': 93.459, 'best_valid_test/acc': 92.928, 'best_valid_test/acc_unbiased': 92.673, 'best_valid_test/diff': 2.476, 'best_valid_test/acc_skew': 91.435, 'best_valid_test/acc_align': 93.911}
[10 / 10] best test accuracy: 92.774 at epoch 8 
 best_stats: {'best_test_epoch': 8, 'best_test_valid/acc': 93.213, 'best_test_valid/acc_unbiased': 92.545, 'best_test_valid/diff': 2.034, 'best_test_valid/acc_skew': 91.528, 'best_test_valid/acc_align': 93.562, 'best_test_test/acc': 93.014, 'best_test_test/acc_unbiased': 92.774, 'best_test_test/diff': 2.189, 'best_test_test/acc_skew': 91.68, 'best_test_test/acc_align': 93.869}
Total training time: 1:07:41
