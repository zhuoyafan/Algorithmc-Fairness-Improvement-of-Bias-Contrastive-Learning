Log level set to: INFO
Set seed: 2
=======> Using Fixed Random Seed: 2 <========
save_path: exp_results/bc-bb0-utk_face_age-crop_rotate_color-0.9-lr0.001-bs128-cbs64-w0.01-ratio10-aug1-seed2
get_utk_face - split: train, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_age-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
Binary Target 1
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Normal Label Distribution: 
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
Binary Target 1
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Normal Label Distribution: 
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 10684, target_attr: gender, bias_attr: age bias_rate: 0.9
['[train] target_0-bias_0: 8237', '[train] target_0-bias_1: 147', '[train] target_1-bias_0: 823', '[train] target_1-bias_1: 1477']
confusion_matrix - 
 original: tensor([[8237.,  823.],
        [ 147., 1477.]]), 
 normalized: tensor([[0.909, 0.091],
        [0.091, 0.909]]), 
 b|y: tensor([[0.982, 0.018],
        [0.358, 0.642]])
get_utk_face - split: train, aug: 1, given_y: True, ratio: 10
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_age-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
Binary Target 1
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Normal Label Distribution: 
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
Binary Target 1
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Normal Label Distribution: 
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 10684, target_attr: gender, bias_attr: age bias_rate: 0.9
['[train] target_0-bias_0: 8237', '[train] target_0-bias_1: 147', '[train] target_1-bias_0: 823', '[train] target_1-bias_1: 1477']
get_utk_face - split: valid, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_age-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [1030, 195]
Target 1: [841, 202]
Binary Target 1
---------------------------
Target 0: [1030, 195]
Target 1: [841, 202]
===================================
Normal Label Distribution: 
Target 0: [1030, 195]
Target 1: [841, 202]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 2268, target_attr: gender, bias_attr: age bias_rate: 0.9
['[valid] target_0-bias_0: 1030', '[valid] target_0-bias_1: 195', '[valid] target_1-bias_0: 841', '[valid] target_1-bias_1: 202']
get_utk_face - split: test, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_age-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [1061, 176]
Target 1: [867, 165]
Binary Target 1
---------------------------
Target 0: [1061, 176]
Target 1: [867, 165]
===================================
Normal Label Distribution: 
Target 0: [1061, 176]
Target 1: [867, 165]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 2269, target_attr: gender, bias_attr: age bias_rate: 0.9
['[test] target_0-bias_0: 1061', '[test] target_0-bias_1: 176', '[test] target_1-bias_0: 867', '[test] target_1-bias_1: 165']
decay_epochs: [6, 13]
[1 / 20] Learning rate: 0.001 weight: 0.01
[1 / 20] Loss: 4.867525149623538 CE Loss: 0.5828679166608695 Con Loss: 4.861696494290642
[1 / 20] tensor([[1., 1.],
        [0., 0.]]) {'epoch': 1, 'valid/acc': 54.012, 'valid/acc_unbiased': 50.0, 'valid/diff': 0.0, 'valid/acc_skew': 50.0, 'valid/acc_align': 50.0, 'test/acc': 54.517, 'test/acc_unbiased': 50.0, 'test/diff': 0.0, 'test/acc_skew': 50.0, 'test/acc_align': 50.0}
[1 / 20] best valid accuracy: 50.000 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 54.012, 'best_valid_valid/acc_unbiased': 50.0, 'best_valid_valid/diff': 0.0, 'best_valid_valid/acc_skew': 50.0, 'best_valid_valid/acc_align': 50.0, 'best_valid_test/acc': 54.517, 'best_valid_test/acc_unbiased': 50.0, 'best_valid_test/diff': 0.0, 'best_valid_test/acc_skew': 50.0, 'best_valid_test/acc_align': 50.0}
[1 / 20] best test accuracy: 50.000 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 54.012, 'best_test_valid/acc_unbiased': 50.0, 'best_test_valid/diff': 0.0, 'best_test_valid/acc_skew': 50.0, 'best_test_valid/acc_align': 50.0, 'best_test_test/acc': 54.517, 'best_test_test/acc_unbiased': 50.0, 'best_test_test/diff': 0.0, 'best_test_test/acc_skew': 50.0, 'best_test_test/acc_align': 50.0}
[2 / 20] Learning rate: 0.001 weight: 0.01
[2 / 20] Loss: 4.734141589728512 CE Loss: 0.5558930286661331 Con Loss: 4.72858264820266
[2 / 20] tensor([[0.999, 0.994],
        [0.003, 0.000]]) {'epoch': 2, 'valid/acc': 53.968, 'valid/acc_unbiased': 49.998, 'valid/diff': 0.481, 'valid/acc_skew': 50.238, 'valid/acc_align': 49.757, 'test/acc': 54.561, 'test/acc_unbiased': 49.921, 'test/diff': 0.41, 'test/acc_skew': 49.889, 'test/acc_align': 49.953}
[2 / 20] best valid accuracy: 50.000 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 54.012, 'best_valid_valid/acc_unbiased': 50.0, 'best_valid_valid/diff': 0.0, 'best_valid_valid/acc_skew': 50.0, 'best_valid_valid/acc_align': 50.0, 'best_valid_test/acc': 54.517, 'best_valid_test/acc_unbiased': 50.0, 'best_valid_test/diff': 0.0, 'best_valid_test/acc_skew': 50.0, 'best_valid_test/acc_align': 50.0}
[2 / 20] best test accuracy: 50.000 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 54.012, 'best_test_valid/acc_unbiased': 50.0, 'best_test_valid/diff': 0.0, 'best_test_valid/acc_skew': 50.0, 'best_test_valid/acc_align': 50.0, 'best_test_test/acc': 54.517, 'best_test_test/acc_unbiased': 50.0, 'best_test_test/diff': 0.0, 'best_test_test/acc_skew': 50.0, 'best_test_test/acc_align': 50.0}
[3 / 20] Learning rate: 0.001 weight: 0.01
[3 / 20] Loss: 4.720122084373037 CE Loss: 0.5406244753318438 Con Loss: 4.714715876591781
[3 / 20] tensor([[0.989, 0.960],
        [0.068, 0.030]]) {'epoch': 3, 'valid/acc': 55.688, 'valid/acc_unbiased': 51.507, 'valid/diff': 1.986, 'valid/acc_skew': 52.501, 'valid/acc_align': 50.514, 'test/acc': 56.501, 'test/acc_unbiased': 51.182, 'test/diff': 3.311, 'test/acc_skew': 51.414, 'test/acc_align': 50.95}
[3 / 20] best valid accuracy: 51.507 at epoch 3 
 best_stats: {'best_valid_epoch': 3, 'best_valid_valid/acc': 55.688, 'best_valid_valid/acc_unbiased': 51.507, 'best_valid_valid/diff': 1.986, 'best_valid_valid/acc_skew': 52.501, 'best_valid_valid/acc_align': 50.514, 'best_valid_test/acc': 56.501, 'best_valid_test/acc_unbiased': 51.182, 'best_valid_test/diff': 3.311, 'best_valid_test/acc_skew': 51.414, 'best_valid_test/acc_align': 50.95}
[3 / 20] best test accuracy: 51.182 at epoch 3 
 best_stats: {'best_test_epoch': 3, 'best_test_valid/acc': 55.688, 'best_test_valid/acc_unbiased': 51.507, 'best_test_valid/diff': 1.986, 'best_test_valid/acc_skew': 52.501, 'best_test_valid/acc_align': 50.514, 'best_test_test/acc': 56.501, 'best_test_test/acc_unbiased': 51.182, 'best_test_test/diff': 3.311, 'best_test_test/acc_skew': 51.414, 'best_test_test/acc_align': 50.95}
[4 / 20] Learning rate: 0.001 weight: 0.01
[4 / 20] Loss: 4.714993894077874 CE Loss: 0.5343970721779312 Con Loss: 4.709649942198839
[4 / 20] tensor([[1.000, 1.000],
        [0.007, 0.000]]) {'epoch': 4, 'valid/acc': 54.056, 'valid/acc_unbiased': 50.156, 'valid/diff': 0.4, 'valid/acc_skew': 50.357, 'valid/acc_align': 49.956, 'test/acc': 54.782, 'test/acc_unbiased': 50.173, 'test/diff': 0.346, 'test/acc_skew': 50.346, 'test/acc_align': 50.0}
[4 / 20] best valid accuracy: 51.507 at epoch 3 
 best_stats: {'best_valid_epoch': 3, 'best_valid_valid/acc': 55.688, 'best_valid_valid/acc_unbiased': 51.507, 'best_valid_valid/diff': 1.986, 'best_valid_valid/acc_skew': 52.501, 'best_valid_valid/acc_align': 50.514, 'best_valid_test/acc': 56.501, 'best_valid_test/acc_unbiased': 51.182, 'best_valid_test/diff': 3.311, 'best_valid_test/acc_skew': 51.414, 'best_valid_test/acc_align': 50.95}
[4 / 20] best test accuracy: 51.182 at epoch 3 
 best_stats: {'best_test_epoch': 3, 'best_test_valid/acc': 55.688, 'best_test_valid/acc_unbiased': 51.507, 'best_test_valid/diff': 1.986, 'best_test_valid/acc_skew': 52.501, 'best_test_valid/acc_align': 50.514, 'best_test_test/acc': 56.501, 'best_test_test/acc_unbiased': 51.182, 'best_test_test/diff': 3.311, 'best_test_test/acc_skew': 51.414, 'best_test_test/acc_align': 50.95}
[5 / 20] Learning rate: 0.001 weight: 0.01
[5 / 20] Loss: 4.6933665709386645 CE Loss: 0.5265878836165113 Con Loss: 4.688100698778844
[5 / 20] tensor([[0.999, 0.994],
        [0.013, 0.000]]) {'epoch': 5, 'valid/acc': 54.409, 'valid/acc_unbiased': 50.273, 'valid/diff': 0.643, 'valid/acc_skew': 50.595, 'valid/acc_align': 49.951, 'test/acc': 54.914, 'test/acc_unbiased': 50.152, 'test/diff': 0.871, 'test/acc_skew': 50.35, 'test/acc_align': 49.953}
[5 / 20] best valid accuracy: 51.507 at epoch 3 
 best_stats: {'best_valid_epoch': 3, 'best_valid_valid/acc': 55.688, 'best_valid_valid/acc_unbiased': 51.507, 'best_valid_valid/diff': 1.986, 'best_valid_valid/acc_skew': 52.501, 'best_valid_valid/acc_align': 50.514, 'best_valid_test/acc': 56.501, 'best_valid_test/acc_unbiased': 51.182, 'best_valid_test/diff': 3.311, 'best_valid_test/acc_skew': 51.414, 'best_valid_test/acc_align': 50.95}
[5 / 20] best test accuracy: 51.182 at epoch 3 
 best_stats: {'best_test_epoch': 3, 'best_test_valid/acc': 55.688, 'best_test_valid/acc_unbiased': 51.507, 'best_test_valid/diff': 1.986, 'best_test_valid/acc_skew': 52.501, 'best_test_valid/acc_align': 50.514, 'best_test_test/acc': 56.501, 'best_test_test/acc_unbiased': 51.182, 'best_test_test/diff': 3.311, 'best_test_test/acc_skew': 51.414, 'best_test_test/acc_align': 50.95}
[6 / 20] Learning rate: 0.001 weight: 0.01
[6 / 20] Loss: 4.674843385397205 CE Loss: 0.4968183115710484 Con Loss: 4.669875221366697
[6 / 20] tensor([[0.964, 0.977],
        [0.242, 0.073]]) {'epoch': 6, 'valid/acc': 61.817, 'valid/acc_unbiased': 57.384, 'valid/diff': 8.344, 'valid/acc_skew': 61.556, 'valid/acc_align': 53.213, 'test/acc': 62.45, 'test/acc_unbiased': 56.41, 'test/diff': 9.129, 'test/acc_skew': 60.974, 'test/acc_align': 51.846}
[6 / 20] best valid accuracy: 57.384 at epoch 6 
 best_stats: {'best_valid_epoch': 6, 'best_valid_valid/acc': 61.817, 'best_valid_valid/acc_unbiased': 57.384, 'best_valid_valid/diff': 8.344, 'best_valid_valid/acc_skew': 61.556, 'best_valid_valid/acc_align': 53.213, 'best_valid_test/acc': 62.45, 'best_valid_test/acc_unbiased': 56.41, 'best_valid_test/diff': 9.129, 'best_valid_test/acc_skew': 60.974, 'best_valid_test/acc_align': 51.846}
[6 / 20] best test accuracy: 56.410 at epoch 6 
 best_stats: {'best_test_epoch': 6, 'best_test_valid/acc': 61.817, 'best_test_valid/acc_unbiased': 57.384, 'best_test_valid/diff': 8.344, 'best_test_valid/acc_skew': 61.556, 'best_test_valid/acc_align': 53.213, 'best_test_test/acc': 62.45, 'best_test_test/acc_unbiased': 56.41, 'best_test_test/diff': 9.129, 'best_test_test/acc_skew': 60.974, 'best_test_test/acc_align': 51.846}
[7 / 20] Learning rate: 0.0001 weight: 0.01
[7 / 20] Loss: 4.640658994329774 CE Loss: 0.49153744277325695 Con Loss: 4.635743611406093
[7 / 20] tensor([[0.985, 0.977],
        [0.186, 0.067]]) {'epoch': 7, 'valid/acc': 61.199, 'valid/acc_unbiased': 56.927, 'valid/diff': 4.108, 'valid/acc_skew': 58.981, 'valid/acc_align': 54.873, 'test/acc': 61.216, 'test/acc_unbiased': 55.364, 'test/diff': 6.334, 'test/acc_skew': 58.149, 'test/acc_align': 52.579}
[7 / 20] best valid accuracy: 57.384 at epoch 6 
 best_stats: {'best_valid_epoch': 6, 'best_valid_valid/acc': 61.817, 'best_valid_valid/acc_unbiased': 57.384, 'best_valid_valid/diff': 8.344, 'best_valid_valid/acc_skew': 61.556, 'best_valid_valid/acc_align': 53.213, 'best_valid_test/acc': 62.45, 'best_valid_test/acc_unbiased': 56.41, 'best_valid_test/diff': 9.129, 'best_valid_test/acc_skew': 60.974, 'best_valid_test/acc_align': 51.846}
[7 / 20] best test accuracy: 56.410 at epoch 6 
 best_stats: {'best_test_epoch': 6, 'best_test_valid/acc': 61.817, 'best_test_valid/acc_unbiased': 57.384, 'best_test_valid/diff': 8.344, 'best_test_valid/acc_skew': 61.556, 'best_test_valid/acc_align': 53.213, 'best_test_test/acc': 62.45, 'best_test_test/acc_unbiased': 56.41, 'best_test_test/diff': 9.129, 'best_test_test/acc_skew': 60.974, 'best_test_test/acc_align': 51.846}
[8 / 20] Learning rate: 0.0001 weight: 0.01
[8 / 20] Loss: 4.621664429282213 CE Loss: 0.4863921998703984 Con Loss: 4.616800504960803
[8 / 20] tensor([[0.962, 0.943],
        [0.319, 0.176]]) {'epoch': 8, 'valid/acc': 63.845, 'valid/acc_unbiased': 59.276, 'valid/diff': 5.876, 'valid/acc_skew': 61.627, 'valid/acc_align': 56.925, 'test/acc': 65.8, 'test/acc_unbiased': 60.018, 'test/diff': 8.143, 'test/acc_skew': 63.134, 'test/acc_align': 56.903}
[8 / 20] best valid accuracy: 59.276 at epoch 8 
 best_stats: {'best_valid_epoch': 8, 'best_valid_valid/acc': 63.845, 'best_valid_valid/acc_unbiased': 59.276, 'best_valid_valid/diff': 5.876, 'best_valid_valid/acc_skew': 61.627, 'best_valid_valid/acc_align': 56.925, 'best_valid_test/acc': 65.8, 'best_valid_test/acc_unbiased': 60.018, 'best_valid_test/diff': 8.143, 'best_valid_test/acc_skew': 63.134, 'best_valid_test/acc_align': 56.903}
[8 / 20] best test accuracy: 60.018 at epoch 8 
 best_stats: {'best_test_epoch': 8, 'best_test_valid/acc': 63.845, 'best_test_valid/acc_unbiased': 59.276, 'best_test_valid/diff': 5.876, 'best_test_valid/acc_skew': 61.627, 'best_test_valid/acc_align': 56.925, 'best_test_test/acc': 65.8, 'best_test_test/acc_unbiased': 60.018, 'best_test_test/diff': 8.143, 'best_test_test/acc_skew': 63.134, 'best_test_test/acc_align': 56.903}
[9 / 20] Learning rate: 0.0001 weight: 0.01
[9 / 20] Loss: 4.583233019244309 CE Loss: 0.48878422010172534 Con Loss: 4.5783451966514574
[9 / 20] tensor([[0.950, 0.869],
        [0.391, 0.291]]) {'epoch': 9, 'valid/acc': 66.711, 'valid/acc_unbiased': 61.852, 'valid/diff': 7.883, 'valid/acc_skew': 61.173, 'valid/acc_align': 62.531, 'test/acc': 68.224, 'test/acc_unbiased': 62.532, 'test/diff': 9.041, 'test/acc_skew': 63.016, 'test/acc_align': 62.048}
[9 / 20] best valid accuracy: 61.852 at epoch 9 
 best_stats: {'best_valid_epoch': 9, 'best_valid_valid/acc': 66.711, 'best_valid_valid/acc_unbiased': 61.852, 'best_valid_valid/diff': 7.883, 'best_valid_valid/acc_skew': 61.173, 'best_valid_valid/acc_align': 62.531, 'best_valid_test/acc': 68.224, 'best_valid_test/acc_unbiased': 62.532, 'best_valid_test/diff': 9.041, 'best_valid_test/acc_skew': 63.016, 'best_valid_test/acc_align': 62.048}
[9 / 20] best test accuracy: 62.532 at epoch 9 
 best_stats: {'best_test_epoch': 9, 'best_test_valid/acc': 66.711, 'best_test_valid/acc_unbiased': 61.852, 'best_test_valid/diff': 7.883, 'best_test_valid/acc_skew': 61.173, 'best_test_valid/acc_align': 62.531, 'best_test_test/acc': 68.224, 'best_test_test/acc_unbiased': 62.532, 'best_test_test/diff': 9.041, 'best_test_test/acc_skew': 63.016, 'best_test_test/acc_align': 62.048}
[10 / 20] Learning rate: 0.0001 weight: 0.01
[10 / 20] Loss: 4.560638593225968 CE Loss: 0.4768839809431292 Con Loss: 4.555869722312776
[10 / 20] tensor([[0.973, 0.898],
        [0.302, 0.212]]) {'epoch': 10, 'valid/acc': 64.947, 'valid/acc_unbiased': 60.667, 'valid/diff': 4.787, 'valid/acc_skew': 60.463, 'valid/acc_align': 60.871, 'test/acc': 65.535, 'test/acc_unbiased': 59.618, 'test/diff': 8.251, 'test/acc_skew': 59.996, 'test/acc_align': 59.239}
[10 / 20] best valid accuracy: 61.852 at epoch 9 
 best_stats: {'best_valid_epoch': 9, 'best_valid_valid/acc': 66.711, 'best_valid_valid/acc_unbiased': 61.852, 'best_valid_valid/diff': 7.883, 'best_valid_valid/acc_skew': 61.173, 'best_valid_valid/acc_align': 62.531, 'best_valid_test/acc': 68.224, 'best_valid_test/acc_unbiased': 62.532, 'best_valid_test/diff': 9.041, 'best_valid_test/acc_skew': 63.016, 'best_valid_test/acc_align': 62.048}
[10 / 20] best test accuracy: 62.532 at epoch 9 
 best_stats: {'best_test_epoch': 9, 'best_test_valid/acc': 66.711, 'best_test_valid/acc_unbiased': 61.852, 'best_test_valid/diff': 7.883, 'best_test_valid/acc_skew': 61.173, 'best_test_valid/acc_align': 62.531, 'best_test_test/acc': 68.224, 'best_test_test/acc_unbiased': 62.532, 'best_test_test/diff': 9.041, 'best_test_test/acc_skew': 63.016, 'best_test_test/acc_align': 62.048}
[11 / 20] Learning rate: 0.0001 weight: 0.01
[11 / 20] Loss: 4.516847986444826 CE Loss: 0.4704014062658315 Con Loss: 4.512143961993195
[11 / 20] tensor([[0.978, 0.915],
        [0.283, 0.218]]) {'epoch': 11, 'valid/acc': 64.198, 'valid/acc_unbiased': 59.827, 'valid/diff': 4.628, 'valid/acc_skew': 58.643, 'valid/acc_align': 61.012, 'test/acc': 65.227, 'test/acc_unbiased': 59.847, 'test/diff': 6.398, 'test/acc_skew': 59.868, 'test/acc_align': 59.825}
[11 / 20] best valid accuracy: 61.852 at epoch 9 
 best_stats: {'best_valid_epoch': 9, 'best_valid_valid/acc': 66.711, 'best_valid_valid/acc_unbiased': 61.852, 'best_valid_valid/diff': 7.883, 'best_valid_valid/acc_skew': 61.173, 'best_valid_valid/acc_align': 62.531, 'best_valid_test/acc': 68.224, 'best_valid_test/acc_unbiased': 62.532, 'best_valid_test/diff': 9.041, 'best_valid_test/acc_skew': 63.016, 'best_valid_test/acc_align': 62.048}
[11 / 20] best test accuracy: 62.532 at epoch 9 
 best_stats: {'best_test_epoch': 9, 'best_test_valid/acc': 66.711, 'best_test_valid/acc_unbiased': 61.852, 'best_test_valid/diff': 7.883, 'best_test_valid/acc_skew': 61.173, 'best_test_valid/acc_align': 62.531, 'best_test_test/acc': 68.224, 'best_test_test/acc_unbiased': 62.532, 'best_test_test/diff': 9.041, 'best_test_test/acc_skew': 63.016, 'best_test_test/acc_align': 62.048}
[12 / 20] Learning rate: 0.0001 weight: 0.01
[12 / 20] Loss: 4.58125679950864 CE Loss: 0.46392176524836753 Con Loss: 4.576617579029902
[12 / 20] tensor([[0.975, 0.881],
        [0.285, 0.297]]) {'epoch': 12, 'valid/acc': 64.991, 'valid/acc_unbiased': 61.496, 'valid/diff': 6.963, 'valid/acc_skew': 58.015, 'valid/acc_align': 64.977, 'test/acc': 65.491, 'test/acc_unbiased': 60.951, 'test/diff': 5.345, 'test/acc_skew': 58.279, 'test/acc_align': 63.623}
[12 / 20] best valid accuracy: 61.852 at epoch 9 
 best_stats: {'best_valid_epoch': 9, 'best_valid_valid/acc': 66.711, 'best_valid_valid/acc_unbiased': 61.852, 'best_valid_valid/diff': 7.883, 'best_valid_valid/acc_skew': 61.173, 'best_valid_valid/acc_align': 62.531, 'best_valid_test/acc': 68.224, 'best_valid_test/acc_unbiased': 62.532, 'best_valid_test/diff': 9.041, 'best_valid_test/acc_skew': 63.016, 'best_valid_test/acc_align': 62.048}
[12 / 20] best test accuracy: 62.532 at epoch 9 
 best_stats: {'best_test_epoch': 9, 'best_test_valid/acc': 66.711, 'best_test_valid/acc_unbiased': 61.852, 'best_test_valid/diff': 7.883, 'best_test_valid/acc_skew': 61.173, 'best_test_valid/acc_align': 62.531, 'best_test_test/acc': 68.224, 'best_test_test/acc_unbiased': 62.532, 'best_test_test/diff': 9.041, 'best_test_test/acc_skew': 63.016, 'best_test_test/acc_align': 62.048}
[13 / 20] Learning rate: 0.0001 weight: 0.01
[13 / 20] Loss: 4.544027385618837 CE Loss: 0.4576758599513392 Con Loss: 4.539450620810489
[13 / 20] tensor([[0.964, 0.869],
        [0.355, 0.321]]) {'epoch': 13, 'valid/acc': 66.667, 'valid/acc_unbiased': 62.491, 'valid/diff': 5.164, 'valid/acc_skew': 60.14, 'valid/acc_align': 64.841, 'test/acc': 67.739, 'test/acc_unbiased': 62.749, 'test/diff': 6.445, 'test/acc_skew': 61.228, 'test/acc_align': 64.27}
[13 / 20] best valid accuracy: 62.491 at epoch 13 
 best_stats: {'best_valid_epoch': 13, 'best_valid_valid/acc': 66.667, 'best_valid_valid/acc_unbiased': 62.491, 'best_valid_valid/diff': 5.164, 'best_valid_valid/acc_skew': 60.14, 'best_valid_valid/acc_align': 64.841, 'best_valid_test/acc': 67.739, 'best_valid_test/acc_unbiased': 62.749, 'best_valid_test/diff': 6.445, 'best_valid_test/acc_skew': 61.228, 'best_valid_test/acc_align': 64.27}
[13 / 20] best test accuracy: 62.749 at epoch 13 
 best_stats: {'best_test_epoch': 13, 'best_test_valid/acc': 66.667, 'best_test_valid/acc_unbiased': 62.491, 'best_test_valid/diff': 5.164, 'best_test_valid/acc_skew': 60.14, 'best_test_valid/acc_align': 64.841, 'best_test_test/acc': 67.739, 'best_test_test/acc_unbiased': 62.749, 'best_test_test/diff': 6.445, 'best_test_test/acc_skew': 61.228, 'best_test_test/acc_align': 64.27}
[14 / 20] Learning rate: 1e-05 weight: 0.01
[14 / 20] Loss: 4.543632853838979 CE Loss: 0.44970740119601316 Con Loss: 4.5391357886751065
[14 / 20] tensor([[0.965, 0.801],
        [0.355, 0.382]]) {'epoch': 14, 'valid/acc': 67.416, 'valid/acc_unbiased': 63.434, 'valid/diff': 8.357, 'valid/acc_skew': 59.255, 'valid/acc_align': 67.613, 'test/acc': 67.695, 'test/acc_unbiased': 62.583, 'test/diff': 9.528, 'test/acc_skew': 57.819, 'test/acc_align': 67.347}
[14 / 20] best valid accuracy: 63.434 at epoch 14 
 best_stats: {'best_valid_epoch': 14, 'best_valid_valid/acc': 67.416, 'best_valid_valid/acc_unbiased': 63.434, 'best_valid_valid/diff': 8.357, 'best_valid_valid/acc_skew': 59.255, 'best_valid_valid/acc_align': 67.613, 'best_valid_test/acc': 67.695, 'best_valid_test/acc_unbiased': 62.583, 'best_valid_test/diff': 9.528, 'best_valid_test/acc_skew': 57.819, 'best_valid_test/acc_align': 67.347}
[14 / 20] best test accuracy: 62.749 at epoch 13 
 best_stats: {'best_test_epoch': 13, 'best_test_valid/acc': 66.667, 'best_test_valid/acc_unbiased': 62.491, 'best_test_valid/diff': 5.164, 'best_test_valid/acc_skew': 60.14, 'best_test_valid/acc_align': 64.841, 'best_test_test/acc': 67.739, 'best_test_test/acc_unbiased': 62.749, 'best_test_test/diff': 6.445, 'best_test_test/acc_skew': 61.228, 'best_test_test/acc_align': 64.27}
[15 / 20] Learning rate: 1e-05 weight: 0.01
[15 / 20] Loss: 4.532583682468347 CE Loss: 0.4473837581925158 Con Loss: 4.528109850931686
[15 / 20] tensor([[0.968, 0.847],
        [0.344, 0.345]]) {'epoch': 15, 'valid/acc': 66.843, 'valid/acc_unbiased': 62.957, 'valid/diff': 5.836, 'valid/acc_skew': 60.04, 'valid/acc_align': 65.875, 'test/acc': 67.475, 'test/acc_unbiased': 62.593, 'test/diff': 6.155, 'test/acc_skew': 59.515, 'test/acc_align': 65.67}
[15 / 20] best valid accuracy: 63.434 at epoch 14 
 best_stats: {'best_valid_epoch': 14, 'best_valid_valid/acc': 67.416, 'best_valid_valid/acc_unbiased': 63.434, 'best_valid_valid/diff': 8.357, 'best_valid_valid/acc_skew': 59.255, 'best_valid_valid/acc_align': 67.613, 'best_valid_test/acc': 67.695, 'best_valid_test/acc_unbiased': 62.583, 'best_valid_test/diff': 9.528, 'best_valid_test/acc_skew': 57.819, 'best_valid_test/acc_align': 67.347}
[15 / 20] best test accuracy: 62.749 at epoch 13 
 best_stats: {'best_test_epoch': 13, 'best_test_valid/acc': 66.667, 'best_test_valid/acc_unbiased': 62.491, 'best_test_valid/diff': 5.164, 'best_test_valid/acc_skew': 60.14, 'best_test_valid/acc_align': 64.841, 'best_test_test/acc': 67.739, 'best_test_test/acc_unbiased': 62.749, 'best_test_test/diff': 6.445, 'best_test_test/acc_skew': 61.228, 'best_test_test/acc_align': 64.27}
[16 / 20] Learning rate: 1e-05 weight: 0.01
[16 / 20] Loss: 4.512105866970975 CE Loss: 0.4466374549067721 Con Loss: 4.507639477378819
[16 / 20] tensor([[0.973, 0.864],
        [0.328, 0.339]]) {'epoch': 16, 'valid/acc': 66.623, 'valid/acc_unbiased': 62.996, 'valid/diff': 4.263, 'valid/acc_skew': 60.865, 'valid/acc_align': 65.128, 'test/acc': 67.166, 'test/acc_unbiased': 62.582, 'test/diff': 6.043, 'test/acc_skew': 59.56, 'test/acc_align': 65.603}
[16 / 20] best valid accuracy: 63.434 at epoch 14 
 best_stats: {'best_valid_epoch': 14, 'best_valid_valid/acc': 67.416, 'best_valid_valid/acc_unbiased': 63.434, 'best_valid_valid/diff': 8.357, 'best_valid_valid/acc_skew': 59.255, 'best_valid_valid/acc_align': 67.613, 'best_valid_test/acc': 67.695, 'best_valid_test/acc_unbiased': 62.583, 'best_valid_test/diff': 9.528, 'best_valid_test/acc_skew': 57.819, 'best_valid_test/acc_align': 67.347}
[16 / 20] best test accuracy: 62.749 at epoch 13 
 best_stats: {'best_test_epoch': 13, 'best_test_valid/acc': 66.667, 'best_test_valid/acc_unbiased': 62.491, 'best_test_valid/diff': 5.164, 'best_test_valid/acc_skew': 60.14, 'best_test_valid/acc_align': 64.841, 'best_test_test/acc': 67.739, 'best_test_test/acc_unbiased': 62.749, 'best_test_test/diff': 6.445, 'best_test_test/acc_skew': 61.228, 'best_test_test/acc_align': 64.27}
[17 / 20] Learning rate: 1e-05 weight: 0.01
[17 / 20] Loss: 4.538241391233718 CE Loss: 0.45188027767597716 Con Loss: 4.533722595077737
[17 / 20] tensor([[0.973, 0.858],
        [0.330, 0.333]]) {'epoch': 17, 'valid/acc': 66.931, 'valid/acc_unbiased': 63.377, 'valid/diff': 5.181, 'valid/acc_skew': 60.787, 'valid/acc_align': 65.968, 'test/acc': 67.166, 'test/acc_unbiased': 62.346, 'test/diff': 5.909, 'test/acc_skew': 59.391, 'test/acc_align': 65.3}
[17 / 20] best valid accuracy: 63.434 at epoch 14 
 best_stats: {'best_valid_epoch': 14, 'best_valid_valid/acc': 67.416, 'best_valid_valid/acc_unbiased': 63.434, 'best_valid_valid/diff': 8.357, 'best_valid_valid/acc_skew': 59.255, 'best_valid_valid/acc_align': 67.613, 'best_valid_test/acc': 67.695, 'best_valid_test/acc_unbiased': 62.583, 'best_valid_test/diff': 9.528, 'best_valid_test/acc_skew': 57.819, 'best_valid_test/acc_align': 67.347}
[17 / 20] best test accuracy: 62.749 at epoch 13 
 best_stats: {'best_test_epoch': 13, 'best_test_valid/acc': 66.667, 'best_test_valid/acc_unbiased': 62.491, 'best_test_valid/diff': 5.164, 'best_test_valid/acc_skew': 60.14, 'best_test_valid/acc_align': 64.841, 'best_test_test/acc': 67.739, 'best_test_test/acc_unbiased': 62.749, 'best_test_test/diff': 6.445, 'best_test_test/acc_skew': 61.228, 'best_test_test/acc_align': 64.27}
[18 / 20] Learning rate: 1e-05 weight: 0.01
[18 / 20] Loss: 4.521780108655718 CE Loss: 0.44433431683832764 Con Loss: 4.517336764705177
[18 / 20] tensor([[0.970, 0.830],
        [0.355, 0.352]]) {'epoch': 18, 'valid/acc': 67.416, 'valid/acc_unbiased': 63.89, 'valid/diff': 8.92, 'valid/acc_skew': 59.43, 'valid/acc_align': 68.35, 'test/acc': 67.915, 'test/acc_unbiased': 62.654, 'test/diff': 7.201, 'test/acc_skew': 59.24, 'test/acc_align': 66.068}
[18 / 20] best valid accuracy: 63.890 at epoch 18 
 best_stats: {'best_valid_epoch': 18, 'best_valid_valid/acc': 67.416, 'best_valid_valid/acc_unbiased': 63.89, 'best_valid_valid/diff': 8.92, 'best_valid_valid/acc_skew': 59.43, 'best_valid_valid/acc_align': 68.35, 'best_valid_test/acc': 67.915, 'best_valid_test/acc_unbiased': 62.654, 'best_valid_test/diff': 7.201, 'best_valid_test/acc_skew': 59.24, 'best_valid_test/acc_align': 66.068}
[18 / 20] best test accuracy: 62.749 at epoch 13 
 best_stats: {'best_test_epoch': 13, 'best_test_valid/acc': 66.667, 'best_test_valid/acc_unbiased': 62.491, 'best_test_valid/diff': 5.164, 'best_test_valid/acc_skew': 60.14, 'best_test_valid/acc_align': 64.841, 'best_test_test/acc': 67.739, 'best_test_test/acc_unbiased': 62.749, 'best_test_test/diff': 6.445, 'best_test_test/acc_skew': 61.228, 'best_test_test/acc_align': 64.27}
[19 / 20] Learning rate: 1e-05 weight: 0.01
[19 / 20] Loss: 4.513532424856776 CE Loss: 0.4486882856770519 Con Loss: 4.509045537336629
[19 / 20] tensor([[0.972, 0.830],
        [0.337, 0.376]]) {'epoch': 19, 'valid/acc': 67.284, 'valid/acc_unbiased': 63.684, 'valid/diff': 8.828, 'valid/acc_skew': 59.27, 'valid/acc_align': 68.098, 'test/acc': 67.475, 'test/acc_unbiased': 62.846, 'test/diff': 9.057, 'test/acc_skew': 58.317, 'test/acc_align': 67.374}
[19 / 20] best valid accuracy: 63.890 at epoch 18 
 best_stats: {'best_valid_epoch': 18, 'best_valid_valid/acc': 67.416, 'best_valid_valid/acc_unbiased': 63.89, 'best_valid_valid/diff': 8.92, 'best_valid_valid/acc_skew': 59.43, 'best_valid_valid/acc_align': 68.35, 'best_valid_test/acc': 67.915, 'best_valid_test/acc_unbiased': 62.654, 'best_valid_test/diff': 7.201, 'best_valid_test/acc_skew': 59.24, 'best_valid_test/acc_align': 66.068}
[19 / 20] best test accuracy: 62.846 at epoch 19 
 best_stats: {'best_test_epoch': 19, 'best_test_valid/acc': 67.284, 'best_test_valid/acc_unbiased': 63.684, 'best_test_valid/diff': 8.828, 'best_test_valid/acc_skew': 59.27, 'best_test_valid/acc_align': 68.098, 'best_test_test/acc': 67.475, 'best_test_test/acc_unbiased': 62.846, 'best_test_test/diff': 9.057, 'best_test_test/acc_skew': 58.317, 'best_test_test/acc_align': 67.374}
[20 / 20] Learning rate: 1e-05 weight: 0.01
[20 / 20] Loss: 4.493724974743305 CE Loss: 0.4441596140958807 Con Loss: 4.48928338318271
[20 / 20] tensor([[0.974, 0.852],
        [0.330, 0.345]]) {'epoch': 20, 'valid/acc': 66.887, 'valid/acc_unbiased': 63.326, 'valid/diff': 8.156, 'valid/acc_skew': 59.248, 'valid/acc_align': 67.404, 'test/acc': 67.254, 'test/acc_unbiased': 62.53, 'test/diff': 6.846, 'test/acc_skew': 59.107, 'test/acc_align': 65.953}
[20 / 20] best valid accuracy: 63.890 at epoch 18 
 best_stats: {'best_valid_epoch': 18, 'best_valid_valid/acc': 67.416, 'best_valid_valid/acc_unbiased': 63.89, 'best_valid_valid/diff': 8.92, 'best_valid_valid/acc_skew': 59.43, 'best_valid_valid/acc_align': 68.35, 'best_valid_test/acc': 67.915, 'best_valid_test/acc_unbiased': 62.654, 'best_valid_test/diff': 7.201, 'best_valid_test/acc_skew': 59.24, 'best_valid_test/acc_align': 66.068}
[20 / 20] best test accuracy: 62.846 at epoch 19 
 best_stats: {'best_test_epoch': 19, 'best_test_valid/acc': 67.284, 'best_test_valid/acc_unbiased': 63.684, 'best_test_valid/diff': 8.828, 'best_test_valid/acc_skew': 59.27, 'best_test_valid/acc_align': 68.098, 'best_test_test/acc': 67.475, 'best_test_test/acc_unbiased': 62.846, 'best_test_test/diff': 9.057, 'best_test_test/acc_skew': 58.317, 'best_test_test/acc_align': 67.374}
Total training time: 0:16:46
