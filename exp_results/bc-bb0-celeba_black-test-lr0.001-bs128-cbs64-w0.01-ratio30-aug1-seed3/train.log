Log level set to: INFO
Set seed: 3
=======> Using Fixed Random Seed: 3 <========
save_path: exp_results/bc-bb0-celeba_black-test-lr0.001-bs128-cbs64-w0.01-ratio30-aug1-seed3
get_celeba - split:train, aug: False, given_y: True, ratio: 0
use existing black indices from data/celeba/pickles/black
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [60544, 38546]
Target 1: [8005, 16093]
Binary Target 1
---------------------------
Target 0: [60544, 38546]
Target 1: [8005, 16093]
===================================
Normal Label Distribution: 
Target 0: [60544, 38546]
Target 1: [8005, 16093]
===================================
Use BiasedCelebASplit 
 target_attr: black split: train 
 tensor([[60544.,  8005.],
        [38546., 16093.]])
get_celeba - split:train, aug: 1, given_y: True, ratio: 30
use existing black indices from data/celeba/pickles/black
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [60623, 38503]
Target 1: [7983, 16079]
Binary Target 1
---------------------------
Target 0: [60623, 38503]
Target 1: [7983, 16079]
===================================
Normal Label Distribution: 
Target 0: [60623, 38503]
Target 1: [7983, 16079]
===================================
Use BiasedCelebASplit 
 target_attr: black split: train 
 tensor([[60623.,  7983.],
        [38503., 16079.]])
get_celeba - split:train_valid, aug: False, given_y: True, ratio: 0
use existing black indices from data/celeba/pickles/black
Use BiasedCelebASplit 
 target_attr: black split: train_valid 
 tensor([[15141.,  1962.],
        [ 9689.,  4006.]])
get_celeba - split:valid, aug: False, given_y: True, ratio: 0
Use BiasedCelebASplit 
 target_attr: black split: valid 
 tensor([[9752., 1657.],
        [5971., 2487.]])
decay_epochs: [3, 6]
[1 / 10] Learning rate: 0.001 weight: 0.01
[1 / 10] Loss: 4.814074641246085 CE Loss: 0.3091729125868335 Con Loss: 4.810982917382213
[1 / 10] tensor([[0.998, 0.999],
        [0.089, 0.081]]) {'epoch': 1, 'valid/acc': 82.064, 'valid/acc_unbiased': 54.151, 'valid/diff': 1.116, 'valid/acc_skew': 54.709, 'valid/acc_align': 53.593, 'test/acc': 80.787, 'test/acc_unbiased': 54.186, 'test/diff': 0.443, 'test/acc_skew': 54.407, 'test/acc_align': 53.964}
[1 / 10] best valid accuracy: 54.151 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 82.064, 'best_valid_valid/acc_unbiased': 54.151, 'best_valid_valid/diff': 1.116, 'best_valid_valid/acc_skew': 54.709, 'best_valid_valid/acc_align': 53.593, 'best_valid_test/acc': 80.787, 'best_valid_test/acc_unbiased': 54.186, 'best_valid_test/diff': 0.443, 'best_valid_test/acc_skew': 54.407, 'best_valid_test/acc_align': 53.964}
[1 / 10] best test accuracy: 54.186 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 82.064, 'best_test_valid/acc_unbiased': 54.151, 'best_test_valid/diff': 1.116, 'best_test_valid/acc_skew': 54.709, 'best_test_valid/acc_align': 53.593, 'best_test_test/acc': 80.787, 'best_test_test/acc_unbiased': 54.186, 'best_test_test/diff': 0.443, 'best_test_test/acc_skew': 54.407, 'best_test_test/acc_align': 53.964}
[2 / 10] Learning rate: 0.001 weight: 0.01
[2 / 10] Loss: 4.795798267850428 CE Loss: 0.27914376625822096 Con Loss: 4.793006828521278
[2 / 10] tensor([[0.953, 0.957],
        [0.658, 0.531]]) {'epoch': 2, 'valid/acc': 87.149, 'valid/acc_unbiased': 75.768, 'valid/diff': 7.226, 'valid/acc_skew': 79.381, 'valid/acc_align': 72.155, 'test/acc': 87.643, 'test/acc_unbiased': 77.447, 'test/diff': 6.566, 'test/acc_skew': 80.73, 'test/acc_align': 74.164}
[2 / 10] best valid accuracy: 75.768 at epoch 2 
 best_stats: {'best_valid_epoch': 2, 'best_valid_valid/acc': 87.149, 'best_valid_valid/acc_unbiased': 75.768, 'best_valid_valid/diff': 7.226, 'best_valid_valid/acc_skew': 79.381, 'best_valid_valid/acc_align': 72.155, 'best_valid_test/acc': 87.643, 'best_valid_test/acc_unbiased': 77.447, 'best_valid_test/diff': 6.566, 'best_valid_test/acc_skew': 80.73, 'best_valid_test/acc_align': 74.164}
[2 / 10] best test accuracy: 77.447 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 87.149, 'best_test_valid/acc_unbiased': 75.768, 'best_test_valid/diff': 7.226, 'best_test_valid/acc_skew': 79.381, 'best_test_valid/acc_align': 72.155, 'best_test_test/acc': 87.643, 'best_test_test/acc_unbiased': 77.447, 'best_test_test/diff': 6.566, 'best_test_test/acc_skew': 80.73, 'best_test_test/acc_align': 74.164}
[3 / 10] Learning rate: 0.001 weight: 0.01
[3 / 10] Loss: 4.789597885103223 CE Loss: 0.2702586672534593 Con Loss: 4.786895287146439
[3 / 10] tensor([[0.995, 0.991],
        [0.278, 0.262]]) {'epoch': 3, 'valid/acc': 85.307, 'valid/acc_unbiased': 63.657, 'valid/diff': 2.004, 'valid/acc_skew': 64.623, 'valid/acc_align': 62.691, 'test/acc': 84.2, 'test/acc_unbiased': 63.134, 'test/diff': 1.03, 'test/acc_skew': 63.442, 'test/acc_align': 62.827}
[3 / 10] best valid accuracy: 75.768 at epoch 2 
 best_stats: {'best_valid_epoch': 2, 'best_valid_valid/acc': 87.149, 'best_valid_valid/acc_unbiased': 75.768, 'best_valid_valid/diff': 7.226, 'best_valid_valid/acc_skew': 79.381, 'best_valid_valid/acc_align': 72.155, 'best_valid_test/acc': 87.643, 'best_valid_test/acc_unbiased': 77.447, 'best_valid_test/diff': 6.566, 'best_valid_test/acc_skew': 80.73, 'best_valid_test/acc_align': 74.164}
[3 / 10] best test accuracy: 77.447 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 87.149, 'best_test_valid/acc_unbiased': 75.768, 'best_test_valid/diff': 7.226, 'best_test_valid/acc_skew': 79.381, 'best_test_valid/acc_align': 72.155, 'best_test_test/acc': 87.643, 'best_test_test/acc_unbiased': 77.447, 'best_test_test/diff': 6.566, 'best_test_test/acc_skew': 80.73, 'best_test_test/acc_align': 74.164}
[4 / 10] Learning rate: 0.0001 weight: 0.01
[4 / 10] Loss: 4.7643805469875 CE Loss: 0.23846244440123793 Con Loss: 4.761995922757746
[4 / 10] tensor([[0.966, 0.939],
        [0.693, 0.717]]) {'epoch': 4, 'valid/acc': 90.003, 'valid/acc_unbiased': 81.537, 'valid/diff': 1.066, 'valid/acc_skew': 81.039, 'valid/acc_align': 82.035, 'test/acc': 90.411, 'test/acc_unbiased': 82.897, 'test/diff': 2.565, 'test/acc_skew': 81.615, 'test/acc_align': 84.18}
[4 / 10] best valid accuracy: 81.537 at epoch 4 
 best_stats: {'best_valid_epoch': 4, 'best_valid_valid/acc': 90.003, 'best_valid_valid/acc_unbiased': 81.537, 'best_valid_valid/diff': 1.066, 'best_valid_valid/acc_skew': 81.039, 'best_valid_valid/acc_align': 82.035, 'best_valid_test/acc': 90.411, 'best_valid_test/acc_unbiased': 82.897, 'best_valid_test/diff': 2.565, 'best_valid_test/acc_skew': 81.615, 'best_valid_test/acc_align': 84.18}
[4 / 10] best test accuracy: 82.897 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 90.003, 'best_test_valid/acc_unbiased': 81.537, 'best_test_valid/diff': 1.066, 'best_test_valid/acc_skew': 81.039, 'best_test_valid/acc_align': 82.035, 'best_test_test/acc': 90.411, 'best_test_test/acc_unbiased': 82.897, 'best_test_test/diff': 2.565, 'best_test_test/acc_skew': 81.615, 'best_test_test/acc_align': 84.18}
[5 / 10] Learning rate: 0.0001 weight: 0.01
[5 / 10] Loss: 4.751336270711459 CE Loss: 0.2314792041477106 Con Loss: 4.749021472228589
[5 / 10] tensor([[0.969, 0.954],
        [0.672, 0.678]]) {'epoch': 5, 'valid/acc': 90.168, 'valid/acc_unbiased': 81.143, 'valid/diff': 1.241, 'valid/acc_skew': 81.122, 'valid/acc_align': 81.163, 'test/acc': 90.326, 'test/acc_unbiased': 81.833, 'test/diff': 1.059, 'test/acc_skew': 81.304, 'test/acc_align': 82.363}
[5 / 10] best valid accuracy: 81.537 at epoch 4 
 best_stats: {'best_valid_epoch': 4, 'best_valid_valid/acc': 90.003, 'best_valid_valid/acc_unbiased': 81.537, 'best_valid_valid/diff': 1.066, 'best_valid_valid/acc_skew': 81.039, 'best_valid_valid/acc_align': 82.035, 'best_valid_test/acc': 90.411, 'best_valid_test/acc_unbiased': 82.897, 'best_valid_test/diff': 2.565, 'best_valid_test/acc_skew': 81.615, 'best_valid_test/acc_align': 84.18}
[5 / 10] best test accuracy: 82.897 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 90.003, 'best_test_valid/acc_unbiased': 81.537, 'best_test_valid/diff': 1.066, 'best_test_valid/acc_skew': 81.039, 'best_test_valid/acc_align': 82.035, 'best_test_test/acc': 90.411, 'best_test_test/acc_unbiased': 82.897, 'best_test_test/diff': 2.565, 'best_test_test/acc_skew': 81.615, 'best_test_test/acc_align': 84.18}
[6 / 10] Learning rate: 0.0001 weight: 0.01
[6 / 10] Loss: 4.753553019214978 CE Loss: 0.22873749270157973 Con Loss: 4.751265643660766
[6 / 10] tensor([[0.948, 0.911],
        [0.777, 0.797]]) {'epoch': 6, 'valid/acc': 89.925, 'valid/acc_unbiased': 84.87, 'valid/diff': 2.076, 'valid/acc_skew': 84.087, 'valid/acc_align': 85.653, 'test/acc': 90.391, 'test/acc_unbiased': 85.835, 'test/diff': 2.816, 'test/acc_skew': 84.427, 'test/acc_align': 87.243}
[6 / 10] best valid accuracy: 84.870 at epoch 6 
 best_stats: {'best_valid_epoch': 6, 'best_valid_valid/acc': 89.925, 'best_valid_valid/acc_unbiased': 84.87, 'best_valid_valid/diff': 2.076, 'best_valid_valid/acc_skew': 84.087, 'best_valid_valid/acc_align': 85.653, 'best_valid_test/acc': 90.391, 'best_valid_test/acc_unbiased': 85.835, 'best_valid_test/diff': 2.816, 'best_valid_test/acc_skew': 84.427, 'best_valid_test/acc_align': 87.243}
[6 / 10] best test accuracy: 85.835 at epoch 6 
 best_stats: {'best_test_epoch': 6, 'best_test_valid/acc': 89.925, 'best_test_valid/acc_unbiased': 84.87, 'best_test_valid/diff': 2.076, 'best_test_valid/acc_skew': 84.087, 'best_test_valid/acc_align': 85.653, 'best_test_test/acc': 90.391, 'best_test_test/acc_unbiased': 85.835, 'best_test_test/diff': 2.816, 'best_test_test/acc_skew': 84.427, 'best_test_test/acc_align': 87.243}
[7 / 10] Learning rate: 1e-05 weight: 0.01
[7 / 10] Loss: 4.75055362678377 CE Loss: 0.22374861078567812 Con Loss: 4.748316135716778
[7 / 10] tensor([[0.960, 0.933],
        [0.746, 0.749]]) {'epoch': 7, 'valid/acc': 90.298, 'valid/acc_unbiased': 83.626, 'valid/diff': 2.177, 'valid/acc_skew': 83.607, 'valid/acc_align': 83.645, 'test/acc': 90.754, 'test/acc_unbiased': 84.703, 'test/diff': 1.513, 'test/acc_skew': 83.947, 'test/acc_align': 85.46}
[7 / 10] best valid accuracy: 84.870 at epoch 6 
 best_stats: {'best_valid_epoch': 6, 'best_valid_valid/acc': 89.925, 'best_valid_valid/acc_unbiased': 84.87, 'best_valid_valid/diff': 2.076, 'best_valid_valid/acc_skew': 84.087, 'best_valid_valid/acc_align': 85.653, 'best_valid_test/acc': 90.391, 'best_valid_test/acc_unbiased': 85.835, 'best_valid_test/diff': 2.816, 'best_valid_test/acc_skew': 84.427, 'best_valid_test/acc_align': 87.243}
[7 / 10] best test accuracy: 85.835 at epoch 6 
 best_stats: {'best_test_epoch': 6, 'best_test_valid/acc': 89.925, 'best_test_valid/acc_unbiased': 84.87, 'best_test_valid/diff': 2.076, 'best_test_valid/acc_skew': 84.087, 'best_test_valid/acc_align': 85.653, 'best_test_test/acc': 90.391, 'best_test_test/acc_unbiased': 85.835, 'best_test_test/diff': 2.816, 'best_test_test/acc_skew': 84.427, 'best_test_test/acc_align': 87.243}
[8 / 10] Learning rate: 1e-05 weight: 0.01
[8 / 10] Loss: 4.7452257455322355 CE Loss: 0.22174811375703574 Con Loss: 4.743008256341767
[8 / 10] tensor([[0.965, 0.945],
        [0.721, 0.727]]) {'epoch': 8, 'valid/acc': 90.418, 'valid/acc_unbiased': 82.763, 'valid/diff': 1.585, 'valid/acc_skew': 82.686, 'valid/acc_align': 82.839, 'test/acc': 90.894, 'test/acc_unbiased': 83.949, 'test/diff': 1.384, 'test/acc_skew': 83.257, 'test/acc_align': 84.641}
[8 / 10] best valid accuracy: 84.870 at epoch 6 
 best_stats: {'best_valid_epoch': 6, 'best_valid_valid/acc': 89.925, 'best_valid_valid/acc_unbiased': 84.87, 'best_valid_valid/diff': 2.076, 'best_valid_valid/acc_skew': 84.087, 'best_valid_valid/acc_align': 85.653, 'best_valid_test/acc': 90.391, 'best_valid_test/acc_unbiased': 85.835, 'best_valid_test/diff': 2.816, 'best_valid_test/acc_skew': 84.427, 'best_valid_test/acc_align': 87.243}
[8 / 10] best test accuracy: 85.835 at epoch 6 
 best_stats: {'best_test_epoch': 6, 'best_test_valid/acc': 89.925, 'best_test_valid/acc_unbiased': 84.87, 'best_test_valid/diff': 2.076, 'best_test_valid/acc_skew': 84.087, 'best_test_valid/acc_align': 85.653, 'best_test_test/acc': 90.391, 'best_test_test/acc_unbiased': 85.835, 'best_test_test/diff': 2.816, 'best_test_test/acc_skew': 84.427, 'best_test_test/acc_align': 87.243}
[9 / 10] Learning rate: 1e-05 weight: 0.01
[9 / 10] Loss: 4.747991443752573 CE Loss: 0.22026987426858965 Con Loss: 4.745788747120025
[9 / 10] tensor([[0.966, 0.941],
        [0.718, 0.725]]) {'epoch': 9, 'valid/acc': 90.415, 'valid/acc_unbiased': 82.761, 'valid/diff': 1.546, 'valid/acc_skew': 82.553, 'valid/acc_align': 82.969, 'test/acc': 90.764, 'test/acc_unbiased': 83.761, 'test/diff': 1.601, 'test/acc_skew': 82.961, 'test/acc_align': 84.561}
[9 / 10] best valid accuracy: 84.870 at epoch 6 
 best_stats: {'best_valid_epoch': 6, 'best_valid_valid/acc': 89.925, 'best_valid_valid/acc_unbiased': 84.87, 'best_valid_valid/diff': 2.076, 'best_valid_valid/acc_skew': 84.087, 'best_valid_valid/acc_align': 85.653, 'best_valid_test/acc': 90.391, 'best_valid_test/acc_unbiased': 85.835, 'best_valid_test/diff': 2.816, 'best_valid_test/acc_skew': 84.427, 'best_valid_test/acc_align': 87.243}
[9 / 10] best test accuracy: 85.835 at epoch 6 
 best_stats: {'best_test_epoch': 6, 'best_test_valid/acc': 89.925, 'best_test_valid/acc_unbiased': 84.87, 'best_test_valid/diff': 2.076, 'best_test_valid/acc_skew': 84.087, 'best_test_valid/acc_align': 85.653, 'best_test_test/acc': 90.391, 'best_test_test/acc_unbiased': 85.835, 'best_test_test/diff': 2.816, 'best_test_test/acc_skew': 84.427, 'best_test_test/acc_align': 87.243}
[10 / 10] Learning rate: 1e-05 weight: 0.01
[10 / 10] Loss: 4.747874259097153 CE Loss: 0.2205290485472363 Con Loss: 4.745668963433458
[10 / 10] tensor([[0.964, 0.942],
        [0.722, 0.742]]) {'epoch': 10, 'valid/acc': 90.441, 'valid/acc_unbiased': 83.166, 'valid/diff': 1.671, 'valid/acc_skew': 82.994, 'valid/acc_align': 83.338, 'test/acc': 90.93, 'test/acc_unbiased': 84.25, 'test/diff': 2.056, 'test/acc_skew': 83.222, 'test/acc_align': 85.278}
[10 / 10] best valid accuracy: 84.870 at epoch 6 
 best_stats: {'best_valid_epoch': 6, 'best_valid_valid/acc': 89.925, 'best_valid_valid/acc_unbiased': 84.87, 'best_valid_valid/diff': 2.076, 'best_valid_valid/acc_skew': 84.087, 'best_valid_valid/acc_align': 85.653, 'best_valid_test/acc': 90.391, 'best_valid_test/acc_unbiased': 85.835, 'best_valid_test/diff': 2.816, 'best_valid_test/acc_skew': 84.427, 'best_valid_test/acc_align': 87.243}
[10 / 10] best test accuracy: 85.835 at epoch 6 
 best_stats: {'best_test_epoch': 6, 'best_test_valid/acc': 89.925, 'best_test_valid/acc_unbiased': 84.87, 'best_test_valid/diff': 2.076, 'best_test_valid/acc_skew': 84.087, 'best_test_valid/acc_align': 85.653, 'best_test_test/acc': 90.391, 'best_test_test/acc_unbiased': 85.835, 'best_test_test/diff': 2.816, 'best_test_test/acc_skew': 84.427, 'best_test_test/acc_align': 87.243}
Total training time: 2:25:11
