Log level set to: INFO
Set seed: 3
=======> Using Fixed Random Seed: 3 <========
save_path: exp_results/bc-bb0-utk_face_race-uw-0.95-lr0.001-bs128-cbs64-w0.01-ratio10-aug1-seed3
get_utk_face - split: train, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_race-0.95
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [4407, 276]
Target 1: [220, 5529]
Binary Target 1
---------------------------
Target 0: [4407, 276]
Target 1: [220, 5529]
===================================
Normal Label Distribution: 
Target 0: [4407, 276]
Target 1: [220, 5529]
===================================
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [4407, 276]
Target 1: [220, 5529]
Binary Target 1
---------------------------
Target 0: [4407, 276]
Target 1: [220, 5529]
===================================
Normal Label Distribution: 
Target 0: [4407, 276]
Target 1: [220, 5529]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 10432, target_attr: gender, bias_attr: race bias_rate: 0.95
['[train] target_0-bias_0: 4407', '[train] target_0-bias_1: 276', '[train] target_1-bias_0: 220', '[train] target_1-bias_1: 5529']
confusion_matrix - 
 original: tensor([[4407.,  220.],
        [ 276., 5529.]]), 
 normalized: tensor([[0.952, 0.048],
        [0.048, 0.952]]), 
 b|y: tensor([[0.941, 0.059],
        [0.038, 0.962]])
get_utk_face - split: train, aug: 1, given_y: True, ratio: 10
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_race-0.95
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [4407, 276]
Target 1: [220, 5529]
Binary Target 1
---------------------------
Target 0: [4407, 276]
Target 1: [220, 5529]
===================================
Normal Label Distribution: 
Target 0: [4407, 276]
Target 1: [220, 5529]
===================================
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [4407, 276]
Target 1: [220, 5529]
Binary Target 1
---------------------------
Target 0: [4407, 276]
Target 1: [220, 5529]
===================================
Normal Label Distribution: 
Target 0: [4407, 276]
Target 1: [220, 5529]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 10432, target_attr: gender, bias_attr: race bias_rate: 0.95
['[train] target_0-bias_0: 4407', '[train] target_0-bias_1: 276', '[train] target_1-bias_0: 220', '[train] target_1-bias_1: 5529']
get_utk_face - split: valid, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_race-0.95
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [583, 684]
Target 1: [457, 646]
Binary Target 1
---------------------------
Target 0: [583, 684]
Target 1: [457, 646]
===================================
Normal Label Distribution: 
Target 0: [583, 684]
Target 1: [457, 646]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 2370, target_attr: gender, bias_attr: race bias_rate: 0.95
['[valid] target_0-bias_0: 583', '[valid] target_0-bias_1: 684', '[valid] target_1-bias_0: 457', '[valid] target_1-bias_1: 646']
get_utk_face - split: test, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_race-0.95
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [558, 677]
Target 1: [462, 673]
Binary Target 1
---------------------------
Target 0: [558, 677]
Target 1: [462, 673]
===================================
Normal Label Distribution: 
Target 0: [558, 677]
Target 1: [462, 673]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 2370, target_attr: gender, bias_attr: race bias_rate: 0.95
['[test] target_0-bias_0: 558', '[test] target_0-bias_1: 677', '[test] target_1-bias_0: 462', '[test] target_1-bias_1: 673']
decay_epochs: [6, 13]
[1 / 20] Learning rate: 0.001 weight: 0.01
[1 / 20] Loss: 4.911906491028019 CE Loss: 2.212645745716212 Con Loss: 4.889780044555664
[1 / 20] tensor([[0.724, 0.685],
        [0.879, 0.878]]) {'epoch': 1, 'valid/acc': 78.819, 'valid/acc_unbiased': 79.313, 'valid/diff': 0.395, 'valid/acc_skew': 79.51, 'valid/acc_align': 79.115, 'test/acc': 78.692, 'test/acc_unbiased': 79.158, 'test/diff': 1.963, 'test/acc_skew': 78.208, 'test/acc_align': 80.109}
[1 / 20] best valid accuracy: 79.313 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 78.819, 'best_valid_valid/acc_unbiased': 79.313, 'best_valid_valid/diff': 0.395, 'best_valid_valid/acc_skew': 79.51, 'best_valid_valid/acc_align': 79.115, 'best_valid_test/acc': 78.692, 'best_valid_test/acc_unbiased': 79.158, 'best_valid_test/diff': 1.963, 'best_valid_test/acc_skew': 78.208, 'best_valid_test/acc_align': 80.109}
[1 / 20] best test accuracy: 79.158 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 78.819, 'best_test_valid/acc_unbiased': 79.313, 'best_test_valid/diff': 0.395, 'best_test_valid/acc_skew': 79.51, 'best_test_valid/acc_align': 79.115, 'best_test_test/acc': 78.692, 'best_test_test/acc_unbiased': 79.158, 'best_test_test/diff': 1.963, 'best_test_test/acc_skew': 78.208, 'best_test_test/acc_align': 80.109}
[2 / 20] Learning rate: 0.001 weight: 0.01
[2 / 20] Loss: 4.749546375742719 CE Loss: 1.780402203279039 Con Loss: 4.731742349870366
[2 / 20] tensor([[0.772, 0.715],
        [0.857, 0.892]]) {'epoch': 2, 'valid/acc': 81.73, 'valid/acc_unbiased': 82.266, 'valid/diff': 3.468, 'valid/acc_skew': 80.532, 'valid/acc_align': 84.0, 'test/acc': 80.633, 'test/acc_unbiased': 80.9, 'test/diff': 4.594, 'test/acc_skew': 78.603, 'test/acc_align': 83.197}
[2 / 20] best valid accuracy: 82.266 at epoch 2 
 best_stats: {'best_valid_epoch': 2, 'best_valid_valid/acc': 81.73, 'best_valid_valid/acc_unbiased': 82.266, 'best_valid_valid/diff': 3.468, 'best_valid_valid/acc_skew': 80.532, 'best_valid_valid/acc_align': 84.0, 'best_valid_test/acc': 80.633, 'best_valid_test/acc_unbiased': 80.9, 'best_valid_test/diff': 4.594, 'best_valid_test/acc_skew': 78.603, 'best_valid_test/acc_align': 83.197}
[2 / 20] best test accuracy: 80.900 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 81.73, 'best_test_valid/acc_unbiased': 82.266, 'best_test_valid/diff': 3.468, 'best_test_valid/acc_skew': 80.532, 'best_test_valid/acc_align': 84.0, 'best_test_test/acc': 80.633, 'best_test_test/acc_unbiased': 80.9, 'best_test_test/diff': 4.594, 'best_test_test/acc_skew': 78.603, 'best_test_test/acc_align': 83.197}
[3 / 20] Learning rate: 0.001 weight: 0.01
[3 / 20] Loss: 4.708090668075656 CE Loss: 1.5357155646283203 Con Loss: 4.692733513065642
[3 / 20] tensor([[0.842, 0.814],
        [0.829, 0.828]]) {'epoch': 3, 'valid/acc': 82.7, 'valid/acc_unbiased': 82.826, 'valid/diff': 3.388, 'valid/acc_skew': 81.963, 'valid/acc_align': 83.688, 'test/acc': 82.743, 'test/acc_unbiased': 82.821, 'test/diff': 1.489, 'test/acc_skew': 82.144, 'test/acc_align': 83.497}
[3 / 20] best valid accuracy: 82.826 at epoch 3 
 best_stats: {'best_valid_epoch': 3, 'best_valid_valid/acc': 82.7, 'best_valid_valid/acc_unbiased': 82.826, 'best_valid_valid/diff': 3.388, 'best_valid_valid/acc_skew': 81.963, 'best_valid_valid/acc_align': 83.688, 'best_valid_test/acc': 82.743, 'best_valid_test/acc_unbiased': 82.821, 'best_valid_test/diff': 1.489, 'best_valid_test/acc_skew': 82.144, 'best_valid_test/acc_align': 83.497}
[3 / 20] best test accuracy: 82.821 at epoch 3 
 best_stats: {'best_test_epoch': 3, 'best_test_valid/acc': 82.7, 'best_test_valid/acc_unbiased': 82.826, 'best_test_valid/diff': 3.388, 'best_test_valid/acc_skew': 81.963, 'best_test_valid/acc_align': 83.688, 'best_test_test/acc': 82.743, 'best_test_test/acc_unbiased': 82.821, 'best_test_test/diff': 1.489, 'best_test_test/acc_skew': 82.144, 'best_test_test/acc_align': 83.497}
[4 / 20] Learning rate: 0.001 weight: 0.01
[4 / 20] Loss: 4.694837189890856 CE Loss: 1.5532759208620692 Con Loss: 4.679304427164464
[4 / 20] tensor([[0.821, 0.731],
        [0.851, 0.887]]) {'epoch': 4, 'valid/acc': 82.574, 'valid/acc_unbiased': 82.868, 'valid/diff': 3.133, 'valid/acc_skew': 81.302, 'valid/acc_align': 84.435, 'test/acc': 81.983, 'test/acc_unbiased': 82.242, 'test/diff': 6.302, 'test/acc_skew': 79.091, 'test/acc_align': 85.393}
[4 / 20] best valid accuracy: 82.868 at epoch 4 
 best_stats: {'best_valid_epoch': 4, 'best_valid_valid/acc': 82.574, 'best_valid_valid/acc_unbiased': 82.868, 'best_valid_valid/diff': 3.133, 'best_valid_valid/acc_skew': 81.302, 'best_valid_valid/acc_align': 84.435, 'best_valid_test/acc': 81.983, 'best_valid_test/acc_unbiased': 82.242, 'best_valid_test/diff': 6.302, 'best_valid_test/acc_skew': 79.091, 'best_valid_test/acc_align': 85.393}
[4 / 20] best test accuracy: 82.821 at epoch 3 
 best_stats: {'best_test_epoch': 3, 'best_test_valid/acc': 82.7, 'best_test_valid/acc_unbiased': 82.826, 'best_test_valid/diff': 3.388, 'best_test_valid/acc_skew': 81.963, 'best_test_valid/acc_align': 83.688, 'best_test_test/acc': 82.743, 'best_test_test/acc_unbiased': 82.821, 'best_test_test/diff': 1.489, 'best_test_test/acc_skew': 82.144, 'best_test_test/acc_align': 83.497}
[5 / 20] Learning rate: 0.001 weight: 0.01
[5 / 20] Loss: 4.658780993128115 CE Loss: 1.42472760150769 Con Loss: 4.6445336897680365
[5 / 20] tensor([[0.824, 0.784],
        [0.810, 0.868]]) {'epoch': 5, 'valid/acc': 82.743, 'valid/acc_unbiased': 82.748, 'valid/diff': 2.298, 'valid/acc_skew': 81.599, 'valid/acc_align': 83.897, 'test/acc': 82.236, 'test/acc_unbiased': 82.15, 'test/diff': 4.913, 'test/acc_skew': 79.693, 'test/acc_align': 84.606}
[5 / 20] best valid accuracy: 82.868 at epoch 4 
 best_stats: {'best_valid_epoch': 4, 'best_valid_valid/acc': 82.574, 'best_valid_valid/acc_unbiased': 82.868, 'best_valid_valid/diff': 3.133, 'best_valid_valid/acc_skew': 81.302, 'best_valid_valid/acc_align': 84.435, 'best_valid_test/acc': 81.983, 'best_valid_test/acc_unbiased': 82.242, 'best_valid_test/diff': 6.302, 'best_valid_test/acc_skew': 79.091, 'best_valid_test/acc_align': 85.393}
[5 / 20] best test accuracy: 82.821 at epoch 3 
 best_stats: {'best_test_epoch': 3, 'best_test_valid/acc': 82.7, 'best_test_valid/acc_unbiased': 82.826, 'best_test_valid/diff': 3.388, 'best_test_valid/acc_skew': 81.963, 'best_test_valid/acc_align': 83.688, 'best_test_test/acc': 82.743, 'best_test_test/acc_unbiased': 82.821, 'best_test_test/diff': 1.489, 'best_test_test/acc_skew': 82.144, 'best_test_test/acc_align': 83.497}
[6 / 20] Learning rate: 0.001 weight: 0.01
[6 / 20] Loss: 4.640969688906991 CE Loss: 1.39487260324092 Con Loss: 4.627020952891718
[6 / 20] tensor([[0.740, 0.604],
        [0.918, 0.951]]) {'epoch': 6, 'valid/acc': 79.451, 'valid/acc_unbiased': 80.421, 'valid/diff': 4.685, 'valid/acc_skew': 78.078, 'valid/acc_align': 82.764, 'test/acc': 79.578, 'test/acc_unbiased': 80.325, 'test/diff': 8.461, 'test/acc_skew': 76.094, 'test/acc_align': 84.555}
[6 / 20] best valid accuracy: 82.868 at epoch 4 
 best_stats: {'best_valid_epoch': 4, 'best_valid_valid/acc': 82.574, 'best_valid_valid/acc_unbiased': 82.868, 'best_valid_valid/diff': 3.133, 'best_valid_valid/acc_skew': 81.302, 'best_valid_valid/acc_align': 84.435, 'best_valid_test/acc': 81.983, 'best_valid_test/acc_unbiased': 82.242, 'best_valid_test/diff': 6.302, 'best_valid_test/acc_skew': 79.091, 'best_valid_test/acc_align': 85.393}
[6 / 20] best test accuracy: 82.821 at epoch 3 
 best_stats: {'best_test_epoch': 3, 'best_test_valid/acc': 82.7, 'best_test_valid/acc_unbiased': 82.826, 'best_test_valid/diff': 3.388, 'best_test_valid/acc_skew': 81.963, 'best_test_valid/acc_align': 83.688, 'best_test_test/acc': 82.743, 'best_test_test/acc_unbiased': 82.821, 'best_test_test/diff': 1.489, 'best_test_test/acc_skew': 82.144, 'best_test_test/acc_align': 83.497}
[7 / 20] Learning rate: 0.0001 weight: 0.01
[7 / 20] Loss: 4.592751450333859 CE Loss: 1.247422551084881 Con Loss: 4.580277229379291
[7 / 20] tensor([[0.880, 0.802],
        [0.844, 0.878]]) {'epoch': 7, 'valid/acc': 85.696, 'valid/acc_unbiased': 85.65, 'valid/diff': 3.209, 'valid/acc_skew': 84.045, 'valid/acc_align': 87.254, 'test/acc': 85.021, 'test/acc_unbiased': 85.108, 'test/diff': 5.593, 'test/acc_skew': 82.311, 'test/acc_align': 87.904}
[7 / 20] best valid accuracy: 85.650 at epoch 7 
 best_stats: {'best_valid_epoch': 7, 'best_valid_valid/acc': 85.696, 'best_valid_valid/acc_unbiased': 85.65, 'best_valid_valid/diff': 3.209, 'best_valid_valid/acc_skew': 84.045, 'best_valid_valid/acc_align': 87.254, 'best_valid_test/acc': 85.021, 'best_valid_test/acc_unbiased': 85.108, 'best_valid_test/diff': 5.593, 'best_valid_test/acc_skew': 82.311, 'best_valid_test/acc_align': 87.904}
[7 / 20] best test accuracy: 85.108 at epoch 7 
 best_stats: {'best_test_epoch': 7, 'best_test_valid/acc': 85.696, 'best_test_valid/acc_unbiased': 85.65, 'best_test_valid/diff': 3.209, 'best_test_valid/acc_skew': 84.045, 'best_test_valid/acc_align': 87.254, 'best_test_test/acc': 85.021, 'best_test_test/acc_unbiased': 85.108, 'best_test_test/diff': 5.593, 'best_test_test/acc_skew': 82.311, 'best_test_test/acc_align': 87.904}
[8 / 20] Learning rate: 0.0001 weight: 0.01
[8 / 20] Loss: 4.543599295469881 CE Loss: 1.1076364948705661 Con Loss: 4.532522935808802
[8 / 20] tensor([[0.860, 0.764],
        [0.864, 0.899]]) {'epoch': 8, 'valid/acc': 85.148, 'valid/acc_unbiased': 85.28, 'valid/diff': 6.054, 'valid/acc_skew': 82.253, 'valid/acc_align': 88.307, 'test/acc': 84.43, 'test/acc_unbiased': 84.662, 'test/diff': 6.594, 'test/acc_skew': 81.365, 'test/acc_align': 87.959}
[8 / 20] best valid accuracy: 85.650 at epoch 7 
 best_stats: {'best_valid_epoch': 7, 'best_valid_valid/acc': 85.696, 'best_valid_valid/acc_unbiased': 85.65, 'best_valid_valid/diff': 3.209, 'best_valid_valid/acc_skew': 84.045, 'best_valid_valid/acc_align': 87.254, 'best_valid_test/acc': 85.021, 'best_valid_test/acc_unbiased': 85.108, 'best_valid_test/diff': 5.593, 'best_valid_test/acc_skew': 82.311, 'best_valid_test/acc_align': 87.904}
[8 / 20] best test accuracy: 85.108 at epoch 7 
 best_stats: {'best_test_epoch': 7, 'best_test_valid/acc': 85.696, 'best_test_valid/acc_unbiased': 85.65, 'best_test_valid/diff': 3.209, 'best_test_valid/acc_skew': 84.045, 'best_test_valid/acc_align': 87.254, 'best_test_test/acc': 85.021, 'best_test_test/acc_unbiased': 85.108, 'best_test_test/diff': 5.593, 'best_test_test/acc_skew': 82.311, 'best_test_test/acc_align': 87.904}
[9 / 20] Learning rate: 0.0001 weight: 0.01
[9 / 20] Loss: 4.509504473282516 CE Loss: 1.0368108007074133 Con Loss: 4.49913635136891
[9 / 20] tensor([[0.903, 0.812],
        [0.807, 0.872]]) {'epoch': 9, 'valid/acc': 86.203, 'valid/acc_unbiased': 86.0, 'valid/diff': 6.901, 'valid/acc_skew': 82.55, 'valid/acc_align': 89.451, 'test/acc': 84.979, 'test/acc_unbiased': 84.88, 'test/diff': 7.784, 'test/acc_skew': 80.988, 'test/acc_align': 88.772}
[9 / 20] best valid accuracy: 86.000 at epoch 9 
 best_stats: {'best_valid_epoch': 9, 'best_valid_valid/acc': 86.203, 'best_valid_valid/acc_unbiased': 86.0, 'best_valid_valid/diff': 6.901, 'best_valid_valid/acc_skew': 82.55, 'best_valid_valid/acc_align': 89.451, 'best_valid_test/acc': 84.979, 'best_valid_test/acc_unbiased': 84.88, 'best_valid_test/diff': 7.784, 'best_valid_test/acc_skew': 80.988, 'best_valid_test/acc_align': 88.772}
[9 / 20] best test accuracy: 85.108 at epoch 7 
 best_stats: {'best_test_epoch': 7, 'best_test_valid/acc': 85.696, 'best_test_valid/acc_unbiased': 85.65, 'best_test_valid/diff': 3.209, 'best_test_valid/acc_skew': 84.045, 'best_test_valid/acc_align': 87.254, 'best_test_test/acc': 85.021, 'best_test_test/acc_unbiased': 85.108, 'best_test_test/diff': 5.593, 'best_test_test/acc_skew': 82.311, 'best_test_test/acc_align': 87.904}
[10 / 20] Learning rate: 0.0001 weight: 0.01
[10 / 20] Loss: 4.51018264396059 CE Loss: 1.0714645883057015 Con Loss: 4.499468001851275
[10 / 20] tensor([[0.884, 0.789],
        [0.831, 0.892]]) {'epoch': 10, 'valid/acc': 85.781, 'valid/acc_unbiased': 85.774, 'valid/diff': 6.965, 'valid/acc_skew': 82.291, 'valid/acc_align': 89.256, 'test/acc': 84.852, 'test/acc_unbiased': 84.875, 'test/diff': 7.755, 'test/acc_skew': 80.997, 'test/acc_align': 88.752}
[10 / 20] best valid accuracy: 86.000 at epoch 9 
 best_stats: {'best_valid_epoch': 9, 'best_valid_valid/acc': 86.203, 'best_valid_valid/acc_unbiased': 86.0, 'best_valid_valid/diff': 6.901, 'best_valid_valid/acc_skew': 82.55, 'best_valid_valid/acc_align': 89.451, 'best_valid_test/acc': 84.979, 'best_valid_test/acc_unbiased': 84.88, 'best_valid_test/diff': 7.784, 'best_valid_test/acc_skew': 80.988, 'best_valid_test/acc_align': 88.772}
[10 / 20] best test accuracy: 85.108 at epoch 7 
 best_stats: {'best_test_epoch': 7, 'best_test_valid/acc': 85.696, 'best_test_valid/acc_unbiased': 85.65, 'best_test_valid/diff': 3.209, 'best_test_valid/acc_skew': 84.045, 'best_test_valid/acc_align': 87.254, 'best_test_test/acc': 85.021, 'best_test_test/acc_unbiased': 85.108, 'best_test_test/diff': 5.593, 'best_test_test/acc_skew': 82.311, 'best_test_test/acc_align': 87.904}
[11 / 20] Learning rate: 0.0001 weight: 0.01
[11 / 20] Loss: 4.46467567806595 CE Loss: 1.0263550676451139 Con Loss: 4.454412126833676
[11 / 20] tensor([[0.903, 0.806],
        [0.818, 0.878]]) {'epoch': 11, 'valid/acc': 86.54, 'valid/acc_unbiased': 86.369, 'valid/diff': 6.252, 'valid/acc_skew': 83.243, 'valid/acc_align': 89.495, 'test/acc': 85.19, 'test/acc_unbiased': 85.152, 'test/diff': 7.835, 'test/acc_skew': 81.234, 'test/acc_align': 89.069}
[11 / 20] best valid accuracy: 86.369 at epoch 11 
 best_stats: {'best_valid_epoch': 11, 'best_valid_valid/acc': 86.54, 'best_valid_valid/acc_unbiased': 86.369, 'best_valid_valid/diff': 6.252, 'best_valid_valid/acc_skew': 83.243, 'best_valid_valid/acc_align': 89.495, 'best_valid_test/acc': 85.19, 'best_valid_test/acc_unbiased': 85.152, 'best_valid_test/diff': 7.835, 'best_valid_test/acc_skew': 81.234, 'best_valid_test/acc_align': 89.069}
[11 / 20] best test accuracy: 85.152 at epoch 11 
 best_stats: {'best_test_epoch': 11, 'best_test_valid/acc': 86.54, 'best_test_valid/acc_unbiased': 86.369, 'best_test_valid/diff': 6.252, 'best_test_valid/acc_skew': 83.243, 'best_test_valid/acc_align': 89.495, 'best_test_test/acc': 85.19, 'best_test_test/acc_unbiased': 85.152, 'best_test_test/diff': 7.835, 'best_test_test/acc_skew': 81.234, 'best_test_test/acc_align': 89.069}
[12 / 20] Learning rate: 0.0001 weight: 0.01
[12 / 20] Loss: 4.476521138033252 CE Loss: 1.0164982884939462 Con Loss: 4.466356160450567
[12 / 20] tensor([[0.884, 0.801],
        [0.829, 0.895]]) {'epoch': 12, 'valid/acc': 86.329, 'valid/acc_unbiased': 86.28, 'valid/diff': 4.543, 'valid/acc_skew': 84.009, 'valid/acc_align': 88.551, 'test/acc': 85.232, 'test/acc_unbiased': 85.19, 'test/diff': 7.421, 'test/acc_skew': 81.48, 'test/acc_align': 88.901}
[12 / 20] best valid accuracy: 86.369 at epoch 11 
 best_stats: {'best_valid_epoch': 11, 'best_valid_valid/acc': 86.54, 'best_valid_valid/acc_unbiased': 86.369, 'best_valid_valid/diff': 6.252, 'best_valid_valid/acc_skew': 83.243, 'best_valid_valid/acc_align': 89.495, 'best_valid_test/acc': 85.19, 'best_valid_test/acc_unbiased': 85.152, 'best_valid_test/diff': 7.835, 'best_valid_test/acc_skew': 81.234, 'best_valid_test/acc_align': 89.069}
[12 / 20] best test accuracy: 85.190 at epoch 12 
 best_stats: {'best_test_epoch': 12, 'best_test_valid/acc': 86.329, 'best_test_valid/acc_unbiased': 86.28, 'best_test_valid/diff': 4.543, 'best_test_valid/acc_skew': 84.009, 'best_test_valid/acc_align': 88.551, 'best_test_test/acc': 85.232, 'best_test_test/acc_unbiased': 85.19, 'best_test_test/diff': 7.421, 'best_test_test/acc_skew': 81.48, 'best_test_test/acc_align': 88.901}
[13 / 20] Learning rate: 0.0001 weight: 0.01
[13 / 20] Loss: 4.463512347519764 CE Loss: 1.0222695444259176 Con Loss: 4.453289649237885
[13 / 20] tensor([[0.912, 0.836],
        [0.799, 0.857]]) {'epoch': 13, 'valid/acc': 87.3, 'valid/acc_unbiased': 86.996, 'valid/diff': 6.333, 'valid/acc_skew': 83.829, 'valid/acc_align': 90.162, 'test/acc': 85.274, 'test/acc_unbiased': 85.107, 'test/diff': 6.74, 'test/acc_skew': 81.737, 'test/acc_align': 88.477}
[13 / 20] best valid accuracy: 86.996 at epoch 13 
 best_stats: {'best_valid_epoch': 13, 'best_valid_valid/acc': 87.3, 'best_valid_valid/acc_unbiased': 86.996, 'best_valid_valid/diff': 6.333, 'best_valid_valid/acc_skew': 83.829, 'best_valid_valid/acc_align': 90.162, 'best_valid_test/acc': 85.274, 'best_valid_test/acc_unbiased': 85.107, 'best_valid_test/diff': 6.74, 'best_valid_test/acc_skew': 81.737, 'best_valid_test/acc_align': 88.477}
[13 / 20] best test accuracy: 85.190 at epoch 12 
 best_stats: {'best_test_epoch': 12, 'best_test_valid/acc': 86.329, 'best_test_valid/acc_unbiased': 86.28, 'best_test_valid/diff': 4.543, 'best_test_valid/acc_skew': 84.009, 'best_test_valid/acc_align': 88.551, 'best_test_test/acc': 85.232, 'best_test_test/acc_unbiased': 85.19, 'best_test_test/diff': 7.421, 'best_test_test/acc_skew': 81.48, 'best_test_test/acc_align': 88.901}
[14 / 20] Learning rate: 1e-05 weight: 0.01
[14 / 20] Loss: 4.464891866672258 CE Loss: 0.9543643176921306 Con Loss: 4.45534818450366
[14 / 20] tensor([[0.885, 0.802],
        [0.846, 0.892]]) {'epoch': 14, 'valid/acc': 86.835, 'valid/acc_unbiased': 86.787, 'valid/diff': 6.946, 'valid/acc_skew': 83.314, 'valid/acc_align': 90.26, 'test/acc': 85.57, 'test/acc_unbiased': 85.631, 'test/diff': 6.422, 'test/acc_skew': 82.419, 'test/acc_align': 88.842}
[14 / 20] best valid accuracy: 86.996 at epoch 13 
 best_stats: {'best_valid_epoch': 13, 'best_valid_valid/acc': 87.3, 'best_valid_valid/acc_unbiased': 86.996, 'best_valid_valid/diff': 6.333, 'best_valid_valid/acc_skew': 83.829, 'best_valid_valid/acc_align': 90.162, 'best_valid_test/acc': 85.274, 'best_valid_test/acc_unbiased': 85.107, 'best_valid_test/diff': 6.74, 'best_valid_test/acc_skew': 81.737, 'best_valid_test/acc_align': 88.477}
[14 / 20] best test accuracy: 85.631 at epoch 14 
 best_stats: {'best_test_epoch': 14, 'best_test_valid/acc': 86.835, 'best_test_valid/acc_unbiased': 86.787, 'best_test_valid/diff': 6.946, 'best_test_valid/acc_skew': 83.314, 'best_test_valid/acc_align': 90.26, 'best_test_test/acc': 85.57, 'best_test_test/acc_unbiased': 85.631, 'best_test_test/diff': 6.422, 'best_test_test/acc_skew': 82.419, 'best_test_test/acc_align': 88.842}
[15 / 20] Learning rate: 1e-05 weight: 0.01
[15 / 20] Loss: 4.453138819501444 CE Loss: 0.913183684363687 Con Loss: 4.44400698714461
[15 / 20] tensor([[0.887, 0.792],
        [0.848, 0.897]]) {'epoch': 15, 'valid/acc': 86.793, 'valid/acc_unbiased': 86.821, 'valid/diff': 6.503, 'valid/acc_skew': 83.569, 'valid/acc_align': 90.072, 'test/acc': 85.527, 'test/acc_unbiased': 85.62, 'test/diff': 7.218, 'test/acc_skew': 82.011, 'test/acc_align': 89.229}
[15 / 20] best valid accuracy: 86.996 at epoch 13 
 best_stats: {'best_valid_epoch': 13, 'best_valid_valid/acc': 87.3, 'best_valid_valid/acc_unbiased': 86.996, 'best_valid_valid/diff': 6.333, 'best_valid_valid/acc_skew': 83.829, 'best_valid_valid/acc_align': 90.162, 'best_valid_test/acc': 85.274, 'best_valid_test/acc_unbiased': 85.107, 'best_valid_test/diff': 6.74, 'best_valid_test/acc_skew': 81.737, 'best_valid_test/acc_align': 88.477}
[15 / 20] best test accuracy: 85.631 at epoch 14 
 best_stats: {'best_test_epoch': 14, 'best_test_valid/acc': 86.835, 'best_test_valid/acc_unbiased': 86.787, 'best_test_valid/diff': 6.946, 'best_test_valid/acc_skew': 83.314, 'best_test_valid/acc_align': 90.26, 'best_test_test/acc': 85.57, 'best_test_test/acc_unbiased': 85.631, 'best_test_test/diff': 6.422, 'best_test_test/acc_skew': 82.419, 'best_test_test/acc_align': 88.842}
[16 / 20] Learning rate: 1e-05 weight: 0.01
[16 / 20] Loss: 4.450335748356544 CE Loss: 0.8868611985189052 Con Loss: 4.441467156439471
[16 / 20] tensor([[0.887, 0.790],
        [0.853, 0.902]]) {'epoch': 16, 'valid/acc': 86.371, 'valid/acc_unbiased': 86.494, 'valid/diff': 6.144, 'valid/acc_skew': 83.422, 'valid/acc_align': 89.566, 'test/acc': 85.696, 'test/acc_unbiased': 85.802, 'test/diff': 7.298, 'test/acc_skew': 82.153, 'test/acc_align': 89.451}
[16 / 20] best valid accuracy: 86.996 at epoch 13 
 best_stats: {'best_valid_epoch': 13, 'best_valid_valid/acc': 87.3, 'best_valid_valid/acc_unbiased': 86.996, 'best_valid_valid/diff': 6.333, 'best_valid_valid/acc_skew': 83.829, 'best_valid_valid/acc_align': 90.162, 'best_valid_test/acc': 85.274, 'best_valid_test/acc_unbiased': 85.107, 'best_valid_test/diff': 6.74, 'best_valid_test/acc_skew': 81.737, 'best_valid_test/acc_align': 88.477}
[16 / 20] best test accuracy: 85.802 at epoch 16 
 best_stats: {'best_test_epoch': 16, 'best_test_valid/acc': 86.371, 'best_test_valid/acc_unbiased': 86.494, 'best_test_valid/diff': 6.144, 'best_test_valid/acc_skew': 83.422, 'best_test_valid/acc_align': 89.566, 'best_test_test/acc': 85.696, 'best_test_test/acc_unbiased': 85.802, 'best_test_test/diff': 7.298, 'best_test_test/acc_skew': 82.153, 'best_test_test/acc_align': 89.451}
[17 / 20] Learning rate: 1e-05 weight: 0.01
[17 / 20] Loss: 4.440733362560623 CE Loss: 0.9287112446650405 Con Loss: 4.431446259738477
[17 / 20] tensor([[0.901, 0.809],
        [0.823, 0.892]]) {'epoch': 17, 'valid/acc': 86.878, 'valid/acc_unbiased': 86.828, 'valid/diff': 6.296, 'valid/acc_skew': 83.68, 'valid/acc_align': 89.976, 'test/acc': 85.696, 'test/acc_unbiased': 85.623, 'test/diff': 8.05, 'test/acc_skew': 81.598, 'test/acc_align': 89.648}
[17 / 20] best valid accuracy: 86.996 at epoch 13 
 best_stats: {'best_valid_epoch': 13, 'best_valid_valid/acc': 87.3, 'best_valid_valid/acc_unbiased': 86.996, 'best_valid_valid/diff': 6.333, 'best_valid_valid/acc_skew': 83.829, 'best_valid_valid/acc_align': 90.162, 'best_valid_test/acc': 85.274, 'best_valid_test/acc_unbiased': 85.107, 'best_valid_test/diff': 6.74, 'best_valid_test/acc_skew': 81.737, 'best_valid_test/acc_align': 88.477}
[17 / 20] best test accuracy: 85.802 at epoch 16 
 best_stats: {'best_test_epoch': 16, 'best_test_valid/acc': 86.371, 'best_test_valid/acc_unbiased': 86.494, 'best_test_valid/diff': 6.144, 'best_test_valid/acc_skew': 83.422, 'best_test_valid/acc_align': 89.566, 'best_test_test/acc': 85.696, 'best_test_test/acc_unbiased': 85.802, 'best_test_test/diff': 7.298, 'best_test_test/acc_skew': 82.153, 'best_test_test/acc_align': 89.451}
[18 / 20] Learning rate: 1e-05 weight: 0.01
[18 / 20] Loss: 4.430576254253738 CE Loss: 0.9111421064365129 Con Loss: 4.421464808879454
[18 / 20] tensor([[0.898, 0.802],
        [0.829, 0.896]]) {'epoch': 18, 'valid/acc': 86.582, 'valid/acc_unbiased': 86.584, 'valid/diff': 5.517, 'valid/acc_skew': 83.825, 'valid/acc_align': 89.342, 'test/acc': 85.654, 'test/acc_unbiased': 85.623, 'test/diff': 8.138, 'test/acc_skew': 81.554, 'test/acc_align': 89.692}
[18 / 20] best valid accuracy: 86.996 at epoch 13 
 best_stats: {'best_valid_epoch': 13, 'best_valid_valid/acc': 87.3, 'best_valid_valid/acc_unbiased': 86.996, 'best_valid_valid/diff': 6.333, 'best_valid_valid/acc_skew': 83.829, 'best_valid_valid/acc_align': 90.162, 'best_valid_test/acc': 85.274, 'best_valid_test/acc_unbiased': 85.107, 'best_valid_test/diff': 6.74, 'best_valid_test/acc_skew': 81.737, 'best_valid_test/acc_align': 88.477}
[18 / 20] best test accuracy: 85.802 at epoch 16 
 best_stats: {'best_test_epoch': 16, 'best_test_valid/acc': 86.371, 'best_test_valid/acc_unbiased': 86.494, 'best_test_valid/diff': 6.144, 'best_test_valid/acc_skew': 83.422, 'best_test_valid/acc_align': 89.566, 'best_test_test/acc': 85.696, 'best_test_test/acc_unbiased': 85.802, 'best_test_test/diff': 7.298, 'best_test_test/acc_skew': 82.153, 'best_test_test/acc_align': 89.451}
[19 / 20] Learning rate: 1e-05 weight: 0.01
[19 / 20] Loss: 4.4437798254329 CE Loss: 0.88628160990089 Con Loss: 4.434917022845497
[19 / 20] tensor([[0.898, 0.798],
        [0.818, 0.896]]) {'epoch': 19, 'valid/acc': 86.582, 'valid/acc_unbiased': 86.55, 'valid/diff': 6.546, 'valid/acc_skew': 83.278, 'valid/acc_align': 89.823, 'test/acc': 85.316, 'test/acc_unbiased': 85.241, 'test/diff': 8.901, 'test/acc_skew': 80.791, 'test/acc_align': 89.692}
[19 / 20] best valid accuracy: 86.996 at epoch 13 
 best_stats: {'best_valid_epoch': 13, 'best_valid_valid/acc': 87.3, 'best_valid_valid/acc_unbiased': 86.996, 'best_valid_valid/diff': 6.333, 'best_valid_valid/acc_skew': 83.829, 'best_valid_valid/acc_align': 90.162, 'best_valid_test/acc': 85.274, 'best_valid_test/acc_unbiased': 85.107, 'best_valid_test/diff': 6.74, 'best_valid_test/acc_skew': 81.737, 'best_valid_test/acc_align': 88.477}
[19 / 20] best test accuracy: 85.802 at epoch 16 
 best_stats: {'best_test_epoch': 16, 'best_test_valid/acc': 86.371, 'best_test_valid/acc_unbiased': 86.494, 'best_test_valid/diff': 6.144, 'best_test_valid/acc_skew': 83.422, 'best_test_valid/acc_align': 89.566, 'best_test_test/acc': 85.696, 'best_test_test/acc_unbiased': 85.802, 'best_test_test/diff': 7.298, 'best_test_test/acc_skew': 82.153, 'best_test_test/acc_align': 89.451}
[20 / 20] Learning rate: 1e-05 weight: 0.01
[20 / 20] Loss: 4.434753201490531 CE Loss: 0.9159015782771667 Con Loss: 4.425594224520256
[20 / 20] tensor([[0.900, 0.799],
        [0.812, 0.897]]) {'epoch': 20, 'valid/acc': 86.878, 'valid/acc_unbiased': 86.811, 'valid/diff': 6.555, 'valid/acc_skew': 83.534, 'valid/acc_align': 90.089, 'test/acc': 85.316, 'test/acc_unbiased': 85.198, 'test/diff': 9.316, 'test/acc_skew': 80.54, 'test/acc_align': 89.856}
[20 / 20] best valid accuracy: 86.996 at epoch 13 
 best_stats: {'best_valid_epoch': 13, 'best_valid_valid/acc': 87.3, 'best_valid_valid/acc_unbiased': 86.996, 'best_valid_valid/diff': 6.333, 'best_valid_valid/acc_skew': 83.829, 'best_valid_valid/acc_align': 90.162, 'best_valid_test/acc': 85.274, 'best_valid_test/acc_unbiased': 85.107, 'best_valid_test/diff': 6.74, 'best_valid_test/acc_skew': 81.737, 'best_valid_test/acc_align': 88.477}
[20 / 20] best test accuracy: 85.802 at epoch 16 
 best_stats: {'best_test_epoch': 16, 'best_test_valid/acc': 86.371, 'best_test_valid/acc_unbiased': 86.494, 'best_test_valid/diff': 6.144, 'best_test_valid/acc_skew': 83.422, 'best_test_valid/acc_align': 89.566, 'best_test_test/acc': 85.696, 'best_test_test/acc_unbiased': 85.802, 'best_test_test/diff': 7.298, 'best_test_test/acc_skew': 82.153, 'best_test_test/acc_align': 89.451}
Total training time: 1:04:18
