Log level set to: INFO
Set seed: 2
=======> Using Fixed Random Seed: 2 <========
save_path: exp_results/bc-bb0-celeba_blonde-os_0.1-lr0.001-bs128-cbs64-w0.01-ratio30-aug1-seed2
get_celeba - split:train, aug: False, given_y: True, ratio: 0
use existing blonde indices from data/celeba/pickles/blonde
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [5355, 5355]
Target 1: [5355, 5355]
Binary Target 1
---------------------------
Target 0: [5355, 5355]
Target 1: [5355, 5355]
===================================
Normal Label Distribution: 
Target 0: [5355, 5355]
Target 1: [5355, 5355]
===================================
Use BiasedCelebASplit 
 target_attr: blonde split: train 
 tensor([[5355., 5355.],
        [5355., 5355.]])
get_celeba - split:train, aug: 1, given_y: True, ratio: 30
use existing blonde indices from data/celeba/pickles/blonde
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [5347, 5347]
Target 1: [5347, 5347]
Binary Target 1
---------------------------
Target 0: [5347, 5347]
Target 1: [5347, 5347]
===================================
Normal Label Distribution: 
Target 0: [5347, 5347]
Target 1: [5347, 5347]
===================================
Use BiasedCelebASplit 
 target_attr: blonde split: train 
 tensor([[5347., 5347.],
        [5347., 5347.]])
get_celeba - split:train_valid, aug: False, given_y: True, ratio: 0
use existing blonde indices from data/celeba/pickles/blonde
Use BiasedCelebASplit 
 target_attr: blonde split: train_valid 
 tensor([[  403.,  4597.],
        [13344.,   285.]])
get_celeba - split:valid, aug: False, given_y: True, ratio: 0
Use BiasedCelebASplit 
 target_attr: blonde split: valid 
 tensor([[8535., 2874.],
        [8276.,  182.]])
decay_epochs: [3, 6]
[1 / 10] Learning rate: 0.001 weight: 0.01
[1 / 10] Loss: 4.697022391745802 CE Loss: 0.31808777011297884 Con Loss: 4.693841514712066
[1 / 10] tensor([[0.870, 0.892],
        [0.914, 0.901]]) {'epoch': 1, 'valid/acc': 89.291, 'valid/acc_unbiased': 90.108, 'valid/diff': 1.871, 'valid/acc_skew': 91.044, 'valid/acc_align': 89.173, 'test/acc': 88.574, 'test/acc_unbiased': 89.43, 'test/diff': 1.79, 'test/acc_skew': 89.2, 'test/acc_align': 89.66}
[1 / 10] best valid accuracy: 90.108 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 89.291, 'best_valid_valid/acc_unbiased': 90.108, 'best_valid_valid/diff': 1.871, 'best_valid_valid/acc_skew': 91.044, 'best_valid_valid/acc_align': 89.173, 'best_valid_test/acc': 88.574, 'best_valid_test/acc_unbiased': 89.43, 'best_valid_test/diff': 1.79, 'best_valid_test/acc_skew': 89.2, 'best_valid_test/acc_align': 89.66}
[1 / 10] best test accuracy: 89.430 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 89.291, 'best_test_valid/acc_unbiased': 90.108, 'best_test_valid/diff': 1.871, 'best_test_valid/acc_skew': 91.044, 'best_test_valid/acc_align': 89.173, 'best_test_test/acc': 88.574, 'best_test_test/acc_unbiased': 89.43, 'best_test_test/diff': 1.79, 'best_test_test/acc_skew': 89.2, 'best_test_test/acc_align': 89.66}
[2 / 10] Learning rate: 0.001 weight: 0.01
[2 / 10] Loss: 4.644595508058977 CE Loss: 0.25406593101031305 Con Loss: 4.642054848978166
[2 / 10] tensor([[0.957, 0.965],
        [0.764, 0.791]]) {'epoch': 2, 'valid/acc': 90.692, 'valid/acc_unbiased': 85.512, 'valid/diff': 3.014, 'valid/acc_skew': 87.019, 'valid/acc_align': 84.005, 'test/acc': 93.089, 'test/acc_unbiased': 86.926, 'test/diff': 1.753, 'test/acc_skew': 86.049, 'test/acc_align': 87.802}
[2 / 10] best valid accuracy: 90.108 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 89.291, 'best_valid_valid/acc_unbiased': 90.108, 'best_valid_valid/diff': 1.871, 'best_valid_valid/acc_skew': 91.044, 'best_valid_valid/acc_align': 89.173, 'best_valid_test/acc': 88.574, 'best_valid_test/acc_unbiased': 89.43, 'best_valid_test/diff': 1.79, 'best_valid_test/acc_skew': 89.2, 'best_valid_test/acc_align': 89.66}
[2 / 10] best test accuracy: 89.430 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 89.291, 'best_test_valid/acc_unbiased': 90.108, 'best_test_valid/diff': 1.871, 'best_test_valid/acc_skew': 91.044, 'best_test_valid/acc_align': 89.173, 'best_test_test/acc': 88.574, 'best_test_test/acc_unbiased': 89.43, 'best_test_test/diff': 1.79, 'best_test_test/acc_skew': 89.2, 'best_test_test/acc_align': 89.66}
[3 / 10] Learning rate: 0.001 weight: 0.01
[3 / 10] Loss: 4.623155548993279 CE Loss: 0.2488456795612971 Con Loss: 4.620667102735361
[3 / 10] tensor([[0.939, 0.962],
        [0.825, 0.769]]) {'epoch': 3, 'valid/acc': 91.406, 'valid/acc_unbiased': 87.308, 'valid/diff': 2.763, 'valid/acc_skew': 88.69, 'valid/acc_align': 85.926, 'test/acc': 93.094, 'test/acc_unbiased': 87.41, 'test/diff': 3.955, 'test/acc_skew': 88.238, 'test/acc_align': 86.583}
[3 / 10] best valid accuracy: 90.108 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 89.291, 'best_valid_valid/acc_unbiased': 90.108, 'best_valid_valid/diff': 1.871, 'best_valid_valid/acc_skew': 91.044, 'best_valid_valid/acc_align': 89.173, 'best_valid_test/acc': 88.574, 'best_valid_test/acc_unbiased': 89.43, 'best_valid_test/diff': 1.79, 'best_valid_test/acc_skew': 89.2, 'best_valid_test/acc_align': 89.66}
[3 / 10] best test accuracy: 89.430 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 89.291, 'best_test_valid/acc_unbiased': 90.108, 'best_test_valid/diff': 1.871, 'best_test_valid/acc_skew': 91.044, 'best_test_valid/acc_align': 89.173, 'best_test_test/acc': 88.574, 'best_test_test/acc_unbiased': 89.43, 'best_test_test/diff': 1.79, 'best_test_test/acc_skew': 89.2, 'best_test_test/acc_align': 89.66}
[4 / 10] Learning rate: 0.0001 weight: 0.01
[4 / 10] Loss: 4.564079241926263 CE Loss: 0.20569715190445786 Con Loss: 4.562022275060944
[4 / 10] tensor([[0.886, 0.935],
        [0.936, 0.907]]) {'epoch': 4, 'valid/acc': 92.866, 'valid/acc_unbiased': 92.688, 'valid/diff': 2.888, 'valid/acc_skew': 94.132, 'valid/acc_align': 91.244, 'test/acc': 91.347, 'test/acc_unbiased': 91.574, 'test/diff': 3.936, 'test/acc_skew': 91.093, 'test/acc_align': 92.055}
[4 / 10] best valid accuracy: 92.688 at epoch 4 
 best_stats: {'best_valid_epoch': 4, 'best_valid_valid/acc': 92.866, 'best_valid_valid/acc_unbiased': 92.688, 'best_valid_valid/diff': 2.888, 'best_valid_valid/acc_skew': 94.132, 'best_valid_valid/acc_align': 91.244, 'best_valid_test/acc': 91.347, 'best_valid_test/acc_unbiased': 91.574, 'best_valid_test/diff': 3.936, 'best_valid_test/acc_skew': 91.093, 'best_valid_test/acc_align': 92.055}
[4 / 10] best test accuracy: 91.574 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 92.866, 'best_test_valid/acc_unbiased': 92.688, 'best_test_valid/diff': 2.888, 'best_test_valid/acc_skew': 94.132, 'best_test_valid/acc_align': 91.244, 'best_test_test/acc': 91.347, 'best_test_test/acc_unbiased': 91.574, 'best_test_test/diff': 3.936, 'best_test_test/acc_skew': 91.093, 'best_test_test/acc_align': 92.055}
[5 / 10] Learning rate: 0.0001 weight: 0.01
[5 / 10] Loss: 4.552947695293124 CE Loss: 0.191420857061525 Con Loss: 4.551033477711967
[5 / 10] tensor([[0.863, 0.927],
        [0.959, 0.940]]) {'epoch': 5, 'valid/acc': 92.973, 'valid/acc_unbiased': 93.437, 'valid/diff': 1.448, 'valid/acc_skew': 94.161, 'valid/acc_align': 92.714, 'test/acc': 90.401, 'test/acc_unbiased': 92.193, 'test/diff': 4.174, 'test/acc_skew': 91.058, 'test/acc_align': 93.329}
[5 / 10] best valid accuracy: 93.437 at epoch 5 
 best_stats: {'best_valid_epoch': 5, 'best_valid_valid/acc': 92.973, 'best_valid_valid/acc_unbiased': 93.437, 'best_valid_valid/diff': 1.448, 'best_valid_valid/acc_skew': 94.161, 'best_valid_valid/acc_align': 92.714, 'best_valid_test/acc': 90.401, 'best_valid_test/acc_unbiased': 92.193, 'best_valid_test/diff': 4.174, 'best_valid_test/acc_skew': 91.058, 'best_valid_test/acc_align': 93.329}
[5 / 10] best test accuracy: 92.193 at epoch 5 
 best_stats: {'best_test_epoch': 5, 'best_test_valid/acc': 92.973, 'best_test_valid/acc_unbiased': 93.437, 'best_test_valid/diff': 1.448, 'best_test_valid/acc_skew': 94.161, 'best_test_valid/acc_align': 92.714, 'best_test_test/acc': 90.401, 'best_test_test/acc_unbiased': 92.193, 'best_test_test/diff': 4.174, 'best_test_test/acc_skew': 91.058, 'best_test_test/acc_align': 93.329}
[6 / 10] Learning rate: 0.0001 weight: 0.01
[6 / 10] Loss: 4.519727919192986 CE Loss: 0.1875289879036662 Con Loss: 4.517852630312481
[6 / 10] tensor([[0.852, 0.926],
        [0.960, 0.923]]) {'epoch': 6, 'valid/acc': 93.059, 'valid/acc_unbiased': 93.032, 'valid/diff': 1.936, 'valid/acc_skew': 94.0, 'valid/acc_align': 92.064, 'test/acc': 89.908, 'test/acc_unbiased': 91.531, 'test/diff': 5.588, 'test/acc_skew': 90.6, 'test/acc_align': 92.462}
[6 / 10] best valid accuracy: 93.437 at epoch 5 
 best_stats: {'best_valid_epoch': 5, 'best_valid_valid/acc': 92.973, 'best_valid_valid/acc_unbiased': 93.437, 'best_valid_valid/diff': 1.448, 'best_valid_valid/acc_skew': 94.161, 'best_valid_valid/acc_align': 92.714, 'best_valid_test/acc': 90.401, 'best_valid_test/acc_unbiased': 92.193, 'best_valid_test/diff': 4.174, 'best_valid_test/acc_skew': 91.058, 'best_valid_test/acc_align': 93.329}
[6 / 10] best test accuracy: 92.193 at epoch 5 
 best_stats: {'best_test_epoch': 5, 'best_test_valid/acc': 92.973, 'best_test_valid/acc_unbiased': 93.437, 'best_test_valid/diff': 1.448, 'best_test_valid/acc_skew': 94.161, 'best_test_valid/acc_align': 92.714, 'best_test_test/acc': 90.401, 'best_test_test/acc_unbiased': 92.193, 'best_test_test/diff': 4.174, 'best_test_test/acc_skew': 91.058, 'best_test_test/acc_align': 93.329}
[7 / 10] Learning rate: 1e-05 weight: 0.01
[7 / 10] Loss: 4.533657951604307 CE Loss: 0.18737452324587647 Con Loss: 4.5317842328581825
[7 / 10] tensor([[0.861, 0.932],
        [0.957, 0.901]]) {'epoch': 7, 'valid/acc': 93.263, 'valid/acc_unbiased': 93.401, 'valid/diff': 2.016, 'valid/acc_skew': 94.41, 'valid/acc_align': 92.393, 'test/acc': 90.462, 'test/acc_unbiased': 91.257, 'test/diff': 6.311, 'test/acc_skew': 90.872, 'test/acc_align': 91.641}
[7 / 10] best valid accuracy: 93.437 at epoch 5 
 best_stats: {'best_valid_epoch': 5, 'best_valid_valid/acc': 92.973, 'best_valid_valid/acc_unbiased': 93.437, 'best_valid_valid/diff': 1.448, 'best_valid_valid/acc_skew': 94.161, 'best_valid_valid/acc_align': 92.714, 'best_valid_test/acc': 90.401, 'best_valid_test/acc_unbiased': 92.193, 'best_valid_test/diff': 4.174, 'best_valid_test/acc_skew': 91.058, 'best_valid_test/acc_align': 93.329}
[7 / 10] best test accuracy: 92.193 at epoch 5 
 best_stats: {'best_test_epoch': 5, 'best_test_valid/acc': 92.973, 'best_test_valid/acc_unbiased': 93.437, 'best_test_valid/diff': 1.448, 'best_test_valid/acc_skew': 94.161, 'best_test_valid/acc_align': 92.714, 'best_test_test/acc': 90.401, 'best_test_test/acc_unbiased': 92.193, 'best_test_test/diff': 4.174, 'best_test_test/acc_skew': 91.058, 'best_test_test/acc_align': 93.329}
[8 / 10] Learning rate: 1e-05 weight: 0.01
[8 / 10] Loss: 4.514255330364466 CE Loss: 0.1802442771018275 Con Loss: 4.512452900242739
[8 / 10] tensor([[0.863, 0.937],
        [0.958, 0.901]]) {'epoch': 8, 'valid/acc': 93.693, 'valid/acc_unbiased': 93.86, 'valid/diff': 2.104, 'valid/acc_skew': 94.912, 'valid/acc_align': 92.809, 'test/acc': 90.784, 'test/acc_unbiased': 91.471, 'test/diff': 6.54, 'test/acc_skew': 91.041, 'test/acc_align': 91.901}
[8 / 10] best valid accuracy: 93.860 at epoch 8 
 best_stats: {'best_valid_epoch': 8, 'best_valid_valid/acc': 93.693, 'best_valid_valid/acc_unbiased': 93.86, 'best_valid_valid/diff': 2.104, 'best_valid_valid/acc_skew': 94.912, 'best_valid_valid/acc_align': 92.809, 'best_valid_test/acc': 90.784, 'best_valid_test/acc_unbiased': 91.471, 'best_valid_test/diff': 6.54, 'best_valid_test/acc_skew': 91.041, 'best_valid_test/acc_align': 91.901}
[8 / 10] best test accuracy: 92.193 at epoch 5 
 best_stats: {'best_test_epoch': 5, 'best_test_valid/acc': 92.973, 'best_test_valid/acc_unbiased': 93.437, 'best_test_valid/diff': 1.448, 'best_test_valid/acc_skew': 94.161, 'best_test_valid/acc_align': 92.714, 'best_test_test/acc': 90.401, 'best_test_test/acc_unbiased': 92.193, 'best_test_test/diff': 4.174, 'best_test_test/acc_skew': 91.058, 'best_test_test/acc_align': 93.329}
[9 / 10] Learning rate: 1e-05 weight: 0.01
[9 / 10] Loss: 4.499997745731187 CE Loss: 0.17799465792770144 Con Loss: 4.498217799438705
[9 / 10] tensor([[0.869, 0.932],
        [0.961, 0.907]]) {'epoch': 9, 'valid/acc': 93.446, 'valid/acc_unbiased': 93.907, 'valid/diff': 1.772, 'valid/acc_skew': 94.793, 'valid/acc_align': 93.021, 'test/acc': 90.884, 'test/acc_unbiased': 91.712, 'test/diff': 5.888, 'test/acc_skew': 91.49, 'test/acc_align': 91.934}
[9 / 10] best valid accuracy: 93.907 at epoch 9 
 best_stats: {'best_valid_epoch': 9, 'best_valid_valid/acc': 93.446, 'best_valid_valid/acc_unbiased': 93.907, 'best_valid_valid/diff': 1.772, 'best_valid_valid/acc_skew': 94.793, 'best_valid_valid/acc_align': 93.021, 'best_valid_test/acc': 90.884, 'best_valid_test/acc_unbiased': 91.712, 'best_valid_test/diff': 5.888, 'best_valid_test/acc_skew': 91.49, 'best_valid_test/acc_align': 91.934}
[9 / 10] best test accuracy: 92.193 at epoch 5 
 best_stats: {'best_test_epoch': 5, 'best_test_valid/acc': 92.973, 'best_test_valid/acc_unbiased': 93.437, 'best_test_valid/diff': 1.448, 'best_test_valid/acc_skew': 94.161, 'best_test_valid/acc_align': 92.714, 'best_test_test/acc': 90.401, 'best_test_test/acc_unbiased': 92.193, 'best_test_test/diff': 4.174, 'best_test_test/acc_skew': 91.058, 'best_test_test/acc_align': 93.329}
[10 / 10] Learning rate: 1e-05 weight: 0.01
[10 / 10] Loss: 4.504430879865374 CE Loss: 0.17883520466940744 Con Loss: 4.502642547828254
[10 / 10] tensor([[0.861, 0.937],
        [0.959, 0.901]]) {'epoch': 10, 'valid/acc': 93.703, 'valid/acc_unbiased': 94.127, 'valid/diff': 2.293, 'valid/acc_skew': 95.274, 'valid/acc_align': 92.98, 'test/acc': 90.743, 'test/acc_unbiased': 91.471, 'test/diff': 6.692, 'test/acc_skew': 91.034, 'test/acc_align': 91.907}
[10 / 10] best valid accuracy: 94.127 at epoch 10 
 best_stats: {'best_valid_epoch': 10, 'best_valid_valid/acc': 93.703, 'best_valid_valid/acc_unbiased': 94.127, 'best_valid_valid/diff': 2.293, 'best_valid_valid/acc_skew': 95.274, 'best_valid_valid/acc_align': 92.98, 'best_valid_test/acc': 90.743, 'best_valid_test/acc_unbiased': 91.471, 'best_valid_test/diff': 6.692, 'best_valid_test/acc_skew': 91.034, 'best_valid_test/acc_align': 91.907}
[10 / 10] best test accuracy: 92.193 at epoch 5 
 best_stats: {'best_test_epoch': 5, 'best_test_valid/acc': 92.973, 'best_test_valid/acc_unbiased': 93.437, 'best_test_valid/diff': 1.448, 'best_test_valid/acc_skew': 94.161, 'best_test_valid/acc_align': 92.714, 'best_test_test/acc': 90.401, 'best_test_test/acc_unbiased': 92.193, 'best_test_test/diff': 4.174, 'best_test_test/acc_skew': 91.058, 'best_test_test/acc_align': 93.329}
Total training time: 0:24:37
