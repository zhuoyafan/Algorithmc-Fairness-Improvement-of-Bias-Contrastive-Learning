Log level set to: INFO
Set seed: 2
=======> Using Fixed Random Seed: 2 <========
save_path: exp_results/bc-bb0-utk_face_race-test-0.5-lr0.001-bs128-cbs64-w0.01-ratio10-aug1-seed2
get_utk_face - split: train, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_race-0.5
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [4407, 2764]
Target 1: [2203, 5529]
Binary Target 1
---------------------------
Target 0: [4407, 2764]
Target 1: [2203, 5529]
===================================
Normal Label Distribution: 
Target 0: [4407, 2764]
Target 1: [2203, 5529]
===================================
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [4407, 2764]
Target 1: [2203, 5529]
Binary Target 1
---------------------------
Target 0: [4407, 2764]
Target 1: [2203, 5529]
===================================
Normal Label Distribution: 
Target 0: [4407, 2764]
Target 1: [2203, 5529]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 14903, target_attr: gender, bias_attr: race bias_rate: 0.5
['[train] target_0-bias_0: 4407', '[train] target_0-bias_1: 2764', '[train] target_1-bias_0: 2203', '[train] target_1-bias_1: 5529']
confusion_matrix - 
 original: tensor([[4407., 2203.],
        [2764., 5529.]]), 
 normalized: tensor([[0.667, 0.333],
        [0.333, 0.667]]), 
 b|y: tensor([[0.615, 0.385],
        [0.285, 0.715]])
get_utk_face - split: train, aug: 1, given_y: True, ratio: 10
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_race-0.5
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [4407, 2764]
Target 1: [2203, 5529]
Binary Target 1
---------------------------
Target 0: [4407, 2764]
Target 1: [2203, 5529]
===================================
Normal Label Distribution: 
Target 0: [4407, 2764]
Target 1: [2203, 5529]
===================================
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [4407, 2764]
Target 1: [2203, 5529]
Binary Target 1
---------------------------
Target 0: [4407, 2764]
Target 1: [2203, 5529]
===================================
Normal Label Distribution: 
Target 0: [4407, 2764]
Target 1: [2203, 5529]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 14903, target_attr: gender, bias_attr: race bias_rate: 0.5
['[train] target_0-bias_0: 4407', '[train] target_0-bias_1: 2764', '[train] target_1-bias_0: 2203', '[train] target_1-bias_1: 5529']
get_utk_face - split: valid, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_race-0.5
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [583, 684]
Target 1: [457, 646]
Binary Target 1
---------------------------
Target 0: [583, 684]
Target 1: [457, 646]
===================================
Normal Label Distribution: 
Target 0: [583, 684]
Target 1: [457, 646]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 2370, target_attr: gender, bias_attr: race bias_rate: 0.5
['[valid] target_0-bias_0: 583', '[valid] target_0-bias_1: 684', '[valid] target_1-bias_0: 457', '[valid] target_1-bias_1: 646']
get_utk_face - split: test, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_race-0.5
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [558, 677]
Target 1: [462, 673]
Binary Target 1
---------------------------
Target 0: [558, 677]
Target 1: [462, 673]
===================================
Normal Label Distribution: 
Target 0: [558, 677]
Target 1: [462, 673]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 2370, target_attr: gender, bias_attr: race bias_rate: 0.5
['[test] target_0-bias_0: 558', '[test] target_0-bias_1: 677', '[test] target_1-bias_0: 462', '[test] target_1-bias_1: 673']
decay_epochs: [6, 13]
[1 / 20] Learning rate: 0.001 weight: 0.01
[1 / 20] Loss: 4.875812368809533 CE Loss: 0.5729614538985803 Con Loss: 4.870082739846847
[1 / 20] tensor([[0.916, 0.894],
        [0.716, 0.710]]) {'epoch': 1, 'valid/acc': 80.717, 'valid/acc_unbiased': 80.162, 'valid/diff': 3.844, 'valid/acc_skew': 82.084, 'valid/acc_align': 78.241, 'test/acc': 81.224, 'test/acc_unbiased': 80.903, 'test/diff': 1.416, 'test/acc_skew': 80.505, 'test/acc_align': 81.301}
[1 / 20] best valid accuracy: 80.162 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 80.717, 'best_valid_valid/acc_unbiased': 80.162, 'best_valid_valid/diff': 3.844, 'best_valid_valid/acc_skew': 82.084, 'best_valid_valid/acc_align': 78.241, 'best_valid_test/acc': 81.224, 'best_valid_test/acc_unbiased': 80.903, 'best_valid_test/diff': 1.416, 'best_valid_test/acc_skew': 80.505, 'best_valid_test/acc_align': 81.301}
[1 / 20] best test accuracy: 80.903 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 80.717, 'best_test_valid/acc_unbiased': 80.162, 'best_test_valid/diff': 3.844, 'best_test_valid/acc_skew': 82.084, 'best_test_valid/acc_align': 78.241, 'best_test_test/acc': 81.224, 'best_test_test/acc_unbiased': 80.903, 'best_test_test/diff': 1.416, 'best_test_test/acc_skew': 80.505, 'best_test_test/acc_align': 81.301}
[2 / 20] Learning rate: 0.001 weight: 0.01
[2 / 20] Loss: 4.769896597684026 CE Loss: 0.4640351795677466 Con Loss: 4.765256248703981
[2 / 20] tensor([[0.658, 0.595],
        [0.931, 0.949]]) {'epoch': 2, 'valid/acc': 76.793, 'valid/acc_unbiased': 78.024, 'valid/diff': 2.118, 'valid/acc_skew': 77.016, 'valid/acc_align': 79.032, 'test/acc': 77.595, 'test/acc_unbiased': 78.33, 'test/diff': 4.059, 'test/acc_skew': 76.3, 'test/acc_align': 80.359}
[2 / 20] best valid accuracy: 80.162 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 80.717, 'best_valid_valid/acc_unbiased': 80.162, 'best_valid_valid/diff': 3.844, 'best_valid_valid/acc_skew': 82.084, 'best_valid_valid/acc_align': 78.241, 'best_valid_test/acc': 81.224, 'best_valid_test/acc_unbiased': 80.903, 'best_valid_test/diff': 1.416, 'best_valid_test/acc_skew': 80.505, 'best_valid_test/acc_align': 81.301}
[2 / 20] best test accuracy: 80.903 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 80.717, 'best_test_valid/acc_unbiased': 80.162, 'best_test_valid/diff': 3.844, 'best_test_valid/acc_skew': 82.084, 'best_test_valid/acc_align': 78.241, 'best_test_test/acc': 81.224, 'best_test_test/acc_unbiased': 80.903, 'best_test_test/diff': 1.416, 'best_test_test/acc_skew': 80.505, 'best_test_test/acc_align': 81.301}
[3 / 20] Learning rate: 0.001 weight: 0.01
[3 / 20] Loss: 4.745511780951093 CE Loss: 0.42775312055879444 Con Loss: 4.741234266781162
[3 / 20] tensor([[0.875, 0.857],
        [0.827, 0.816]]) {'epoch': 3, 'valid/acc': 84.768, 'valid/acc_unbiased': 84.785, 'valid/diff': 3.945, 'valid/acc_skew': 85.398, 'valid/acc_align': 84.173, 'test/acc': 84.346, 'test/acc_unbiased': 84.347, 'test/diff': 1.446, 'test/acc_skew': 84.178, 'test/acc_align': 84.515}
[3 / 20] best valid accuracy: 84.785 at epoch 3 
 best_stats: {'best_valid_epoch': 3, 'best_valid_valid/acc': 84.768, 'best_valid_valid/acc_unbiased': 84.785, 'best_valid_valid/diff': 3.945, 'best_valid_valid/acc_skew': 85.398, 'best_valid_valid/acc_align': 84.173, 'best_valid_test/acc': 84.346, 'best_valid_test/acc_unbiased': 84.347, 'best_valid_test/diff': 1.446, 'best_valid_test/acc_skew': 84.178, 'best_valid_test/acc_align': 84.515}
[3 / 20] best test accuracy: 84.347 at epoch 3 
 best_stats: {'best_test_epoch': 3, 'best_test_valid/acc': 84.768, 'best_test_valid/acc_unbiased': 84.785, 'best_test_valid/diff': 3.945, 'best_test_valid/acc_skew': 85.398, 'best_test_valid/acc_align': 84.173, 'best_test_test/acc': 84.346, 'best_test_test/acc_unbiased': 84.347, 'best_test_test/diff': 1.446, 'best_test_test/acc_skew': 84.178, 'best_test_test/acc_align': 84.515}
[4 / 20] Learning rate: 0.001 weight: 0.01
[4 / 20] Loss: 4.728049270612221 CE Loss: 0.406220902500637 Con Loss: 4.723987067248896
[4 / 20] tensor([[0.948, 0.941],
        [0.699, 0.701]]) {'epoch': 4, 'valid/acc': 82.236, 'valid/acc_unbiased': 81.589, 'valid/diff': 3.993, 'valid/acc_skew': 82.488, 'valid/acc_align': 80.69, 'test/acc': 82.743, 'test/acc_unbiased': 82.235, 'test/diff': 0.466, 'test/acc_skew': 82.002, 'test/acc_align': 82.468}
[4 / 20] best valid accuracy: 84.785 at epoch 3 
 best_stats: {'best_valid_epoch': 3, 'best_valid_valid/acc': 84.768, 'best_valid_valid/acc_unbiased': 84.785, 'best_valid_valid/diff': 3.945, 'best_valid_valid/acc_skew': 85.398, 'best_valid_valid/acc_align': 84.173, 'best_valid_test/acc': 84.346, 'best_valid_test/acc_unbiased': 84.347, 'best_valid_test/diff': 1.446, 'best_valid_test/acc_skew': 84.178, 'best_valid_test/acc_align': 84.515}
[4 / 20] best test accuracy: 84.347 at epoch 3 
 best_stats: {'best_test_epoch': 3, 'best_test_valid/acc': 84.768, 'best_test_valid/acc_unbiased': 84.785, 'best_test_valid/diff': 3.945, 'best_test_valid/acc_skew': 85.398, 'best_test_valid/acc_align': 84.173, 'best_test_test/acc': 84.346, 'best_test_test/acc_unbiased': 84.347, 'best_test_test/diff': 1.446, 'best_test_test/acc_skew': 84.178, 'best_test_test/acc_align': 84.515}
[5 / 20] Learning rate: 0.001 weight: 0.01
[5 / 20] Loss: 4.713609411085659 CE Loss: 0.39864174994351775 Con Loss: 4.709622980963902
[5 / 20] tensor([[0.799, 0.765],
        [0.916, 0.917]]) {'epoch': 5, 'valid/acc': 84.81, 'valid/acc_unbiased': 85.449, 'valid/diff': 3.621, 'valid/acc_skew': 85.278, 'valid/acc_align': 85.621, 'test/acc': 84.557, 'test/acc_unbiased': 84.92, 'test/diff': 1.767, 'test/acc_skew': 84.036, 'test/acc_align': 85.804}
[5 / 20] best valid accuracy: 85.449 at epoch 5 
 best_stats: {'best_valid_epoch': 5, 'best_valid_valid/acc': 84.81, 'best_valid_valid/acc_unbiased': 85.449, 'best_valid_valid/diff': 3.621, 'best_valid_valid/acc_skew': 85.278, 'best_valid_valid/acc_align': 85.621, 'best_valid_test/acc': 84.557, 'best_valid_test/acc_unbiased': 84.92, 'best_valid_test/diff': 1.767, 'best_valid_test/acc_skew': 84.036, 'best_valid_test/acc_align': 85.804}
[5 / 20] best test accuracy: 84.920 at epoch 5 
 best_stats: {'best_test_epoch': 5, 'best_test_valid/acc': 84.81, 'best_test_valid/acc_unbiased': 85.449, 'best_test_valid/diff': 3.621, 'best_test_valid/acc_skew': 85.278, 'best_test_valid/acc_align': 85.621, 'best_test_test/acc': 84.557, 'best_test_test/acc_unbiased': 84.92, 'best_test_test/diff': 1.767, 'best_test_test/acc_skew': 84.036, 'best_test_test/acc_align': 85.804}
[6 / 20] Learning rate: 0.001 weight: 0.01
[6 / 20] Loss: 4.7062014884887295 CE Loss: 0.39363573395885143 Con Loss: 4.702265137851154
[6 / 20] tensor([[0.787, 0.773],
        [0.905, 0.921]]) {'epoch': 6, 'valid/acc': 84.219, 'valid/acc_unbiased': 84.873, 'valid/diff': 3.277, 'valid/acc_skew': 85.68, 'valid/acc_align': 84.067, 'test/acc': 84.388, 'test/acc_unbiased': 84.632, 'test/diff': 1.535, 'test/acc_skew': 83.864, 'test/acc_align': 85.399}
[6 / 20] best valid accuracy: 85.449 at epoch 5 
 best_stats: {'best_valid_epoch': 5, 'best_valid_valid/acc': 84.81, 'best_valid_valid/acc_unbiased': 85.449, 'best_valid_valid/diff': 3.621, 'best_valid_valid/acc_skew': 85.278, 'best_valid_valid/acc_align': 85.621, 'best_valid_test/acc': 84.557, 'best_valid_test/acc_unbiased': 84.92, 'best_valid_test/diff': 1.767, 'best_valid_test/acc_skew': 84.036, 'best_valid_test/acc_align': 85.804}
[6 / 20] best test accuracy: 84.920 at epoch 5 
 best_stats: {'best_test_epoch': 5, 'best_test_valid/acc': 84.81, 'best_test_valid/acc_unbiased': 85.449, 'best_test_valid/diff': 3.621, 'best_test_valid/acc_skew': 85.278, 'best_test_valid/acc_align': 85.621, 'best_test_test/acc': 84.557, 'best_test_test/acc_unbiased': 84.92, 'best_test_test/diff': 1.767, 'best_test_test/acc_skew': 84.036, 'best_test_test/acc_align': 85.804}
[7 / 20] Learning rate: 0.0001 weight: 0.01
[7 / 20] Loss: 4.648598005313613 CE Loss: 0.34256654169098255 Con Loss: 4.645172348712296
[7 / 20] tensor([[0.848, 0.824],
        [0.877, 0.892]]) {'epoch': 7, 'valid/acc': 87.004, 'valid/acc_unbiased': 87.334, 'valid/diff': 2.686, 'valid/acc_skew': 87.729, 'valid/acc_align': 86.939, 'test/acc': 85.907, 'test/acc_unbiased': 86.001, 'test/diff': 1.918, 'test/acc_skew': 85.042, 'test/acc_align': 86.96}
[7 / 20] best valid accuracy: 87.334 at epoch 7 
 best_stats: {'best_valid_epoch': 7, 'best_valid_valid/acc': 87.004, 'best_valid_valid/acc_unbiased': 87.334, 'best_valid_valid/diff': 2.686, 'best_valid_valid/acc_skew': 87.729, 'best_valid_valid/acc_align': 86.939, 'best_valid_test/acc': 85.907, 'best_valid_test/acc_unbiased': 86.001, 'best_valid_test/diff': 1.918, 'best_valid_test/acc_skew': 85.042, 'best_valid_test/acc_align': 86.96}
[7 / 20] best test accuracy: 86.001 at epoch 7 
 best_stats: {'best_test_epoch': 7, 'best_test_valid/acc': 87.004, 'best_test_valid/acc_unbiased': 87.334, 'best_test_valid/diff': 2.686, 'best_test_valid/acc_skew': 87.729, 'best_test_valid/acc_align': 86.939, 'best_test_test/acc': 85.907, 'best_test_test/acc_unbiased': 86.001, 'best_test_test/diff': 1.918, 'best_test_test/acc_skew': 85.042, 'best_test_test/acc_align': 86.96}
[8 / 20] Learning rate: 0.0001 weight: 0.01
[8 / 20] Loss: 4.635412306127424 CE Loss: 0.3238278205667671 Con Loss: 4.632174040226059
[8 / 20] tensor([[0.855, 0.814],
        [0.885, 0.903]]) {'epoch': 8, 'valid/acc': 87.468, 'valid/acc_unbiased': 87.875, 'valid/diff': 3.089, 'valid/acc_skew': 87.874, 'valid/acc_align': 87.876, 'test/acc': 86.287, 'test/acc_unbiased': 86.436, 'test/diff': 2.955, 'test/acc_skew': 84.958, 'test/acc_align': 87.913}
[8 / 20] best valid accuracy: 87.875 at epoch 8 
 best_stats: {'best_valid_epoch': 8, 'best_valid_valid/acc': 87.468, 'best_valid_valid/acc_unbiased': 87.875, 'best_valid_valid/diff': 3.089, 'best_valid_valid/acc_skew': 87.874, 'best_valid_valid/acc_align': 87.876, 'best_valid_test/acc': 86.287, 'best_valid_test/acc_unbiased': 86.436, 'best_valid_test/diff': 2.955, 'best_valid_test/acc_skew': 84.958, 'best_valid_test/acc_align': 87.913}
[8 / 20] best test accuracy: 86.436 at epoch 8 
 best_stats: {'best_test_epoch': 8, 'best_test_valid/acc': 87.468, 'best_test_valid/acc_unbiased': 87.875, 'best_test_valid/diff': 3.089, 'best_test_valid/acc_skew': 87.874, 'best_test_valid/acc_align': 87.876, 'best_test_test/acc': 86.287, 'best_test_test/acc_unbiased': 86.436, 'best_test_test/diff': 2.955, 'best_test_test/acc_skew': 84.958, 'best_test_test/acc_align': 87.913}
[9 / 20] Learning rate: 0.0001 weight: 0.01
[9 / 20] Loss: 4.632067500925029 CE Loss: 0.3186876085499169 Con Loss: 4.628880635336855
[9 / 20] tensor([[0.876, 0.846],
        [0.868, 0.886]]) {'epoch': 9, 'valid/acc': 88.017, 'valid/acc_unbiased': 88.196, 'valid/diff': 2.69, 'valid/acc_skew': 88.133, 'valid/acc_align': 88.259, 'test/acc': 86.878, 'test/acc_unbiased': 86.907, 'test/diff': 2.379, 'test/acc_skew': 85.717, 'test/acc_align': 88.097}
[9 / 20] best valid accuracy: 88.196 at epoch 9 
 best_stats: {'best_valid_epoch': 9, 'best_valid_valid/acc': 88.017, 'best_valid_valid/acc_unbiased': 88.196, 'best_valid_valid/diff': 2.69, 'best_valid_valid/acc_skew': 88.133, 'best_valid_valid/acc_align': 88.259, 'best_valid_test/acc': 86.878, 'best_valid_test/acc_unbiased': 86.907, 'best_valid_test/diff': 2.379, 'best_valid_test/acc_skew': 85.717, 'best_valid_test/acc_align': 88.097}
[9 / 20] best test accuracy: 86.907 at epoch 9 
 best_stats: {'best_test_epoch': 9, 'best_test_valid/acc': 88.017, 'best_test_valid/acc_unbiased': 88.196, 'best_test_valid/diff': 2.69, 'best_test_valid/acc_skew': 88.133, 'best_test_valid/acc_align': 88.259, 'best_test_test/acc': 86.878, 'best_test_test/acc_unbiased': 86.907, 'best_test_test/diff': 2.379, 'best_test_test/acc_skew': 85.717, 'best_test_test/acc_align': 88.097}
[10 / 20] Learning rate: 0.0001 weight: 0.01
[10 / 20] Loss: 4.62294838139413 CE Loss: 0.31241342519734727 Con Loss: 4.619824255775831
[10 / 20] tensor([[0.867, 0.839],
        [0.881, 0.897]]) {'epoch': 10, 'valid/acc': 87.932, 'valid/acc_unbiased': 88.26, 'valid/diff': 3.205, 'valid/acc_skew': 88.569, 'valid/acc_align': 87.951, 'test/acc': 87.046, 'test/acc_unbiased': 87.12, 'test/diff': 2.245, 'test/acc_skew': 85.997, 'test/acc_align': 88.243}
[10 / 20] best valid accuracy: 88.260 at epoch 10 
 best_stats: {'best_valid_epoch': 10, 'best_valid_valid/acc': 87.932, 'best_valid_valid/acc_unbiased': 88.26, 'best_valid_valid/diff': 3.205, 'best_valid_valid/acc_skew': 88.569, 'best_valid_valid/acc_align': 87.951, 'best_valid_test/acc': 87.046, 'best_valid_test/acc_unbiased': 87.12, 'best_valid_test/diff': 2.245, 'best_valid_test/acc_skew': 85.997, 'best_valid_test/acc_align': 88.243}
[10 / 20] best test accuracy: 87.120 at epoch 10 
 best_stats: {'best_test_epoch': 10, 'best_test_valid/acc': 87.932, 'best_test_valid/acc_unbiased': 88.26, 'best_test_valid/diff': 3.205, 'best_test_valid/acc_skew': 88.569, 'best_test_valid/acc_align': 87.951, 'best_test_test/acc': 87.046, 'best_test_test/acc_unbiased': 87.12, 'best_test_test/diff': 2.245, 'best_test_test/acc_skew': 85.997, 'best_test_test/acc_align': 88.243}
[11 / 20] Learning rate: 0.0001 weight: 0.01
[11 / 20] Loss: 4.612179643570445 CE Loss: 0.3119332277877998 Con Loss: 4.609060312560491
[11 / 20] tensor([[0.871, 0.833],
        [0.894, 0.908]]) {'epoch': 11, 'valid/acc': 88.903, 'valid/acc_unbiased': 89.269, 'valid/diff': 2.548, 'valid/acc_skew': 88.969, 'valid/acc_align': 89.568, 'test/acc': 87.511, 'test/acc_unbiased': 87.647, 'test/diff': 2.591, 'test/acc_skew': 86.351, 'test/acc_align': 88.942}
[11 / 20] best valid accuracy: 89.269 at epoch 11 
 best_stats: {'best_valid_epoch': 11, 'best_valid_valid/acc': 88.903, 'best_valid_valid/acc_unbiased': 89.269, 'best_valid_valid/diff': 2.548, 'best_valid_valid/acc_skew': 88.969, 'best_valid_valid/acc_align': 89.568, 'best_valid_test/acc': 87.511, 'best_valid_test/acc_unbiased': 87.647, 'best_valid_test/diff': 2.591, 'best_valid_test/acc_skew': 86.351, 'best_valid_test/acc_align': 88.942}
[11 / 20] best test accuracy: 87.647 at epoch 11 
 best_stats: {'best_test_epoch': 11, 'best_test_valid/acc': 88.903, 'best_test_valid/acc_unbiased': 89.269, 'best_test_valid/diff': 2.548, 'best_test_valid/acc_skew': 88.969, 'best_test_valid/acc_align': 89.568, 'best_test_test/acc': 87.511, 'best_test_test/acc_unbiased': 87.647, 'best_test_test/diff': 2.591, 'best_test_test/acc_skew': 86.351, 'best_test_test/acc_align': 88.942}
[12 / 20] Learning rate: 0.0001 weight: 0.01
[12 / 20] Loss: 4.622582094178043 CE Loss: 0.30951595560465134 Con Loss: 4.6194869319936505
[12 / 20] tensor([[0.875, 0.836],
        [0.896, 0.899]]) {'epoch': 12, 'valid/acc': 88.776, 'valid/acc_unbiased': 89.207, 'valid/diff': 3.328, 'valid/acc_skew': 89.078, 'valid/acc_align': 89.336, 'test/acc': 87.468, 'test/acc_unbiased': 87.641, 'test/diff': 2.068, 'test/acc_skew': 86.607, 'test/acc_align': 88.676}
[12 / 20] best valid accuracy: 89.269 at epoch 11 
 best_stats: {'best_valid_epoch': 11, 'best_valid_valid/acc': 88.903, 'best_valid_valid/acc_unbiased': 89.269, 'best_valid_valid/diff': 2.548, 'best_valid_valid/acc_skew': 88.969, 'best_valid_valid/acc_align': 89.568, 'best_valid_test/acc': 87.511, 'best_valid_test/acc_unbiased': 87.647, 'best_valid_test/diff': 2.591, 'best_valid_test/acc_skew': 86.351, 'best_valid_test/acc_align': 88.942}
[12 / 20] best test accuracy: 87.647 at epoch 11 
 best_stats: {'best_test_epoch': 11, 'best_test_valid/acc': 88.903, 'best_test_valid/acc_unbiased': 89.269, 'best_test_valid/diff': 2.548, 'best_test_valid/acc_skew': 88.969, 'best_test_valid/acc_align': 89.568, 'best_test_test/acc': 87.511, 'best_test_test/acc_unbiased': 87.647, 'best_test_test/diff': 2.591, 'best_test_test/acc_skew': 86.351, 'best_test_test/acc_align': 88.942}
[13 / 20] Learning rate: 0.0001 weight: 0.01
[13 / 20] Loss: 4.6093214859316465 CE Loss: 0.29981013833536585 Con Loss: 4.606323396856414
[13 / 20] tensor([[0.885, 0.858],
        [0.870, 0.893]]) {'epoch': 13, 'valid/acc': 88.819, 'valid/acc_unbiased': 89.057, 'valid/diff': 2.203, 'valid/acc_skew': 88.642, 'valid/acc_align': 89.472, 'test/acc': 87.679, 'test/acc_unbiased': 87.666, 'test/diff': 2.5, 'test/acc_skew': 86.416, 'test/acc_align': 88.916}
[13 / 20] best valid accuracy: 89.269 at epoch 11 
 best_stats: {'best_valid_epoch': 11, 'best_valid_valid/acc': 88.903, 'best_valid_valid/acc_unbiased': 89.269, 'best_valid_valid/diff': 2.548, 'best_valid_valid/acc_skew': 88.969, 'best_valid_valid/acc_align': 89.568, 'best_valid_test/acc': 87.511, 'best_valid_test/acc_unbiased': 87.647, 'best_valid_test/diff': 2.591, 'best_valid_test/acc_skew': 86.351, 'best_valid_test/acc_align': 88.942}
[13 / 20] best test accuracy: 87.666 at epoch 13 
 best_stats: {'best_test_epoch': 13, 'best_test_valid/acc': 88.819, 'best_test_valid/acc_unbiased': 89.057, 'best_test_valid/diff': 2.203, 'best_test_valid/acc_skew': 88.642, 'best_test_valid/acc_align': 89.472, 'best_test_test/acc': 87.679, 'best_test_test/acc_unbiased': 87.666, 'best_test_test/diff': 2.5, 'best_test_test/acc_skew': 86.416, 'best_test_test/acc_align': 88.916}
[14 / 20] Learning rate: 1e-05 weight: 0.01
[14 / 20] Loss: 4.601669976721352 CE Loss: 0.2976984598888916 Con Loss: 4.598693002704517
[14 / 20] tensor([[0.882, 0.849],
        [0.879, 0.903]]) {'epoch': 14, 'valid/acc': 88.903, 'valid/acc_unbiased': 89.164, 'valid/diff': 2.254, 'valid/acc_skew': 88.788, 'valid/acc_align': 89.541, 'test/acc': 87.806, 'test/acc_unbiased': 87.832, 'test/diff': 2.851, 'test/acc_skew': 86.406, 'test/acc_align': 89.257}
[14 / 20] best valid accuracy: 89.269 at epoch 11 
 best_stats: {'best_valid_epoch': 11, 'best_valid_valid/acc': 88.903, 'best_valid_valid/acc_unbiased': 89.269, 'best_valid_valid/diff': 2.548, 'best_valid_valid/acc_skew': 88.969, 'best_valid_valid/acc_align': 89.568, 'best_valid_test/acc': 87.511, 'best_valid_test/acc_unbiased': 87.647, 'best_valid_test/diff': 2.591, 'best_valid_test/acc_skew': 86.351, 'best_valid_test/acc_align': 88.942}
[14 / 20] best test accuracy: 87.832 at epoch 14 
 best_stats: {'best_test_epoch': 14, 'best_test_valid/acc': 88.903, 'best_test_valid/acc_unbiased': 89.164, 'best_test_valid/diff': 2.254, 'best_test_valid/acc_skew': 88.788, 'best_test_valid/acc_align': 89.541, 'best_test_test/acc': 87.806, 'best_test_test/acc_unbiased': 87.832, 'best_test_test/diff': 2.851, 'best_test_test/acc_skew': 86.406, 'best_test_test/acc_align': 89.257}
[15 / 20] Learning rate: 1e-05 weight: 0.01
[15 / 20] Loss: 4.5951074285250595 CE Loss: 0.2944973899295392 Con Loss: 4.5921624799322815
[15 / 20] tensor([[0.882, 0.846],
        [0.892, 0.911]]) {'epoch': 15, 'valid/acc': 88.819, 'valid/acc_unbiased': 89.137, 'valid/diff': 2.621, 'valid/acc_skew': 88.751, 'valid/acc_align': 89.524, 'test/acc': 88.186, 'test/acc_unbiased': 88.268, 'test/diff': 2.721, 'test/acc_skew': 86.908, 'test/acc_align': 89.628}
[15 / 20] best valid accuracy: 89.269 at epoch 11 
 best_stats: {'best_valid_epoch': 11, 'best_valid_valid/acc': 88.903, 'best_valid_valid/acc_unbiased': 89.269, 'best_valid_valid/diff': 2.548, 'best_valid_valid/acc_skew': 88.969, 'best_valid_valid/acc_align': 89.568, 'best_valid_test/acc': 87.511, 'best_valid_test/acc_unbiased': 87.647, 'best_valid_test/diff': 2.591, 'best_valid_test/acc_skew': 86.351, 'best_valid_test/acc_align': 88.942}
[15 / 20] best test accuracy: 88.268 at epoch 15 
 best_stats: {'best_test_epoch': 15, 'best_test_valid/acc': 88.819, 'best_test_valid/acc_unbiased': 89.137, 'best_test_valid/diff': 2.621, 'best_test_valid/acc_skew': 88.751, 'best_test_valid/acc_align': 89.524, 'best_test_test/acc': 88.186, 'best_test_test/acc_unbiased': 88.268, 'best_test_test/diff': 2.721, 'best_test_test/acc_skew': 86.908, 'best_test_test/acc_align': 89.628}
[16 / 20] Learning rate: 1e-05 weight: 0.01
[16 / 20] Loss: 4.603645274377242 CE Loss: 0.2943542704545099 Con Loss: 4.6007017104136
[16 / 20] tensor([[0.875, 0.840],
        [0.896, 0.909]]) {'epoch': 16, 'valid/acc': 89.03, 'valid/acc_unbiased': 89.304, 'valid/diff': 1.726, 'valid/acc_skew': 88.715, 'valid/acc_align': 89.894, 'test/acc': 87.89, 'test/acc_unbiased': 88.012, 'test/diff': 2.367, 'test/acc_skew': 86.829, 'test/acc_align': 89.196}
[16 / 20] best valid accuracy: 89.304 at epoch 16 
 best_stats: {'best_valid_epoch': 16, 'best_valid_valid/acc': 89.03, 'best_valid_valid/acc_unbiased': 89.304, 'best_valid_valid/diff': 1.726, 'best_valid_valid/acc_skew': 88.715, 'best_valid_valid/acc_align': 89.894, 'best_valid_test/acc': 87.89, 'best_valid_test/acc_unbiased': 88.012, 'best_valid_test/diff': 2.367, 'best_valid_test/acc_skew': 86.829, 'best_valid_test/acc_align': 89.196}
[16 / 20] best test accuracy: 88.268 at epoch 15 
 best_stats: {'best_test_epoch': 15, 'best_test_valid/acc': 88.819, 'best_test_valid/acc_unbiased': 89.137, 'best_test_valid/diff': 2.621, 'best_test_valid/acc_skew': 88.751, 'best_test_valid/acc_align': 89.524, 'best_test_test/acc': 88.186, 'best_test_test/acc_unbiased': 88.268, 'best_test_test/diff': 2.721, 'best_test_test/acc_skew': 86.908, 'best_test_test/acc_align': 89.628}
[17 / 20] Learning rate: 1e-05 weight: 0.01
[17 / 20] Loss: 4.605451077556783 CE Loss: 0.29132367530853276 Con Loss: 4.6025378460741075
[17 / 20] tensor([[0.884, 0.848],
        [0.887, 0.903]]) {'epoch': 17, 'valid/acc': 89.325, 'valid/acc_unbiased': 89.588, 'valid/diff': 2.189, 'valid/acc_skew': 89.153, 'valid/acc_align': 90.022, 'test/acc': 87.975, 'test/acc_unbiased': 88.056, 'test/diff': 2.581, 'test/acc_skew': 86.765, 'test/acc_align': 89.347}
[17 / 20] best valid accuracy: 89.588 at epoch 17 
 best_stats: {'best_valid_epoch': 17, 'best_valid_valid/acc': 89.325, 'best_valid_valid/acc_unbiased': 89.588, 'best_valid_valid/diff': 2.189, 'best_valid_valid/acc_skew': 89.153, 'best_valid_valid/acc_align': 90.022, 'best_valid_test/acc': 87.975, 'best_valid_test/acc_unbiased': 88.056, 'best_valid_test/diff': 2.581, 'best_valid_test/acc_skew': 86.765, 'best_valid_test/acc_align': 89.347}
[17 / 20] best test accuracy: 88.268 at epoch 15 
 best_stats: {'best_test_epoch': 15, 'best_test_valid/acc': 88.819, 'best_test_valid/acc_unbiased': 89.137, 'best_test_valid/diff': 2.621, 'best_test_valid/acc_skew': 88.751, 'best_test_valid/acc_align': 89.524, 'best_test_test/acc': 88.186, 'best_test_test/acc_unbiased': 88.268, 'best_test_test/diff': 2.721, 'best_test_test/acc_skew': 86.908, 'best_test_test/acc_align': 89.628}
[18 / 20] Learning rate: 1e-05 weight: 0.01
[18 / 20] Loss: 4.594197290500267 CE Loss: 0.28297788177705696 Con Loss: 4.59136752663767
[18 / 20] tensor([[0.894, 0.852],
        [0.879, 0.896]]) {'epoch': 18, 'valid/acc': 89.198, 'valid/acc_unbiased': 89.407, 'valid/diff': 2.017, 'valid/acc_skew': 89.008, 'valid/acc_align': 89.807, 'test/acc': 87.975, 'test/acc_unbiased': 88.033, 'test/diff': 2.959, 'test/acc_skew': 86.554, 'test/acc_align': 89.513}
[18 / 20] best valid accuracy: 89.588 at epoch 17 
 best_stats: {'best_valid_epoch': 17, 'best_valid_valid/acc': 89.325, 'best_valid_valid/acc_unbiased': 89.588, 'best_valid_valid/diff': 2.189, 'best_valid_valid/acc_skew': 89.153, 'best_valid_valid/acc_align': 90.022, 'best_valid_test/acc': 87.975, 'best_valid_test/acc_unbiased': 88.056, 'best_valid_test/diff': 2.581, 'best_valid_test/acc_skew': 86.765, 'best_valid_test/acc_align': 89.347}
[18 / 20] best test accuracy: 88.268 at epoch 15 
 best_stats: {'best_test_epoch': 15, 'best_test_valid/acc': 88.819, 'best_test_valid/acc_unbiased': 89.137, 'best_test_valid/diff': 2.621, 'best_test_valid/acc_skew': 88.751, 'best_test_valid/acc_align': 89.524, 'best_test_test/acc': 88.186, 'best_test_test/acc_unbiased': 88.268, 'best_test_test/diff': 2.721, 'best_test_test/acc_skew': 86.908, 'best_test_test/acc_align': 89.628}
[19 / 20] Learning rate: 1e-05 weight: 0.01
[19 / 20] Loss: 4.591150014406721 CE Loss: 0.2929635158168992 Con Loss: 4.588220389874951
[19 / 20] tensor([[0.885, 0.845],
        [0.887, 0.903]]) {'epoch': 19, 'valid/acc': 89.283, 'valid/acc_unbiased': 89.54, 'valid/diff': 1.94, 'valid/acc_skew': 89.153, 'valid/acc_align': 89.928, 'test/acc': 87.932, 'test/acc_unbiased': 88.027, 'test/diff': 2.819, 'test/acc_skew': 86.617, 'test/acc_align': 89.436}
[19 / 20] best valid accuracy: 89.588 at epoch 17 
 best_stats: {'best_valid_epoch': 17, 'best_valid_valid/acc': 89.325, 'best_valid_valid/acc_unbiased': 89.588, 'best_valid_valid/diff': 2.189, 'best_valid_valid/acc_skew': 89.153, 'best_valid_valid/acc_align': 90.022, 'best_valid_test/acc': 87.975, 'best_valid_test/acc_unbiased': 88.056, 'best_valid_test/diff': 2.581, 'best_valid_test/acc_skew': 86.765, 'best_valid_test/acc_align': 89.347}
[19 / 20] best test accuracy: 88.268 at epoch 15 
 best_stats: {'best_test_epoch': 15, 'best_test_valid/acc': 88.819, 'best_test_valid/acc_unbiased': 89.137, 'best_test_valid/diff': 2.621, 'best_test_valid/acc_skew': 88.751, 'best_test_valid/acc_align': 89.524, 'best_test_test/acc': 88.186, 'best_test_test/acc_unbiased': 88.268, 'best_test_test/diff': 2.721, 'best_test_test/acc_skew': 86.908, 'best_test_test/acc_align': 89.628}
[20 / 20] Learning rate: 1e-05 weight: 0.01
[20 / 20] Loss: 4.595782629973071 CE Loss: 0.28678566686964546 Con Loss: 4.592914760412725
[20 / 20] tensor([[0.882, 0.839],
        [0.892, 0.906]]) {'epoch': 20, 'valid/acc': 89.03, 'valid/acc_unbiased': 89.341, 'valid/diff': 2.262, 'valid/acc_skew': 88.933, 'valid/acc_align': 89.748, 'test/acc': 87.848, 'test/acc_unbiased': 87.972, 'test/diff': 2.867, 'test/acc_skew': 86.539, 'test/acc_align': 89.405}
[20 / 20] best valid accuracy: 89.588 at epoch 17 
 best_stats: {'best_valid_epoch': 17, 'best_valid_valid/acc': 89.325, 'best_valid_valid/acc_unbiased': 89.588, 'best_valid_valid/diff': 2.189, 'best_valid_valid/acc_skew': 89.153, 'best_valid_valid/acc_align': 90.022, 'best_valid_test/acc': 87.975, 'best_valid_test/acc_unbiased': 88.056, 'best_valid_test/diff': 2.581, 'best_valid_test/acc_skew': 86.765, 'best_valid_test/acc_align': 89.347}
[20 / 20] best test accuracy: 88.268 at epoch 15 
 best_stats: {'best_test_epoch': 15, 'best_test_valid/acc': 88.819, 'best_test_valid/acc_unbiased': 89.137, 'best_test_valid/diff': 2.621, 'best_test_valid/acc_skew': 88.751, 'best_test_valid/acc_align': 89.524, 'best_test_test/acc': 88.186, 'best_test_test/acc_unbiased': 88.268, 'best_test_test/diff': 2.721, 'best_test_test/acc_skew': 86.908, 'best_test_test/acc_align': 89.628}
Total training time: 0:42:21
