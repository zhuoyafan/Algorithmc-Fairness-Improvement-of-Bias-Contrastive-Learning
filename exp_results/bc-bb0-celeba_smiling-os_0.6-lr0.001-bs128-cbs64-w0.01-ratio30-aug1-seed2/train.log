Log level set to: INFO
Set seed: 2
=======> Using Fixed Random Seed: 2 <========
save_path: exp_results/bc-bb0-celeba_smiling-os_0.6-lr0.001-bs128-cbs64-w0.01-ratio30-aug1-seed2
get_celeba - split:train, aug: False, given_y: True, ratio: 0
use existing smiling indices from data/celeba/pickles/smiling
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [24366, 24366]
Target 1: [24366, 24366]
Binary Target 1
---------------------------
Target 0: [24366, 24366]
Target 1: [24366, 24366]
===================================
Normal Label Distribution: 
Target 0: [24366, 24366]
Target 1: [24366, 24366]
===================================
Use BiasedCelebASplit 
 target_attr: smiling split: train 
 tensor([[24366., 24366.],
        [24366., 24366.]])
get_celeba - split:train, aug: 1, given_y: True, ratio: 30
use existing smiling indices from data/celeba/pickles/smiling
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [24461, 24461]
Target 1: [24461, 24461]
Binary Target 1
---------------------------
Target 0: [24461, 24461]
Target 1: [24461, 24461]
===================================
Normal Label Distribution: 
Target 0: [24461, 24461]
Target 1: [24461, 24461]
===================================
Use BiasedCelebASplit 
 target_attr: smiling split: train 
 tensor([[24461., 24461.],
        [24461., 24461.]])
get_celeba - split:train_valid, aug: False, given_y: True, ratio: 0
use existing smiling indices from data/celeba/pickles/smiling
Use BiasedCelebASplit 
 target_attr: smiling split: train_valid 
 tensor([[ 1973., 10114.],
        [ 8289.,  1989.]])
get_celeba - split:valid, aug: False, given_y: True, ratio: 0
Use BiasedCelebASplit 
 target_attr: smiling split: valid 
 tensor([[5252., 6157.],
        [5013., 3445.]])
decay_epochs: [3, 6]
[1 / 10] Learning rate: 0.001 weight: 0.01
[1 / 10] Loss: 4.640817731450092 CE Loss: 0.26386929511397694 Con Loss: 4.638179028512691
[1 / 10] tensor([[0.914, 0.896],
        [0.925, 0.910]]) {'epoch': 1, 'valid/acc': 90.874, 'valid/acc_unbiased': 90.771, 'valid/diff': 1.255, 'valid/acc_skew': 91.399, 'valid/acc_align': 90.144, 'test/acc': 91.212, 'test/acc_unbiased': 91.119, 'test/diff': 1.658, 'test/acc_skew': 91.948, 'test/acc_align': 90.29}
[1 / 10] best valid accuracy: 90.771 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 90.874, 'best_valid_valid/acc_unbiased': 90.771, 'best_valid_valid/diff': 1.255, 'best_valid_valid/acc_skew': 91.399, 'best_valid_valid/acc_align': 90.144, 'best_valid_test/acc': 91.212, 'best_valid_test/acc_unbiased': 91.119, 'best_valid_test/diff': 1.658, 'best_valid_test/acc_skew': 91.948, 'best_valid_test/acc_align': 90.29}
[1 / 10] best test accuracy: 91.119 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 90.874, 'best_test_valid/acc_unbiased': 90.771, 'best_test_valid/diff': 1.255, 'best_test_valid/acc_skew': 91.399, 'best_test_valid/acc_align': 90.144, 'best_test_test/acc': 91.212, 'best_test_test/acc_unbiased': 91.119, 'best_test_test/diff': 1.658, 'best_test_test/acc_skew': 91.948, 'best_test_test/acc_align': 90.29}
[2 / 10] Learning rate: 0.001 weight: 0.01
[2 / 10] Loss: 4.602760754478572 CE Loss: 0.23420720667608322 Con Loss: 4.600418684567312
[2 / 10] tensor([[0.909, 0.900],
        [0.938, 0.925]]) {'epoch': 2, 'valid/acc': 92.046, 'valid/acc_unbiased': 91.954, 'valid/diff': 0.924, 'valid/acc_skew': 92.416, 'valid/acc_align': 91.492, 'test/acc': 91.861, 'test/acc_unbiased': 91.808, 'test/diff': 1.147, 'test/acc_skew': 92.381, 'test/acc_align': 91.234}
[2 / 10] best valid accuracy: 91.954 at epoch 2 
 best_stats: {'best_valid_epoch': 2, 'best_valid_valid/acc': 92.046, 'best_valid_valid/acc_unbiased': 91.954, 'best_valid_valid/diff': 0.924, 'best_valid_valid/acc_skew': 92.416, 'best_valid_valid/acc_align': 91.492, 'best_valid_test/acc': 91.861, 'best_valid_test/acc_unbiased': 91.808, 'best_valid_test/diff': 1.147, 'best_valid_test/acc_skew': 92.381, 'best_valid_test/acc_align': 91.234}
[2 / 10] best test accuracy: 91.808 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 92.046, 'best_test_valid/acc_unbiased': 91.954, 'best_test_valid/diff': 0.924, 'best_test_valid/acc_skew': 92.416, 'best_test_valid/acc_align': 91.492, 'best_test_test/acc': 91.861, 'best_test_test/acc_unbiased': 91.808, 'best_test_test/diff': 1.147, 'best_test_test/acc_skew': 92.381, 'best_test_test/acc_align': 91.234}
[3 / 10] Learning rate: 0.001 weight: 0.01
[3 / 10] Loss: 4.594642516340243 CE Loss: 0.22734953874532082 Con Loss: 4.592369029217241
[3 / 10] tensor([[0.965, 0.947],
        [0.888, 0.871]]) {'epoch': 3, 'valid/acc': 91.411, 'valid/acc_unbiased': 91.672, 'valid/diff': 2.112, 'valid/acc_skew': 92.728, 'valid/acc_align': 90.616, 'test/acc': 92.032, 'test/acc_unbiased': 91.779, 'test/diff': 1.744, 'test/acc_skew': 92.652, 'test/acc_align': 90.907}
[3 / 10] best valid accuracy: 91.954 at epoch 2 
 best_stats: {'best_valid_epoch': 2, 'best_valid_valid/acc': 92.046, 'best_valid_valid/acc_unbiased': 91.954, 'best_valid_valid/diff': 0.924, 'best_valid_valid/acc_skew': 92.416, 'best_valid_valid/acc_align': 91.492, 'best_valid_test/acc': 91.861, 'best_valid_test/acc_unbiased': 91.808, 'best_valid_test/diff': 1.147, 'best_valid_test/acc_skew': 92.381, 'best_valid_test/acc_align': 91.234}
[3 / 10] best test accuracy: 91.808 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 92.046, 'best_test_valid/acc_unbiased': 91.954, 'best_test_valid/diff': 0.924, 'best_test_valid/acc_skew': 92.416, 'best_test_valid/acc_align': 91.492, 'best_test_test/acc': 91.861, 'best_test_test/acc_unbiased': 91.808, 'best_test_test/diff': 1.147, 'best_test_test/acc_skew': 92.381, 'best_test_test/acc_align': 91.234}
[4 / 10] Learning rate: 0.0001 weight: 0.01
[4 / 10] Loss: 4.5557540003364725 CE Loss: 0.19890973414560065 Con Loss: 4.553764898651957
[4 / 10] tensor([[0.958, 0.939],
        [0.903, 0.892]]) {'epoch': 4, 'valid/acc': 92.037, 'valid/acc_unbiased': 92.421, 'valid/diff': 1.687, 'valid/acc_skew': 93.264, 'valid/acc_align': 91.577, 'test/acc': 92.48, 'test/acc_unbiased': 92.307, 'test/diff': 1.505, 'test/acc_skew': 93.059, 'test/acc_align': 91.554}
[4 / 10] best valid accuracy: 92.421 at epoch 4 
 best_stats: {'best_valid_epoch': 4, 'best_valid_valid/acc': 92.037, 'best_valid_valid/acc_unbiased': 92.421, 'best_valid_valid/diff': 1.687, 'best_valid_valid/acc_skew': 93.264, 'best_valid_valid/acc_align': 91.577, 'best_valid_test/acc': 92.48, 'best_valid_test/acc_unbiased': 92.307, 'best_valid_test/diff': 1.505, 'best_valid_test/acc_skew': 93.059, 'best_valid_test/acc_align': 91.554}
[4 / 10] best test accuracy: 92.307 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 92.037, 'best_test_valid/acc_unbiased': 92.421, 'best_test_valid/diff': 1.687, 'best_test_valid/acc_skew': 93.264, 'best_test_valid/acc_align': 91.577, 'best_test_test/acc': 92.48, 'best_test_test/acc_unbiased': 92.307, 'best_test_test/diff': 1.505, 'best_test_test/acc_skew': 93.059, 'best_test_test/acc_align': 91.554}
[5 / 10] Learning rate: 0.0001 weight: 0.01
[5 / 10] Loss: 4.549112543511408 CE Loss: 0.19266098710808233 Con Loss: 4.547185930078139
[5 / 10] tensor([[0.949, 0.940],
        [0.911, 0.900]]) {'epoch': 5, 'valid/acc': 92.515, 'valid/acc_unbiased': 92.527, 'valid/diff': 1.73, 'valid/acc_skew': 93.392, 'valid/acc_align': 91.663, 'test/acc': 92.621, 'test/acc_unbiased': 92.479, 'test/diff': 0.987, 'test/acc_skew': 92.973, 'test/acc_align': 91.985}
[5 / 10] best valid accuracy: 92.527 at epoch 5 
 best_stats: {'best_valid_epoch': 5, 'best_valid_valid/acc': 92.515, 'best_valid_valid/acc_unbiased': 92.527, 'best_valid_valid/diff': 1.73, 'best_valid_valid/acc_skew': 93.392, 'best_valid_valid/acc_align': 91.663, 'best_valid_test/acc': 92.621, 'best_valid_test/acc_unbiased': 92.479, 'best_valid_test/diff': 0.987, 'best_valid_test/acc_skew': 92.973, 'best_valid_test/acc_align': 91.985}
[5 / 10] best test accuracy: 92.479 at epoch 5 
 best_stats: {'best_test_epoch': 5, 'best_test_valid/acc': 92.515, 'best_test_valid/acc_unbiased': 92.527, 'best_test_valid/diff': 1.73, 'best_test_valid/acc_skew': 93.392, 'best_test_valid/acc_align': 91.663, 'best_test_test/acc': 92.621, 'best_test_test/acc_unbiased': 92.479, 'best_test_test/diff': 0.987, 'best_test_test/acc_skew': 92.973, 'best_test_test/acc_align': 91.985}
[6 / 10] Learning rate: 0.0001 weight: 0.01
[6 / 10] Loss: 4.538022712524973 CE Loss: 0.19055984695732892 Con Loss: 4.536117114526028
[6 / 10] tensor([[0.927, 0.911],
        [0.932, 0.929]]) {'epoch': 6, 'valid/acc': 92.81, 'valid/acc_unbiased': 93.006, 'valid/diff': 1.373, 'valid/acc_skew': 93.692, 'valid/acc_align': 92.32, 'test/acc': 92.485, 'test/acc_unbiased': 92.472, 'test/diff': 0.992, 'test/acc_skew': 92.967, 'test/acc_align': 91.976}
[6 / 10] best valid accuracy: 93.006 at epoch 6 
 best_stats: {'best_valid_epoch': 6, 'best_valid_valid/acc': 92.81, 'best_valid_valid/acc_unbiased': 93.006, 'best_valid_valid/diff': 1.373, 'best_valid_valid/acc_skew': 93.692, 'best_valid_valid/acc_align': 92.32, 'best_valid_test/acc': 92.485, 'best_valid_test/acc_unbiased': 92.472, 'best_valid_test/diff': 0.992, 'best_valid_test/acc_skew': 92.967, 'best_valid_test/acc_align': 91.976}
[6 / 10] best test accuracy: 92.479 at epoch 5 
 best_stats: {'best_test_epoch': 5, 'best_test_valid/acc': 92.515, 'best_test_valid/acc_unbiased': 92.527, 'best_test_valid/diff': 1.73, 'best_test_valid/acc_skew': 93.392, 'best_test_valid/acc_align': 91.663, 'best_test_test/acc': 92.621, 'best_test_test/acc_unbiased': 92.479, 'best_test_test/diff': 0.987, 'best_test_test/acc_skew': 92.973, 'best_test_test/acc_align': 91.985}
[7 / 10] Learning rate: 1e-05 weight: 0.01
[7 / 10] Loss: 4.537215017033633 CE Loss: 0.18564284588769475 Con Loss: 4.535358591384218
[7 / 10] tensor([[0.945, 0.936],
        [0.916, 0.906]]) {'epoch': 7, 'valid/acc': 92.752, 'valid/acc_unbiased': 92.842, 'valid/diff': 1.433, 'valid/acc_skew': 93.558, 'valid/acc_align': 92.125, 'test/acc': 92.706, 'test/acc_unbiased': 92.582, 'test/diff': 0.991, 'test/acc_skew': 93.077, 'test/acc_align': 92.086}
[7 / 10] best valid accuracy: 93.006 at epoch 6 
 best_stats: {'best_valid_epoch': 6, 'best_valid_valid/acc': 92.81, 'best_valid_valid/acc_unbiased': 93.006, 'best_valid_valid/diff': 1.373, 'best_valid_valid/acc_skew': 93.692, 'best_valid_valid/acc_align': 92.32, 'best_valid_test/acc': 92.485, 'best_valid_test/acc_unbiased': 92.472, 'best_valid_test/diff': 0.992, 'best_valid_test/acc_skew': 92.967, 'best_valid_test/acc_align': 91.976}
[7 / 10] best test accuracy: 92.582 at epoch 7 
 best_stats: {'best_test_epoch': 7, 'best_test_valid/acc': 92.752, 'best_test_valid/acc_unbiased': 92.842, 'best_test_valid/diff': 1.433, 'best_test_valid/acc_skew': 93.558, 'best_test_valid/acc_align': 92.125, 'best_test_test/acc': 92.706, 'best_test_test/acc_unbiased': 92.582, 'best_test_test/diff': 0.991, 'best_test_test/acc_skew': 93.077, 'best_test_test/acc_align': 92.086}
[8 / 10] Learning rate: 1e-05 weight: 0.01
[8 / 10] Loss: 4.528691542889306 CE Loss: 0.1843035263774196 Con Loss: 4.526848506723964
[8 / 10] tensor([[0.948, 0.937],
        [0.919, 0.906]]) {'epoch': 8, 'valid/acc': 92.864, 'valid/acc_unbiased': 92.979, 'valid/diff': 1.274, 'valid/acc_skew': 93.616, 'valid/acc_align': 92.341, 'test/acc': 92.923, 'test/acc_unbiased': 92.777, 'test/diff': 1.214, 'test/acc_skew': 93.384, 'test/acc_align': 92.17}
[8 / 10] best valid accuracy: 93.006 at epoch 6 
 best_stats: {'best_valid_epoch': 6, 'best_valid_valid/acc': 92.81, 'best_valid_valid/acc_unbiased': 93.006, 'best_valid_valid/diff': 1.373, 'best_valid_valid/acc_skew': 93.692, 'best_valid_valid/acc_align': 92.32, 'best_valid_test/acc': 92.485, 'best_valid_test/acc_unbiased': 92.472, 'best_valid_test/diff': 0.992, 'best_valid_test/acc_skew': 92.967, 'best_valid_test/acc_align': 91.976}
[8 / 10] best test accuracy: 92.777 at epoch 8 
 best_stats: {'best_test_epoch': 8, 'best_test_valid/acc': 92.864, 'best_test_valid/acc_unbiased': 92.979, 'best_test_valid/diff': 1.274, 'best_test_valid/acc_skew': 93.616, 'best_test_valid/acc_align': 92.341, 'best_test_test/acc': 92.923, 'best_test_test/acc_unbiased': 92.777, 'best_test_test/diff': 1.214, 'best_test_test/acc_skew': 93.384, 'best_test_test/acc_align': 92.17}
[9 / 10] Learning rate: 1e-05 weight: 0.01
[9 / 10] Loss: 4.530602830761437 CE Loss: 0.1839615592610256 Con Loss: 4.52876322357308
[9 / 10] tensor([[0.950, 0.939],
        [0.914, 0.899]]) {'epoch': 9, 'valid/acc': 92.806, 'valid/acc_unbiased': 92.96, 'valid/diff': 1.284, 'valid/acc_skew': 93.602, 'valid/acc_align': 92.318, 'test/acc': 92.737, 'test/acc_unbiased': 92.564, 'test/diff': 1.285, 'test/acc_skew': 93.207, 'test/acc_align': 91.922}
[9 / 10] best valid accuracy: 93.006 at epoch 6 
 best_stats: {'best_valid_epoch': 6, 'best_valid_valid/acc': 92.81, 'best_valid_valid/acc_unbiased': 93.006, 'best_valid_valid/diff': 1.373, 'best_valid_valid/acc_skew': 93.692, 'best_valid_valid/acc_align': 92.32, 'best_valid_test/acc': 92.485, 'best_valid_test/acc_unbiased': 92.472, 'best_valid_test/diff': 0.992, 'best_valid_test/acc_skew': 92.967, 'best_valid_test/acc_align': 91.976}
[9 / 10] best test accuracy: 92.777 at epoch 8 
 best_stats: {'best_test_epoch': 8, 'best_test_valid/acc': 92.864, 'best_test_valid/acc_unbiased': 92.979, 'best_test_valid/diff': 1.274, 'best_test_valid/acc_skew': 93.616, 'best_test_valid/acc_align': 92.341, 'best_test_test/acc': 92.923, 'best_test_test/acc_unbiased': 92.777, 'best_test_test/diff': 1.214, 'best_test_test/acc_skew': 93.384, 'best_test_test/acc_align': 92.17}
[10 / 10] Learning rate: 1e-05 weight: 0.01
[10 / 10] Loss: 4.523876719821961 CE Loss: 0.18399291132619344 Con Loss: 4.522036785152974
[10 / 10] tensor([[0.936, 0.926],
        [0.930, 0.913]]) {'epoch': 10, 'valid/acc': 92.94, 'valid/acc_unbiased': 92.895, 'valid/diff': 1.329, 'valid/acc_skew': 93.56, 'valid/acc_align': 92.231, 'test/acc': 92.787, 'test/acc_unbiased': 92.646, 'test/diff': 1.381, 'test/acc_skew': 93.336, 'test/acc_align': 91.955}
[10 / 10] best valid accuracy: 93.006 at epoch 6 
 best_stats: {'best_valid_epoch': 6, 'best_valid_valid/acc': 92.81, 'best_valid_valid/acc_unbiased': 93.006, 'best_valid_valid/diff': 1.373, 'best_valid_valid/acc_skew': 93.692, 'best_valid_valid/acc_align': 92.32, 'best_valid_test/acc': 92.485, 'best_valid_test/acc_unbiased': 92.472, 'best_valid_test/diff': 0.992, 'best_valid_test/acc_skew': 92.967, 'best_valid_test/acc_align': 91.976}
[10 / 10] best test accuracy: 92.777 at epoch 8 
 best_stats: {'best_test_epoch': 8, 'best_test_valid/acc': 92.864, 'best_test_valid/acc_unbiased': 92.979, 'best_test_valid/diff': 1.274, 'best_test_valid/acc_skew': 93.616, 'best_test_valid/acc_align': 92.341, 'best_test_test/acc': 92.923, 'best_test_test/acc_unbiased': 92.777, 'best_test_test/diff': 1.214, 'best_test_test/acc_skew': 93.384, 'best_test_test/acc_align': 92.17}
Total training time: 1:36:10
