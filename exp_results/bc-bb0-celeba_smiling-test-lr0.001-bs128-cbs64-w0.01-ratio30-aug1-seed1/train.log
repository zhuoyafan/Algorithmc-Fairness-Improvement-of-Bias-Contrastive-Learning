Log level set to: INFO
Set seed: 1
=======> Using Fixed Random Seed: 1 <========
save_path: exp_results/bc-bb0-celeba_smiling-test-lr0.001-bs128-cbs64-w0.01-ratio30-aug1-seed1
get_celeba - split:train, aug: False, given_y: True, ratio: 0
get_celeba - split:train, aug: 1, given_y: True, ratio: 30
get_celeba - split:train_valid, aug: False, given_y: True, ratio: 0
get_celeba - split:valid, aug: False, given_y: True, ratio: 0
decay_epochs: [3, 6]
[1 / 10] Learning rate: 0.001 weight: 0.01
[1 / 10] Loss: 4.651959323721016 CE Loss: 0.25504569729989185 Con Loss: 4.649408868302143
[1 / 10] tensor([[0.659, 0.693],
        [0.987, 0.981]]) {'epoch': 1, 'valid/acc': 84.632, 'valid/acc_unbiased': 82.901, 'valid/diff': 1.193, 'valid/acc_skew': 82.304, 'valid/acc_align': 83.497, 'test/acc': 82.499, 'test/acc_unbiased': 82.993, 'test/diff': 1.994, 'test/acc_skew': 81.996, 'test/acc_align': 83.99}
[1 / 10] best valid accuracy: 82.901 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 84.632, 'best_valid_valid/acc_unbiased': 82.901, 'best_valid_valid/diff': 1.193, 'best_valid_valid/acc_skew': 82.304, 'best_valid_valid/acc_align': 83.497, 'best_valid_test/acc': 82.499, 'best_valid_test/acc_unbiased': 82.993, 'best_valid_test/diff': 1.994, 'best_valid_test/acc_skew': 81.996, 'best_valid_test/acc_align': 83.99}
[1 / 10] best test accuracy: 82.993 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 84.632, 'best_test_valid/acc_unbiased': 82.901, 'best_test_valid/diff': 1.193, 'best_test_valid/acc_skew': 82.304, 'best_test_valid/acc_align': 83.497, 'best_test_test/acc': 82.499, 'best_test_test/acc_unbiased': 82.993, 'best_test_test/diff': 1.994, 'best_test_test/acc_skew': 81.996, 'best_test_test/acc_align': 83.99}
[2 / 10] Learning rate: 0.001 weight: 0.01
[2 / 10] Loss: 4.6156275637867425 CE Loss: 0.22480486792341564 Con Loss: 4.613379516598151
[2 / 10] tensor([[0.792, 0.844],
        [0.972, 0.947]]) {'epoch': 2, 'valid/acc': 90.82, 'valid/acc_unbiased': 89.464, 'valid/diff': 2.412, 'valid/acc_skew': 88.258, 'valid/acc_align': 90.67, 'test/acc': 88.77, 'test/acc_unbiased': 88.865, 'test/diff': 3.89, 'test/acc_skew': 86.919, 'test/acc_align': 90.81}
[2 / 10] best valid accuracy: 89.464 at epoch 2 
 best_stats: {'best_valid_epoch': 2, 'best_valid_valid/acc': 90.82, 'best_valid_valid/acc_unbiased': 89.464, 'best_valid_valid/diff': 2.412, 'best_valid_valid/acc_skew': 88.258, 'best_valid_valid/acc_align': 90.67, 'best_valid_test/acc': 88.77, 'best_valid_test/acc_unbiased': 88.865, 'best_valid_test/diff': 3.89, 'best_valid_test/acc_skew': 86.919, 'best_valid_test/acc_align': 90.81}
[2 / 10] best test accuracy: 88.865 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 90.82, 'best_test_valid/acc_unbiased': 89.464, 'best_test_valid/diff': 2.412, 'best_test_valid/acc_skew': 88.258, 'best_test_valid/acc_align': 90.67, 'best_test_test/acc': 88.77, 'best_test_test/acc_unbiased': 88.865, 'best_test_test/diff': 3.89, 'best_test_test/acc_skew': 86.919, 'best_test_test/acc_align': 90.81}
[3 / 10] Learning rate: 0.001 weight: 0.01
[3 / 10] Loss: 4.595416683410745 CE Loss: 0.22242863316134473 Con Loss: 4.593192404266196
[3 / 10] tensor([[0.883, 0.897],
        [0.944, 0.919]]) {'epoch': 3, 'valid/acc': 92.113, 'valid/acc_unbiased': 91.512, 'valid/diff': 1.171, 'valid/acc_skew': 90.942, 'valid/acc_align': 92.081, 'test/acc': 91.171, 'test/acc_unbiased': 91.082, 'test/diff': 1.906, 'test/acc_skew': 90.129, 'test/acc_align': 92.035}
[3 / 10] best valid accuracy: 91.512 at epoch 3 
 best_stats: {'best_valid_epoch': 3, 'best_valid_valid/acc': 92.113, 'best_valid_valid/acc_unbiased': 91.512, 'best_valid_valid/diff': 1.171, 'best_valid_valid/acc_skew': 90.942, 'best_valid_valid/acc_align': 92.081, 'best_valid_test/acc': 91.171, 'best_valid_test/acc_unbiased': 91.082, 'best_valid_test/diff': 1.906, 'best_valid_test/acc_skew': 90.129, 'best_valid_test/acc_align': 92.035}
[3 / 10] best test accuracy: 91.082 at epoch 3 
 best_stats: {'best_test_epoch': 3, 'best_test_valid/acc': 92.113, 'best_test_valid/acc_unbiased': 91.512, 'best_test_valid/diff': 1.171, 'best_test_valid/acc_skew': 90.942, 'best_test_valid/acc_align': 92.081, 'best_test_test/acc': 91.171, 'best_test_test/acc_unbiased': 91.082, 'best_test_test/diff': 1.906, 'best_test_test/acc_skew': 90.129, 'best_test_test/acc_align': 92.035}
[4 / 10] Learning rate: 0.0001 weight: 0.01
[4 / 10] Loss: 4.559106250162023 CE Loss: 0.18604899129206012 Con Loss: 4.55724576013733
[4 / 10] tensor([[0.916, 0.923],
        [0.938, 0.915]]) {'epoch': 4, 'valid/acc': 92.73, 'valid/acc_unbiased': 92.629, 'valid/diff': 1.548, 'valid/acc_skew': 92.594, 'valid/acc_align': 92.663, 'test/acc': 92.455, 'test/acc_unbiased': 92.315, 'test/diff': 1.465, 'test/acc_skew': 91.583, 'test/acc_align': 93.048}
[4 / 10] best valid accuracy: 92.629 at epoch 4 
 best_stats: {'best_valid_epoch': 4, 'best_valid_valid/acc': 92.73, 'best_valid_valid/acc_unbiased': 92.629, 'best_valid_valid/diff': 1.548, 'best_valid_valid/acc_skew': 92.594, 'best_valid_valid/acc_align': 92.663, 'best_valid_test/acc': 92.455, 'best_valid_test/acc_unbiased': 92.315, 'best_valid_test/diff': 1.465, 'best_valid_test/acc_skew': 91.583, 'best_valid_test/acc_align': 93.048}
[4 / 10] best test accuracy: 92.315 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 92.73, 'best_test_valid/acc_unbiased': 92.629, 'best_test_valid/diff': 1.548, 'best_test_valid/acc_skew': 92.594, 'best_test_valid/acc_align': 92.663, 'best_test_test/acc': 92.455, 'best_test_test/acc_unbiased': 92.315, 'best_test_test/diff': 1.465, 'best_test_test/acc_skew': 91.583, 'best_test_test/acc_align': 93.048}
[5 / 10] Learning rate: 0.0001 weight: 0.01
[5 / 10] Loss: 4.554016406234035 CE Loss: 0.1833959927273915 Con Loss: 4.552182449096565
[5 / 10] tensor([[0.938, 0.940],
        [0.925, 0.896]]) {'epoch': 5, 'valid/acc': 92.971, 'valid/acc_unbiased': 92.688, 'valid/diff': 1.571, 'valid/acc_skew': 92.169, 'valid/acc_align': 93.207, 'test/acc': 92.706, 'test/acc_unbiased': 92.467, 'test/diff': 1.542, 'test/acc_skew': 91.696, 'test/acc_align': 93.238}
[5 / 10] best valid accuracy: 92.688 at epoch 5 
 best_stats: {'best_valid_epoch': 5, 'best_valid_valid/acc': 92.971, 'best_valid_valid/acc_unbiased': 92.688, 'best_valid_valid/diff': 1.571, 'best_valid_valid/acc_skew': 92.169, 'best_valid_valid/acc_align': 93.207, 'best_valid_test/acc': 92.706, 'best_valid_test/acc_unbiased': 92.467, 'best_valid_test/diff': 1.542, 'best_valid_test/acc_skew': 91.696, 'best_valid_test/acc_align': 93.238}
[5 / 10] best test accuracy: 92.467 at epoch 5 
 best_stats: {'best_test_epoch': 5, 'best_test_valid/acc': 92.971, 'best_test_valid/acc_unbiased': 92.688, 'best_test_valid/diff': 1.571, 'best_test_valid/acc_skew': 92.169, 'best_test_valid/acc_align': 93.207, 'best_test_test/acc': 92.706, 'best_test_test/acc_unbiased': 92.467, 'best_test_test/diff': 1.542, 'best_test_test/acc_skew': 91.696, 'best_test_test/acc_align': 93.238}
[6 / 10] Learning rate: 0.0001 weight: 0.01
[6 / 10] Loss: 4.543389514385462 CE Loss: 0.17907847867021298 Con Loss: 4.54159872881931
[6 / 10] tensor([[0.920, 0.923],
        [0.941, 0.919]]) {'epoch': 6, 'valid/acc': 92.922, 'valid/acc_unbiased': 92.712, 'valid/diff': 1.359, 'valid/acc_skew': 92.495, 'valid/acc_align': 92.929, 'test/acc': 92.712, 'test/acc_unbiased': 92.577, 'test/diff': 1.23, 'test/acc_skew': 91.962, 'test/acc_align': 93.192}
[6 / 10] best valid accuracy: 92.712 at epoch 6 
 best_stats: {'best_valid_epoch': 6, 'best_valid_valid/acc': 92.922, 'best_valid_valid/acc_unbiased': 92.712, 'best_valid_valid/diff': 1.359, 'best_valid_valid/acc_skew': 92.495, 'best_valid_valid/acc_align': 92.929, 'best_valid_test/acc': 92.712, 'best_valid_test/acc_unbiased': 92.577, 'best_valid_test/diff': 1.23, 'best_valid_test/acc_skew': 91.962, 'best_valid_test/acc_align': 93.192}
[6 / 10] best test accuracy: 92.577 at epoch 6 
 best_stats: {'best_test_epoch': 6, 'best_test_valid/acc': 92.922, 'best_test_valid/acc_unbiased': 92.712, 'best_test_valid/diff': 1.359, 'best_test_valid/acc_skew': 92.495, 'best_test_valid/acc_align': 92.929, 'best_test_test/acc': 92.712, 'best_test_test/acc_unbiased': 92.577, 'best_test_test/diff': 1.23, 'best_test_test/acc_skew': 91.962, 'best_test_test/acc_align': 93.192}
[7 / 10] Learning rate: 1e-05 weight: 0.01
[7 / 10] Loss: 4.539105692721913 CE Loss: 0.17809720608702703 Con Loss: 4.5373247217563275
[7 / 10] tensor([[0.916, 0.924],
        [0.941, 0.916]]) {'epoch': 7, 'valid/acc': 92.976, 'valid/acc_unbiased': 92.803, 'valid/diff': 1.532, 'valid/acc_skew': 92.672, 'valid/acc_align': 92.933, 'test/acc': 92.581, 'test/acc_unbiased': 92.425, 'test/diff': 1.674, 'test/acc_skew': 91.588, 'test/acc_align': 93.262}
[7 / 10] best valid accuracy: 92.803 at epoch 7 
 best_stats: {'best_valid_epoch': 7, 'best_valid_valid/acc': 92.976, 'best_valid_valid/acc_unbiased': 92.803, 'best_valid_valid/diff': 1.532, 'best_valid_valid/acc_skew': 92.672, 'best_valid_valid/acc_align': 92.933, 'best_valid_test/acc': 92.581, 'best_valid_test/acc_unbiased': 92.425, 'best_valid_test/diff': 1.674, 'best_valid_test/acc_skew': 91.588, 'best_valid_test/acc_align': 93.262}
[7 / 10] best test accuracy: 92.577 at epoch 6 
 best_stats: {'best_test_epoch': 6, 'best_test_valid/acc': 92.922, 'best_test_valid/acc_unbiased': 92.712, 'best_test_valid/diff': 1.359, 'best_test_valid/acc_skew': 92.495, 'best_test_valid/acc_align': 92.929, 'best_test_test/acc': 92.712, 'best_test_test/acc_unbiased': 92.577, 'best_test_test/diff': 1.23, 'best_test_test/acc_skew': 91.962, 'best_test_test/acc_align': 93.192}
[8 / 10] Learning rate: 1e-05 weight: 0.01
[8 / 10] Loss: 4.530995738794419 CE Loss: 0.17615435404363256 Con Loss: 4.529234198817769
[8 / 10] tensor([[0.928, 0.935],
        [0.935, 0.910]]) {'epoch': 8, 'valid/acc': 93.181, 'valid/acc_unbiased': 92.918, 'valid/diff': 1.864, 'valid/acc_skew': 92.499, 'valid/acc_align': 93.338, 'test/acc': 92.857, 'test/acc_unbiased': 92.676, 'test/diff': 1.615, 'test/acc_skew': 91.869, 'test/acc_align': 93.484}
[8 / 10] best valid accuracy: 92.918 at epoch 8 
 best_stats: {'best_valid_epoch': 8, 'best_valid_valid/acc': 93.181, 'best_valid_valid/acc_unbiased': 92.918, 'best_valid_valid/diff': 1.864, 'best_valid_valid/acc_skew': 92.499, 'best_valid_valid/acc_align': 93.338, 'best_valid_test/acc': 92.857, 'best_valid_test/acc_unbiased': 92.676, 'best_valid_test/diff': 1.615, 'best_valid_test/acc_skew': 91.869, 'best_valid_test/acc_align': 93.484}
[8 / 10] best test accuracy: 92.676 at epoch 8 
 best_stats: {'best_test_epoch': 8, 'best_test_valid/acc': 93.181, 'best_test_valid/acc_unbiased': 92.918, 'best_test_valid/diff': 1.864, 'best_test_valid/acc_skew': 92.499, 'best_test_valid/acc_align': 93.338, 'best_test_test/acc': 92.857, 'best_test_test/acc_unbiased': 92.676, 'best_test_test/diff': 1.615, 'best_test_test/acc_skew': 91.869, 'best_test_test/acc_align': 93.484}
[9 / 10] Learning rate: 1e-05 weight: 0.01
[9 / 10] Loss: 4.532768028976266 CE Loss: 0.17575843928818594 Con Loss: 4.531010451271313
[9 / 10] tensor([[0.924, 0.930],
        [0.937, 0.912]]) {'epoch': 9, 'valid/acc': 93.163, 'valid/acc_unbiased': 92.948, 'valid/diff': 1.503, 'valid/acc_skew': 92.662, 'valid/acc_align': 93.233, 'test/acc': 92.757, 'test/acc_unbiased': 92.588, 'test/diff': 1.501, 'test/acc_skew': 91.837, 'test/acc_align': 93.338}
[9 / 10] best valid accuracy: 92.948 at epoch 9 
 best_stats: {'best_valid_epoch': 9, 'best_valid_valid/acc': 93.163, 'best_valid_valid/acc_unbiased': 92.948, 'best_valid_valid/diff': 1.503, 'best_valid_valid/acc_skew': 92.662, 'best_valid_valid/acc_align': 93.233, 'best_valid_test/acc': 92.757, 'best_valid_test/acc_unbiased': 92.588, 'best_valid_test/diff': 1.501, 'best_valid_test/acc_skew': 91.837, 'best_valid_test/acc_align': 93.338}
[9 / 10] best test accuracy: 92.676 at epoch 8 
 best_stats: {'best_test_epoch': 8, 'best_test_valid/acc': 93.181, 'best_test_valid/acc_unbiased': 92.918, 'best_test_valid/diff': 1.864, 'best_test_valid/acc_skew': 92.499, 'best_test_valid/acc_align': 93.338, 'best_test_test/acc': 92.857, 'best_test_test/acc_unbiased': 92.676, 'best_test_test/diff': 1.615, 'best_test_test/acc_skew': 91.869, 'best_test_test/acc_align': 93.484}
[10 / 10] Learning rate: 1e-05 weight: 0.01
[10 / 10] Loss: 4.5343448180660255 CE Loss: 0.17522692510122723 Con Loss: 4.532592545524924
[10 / 10] tensor([[0.934, 0.941],
        [0.932, 0.906]]) {'epoch': 10, 'valid/acc': 93.141, 'valid/acc_unbiased': 92.899, 'valid/diff': 1.602, 'valid/acc_skew': 92.445, 'valid/acc_align': 93.352, 'test/acc': 93.029, 'test/acc_unbiased': 92.828, 'test/diff': 1.601, 'test/acc_skew': 92.028, 'test/acc_align': 93.629}
[10 / 10] best valid accuracy: 92.948 at epoch 9 
 best_stats: {'best_valid_epoch': 9, 'best_valid_valid/acc': 93.163, 'best_valid_valid/acc_unbiased': 92.948, 'best_valid_valid/diff': 1.503, 'best_valid_valid/acc_skew': 92.662, 'best_valid_valid/acc_align': 93.233, 'best_valid_test/acc': 92.757, 'best_valid_test/acc_unbiased': 92.588, 'best_valid_test/diff': 1.501, 'best_valid_test/acc_skew': 91.837, 'best_valid_test/acc_align': 93.338}
[10 / 10] best test accuracy: 92.828 at epoch 10 
 best_stats: {'best_test_epoch': 10, 'best_test_valid/acc': 93.141, 'best_test_valid/acc_unbiased': 92.899, 'best_test_valid/diff': 1.602, 'best_test_valid/acc_skew': 92.445, 'best_test_valid/acc_align': 93.352, 'best_test_test/acc': 93.029, 'best_test_test/acc_unbiased': 92.828, 'best_test_test/diff': 1.601, 'best_test_test/acc_skew': 92.028, 'best_test_test/acc_align': 93.629}
Total training time: 1:17:19
