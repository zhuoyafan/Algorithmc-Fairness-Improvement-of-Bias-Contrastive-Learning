Log level set to: INFO
Set seed: 2
=======> Using Fixed Random Seed: 2 <========
save_path: exp_results/bc-bb0-celeba_blonde-os_0.9_trivial-lr0.001-bs128-cbs64-w0.01-ratio30-aug1-seed2
get_celeba - split:train, aug: False, given_y: True, ratio: 0
use existing blonde indices from data/celeba/pickles/blonde
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [48198, 48198]
Target 1: [48198, 48198]
Binary Target 1
---------------------------
Target 0: [48198, 48198]
Target 1: [48198, 48198]
===================================
Normal Label Distribution: 
Target 0: [48198, 48198]
Target 1: [48198, 48198]
===================================
Use BiasedCelebASplit 
 target_attr: blonde split: train 
 tensor([[48198., 48198.],
        [48198., 48198.]])
get_celeba - split:train, aug: 1, given_y: True, ratio: 30
use existing blonde indices from data/celeba/pickles/blonde
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [48126, 48126]
Target 1: [48126, 48126]
Binary Target 1
---------------------------
Target 0: [48126, 48126]
Target 1: [48126, 48126]
===================================
Normal Label Distribution: 
Target 0: [48126, 48126]
Target 1: [48126, 48126]
===================================
Use BiasedCelebASplit 
 target_attr: blonde split: train 
 tensor([[48126., 48126.],
        [48126., 48126.]])
get_celeba - split:train_valid, aug: False, given_y: True, ratio: 0
use existing blonde indices from data/celeba/pickles/blonde
Use BiasedCelebASplit 
 target_attr: blonde split: train_valid 
 tensor([[  403.,  4597.],
        [13344.,   285.]])
get_celeba - split:valid, aug: False, given_y: True, ratio: 0
Use BiasedCelebASplit 
 target_attr: blonde split: valid 
 tensor([[8535., 2874.],
        [8276.,  182.]])
decay_epochs: [3, 6]
[1 / 10] Learning rate: 0.001 weight: 0.01
[1 / 10] Loss: 4.633715939257638 CE Loss: 0.2323040920562272 Con Loss: 4.631392893531401
[1 / 10] tensor([[0.849, 0.909],
        [0.966, 0.956]]) {'epoch': 1, 'valid/acc': 91.862, 'valid/acc_unbiased': 92.976, 'valid/diff': 1.3, 'valid/acc_skew': 93.626, 'valid/acc_align': 92.326, 'test/acc': 89.188, 'test/acc_unbiased': 91.998, 'test/diff': 3.447, 'test/acc_skew': 90.767, 'test/acc_align': 93.229}
[1 / 10] best valid accuracy: 92.976 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 91.862, 'best_valid_valid/acc_unbiased': 92.976, 'best_valid_valid/diff': 1.3, 'best_valid_valid/acc_skew': 93.626, 'best_valid_valid/acc_align': 92.326, 'best_valid_test/acc': 89.188, 'best_valid_test/acc_unbiased': 91.998, 'best_valid_test/diff': 3.447, 'best_valid_test/acc_skew': 90.767, 'best_valid_test/acc_align': 93.229}
[1 / 10] best test accuracy: 91.998 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 91.862, 'best_test_valid/acc_unbiased': 92.976, 'best_test_valid/diff': 1.3, 'best_test_valid/acc_skew': 93.626, 'best_test_valid/acc_align': 92.326, 'best_test_test/acc': 89.188, 'best_test_test/acc_unbiased': 91.998, 'best_test_test/diff': 3.447, 'best_test_test/acc_skew': 90.767, 'best_test_test/acc_align': 93.229}
[2 / 10] Learning rate: 0.001 weight: 0.01
[2 / 10] Loss: 4.589516076108095 CE Loss: 0.20103611279891295 Con Loss: 4.587505714800047
[2 / 10] tensor([[0.843, 0.935],
        [0.962, 0.934]]) {'epoch': 2, 'valid/acc': 93.762, 'valid/acc_unbiased': 93.971, 'valid/diff': 1.35, 'valid/acc_skew': 94.483, 'valid/acc_align': 93.458, 'test/acc': 89.973, 'test/acc_unbiased': 91.88, 'test/diff': 6.03, 'test/acc_skew': 90.283, 'test/acc_align': 93.477}
[2 / 10] best valid accuracy: 93.971 at epoch 2 
 best_stats: {'best_valid_epoch': 2, 'best_valid_valid/acc': 93.762, 'best_valid_valid/acc_unbiased': 93.971, 'best_valid_valid/diff': 1.35, 'best_valid_valid/acc_skew': 94.483, 'best_valid_valid/acc_align': 93.458, 'best_valid_test/acc': 89.973, 'best_valid_test/acc_unbiased': 91.88, 'best_valid_test/diff': 6.03, 'best_valid_test/acc_skew': 90.283, 'best_valid_test/acc_align': 93.477}
[2 / 10] best test accuracy: 91.998 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 91.862, 'best_test_valid/acc_unbiased': 92.976, 'best_test_valid/diff': 1.3, 'best_test_valid/acc_skew': 93.626, 'best_test_valid/acc_align': 92.326, 'best_test_test/acc': 89.188, 'best_test_test/acc_unbiased': 91.998, 'best_test_test/diff': 3.447, 'best_test_test/acc_skew': 90.767, 'best_test_test/acc_align': 93.229}
[3 / 10] Learning rate: 0.001 weight: 0.01
[3 / 10] Loss: 4.565148303912306 CE Loss: 0.1873899060108834 Con Loss: 4.563274411285728
[3 / 10] tensor([[0.819, 0.881],
        [0.969, 0.951]]) {'epoch': 3, 'valid/acc': 90.601, 'valid/acc_unbiased': 93.297, 'valid/diff': 1.332, 'valid/acc_skew': 93.164, 'valid/acc_align': 93.43, 'test/acc': 86.762, 'test/acc_unbiased': 90.477, 'test/diff': 4.048, 'test/acc_skew': 89.36, 'test/acc_align': 91.595}
[3 / 10] best valid accuracy: 93.971 at epoch 2 
 best_stats: {'best_valid_epoch': 2, 'best_valid_valid/acc': 93.762, 'best_valid_valid/acc_unbiased': 93.971, 'best_valid_valid/diff': 1.35, 'best_valid_valid/acc_skew': 94.483, 'best_valid_valid/acc_align': 93.458, 'best_valid_test/acc': 89.973, 'best_valid_test/acc_unbiased': 91.88, 'best_valid_test/diff': 6.03, 'best_valid_test/acc_skew': 90.283, 'best_valid_test/acc_align': 93.477}
[3 / 10] best test accuracy: 91.998 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 91.862, 'best_test_valid/acc_unbiased': 92.976, 'best_test_valid/diff': 1.3, 'best_test_valid/acc_skew': 93.626, 'best_test_valid/acc_align': 92.326, 'best_test_test/acc': 89.188, 'best_test_test/acc_unbiased': 91.998, 'best_test_test/diff': 3.447, 'best_test_test/acc_skew': 90.767, 'best_test_test/acc_align': 93.229}
[4 / 10] Learning rate: 0.0001 weight: 0.01
[4 / 10] Loss: 4.498640129578955 CE Loss: 0.15275904332445323 Con Loss: 4.497112536718254
[4 / 10] tensor([[0.845, 0.932],
        [0.967, 0.912]]) {'epoch': 4, 'valid/acc': 94.02, 'valid/acc_unbiased': 95.795, 'valid/diff': 1.59, 'valid/acc_skew': 96.24, 'valid/acc_align': 95.35, 'test/acc': 89.973, 'test/acc_unbiased': 91.421, 'test/diff': 7.133, 'test/acc_skew': 90.614, 'test/acc_align': 92.227}
[4 / 10] best valid accuracy: 95.795 at epoch 4 
 best_stats: {'best_valid_epoch': 4, 'best_valid_valid/acc': 94.02, 'best_valid_valid/acc_unbiased': 95.795, 'best_valid_valid/diff': 1.59, 'best_valid_valid/acc_skew': 96.24, 'best_valid_valid/acc_align': 95.35, 'best_valid_test/acc': 89.973, 'best_valid_test/acc_unbiased': 91.421, 'best_valid_test/diff': 7.133, 'best_valid_test/acc_skew': 90.614, 'best_valid_test/acc_align': 92.227}
[4 / 10] best test accuracy: 91.998 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 91.862, 'best_test_valid/acc_unbiased': 92.976, 'best_test_valid/diff': 1.3, 'best_test_valid/acc_skew': 93.626, 'best_test_valid/acc_align': 92.326, 'best_test_test/acc': 89.188, 'best_test_test/acc_unbiased': 91.998, 'best_test_test/diff': 3.447, 'best_test_test/acc_skew': 90.767, 'best_test_test/acc_align': 93.229}
[5 / 10] Learning rate: 0.0001 weight: 0.01
[5 / 10] Loss: 4.47290622040891 CE Loss: 0.13807210611183568 Con Loss: 4.471525499625712
[5 / 10] tensor([[0.844, 0.938],
        [0.967, 0.929]]) {'epoch': 5, 'valid/acc': 94.476, 'valid/acc_unbiased': 96.399, 'valid/diff': 2.179, 'valid/acc_skew': 96.634, 'valid/acc_align': 96.165, 'test/acc': 90.2, 'test/acc_unbiased': 91.96, 'test/diff': 6.623, 'test/acc_skew': 90.585, 'test/acc_align': 93.335}
[5 / 10] best valid accuracy: 96.399 at epoch 5 
 best_stats: {'best_valid_epoch': 5, 'best_valid_valid/acc': 94.476, 'best_valid_valid/acc_unbiased': 96.399, 'best_valid_valid/diff': 2.179, 'best_valid_valid/acc_skew': 96.634, 'best_valid_valid/acc_align': 96.165, 'best_valid_test/acc': 90.2, 'best_valid_test/acc_unbiased': 91.96, 'best_valid_test/diff': 6.623, 'best_valid_test/acc_skew': 90.585, 'best_valid_test/acc_align': 93.335}
[5 / 10] best test accuracy: 91.998 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 91.862, 'best_test_valid/acc_unbiased': 92.976, 'best_test_valid/diff': 1.3, 'best_test_valid/acc_skew': 93.626, 'best_test_valid/acc_align': 92.326, 'best_test_test/acc': 89.188, 'best_test_test/acc_unbiased': 91.998, 'best_test_test/diff': 3.447, 'best_test_test/acc_skew': 90.767, 'best_test_test/acc_align': 93.229}
[6 / 10] Learning rate: 0.0001 weight: 0.01
[6 / 10] Loss: 4.459244924074604 CE Loss: 0.12756874676851163 Con Loss: 4.457969236395667
[6 / 10] tensor([[0.831, 0.929],
        [0.975, 0.934]]) {'epoch': 6, 'valid/acc': 93.918, 'valid/acc_unbiased': 96.349, 'valid/diff': 2.673, 'valid/acc_skew': 97.158, 'valid/acc_align': 95.54, 'test/acc': 89.364, 'test/acc_unbiased': 91.728, 'test/diff': 6.933, 'test/acc_skew': 90.306, 'test/acc_align': 93.151}
[6 / 10] best valid accuracy: 96.399 at epoch 5 
 best_stats: {'best_valid_epoch': 5, 'best_valid_valid/acc': 94.476, 'best_valid_valid/acc_unbiased': 96.399, 'best_valid_valid/diff': 2.179, 'best_valid_valid/acc_skew': 96.634, 'best_valid_valid/acc_align': 96.165, 'best_valid_test/acc': 90.2, 'best_valid_test/acc_unbiased': 91.96, 'best_valid_test/diff': 6.623, 'best_valid_test/acc_skew': 90.585, 'best_valid_test/acc_align': 93.335}
[6 / 10] best test accuracy: 91.998 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 91.862, 'best_test_valid/acc_unbiased': 92.976, 'best_test_valid/diff': 1.3, 'best_test_valid/acc_skew': 93.626, 'best_test_valid/acc_align': 92.326, 'best_test_test/acc': 89.188, 'best_test_test/acc_unbiased': 91.998, 'best_test_test/diff': 3.447, 'best_test_test/acc_skew': 90.767, 'best_test_test/acc_align': 93.229}
[7 / 10] Learning rate: 1e-05 weight: 0.01
[7 / 10] Loss: 4.441148978001082 CE Loss: 0.12005901270152954 Con Loss: 4.439948384151097
[7 / 10] tensor([[0.849, 0.949],
        [0.966, 0.896]]) {'epoch': 7, 'valid/acc': 94.965, 'valid/acc_unbiased': 96.545, 'valid/diff': 1.973, 'valid/acc_skew': 97.247, 'valid/acc_align': 95.842, 'test/acc': 90.804, 'test/acc_unbiased': 91.485, 'test/diff': 8.523, 'test/acc_skew': 90.721, 'test/acc_align': 92.249}
[7 / 10] best valid accuracy: 96.545 at epoch 7 
 best_stats: {'best_valid_epoch': 7, 'best_valid_valid/acc': 94.965, 'best_valid_valid/acc_unbiased': 96.545, 'best_valid_valid/diff': 1.973, 'best_valid_valid/acc_skew': 97.247, 'best_valid_valid/acc_align': 95.842, 'best_valid_test/acc': 90.804, 'best_valid_test/acc_unbiased': 91.485, 'best_valid_test/diff': 8.523, 'best_valid_test/acc_skew': 90.721, 'best_valid_test/acc_align': 92.249}
[7 / 10] best test accuracy: 91.998 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 91.862, 'best_test_valid/acc_unbiased': 92.976, 'best_test_valid/diff': 1.3, 'best_test_valid/acc_skew': 93.626, 'best_test_valid/acc_align': 92.326, 'best_test_test/acc': 89.188, 'best_test_test/acc_unbiased': 91.998, 'best_test_test/diff': 3.447, 'best_test_test/acc_skew': 90.767, 'best_test_test/acc_align': 93.229}
[8 / 10] Learning rate: 1e-05 weight: 0.01
[8 / 10] Loss: 4.436685923080859 CE Loss: 0.11810647030808707 Con Loss: 4.435504856146818
[8 / 10] tensor([[0.844, 0.947],
        [0.969, 0.918]]) {'epoch': 8, 'valid/acc': 95.024, 'valid/acc_unbiased': 96.559, 'valid/diff': 1.697, 'valid/acc_skew': 97.287, 'valid/acc_align': 95.831, 'test/acc': 90.532, 'test/acc_unbiased': 91.914, 'test/diff': 7.712, 'test/acc_skew': 90.613, 'test/acc_align': 93.215}
[8 / 10] best valid accuracy: 96.559 at epoch 8 
 best_stats: {'best_valid_epoch': 8, 'best_valid_valid/acc': 95.024, 'best_valid_valid/acc_unbiased': 96.559, 'best_valid_valid/diff': 1.697, 'best_valid_valid/acc_skew': 97.287, 'best_valid_valid/acc_align': 95.831, 'best_valid_test/acc': 90.532, 'best_valid_test/acc_unbiased': 91.914, 'best_valid_test/diff': 7.712, 'best_valid_test/acc_skew': 90.613, 'best_valid_test/acc_align': 93.215}
[8 / 10] best test accuracy: 91.998 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 91.862, 'best_test_valid/acc_unbiased': 92.976, 'best_test_valid/diff': 1.3, 'best_test_valid/acc_skew': 93.626, 'best_test_valid/acc_align': 92.326, 'best_test_test/acc': 89.188, 'best_test_test/acc_unbiased': 91.998, 'best_test_test/diff': 3.447, 'best_test_test/acc_skew': 90.767, 'best_test_test/acc_align': 93.229}
[9 / 10] Learning rate: 1e-05 weight: 0.01
[9 / 10] Loss: 4.440167689631107 CE Loss: 0.11682012604616075 Con Loss: 4.438999490790548
[9 / 10] tensor([[0.842, 0.945],
        [0.966, 0.907]]) {'epoch': 9, 'valid/acc': 94.976, 'valid/acc_unbiased': 96.66, 'valid/diff': 1.846, 'valid/acc_skew': 97.384, 'valid/acc_align': 95.935, 'test/acc': 90.331, 'test/acc_unbiased': 91.486, 'test/diff': 8.13, 'test/acc_skew': 90.404, 'test/acc_align': 92.569}
[9 / 10] best valid accuracy: 96.660 at epoch 9 
 best_stats: {'best_valid_epoch': 9, 'best_valid_valid/acc': 94.976, 'best_valid_valid/acc_unbiased': 96.66, 'best_valid_valid/diff': 1.846, 'best_valid_valid/acc_skew': 97.384, 'best_valid_valid/acc_align': 95.935, 'best_valid_test/acc': 90.331, 'best_valid_test/acc_unbiased': 91.486, 'best_valid_test/diff': 8.13, 'best_valid_test/acc_skew': 90.404, 'best_valid_test/acc_align': 92.569}
[9 / 10] best test accuracy: 91.998 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 91.862, 'best_test_valid/acc_unbiased': 92.976, 'best_test_valid/diff': 1.3, 'best_test_valid/acc_skew': 93.626, 'best_test_valid/acc_align': 92.326, 'best_test_test/acc': 89.188, 'best_test_test/acc_unbiased': 91.998, 'best_test_test/diff': 3.447, 'best_test_test/acc_skew': 90.767, 'best_test_test/acc_align': 93.229}
[10 / 10] Learning rate: 1e-05 weight: 0.01
[10 / 10] Loss: 4.428742739703033 CE Loss: 0.11564117367324298 Con Loss: 4.42758633026993
[10 / 10] tensor([[0.849, 0.951],
        [0.967, 0.901]]) {'epoch': 10, 'valid/acc': 95.271, 'valid/acc_unbiased': 96.473, 'valid/diff': 1.506, 'valid/acc_skew': 97.226, 'valid/acc_align': 95.719, 'test/acc': 90.899, 'test/acc_unbiased': 91.705, 'test/diff': 8.426, 'test/acc_skew': 90.802, 'test/acc_align': 92.608}
[10 / 10] best valid accuracy: 96.660 at epoch 9 
 best_stats: {'best_valid_epoch': 9, 'best_valid_valid/acc': 94.976, 'best_valid_valid/acc_unbiased': 96.66, 'best_valid_valid/diff': 1.846, 'best_valid_valid/acc_skew': 97.384, 'best_valid_valid/acc_align': 95.935, 'best_valid_test/acc': 90.331, 'best_valid_test/acc_unbiased': 91.486, 'best_valid_test/diff': 8.13, 'best_valid_test/acc_skew': 90.404, 'best_valid_test/acc_align': 92.569}
[10 / 10] best test accuracy: 91.998 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 91.862, 'best_test_valid/acc_unbiased': 92.976, 'best_test_valid/diff': 1.3, 'best_test_valid/acc_skew': 93.626, 'best_test_valid/acc_align': 92.326, 'best_test_test/acc': 89.188, 'best_test_test/acc_unbiased': 91.998, 'best_test_test/diff': 3.447, 'best_test_test/acc_skew': 90.767, 'best_test_test/acc_align': 93.229}
Total training time: 2:13:32
