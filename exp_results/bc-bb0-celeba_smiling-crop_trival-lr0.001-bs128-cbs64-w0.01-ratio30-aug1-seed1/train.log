Log level set to: INFO
Set seed: 1
=======> Using Fixed Random Seed: 1 <========
save_path: exp_results/bc-bb0-celeba_smiling-crop_trival-lr0.001-bs128-cbs64-w0.01-ratio30-aug1-seed1
get_celeba - split:train, aug: False, given_y: True, ratio: 0
use existing smiling indices from data/celeba/pickles/smiling
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [8007, 32831]
Target 1: [40613, 8007]
Binary Target 1
---------------------------
Target 0: [8007, 32831]
Target 1: [40613, 8007]
===================================
Normal Label Distribution: 
Target 0: [8007, 32831]
Target 1: [40613, 8007]
===================================
Use BiasedCelebASplit 
 target_attr: smiling split: train 
 tensor([[ 8007., 40613.],
        [32831.,  8007.]])
get_celeba - split:train, aug: 1, given_y: True, ratio: 30
use existing smiling indices from data/celeba/pickles/smiling
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [8056, 32674]
Target 1: [40701, 8027]
Binary Target 1
---------------------------
Target 0: [8056, 32674]
Target 1: [40701, 8027]
===================================
Normal Label Distribution: 
Target 0: [8056, 32674]
Target 1: [40701, 8027]
===================================
Use BiasedCelebASplit 
 target_attr: smiling split: train 
 tensor([[ 8056., 40701.],
        [32674.,  8027.]])
get_celeba - split:train_valid, aug: False, given_y: True, ratio: 0
use existing smiling indices from data/celeba/pickles/smiling
Use BiasedCelebASplit 
 target_attr: smiling split: train_valid 
 tensor([[ 2019., 10233.],
        [ 8156.,  1957.]])
get_celeba - split:valid, aug: False, given_y: True, ratio: 0
Use BiasedCelebASplit 
 target_attr: smiling split: valid 
 tensor([[5252., 6157.],
        [5013., 3445.]])
decay_epochs: [3, 6]
[1 / 10] Learning rate: 0.001 weight: 0.01
[1 / 10] Loss: 4.715934817871846 CE Loss: 0.2602837274049715 Con Loss: 4.713331982143267
[1 / 10] tensor([[0.864, 0.810],
        [0.951, 0.949]]) {'epoch': 1, 'valid/acc': 88.715, 'valid/acc_unbiased': 89.088, 'valid/diff': 3.133, 'valid/acc_skew': 90.654, 'valid/acc_align': 87.521, 'test/acc': 89.233, 'test/acc_unbiased': 89.377, 'test/diff': 2.776, 'test/acc_skew': 90.668, 'test/acc_align': 88.087}
[1 / 10] best valid accuracy: 89.088 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 88.715, 'best_valid_valid/acc_unbiased': 89.088, 'best_valid_valid/diff': 3.133, 'best_valid_valid/acc_skew': 90.654, 'best_valid_valid/acc_align': 87.521, 'best_valid_test/acc': 89.233, 'best_valid_test/acc_unbiased': 89.377, 'best_valid_test/diff': 2.776, 'best_valid_test/acc_skew': 90.668, 'best_valid_test/acc_align': 88.087}
[1 / 10] best test accuracy: 89.377 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 88.715, 'best_test_valid/acc_unbiased': 89.088, 'best_test_valid/diff': 3.133, 'best_test_valid/acc_skew': 90.654, 'best_test_valid/acc_align': 87.521, 'best_test_test/acc': 89.233, 'best_test_test/acc_unbiased': 89.377, 'best_test_test/diff': 2.776, 'best_test_test/acc_skew': 90.668, 'best_test_test/acc_align': 88.087}
[2 / 10] Learning rate: 0.001 weight: 0.01
[2 / 10] Loss: 4.676301529039232 CE Loss: 0.22682027119277254 Con Loss: 4.674033328084927
[2 / 10] tensor([[0.898, 0.923],
        [0.941, 0.883]]) {'epoch': 2, 'valid/acc': 92.354, 'valid/acc_unbiased': 91.442, 'valid/diff': 2.623, 'valid/acc_skew': 90.131, 'valid/acc_align': 92.754, 'test/acc': 91.514, 'test/acc_unbiased': 91.138, 'test/diff': 4.169, 'test/acc_skew': 89.053, 'test/acc_align': 93.222}
[2 / 10] best valid accuracy: 91.442 at epoch 2 
 best_stats: {'best_valid_epoch': 2, 'best_valid_valid/acc': 92.354, 'best_valid_valid/acc_unbiased': 91.442, 'best_valid_valid/diff': 2.623, 'best_valid_valid/acc_skew': 90.131, 'best_valid_valid/acc_align': 92.754, 'best_valid_test/acc': 91.514, 'best_valid_test/acc_unbiased': 91.138, 'best_valid_test/diff': 4.169, 'best_valid_test/acc_skew': 89.053, 'best_valid_test/acc_align': 93.222}
[2 / 10] best test accuracy: 91.138 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 92.354, 'best_test_valid/acc_unbiased': 91.442, 'best_test_valid/diff': 2.623, 'best_test_valid/acc_skew': 90.131, 'best_test_valid/acc_align': 92.754, 'best_test_test/acc': 91.514, 'best_test_test/acc_unbiased': 91.138, 'best_test_test/diff': 4.169, 'best_test_test/acc_skew': 89.053, 'best_test_test/acc_align': 93.222}
[3 / 10] Learning rate: 0.001 weight: 0.01
[3 / 10] Loss: 4.657362569060459 CE Loss: 0.21754758426635867 Con Loss: 4.655187094485289
[3 / 10] tensor([[0.863, 0.892],
        [0.958, 0.930]]) {'epoch': 3, 'valid/acc': 92.046, 'valid/acc_unbiased': 91.438, 'valid/diff': 1.103, 'valid/acc_skew': 90.954, 'valid/acc_align': 91.922, 'test/acc': 91.121, 'test/acc_unbiased': 91.061, 'test/diff': 2.846, 'test/acc_skew': 89.638, 'test/acc_align': 92.484}
[3 / 10] best valid accuracy: 91.442 at epoch 2 
 best_stats: {'best_valid_epoch': 2, 'best_valid_valid/acc': 92.354, 'best_valid_valid/acc_unbiased': 91.442, 'best_valid_valid/diff': 2.623, 'best_valid_valid/acc_skew': 90.131, 'best_valid_valid/acc_align': 92.754, 'best_valid_test/acc': 91.514, 'best_valid_test/acc_unbiased': 91.138, 'best_valid_test/diff': 4.169, 'best_valid_test/acc_skew': 89.053, 'best_valid_test/acc_align': 93.222}
[3 / 10] best test accuracy: 91.138 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 92.354, 'best_test_valid/acc_unbiased': 91.442, 'best_test_valid/diff': 2.623, 'best_test_valid/acc_skew': 90.131, 'best_test_valid/acc_align': 92.754, 'best_test_test/acc': 91.514, 'best_test_test/acc_unbiased': 91.138, 'best_test_test/diff': 4.169, 'best_test_test/acc_skew': 89.053, 'best_test_test/acc_align': 93.222}
[4 / 10] Learning rate: 0.0001 weight: 0.01
[4 / 10] Loss: 4.609981807249568 CE Loss: 0.18580286098775436 Con Loss: 4.608123777026171
[4 / 10] tensor([[0.926, 0.947],
        [0.935, 0.878]]) {'epoch': 4, 'valid/acc': 93.271, 'valid/acc_unbiased': 92.118, 'valid/diff': 3.726, 'valid/acc_skew': 90.255, 'valid/acc_align': 93.981, 'test/acc': 92.571, 'test/acc_unbiased': 92.146, 'test/diff': 3.909, 'test/acc_skew': 90.191, 'test/acc_align': 94.1}
[4 / 10] best valid accuracy: 92.118 at epoch 4 
 best_stats: {'best_valid_epoch': 4, 'best_valid_valid/acc': 93.271, 'best_valid_valid/acc_unbiased': 92.118, 'best_valid_valid/diff': 3.726, 'best_valid_valid/acc_skew': 90.255, 'best_valid_valid/acc_align': 93.981, 'best_valid_test/acc': 92.571, 'best_valid_test/acc_unbiased': 92.146, 'best_valid_test/diff': 3.909, 'best_valid_test/acc_skew': 90.191, 'best_valid_test/acc_align': 94.1}
[4 / 10] best test accuracy: 92.146 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 93.271, 'best_test_valid/acc_unbiased': 92.118, 'best_test_valid/diff': 3.726, 'best_test_valid/acc_skew': 90.255, 'best_test_valid/acc_align': 93.981, 'best_test_test/acc': 92.571, 'best_test_test/acc_unbiased': 92.146, 'best_test_test/diff': 3.909, 'best_test_test/acc_skew': 90.191, 'best_test_test/acc_align': 94.1}
[5 / 10] Learning rate: 0.0001 weight: 0.01
[5 / 10] Loss: 4.599991108256142 CE Loss: 0.1811886600086143 Con Loss: 4.598179211465456
[5 / 10] tensor([[0.908, 0.924],
        [0.943, 0.911]]) {'epoch': 5, 'valid/acc': 93.029, 'valid/acc_unbiased': 92.433, 'valid/diff': 1.577, 'valid/acc_skew': 91.645, 'valid/acc_align': 93.222, 'test/acc': 92.339, 'test/acc_unbiased': 92.151, 'test/diff': 2.4, 'test/acc_skew': 90.951, 'test/acc_align': 93.351}
[5 / 10] best valid accuracy: 92.433 at epoch 5 
 best_stats: {'best_valid_epoch': 5, 'best_valid_valid/acc': 93.029, 'best_valid_valid/acc_unbiased': 92.433, 'best_valid_valid/diff': 1.577, 'best_valid_valid/acc_skew': 91.645, 'best_valid_valid/acc_align': 93.222, 'best_valid_test/acc': 92.339, 'best_valid_test/acc_unbiased': 92.151, 'best_valid_test/diff': 2.4, 'best_valid_test/acc_skew': 90.951, 'best_valid_test/acc_align': 93.351}
[5 / 10] best test accuracy: 92.151 at epoch 5 
 best_stats: {'best_test_epoch': 5, 'best_test_valid/acc': 93.029, 'best_test_valid/acc_unbiased': 92.433, 'best_test_valid/diff': 1.577, 'best_test_valid/acc_skew': 91.645, 'best_test_valid/acc_align': 93.222, 'best_test_test/acc': 92.339, 'best_test_test/acc_unbiased': 92.151, 'best_test_test/diff': 2.4, 'best_test_test/acc_skew': 90.951, 'best_test_test/acc_align': 93.351}
[6 / 10] Learning rate: 0.0001 weight: 0.01
[6 / 10] Loss: 4.591240269357059 CE Loss: 0.17737662819490238 Con Loss: 4.589466503963919
[6 / 10] tensor([[0.920, 0.929],
        [0.942, 0.909]]) {'epoch': 6, 'valid/acc': 92.944, 'valid/acc_unbiased': 92.316, 'valid/diff': 1.81, 'valid/acc_skew': 91.411, 'valid/acc_align': 93.22, 'test/acc': 92.712, 'test/acc_unbiased': 92.49, 'test/diff': 2.083, 'test/acc_skew': 91.449, 'test/acc_align': 93.532}
[6 / 10] best valid accuracy: 92.433 at epoch 5 
 best_stats: {'best_valid_epoch': 5, 'best_valid_valid/acc': 93.029, 'best_valid_valid/acc_unbiased': 92.433, 'best_valid_valid/diff': 1.577, 'best_valid_valid/acc_skew': 91.645, 'best_valid_valid/acc_align': 93.222, 'best_valid_test/acc': 92.339, 'best_valid_test/acc_unbiased': 92.151, 'best_valid_test/diff': 2.4, 'best_valid_test/acc_skew': 90.951, 'best_valid_test/acc_align': 93.351}
[6 / 10] best test accuracy: 92.490 at epoch 6 
 best_stats: {'best_test_epoch': 6, 'best_test_valid/acc': 92.944, 'best_test_valid/acc_unbiased': 92.316, 'best_test_valid/diff': 1.81, 'best_test_valid/acc_skew': 91.411, 'best_test_valid/acc_align': 93.22, 'best_test_test/acc': 92.712, 'best_test_test/acc_unbiased': 92.49, 'best_test_test/diff': 2.083, 'best_test_test/acc_skew': 91.449, 'best_test_test/acc_align': 93.532}
[7 / 10] Learning rate: 1e-05 weight: 0.01
[7 / 10] Loss: 4.588655637179362 CE Loss: 0.1761346828914477 Con Loss: 4.586894289551586
[7 / 10] tensor([[0.921, 0.930],
        [0.944, 0.904]]) {'epoch': 7, 'valid/acc': 93.226, 'valid/acc_unbiased': 92.633, 'valid/diff': 1.748, 'valid/acc_skew': 91.759, 'valid/acc_align': 93.507, 'test/acc': 92.747, 'test/acc_unbiased': 92.48, 'test/diff': 2.442, 'test/acc_skew': 91.26, 'test/acc_align': 93.701}
[7 / 10] best valid accuracy: 92.633 at epoch 7 
 best_stats: {'best_valid_epoch': 7, 'best_valid_valid/acc': 93.226, 'best_valid_valid/acc_unbiased': 92.633, 'best_valid_valid/diff': 1.748, 'best_valid_valid/acc_skew': 91.759, 'best_valid_valid/acc_align': 93.507, 'best_valid_test/acc': 92.747, 'best_valid_test/acc_unbiased': 92.48, 'best_valid_test/diff': 2.442, 'best_valid_test/acc_skew': 91.26, 'best_valid_test/acc_align': 93.701}
[7 / 10] best test accuracy: 92.490 at epoch 6 
 best_stats: {'best_test_epoch': 6, 'best_test_valid/acc': 92.944, 'best_test_valid/acc_unbiased': 92.316, 'best_test_valid/diff': 1.81, 'best_test_valid/acc_skew': 91.411, 'best_test_valid/acc_align': 93.22, 'best_test_test/acc': 92.712, 'best_test_test/acc_unbiased': 92.49, 'best_test_test/diff': 2.083, 'best_test_test/acc_skew': 91.449, 'best_test_test/acc_align': 93.532}
[8 / 10] Learning rate: 1e-05 weight: 0.01
[8 / 10] Loss: 4.58025889249658 CE Loss: 0.17386098245020995 Con Loss: 4.578520281746763
[8 / 10] tensor([[0.924, 0.941],
        [0.942, 0.897]]) {'epoch': 8, 'valid/acc': 93.409, 'valid/acc_unbiased': 92.668, 'valid/diff': 2.329, 'valid/acc_skew': 91.503, 'valid/acc_align': 93.832, 'test/acc': 92.933, 'test/acc_unbiased': 92.612, 'test/diff': 3.106, 'test/acc_skew': 91.059, 'test/acc_align': 94.165}
[8 / 10] best valid accuracy: 92.668 at epoch 8 
 best_stats: {'best_valid_epoch': 8, 'best_valid_valid/acc': 93.409, 'best_valid_valid/acc_unbiased': 92.668, 'best_valid_valid/diff': 2.329, 'best_valid_valid/acc_skew': 91.503, 'best_valid_valid/acc_align': 93.832, 'best_valid_test/acc': 92.933, 'best_valid_test/acc_unbiased': 92.612, 'best_valid_test/diff': 3.106, 'best_valid_test/acc_skew': 91.059, 'best_valid_test/acc_align': 94.165}
[8 / 10] best test accuracy: 92.612 at epoch 8 
 best_stats: {'best_test_epoch': 8, 'best_test_valid/acc': 93.409, 'best_test_valid/acc_unbiased': 92.668, 'best_test_valid/diff': 2.329, 'best_test_valid/acc_skew': 91.503, 'best_test_valid/acc_align': 93.832, 'best_test_test/acc': 92.933, 'best_test_test/acc_unbiased': 92.612, 'best_test_test/diff': 3.106, 'best_test_test/acc_skew': 91.059, 'best_test_test/acc_align': 94.165}
[9 / 10] Learning rate: 1e-05 weight: 0.01
[9 / 10] Loss: 4.577510424757679 CE Loss: 0.17344416882435096 Con Loss: 4.575775988968824
[9 / 10] tensor([[0.927, 0.939],
        [0.941, 0.896]]) {'epoch': 9, 'valid/acc': 93.405, 'valid/acc_unbiased': 92.732, 'valid/diff': 2.109, 'valid/acc_skew': 91.678, 'valid/acc_align': 93.787, 'test/acc': 92.883, 'test/acc_unbiased': 92.565, 'test/diff': 2.842, 'test/acc_skew': 91.144, 'test/acc_align': 93.986}
[9 / 10] best valid accuracy: 92.732 at epoch 9 
 best_stats: {'best_valid_epoch': 9, 'best_valid_valid/acc': 93.405, 'best_valid_valid/acc_unbiased': 92.732, 'best_valid_valid/diff': 2.109, 'best_valid_valid/acc_skew': 91.678, 'best_valid_valid/acc_align': 93.787, 'best_valid_test/acc': 92.883, 'best_valid_test/acc_unbiased': 92.565, 'best_valid_test/diff': 2.842, 'best_valid_test/acc_skew': 91.144, 'best_valid_test/acc_align': 93.986}
[9 / 10] best test accuracy: 92.612 at epoch 8 
 best_stats: {'best_test_epoch': 8, 'best_test_valid/acc': 93.409, 'best_test_valid/acc_unbiased': 92.668, 'best_test_valid/diff': 2.329, 'best_test_valid/acc_skew': 91.503, 'best_test_valid/acc_align': 93.832, 'best_test_test/acc': 92.933, 'best_test_test/acc_unbiased': 92.612, 'best_test_test/diff': 3.106, 'best_test_test/acc_skew': 91.059, 'best_test_test/acc_align': 94.165}
[10 / 10] Learning rate: 1e-05 weight: 0.01
[10 / 10] Loss: 4.580337137562874 CE Loss: 0.17308269974090232 Con Loss: 4.5786063079609685
[10 / 10] tensor([[0.931, 0.945],
        [0.937, 0.892]]) {'epoch': 10, 'valid/acc': 93.315, 'valid/acc_unbiased': 92.658, 'valid/diff': 2.183, 'valid/acc_skew': 91.567, 'valid/acc_align': 93.75, 'test/acc': 92.958, 'test/acc_unbiased': 92.619, 'test/diff': 2.995, 'test/acc_skew': 91.121, 'test/acc_align': 94.116}
[10 / 10] best valid accuracy: 92.732 at epoch 9 
 best_stats: {'best_valid_epoch': 9, 'best_valid_valid/acc': 93.405, 'best_valid_valid/acc_unbiased': 92.732, 'best_valid_valid/diff': 2.109, 'best_valid_valid/acc_skew': 91.678, 'best_valid_valid/acc_align': 93.787, 'best_valid_test/acc': 92.883, 'best_valid_test/acc_unbiased': 92.565, 'best_valid_test/diff': 2.842, 'best_valid_test/acc_skew': 91.144, 'best_valid_test/acc_align': 93.986}
[10 / 10] best test accuracy: 92.619 at epoch 10 
 best_stats: {'best_test_epoch': 10, 'best_test_valid/acc': 93.315, 'best_test_valid/acc_unbiased': 92.658, 'best_test_valid/diff': 2.183, 'best_test_valid/acc_skew': 91.567, 'best_test_valid/acc_align': 93.75, 'best_test_test/acc': 92.958, 'best_test_test/acc_unbiased': 92.619, 'best_test_test/diff': 2.995, 'best_test_test/acc_skew': 91.121, 'best_test_test/acc_align': 94.116}
Total training time: 1:22:46
