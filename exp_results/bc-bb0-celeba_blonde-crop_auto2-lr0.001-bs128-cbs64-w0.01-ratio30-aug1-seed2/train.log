Log level set to: INFO
Set seed: 2
=======> Using Fixed Random Seed: 2 <========
save_path: exp_results/bc-bb0-celeba_blonde-crop_auto2-lr0.001-bs128-cbs64-w0.01-ratio30-aug1-seed2
get_celeba - split:train, aug: False, given_y: True, ratio: 0
use existing blonde indices from data/celeba/pickles/blonde
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [1586, 53554]
Target 1: [18282, 1090]
Binary Target 1
---------------------------
Target 0: [1586, 53554]
Target 1: [18282, 1090]
===================================
Normal Label Distribution: 
Target 0: [1586, 53554]
Target 1: [18282, 1090]
===================================
Use BiasedCelebASplit 
 target_attr: blonde split: train 
 tensor([[ 1586., 18282.],
        [53554.,  1090.]])
get_celeba - split:train, aug: 1, given_y: True, ratio: 30
use existing blonde indices from data/celeba/pickles/blonde
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [1615, 53474]
Target 1: [18298, 1125]
Binary Target 1
---------------------------
Target 0: [1615, 53474]
Target 1: [18298, 1125]
===================================
Normal Label Distribution: 
Target 0: [1615, 53474]
Target 1: [18298, 1125]
===================================
Use BiasedCelebASplit 
 target_attr: blonde split: train 
 tensor([[ 1615., 18298.],
        [53474.,  1125.]])
get_celeba - split:train_valid, aug: False, given_y: True, ratio: 0
use existing blonde indices from data/celeba/pickles/blonde
Use BiasedCelebASplit 
 target_attr: blonde split: train_valid 
 tensor([[  403.,  4597.],
        [13344.,   285.]])
get_celeba - split:valid, aug: False, given_y: True, ratio: 0
Use BiasedCelebASplit 
 target_attr: blonde split: valid 
 tensor([[8535., 2874.],
        [8276.,  182.]])
decay_epochs: [3, 6]
[1 / 10] Learning rate: 0.001 weight: 0.01
[1 / 10] Loss: 4.751034047129022 CE Loss: 0.20544598537797398 Con Loss: 4.748979580154075
[1 / 10] tensor([[0.914, 0.966],
        [0.822, 0.703]]) {'epoch': 1, 'valid/acc': 92.098, 'valid/acc_unbiased': 86.417, 'valid/diff': 5.062, 'valid/acc_skew': 83.886, 'valid/acc_align': 88.948, 'test/acc': 92.072, 'test/acc_unbiased': 85.148, 'test/diff': 8.531, 'test/acc_skew': 80.882, 'test/acc_align': 89.413}
[1 / 10] best valid accuracy: 86.417 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 92.098, 'best_valid_valid/acc_unbiased': 86.417, 'best_valid_valid/diff': 5.062, 'best_valid_valid/acc_skew': 83.886, 'best_valid_valid/acc_align': 88.948, 'best_valid_test/acc': 92.072, 'best_valid_test/acc_unbiased': 85.148, 'best_valid_test/diff': 8.531, 'best_valid_test/acc_skew': 80.882, 'best_valid_test/acc_align': 89.413}
[1 / 10] best test accuracy: 85.148 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 92.098, 'best_test_valid/acc_unbiased': 86.417, 'best_test_valid/diff': 5.062, 'best_test_valid/acc_skew': 83.886, 'best_test_valid/acc_align': 88.948, 'best_test_test/acc': 92.072, 'best_test_test/acc_unbiased': 85.148, 'best_test_test/diff': 8.531, 'best_test_test/acc_skew': 80.882, 'best_test_test/acc_align': 89.413}
[2 / 10] Learning rate: 0.001 weight: 0.01
[2 / 10] Loss: 4.71420064780342 CE Loss: 0.1825902139184453 Con Loss: 4.7123747465818875
[2 / 10] tensor([[0.972, 0.982],
        [0.674, 0.577]]) {'epoch': 2, 'valid/acc': 89.989, 'valid/acc_unbiased': 80.439, 'valid/diff': 5.7, 'valid/acc_skew': 77.852, 'valid/acc_align': 83.025, 'test/acc': 92.958, 'test/acc_unbiased': 80.126, 'test/diff': 5.347, 'test/acc_skew': 77.452, 'test/acc_align': 82.799}
[2 / 10] best valid accuracy: 86.417 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 92.098, 'best_valid_valid/acc_unbiased': 86.417, 'best_valid_valid/diff': 5.062, 'best_valid_valid/acc_skew': 83.886, 'best_valid_valid/acc_align': 88.948, 'best_valid_test/acc': 92.072, 'best_valid_test/acc_unbiased': 85.148, 'best_valid_test/diff': 8.531, 'best_valid_test/acc_skew': 80.882, 'best_valid_test/acc_align': 89.413}
[2 / 10] best test accuracy: 85.148 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 92.098, 'best_test_valid/acc_unbiased': 86.417, 'best_test_valid/diff': 5.062, 'best_test_valid/acc_skew': 83.886, 'best_test_valid/acc_align': 88.948, 'best_test_test/acc': 92.072, 'best_test_test/acc_unbiased': 85.148, 'best_test_test/diff': 8.531, 'best_test_test/acc_skew': 80.882, 'best_test_test/acc_align': 89.413}
[3 / 10] Learning rate: 0.001 weight: 0.01
[3 / 10] Loss: 4.697287414113365 CE Loss: 0.1726542490476289 Con Loss: 4.695560864581042
[3 / 10] tensor([[0.921, 0.959],
        [0.887, 0.835]]) {'epoch': 3, 'valid/acc': 93.419, 'valid/acc_unbiased': 89.851, 'valid/diff': 4.108, 'valid/acc_skew': 87.797, 'valid/acc_align': 91.905, 'test/acc': 93.129, 'test/acc_unbiased': 90.063, 'test/diff': 4.494, 'test/acc_skew': 87.816, 'test/acc_align': 92.31}
[3 / 10] best valid accuracy: 89.851 at epoch 3 
 best_stats: {'best_valid_epoch': 3, 'best_valid_valid/acc': 93.419, 'best_valid_valid/acc_unbiased': 89.851, 'best_valid_valid/diff': 4.108, 'best_valid_valid/acc_skew': 87.797, 'best_valid_valid/acc_align': 91.905, 'best_valid_test/acc': 93.129, 'best_valid_test/acc_unbiased': 90.063, 'best_valid_test/diff': 4.494, 'best_valid_test/acc_skew': 87.816, 'best_valid_test/acc_align': 92.31}
[3 / 10] best test accuracy: 90.063 at epoch 3 
 best_stats: {'best_test_epoch': 3, 'best_test_valid/acc': 93.419, 'best_test_valid/acc_unbiased': 89.851, 'best_test_valid/diff': 4.108, 'best_test_valid/acc_skew': 87.797, 'best_test_valid/acc_align': 91.905, 'best_test_test/acc': 93.129, 'best_test_test/acc_unbiased': 90.063, 'best_test_test/diff': 4.494, 'best_test_test/acc_skew': 87.816, 'best_test_test/acc_align': 92.31}
[4 / 10] Learning rate: 0.0001 weight: 0.01
[4 / 10] Loss: 4.643227249966278 CE Loss: 0.15240926428067855 Con Loss: 4.641703153491046
[4 / 10] tensor([[0.902, 0.957],
        [0.915, 0.907]]) {'epoch': 4, 'valid/acc': 93.95, 'valid/acc_unbiased': 91.623, 'valid/diff': 2.842, 'valid/acc_skew': 90.202, 'valid/acc_align': 93.044, 'test/acc': 92.671, 'test/acc_unbiased': 92.015, 'test/diff': 3.189, 'test/acc_skew': 90.42, 'test/acc_align': 93.61}
[4 / 10] best valid accuracy: 91.623 at epoch 4 
 best_stats: {'best_valid_epoch': 4, 'best_valid_valid/acc': 93.95, 'best_valid_valid/acc_unbiased': 91.623, 'best_valid_valid/diff': 2.842, 'best_valid_valid/acc_skew': 90.202, 'best_valid_valid/acc_align': 93.044, 'best_valid_test/acc': 92.671, 'best_valid_test/acc_unbiased': 92.015, 'best_valid_test/diff': 3.189, 'best_valid_test/acc_skew': 90.42, 'best_valid_test/acc_align': 93.61}
[4 / 10] best test accuracy: 92.015 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 93.95, 'best_test_valid/acc_unbiased': 91.623, 'best_test_valid/diff': 2.842, 'best_test_valid/acc_skew': 90.202, 'best_test_valid/acc_align': 93.044, 'best_test_test/acc': 92.671, 'best_test_test/acc_unbiased': 92.015, 'best_test_test/diff': 3.189, 'best_test_test/acc_skew': 90.42, 'best_test_test/acc_align': 93.61}
[5 / 10] Learning rate: 0.0001 weight: 0.01
[5 / 10] Loss: 4.630772163050354 CE Loss: 0.14762456345217714 Con Loss: 4.6292959201584205
[5 / 10] tensor([[0.925, 0.974],
        [0.888, 0.769]]) {'epoch': 5, 'valid/acc': 94.38, 'valid/acc_unbiased': 89.841, 'valid/diff': 6.869, 'valid/acc_skew': 87.078, 'valid/acc_align': 92.604, 'test/acc': 93.849, 'test/acc_unbiased': 88.891, 'test/diff': 8.345, 'test/acc_skew': 84.718, 'test/acc_align': 93.064}
[5 / 10] best valid accuracy: 91.623 at epoch 4 
 best_stats: {'best_valid_epoch': 4, 'best_valid_valid/acc': 93.95, 'best_valid_valid/acc_unbiased': 91.623, 'best_valid_valid/diff': 2.842, 'best_valid_valid/acc_skew': 90.202, 'best_valid_valid/acc_align': 93.044, 'best_valid_test/acc': 92.671, 'best_valid_test/acc_unbiased': 92.015, 'best_valid_test/diff': 3.189, 'best_valid_test/acc_skew': 90.42, 'best_valid_test/acc_align': 93.61}
[5 / 10] best test accuracy: 92.015 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 93.95, 'best_test_valid/acc_unbiased': 91.623, 'best_test_valid/diff': 2.842, 'best_test_valid/acc_skew': 90.202, 'best_test_valid/acc_align': 93.044, 'best_test_test/acc': 92.671, 'best_test_test/acc_unbiased': 92.015, 'best_test_test/diff': 3.189, 'best_test_test/acc_skew': 90.42, 'best_test_test/acc_align': 93.61}
[6 / 10] Learning rate: 0.0001 weight: 0.01
[6 / 10] Loss: 4.608253976114579 CE Loss: 0.1439720033217019 Con Loss: 4.6068142554471745
[6 / 10] tensor([[0.921, 0.977],
        [0.894, 0.780]]) {'epoch': 6, 'valid/acc': 94.857, 'valid/acc_unbiased': 89.669, 'valid/diff': 7.478, 'valid/acc_skew': 86.128, 'valid/acc_align': 93.21, 'test/acc': 93.94, 'test/acc_unbiased': 89.313, 'test/diff': 8.467, 'test/acc_skew': 85.08, 'test/acc_align': 93.547}
[6 / 10] best valid accuracy: 91.623 at epoch 4 
 best_stats: {'best_valid_epoch': 4, 'best_valid_valid/acc': 93.95, 'best_valid_valid/acc_unbiased': 91.623, 'best_valid_valid/diff': 2.842, 'best_valid_valid/acc_skew': 90.202, 'best_valid_valid/acc_align': 93.044, 'best_valid_test/acc': 92.671, 'best_valid_test/acc_unbiased': 92.015, 'best_valid_test/diff': 3.189, 'best_valid_test/acc_skew': 90.42, 'best_valid_test/acc_align': 93.61}
[6 / 10] best test accuracy: 92.015 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 93.95, 'best_test_valid/acc_unbiased': 91.623, 'best_test_valid/diff': 2.842, 'best_test_valid/acc_skew': 90.202, 'best_test_valid/acc_align': 93.044, 'best_test_test/acc': 92.671, 'best_test_test/acc_unbiased': 92.015, 'best_test_test/diff': 3.189, 'best_test_test/acc_skew': 90.42, 'best_test_test/acc_align': 93.61}
[7 / 10] Learning rate: 1e-05 weight: 0.01
[7 / 10] Loss: 4.604545316087962 CE Loss: 0.13597474153304986 Con Loss: 4.603185563172448
[7 / 10] tensor([[0.922, 0.974],
        [0.898, 0.824]]) {'epoch': 7, 'valid/acc': 94.739, 'valid/acc_unbiased': 90.7, 'valid/diff': 5.676, 'valid/acc_skew': 88.233, 'valid/acc_align': 93.168, 'test/acc': 93.894, 'test/acc_unbiased': 90.435, 'test/diff': 6.29, 'test/acc_skew': 87.29, 'test/acc_align': 93.579}
[7 / 10] best valid accuracy: 91.623 at epoch 4 
 best_stats: {'best_valid_epoch': 4, 'best_valid_valid/acc': 93.95, 'best_valid_valid/acc_unbiased': 91.623, 'best_valid_valid/diff': 2.842, 'best_valid_valid/acc_skew': 90.202, 'best_valid_valid/acc_align': 93.044, 'best_valid_test/acc': 92.671, 'best_valid_test/acc_unbiased': 92.015, 'best_valid_test/diff': 3.189, 'best_valid_test/acc_skew': 90.42, 'best_valid_test/acc_align': 93.61}
[7 / 10] best test accuracy: 92.015 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 93.95, 'best_test_valid/acc_unbiased': 91.623, 'best_test_valid/diff': 2.842, 'best_test_valid/acc_skew': 90.202, 'best_test_valid/acc_align': 93.044, 'best_test_test/acc': 92.671, 'best_test_test/acc_unbiased': 92.015, 'best_test_test/diff': 3.189, 'best_test_test/acc_skew': 90.42, 'best_test_test/acc_align': 93.61}
[8 / 10] Learning rate: 1e-05 weight: 0.01
[8 / 10] Loss: 4.599938068672493 CE Loss: 0.13929754116132276 Con Loss: 4.598545089821614
[8 / 10] tensor([[0.912, 0.971],
        [0.909, 0.830]]) {'epoch': 8, 'valid/acc': 94.734, 'valid/acc_unbiased': 90.666, 'valid/diff': 6.714, 'valid/acc_skew': 87.758, 'valid/acc_align': 93.575, 'test/acc': 93.512, 'test/acc_unbiased': 90.523, 'test/diff': 6.913, 'test/acc_skew': 87.066, 'test/acc_align': 93.98}
[8 / 10] best valid accuracy: 91.623 at epoch 4 
 best_stats: {'best_valid_epoch': 4, 'best_valid_valid/acc': 93.95, 'best_valid_valid/acc_unbiased': 91.623, 'best_valid_valid/diff': 2.842, 'best_valid_valid/acc_skew': 90.202, 'best_valid_valid/acc_align': 93.044, 'best_valid_test/acc': 92.671, 'best_valid_test/acc_unbiased': 92.015, 'best_valid_test/diff': 3.189, 'best_valid_test/acc_skew': 90.42, 'best_valid_test/acc_align': 93.61}
[8 / 10] best test accuracy: 92.015 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 93.95, 'best_test_valid/acc_unbiased': 91.623, 'best_test_valid/diff': 2.842, 'best_test_valid/acc_skew': 90.202, 'best_test_valid/acc_align': 93.044, 'best_test_test/acc': 92.671, 'best_test_test/acc_unbiased': 92.015, 'best_test_test/diff': 3.189, 'best_test_test/acc_skew': 90.42, 'best_test_test/acc_align': 93.61}
[9 / 10] Learning rate: 1e-05 weight: 0.01
[9 / 10] Loss: 4.60111680726061 CE Loss: 0.13603347428470997 Con Loss: 4.5997564853555994
[9 / 10] tensor([[0.905, 0.968],
        [0.920, 0.857]]) {'epoch': 9, 'valid/acc': 95.002, 'valid/acc_unbiased': 91.471, 'valid/diff': 6.301, 'valid/acc_skew': 88.811, 'valid/acc_align': 94.132, 'test/acc': 93.305, 'test/acc_unbiased': 91.264, 'test/diff': 6.327, 'test/acc_skew': 88.1, 'test/acc_align': 94.427}
[9 / 10] best valid accuracy: 91.623 at epoch 4 
 best_stats: {'best_valid_epoch': 4, 'best_valid_valid/acc': 93.95, 'best_valid_valid/acc_unbiased': 91.623, 'best_valid_valid/diff': 2.842, 'best_valid_valid/acc_skew': 90.202, 'best_valid_valid/acc_align': 93.044, 'best_valid_test/acc': 92.671, 'best_valid_test/acc_unbiased': 92.015, 'best_valid_test/diff': 3.189, 'best_valid_test/acc_skew': 90.42, 'best_valid_test/acc_align': 93.61}
[9 / 10] best test accuracy: 92.015 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 93.95, 'best_test_valid/acc_unbiased': 91.623, 'best_test_valid/diff': 2.842, 'best_test_valid/acc_skew': 90.202, 'best_test_valid/acc_align': 93.044, 'best_test_test/acc': 92.671, 'best_test_test/acc_unbiased': 92.015, 'best_test_test/diff': 3.189, 'best_test_test/acc_skew': 90.42, 'best_test_test/acc_align': 93.61}
[10 / 10] Learning rate: 1e-05 weight: 0.01
[10 / 10] Loss: 4.594557750985324 CE Loss: 0.13622885014536248 Con Loss: 4.593195465825929
[10 / 10] tensor([[0.921, 0.974],
        [0.892, 0.775]]) {'epoch': 10, 'valid/acc': 94.782, 'valid/acc_unbiased': 90.605, 'valid/diff': 6.694, 'valid/acc_skew': 88.152, 'valid/acc_align': 93.059, 'test/acc': 93.769, 'test/acc_unbiased': 89.054, 'test/diff': 8.52, 'test/acc_skew': 84.794, 'test/acc_align': 93.314}
[10 / 10] best valid accuracy: 91.623 at epoch 4 
 best_stats: {'best_valid_epoch': 4, 'best_valid_valid/acc': 93.95, 'best_valid_valid/acc_unbiased': 91.623, 'best_valid_valid/diff': 2.842, 'best_valid_valid/acc_skew': 90.202, 'best_valid_valid/acc_align': 93.044, 'best_valid_test/acc': 92.671, 'best_valid_test/acc_unbiased': 92.015, 'best_valid_test/diff': 3.189, 'best_valid_test/acc_skew': 90.42, 'best_valid_test/acc_align': 93.61}
[10 / 10] best test accuracy: 92.015 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 93.95, 'best_test_valid/acc_unbiased': 91.623, 'best_test_valid/diff': 2.842, 'best_test_valid/acc_skew': 90.202, 'best_test_valid/acc_align': 93.044, 'best_test_test/acc': 92.671, 'best_test_test/acc_unbiased': 92.015, 'best_test_test/diff': 3.189, 'best_test_test/acc_skew': 90.42, 'best_test_test/acc_align': 93.61}
Total training time: 1:29:04
