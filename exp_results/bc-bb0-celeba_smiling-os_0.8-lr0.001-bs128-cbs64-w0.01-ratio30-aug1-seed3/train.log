Log level set to: INFO
Set seed: 3
=======> Using Fixed Random Seed: 3 <========
save_path: exp_results/bc-bb0-celeba_smiling-os_0.8-lr0.001-bs128-cbs64-w0.01-ratio30-aug1-seed3
get_celeba - split:train, aug: False, given_y: True, ratio: 0
use existing smiling indices from data/celeba/pickles/smiling
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [32496, 32496]
Target 1: [32496, 32496]
Binary Target 1
---------------------------
Target 0: [32496, 32496]
Target 1: [32496, 32496]
===================================
Normal Label Distribution: 
Target 0: [32496, 32496]
Target 1: [32496, 32496]
===================================
Use BiasedCelebASplit 
 target_attr: smiling split: train 
 tensor([[32496., 32496.],
        [32496., 32496.]])
get_celeba - split:train, aug: 1, given_y: True, ratio: 30
use existing smiling indices from data/celeba/pickles/smiling
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [32641, 32641]
Target 1: [32641, 32641]
Binary Target 1
---------------------------
Target 0: [32641, 32641]
Target 1: [32641, 32641]
===================================
Normal Label Distribution: 
Target 0: [32641, 32641]
Target 1: [32641, 32641]
===================================
Use BiasedCelebASplit 
 target_attr: smiling split: train 
 tensor([[32641., 32641.],
        [32641., 32641.]])
get_celeba - split:train_valid, aug: False, given_y: True, ratio: 0
use existing smiling indices from data/celeba/pickles/smiling
Use BiasedCelebASplit 
 target_attr: smiling split: train_valid 
 tensor([[ 1944., 10217.],
        [ 8222.,  1982.]])
get_celeba - split:valid, aug: False, given_y: True, ratio: 0
Use BiasedCelebASplit 
 target_attr: smiling split: valid 
 tensor([[5252., 6157.],
        [5013., 3445.]])
decay_epochs: [3, 6]
[1 / 10] Learning rate: 0.001 weight: 0.01
[1 / 10] Loss: 4.635976663896569 CE Loss: 0.25391076326898493 Con Loss: 4.633437552985037
[1 / 10] tensor([[0.984, 0.950],
        [0.790, 0.852]]) {'epoch': 1, 'valid/acc': 86.859, 'valid/acc_unbiased': 88.941, 'valid/diff': 4.071, 'valid/acc_skew': 88.353, 'valid/acc_align': 89.53, 'test/acc': 89.223, 'test/acc_unbiased': 89.381, 'test/diff': 4.806, 'test/acc_skew': 88.692, 'test/acc_align': 90.07}
[1 / 10] best valid accuracy: 88.941 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 86.859, 'best_valid_valid/acc_unbiased': 88.941, 'best_valid_valid/diff': 4.071, 'best_valid_valid/acc_skew': 88.353, 'best_valid_valid/acc_align': 89.53, 'best_valid_test/acc': 89.223, 'best_valid_test/acc_unbiased': 89.381, 'best_valid_test/diff': 4.806, 'best_valid_test/acc_skew': 88.692, 'best_valid_test/acc_align': 90.07}
[1 / 10] best test accuracy: 89.381 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 86.859, 'best_test_valid/acc_unbiased': 88.941, 'best_test_valid/diff': 4.071, 'best_test_valid/acc_skew': 88.353, 'best_test_valid/acc_align': 89.53, 'best_test_test/acc': 89.223, 'best_test_test/acc_unbiased': 89.381, 'best_test_test/diff': 4.806, 'best_test_test/acc_skew': 88.692, 'best_test_test/acc_align': 90.07}
[2 / 10] Learning rate: 0.001 weight: 0.01
[2 / 10] Loss: 4.59933796731901 CE Loss: 0.2261469246116194 Con Loss: 4.597076501240583
[2 / 10] tensor([[0.953, 0.948],
        [0.886, 0.863]]) {'epoch': 2, 'valid/acc': 91.183, 'valid/acc_unbiased': 91.388, 'valid/diff': 1.36, 'valid/acc_skew': 92.067, 'valid/acc_align': 90.708, 'test/acc': 91.509, 'test/acc_unbiased': 91.224, 'test/diff': 1.396, 'test/acc_skew': 91.922, 'test/acc_align': 90.526}
[2 / 10] best valid accuracy: 91.388 at epoch 2 
 best_stats: {'best_valid_epoch': 2, 'best_valid_valid/acc': 91.183, 'best_valid_valid/acc_unbiased': 91.388, 'best_valid_valid/diff': 1.36, 'best_valid_valid/acc_skew': 92.067, 'best_valid_valid/acc_align': 90.708, 'best_valid_test/acc': 91.509, 'best_valid_test/acc_unbiased': 91.224, 'best_valid_test/diff': 1.396, 'best_valid_test/acc_skew': 91.922, 'best_valid_test/acc_align': 90.526}
[2 / 10] best test accuracy: 91.224 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 91.183, 'best_test_valid/acc_unbiased': 91.388, 'best_test_valid/diff': 1.36, 'best_test_valid/acc_skew': 92.067, 'best_test_valid/acc_align': 90.708, 'best_test_test/acc': 91.509, 'best_test_test/acc_unbiased': 91.224, 'best_test_test/diff': 1.396, 'best_test_test/acc_skew': 91.922, 'best_test_test/acc_align': 90.526}
[3 / 10] Learning rate: 0.001 weight: 0.01
[3 / 10] Loss: 4.5954124071749485 CE Loss: 0.2230418919563176 Con Loss: 4.593181980824247
[3 / 10] tensor([[0.946, 0.934],
        [0.899, 0.879]]) {'epoch': 3, 'valid/acc': 91.491, 'valid/acc_unbiased': 91.747, 'valid/diff': 1.168, 'valid/acc_skew': 92.331, 'valid/acc_align': 91.163, 'test/acc': 91.675, 'test/acc_unbiased': 91.444, 'test/diff': 1.596, 'test/acc_skew': 92.242, 'test/acc_align': 90.646}
[3 / 10] best valid accuracy: 91.747 at epoch 3 
 best_stats: {'best_valid_epoch': 3, 'best_valid_valid/acc': 91.491, 'best_valid_valid/acc_unbiased': 91.747, 'best_valid_valid/diff': 1.168, 'best_valid_valid/acc_skew': 92.331, 'best_valid_valid/acc_align': 91.163, 'best_valid_test/acc': 91.675, 'best_valid_test/acc_unbiased': 91.444, 'best_valid_test/diff': 1.596, 'best_valid_test/acc_skew': 92.242, 'best_valid_test/acc_align': 90.646}
[3 / 10] best test accuracy: 91.444 at epoch 3 
 best_stats: {'best_test_epoch': 3, 'best_test_valid/acc': 91.491, 'best_test_valid/acc_unbiased': 91.747, 'best_test_valid/diff': 1.168, 'best_test_valid/acc_skew': 92.331, 'best_test_valid/acc_align': 91.163, 'best_test_test/acc': 91.675, 'best_test_test/acc_unbiased': 91.444, 'best_test_test/diff': 1.596, 'best_test_test/acc_skew': 92.242, 'best_test_test/acc_align': 90.646}
[4 / 10] Learning rate: 0.0001 weight: 0.01
[4 / 10] Loss: 4.549940866886367 CE Loss: 0.195773003695341 Con Loss: 4.5479831441994785
[4 / 10] tensor([[0.938, 0.922],
        [0.927, 0.916]]) {'epoch': 4, 'valid/acc': 92.573, 'valid/acc_unbiased': 92.628, 'valid/diff': 1.439, 'valid/acc_skew': 93.347, 'valid/acc_align': 91.908, 'test/acc': 92.641, 'test/acc_unbiased': 92.542, 'test/diff': 1.33, 'test/acc_skew': 93.207, 'test/acc_align': 91.877}
[4 / 10] best valid accuracy: 92.628 at epoch 4 
 best_stats: {'best_valid_epoch': 4, 'best_valid_valid/acc': 92.573, 'best_valid_valid/acc_unbiased': 92.628, 'best_valid_valid/diff': 1.439, 'best_valid_valid/acc_skew': 93.347, 'best_valid_valid/acc_align': 91.908, 'best_valid_test/acc': 92.641, 'best_valid_test/acc_unbiased': 92.542, 'best_valid_test/diff': 1.33, 'best_valid_test/acc_skew': 93.207, 'best_valid_test/acc_align': 91.877}
[4 / 10] best test accuracy: 92.542 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 92.573, 'best_test_valid/acc_unbiased': 92.628, 'best_test_valid/diff': 1.439, 'best_test_valid/acc_skew': 93.347, 'best_test_valid/acc_align': 91.908, 'best_test_test/acc': 92.641, 'best_test_test/acc_unbiased': 92.542, 'best_test_test/diff': 1.33, 'best_test_test/acc_skew': 93.207, 'best_test_test/acc_align': 91.877}
[5 / 10] Learning rate: 0.0001 weight: 0.01
[5 / 10] Loss: 4.530571208101138 CE Loss: 0.18978189431948947 Con Loss: 4.528673392220238
[5 / 10] tensor([[0.959, 0.935],
        [0.909, 0.892]]) {'epoch': 5, 'valid/acc': 92.117, 'valid/acc_unbiased': 92.475, 'valid/diff': 1.408, 'valid/acc_skew': 93.179, 'valid/acc_align': 91.771, 'test/acc': 92.586, 'test/acc_unbiased': 92.381, 'test/diff': 2.014, 'test/acc_skew': 93.388, 'test/acc_align': 91.374}
[5 / 10] best valid accuracy: 92.628 at epoch 4 
 best_stats: {'best_valid_epoch': 4, 'best_valid_valid/acc': 92.573, 'best_valid_valid/acc_unbiased': 92.628, 'best_valid_valid/diff': 1.439, 'best_valid_valid/acc_skew': 93.347, 'best_valid_valid/acc_align': 91.908, 'best_valid_test/acc': 92.641, 'best_valid_test/acc_unbiased': 92.542, 'best_valid_test/diff': 1.33, 'best_valid_test/acc_skew': 93.207, 'best_valid_test/acc_align': 91.877}
[5 / 10] best test accuracy: 92.542 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 92.573, 'best_test_valid/acc_unbiased': 92.628, 'best_test_valid/diff': 1.439, 'best_test_valid/acc_skew': 93.347, 'best_test_valid/acc_align': 91.908, 'best_test_test/acc': 92.641, 'best_test_test/acc_unbiased': 92.542, 'best_test_test/diff': 1.33, 'best_test_test/acc_skew': 93.207, 'best_test_test/acc_align': 91.877}
[6 / 10] Learning rate: 0.0001 weight: 0.01
[6 / 10] Loss: 4.532847122275025 CE Loss: 0.18517095974547002 Con Loss: 4.530995416617757
[6 / 10] tensor([[0.956, 0.944],
        [0.910, 0.891]]) {'epoch': 6, 'valid/acc': 92.444, 'valid/acc_unbiased': 92.451, 'valid/diff': 1.436, 'valid/acc_skew': 93.169, 'valid/acc_align': 91.734, 'test/acc': 92.742, 'test/acc_unbiased': 92.525, 'test/diff': 1.521, 'test/acc_skew': 93.286, 'test/acc_align': 91.765}
[6 / 10] best valid accuracy: 92.628 at epoch 4 
 best_stats: {'best_valid_epoch': 4, 'best_valid_valid/acc': 92.573, 'best_valid_valid/acc_unbiased': 92.628, 'best_valid_valid/diff': 1.439, 'best_valid_valid/acc_skew': 93.347, 'best_valid_valid/acc_align': 91.908, 'best_valid_test/acc': 92.641, 'best_valid_test/acc_unbiased': 92.542, 'best_valid_test/diff': 1.33, 'best_valid_test/acc_skew': 93.207, 'best_valid_test/acc_align': 91.877}
[6 / 10] best test accuracy: 92.542 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 92.573, 'best_test_valid/acc_unbiased': 92.628, 'best_test_valid/diff': 1.439, 'best_test_valid/acc_skew': 93.347, 'best_test_valid/acc_align': 91.908, 'best_test_test/acc': 92.641, 'best_test_test/acc_unbiased': 92.542, 'best_test_test/diff': 1.33, 'best_test_test/acc_skew': 93.207, 'best_test_test/acc_align': 91.877}
[7 / 10] Learning rate: 1e-05 weight: 0.01
[7 / 10] Loss: 4.522415291904992 CE Loss: 0.18333743207050274 Con Loss: 4.520581926048124
[7 / 10] tensor([[0.949, 0.933],
        [0.918, 0.905]]) {'epoch': 7, 'valid/acc': 92.618, 'valid/acc_unbiased': 92.786, 'valid/diff': 1.195, 'valid/acc_skew': 93.383, 'valid/acc_align': 92.188, 'test/acc': 92.782, 'test/acc_unbiased': 92.636, 'test/diff': 1.457, 'test/acc_skew': 93.364, 'test/acc_align': 91.907}
[7 / 10] best valid accuracy: 92.786 at epoch 7 
 best_stats: {'best_valid_epoch': 7, 'best_valid_valid/acc': 92.618, 'best_valid_valid/acc_unbiased': 92.786, 'best_valid_valid/diff': 1.195, 'best_valid_valid/acc_skew': 93.383, 'best_valid_valid/acc_align': 92.188, 'best_valid_test/acc': 92.782, 'best_valid_test/acc_unbiased': 92.636, 'best_valid_test/diff': 1.457, 'best_valid_test/acc_skew': 93.364, 'best_valid_test/acc_align': 91.907}
[7 / 10] best test accuracy: 92.636 at epoch 7 
 best_stats: {'best_test_epoch': 7, 'best_test_valid/acc': 92.618, 'best_test_valid/acc_unbiased': 92.786, 'best_test_valid/diff': 1.195, 'best_test_valid/acc_skew': 93.383, 'best_test_valid/acc_align': 92.188, 'best_test_test/acc': 92.782, 'best_test_test/acc_unbiased': 92.636, 'best_test_test/diff': 1.457, 'best_test_test/acc_skew': 93.364, 'best_test_test/acc_align': 91.907}
[8 / 10] Learning rate: 1e-05 weight: 0.01
[8 / 10] Loss: 4.519425055007521 CE Loss: 0.18142722979928988 Con Loss: 4.517610784706255
[8 / 10] tensor([[0.955, 0.934],
        [0.916, 0.904]]) {'epoch': 8, 'valid/acc': 92.582, 'valid/acc_unbiased': 92.789, 'valid/diff': 1.267, 'valid/acc_skew': 93.423, 'valid/acc_align': 92.156, 'test/acc': 92.878, 'test/acc_unbiased': 92.731, 'test/diff': 1.615, 'test/acc_skew': 93.539, 'test/acc_align': 91.924}
[8 / 10] best valid accuracy: 92.789 at epoch 8 
 best_stats: {'best_valid_epoch': 8, 'best_valid_valid/acc': 92.582, 'best_valid_valid/acc_unbiased': 92.789, 'best_valid_valid/diff': 1.267, 'best_valid_valid/acc_skew': 93.423, 'best_valid_valid/acc_align': 92.156, 'best_valid_test/acc': 92.878, 'best_valid_test/acc_unbiased': 92.731, 'best_valid_test/diff': 1.615, 'best_valid_test/acc_skew': 93.539, 'best_valid_test/acc_align': 91.924}
[8 / 10] best test accuracy: 92.731 at epoch 8 
 best_stats: {'best_test_epoch': 8, 'best_test_valid/acc': 92.582, 'best_test_valid/acc_unbiased': 92.789, 'best_test_valid/diff': 1.267, 'best_test_valid/acc_skew': 93.423, 'best_test_valid/acc_align': 92.156, 'best_test_test/acc': 92.878, 'best_test_test/acc_unbiased': 92.731, 'best_test_test/diff': 1.615, 'best_test_test/acc_skew': 93.539, 'best_test_test/acc_align': 91.924}
[9 / 10] Learning rate: 1e-05 weight: 0.01
[9 / 10] Loss: 4.5156244839546655 CE Loss: 0.1818041580319698 Con Loss: 4.513806440746884
[9 / 10] tensor([[0.954, 0.931],
        [0.917, 0.909]]) {'epoch': 9, 'valid/acc': 92.667, 'valid/acc_unbiased': 93.04, 'valid/diff': 0.859, 'valid/acc_skew': 93.469, 'valid/acc_align': 92.61, 'test/acc': 92.903, 'test/acc_unbiased': 92.785, 'test/diff': 1.547, 'test/acc_skew': 93.559, 'test/acc_align': 92.012}
[9 / 10] best valid accuracy: 93.040 at epoch 9 
 best_stats: {'best_valid_epoch': 9, 'best_valid_valid/acc': 92.667, 'best_valid_valid/acc_unbiased': 93.04, 'best_valid_valid/diff': 0.859, 'best_valid_valid/acc_skew': 93.469, 'best_valid_valid/acc_align': 92.61, 'best_valid_test/acc': 92.903, 'best_valid_test/acc_unbiased': 92.785, 'best_valid_test/diff': 1.547, 'best_valid_test/acc_skew': 93.559, 'best_valid_test/acc_align': 92.012}
[9 / 10] best test accuracy: 92.785 at epoch 9 
 best_stats: {'best_test_epoch': 9, 'best_test_valid/acc': 92.667, 'best_test_valid/acc_unbiased': 93.04, 'best_test_valid/diff': 0.859, 'best_test_valid/acc_skew': 93.469, 'best_test_valid/acc_align': 92.61, 'best_test_test/acc': 92.903, 'best_test_test/acc_unbiased': 92.785, 'best_test_test/diff': 1.547, 'best_test_test/acc_skew': 93.559, 'best_test_test/acc_align': 92.012}
[10 / 10] Learning rate: 1e-05 weight: 0.01
[10 / 10] Loss: 4.511388800990575 CE Loss: 0.18097395461982604 Con Loss: 4.509579059351025
[10 / 10] tensor([[0.952, 0.931],
        [0.917, 0.912]]) {'epoch': 10, 'valid/acc': 92.627, 'valid/acc_unbiased': 92.949, 'valid/diff': 0.793, 'valid/acc_skew': 93.345, 'valid/acc_align': 92.553, 'test/acc': 92.893, 'test/acc_unbiased': 92.802, 'test/diff': 1.312, 'test/acc_skew': 93.458, 'test/acc_align': 92.146}
[10 / 10] best valid accuracy: 93.040 at epoch 9 
 best_stats: {'best_valid_epoch': 9, 'best_valid_valid/acc': 92.667, 'best_valid_valid/acc_unbiased': 93.04, 'best_valid_valid/diff': 0.859, 'best_valid_valid/acc_skew': 93.469, 'best_valid_valid/acc_align': 92.61, 'best_valid_test/acc': 92.903, 'best_valid_test/acc_unbiased': 92.785, 'best_valid_test/diff': 1.547, 'best_valid_test/acc_skew': 93.559, 'best_valid_test/acc_align': 92.012}
[10 / 10] best test accuracy: 92.802 at epoch 10 
 best_stats: {'best_test_epoch': 10, 'best_test_valid/acc': 92.627, 'best_test_valid/acc_unbiased': 92.949, 'best_test_valid/diff': 0.793, 'best_test_valid/acc_skew': 93.345, 'best_test_valid/acc_align': 92.553, 'best_test_test/acc': 92.893, 'best_test_test/acc_unbiased': 92.802, 'best_test_test/diff': 1.312, 'best_test_test/acc_skew': 93.458, 'best_test_test/acc_align': 92.146}
Total training time: 2:06:07
