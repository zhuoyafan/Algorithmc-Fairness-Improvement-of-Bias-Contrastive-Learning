Log level set to: INFO
Set seed: 3
=======> Using Fixed Random Seed: 3 <========
save_path: exp_results/bc-bb0-utk_face_race-us-0.997-lr0.001-bs2-cbs1-w0.01-ratio10-aug1-seed3
get_utk_face - split: train, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_race-0.997
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [4407, 16]
Target 1: [13, 5529]
Binary Target 1
---------------------------
Target 0: [4407, 16]
Target 1: [13, 5529]
===================================
Normal Label Distribution: 
Target 0: [4407, 16]
Target 1: [13, 5529]
===================================
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [13, 13]
Target 1: [13, 13]
Binary Target 1
---------------------------
Target 0: [13, 13]
Target 1: [13, 13]
===================================
Normal Label Distribution: 
Target 0: [13, 13]
Target 1: [13, 13]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 52, target_attr: gender, bias_attr: race bias_rate: 0.997
['[train] target_0-bias_0: 13', '[train] target_0-bias_1: 13', '[train] target_1-bias_0: 13', '[train] target_1-bias_1: 13']
confusion_matrix - 
 original: tensor([[13., 13.],
        [13., 13.]]), 
 normalized: tensor([[0.500, 0.500],
        [0.500, 0.500]]), 
 b|y: tensor([[0.500, 0.500],
        [0.500, 0.500]])
get_utk_face - split: train, aug: 1, given_y: True, ratio: 10
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_race-0.997
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [4407, 16]
Target 1: [13, 5529]
Binary Target 1
---------------------------
Target 0: [4407, 16]
Target 1: [13, 5529]
===================================
Normal Label Distribution: 
Target 0: [4407, 16]
Target 1: [13, 5529]
===================================
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [13, 13]
Target 1: [13, 13]
Binary Target 1
---------------------------
Target 0: [13, 13]
Target 1: [13, 13]
===================================
Normal Label Distribution: 
Target 0: [13, 13]
Target 1: [13, 13]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 52, target_attr: gender, bias_attr: race bias_rate: 0.997
['[train] target_0-bias_0: 13', '[train] target_0-bias_1: 13', '[train] target_1-bias_0: 13', '[train] target_1-bias_1: 13']
get_utk_face - split: valid, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_race-0.997
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [583, 684]
Target 1: [457, 646]
Binary Target 1
---------------------------
Target 0: [583, 684]
Target 1: [457, 646]
===================================
Normal Label Distribution: 
Target 0: [583, 684]
Target 1: [457, 646]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 2370, target_attr: gender, bias_attr: race bias_rate: 0.997
['[valid] target_0-bias_0: 583', '[valid] target_0-bias_1: 684', '[valid] target_1-bias_0: 457', '[valid] target_1-bias_1: 646']
get_utk_face - split: test, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_race-0.997
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [558, 677]
Target 1: [462, 673]
Binary Target 1
---------------------------
Target 0: [558, 677]
Target 1: [462, 673]
===================================
Normal Label Distribution: 
Target 0: [558, 677]
Target 1: [462, 673]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 2370, target_attr: gender, bias_attr: race bias_rate: 0.997
['[test] target_0-bias_0: 558', '[test] target_0-bias_1: 677', '[test] target_1-bias_0: 462', '[test] target_1-bias_1: 673']
decay_epochs: [6, 13]
[1 / 20] Learning rate: 0.001 weight: 0.01
[1 / 20] Loss: 0.017127512112962835 CE Loss: 1.7127512557288775 Con Loss: 0.0
[1 / 20] tensor([[0.751, 0.771],
        [0.340, 0.318]]) {'epoch': 1, 'valid/acc': 55.612, 'valid/acc_unbiased': 54.353, 'valid/diff': 2.385, 'valid/acc_skew': 55.546, 'valid/acc_align': 53.16, 'test/acc': 55.359, 'test/acc_unbiased': 54.494, 'test/diff': 2.1, 'test/acc_skew': 54.536, 'test/acc_align': 54.451}
[1 / 20] best valid accuracy: 54.353 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 55.612, 'best_valid_valid/acc_unbiased': 54.353, 'best_valid_valid/diff': 2.385, 'best_valid_valid/acc_skew': 55.546, 'best_valid_valid/acc_align': 53.16, 'best_valid_test/acc': 55.359, 'best_valid_test/acc_unbiased': 54.494, 'best_valid_test/diff': 2.1, 'best_valid_test/acc_skew': 54.536, 'best_valid_test/acc_align': 54.451}
[1 / 20] best test accuracy: 54.494 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 55.612, 'best_test_valid/acc_unbiased': 54.353, 'best_test_valid/diff': 2.385, 'best_test_valid/acc_skew': 55.546, 'best_test_valid/acc_align': 53.16, 'best_test_test/acc': 55.359, 'best_test_test/acc_unbiased': 54.494, 'best_test_test/diff': 2.1, 'best_test_test/acc_skew': 54.536, 'best_test_test/acc_align': 54.451}
[2 / 20] Learning rate: 0.001 weight: 0.01
[2 / 20] Loss: 0.009399430772576194 CE Loss: 0.939943096958674 Con Loss: 0.0
[2 / 20] tensor([[0.208, 0.257],
        [0.760, 0.816]]) {'epoch': 2, 'valid/acc': 50.464, 'valid/acc_unbiased': 52.026, 'valid/diff': 6.054, 'valid/acc_skew': 48.999, 'valid/acc_align': 55.052, 'test/acc': 50.211, 'test/acc_unbiased': 51.01, 'test/diff': 5.257, 'test/acc_skew': 48.381, 'test/acc_align': 53.638}
[2 / 20] best valid accuracy: 54.353 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 55.612, 'best_valid_valid/acc_unbiased': 54.353, 'best_valid_valid/diff': 2.385, 'best_valid_valid/acc_skew': 55.546, 'best_valid_valid/acc_align': 53.16, 'best_valid_test/acc': 55.359, 'best_valid_test/acc_unbiased': 54.494, 'best_valid_test/diff': 2.1, 'best_valid_test/acc_skew': 54.536, 'best_valid_test/acc_align': 54.451}
[2 / 20] best test accuracy: 54.494 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 55.612, 'best_test_valid/acc_unbiased': 54.353, 'best_test_valid/diff': 2.385, 'best_test_valid/acc_skew': 55.546, 'best_test_valid/acc_align': 53.16, 'best_test_test/acc': 55.359, 'best_test_test/acc_unbiased': 54.494, 'best_test_test/diff': 2.1, 'best_test_test/acc_skew': 54.536, 'best_test_test/acc_align': 54.451}
[3 / 20] Learning rate: 0.001 weight: 0.01
[3 / 20] Loss: 0.008626853814348578 CE Loss: 0.8626854041448007 Con Loss: 0.0
[3 / 20] tensor([[0.152, 0.207],
        [0.892, 0.865]]) {'epoch': 3, 'valid/acc': 51.308, 'valid/acc_unbiased': 53.582, 'valid/diff': 6.603, 'valid/acc_skew': 52.162, 'valid/acc_align': 55.001, 'test/acc': 51.435, 'test/acc_unbiased': 52.892, 'test/diff': 4.073, 'test/acc_skew': 52.205, 'test/acc_align': 53.579}
[3 / 20] best valid accuracy: 54.353 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 55.612, 'best_valid_valid/acc_unbiased': 54.353, 'best_valid_valid/diff': 2.385, 'best_valid_valid/acc_skew': 55.546, 'best_valid_valid/acc_align': 53.16, 'best_valid_test/acc': 55.359, 'best_valid_test/acc_unbiased': 54.494, 'best_valid_test/diff': 2.1, 'best_valid_test/acc_skew': 54.536, 'best_valid_test/acc_align': 54.451}
[3 / 20] best test accuracy: 54.494 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 55.612, 'best_test_valid/acc_unbiased': 54.353, 'best_test_valid/diff': 2.385, 'best_test_valid/acc_skew': 55.546, 'best_test_valid/acc_align': 53.16, 'best_test_test/acc': 55.359, 'best_test_test/acc_unbiased': 54.494, 'best_test_test/diff': 2.1, 'best_test_test/acc_skew': 54.536, 'best_test_test/acc_align': 54.451}
[4 / 20] Learning rate: 0.001 weight: 0.01
[4 / 20] Loss: 0.007971962636265043 CE Loss: 0.7971962759127984 Con Loss: 0.0
[4 / 20] tensor([[0.514, 0.391],
        [0.535, 0.639]]) {'epoch': 4, 'valid/acc': 52.025, 'valid/acc_unbiased': 52.064, 'valid/diff': 11.111, 'valid/acc_skew': 50.559, 'valid/acc_align': 53.569, 'test/acc': 51.857, 'test/acc_unbiased': 51.983, 'test/diff': 11.36, 'test/acc_skew': 52.448, 'test/acc_align': 51.518}
[4 / 20] best valid accuracy: 54.353 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 55.612, 'best_valid_valid/acc_unbiased': 54.353, 'best_valid_valid/diff': 2.385, 'best_valid_valid/acc_skew': 55.546, 'best_valid_valid/acc_align': 53.16, 'best_valid_test/acc': 55.359, 'best_valid_test/acc_unbiased': 54.494, 'best_valid_test/diff': 2.1, 'best_valid_test/acc_skew': 54.536, 'best_valid_test/acc_align': 54.451}
[4 / 20] best test accuracy: 54.494 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 55.612, 'best_test_valid/acc_unbiased': 54.353, 'best_test_valid/diff': 2.385, 'best_test_valid/acc_skew': 55.546, 'best_test_valid/acc_align': 53.16, 'best_test_test/acc': 55.359, 'best_test_test/acc_unbiased': 54.494, 'best_test_test/diff': 2.1, 'best_test_test/acc_skew': 54.536, 'best_test_test/acc_align': 54.451}
[5 / 20] Learning rate: 0.001 weight: 0.01
[5 / 20] Loss: 0.007902197253245574 CE Loss: 0.790219743664448 Con Loss: 0.0
[5 / 20] tensor([[0.948, 0.944],
        [0.100, 0.031]]) {'epoch': 5, 'valid/acc': 54.388, 'valid/acc_unbiased': 51.606, 'valid/diff': 4.073, 'valid/acc_skew': 52.859, 'valid/acc_align': 50.353, 'test/acc': 52.11, 'test/acc_unbiased': 50.567, 'test/diff': 3.626, 'test/acc_skew': 52.38, 'test/acc_align': 48.754}
[5 / 20] best valid accuracy: 54.353 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 55.612, 'best_valid_valid/acc_unbiased': 54.353, 'best_valid_valid/diff': 2.385, 'best_valid_valid/acc_skew': 55.546, 'best_valid_valid/acc_align': 53.16, 'best_valid_test/acc': 55.359, 'best_valid_test/acc_unbiased': 54.494, 'best_valid_test/diff': 2.1, 'best_valid_test/acc_skew': 54.536, 'best_valid_test/acc_align': 54.451}
[5 / 20] best test accuracy: 54.494 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 55.612, 'best_test_valid/acc_unbiased': 54.353, 'best_test_valid/diff': 2.385, 'best_test_valid/acc_skew': 55.546, 'best_test_valid/acc_align': 53.16, 'best_test_test/acc': 55.359, 'best_test_test/acc_unbiased': 54.494, 'best_test_test/diff': 2.1, 'best_test_test/acc_skew': 54.536, 'best_test_test/acc_align': 54.451}
[6 / 20] Learning rate: 0.001 weight: 0.01
[6 / 20] Loss: 0.006869591056154325 CE Loss: 0.6869591210897152 Con Loss: 0.0
[6 / 20] tensor([[0.090, 0.145],
        [0.926, 0.868]]) {'epoch': 6, 'valid/acc': 46.92, 'valid/acc_unbiased': 49.952, 'valid/diff': 5.226, 'valid/acc_skew': 51.396, 'valid/acc_align': 48.508, 'test/acc': 48.945, 'test/acc_unbiased': 50.713, 'test/diff': 5.69, 'test/acc_skew': 50.801, 'test/acc_align': 50.626}
[6 / 20] best valid accuracy: 54.353 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 55.612, 'best_valid_valid/acc_unbiased': 54.353, 'best_valid_valid/diff': 2.385, 'best_valid_valid/acc_skew': 55.546, 'best_valid_valid/acc_align': 53.16, 'best_valid_test/acc': 55.359, 'best_valid_test/acc_unbiased': 54.494, 'best_valid_test/diff': 2.1, 'best_valid_test/acc_skew': 54.536, 'best_valid_test/acc_align': 54.451}
[6 / 20] best test accuracy: 54.494 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 55.612, 'best_test_valid/acc_unbiased': 54.353, 'best_test_valid/diff': 2.385, 'best_test_valid/acc_skew': 55.546, 'best_test_valid/acc_align': 53.16, 'best_test_test/acc': 55.359, 'best_test_test/acc_unbiased': 54.494, 'best_test_test/diff': 2.1, 'best_test_test/acc_skew': 54.536, 'best_test_test/acc_align': 54.451}
[7 / 20] Learning rate: 0.0001 weight: 0.01
[7 / 20] Loss: 0.009022008967944063 CE Loss: 0.9022009166387411 Con Loss: 0.0
[7 / 20] tensor([[0.292, 0.405],
        [0.766, 0.577]]) {'epoch': 7, 'valid/acc': 49.156, 'valid/acc_unbiased': 50.557, 'valid/diff': 12.615, 'valid/acc_skew': 51.38, 'valid/acc_align': 49.733, 'test/acc': 49.747, 'test/acc_unbiased': 50.99, 'test/diff': 15.116, 'test/acc_skew': 52.917, 'test/acc_align': 49.062}
[7 / 20] best valid accuracy: 54.353 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 55.612, 'best_valid_valid/acc_unbiased': 54.353, 'best_valid_valid/diff': 2.385, 'best_valid_valid/acc_skew': 55.546, 'best_valid_valid/acc_align': 53.16, 'best_valid_test/acc': 55.359, 'best_valid_test/acc_unbiased': 54.494, 'best_valid_test/diff': 2.1, 'best_valid_test/acc_skew': 54.536, 'best_valid_test/acc_align': 54.451}
[7 / 20] best test accuracy: 54.494 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 55.612, 'best_test_valid/acc_unbiased': 54.353, 'best_test_valid/diff': 2.385, 'best_test_valid/acc_skew': 55.546, 'best_test_valid/acc_align': 53.16, 'best_test_test/acc': 55.359, 'best_test_test/acc_unbiased': 54.494, 'best_test_test/diff': 2.1, 'best_test_test/acc_skew': 54.536, 'best_test_test/acc_align': 54.451}
[8 / 20] Learning rate: 0.0001 weight: 0.01
[8 / 20] Loss: 0.0073121344545283 CE Loss: 0.7312134561630396 Con Loss: 0.0
[8 / 20] tensor([[0.692, 0.762],
        [0.353, 0.314]]) {'epoch': 8, 'valid/acc': 56.16, 'valid/acc_unbiased': 54.676, 'valid/diff': 4.678, 'valid/acc_skew': 52.911, 'valid/acc_align': 56.441, 'test/acc': 53.84, 'test/acc_unbiased': 53.007, 'test/diff': 5.486, 'test/acc_skew': 52.229, 'test/acc_align': 53.785}
[8 / 20] best valid accuracy: 54.676 at epoch 8 
 best_stats: {'best_valid_epoch': 8, 'best_valid_valid/acc': 56.16, 'best_valid_valid/acc_unbiased': 54.676, 'best_valid_valid/diff': 4.678, 'best_valid_valid/acc_skew': 52.911, 'best_valid_valid/acc_align': 56.441, 'best_valid_test/acc': 53.84, 'best_valid_test/acc_unbiased': 53.007, 'best_valid_test/diff': 5.486, 'best_valid_test/acc_skew': 52.229, 'best_valid_test/acc_align': 53.785}
[8 / 20] best test accuracy: 54.494 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 55.612, 'best_test_valid/acc_unbiased': 54.353, 'best_test_valid/diff': 2.385, 'best_test_valid/acc_skew': 55.546, 'best_test_valid/acc_align': 53.16, 'best_test_test/acc': 55.359, 'best_test_test/acc_unbiased': 54.494, 'best_test_test/diff': 2.1, 'best_test_test/acc_skew': 54.536, 'best_test_test/acc_align': 54.451}
[9 / 20] Learning rate: 0.0001 weight: 0.01
[9 / 20] Loss: 0.007579187808844905 CE Loss: 0.7579187980064979 Con Loss: 0.0
[9 / 20] tensor([[0.324, 0.427],
        [0.714, 0.557]]) {'epoch': 9, 'valid/acc': 50.549, 'valid/acc_unbiased': 51.836, 'valid/diff': 11.376, 'valid/acc_skew': 54.107, 'valid/acc_align': 49.566, 'test/acc': 49.578, 'test/acc_unbiased': 50.569, 'test/diff': 12.979, 'test/acc_skew': 51.933, 'test/acc_align': 49.204}
[9 / 20] best valid accuracy: 54.676 at epoch 8 
 best_stats: {'best_valid_epoch': 8, 'best_valid_valid/acc': 56.16, 'best_valid_valid/acc_unbiased': 54.676, 'best_valid_valid/diff': 4.678, 'best_valid_valid/acc_skew': 52.911, 'best_valid_valid/acc_align': 56.441, 'best_valid_test/acc': 53.84, 'best_valid_test/acc_unbiased': 53.007, 'best_valid_test/diff': 5.486, 'best_valid_test/acc_skew': 52.229, 'best_valid_test/acc_align': 53.785}
[9 / 20] best test accuracy: 54.494 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 55.612, 'best_test_valid/acc_unbiased': 54.353, 'best_test_valid/diff': 2.385, 'best_test_valid/acc_skew': 55.546, 'best_test_valid/acc_align': 53.16, 'best_test_test/acc': 55.359, 'best_test_test/acc_unbiased': 54.494, 'best_test_test/diff': 2.1, 'best_test_test/acc_skew': 54.536, 'best_test_test/acc_align': 54.451}
[10 / 20] Learning rate: 0.0001 weight: 0.01
[10 / 20] Loss: 0.006737875268579676 CE Loss: 0.6737875491380692 Con Loss: 0.0
[10 / 20] tensor([[0.547, 0.623],
        [0.545, 0.480]]) {'epoch': 10, 'valid/acc': 55.063, 'valid/acc_unbiased': 54.938, 'valid/diff': 7.84, 'valid/acc_skew': 54.672, 'valid/acc_align': 55.203, 'test/acc': 54.937, 'test/acc_unbiased': 54.883, 'test/diff': 7.113, 'test/acc_skew': 54.602, 'test/acc_align': 55.164}
[10 / 20] best valid accuracy: 54.938 at epoch 10 
 best_stats: {'best_valid_epoch': 10, 'best_valid_valid/acc': 55.063, 'best_valid_valid/acc_unbiased': 54.938, 'best_valid_valid/diff': 7.84, 'best_valid_valid/acc_skew': 54.672, 'best_valid_valid/acc_align': 55.203, 'best_valid_test/acc': 54.937, 'best_valid_test/acc_unbiased': 54.883, 'best_valid_test/diff': 7.113, 'best_valid_test/acc_skew': 54.602, 'best_valid_test/acc_align': 55.164}
[10 / 20] best test accuracy: 54.883 at epoch 10 
 best_stats: {'best_test_epoch': 10, 'best_test_valid/acc': 55.063, 'best_test_valid/acc_unbiased': 54.938, 'best_test_valid/diff': 7.84, 'best_test_valid/acc_skew': 54.672, 'best_test_valid/acc_align': 55.203, 'best_test_test/acc': 54.937, 'best_test_test/acc_unbiased': 54.883, 'best_test_test/diff': 7.113, 'best_test_test/acc_skew': 54.602, 'best_test_test/acc_align': 55.164}
[11 / 20] Learning rate: 0.0001 weight: 0.01
[11 / 20] Loss: 0.006687623842691 CE Loss: 0.6687624018925887 Con Loss: 0.0
[11 / 20] tensor([[0.627, 0.656],
        [0.385, 0.458]]) {'epoch': 11, 'valid/acc': 55.485, 'valid/acc_unbiased': 54.541, 'valid/diff': 3.324, 'valid/acc_skew': 53.798, 'valid/acc_align': 55.285, 'test/acc': 54.008, 'test/acc_unbiased': 53.15, 'test/diff': 5.048, 'test/acc_skew': 50.626, 'test/acc_align': 55.674}
[11 / 20] best valid accuracy: 54.938 at epoch 10 
 best_stats: {'best_valid_epoch': 10, 'best_valid_valid/acc': 55.063, 'best_valid_valid/acc_unbiased': 54.938, 'best_valid_valid/diff': 7.84, 'best_valid_valid/acc_skew': 54.672, 'best_valid_valid/acc_align': 55.203, 'best_valid_test/acc': 54.937, 'best_valid_test/acc_unbiased': 54.883, 'best_valid_test/diff': 7.113, 'best_valid_test/acc_skew': 54.602, 'best_valid_test/acc_align': 55.164}
[11 / 20] best test accuracy: 54.883 at epoch 10 
 best_stats: {'best_test_epoch': 10, 'best_test_valid/acc': 55.063, 'best_test_valid/acc_unbiased': 54.938, 'best_test_valid/diff': 7.84, 'best_test_valid/acc_skew': 54.672, 'best_test_valid/acc_align': 55.203, 'best_test_test/acc': 54.937, 'best_test_test/acc_unbiased': 54.883, 'best_test_test/diff': 7.113, 'best_test_test/acc_skew': 54.602, 'best_test_test/acc_align': 55.164}
[12 / 20] Learning rate: 0.0001 weight: 0.01
[12 / 20] Loss: 0.006968361549437619 CE Loss: 0.6968361689494207 Con Loss: 0.0
[12 / 20] tensor([[0.360, 0.285],
        [0.636, 0.820]]) {'epoch': 12, 'valid/acc': 51.941, 'valid/acc_unbiased': 52.949, 'valid/diff': 11.598, 'valid/acc_skew': 51.309, 'valid/acc_align': 54.588, 'test/acc': 52.321, 'test/acc_unbiased': 52.547, 'test/diff': 12.949, 'test/acc_skew': 49.829, 'test/acc_align': 55.264}
[12 / 20] best valid accuracy: 54.938 at epoch 10 
 best_stats: {'best_valid_epoch': 10, 'best_valid_valid/acc': 55.063, 'best_valid_valid/acc_unbiased': 54.938, 'best_valid_valid/diff': 7.84, 'best_valid_valid/acc_skew': 54.672, 'best_valid_valid/acc_align': 55.203, 'best_valid_test/acc': 54.937, 'best_valid_test/acc_unbiased': 54.883, 'best_valid_test/diff': 7.113, 'best_valid_test/acc_skew': 54.602, 'best_valid_test/acc_align': 55.164}
[12 / 20] best test accuracy: 54.883 at epoch 10 
 best_stats: {'best_test_epoch': 10, 'best_test_valid/acc': 55.063, 'best_test_valid/acc_unbiased': 54.938, 'best_test_valid/diff': 7.84, 'best_test_valid/acc_skew': 54.672, 'best_test_valid/acc_align': 55.203, 'best_test_test/acc': 54.937, 'best_test_test/acc_unbiased': 54.883, 'best_test_test/diff': 7.113, 'best_test_test/acc_skew': 54.602, 'best_test_test/acc_align': 55.164}
[13 / 20] Learning rate: 0.0001 weight: 0.01
[13 / 20] Loss: 0.006615889643748792 CE Loss: 0.6615889737239251 Con Loss: 0.0
[13 / 20] tensor([[0.375, 0.414],
        [0.706, 0.756]]) {'epoch': 13, 'valid/acc': 54.515, 'valid/acc_unbiased': 55.534, 'valid/diff': 3.665, 'valid/acc_skew': 53.701, 'valid/acc_align': 57.366, 'test/acc': 55.865, 'test/acc_unbiased': 56.252, 'test/diff': 4.486, 'test/acc_skew': 54.009, 'test/acc_align': 58.495}
[13 / 20] best valid accuracy: 55.534 at epoch 13 
 best_stats: {'best_valid_epoch': 13, 'best_valid_valid/acc': 54.515, 'best_valid_valid/acc_unbiased': 55.534, 'best_valid_valid/diff': 3.665, 'best_valid_valid/acc_skew': 53.701, 'best_valid_valid/acc_align': 57.366, 'best_valid_test/acc': 55.865, 'best_valid_test/acc_unbiased': 56.252, 'best_valid_test/diff': 4.486, 'best_valid_test/acc_skew': 54.009, 'best_valid_test/acc_align': 58.495}
[13 / 20] best test accuracy: 56.252 at epoch 13 
 best_stats: {'best_test_epoch': 13, 'best_test_valid/acc': 54.515, 'best_test_valid/acc_unbiased': 55.534, 'best_test_valid/diff': 3.665, 'best_test_valid/acc_skew': 53.701, 'best_test_valid/acc_align': 57.366, 'best_test_test/acc': 55.865, 'best_test_test/acc_unbiased': 56.252, 'best_test_test/diff': 4.486, 'best_test_test/acc_skew': 54.009, 'best_test_test/acc_align': 58.495}
[14 / 20] Learning rate: 1e-05 weight: 0.01
[14 / 20] Loss: 0.006911668460816145 CE Loss: 0.6911668662841504 Con Loss: 0.0
[14 / 20] tensor([[0.305, 0.347],
        [0.777, 0.814]]) {'epoch': 14, 'valid/acc': 54.641, 'valid/acc_unbiased': 56.001, 'valid/diff': 4.304, 'valid/acc_skew': 53.849, 'valid/acc_align': 58.153, 'test/acc': 55.359, 'test/acc_unbiased': 56.077, 'test/diff': 3.983, 'test/acc_skew': 54.086, 'test/acc_align': 58.069}
[14 / 20] best valid accuracy: 56.001 at epoch 14 
 best_stats: {'best_valid_epoch': 14, 'best_valid_valid/acc': 54.641, 'best_valid_valid/acc_unbiased': 56.001, 'best_valid_valid/diff': 4.304, 'best_valid_valid/acc_skew': 53.849, 'best_valid_valid/acc_align': 58.153, 'best_valid_test/acc': 55.359, 'best_valid_test/acc_unbiased': 56.077, 'best_valid_test/diff': 3.983, 'best_valid_test/acc_skew': 54.086, 'best_valid_test/acc_align': 58.069}
[14 / 20] best test accuracy: 56.252 at epoch 13 
 best_stats: {'best_test_epoch': 13, 'best_test_valid/acc': 54.515, 'best_test_valid/acc_unbiased': 55.534, 'best_test_valid/diff': 3.665, 'best_test_valid/acc_skew': 53.701, 'best_test_valid/acc_align': 57.366, 'best_test_test/acc': 55.865, 'best_test_test/acc_unbiased': 56.252, 'best_test_test/diff': 4.486, 'best_test_test/acc_skew': 54.009, 'best_test_test/acc_align': 58.495}
[15 / 20] Learning rate: 1e-05 weight: 0.01
[15 / 20] Loss: 0.006555424976305893 CE Loss: 0.6555425112064068 Con Loss: 0.0
[15 / 20] tensor([[0.606, 0.650],
        [0.522, 0.502]]) {'epoch': 15, 'valid/acc': 59.494, 'valid/acc_unbiased': 59.06, 'valid/diff': 3.91, 'valid/acc_skew': 58.032, 'valid/acc_align': 60.088, 'test/acc': 57.257, 'test/acc_unbiased': 56.988, 'test/diff': 3.18, 'test/acc_skew': 56.369, 'test/acc_align': 57.608}
[15 / 20] best valid accuracy: 59.060 at epoch 15 
 best_stats: {'best_valid_epoch': 15, 'best_valid_valid/acc': 59.494, 'best_valid_valid/acc_unbiased': 59.06, 'best_valid_valid/diff': 3.91, 'best_valid_valid/acc_skew': 58.032, 'best_valid_valid/acc_align': 60.088, 'best_valid_test/acc': 57.257, 'best_valid_test/acc_unbiased': 56.988, 'best_valid_test/diff': 3.18, 'best_valid_test/acc_skew': 56.369, 'best_valid_test/acc_align': 57.608}
[15 / 20] best test accuracy: 56.988 at epoch 15 
 best_stats: {'best_test_epoch': 15, 'best_test_valid/acc': 59.494, 'best_test_valid/acc_unbiased': 59.06, 'best_test_valid/diff': 3.91, 'best_test_valid/acc_skew': 58.032, 'best_test_valid/acc_align': 60.088, 'best_test_test/acc': 57.257, 'best_test_test/acc_unbiased': 56.988, 'best_test_test/diff': 3.18, 'best_test_test/acc_skew': 56.369, 'best_test_test/acc_align': 57.608}
[16 / 20] Learning rate: 1e-05 weight: 0.01
[16 / 20] Loss: 0.006867095281799825 CE Loss: 0.6867095438333658 Con Loss: 0.0
[16 / 20] tensor([[0.489, 0.557],
        [0.606, 0.621]]) {'epoch': 16, 'valid/acc': 57.679, 'valid/acc_unbiased': 57.862, 'valid/diff': 3.274, 'valid/acc_skew': 56.225, 'valid/acc_align': 59.499, 'test/acc': 56.878, 'test/acc_unbiased': 56.832, 'test/diff': 4.133, 'test/acc_skew': 54.765, 'test/acc_align': 58.898}
[16 / 20] best valid accuracy: 59.060 at epoch 15 
 best_stats: {'best_valid_epoch': 15, 'best_valid_valid/acc': 59.494, 'best_valid_valid/acc_unbiased': 59.06, 'best_valid_valid/diff': 3.91, 'best_valid_valid/acc_skew': 58.032, 'best_valid_valid/acc_align': 60.088, 'best_valid_test/acc': 57.257, 'best_valid_test/acc_unbiased': 56.988, 'best_valid_test/diff': 3.18, 'best_valid_test/acc_skew': 56.369, 'best_valid_test/acc_align': 57.608}
[16 / 20] best test accuracy: 56.988 at epoch 15 
 best_stats: {'best_test_epoch': 15, 'best_test_valid/acc': 59.494, 'best_test_valid/acc_unbiased': 59.06, 'best_test_valid/diff': 3.91, 'best_test_valid/acc_skew': 58.032, 'best_test_valid/acc_align': 60.088, 'best_test_test/acc': 57.257, 'best_test_test/acc_unbiased': 56.988, 'best_test_test/diff': 3.18, 'best_test_test/acc_skew': 56.369, 'best_test_test/acc_align': 57.608}
[17 / 20] Learning rate: 1e-05 weight: 0.01
[17 / 20] Loss: 0.006618900520082276 CE Loss: 0.661890066587008 Con Loss: 0.0
[17 / 20] tensor([[0.595, 0.638],
        [0.485, 0.489]]) {'epoch': 17, 'valid/acc': 58.27, 'valid/acc_unbiased': 57.903, 'valid/diff': 3.813, 'valid/acc_skew': 57.446, 'valid/acc_align': 58.359, 'test/acc': 55.57, 'test/acc_unbiased': 55.17, 'test/diff': 2.357, 'test/acc_skew': 53.992, 'test/acc_align': 56.348}
[17 / 20] best valid accuracy: 59.060 at epoch 15 
 best_stats: {'best_valid_epoch': 15, 'best_valid_valid/acc': 59.494, 'best_valid_valid/acc_unbiased': 59.06, 'best_valid_valid/diff': 3.91, 'best_valid_valid/acc_skew': 58.032, 'best_valid_valid/acc_align': 60.088, 'best_valid_test/acc': 57.257, 'best_valid_test/acc_unbiased': 56.988, 'best_valid_test/diff': 3.18, 'best_valid_test/acc_skew': 56.369, 'best_valid_test/acc_align': 57.608}
[17 / 20] best test accuracy: 56.988 at epoch 15 
 best_stats: {'best_test_epoch': 15, 'best_test_valid/acc': 59.494, 'best_test_valid/acc_unbiased': 59.06, 'best_test_valid/diff': 3.91, 'best_test_valid/acc_skew': 58.032, 'best_test_valid/acc_align': 60.088, 'best_test_test/acc': 57.257, 'best_test_test/acc_unbiased': 56.988, 'best_test_test/diff': 3.18, 'best_test_test/acc_skew': 56.369, 'best_test_test/acc_align': 57.608}
[18 / 20] Learning rate: 1e-05 weight: 0.01
[18 / 20] Loss: 0.006748727504880383 CE Loss: 0.6748727582968198 Con Loss: 0.0
[18 / 20] tensor([[0.556, 0.601],
        [0.576, 0.563]]) {'epoch': 18, 'valid/acc': 59.451, 'valid/acc_unbiased': 59.309, 'valid/diff': 3.105, 'valid/acc_skew': 57.757, 'valid/acc_align': 60.862, 'test/acc': 57.468, 'test/acc_unbiased': 57.391, 'test/diff': 2.912, 'test/acc_skew': 56.566, 'test/acc_align': 58.217}
[18 / 20] best valid accuracy: 59.309 at epoch 18 
 best_stats: {'best_valid_epoch': 18, 'best_valid_valid/acc': 59.451, 'best_valid_valid/acc_unbiased': 59.309, 'best_valid_valid/diff': 3.105, 'best_valid_valid/acc_skew': 57.757, 'best_valid_valid/acc_align': 60.862, 'best_valid_test/acc': 57.468, 'best_valid_test/acc_unbiased': 57.391, 'best_valid_test/diff': 2.912, 'best_valid_test/acc_skew': 56.566, 'best_valid_test/acc_align': 58.217}
[18 / 20] best test accuracy: 57.391 at epoch 18 
 best_stats: {'best_test_epoch': 18, 'best_test_valid/acc': 59.451, 'best_test_valid/acc_unbiased': 59.309, 'best_test_valid/diff': 3.105, 'best_test_valid/acc_skew': 57.757, 'best_test_valid/acc_align': 60.862, 'best_test_test/acc': 57.468, 'best_test_test/acc_unbiased': 57.391, 'best_test_test/diff': 2.912, 'best_test_test/acc_skew': 56.566, 'best_test_test/acc_align': 58.217}
[19 / 20] Learning rate: 1e-05 weight: 0.01
[19 / 20] Loss: 0.006055674479844479 CE Loss: 0.6055674564379913 Con Loss: 0.0
[19 / 20] tensor([[0.566, 0.579],
        [0.595, 0.615]]) {'epoch': 19, 'valid/acc': 59.325, 'valid/acc_unbiased': 59.307, 'valid/diff': 3.409, 'valid/acc_skew': 57.603, 'valid/acc_align': 61.012, 'test/acc': 58.945, 'test/acc_unbiased': 58.893, 'test/diff': 1.632, 'test/acc_skew': 58.077, 'test/acc_align': 59.709}
[19 / 20] best valid accuracy: 59.309 at epoch 18 
 best_stats: {'best_valid_epoch': 18, 'best_valid_valid/acc': 59.451, 'best_valid_valid/acc_unbiased': 59.309, 'best_valid_valid/diff': 3.105, 'best_valid_valid/acc_skew': 57.757, 'best_valid_valid/acc_align': 60.862, 'best_valid_test/acc': 57.468, 'best_valid_test/acc_unbiased': 57.391, 'best_valid_test/diff': 2.912, 'best_valid_test/acc_skew': 56.566, 'best_valid_test/acc_align': 58.217}
[19 / 20] best test accuracy: 58.893 at epoch 19 
 best_stats: {'best_test_epoch': 19, 'best_test_valid/acc': 59.325, 'best_test_valid/acc_unbiased': 59.307, 'best_test_valid/diff': 3.409, 'best_test_valid/acc_skew': 57.603, 'best_test_valid/acc_align': 61.012, 'best_test_test/acc': 58.945, 'best_test_test/acc_unbiased': 58.893, 'best_test_test/diff': 1.632, 'best_test_test/acc_skew': 58.077, 'best_test_test/acc_align': 59.709}
[20 / 20] Learning rate: 1e-05 weight: 0.01
[20 / 20] Loss: 0.006637724626880999 CE Loss: 0.6637724775534409 Con Loss: 0.0
[20 / 20] tensor([[0.536, 0.554],
        [0.587, 0.630]]) {'epoch': 20, 'valid/acc': 58.776, 'valid/acc_unbiased': 58.793, 'valid/diff': 3.801, 'valid/acc_skew': 56.893, 'valid/acc_align': 60.694, 'test/acc': 57.764, 'test/acc_unbiased': 57.659, 'test/diff': 3.075, 'test/acc_skew': 56.121, 'test/acc_align': 59.196}
[20 / 20] best valid accuracy: 59.309 at epoch 18 
 best_stats: {'best_valid_epoch': 18, 'best_valid_valid/acc': 59.451, 'best_valid_valid/acc_unbiased': 59.309, 'best_valid_valid/diff': 3.105, 'best_valid_valid/acc_skew': 57.757, 'best_valid_valid/acc_align': 60.862, 'best_valid_test/acc': 57.468, 'best_valid_test/acc_unbiased': 57.391, 'best_valid_test/diff': 2.912, 'best_valid_test/acc_skew': 56.566, 'best_valid_test/acc_align': 58.217}
[20 / 20] best test accuracy: 58.893 at epoch 19 
 best_stats: {'best_test_epoch': 19, 'best_test_valid/acc': 59.325, 'best_test_valid/acc_unbiased': 59.307, 'best_test_valid/diff': 3.409, 'best_test_valid/acc_skew': 57.603, 'best_test_valid/acc_align': 61.012, 'best_test_test/acc': 58.945, 'best_test_test/acc_unbiased': 58.893, 'best_test_test/diff': 1.632, 'best_test_test/acc_skew': 58.077, 'best_test_test/acc_align': 59.709}
Total training time: 0:14:53
