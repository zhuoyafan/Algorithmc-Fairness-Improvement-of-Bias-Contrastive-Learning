Log level set to: INFO
Set seed: 3
=======> Using Fixed Random Seed: 3 <========
save_path: exp_results/bc-bb0-celeba_blonde-rand1-lr0.001-bs128-cbs64-w0.01-ratio30-aug1-seed3
get_celeba - split:train, aug: False, given_y: True, ratio: 0
use existing blonde indices from data/celeba/pickles/blonde
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [1628, 53486]
Target 1: [18293, 1105]
Binary Target 1
---------------------------
Target 0: [1628, 53486]
Target 1: [18293, 1105]
===================================
Normal Label Distribution: 
Target 0: [1628, 53486]
Target 1: [18293, 1105]
===================================
Use BiasedCelebASplit 
 target_attr: blonde split: train 
 tensor([[ 1628., 18293.],
        [53486.,  1105.]])
get_celeba - split:train, aug: 1, given_y: True, ratio: 30
use existing blonde indices from data/celeba/pickles/blonde
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [1599, 53508]
Target 1: [18327, 1078]
Binary Target 1
---------------------------
Target 0: [1599, 53508]
Target 1: [18327, 1078]
===================================
Normal Label Distribution: 
Target 0: [1599, 53508]
Target 1: [18327, 1078]
===================================
Use BiasedCelebASplit 
 target_attr: blonde split: train 
 tensor([[ 1599., 18327.],
        [53508.,  1078.]])
get_celeba - split:train_valid, aug: False, given_y: True, ratio: 0
use existing blonde indices from data/celeba/pickles/blonde
Use BiasedCelebASplit 
 target_attr: blonde split: train_valid 
 tensor([[  386.,  4517.],
        [13446.,   280.]])
get_celeba - split:valid, aug: False, given_y: True, ratio: 0
Use BiasedCelebASplit 
 target_attr: blonde split: valid 
 tensor([[8535., 2874.],
        [8276.,  182.]])
decay_epochs: [3, 6]
[1 / 10] Learning rate: 0.001 weight: 0.01
[1 / 10] Loss: 4.70442484969716 CE Loss: 0.20704023571457375 Con Loss: 4.702354452756948
[1 / 10] tensor([[0.795, 0.927],
        [0.957, 0.863]]) {'epoch': 1, 'valid/acc': 92.581, 'valid/acc_unbiased': 90.343, 'valid/diff': 6.462, 'valid/acc_skew': 87.112, 'valid/acc_align': 93.575, 'test/acc': 87.396, 'test/acc_unbiased': 88.534, 'test/diff': 11.32, 'test/acc_skew': 82.874, 'test/acc_align': 94.194}
[1 / 10] best valid accuracy: 90.343 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 92.581, 'best_valid_valid/acc_unbiased': 90.343, 'best_valid_valid/diff': 6.462, 'best_valid_valid/acc_skew': 87.112, 'best_valid_valid/acc_align': 93.575, 'best_valid_test/acc': 87.396, 'best_valid_test/acc_unbiased': 88.534, 'best_valid_test/diff': 11.32, 'best_valid_test/acc_skew': 82.874, 'best_valid_test/acc_align': 94.194}
[1 / 10] best test accuracy: 88.534 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 92.581, 'best_test_valid/acc_unbiased': 90.343, 'best_test_valid/diff': 6.462, 'best_test_valid/acc_skew': 87.112, 'best_test_valid/acc_align': 93.575, 'best_test_test/acc': 87.396, 'best_test_test/acc_unbiased': 88.534, 'best_test_test/diff': 11.32, 'best_test_test/acc_skew': 82.874, 'best_test_test/acc_align': 94.194}
[2 / 10] Learning rate: 0.001 weight: 0.01
[2 / 10] Loss: 4.661611881383069 CE Loss: 0.18221147537922588 Con Loss: 4.659789762195917
[2 / 10] tensor([[0.897, 0.959],
        [0.912, 0.808]]) {'epoch': 2, 'valid/acc': 93.956, 'valid/acc_unbiased': 90.685, 'valid/diff': 5.082, 'valid/acc_skew': 88.334, 'valid/acc_align': 93.037, 'test/acc': 92.404, 'test/acc_unbiased': 89.39, 'test/diff': 8.332, 'test/acc_skew': 85.224, 'test/acc_align': 93.556}
[2 / 10] best valid accuracy: 90.685 at epoch 2 
 best_stats: {'best_valid_epoch': 2, 'best_valid_valid/acc': 93.956, 'best_valid_valid/acc_unbiased': 90.685, 'best_valid_valid/diff': 5.082, 'best_valid_valid/acc_skew': 88.334, 'best_valid_valid/acc_align': 93.037, 'best_valid_test/acc': 92.404, 'best_valid_test/acc_unbiased': 89.39, 'best_valid_test/diff': 8.332, 'best_valid_test/acc_skew': 85.224, 'best_valid_test/acc_align': 93.556}
[2 / 10] best test accuracy: 89.390 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 93.956, 'best_test_valid/acc_unbiased': 90.685, 'best_test_valid/diff': 5.082, 'best_test_valid/acc_skew': 88.334, 'best_test_valid/acc_align': 93.037, 'best_test_test/acc': 92.404, 'best_test_test/acc_unbiased': 89.39, 'best_test_test/diff': 8.332, 'best_test_test/acc_skew': 85.224, 'best_test_test/acc_align': 93.556}
[3 / 10] Learning rate: 0.001 weight: 0.01
[3 / 10] Loss: 4.6416863427542046 CE Loss: 0.17417416889248474 Con Loss: 4.639944599553805
[3 / 10] tensor([[0.949, 0.987],
        [0.810, 0.511]]) {'epoch': 3, 'valid/acc': 93.467, 'valid/acc_unbiased': 84.489, 'valid/diff': 10.681, 'valid/acc_skew': 79.482, 'valid/acc_align': 89.496, 'test/acc': 94.055, 'test/acc_unbiased': 81.41, 'test/diff': 16.818, 'test/acc_skew': 73.001, 'test/acc_align': 89.819}
[3 / 10] best valid accuracy: 90.685 at epoch 2 
 best_stats: {'best_valid_epoch': 2, 'best_valid_valid/acc': 93.956, 'best_valid_valid/acc_unbiased': 90.685, 'best_valid_valid/diff': 5.082, 'best_valid_valid/acc_skew': 88.334, 'best_valid_valid/acc_align': 93.037, 'best_valid_test/acc': 92.404, 'best_valid_test/acc_unbiased': 89.39, 'best_valid_test/diff': 8.332, 'best_valid_test/acc_skew': 85.224, 'best_valid_test/acc_align': 93.556}
[3 / 10] best test accuracy: 89.390 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 93.956, 'best_test_valid/acc_unbiased': 90.685, 'best_test_valid/diff': 5.082, 'best_test_valid/acc_skew': 88.334, 'best_test_valid/acc_align': 93.037, 'best_test_test/acc': 92.404, 'best_test_test/acc_unbiased': 89.39, 'best_test_test/diff': 8.332, 'best_test_test/acc_skew': 85.224, 'best_test_test/acc_align': 93.556}
[4 / 10] Learning rate: 0.0001 weight: 0.01
[4 / 10] Loss: 4.595633832379833 CE Loss: 0.14884019778737034 Con Loss: 4.59414542671025
[4 / 10] tensor([[0.912, 0.969],
        [0.920, 0.835]]) {'epoch': 4, 'valid/acc': 95.158, 'valid/acc_unbiased': 92.77, 'valid/diff': 3.514, 'valid/acc_skew': 91.303, 'valid/acc_align': 94.237, 'test/acc': 93.618, 'test/acc_unbiased': 90.902, 'test/diff': 7.087, 'test/acc_skew': 87.359, 'test/acc_align': 94.446}
[4 / 10] best valid accuracy: 92.770 at epoch 4 
 best_stats: {'best_valid_epoch': 4, 'best_valid_valid/acc': 95.158, 'best_valid_valid/acc_unbiased': 92.77, 'best_valid_valid/diff': 3.514, 'best_valid_valid/acc_skew': 91.303, 'best_valid_valid/acc_align': 94.237, 'best_valid_test/acc': 93.618, 'best_valid_test/acc_unbiased': 90.902, 'best_valid_test/diff': 7.087, 'best_valid_test/acc_skew': 87.359, 'best_valid_test/acc_align': 94.446}
[4 / 10] best test accuracy: 90.902 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 95.158, 'best_test_valid/acc_unbiased': 92.77, 'best_test_valid/diff': 3.514, 'best_test_valid/acc_skew': 91.303, 'best_test_valid/acc_align': 94.237, 'best_test_test/acc': 93.618, 'best_test_test/acc_unbiased': 90.902, 'best_test_test/diff': 7.087, 'best_test_test/acc_skew': 87.359, 'best_test_test/acc_align': 94.446}
[5 / 10] Learning rate: 0.0001 weight: 0.01
[5 / 10] Loss: 4.5682535905655755 CE Loss: 0.14484278771155173 Con Loss: 4.566805158020832
[5 / 10] tensor([[0.899, 0.968],
        [0.928, 0.830]]) {'epoch': 5, 'valid/acc': 95.464, 'valid/acc_unbiased': 93.705, 'valid/diff': 4.171, 'valid/acc_skew': 92.406, 'valid/acc_align': 95.004, 'test/acc': 93.165, 'test/acc_unbiased': 90.642, 'test/diff': 8.37, 'test/acc_skew': 86.457, 'test/acc_align': 94.827}
[5 / 10] best valid accuracy: 93.705 at epoch 5 
 best_stats: {'best_valid_epoch': 5, 'best_valid_valid/acc': 95.464, 'best_valid_valid/acc_unbiased': 93.705, 'best_valid_valid/diff': 4.171, 'best_valid_valid/acc_skew': 92.406, 'best_valid_valid/acc_align': 95.004, 'best_valid_test/acc': 93.165, 'best_valid_test/acc_unbiased': 90.642, 'best_valid_test/diff': 8.37, 'best_valid_test/acc_skew': 86.457, 'best_valid_test/acc_align': 94.827}
[5 / 10] best test accuracy: 90.902 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 95.158, 'best_test_valid/acc_unbiased': 92.77, 'best_test_valid/diff': 3.514, 'best_test_valid/acc_skew': 91.303, 'best_test_valid/acc_align': 94.237, 'best_test_test/acc': 93.618, 'best_test_test/acc_unbiased': 90.902, 'best_test_test/diff': 7.087, 'best_test_test/acc_skew': 87.359, 'best_test_test/acc_align': 94.446}
[6 / 10] Learning rate: 0.0001 weight: 0.01
[6 / 10] Loss: 4.553521315836973 CE Loss: 0.13745240919933518 Con Loss: 4.552146790184789
[6 / 10] tensor([[0.912, 0.972],
        [0.912, 0.780]]) {'epoch': 6, 'valid/acc': 95.459, 'valid/acc_unbiased': 93.547, 'valid/diff': 3.596, 'valid/acc_skew': 92.745, 'valid/acc_align': 94.349, 'test/acc': 93.587, 'test/acc_unbiased': 89.416, 'test/diff': 9.633, 'test/acc_skew': 84.6, 'test/acc_align': 94.232}
[6 / 10] best valid accuracy: 93.705 at epoch 5 
 best_stats: {'best_valid_epoch': 5, 'best_valid_valid/acc': 95.464, 'best_valid_valid/acc_unbiased': 93.705, 'best_valid_valid/diff': 4.171, 'best_valid_valid/acc_skew': 92.406, 'best_valid_valid/acc_align': 95.004, 'best_valid_test/acc': 93.165, 'best_valid_test/acc_unbiased': 90.642, 'best_valid_test/diff': 8.37, 'best_valid_test/acc_skew': 86.457, 'best_valid_test/acc_align': 94.827}
[6 / 10] best test accuracy: 90.902 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 95.158, 'best_test_valid/acc_unbiased': 92.77, 'best_test_valid/diff': 3.514, 'best_test_valid/acc_skew': 91.303, 'best_test_valid/acc_align': 94.237, 'best_test_test/acc': 93.618, 'best_test_test/acc_unbiased': 90.902, 'best_test_test/diff': 7.087, 'best_test_test/acc_skew': 87.359, 'best_test_test/acc_align': 94.446}
[7 / 10] Learning rate: 1e-05 weight: 0.01
[7 / 10] Loss: 4.54221699712408 CE Loss: 0.1301363026141314 Con Loss: 4.540915638176392
[7 / 10] tensor([[0.907, 0.972],
        [0.923, 0.791]]) {'epoch': 7, 'valid/acc': 95.614, 'valid/acc_unbiased': 93.685, 'valid/diff': 3.946, 'valid/acc_skew': 92.616, 'valid/acc_align': 94.755, 'test/acc': 93.517, 'test/acc_unbiased': 89.823, 'test/diff': 9.874, 'test/acc_skew': 84.886, 'test/acc_align': 94.76}
[7 / 10] best valid accuracy: 93.705 at epoch 5 
 best_stats: {'best_valid_epoch': 5, 'best_valid_valid/acc': 95.464, 'best_valid_valid/acc_unbiased': 93.705, 'best_valid_valid/diff': 4.171, 'best_valid_valid/acc_skew': 92.406, 'best_valid_valid/acc_align': 95.004, 'best_valid_test/acc': 93.165, 'best_valid_test/acc_unbiased': 90.642, 'best_valid_test/diff': 8.37, 'best_valid_test/acc_skew': 86.457, 'best_valid_test/acc_align': 94.827}
[7 / 10] best test accuracy: 90.902 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 95.158, 'best_test_valid/acc_unbiased': 92.77, 'best_test_valid/diff': 3.514, 'best_test_valid/acc_skew': 91.303, 'best_test_valid/acc_align': 94.237, 'best_test_test/acc': 93.618, 'best_test_test/acc_unbiased': 90.902, 'best_test_test/diff': 7.087, 'best_test_test/acc_skew': 87.359, 'best_test_test/acc_align': 94.446}
[8 / 10] Learning rate: 1e-05 weight: 0.01
[8 / 10] Loss: 4.541364499215586 CE Loss: 0.13079952415169271 Con Loss: 4.540056506937759
[8 / 10] tensor([[0.914, 0.975],
        [0.916, 0.786]]) {'epoch': 8, 'valid/acc': 95.727, 'valid/acc_unbiased': 93.627, 'valid/diff': 3.763, 'valid/acc_skew': 92.696, 'valid/acc_align': 94.557, 'test/acc': 93.829, 'test/acc_unbiased': 89.762, 'test/diff': 9.588, 'test/acc_skew': 84.968, 'test/acc_align': 94.556}
[8 / 10] best valid accuracy: 93.705 at epoch 5 
 best_stats: {'best_valid_epoch': 5, 'best_valid_valid/acc': 95.464, 'best_valid_valid/acc_unbiased': 93.705, 'best_valid_valid/diff': 4.171, 'best_valid_valid/acc_skew': 92.406, 'best_valid_valid/acc_align': 95.004, 'best_valid_test/acc': 93.165, 'best_valid_test/acc_unbiased': 90.642, 'best_valid_test/diff': 8.37, 'best_valid_test/acc_skew': 86.457, 'best_valid_test/acc_align': 94.827}
[8 / 10] best test accuracy: 90.902 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 95.158, 'best_test_valid/acc_unbiased': 92.77, 'best_test_valid/diff': 3.514, 'best_test_valid/acc_skew': 91.303, 'best_test_valid/acc_align': 94.237, 'best_test_test/acc': 93.618, 'best_test_test/acc_unbiased': 90.902, 'best_test_test/diff': 7.087, 'best_test_test/acc_skew': 87.359, 'best_test_test/acc_align': 94.446}
[9 / 10] Learning rate: 1e-05 weight: 0.01
[9 / 10] Loss: 4.532720125819676 CE Loss: 0.1286006064752358 Con Loss: 4.5314341149464274
[9 / 10] tensor([[0.912, 0.974],
        [0.919, 0.791]]) {'epoch': 9, 'valid/acc': 95.727, 'valid/acc_unbiased': 94.003, 'valid/diff': 3.696, 'valid/acc_skew': 93.232, 'valid/acc_align': 94.774, 'test/acc': 93.784, 'test/acc_unbiased': 89.916, 'test/diff': 9.51, 'test/acc_skew': 85.161, 'test/acc_align': 94.671}
[9 / 10] best valid accuracy: 94.003 at epoch 9 
 best_stats: {'best_valid_epoch': 9, 'best_valid_valid/acc': 95.727, 'best_valid_valid/acc_unbiased': 94.003, 'best_valid_valid/diff': 3.696, 'best_valid_valid/acc_skew': 93.232, 'best_valid_valid/acc_align': 94.774, 'best_valid_test/acc': 93.784, 'best_valid_test/acc_unbiased': 89.916, 'best_valid_test/diff': 9.51, 'best_valid_test/acc_skew': 85.161, 'best_valid_test/acc_align': 94.671}
[9 / 10] best test accuracy: 90.902 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 95.158, 'best_test_valid/acc_unbiased': 92.77, 'best_test_valid/diff': 3.514, 'best_test_valid/acc_skew': 91.303, 'best_test_valid/acc_align': 94.237, 'best_test_test/acc': 93.618, 'best_test_test/acc_unbiased': 90.902, 'best_test_test/diff': 7.087, 'best_test_test/acc_skew': 87.359, 'best_test_test/acc_align': 94.446}
[10 / 10] Learning rate: 1e-05 weight: 0.01
[10 / 10] Loss: 4.52931343098682 CE Loss: 0.13004383010262197 Con Loss: 4.528012993767304
[10 / 10] tensor([[0.911, 0.973],
        [0.920, 0.786]]) {'epoch': 10, 'valid/acc': 95.636, 'valid/acc_unbiased': 93.846, 'valid/diff': 3.375, 'valid/acc_skew': 93.102, 'valid/acc_align': 94.59, 'test/acc': 93.703, 'test/acc_unbiased': 89.745, 'test/diff': 9.812, 'test/acc_skew': 84.839, 'test/acc_align': 94.651}
[10 / 10] best valid accuracy: 94.003 at epoch 9 
 best_stats: {'best_valid_epoch': 9, 'best_valid_valid/acc': 95.727, 'best_valid_valid/acc_unbiased': 94.003, 'best_valid_valid/diff': 3.696, 'best_valid_valid/acc_skew': 93.232, 'best_valid_valid/acc_align': 94.774, 'best_valid_test/acc': 93.784, 'best_valid_test/acc_unbiased': 89.916, 'best_valid_test/diff': 9.51, 'best_valid_test/acc_skew': 85.161, 'best_valid_test/acc_align': 94.671}
[10 / 10] best test accuracy: 90.902 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 95.158, 'best_test_valid/acc_unbiased': 92.77, 'best_test_valid/diff': 3.514, 'best_test_valid/acc_skew': 91.303, 'best_test_valid/acc_align': 94.237, 'best_test_test/acc': 93.618, 'best_test_test/acc_unbiased': 90.902, 'best_test_test/diff': 7.087, 'best_test_test/acc_skew': 87.359, 'best_test_test/acc_align': 94.446}
Total training time: 0:39:22
