Log level set to: INFO
Set seed: 2
=======> Using Fixed Random Seed: 2 <========
save_path: exp_results/bc-bb0-celeba_blonde-os_trival-lr0.001-bs128-cbs64-w0.01-ratio30-aug1-seed2
get_celeba - split:train, aug: False, given_y: True, ratio: 0
use existing blonde indices from data/celeba/pickles/blonde
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [53554, 53554]
Target 1: [53554, 53554]
Binary Target 1
---------------------------
Target 0: [53554, 53554]
Target 1: [53554, 53554]
===================================
Normal Label Distribution: 
Target 0: [53554, 53554]
Target 1: [53554, 53554]
===================================
Use BiasedCelebASplit 
 target_attr: blonde split: train 
 tensor([[53554., 53554.],
        [53554., 53554.]])
get_celeba - split:train, aug: 1, given_y: True, ratio: 30
use existing blonde indices from data/celeba/pickles/blonde
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [53474, 53474]
Target 1: [53474, 53474]
Binary Target 1
---------------------------
Target 0: [53474, 53474]
Target 1: [53474, 53474]
===================================
Normal Label Distribution: 
Target 0: [53474, 53474]
Target 1: [53474, 53474]
===================================
Use BiasedCelebASplit 
 target_attr: blonde split: train 
 tensor([[53474., 53474.],
        [53474., 53474.]])
get_celeba - split:train_valid, aug: False, given_y: True, ratio: 0
use existing blonde indices from data/celeba/pickles/blonde
Use BiasedCelebASplit 
 target_attr: blonde split: train_valid 
 tensor([[  403.,  4597.],
        [13344.,   285.]])
get_celeba - split:valid, aug: False, given_y: True, ratio: 0
Use BiasedCelebASplit 
 target_attr: blonde split: valid 
 tensor([[8535., 2874.],
        [8276.,  182.]])
decay_epochs: [3, 6]
[1 / 10] Learning rate: 0.001 weight: 0.01
[1 / 10] Loss: 4.628293133611822 CE Loss: 0.23336502354059663 Con Loss: 4.6259594870748
[1 / 10] tensor([[0.865, 0.932],
        [0.955, 0.962]]) {'epoch': 1, 'valid/acc': 93.478, 'valid/acc_unbiased': 93.398, 'valid/diff': 1.665, 'valid/acc_skew': 94.231, 'valid/acc_align': 92.566, 'test/acc': 90.703, 'test/acc_unbiased': 92.853, 'test/diff': 3.669, 'test/acc_skew': 91.019, 'test/acc_align': 94.688}
[1 / 10] best valid accuracy: 93.398 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 93.478, 'best_valid_valid/acc_unbiased': 93.398, 'best_valid_valid/diff': 1.665, 'best_valid_valid/acc_skew': 94.231, 'best_valid_valid/acc_align': 92.566, 'best_valid_test/acc': 90.703, 'best_valid_test/acc_unbiased': 92.853, 'best_valid_test/diff': 3.669, 'best_valid_test/acc_skew': 91.019, 'best_valid_test/acc_align': 94.688}
[1 / 10] best test accuracy: 92.853 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 93.478, 'best_test_valid/acc_unbiased': 93.398, 'best_test_valid/diff': 1.665, 'best_test_valid/acc_skew': 94.231, 'best_test_valid/acc_align': 92.566, 'best_test_test/acc': 90.703, 'best_test_test/acc_unbiased': 92.853, 'best_test_test/diff': 3.669, 'best_test_test/acc_skew': 91.019, 'best_test_test/acc_align': 94.688}
[2 / 10] Learning rate: 0.001 weight: 0.01
[2 / 10] Loss: 4.589095766017144 CE Loss: 0.19912493811836743 Con Loss: 4.587104516678093
[2 / 10] tensor([[0.821, 0.920],
        [0.972, 0.973]]) {'epoch': 2, 'valid/acc': 93.065, 'valid/acc_unbiased': 93.724, 'valid/diff': 1.378, 'valid/acc_skew': 93.353, 'valid/acc_align': 94.094, 'test/acc': 88.549, 'test/acc_unbiased': 92.142, 'test/diff': 5.018, 'test/acc_skew': 89.633, 'test/acc_align': 94.651}
[2 / 10] best valid accuracy: 93.724 at epoch 2 
 best_stats: {'best_valid_epoch': 2, 'best_valid_valid/acc': 93.065, 'best_valid_valid/acc_unbiased': 93.724, 'best_valid_valid/diff': 1.378, 'best_valid_valid/acc_skew': 93.353, 'best_valid_valid/acc_align': 94.094, 'best_valid_test/acc': 88.549, 'best_valid_test/acc_unbiased': 92.142, 'best_valid_test/diff': 5.018, 'best_valid_test/acc_skew': 89.633, 'best_valid_test/acc_align': 94.651}
[2 / 10] best test accuracy: 92.853 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 93.478, 'best_test_valid/acc_unbiased': 93.398, 'best_test_valid/diff': 1.665, 'best_test_valid/acc_skew': 94.231, 'best_test_valid/acc_align': 92.566, 'best_test_test/acc': 90.703, 'best_test_test/acc_unbiased': 92.853, 'best_test_test/diff': 3.669, 'best_test_test/acc_skew': 91.019, 'best_test_test/acc_align': 94.688}
[3 / 10] Learning rate: 0.001 weight: 0.01
[3 / 10] Loss: 4.56284664592265 CE Loss: 0.1858899326510242 Con Loss: 4.560987745615474
[3 / 10] tensor([[0.772, 0.894],
        [0.977, 0.934]]) {'epoch': 3, 'valid/acc': 91.562, 'valid/acc_unbiased': 92.528, 'valid/diff': 2.375, 'valid/acc_skew': 92.829, 'valid/acc_align': 92.227, 'test/acc': 85.378, 'test/acc_unbiased': 89.422, 'test/diff': 8.261, 'test/acc_skew': 87.457, 'test/acc_align': 91.387}
[3 / 10] best valid accuracy: 93.724 at epoch 2 
 best_stats: {'best_valid_epoch': 2, 'best_valid_valid/acc': 93.065, 'best_valid_valid/acc_unbiased': 93.724, 'best_valid_valid/diff': 1.378, 'best_valid_valid/acc_skew': 93.353, 'best_valid_valid/acc_align': 94.094, 'best_valid_test/acc': 88.549, 'best_valid_test/acc_unbiased': 92.142, 'best_valid_test/diff': 5.018, 'best_valid_test/acc_skew': 89.633, 'best_valid_test/acc_align': 94.651}
[3 / 10] best test accuracy: 92.853 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 93.478, 'best_test_valid/acc_unbiased': 93.398, 'best_test_valid/diff': 1.665, 'best_test_valid/acc_skew': 94.231, 'best_test_valid/acc_align': 92.566, 'best_test_test/acc': 90.703, 'best_test_test/acc_unbiased': 92.853, 'best_test_test/diff': 3.669, 'best_test_test/acc_skew': 91.019, 'best_test_test/acc_align': 94.688}
[4 / 10] Learning rate: 0.0001 weight: 0.01
[4 / 10] Loss: 4.492420725742848 CE Loss: 0.1483504946838217 Con Loss: 4.490937218564751
[4 / 10] tensor([[0.881, 0.951],
        [0.949, 0.896]]) {'epoch': 4, 'valid/acc': 94.863, 'valid/acc_unbiased': 96.562, 'valid/diff': 3.385, 'valid/acc_skew': 96.706, 'valid/acc_align': 96.417, 'test/acc': 92.017, 'test/acc_unbiased': 91.921, 'test/diff': 6.221, 'test/acc_skew': 91.49, 'test/acc_align': 92.352}
[4 / 10] best valid accuracy: 96.562 at epoch 4 
 best_stats: {'best_valid_epoch': 4, 'best_valid_valid/acc': 94.863, 'best_valid_valid/acc_unbiased': 96.562, 'best_valid_valid/diff': 3.385, 'best_valid_valid/acc_skew': 96.706, 'best_valid_valid/acc_align': 96.417, 'best_valid_test/acc': 92.017, 'best_valid_test/acc_unbiased': 91.921, 'best_valid_test/diff': 6.221, 'best_valid_test/acc_skew': 91.49, 'best_valid_test/acc_align': 92.352}
[4 / 10] best test accuracy: 92.853 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 93.478, 'best_test_valid/acc_unbiased': 93.398, 'best_test_valid/diff': 1.665, 'best_test_valid/acc_skew': 94.231, 'best_test_valid/acc_align': 92.566, 'best_test_test/acc': 90.703, 'best_test_test/acc_unbiased': 92.853, 'best_test_test/diff': 3.669, 'best_test_test/acc_skew': 91.019, 'best_test_test/acc_align': 94.688}
[5 / 10] Learning rate: 0.0001 weight: 0.01
[5 / 10] Loss: 4.469735588678195 CE Loss: 0.13636887388073418 Con Loss: 4.468371909091287
[5 / 10] tensor([[0.842, 0.944],
        [0.966, 0.896]]) {'epoch': 5, 'valid/acc': 94.675, 'valid/acc_unbiased': 96.518, 'valid/diff': 2.438, 'valid/acc_skew': 96.664, 'valid/acc_align': 96.371, 'test/acc': 90.29, 'test/acc_unbiased': 91.187, 'test/diff': 8.573, 'test/acc_skew': 90.416, 'test/acc_align': 91.959}
[5 / 10] best valid accuracy: 96.562 at epoch 4 
 best_stats: {'best_valid_epoch': 4, 'best_valid_valid/acc': 94.863, 'best_valid_valid/acc_unbiased': 96.562, 'best_valid_valid/diff': 3.385, 'best_valid_valid/acc_skew': 96.706, 'best_valid_valid/acc_align': 96.417, 'best_valid_test/acc': 92.017, 'best_valid_test/acc_unbiased': 91.921, 'best_valid_test/diff': 6.221, 'best_valid_test/acc_skew': 91.49, 'best_valid_test/acc_align': 92.352}
[5 / 10] best test accuracy: 92.853 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 93.478, 'best_test_valid/acc_unbiased': 93.398, 'best_test_valid/diff': 1.665, 'best_test_valid/acc_skew': 94.231, 'best_test_valid/acc_align': 92.566, 'best_test_test/acc': 90.703, 'best_test_test/acc_unbiased': 92.853, 'best_test_test/diff': 3.669, 'best_test_test/acc_skew': 91.019, 'best_test_test/acc_align': 94.688}
[6 / 10] Learning rate: 0.0001 weight: 0.01
[6 / 10] Loss: 4.450088624651136 CE Loss: 0.12768690213330114 Con Loss: 4.4488117470032345
[6 / 10] tensor([[0.852, 0.952],
        [0.962, 0.896]]) {'epoch': 6, 'valid/acc': 95.185, 'valid/acc_unbiased': 96.412, 'valid/diff': 1.742, 'valid/acc_skew': 96.727, 'valid/acc_align': 96.097, 'test/acc': 90.995, 'test/acc_unbiased': 91.546, 'test/diff': 8.305, 'test/acc_skew': 90.734, 'test/acc_align': 92.358}
[6 / 10] best valid accuracy: 96.562 at epoch 4 
 best_stats: {'best_valid_epoch': 4, 'best_valid_valid/acc': 94.863, 'best_valid_valid/acc_unbiased': 96.562, 'best_valid_valid/diff': 3.385, 'best_valid_valid/acc_skew': 96.706, 'best_valid_valid/acc_align': 96.417, 'best_valid_test/acc': 92.017, 'best_valid_test/acc_unbiased': 91.921, 'best_valid_test/diff': 6.221, 'best_valid_test/acc_skew': 91.49, 'best_valid_test/acc_align': 92.352}
[6 / 10] best test accuracy: 92.853 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 93.478, 'best_test_valid/acc_unbiased': 93.398, 'best_test_valid/diff': 1.665, 'best_test_valid/acc_skew': 94.231, 'best_test_valid/acc_align': 92.566, 'best_test_test/acc': 90.703, 'best_test_test/acc_unbiased': 92.853, 'best_test_test/diff': 3.669, 'best_test_test/acc_skew': 91.019, 'best_test_test/acc_align': 94.688}
[7 / 10] Learning rate: 1e-05 weight: 0.01
[7 / 10] Loss: 4.443424533799546 CE Loss: 0.12026667582722514 Con Loss: 4.4422218714915385
[7 / 10] tensor([[0.842, 0.950],
        [0.965, 0.901]]) {'epoch': 7, 'valid/acc': 95.303, 'valid/acc_unbiased': 96.673, 'valid/diff': 1.716, 'valid/acc_skew': 97.28, 'valid/acc_align': 96.067, 'test/acc': 90.512, 'test/acc_unbiased': 91.432, 'test/diff': 8.548, 'test/acc_skew': 90.329, 'test/acc_align': 92.536}
[7 / 10] best valid accuracy: 96.673 at epoch 7 
 best_stats: {'best_valid_epoch': 7, 'best_valid_valid/acc': 95.303, 'best_valid_valid/acc_unbiased': 96.673, 'best_valid_valid/diff': 1.716, 'best_valid_valid/acc_skew': 97.28, 'best_valid_valid/acc_align': 96.067, 'best_valid_test/acc': 90.512, 'best_valid_test/acc_unbiased': 91.432, 'best_valid_test/diff': 8.548, 'best_valid_test/acc_skew': 90.329, 'best_valid_test/acc_align': 92.536}
[7 / 10] best test accuracy: 92.853 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 93.478, 'best_test_valid/acc_unbiased': 93.398, 'best_test_valid/diff': 1.665, 'best_test_valid/acc_skew': 94.231, 'best_test_valid/acc_align': 92.566, 'best_test_test/acc': 90.703, 'best_test_test/acc_unbiased': 92.853, 'best_test_test/diff': 3.669, 'best_test_test/acc_skew': 91.019, 'best_test_test/acc_align': 94.688}
[8 / 10] Learning rate: 1e-05 weight: 0.01
[8 / 10] Loss: 4.433221942276062 CE Loss: 0.11855519636333017 Con Loss: 4.432036384669137
[8 / 10] tensor([[0.845, 0.952],
        [0.964, 0.890]]) {'epoch': 8, 'valid/acc': 95.335, 'valid/acc_unbiased': 96.873, 'valid/diff': 2.164, 'valid/acc_skew': 97.474, 'valid/acc_align': 96.272, 'test/acc': 90.723, 'test/acc_unbiased': 91.282, 'test/diff': 9.055, 'test/acc_skew': 90.458, 'test/acc_align': 92.107}
[8 / 10] best valid accuracy: 96.873 at epoch 8 
 best_stats: {'best_valid_epoch': 8, 'best_valid_valid/acc': 95.335, 'best_valid_valid/acc_unbiased': 96.873, 'best_valid_valid/diff': 2.164, 'best_valid_valid/acc_skew': 97.474, 'best_valid_valid/acc_align': 96.272, 'best_valid_test/acc': 90.723, 'best_valid_test/acc_unbiased': 91.282, 'best_valid_test/diff': 9.055, 'best_valid_test/acc_skew': 90.458, 'best_valid_test/acc_align': 92.107}
[8 / 10] best test accuracy: 92.853 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 93.478, 'best_test_valid/acc_unbiased': 93.398, 'best_test_valid/diff': 1.665, 'best_test_valid/acc_skew': 94.231, 'best_test_valid/acc_align': 92.566, 'best_test_test/acc': 90.703, 'best_test_test/acc_unbiased': 92.853, 'best_test_test/diff': 3.669, 'best_test_test/acc_skew': 91.019, 'best_test_test/acc_align': 94.688}
[9 / 10] Learning rate: 1e-05 weight: 0.01
[9 / 10] Loss: 4.431306644137251 CE Loss: 0.11722845821163673 Con Loss: 4.430134351300611
[9 / 10] tensor([[0.846, 0.952],
        [0.968, 0.879]]) {'epoch': 9, 'valid/acc': 95.443, 'valid/acc_unbiased': 96.9, 'valid/diff': 2.11, 'valid/acc_skew': 97.441, 'valid/acc_align': 96.358, 'test/acc': 90.779, 'test/acc_unbiased': 91.109, 'test/diff': 9.736, 'test/acc_skew': 90.684, 'test/acc_align': 91.533}
[9 / 10] best valid accuracy: 96.900 at epoch 9 
 best_stats: {'best_valid_epoch': 9, 'best_valid_valid/acc': 95.443, 'best_valid_valid/acc_unbiased': 96.9, 'best_valid_valid/diff': 2.11, 'best_valid_valid/acc_skew': 97.441, 'best_valid_valid/acc_align': 96.358, 'best_valid_test/acc': 90.779, 'best_valid_test/acc_unbiased': 91.109, 'best_valid_test/diff': 9.736, 'best_valid_test/acc_skew': 90.684, 'best_valid_test/acc_align': 91.533}
[9 / 10] best test accuracy: 92.853 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 93.478, 'best_test_valid/acc_unbiased': 93.398, 'best_test_valid/diff': 1.665, 'best_test_valid/acc_skew': 94.231, 'best_test_valid/acc_align': 92.566, 'best_test_test/acc': 90.703, 'best_test_test/acc_unbiased': 92.853, 'best_test_test/diff': 3.669, 'best_test_test/acc_skew': 91.019, 'best_test_test/acc_align': 94.688}
[10 / 10] Learning rate: 1e-05 weight: 0.01
[10 / 10] Loss: 4.428085465371914 CE Loss: 0.11511958265959445 Con Loss: 4.426934265914987
[10 / 10] tensor([[0.832, 0.952],
        [0.969, 0.923]]) {'epoch': 10, 'valid/acc': 95.512, 'valid/acc_unbiased': 97.088, 'valid/diff': 2.084, 'valid/acc_skew': 97.68, 'valid/acc_align': 96.496, 'test/acc': 90.275, 'test/acc_unbiased': 91.903, 'test/diff': 8.253, 'test/acc_skew': 90.057, 'test/acc_align': 93.749}
[10 / 10] best valid accuracy: 97.088 at epoch 10 
 best_stats: {'best_valid_epoch': 10, 'best_valid_valid/acc': 95.512, 'best_valid_valid/acc_unbiased': 97.088, 'best_valid_valid/diff': 2.084, 'best_valid_valid/acc_skew': 97.68, 'best_valid_valid/acc_align': 96.496, 'best_valid_test/acc': 90.275, 'best_valid_test/acc_unbiased': 91.903, 'best_valid_test/diff': 8.253, 'best_valid_test/acc_skew': 90.057, 'best_valid_test/acc_align': 93.749}
[10 / 10] best test accuracy: 92.853 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 93.478, 'best_test_valid/acc_unbiased': 93.398, 'best_test_valid/diff': 1.665, 'best_test_valid/acc_skew': 94.231, 'best_test_valid/acc_align': 92.566, 'best_test_test/acc': 90.703, 'best_test_test/acc_unbiased': 92.853, 'best_test_test/diff': 3.669, 'best_test_test/acc_skew': 91.019, 'best_test_test/acc_align': 94.688}
Total training time: 3:06:39
