Log level set to: INFO
Set seed: 3
=======> Using Fixed Random Seed: 3 <========
save_path: exp_results/bc-bb0-utk_face_race-crop_cutout_rotate-0.9-lr0.001-bs128-cbs64-w0.01-ratio10-aug1-seed3
get_utk_face - split: train, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_race-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [4407, 552]
Target 1: [440, 5529]
Binary Target 1
---------------------------
Target 0: [4407, 552]
Target 1: [440, 5529]
===================================
Normal Label Distribution: 
Target 0: [4407, 552]
Target 1: [440, 5529]
===================================
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [4407, 552]
Target 1: [440, 5529]
Binary Target 1
---------------------------
Target 0: [4407, 552]
Target 1: [440, 5529]
===================================
Normal Label Distribution: 
Target 0: [4407, 552]
Target 1: [440, 5529]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 10928, target_attr: gender, bias_attr: race bias_rate: 0.9
['[train] target_0-bias_0: 4407', '[train] target_0-bias_1: 552', '[train] target_1-bias_0: 440', '[train] target_1-bias_1: 5529']
confusion_matrix - 
 original: tensor([[4407.,  440.],
        [ 552., 5529.]]), 
 normalized: tensor([[0.909, 0.091],
        [0.091, 0.909]]), 
 b|y: tensor([[0.889, 0.111],
        [0.074, 0.926]])
get_utk_face - split: train, aug: 1, given_y: True, ratio: 10
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_race-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [4407, 552]
Target 1: [440, 5529]
Binary Target 1
---------------------------
Target 0: [4407, 552]
Target 1: [440, 5529]
===================================
Normal Label Distribution: 
Target 0: [4407, 552]
Target 1: [440, 5529]
===================================
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [4407, 552]
Target 1: [440, 5529]
Binary Target 1
---------------------------
Target 0: [4407, 552]
Target 1: [440, 5529]
===================================
Normal Label Distribution: 
Target 0: [4407, 552]
Target 1: [440, 5529]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 10928, target_attr: gender, bias_attr: race bias_rate: 0.9
['[train] target_0-bias_0: 4407', '[train] target_0-bias_1: 552', '[train] target_1-bias_0: 440', '[train] target_1-bias_1: 5529']
get_utk_face - split: valid, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_race-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [583, 684]
Target 1: [457, 646]
Binary Target 1
---------------------------
Target 0: [583, 684]
Target 1: [457, 646]
===================================
Normal Label Distribution: 
Target 0: [583, 684]
Target 1: [457, 646]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 2370, target_attr: gender, bias_attr: race bias_rate: 0.9
['[valid] target_0-bias_0: 583', '[valid] target_0-bias_1: 684', '[valid] target_1-bias_0: 457', '[valid] target_1-bias_1: 646']
get_utk_face - split: test, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_race-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [558, 677]
Target 1: [462, 673]
Binary Target 1
---------------------------
Target 0: [558, 677]
Target 1: [462, 673]
===================================
Normal Label Distribution: 
Target 0: [558, 677]
Target 1: [462, 673]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 2370, target_attr: gender, bias_attr: race bias_rate: 0.9
['[test] target_0-bias_0: 558', '[test] target_0-bias_1: 677', '[test] target_1-bias_0: 462', '[test] target_1-bias_1: 673']
decay_epochs: [6, 13]
[1 / 20] Learning rate: 0.001 weight: 0.01
[1 / 20] Loss: 4.916598122430581 CE Loss: 0.6388436667566593 Con Loss: 4.9102096662339845
[1 / 20] tensor([[0.711, 0.668],
        [0.665, 0.761]]) {'epoch': 1, 'valid/acc': 70.802, 'valid/acc_unbiased': 70.458, 'valid/diff': 7.797, 'valid/acc_skew': 66.559, 'valid/acc_align': 74.356, 'test/acc': 70.38, 'test/acc_unbiased': 70.11, 'test/diff': 7.004, 'test/acc_skew': 66.608, 'test/acc_align': 73.612}
[1 / 20] best valid accuracy: 70.458 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 70.802, 'best_valid_valid/acc_unbiased': 70.458, 'best_valid_valid/diff': 7.797, 'best_valid_valid/acc_skew': 66.559, 'best_valid_valid/acc_align': 74.356, 'best_valid_test/acc': 70.38, 'best_valid_test/acc_unbiased': 70.11, 'best_valid_test/diff': 7.004, 'best_valid_test/acc_skew': 66.608, 'best_valid_test/acc_align': 73.612}
[1 / 20] best test accuracy: 70.110 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 70.802, 'best_test_valid/acc_unbiased': 70.458, 'best_test_valid/diff': 7.797, 'best_test_valid/acc_skew': 66.559, 'best_test_valid/acc_align': 74.356, 'best_test_test/acc': 70.38, 'best_test_test/acc_unbiased': 70.11, 'best_test_test/diff': 7.004, 'best_test_test/acc_skew': 66.608, 'best_test_test/acc_align': 73.612}
[2 / 20] Learning rate: 0.001 weight: 0.01
[2 / 20] Loss: 4.844031452609016 CE Loss: 0.5560109510166927 Con Loss: 4.838471341447286
[2 / 20] tensor([[0.715, 0.637],
        [0.729, 0.813]]) {'epoch': 2, 'valid/acc': 72.025, 'valid/acc_unbiased': 72.079, 'valid/diff': 6.522, 'valid/acc_skew': 68.818, 'valid/acc_align': 75.339, 'test/acc': 72.321, 'test/acc_unbiased': 72.348, 'test/diff': 8.088, 'test/acc_skew': 68.303, 'test/acc_align': 76.392}
[2 / 20] best valid accuracy: 72.079 at epoch 2 
 best_stats: {'best_valid_epoch': 2, 'best_valid_valid/acc': 72.025, 'best_valid_valid/acc_unbiased': 72.079, 'best_valid_valid/diff': 6.522, 'best_valid_valid/acc_skew': 68.818, 'best_valid_valid/acc_align': 75.339, 'best_valid_test/acc': 72.321, 'best_valid_test/acc_unbiased': 72.348, 'best_valid_test/diff': 8.088, 'best_valid_test/acc_skew': 68.303, 'best_valid_test/acc_align': 76.392}
[2 / 20] best test accuracy: 72.348 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 72.025, 'best_test_valid/acc_unbiased': 72.079, 'best_test_valid/diff': 6.522, 'best_test_valid/acc_skew': 68.818, 'best_test_valid/acc_align': 75.339, 'best_test_test/acc': 72.321, 'best_test_test/acc_unbiased': 72.348, 'best_test_test/diff': 8.088, 'best_test_test/acc_skew': 68.303, 'best_test_test/acc_align': 76.392}
[3 / 20] Learning rate: 0.001 weight: 0.01
[3 / 20] Loss: 4.841010456727504 CE Loss: 0.5556188075643682 Con Loss: 4.835454270570903
[3 / 20] tensor([[0.557, 0.557],
        [0.838, 0.863]]) {'epoch': 3, 'valid/acc': 70.802, 'valid/acc_unbiased': 71.79, 'valid/diff': 1.621, 'valid/acc_skew': 71.544, 'valid/acc_align': 72.037, 'test/acc': 69.873, 'test/acc_unbiased': 70.379, 'test/diff': 1.306, 'test/acc_skew': 69.727, 'test/acc_align': 71.032}
[3 / 20] best valid accuracy: 72.079 at epoch 2 
 best_stats: {'best_valid_epoch': 2, 'best_valid_valid/acc': 72.025, 'best_valid_valid/acc_unbiased': 72.079, 'best_valid_valid/diff': 6.522, 'best_valid_valid/acc_skew': 68.818, 'best_valid_valid/acc_align': 75.339, 'best_valid_test/acc': 72.321, 'best_valid_test/acc_unbiased': 72.348, 'best_valid_test/diff': 8.088, 'best_valid_test/acc_skew': 68.303, 'best_valid_test/acc_align': 76.392}
[3 / 20] best test accuracy: 72.348 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 72.025, 'best_test_valid/acc_unbiased': 72.079, 'best_test_valid/diff': 6.522, 'best_test_valid/acc_skew': 68.818, 'best_test_valid/acc_align': 75.339, 'best_test_test/acc': 72.321, 'best_test_test/acc_unbiased': 72.348, 'best_test_test/diff': 8.088, 'best_test_test/acc_skew': 68.303, 'best_test_test/acc_align': 76.392}
[4 / 20] Learning rate: 0.001 weight: 0.01
[4 / 20] Loss: 4.833378478339267 CE Loss: 0.5507547840541488 Con Loss: 4.827870936554312
[4 / 20] tensor([[0.692, 0.566],
        [0.775, 0.822]]) {'epoch': 4, 'valid/acc': 71.139, 'valid/acc_unbiased': 71.759, 'valid/diff': 6.848, 'valid/acc_skew': 68.335, 'valid/acc_align': 75.183, 'test/acc': 70.886, 'test/acc_unbiased': 71.352, 'test/diff': 8.641, 'test/acc_skew': 67.031, 'test/acc_align': 75.673}
[4 / 20] best valid accuracy: 72.079 at epoch 2 
 best_stats: {'best_valid_epoch': 2, 'best_valid_valid/acc': 72.025, 'best_valid_valid/acc_unbiased': 72.079, 'best_valid_valid/diff': 6.522, 'best_valid_valid/acc_skew': 68.818, 'best_valid_valid/acc_align': 75.339, 'best_valid_test/acc': 72.321, 'best_valid_test/acc_unbiased': 72.348, 'best_valid_test/diff': 8.088, 'best_valid_test/acc_skew': 68.303, 'best_valid_test/acc_align': 76.392}
[4 / 20] best test accuracy: 72.348 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 72.025, 'best_test_valid/acc_unbiased': 72.079, 'best_test_valid/diff': 6.522, 'best_test_valid/acc_skew': 68.818, 'best_test_valid/acc_align': 75.339, 'best_test_test/acc': 72.321, 'best_test_test/acc_unbiased': 72.348, 'best_test_test/diff': 8.088, 'best_test_test/acc_skew': 68.303, 'best_test_test/acc_align': 76.392}
[5 / 20] Learning rate: 0.001 weight: 0.01
[5 / 20] Loss: 4.825657033291952 CE Loss: 0.5501488395700692 Con Loss: 4.820155536098675
[5 / 20] tensor([[0.450, 0.396],
        [0.922, 0.932]]) {'epoch': 5, 'valid/acc': 66.203, 'valid/acc_unbiased': 67.88, 'valid/diff': 1.004, 'valid/acc_skew': 67.991, 'valid/acc_align': 67.77, 'test/acc': 66.329, 'test/acc_unbiased': 67.485, 'test/diff': 3.176, 'test/acc_skew': 65.897, 'test/acc_align': 69.074}
[5 / 20] best valid accuracy: 72.079 at epoch 2 
 best_stats: {'best_valid_epoch': 2, 'best_valid_valid/acc': 72.025, 'best_valid_valid/acc_unbiased': 72.079, 'best_valid_valid/diff': 6.522, 'best_valid_valid/acc_skew': 68.818, 'best_valid_valid/acc_align': 75.339, 'best_valid_test/acc': 72.321, 'best_valid_test/acc_unbiased': 72.348, 'best_valid_test/diff': 8.088, 'best_valid_test/acc_skew': 68.303, 'best_valid_test/acc_align': 76.392}
[5 / 20] best test accuracy: 72.348 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 72.025, 'best_test_valid/acc_unbiased': 72.079, 'best_test_valid/diff': 6.522, 'best_test_valid/acc_skew': 68.818, 'best_test_valid/acc_align': 75.339, 'best_test_test/acc': 72.321, 'best_test_test/acc_unbiased': 72.348, 'best_test_test/diff': 8.088, 'best_test_test/acc_skew': 68.303, 'best_test_test/acc_align': 76.392}
[6 / 20] Learning rate: 0.001 weight: 0.01
[6 / 20] Loss: 4.822797463893192 CE Loss: 0.5483172166748941 Con Loss: 4.8173142973535406
[6 / 20] tensor([[0.430, 0.368],
        [0.926, 0.936]]) {'epoch': 6, 'valid/acc': 66.034, 'valid/acc_unbiased': 67.702, 'valid/diff': 2.783, 'valid/acc_skew': 66.31, 'valid/acc_align': 69.094, 'test/acc': 65.274, 'test/acc_unbiased': 66.511, 'test/diff': 3.6, 'test/acc_skew': 64.71, 'test/acc_align': 68.311}
[6 / 20] best valid accuracy: 72.079 at epoch 2 
 best_stats: {'best_valid_epoch': 2, 'best_valid_valid/acc': 72.025, 'best_valid_valid/acc_unbiased': 72.079, 'best_valid_valid/diff': 6.522, 'best_valid_valid/acc_skew': 68.818, 'best_valid_valid/acc_align': 75.339, 'best_valid_test/acc': 72.321, 'best_valid_test/acc_unbiased': 72.348, 'best_valid_test/diff': 8.088, 'best_valid_test/acc_skew': 68.303, 'best_valid_test/acc_align': 76.392}
[6 / 20] best test accuracy: 72.348 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 72.025, 'best_test_valid/acc_unbiased': 72.079, 'best_test_valid/diff': 6.522, 'best_test_valid/acc_skew': 68.818, 'best_test_valid/acc_align': 75.339, 'best_test_test/acc': 72.321, 'best_test_test/acc_unbiased': 72.348, 'best_test_test/diff': 8.088, 'best_test_test/acc_skew': 68.303, 'best_test_test/acc_align': 76.392}
[7 / 20] Learning rate: 0.0001 weight: 0.01
[7 / 20] Loss: 4.8066209175925305 CE Loss: 0.49880808705292196 Con Loss: 4.801632815538353
[7 / 20] tensor([[0.837, 0.789],
        [0.729, 0.759]]) {'epoch': 7, 'valid/acc': 76.414, 'valid/acc_unbiased': 76.052, 'valid/diff': 2.917, 'valid/acc_skew': 74.594, 'valid/acc_align': 77.511, 'test/acc': 78.017, 'test/acc_unbiased': 77.86, 'test/diff': 3.9, 'test/acc_skew': 75.911, 'test/acc_align': 79.81}
[7 / 20] best valid accuracy: 76.052 at epoch 7 
 best_stats: {'best_valid_epoch': 7, 'best_valid_valid/acc': 76.414, 'best_valid_valid/acc_unbiased': 76.052, 'best_valid_valid/diff': 2.917, 'best_valid_valid/acc_skew': 74.594, 'best_valid_valid/acc_align': 77.511, 'best_valid_test/acc': 78.017, 'best_valid_test/acc_unbiased': 77.86, 'best_valid_test/diff': 3.9, 'best_valid_test/acc_skew': 75.911, 'best_valid_test/acc_align': 79.81}
[7 / 20] best test accuracy: 77.860 at epoch 7 
 best_stats: {'best_test_epoch': 7, 'best_test_valid/acc': 76.414, 'best_test_valid/acc_unbiased': 76.052, 'best_test_valid/diff': 2.917, 'best_test_valid/acc_skew': 74.594, 'best_test_valid/acc_align': 77.511, 'best_test_test/acc': 78.017, 'best_test_test/acc_unbiased': 77.86, 'best_test_test/diff': 3.9, 'best_test_test/acc_skew': 75.911, 'best_test_test/acc_align': 79.81}
[8 / 20] Learning rate: 0.0001 weight: 0.01
[8 / 20] Loss: 4.786493551329673 CE Loss: 0.4788227244927977 Con Loss: 4.781705312463584
[8 / 20] tensor([[0.789, 0.721],
        [0.784, 0.826]]) {'epoch': 8, 'valid/acc': 77.257, 'valid/acc_unbiased': 77.389, 'valid/diff': 5.532, 'valid/acc_skew': 74.623, 'valid/acc_align': 80.155, 'test/acc': 77.89, 'test/acc_unbiased': 77.976, 'test/diff': 5.515, 'test/acc_skew': 75.219, 'test/acc_align': 80.734}
[8 / 20] best valid accuracy: 77.389 at epoch 8 
 best_stats: {'best_valid_epoch': 8, 'best_valid_valid/acc': 77.257, 'best_valid_valid/acc_unbiased': 77.389, 'best_valid_valid/diff': 5.532, 'best_valid_valid/acc_skew': 74.623, 'best_valid_valid/acc_align': 80.155, 'best_valid_test/acc': 77.89, 'best_valid_test/acc_unbiased': 77.976, 'best_valid_test/diff': 5.515, 'best_valid_test/acc_skew': 75.219, 'best_valid_test/acc_align': 80.734}
[8 / 20] best test accuracy: 77.976 at epoch 8 
 best_stats: {'best_test_epoch': 8, 'best_test_valid/acc': 77.257, 'best_test_valid/acc_unbiased': 77.389, 'best_test_valid/diff': 5.532, 'best_test_valid/acc_skew': 74.623, 'best_test_valid/acc_align': 80.155, 'best_test_test/acc': 77.89, 'best_test_test/acc_unbiased': 77.976, 'best_test_test/diff': 5.515, 'best_test_test/acc_skew': 75.219, 'best_test_test/acc_align': 80.734}
[9 / 20] Learning rate: 0.0001 weight: 0.01
[9 / 20] Loss: 4.780916769019332 CE Loss: 0.47292965641831586 Con Loss: 4.77618746876193
[9 / 20] tensor([[0.778, 0.700],
        [0.814, 0.834]]) {'epoch': 9, 'valid/acc': 77.848, 'valid/acc_unbiased': 78.121, 'valid/diff': 4.591, 'valid/acc_skew': 75.825, 'valid/acc_align': 80.416, 'test/acc': 77.848, 'test/acc_unbiased': 78.134, 'test/diff': 4.868, 'test/acc_skew': 75.7, 'test/acc_align': 80.568}
[9 / 20] best valid accuracy: 78.121 at epoch 9 
 best_stats: {'best_valid_epoch': 9, 'best_valid_valid/acc': 77.848, 'best_valid_valid/acc_unbiased': 78.121, 'best_valid_valid/diff': 4.591, 'best_valid_valid/acc_skew': 75.825, 'best_valid_valid/acc_align': 80.416, 'best_valid_test/acc': 77.848, 'best_valid_test/acc_unbiased': 78.134, 'best_valid_test/diff': 4.868, 'best_valid_test/acc_skew': 75.7, 'best_valid_test/acc_align': 80.568}
[9 / 20] best test accuracy: 78.134 at epoch 9 
 best_stats: {'best_test_epoch': 9, 'best_test_valid/acc': 77.848, 'best_test_valid/acc_unbiased': 78.121, 'best_test_valid/diff': 4.591, 'best_test_valid/acc_skew': 75.825, 'best_test_valid/acc_align': 80.416, 'best_test_test/acc': 77.848, 'best_test_test/acc_unbiased': 78.134, 'best_test_test/diff': 4.868, 'best_test_test/acc_skew': 75.7, 'best_test_test/acc_align': 80.568}
[10 / 20] Learning rate: 0.0001 weight: 0.01
[10 / 20] Loss: 4.771490063534649 CE Loss: 0.4695172893267949 Con Loss: 4.766794865162795
[10 / 20] tensor([[0.855, 0.792],
        [0.732, 0.774]]) {'epoch': 10, 'valid/acc': 78.819, 'valid/acc_unbiased': 78.428, 'valid/diff': 3.579, 'valid/acc_skew': 76.638, 'valid/acc_align': 80.217, 'test/acc': 78.987, 'test/acc_unbiased': 78.808, 'test/diff': 5.283, 'test/acc_skew': 76.166, 'test/acc_align': 81.449}
[10 / 20] best valid accuracy: 78.428 at epoch 10 
 best_stats: {'best_valid_epoch': 10, 'best_valid_valid/acc': 78.819, 'best_valid_valid/acc_unbiased': 78.428, 'best_valid_valid/diff': 3.579, 'best_valid_valid/acc_skew': 76.638, 'best_valid_valid/acc_align': 80.217, 'best_valid_test/acc': 78.987, 'best_valid_test/acc_unbiased': 78.808, 'best_valid_test/diff': 5.283, 'best_valid_test/acc_skew': 76.166, 'best_valid_test/acc_align': 81.449}
[10 / 20] best test accuracy: 78.808 at epoch 10 
 best_stats: {'best_test_epoch': 10, 'best_test_valid/acc': 78.819, 'best_test_valid/acc_unbiased': 78.428, 'best_test_valid/diff': 3.579, 'best_test_valid/acc_skew': 76.638, 'best_test_valid/acc_align': 80.217, 'best_test_test/acc': 78.987, 'best_test_test/acc_unbiased': 78.808, 'best_test_test/diff': 5.283, 'best_test_test/acc_skew': 76.166, 'best_test_test/acc_align': 81.449}
[11 / 20] Learning rate: 0.0001 weight: 0.01
[11 / 20] Loss: 4.769309617066279 CE Loss: 0.46495307085280185 Con Loss: 4.764660075677785
[11 / 20] tensor([[0.781, 0.713],
        [0.816, 0.841]]) {'epoch': 11, 'valid/acc': 78.523, 'valid/acc_unbiased': 78.966, 'valid/diff': 2.548, 'valid/acc_skew': 77.722, 'valid/acc_align': 80.209, 'test/acc': 78.565, 'test/acc_unbiased': 78.796, 'test/diff': 4.646, 'test/acc_skew': 76.473, 'test/acc_align': 81.119}
[11 / 20] best valid accuracy: 78.966 at epoch 11 
 best_stats: {'best_valid_epoch': 11, 'best_valid_valid/acc': 78.523, 'best_valid_valid/acc_unbiased': 78.966, 'best_valid_valid/diff': 2.548, 'best_valid_valid/acc_skew': 77.722, 'best_valid_valid/acc_align': 80.209, 'best_valid_test/acc': 78.565, 'best_valid_test/acc_unbiased': 78.796, 'best_valid_test/diff': 4.646, 'best_valid_test/acc_skew': 76.473, 'best_valid_test/acc_align': 81.119}
[11 / 20] best test accuracy: 78.808 at epoch 10 
 best_stats: {'best_test_epoch': 10, 'best_test_valid/acc': 78.819, 'best_test_valid/acc_unbiased': 78.428, 'best_test_valid/diff': 3.579, 'best_test_valid/acc_skew': 76.638, 'best_test_valid/acc_align': 80.217, 'best_test_test/acc': 78.987, 'best_test_test/acc_unbiased': 78.808, 'best_test_test/diff': 5.283, 'best_test_test/acc_skew': 76.166, 'best_test_test/acc_align': 81.449}
[12 / 20] Learning rate: 0.0001 weight: 0.01
[12 / 20] Loss: 4.765105947743049 CE Loss: 0.460424814269623 Con Loss: 4.760501714960548
[12 / 20] tensor([[0.837, 0.774],
        [0.760, 0.808]]) {'epoch': 12, 'valid/acc': 78.987, 'valid/acc_unbiased': 78.985, 'valid/diff': 3.608, 'valid/acc_skew': 77.181, 'valid/acc_align': 80.789, 'test/acc': 79.578, 'test/acc_unbiased': 79.475, 'test/diff': 5.575, 'test/acc_skew': 76.687, 'test/acc_align': 82.262}
[12 / 20] best valid accuracy: 78.985 at epoch 12 
 best_stats: {'best_valid_epoch': 12, 'best_valid_valid/acc': 78.987, 'best_valid_valid/acc_unbiased': 78.985, 'best_valid_valid/diff': 3.608, 'best_valid_valid/acc_skew': 77.181, 'best_valid_valid/acc_align': 80.789, 'best_valid_test/acc': 79.578, 'best_valid_test/acc_unbiased': 79.475, 'best_valid_test/diff': 5.575, 'best_valid_test/acc_skew': 76.687, 'best_valid_test/acc_align': 82.262}
[12 / 20] best test accuracy: 79.475 at epoch 12 
 best_stats: {'best_test_epoch': 12, 'best_test_valid/acc': 78.987, 'best_test_valid/acc_unbiased': 78.985, 'best_test_valid/diff': 3.608, 'best_test_valid/acc_skew': 77.181, 'best_test_valid/acc_align': 80.789, 'best_test_test/acc': 79.578, 'best_test_test/acc_unbiased': 79.475, 'best_test_test/diff': 5.575, 'best_test_test/acc_skew': 76.687, 'best_test_test/acc_align': 82.262}
[13 / 20] Learning rate: 0.0001 weight: 0.01
[13 / 20] Loss: 4.7518735699911945 CE Loss: 0.4497729109199295 Con Loss: 4.747375846432732
[13 / 20] tensor([[0.873, 0.802],
        [0.727, 0.773]]) {'epoch': 13, 'valid/acc': 78.903, 'valid/acc_unbiased': 78.548, 'valid/diff': 5.208, 'valid/acc_skew': 75.944, 'valid/acc_align': 81.153, 'test/acc': 79.578, 'test/acc_unbiased': 79.369, 'test/diff': 5.804, 'test/acc_skew': 76.467, 'test/acc_align': 82.271}
[13 / 20] best valid accuracy: 78.985 at epoch 12 
 best_stats: {'best_valid_epoch': 12, 'best_valid_valid/acc': 78.987, 'best_valid_valid/acc_unbiased': 78.985, 'best_valid_valid/diff': 3.608, 'best_valid_valid/acc_skew': 77.181, 'best_valid_valid/acc_align': 80.789, 'best_valid_test/acc': 79.578, 'best_valid_test/acc_unbiased': 79.475, 'best_valid_test/diff': 5.575, 'best_valid_test/acc_skew': 76.687, 'best_valid_test/acc_align': 82.262}
[13 / 20] best test accuracy: 79.475 at epoch 12 
 best_stats: {'best_test_epoch': 12, 'best_test_valid/acc': 78.987, 'best_test_valid/acc_unbiased': 78.985, 'best_test_valid/diff': 3.608, 'best_test_valid/acc_skew': 77.181, 'best_test_valid/acc_align': 80.789, 'best_test_test/acc': 79.578, 'best_test_test/acc_unbiased': 79.475, 'best_test_test/diff': 5.575, 'best_test_test/acc_skew': 76.687, 'best_test_test/acc_align': 82.262}
[14 / 20] Learning rate: 1e-05 weight: 0.01
[14 / 20] Loss: 4.748547939395485 CE Loss: 0.4544001737415878 Con Loss: 4.744003929121428
[14 / 20] tensor([[0.839, 0.759],
        [0.773, 0.813]]) {'epoch': 14, 'valid/acc': 79.367, 'valid/acc_unbiased': 79.38, 'valid/diff': 4.107, 'valid/acc_skew': 77.326, 'valid/acc_align': 81.433, 'test/acc': 79.578, 'test/acc_unbiased': 79.586, 'test/diff': 5.976, 'test/acc_skew': 76.598, 'test/acc_align': 82.574}
[14 / 20] best valid accuracy: 79.380 at epoch 14 
 best_stats: {'best_valid_epoch': 14, 'best_valid_valid/acc': 79.367, 'best_valid_valid/acc_unbiased': 79.38, 'best_valid_valid/diff': 4.107, 'best_valid_valid/acc_skew': 77.326, 'best_valid_valid/acc_align': 81.433, 'best_valid_test/acc': 79.578, 'best_valid_test/acc_unbiased': 79.586, 'best_valid_test/diff': 5.976, 'best_valid_test/acc_skew': 76.598, 'best_valid_test/acc_align': 82.574}
[14 / 20] best test accuracy: 79.586 at epoch 14 
 best_stats: {'best_test_epoch': 14, 'best_test_valid/acc': 79.367, 'best_test_valid/acc_unbiased': 79.38, 'best_test_valid/diff': 4.107, 'best_test_valid/acc_skew': 77.326, 'best_test_valid/acc_align': 81.433, 'best_test_test/acc': 79.578, 'best_test_test/acc_unbiased': 79.586, 'best_test_test/diff': 5.976, 'best_test_test/acc_skew': 76.598, 'best_test_test/acc_align': 82.574}
[15 / 20] Learning rate: 1e-05 weight: 0.01
[15 / 20] Loss: 4.749436569074237 CE Loss: 0.45152926488641765 Con Loss: 4.74492128282829
[15 / 20] tensor([[0.851, 0.756],
        [0.777, 0.822]]) {'epoch': 15, 'valid/acc': 79.494, 'valid/acc_unbiased': 79.494, 'valid/diff': 4.481, 'valid/acc_skew': 77.253, 'valid/acc_align': 81.734, 'test/acc': 80.127, 'test/acc_unbiased': 80.157, 'test/diff': 6.981, 'test/acc_skew': 76.667, 'test/acc_align': 83.647}
[15 / 20] best valid accuracy: 79.494 at epoch 15 
 best_stats: {'best_valid_epoch': 15, 'best_valid_valid/acc': 79.494, 'best_valid_valid/acc_unbiased': 79.494, 'best_valid_valid/diff': 4.481, 'best_valid_valid/acc_skew': 77.253, 'best_valid_valid/acc_align': 81.734, 'best_valid_test/acc': 80.127, 'best_valid_test/acc_unbiased': 80.157, 'best_valid_test/diff': 6.981, 'best_valid_test/acc_skew': 76.667, 'best_valid_test/acc_align': 83.647}
[15 / 20] best test accuracy: 80.157 at epoch 15 
 best_stats: {'best_test_epoch': 15, 'best_test_valid/acc': 79.494, 'best_test_valid/acc_unbiased': 79.494, 'best_test_valid/diff': 4.481, 'best_test_valid/acc_skew': 77.253, 'best_test_valid/acc_align': 81.734, 'best_test_test/acc': 80.127, 'best_test_test/acc_unbiased': 80.157, 'best_test_test/diff': 6.981, 'best_test_test/acc_skew': 76.667, 'best_test_test/acc_align': 83.647}
[16 / 20] Learning rate: 1e-05 weight: 0.01
[16 / 20] Loss: 4.741105129219602 CE Loss: 0.4509127653186178 Con Loss: 4.736595998571349
[16 / 20] tensor([[0.844, 0.749],
        [0.797, 0.837]]) {'epoch': 16, 'valid/acc': 79.789, 'valid/acc_unbiased': 79.891, 'valid/diff': 4.256, 'valid/acc_skew': 77.763, 'valid/acc_align': 82.019, 'test/acc': 80.549, 'test/acc_unbiased': 80.652, 'test/diff': 6.76, 'test/acc_skew': 77.271, 'test/acc_align': 84.032}
[16 / 20] best valid accuracy: 79.891 at epoch 16 
 best_stats: {'best_valid_epoch': 16, 'best_valid_valid/acc': 79.789, 'best_valid_valid/acc_unbiased': 79.891, 'best_valid_valid/diff': 4.256, 'best_valid_valid/acc_skew': 77.763, 'best_valid_valid/acc_align': 82.019, 'best_valid_test/acc': 80.549, 'best_valid_test/acc_unbiased': 80.652, 'best_valid_test/diff': 6.76, 'best_valid_test/acc_skew': 77.271, 'best_valid_test/acc_align': 84.032}
[16 / 20] best test accuracy: 80.652 at epoch 16 
 best_stats: {'best_test_epoch': 16, 'best_test_valid/acc': 79.789, 'best_test_valid/acc_unbiased': 79.891, 'best_test_valid/diff': 4.256, 'best_test_valid/acc_skew': 77.763, 'best_test_valid/acc_align': 82.019, 'best_test_test/acc': 80.549, 'best_test_test/acc_unbiased': 80.652, 'best_test_test/diff': 6.76, 'best_test_test/acc_skew': 77.271, 'best_test_test/acc_align': 84.032}
[17 / 20] Learning rate: 1e-05 weight: 0.01
[17 / 20] Loss: 4.743652872948486 CE Loss: 0.44246032205717106 Con Loss: 4.739228269540723
[17 / 20] tensor([[0.857, 0.765],
        [0.786, 0.828]]) {'epoch': 17, 'valid/acc': 80.127, 'valid/acc_unbiased': 80.176, 'valid/diff': 3.802, 'valid/acc_skew': 78.275, 'valid/acc_align': 82.077, 'test/acc': 80.844, 'test/acc_unbiased': 80.878, 'test/diff': 6.671, 'test/acc_skew': 77.543, 'test/acc_align': 84.213}
[17 / 20] best valid accuracy: 80.176 at epoch 17 
 best_stats: {'best_valid_epoch': 17, 'best_valid_valid/acc': 80.127, 'best_valid_valid/acc_unbiased': 80.176, 'best_valid_valid/diff': 3.802, 'best_valid_valid/acc_skew': 78.275, 'best_valid_valid/acc_align': 82.077, 'best_valid_test/acc': 80.844, 'best_valid_test/acc_unbiased': 80.878, 'best_valid_test/diff': 6.671, 'best_valid_test/acc_skew': 77.543, 'best_valid_test/acc_align': 84.213}
[17 / 20] best test accuracy: 80.878 at epoch 17 
 best_stats: {'best_test_epoch': 17, 'best_test_valid/acc': 80.127, 'best_test_valid/acc_unbiased': 80.176, 'best_test_valid/diff': 3.802, 'best_test_valid/acc_skew': 78.275, 'best_test_valid/acc_align': 82.077, 'best_test_test/acc': 80.844, 'best_test_test/acc_unbiased': 80.878, 'best_test_test/diff': 6.671, 'best_test_test/acc_skew': 77.543, 'best_test_test/acc_align': 84.213}
[18 / 20] Learning rate: 1e-05 weight: 0.01
[18 / 20] Loss: 4.751991659446482 CE Loss: 0.4494555897105316 Con Loss: 4.7474971341179195
[18 / 20] tensor([[0.858, 0.761],
        [0.775, 0.832]]) {'epoch': 18, 'valid/acc': 79.958, 'valid/acc_unbiased': 79.996, 'valid/diff': 4.025, 'valid/acc_skew': 77.983, 'valid/acc_align': 82.008, 'test/acc': 80.675, 'test/acc_unbiased': 80.653, 'test/diff': 7.746, 'test/acc_skew': 76.78, 'test/acc_align': 84.526}
[18 / 20] best valid accuracy: 80.176 at epoch 17 
 best_stats: {'best_valid_epoch': 17, 'best_valid_valid/acc': 80.127, 'best_valid_valid/acc_unbiased': 80.176, 'best_valid_valid/diff': 3.802, 'best_valid_valid/acc_skew': 78.275, 'best_valid_valid/acc_align': 82.077, 'best_valid_test/acc': 80.844, 'best_valid_test/acc_unbiased': 80.878, 'best_valid_test/diff': 6.671, 'best_valid_test/acc_skew': 77.543, 'best_valid_test/acc_align': 84.213}
[18 / 20] best test accuracy: 80.878 at epoch 17 
 best_stats: {'best_test_epoch': 17, 'best_test_valid/acc': 80.127, 'best_test_valid/acc_unbiased': 80.176, 'best_test_valid/diff': 3.802, 'best_test_valid/acc_skew': 78.275, 'best_test_valid/acc_align': 82.077, 'best_test_test/acc': 80.844, 'best_test_test/acc_unbiased': 80.878, 'best_test_test/diff': 6.671, 'best_test_test/acc_skew': 77.543, 'best_test_test/acc_align': 84.213}
[19 / 20] Learning rate: 1e-05 weight: 0.01
[19 / 20] Loss: 4.748983718291209 CE Loss: 0.4394504999521013 Con Loss: 4.7445892254395154
[19 / 20] tensor([[0.833, 0.749],
        [0.794, 0.838]]) {'epoch': 19, 'valid/acc': 79.662, 'valid/acc_unbiased': 79.86, 'valid/diff': 4.489, 'valid/acc_skew': 77.616, 'valid/acc_align': 82.104, 'test/acc': 80.295, 'test/acc_unbiased': 80.366, 'test/diff': 6.405, 'test/acc_skew': 77.163, 'test/acc_align': 83.569}
[19 / 20] best valid accuracy: 80.176 at epoch 17 
 best_stats: {'best_valid_epoch': 17, 'best_valid_valid/acc': 80.127, 'best_valid_valid/acc_unbiased': 80.176, 'best_valid_valid/diff': 3.802, 'best_valid_valid/acc_skew': 78.275, 'best_valid_valid/acc_align': 82.077, 'best_valid_test/acc': 80.844, 'best_valid_test/acc_unbiased': 80.878, 'best_valid_test/diff': 6.671, 'best_valid_test/acc_skew': 77.543, 'best_valid_test/acc_align': 84.213}
[19 / 20] best test accuracy: 80.878 at epoch 17 
 best_stats: {'best_test_epoch': 17, 'best_test_valid/acc': 80.127, 'best_test_valid/acc_unbiased': 80.176, 'best_test_valid/diff': 3.802, 'best_test_valid/acc_skew': 78.275, 'best_test_valid/acc_align': 82.077, 'best_test_test/acc': 80.844, 'best_test_test/acc_unbiased': 80.878, 'best_test_test/diff': 6.671, 'best_test_test/acc_skew': 77.543, 'best_test_test/acc_align': 84.213}
[20 / 20] Learning rate: 1e-05 weight: 0.01
[20 / 20] Loss: 4.7401785696931675 CE Loss: 0.43480462848180207 Con Loss: 4.735830515055845
[20 / 20] tensor([[0.855, 0.761],
        [0.773, 0.826]]) {'epoch': 20, 'valid/acc': 80.169, 'valid/acc_unbiased': 80.186, 'valid/diff': 4.916, 'valid/acc_skew': 77.728, 'valid/acc_align': 82.644, 'test/acc': 80.38, 'test/acc_unbiased': 80.361, 'test/diff': 7.378, 'test/acc_skew': 76.672, 'test/acc_align': 84.05}
[20 / 20] best valid accuracy: 80.186 at epoch 20 
 best_stats: {'best_valid_epoch': 20, 'best_valid_valid/acc': 80.169, 'best_valid_valid/acc_unbiased': 80.186, 'best_valid_valid/diff': 4.916, 'best_valid_valid/acc_skew': 77.728, 'best_valid_valid/acc_align': 82.644, 'best_valid_test/acc': 80.38, 'best_valid_test/acc_unbiased': 80.361, 'best_valid_test/diff': 7.378, 'best_valid_test/acc_skew': 76.672, 'best_valid_test/acc_align': 84.05}
[20 / 20] best test accuracy: 80.878 at epoch 17 
 best_stats: {'best_test_epoch': 17, 'best_test_valid/acc': 80.127, 'best_test_valid/acc_unbiased': 80.176, 'best_test_valid/diff': 3.802, 'best_test_valid/acc_skew': 78.275, 'best_test_valid/acc_align': 82.077, 'best_test_test/acc': 80.844, 'best_test_test/acc_unbiased': 80.878, 'best_test_test/diff': 6.671, 'best_test_test/acc_skew': 77.543, 'best_test_test/acc_align': 84.213}
Total training time: 0:17:16
