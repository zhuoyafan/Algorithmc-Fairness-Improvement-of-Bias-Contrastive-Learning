Log level set to: INFO
Set seed: 1
=======> Using Fixed Random Seed: 1 <========
save_path: exp_results/di-celeba_black-test-lr0.001-bs128-seed1
get_celeba - split:train, aug: False, given_y: True, ratio: 0
get_celeba - split:train_valid, aug: False, given_y: True, ratio: 0
get_celeba - split:valid, aug: False, given_y: True, ratio: 0
decay_epochs: [3, 6]
[1 / 10] Learning rate: 0.001
[1 / 10] Loss: 0.2315
[1 / 10] tensor([[0.991, 0.974],
        [0.420, 0.527]]) {'epoch': 1, 'valid/acc': 88.639, 'valid/acc_unbiased': 72.878, 'valid/diff': 3.635, 'valid/acc_skew': 71.061, 'valid/acc_align': 74.696, 'test/acc': 88.035, 'test/acc_unbiased': 72.807, 'test/diff': 6.189, 'test/acc_skew': 69.712, 'test/acc_align': 75.901}
[1 / 10] best valid accuracy: 72.878 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 88.639, 'best_valid_valid/acc_unbiased': 72.878, 'best_valid_valid/diff': 3.635, 'best_valid_valid/acc_skew': 71.061, 'best_valid_valid/acc_align': 74.696, 'best_valid_test/acc': 88.035, 'best_valid_test/acc_unbiased': 72.807, 'best_valid_test/diff': 6.189, 'best_valid_test/acc_skew': 69.712, 'best_valid_test/acc_align': 75.901}
[1 / 10] best test accuracy: 72.807 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 88.639, 'best_test_valid/acc_unbiased': 72.878, 'best_test_valid/diff': 3.635, 'best_test_valid/acc_skew': 71.061, 'best_test_valid/acc_align': 74.696, 'best_test_test/acc': 88.035, 'best_test_test/acc_unbiased': 72.807, 'best_test_test/diff': 6.189, 'best_test_test/acc_skew': 69.712, 'best_test_test/acc_align': 75.901}
[2 / 10] Learning rate: 0.001
[2 / 10] Loss: 0.2152
[2 / 10] tensor([[0.992, 0.987],
        [0.401, 0.332]]) {'epoch': 2, 'valid/acc': 86.957, 'valid/acc_unbiased': 69.64, 'valid/diff': 7.192, 'valid/acc_skew': 73.22, 'valid/acc_align': 66.059, 'test/acc': 85.836, 'test/acc_unbiased': 67.788, 'test/diff': 3.726, 'test/acc_skew': 69.405, 'test/acc_align': 66.171}
[2 / 10] best valid accuracy: 72.878 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 88.639, 'best_valid_valid/acc_unbiased': 72.878, 'best_valid_valid/diff': 3.635, 'best_valid_valid/acc_skew': 71.061, 'best_valid_valid/acc_align': 74.696, 'best_valid_test/acc': 88.035, 'best_valid_test/acc_unbiased': 72.807, 'best_valid_test/diff': 6.189, 'best_valid_test/acc_skew': 69.712, 'best_valid_test/acc_align': 75.901}
[2 / 10] best test accuracy: 72.807 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 88.639, 'best_test_valid/acc_unbiased': 72.878, 'best_test_valid/diff': 3.635, 'best_test_valid/acc_skew': 71.061, 'best_test_valid/acc_align': 74.696, 'best_test_test/acc': 88.035, 'best_test_test/acc_unbiased': 72.807, 'best_test_test/diff': 6.189, 'best_test_test/acc_skew': 69.712, 'best_test_test/acc_align': 75.901}
[3 / 10] Learning rate: 0.001
[3 / 10] Loss: 0.2113
[3 / 10] tensor([[0.993, 0.981],
        [0.374, 0.332]]) {'epoch': 3, 'valid/acc': 86.226, 'valid/acc_unbiased': 66.984, 'valid/diff': 3.306, 'valid/acc_skew': 68.442, 'valid/acc_align': 65.526, 'test/acc': 85.499, 'test/acc_unbiased': 66.992, 'test/diff': 2.664, 'test/acc_skew': 67.732, 'test/acc_align': 66.253}
[3 / 10] best valid accuracy: 72.878 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 88.639, 'best_valid_valid/acc_unbiased': 72.878, 'best_valid_valid/diff': 3.635, 'best_valid_valid/acc_skew': 71.061, 'best_valid_valid/acc_align': 74.696, 'best_valid_test/acc': 88.035, 'best_valid_test/acc_unbiased': 72.807, 'best_valid_test/diff': 6.189, 'best_valid_test/acc_skew': 69.712, 'best_valid_test/acc_align': 75.901}
[3 / 10] best test accuracy: 72.807 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 88.639, 'best_test_valid/acc_unbiased': 72.878, 'best_test_valid/diff': 3.635, 'best_test_valid/acc_skew': 71.061, 'best_test_valid/acc_align': 74.696, 'best_test_test/acc': 88.035, 'best_test_test/acc_unbiased': 72.807, 'best_test_test/diff': 6.189, 'best_test_test/acc_skew': 69.712, 'best_test_test/acc_align': 75.901}
[4 / 10] Learning rate: 0.0001
[4 / 10] Loss: 0.1855
[4 / 10] tensor([[0.971, 0.949],
        [0.734, 0.744]]) {'epoch': 4, 'valid/acc': 92.207, 'valid/acc_unbiased': 86.172, 'valid/diff': 3.008, 'valid/acc_skew': 87.27, 'valid/acc_align': 85.075, 'test/acc': 91.629, 'test/acc_unbiased': 84.961, 'test/diff': 1.593, 'test/acc_skew': 84.164, 'test/acc_align': 85.757}
[4 / 10] best valid accuracy: 86.172 at epoch 4 
 best_stats: {'best_valid_epoch': 4, 'best_valid_valid/acc': 92.207, 'best_valid_valid/acc_unbiased': 86.172, 'best_valid_valid/diff': 3.008, 'best_valid_valid/acc_skew': 87.27, 'best_valid_valid/acc_align': 85.075, 'best_valid_test/acc': 91.629, 'best_valid_test/acc_unbiased': 84.961, 'best_valid_test/diff': 1.593, 'best_valid_test/acc_skew': 84.164, 'best_valid_test/acc_align': 85.757}
[4 / 10] best test accuracy: 84.961 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 92.207, 'best_test_valid/acc_unbiased': 86.172, 'best_test_valid/diff': 3.008, 'best_test_valid/acc_skew': 87.27, 'best_test_valid/acc_align': 85.075, 'best_test_test/acc': 91.629, 'best_test_test/acc_unbiased': 84.961, 'best_test_test/diff': 1.593, 'best_test_test/acc_skew': 84.164, 'best_test_test/acc_align': 85.757}
[5 / 10] Learning rate: 0.0001
[5 / 10] Loss: 0.1751
[5 / 10] tensor([[0.965, 0.942],
        [0.758, 0.766]]) {'epoch': 5, 'valid/acc': 92.532, 'valid/acc_unbiased': 87.766, 'valid/diff': 4.599, 'valid/acc_skew': 89.694, 'valid/acc_align': 85.839, 'test/acc': 91.599, 'test/acc_unbiased': 85.775, 'test/diff': 1.511, 'test/acc_skew': 85.019, 'test/acc_align': 86.531}
[5 / 10] best valid accuracy: 87.766 at epoch 5 
 best_stats: {'best_valid_epoch': 5, 'best_valid_valid/acc': 92.532, 'best_valid_valid/acc_unbiased': 87.766, 'best_valid_valid/diff': 4.599, 'best_valid_valid/acc_skew': 89.694, 'best_valid_valid/acc_align': 85.839, 'best_valid_test/acc': 91.599, 'best_valid_test/acc_unbiased': 85.775, 'best_valid_test/diff': 1.511, 'best_valid_test/acc_skew': 85.019, 'best_valid_test/acc_align': 86.531}
[5 / 10] best test accuracy: 85.775 at epoch 5 
 best_stats: {'best_test_epoch': 5, 'best_test_valid/acc': 92.532, 'best_test_valid/acc_unbiased': 87.766, 'best_test_valid/diff': 4.599, 'best_test_valid/acc_skew': 89.694, 'best_test_valid/acc_align': 85.839, 'best_test_test/acc': 91.599, 'best_test_test/acc_unbiased': 85.775, 'best_test_test/diff': 1.511, 'best_test_test/acc_skew': 85.019, 'best_test_test/acc_align': 86.531}
[6 / 10] Learning rate: 0.0001
[6 / 10] Loss: 0.1661
[6 / 10] tensor([[0.973, 0.954],
        [0.713, 0.714]]) {'epoch': 6, 'valid/acc': 92.837, 'valid/acc_unbiased': 87.011, 'valid/diff': 6.162, 'valid/acc_skew': 89.993, 'valid/acc_align': 84.028, 'test/acc': 91.307, 'test/acc_unbiased': 83.847, 'test/diff': 0.949, 'test/acc_skew': 83.372, 'test/acc_align': 84.322}
[6 / 10] best valid accuracy: 87.766 at epoch 5 
 best_stats: {'best_valid_epoch': 5, 'best_valid_valid/acc': 92.532, 'best_valid_valid/acc_unbiased': 87.766, 'best_valid_valid/diff': 4.599, 'best_valid_valid/acc_skew': 89.694, 'best_valid_valid/acc_align': 85.839, 'best_valid_test/acc': 91.599, 'best_valid_test/acc_unbiased': 85.775, 'best_valid_test/diff': 1.511, 'best_valid_test/acc_skew': 85.019, 'best_valid_test/acc_align': 86.531}
[6 / 10] best test accuracy: 85.775 at epoch 5 
 best_stats: {'best_test_epoch': 5, 'best_test_valid/acc': 92.532, 'best_test_valid/acc_unbiased': 87.766, 'best_test_valid/diff': 4.599, 'best_test_valid/acc_skew': 89.694, 'best_test_valid/acc_align': 85.839, 'best_test_test/acc': 91.599, 'best_test_test/acc_unbiased': 85.775, 'best_test_test/diff': 1.511, 'best_test_test/acc_skew': 85.019, 'best_test_test/acc_align': 86.531}
[7 / 10] Learning rate: 1e-05
[7 / 10] Loss: 0.1491
[7 / 10] tensor([[0.967, 0.942],
        [0.740, 0.753]]) {'epoch': 7, 'valid/acc': 93.383, 'valid/acc_unbiased': 89.23, 'valid/diff': 5.866, 'valid/acc_skew': 91.987, 'valid/acc_align': 86.473, 'test/acc': 91.398, 'test/acc_unbiased': 85.068, 'test/diff': 1.864, 'test/acc_skew': 84.136, 'test/acc_align': 86.0}
[7 / 10] best valid accuracy: 89.230 at epoch 7 
 best_stats: {'best_valid_epoch': 7, 'best_valid_valid/acc': 93.383, 'best_valid_valid/acc_unbiased': 89.23, 'best_valid_valid/diff': 5.866, 'best_valid_valid/acc_skew': 91.987, 'best_valid_valid/acc_align': 86.473, 'best_valid_test/acc': 91.398, 'best_valid_test/acc_unbiased': 85.068, 'best_valid_test/diff': 1.864, 'best_valid_test/acc_skew': 84.136, 'best_valid_test/acc_align': 86.0}
[7 / 10] best test accuracy: 85.775 at epoch 5 
 best_stats: {'best_test_epoch': 5, 'best_test_valid/acc': 92.532, 'best_test_valid/acc_unbiased': 87.766, 'best_test_valid/diff': 4.599, 'best_test_valid/acc_skew': 89.694, 'best_test_valid/acc_align': 85.839, 'best_test_test/acc': 91.599, 'best_test_test/acc_unbiased': 85.775, 'best_test_test/diff': 1.511, 'best_test_test/acc_skew': 85.019, 'best_test_test/acc_align': 86.531}
[8 / 10] Learning rate: 1e-05
[8 / 10] Loss: 0.1425
[8 / 10] tensor([[0.968, 0.947],
        [0.718, 0.738]]) {'epoch': 8, 'valid/acc': 93.724, 'valid/acc_unbiased': 89.66, 'valid/diff': 6.029, 'valid/acc_skew': 92.552, 'valid/acc_align': 86.768, 'test/acc': 91.176, 'test/acc_unbiased': 84.252, 'test/diff': 2.09, 'test/acc_skew': 83.207, 'test/acc_align': 85.297}
[8 / 10] best valid accuracy: 89.660 at epoch 8 
 best_stats: {'best_valid_epoch': 8, 'best_valid_valid/acc': 93.724, 'best_valid_valid/acc_unbiased': 89.66, 'best_valid_valid/diff': 6.029, 'best_valid_valid/acc_skew': 92.552, 'best_valid_valid/acc_align': 86.768, 'best_valid_test/acc': 91.176, 'best_valid_test/acc_unbiased': 84.252, 'best_valid_test/diff': 2.09, 'best_valid_test/acc_skew': 83.207, 'best_valid_test/acc_align': 85.297}
[8 / 10] best test accuracy: 85.775 at epoch 5 
 best_stats: {'best_test_epoch': 5, 'best_test_valid/acc': 92.532, 'best_test_valid/acc_unbiased': 87.766, 'best_test_valid/diff': 4.599, 'best_test_valid/acc_skew': 89.694, 'best_test_valid/acc_align': 85.839, 'best_test_test/acc': 91.599, 'best_test_test/acc_unbiased': 85.775, 'best_test_test/diff': 1.511, 'best_test_test/acc_skew': 85.019, 'best_test_test/acc_align': 86.531}
[9 / 10] Learning rate: 1e-05
[9 / 10] Loss: 0.1388
[9 / 10] tensor([[0.965, 0.941],
        [0.746, 0.751]]) {'epoch': 9, 'valid/acc': 93.685, 'valid/acc_unbiased': 90.074, 'valid/diff': 5.69, 'valid/acc_skew': 92.614, 'valid/acc_align': 87.535, 'test/acc': 91.247, 'test/acc_unbiased': 85.055, 'test/diff': 1.412, 'test/acc_skew': 84.349, 'test/acc_align': 85.761}
[9 / 10] best valid accuracy: 90.074 at epoch 9 
 best_stats: {'best_valid_epoch': 9, 'best_valid_valid/acc': 93.685, 'best_valid_valid/acc_unbiased': 90.074, 'best_valid_valid/diff': 5.69, 'best_valid_valid/acc_skew': 92.614, 'best_valid_valid/acc_align': 87.535, 'best_valid_test/acc': 91.247, 'best_valid_test/acc_unbiased': 85.055, 'best_valid_test/diff': 1.412, 'best_valid_test/acc_skew': 84.349, 'best_valid_test/acc_align': 85.761}
[9 / 10] best test accuracy: 85.775 at epoch 5 
 best_stats: {'best_test_epoch': 5, 'best_test_valid/acc': 92.532, 'best_test_valid/acc_unbiased': 87.766, 'best_test_valid/diff': 4.599, 'best_test_valid/acc_skew': 89.694, 'best_test_valid/acc_align': 85.839, 'best_test_test/acc': 91.599, 'best_test_test/acc_unbiased': 85.775, 'best_test_test/diff': 1.511, 'best_test_test/acc_skew': 85.019, 'best_test_test/acc_align': 86.531}
[10 / 10] Learning rate: 1e-05
[10 / 10] Loss: 0.1339
[10 / 10] tensor([[0.971, 0.950],
        [0.695, 0.696]]) {'epoch': 10, 'valid/acc': 93.542, 'valid/acc_unbiased': 88.885, 'valid/diff': 7.891, 'valid/acc_skew': 92.53, 'valid/acc_align': 85.239, 'test/acc': 90.703, 'test/acc_unbiased': 82.8, 'test/diff': 1.1, 'test/acc_skew': 82.249, 'test/acc_align': 83.35}
[10 / 10] best valid accuracy: 90.074 at epoch 9 
 best_stats: {'best_valid_epoch': 9, 'best_valid_valid/acc': 93.685, 'best_valid_valid/acc_unbiased': 90.074, 'best_valid_valid/diff': 5.69, 'best_valid_valid/acc_skew': 92.614, 'best_valid_valid/acc_align': 87.535, 'best_valid_test/acc': 91.247, 'best_valid_test/acc_unbiased': 85.055, 'best_valid_test/diff': 1.412, 'best_valid_test/acc_skew': 84.349, 'best_valid_test/acc_align': 85.761}
[10 / 10] best test accuracy: 85.775 at epoch 5 
 best_stats: {'best_test_epoch': 5, 'best_test_valid/acc': 92.532, 'best_test_valid/acc_unbiased': 87.766, 'best_test_valid/diff': 4.599, 'best_test_valid/acc_skew': 89.694, 'best_test_valid/acc_align': 85.839, 'best_test_test/acc': 91.599, 'best_test_test/acc_unbiased': 85.775, 'best_test_test/diff': 1.511, 'best_test_test/acc_skew': 85.019, 'best_test_test/acc_align': 86.531}
Total training time: 0:54:47
