Log level set to: INFO
Set seed: 2
=======> Using Fixed Random Seed: 2 <========
save_path: exp_results/bc-bb0-utk_face_race-uw-0.1-lr0.001-bs128-cbs64-w0.01-ratio10-aug1-seed2
get_utk_face - split: train, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_race-0.1
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [4407, 4976]
Target 1: [3755, 5529]
Binary Target 1
---------------------------
Target 0: [4407, 4976]
Target 1: [3755, 5529]
===================================
Normal Label Distribution: 
Target 0: [4407, 4976]
Target 1: [3755, 5529]
===================================
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [4407, 4976]
Target 1: [3755, 5529]
Binary Target 1
---------------------------
Target 0: [4407, 4976]
Target 1: [3755, 5529]
===================================
Normal Label Distribution: 
Target 0: [4407, 4976]
Target 1: [3755, 5529]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 18667, target_attr: gender, bias_attr: race bias_rate: 0.1
['[train] target_0-bias_0: 4407', '[train] target_0-bias_1: 4976', '[train] target_1-bias_0: 3755', '[train] target_1-bias_1: 5529']
confusion_matrix - 
 original: tensor([[4407., 3755.],
        [4976., 5529.]]), 
 normalized: tensor([[0.540, 0.460],
        [0.474, 0.526]]), 
 b|y: tensor([[0.470, 0.530],
        [0.404, 0.596]])
get_utk_face - split: train, aug: 1, given_y: True, ratio: 10
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_race-0.1
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [4407, 4976]
Target 1: [3755, 5529]
Binary Target 1
---------------------------
Target 0: [4407, 4976]
Target 1: [3755, 5529]
===================================
Normal Label Distribution: 
Target 0: [4407, 4976]
Target 1: [3755, 5529]
===================================
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [4407, 4976]
Target 1: [3755, 5529]
Binary Target 1
---------------------------
Target 0: [4407, 4976]
Target 1: [3755, 5529]
===================================
Normal Label Distribution: 
Target 0: [4407, 4976]
Target 1: [3755, 5529]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 18667, target_attr: gender, bias_attr: race bias_rate: 0.1
['[train] target_0-bias_0: 4407', '[train] target_0-bias_1: 4976', '[train] target_1-bias_0: 3755', '[train] target_1-bias_1: 5529']
get_utk_face - split: valid, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_race-0.1
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [583, 684]
Target 1: [457, 646]
Binary Target 1
---------------------------
Target 0: [583, 684]
Target 1: [457, 646]
===================================
Normal Label Distribution: 
Target 0: [583, 684]
Target 1: [457, 646]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 2370, target_attr: gender, bias_attr: race bias_rate: 0.1
['[valid] target_0-bias_0: 583', '[valid] target_0-bias_1: 684', '[valid] target_1-bias_0: 457', '[valid] target_1-bias_1: 646']
get_utk_face - split: test, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_race-0.1
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [558, 677]
Target 1: [462, 673]
Binary Target 1
---------------------------
Target 0: [558, 677]
Target 1: [462, 673]
===================================
Normal Label Distribution: 
Target 0: [558, 677]
Target 1: [462, 673]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 2370, target_attr: gender, bias_attr: race bias_rate: 0.1
['[test] target_0-bias_0: 558', '[test] target_0-bias_1: 677', '[test] target_1-bias_0: 462', '[test] target_1-bias_1: 673']
decay_epochs: [6, 13]
[1 / 20] Learning rate: 0.001 weight: 0.01
[1 / 20] Loss: 4.86449665498828 CE Loss: 2.1263877907850213 Con Loss: 4.843232779304389
[1 / 20] tensor([[0.824, 0.818],
        [0.838, 0.831]]) {'epoch': 1, 'valid/acc': 82.194, 'valid/acc_unbiased': 82.539, 'valid/diff': 4.422, 'valid/acc_skew': 84.75, 'valid/acc_align': 80.328, 'test/acc': 82.7, 'test/acc_unbiased': 82.774, 'test/diff': 0.655, 'test/acc_skew': 83.102, 'test/acc_align': 82.446}
[1 / 20] best valid accuracy: 82.539 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 82.194, 'best_valid_valid/acc_unbiased': 82.539, 'best_valid_valid/diff': 4.422, 'best_valid_valid/acc_skew': 84.75, 'best_valid_valid/acc_align': 80.328, 'best_valid_test/acc': 82.7, 'best_valid_test/acc_unbiased': 82.774, 'best_valid_test/diff': 0.655, 'best_valid_test/acc_skew': 83.102, 'best_valid_test/acc_align': 82.446}
[1 / 20] best test accuracy: 82.774 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 82.194, 'best_test_valid/acc_unbiased': 82.539, 'best_test_valid/diff': 4.422, 'best_test_valid/acc_skew': 84.75, 'best_test_valid/acc_align': 80.328, 'best_test_test/acc': 82.7, 'best_test_test/acc_unbiased': 82.774, 'best_test_test/diff': 0.655, 'best_test_test/acc_skew': 83.102, 'best_test_test/acc_align': 82.446}
[2 / 20] Learning rate: 0.001 weight: 0.01
[2 / 20] Loss: 4.762515605099488 CE Loss: 1.760857970469215 Con Loss: 4.744907023214838
[2 / 20] tensor([[0.909, 0.879],
        [0.727, 0.694]]) {'epoch': 2, 'valid/acc': 80.464, 'valid/acc_unbiased': 80.017, 'valid/diff': 4.504, 'valid/acc_skew': 82.269, 'valid/acc_align': 77.765, 'test/acc': 80.38, 'test/acc_unbiased': 80.217, 'test/diff': 3.154, 'test/acc_skew': 81.794, 'test/acc_align': 78.639}
[2 / 20] best valid accuracy: 82.539 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 82.194, 'best_valid_valid/acc_unbiased': 82.539, 'best_valid_valid/diff': 4.422, 'best_valid_valid/acc_skew': 84.75, 'best_valid_valid/acc_align': 80.328, 'best_valid_test/acc': 82.7, 'best_valid_test/acc_unbiased': 82.774, 'best_valid_test/diff': 0.655, 'best_valid_test/acc_skew': 83.102, 'best_valid_test/acc_align': 82.446}
[2 / 20] best test accuracy: 82.774 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 82.194, 'best_test_valid/acc_unbiased': 82.539, 'best_test_valid/diff': 4.422, 'best_test_valid/acc_skew': 84.75, 'best_test_valid/acc_align': 80.328, 'best_test_test/acc': 82.7, 'best_test_test/acc_unbiased': 82.774, 'best_test_test/diff': 0.655, 'best_test_test/acc_skew': 83.102, 'best_test_test/acc_align': 82.446}
[3 / 20] Learning rate: 0.001 weight: 0.01
[3 / 20] Loss: 4.744902263196272 CE Loss: 1.6451639542909429 Con Loss: 4.728450625073184
[3 / 20] tensor([[0.801, 0.775],
        [0.885, 0.905]]) {'epoch': 3, 'valid/acc': 82.7, 'valid/acc_unbiased': 83.126, 'valid/diff': 2.13, 'valid/acc_skew': 84.191, 'valid/acc_align': 82.061, 'test/acc': 83.966, 'test/acc_unbiased': 84.168, 'test/diff': 2.261, 'test/acc_skew': 84.318, 'test/acc_align': 84.019}
[3 / 20] best valid accuracy: 83.126 at epoch 3 
 best_stats: {'best_valid_epoch': 3, 'best_valid_valid/acc': 82.7, 'best_valid_valid/acc_unbiased': 83.126, 'best_valid_valid/diff': 2.13, 'best_valid_valid/acc_skew': 84.191, 'best_valid_valid/acc_align': 82.061, 'best_valid_test/acc': 83.966, 'best_valid_test/acc_unbiased': 84.168, 'best_valid_test/diff': 2.261, 'best_valid_test/acc_skew': 84.318, 'best_valid_test/acc_align': 84.019}
[3 / 20] best test accuracy: 84.168 at epoch 3 
 best_stats: {'best_test_epoch': 3, 'best_test_valid/acc': 82.7, 'best_test_valid/acc_unbiased': 83.126, 'best_test_valid/diff': 2.13, 'best_test_valid/acc_skew': 84.191, 'best_test_valid/acc_align': 82.061, 'best_test_test/acc': 83.966, 'best_test_test/acc_unbiased': 84.168, 'best_test_test/diff': 2.261, 'best_test_test/acc_skew': 84.318, 'best_test_test/acc_align': 84.019}
[4 / 20] Learning rate: 0.001 weight: 0.01
[4 / 20] Loss: 4.7267738567229065 CE Loss: 1.5699318696940763 Con Loss: 4.711074543208731
[4 / 20] tensor([[0.905, 0.851],
        [0.812, 0.853]]) {'epoch': 4, 'valid/acc': 85.316, 'valid/acc_unbiased': 85.356, 'valid/diff': 2.963, 'valid/acc_skew': 86.838, 'valid/acc_align': 83.875, 'test/acc': 85.654, 'test/acc_unbiased': 85.51, 'test/diff': 4.771, 'test/acc_skew': 85.835, 'test/acc_align': 85.185}
[4 / 20] best valid accuracy: 85.356 at epoch 4 
 best_stats: {'best_valid_epoch': 4, 'best_valid_valid/acc': 85.316, 'best_valid_valid/acc_unbiased': 85.356, 'best_valid_valid/diff': 2.963, 'best_valid_valid/acc_skew': 86.838, 'best_valid_valid/acc_align': 83.875, 'best_valid_test/acc': 85.654, 'best_valid_test/acc_unbiased': 85.51, 'best_valid_test/diff': 4.771, 'best_valid_test/acc_skew': 85.835, 'best_valid_test/acc_align': 85.185}
[4 / 20] best test accuracy: 85.510 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 85.316, 'best_test_valid/acc_unbiased': 85.356, 'best_test_valid/diff': 2.963, 'best_test_valid/acc_skew': 86.838, 'best_test_valid/acc_align': 83.875, 'best_test_test/acc': 85.654, 'best_test_test/acc_unbiased': 85.51, 'best_test_test/diff': 4.771, 'best_test_test/acc_skew': 85.835, 'best_test_test/acc_align': 85.185}
[5 / 20] Learning rate: 0.001 weight: 0.01
[5 / 20] Loss: 4.714055492018774 CE Loss: 1.5841138270477684 Con Loss: 4.698214343959878
[5 / 20] tensor([[0.889, 0.882],
        [0.825, 0.844]]) {'epoch': 5, 'valid/acc': 86.498, 'valid/acc_unbiased': 86.536, 'valid/diff': 3.146, 'valid/acc_skew': 88.109, 'valid/acc_align': 84.963, 'test/acc': 86.16, 'test/acc_unbiased': 85.984, 'test/diff': 1.318, 'test/acc_skew': 85.678, 'test/acc_align': 86.291}
[5 / 20] best valid accuracy: 86.536 at epoch 5 
 best_stats: {'best_valid_epoch': 5, 'best_valid_valid/acc': 86.498, 'best_valid_valid/acc_unbiased': 86.536, 'best_valid_valid/diff': 3.146, 'best_valid_valid/acc_skew': 88.109, 'best_valid_valid/acc_align': 84.963, 'best_valid_test/acc': 86.16, 'best_valid_test/acc_unbiased': 85.984, 'best_valid_test/diff': 1.318, 'best_valid_test/acc_skew': 85.678, 'best_valid_test/acc_align': 86.291}
[5 / 20] best test accuracy: 85.984 at epoch 5 
 best_stats: {'best_test_epoch': 5, 'best_test_valid/acc': 86.498, 'best_test_valid/acc_unbiased': 86.536, 'best_test_valid/diff': 3.146, 'best_test_valid/acc_skew': 88.109, 'best_test_valid/acc_align': 84.963, 'best_test_test/acc': 86.16, 'best_test_test/acc_unbiased': 85.984, 'best_test_test/diff': 1.318, 'best_test_test/acc_skew': 85.678, 'best_test_test/acc_align': 86.291}
[6 / 20] Learning rate: 0.001 weight: 0.01
[6 / 20] Loss: 4.700602078377776 CE Loss: 1.533316518355241 Con Loss: 4.685268907061142
[6 / 20] tensor([[0.896, 0.876],
        [0.844, 0.832]]) {'epoch': 6, 'valid/acc': 85.612, 'valid/acc_unbiased': 85.594, 'valid/diff': 3.155, 'valid/acc_skew': 87.172, 'valid/acc_align': 84.017, 'test/acc': 86.203, 'test/acc_unbiased': 86.206, 'test/diff': 1.61, 'test/acc_skew': 87.011, 'test/acc_align': 85.401}
[6 / 20] best valid accuracy: 86.536 at epoch 5 
 best_stats: {'best_valid_epoch': 5, 'best_valid_valid/acc': 86.498, 'best_valid_valid/acc_unbiased': 86.536, 'best_valid_valid/diff': 3.146, 'best_valid_valid/acc_skew': 88.109, 'best_valid_valid/acc_align': 84.963, 'best_valid_test/acc': 86.16, 'best_valid_test/acc_unbiased': 85.984, 'best_valid_test/diff': 1.318, 'best_valid_test/acc_skew': 85.678, 'best_valid_test/acc_align': 86.291}
[6 / 20] best test accuracy: 86.206 at epoch 6 
 best_stats: {'best_test_epoch': 6, 'best_test_valid/acc': 85.612, 'best_test_valid/acc_unbiased': 85.594, 'best_test_valid/diff': 3.155, 'best_test_valid/acc_skew': 87.172, 'best_test_valid/acc_align': 84.017, 'best_test_test/acc': 86.203, 'best_test_test/acc_unbiased': 86.206, 'best_test_test/diff': 1.61, 'best_test_test/acc_skew': 87.011, 'best_test_test/acc_align': 85.401}
[7 / 20] Learning rate: 0.0001 weight: 0.01
[7 / 20] Loss: 4.661693275124897 CE Loss: 1.370187380077971 Con Loss: 4.64799140219633
[7 / 20] tensor([[0.889, 0.874],
        [0.866, 0.877]]) {'epoch': 7, 'valid/acc': 87.257, 'valid/acc_unbiased': 87.308, 'valid/diff': 2.402, 'valid/acc_skew': 88.508, 'valid/acc_align': 86.107, 'test/acc': 87.679, 'test/acc_unbiased': 87.645, 'test/diff': 1.266, 'test/acc_skew': 87.734, 'test/acc_align': 87.556}
[7 / 20] best valid accuracy: 87.308 at epoch 7 
 best_stats: {'best_valid_epoch': 7, 'best_valid_valid/acc': 87.257, 'best_valid_valid/acc_unbiased': 87.308, 'best_valid_valid/diff': 2.402, 'best_valid_valid/acc_skew': 88.508, 'best_valid_valid/acc_align': 86.107, 'best_valid_test/acc': 87.679, 'best_valid_test/acc_unbiased': 87.645, 'best_valid_test/diff': 1.266, 'best_valid_test/acc_skew': 87.734, 'best_valid_test/acc_align': 87.556}
[7 / 20] best test accuracy: 87.645 at epoch 7 
 best_stats: {'best_test_epoch': 7, 'best_test_valid/acc': 87.257, 'best_test_valid/acc_unbiased': 87.308, 'best_test_valid/diff': 2.402, 'best_test_valid/acc_skew': 88.508, 'best_test_valid/acc_align': 86.107, 'best_test_test/acc': 87.679, 'best_test_test/acc_unbiased': 87.645, 'best_test_test/diff': 1.266, 'best_test_test/acc_skew': 87.734, 'best_test_test/acc_align': 87.556}
[8 / 20] Learning rate: 0.0001 weight: 0.01
[8 / 20] Loss: 4.640300920653715 CE Loss: 1.2876205241385745 Con Loss: 4.627424729747203
[8 / 20] tensor([[0.880, 0.863],
        [0.879, 0.899]]) {'epoch': 8, 'valid/acc': 88.101, 'valid/acc_unbiased': 88.291, 'valid/diff': 2.003, 'valid/acc_skew': 89.292, 'valid/acc_align': 87.289, 'test/acc': 88.017, 'test/acc_unbiased': 88.008, 'test/diff': 1.874, 'test/acc_skew': 87.936, 'test/acc_align': 88.079}
[8 / 20] best valid accuracy: 88.291 at epoch 8 
 best_stats: {'best_valid_epoch': 8, 'best_valid_valid/acc': 88.101, 'best_valid_valid/acc_unbiased': 88.291, 'best_valid_valid/diff': 2.003, 'best_valid_valid/acc_skew': 89.292, 'best_valid_valid/acc_align': 87.289, 'best_valid_test/acc': 88.017, 'best_valid_test/acc_unbiased': 88.008, 'best_valid_test/diff': 1.874, 'best_valid_test/acc_skew': 87.936, 'best_valid_test/acc_align': 88.079}
[8 / 20] best test accuracy: 88.008 at epoch 8 
 best_stats: {'best_test_epoch': 8, 'best_test_valid/acc': 88.101, 'best_test_valid/acc_unbiased': 88.291, 'best_test_valid/diff': 2.003, 'best_test_valid/acc_skew': 89.292, 'best_test_valid/acc_align': 87.289, 'best_test_test/acc': 88.017, 'best_test_test/acc_unbiased': 88.008, 'best_test_test/diff': 1.874, 'best_test_test/acc_skew': 87.936, 'best_test_test/acc_align': 88.079}
[9 / 20] Learning rate: 0.0001 weight: 0.01
[9 / 20] Loss: 4.6342290713381304 CE Loss: 1.2510018427306713 Con Loss: 4.621719056449935
[9 / 20] tensor([[0.858, 0.849],
        [0.898, 0.906]]) {'epoch': 9, 'valid/acc': 88.65, 'valid/acc_unbiased': 88.892, 'valid/diff': 1.941, 'valid/acc_skew': 89.863, 'valid/acc_align': 87.921, 'test/acc': 87.722, 'test/acc_unbiased': 87.81, 'test/diff': 0.86, 'test/acc_skew': 87.835, 'test/acc_align': 87.786}
[9 / 20] best valid accuracy: 88.892 at epoch 9 
 best_stats: {'best_valid_epoch': 9, 'best_valid_valid/acc': 88.65, 'best_valid_valid/acc_unbiased': 88.892, 'best_valid_valid/diff': 1.941, 'best_valid_valid/acc_skew': 89.863, 'best_valid_valid/acc_align': 87.921, 'best_valid_test/acc': 87.722, 'best_valid_test/acc_unbiased': 87.81, 'best_valid_test/diff': 0.86, 'best_valid_test/acc_skew': 87.835, 'best_valid_test/acc_align': 87.786}
[9 / 20] best test accuracy: 88.008 at epoch 8 
 best_stats: {'best_test_epoch': 8, 'best_test_valid/acc': 88.101, 'best_test_valid/acc_unbiased': 88.291, 'best_test_valid/diff': 2.003, 'best_test_valid/acc_skew': 89.292, 'best_test_valid/acc_align': 87.289, 'best_test_test/acc': 88.017, 'best_test_test/acc_unbiased': 88.008, 'best_test_test/diff': 1.874, 'best_test_test/acc_skew': 87.936, 'best_test_test/acc_align': 88.079}
[10 / 20] Learning rate: 0.0001 weight: 0.01
[10 / 20] Loss: 4.628809233371348 CE Loss: 1.2303357189083646 Con Loss: 4.61650588147519
[10 / 20] tensor([[0.903, 0.874],
        [0.883, 0.880]]) {'epoch': 10, 'valid/acc': 88.228, 'valid/acc_unbiased': 88.369, 'valid/diff': 3.028, 'valid/acc_skew': 89.883, 'valid/acc_align': 86.855, 'test/acc': 88.439, 'test/acc_unbiased': 88.511, 'test/diff': 1.613, 'test/acc_skew': 89.317, 'test/acc_align': 87.704}
[10 / 20] best valid accuracy: 88.892 at epoch 9 
 best_stats: {'best_valid_epoch': 9, 'best_valid_valid/acc': 88.65, 'best_valid_valid/acc_unbiased': 88.892, 'best_valid_valid/diff': 1.941, 'best_valid_valid/acc_skew': 89.863, 'best_valid_valid/acc_align': 87.921, 'best_valid_test/acc': 87.722, 'best_valid_test/acc_unbiased': 87.81, 'best_valid_test/diff': 0.86, 'best_valid_test/acc_skew': 87.835, 'best_valid_test/acc_align': 87.786}
[10 / 20] best test accuracy: 88.511 at epoch 10 
 best_stats: {'best_test_epoch': 10, 'best_test_valid/acc': 88.228, 'best_test_valid/acc_unbiased': 88.369, 'best_test_valid/diff': 3.028, 'best_test_valid/acc_skew': 89.883, 'best_test_valid/acc_align': 86.855, 'best_test_test/acc': 88.439, 'best_test_test/acc_unbiased': 88.511, 'best_test_test/diff': 1.613, 'best_test_test/acc_skew': 89.317, 'best_test_test/acc_align': 87.704}
[11 / 20] Learning rate: 0.0001 weight: 0.01
[11 / 20] Loss: 4.621384815697934 CE Loss: 1.2159425256407725 Con Loss: 4.609225394059474
[11 / 20] tensor([[0.876, 0.870],
        [0.903, 0.903]]) {'epoch': 11, 'valid/acc': 88.65, 'valid/acc_unbiased': 88.891, 'valid/diff': 2.705, 'valid/acc_skew': 90.244, 'valid/acc_align': 87.539, 'test/acc': 88.734, 'test/acc_unbiased': 88.809, 'test/diff': 0.357, 'test/acc_skew': 88.947, 'test/acc_align': 88.672}
[11 / 20] best valid accuracy: 88.892 at epoch 9 
 best_stats: {'best_valid_epoch': 9, 'best_valid_valid/acc': 88.65, 'best_valid_valid/acc_unbiased': 88.892, 'best_valid_valid/diff': 1.941, 'best_valid_valid/acc_skew': 89.863, 'best_valid_valid/acc_align': 87.921, 'best_valid_test/acc': 87.722, 'best_valid_test/acc_unbiased': 87.81, 'best_valid_test/diff': 0.86, 'best_valid_test/acc_skew': 87.835, 'best_valid_test/acc_align': 87.786}
[11 / 20] best test accuracy: 88.809 at epoch 11 
 best_stats: {'best_test_epoch': 11, 'best_test_valid/acc': 88.65, 'best_test_valid/acc_unbiased': 88.891, 'best_test_valid/diff': 2.705, 'best_test_valid/acc_skew': 90.244, 'best_test_valid/acc_align': 87.539, 'best_test_test/acc': 88.734, 'best_test_test/acc_unbiased': 88.809, 'best_test_test/diff': 0.357, 'best_test_test/acc_skew': 88.947, 'best_test_test/acc_align': 88.672}
[12 / 20] Learning rate: 0.0001 weight: 0.01
[12 / 20] Loss: 4.621130130271443 CE Loss: 1.189334094553121 Con Loss: 4.609236783026474
[12 / 20] tensor([[0.884, 0.867],
        [0.898, 0.896]]) {'epoch': 12, 'valid/acc': 89.03, 'valid/acc_unbiased': 89.255, 'valid/diff': 2.417, 'valid/acc_skew': 90.463, 'valid/acc_align': 88.046, 'test/acc': 88.523, 'test/acc_unbiased': 88.621, 'test/diff': 0.937, 'test/acc_skew': 89.089, 'test/acc_align': 88.152}
[12 / 20] best valid accuracy: 89.255 at epoch 12 
 best_stats: {'best_valid_epoch': 12, 'best_valid_valid/acc': 89.03, 'best_valid_valid/acc_unbiased': 89.255, 'best_valid_valid/diff': 2.417, 'best_valid_valid/acc_skew': 90.463, 'best_valid_valid/acc_align': 88.046, 'best_valid_test/acc': 88.523, 'best_valid_test/acc_unbiased': 88.621, 'best_valid_test/diff': 0.937, 'best_valid_test/acc_skew': 89.089, 'best_valid_test/acc_align': 88.152}
[12 / 20] best test accuracy: 88.809 at epoch 11 
 best_stats: {'best_test_epoch': 11, 'best_test_valid/acc': 88.65, 'best_test_valid/acc_unbiased': 88.891, 'best_test_valid/diff': 2.705, 'best_test_valid/acc_skew': 90.244, 'best_test_valid/acc_align': 87.539, 'best_test_test/acc': 88.734, 'best_test_test/acc_unbiased': 88.809, 'best_test_test/diff': 0.357, 'best_test_test/acc_skew': 88.947, 'best_test_test/acc_align': 88.672}
[13 / 20] Learning rate: 0.0001 weight: 0.01
[13 / 20] Loss: 4.618960604399703 CE Loss: 1.1768975177664145 Con Loss: 4.607191615325124
[13 / 20] tensor([[0.898, 0.891],
        [0.894, 0.881]]) {'epoch': 13, 'valid/acc': 89.241, 'valid/acc_unbiased': 89.431, 'valid/diff': 3.123, 'valid/acc_skew': 90.992, 'valid/acc_align': 87.87, 'test/acc': 89.03, 'test/acc_unbiased': 89.09, 'test/diff': 0.998, 'test/acc_skew': 89.589, 'test/acc_align': 88.591}
[13 / 20] best valid accuracy: 89.431 at epoch 13 
 best_stats: {'best_valid_epoch': 13, 'best_valid_valid/acc': 89.241, 'best_valid_valid/acc_unbiased': 89.431, 'best_valid_valid/diff': 3.123, 'best_valid_valid/acc_skew': 90.992, 'best_valid_valid/acc_align': 87.87, 'best_valid_test/acc': 89.03, 'best_valid_test/acc_unbiased': 89.09, 'best_valid_test/diff': 0.998, 'best_valid_test/acc_skew': 89.589, 'best_valid_test/acc_align': 88.591}
[13 / 20] best test accuracy: 89.090 at epoch 13 
 best_stats: {'best_test_epoch': 13, 'best_test_valid/acc': 89.241, 'best_test_valid/acc_unbiased': 89.431, 'best_test_valid/diff': 3.123, 'best_test_valid/acc_skew': 90.992, 'best_test_valid/acc_align': 87.87, 'best_test_test/acc': 89.03, 'best_test_test/acc_unbiased': 89.09, 'best_test_test/diff': 0.998, 'best_test_test/acc_skew': 89.589, 'best_test_test/acc_align': 88.591}
[14 / 20] Learning rate: 1e-05 weight: 0.01
[14 / 20] Loss: 4.610110843188635 CE Loss: 1.1601131330626162 Con Loss: 4.598509711062588
[14 / 20] tensor([[0.900, 0.891],
        [0.896, 0.883]]) {'epoch': 14, 'valid/acc': 89.241, 'valid/acc_unbiased': 89.451, 'valid/diff': 3.007, 'valid/acc_skew': 90.954, 'valid/acc_align': 87.947, 'test/acc': 89.156, 'test/acc_unbiased': 89.226, 'test/diff': 1.122, 'test/acc_skew': 89.787, 'test/acc_align': 88.665}
[14 / 20] best valid accuracy: 89.451 at epoch 14 
 best_stats: {'best_valid_epoch': 14, 'best_valid_valid/acc': 89.241, 'best_valid_valid/acc_unbiased': 89.451, 'best_valid_valid/diff': 3.007, 'best_valid_valid/acc_skew': 90.954, 'best_valid_valid/acc_align': 87.947, 'best_valid_test/acc': 89.156, 'best_valid_test/acc_unbiased': 89.226, 'best_valid_test/diff': 1.122, 'best_valid_test/acc_skew': 89.787, 'best_valid_test/acc_align': 88.665}
[14 / 20] best test accuracy: 89.226 at epoch 14 
 best_stats: {'best_test_epoch': 14, 'best_test_valid/acc': 89.241, 'best_test_valid/acc_unbiased': 89.451, 'best_test_valid/diff': 3.007, 'best_test_valid/acc_skew': 90.954, 'best_test_valid/acc_align': 87.947, 'best_test_test/acc': 89.156, 'best_test_test/acc_unbiased': 89.226, 'best_test_test/diff': 1.122, 'best_test_test/acc_skew': 89.787, 'best_test_test/acc_align': 88.665}
[15 / 20] Learning rate: 1e-05 weight: 0.01
[15 / 20] Loss: 4.598604172255848 CE Loss: 1.1432574776414823 Con Loss: 4.587171585704043
[15 / 20] tensor([[0.885, 0.885],
        [0.903, 0.895]]) {'epoch': 15, 'valid/acc': 89.283, 'valid/acc_unbiased': 89.513, 'valid/diff': 2.633, 'valid/acc_skew': 90.83, 'valid/acc_align': 88.197, 'test/acc': 89.114, 'test/acc_unbiased': 89.18, 'test/diff': 0.431, 'test/acc_skew': 89.395, 'test/acc_align': 88.964}
[15 / 20] best valid accuracy: 89.513 at epoch 15 
 best_stats: {'best_valid_epoch': 15, 'best_valid_valid/acc': 89.283, 'best_valid_valid/acc_unbiased': 89.513, 'best_valid_valid/diff': 2.633, 'best_valid_valid/acc_skew': 90.83, 'best_valid_valid/acc_align': 88.197, 'best_valid_test/acc': 89.114, 'best_valid_test/acc_unbiased': 89.18, 'best_valid_test/diff': 0.431, 'best_valid_test/acc_skew': 89.395, 'best_valid_test/acc_align': 88.964}
[15 / 20] best test accuracy: 89.226 at epoch 14 
 best_stats: {'best_test_epoch': 14, 'best_test_valid/acc': 89.241, 'best_test_valid/acc_unbiased': 89.451, 'best_test_valid/diff': 3.007, 'best_test_valid/acc_skew': 90.954, 'best_test_valid/acc_align': 87.947, 'best_test_test/acc': 89.156, 'best_test_test/acc_unbiased': 89.226, 'best_test_test/diff': 1.122, 'best_test_test/acc_skew': 89.787, 'best_test_test/acc_align': 88.665}
[16 / 20] Learning rate: 1e-05 weight: 0.01
[16 / 20] Loss: 4.613040669088148 CE Loss: 1.1562779480422285 Con Loss: 4.60147787071535
[16 / 20] tensor([[0.878, 0.870],
        [0.911, 0.908]]) {'epoch': 16, 'valid/acc': 89.325, 'valid/acc_unbiased': 89.563, 'valid/diff': 1.942, 'valid/acc_skew': 90.534, 'valid/acc_align': 88.592, 'test/acc': 89.072, 'test/acc_unbiased': 89.182, 'test/diff': 0.575, 'test/acc_skew': 89.47, 'test/acc_align': 88.894}
[16 / 20] best valid accuracy: 89.563 at epoch 16 
 best_stats: {'best_valid_epoch': 16, 'best_valid_valid/acc': 89.325, 'best_valid_valid/acc_unbiased': 89.563, 'best_valid_valid/diff': 1.942, 'best_valid_valid/acc_skew': 90.534, 'best_valid_valid/acc_align': 88.592, 'best_valid_test/acc': 89.072, 'best_valid_test/acc_unbiased': 89.182, 'best_valid_test/diff': 0.575, 'best_valid_test/acc_skew': 89.47, 'best_valid_test/acc_align': 88.894}
[16 / 20] best test accuracy: 89.226 at epoch 14 
 best_stats: {'best_test_epoch': 14, 'best_test_valid/acc': 89.241, 'best_test_valid/acc_unbiased': 89.451, 'best_test_valid/diff': 3.007, 'best_test_valid/acc_skew': 90.954, 'best_test_valid/acc_align': 87.947, 'best_test_test/acc': 89.156, 'best_test_test/acc_unbiased': 89.226, 'best_test_test/diff': 1.122, 'best_test_test/acc_skew': 89.787, 'best_test_test/acc_align': 88.665}
[17 / 20] Learning rate: 1e-05 weight: 0.01
[17 / 20] Loss: 4.598580881135021 CE Loss: 1.147657601069694 Con Loss: 4.587104285096052
[17 / 20] tensor([[0.889, 0.886],
        [0.903, 0.896]]) {'epoch': 17, 'valid/acc': 89.62, 'valid/acc_unbiased': 89.8, 'valid/diff': 2.012, 'valid/acc_skew': 90.806, 'valid/acc_align': 88.794, 'test/acc': 89.283, 'test/acc_unbiased': 89.343, 'test/diff': 0.462, 'test/acc_skew': 89.574, 'test/acc_align': 89.113}
[17 / 20] best valid accuracy: 89.800 at epoch 17 
 best_stats: {'best_valid_epoch': 17, 'best_valid_valid/acc': 89.62, 'best_valid_valid/acc_unbiased': 89.8, 'best_valid_valid/diff': 2.012, 'best_valid_valid/acc_skew': 90.806, 'best_valid_valid/acc_align': 88.794, 'best_valid_test/acc': 89.283, 'best_valid_test/acc_unbiased': 89.343, 'best_valid_test/diff': 0.462, 'best_valid_test/acc_skew': 89.574, 'best_valid_test/acc_align': 89.113}
[17 / 20] best test accuracy: 89.343 at epoch 17 
 best_stats: {'best_test_epoch': 17, 'best_test_valid/acc': 89.62, 'best_test_valid/acc_unbiased': 89.8, 'best_test_valid/diff': 2.012, 'best_test_valid/acc_skew': 90.806, 'best_test_valid/acc_align': 88.794, 'best_test_test/acc': 89.283, 'best_test_test/acc_unbiased': 89.343, 'best_test_test/diff': 0.462, 'best_test_test/acc_skew': 89.574, 'best_test_test/acc_align': 89.113}
[18 / 20] Learning rate: 1e-05 weight: 0.01
[18 / 20] Loss: 4.600999489194319 CE Loss: 1.1564010004599528 Con Loss: 4.58943548137121
[18 / 20] tensor([[0.894, 0.891],
        [0.892, 0.893]]) {'epoch': 18, 'valid/acc': 89.662, 'valid/acc_unbiased': 89.801, 'valid/diff': 2.039, 'valid/acc_skew': 90.821, 'valid/acc_align': 88.781, 'test/acc': 89.241, 'test/acc_unbiased': 89.244, 'test/diff': 0.241, 'test/acc_skew': 89.302, 'test/acc_align': 89.186}
[18 / 20] best valid accuracy: 89.801 at epoch 18 
 best_stats: {'best_valid_epoch': 18, 'best_valid_valid/acc': 89.662, 'best_valid_valid/acc_unbiased': 89.801, 'best_valid_valid/diff': 2.039, 'best_valid_valid/acc_skew': 90.821, 'best_valid_valid/acc_align': 88.781, 'best_valid_test/acc': 89.241, 'best_valid_test/acc_unbiased': 89.244, 'best_valid_test/diff': 0.241, 'best_valid_test/acc_skew': 89.302, 'best_valid_test/acc_align': 89.186}
[18 / 20] best test accuracy: 89.343 at epoch 17 
 best_stats: {'best_test_epoch': 17, 'best_test_valid/acc': 89.62, 'best_test_valid/acc_unbiased': 89.8, 'best_test_valid/diff': 2.012, 'best_test_valid/acc_skew': 90.806, 'best_test_valid/acc_align': 88.794, 'best_test_test/acc': 89.283, 'best_test_test/acc_unbiased': 89.343, 'best_test_test/diff': 0.462, 'best_test_test/acc_skew': 89.574, 'best_test_test/acc_align': 89.113}
[19 / 20] Learning rate: 1e-05 weight: 0.01
[19 / 20] Loss: 4.594431614820873 CE Loss: 1.146649900147903 Con Loss: 4.58296512771944
[19 / 20] tensor([[0.876, 0.873],
        [0.913, 0.905]]) {'epoch': 19, 'valid/acc': 89.451, 'valid/acc_unbiased': 89.69, 'valid/diff': 2.203, 'valid/acc_skew': 90.791, 'valid/acc_align': 88.588, 'test/acc': 89.072, 'test/acc_unbiased': 89.191, 'test/diff': 0.595, 'test/acc_skew': 89.488, 'test/acc_align': 88.894}
[19 / 20] best valid accuracy: 89.801 at epoch 18 
 best_stats: {'best_valid_epoch': 18, 'best_valid_valid/acc': 89.662, 'best_valid_valid/acc_unbiased': 89.801, 'best_valid_valid/diff': 2.039, 'best_valid_valid/acc_skew': 90.821, 'best_valid_valid/acc_align': 88.781, 'best_valid_test/acc': 89.241, 'best_valid_test/acc_unbiased': 89.244, 'best_valid_test/diff': 0.241, 'best_valid_test/acc_skew': 89.302, 'best_valid_test/acc_align': 89.186}
[19 / 20] best test accuracy: 89.343 at epoch 17 
 best_stats: {'best_test_epoch': 17, 'best_test_valid/acc': 89.62, 'best_test_valid/acc_unbiased': 89.8, 'best_test_valid/diff': 2.012, 'best_test_valid/acc_skew': 90.806, 'best_test_valid/acc_align': 88.794, 'best_test_test/acc': 89.283, 'best_test_test/acc_unbiased': 89.343, 'best_test_test/diff': 0.462, 'best_test_test/acc_skew': 89.574, 'best_test_test/acc_align': 89.113}
[20 / 20] Learning rate: 1e-05 weight: 0.01
[20 / 20] Loss: 4.59246423329156 CE Loss: 1.1521825427738774 Con Loss: 4.580942426233879
[20 / 20] tensor([[0.876, 0.870],
        [0.909, 0.915]]) {'epoch': 20, 'valid/acc': 89.409, 'valid/acc_unbiased': 89.674, 'valid/diff': 2.111, 'valid/acc_skew': 90.729, 'valid/acc_align': 88.618, 'test/acc': 89.198, 'test/acc_unbiased': 89.269, 'test/diff': 0.627, 'test/acc_skew': 89.272, 'test/acc_align': 89.266}
[20 / 20] best valid accuracy: 89.801 at epoch 18 
 best_stats: {'best_valid_epoch': 18, 'best_valid_valid/acc': 89.662, 'best_valid_valid/acc_unbiased': 89.801, 'best_valid_valid/diff': 2.039, 'best_valid_valid/acc_skew': 90.821, 'best_valid_valid/acc_align': 88.781, 'best_valid_test/acc': 89.241, 'best_valid_test/acc_unbiased': 89.244, 'best_valid_test/diff': 0.241, 'best_valid_test/acc_skew': 89.302, 'best_valid_test/acc_align': 89.186}
[20 / 20] best test accuracy: 89.343 at epoch 17 
 best_stats: {'best_test_epoch': 17, 'best_test_valid/acc': 89.62, 'best_test_valid/acc_unbiased': 89.8, 'best_test_valid/diff': 2.012, 'best_test_valid/acc_skew': 90.806, 'best_test_valid/acc_align': 88.794, 'best_test_test/acc': 89.283, 'best_test_test/acc_unbiased': 89.343, 'best_test_test/diff': 0.462, 'best_test_test/acc_skew': 89.574, 'best_test_test/acc_align': 89.113}
Total training time: 1:27:45
