Log level set to: INFO
Set seed: 2
=======> Using Fixed Random Seed: 2 <========
save_path: exp_results/bc-bb0-celeba_smiling-crop_auto3-lr0.001-bs128-cbs64-w0.01-ratio30-aug1-seed2
get_celeba - split:train, aug: False, given_y: True, ratio: 0
use existing smiling indices from data/celeba/pickles/smiling
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [8019, 32821]
Target 1: [40611, 8007]
Binary Target 1
---------------------------
Target 0: [8019, 32821]
Target 1: [40611, 8007]
===================================
Normal Label Distribution: 
Target 0: [8019, 32821]
Target 1: [40611, 8007]
===================================
Use BiasedCelebASplit 
 target_attr: smiling split: train 
 tensor([[ 8019., 40611.],
        [32821.,  8007.]])
get_celeba - split:train, aug: 1, given_y: True, ratio: 30
use existing smiling indices from data/celeba/pickles/smiling
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [7986, 32687]
Target 1: [40769, 8016]
Binary Target 1
---------------------------
Target 0: [7986, 32687]
Target 1: [40769, 8016]
===================================
Normal Label Distribution: 
Target 0: [7986, 32687]
Target 1: [40769, 8016]
===================================
Use BiasedCelebASplit 
 target_attr: smiling split: train 
 tensor([[ 7986., 40769.],
        [32687.,  8016.]])
get_celeba - split:train_valid, aug: False, given_y: True, ratio: 0
use existing smiling indices from data/celeba/pickles/smiling
Use BiasedCelebASplit 
 target_attr: smiling split: train_valid 
 tensor([[ 1973., 10114.],
        [ 8289.,  1989.]])
get_celeba - split:valid, aug: False, given_y: True, ratio: 0
Use BiasedCelebASplit 
 target_attr: smiling split: valid 
 tensor([[5252., 6157.],
        [5013., 3445.]])
decay_epochs: [3, 6]
[1 / 10] Learning rate: 0.001 weight: 0.01
[1 / 10] Loss: 4.696100635919168 CE Loss: 0.26624832625497463 Con Loss: 4.693438160557785
[1 / 10] tensor([[0.916, 0.942],
        [0.928, 0.864]]) {'epoch': 1, 'valid/acc': 92.587, 'valid/acc_unbiased': 91.032, 'valid/diff': 5.01, 'valid/acc_skew': 88.527, 'valid/acc_align': 93.537, 'test/acc': 91.725, 'test/acc_unbiased': 91.247, 'test/diff': 4.523, 'test/acc_skew': 88.985, 'test/acc_align': 93.508}
[1 / 10] best valid accuracy: 91.032 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 92.587, 'best_valid_valid/acc_unbiased': 91.032, 'best_valid_valid/diff': 5.01, 'best_valid_valid/acc_skew': 88.527, 'best_valid_valid/acc_align': 93.537, 'best_valid_test/acc': 91.725, 'best_valid_test/acc_unbiased': 91.247, 'best_valid_test/diff': 4.523, 'best_valid_test/acc_skew': 88.985, 'best_valid_test/acc_align': 93.508}
[1 / 10] best test accuracy: 91.247 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 92.587, 'best_test_valid/acc_unbiased': 91.032, 'best_test_valid/diff': 5.01, 'best_test_valid/acc_skew': 88.527, 'best_test_valid/acc_align': 93.537, 'best_test_test/acc': 91.725, 'best_test_test/acc_unbiased': 91.247, 'best_test_test/diff': 4.523, 'best_test_test/acc_skew': 88.985, 'best_test_test/acc_align': 93.508}
[2 / 10] Learning rate: 0.001 weight: 0.01
[2 / 10] Loss: 4.649331738855063 CE Loss: 0.22734146452313334 Con Loss: 4.647058320697366
[2 / 10] tensor([[0.925, 0.937],
        [0.921, 0.886]]) {'epoch': 2, 'valid/acc': 92.216, 'valid/acc_unbiased': 91.787, 'valid/diff': 1.663, 'valid/acc_skew': 91.073, 'valid/acc_align': 92.5, 'test/acc': 91.972, 'test/acc_unbiased': 91.693, 'test/diff': 2.364, 'test/acc_skew': 90.512, 'test/acc_align': 92.875}
[2 / 10] best valid accuracy: 91.787 at epoch 2 
 best_stats: {'best_valid_epoch': 2, 'best_valid_valid/acc': 92.216, 'best_valid_valid/acc_unbiased': 91.787, 'best_valid_valid/diff': 1.663, 'best_valid_valid/acc_skew': 91.073, 'best_valid_valid/acc_align': 92.5, 'best_valid_test/acc': 91.972, 'best_valid_test/acc_unbiased': 91.693, 'best_valid_test/diff': 2.364, 'best_valid_test/acc_skew': 90.512, 'best_valid_test/acc_align': 92.875}
[2 / 10] best test accuracy: 91.693 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 92.216, 'best_test_valid/acc_unbiased': 91.787, 'best_test_valid/diff': 1.663, 'best_test_valid/acc_skew': 91.073, 'best_test_valid/acc_align': 92.5, 'best_test_test/acc': 91.972, 'best_test_test/acc_unbiased': 91.693, 'best_test_test/diff': 2.364, 'best_test_test/acc_skew': 90.512, 'best_test_test/acc_align': 92.875}
[3 / 10] Learning rate: 0.001 weight: 0.01
[3 / 10] Loss: 4.63528084922848 CE Loss: 0.21411882193958595 Con Loss: 4.633139657847382
[3 / 10] tensor([[0.865, 0.920],
        [0.949, 0.895]]) {'epoch': 3, 'valid/acc': 92.698, 'valid/acc_unbiased': 91.031, 'valid/diff': 4.739, 'valid/acc_skew': 88.662, 'valid/acc_align': 93.401, 'test/acc': 91.025, 'test/acc_unbiased': 90.736, 'test/diff': 5.441, 'test/acc_skew': 88.015, 'test/acc_align': 93.457}
[3 / 10] best valid accuracy: 91.787 at epoch 2 
 best_stats: {'best_valid_epoch': 2, 'best_valid_valid/acc': 92.216, 'best_valid_valid/acc_unbiased': 91.787, 'best_valid_valid/diff': 1.663, 'best_valid_valid/acc_skew': 91.073, 'best_valid_valid/acc_align': 92.5, 'best_valid_test/acc': 91.972, 'best_valid_test/acc_unbiased': 91.693, 'best_valid_test/diff': 2.364, 'best_valid_test/acc_skew': 90.512, 'best_valid_test/acc_align': 92.875}
[3 / 10] best test accuracy: 91.693 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 92.216, 'best_test_valid/acc_unbiased': 91.787, 'best_test_valid/diff': 1.663, 'best_test_valid/acc_skew': 91.073, 'best_test_valid/acc_align': 92.5, 'best_test_test/acc': 91.972, 'best_test_test/acc_unbiased': 91.693, 'best_test_test/diff': 2.364, 'best_test_test/acc_skew': 90.512, 'best_test_test/acc_align': 92.875}
[4 / 10] Learning rate: 0.0001 weight: 0.01
[4 / 10] Loss: 4.592694091014389 CE Loss: 0.18672401982408998 Con Loss: 4.590826861252687
[4 / 10] tensor([[0.923, 0.935],
        [0.935, 0.900]]) {'epoch': 4, 'valid/acc': 92.904, 'valid/acc_unbiased': 92.227, 'valid/diff': 2.067, 'valid/acc_skew': 91.194, 'valid/acc_align': 93.26, 'test/acc': 92.591, 'test/acc_unbiased': 92.341, 'test/diff': 2.311, 'test/acc_skew': 91.185, 'test/acc_align': 93.496}
[4 / 10] best valid accuracy: 92.227 at epoch 4 
 best_stats: {'best_valid_epoch': 4, 'best_valid_valid/acc': 92.904, 'best_valid_valid/acc_unbiased': 92.227, 'best_valid_valid/diff': 2.067, 'best_valid_valid/acc_skew': 91.194, 'best_valid_valid/acc_align': 93.26, 'best_valid_test/acc': 92.591, 'best_valid_test/acc_unbiased': 92.341, 'best_valid_test/diff': 2.311, 'best_valid_test/acc_skew': 91.185, 'best_valid_test/acc_align': 93.496}
[4 / 10] best test accuracy: 92.341 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 92.904, 'best_test_valid/acc_unbiased': 92.227, 'best_test_valid/diff': 2.067, 'best_test_valid/acc_skew': 91.194, 'best_test_valid/acc_align': 93.26, 'best_test_test/acc': 92.591, 'best_test_test/acc_unbiased': 92.341, 'best_test_test/diff': 2.311, 'best_test_test/acc_skew': 91.185, 'best_test_test/acc_align': 93.496}
[5 / 10] Learning rate: 0.0001 weight: 0.01
[5 / 10] Loss: 4.5831159989613 CE Loss: 0.18347866152931622 Con Loss: 4.581281214264195
[5 / 10] tensor([[0.920, 0.932],
        [0.938, 0.899]]) {'epoch': 5, 'valid/acc': 93.128, 'valid/acc_unbiased': 92.45, 'valid/diff': 2.005, 'valid/acc_skew': 91.448, 'valid/acc_align': 93.453, 'test/acc': 92.495, 'test/acc_unbiased': 92.221, 'test/diff': 2.57, 'test/acc_skew': 90.936, 'test/acc_align': 93.507}
[5 / 10] best valid accuracy: 92.450 at epoch 5 
 best_stats: {'best_valid_epoch': 5, 'best_valid_valid/acc': 93.128, 'best_valid_valid/acc_unbiased': 92.45, 'best_valid_valid/diff': 2.005, 'best_valid_valid/acc_skew': 91.448, 'best_valid_valid/acc_align': 93.453, 'best_valid_test/acc': 92.495, 'best_valid_test/acc_unbiased': 92.221, 'best_valid_test/diff': 2.57, 'best_valid_test/acc_skew': 90.936, 'best_valid_test/acc_align': 93.507}
[5 / 10] best test accuracy: 92.341 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 92.904, 'best_test_valid/acc_unbiased': 92.227, 'best_test_valid/diff': 2.067, 'best_test_valid/acc_skew': 91.194, 'best_test_valid/acc_align': 93.26, 'best_test_test/acc': 92.591, 'best_test_test/acc_unbiased': 92.341, 'best_test_test/diff': 2.311, 'best_test_test/acc_skew': 91.185, 'best_test_test/acc_align': 93.496}
[6 / 10] Learning rate: 0.0001 weight: 0.01
[6 / 10] Loss: 4.579941788643786 CE Loss: 0.18212453855804633 Con Loss: 4.5781205435037355
[6 / 10] tensor([[0.910, 0.922],
        [0.945, 0.917]]) {'epoch': 6, 'valid/acc': 93.172, 'valid/acc_unbiased': 92.394, 'valid/diff': 2.105, 'valid/acc_skew': 91.342, 'valid/acc_align': 93.447, 'test/acc': 92.475, 'test/acc_unbiased': 92.316, 'test/diff': 2.007, 'test/acc_skew': 91.312, 'test/acc_align': 93.319}
[6 / 10] best valid accuracy: 92.450 at epoch 5 
 best_stats: {'best_valid_epoch': 5, 'best_valid_valid/acc': 93.128, 'best_valid_valid/acc_unbiased': 92.45, 'best_valid_valid/diff': 2.005, 'best_valid_valid/acc_skew': 91.448, 'best_valid_valid/acc_align': 93.453, 'best_valid_test/acc': 92.495, 'best_valid_test/acc_unbiased': 92.221, 'best_valid_test/diff': 2.57, 'best_valid_test/acc_skew': 90.936, 'best_valid_test/acc_align': 93.507}
[6 / 10] best test accuracy: 92.341 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 92.904, 'best_test_valid/acc_unbiased': 92.227, 'best_test_valid/diff': 2.067, 'best_test_valid/acc_skew': 91.194, 'best_test_valid/acc_align': 93.26, 'best_test_test/acc': 92.591, 'best_test_test/acc_unbiased': 92.341, 'best_test_test/diff': 2.311, 'best_test_test/acc_skew': 91.185, 'best_test_test/acc_align': 93.496}
[7 / 10] Learning rate: 1e-05 weight: 0.01
[7 / 10] Loss: 4.567648120957224 CE Loss: 0.17702364627304457 Con Loss: 4.565877884749652
[7 / 10] tensor([[0.920, 0.930],
        [0.942, 0.910]]) {'epoch': 7, 'valid/acc': 93.199, 'valid/acc_unbiased': 92.528, 'valid/diff': 1.915, 'valid/acc_skew': 91.571, 'valid/acc_align': 93.485, 'test/acc': 92.752, 'test/acc_unbiased': 92.54, 'test/diff': 2.095, 'test/acc_skew': 91.493, 'test/acc_align': 93.588}
[7 / 10] best valid accuracy: 92.528 at epoch 7 
 best_stats: {'best_valid_epoch': 7, 'best_valid_valid/acc': 93.199, 'best_valid_valid/acc_unbiased': 92.528, 'best_valid_valid/diff': 1.915, 'best_valid_valid/acc_skew': 91.571, 'best_valid_valid/acc_align': 93.485, 'best_valid_test/acc': 92.752, 'best_valid_test/acc_unbiased': 92.54, 'best_valid_test/diff': 2.095, 'best_valid_test/acc_skew': 91.493, 'best_valid_test/acc_align': 93.588}
[7 / 10] best test accuracy: 92.540 at epoch 7 
 best_stats: {'best_test_epoch': 7, 'best_test_valid/acc': 93.199, 'best_test_valid/acc_unbiased': 92.528, 'best_test_valid/diff': 1.915, 'best_test_valid/acc_skew': 91.571, 'best_test_valid/acc_align': 93.485, 'best_test_test/acc': 92.752, 'best_test_test/acc_unbiased': 92.54, 'best_test_test/diff': 2.095, 'best_test_test/acc_skew': 91.493, 'best_test_test/acc_align': 93.588}
[8 / 10] Learning rate: 1e-05 weight: 0.01
[8 / 10] Loss: 4.568858150014903 CE Loss: 0.176355208264859 Con Loss: 4.5670946045589655
[8 / 10] tensor([[0.915, 0.928],
        [0.943, 0.912]]) {'epoch': 8, 'valid/acc': 93.262, 'valid/acc_unbiased': 92.414, 'valid/diff': 2.395, 'valid/acc_skew': 91.217, 'valid/acc_align': 93.612, 'test/acc': 92.626, 'test/acc_unbiased': 92.436, 'test/diff': 2.169, 'test/acc_skew': 91.352, 'test/acc_align': 93.521}
[8 / 10] best valid accuracy: 92.528 at epoch 7 
 best_stats: {'best_valid_epoch': 7, 'best_valid_valid/acc': 93.199, 'best_valid_valid/acc_unbiased': 92.528, 'best_valid_valid/diff': 1.915, 'best_valid_valid/acc_skew': 91.571, 'best_valid_valid/acc_align': 93.485, 'best_valid_test/acc': 92.752, 'best_valid_test/acc_unbiased': 92.54, 'best_valid_test/diff': 2.095, 'best_valid_test/acc_skew': 91.493, 'best_valid_test/acc_align': 93.588}
[8 / 10] best test accuracy: 92.540 at epoch 7 
 best_stats: {'best_test_epoch': 7, 'best_test_valid/acc': 93.199, 'best_test_valid/acc_unbiased': 92.528, 'best_test_valid/diff': 1.915, 'best_test_valid/acc_skew': 91.571, 'best_test_valid/acc_align': 93.485, 'best_test_test/acc': 92.752, 'best_test_test/acc_unbiased': 92.54, 'best_test_test/diff': 2.095, 'best_test_test/acc_skew': 91.493, 'best_test_test/acc_align': 93.588}
[9 / 10] Learning rate: 1e-05 weight: 0.01
[9 / 10] Loss: 4.565691081690126 CE Loss: 0.175204897758272 Con Loss: 4.563939027658968
[9 / 10] tensor([[0.929, 0.934],
        [0.934, 0.903]]) {'epoch': 9, 'valid/acc': 93.235, 'valid/acc_unbiased': 92.649, 'valid/diff': 1.799, 'valid/acc_skew': 91.749, 'valid/acc_align': 93.548, 'test/acc': 92.732, 'test/acc_unbiased': 92.5, 'test/diff': 1.835, 'test/acc_skew': 91.582, 'test/acc_align': 93.418}
[9 / 10] best valid accuracy: 92.649 at epoch 9 
 best_stats: {'best_valid_epoch': 9, 'best_valid_valid/acc': 93.235, 'best_valid_valid/acc_unbiased': 92.649, 'best_valid_valid/diff': 1.799, 'best_valid_valid/acc_skew': 91.749, 'best_valid_valid/acc_align': 93.548, 'best_valid_test/acc': 92.732, 'best_valid_test/acc_unbiased': 92.5, 'best_valid_test/diff': 1.835, 'best_valid_test/acc_skew': 91.582, 'best_valid_test/acc_align': 93.418}
[9 / 10] best test accuracy: 92.540 at epoch 7 
 best_stats: {'best_test_epoch': 7, 'best_test_valid/acc': 93.199, 'best_test_valid/acc_unbiased': 92.528, 'best_test_valid/diff': 1.915, 'best_test_valid/acc_skew': 91.571, 'best_test_valid/acc_align': 93.485, 'best_test_test/acc': 92.752, 'best_test_test/acc_unbiased': 92.54, 'best_test_test/diff': 2.095, 'best_test_test/acc_skew': 91.493, 'best_test_test/acc_align': 93.588}
[10 / 10] Learning rate: 1e-05 weight: 0.01
[10 / 10] Loss: 4.56140217796738 CE Loss: 0.1746343116146311 Con Loss: 4.559655829948605
[10 / 10] tensor([[0.916, 0.927],
        [0.943, 0.913]]) {'epoch': 10, 'valid/acc': 93.168, 'valid/acc_unbiased': 92.467, 'valid/diff': 1.943, 'valid/acc_skew': 91.495, 'valid/acc_align': 93.438, 'test/acc': 92.671, 'test/acc_unbiased': 92.485, 'test/diff': 2.045, 'test/acc_skew': 91.462, 'test/acc_align': 93.507}
[10 / 10] best valid accuracy: 92.649 at epoch 9 
 best_stats: {'best_valid_epoch': 9, 'best_valid_valid/acc': 93.235, 'best_valid_valid/acc_unbiased': 92.649, 'best_valid_valid/diff': 1.799, 'best_valid_valid/acc_skew': 91.749, 'best_valid_valid/acc_align': 93.548, 'best_valid_test/acc': 92.732, 'best_valid_test/acc_unbiased': 92.5, 'best_valid_test/diff': 1.835, 'best_valid_test/acc_skew': 91.582, 'best_valid_test/acc_align': 93.418}
[10 / 10] best test accuracy: 92.540 at epoch 7 
 best_stats: {'best_test_epoch': 7, 'best_test_valid/acc': 93.199, 'best_test_valid/acc_unbiased': 92.528, 'best_test_valid/diff': 1.915, 'best_test_valid/acc_skew': 91.571, 'best_test_valid/acc_align': 93.485, 'best_test_test/acc': 92.752, 'best_test_test/acc_unbiased': 92.54, 'best_test_test/diff': 2.095, 'best_test_test/acc_skew': 91.493, 'best_test_test/acc_align': 93.588}
Total training time: 1:39:28
