Log level set to: INFO
Set seed: 3
=======> Using Fixed Random Seed: 3 <========
save_path: exp_results/ce-celeba_blonde-test-lr0.001-bs128-seed3
get_celeba - split:train, aug: False, given_y: True, ratio: 0
use existing blonde indices from data/celeba/pickles/blonde
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [1628, 53486]
Target 1: [18293, 1105]
Binary Target 1
---------------------------
Target 0: [1628, 53486]
Target 1: [18293, 1105]
===================================
Normal Label Distribution: 
Target 0: [1628, 53486]
Target 1: [18293, 1105]
===================================
Use BiasedCelebASplit 
 target_attr: blonde split: train 
 tensor([[ 1628., 18293.],
        [53486.,  1105.]])
get_celeba - split:train_valid, aug: False, given_y: True, ratio: 0
use existing blonde indices from data/celeba/pickles/blonde
Use BiasedCelebASplit 
 target_attr: blonde split: train_valid 
 tensor([[  401.,  4553.],
        [13366.,   309.]])
get_celeba - split:valid, aug: False, given_y: True, ratio: 0
Use BiasedCelebASplit 
 target_attr: blonde split: valid 
 tensor([[8535., 2874.],
        [8276.,  182.]])
decay_epochs: [3, 6]
[1 / 10] Learning rate: 0.001
[1 / 10] Loss: 0.0873
[1 / 10] tensor([[0.770, 0.991],
        [0.980, 0.396]]) {'epoch': 1, 'valid/acc': 97.52, 'valid/acc_unbiased': 83.39, 'valid/diff': 30.038, 'valid/acc_skew': 68.372, 'valid/acc_align': 98.409, 'test/acc': 88.886, 'test/acc_unbiased': 78.409, 'test/diff': 40.292, 'test/acc_skew': 58.263, 'test/acc_align': 98.555}
[1 / 10] best valid accuracy: 83.390 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 97.52, 'best_valid_valid/acc_unbiased': 83.39, 'best_valid_valid/diff': 30.038, 'best_valid_valid/acc_skew': 68.372, 'best_valid_valid/acc_align': 98.409, 'best_valid_test/acc': 88.886, 'best_valid_test/acc_unbiased': 78.409, 'best_valid_test/diff': 40.292, 'best_valid_test/acc_skew': 58.263, 'best_valid_test/acc_align': 98.555}
[1 / 10] best test accuracy: 78.409 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 97.52, 'best_test_valid/acc_unbiased': 83.39, 'best_test_valid/diff': 30.038, 'best_test_valid/acc_skew': 68.372, 'best_test_valid/acc_align': 98.409, 'best_test_test/acc': 88.886, 'best_test_test/acc_unbiased': 78.409, 'best_test_test/diff': 40.292, 'best_test_test/acc_skew': 58.263, 'best_test_test/acc_align': 98.555}
[2 / 10] Learning rate: 0.001
[2 / 10] Loss: 0.0758
[2 / 10] tensor([[0.763, 0.995],
        [0.975, 0.236]]) {'epoch': 2, 'valid/acc': 97.579, 'valid/acc_unbiased': 78.601, 'valid/diff': 40.004, 'valid/acc_skew': 58.599, 'valid/acc_align': 98.603, 'test/acc': 88.569, 'test/acc_unbiased': 74.248, 'test/diff': 48.526, 'test/acc_skew': 49.985, 'test/acc_align': 98.511}
[2 / 10] best valid accuracy: 83.390 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 97.52, 'best_valid_valid/acc_unbiased': 83.39, 'best_valid_valid/diff': 30.038, 'best_valid_valid/acc_skew': 68.372, 'best_valid_valid/acc_align': 98.409, 'best_valid_test/acc': 88.886, 'best_valid_test/acc_unbiased': 78.409, 'best_valid_test/diff': 40.292, 'best_valid_test/acc_skew': 58.263, 'best_valid_test/acc_align': 98.555}
[2 / 10] best test accuracy: 78.409 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 97.52, 'best_test_valid/acc_unbiased': 83.39, 'best_test_valid/diff': 30.038, 'best_test_valid/acc_skew': 68.372, 'best_test_valid/acc_align': 98.409, 'best_test_test/acc': 88.886, 'best_test_test/acc_unbiased': 78.409, 'best_test_test/diff': 40.292, 'best_test_test/acc_skew': 58.263, 'best_test_test/acc_align': 98.555}
[3 / 10] Learning rate: 0.001
[3 / 10] Loss: 0.0729
[3 / 10] tensor([[0.794, 0.991],
        [0.970, 0.396]]) {'epoch': 3, 'valid/acc': 97.343, 'valid/acc_unbiased': 83.508, 'valid/diff': 28.677, 'valid/acc_skew': 69.17, 'valid/acc_align': 97.847, 'test/acc': 89.792, 'test/acc_unbiased': 78.775, 'test/diff': 38.61, 'test/acc_skew': 59.47, 'test/acc_align': 98.08}
[3 / 10] best valid accuracy: 83.508 at epoch 3 
 best_stats: {'best_valid_epoch': 3, 'best_valid_valid/acc': 97.343, 'best_valid_valid/acc_unbiased': 83.508, 'best_valid_valid/diff': 28.677, 'best_valid_valid/acc_skew': 69.17, 'best_valid_valid/acc_align': 97.847, 'best_valid_test/acc': 89.792, 'best_valid_test/acc_unbiased': 78.775, 'best_valid_test/diff': 38.61, 'best_valid_test/acc_skew': 59.47, 'best_valid_test/acc_align': 98.08}
[3 / 10] best test accuracy: 78.775 at epoch 3 
 best_stats: {'best_test_epoch': 3, 'best_test_valid/acc': 97.343, 'best_test_valid/acc_unbiased': 83.508, 'best_test_valid/diff': 28.677, 'best_test_valid/acc_skew': 69.17, 'best_test_valid/acc_align': 97.847, 'best_test_test/acc': 89.792, 'best_test_test/acc_unbiased': 78.775, 'best_test_test/diff': 38.61, 'best_test_test/acc_skew': 59.47, 'best_test_test/acc_align': 98.08}
[4 / 10] Learning rate: 0.0001
[4 / 10] Loss: 0.0546
[4 / 10] tensor([[0.719, 0.993],
        [0.989, 0.456]]) {'epoch': 4, 'valid/acc': 98.368, 'valid/acc_unbiased': 85.745, 'valid/diff': 27.25, 'valid/acc_skew': 72.12, 'valid/acc_align': 99.37, 'test/acc': 86.994, 'test/acc_unbiased': 78.933, 'test/diff': 40.357, 'test/acc_skew': 58.754, 'test/acc_align': 99.111}
[4 / 10] best valid accuracy: 85.745 at epoch 4 
 best_stats: {'best_valid_epoch': 4, 'best_valid_valid/acc': 98.368, 'best_valid_valid/acc_unbiased': 85.745, 'best_valid_valid/diff': 27.25, 'best_valid_valid/acc_skew': 72.12, 'best_valid_valid/acc_align': 99.37, 'best_valid_test/acc': 86.994, 'best_valid_test/acc_unbiased': 78.933, 'best_valid_test/diff': 40.357, 'best_valid_test/acc_skew': 58.754, 'best_valid_test/acc_align': 99.111}
[4 / 10] best test accuracy: 78.933 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 98.368, 'best_test_valid/acc_unbiased': 85.745, 'best_test_valid/diff': 27.25, 'best_test_valid/acc_skew': 72.12, 'best_test_valid/acc_align': 99.37, 'best_test_test/acc': 86.994, 'best_test_test/acc_unbiased': 78.933, 'best_test_test/diff': 40.357, 'best_test_test/acc_skew': 58.754, 'best_test_test/acc_align': 99.111}
[5 / 10] Learning rate: 0.0001
[5 / 10] Loss: 0.0477
[5 / 10] tensor([[0.751, 0.996],
        [0.984, 0.286]]) {'epoch': 5, 'valid/acc': 98.508, 'valid/acc_unbiased': 84.176, 'valid/diff': 30.579, 'valid/acc_skew': 68.886, 'valid/acc_align': 99.466, 'test/acc': 88.247, 'test/acc_unbiased': 75.416, 'test/diff': 47.181, 'test/acc_skew': 51.825, 'test/acc_align': 99.006}
[5 / 10] best valid accuracy: 85.745 at epoch 4 
 best_stats: {'best_valid_epoch': 4, 'best_valid_valid/acc': 98.368, 'best_valid_valid/acc_unbiased': 85.745, 'best_valid_valid/diff': 27.25, 'best_valid_valid/acc_skew': 72.12, 'best_valid_valid/acc_align': 99.37, 'best_valid_test/acc': 86.994, 'best_valid_test/acc_unbiased': 78.933, 'best_valid_test/diff': 40.357, 'best_valid_test/acc_skew': 58.754, 'best_valid_test/acc_align': 99.111}
[5 / 10] best test accuracy: 78.933 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 98.368, 'best_test_valid/acc_unbiased': 85.745, 'best_test_valid/diff': 27.25, 'best_test_valid/acc_skew': 72.12, 'best_test_valid/acc_align': 99.37, 'best_test_test/acc': 86.994, 'best_test_test/acc_unbiased': 78.933, 'best_test_test/diff': 40.357, 'best_test_test/acc_skew': 58.754, 'best_test_test/acc_align': 99.111}
[6 / 10] Learning rate: 0.0001
[6 / 10] Loss: 0.0428
[6 / 10] tensor([[0.759, 0.997],
        [0.984, 0.302]]) {'epoch': 6, 'valid/acc': 98.588, 'valid/acc_unbiased': 85.175, 'valid/diff': 28.539, 'valid/acc_skew': 70.905, 'valid/acc_align': 99.444, 'test/acc': 88.67, 'test/acc_unbiased': 76.06, 'test/diff': 45.966, 'test/acc_skew': 53.077, 'test/acc_align': 99.043}
[6 / 10] best valid accuracy: 85.745 at epoch 4 
 best_stats: {'best_valid_epoch': 4, 'best_valid_valid/acc': 98.368, 'best_valid_valid/acc_unbiased': 85.745, 'best_valid_valid/diff': 27.25, 'best_valid_valid/acc_skew': 72.12, 'best_valid_valid/acc_align': 99.37, 'best_valid_test/acc': 86.994, 'best_valid_test/acc_unbiased': 78.933, 'best_valid_test/diff': 40.357, 'best_valid_test/acc_skew': 58.754, 'best_valid_test/acc_align': 99.111}
[6 / 10] best test accuracy: 78.933 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 98.368, 'best_test_valid/acc_unbiased': 85.745, 'best_test_valid/diff': 27.25, 'best_test_valid/acc_skew': 72.12, 'best_test_valid/acc_align': 99.37, 'best_test_test/acc': 86.994, 'best_test_test/acc_unbiased': 78.933, 'best_test_test/diff': 40.357, 'best_test_test/acc_skew': 58.754, 'best_test_test/acc_align': 99.111}
[7 / 10] Learning rate: 1e-05
[7 / 10] Loss: 0.0344
[7 / 10] tensor([[0.779, 0.996],
        [0.983, 0.341]]) {'epoch': 7, 'valid/acc': 98.781, 'valid/acc_unbiased': 87.837, 'valid/diff': 23.353, 'valid/acc_skew': 76.16, 'valid/acc_align': 99.513, 'test/acc': 89.47, 'test/acc_unbiased': 77.46, 'test/diff': 42.987, 'test/acc_skew': 55.967, 'test/acc_align': 98.953}
[7 / 10] best valid accuracy: 87.837 at epoch 7 
 best_stats: {'best_valid_epoch': 7, 'best_valid_valid/acc': 98.781, 'best_valid_valid/acc_unbiased': 87.837, 'best_valid_valid/diff': 23.353, 'best_valid_valid/acc_skew': 76.16, 'best_valid_valid/acc_align': 99.513, 'best_valid_test/acc': 89.47, 'best_valid_test/acc_unbiased': 77.46, 'best_valid_test/diff': 42.987, 'best_valid_test/acc_skew': 55.967, 'best_valid_test/acc_align': 98.953}
[7 / 10] best test accuracy: 78.933 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 98.368, 'best_test_valid/acc_unbiased': 85.745, 'best_test_valid/diff': 27.25, 'best_test_valid/acc_skew': 72.12, 'best_test_valid/acc_align': 99.37, 'best_test_test/acc': 86.994, 'best_test_test/acc_unbiased': 78.933, 'best_test_test/diff': 40.357, 'best_test_test/acc_skew': 58.754, 'best_test_test/acc_align': 99.111}
[8 / 10] Learning rate: 1e-05
[8 / 10] Loss: 0.0316
[8 / 10] tensor([[0.772, 0.993],
        [0.984, 0.423]]) {'epoch': 8, 'valid/acc': 98.851, 'valid/acc_unbiased': 90.035, 'valid/diff': 18.938, 'valid/acc_skew': 80.566, 'valid/acc_align': 99.504, 'test/acc': 89.143, 'test/acc_unbiased': 79.29, 'test/diff': 39.108, 'test/acc_skew': 59.736, 'test/acc_align': 98.844}
[8 / 10] best valid accuracy: 90.035 at epoch 8 
 best_stats: {'best_valid_epoch': 8, 'best_valid_valid/acc': 98.851, 'best_valid_valid/acc_unbiased': 90.035, 'best_valid_valid/diff': 18.938, 'best_valid_valid/acc_skew': 80.566, 'best_valid_valid/acc_align': 99.504, 'best_valid_test/acc': 89.143, 'best_valid_test/acc_unbiased': 79.29, 'best_valid_test/diff': 39.108, 'best_valid_test/acc_skew': 59.736, 'best_valid_test/acc_align': 98.844}
[8 / 10] best test accuracy: 79.290 at epoch 8 
 best_stats: {'best_test_epoch': 8, 'best_test_valid/acc': 98.851, 'best_test_valid/acc_unbiased': 90.035, 'best_test_valid/diff': 18.938, 'best_test_valid/acc_skew': 80.566, 'best_test_valid/acc_align': 99.504, 'best_test_test/acc': 89.143, 'best_test_test/acc_unbiased': 79.29, 'best_test_test/diff': 39.108, 'best_test_test/acc_skew': 59.736, 'best_test_test/acc_align': 98.844}
[9 / 10] Learning rate: 1e-05
[9 / 10] Loss: 0.0302
[9 / 10] tensor([[0.752, 0.994],
        [0.986, 0.390]]) {'epoch': 9, 'valid/acc': 98.921, 'valid/acc_unbiased': 90.131, 'valid/diff': 18.88, 'valid/acc_skew': 80.691, 'valid/acc_align': 99.571, 'test/acc': 88.317, 'test/acc_unbiased': 78.038, 'test/diff': 41.869, 'test/acc_skew': 57.104, 'test/acc_align': 98.973}
[9 / 10] best valid accuracy: 90.131 at epoch 9 
 best_stats: {'best_valid_epoch': 9, 'best_valid_valid/acc': 98.921, 'best_valid_valid/acc_unbiased': 90.131, 'best_valid_valid/diff': 18.88, 'best_valid_valid/acc_skew': 80.691, 'best_valid_valid/acc_align': 99.571, 'best_valid_test/acc': 88.317, 'best_valid_test/acc_unbiased': 78.038, 'best_valid_test/diff': 41.869, 'best_valid_test/acc_skew': 57.104, 'best_valid_test/acc_align': 98.973}
[9 / 10] best test accuracy: 79.290 at epoch 8 
 best_stats: {'best_test_epoch': 8, 'best_test_valid/acc': 98.851, 'best_test_valid/acc_unbiased': 90.035, 'best_test_valid/diff': 18.938, 'best_test_valid/acc_skew': 80.566, 'best_test_valid/acc_align': 99.504, 'best_test_test/acc': 89.143, 'best_test_test/acc_unbiased': 79.29, 'best_test_test/diff': 39.108, 'best_test_test/acc_skew': 59.736, 'best_test_test/acc_align': 98.844}
[10 / 10] Learning rate: 1e-05
[10 / 10] Loss: 0.0282
[10 / 10] tensor([[0.746, 0.993],
        [0.985, 0.412]]) {'epoch': 10, 'valid/acc': 99.002, 'valid/acc_unbiased': 90.881, 'valid/diff': 17.467, 'valid/acc_skew': 82.147, 'valid/acc_align': 99.615, 'test/acc': 88.035, 'test/acc_unbiased': 78.406, 'test/diff': 41.039, 'test/acc_skew': 57.886, 'test/acc_align': 98.925}
[10 / 10] best valid accuracy: 90.881 at epoch 10 
 best_stats: {'best_valid_epoch': 10, 'best_valid_valid/acc': 99.002, 'best_valid_valid/acc_unbiased': 90.881, 'best_valid_valid/diff': 17.467, 'best_valid_valid/acc_skew': 82.147, 'best_valid_valid/acc_align': 99.615, 'best_valid_test/acc': 88.035, 'best_valid_test/acc_unbiased': 78.406, 'best_valid_test/diff': 41.039, 'best_valid_test/acc_skew': 57.886, 'best_valid_test/acc_align': 98.925}
[10 / 10] best test accuracy: 79.290 at epoch 8 
 best_stats: {'best_test_epoch': 8, 'best_test_valid/acc': 98.851, 'best_test_valid/acc_unbiased': 90.035, 'best_test_valid/diff': 18.938, 'best_test_valid/acc_skew': 80.566, 'best_test_valid/acc_align': 99.504, 'best_test_test/acc': 89.143, 'best_test_test/acc_unbiased': 79.29, 'best_test_test/diff': 39.108, 'best_test_test/acc_skew': 59.736, 'best_test_test/acc_align': 98.844}
Total training time: 0:47:33
