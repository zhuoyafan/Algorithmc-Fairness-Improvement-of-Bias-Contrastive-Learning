Log level set to: INFO
Set seed: 1
=======> Using Fixed Random Seed: 1 <========
save_path: exp_results/bc-bb0-utk_face_race-uw-0.5-lr0.001-bs128-cbs64-w0.01-ratio10-aug1-seed1
get_utk_face - split: train, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_race-0.5
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [4407, 2764]
Target 1: [2203, 5529]
Binary Target 1
---------------------------
Target 0: [4407, 2764]
Target 1: [2203, 5529]
===================================
Normal Label Distribution: 
Target 0: [4407, 2764]
Target 1: [2203, 5529]
===================================
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [4407, 2764]
Target 1: [2203, 5529]
Binary Target 1
---------------------------
Target 0: [4407, 2764]
Target 1: [2203, 5529]
===================================
Normal Label Distribution: 
Target 0: [4407, 2764]
Target 1: [2203, 5529]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 14903, target_attr: gender, bias_attr: race bias_rate: 0.5
['[train] target_0-bias_0: 4407', '[train] target_0-bias_1: 2764', '[train] target_1-bias_0: 2203', '[train] target_1-bias_1: 5529']
confusion_matrix - 
 original: tensor([[4407., 2203.],
        [2764., 5529.]]), 
 normalized: tensor([[0.667, 0.333],
        [0.333, 0.667]]), 
 b|y: tensor([[0.615, 0.385],
        [0.285, 0.715]])
get_utk_face - split: train, aug: 1, given_y: True, ratio: 10
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_race-0.5
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [4407, 2764]
Target 1: [2203, 5529]
Binary Target 1
---------------------------
Target 0: [4407, 2764]
Target 1: [2203, 5529]
===================================
Normal Label Distribution: 
Target 0: [4407, 2764]
Target 1: [2203, 5529]
===================================
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [4407, 2764]
Target 1: [2203, 5529]
Binary Target 1
---------------------------
Target 0: [4407, 2764]
Target 1: [2203, 5529]
===================================
Normal Label Distribution: 
Target 0: [4407, 2764]
Target 1: [2203, 5529]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 14903, target_attr: gender, bias_attr: race bias_rate: 0.5
['[train] target_0-bias_0: 4407', '[train] target_0-bias_1: 2764', '[train] target_1-bias_0: 2203', '[train] target_1-bias_1: 5529']
get_utk_face - split: valid, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_race-0.5
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [583, 684]
Target 1: [457, 646]
Binary Target 1
---------------------------
Target 0: [583, 684]
Target 1: [457, 646]
===================================
Normal Label Distribution: 
Target 0: [583, 684]
Target 1: [457, 646]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 2370, target_attr: gender, bias_attr: race bias_rate: 0.5
['[valid] target_0-bias_0: 583', '[valid] target_0-bias_1: 684', '[valid] target_1-bias_0: 457', '[valid] target_1-bias_1: 646']
get_utk_face - split: test, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_race-0.5
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [558, 677]
Target 1: [462, 673]
Binary Target 1
---------------------------
Target 0: [558, 677]
Target 1: [462, 673]
===================================
Normal Label Distribution: 
Target 0: [558, 677]
Target 1: [462, 673]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 2370, target_attr: gender, bias_attr: race bias_rate: 0.5
['[test] target_0-bias_0: 558', '[test] target_0-bias_1: 677', '[test] target_1-bias_0: 462', '[test] target_1-bias_1: 673']
decay_epochs: [6, 13]
[1 / 20] Learning rate: 0.001 weight: 0.01
[1 / 20] Loss: 4.864572369427615 CE Loss: 2.1385466890079754 Con Loss: 4.843186903406227
[1 / 20] tensor([[0.654, 0.632],
        [0.890, 0.908]]) {'epoch': 1, 'valid/acc': 76.16, 'valid/acc_unbiased': 77.092, 'valid/diff': 2.999, 'valid/acc_skew': 78.591, 'valid/acc_align': 75.593, 'test/acc': 76.582, 'test/acc_unbiased': 77.095, 'test/diff': 2.009, 'test/acc_skew': 76.091, 'test/acc_align': 78.1}
[1 / 20] best valid accuracy: 77.092 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 76.16, 'best_valid_valid/acc_unbiased': 77.092, 'best_valid_valid/diff': 2.999, 'best_valid_valid/acc_skew': 78.591, 'best_valid_valid/acc_align': 75.593, 'best_valid_test/acc': 76.582, 'best_valid_test/acc_unbiased': 77.095, 'best_valid_test/diff': 2.009, 'best_valid_test/acc_skew': 76.091, 'best_valid_test/acc_align': 78.1}
[1 / 20] best test accuracy: 77.095 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 76.16, 'best_test_valid/acc_unbiased': 77.092, 'best_test_valid/diff': 2.999, 'best_test_valid/acc_skew': 78.591, 'best_test_valid/acc_align': 75.593, 'best_test_test/acc': 76.582, 'best_test_test/acc_unbiased': 77.095, 'best_test_test/diff': 2.009, 'best_test_test/acc_skew': 76.091, 'best_test_test/acc_align': 78.1}
[2 / 20] Learning rate: 0.001 weight: 0.01
[2 / 20] Loss: 4.770717536252048 CE Loss: 1.7585490356713567 Con Loss: 4.75313204966447
[2 / 20] tensor([[0.934, 0.905],
        [0.688, 0.727]]) {'epoch': 2, 'valid/acc': 81.941, 'valid/acc_unbiased': 81.403, 'valid/diff': 2.856, 'valid/acc_skew': 82.12, 'valid/acc_align': 80.686, 'test/acc': 81.899, 'test/acc_unbiased': 81.352, 'test/diff': 3.326, 'test/acc_skew': 79.689, 'test/acc_align': 83.014}
[2 / 20] best valid accuracy: 81.403 at epoch 2 
 best_stats: {'best_valid_epoch': 2, 'best_valid_valid/acc': 81.941, 'best_valid_valid/acc_unbiased': 81.403, 'best_valid_valid/diff': 2.856, 'best_valid_valid/acc_skew': 82.12, 'best_valid_valid/acc_align': 80.686, 'best_valid_test/acc': 81.899, 'best_valid_test/acc_unbiased': 81.352, 'best_valid_test/diff': 3.326, 'best_valid_test/acc_skew': 79.689, 'best_valid_test/acc_align': 83.014}
[2 / 20] best test accuracy: 81.352 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 81.941, 'best_test_valid/acc_unbiased': 81.403, 'best_test_valid/diff': 2.856, 'best_test_valid/acc_skew': 82.12, 'best_test_valid/acc_align': 80.686, 'best_test_test/acc': 81.899, 'best_test_test/acc_unbiased': 81.352, 'best_test_test/diff': 3.326, 'best_test_test/acc_skew': 79.689, 'best_test_test/acc_align': 83.014}
[3 / 20] Learning rate: 0.001 weight: 0.01
[3 / 20] Loss: 4.738648234889994 CE Loss: 1.646828779196456 Con Loss: 4.722179951751295
[3 / 20] tensor([[0.833, 0.814],
        [0.844, 0.862]]) {'epoch': 3, 'valid/acc': 83.84, 'valid/acc_unbiased': 83.981, 'valid/diff': 0.49, 'valid/acc_skew': 84.226, 'valid/acc_align': 83.736, 'test/acc': 83.797, 'test/acc_unbiased': 83.83, 'test/diff': 1.855, 'test/acc_skew': 82.902, 'test/acc_align': 84.757}
[3 / 20] best valid accuracy: 83.981 at epoch 3 
 best_stats: {'best_valid_epoch': 3, 'best_valid_valid/acc': 83.84, 'best_valid_valid/acc_unbiased': 83.981, 'best_valid_valid/diff': 0.49, 'best_valid_valid/acc_skew': 84.226, 'best_valid_valid/acc_align': 83.736, 'best_valid_test/acc': 83.797, 'best_valid_test/acc_unbiased': 83.83, 'best_valid_test/diff': 1.855, 'best_valid_test/acc_skew': 82.902, 'best_valid_test/acc_align': 84.757}
[3 / 20] best test accuracy: 83.830 at epoch 3 
 best_stats: {'best_test_epoch': 3, 'best_test_valid/acc': 83.84, 'best_test_valid/acc_unbiased': 83.981, 'best_test_valid/diff': 0.49, 'best_test_valid/acc_skew': 84.226, 'best_test_valid/acc_align': 83.736, 'best_test_test/acc': 83.797, 'best_test_test/acc_unbiased': 83.83, 'best_test_test/diff': 1.855, 'best_test_test/acc_skew': 82.902, 'best_test_test/acc_align': 84.757}
[4 / 20] Learning rate: 0.001 weight: 0.01
[4 / 20] Loss: 4.720779829262679 CE Loss: 1.6350635432848264 Con Loss: 4.704429195797988
[4 / 20] tensor([[0.851, 0.832],
        [0.827, 0.842]]) {'epoch': 4, 'valid/acc': 85.781, 'valid/acc_unbiased': 85.856, 'valid/diff': 2.028, 'valid/acc_skew': 86.418, 'valid/acc_align': 85.294, 'test/acc': 83.84, 'test/acc_unbiased': 83.805, 'test/diff': 1.765, 'test/acc_skew': 82.922, 'test/acc_align': 84.688}
[4 / 20] best valid accuracy: 85.856 at epoch 4 
 best_stats: {'best_valid_epoch': 4, 'best_valid_valid/acc': 85.781, 'best_valid_valid/acc_unbiased': 85.856, 'best_valid_valid/diff': 2.028, 'best_valid_valid/acc_skew': 86.418, 'best_valid_valid/acc_align': 85.294, 'best_valid_test/acc': 83.84, 'best_valid_test/acc_unbiased': 83.805, 'best_valid_test/diff': 1.765, 'best_valid_test/acc_skew': 82.922, 'best_valid_test/acc_align': 84.688}
[4 / 20] best test accuracy: 83.830 at epoch 3 
 best_stats: {'best_test_epoch': 3, 'best_test_valid/acc': 83.84, 'best_test_valid/acc_unbiased': 83.981, 'best_test_valid/diff': 0.49, 'best_test_valid/acc_skew': 84.226, 'best_test_valid/acc_align': 83.736, 'best_test_test/acc': 83.797, 'best_test_test/acc_unbiased': 83.83, 'best_test_test/diff': 1.855, 'best_test_test/acc_skew': 82.902, 'best_test_test/acc_align': 84.757}
[5 / 20] Learning rate: 0.001 weight: 0.01
[5 / 20] Loss: 4.713622091888846 CE Loss: 1.5657060604515247 Con Loss: 4.697965036612473
[5 / 20] tensor([[0.858, 0.857],
        [0.835, 0.844]]) {'epoch': 5, 'valid/acc': 84.43, 'valid/acc_unbiased': 84.533, 'valid/diff': 2.426, 'valid/acc_skew': 85.542, 'valid/acc_align': 83.525, 'test/acc': 84.937, 'test/acc_unbiased': 84.866, 'test/diff': 0.509, 'test/acc_skew': 84.611, 'test/acc_align': 85.12}
[5 / 20] best valid accuracy: 85.856 at epoch 4 
 best_stats: {'best_valid_epoch': 4, 'best_valid_valid/acc': 85.781, 'best_valid_valid/acc_unbiased': 85.856, 'best_valid_valid/diff': 2.028, 'best_valid_valid/acc_skew': 86.418, 'best_valid_valid/acc_align': 85.294, 'best_valid_test/acc': 83.84, 'best_valid_test/acc_unbiased': 83.805, 'best_valid_test/diff': 1.765, 'best_valid_test/acc_skew': 82.922, 'best_valid_test/acc_align': 84.688}
[5 / 20] best test accuracy: 84.866 at epoch 5 
 best_stats: {'best_test_epoch': 5, 'best_test_valid/acc': 84.43, 'best_test_valid/acc_unbiased': 84.533, 'best_test_valid/diff': 2.426, 'best_test_valid/acc_skew': 85.542, 'best_test_valid/acc_align': 83.525, 'best_test_test/acc': 84.937, 'best_test_test/acc_unbiased': 84.866, 'best_test_test/diff': 0.509, 'best_test_test/acc_skew': 84.611, 'best_test_test/acc_align': 85.12}
[6 / 20] Learning rate: 0.001 weight: 0.01
[6 / 20] Loss: 4.703189557377607 CE Loss: 1.5649112812634292 Con Loss: 4.687540448896598
[6 / 20] tensor([[0.616, 0.606],
        [0.974, 0.964]]) {'epoch': 6, 'valid/acc': 77.468, 'valid/acc_unbiased': 78.654, 'valid/diff': 3.369, 'valid/acc_skew': 80.339, 'valid/acc_align': 76.969, 'test/acc': 78.186, 'test/acc_unbiased': 79.012, 'test/diff': 1.028, 'test/acc_skew': 78.982, 'test/acc_align': 79.041}
[6 / 20] best valid accuracy: 85.856 at epoch 4 
 best_stats: {'best_valid_epoch': 4, 'best_valid_valid/acc': 85.781, 'best_valid_valid/acc_unbiased': 85.856, 'best_valid_valid/diff': 2.028, 'best_valid_valid/acc_skew': 86.418, 'best_valid_valid/acc_align': 85.294, 'best_valid_test/acc': 83.84, 'best_valid_test/acc_unbiased': 83.805, 'best_valid_test/diff': 1.765, 'best_valid_test/acc_skew': 82.922, 'best_valid_test/acc_align': 84.688}
[6 / 20] best test accuracy: 84.866 at epoch 5 
 best_stats: {'best_test_epoch': 5, 'best_test_valid/acc': 84.43, 'best_test_valid/acc_unbiased': 84.533, 'best_test_valid/diff': 2.426, 'best_test_valid/acc_skew': 85.542, 'best_test_valid/acc_align': 83.525, 'best_test_test/acc': 84.937, 'best_test_test/acc_unbiased': 84.866, 'best_test_test/diff': 0.509, 'best_test_test/acc_skew': 84.611, 'best_test_test/acc_align': 85.12}
[7 / 20] Learning rate: 0.0001 weight: 0.01
[7 / 20] Loss: 4.670981908479665 CE Loss: 1.3730356144535536 Con Loss: 4.6572515604072535
[7 / 20] tensor([[0.864, 0.851],
        [0.877, 0.880]]) {'epoch': 7, 'valid/acc': 88.017, 'valid/acc_unbiased': 88.183, 'valid/diff': 0.627, 'valid/acc_skew': 88.242, 'valid/acc_align': 88.125, 'test/acc': 86.709, 'test/acc_unbiased': 86.772, 'test/diff': 0.8, 'test/acc_skew': 86.372, 'test/acc_align': 87.172}
[7 / 20] best valid accuracy: 88.183 at epoch 7 
 best_stats: {'best_valid_epoch': 7, 'best_valid_valid/acc': 88.017, 'best_valid_valid/acc_unbiased': 88.183, 'best_valid_valid/diff': 0.627, 'best_valid_valid/acc_skew': 88.242, 'best_valid_valid/acc_align': 88.125, 'best_valid_test/acc': 86.709, 'best_valid_test/acc_unbiased': 86.772, 'best_valid_test/diff': 0.8, 'best_valid_test/acc_skew': 86.372, 'best_valid_test/acc_align': 87.172}
[7 / 20] best test accuracy: 86.772 at epoch 7 
 best_stats: {'best_test_epoch': 7, 'best_test_valid/acc': 88.017, 'best_test_valid/acc_unbiased': 88.183, 'best_test_valid/diff': 0.627, 'best_test_valid/acc_skew': 88.242, 'best_test_valid/acc_align': 88.125, 'best_test_test/acc': 86.709, 'best_test_test/acc_unbiased': 86.772, 'best_test_test/diff': 0.8, 'best_test_test/acc_skew': 86.372, 'best_test_test/acc_align': 87.172}
[8 / 20] Learning rate: 0.0001 weight: 0.01
[8 / 20] Loss: 4.649743377926413 CE Loss: 1.3125763965246542 Con Loss: 4.636617617967712
[8 / 20] tensor([[0.880, 0.870],
        [0.846, 0.872]]) {'epoch': 8, 'valid/acc': 88.481, 'valid/acc_unbiased': 88.493, 'valid/diff': 0.498, 'valid/acc_skew': 88.243, 'valid/acc_align': 88.742, 'test/acc': 86.835, 'test/acc_unbiased': 86.712, 'test/diff': 1.79, 'test/acc_skew': 85.817, 'test/acc_align': 87.607}
[8 / 20] best valid accuracy: 88.493 at epoch 8 
 best_stats: {'best_valid_epoch': 8, 'best_valid_valid/acc': 88.481, 'best_valid_valid/acc_unbiased': 88.493, 'best_valid_valid/diff': 0.498, 'best_valid_valid/acc_skew': 88.243, 'best_valid_valid/acc_align': 88.742, 'best_valid_test/acc': 86.835, 'best_valid_test/acc_unbiased': 86.712, 'best_valid_test/diff': 1.79, 'best_valid_test/acc_skew': 85.817, 'best_valid_test/acc_align': 87.607}
[8 / 20] best test accuracy: 86.772 at epoch 7 
 best_stats: {'best_test_epoch': 7, 'best_test_valid/acc': 88.017, 'best_test_valid/acc_unbiased': 88.183, 'best_test_valid/diff': 0.627, 'best_test_valid/acc_skew': 88.242, 'best_test_valid/acc_align': 88.125, 'best_test_test/acc': 86.709, 'best_test_test/acc_unbiased': 86.772, 'best_test_test/diff': 0.8, 'best_test_test/acc_skew': 86.372, 'best_test_test/acc_align': 87.172}
[9 / 20] Learning rate: 0.0001 weight: 0.01
[9 / 20] Loss: 4.6329701976920745 CE Loss: 1.2584348164020365 Con Loss: 4.6203858449076245
[9 / 20] tensor([[0.894, 0.888],
        [0.840, 0.856]]) {'epoch': 9, 'valid/acc': 88.017, 'valid/acc_unbiased': 87.979, 'valid/diff': 0.373, 'valid/acc_skew': 88.026, 'valid/acc_align': 87.932, 'test/acc': 87.089, 'test/acc_unbiased': 86.943, 'test/diff': 1.128, 'test/acc_skew': 86.378, 'test/acc_align': 87.507}
[9 / 20] best valid accuracy: 88.493 at epoch 8 
 best_stats: {'best_valid_epoch': 8, 'best_valid_valid/acc': 88.481, 'best_valid_valid/acc_unbiased': 88.493, 'best_valid_valid/diff': 0.498, 'best_valid_valid/acc_skew': 88.243, 'best_valid_valid/acc_align': 88.742, 'best_valid_test/acc': 86.835, 'best_valid_test/acc_unbiased': 86.712, 'best_valid_test/diff': 1.79, 'best_valid_test/acc_skew': 85.817, 'best_valid_test/acc_align': 87.607}
[9 / 20] best test accuracy: 86.943 at epoch 9 
 best_stats: {'best_test_epoch': 9, 'best_test_valid/acc': 88.017, 'best_test_valid/acc_unbiased': 87.979, 'best_test_valid/diff': 0.373, 'best_test_valid/acc_skew': 88.026, 'best_test_valid/acc_align': 87.932, 'best_test_test/acc': 87.089, 'best_test_test/acc_unbiased': 86.943, 'best_test_test/diff': 1.128, 'best_test_test/acc_skew': 86.378, 'best_test_test/acc_align': 87.507}
[10 / 20] Learning rate: 0.0001 weight: 0.01
[10 / 20] Loss: 4.618397697285423 CE Loss: 1.240362565701243 Con Loss: 4.6059940514497
[10 / 20] tensor([[0.875, 0.871],
        [0.881, 0.875]]) {'epoch': 10, 'valid/acc': 88.481, 'valid/acc_unbiased': 88.577, 'valid/diff': 0.898, 'valid/acc_skew': 88.791, 'valid/acc_align': 88.363, 'test/acc': 87.511, 'test/acc_unbiased': 87.555, 'test/diff': 0.441, 'test/acc_skew': 87.622, 'test/acc_align': 87.487}
[10 / 20] best valid accuracy: 88.577 at epoch 10 
 best_stats: {'best_valid_epoch': 10, 'best_valid_valid/acc': 88.481, 'best_valid_valid/acc_unbiased': 88.577, 'best_valid_valid/diff': 0.898, 'best_valid_valid/acc_skew': 88.791, 'best_valid_valid/acc_align': 88.363, 'best_valid_test/acc': 87.511, 'best_valid_test/acc_unbiased': 87.555, 'best_valid_test/diff': 0.441, 'best_valid_test/acc_skew': 87.622, 'best_valid_test/acc_align': 87.487}
[10 / 20] best test accuracy: 87.555 at epoch 10 
 best_stats: {'best_test_epoch': 10, 'best_test_valid/acc': 88.481, 'best_test_valid/acc_unbiased': 88.577, 'best_test_valid/diff': 0.898, 'best_test_valid/acc_skew': 88.791, 'best_test_valid/acc_align': 88.363, 'best_test_test/acc': 87.511, 'best_test_test/acc_unbiased': 87.555, 'best_test_test/diff': 0.441, 'best_test_test/acc_skew': 87.622, 'best_test_test/acc_align': 87.487}
[11 / 20] Learning rate: 0.0001 weight: 0.01
[11 / 20] Loss: 4.623511453062978 CE Loss: 1.206149912109265 Con Loss: 4.611449977867332
[11 / 20] tensor([[0.892, 0.886],
        [0.866, 0.866]]) {'epoch': 11, 'valid/acc': 88.059, 'valid/acc_unbiased': 88.077, 'valid/diff': 1.65, 'valid/acc_skew': 88.902, 'valid/acc_align': 87.252, 'test/acc': 87.806, 'test/acc_unbiased': 87.77, 'test/diff': 0.334, 'test/acc_skew': 87.603, 'test/acc_align': 87.937}
[11 / 20] best valid accuracy: 88.577 at epoch 10 
 best_stats: {'best_valid_epoch': 10, 'best_valid_valid/acc': 88.481, 'best_valid_valid/acc_unbiased': 88.577, 'best_valid_valid/diff': 0.898, 'best_valid_valid/acc_skew': 88.791, 'best_valid_valid/acc_align': 88.363, 'best_valid_test/acc': 87.511, 'best_valid_test/acc_unbiased': 87.555, 'best_valid_test/diff': 0.441, 'best_valid_test/acc_skew': 87.622, 'best_valid_test/acc_align': 87.487}
[11 / 20] best test accuracy: 87.770 at epoch 11 
 best_stats: {'best_test_epoch': 11, 'best_test_valid/acc': 88.059, 'best_test_valid/acc_unbiased': 88.077, 'best_test_valid/diff': 1.65, 'best_test_valid/acc_skew': 88.902, 'best_test_valid/acc_align': 87.252, 'best_test_test/acc': 87.806, 'best_test_test/acc_unbiased': 87.77, 'best_test_test/diff': 0.334, 'best_test_test/acc_skew': 87.603, 'best_test_test/acc_align': 87.937}
[12 / 20] Learning rate: 0.0001 weight: 0.01
[12 / 20] Loss: 4.6131373283999535 CE Loss: 1.2124990838602518 Con Loss: 4.6010123437613855
[12 / 20] tensor([[0.891, 0.879],
        [0.855, 0.875]]) {'epoch': 12, 'valid/acc': 88.608, 'valid/acc_unbiased': 88.657, 'valid/diff': 1.282, 'valid/acc_skew': 89.047, 'valid/acc_align': 88.267, 'test/acc': 87.595, 'test/acc_unbiased': 87.493, 'test/diff': 1.601, 'test/acc_skew': 86.693, 'test/acc_align': 88.293}
[12 / 20] best valid accuracy: 88.657 at epoch 12 
 best_stats: {'best_valid_epoch': 12, 'best_valid_valid/acc': 88.608, 'best_valid_valid/acc_unbiased': 88.657, 'best_valid_valid/diff': 1.282, 'best_valid_valid/acc_skew': 89.047, 'best_valid_valid/acc_align': 88.267, 'best_valid_test/acc': 87.595, 'best_valid_test/acc_unbiased': 87.493, 'best_valid_test/diff': 1.601, 'best_valid_test/acc_skew': 86.693, 'best_valid_test/acc_align': 88.293}
[12 / 20] best test accuracy: 87.770 at epoch 11 
 best_stats: {'best_test_epoch': 11, 'best_test_valid/acc': 88.059, 'best_test_valid/acc_unbiased': 88.077, 'best_test_valid/diff': 1.65, 'best_test_valid/acc_skew': 88.902, 'best_test_valid/acc_align': 87.252, 'best_test_test/acc': 87.806, 'best_test_test/acc_unbiased': 87.77, 'best_test_test/diff': 0.334, 'best_test_test/acc_skew': 87.603, 'best_test_test/acc_align': 87.937}
[13 / 20] Learning rate: 0.0001 weight: 0.01
[13 / 20] Loss: 4.608563185490066 CE Loss: 1.1868444239102154 Con Loss: 4.596694739530577
[13 / 20] tensor([[0.860, 0.838],
        [0.905, 0.908]]) {'epoch': 13, 'valid/acc': 88.354, 'valid/acc_unbiased': 88.629, 'valid/diff': 1.485, 'valid/acc_skew': 88.824, 'valid/acc_align': 88.434, 'test/acc': 87.595, 'test/acc_unbiased': 87.759, 'test/diff': 1.29, 'test/acc_skew': 87.114, 'test/acc_align': 88.405}
[13 / 20] best valid accuracy: 88.657 at epoch 12 
 best_stats: {'best_valid_epoch': 12, 'best_valid_valid/acc': 88.608, 'best_valid_valid/acc_unbiased': 88.657, 'best_valid_valid/diff': 1.282, 'best_valid_valid/acc_skew': 89.047, 'best_valid_valid/acc_align': 88.267, 'best_valid_test/acc': 87.595, 'best_valid_test/acc_unbiased': 87.493, 'best_valid_test/diff': 1.601, 'best_valid_test/acc_skew': 86.693, 'best_valid_test/acc_align': 88.293}
[13 / 20] best test accuracy: 87.770 at epoch 11 
 best_stats: {'best_test_epoch': 11, 'best_test_valid/acc': 88.059, 'best_test_valid/acc_unbiased': 88.077, 'best_test_valid/diff': 1.65, 'best_test_valid/acc_skew': 88.902, 'best_test_valid/acc_align': 87.252, 'best_test_test/acc': 87.806, 'best_test_test/acc_unbiased': 87.77, 'best_test_test/diff': 0.334, 'best_test_test/acc_skew': 87.603, 'best_test_test/acc_align': 87.937}
[14 / 20] Learning rate: 1e-05 weight: 0.01
[14 / 20] Loss: 4.616034010116873 CE Loss: 1.174326829507768 Con Loss: 4.604290757316523
[14 / 20] tensor([[0.887, 0.869],
        [0.877, 0.886]]) {'epoch': 14, 'valid/acc': 89.03, 'valid/acc_unbiased': 89.172, 'valid/diff': 1.487, 'valid/acc_skew': 89.484, 'valid/acc_align': 88.861, 'test/acc': 87.932, 'test/acc_unbiased': 87.946, 'test/diff': 1.376, 'test/acc_skew': 87.258, 'test/acc_align': 88.634}
[14 / 20] best valid accuracy: 89.172 at epoch 14 
 best_stats: {'best_valid_epoch': 14, 'best_valid_valid/acc': 89.03, 'best_valid_valid/acc_unbiased': 89.172, 'best_valid_valid/diff': 1.487, 'best_valid_valid/acc_skew': 89.484, 'best_valid_valid/acc_align': 88.861, 'best_valid_test/acc': 87.932, 'best_valid_test/acc_unbiased': 87.946, 'best_valid_test/diff': 1.376, 'best_valid_test/acc_skew': 87.258, 'best_valid_test/acc_align': 88.634}
[14 / 20] best test accuracy: 87.946 at epoch 14 
 best_stats: {'best_test_epoch': 14, 'best_test_valid/acc': 89.03, 'best_test_valid/acc_unbiased': 89.172, 'best_test_valid/diff': 1.487, 'best_test_valid/acc_skew': 89.484, 'best_test_valid/acc_align': 88.861, 'best_test_test/acc': 87.932, 'best_test_test/acc_unbiased': 87.946, 'best_test_test/diff': 1.376, 'best_test_test/acc_skew': 87.258, 'best_test_test/acc_align': 88.634}
[15 / 20] Learning rate: 1e-05 weight: 0.01
[15 / 20] Loss: 4.606827694625972 CE Loss: 1.1449670233054905 Con Loss: 4.595378012606932
[15 / 20] tensor([[0.884, 0.871],
        [0.877, 0.886]]) {'epoch': 15, 'valid/acc': 89.241, 'valid/acc_unbiased': 89.372, 'valid/diff': 1.603, 'valid/acc_skew': 89.703, 'valid/acc_align': 89.041, 'test/acc': 87.932, 'test/acc_unbiased': 87.93, 'test/diff': 1.049, 'test/acc_skew': 87.406, 'test/acc_align': 88.455}
[15 / 20] best valid accuracy: 89.372 at epoch 15 
 best_stats: {'best_valid_epoch': 15, 'best_valid_valid/acc': 89.241, 'best_valid_valid/acc_unbiased': 89.372, 'best_valid_valid/diff': 1.603, 'best_valid_valid/acc_skew': 89.703, 'best_valid_valid/acc_align': 89.041, 'best_valid_test/acc': 87.932, 'best_valid_test/acc_unbiased': 87.93, 'best_valid_test/diff': 1.049, 'best_valid_test/acc_skew': 87.406, 'best_valid_test/acc_align': 88.455}
[15 / 20] best test accuracy: 87.946 at epoch 14 
 best_stats: {'best_test_epoch': 14, 'best_test_valid/acc': 89.03, 'best_test_valid/acc_unbiased': 89.172, 'best_test_valid/diff': 1.487, 'best_test_valid/acc_skew': 89.484, 'best_test_valid/acc_align': 88.861, 'best_test_test/acc': 87.932, 'best_test_test/acc_unbiased': 87.946, 'best_test_test/diff': 1.376, 'best_test_test/acc_skew': 87.258, 'best_test_test/acc_align': 88.634}
[16 / 20] Learning rate: 1e-05 weight: 0.01
[16 / 20] Loss: 4.594572531491456 CE Loss: 1.1484342755338997 Con Loss: 4.583088208531114
[16 / 20] tensor([[0.880, 0.869],
        [0.881, 0.889]]) {'epoch': 16, 'valid/acc': 88.945, 'valid/acc_unbiased': 89.135, 'valid/diff': 1.876, 'valid/acc_skew': 89.812, 'valid/acc_align': 88.457, 'test/acc': 87.932, 'test/acc_unbiased': 87.949, 'test/diff': 0.95, 'test/acc_skew': 87.475, 'test/acc_align': 88.424}
[16 / 20] best valid accuracy: 89.372 at epoch 15 
 best_stats: {'best_valid_epoch': 15, 'best_valid_valid/acc': 89.241, 'best_valid_valid/acc_unbiased': 89.372, 'best_valid_valid/diff': 1.603, 'best_valid_valid/acc_skew': 89.703, 'best_valid_valid/acc_align': 89.041, 'best_valid_test/acc': 87.932, 'best_valid_test/acc_unbiased': 87.93, 'best_valid_test/diff': 1.049, 'best_valid_test/acc_skew': 87.406, 'best_valid_test/acc_align': 88.455}
[16 / 20] best test accuracy: 87.949 at epoch 16 
 best_stats: {'best_test_epoch': 16, 'best_test_valid/acc': 88.945, 'best_test_valid/acc_unbiased': 89.135, 'best_test_valid/diff': 1.876, 'best_test_valid/acc_skew': 89.812, 'best_test_valid/acc_align': 88.457, 'best_test_test/acc': 87.932, 'best_test_test/acc_unbiased': 87.949, 'best_test_test/diff': 0.95, 'best_test_test/acc_skew': 87.475, 'best_test_test/acc_align': 88.424}
[17 / 20] Learning rate: 1e-05 weight: 0.01
[17 / 20] Loss: 4.5938489527492115 CE Loss: 1.149816284385742 Con Loss: 4.58235079885561
[17 / 20] tensor([[0.884, 0.870],
        [0.881, 0.889]]) {'epoch': 17, 'valid/acc': 89.072, 'valid/acc_unbiased': 89.189, 'valid/diff': 1.53, 'valid/acc_skew': 89.338, 'valid/acc_align': 89.041, 'test/acc': 88.059, 'test/acc_unbiased': 88.076, 'test/diff': 1.055, 'test/acc_skew': 87.548, 'test/acc_align': 88.604}
[17 / 20] best valid accuracy: 89.372 at epoch 15 
 best_stats: {'best_valid_epoch': 15, 'best_valid_valid/acc': 89.241, 'best_valid_valid/acc_unbiased': 89.372, 'best_valid_valid/diff': 1.603, 'best_valid_valid/acc_skew': 89.703, 'best_valid_valid/acc_align': 89.041, 'best_valid_test/acc': 87.932, 'best_valid_test/acc_unbiased': 87.93, 'best_valid_test/diff': 1.049, 'best_valid_test/acc_skew': 87.406, 'best_valid_test/acc_align': 88.455}
[17 / 20] best test accuracy: 88.076 at epoch 17 
 best_stats: {'best_test_epoch': 17, 'best_test_valid/acc': 89.072, 'best_test_valid/acc_unbiased': 89.189, 'best_test_valid/diff': 1.53, 'best_test_valid/acc_skew': 89.338, 'best_test_valid/acc_align': 89.041, 'best_test_test/acc': 88.059, 'best_test_test/acc_unbiased': 88.076, 'best_test_test/diff': 1.055, 'best_test_test/acc_skew': 87.548, 'best_test_test/acc_align': 88.604}
[18 / 20] Learning rate: 1e-05 weight: 0.01
[18 / 20] Loss: 4.592201192147186 CE Loss: 1.1569141963940375 Con Loss: 4.5806320540850445
[18 / 20] tensor([[0.880, 0.864],
        [0.883, 0.897]]) {'epoch': 18, 'valid/acc': 89.072, 'valid/acc_unbiased': 89.225, 'valid/diff': 1.257, 'valid/acc_skew': 89.374, 'valid/acc_align': 89.076, 'test/acc': 88.101, 'test/acc_unbiased': 88.116, 'test/diff': 1.509, 'test/acc_skew': 87.361, 'test/acc_align': 88.87}
[18 / 20] best valid accuracy: 89.372 at epoch 15 
 best_stats: {'best_valid_epoch': 15, 'best_valid_valid/acc': 89.241, 'best_valid_valid/acc_unbiased': 89.372, 'best_valid_valid/diff': 1.603, 'best_valid_valid/acc_skew': 89.703, 'best_valid_valid/acc_align': 89.041, 'best_valid_test/acc': 87.932, 'best_valid_test/acc_unbiased': 87.93, 'best_valid_test/diff': 1.049, 'best_valid_test/acc_skew': 87.406, 'best_valid_test/acc_align': 88.455}
[18 / 20] best test accuracy: 88.116 at epoch 18 
 best_stats: {'best_test_epoch': 18, 'best_test_valid/acc': 89.072, 'best_test_valid/acc_unbiased': 89.225, 'best_test_valid/diff': 1.257, 'best_test_valid/acc_skew': 89.374, 'best_test_valid/acc_align': 89.076, 'best_test_test/acc': 88.101, 'best_test_test/acc_unbiased': 88.116, 'best_test_test/diff': 1.509, 'best_test_test/acc_skew': 87.361, 'best_test_test/acc_align': 88.87}
[19 / 20] Learning rate: 1e-05 weight: 0.01
[19 / 20] Loss: 4.591499044968283 CE Loss: 1.1467992705658268 Con Loss: 4.58003105189683
[19 / 20] tensor([[0.884, 0.871],
        [0.877, 0.895]]) {'epoch': 19, 'valid/acc': 89.03, 'valid/acc_unbiased': 89.161, 'valid/diff': 1.464, 'valid/acc_skew': 89.374, 'valid/acc_align': 88.947, 'test/acc': 88.186, 'test/acc_unbiased': 88.153, 'test/diff': 1.495, 'test/acc_skew': 87.406, 'test/acc_align': 88.901}
[19 / 20] best valid accuracy: 89.372 at epoch 15 
 best_stats: {'best_valid_epoch': 15, 'best_valid_valid/acc': 89.241, 'best_valid_valid/acc_unbiased': 89.372, 'best_valid_valid/diff': 1.603, 'best_valid_valid/acc_skew': 89.703, 'best_valid_valid/acc_align': 89.041, 'best_valid_test/acc': 87.932, 'best_valid_test/acc_unbiased': 87.93, 'best_valid_test/diff': 1.049, 'best_valid_test/acc_skew': 87.406, 'best_valid_test/acc_align': 88.455}
[19 / 20] best test accuracy: 88.153 at epoch 19 
 best_stats: {'best_test_epoch': 19, 'best_test_valid/acc': 89.03, 'best_test_valid/acc_unbiased': 89.161, 'best_test_valid/diff': 1.464, 'best_test_valid/acc_skew': 89.374, 'best_test_valid/acc_align': 88.947, 'best_test_test/acc': 88.186, 'best_test_test/acc_unbiased': 88.153, 'best_test_test/diff': 1.495, 'best_test_test/acc_skew': 87.406, 'best_test_test/acc_align': 88.901}
[20 / 20] Learning rate: 1e-05 weight: 0.01
[20 / 20] Loss: 4.614185553096824 CE Loss: 1.1441610475230568 Con Loss: 4.602743920484485
[20 / 20] tensor([[0.889, 0.873],
        [0.879, 0.889]]) {'epoch': 20, 'valid/acc': 89.198, 'valid/acc_unbiased': 89.283, 'valid/diff': 1.124, 'valid/acc_skew': 89.448, 'valid/acc_align': 89.118, 'test/acc': 88.228, 'test/acc_unbiased': 88.23, 'test/diff': 1.285, 'test/acc_skew': 87.588, 'test/acc_align': 88.872}
[20 / 20] best valid accuracy: 89.372 at epoch 15 
 best_stats: {'best_valid_epoch': 15, 'best_valid_valid/acc': 89.241, 'best_valid_valid/acc_unbiased': 89.372, 'best_valid_valid/diff': 1.603, 'best_valid_valid/acc_skew': 89.703, 'best_valid_valid/acc_align': 89.041, 'best_valid_test/acc': 87.932, 'best_valid_test/acc_unbiased': 87.93, 'best_valid_test/diff': 1.049, 'best_valid_test/acc_skew': 87.406, 'best_valid_test/acc_align': 88.455}
[20 / 20] best test accuracy: 88.230 at epoch 20 
 best_stats: {'best_test_epoch': 20, 'best_test_valid/acc': 89.198, 'best_test_valid/acc_unbiased': 89.283, 'best_test_valid/diff': 1.124, 'best_test_valid/acc_skew': 89.448, 'best_test_valid/acc_align': 89.118, 'best_test_test/acc': 88.228, 'best_test_test/acc_unbiased': 88.23, 'best_test_test/diff': 1.285, 'best_test_test/acc_skew': 87.588, 'best_test_test/acc_align': 88.872}
Total training time: 1:15:09
