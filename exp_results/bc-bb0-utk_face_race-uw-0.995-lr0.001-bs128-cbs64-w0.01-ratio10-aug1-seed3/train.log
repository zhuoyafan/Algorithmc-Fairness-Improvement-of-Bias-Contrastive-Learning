Log level set to: INFO
Set seed: 3
=======> Using Fixed Random Seed: 3 <========
save_path: exp_results/bc-bb0-utk_face_race-uw-0.995-lr0.001-bs128-cbs64-w0.01-ratio10-aug1-seed3
get_utk_face - split: train, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_race-0.995
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [4407, 27]
Target 1: [22, 5529]
Binary Target 1
---------------------------
Target 0: [4407, 27]
Target 1: [22, 5529]
===================================
Normal Label Distribution: 
Target 0: [4407, 27]
Target 1: [22, 5529]
===================================
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [4407, 27]
Target 1: [22, 5529]
Binary Target 1
---------------------------
Target 0: [4407, 27]
Target 1: [22, 5529]
===================================
Normal Label Distribution: 
Target 0: [4407, 27]
Target 1: [22, 5529]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 9985, target_attr: gender, bias_attr: race bias_rate: 0.995
['[train] target_0-bias_0: 4407', '[train] target_0-bias_1: 27', '[train] target_1-bias_0: 22', '[train] target_1-bias_1: 5529']
confusion_matrix - 
 original: tensor([[4407.,   22.],
        [  27., 5529.]]), 
 normalized: tensor([[0.995, 0.005],
        [0.005, 0.995]]), 
 b|y: tensor([[0.994, 0.006],
        [0.004, 0.996]])
get_utk_face - split: train, aug: 1, given_y: True, ratio: 10
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_race-0.995
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [4407, 27]
Target 1: [22, 5529]
Binary Target 1
---------------------------
Target 0: [4407, 27]
Target 1: [22, 5529]
===================================
Normal Label Distribution: 
Target 0: [4407, 27]
Target 1: [22, 5529]
===================================
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [4407, 27]
Target 1: [22, 5529]
Binary Target 1
---------------------------
Target 0: [4407, 27]
Target 1: [22, 5529]
===================================
Normal Label Distribution: 
Target 0: [4407, 27]
Target 1: [22, 5529]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 9985, target_attr: gender, bias_attr: race bias_rate: 0.995
['[train] target_0-bias_0: 4407', '[train] target_0-bias_1: 27', '[train] target_1-bias_0: 22', '[train] target_1-bias_1: 5529']
get_utk_face - split: valid, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_race-0.995
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [583, 684]
Target 1: [457, 646]
Binary Target 1
---------------------------
Target 0: [583, 684]
Target 1: [457, 646]
===================================
Normal Label Distribution: 
Target 0: [583, 684]
Target 1: [457, 646]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 2370, target_attr: gender, bias_attr: race bias_rate: 0.995
['[valid] target_0-bias_0: 583', '[valid] target_0-bias_1: 684', '[valid] target_1-bias_0: 457', '[valid] target_1-bias_1: 646']
get_utk_face - split: test, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_race-0.995
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [558, 677]
Target 1: [462, 673]
Binary Target 1
---------------------------
Target 0: [558, 677]
Target 1: [462, 673]
===================================
Normal Label Distribution: 
Target 0: [558, 677]
Target 1: [462, 673]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 2370, target_attr: gender, bias_attr: race bias_rate: 0.995
['[test] target_0-bias_0: 558', '[test] target_0-bias_1: 677', '[test] target_1-bias_0: 462', '[test] target_1-bias_1: 673']
decay_epochs: [6, 13]
[1 / 20] Learning rate: 0.001 weight: 0.01
[1 / 20] Loss: 4.129710704407575 CE Loss: 2.9996203572259406 Con Loss: 4.099714507827415
[1 / 20] tensor([[0.909, 0.928],
        [0.130, 0.132]]) {'epoch': 1, 'valid/acc': 55.063, 'valid/acc_unbiased': 52.211, 'valid/diff': 0.498, 'valid/acc_skew': 51.962, 'valid/acc_align': 52.46, 'test/acc': 54.177, 'test/acc_unbiased': 52.458, 'test/diff': 1.07, 'test/acc_skew': 52.875, 'test/acc_align': 52.042}
[1 / 20] best valid accuracy: 52.211 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 55.063, 'best_valid_valid/acc_unbiased': 52.211, 'best_valid_valid/diff': 0.498, 'best_valid_valid/acc_skew': 51.962, 'best_valid_valid/acc_align': 52.46, 'best_valid_test/acc': 54.177, 'best_valid_test/acc_unbiased': 52.458, 'best_valid_test/diff': 1.07, 'best_valid_test/acc_skew': 52.875, 'best_valid_test/acc_align': 52.042}
[1 / 20] best test accuracy: 52.458 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 55.063, 'best_test_valid/acc_unbiased': 52.211, 'best_test_valid/diff': 0.498, 'best_test_valid/acc_skew': 51.962, 'best_test_valid/acc_align': 52.46, 'best_test_test/acc': 54.177, 'best_test_test/acc_unbiased': 52.458, 'best_test_test/diff': 1.07, 'best_test_test/acc_skew': 52.875, 'best_test_test/acc_align': 52.042}
[2 / 20] Learning rate: 0.001 weight: 0.01
[2 / 20] Loss: 3.8731022454048314 CE Loss: 2.8069206728837344 Con Loss: 3.8450330267205617
[2 / 20] tensor([[0.787, 0.823],
        [0.206, 0.352]]) {'epoch': 2, 'valid/acc': 57.975, 'valid/acc_unbiased': 55.598, 'valid/diff': 7.508, 'valid/acc_skew': 54.031, 'valid/acc_align': 57.165, 'test/acc': 56.034, 'test/acc_unbiased': 54.182, 'test/diff': 9.127, 'test/acc_skew': 51.419, 'test/acc_align': 56.945}
[2 / 20] best valid accuracy: 55.598 at epoch 2 
 best_stats: {'best_valid_epoch': 2, 'best_valid_valid/acc': 57.975, 'best_valid_valid/acc_unbiased': 55.598, 'best_valid_valid/diff': 7.508, 'best_valid_valid/acc_skew': 54.031, 'best_valid_valid/acc_align': 57.165, 'best_valid_test/acc': 56.034, 'best_valid_test/acc_unbiased': 54.182, 'best_valid_test/diff': 9.127, 'best_valid_test/acc_skew': 51.419, 'best_valid_test/acc_align': 56.945}
[2 / 20] best test accuracy: 54.182 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 57.975, 'best_test_valid/acc_unbiased': 55.598, 'best_test_valid/diff': 7.508, 'best_test_valid/acc_skew': 54.031, 'best_test_valid/acc_align': 57.165, 'best_test_test/acc': 56.034, 'best_test_test/acc_unbiased': 54.182, 'best_test_test/diff': 9.127, 'best_test_test/acc_skew': 51.419, 'best_test_test/acc_align': 56.945}
[3 / 20] Learning rate: 0.001 weight: 0.01
[3 / 20] Loss: 3.5526959595348337 CE Loss: 3.016163504929559 Con Loss: 3.522534322117828
[3 / 20] tensor([[0.081, 0.087],
        [0.955, 0.926]]) {'epoch': 3, 'valid/acc': 47.806, 'valid/acc_unbiased': 50.958, 'valid/diff': 2.379, 'valid/acc_skew': 51.978, 'valid/acc_align': 49.937, 'test/acc': 49.283, 'test/acc_unbiased': 51.201, 'test/diff': 1.767, 'test/acc_skew': 52.085, 'test/acc_align': 50.318}
[3 / 20] best valid accuracy: 55.598 at epoch 2 
 best_stats: {'best_valid_epoch': 2, 'best_valid_valid/acc': 57.975, 'best_valid_valid/acc_unbiased': 55.598, 'best_valid_valid/diff': 7.508, 'best_valid_valid/acc_skew': 54.031, 'best_valid_valid/acc_align': 57.165, 'best_valid_test/acc': 56.034, 'best_valid_test/acc_unbiased': 54.182, 'best_valid_test/diff': 9.127, 'best_valid_test/acc_skew': 51.419, 'best_valid_test/acc_align': 56.945}
[3 / 20] best test accuracy: 54.182 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 57.975, 'best_test_valid/acc_unbiased': 55.598, 'best_test_valid/diff': 7.508, 'best_test_valid/acc_skew': 54.031, 'best_test_valid/acc_align': 57.165, 'best_test_test/acc': 56.034, 'best_test_test/acc_unbiased': 54.182, 'best_test_test/diff': 9.127, 'best_test_test/acc_skew': 51.419, 'best_test_test/acc_align': 56.945}
[4 / 20] Learning rate: 0.001 weight: 0.01
[4 / 20] Loss: 3.7164868381062806 CE Loss: 2.975155108573142 Con Loss: 3.686735268861697
[4 / 20] tensor([[0.179, 0.167],
        [0.874, 0.897]]) {'epoch': 4, 'valid/acc': 50.0, 'valid/acc_unbiased': 52.566, 'valid/diff': 3.277, 'valid/acc_skew': 50.927, 'valid/acc_align': 54.204, 'test/acc': 51.519, 'test/acc_unbiased': 52.951, 'test/diff': 1.766, 'test/acc_skew': 52.069, 'test/acc_align': 53.834}
[4 / 20] best valid accuracy: 55.598 at epoch 2 
 best_stats: {'best_valid_epoch': 2, 'best_valid_valid/acc': 57.975, 'best_valid_valid/acc_unbiased': 55.598, 'best_valid_valid/diff': 7.508, 'best_valid_valid/acc_skew': 54.031, 'best_valid_valid/acc_align': 57.165, 'best_valid_test/acc': 56.034, 'best_valid_test/acc_unbiased': 54.182, 'best_valid_test/diff': 9.127, 'best_valid_test/acc_skew': 51.419, 'best_valid_test/acc_align': 56.945}
[4 / 20] best test accuracy: 54.182 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 57.975, 'best_test_valid/acc_unbiased': 55.598, 'best_test_valid/diff': 7.508, 'best_test_valid/acc_skew': 54.031, 'best_test_valid/acc_align': 57.165, 'best_test_test/acc': 56.034, 'best_test_test/acc_unbiased': 54.182, 'best_test_test/diff': 9.127, 'best_test_test/acc_skew': 51.419, 'best_test_test/acc_align': 56.945}
[5 / 20] Learning rate: 0.001 weight: 0.01
[5 / 20] Loss: 4.006982986928226 CE Loss: 2.9057108916338525 Con Loss: 3.977925891152727
[5 / 20] tensor([[0., 0.],
        [1., 1.]]) {'epoch': 5, 'valid/acc': 46.582, 'valid/acc_unbiased': 50.037, 'valid/diff': 0.073, 'valid/acc_skew': 50.073, 'valid/acc_align': 50.0, 'test/acc': 47.89, 'test/acc_unbiased': 50.0, 'test/diff': 0.0, 'test/acc_skew': 50.0, 'test/acc_align': 50.0}
[5 / 20] best valid accuracy: 55.598 at epoch 2 
 best_stats: {'best_valid_epoch': 2, 'best_valid_valid/acc': 57.975, 'best_valid_valid/acc_unbiased': 55.598, 'best_valid_valid/diff': 7.508, 'best_valid_valid/acc_skew': 54.031, 'best_valid_valid/acc_align': 57.165, 'best_valid_test/acc': 56.034, 'best_valid_test/acc_unbiased': 54.182, 'best_valid_test/diff': 9.127, 'best_valid_test/acc_skew': 51.419, 'best_valid_test/acc_align': 56.945}
[5 / 20] best test accuracy: 54.182 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 57.975, 'best_test_valid/acc_unbiased': 55.598, 'best_test_valid/diff': 7.508, 'best_test_valid/acc_skew': 54.031, 'best_test_valid/acc_align': 57.165, 'best_test_test/acc': 56.034, 'best_test_test/acc_unbiased': 54.182, 'best_test_test/diff': 9.127, 'best_test_test/acc_skew': 51.419, 'best_test_test/acc_align': 56.945}
[6 / 20] Learning rate: 0.001 weight: 0.01
[6 / 20] Loss: 3.914667159996453 CE Loss: 3.022585352826966 Con Loss: 3.8844413151308843
[6 / 20] tensor([[0.002, 0.001],
        [0.996, 1.000]]) {'epoch': 6, 'valid/acc': 46.624, 'valid/acc_unbiased': 50.055, 'valid/diff': 0.403, 'valid/acc_skew': 50.256, 'valid/acc_align': 49.854, 'test/acc': 47.89, 'test/acc_unbiased': 49.974, 'test/diff': 0.232, 'test/acc_skew': 49.857, 'test/acc_align': 50.09}
[6 / 20] best valid accuracy: 55.598 at epoch 2 
 best_stats: {'best_valid_epoch': 2, 'best_valid_valid/acc': 57.975, 'best_valid_valid/acc_unbiased': 55.598, 'best_valid_valid/diff': 7.508, 'best_valid_valid/acc_skew': 54.031, 'best_valid_valid/acc_align': 57.165, 'best_valid_test/acc': 56.034, 'best_valid_test/acc_unbiased': 54.182, 'best_valid_test/diff': 9.127, 'best_valid_test/acc_skew': 51.419, 'best_valid_test/acc_align': 56.945}
[6 / 20] best test accuracy: 54.182 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 57.975, 'best_test_valid/acc_unbiased': 55.598, 'best_test_valid/diff': 7.508, 'best_test_valid/acc_skew': 54.031, 'best_test_valid/acc_align': 57.165, 'best_test_test/acc': 56.034, 'best_test_test/acc_unbiased': 54.182, 'best_test_test/diff': 9.127, 'best_test_test/acc_skew': 51.419, 'best_test_test/acc_align': 56.945}
[7 / 20] Learning rate: 0.0001 weight: 0.01
[7 / 20] Loss: 3.52437358260692 CE Loss: 2.791242206568233 Con Loss: 3.496461159071447
[7 / 20] tensor([[0.263, 0.282],
        [0.831, 0.847]]) {'epoch': 7, 'valid/acc': 53.84, 'valid/acc_unbiased': 55.553, 'valid/diff': 3.616, 'valid/acc_skew': 56.781, 'valid/acc_align': 54.325, 'test/acc': 54.515, 'test/acc_unbiased': 55.592, 'test/diff': 1.724, 'test/acc_skew': 55.665, 'test/acc_align': 55.52}
[7 / 20] best valid accuracy: 55.598 at epoch 2 
 best_stats: {'best_valid_epoch': 2, 'best_valid_valid/acc': 57.975, 'best_valid_valid/acc_unbiased': 55.598, 'best_valid_valid/diff': 7.508, 'best_valid_valid/acc_skew': 54.031, 'best_valid_valid/acc_align': 57.165, 'best_valid_test/acc': 56.034, 'best_valid_test/acc_unbiased': 54.182, 'best_valid_test/diff': 9.127, 'best_valid_test/acc_skew': 51.419, 'best_valid_test/acc_align': 56.945}
[7 / 20] best test accuracy: 55.592 at epoch 7 
 best_stats: {'best_test_epoch': 7, 'best_test_valid/acc': 53.84, 'best_test_valid/acc_unbiased': 55.553, 'best_test_valid/diff': 3.616, 'best_test_valid/acc_skew': 56.781, 'best_test_valid/acc_align': 54.325, 'best_test_test/acc': 54.515, 'best_test_test/acc_unbiased': 55.592, 'best_test_test/diff': 1.724, 'best_test_test/acc_skew': 55.665, 'best_test_test/acc_align': 55.52}
[8 / 20] Learning rate: 0.0001 weight: 0.01
[8 / 20] Loss: 3.879191240228052 CE Loss: 2.7112778097376204 Con Loss: 3.8520784529913765
[8 / 20] tensor([[0.240, 0.284],
        [0.861, 0.856]]) {'epoch': 8, 'valid/acc': 53.797, 'valid/acc_unbiased': 55.663, 'valid/diff': 3.838, 'valid/acc_skew': 57.582, 'valid/acc_align': 53.744, 'test/acc': 54.852, 'test/acc_unbiased': 56.027, 'test/diff': 2.453, 'test/acc_skew': 57.254, 'test/acc_align': 54.801}
[8 / 20] best valid accuracy: 55.663 at epoch 8 
 best_stats: {'best_valid_epoch': 8, 'best_valid_valid/acc': 53.797, 'best_valid_valid/acc_unbiased': 55.663, 'best_valid_valid/diff': 3.838, 'best_valid_valid/acc_skew': 57.582, 'best_valid_valid/acc_align': 53.744, 'best_valid_test/acc': 54.852, 'best_valid_test/acc_unbiased': 56.027, 'best_valid_test/diff': 2.453, 'best_valid_test/acc_skew': 57.254, 'best_valid_test/acc_align': 54.801}
[8 / 20] best test accuracy: 56.027 at epoch 8 
 best_stats: {'best_test_epoch': 8, 'best_test_valid/acc': 53.797, 'best_test_valid/acc_unbiased': 55.663, 'best_test_valid/diff': 3.838, 'best_test_valid/acc_skew': 57.582, 'best_test_valid/acc_align': 53.744, 'best_test_test/acc': 54.852, 'best_test_test/acc_unbiased': 56.027, 'best_test_test/diff': 2.453, 'best_test_test/acc_skew': 57.254, 'best_test_test/acc_align': 54.801}
[9 / 20] Learning rate: 0.0001 weight: 0.01
[9 / 20] Loss: 3.839339539798188 CE Loss: 2.739594589595384 Con Loss: 3.8119435912558717
[9 / 20] tensor([[0.780, 0.796],
        [0.318, 0.539]]) {'epoch': 9, 'valid/acc': 62.785, 'valid/acc_unbiased': 60.845, 'valid/diff': 9.759, 'valid/acc_skew': 56.541, 'valid/acc_align': 65.15, 'test/acc': 62.616, 'test/acc_unbiased': 60.832, 'test/diff': 11.889, 'test/acc_skew': 55.717, 'test/acc_align': 65.947}
[9 / 20] best valid accuracy: 60.845 at epoch 9 
 best_stats: {'best_valid_epoch': 9, 'best_valid_valid/acc': 62.785, 'best_valid_valid/acc_unbiased': 60.845, 'best_valid_valid/diff': 9.759, 'best_valid_valid/acc_skew': 56.541, 'best_valid_valid/acc_align': 65.15, 'best_valid_test/acc': 62.616, 'best_valid_test/acc_unbiased': 60.832, 'best_valid_test/diff': 11.889, 'best_valid_test/acc_skew': 55.717, 'best_valid_test/acc_align': 65.947}
[9 / 20] best test accuracy: 60.832 at epoch 9 
 best_stats: {'best_test_epoch': 9, 'best_test_valid/acc': 62.785, 'best_test_valid/acc_unbiased': 60.845, 'best_test_valid/diff': 9.759, 'best_test_valid/acc_skew': 56.541, 'best_test_valid/acc_align': 65.15, 'best_test_test/acc': 62.616, 'best_test_test/acc_unbiased': 60.832, 'best_test_test/diff': 11.889, 'best_test_test/acc_skew': 55.717, 'best_test_test/acc_align': 65.947}
[10 / 20] Learning rate: 0.0001 weight: 0.01
[10 / 20] Loss: 3.849083608368008 CE Loss: 2.700646031064037 Con Loss: 3.8220771375034355
[10 / 20] tensor([[0.339, 0.362],
        [0.829, 0.834]]) {'epoch': 10, 'valid/acc': 56.54, 'valid/acc_unbiased': 57.839, 'valid/diff': 4.704, 'valid/acc_skew': 58.138, 'valid/acc_align': 57.541, 'test/acc': 58.143, 'test/acc_unbiased': 59.08, 'test/diff': 1.388, 'test/acc_skew': 59.545, 'test/acc_align': 58.615}
[10 / 20] best valid accuracy: 60.845 at epoch 9 
 best_stats: {'best_valid_epoch': 9, 'best_valid_valid/acc': 62.785, 'best_valid_valid/acc_unbiased': 60.845, 'best_valid_valid/diff': 9.759, 'best_valid_valid/acc_skew': 56.541, 'best_valid_valid/acc_align': 65.15, 'best_valid_test/acc': 62.616, 'best_valid_test/acc_unbiased': 60.832, 'best_valid_test/diff': 11.889, 'best_valid_test/acc_skew': 55.717, 'best_valid_test/acc_align': 65.947}
[10 / 20] best test accuracy: 60.832 at epoch 9 
 best_stats: {'best_test_epoch': 9, 'best_test_valid/acc': 62.785, 'best_test_valid/acc_unbiased': 60.845, 'best_test_valid/diff': 9.759, 'best_test_valid/acc_skew': 56.541, 'best_test_valid/acc_align': 65.15, 'best_test_test/acc': 62.616, 'best_test_test/acc_unbiased': 60.832, 'best_test_test/diff': 11.889, 'best_test_test/acc_skew': 55.717, 'best_test_test/acc_align': 65.947}
[11 / 20] Learning rate: 0.0001 weight: 0.01
[11 / 20] Loss: 3.6706445773840546 CE Loss: 2.6732333398903974 Con Loss: 3.6439122328951647
[11 / 20] tensor([[0.676, 0.719],
        [0.424, 0.623]]) {'epoch': 11, 'valid/acc': 64.262, 'valid/acc_unbiased': 63.117, 'valid/diff': 9.171, 'valid/acc_skew': 60.29, 'valid/acc_align': 65.945, 'test/acc': 62.405, 'test/acc_unbiased': 61.045, 'test/diff': 12.103, 'test/acc_skew': 57.18, 'test/acc_align': 64.911}
[11 / 20] best valid accuracy: 63.117 at epoch 11 
 best_stats: {'best_valid_epoch': 11, 'best_valid_valid/acc': 64.262, 'best_valid_valid/acc_unbiased': 63.117, 'best_valid_valid/diff': 9.171, 'best_valid_valid/acc_skew': 60.29, 'best_valid_valid/acc_align': 65.945, 'best_valid_test/acc': 62.405, 'best_valid_test/acc_unbiased': 61.045, 'best_valid_test/diff': 12.103, 'best_valid_test/acc_skew': 57.18, 'best_valid_test/acc_align': 64.911}
[11 / 20] best test accuracy: 61.045 at epoch 11 
 best_stats: {'best_test_epoch': 11, 'best_test_valid/acc': 64.262, 'best_test_valid/acc_unbiased': 63.117, 'best_test_valid/diff': 9.171, 'best_test_valid/acc_skew': 60.29, 'best_test_valid/acc_align': 65.945, 'best_test_test/acc': 62.405, 'best_test_test/acc_unbiased': 61.045, 'best_test_test/diff': 12.103, 'best_test_test/acc_skew': 57.18, 'best_test_test/acc_align': 64.911}
[12 / 20] Learning rate: 0.0001 weight: 0.01
[12 / 20] Loss: 3.5330226679235084 CE Loss: 2.7294878660110338 Con Loss: 3.5057278033071717
[12 / 20] tensor([[0.154, 0.170],
        [0.933, 0.917]]) {'epoch': 12, 'valid/acc': 51.899, 'valid/acc_unbiased': 54.37, 'valid/diff': 3.121, 'valid/acc_skew': 55.93, 'valid/acc_align': 52.809, 'test/acc': 52.7, 'test/acc_unbiased': 54.342, 'test/diff': 1.593, 'test/acc_skew': 55.138, 'test/acc_align': 53.546}
[12 / 20] best valid accuracy: 63.117 at epoch 11 
 best_stats: {'best_valid_epoch': 11, 'best_valid_valid/acc': 64.262, 'best_valid_valid/acc_unbiased': 63.117, 'best_valid_valid/diff': 9.171, 'best_valid_valid/acc_skew': 60.29, 'best_valid_valid/acc_align': 65.945, 'best_valid_test/acc': 62.405, 'best_valid_test/acc_unbiased': 61.045, 'best_valid_test/diff': 12.103, 'best_valid_test/acc_skew': 57.18, 'best_valid_test/acc_align': 64.911}
[12 / 20] best test accuracy: 61.045 at epoch 11 
 best_stats: {'best_test_epoch': 11, 'best_test_valid/acc': 64.262, 'best_test_valid/acc_unbiased': 63.117, 'best_test_valid/diff': 9.171, 'best_test_valid/acc_skew': 60.29, 'best_test_valid/acc_align': 65.945, 'best_test_test/acc': 62.405, 'best_test_test/acc_unbiased': 61.045, 'best_test_test/diff': 12.103, 'best_test_test/acc_skew': 57.18, 'best_test_test/acc_align': 64.911}
[13 / 20] Learning rate: 0.0001 weight: 0.01
[13 / 20] Loss: 3.959972502281502 CE Loss: 2.6887745926484024 Con Loss: 3.9330847618874754
[13 / 20] tensor([[0.548, 0.555],
        [0.658, 0.733]]) {'epoch': 13, 'valid/acc': 63.08, 'valid/acc_unbiased': 63.29, 'valid/diff': 5.136, 'valid/acc_skew': 63.229, 'valid/acc_align': 63.351, 'test/acc': 62.405, 'test/acc_unbiased': 62.358, 'test/diff': 4.077, 'test/acc_skew': 60.67, 'test/acc_align': 64.046}
[13 / 20] best valid accuracy: 63.290 at epoch 13 
 best_stats: {'best_valid_epoch': 13, 'best_valid_valid/acc': 63.08, 'best_valid_valid/acc_unbiased': 63.29, 'best_valid_valid/diff': 5.136, 'best_valid_valid/acc_skew': 63.229, 'best_valid_valid/acc_align': 63.351, 'best_valid_test/acc': 62.405, 'best_valid_test/acc_unbiased': 62.358, 'best_valid_test/diff': 4.077, 'best_valid_test/acc_skew': 60.67, 'best_valid_test/acc_align': 64.046}
[13 / 20] best test accuracy: 62.358 at epoch 13 
 best_stats: {'best_test_epoch': 13, 'best_test_valid/acc': 63.08, 'best_test_valid/acc_unbiased': 63.29, 'best_test_valid/diff': 5.136, 'best_test_valid/acc_skew': 63.229, 'best_test_valid/acc_align': 63.351, 'best_test_test/acc': 62.405, 'best_test_test/acc_unbiased': 62.358, 'best_test_test/diff': 4.077, 'best_test_test/acc_skew': 60.67, 'best_test_test/acc_align': 64.046}
[14 / 20] Learning rate: 1e-05 weight: 0.01
[14 / 20] Loss: 3.6941154529526643 CE Loss: 2.6234510509145217 Con Loss: 3.66788096186753
[14 / 20] tensor([[0.582, 0.595],
        [0.619, 0.727]]) {'epoch': 14, 'valid/acc': 63.797, 'valid/acc_unbiased': 63.597, 'valid/diff': 7.867, 'valid/acc_skew': 62.54, 'valid/acc_align': 64.655, 'test/acc': 63.418, 'test/acc_unbiased': 63.084, 'test/diff': 6.019, 'test/acc_skew': 60.716, 'test/acc_align': 65.452}
[14 / 20] best valid accuracy: 63.597 at epoch 14 
 best_stats: {'best_valid_epoch': 14, 'best_valid_valid/acc': 63.797, 'best_valid_valid/acc_unbiased': 63.597, 'best_valid_valid/diff': 7.867, 'best_valid_valid/acc_skew': 62.54, 'best_valid_valid/acc_align': 64.655, 'best_valid_test/acc': 63.418, 'best_valid_test/acc_unbiased': 63.084, 'best_valid_test/diff': 6.019, 'best_valid_test/acc_skew': 60.716, 'best_valid_test/acc_align': 65.452}
[14 / 20] best test accuracy: 63.084 at epoch 14 
 best_stats: {'best_test_epoch': 14, 'best_test_valid/acc': 63.797, 'best_test_valid/acc_unbiased': 63.597, 'best_test_valid/diff': 7.867, 'best_test_valid/acc_skew': 62.54, 'best_test_valid/acc_align': 64.655, 'best_test_test/acc': 63.418, 'best_test_test/acc_unbiased': 63.084, 'best_test_test/diff': 6.019, 'best_test_test/acc_skew': 60.716, 'best_test_test/acc_align': 65.452}
[15 / 20] Learning rate: 1e-05 weight: 0.01
[15 / 20] Loss: 3.5802690177187735 CE Loss: 2.6460964114294687 Con Loss: 3.5538080359675255
[15 / 20] tensor([[0.688, 0.699],
        [0.489, 0.639]]) {'epoch': 15, 'valid/acc': 65.021, 'valid/acc_unbiased': 64.046, 'valid/diff': 8.26, 'valid/acc_skew': 61.785, 'valid/acc_align': 66.307, 'test/acc': 63.84, 'test/acc_unbiased': 62.874, 'test/diff': 8.013, 'test/acc_skew': 59.392, 'test/acc_align': 66.355}
[15 / 20] best valid accuracy: 64.046 at epoch 15 
 best_stats: {'best_valid_epoch': 15, 'best_valid_valid/acc': 65.021, 'best_valid_valid/acc_unbiased': 64.046, 'best_valid_valid/diff': 8.26, 'best_valid_valid/acc_skew': 61.785, 'best_valid_valid/acc_align': 66.307, 'best_valid_test/acc': 63.84, 'best_valid_test/acc_unbiased': 62.874, 'best_valid_test/diff': 8.013, 'best_valid_test/acc_skew': 59.392, 'best_valid_test/acc_align': 66.355}
[15 / 20] best test accuracy: 63.084 at epoch 14 
 best_stats: {'best_test_epoch': 14, 'best_test_valid/acc': 63.797, 'best_test_valid/acc_unbiased': 63.597, 'best_test_valid/diff': 7.867, 'best_test_valid/acc_skew': 62.54, 'best_test_valid/acc_align': 64.655, 'best_test_test/acc': 63.418, 'best_test_test/acc_unbiased': 63.084, 'best_test_test/diff': 6.019, 'best_test_test/acc_skew': 60.716, 'best_test_test/acc_align': 65.452}
[16 / 20] Learning rate: 1e-05 weight: 0.01
[16 / 20] Loss: 3.6226712069155638 CE Loss: 2.680805415777666 Con Loss: 3.5958631353134742
[16 / 20] tensor([[0.629, 0.653],
        [0.541, 0.691]]) {'epoch': 16, 'valid/acc': 65.063, 'valid/acc_unbiased': 64.494, 'valid/diff': 7.364, 'valid/acc_skew': 62.107, 'valid/acc_align': 66.88, 'test/acc': 63.629, 'test/acc_unbiased': 62.849, 'test/diff': 8.683, 'test/acc_skew': 59.7, 'test/acc_align': 65.998}
[16 / 20] best valid accuracy: 64.494 at epoch 16 
 best_stats: {'best_valid_epoch': 16, 'best_valid_valid/acc': 65.063, 'best_valid_valid/acc_unbiased': 64.494, 'best_valid_valid/diff': 7.364, 'best_valid_valid/acc_skew': 62.107, 'best_valid_valid/acc_align': 66.88, 'best_valid_test/acc': 63.629, 'best_valid_test/acc_unbiased': 62.849, 'best_valid_test/diff': 8.683, 'best_valid_test/acc_skew': 59.7, 'best_valid_test/acc_align': 65.998}
[16 / 20] best test accuracy: 63.084 at epoch 14 
 best_stats: {'best_test_epoch': 14, 'best_test_valid/acc': 63.797, 'best_test_valid/acc_unbiased': 63.597, 'best_test_valid/diff': 7.867, 'best_test_valid/acc_skew': 62.54, 'best_test_valid/acc_align': 64.655, 'best_test_test/acc': 63.418, 'best_test_test/acc_unbiased': 63.084, 'best_test_test/diff': 6.019, 'best_test_test/acc_skew': 60.716, 'best_test_test/acc_align': 65.452}
[17 / 20] Learning rate: 1e-05 weight: 0.01
[17 / 20] Loss: 3.4342834445077535 CE Loss: 2.640386558498331 Con Loss: 3.4078795867140554
[17 / 20] tensor([[0.636, 0.677],
        [0.537, 0.684]]) {'epoch': 17, 'valid/acc': 64.937, 'valid/acc_unbiased': 64.339, 'valid/diff': 7.398, 'valid/acc_skew': 63.131, 'valid/acc_align': 65.548, 'test/acc': 64.177, 'test/acc_unbiased': 63.325, 'test/diff': 9.351, 'test/acc_skew': 60.666, 'test/acc_align': 65.985}
[17 / 20] best valid accuracy: 64.494 at epoch 16 
 best_stats: {'best_valid_epoch': 16, 'best_valid_valid/acc': 65.063, 'best_valid_valid/acc_unbiased': 64.494, 'best_valid_valid/diff': 7.364, 'best_valid_valid/acc_skew': 62.107, 'best_valid_valid/acc_align': 66.88, 'best_valid_test/acc': 63.629, 'best_valid_test/acc_unbiased': 62.849, 'best_valid_test/diff': 8.683, 'best_valid_test/acc_skew': 59.7, 'best_valid_test/acc_align': 65.998}
[17 / 20] best test accuracy: 63.325 at epoch 17 
 best_stats: {'best_test_epoch': 17, 'best_test_valid/acc': 64.937, 'best_test_valid/acc_unbiased': 64.339, 'best_test_valid/diff': 7.398, 'best_test_valid/acc_skew': 63.131, 'best_test_valid/acc_align': 65.548, 'best_test_test/acc': 64.177, 'best_test_test/acc_unbiased': 63.325, 'best_test_test/diff': 9.351, 'best_test_test/acc_skew': 60.666, 'best_test_test/acc_align': 65.985}
[18 / 20] Learning rate: 1e-05 weight: 0.01
[18 / 20] Loss: 3.6333633339757254 CE Loss: 2.6350931607071137 Con Loss: 3.60701242818436
[18 / 20] tensor([[0.640, 0.678],
        [0.548, 0.682]]) {'epoch': 18, 'valid/acc': 64.852, 'valid/acc_unbiased': 64.215, 'valid/diff': 7.931, 'valid/acc_skew': 63.131, 'valid/acc_align': 65.299, 'test/acc': 64.473, 'test/acc_unbiased': 63.685, 'test/diff': 8.63, 'test/acc_skew': 61.281, 'test/acc_align': 66.09}
[18 / 20] best valid accuracy: 64.494 at epoch 16 
 best_stats: {'best_valid_epoch': 16, 'best_valid_valid/acc': 65.063, 'best_valid_valid/acc_unbiased': 64.494, 'best_valid_valid/diff': 7.364, 'best_valid_valid/acc_skew': 62.107, 'best_valid_valid/acc_align': 66.88, 'best_valid_test/acc': 63.629, 'best_valid_test/acc_unbiased': 62.849, 'best_valid_test/diff': 8.683, 'best_valid_test/acc_skew': 59.7, 'best_valid_test/acc_align': 65.998}
[18 / 20] best test accuracy: 63.685 at epoch 18 
 best_stats: {'best_test_epoch': 18, 'best_test_valid/acc': 64.852, 'best_test_valid/acc_unbiased': 64.215, 'best_test_valid/diff': 7.931, 'best_test_valid/acc_skew': 63.131, 'best_test_valid/acc_align': 65.299, 'best_test_test/acc': 64.473, 'best_test_test/acc_unbiased': 63.685, 'best_test_test/diff': 8.63, 'best_test_test/acc_skew': 61.281, 'best_test_test/acc_align': 66.09}
[19 / 20] Learning rate: 1e-05 weight: 0.01
[19 / 20] Loss: 3.5686701818173923 CE Loss: 2.566189601699531 Con Loss: 3.543008294246408
[19 / 20] tensor([[0.751, 0.775],
        [0.398, 0.574]]) {'epoch': 19, 'valid/acc': 65.485, 'valid/acc_unbiased': 63.889, 'valid/diff': 9.494, 'valid/acc_skew': 61.429, 'valid/acc_align': 66.349, 'test/acc': 63.882, 'test/acc_unbiased': 62.455, 'test/diff': 9.993, 'test/acc_skew': 58.687, 'test/acc_align': 66.222}
[19 / 20] best valid accuracy: 64.494 at epoch 16 
 best_stats: {'best_valid_epoch': 16, 'best_valid_valid/acc': 65.063, 'best_valid_valid/acc_unbiased': 64.494, 'best_valid_valid/diff': 7.364, 'best_valid_valid/acc_skew': 62.107, 'best_valid_valid/acc_align': 66.88, 'best_valid_test/acc': 63.629, 'best_valid_test/acc_unbiased': 62.849, 'best_valid_test/diff': 8.683, 'best_valid_test/acc_skew': 59.7, 'best_valid_test/acc_align': 65.998}
[19 / 20] best test accuracy: 63.685 at epoch 18 
 best_stats: {'best_test_epoch': 18, 'best_test_valid/acc': 64.852, 'best_test_valid/acc_unbiased': 64.215, 'best_test_valid/diff': 7.931, 'best_test_valid/acc_skew': 63.131, 'best_test_valid/acc_align': 65.299, 'best_test_test/acc': 64.473, 'best_test_test/acc_unbiased': 63.685, 'best_test_test/diff': 8.63, 'best_test_test/acc_skew': 61.281, 'best_test_test/acc_align': 66.09}
[20 / 20] Learning rate: 1e-05 weight: 0.01
[20 / 20] Loss: 3.8075907618508795 CE Loss: 2.6148877289991233 Con Loss: 3.7814418975627597
[20 / 20] tensor([[0.668, 0.716],
        [0.524, 0.633]]) {'epoch': 20, 'valid/acc': 65.738, 'valid/acc_unbiased': 64.853, 'valid/diff': 7.935, 'valid/acc_skew': 63.975, 'valid/acc_align': 65.732, 'test/acc': 64.388, 'test/acc_unbiased': 63.541, 'test/diff': 7.856, 'test/acc_skew': 62.01, 'test/acc_align': 65.072}
[20 / 20] best valid accuracy: 64.853 at epoch 20 
 best_stats: {'best_valid_epoch': 20, 'best_valid_valid/acc': 65.738, 'best_valid_valid/acc_unbiased': 64.853, 'best_valid_valid/diff': 7.935, 'best_valid_valid/acc_skew': 63.975, 'best_valid_valid/acc_align': 65.732, 'best_valid_test/acc': 64.388, 'best_valid_test/acc_unbiased': 63.541, 'best_valid_test/diff': 7.856, 'best_valid_test/acc_skew': 62.01, 'best_valid_test/acc_align': 65.072}
[20 / 20] best test accuracy: 63.685 at epoch 18 
 best_stats: {'best_test_epoch': 18, 'best_test_valid/acc': 64.852, 'best_test_valid/acc_unbiased': 64.215, 'best_test_valid/diff': 7.931, 'best_test_valid/acc_skew': 63.131, 'best_test_valid/acc_align': 65.299, 'best_test_test/acc': 64.473, 'best_test_test/acc_unbiased': 63.685, 'best_test_test/diff': 8.63, 'best_test_test/acc_skew': 61.281, 'best_test_test/acc_align': 66.09}
Total training time: 0:54:29
