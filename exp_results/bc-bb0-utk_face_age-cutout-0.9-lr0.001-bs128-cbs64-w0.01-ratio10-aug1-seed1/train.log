Log level set to: INFO
Set seed: 1
=======> Using Fixed Random Seed: 1 <========
save_path: exp_results/bc-bb0-utk_face_age-cutout-0.9-lr0.001-bs128-cbs64-w0.01-ratio10-aug1-seed1
get_utk_face - split: train, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_age-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
Binary Target 1
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Normal Label Distribution: 
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
Binary Target 1
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Normal Label Distribution: 
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 10684, target_attr: gender, bias_attr: age bias_rate: 0.9
['[train] target_0-bias_0: 8237', '[train] target_0-bias_1: 147', '[train] target_1-bias_0: 823', '[train] target_1-bias_1: 1477']
confusion_matrix - 
 original: tensor([[8237.,  823.],
        [ 147., 1477.]]), 
 normalized: tensor([[0.909, 0.091],
        [0.091, 0.909]]), 
 b|y: tensor([[0.982, 0.018],
        [0.358, 0.642]])
get_utk_face - split: train, aug: 1, given_y: True, ratio: 10
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_age-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
Binary Target 1
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Normal Label Distribution: 
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
Binary Target 1
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Normal Label Distribution: 
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 10684, target_attr: gender, bias_attr: age bias_rate: 0.9
['[train] target_0-bias_0: 8237', '[train] target_0-bias_1: 147', '[train] target_1-bias_0: 823', '[train] target_1-bias_1: 1477']
get_utk_face - split: valid, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_age-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [1030, 195]
Target 1: [841, 202]
Binary Target 1
---------------------------
Target 0: [1030, 195]
Target 1: [841, 202]
===================================
Normal Label Distribution: 
Target 0: [1030, 195]
Target 1: [841, 202]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 2268, target_attr: gender, bias_attr: age bias_rate: 0.9
['[valid] target_0-bias_0: 1030', '[valid] target_0-bias_1: 195', '[valid] target_1-bias_0: 841', '[valid] target_1-bias_1: 202']
get_utk_face - split: test, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_age-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [1061, 176]
Target 1: [867, 165]
Binary Target 1
---------------------------
Target 0: [1061, 176]
Target 1: [867, 165]
===================================
Normal Label Distribution: 
Target 0: [1061, 176]
Target 1: [867, 165]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 2269, target_attr: gender, bias_attr: age bias_rate: 0.9
['[test] target_0-bias_0: 1061', '[test] target_0-bias_1: 176', '[test] target_1-bias_0: 867', '[test] target_1-bias_1: 165']
decay_epochs: [6, 13]
[1 / 20] Learning rate: 0.001 weight: 0.01
[1 / 20] Loss: 4.786946696942328 CE Loss: 0.5374801603206218 Con Loss: 4.781571897751649
[1 / 20] tensor([[0.991, 0.966],
        [0.068, 0.091]]) {'epoch': 1, 'valid/acc': 56.878, 'valid/acc_unbiased': 52.961, 'valid/diff': 1.708, 'valid/acc_skew': 52.107, 'valid/acc_align': 53.815, 'test/acc': 57.074, 'test/acc_unbiased': 52.886, 'test/diff': 2.376, 'test/acc_skew': 51.698, 'test/acc_align': 54.074}
[1 / 20] best valid accuracy: 52.961 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 56.878, 'best_valid_valid/acc_unbiased': 52.961, 'best_valid_valid/diff': 1.708, 'best_valid_valid/acc_skew': 52.107, 'best_valid_valid/acc_align': 53.815, 'best_valid_test/acc': 57.074, 'best_valid_test/acc_unbiased': 52.886, 'best_valid_test/diff': 2.376, 'best_valid_test/acc_skew': 51.698, 'best_valid_test/acc_align': 54.074}
[1 / 20] best test accuracy: 52.886 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 56.878, 'best_test_valid/acc_unbiased': 52.961, 'best_test_valid/diff': 1.708, 'best_test_valid/acc_skew': 52.107, 'best_test_valid/acc_align': 53.815, 'best_test_test/acc': 57.074, 'best_test_test/acc_unbiased': 52.886, 'best_test_test/diff': 2.376, 'best_test_test/acc_skew': 51.698, 'best_test_test/acc_align': 54.074}
[2 / 20] Learning rate: 0.001 weight: 0.01
[2 / 20] Loss: 4.500338461192883 CE Loss: 0.4889420288214296 Con Loss: 4.495449041168773
[2 / 20] tensor([[0.978, 0.795],
        [0.393, 0.485]]) {'epoch': 2, 'valid/acc': 69.18, 'valid/acc_unbiased': 65.781, 'valid/diff': 17.584, 'valid/acc_skew': 56.989, 'valid/acc_align': 74.573, 'test/acc': 70.472, 'test/acc_unbiased': 66.298, 'test/diff': 13.72, 'test/acc_skew': 59.438, 'test/acc_align': 73.159}
[2 / 20] best valid accuracy: 65.781 at epoch 2 
 best_stats: {'best_valid_epoch': 2, 'best_valid_valid/acc': 69.18, 'best_valid_valid/acc_unbiased': 65.781, 'best_valid_valid/diff': 17.584, 'best_valid_valid/acc_skew': 56.989, 'best_valid_valid/acc_align': 74.573, 'best_valid_test/acc': 70.472, 'best_valid_test/acc_unbiased': 66.298, 'best_valid_test/diff': 13.72, 'best_valid_test/acc_skew': 59.438, 'best_valid_test/acc_align': 73.159}
[2 / 20] best test accuracy: 66.298 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 69.18, 'best_test_valid/acc_unbiased': 65.781, 'best_test_valid/diff': 17.584, 'best_test_valid/acc_skew': 56.989, 'best_test_valid/acc_align': 74.573, 'best_test_test/acc': 70.472, 'best_test_test/acc_unbiased': 66.298, 'best_test_test/diff': 13.72, 'best_test_test/acc_skew': 59.438, 'best_test_test/acc_align': 73.159}
[3 / 20] Learning rate: 0.001 weight: 0.01
[3 / 20] Loss: 4.349922910338258 CE Loss: 0.47803553939981436 Con Loss: 4.345142564270122
[3 / 20] tensor([[0.772, 0.386],
        [0.824, 0.794]]) {'epoch': 3, 'valid/acc': 77.601, 'valid/acc_unbiased': 71.15, 'valid/diff': 20.157, 'valid/acc_skew': 61.104, 'valid/acc_align': 81.196, 'test/acc': 76.333, 'test/acc_unbiased': 69.394, 'test/diff': 20.757, 'test/acc_skew': 60.495, 'test/acc_align': 78.293}
[3 / 20] best valid accuracy: 71.150 at epoch 3 
 best_stats: {'best_valid_epoch': 3, 'best_valid_valid/acc': 77.601, 'best_valid_valid/acc_unbiased': 71.15, 'best_valid_valid/diff': 20.157, 'best_valid_valid/acc_skew': 61.104, 'best_valid_valid/acc_align': 81.196, 'best_valid_test/acc': 76.333, 'best_valid_test/acc_unbiased': 69.394, 'best_valid_test/diff': 20.757, 'best_valid_test/acc_skew': 60.495, 'best_valid_test/acc_align': 78.293}
[3 / 20] best test accuracy: 69.394 at epoch 3 
 best_stats: {'best_test_epoch': 3, 'best_test_valid/acc': 77.601, 'best_test_valid/acc_unbiased': 71.15, 'best_test_valid/diff': 20.157, 'best_test_valid/acc_skew': 61.104, 'best_test_valid/acc_align': 81.196, 'best_test_test/acc': 76.333, 'best_test_test/acc_unbiased': 69.394, 'best_test_test/diff': 20.757, 'best_test_test/acc_skew': 60.495, 'best_test_test/acc_align': 78.293}
[4 / 20] Learning rate: 0.001 weight: 0.01
[4 / 20] Loss: 4.3500460146607995 CE Loss: 0.4526227934335511 Con Loss: 4.345519787450267
[4 / 20] tensor([[0.987, 0.778],
        [0.400, 0.485]]) {'epoch': 4, 'valid/acc': 69.621, 'valid/acc_unbiased': 65.278, 'valid/diff': 18.385, 'valid/acc_skew': 56.086, 'valid/acc_align': 74.471, 'test/acc': 71.0, 'test/acc_unbiased': 66.257, 'test/diff': 14.651, 'test/acc_skew': 58.932, 'test/acc_align': 73.583}
[4 / 20] best valid accuracy: 71.150 at epoch 3 
 best_stats: {'best_valid_epoch': 3, 'best_valid_valid/acc': 77.601, 'best_valid_valid/acc_unbiased': 71.15, 'best_valid_valid/diff': 20.157, 'best_valid_valid/acc_skew': 61.104, 'best_valid_valid/acc_align': 81.196, 'best_valid_test/acc': 76.333, 'best_valid_test/acc_unbiased': 69.394, 'best_valid_test/diff': 20.757, 'best_valid_test/acc_skew': 60.495, 'best_valid_test/acc_align': 78.293}
[4 / 20] best test accuracy: 69.394 at epoch 3 
 best_stats: {'best_test_epoch': 3, 'best_test_valid/acc': 77.601, 'best_test_valid/acc_unbiased': 71.15, 'best_test_valid/diff': 20.157, 'best_test_valid/acc_skew': 61.104, 'best_test_valid/acc_align': 81.196, 'best_test_test/acc': 76.333, 'best_test_test/acc_unbiased': 69.394, 'best_test_test/diff': 20.757, 'best_test_test/acc_skew': 60.495, 'best_test_test/acc_align': 78.293}
[5 / 20] Learning rate: 0.001 weight: 0.01
[5 / 20] Loss: 4.286596236984098 CE Loss: 0.4243920063401197 Con Loss: 4.282352323971273
[5 / 20] tensor([[0.994, 0.864],
        [0.204, 0.230]]) {'epoch': 5, 'valid/acc': 62.875, 'valid/acc_unbiased': 59.677, 'valid/diff': 8.572, 'valid/acc_skew': 55.391, 'valid/acc_align': 63.963, 'test/acc': 62.671, 'test/acc_unbiased': 57.311, 'test/diff': 7.843, 'test/acc_skew': 53.389, 'test/acc_align': 61.232}
[5 / 20] best valid accuracy: 71.150 at epoch 3 
 best_stats: {'best_valid_epoch': 3, 'best_valid_valid/acc': 77.601, 'best_valid_valid/acc_unbiased': 71.15, 'best_valid_valid/diff': 20.157, 'best_valid_valid/acc_skew': 61.104, 'best_valid_valid/acc_align': 81.196, 'best_valid_test/acc': 76.333, 'best_valid_test/acc_unbiased': 69.394, 'best_valid_test/diff': 20.757, 'best_valid_test/acc_skew': 60.495, 'best_valid_test/acc_align': 78.293}
[5 / 20] best test accuracy: 69.394 at epoch 3 
 best_stats: {'best_test_epoch': 3, 'best_test_valid/acc': 77.601, 'best_test_valid/acc_unbiased': 71.15, 'best_test_valid/diff': 20.157, 'best_test_valid/acc_skew': 61.104, 'best_test_valid/acc_align': 81.196, 'best_test_test/acc': 76.333, 'best_test_test/acc_unbiased': 69.394, 'best_test_test/diff': 20.757, 'best_test_test/acc_skew': 60.495, 'best_test_test/acc_align': 78.293}
[6 / 20] Learning rate: 0.001 weight: 0.01
[6 / 20] Loss: 4.120307724380351 CE Loss: 0.3869594131369396 Con Loss: 4.11643812925081
[6 / 20] tensor([[0.984, 0.676],
        [0.454, 0.558]]) {'epoch': 6, 'valid/acc': 71.34, 'valid/acc_unbiased': 66.351, 'valid/diff': 26.937, 'valid/acc_skew': 52.882, 'valid/acc_align': 79.819, 'test/acc': 72.675, 'test/acc_unbiased': 66.803, 'test/diff': 20.549, 'test/acc_skew': 56.529, 'test/acc_align': 77.078}
[6 / 20] best valid accuracy: 71.150 at epoch 3 
 best_stats: {'best_valid_epoch': 3, 'best_valid_valid/acc': 77.601, 'best_valid_valid/acc_unbiased': 71.15, 'best_valid_valid/diff': 20.157, 'best_valid_valid/acc_skew': 61.104, 'best_valid_valid/acc_align': 81.196, 'best_valid_test/acc': 76.333, 'best_valid_test/acc_unbiased': 69.394, 'best_valid_test/diff': 20.757, 'best_valid_test/acc_skew': 60.495, 'best_valid_test/acc_align': 78.293}
[6 / 20] best test accuracy: 69.394 at epoch 3 
 best_stats: {'best_test_epoch': 3, 'best_test_valid/acc': 77.601, 'best_test_valid/acc_unbiased': 71.15, 'best_test_valid/diff': 20.157, 'best_test_valid/acc_skew': 61.104, 'best_test_valid/acc_align': 81.196, 'best_test_test/acc': 76.333, 'best_test_test/acc_unbiased': 69.394, 'best_test_test/diff': 20.757, 'best_test_test/acc_skew': 60.495, 'best_test_test/acc_align': 78.293}
[7 / 20] Learning rate: 0.0001 weight: 0.01
[7 / 20] Loss: 4.071411567607296 CE Loss: 0.36273920422232314 Con Loss: 4.067784168174855
[7 / 20] tensor([[0.972, 0.517],
        [0.630, 0.721]]) {'epoch': 7, 'valid/acc': 78.616, 'valid/acc_unbiased': 71.329, 'valid/diff': 33.327, 'valid/acc_skew': 54.665, 'valid/acc_align': 87.992, 'test/acc': 78.757, 'test/acc_unbiased': 70.994, 'test/diff': 27.307, 'test/acc_skew': 57.34, 'test/acc_align': 84.647}
[7 / 20] best valid accuracy: 71.329 at epoch 7 
 best_stats: {'best_valid_epoch': 7, 'best_valid_valid/acc': 78.616, 'best_valid_valid/acc_unbiased': 71.329, 'best_valid_valid/diff': 33.327, 'best_valid_valid/acc_skew': 54.665, 'best_valid_valid/acc_align': 87.992, 'best_valid_test/acc': 78.757, 'best_valid_test/acc_unbiased': 70.994, 'best_valid_test/diff': 27.307, 'best_valid_test/acc_skew': 57.34, 'best_valid_test/acc_align': 84.647}
[7 / 20] best test accuracy: 70.994 at epoch 7 
 best_stats: {'best_test_epoch': 7, 'best_test_valid/acc': 78.616, 'best_test_valid/acc_unbiased': 71.329, 'best_test_valid/diff': 33.327, 'best_test_valid/acc_skew': 54.665, 'best_test_valid/acc_align': 87.992, 'best_test_test/acc': 78.757, 'best_test_test/acc_unbiased': 70.994, 'best_test_test/diff': 27.307, 'best_test_test/acc_skew': 57.34, 'best_test_test/acc_align': 84.647}
[8 / 20] Learning rate: 0.0001 weight: 0.01
[8 / 20] Loss: 3.985049916402716 CE Loss: 0.3468007668992278 Con Loss: 3.981581907065251
[8 / 20] tensor([[0.976, 0.472],
        [0.632, 0.782]]) {'epoch': 8, 'valid/acc': 78.351, 'valid/acc_unbiased': 71.02, 'valid/diff': 37.013, 'valid/acc_skew': 52.513, 'valid/acc_align': 89.526, 'test/acc': 79.154, 'test/acc_unbiased': 71.548, 'test/diff': 32.73, 'test/acc_skew': 55.183, 'test/acc_align': 87.913}
[8 / 20] best valid accuracy: 71.329 at epoch 7 
 best_stats: {'best_valid_epoch': 7, 'best_valid_valid/acc': 78.616, 'best_valid_valid/acc_unbiased': 71.329, 'best_valid_valid/diff': 33.327, 'best_valid_valid/acc_skew': 54.665, 'best_valid_valid/acc_align': 87.992, 'best_valid_test/acc': 78.757, 'best_valid_test/acc_unbiased': 70.994, 'best_valid_test/diff': 27.307, 'best_valid_test/acc_skew': 57.34, 'best_valid_test/acc_align': 84.647}
[8 / 20] best test accuracy: 71.548 at epoch 8 
 best_stats: {'best_test_epoch': 8, 'best_test_valid/acc': 78.351, 'best_test_valid/acc_unbiased': 71.02, 'best_test_valid/diff': 37.013, 'best_test_valid/acc_skew': 52.513, 'best_test_valid/acc_align': 89.526, 'best_test_test/acc': 79.154, 'best_test_test/acc_unbiased': 71.548, 'best_test_test/diff': 32.73, 'best_test_test/acc_skew': 55.183, 'best_test_test/acc_align': 87.913}
[9 / 20] Learning rate: 0.0001 weight: 0.01
[9 / 20] Loss: 3.9484919974171055 CE Loss: 0.31461973141883026 Con Loss: 3.945345801478778
[9 / 20] tensor([[0.970, 0.432],
        [0.641, 0.806]]) {'epoch': 9, 'valid/acc': 78.042, 'valid/acc_unbiased': 70.017, 'valid/diff': 40.804, 'valid/acc_skew': 49.615, 'valid/acc_align': 90.419, 'test/acc': 79.066, 'test/acc_unbiased': 71.225, 'test/diff': 35.14, 'test/acc_skew': 53.655, 'test/acc_align': 88.795}
[9 / 20] best valid accuracy: 71.329 at epoch 7 
 best_stats: {'best_valid_epoch': 7, 'best_valid_valid/acc': 78.616, 'best_valid_valid/acc_unbiased': 71.329, 'best_valid_valid/diff': 33.327, 'best_valid_valid/acc_skew': 54.665, 'best_valid_valid/acc_align': 87.992, 'best_valid_test/acc': 78.757, 'best_valid_test/acc_unbiased': 70.994, 'best_valid_test/diff': 27.307, 'best_valid_test/acc_skew': 57.34, 'best_valid_test/acc_align': 84.647}
[9 / 20] best test accuracy: 71.548 at epoch 8 
 best_stats: {'best_test_epoch': 8, 'best_test_valid/acc': 78.351, 'best_test_valid/acc_unbiased': 71.02, 'best_test_valid/diff': 37.013, 'best_test_valid/acc_skew': 52.513, 'best_test_valid/acc_align': 89.526, 'best_test_test/acc': 79.154, 'best_test_test/acc_unbiased': 71.548, 'best_test_test/diff': 32.73, 'best_test_test/acc_skew': 55.183, 'best_test_test/acc_align': 87.913}
[10 / 20] Learning rate: 0.0001 weight: 0.01
[10 / 20] Loss: 3.8914581205638683 CE Loss: 0.3155182707470394 Con Loss: 3.888302931487449
[10 / 20] tensor([[0.975, 0.420],
        [0.602, 0.782]]) {'epoch': 10, 'valid/acc': 76.764, 'valid/acc_unbiased': 68.651, 'valid/diff': 43.333, 'valid/acc_skew': 46.984, 'valid/acc_align': 90.317, 'test/acc': 77.567, 'test/acc_unbiased': 69.496, 'test/diff': 36.739, 'test/acc_skew': 51.127, 'test/acc_align': 87.866}
[10 / 20] best valid accuracy: 71.329 at epoch 7 
 best_stats: {'best_valid_epoch': 7, 'best_valid_valid/acc': 78.616, 'best_valid_valid/acc_unbiased': 71.329, 'best_valid_valid/diff': 33.327, 'best_valid_valid/acc_skew': 54.665, 'best_valid_valid/acc_align': 87.992, 'best_valid_test/acc': 78.757, 'best_valid_test/acc_unbiased': 70.994, 'best_valid_test/diff': 27.307, 'best_valid_test/acc_skew': 57.34, 'best_valid_test/acc_align': 84.647}
[10 / 20] best test accuracy: 71.548 at epoch 8 
 best_stats: {'best_test_epoch': 8, 'best_test_valid/acc': 78.351, 'best_test_valid/acc_unbiased': 71.02, 'best_test_valid/diff': 37.013, 'best_test_valid/acc_skew': 52.513, 'best_test_valid/acc_align': 89.526, 'best_test_test/acc': 79.154, 'best_test_test/acc_unbiased': 71.548, 'best_test_test/diff': 32.73, 'best_test_test/acc_skew': 55.183, 'best_test_test/acc_align': 87.913}
[11 / 20] Learning rate: 0.0001 weight: 0.01
[11 / 20] Loss: 3.8486960151141076 CE Loss: 0.3013892064644397 Con Loss: 3.845682128097894
[11 / 20] tensor([[0.970, 0.398],
        [0.645, 0.824]]) {'epoch': 11, 'valid/acc': 78.307, 'valid/acc_unbiased': 70.863, 'valid/diff': 41.588, 'valid/acc_skew': 50.068, 'valid/acc_align': 91.657, 'test/acc': 79.066, 'test/acc_unbiased': 70.914, 'test/diff': 37.58, 'test/acc_skew': 52.124, 'test/acc_align': 89.704}
[11 / 20] best valid accuracy: 71.329 at epoch 7 
 best_stats: {'best_valid_epoch': 7, 'best_valid_valid/acc': 78.616, 'best_valid_valid/acc_unbiased': 71.329, 'best_valid_valid/diff': 33.327, 'best_valid_valid/acc_skew': 54.665, 'best_valid_valid/acc_align': 87.992, 'best_valid_test/acc': 78.757, 'best_valid_test/acc_unbiased': 70.994, 'best_valid_test/diff': 27.307, 'best_valid_test/acc_skew': 57.34, 'best_valid_test/acc_align': 84.647}
[11 / 20] best test accuracy: 71.548 at epoch 8 
 best_stats: {'best_test_epoch': 8, 'best_test_valid/acc': 78.351, 'best_test_valid/acc_unbiased': 71.02, 'best_test_valid/diff': 37.013, 'best_test_valid/acc_skew': 52.513, 'best_test_valid/acc_align': 89.526, 'best_test_test/acc': 79.154, 'best_test_test/acc_unbiased': 71.548, 'best_test_test/diff': 32.73, 'best_test_test/acc_skew': 55.183, 'best_test_test/acc_align': 87.913}
[12 / 20] Learning rate: 0.0001 weight: 0.01
[12 / 20] Loss: 3.8583857782857334 CE Loss: 0.3002907989043861 Con Loss: 3.8553828627194684
[12 / 20] tensor([[0.983, 0.545],
        [0.573, 0.758]]) {'epoch': 12, 'valid/acc': 76.367, 'valid/acc_unbiased': 70.15, 'valid/diff': 37.947, 'valid/acc_skew': 51.176, 'valid/acc_align': 89.123, 'test/acc': 77.611, 'test/acc_unbiased': 71.483, 'test/diff': 31.096, 'test/acc_skew': 55.935, 'test/acc_align': 87.031}
[12 / 20] best valid accuracy: 71.329 at epoch 7 
 best_stats: {'best_valid_epoch': 7, 'best_valid_valid/acc': 78.616, 'best_valid_valid/acc_unbiased': 71.329, 'best_valid_valid/diff': 33.327, 'best_valid_valid/acc_skew': 54.665, 'best_valid_valid/acc_align': 87.992, 'best_valid_test/acc': 78.757, 'best_valid_test/acc_unbiased': 70.994, 'best_valid_test/diff': 27.307, 'best_valid_test/acc_skew': 57.34, 'best_valid_test/acc_align': 84.647}
[12 / 20] best test accuracy: 71.548 at epoch 8 
 best_stats: {'best_test_epoch': 8, 'best_test_valid/acc': 78.351, 'best_test_valid/acc_unbiased': 71.02, 'best_test_valid/diff': 37.013, 'best_test_valid/acc_skew': 52.513, 'best_test_valid/acc_align': 89.526, 'best_test_test/acc': 79.154, 'best_test_test/acc_unbiased': 71.548, 'best_test_test/diff': 32.73, 'best_test_test/acc_skew': 55.183, 'best_test_test/acc_align': 87.913}
[13 / 20] Learning rate: 0.0001 weight: 0.01
[13 / 20] Loss: 3.8589276755985273 CE Loss: 0.2871013620916443 Con Loss: 3.856056678969063
[13 / 20] tensor([[0.972, 0.358],
        [0.632, 0.836]]) {'epoch': 13, 'valid/acc': 78.263, 'valid/acc_unbiased': 70.709, 'valid/diff': 45.264, 'valid/acc_skew': 48.076, 'valid/acc_align': 93.341, 'test/acc': 78.449, 'test/acc_unbiased': 69.953, 'test/diff': 40.903, 'test/acc_skew': 49.501, 'test/acc_align': 90.404}
[13 / 20] best valid accuracy: 71.329 at epoch 7 
 best_stats: {'best_valid_epoch': 7, 'best_valid_valid/acc': 78.616, 'best_valid_valid/acc_unbiased': 71.329, 'best_valid_valid/diff': 33.327, 'best_valid_valid/acc_skew': 54.665, 'best_valid_valid/acc_align': 87.992, 'best_valid_test/acc': 78.757, 'best_valid_test/acc_unbiased': 70.994, 'best_valid_test/diff': 27.307, 'best_valid_test/acc_skew': 57.34, 'best_valid_test/acc_align': 84.647}
[13 / 20] best test accuracy: 71.548 at epoch 8 
 best_stats: {'best_test_epoch': 8, 'best_test_valid/acc': 78.351, 'best_test_valid/acc_unbiased': 71.02, 'best_test_valid/diff': 37.013, 'best_test_valid/acc_skew': 52.513, 'best_test_valid/acc_align': 89.526, 'best_test_test/acc': 79.154, 'best_test_test/acc_unbiased': 71.548, 'best_test_test/diff': 32.73, 'best_test_test/acc_skew': 55.183, 'best_test_test/acc_align': 87.913}
[14 / 20] Learning rate: 1e-05 weight: 0.01
[14 / 20] Loss: 3.824688910545369 CE Loss: 0.2765805114525081 Con Loss: 3.8219230939992936
[14 / 20] tensor([[0.977, 0.386],
        [0.602, 0.836]]) {'epoch': 14, 'valid/acc': 77.337, 'valid/acc_unbiased': 70.258, 'valid/diff': 45.759, 'valid/acc_skew': 47.378, 'valid/acc_align': 93.137, 'test/acc': 77.788, 'test/acc_unbiased': 70.055, 'test/diff': 41.265, 'test/acc_skew': 49.422, 'test/acc_align': 90.687}
[14 / 20] best valid accuracy: 71.329 at epoch 7 
 best_stats: {'best_valid_epoch': 7, 'best_valid_valid/acc': 78.616, 'best_valid_valid/acc_unbiased': 71.329, 'best_valid_valid/diff': 33.327, 'best_valid_valid/acc_skew': 54.665, 'best_valid_valid/acc_align': 87.992, 'best_valid_test/acc': 78.757, 'best_valid_test/acc_unbiased': 70.994, 'best_valid_test/diff': 27.307, 'best_valid_test/acc_skew': 57.34, 'best_valid_test/acc_align': 84.647}
[14 / 20] best test accuracy: 71.548 at epoch 8 
 best_stats: {'best_test_epoch': 8, 'best_test_valid/acc': 78.351, 'best_test_valid/acc_unbiased': 71.02, 'best_test_valid/diff': 37.013, 'best_test_valid/acc_skew': 52.513, 'best_test_valid/acc_align': 89.526, 'best_test_test/acc': 79.154, 'best_test_test/acc_unbiased': 71.548, 'best_test_test/diff': 32.73, 'best_test_test/acc_skew': 55.183, 'best_test_test/acc_align': 87.913}
[15 / 20] Learning rate: 1e-05 weight: 0.01
[15 / 20] Loss: 3.7796312912891348 CE Loss: 0.28321486877752394 Con Loss: 3.776799132519561
[15 / 20] tensor([[0.975, 0.381],
        [0.617, 0.836]]) {'epoch': 15, 'valid/acc': 77.91, 'valid/acc_unbiased': 70.069, 'valid/diff': 45.844, 'valid/acc_skew': 47.147, 'valid/acc_align': 92.991, 'test/acc': 78.184, 'test/acc_unbiased': 70.217, 'test/diff': 40.658, 'test/acc_skew': 49.888, 'test/acc_align': 90.546}
[15 / 20] best valid accuracy: 71.329 at epoch 7 
 best_stats: {'best_valid_epoch': 7, 'best_valid_valid/acc': 78.616, 'best_valid_valid/acc_unbiased': 71.329, 'best_valid_valid/diff': 33.327, 'best_valid_valid/acc_skew': 54.665, 'best_valid_valid/acc_align': 87.992, 'best_valid_test/acc': 78.757, 'best_valid_test/acc_unbiased': 70.994, 'best_valid_test/diff': 27.307, 'best_valid_test/acc_skew': 57.34, 'best_valid_test/acc_align': 84.647}
[15 / 20] best test accuracy: 71.548 at epoch 8 
 best_stats: {'best_test_epoch': 8, 'best_test_valid/acc': 78.351, 'best_test_valid/acc_unbiased': 71.02, 'best_test_valid/diff': 37.013, 'best_test_valid/acc_skew': 52.513, 'best_test_valid/acc_align': 89.526, 'best_test_test/acc': 79.154, 'best_test_test/acc_unbiased': 71.548, 'best_test_test/diff': 32.73, 'best_test_test/acc_skew': 55.183, 'best_test_test/acc_align': 87.913}
[16 / 20] Learning rate: 1e-05 weight: 0.01
[16 / 20] Loss: 3.7676161753912627 CE Loss: 0.2863761729535339 Con Loss: 3.7647524058528714
[16 / 20] tensor([[0.975, 0.358],
        [0.611, 0.818]]) {'epoch': 16, 'valid/acc': 77.601, 'valid/acc_unbiased': 69.662, 'valid/diff': 45.862, 'valid/acc_skew': 46.731, 'valid/acc_align': 92.593, 'test/acc': 77.699, 'test/acc_unbiased': 69.073, 'test/diff': 41.221, 'test/acc_skew': 48.463, 'test/acc_align': 89.684}
[16 / 20] best valid accuracy: 71.329 at epoch 7 
 best_stats: {'best_valid_epoch': 7, 'best_valid_valid/acc': 78.616, 'best_valid_valid/acc_unbiased': 71.329, 'best_valid_valid/diff': 33.327, 'best_valid_valid/acc_skew': 54.665, 'best_valid_valid/acc_align': 87.992, 'best_valid_test/acc': 78.757, 'best_valid_test/acc_unbiased': 70.994, 'best_valid_test/diff': 27.307, 'best_valid_test/acc_skew': 57.34, 'best_valid_test/acc_align': 84.647}
[16 / 20] best test accuracy: 71.548 at epoch 8 
 best_stats: {'best_test_epoch': 8, 'best_test_valid/acc': 78.351, 'best_test_valid/acc_unbiased': 71.02, 'best_test_valid/diff': 37.013, 'best_test_valid/acc_skew': 52.513, 'best_test_valid/acc_align': 89.526, 'best_test_test/acc': 79.154, 'best_test_test/acc_unbiased': 71.548, 'best_test_test/diff': 32.73, 'best_test_test/acc_skew': 55.183, 'best_test_test/acc_align': 87.913}
[17 / 20] Learning rate: 1e-05 weight: 0.01
[17 / 20] Loss: 3.7439105473221663 CE Loss: 0.2731988686539626 Con Loss: 3.741178550241771
[17 / 20] tensor([[0.980, 0.415],
        [0.608, 0.812]]) {'epoch': 17, 'valid/acc': 77.116, 'valid/acc_unbiased': 69.931, 'valid/diff': 44.83, 'valid/acc_skew': 47.515, 'valid/acc_align': 92.346, 'test/acc': 78.184, 'test/acc_unbiased': 70.374, 'test/diff': 38.486, 'test/acc_skew': 51.131, 'test/acc_align': 89.616}
[17 / 20] best valid accuracy: 71.329 at epoch 7 
 best_stats: {'best_valid_epoch': 7, 'best_valid_valid/acc': 78.616, 'best_valid_valid/acc_unbiased': 71.329, 'best_valid_valid/diff': 33.327, 'best_valid_valid/acc_skew': 54.665, 'best_valid_valid/acc_align': 87.992, 'best_valid_test/acc': 78.757, 'best_valid_test/acc_unbiased': 70.994, 'best_valid_test/diff': 27.307, 'best_valid_test/acc_skew': 57.34, 'best_valid_test/acc_align': 84.647}
[17 / 20] best test accuracy: 71.548 at epoch 8 
 best_stats: {'best_test_epoch': 8, 'best_test_valid/acc': 78.351, 'best_test_valid/acc_unbiased': 71.02, 'best_test_valid/diff': 37.013, 'best_test_valid/acc_skew': 52.513, 'best_test_valid/acc_align': 89.526, 'best_test_test/acc': 79.154, 'best_test_test/acc_unbiased': 71.548, 'best_test_test/diff': 32.73, 'best_test_test/acc_skew': 55.183, 'best_test_test/acc_align': 87.913}
[18 / 20] Learning rate: 1e-05 weight: 0.01
[18 / 20] Loss: 3.7589144162228383 CE Loss: 0.27583000711045075 Con Loss: 3.7561561142804694
[18 / 20] tensor([[0.981, 0.438],
        [0.586, 0.806]]) {'epoch': 18, 'valid/acc': 76.323, 'valid/acc_unbiased': 69.403, 'valid/diff': 44.101, 'valid/acc_skew': 47.352, 'valid/acc_align': 91.453, 'test/acc': 77.523, 'test/acc_unbiased': 70.266, 'test/diff': 38.189, 'test/acc_skew': 51.171, 'test/acc_align': 89.361}
[18 / 20] best valid accuracy: 71.329 at epoch 7 
 best_stats: {'best_valid_epoch': 7, 'best_valid_valid/acc': 78.616, 'best_valid_valid/acc_unbiased': 71.329, 'best_valid_valid/diff': 33.327, 'best_valid_valid/acc_skew': 54.665, 'best_valid_valid/acc_align': 87.992, 'best_valid_test/acc': 78.757, 'best_valid_test/acc_unbiased': 70.994, 'best_valid_test/diff': 27.307, 'best_valid_test/acc_skew': 57.34, 'best_valid_test/acc_align': 84.647}
[18 / 20] best test accuracy: 71.548 at epoch 8 
 best_stats: {'best_test_epoch': 8, 'best_test_valid/acc': 78.351, 'best_test_valid/acc_unbiased': 71.02, 'best_test_valid/diff': 37.013, 'best_test_valid/acc_skew': 52.513, 'best_test_valid/acc_align': 89.526, 'best_test_test/acc': 79.154, 'best_test_test/acc_unbiased': 71.548, 'best_test_test/diff': 32.73, 'best_test_test/acc_skew': 55.183, 'best_test_test/acc_align': 87.913}
[19 / 20] Learning rate: 1e-05 weight: 0.01
[19 / 20] Loss: 3.8090884128522 CE Loss: 0.27362604356133413 Con Loss: 3.8063521454817164
[19 / 20] tensor([[0.980, 0.392],
        [0.597, 0.836]]) {'epoch': 19, 'valid/acc': 76.764, 'valid/acc_unbiased': 69.391, 'valid/diff': 45.609, 'valid/acc_skew': 46.586, 'valid/acc_align': 92.196, 'test/acc': 77.788, 'test/acc_unbiased': 70.152, 'test/diff': 41.353, 'test/acc_skew': 49.475, 'test/acc_align': 90.829}
[19 / 20] best valid accuracy: 71.329 at epoch 7 
 best_stats: {'best_valid_epoch': 7, 'best_valid_valid/acc': 78.616, 'best_valid_valid/acc_unbiased': 71.329, 'best_valid_valid/diff': 33.327, 'best_valid_valid/acc_skew': 54.665, 'best_valid_valid/acc_align': 87.992, 'best_valid_test/acc': 78.757, 'best_valid_test/acc_unbiased': 70.994, 'best_valid_test/diff': 27.307, 'best_valid_test/acc_skew': 57.34, 'best_valid_test/acc_align': 84.647}
[19 / 20] best test accuracy: 71.548 at epoch 8 
 best_stats: {'best_test_epoch': 8, 'best_test_valid/acc': 78.351, 'best_test_valid/acc_unbiased': 71.02, 'best_test_valid/diff': 37.013, 'best_test_valid/acc_skew': 52.513, 'best_test_valid/acc_align': 89.526, 'best_test_test/acc': 79.154, 'best_test_test/acc_unbiased': 71.548, 'best_test_test/diff': 32.73, 'best_test_test/acc_skew': 55.183, 'best_test_test/acc_align': 87.913}
[20 / 20] Learning rate: 1e-05 weight: 0.01
[20 / 20] Loss: 3.795536268877653 CE Loss: 0.28269309910081913 Con Loss: 3.7927093334476494
[20 / 20] tensor([[0.979, 0.386],
        [0.612, 0.830]]) {'epoch': 20, 'valid/acc': 76.984, 'valid/acc_unbiased': 69.344, 'valid/diff': 46.102, 'valid/acc_skew': 46.293, 'valid/acc_align': 92.395, 'test/acc': 78.228, 'test/acc_unbiased': 70.21, 'test/diff': 40.537, 'test/acc_skew': 49.941, 'test/acc_align': 90.478}
[20 / 20] best valid accuracy: 71.329 at epoch 7 
 best_stats: {'best_valid_epoch': 7, 'best_valid_valid/acc': 78.616, 'best_valid_valid/acc_unbiased': 71.329, 'best_valid_valid/diff': 33.327, 'best_valid_valid/acc_skew': 54.665, 'best_valid_valid/acc_align': 87.992, 'best_valid_test/acc': 78.757, 'best_valid_test/acc_unbiased': 70.994, 'best_valid_test/diff': 27.307, 'best_valid_test/acc_skew': 57.34, 'best_valid_test/acc_align': 84.647}
[20 / 20] best test accuracy: 71.548 at epoch 8 
 best_stats: {'best_test_epoch': 8, 'best_test_valid/acc': 78.351, 'best_test_valid/acc_unbiased': 71.02, 'best_test_valid/diff': 37.013, 'best_test_valid/acc_skew': 52.513, 'best_test_valid/acc_align': 89.526, 'best_test_test/acc': 79.154, 'best_test_test/acc_unbiased': 71.548, 'best_test_test/diff': 32.73, 'best_test_test/acc_skew': 55.183, 'best_test_test/acc_align': 87.913}
Total training time: 0:16:06
