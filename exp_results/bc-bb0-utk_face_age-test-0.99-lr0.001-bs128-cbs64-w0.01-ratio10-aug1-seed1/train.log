Log level set to: INFO
Set seed: 1
=======> Using Fixed Random Seed: 1 <========
save_path: exp_results/bc-bb0-utk_face_age-test-0.99-lr0.001-bs128-cbs64-w0.01-ratio10-aug1-seed1
get_utk_face - split: train, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_age-0.99
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [8237, 14]
Target 1: [82, 1477]
Binary Target 1
---------------------------
Target 0: [8237, 14]
Target 1: [82, 1477]
===================================
Normal Label Distribution: 
Target 0: [8237, 14]
Target 1: [82, 1477]
===================================
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [8237, 14]
Target 1: [82, 1477]
Binary Target 1
---------------------------
Target 0: [8237, 14]
Target 1: [82, 1477]
===================================
Normal Label Distribution: 
Target 0: [8237, 14]
Target 1: [82, 1477]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 9810, target_attr: gender, bias_attr: age bias_rate: 0.99
['[train] target_0-bias_0: 8237', '[train] target_0-bias_1: 14', '[train] target_1-bias_0: 82', '[train] target_1-bias_1: 1477']
confusion_matrix - 
 original: tensor([[8237.,   82.],
        [  14., 1477.]]), 
 normalized: tensor([[0.990, 0.010],
        [0.009, 0.991]]), 
 b|y: tensor([[0.998, 0.002],
        [0.053, 0.947]])
get_utk_face - split: train, aug: 1, given_y: True, ratio: 10
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_age-0.99
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [8237, 14]
Target 1: [82, 1477]
Binary Target 1
---------------------------
Target 0: [8237, 14]
Target 1: [82, 1477]
===================================
Normal Label Distribution: 
Target 0: [8237, 14]
Target 1: [82, 1477]
===================================
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [8237, 14]
Target 1: [82, 1477]
Binary Target 1
---------------------------
Target 0: [8237, 14]
Target 1: [82, 1477]
===================================
Normal Label Distribution: 
Target 0: [8237, 14]
Target 1: [82, 1477]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 9810, target_attr: gender, bias_attr: age bias_rate: 0.99
['[train] target_0-bias_0: 8237', '[train] target_0-bias_1: 14', '[train] target_1-bias_0: 82', '[train] target_1-bias_1: 1477']
get_utk_face - split: valid, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_age-0.99
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [1030, 195]
Target 1: [841, 202]
Binary Target 1
---------------------------
Target 0: [1030, 195]
Target 1: [841, 202]
===================================
Normal Label Distribution: 
Target 0: [1030, 195]
Target 1: [841, 202]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 2268, target_attr: gender, bias_attr: age bias_rate: 0.99
['[valid] target_0-bias_0: 1030', '[valid] target_0-bias_1: 195', '[valid] target_1-bias_0: 841', '[valid] target_1-bias_1: 202']
get_utk_face - split: test, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_age-0.99
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [1061, 176]
Target 1: [867, 165]
Binary Target 1
---------------------------
Target 0: [1061, 176]
Target 1: [867, 165]
===================================
Normal Label Distribution: 
Target 0: [1061, 176]
Target 1: [867, 165]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 2269, target_attr: gender, bias_attr: age bias_rate: 0.99
['[test] target_0-bias_0: 1061', '[test] target_0-bias_1: 176', '[test] target_1-bias_0: 867', '[test] target_1-bias_1: 165']
decay_epochs: [6, 13]
[1 / 20] Learning rate: 0.001 weight: 0.01
[1 / 20] Loss: 2.943513216107142 CE Loss: 0.5267223760865394 Con Loss: 2.9382459910273186
[1 / 20] tensor([[1., 1.],
        [0., 0.]]) {'epoch': 1, 'valid/acc': 54.012, 'valid/acc_unbiased': 50.0, 'valid/diff': 0.0, 'valid/acc_skew': 50.0, 'valid/acc_align': 50.0, 'test/acc': 54.517, 'test/acc_unbiased': 50.0, 'test/diff': 0.0, 'test/acc_skew': 50.0, 'test/acc_align': 50.0}
[1 / 20] best valid accuracy: 50.000 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 54.012, 'best_valid_valid/acc_unbiased': 50.0, 'best_valid_valid/diff': 0.0, 'best_valid_valid/acc_skew': 50.0, 'best_valid_valid/acc_align': 50.0, 'best_valid_test/acc': 54.517, 'best_valid_test/acc_unbiased': 50.0, 'best_valid_test/diff': 0.0, 'best_valid_test/acc_skew': 50.0, 'best_valid_test/acc_align': 50.0}
[1 / 20] best test accuracy: 50.000 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 54.012, 'best_test_valid/acc_unbiased': 50.0, 'best_test_valid/diff': 0.0, 'best_test_valid/acc_skew': 50.0, 'best_test_valid/acc_align': 50.0, 'best_test_test/acc': 54.517, 'best_test_test/acc_unbiased': 50.0, 'best_test_test/diff': 0.0, 'best_test_test/acc_skew': 50.0, 'best_test_test/acc_align': 50.0}
[2 / 20] Learning rate: 0.001 weight: 0.01
[2 / 20] Loss: 3.1858866995141653 CE Loss: 0.47593970994458407 Con Loss: 3.181127305521756
[2 / 20] tensor([[1., 1.],
        [0., 0.]]) {'epoch': 2, 'valid/acc': 54.012, 'valid/acc_unbiased': 50.0, 'valid/diff': 0.0, 'valid/acc_skew': 50.0, 'valid/acc_align': 50.0, 'test/acc': 54.517, 'test/acc_unbiased': 50.0, 'test/diff': 0.0, 'test/acc_skew': 50.0, 'test/acc_align': 50.0}
[2 / 20] best valid accuracy: 50.000 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 54.012, 'best_valid_valid/acc_unbiased': 50.0, 'best_valid_valid/diff': 0.0, 'best_valid_valid/acc_skew': 50.0, 'best_valid_valid/acc_align': 50.0, 'best_valid_test/acc': 54.517, 'best_valid_test/acc_unbiased': 50.0, 'best_valid_test/diff': 0.0, 'best_valid_test/acc_skew': 50.0, 'best_valid_test/acc_align': 50.0}
[2 / 20] best test accuracy: 50.000 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 54.012, 'best_test_valid/acc_unbiased': 50.0, 'best_test_valid/diff': 0.0, 'best_test_valid/acc_skew': 50.0, 'best_test_valid/acc_align': 50.0, 'best_test_test/acc': 54.517, 'best_test_test/acc_unbiased': 50.0, 'best_test_test/diff': 0.0, 'best_test_test/acc_skew': 50.0, 'best_test_test/acc_align': 50.0}
[3 / 20] Learning rate: 0.001 weight: 0.01
[3 / 20] Loss: 2.6727484467258025 CE Loss: 0.46816527105860267 Con Loss: 2.6680668053155525
[3 / 20] tensor([[0.987, 1.000],
        [0.020, 0.018]]) {'epoch': 3, 'valid/acc': 54.541, 'valid/acc_unbiased': 50.386, 'valid/diff': 0.808, 'valid/acc_skew': 50.617, 'valid/acc_align': 50.155, 'test/acc': 54.782, 'test/acc_unbiased': 50.615, 'test/diff': 0.731, 'test/acc_skew': 50.98, 'test/acc_align': 50.249}
[3 / 20] best valid accuracy: 50.386 at epoch 3 
 best_stats: {'best_valid_epoch': 3, 'best_valid_valid/acc': 54.541, 'best_valid_valid/acc_unbiased': 50.386, 'best_valid_valid/diff': 0.808, 'best_valid_valid/acc_skew': 50.617, 'best_valid_valid/acc_align': 50.155, 'best_valid_test/acc': 54.782, 'best_valid_test/acc_unbiased': 50.615, 'best_valid_test/diff': 0.731, 'best_valid_test/acc_skew': 50.98, 'best_valid_test/acc_align': 50.249}
[3 / 20] best test accuracy: 50.615 at epoch 3 
 best_stats: {'best_test_epoch': 3, 'best_test_valid/acc': 54.541, 'best_test_valid/acc_unbiased': 50.386, 'best_test_valid/diff': 0.808, 'best_test_valid/acc_skew': 50.617, 'best_test_valid/acc_align': 50.155, 'best_test_test/acc': 54.782, 'best_test_test/acc_unbiased': 50.615, 'best_test_test/diff': 0.731, 'best_test_test/acc_skew': 50.98, 'best_test_test/acc_align': 50.249}
[4 / 20] Learning rate: 0.001 weight: 0.01
[4 / 20] Loss: 2.7526671135462024 CE Loss: 0.47696854585779797 Con Loss: 2.7478974133335
[4 / 20] tensor([[1., 1.],
        [0., 0.]]) {'epoch': 4, 'valid/acc': 54.012, 'valid/acc_unbiased': 50.0, 'valid/diff': 0.0, 'valid/acc_skew': 50.0, 'valid/acc_align': 50.0, 'test/acc': 54.517, 'test/acc_unbiased': 50.0, 'test/diff': 0.0, 'test/acc_skew': 50.0, 'test/acc_align': 50.0}
[4 / 20] best valid accuracy: 50.386 at epoch 3 
 best_stats: {'best_valid_epoch': 3, 'best_valid_valid/acc': 54.541, 'best_valid_valid/acc_unbiased': 50.386, 'best_valid_valid/diff': 0.808, 'best_valid_valid/acc_skew': 50.617, 'best_valid_valid/acc_align': 50.155, 'best_valid_test/acc': 54.782, 'best_valid_test/acc_unbiased': 50.615, 'best_valid_test/diff': 0.731, 'best_valid_test/acc_skew': 50.98, 'best_valid_test/acc_align': 50.249}
[4 / 20] best test accuracy: 50.615 at epoch 3 
 best_stats: {'best_test_epoch': 3, 'best_test_valid/acc': 54.541, 'best_test_valid/acc_unbiased': 50.386, 'best_test_valid/diff': 0.808, 'best_test_valid/acc_skew': 50.617, 'best_test_valid/acc_align': 50.155, 'best_test_test/acc': 54.782, 'best_test_test/acc_unbiased': 50.615, 'best_test_test/diff': 0.731, 'best_test_test/acc_skew': 50.98, 'best_test_test/acc_align': 50.249}
[5 / 20] Learning rate: 0.001 weight: 0.01
[5 / 20] Loss: 2.951737525412067 CE Loss: 0.487554369345839 Con Loss: 2.9468619842655674
[5 / 20] tensor([[1., 1.],
        [0., 0.]]) {'epoch': 5, 'valid/acc': 54.012, 'valid/acc_unbiased': 50.0, 'valid/diff': 0.0, 'valid/acc_skew': 50.0, 'valid/acc_align': 50.0, 'test/acc': 54.517, 'test/acc_unbiased': 50.0, 'test/diff': 0.0, 'test/acc_skew': 50.0, 'test/acc_align': 50.0}
[5 / 20] best valid accuracy: 50.386 at epoch 3 
 best_stats: {'best_valid_epoch': 3, 'best_valid_valid/acc': 54.541, 'best_valid_valid/acc_unbiased': 50.386, 'best_valid_valid/diff': 0.808, 'best_valid_valid/acc_skew': 50.617, 'best_valid_valid/acc_align': 50.155, 'best_valid_test/acc': 54.782, 'best_valid_test/acc_unbiased': 50.615, 'best_valid_test/diff': 0.731, 'best_valid_test/acc_skew': 50.98, 'best_valid_test/acc_align': 50.249}
[5 / 20] best test accuracy: 50.615 at epoch 3 
 best_stats: {'best_test_epoch': 3, 'best_test_valid/acc': 54.541, 'best_test_valid/acc_unbiased': 50.386, 'best_test_valid/diff': 0.808, 'best_test_valid/acc_skew': 50.617, 'best_test_valid/acc_align': 50.155, 'best_test_test/acc': 54.782, 'best_test_test/acc_unbiased': 50.615, 'best_test_test/diff': 0.731, 'best_test_test/acc_skew': 50.98, 'best_test_test/acc_align': 50.249}
[6 / 20] Learning rate: 0.001 weight: 0.01
[6 / 20] Loss: 2.8362566789477364 CE Loss: 0.4791633609238021 Con Loss: 2.8314650561831414
[6 / 20] tensor([[0.992, 0.915],
        [0.054, 0.164]]) {'epoch': 6, 'valid/acc': 55.996, 'valid/acc_unbiased': 52.271, 'valid/diff': 8.853, 'valid/acc_skew': 47.844, 'valid/acc_align': 56.698, 'test/acc': 56.765, 'test/acc_unbiased': 53.127, 'test/diff': 9.356, 'test/acc_skew': 48.449, 'test/acc_align': 57.805}
[6 / 20] best valid accuracy: 52.271 at epoch 6 
 best_stats: {'best_valid_epoch': 6, 'best_valid_valid/acc': 55.996, 'best_valid_valid/acc_unbiased': 52.271, 'best_valid_valid/diff': 8.853, 'best_valid_valid/acc_skew': 47.844, 'best_valid_valid/acc_align': 56.698, 'best_valid_test/acc': 56.765, 'best_valid_test/acc_unbiased': 53.127, 'best_valid_test/diff': 9.356, 'best_valid_test/acc_skew': 48.449, 'best_valid_test/acc_align': 57.805}
[6 / 20] best test accuracy: 53.127 at epoch 6 
 best_stats: {'best_test_epoch': 6, 'best_test_valid/acc': 55.996, 'best_test_valid/acc_unbiased': 52.271, 'best_test_valid/diff': 8.853, 'best_test_valid/acc_skew': 47.844, 'best_test_valid/acc_align': 56.698, 'best_test_test/acc': 56.765, 'best_test_test/acc_unbiased': 53.127, 'best_test_test/diff': 9.356, 'best_test_test/acc_skew': 48.449, 'best_test_test/acc_align': 57.805}
[7 / 20] Learning rate: 0.0001 weight: 0.01
[7 / 20] Loss: 3.0261959275703547 CE Loss: 0.4451935097347341 Con Loss: 3.02174399003584
[7 / 20] tensor([[0.974, 0.830],
        [0.175, 0.267]]) {'epoch': 7, 'valid/acc': 59.921, 'valid/acc_unbiased': 55.254, 'valid/diff': 12.205, 'valid/acc_skew': 49.152, 'valid/acc_align': 61.357, 'test/acc': 60.599, 'test/acc_unbiased': 56.128, 'test/diff': 11.771, 'test/acc_skew': 50.243, 'test/acc_align': 62.014}
[7 / 20] best valid accuracy: 55.254 at epoch 7 
 best_stats: {'best_valid_epoch': 7, 'best_valid_valid/acc': 59.921, 'best_valid_valid/acc_unbiased': 55.254, 'best_valid_valid/diff': 12.205, 'best_valid_valid/acc_skew': 49.152, 'best_valid_valid/acc_align': 61.357, 'best_valid_test/acc': 60.599, 'best_valid_test/acc_unbiased': 56.128, 'best_valid_test/diff': 11.771, 'best_valid_test/acc_skew': 50.243, 'best_valid_test/acc_align': 62.014}
[7 / 20] best test accuracy: 56.128 at epoch 7 
 best_stats: {'best_test_epoch': 7, 'best_test_valid/acc': 59.921, 'best_test_valid/acc_unbiased': 55.254, 'best_test_valid/diff': 12.205, 'best_test_valid/acc_skew': 49.152, 'best_test_valid/acc_align': 61.357, 'best_test_test/acc': 60.599, 'best_test_test/acc_unbiased': 56.128, 'best_test_test/diff': 11.771, 'best_test_test/acc_skew': 50.243, 'best_test_test/acc_align': 62.014}
[8 / 20] Learning rate: 0.0001 weight: 0.01
[8 / 20] Loss: 2.8042733818869827 CE Loss: 0.44000703071478553 Con Loss: 2.799873321646944
[8 / 20] tensor([[0.979, 0.909],
        [0.181, 0.236]]) {'epoch': 8, 'valid/acc': 59.921, 'valid/acc_unbiased': 54.925, 'valid/diff': 6.729, 'valid/acc_skew': 51.56, 'valid/acc_align': 58.289, 'test/acc': 61.481, 'test/acc_unbiased': 57.645, 'test/diff': 6.273, 'test/acc_skew': 54.509, 'test/acc_align': 60.781}
[8 / 20] best valid accuracy: 55.254 at epoch 7 
 best_stats: {'best_valid_epoch': 7, 'best_valid_valid/acc': 59.921, 'best_valid_valid/acc_unbiased': 55.254, 'best_valid_valid/diff': 12.205, 'best_valid_valid/acc_skew': 49.152, 'best_valid_valid/acc_align': 61.357, 'best_valid_test/acc': 60.599, 'best_valid_test/acc_unbiased': 56.128, 'best_valid_test/diff': 11.771, 'best_valid_test/acc_skew': 50.243, 'best_valid_test/acc_align': 62.014}
[8 / 20] best test accuracy: 57.645 at epoch 8 
 best_stats: {'best_test_epoch': 8, 'best_test_valid/acc': 59.921, 'best_test_valid/acc_unbiased': 54.925, 'best_test_valid/diff': 6.729, 'best_test_valid/acc_skew': 51.56, 'best_test_valid/acc_align': 58.289, 'best_test_test/acc': 61.481, 'best_test_test/acc_unbiased': 57.645, 'best_test_test/diff': 6.273, 'best_test_test/acc_skew': 54.509, 'best_test_test/acc_align': 60.781}
[9 / 20] Learning rate: 0.0001 weight: 0.01
[9 / 20] Loss: 2.5723179876014486 CE Loss: 0.4305543134214924 Con Loss: 2.568012437032997
[9 / 20] tensor([[0.960, 0.710],
        [0.403, 0.448]]) {'epoch': 9, 'valid/acc': 66.843, 'valid/acc_unbiased': 61.245, 'valid/diff': 10.676, 'valid/acc_skew': 55.907, 'valid/acc_align': 66.584, 'test/acc': 69.061, 'test/acc_unbiased': 63.042, 'test/diff': 14.807, 'test/acc_skew': 55.638, 'test/acc_align': 70.445}
[9 / 20] best valid accuracy: 61.245 at epoch 9 
 best_stats: {'best_valid_epoch': 9, 'best_valid_valid/acc': 66.843, 'best_valid_valid/acc_unbiased': 61.245, 'best_valid_valid/diff': 10.676, 'best_valid_valid/acc_skew': 55.907, 'best_valid_valid/acc_align': 66.584, 'best_valid_test/acc': 69.061, 'best_valid_test/acc_unbiased': 63.042, 'best_valid_test/diff': 14.807, 'best_valid_test/acc_skew': 55.638, 'best_valid_test/acc_align': 70.445}
[9 / 20] best test accuracy: 63.042 at epoch 9 
 best_stats: {'best_test_epoch': 9, 'best_test_valid/acc': 66.843, 'best_test_valid/acc_unbiased': 61.245, 'best_test_valid/diff': 10.676, 'best_test_valid/acc_skew': 55.907, 'best_test_valid/acc_align': 66.584, 'best_test_test/acc': 69.061, 'best_test_test/acc_unbiased': 63.042, 'best_test_test/diff': 14.807, 'best_test_test/acc_skew': 55.638, 'best_test_test/acc_align': 70.445}
[10 / 20] Learning rate: 0.0001 weight: 0.01
[10 / 20] Loss: 2.800296874926117 CE Loss: 0.42650646982329093 Con Loss: 2.796031822171537
[10 / 20] tensor([[0.969, 0.750],
        [0.356, 0.418]]) {'epoch': 10, 'valid/acc': 65.829, 'valid/acc_unbiased': 59.441, 'valid/diff': 11.78, 'valid/acc_skew': 55.09, 'valid/acc_align': 63.793, 'test/acc': 67.783, 'test/acc_unbiased': 62.337, 'test/diff': 14.034, 'test/acc_skew': 55.32, 'test/acc_align': 69.354}
[10 / 20] best valid accuracy: 61.245 at epoch 9 
 best_stats: {'best_valid_epoch': 9, 'best_valid_valid/acc': 66.843, 'best_valid_valid/acc_unbiased': 61.245, 'best_valid_valid/diff': 10.676, 'best_valid_valid/acc_skew': 55.907, 'best_valid_valid/acc_align': 66.584, 'best_valid_test/acc': 69.061, 'best_valid_test/acc_unbiased': 63.042, 'best_valid_test/diff': 14.807, 'best_valid_test/acc_skew': 55.638, 'best_valid_test/acc_align': 70.445}
[10 / 20] best test accuracy: 63.042 at epoch 9 
 best_stats: {'best_test_epoch': 9, 'best_test_valid/acc': 66.843, 'best_test_valid/acc_unbiased': 61.245, 'best_test_valid/diff': 10.676, 'best_test_valid/acc_skew': 55.907, 'best_test_valid/acc_align': 66.584, 'best_test_test/acc': 69.061, 'best_test_test/acc_unbiased': 63.042, 'best_test_test/diff': 14.807, 'best_test_test/acc_skew': 55.638, 'best_test_test/acc_align': 70.445}
[11 / 20] Learning rate: 0.0001 weight: 0.01
[11 / 20] Loss: 2.7704693550485113 CE Loss: 0.42738502622258284 Con Loss: 2.766195517140426
[11 / 20] tensor([[0.948, 0.739],
        [0.385, 0.430]]) {'epoch': 11, 'valid/acc': 64.727, 'valid/acc_unbiased': 57.926, 'valid/diff': 13.345, 'valid/acc_skew': 53.276, 'valid/acc_align': 62.575, 'test/acc': 67.915, 'test/acc_unbiased': 62.558, 'test/diff': 12.73, 'test/acc_skew': 56.194, 'test/acc_align': 68.923}
[11 / 20] best valid accuracy: 61.245 at epoch 9 
 best_stats: {'best_valid_epoch': 9, 'best_valid_valid/acc': 66.843, 'best_valid_valid/acc_unbiased': 61.245, 'best_valid_valid/diff': 10.676, 'best_valid_valid/acc_skew': 55.907, 'best_valid_valid/acc_align': 66.584, 'best_valid_test/acc': 69.061, 'best_valid_test/acc_unbiased': 63.042, 'best_valid_test/diff': 14.807, 'best_valid_test/acc_skew': 55.638, 'best_valid_test/acc_align': 70.445}
[11 / 20] best test accuracy: 63.042 at epoch 9 
 best_stats: {'best_test_epoch': 9, 'best_test_valid/acc': 66.843, 'best_test_valid/acc_unbiased': 61.245, 'best_test_valid/diff': 10.676, 'best_test_valid/acc_skew': 55.907, 'best_test_valid/acc_align': 66.584, 'best_test_test/acc': 69.061, 'best_test_test/acc_unbiased': 63.042, 'best_test_test/diff': 14.807, 'best_test_test/acc_skew': 55.638, 'best_test_test/acc_align': 70.445}
[12 / 20] Learning rate: 0.0001 weight: 0.01
[12 / 20] Loss: 2.5794163067163436 CE Loss: 0.42067805852486573 Con Loss: 2.575209524677677
[12 / 20] tensor([[0.970, 0.659],
        [0.428, 0.503]]) {'epoch': 12, 'valid/acc': 68.386, 'valid/acc_unbiased': 61.809, 'valid/diff': 13.174, 'valid/acc_skew': 56.505, 'valid/acc_align': 67.113, 'test/acc': 70.472, 'test/acc_unbiased': 63.997, 'test/diff': 19.293, 'test/acc_skew': 54.35, 'test/acc_align': 73.644}
[12 / 20] best valid accuracy: 61.809 at epoch 12 
 best_stats: {'best_valid_epoch': 12, 'best_valid_valid/acc': 68.386, 'best_valid_valid/acc_unbiased': 61.809, 'best_valid_valid/diff': 13.174, 'best_valid_valid/acc_skew': 56.505, 'best_valid_valid/acc_align': 67.113, 'best_valid_test/acc': 70.472, 'best_valid_test/acc_unbiased': 63.997, 'best_valid_test/diff': 19.293, 'best_valid_test/acc_skew': 54.35, 'best_valid_test/acc_align': 73.644}
[12 / 20] best test accuracy: 63.997 at epoch 12 
 best_stats: {'best_test_epoch': 12, 'best_test_valid/acc': 68.386, 'best_test_valid/acc_unbiased': 61.809, 'best_test_valid/diff': 13.174, 'best_test_valid/acc_skew': 56.505, 'best_test_valid/acc_align': 67.113, 'best_test_test/acc': 70.472, 'best_test_test/acc_unbiased': 63.997, 'best_test_test/diff': 19.293, 'best_test_test/acc_skew': 54.35, 'best_test_test/acc_align': 73.644}
[13 / 20] Learning rate: 0.0001 weight: 0.01
[13 / 20] Loss: 2.6066954238942155 CE Loss: 0.40348198210913594 Con Loss: 2.6026606132009587
[13 / 20] tensor([[0.957, 0.602],
        [0.514, 0.594]]) {'epoch': 13, 'valid/acc': 71.384, 'valid/acc_unbiased': 65.035, 'valid/diff': 17.142, 'valid/acc_skew': 56.464, 'valid/acc_align': 73.607, 'test/acc': 73.38, 'test/acc_unbiased': 66.682, 'test/diff': 21.695, 'test/acc_skew': 55.835, 'test/acc_align': 77.529}
[13 / 20] best valid accuracy: 65.035 at epoch 13 
 best_stats: {'best_valid_epoch': 13, 'best_valid_valid/acc': 71.384, 'best_valid_valid/acc_unbiased': 65.035, 'best_valid_valid/diff': 17.142, 'best_valid_valid/acc_skew': 56.464, 'best_valid_valid/acc_align': 73.607, 'best_valid_test/acc': 73.38, 'best_valid_test/acc_unbiased': 66.682, 'best_valid_test/diff': 21.695, 'best_valid_test/acc_skew': 55.835, 'best_valid_test/acc_align': 77.529}
[13 / 20] best test accuracy: 66.682 at epoch 13 
 best_stats: {'best_test_epoch': 13, 'best_test_valid/acc': 71.384, 'best_test_valid/acc_unbiased': 65.035, 'best_test_valid/diff': 17.142, 'best_test_valid/acc_skew': 56.464, 'best_test_valid/acc_align': 73.607, 'best_test_test/acc': 73.38, 'best_test_test/acc_unbiased': 66.682, 'best_test_test/diff': 21.695, 'best_test_test/acc_skew': 55.835, 'best_test_test/acc_align': 77.529}
[14 / 20] Learning rate: 1e-05 weight: 0.01
[14 / 20] Loss: 2.3018840726605494 CE Loss: 0.39465150191514137 Con Loss: 2.2979375545159515
[14 / 20] tensor([[0.965, 0.568],
        [0.480, 0.588]]) {'epoch': 14, 'valid/acc': 70.062, 'valid/acc_unbiased': 63.77, 'valid/diff': 14.315, 'valid/acc_skew': 56.613, 'valid/acc_align': 70.928, 'test/acc': 72.146, 'test/acc_unbiased': 65.025, 'test/diff': 25.25, 'test/acc_skew': 52.4, 'test/acc_align': 77.65}
[14 / 20] best valid accuracy: 65.035 at epoch 13 
 best_stats: {'best_valid_epoch': 13, 'best_valid_valid/acc': 71.384, 'best_valid_valid/acc_unbiased': 65.035, 'best_valid_valid/diff': 17.142, 'best_valid_valid/acc_skew': 56.464, 'best_valid_valid/acc_align': 73.607, 'best_valid_test/acc': 73.38, 'best_valid_test/acc_unbiased': 66.682, 'best_valid_test/diff': 21.695, 'best_valid_test/acc_skew': 55.835, 'best_valid_test/acc_align': 77.529}
[14 / 20] best test accuracy: 66.682 at epoch 13 
 best_stats: {'best_test_epoch': 13, 'best_test_valid/acc': 71.384, 'best_test_valid/acc_unbiased': 65.035, 'best_test_valid/diff': 17.142, 'best_test_valid/acc_skew': 56.464, 'best_test_valid/acc_align': 73.607, 'best_test_test/acc': 73.38, 'best_test_test/acc_unbiased': 66.682, 'best_test_test/diff': 21.695, 'best_test_test/acc_skew': 55.835, 'best_test_test/acc_align': 77.529}
[15 / 20] Learning rate: 1e-05 weight: 0.01
[15 / 20] Loss: 2.454509998412915 CE Loss: 0.38183724632321514 Con Loss: 2.450691616134177
[15 / 20] tensor([[0.965, 0.597],
        [0.473, 0.570]]) {'epoch': 15, 'valid/acc': 70.018, 'valid/acc_unbiased': 64.017, 'valid/diff': 15.403, 'valid/acc_skew': 56.316, 'valid/acc_align': 71.719, 'test/acc': 71.97, 'test/acc_unbiased': 65.108, 'test/diff': 23.267, 'test/acc_skew': 53.474, 'test/acc_align': 76.741}
[15 / 20] best valid accuracy: 65.035 at epoch 13 
 best_stats: {'best_valid_epoch': 13, 'best_valid_valid/acc': 71.384, 'best_valid_valid/acc_unbiased': 65.035, 'best_valid_valid/diff': 17.142, 'best_valid_valid/acc_skew': 56.464, 'best_valid_valid/acc_align': 73.607, 'best_valid_test/acc': 73.38, 'best_valid_test/acc_unbiased': 66.682, 'best_valid_test/diff': 21.695, 'best_valid_test/acc_skew': 55.835, 'best_valid_test/acc_align': 77.529}
[15 / 20] best test accuracy: 66.682 at epoch 13 
 best_stats: {'best_test_epoch': 13, 'best_test_valid/acc': 71.384, 'best_test_valid/acc_unbiased': 65.035, 'best_test_valid/diff': 17.142, 'best_test_valid/acc_skew': 56.464, 'best_test_valid/acc_align': 73.607, 'best_test_test/acc': 73.38, 'best_test_test/acc_unbiased': 66.682, 'best_test_test/diff': 21.695, 'best_test_test/acc_skew': 55.835, 'best_test_test/acc_align': 77.529}
[16 / 20] Learning rate: 1e-05 weight: 0.01
[16 / 20] Loss: 2.2745633552076865 CE Loss: 0.3790459721460255 Con Loss: 2.270772893178475
[16 / 20] tensor([[0.966, 0.551],
        [0.468, 0.582]]) {'epoch': 16, 'valid/acc': 70.018, 'valid/acc_unbiased': 63.986, 'valid/diff': 18.931, 'valid/acc_skew': 54.521, 'valid/acc_align': 73.451, 'test/acc': 71.573, 'test/acc_unbiased': 64.183, 'test/diff': 26.424, 'test/acc_skew': 50.971, 'test/acc_align': 77.394}
[16 / 20] best valid accuracy: 65.035 at epoch 13 
 best_stats: {'best_valid_epoch': 13, 'best_valid_valid/acc': 71.384, 'best_valid_valid/acc_unbiased': 65.035, 'best_valid_valid/diff': 17.142, 'best_valid_valid/acc_skew': 56.464, 'best_valid_valid/acc_align': 73.607, 'best_valid_test/acc': 73.38, 'best_valid_test/acc_unbiased': 66.682, 'best_valid_test/diff': 21.695, 'best_valid_test/acc_skew': 55.835, 'best_valid_test/acc_align': 77.529}
[16 / 20] best test accuracy: 66.682 at epoch 13 
 best_stats: {'best_test_epoch': 13, 'best_test_valid/acc': 71.384, 'best_test_valid/acc_unbiased': 65.035, 'best_test_valid/diff': 17.142, 'best_test_valid/acc_skew': 56.464, 'best_test_valid/acc_align': 73.607, 'best_test_test/acc': 73.38, 'best_test_test/acc_unbiased': 66.682, 'best_test_test/diff': 21.695, 'best_test_test/acc_skew': 55.835, 'best_test_test/acc_align': 77.529}
[17 / 20] Learning rate: 1e-05 weight: 0.01
[17 / 20] Loss: 2.266167434202422 CE Loss: 0.3687936914562571 Con Loss: 2.262479501494817
[17 / 20] tensor([[0.966, 0.557],
        [0.459, 0.582]]) {'epoch': 17, 'valid/acc': 69.929, 'valid/acc_unbiased': 64.296, 'valid/diff': 19.989, 'valid/acc_skew': 54.302, 'valid/acc_align': 74.291, 'test/acc': 71.265, 'test/acc_unbiased': 64.094, 'test/diff': 26.601, 'test/acc_skew': 50.794, 'test/acc_align': 77.394}
[17 / 20] best valid accuracy: 65.035 at epoch 13 
 best_stats: {'best_valid_epoch': 13, 'best_valid_valid/acc': 71.384, 'best_valid_valid/acc_unbiased': 65.035, 'best_valid_valid/diff': 17.142, 'best_valid_valid/acc_skew': 56.464, 'best_valid_valid/acc_align': 73.607, 'best_valid_test/acc': 73.38, 'best_valid_test/acc_unbiased': 66.682, 'best_valid_test/diff': 21.695, 'best_valid_test/acc_skew': 55.835, 'best_valid_test/acc_align': 77.529}
[17 / 20] best test accuracy: 66.682 at epoch 13 
 best_stats: {'best_test_epoch': 13, 'best_test_valid/acc': 71.384, 'best_test_valid/acc_unbiased': 65.035, 'best_test_valid/diff': 17.142, 'best_test_valid/acc_skew': 56.464, 'best_test_valid/acc_align': 73.607, 'best_test_test/acc': 73.38, 'best_test_test/acc_unbiased': 66.682, 'best_test_test/diff': 21.695, 'best_test_test/acc_skew': 55.835, 'best_test_test/acc_align': 77.529}
[18 / 20] Learning rate: 1e-05 weight: 0.01
[18 / 20] Loss: 2.3677210670727837 CE Loss: 0.3607286233967597 Con Loss: 2.364113772097713
[18 / 20] tensor([[0.966, 0.557],
        [0.460, 0.576]]) {'epoch': 18, 'valid/acc': 69.665, 'valid/acc_unbiased': 63.843, 'valid/diff': 20.109, 'valid/acc_skew': 53.789, 'valid/acc_align': 73.898, 'test/acc': 71.265, 'test/acc_unbiased': 63.971, 'test/diff': 26.24, 'test/acc_skew': 50.851, 'test/acc_align': 77.091}
[18 / 20] best valid accuracy: 65.035 at epoch 13 
 best_stats: {'best_valid_epoch': 13, 'best_valid_valid/acc': 71.384, 'best_valid_valid/acc_unbiased': 65.035, 'best_valid_valid/diff': 17.142, 'best_valid_valid/acc_skew': 56.464, 'best_valid_valid/acc_align': 73.607, 'best_valid_test/acc': 73.38, 'best_valid_test/acc_unbiased': 66.682, 'best_valid_test/diff': 21.695, 'best_valid_test/acc_skew': 55.835, 'best_valid_test/acc_align': 77.529}
[18 / 20] best test accuracy: 66.682 at epoch 13 
 best_stats: {'best_test_epoch': 13, 'best_test_valid/acc': 71.384, 'best_test_valid/acc_unbiased': 65.035, 'best_test_valid/diff': 17.142, 'best_test_valid/acc_skew': 56.464, 'best_test_valid/acc_align': 73.607, 'best_test_test/acc': 73.38, 'best_test_test/acc_unbiased': 66.682, 'best_test_test/diff': 21.695, 'best_test_test/acc_skew': 55.835, 'best_test_test/acc_align': 77.529}
[19 / 20] Learning rate: 1e-05 weight: 0.01
[19 / 20] Loss: 2.3729889868839313 CE Loss: 0.356526978045064 Con Loss: 2.369423720523123
[19 / 20] tensor([[0.963, 0.545],
        [0.494, 0.588]]) {'epoch': 19, 'valid/acc': 70.37, 'valid/acc_unbiased': 64.517, 'valid/diff': 21.248, 'valid/acc_skew': 53.893, 'valid/acc_align': 75.14, 'test/acc': 72.411, 'test/acc_unbiased': 64.756, 'test/diff': 25.601, 'test/acc_skew': 51.956, 'test/acc_align': 77.556}
[19 / 20] best valid accuracy: 65.035 at epoch 13 
 best_stats: {'best_valid_epoch': 13, 'best_valid_valid/acc': 71.384, 'best_valid_valid/acc_unbiased': 65.035, 'best_valid_valid/diff': 17.142, 'best_valid_valid/acc_skew': 56.464, 'best_valid_valid/acc_align': 73.607, 'best_valid_test/acc': 73.38, 'best_valid_test/acc_unbiased': 66.682, 'best_valid_test/diff': 21.695, 'best_valid_test/acc_skew': 55.835, 'best_valid_test/acc_align': 77.529}
[19 / 20] best test accuracy: 66.682 at epoch 13 
 best_stats: {'best_test_epoch': 13, 'best_test_valid/acc': 71.384, 'best_test_valid/acc_unbiased': 65.035, 'best_test_valid/diff': 17.142, 'best_test_valid/acc_skew': 56.464, 'best_test_valid/acc_align': 73.607, 'best_test_test/acc': 73.38, 'best_test_test/acc_unbiased': 66.682, 'best_test_test/diff': 21.695, 'best_test_test/acc_skew': 55.835, 'best_test_test/acc_align': 77.529}
[20 / 20] Learning rate: 1e-05 weight: 0.01
[20 / 20] Loss: 2.5894672780712567 CE Loss: 0.3655321064102297 Con Loss: 2.5858119601260388
[20 / 20] tensor([[0.962, 0.551],
        [0.489, 0.606]]) {'epoch': 20, 'valid/acc': 70.238, 'valid/acc_unbiased': 63.92, 'valid/diff': 23.131, 'valid/acc_skew': 52.354, 'valid/acc_align': 75.485, 'test/acc': 72.367, 'test/acc_unbiased': 65.213, 'test/diff': 26.409, 'test/acc_skew': 52.009, 'test/acc_align': 78.418}
[20 / 20] best valid accuracy: 65.035 at epoch 13 
 best_stats: {'best_valid_epoch': 13, 'best_valid_valid/acc': 71.384, 'best_valid_valid/acc_unbiased': 65.035, 'best_valid_valid/diff': 17.142, 'best_valid_valid/acc_skew': 56.464, 'best_valid_valid/acc_align': 73.607, 'best_valid_test/acc': 73.38, 'best_valid_test/acc_unbiased': 66.682, 'best_valid_test/diff': 21.695, 'best_valid_test/acc_skew': 55.835, 'best_valid_test/acc_align': 77.529}
[20 / 20] best test accuracy: 66.682 at epoch 13 
 best_stats: {'best_test_epoch': 13, 'best_test_valid/acc': 71.384, 'best_test_valid/acc_unbiased': 65.035, 'best_test_valid/diff': 17.142, 'best_test_valid/acc_skew': 56.464, 'best_test_valid/acc_align': 73.607, 'best_test_test/acc': 73.38, 'best_test_test/acc_unbiased': 66.682, 'best_test_test/diff': 21.695, 'best_test_test/acc_skew': 55.835, 'best_test_test/acc_align': 77.529}
Total training time: 0:47:10
