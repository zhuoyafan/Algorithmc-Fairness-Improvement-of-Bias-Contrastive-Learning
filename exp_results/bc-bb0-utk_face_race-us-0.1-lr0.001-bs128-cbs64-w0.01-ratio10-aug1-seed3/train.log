Log level set to: INFO
Set seed: 3
=======> Using Fixed Random Seed: 3 <========
save_path: exp_results/bc-bb0-utk_face_race-us-0.1-lr0.001-bs128-cbs64-w0.01-ratio10-aug1-seed3
get_utk_face - split: train, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_race-0.1
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [4407, 4976]
Target 1: [3755, 5529]
Binary Target 1
---------------------------
Target 0: [4407, 4976]
Target 1: [3755, 5529]
===================================
Normal Label Distribution: 
Target 0: [4407, 4976]
Target 1: [3755, 5529]
===================================
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [3755, 3755]
Target 1: [3755, 3755]
Binary Target 1
---------------------------
Target 0: [3755, 3755]
Target 1: [3755, 3755]
===================================
Normal Label Distribution: 
Target 0: [3755, 3755]
Target 1: [3755, 3755]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 15020, target_attr: gender, bias_attr: race bias_rate: 0.1
['[train] target_0-bias_0: 3755', '[train] target_0-bias_1: 3755', '[train] target_1-bias_0: 3755', '[train] target_1-bias_1: 3755']
confusion_matrix - 
 original: tensor([[3755., 3755.],
        [3755., 3755.]]), 
 normalized: tensor([[0.500, 0.500],
        [0.500, 0.500]]), 
 b|y: tensor([[0.500, 0.500],
        [0.500, 0.500]])
get_utk_face - split: train, aug: 1, given_y: True, ratio: 10
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_race-0.1
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [4407, 4976]
Target 1: [3755, 5529]
Binary Target 1
---------------------------
Target 0: [4407, 4976]
Target 1: [3755, 5529]
===================================
Normal Label Distribution: 
Target 0: [4407, 4976]
Target 1: [3755, 5529]
===================================
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [3755, 3755]
Target 1: [3755, 3755]
Binary Target 1
---------------------------
Target 0: [3755, 3755]
Target 1: [3755, 3755]
===================================
Normal Label Distribution: 
Target 0: [3755, 3755]
Target 1: [3755, 3755]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 15020, target_attr: gender, bias_attr: race bias_rate: 0.1
['[train] target_0-bias_0: 3755', '[train] target_0-bias_1: 3755', '[train] target_1-bias_0: 3755', '[train] target_1-bias_1: 3755']
get_utk_face - split: valid, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_race-0.1
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [583, 684]
Target 1: [457, 646]
Binary Target 1
---------------------------
Target 0: [583, 684]
Target 1: [457, 646]
===================================
Normal Label Distribution: 
Target 0: [583, 684]
Target 1: [457, 646]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 2370, target_attr: gender, bias_attr: race bias_rate: 0.1
['[valid] target_0-bias_0: 583', '[valid] target_0-bias_1: 684', '[valid] target_1-bias_0: 457', '[valid] target_1-bias_1: 646']
get_utk_face - split: test, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_race-0.1
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [558, 677]
Target 1: [462, 673]
Binary Target 1
---------------------------
Target 0: [558, 677]
Target 1: [462, 673]
===================================
Normal Label Distribution: 
Target 0: [558, 677]
Target 1: [462, 673]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 2370, target_attr: gender, bias_attr: race bias_rate: 0.1
['[test] target_0-bias_0: 558', '[test] target_0-bias_1: 677', '[test] target_1-bias_0: 462', '[test] target_1-bias_1: 673']
decay_epochs: [6, 13]
[1 / 20] Learning rate: 0.001 weight: 0.01
[1 / 20] Loss: 4.86343734591366 CE Loss: 0.5627167193772155 Con Loss: 4.857810188069959
[1 / 20] tensor([[0.577, 0.588],
        [0.944, 0.927]]) {'epoch': 1, 'valid/acc': 74.641, 'valid/acc_unbiased': 75.886, 'valid/diff': 7.08, 'valid/acc_skew': 74.898, 'valid/acc_align': 76.875, 'test/acc': 75.105, 'test/acc_unbiased': 75.897, 'test/diff': 1.368, 'test/acc_skew': 76.039, 'test/acc_align': 75.754}
[1 / 20] best valid accuracy: 75.886 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 74.641, 'best_valid_valid/acc_unbiased': 75.886, 'best_valid_valid/diff': 7.08, 'best_valid_valid/acc_skew': 74.898, 'best_valid_valid/acc_align': 76.875, 'best_valid_test/acc': 75.105, 'best_valid_test/acc_unbiased': 75.897, 'best_valid_test/diff': 1.368, 'best_valid_test/acc_skew': 76.039, 'best_valid_test/acc_align': 75.754}
[1 / 20] best test accuracy: 75.897 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 74.641, 'best_test_valid/acc_unbiased': 75.886, 'best_test_valid/diff': 7.08, 'best_test_valid/acc_skew': 74.898, 'best_test_valid/acc_align': 76.875, 'best_test_test/acc': 75.105, 'best_test_test/acc_unbiased': 75.897, 'best_test_test/diff': 1.368, 'best_test_test/acc_skew': 76.039, 'best_test_test/acc_align': 75.754}
[2 / 20] Learning rate: 0.001 weight: 0.01
[2 / 20] Loss: 4.758027314187366 CE Loss: 0.455019872094915 Con Loss: 4.753477116113655
[2 / 20] tensor([[0.873, 0.843],
        [0.773, 0.810]]) {'epoch': 2, 'valid/acc': 83.376, 'valid/acc_unbiased': 83.31, 'valid/diff': 2.353, 'valid/acc_skew': 84.487, 'valid/acc_align': 82.134, 'test/acc': 82.7, 'test/acc_unbiased': 82.468, 'test/diff': 3.321, 'test/acc_skew': 82.274, 'test/acc_align': 82.662}
[2 / 20] best valid accuracy: 83.310 at epoch 2 
 best_stats: {'best_valid_epoch': 2, 'best_valid_valid/acc': 83.376, 'best_valid_valid/acc_unbiased': 83.31, 'best_valid_valid/diff': 2.353, 'best_valid_valid/acc_skew': 84.487, 'best_valid_valid/acc_align': 82.134, 'best_valid_test/acc': 82.7, 'best_valid_test/acc_unbiased': 82.468, 'best_valid_test/diff': 3.321, 'best_valid_test/acc_skew': 82.274, 'best_valid_test/acc_align': 82.662}
[2 / 20] best test accuracy: 82.468 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 83.376, 'best_test_valid/acc_unbiased': 83.31, 'best_test_valid/diff': 2.353, 'best_test_valid/acc_skew': 84.487, 'best_test_valid/acc_align': 82.134, 'best_test_test/acc': 82.7, 'best_test_test/acc_unbiased': 82.468, 'best_test_test/diff': 3.321, 'best_test_test/acc_skew': 82.274, 'best_test_test/acc_align': 82.662}
[3 / 20] Learning rate: 0.001 weight: 0.01
[3 / 20] Loss: 4.730326666749429 CE Loss: 0.4264576162304605 Con Loss: 4.726062081815717
[3 / 20] tensor([[0.835, 0.826],
        [0.848, 0.853]]) {'epoch': 3, 'valid/acc': 83.966, 'valid/acc_unbiased': 84.238, 'valid/diff': 3.986, 'valid/acc_skew': 86.231, 'valid/acc_align': 82.245, 'test/acc': 84.008, 'test/acc_unbiased': 84.055, 'test/diff': 0.692, 'test/acc_skew': 84.181, 'test/acc_align': 83.93}
[3 / 20] best valid accuracy: 84.238 at epoch 3 
 best_stats: {'best_valid_epoch': 3, 'best_valid_valid/acc': 83.966, 'best_valid_valid/acc_unbiased': 84.238, 'best_valid_valid/diff': 3.986, 'best_valid_valid/acc_skew': 86.231, 'best_valid_valid/acc_align': 82.245, 'best_valid_test/acc': 84.008, 'best_valid_test/acc_unbiased': 84.055, 'best_valid_test/diff': 0.692, 'best_valid_test/acc_skew': 84.181, 'best_valid_test/acc_align': 83.93}
[3 / 20] best test accuracy: 84.055 at epoch 3 
 best_stats: {'best_test_epoch': 3, 'best_test_valid/acc': 83.966, 'best_test_valid/acc_unbiased': 84.238, 'best_test_valid/diff': 3.986, 'best_test_valid/acc_skew': 86.231, 'best_test_valid/acc_align': 82.245, 'best_test_test/acc': 84.008, 'best_test_test/acc_unbiased': 84.055, 'best_test_test/diff': 0.692, 'best_test_test/acc_skew': 84.181, 'best_test_test/acc_align': 83.93}
[4 / 20] Learning rate: 0.001 weight: 0.01
[4 / 20] Loss: 4.725916691562942 CE Loss: 0.42276221756611304 Con Loss: 4.721689089382695
[4 / 20] tensor([[0.925, 0.914],
        [0.736, 0.749]]) {'epoch': 4, 'valid/acc': 84.852, 'valid/acc_unbiased': 84.493, 'valid/diff': 3.223, 'valid/acc_skew': 86.105, 'valid/acc_align': 82.882, 'test/acc': 83.502, 'test/acc_unbiased': 83.097, 'test/diff': 1.168, 'test/acc_skew': 83.033, 'test/acc_align': 83.161}
[4 / 20] best valid accuracy: 84.493 at epoch 4 
 best_stats: {'best_valid_epoch': 4, 'best_valid_valid/acc': 84.852, 'best_valid_valid/acc_unbiased': 84.493, 'best_valid_valid/diff': 3.223, 'best_valid_valid/acc_skew': 86.105, 'best_valid_valid/acc_align': 82.882, 'best_valid_test/acc': 83.502, 'best_valid_test/acc_unbiased': 83.097, 'best_valid_test/diff': 1.168, 'best_valid_test/acc_skew': 83.033, 'best_valid_test/acc_align': 83.161}
[4 / 20] best test accuracy: 84.055 at epoch 3 
 best_stats: {'best_test_epoch': 3, 'best_test_valid/acc': 83.966, 'best_test_valid/acc_unbiased': 84.238, 'best_test_valid/diff': 3.986, 'best_test_valid/acc_skew': 86.231, 'best_test_valid/acc_align': 82.245, 'best_test_test/acc': 84.008, 'best_test_test/acc_unbiased': 84.055, 'best_test_test/diff': 0.692, 'best_test_test/acc_skew': 84.181, 'best_test_test/acc_align': 83.93}
[5 / 20] Learning rate: 0.001 weight: 0.01
[5 / 20] Loss: 4.70327467061232 CE Loss: 0.399781408703597 Con Loss: 4.699276857845952
[5 / 20] tensor([[0.719, 0.677],
        [0.939, 0.954]]) {'epoch': 5, 'valid/acc': 81.814, 'valid/acc_unbiased': 82.787, 'valid/diff': 1.612, 'valid/acc_skew': 83.436, 'valid/acc_align': 82.138, 'test/acc': 81.646, 'test/acc_unbiased': 82.212, 'test/diff': 2.833, 'test/acc_skew': 82.902, 'test/acc_align': 81.523}
[5 / 20] best valid accuracy: 84.493 at epoch 4 
 best_stats: {'best_valid_epoch': 4, 'best_valid_valid/acc': 84.852, 'best_valid_valid/acc_unbiased': 84.493, 'best_valid_valid/diff': 3.223, 'best_valid_valid/acc_skew': 86.105, 'best_valid_valid/acc_align': 82.882, 'best_valid_test/acc': 83.502, 'best_valid_test/acc_unbiased': 83.097, 'best_valid_test/diff': 1.168, 'best_valid_test/acc_skew': 83.033, 'best_valid_test/acc_align': 83.161}
[5 / 20] best test accuracy: 84.055 at epoch 3 
 best_stats: {'best_test_epoch': 3, 'best_test_valid/acc': 83.966, 'best_test_valid/acc_unbiased': 84.238, 'best_test_valid/diff': 3.986, 'best_test_valid/acc_skew': 86.231, 'best_test_valid/acc_align': 82.245, 'best_test_test/acc': 84.008, 'best_test_test/acc_unbiased': 84.055, 'best_test_test/diff': 0.692, 'best_test_test/acc_skew': 84.181, 'best_test_test/acc_align': 83.93}
[6 / 20] Learning rate: 0.001 weight: 0.01
[6 / 20] Loss: 4.6985832837862915 CE Loss: 0.38898720527774644 Con Loss: 4.694693426190616
[6 / 20] tensor([[0.952, 0.947],
        [0.671, 0.698]]) {'epoch': 6, 'valid/acc': 82.574, 'valid/acc_unbiased': 81.847, 'valid/diff': 3.382, 'valid/acc_skew': 83.538, 'valid/acc_align': 80.156, 'test/acc': 82.363, 'test/acc_unbiased': 81.695, 'test/diff': 1.608, 'test/acc_skew': 81.13, 'test/acc_align': 82.259}
[6 / 20] best valid accuracy: 84.493 at epoch 4 
 best_stats: {'best_valid_epoch': 4, 'best_valid_valid/acc': 84.852, 'best_valid_valid/acc_unbiased': 84.493, 'best_valid_valid/diff': 3.223, 'best_valid_valid/acc_skew': 86.105, 'best_valid_valid/acc_align': 82.882, 'best_valid_test/acc': 83.502, 'best_valid_test/acc_unbiased': 83.097, 'best_valid_test/diff': 1.168, 'best_valid_test/acc_skew': 83.033, 'best_valid_test/acc_align': 83.161}
[6 / 20] best test accuracy: 84.055 at epoch 3 
 best_stats: {'best_test_epoch': 3, 'best_test_valid/acc': 83.966, 'best_test_valid/acc_unbiased': 84.238, 'best_test_valid/diff': 3.986, 'best_test_valid/acc_skew': 86.231, 'best_test_valid/acc_align': 82.245, 'best_test_test/acc': 84.008, 'best_test_test/acc_unbiased': 84.055, 'best_test_test/diff': 0.692, 'best_test_test/acc_skew': 84.181, 'best_test_test/acc_align': 83.93}
[7 / 20] Learning rate: 0.0001 weight: 0.01
[7 / 20] Loss: 4.664393095836817 CE Loss: 0.3617165663509013 Con Loss: 4.660775934110151
[7 / 20] tensor([[0.837, 0.808],
        [0.898, 0.915]]) {'epoch': 7, 'valid/acc': 86.624, 'valid/acc_unbiased': 86.943, 'valid/diff': 2.515, 'valid/acc_skew': 88.201, 'valid/acc_align': 85.685, 'test/acc': 86.287, 'test/acc_unbiased': 86.462, 'test/diff': 2.299, 'test/acc_skew': 86.759, 'test/acc_align': 86.164}
[7 / 20] best valid accuracy: 86.943 at epoch 7 
 best_stats: {'best_valid_epoch': 7, 'best_valid_valid/acc': 86.624, 'best_valid_valid/acc_unbiased': 86.943, 'best_valid_valid/diff': 2.515, 'best_valid_valid/acc_skew': 88.201, 'best_valid_valid/acc_align': 85.685, 'best_valid_test/acc': 86.287, 'best_valid_test/acc_unbiased': 86.462, 'best_valid_test/diff': 2.299, 'best_valid_test/acc_skew': 86.759, 'best_valid_test/acc_align': 86.164}
[7 / 20] best test accuracy: 86.462 at epoch 7 
 best_stats: {'best_test_epoch': 7, 'best_test_valid/acc': 86.624, 'best_test_valid/acc_unbiased': 86.943, 'best_test_valid/diff': 2.515, 'best_test_valid/acc_skew': 88.201, 'best_test_valid/acc_align': 85.685, 'best_test_test/acc': 86.287, 'best_test_test/acc_unbiased': 86.462, 'best_test_test/diff': 2.299, 'best_test_test/acc_skew': 86.759, 'best_test_test/acc_align': 86.164}
[8 / 20] Learning rate: 0.0001 weight: 0.01
[8 / 20] Loss: 4.637668556665454 CE Loss: 0.33901406597202216 Con Loss: 4.634278431522862
[8 / 20] tensor([[0.857, 0.842],
        [0.874, 0.896]]) {'epoch': 8, 'valid/acc': 87.089, 'valid/acc_unbiased': 87.216, 'valid/diff': 1.324, 'valid/acc_skew': 87.878, 'valid/acc_align': 86.554, 'test/acc': 86.709, 'test/acc_unbiased': 86.726, 'test/diff': 1.811, 'test/acc_skew': 86.554, 'test/acc_align': 86.897}
[8 / 20] best valid accuracy: 87.216 at epoch 8 
 best_stats: {'best_valid_epoch': 8, 'best_valid_valid/acc': 87.089, 'best_valid_valid/acc_unbiased': 87.216, 'best_valid_valid/diff': 1.324, 'best_valid_valid/acc_skew': 87.878, 'best_valid_valid/acc_align': 86.554, 'best_valid_test/acc': 86.709, 'best_valid_test/acc_unbiased': 86.726, 'best_valid_test/diff': 1.811, 'best_valid_test/acc_skew': 86.554, 'best_valid_test/acc_align': 86.897}
[8 / 20] best test accuracy: 86.726 at epoch 8 
 best_stats: {'best_test_epoch': 8, 'best_test_valid/acc': 87.089, 'best_test_valid/acc_unbiased': 87.216, 'best_test_valid/diff': 1.324, 'best_test_valid/acc_skew': 87.878, 'best_test_valid/acc_align': 86.554, 'best_test_test/acc': 86.709, 'best_test_test/acc_unbiased': 86.726, 'best_test_test/diff': 1.811, 'best_test_test/acc_skew': 86.554, 'best_test_test/acc_align': 86.897}
[9 / 20] Learning rate: 0.0001 weight: 0.01
[9 / 20] Loss: 4.639320803133054 CE Loss: 0.32249465629200486 Con Loss: 4.636095830381472
[9 / 20] tensor([[0.862, 0.867],
        [0.877, 0.883]]) {'epoch': 9, 'valid/acc': 87.384, 'valid/acc_unbiased': 87.542, 'valid/diff': 2.14, 'valid/acc_skew': 88.612, 'valid/acc_align': 86.472, 'test/acc': 87.215, 'test/acc_unbiased': 87.208, 'test/diff': 0.552, 'test/acc_skew': 86.932, 'test/acc_align': 87.484}
[9 / 20] best valid accuracy: 87.542 at epoch 9 
 best_stats: {'best_valid_epoch': 9, 'best_valid_valid/acc': 87.384, 'best_valid_valid/acc_unbiased': 87.542, 'best_valid_valid/diff': 2.14, 'best_valid_valid/acc_skew': 88.612, 'best_valid_valid/acc_align': 86.472, 'best_valid_test/acc': 87.215, 'best_valid_test/acc_unbiased': 87.208, 'best_valid_test/diff': 0.552, 'best_valid_test/acc_skew': 86.932, 'best_valid_test/acc_align': 87.484}
[9 / 20] best test accuracy: 87.208 at epoch 9 
 best_stats: {'best_test_epoch': 9, 'best_test_valid/acc': 87.384, 'best_test_valid/acc_unbiased': 87.542, 'best_test_valid/diff': 2.14, 'best_test_valid/acc_skew': 88.612, 'best_test_valid/acc_align': 86.472, 'best_test_test/acc': 87.215, 'best_test_test/acc_unbiased': 87.208, 'best_test_test/diff': 0.552, 'best_test_test/acc_skew': 86.932, 'best_test_test/acc_align': 87.484}
[10 / 20] Learning rate: 0.0001 weight: 0.01
[10 / 20] Loss: 4.627730036353303 CE Loss: 0.3257377742927338 Con Loss: 4.624472629912843
[10 / 20] tensor([[0.876, 0.876],
        [0.870, 0.881]]) {'epoch': 10, 'valid/acc': 87.806, 'valid/acc_unbiased': 87.861, 'valid/diff': 1.187, 'valid/acc_skew': 88.455, 'valid/acc_align': 87.268, 'test/acc': 87.637, 'test/acc_unbiased': 87.588, 'test/diff': 0.571, 'test/acc_skew': 87.324, 'test/acc_align': 87.853}
[10 / 20] best valid accuracy: 87.861 at epoch 10 
 best_stats: {'best_valid_epoch': 10, 'best_valid_valid/acc': 87.806, 'best_valid_valid/acc_unbiased': 87.861, 'best_valid_valid/diff': 1.187, 'best_valid_valid/acc_skew': 88.455, 'best_valid_valid/acc_align': 87.268, 'best_valid_test/acc': 87.637, 'best_valid_test/acc_unbiased': 87.588, 'best_valid_test/diff': 0.571, 'best_valid_test/acc_skew': 87.324, 'best_valid_test/acc_align': 87.853}
[10 / 20] best test accuracy: 87.588 at epoch 10 
 best_stats: {'best_test_epoch': 10, 'best_test_valid/acc': 87.806, 'best_test_valid/acc_unbiased': 87.861, 'best_test_valid/diff': 1.187, 'best_test_valid/acc_skew': 88.455, 'best_test_valid/acc_align': 87.268, 'best_test_test/acc': 87.637, 'best_test_test/acc_unbiased': 87.588, 'best_test_test/diff': 0.571, 'best_test_test/acc_skew': 87.324, 'best_test_test/acc_align': 87.853}
[11 / 20] Learning rate: 0.0001 weight: 0.01
[11 / 20] Loss: 4.6083775191427705 CE Loss: 0.32046356736899373 Con Loss: 4.605172881114975
[11 / 20] tensor([[0.873, 0.870],
        [0.881, 0.899]]) {'epoch': 11, 'valid/acc': 88.101, 'valid/acc_unbiased': 88.243, 'valid/diff': 1.442, 'valid/acc_skew': 88.964, 'valid/acc_align': 87.521, 'test/acc': 88.101, 'test/acc_unbiased': 88.067, 'test/diff': 1.038, 'test/acc_skew': 87.686, 'test/acc_align': 88.449}
[11 / 20] best valid accuracy: 88.243 at epoch 11 
 best_stats: {'best_valid_epoch': 11, 'best_valid_valid/acc': 88.101, 'best_valid_valid/acc_unbiased': 88.243, 'best_valid_valid/diff': 1.442, 'best_valid_valid/acc_skew': 88.964, 'best_valid_valid/acc_align': 87.521, 'best_valid_test/acc': 88.101, 'best_valid_test/acc_unbiased': 88.067, 'best_valid_test/diff': 1.038, 'best_valid_test/acc_skew': 87.686, 'best_valid_test/acc_align': 88.449}
[11 / 20] best test accuracy: 88.067 at epoch 11 
 best_stats: {'best_test_epoch': 11, 'best_test_valid/acc': 88.101, 'best_test_valid/acc_unbiased': 88.243, 'best_test_valid/diff': 1.442, 'best_test_valid/acc_skew': 88.964, 'best_test_valid/acc_align': 87.521, 'best_test_test/acc': 88.101, 'best_test_test/acc_unbiased': 88.067, 'best_test_test/diff': 1.038, 'best_test_test/acc_skew': 87.686, 'best_test_test/acc_align': 88.449}
[12 / 20] Learning rate: 0.0001 weight: 0.01
[12 / 20] Loss: 4.617487735214945 CE Loss: 0.31149209011569323 Con Loss: 4.614372799971132
[12 / 20] tensor([[0.869, 0.857],
        [0.896, 0.908]]) {'epoch': 12, 'valid/acc': 88.397, 'valid/acc_unbiased': 88.57, 'valid/diff': 1.1, 'valid/acc_skew': 89.12, 'valid/acc_align': 88.02, 'test/acc': 88.186, 'test/acc_unbiased': 88.247, 'test/diff': 1.211, 'test/acc_skew': 88.264, 'test/acc_align': 88.23}
[12 / 20] best valid accuracy: 88.570 at epoch 12 
 best_stats: {'best_valid_epoch': 12, 'best_valid_valid/acc': 88.397, 'best_valid_valid/acc_unbiased': 88.57, 'best_valid_valid/diff': 1.1, 'best_valid_valid/acc_skew': 89.12, 'best_valid_valid/acc_align': 88.02, 'best_valid_test/acc': 88.186, 'best_valid_test/acc_unbiased': 88.247, 'best_valid_test/diff': 1.211, 'best_valid_test/acc_skew': 88.264, 'best_valid_test/acc_align': 88.23}
[12 / 20] best test accuracy: 88.247 at epoch 12 
 best_stats: {'best_test_epoch': 12, 'best_test_valid/acc': 88.397, 'best_test_valid/acc_unbiased': 88.57, 'best_test_valid/diff': 1.1, 'best_test_valid/acc_skew': 89.12, 'best_test_valid/acc_align': 88.02, 'best_test_test/acc': 88.186, 'best_test_test/acc_unbiased': 88.247, 'best_test_test/diff': 1.211, 'best_test_test/acc_skew': 88.264, 'best_test_test/acc_align': 88.23}
[13 / 20] Learning rate: 0.0001 weight: 0.01
[13 / 20] Loss: 4.612206875436633 CE Loss: 0.3082828509505992 Con Loss: 4.609124048667328
[13 / 20] tensor([[0.860, 0.852],
        [0.890, 0.902]]) {'epoch': 13, 'valid/acc': 88.65, 'valid/acc_unbiased': 88.869, 'valid/diff': 1.939, 'valid/acc_skew': 89.839, 'valid/acc_align': 87.9, 'test/acc': 87.553, 'test/acc_unbiased': 87.601, 'test/diff': 1.012, 'test/acc_skew': 87.491, 'test/acc_align': 87.711}
[13 / 20] best valid accuracy: 88.869 at epoch 13 
 best_stats: {'best_valid_epoch': 13, 'best_valid_valid/acc': 88.65, 'best_valid_valid/acc_unbiased': 88.869, 'best_valid_valid/diff': 1.939, 'best_valid_valid/acc_skew': 89.839, 'best_valid_valid/acc_align': 87.9, 'best_valid_test/acc': 87.553, 'best_valid_test/acc_unbiased': 87.601, 'best_valid_test/diff': 1.012, 'best_valid_test/acc_skew': 87.491, 'best_valid_test/acc_align': 87.711}
[13 / 20] best test accuracy: 88.247 at epoch 12 
 best_stats: {'best_test_epoch': 12, 'best_test_valid/acc': 88.397, 'best_test_valid/acc_unbiased': 88.57, 'best_test_valid/diff': 1.1, 'best_test_valid/acc_skew': 89.12, 'best_test_valid/acc_align': 88.02, 'best_test_test/acc': 88.186, 'best_test_test/acc_unbiased': 88.247, 'best_test_test/diff': 1.211, 'best_test_test/acc_skew': 88.264, 'best_test_test/acc_align': 88.23}
[14 / 20] Learning rate: 1e-05 weight: 0.01
[14 / 20] Loss: 4.614397213017734 CE Loss: 0.3008450148188163 Con Loss: 4.611388752654135
[14 / 20] tensor([[0.862, 0.855],
        [0.894, 0.906]]) {'epoch': 14, 'valid/acc': 88.523, 'valid/acc_unbiased': 88.768, 'valid/diff': 2.141, 'valid/acc_skew': 89.839, 'valid/acc_align': 87.698, 'test/acc': 87.89, 'test/acc_unbiased': 87.939, 'test/diff': 0.961, 'test/acc_skew': 87.797, 'test/acc_align': 88.082}
[14 / 20] best valid accuracy: 88.869 at epoch 13 
 best_stats: {'best_valid_epoch': 13, 'best_valid_valid/acc': 88.65, 'best_valid_valid/acc_unbiased': 88.869, 'best_valid_valid/diff': 1.939, 'best_valid_valid/acc_skew': 89.839, 'best_valid_valid/acc_align': 87.9, 'best_valid_test/acc': 87.553, 'best_valid_test/acc_unbiased': 87.601, 'best_valid_test/diff': 1.012, 'best_valid_test/acc_skew': 87.491, 'best_valid_test/acc_align': 87.711}
[14 / 20] best test accuracy: 88.247 at epoch 12 
 best_stats: {'best_test_epoch': 12, 'best_test_valid/acc': 88.397, 'best_test_valid/acc_unbiased': 88.57, 'best_test_valid/diff': 1.1, 'best_test_valid/acc_skew': 89.12, 'best_test_valid/acc_align': 88.02, 'best_test_test/acc': 88.186, 'best_test_test/acc_unbiased': 88.247, 'best_test_test/diff': 1.211, 'best_test_test/acc_skew': 88.264, 'best_test_test/acc_align': 88.23}
[15 / 20] Learning rate: 1e-05 weight: 0.01
[15 / 20] Loss: 4.60847525374391 CE Loss: 0.30541933372557245 Con Loss: 4.605421053712441
[15 / 20] tensor([[0.858, 0.849],
        [0.896, 0.909]]) {'epoch': 15, 'valid/acc': 88.65, 'valid/acc_unbiased': 88.934, 'valid/diff': 1.999, 'valid/acc_skew': 89.934, 'valid/acc_align': 87.934, 'test/acc': 87.764, 'test/acc_unbiased': 87.831, 'test/diff': 1.117, 'test/acc_skew': 87.726, 'test/acc_align': 87.935}
[15 / 20] best valid accuracy: 88.934 at epoch 15 
 best_stats: {'best_valid_epoch': 15, 'best_valid_valid/acc': 88.65, 'best_valid_valid/acc_unbiased': 88.934, 'best_valid_valid/diff': 1.999, 'best_valid_valid/acc_skew': 89.934, 'best_valid_valid/acc_align': 87.934, 'best_valid_test/acc': 87.764, 'best_valid_test/acc_unbiased': 87.831, 'best_valid_test/diff': 1.117, 'best_valid_test/acc_skew': 87.726, 'best_valid_test/acc_align': 87.935}
[15 / 20] best test accuracy: 88.247 at epoch 12 
 best_stats: {'best_test_epoch': 12, 'best_test_valid/acc': 88.397, 'best_test_valid/acc_unbiased': 88.57, 'best_test_valid/diff': 1.1, 'best_test_valid/acc_skew': 89.12, 'best_test_valid/acc_align': 88.02, 'best_test_test/acc': 88.186, 'best_test_test/acc_unbiased': 88.247, 'best_test_test/diff': 1.211, 'best_test_test/acc_skew': 88.264, 'best_test_test/acc_align': 88.23}
[16 / 20] Learning rate: 1e-05 weight: 0.01
[16 / 20] Loss: 4.5992817778403206 CE Loss: 0.29932762722915085 Con Loss: 4.596288504390996
[16 / 20] tensor([[0.873, 0.857],
        [0.890, 0.902]]) {'epoch': 16, 'valid/acc': 88.861, 'valid/acc_unbiased': 89.045, 'valid/diff': 2.007, 'valid/acc_skew': 90.049, 'valid/acc_align': 88.042, 'test/acc': 87.975, 'test/acc_unbiased': 88.026, 'test/diff': 1.418, 'test/acc_skew': 88.119, 'test/acc_align': 87.933}
[16 / 20] best valid accuracy: 89.045 at epoch 16 
 best_stats: {'best_valid_epoch': 16, 'best_valid_valid/acc': 88.861, 'best_valid_valid/acc_unbiased': 89.045, 'best_valid_valid/diff': 2.007, 'best_valid_valid/acc_skew': 90.049, 'best_valid_valid/acc_align': 88.042, 'best_valid_test/acc': 87.975, 'best_valid_test/acc_unbiased': 88.026, 'best_valid_test/diff': 1.418, 'best_valid_test/acc_skew': 88.119, 'best_valid_test/acc_align': 87.933}
[16 / 20] best test accuracy: 88.247 at epoch 12 
 best_stats: {'best_test_epoch': 12, 'best_test_valid/acc': 88.397, 'best_test_valid/acc_unbiased': 88.57, 'best_test_valid/diff': 1.1, 'best_test_valid/acc_skew': 89.12, 'best_test_valid/acc_align': 88.02, 'best_test_test/acc': 88.186, 'best_test_test/acc_unbiased': 88.247, 'best_test_test/diff': 1.211, 'best_test_test/acc_skew': 88.264, 'best_test_test/acc_align': 88.23}
[17 / 20] Learning rate: 1e-05 weight: 0.01
[17 / 20] Loss: 4.595644375487428 CE Loss: 0.3013722487915054 Con Loss: 4.592630662168866
[17 / 20] tensor([[0.869, 0.861],
        [0.890, 0.902]]) {'epoch': 17, 'valid/acc': 88.903, 'valid/acc_unbiased': 89.146, 'valid/diff': 2.338, 'valid/acc_skew': 90.315, 'valid/acc_align': 87.977, 'test/acc': 88.017, 'test/acc_unbiased': 88.047, 'test/diff': 1.017, 'test/acc_skew': 87.939, 'test/acc_align': 88.154}
[17 / 20] best valid accuracy: 89.146 at epoch 17 
 best_stats: {'best_valid_epoch': 17, 'best_valid_valid/acc': 88.903, 'best_valid_valid/acc_unbiased': 89.146, 'best_valid_valid/diff': 2.338, 'best_valid_valid/acc_skew': 90.315, 'best_valid_valid/acc_align': 87.977, 'best_valid_test/acc': 88.017, 'best_valid_test/acc_unbiased': 88.047, 'best_valid_test/diff': 1.017, 'best_valid_test/acc_skew': 87.939, 'best_valid_test/acc_align': 88.154}
[17 / 20] best test accuracy: 88.247 at epoch 12 
 best_stats: {'best_test_epoch': 12, 'best_test_valid/acc': 88.397, 'best_test_valid/acc_unbiased': 88.57, 'best_test_valid/diff': 1.1, 'best_test_valid/acc_skew': 89.12, 'best_test_valid/acc_align': 88.02, 'best_test_test/acc': 88.186, 'best_test_test/acc_unbiased': 88.247, 'best_test_test/diff': 1.211, 'best_test_test/acc_skew': 88.264, 'best_test_test/acc_align': 88.23}
[18 / 20] Learning rate: 1e-05 weight: 0.01
[18 / 20] Loss: 4.594000967206079 CE Loss: 0.30001008336775786 Con Loss: 4.5910009013352475
[18 / 20] tensor([[0.875, 0.870],
        [0.894, 0.902]]) {'epoch': 18, 'valid/acc': 88.987, 'valid/acc_unbiased': 89.151, 'valid/diff': 1.625, 'valid/acc_skew': 89.963, 'valid/acc_align': 88.338, 'test/acc': 88.481, 'test/acc_unbiased': 88.511, 'test/diff': 0.626, 'test/acc_skew': 88.425, 'test/acc_align': 88.597}
[18 / 20] best valid accuracy: 89.151 at epoch 18 
 best_stats: {'best_valid_epoch': 18, 'best_valid_valid/acc': 88.987, 'best_valid_valid/acc_unbiased': 89.151, 'best_valid_valid/diff': 1.625, 'best_valid_valid/acc_skew': 89.963, 'best_valid_valid/acc_align': 88.338, 'best_valid_test/acc': 88.481, 'best_valid_test/acc_unbiased': 88.511, 'best_valid_test/diff': 0.626, 'best_valid_test/acc_skew': 88.425, 'best_valid_test/acc_align': 88.597}
[18 / 20] best test accuracy: 88.511 at epoch 18 
 best_stats: {'best_test_epoch': 18, 'best_test_valid/acc': 88.987, 'best_test_valid/acc_unbiased': 89.151, 'best_test_valid/diff': 1.625, 'best_test_valid/acc_skew': 89.963, 'best_test_valid/acc_align': 88.338, 'best_test_test/acc': 88.481, 'best_test_test/acc_unbiased': 88.511, 'best_test_test/diff': 0.626, 'best_test_test/acc_skew': 88.425, 'best_test_test/acc_align': 88.597}
[19 / 20] Learning rate: 1e-05 weight: 0.01
[19 / 20] Loss: 4.588897674982144 CE Loss: 0.3017754936662717 Con Loss: 4.585879917627327
[19 / 20] tensor([[0.866, 0.860],
        [0.898, 0.911]]) {'epoch': 19, 'valid/acc': 88.776, 'valid/acc_unbiased': 89.034, 'valid/diff': 2.096, 'valid/acc_skew': 90.081, 'valid/acc_align': 87.986, 'test/acc': 88.312, 'test/acc_unbiased': 88.36, 'test/diff': 0.925, 'test/acc_skew': 88.193, 'test/acc_align': 88.526}
[19 / 20] best valid accuracy: 89.151 at epoch 18 
 best_stats: {'best_valid_epoch': 18, 'best_valid_valid/acc': 88.987, 'best_valid_valid/acc_unbiased': 89.151, 'best_valid_valid/diff': 1.625, 'best_valid_valid/acc_skew': 89.963, 'best_valid_valid/acc_align': 88.338, 'best_valid_test/acc': 88.481, 'best_valid_test/acc_unbiased': 88.511, 'best_valid_test/diff': 0.626, 'best_valid_test/acc_skew': 88.425, 'best_valid_test/acc_align': 88.597}
[19 / 20] best test accuracy: 88.511 at epoch 18 
 best_stats: {'best_test_epoch': 18, 'best_test_valid/acc': 88.987, 'best_test_valid/acc_unbiased': 89.151, 'best_test_valid/diff': 1.625, 'best_test_valid/acc_skew': 89.963, 'best_test_valid/acc_align': 88.338, 'best_test_test/acc': 88.481, 'best_test_test/acc_unbiased': 88.511, 'best_test_test/diff': 0.626, 'best_test_test/acc_skew': 88.425, 'best_test_test/acc_align': 88.597}
[20 / 20] Learning rate: 1e-05 weight: 0.01
[20 / 20] Loss: 4.598333690963319 CE Loss: 0.2982545143357923 Con Loss: 4.595351155175668
[20 / 20] tensor([[0.869, 0.860],
        [0.894, 0.905]]) {'epoch': 20, 'valid/acc': 89.072, 'valid/acc_unbiased': 89.309, 'valid/diff': 2.06, 'valid/acc_skew': 90.339, 'valid/acc_align': 88.278, 'test/acc': 88.143, 'test/acc_unbiased': 88.192, 'test/diff': 1.023, 'test/acc_skew': 88.156, 'test/acc_align': 88.229}
[20 / 20] best valid accuracy: 89.309 at epoch 20 
 best_stats: {'best_valid_epoch': 20, 'best_valid_valid/acc': 89.072, 'best_valid_valid/acc_unbiased': 89.309, 'best_valid_valid/diff': 2.06, 'best_valid_valid/acc_skew': 90.339, 'best_valid_valid/acc_align': 88.278, 'best_valid_test/acc': 88.143, 'best_valid_test/acc_unbiased': 88.192, 'best_valid_test/diff': 1.023, 'best_valid_test/acc_skew': 88.156, 'best_valid_test/acc_align': 88.229}
[20 / 20] best test accuracy: 88.511 at epoch 18 
 best_stats: {'best_test_epoch': 18, 'best_test_valid/acc': 88.987, 'best_test_valid/acc_unbiased': 89.151, 'best_test_valid/diff': 1.625, 'best_test_valid/acc_skew': 89.963, 'best_test_valid/acc_align': 88.338, 'best_test_test/acc': 88.481, 'best_test_test/acc_unbiased': 88.511, 'best_test_test/diff': 0.626, 'best_test_test/acc_skew': 88.425, 'best_test_test/acc_align': 88.597}
Total training time: 0:32:43
