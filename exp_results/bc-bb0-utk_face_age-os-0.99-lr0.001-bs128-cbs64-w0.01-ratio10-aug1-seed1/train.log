Log level set to: INFO
Set seed: 1
=======> Using Fixed Random Seed: 1 <========
save_path: exp_results/bc-bb0-utk_face_age-os-0.99-lr0.001-bs128-cbs64-w0.01-ratio10-aug1-seed1
get_utk_face - split: train, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_age-0.99
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [8237, 14]
Target 1: [82, 1477]
Binary Target 1
---------------------------
Target 0: [8237, 14]
Target 1: [82, 1477]
===================================
Normal Label Distribution: 
Target 0: [8237, 14]
Target 1: [82, 1477]
===================================
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [8237, 8237]
Target 1: [8237, 8237]
Binary Target 1
---------------------------
Target 0: [8237, 8237]
Target 1: [8237, 8237]
===================================
Normal Label Distribution: 
Target 0: [8237, 8237]
Target 1: [8237, 8237]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 32948, target_attr: gender, bias_attr: age bias_rate: 0.99
['[train] target_0-bias_0: 8237', '[train] target_0-bias_1: 8237', '[train] target_1-bias_0: 8237', '[train] target_1-bias_1: 8237']
confusion_matrix - 
 original: tensor([[8237., 8237.],
        [8237., 8237.]]), 
 normalized: tensor([[0.500, 0.500],
        [0.500, 0.500]]), 
 b|y: tensor([[0.500, 0.500],
        [0.500, 0.500]])
get_utk_face - split: train, aug: 1, given_y: True, ratio: 10
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_age-0.99
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [8237, 14]
Target 1: [82, 1477]
Binary Target 1
---------------------------
Target 0: [8237, 14]
Target 1: [82, 1477]
===================================
Normal Label Distribution: 
Target 0: [8237, 14]
Target 1: [82, 1477]
===================================
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [8237, 8237]
Target 1: [8237, 8237]
Binary Target 1
---------------------------
Target 0: [8237, 8237]
Target 1: [8237, 8237]
===================================
Normal Label Distribution: 
Target 0: [8237, 8237]
Target 1: [8237, 8237]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 32948, target_attr: gender, bias_attr: age bias_rate: 0.99
['[train] target_0-bias_0: 8237', '[train] target_0-bias_1: 8237', '[train] target_1-bias_0: 8237', '[train] target_1-bias_1: 8237']
get_utk_face - split: valid, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_age-0.99
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [1030, 195]
Target 1: [841, 202]
Binary Target 1
---------------------------
Target 0: [1030, 195]
Target 1: [841, 202]
===================================
Normal Label Distribution: 
Target 0: [1030, 195]
Target 1: [841, 202]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 2268, target_attr: gender, bias_attr: age bias_rate: 0.99
['[valid] target_0-bias_0: 1030', '[valid] target_0-bias_1: 195', '[valid] target_1-bias_0: 841', '[valid] target_1-bias_1: 202']
get_utk_face - split: test, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_age-0.99
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [1061, 176]
Target 1: [867, 165]
Binary Target 1
---------------------------
Target 0: [1061, 176]
Target 1: [867, 165]
===================================
Normal Label Distribution: 
Target 0: [1061, 176]
Target 1: [867, 165]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 2269, target_attr: gender, bias_attr: age bias_rate: 0.99
['[test] target_0-bias_0: 1061', '[test] target_0-bias_1: 176', '[test] target_1-bias_0: 867', '[test] target_1-bias_1: 165']
decay_epochs: [6, 13]
[1 / 20] Learning rate: 0.001 weight: 0.01
[1 / 20] Loss: 4.707241179860013 CE Loss: 0.3842844509001682 Con Loss: 4.703398342313184
[1 / 20] tensor([[0.926, 0.369],
        [0.622, 0.806]]) {'epoch': 1, 'valid/acc': 75.397, 'valid/acc_unbiased': 69.325, 'valid/diff': 38.44, 'valid/acc_skew': 76.589, 'valid/acc_align': 62.061, 'test/acc': 75.804, 'test/acc_unbiased': 68.089, 'test/diff': 37.077, 'test/acc_skew': 77.408, 'test/acc_align': 58.769}
[1 / 20] best valid accuracy: 69.325 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 75.397, 'best_valid_valid/acc_unbiased': 69.325, 'best_valid_valid/diff': 38.44, 'best_valid_valid/acc_skew': 76.589, 'best_valid_valid/acc_align': 62.061, 'best_valid_test/acc': 75.804, 'best_valid_test/acc_unbiased': 68.089, 'best_valid_test/diff': 37.077, 'best_valid_test/acc_skew': 77.408, 'best_valid_test/acc_align': 58.769}
[1 / 20] best test accuracy: 68.089 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 75.397, 'best_test_valid/acc_unbiased': 69.325, 'best_test_valid/diff': 38.44, 'best_test_valid/acc_skew': 76.589, 'best_test_valid/acc_align': 62.061, 'best_test_test/acc': 75.804, 'best_test_test/acc_unbiased': 68.089, 'best_test_test/diff': 37.077, 'best_test_test/acc_skew': 77.408, 'best_test_test/acc_align': 58.769}
[2 / 20] Learning rate: 0.001 weight: 0.01
[2 / 20] Loss: 4.526061637346296 CE Loss: 0.2535190341743839 Con Loss: 4.523526455109395
[2 / 20] tensor([[0.944, 0.250],
        [0.678, 0.909]]) {'epoch': 2, 'valid/acc': 78.131, 'valid/acc_unbiased': 69.109, 'valid/diff': 45.551, 'valid/acc_skew': 81.099, 'valid/acc_align': 57.119, 'test/acc': 78.625, 'test/acc_unbiased': 69.542, 'test/diff': 46.264, 'test/acc_skew': 81.13, 'test/acc_align': 57.955}
[2 / 20] best valid accuracy: 69.325 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 75.397, 'best_valid_valid/acc_unbiased': 69.325, 'best_valid_valid/diff': 38.44, 'best_valid_valid/acc_skew': 76.589, 'best_valid_valid/acc_align': 62.061, 'best_valid_test/acc': 75.804, 'best_valid_test/acc_unbiased': 68.089, 'best_valid_test/diff': 37.077, 'best_valid_test/acc_skew': 77.408, 'best_valid_test/acc_align': 58.769}
[2 / 20] best test accuracy: 69.542 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 78.131, 'best_test_valid/acc_unbiased': 69.109, 'best_test_valid/diff': 45.551, 'best_test_valid/acc_skew': 81.099, 'best_test_valid/acc_align': 57.119, 'best_test_test/acc': 78.625, 'best_test_test/acc_unbiased': 69.542, 'best_test_test/diff': 46.264, 'best_test_test/acc_skew': 81.13, 'best_test_test/acc_align': 57.955}
[3 / 20] Learning rate: 0.001 weight: 0.01
[3 / 20] Loss: 4.460553994988649 CE Loss: 0.21930261597596312 Con Loss: 4.458360972212865
[3 / 20] tensor([[0.927, 0.227],
        [0.696, 0.970]]) {'epoch': 3, 'valid/acc': 76.19, 'valid/acc_unbiased': 67.664, 'valid/diff': 54.032, 'valid/acc_skew': 78.864, 'valid/acc_align': 56.464, 'test/acc': 78.757, 'test/acc_unbiased': 70.497, 'test/diff': 48.717, 'test/acc_skew': 81.146, 'test/acc_align': 59.848}
[3 / 20] best valid accuracy: 69.325 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 75.397, 'best_valid_valid/acc_unbiased': 69.325, 'best_valid_valid/diff': 38.44, 'best_valid_valid/acc_skew': 76.589, 'best_valid_valid/acc_align': 62.061, 'best_valid_test/acc': 75.804, 'best_valid_test/acc_unbiased': 68.089, 'best_valid_test/diff': 37.077, 'best_valid_test/acc_skew': 77.408, 'best_valid_test/acc_align': 58.769}
[3 / 20] best test accuracy: 70.497 at epoch 3 
 best_stats: {'best_test_epoch': 3, 'best_test_valid/acc': 76.19, 'best_test_valid/acc_unbiased': 67.664, 'best_test_valid/diff': 54.032, 'best_test_valid/acc_skew': 78.864, 'best_test_valid/acc_align': 56.464, 'best_test_test/acc': 78.757, 'best_test_test/acc_unbiased': 70.497, 'best_test_test/diff': 48.717, 'best_test_test/acc_skew': 81.146, 'best_test_test/acc_align': 59.848}
[4 / 20] Learning rate: 0.001 weight: 0.01
[4 / 20] Loss: 4.4283104606865535 CE Loss: 0.2105031697708411 Con Loss: 4.426205438998511
[4 / 20] tensor([[0.910, 0.227],
        [0.822, 0.958]]) {'epoch': 4, 'valid/acc': 80.159, 'valid/acc_unbiased': 69.373, 'valid/diff': 47.284, 'valid/acc_skew': 85.076, 'valid/acc_align': 53.67, 'test/acc': 82.724, 'test/acc_unbiased': 72.942, 'test/diff': 40.919, 'test/acc_skew': 86.642, 'test/acc_align': 59.242}
[4 / 20] best valid accuracy: 69.373 at epoch 4 
 best_stats: {'best_valid_epoch': 4, 'best_valid_valid/acc': 80.159, 'best_valid_valid/acc_unbiased': 69.373, 'best_valid_valid/diff': 47.284, 'best_valid_valid/acc_skew': 85.076, 'best_valid_valid/acc_align': 53.67, 'best_valid_test/acc': 82.724, 'best_valid_test/acc_unbiased': 72.942, 'best_valid_test/diff': 40.919, 'best_valid_test/acc_skew': 86.642, 'best_valid_test/acc_align': 59.242}
[4 / 20] best test accuracy: 72.942 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 80.159, 'best_test_valid/acc_unbiased': 69.373, 'best_test_valid/diff': 47.284, 'best_test_valid/acc_skew': 85.076, 'best_test_valid/acc_align': 53.67, 'best_test_test/acc': 82.724, 'best_test_test/acc_unbiased': 72.942, 'best_test_test/diff': 40.919, 'best_test_test/acc_skew': 86.642, 'best_test_test/acc_align': 59.242}
[5 / 20] Learning rate: 0.001 weight: 0.01
[5 / 20] Loss: 4.406205086015129 CE Loss: 0.1882157650668456 Con Loss: 4.404322924653896
[5 / 20] tensor([[0.918, 0.193],
        [0.773, 0.958]]) {'epoch': 5, 'valid/acc': 78.263, 'valid/acc_unbiased': 68.655, 'valid/diff': 50.099, 'valid/acc_skew': 82.119, 'valid/acc_align': 55.19, 'test/acc': 80.917, 'test/acc_unbiased': 71.038, 'test/diff': 45.481, 'test/acc_skew': 84.539, 'test/acc_align': 57.538}
[5 / 20] best valid accuracy: 69.373 at epoch 4 
 best_stats: {'best_valid_epoch': 4, 'best_valid_valid/acc': 80.159, 'best_valid_valid/acc_unbiased': 69.373, 'best_valid_valid/diff': 47.284, 'best_valid_valid/acc_skew': 85.076, 'best_valid_valid/acc_align': 53.67, 'best_valid_test/acc': 82.724, 'best_valid_test/acc_unbiased': 72.942, 'best_valid_test/diff': 40.919, 'best_valid_test/acc_skew': 86.642, 'best_valid_test/acc_align': 59.242}
[5 / 20] best test accuracy: 72.942 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 80.159, 'best_test_valid/acc_unbiased': 69.373, 'best_test_valid/diff': 47.284, 'best_test_valid/acc_skew': 85.076, 'best_test_valid/acc_align': 53.67, 'best_test_test/acc': 82.724, 'best_test_test/acc_unbiased': 72.942, 'best_test_test/diff': 40.919, 'best_test_test/acc_skew': 86.642, 'best_test_test/acc_align': 59.242}
[6 / 20] Learning rate: 0.001 weight: 0.01
[6 / 20] Loss: 4.382884285035202 CE Loss: 0.1743777231443879 Con Loss: 4.381140498783862
[6 / 20] tensor([[0.901, 0.159],
        [0.804, 0.982]]) {'epoch': 6, 'valid/acc': 80.423, 'valid/acc_unbiased': 70.149, 'valid/diff': 49.868, 'valid/acc_skew': 84.886, 'valid/acc_align': 55.411, 'test/acc': 81.225, 'test/acc_unbiased': 71.147, 'test/diff': 45.992, 'test/acc_skew': 85.248, 'test/acc_align': 57.045}
[6 / 20] best valid accuracy: 70.149 at epoch 6 
 best_stats: {'best_valid_epoch': 6, 'best_valid_valid/acc': 80.423, 'best_valid_valid/acc_unbiased': 70.149, 'best_valid_valid/diff': 49.868, 'best_valid_valid/acc_skew': 84.886, 'best_valid_valid/acc_align': 55.411, 'best_valid_test/acc': 81.225, 'best_valid_test/acc_unbiased': 71.147, 'best_valid_test/diff': 45.992, 'best_valid_test/acc_skew': 85.248, 'best_valid_test/acc_align': 57.045}
[6 / 20] best test accuracy: 72.942 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 80.159, 'best_test_valid/acc_unbiased': 69.373, 'best_test_valid/diff': 47.284, 'best_test_valid/acc_skew': 85.076, 'best_test_valid/acc_align': 53.67, 'best_test_test/acc': 82.724, 'best_test_test/acc_unbiased': 72.942, 'best_test_test/diff': 40.919, 'best_test_test/acc_skew': 86.642, 'best_test_test/acc_align': 59.242}
[7 / 20] Learning rate: 0.0001 weight: 0.01
[7 / 20] Loss: 4.319078121310344 CE Loss: 0.1412776059153243 Con Loss: 4.317665353885941
[7 / 20] tensor([[0.951, 0.182],
        [0.730, 0.982]]) {'epoch': 7, 'valid/acc': 79.674, 'valid/acc_unbiased': 69.73, 'valid/diff': 53.996, 'valid/acc_skew': 83.271, 'valid/acc_align': 56.189, 'test/acc': 80.917, 'test/acc_unbiased': 71.118, 'test/diff': 51.044, 'test/acc_skew': 84.055, 'test/acc_align': 58.182}
[7 / 20] best valid accuracy: 70.149 at epoch 6 
 best_stats: {'best_valid_epoch': 6, 'best_valid_valid/acc': 80.423, 'best_valid_valid/acc_unbiased': 70.149, 'best_valid_valid/diff': 49.868, 'best_valid_valid/acc_skew': 84.886, 'best_valid_valid/acc_align': 55.411, 'best_valid_test/acc': 81.225, 'best_valid_test/acc_unbiased': 71.147, 'best_valid_test/diff': 45.992, 'best_valid_test/acc_skew': 85.248, 'best_valid_test/acc_align': 57.045}
[7 / 20] best test accuracy: 72.942 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 80.159, 'best_test_valid/acc_unbiased': 69.373, 'best_test_valid/diff': 47.284, 'best_test_valid/acc_skew': 85.076, 'best_test_valid/acc_align': 53.67, 'best_test_test/acc': 82.724, 'best_test_test/acc_unbiased': 72.942, 'best_test_test/diff': 40.919, 'best_test_test/acc_skew': 86.642, 'best_test_test/acc_align': 59.242}
[8 / 20] Learning rate: 0.0001 weight: 0.01
[8 / 20] Loss: 4.293959018398839 CE Loss: 0.12659096063681274 Con Loss: 4.2926931091198375
[8 / 20] tensor([[0.959, 0.170],
        [0.731, 0.964]]) {'epoch': 8, 'valid/acc': 79.541, 'valid/acc_unbiased': 69.718, 'valid/diff': 54.409, 'valid/acc_skew': 82.99, 'valid/acc_align': 56.446, 'test/acc': 81.093, 'test/acc_unbiased': 70.597, 'test/diff': 51.023, 'test/acc_skew': 84.489, 'test/acc_align': 56.705}
[8 / 20] best valid accuracy: 70.149 at epoch 6 
 best_stats: {'best_valid_epoch': 6, 'best_valid_valid/acc': 80.423, 'best_valid_valid/acc_unbiased': 70.149, 'best_valid_valid/diff': 49.868, 'best_valid_valid/acc_skew': 84.886, 'best_valid_valid/acc_align': 55.411, 'best_valid_test/acc': 81.225, 'best_valid_test/acc_unbiased': 71.147, 'best_valid_test/diff': 45.992, 'best_valid_test/acc_skew': 85.248, 'best_valid_test/acc_align': 57.045}
[8 / 20] best test accuracy: 72.942 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 80.159, 'best_test_valid/acc_unbiased': 69.373, 'best_test_valid/diff': 47.284, 'best_test_valid/acc_skew': 85.076, 'best_test_valid/acc_align': 53.67, 'best_test_test/acc': 82.724, 'best_test_test/acc_unbiased': 72.942, 'best_test_test/diff': 40.919, 'best_test_test/acc_skew': 86.642, 'best_test_test/acc_align': 59.242}
[9 / 20] Learning rate: 0.0001 weight: 0.01
[9 / 20] Loss: 4.284360557443615 CE Loss: 0.12340301226227987 Con Loss: 4.283126529738989
[9 / 20] tensor([[0.964, 0.193],
        [0.698, 0.970]]) {'epoch': 9, 'valid/acc': 78.66, 'valid/acc_unbiased': 69.211, 'valid/diff': 55.617, 'valid/acc_skew': 81.72, 'valid/acc_align': 56.702, 'test/acc': 80.3, 'test/acc_unbiased': 70.622, 'test/diff': 52.145, 'test/acc_skew': 83.1, 'test/acc_align': 58.144}
[9 / 20] best valid accuracy: 70.149 at epoch 6 
 best_stats: {'best_valid_epoch': 6, 'best_valid_valid/acc': 80.423, 'best_valid_valid/acc_unbiased': 70.149, 'best_valid_valid/diff': 49.868, 'best_valid_valid/acc_skew': 84.886, 'best_valid_valid/acc_align': 55.411, 'best_valid_test/acc': 81.225, 'best_valid_test/acc_unbiased': 71.147, 'best_valid_test/diff': 45.992, 'best_valid_test/acc_skew': 85.248, 'best_valid_test/acc_align': 57.045}
[9 / 20] best test accuracy: 72.942 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 80.159, 'best_test_valid/acc_unbiased': 69.373, 'best_test_valid/diff': 47.284, 'best_test_valid/acc_skew': 85.076, 'best_test_valid/acc_align': 53.67, 'best_test_test/acc': 82.724, 'best_test_test/acc_unbiased': 72.942, 'best_test_test/diff': 40.919, 'best_test_test/acc_skew': 86.642, 'best_test_test/acc_align': 59.242}
[10 / 20] Learning rate: 0.0001 weight: 0.01
[10 / 20] Loss: 4.281264222679865 CE Loss: 0.1182661766345327 Con Loss: 4.280081571935812
[10 / 20] tensor([[0.967, 0.205],
        [0.648, 0.952]]) {'epoch': 10, 'valid/acc': 77.822, 'valid/acc_unbiased': 68.759, 'valid/diff': 57.181, 'valid/acc_skew': 80.286, 'valid/acc_align': 57.233, 'test/acc': 78.493, 'test/acc_unbiased': 69.282, 'test/diff': 53.288, 'test/acc_skew': 80.761, 'test/acc_align': 57.803}
[10 / 20] best valid accuracy: 70.149 at epoch 6 
 best_stats: {'best_valid_epoch': 6, 'best_valid_valid/acc': 80.423, 'best_valid_valid/acc_unbiased': 70.149, 'best_valid_valid/diff': 49.868, 'best_valid_valid/acc_skew': 84.886, 'best_valid_valid/acc_align': 55.411, 'best_valid_test/acc': 81.225, 'best_valid_test/acc_unbiased': 71.147, 'best_valid_test/diff': 45.992, 'best_valid_test/acc_skew': 85.248, 'best_valid_test/acc_align': 57.045}
[10 / 20] best test accuracy: 72.942 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 80.159, 'best_test_valid/acc_unbiased': 69.373, 'best_test_valid/diff': 47.284, 'best_test_valid/acc_skew': 85.076, 'best_test_valid/acc_align': 53.67, 'best_test_test/acc': 82.724, 'best_test_test/acc_unbiased': 72.942, 'best_test_test/diff': 40.919, 'best_test_test/acc_skew': 86.642, 'best_test_test/acc_align': 59.242}
[11 / 20] Learning rate: 0.0001 weight: 0.01
[11 / 20] Loss: 4.27463051629353 CE Loss: 0.11774728381620733 Con Loss: 4.273453040653834
[11 / 20] tensor([[0.967, 0.199],
        [0.661, 0.964]]) {'epoch': 11, 'valid/acc': 77.954, 'valid/acc_unbiased': 68.778, 'valid/diff': 57.056, 'valid/acc_skew': 80.589, 'valid/acc_align': 56.968, 'test/acc': 79.022, 'test/acc_unbiased': 69.76, 'test/diff': 53.544, 'test/acc_skew': 81.396, 'test/acc_align': 58.125}
[11 / 20] best valid accuracy: 70.149 at epoch 6 
 best_stats: {'best_valid_epoch': 6, 'best_valid_valid/acc': 80.423, 'best_valid_valid/acc_unbiased': 70.149, 'best_valid_valid/diff': 49.868, 'best_valid_valid/acc_skew': 84.886, 'best_valid_valid/acc_align': 55.411, 'best_valid_test/acc': 81.225, 'best_valid_test/acc_unbiased': 71.147, 'best_valid_test/diff': 45.992, 'best_valid_test/acc_skew': 85.248, 'best_valid_test/acc_align': 57.045}
[11 / 20] best test accuracy: 72.942 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 80.159, 'best_test_valid/acc_unbiased': 69.373, 'best_test_valid/diff': 47.284, 'best_test_valid/acc_skew': 85.076, 'best_test_valid/acc_align': 53.67, 'best_test_test/acc': 82.724, 'best_test_test/acc_unbiased': 72.942, 'best_test_test/diff': 40.919, 'best_test_test/acc_skew': 86.642, 'best_test_test/acc_align': 59.242}
[12 / 20] Learning rate: 0.0001 weight: 0.01
[12 / 20] Loss: 4.271340396807468 CE Loss: 0.11396311057345503 Con Loss: 4.270200767287847
[12 / 20] tensor([[0.960, 0.165],
        [0.728, 0.976]]) {'epoch': 12, 'valid/acc': 79.762, 'valid/acc_unbiased': 69.941, 'valid/diff': 55.643, 'valid/acc_skew': 83.206, 'valid/acc_align': 56.676, 'test/acc': 81.093, 'test/acc_unbiased': 70.719, 'test/diff': 52.18, 'test/acc_skew': 84.411, 'test/acc_align': 57.027}
[12 / 20] best valid accuracy: 70.149 at epoch 6 
 best_stats: {'best_valid_epoch': 6, 'best_valid_valid/acc': 80.423, 'best_valid_valid/acc_unbiased': 70.149, 'best_valid_valid/diff': 49.868, 'best_valid_valid/acc_skew': 84.886, 'best_valid_valid/acc_align': 55.411, 'best_valid_test/acc': 81.225, 'best_valid_test/acc_unbiased': 71.147, 'best_valid_test/diff': 45.992, 'best_valid_test/acc_skew': 85.248, 'best_valid_test/acc_align': 57.045}
[12 / 20] best test accuracy: 72.942 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 80.159, 'best_test_valid/acc_unbiased': 69.373, 'best_test_valid/diff': 47.284, 'best_test_valid/acc_skew': 85.076, 'best_test_valid/acc_align': 53.67, 'best_test_test/acc': 82.724, 'best_test_test/acc_unbiased': 72.942, 'best_test_test/diff': 40.919, 'best_test_test/acc_skew': 86.642, 'best_test_test/acc_align': 59.242}
[13 / 20] Learning rate: 0.0001 weight: 0.01
[13 / 20] Loss: 4.2724364517932525 CE Loss: 0.11275301258018312 Con Loss: 4.271308921271191
[13 / 20] tensor([[0.970, 0.159],
        [0.677, 0.970]]) {'epoch': 13, 'valid/acc': 78.836, 'valid/acc_unbiased': 69.178, 'valid/diff': 54.965, 'valid/acc_skew': 81.875, 'valid/acc_align': 56.481, 'test/acc': 79.506, 'test/acc_unbiased': 69.392, 'test/diff': 55.17, 'test/acc_skew': 82.344, 'test/acc_align': 56.439}
[13 / 20] best valid accuracy: 70.149 at epoch 6 
 best_stats: {'best_valid_epoch': 6, 'best_valid_valid/acc': 80.423, 'best_valid_valid/acc_unbiased': 70.149, 'best_valid_valid/diff': 49.868, 'best_valid_valid/acc_skew': 84.886, 'best_valid_valid/acc_align': 55.411, 'best_valid_test/acc': 81.225, 'best_valid_test/acc_unbiased': 71.147, 'best_valid_test/diff': 45.992, 'best_valid_test/acc_skew': 85.248, 'best_valid_test/acc_align': 57.045}
[13 / 20] best test accuracy: 72.942 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 80.159, 'best_test_valid/acc_unbiased': 69.373, 'best_test_valid/diff': 47.284, 'best_test_valid/acc_skew': 85.076, 'best_test_valid/acc_align': 53.67, 'best_test_test/acc': 82.724, 'best_test_test/acc_unbiased': 72.942, 'best_test_test/diff': 40.919, 'best_test_test/acc_skew': 86.642, 'best_test_test/acc_align': 59.242}
[14 / 20] Learning rate: 1e-05 weight: 0.01
[14 / 20] Loss: 4.254538640157392 CE Loss: 0.11195880776508436 Con Loss: 4.253419047581769
[14 / 20] tensor([[0.963, 0.153],
        [0.698, 0.970]]) {'epoch': 14, 'valid/acc': 78.748, 'valid/acc_unbiased': 69.152, 'valid/diff': 56.919, 'valid/acc_skew': 81.876, 'valid/acc_align': 56.428, 'test/acc': 79.947, 'test/acc_unbiased': 69.604, 'test/diff': 54.086, 'test/acc_skew': 83.053, 'test/acc_align': 56.155}
[14 / 20] best valid accuracy: 70.149 at epoch 6 
 best_stats: {'best_valid_epoch': 6, 'best_valid_valid/acc': 80.423, 'best_valid_valid/acc_unbiased': 70.149, 'best_valid_valid/diff': 49.868, 'best_valid_valid/acc_skew': 84.886, 'best_valid_valid/acc_align': 55.411, 'best_valid_test/acc': 81.225, 'best_valid_test/acc_unbiased': 71.147, 'best_valid_test/diff': 45.992, 'best_valid_test/acc_skew': 85.248, 'best_valid_test/acc_align': 57.045}
[14 / 20] best test accuracy: 72.942 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 80.159, 'best_test_valid/acc_unbiased': 69.373, 'best_test_valid/diff': 47.284, 'best_test_valid/acc_skew': 85.076, 'best_test_valid/acc_align': 53.67, 'best_test_test/acc': 82.724, 'best_test_test/acc_unbiased': 72.942, 'best_test_test/diff': 40.919, 'best_test_test/acc_skew': 86.642, 'best_test_test/acc_align': 59.242}
[15 / 20] Learning rate: 1e-05 weight: 0.01
[15 / 20] Loss: 4.266282603826658 CE Loss: 0.10500672045691262 Con Loss: 4.2652325487779414
[15 / 20] tensor([[0.970, 0.165],
        [0.664, 0.970]]) {'epoch': 15, 'valid/acc': 78.307, 'valid/acc_unbiased': 68.79, 'valid/diff': 56.722, 'valid/acc_skew': 81.107, 'valid/acc_align': 56.472, 'test/acc': 79.066, 'test/acc_unbiased': 69.217, 'test/diff': 55.52, 'test/acc_skew': 81.71, 'test/acc_align': 56.723}
[15 / 20] best valid accuracy: 70.149 at epoch 6 
 best_stats: {'best_valid_epoch': 6, 'best_valid_valid/acc': 80.423, 'best_valid_valid/acc_unbiased': 70.149, 'best_valid_valid/diff': 49.868, 'best_valid_valid/acc_skew': 84.886, 'best_valid_valid/acc_align': 55.411, 'best_valid_test/acc': 81.225, 'best_valid_test/acc_unbiased': 71.147, 'best_valid_test/diff': 45.992, 'best_valid_test/acc_skew': 85.248, 'best_valid_test/acc_align': 57.045}
[15 / 20] best test accuracy: 72.942 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 80.159, 'best_test_valid/acc_unbiased': 69.373, 'best_test_valid/diff': 47.284, 'best_test_valid/acc_skew': 85.076, 'best_test_valid/acc_align': 53.67, 'best_test_test/acc': 82.724, 'best_test_test/acc_unbiased': 72.942, 'best_test_test/diff': 40.919, 'best_test_test/acc_skew': 86.642, 'best_test_test/acc_align': 59.242}
[16 / 20] Learning rate: 1e-05 weight: 0.01
[16 / 20] Loss: 4.258029678977345 CE Loss: 0.10836360403399337 Con Loss: 4.256946041092821
[16 / 20] tensor([[0.969, 0.165],
        [0.660, 0.970]]) {'epoch': 16, 'valid/acc': 78.175, 'valid/acc_unbiased': 68.702, 'valid/diff': 57.296, 'valid/acc_skew': 80.94, 'valid/acc_align': 56.464, 'test/acc': 78.845, 'test/acc_unbiased': 69.078, 'test/diff': 55.704, 'test/acc_skew': 81.432, 'test/acc_align': 56.723}
[16 / 20] best valid accuracy: 70.149 at epoch 6 
 best_stats: {'best_valid_epoch': 6, 'best_valid_valid/acc': 80.423, 'best_valid_valid/acc_unbiased': 70.149, 'best_valid_valid/diff': 49.868, 'best_valid_valid/acc_skew': 84.886, 'best_valid_valid/acc_align': 55.411, 'best_valid_test/acc': 81.225, 'best_valid_test/acc_unbiased': 71.147, 'best_valid_test/diff': 45.992, 'best_valid_test/acc_skew': 85.248, 'best_valid_test/acc_align': 57.045}
[16 / 20] best test accuracy: 72.942 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 80.159, 'best_test_valid/acc_unbiased': 69.373, 'best_test_valid/diff': 47.284, 'best_test_valid/acc_skew': 85.076, 'best_test_valid/acc_align': 53.67, 'best_test_test/acc': 82.724, 'best_test_test/acc_unbiased': 72.942, 'best_test_test/diff': 40.919, 'best_test_test/acc_skew': 86.642, 'best_test_test/acc_align': 59.242}
[17 / 20] Learning rate: 1e-05 weight: 0.01
[17 / 20] Loss: 4.2470104850957995 CE Loss: 0.10465230654730183 Con Loss: 4.245963957727397
[17 / 20] tensor([[0.972, 0.170],
        [0.664, 0.970]]) {'epoch': 17, 'valid/acc': 78.395, 'valid/acc_unbiased': 68.942, 'valid/diff': 56.514, 'valid/acc_skew': 81.156, 'valid/acc_align': 56.729, 'test/acc': 79.198, 'test/acc_unbiased': 69.406, 'test/diff': 55.33, 'test/acc_skew': 81.804, 'test/acc_align': 57.008}
[17 / 20] best valid accuracy: 70.149 at epoch 6 
 best_stats: {'best_valid_epoch': 6, 'best_valid_valid/acc': 80.423, 'best_valid_valid/acc_unbiased': 70.149, 'best_valid_valid/diff': 49.868, 'best_valid_valid/acc_skew': 84.886, 'best_valid_valid/acc_align': 55.411, 'best_valid_test/acc': 81.225, 'best_valid_test/acc_unbiased': 71.147, 'best_valid_test/diff': 45.992, 'best_valid_test/acc_skew': 85.248, 'best_valid_test/acc_align': 57.045}
[17 / 20] best test accuracy: 72.942 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 80.159, 'best_test_valid/acc_unbiased': 69.373, 'best_test_valid/diff': 47.284, 'best_test_valid/acc_skew': 85.076, 'best_test_valid/acc_align': 53.67, 'best_test_test/acc': 82.724, 'best_test_test/acc_unbiased': 72.942, 'best_test_test/diff': 40.919, 'best_test_test/acc_skew': 86.642, 'best_test_test/acc_align': 59.242}
[18 / 20] Learning rate: 1e-05 weight: 0.01
[18 / 20] Loss: 4.249443314123808 CE Loss: 0.10409940879611522 Con Loss: 4.248402317070738
[18 / 20] tensor([[0.975, 0.199],
        [0.652, 0.964]]) {'epoch': 18, 'valid/acc': 78.131, 'valid/acc_unbiased': 68.748, 'valid/diff': 57.195, 'valid/acc_skew': 80.766, 'valid/acc_align': 56.729, 'test/acc': 79.022, 'test/acc_unbiased': 69.718, 'test/diff': 54.383, 'test/acc_skew': 81.311, 'test/acc_align': 58.125}
[18 / 20] best valid accuracy: 70.149 at epoch 6 
 best_stats: {'best_valid_epoch': 6, 'best_valid_valid/acc': 80.423, 'best_valid_valid/acc_unbiased': 70.149, 'best_valid_valid/diff': 49.868, 'best_valid_valid/acc_skew': 84.886, 'best_valid_valid/acc_align': 55.411, 'best_valid_test/acc': 81.225, 'best_valid_test/acc_unbiased': 71.147, 'best_valid_test/diff': 45.992, 'best_valid_test/acc_skew': 85.248, 'best_valid_test/acc_align': 57.045}
[18 / 20] best test accuracy: 72.942 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 80.159, 'best_test_valid/acc_unbiased': 69.373, 'best_test_valid/diff': 47.284, 'best_test_valid/acc_skew': 85.076, 'best_test_valid/acc_align': 53.67, 'best_test_test/acc': 82.724, 'best_test_test/acc_unbiased': 72.942, 'best_test_test/diff': 40.919, 'best_test_test/acc_skew': 86.642, 'best_test_test/acc_align': 59.242}
[19 / 20] Learning rate: 1e-05 weight: 0.01
[19 / 20] Loss: 4.247968180544011 CE Loss: 0.10353241730614804 Con Loss: 4.246932864377289
[19 / 20] tensor([[0.969, 0.176],
        [0.653, 0.964]]) {'epoch': 19, 'valid/acc': 78.042, 'valid/acc_unbiased': 68.612, 'valid/diff': 57.475, 'valid/acc_skew': 80.761, 'valid/acc_align': 56.464, 'test/acc': 78.625, 'test/acc_unbiased': 69.037, 'test/diff': 55.179, 'test/acc_skew': 81.086, 'test/acc_align': 56.989}
[19 / 20] best valid accuracy: 70.149 at epoch 6 
 best_stats: {'best_valid_epoch': 6, 'best_valid_valid/acc': 80.423, 'best_valid_valid/acc_unbiased': 70.149, 'best_valid_valid/diff': 49.868, 'best_valid_valid/acc_skew': 84.886, 'best_valid_valid/acc_align': 55.411, 'best_valid_test/acc': 81.225, 'best_valid_test/acc_unbiased': 71.147, 'best_valid_test/diff': 45.992, 'best_valid_test/acc_skew': 85.248, 'best_valid_test/acc_align': 57.045}
[19 / 20] best test accuracy: 72.942 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 80.159, 'best_test_valid/acc_unbiased': 69.373, 'best_test_valid/diff': 47.284, 'best_test_valid/acc_skew': 85.076, 'best_test_valid/acc_align': 53.67, 'best_test_test/acc': 82.724, 'best_test_test/acc_unbiased': 72.942, 'best_test_test/diff': 40.919, 'best_test_test/acc_skew': 86.642, 'best_test_test/acc_align': 59.242}
[20 / 20] Learning rate: 1e-05 weight: 0.01
[20 / 20] Loss: 4.252409546557916 CE Loss: 0.10826270929321193 Con Loss: 4.251326925042215
[20 / 20] tensor([[0.969, 0.193],
        [0.660, 0.964]]) {'epoch': 20, 'valid/acc': 78.086, 'valid/acc_unbiased': 68.637, 'valid/diff': 57.523, 'valid/acc_skew': 80.81, 'valid/acc_align': 56.464, 'test/acc': 79.022, 'test/acc_unbiased': 69.637, 'test/diff': 53.98, 'test/acc_skew': 81.432, 'test/acc_align': 57.841}
[20 / 20] best valid accuracy: 70.149 at epoch 6 
 best_stats: {'best_valid_epoch': 6, 'best_valid_valid/acc': 80.423, 'best_valid_valid/acc_unbiased': 70.149, 'best_valid_valid/diff': 49.868, 'best_valid_valid/acc_skew': 84.886, 'best_valid_valid/acc_align': 55.411, 'best_valid_test/acc': 81.225, 'best_valid_test/acc_unbiased': 71.147, 'best_valid_test/diff': 45.992, 'best_valid_test/acc_skew': 85.248, 'best_valid_test/acc_align': 57.045}
[20 / 20] best test accuracy: 72.942 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 80.159, 'best_test_valid/acc_unbiased': 69.373, 'best_test_valid/diff': 47.284, 'best_test_valid/acc_skew': 85.076, 'best_test_valid/acc_align': 53.67, 'best_test_test/acc': 82.724, 'best_test_test/acc_unbiased': 72.942, 'best_test_test/diff': 40.919, 'best_test_test/acc_skew': 86.642, 'best_test_test/acc_align': 59.242}
Total training time: 1:23:17
