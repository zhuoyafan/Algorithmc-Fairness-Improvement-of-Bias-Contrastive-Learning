Log level set to: INFO
Set seed: 3
=======> Using Fixed Random Seed: 3 <========
save_path: exp_results/bc-bb0-utk_face_age-os_0.6-0.9-lr0.001-bs128-cbs64-w0.01-ratio10-aug1-seed3
get_utk_face - split: train, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_age-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
Binary Target 1
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Normal Label Distribution: 
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [4942, 4942]
Target 1: [4942, 4942]
Binary Target 1
---------------------------
Target 0: [4942, 4942]
Target 1: [4942, 4942]
===================================
Normal Label Distribution: 
Target 0: [4942, 4942]
Target 1: [4942, 4942]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 19768, target_attr: gender, bias_attr: age bias_rate: 0.9
['[train] target_0-bias_0: 4942', '[train] target_0-bias_1: 4942', '[train] target_1-bias_0: 4942', '[train] target_1-bias_1: 4942']
confusion_matrix - 
 original: tensor([[4942., 4942.],
        [4942., 4942.]]), 
 normalized: tensor([[0.500, 0.500],
        [0.500, 0.500]]), 
 b|y: tensor([[0.500, 0.500],
        [0.500, 0.500]])
get_utk_face - split: train, aug: 1, given_y: True, ratio: 10
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_age-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
Binary Target 1
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Normal Label Distribution: 
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [4942, 4942]
Target 1: [4942, 4942]
Binary Target 1
---------------------------
Target 0: [4942, 4942]
Target 1: [4942, 4942]
===================================
Normal Label Distribution: 
Target 0: [4942, 4942]
Target 1: [4942, 4942]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 19768, target_attr: gender, bias_attr: age bias_rate: 0.9
['[train] target_0-bias_0: 4942', '[train] target_0-bias_1: 4942', '[train] target_1-bias_0: 4942', '[train] target_1-bias_1: 4942']
get_utk_face - split: valid, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_age-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [1030, 195]
Target 1: [841, 202]
Binary Target 1
---------------------------
Target 0: [1030, 195]
Target 1: [841, 202]
===================================
Normal Label Distribution: 
Target 0: [1030, 195]
Target 1: [841, 202]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 2268, target_attr: gender, bias_attr: age bias_rate: 0.9
['[valid] target_0-bias_0: 1030', '[valid] target_0-bias_1: 195', '[valid] target_1-bias_0: 841', '[valid] target_1-bias_1: 202']
get_utk_face - split: test, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_age-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [1061, 176]
Target 1: [867, 165]
Binary Target 1
---------------------------
Target 0: [1061, 176]
Target 1: [867, 165]
===================================
Normal Label Distribution: 
Target 0: [1061, 176]
Target 1: [867, 165]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 2269, target_attr: gender, bias_attr: age bias_rate: 0.9
['[test] target_0-bias_0: 1061', '[test] target_0-bias_1: 176', '[test] target_1-bias_0: 867', '[test] target_1-bias_1: 165']
decay_epochs: [6, 13]
[1 / 20] Learning rate: 0.001 weight: 0.01
[1 / 20] Loss: 4.868500394987124 CE Loss: 0.5940680429309256 Con Loss: 4.862559723400578
[1 / 20] tensor([[0.831, 0.511],
        [0.811, 0.812]]) {'epoch': 1, 'valid/acc': 78.704, 'valid/acc_unbiased': 72.77, 'valid/diff': 23.026, 'valid/acc_skew': 81.701, 'valid/acc_align': 63.839, 'test/acc': 79.727, 'test/acc_unbiased': 74.14, 'test/diff': 16.06, 'test/acc_skew': 82.107, 'test/acc_align': 66.174}
[1 / 20] best valid accuracy: 72.770 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 78.704, 'best_valid_valid/acc_unbiased': 72.77, 'best_valid_valid/diff': 23.026, 'best_valid_valid/acc_skew': 81.701, 'best_valid_valid/acc_align': 63.839, 'best_valid_test/acc': 79.727, 'best_valid_test/acc_unbiased': 74.14, 'best_valid_test/diff': 16.06, 'best_valid_test/acc_skew': 82.107, 'best_valid_test/acc_align': 66.174}
[1 / 20] best test accuracy: 74.140 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 78.704, 'best_test_valid/acc_unbiased': 72.77, 'best_test_valid/diff': 23.026, 'best_test_valid/acc_skew': 81.701, 'best_test_valid/acc_align': 63.839, 'best_test_test/acc': 79.727, 'best_test_test/acc_unbiased': 74.14, 'best_test_test/diff': 16.06, 'best_test_test/acc_skew': 82.107, 'best_test_test/acc_align': 66.174}
[2 / 20] Learning rate: 0.001 weight: 0.01
[2 / 20] Loss: 4.7743087360994965 CE Loss: 0.4804548846715281 Con Loss: 4.769504198223316
[2 / 20] tensor([[0.828, 0.477],
        [0.845, 0.842]]) {'epoch': 2, 'valid/acc': 80.732, 'valid/acc_unbiased': 74.207, 'valid/diff': 20.238, 'valid/acc_skew': 84.311, 'valid/acc_align': 64.104, 'test/acc': 80.829, 'test/acc_unbiased': 74.817, 'test/diff': 17.663, 'test/acc_skew': 83.648, 'test/acc_align': 65.985}
[2 / 20] best valid accuracy: 74.207 at epoch 2 
 best_stats: {'best_valid_epoch': 2, 'best_valid_valid/acc': 80.732, 'best_valid_valid/acc_unbiased': 74.207, 'best_valid_valid/diff': 20.238, 'best_valid_valid/acc_skew': 84.311, 'best_valid_valid/acc_align': 64.104, 'best_valid_test/acc': 80.829, 'best_valid_test/acc_unbiased': 74.817, 'best_valid_test/diff': 17.663, 'best_valid_test/acc_skew': 83.648, 'best_valid_test/acc_align': 65.985}
[2 / 20] best test accuracy: 74.817 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 80.732, 'best_test_valid/acc_unbiased': 74.207, 'best_test_valid/diff': 20.238, 'best_test_valid/acc_skew': 84.311, 'best_test_valid/acc_align': 64.104, 'best_test_test/acc': 80.829, 'best_test_test/acc_unbiased': 74.817, 'best_test_test/diff': 17.663, 'best_test_test/acc_skew': 83.648, 'best_test_test/acc_align': 65.985}
[3 / 20] Learning rate: 0.001 weight: 0.01
[3 / 20] Loss: 4.752266605389548 CE Loss: 0.43595113876328107 Con Loss: 4.747907105171453
[3 / 20] tensor([[0.959, 0.722],
        [0.669, 0.612]]) {'epoch': 3, 'valid/acc': 79.145, 'valid/acc_unbiased': 74.318, 'valid/diff': 12.157, 'valid/acc_skew': 79.818, 'valid/acc_align': 68.818, 'test/acc': 80.432, 'test/acc_unbiased': 74.03, 'test/diff': 14.69, 'test/acc_skew': 81.375, 'test/acc_align': 66.686}
[3 / 20] best valid accuracy: 74.318 at epoch 3 
 best_stats: {'best_valid_epoch': 3, 'best_valid_valid/acc': 79.145, 'best_valid_valid/acc_unbiased': 74.318, 'best_valid_valid/diff': 12.157, 'best_valid_valid/acc_skew': 79.818, 'best_valid_valid/acc_align': 68.818, 'best_valid_test/acc': 80.432, 'best_valid_test/acc_unbiased': 74.03, 'best_valid_test/diff': 14.69, 'best_valid_test/acc_skew': 81.375, 'best_valid_test/acc_align': 66.686}
[3 / 20] best test accuracy: 74.817 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 80.732, 'best_test_valid/acc_unbiased': 74.207, 'best_test_valid/diff': 20.238, 'best_test_valid/acc_skew': 84.311, 'best_test_valid/acc_align': 64.104, 'best_test_test/acc': 80.829, 'best_test_test/acc_unbiased': 74.817, 'best_test_test/diff': 17.663, 'best_test_test/acc_skew': 83.648, 'best_test_test/acc_align': 65.985}
[4 / 20] Learning rate: 0.001 weight: 0.01
[4 / 20] Loss: 4.7104800184551685 CE Loss: 0.40948010120542366 Con Loss: 4.706385216699443
[4 / 20] tensor([[0.829, 0.528],
        [0.873, 0.794]]) {'epoch': 4, 'valid/acc': 82.407, 'valid/acc_unbiased': 75.605, 'valid/diff': 20.844, 'valid/acc_skew': 86.027, 'valid/acc_align': 65.183, 'test/acc': 82.019, 'test/acc_unbiased': 75.622, 'test/diff': 19.009, 'test/acc_skew': 85.127, 'test/acc_align': 66.117}
[4 / 20] best valid accuracy: 75.605 at epoch 4 
 best_stats: {'best_valid_epoch': 4, 'best_valid_valid/acc': 82.407, 'best_valid_valid/acc_unbiased': 75.605, 'best_valid_valid/diff': 20.844, 'best_valid_valid/acc_skew': 86.027, 'best_valid_valid/acc_align': 65.183, 'best_valid_test/acc': 82.019, 'best_valid_test/acc_unbiased': 75.622, 'best_valid_test/diff': 19.009, 'best_valid_test/acc_skew': 85.127, 'best_valid_test/acc_align': 66.117}
[4 / 20] best test accuracy: 75.622 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 82.407, 'best_test_valid/acc_unbiased': 75.605, 'best_test_valid/diff': 20.844, 'best_test_valid/acc_skew': 86.027, 'best_test_valid/acc_align': 65.183, 'best_test_test/acc': 82.019, 'best_test_test/acc_unbiased': 75.622, 'best_test_test/diff': 19.009, 'best_test_test/acc_skew': 85.127, 'best_test_test/acc_align': 66.117}
[5 / 20] Learning rate: 0.001 weight: 0.01
[5 / 20] Loss: 4.6810623913436515 CE Loss: 0.3882695238679973 Con Loss: 4.6771797097583185
[5 / 20] tensor([[0.938, 0.750],
        [0.708, 0.709]]) {'epoch': 5, 'valid/acc': 81.041, 'valid/acc_unbiased': 74.324, 'valid/diff': 17.713, 'valid/acc_skew': 83.18, 'valid/acc_align': 65.467, 'test/acc': 81.886, 'test/acc_unbiased': 77.627, 'test/diff': 9.435, 'test/acc_skew': 82.299, 'test/acc_align': 72.955}
[5 / 20] best valid accuracy: 75.605 at epoch 4 
 best_stats: {'best_valid_epoch': 4, 'best_valid_valid/acc': 82.407, 'best_valid_valid/acc_unbiased': 75.605, 'best_valid_valid/diff': 20.844, 'best_valid_valid/acc_skew': 86.027, 'best_valid_valid/acc_align': 65.183, 'best_valid_test/acc': 82.019, 'best_valid_test/acc_unbiased': 75.622, 'best_valid_test/diff': 19.009, 'best_valid_test/acc_skew': 85.127, 'best_valid_test/acc_align': 66.117}
[5 / 20] best test accuracy: 77.627 at epoch 5 
 best_stats: {'best_test_epoch': 5, 'best_test_valid/acc': 81.041, 'best_test_valid/acc_unbiased': 74.324, 'best_test_valid/diff': 17.713, 'best_test_valid/acc_skew': 83.18, 'best_test_valid/acc_align': 65.467, 'best_test_test/acc': 81.886, 'best_test_test/acc_unbiased': 77.627, 'best_test_test/diff': 9.435, 'best_test_test/acc_skew': 82.299, 'best_test_test/acc_align': 72.955}
[6 / 20] Learning rate: 0.001 weight: 0.01
[6 / 20] Loss: 4.665033886568694 CE Loss: 0.3670230743278139 Con Loss: 4.661363670190111
[6 / 20] tensor([[0.820, 0.398],
        [0.896, 0.903]]) {'epoch': 6, 'valid/acc': 80.556, 'valid/acc_unbiased': 74.177, 'valid/diff': 23.716, 'valid/acc_skew': 84.357, 'valid/acc_align': 63.997, 'test/acc': 82.239, 'test/acc_unbiased': 75.423, 'test/diff': 21.455, 'test/acc_skew': 85.809, 'test/acc_align': 65.038}
[6 / 20] best valid accuracy: 75.605 at epoch 4 
 best_stats: {'best_valid_epoch': 4, 'best_valid_valid/acc': 82.407, 'best_valid_valid/acc_unbiased': 75.605, 'best_valid_valid/diff': 20.844, 'best_valid_valid/acc_skew': 86.027, 'best_valid_valid/acc_align': 65.183, 'best_valid_test/acc': 82.019, 'best_valid_test/acc_unbiased': 75.622, 'best_valid_test/diff': 19.009, 'best_valid_test/acc_skew': 85.127, 'best_valid_test/acc_align': 66.117}
[6 / 20] best test accuracy: 77.627 at epoch 5 
 best_stats: {'best_test_epoch': 5, 'best_test_valid/acc': 81.041, 'best_test_valid/acc_unbiased': 74.324, 'best_test_valid/diff': 17.713, 'best_test_valid/acc_skew': 83.18, 'best_test_valid/acc_align': 65.467, 'best_test_test/acc': 81.886, 'best_test_test/acc_unbiased': 77.627, 'best_test_test/diff': 9.435, 'best_test_test/acc_skew': 82.299, 'best_test_test/acc_align': 72.955}
[7 / 20] Learning rate: 0.0001 weight: 0.01
[7 / 20] Loss: 4.583400436665355 CE Loss: 0.3043723039687862 Con Loss: 4.580356705579522
[7 / 20] tensor([[0.891, 0.443],
        [0.882, 0.903]]) {'epoch': 7, 'valid/acc': 83.862, 'valid/acc_unbiased': 76.937, 'valid/diff': 27.942, 'valid/acc_skew': 87.349, 'valid/acc_align': 66.526, 'test/acc': 85.368, 'test/acc_unbiased': 77.981, 'test/diff': 23.408, 'test/acc_skew': 88.651, 'test/acc_align': 67.311}
[7 / 20] best valid accuracy: 76.937 at epoch 7 
 best_stats: {'best_valid_epoch': 7, 'best_valid_valid/acc': 83.862, 'best_valid_valid/acc_unbiased': 76.937, 'best_valid_valid/diff': 27.942, 'best_valid_valid/acc_skew': 87.349, 'best_valid_valid/acc_align': 66.526, 'best_valid_test/acc': 85.368, 'best_valid_test/acc_unbiased': 77.981, 'best_valid_test/diff': 23.408, 'best_valid_test/acc_skew': 88.651, 'best_valid_test/acc_align': 67.311}
[7 / 20] best test accuracy: 77.981 at epoch 7 
 best_stats: {'best_test_epoch': 7, 'best_test_valid/acc': 83.862, 'best_test_valid/acc_unbiased': 76.937, 'best_test_valid/diff': 27.942, 'best_test_valid/acc_skew': 87.349, 'best_test_valid/acc_align': 66.526, 'best_test_test/acc': 85.368, 'best_test_test/acc_unbiased': 77.981, 'best_test_test/diff': 23.408, 'best_test_test/acc_skew': 88.651, 'best_test_test/acc_align': 67.311}
[8 / 20] Learning rate: 0.0001 weight: 0.01
[8 / 20] Loss: 4.538171051292466 CE Loss: 0.2686857009696266 Con Loss: 4.5354842008824585
[8 / 20] tensor([[0.887, 0.409],
        [0.873, 0.915]]) {'epoch': 8, 'valid/acc': 83.907, 'valid/acc_unbiased': 76.503, 'valid/diff': 28.724, 'valid/acc_skew': 87.771, 'valid/acc_align': 65.235, 'test/acc': 84.663, 'test/acc_unbiased': 77.107, 'test/diff': 25.992, 'test/acc_skew': 88.001, 'test/acc_align': 66.212}
[8 / 20] best valid accuracy: 76.937 at epoch 7 
 best_stats: {'best_valid_epoch': 7, 'best_valid_valid/acc': 83.862, 'best_valid_valid/acc_unbiased': 76.937, 'best_valid_valid/diff': 27.942, 'best_valid_valid/acc_skew': 87.349, 'best_valid_valid/acc_align': 66.526, 'best_valid_test/acc': 85.368, 'best_valid_test/acc_unbiased': 77.981, 'best_valid_test/diff': 23.408, 'best_valid_test/acc_skew': 88.651, 'best_valid_test/acc_align': 67.311}
[8 / 20] best test accuracy: 77.981 at epoch 7 
 best_stats: {'best_test_epoch': 7, 'best_test_valid/acc': 83.862, 'best_test_valid/acc_unbiased': 76.937, 'best_test_valid/diff': 27.942, 'best_test_valid/acc_skew': 87.349, 'best_test_valid/acc_align': 66.526, 'best_test_test/acc': 85.368, 'best_test_test/acc_unbiased': 77.981, 'best_test_test/diff': 23.408, 'best_test_test/acc_skew': 88.651, 'best_test_test/acc_align': 67.311}
[9 / 20] Learning rate: 0.0001 weight: 0.01
[9 / 20] Loss: 4.517422795729906 CE Loss: 0.2568843614193941 Con Loss: 4.514853946403278
[9 / 20] tensor([[0.905, 0.432],
        [0.886, 0.915]]) {'epoch': 9, 'valid/acc': 84.656, 'valid/acc_unbiased': 76.792, 'valid/diff': 31.078, 'valid/acc_skew': 88.623, 'valid/acc_align': 64.961, 'test/acc': 86.161, 'test/acc_unbiased': 78.44, 'test/diff': 25.116, 'test/acc_skew': 89.531, 'test/acc_align': 67.348}
[9 / 20] best valid accuracy: 76.937 at epoch 7 
 best_stats: {'best_valid_epoch': 7, 'best_valid_valid/acc': 83.862, 'best_valid_valid/acc_unbiased': 76.937, 'best_valid_valid/diff': 27.942, 'best_valid_valid/acc_skew': 87.349, 'best_valid_valid/acc_align': 66.526, 'best_valid_test/acc': 85.368, 'best_valid_test/acc_unbiased': 77.981, 'best_valid_test/diff': 23.408, 'best_valid_test/acc_skew': 88.651, 'best_valid_test/acc_align': 67.311}
[9 / 20] best test accuracy: 78.440 at epoch 9 
 best_stats: {'best_test_epoch': 9, 'best_test_valid/acc': 84.656, 'best_test_valid/acc_unbiased': 76.792, 'best_test_valid/diff': 31.078, 'best_test_valid/acc_skew': 88.623, 'best_test_valid/acc_align': 64.961, 'best_test_test/acc': 86.161, 'best_test_test/acc_unbiased': 78.44, 'best_test_test/diff': 25.116, 'best_test_test/acc_skew': 89.531, 'best_test_test/acc_align': 67.348}
[10 / 20] Learning rate: 0.0001 weight: 0.01
[10 / 20] Loss: 4.492991577898718 CE Loss: 0.251200770231839 Con Loss: 4.490479569838434
[10 / 20] tensor([[0.929, 0.443],
        [0.864, 0.897]]) {'epoch': 10, 'valid/acc': 85.185, 'valid/acc_unbiased': 79.503, 'valid/diff': 25.909, 'valid/acc_skew': 87.599, 'valid/acc_align': 71.406, 'test/acc': 86.426, 'test/acc_unbiased': 78.334, 'test/diff': 25.96, 'test/acc_skew': 89.661, 'test/acc_align': 67.008}
[10 / 20] best valid accuracy: 79.503 at epoch 10 
 best_stats: {'best_valid_epoch': 10, 'best_valid_valid/acc': 85.185, 'best_valid_valid/acc_unbiased': 79.503, 'best_valid_valid/diff': 25.909, 'best_valid_valid/acc_skew': 87.599, 'best_valid_valid/acc_align': 71.406, 'best_valid_test/acc': 86.426, 'best_valid_test/acc_unbiased': 78.334, 'best_valid_test/diff': 25.96, 'best_valid_test/acc_skew': 89.661, 'best_valid_test/acc_align': 67.008}
[10 / 20] best test accuracy: 78.440 at epoch 9 
 best_stats: {'best_test_epoch': 9, 'best_test_valid/acc': 84.656, 'best_test_valid/acc_unbiased': 76.792, 'best_test_valid/diff': 31.078, 'best_test_valid/acc_skew': 88.623, 'best_test_valid/acc_align': 64.961, 'best_test_test/acc': 86.161, 'best_test_test/acc_unbiased': 78.44, 'best_test_test/diff': 25.116, 'best_test_test/acc_skew': 89.531, 'best_test_test/acc_align': 67.348}
[11 / 20] Learning rate: 0.0001 weight: 0.01
[11 / 20] Loss: 4.4798398922928335 CE Loss: 0.2382439696344949 Con Loss: 4.477457465453941
[11 / 20] tensor([[0.915, 0.415],
        [0.871, 0.915]]) {'epoch': 11, 'valid/acc': 84.48, 'valid/acc_unbiased': 76.932, 'valid/diff': 30.185, 'valid/acc_skew': 88.108, 'valid/acc_align': 65.757, 'test/acc': 85.941, 'test/acc_unbiased': 77.898, 'test/diff': 27.237, 'test/acc_skew': 89.3, 'test/acc_align': 66.496}
[11 / 20] best valid accuracy: 79.503 at epoch 10 
 best_stats: {'best_valid_epoch': 10, 'best_valid_valid/acc': 85.185, 'best_valid_valid/acc_unbiased': 79.503, 'best_valid_valid/diff': 25.909, 'best_valid_valid/acc_skew': 87.599, 'best_valid_valid/acc_align': 71.406, 'best_valid_test/acc': 86.426, 'best_valid_test/acc_unbiased': 78.334, 'best_valid_test/diff': 25.96, 'best_valid_test/acc_skew': 89.661, 'best_valid_test/acc_align': 67.008}
[11 / 20] best test accuracy: 78.440 at epoch 9 
 best_stats: {'best_test_epoch': 9, 'best_test_valid/acc': 84.656, 'best_test_valid/acc_unbiased': 76.792, 'best_test_valid/diff': 31.078, 'best_test_valid/acc_skew': 88.623, 'best_test_valid/acc_align': 64.961, 'best_test_test/acc': 86.161, 'best_test_test/acc_unbiased': 78.44, 'best_test_test/diff': 25.116, 'best_test_test/acc_skew': 89.531, 'best_test_test/acc_align': 67.348}
[12 / 20] Learning rate: 0.0001 weight: 0.01
[12 / 20] Loss: 4.482153578549442 CE Loss: 0.23677262402724178 Con Loss: 4.479785847403365
[12 / 20] tensor([[0.926, 0.466],
        [0.856, 0.891]]) {'epoch': 12, 'valid/acc': 84.436, 'valid/acc_unbiased': 77.453, 'valid/diff': 29.027, 'valid/acc_skew': 87.594, 'valid/acc_align': 67.313, 'test/acc': 86.073, 'test/acc_unbiased': 78.455, 'test/diff': 24.736, 'test/acc_skew': 89.068, 'test/acc_align': 67.841}
[12 / 20] best valid accuracy: 79.503 at epoch 10 
 best_stats: {'best_valid_epoch': 10, 'best_valid_valid/acc': 85.185, 'best_valid_valid/acc_unbiased': 79.503, 'best_valid_valid/diff': 25.909, 'best_valid_valid/acc_skew': 87.599, 'best_valid_valid/acc_align': 71.406, 'best_valid_test/acc': 86.426, 'best_valid_test/acc_unbiased': 78.334, 'best_valid_test/diff': 25.96, 'best_valid_test/acc_skew': 89.661, 'best_valid_test/acc_align': 67.008}
[12 / 20] best test accuracy: 78.455 at epoch 12 
 best_stats: {'best_test_epoch': 12, 'best_test_valid/acc': 84.436, 'best_test_valid/acc_unbiased': 77.453, 'best_test_valid/diff': 29.027, 'best_test_valid/acc_skew': 87.594, 'best_test_valid/acc_align': 67.313, 'best_test_test/acc': 86.073, 'best_test_test/acc_unbiased': 78.455, 'best_test_test/diff': 24.736, 'best_test_test/acc_skew': 89.068, 'best_test_test/acc_align': 67.841}
[13 / 20] Learning rate: 0.0001 weight: 0.01
[13 / 20] Loss: 4.475993904204853 CE Loss: 0.23082329915969876 Con Loss: 4.4736856648141385
[13 / 20] tensor([[0.910, 0.330],
        [0.895, 0.939]]) {'epoch': 13, 'valid/acc': 84.656, 'valid/acc_unbiased': 76.258, 'valid/diff': 33.718, 'valid/acc_skew': 88.855, 'valid/acc_align': 63.661, 'test/acc': 86.117, 'test/acc_unbiased': 76.837, 'test/diff': 31.216, 'test/acc_skew': 90.228, 'test/acc_align': 63.447}
[13 / 20] best valid accuracy: 79.503 at epoch 10 
 best_stats: {'best_valid_epoch': 10, 'best_valid_valid/acc': 85.185, 'best_valid_valid/acc_unbiased': 79.503, 'best_valid_valid/diff': 25.909, 'best_valid_valid/acc_skew': 87.599, 'best_valid_valid/acc_align': 71.406, 'best_valid_test/acc': 86.426, 'best_valid_test/acc_unbiased': 78.334, 'best_valid_test/diff': 25.96, 'best_valid_test/acc_skew': 89.661, 'best_valid_test/acc_align': 67.008}
[13 / 20] best test accuracy: 78.455 at epoch 12 
 best_stats: {'best_test_epoch': 12, 'best_test_valid/acc': 84.436, 'best_test_valid/acc_unbiased': 77.453, 'best_test_valid/diff': 29.027, 'best_test_valid/acc_skew': 87.594, 'best_test_valid/acc_align': 67.313, 'best_test_test/acc': 86.073, 'best_test_test/acc_unbiased': 78.455, 'best_test_test/diff': 24.736, 'best_test_test/acc_skew': 89.068, 'best_test_test/acc_align': 67.841}
[14 / 20] Learning rate: 1e-05 weight: 0.01
[14 / 20] Loss: 4.456176042460276 CE Loss: 0.2250205372591725 Con Loss: 4.453925804684684
[14 / 20] tensor([[0.921, 0.420],
        [0.877, 0.927]]) {'epoch': 14, 'valid/acc': 84.744, 'valid/acc_unbiased': 76.784, 'valid/diff': 31.463, 'valid/acc_skew': 88.589, 'valid/acc_align': 64.978, 'test/acc': 86.558, 'test/acc_unbiased': 78.629, 'test/diff': 27.553, 'test/acc_skew': 89.871, 'test/acc_align': 67.386}
[14 / 20] best valid accuracy: 79.503 at epoch 10 
 best_stats: {'best_valid_epoch': 10, 'best_valid_valid/acc': 85.185, 'best_valid_valid/acc_unbiased': 79.503, 'best_valid_valid/diff': 25.909, 'best_valid_valid/acc_skew': 87.599, 'best_valid_valid/acc_align': 71.406, 'best_valid_test/acc': 86.426, 'best_valid_test/acc_unbiased': 78.334, 'best_valid_test/diff': 25.96, 'best_valid_test/acc_skew': 89.661, 'best_valid_test/acc_align': 67.008}
[14 / 20] best test accuracy: 78.629 at epoch 14 
 best_stats: {'best_test_epoch': 14, 'best_test_valid/acc': 84.744, 'best_test_valid/acc_unbiased': 76.784, 'best_test_valid/diff': 31.463, 'best_test_valid/acc_skew': 88.589, 'best_test_valid/acc_align': 64.978, 'best_test_test/acc': 86.558, 'best_test_test/acc_unbiased': 78.629, 'best_test_test/diff': 27.553, 'best_test_test/acc_skew': 89.871, 'best_test_test/acc_align': 67.386}
[15 / 20] Learning rate: 1e-05 weight: 0.01
[15 / 20] Loss: 4.457779350381108 CE Loss: 0.2180166183599621 Con Loss: 4.455599175441222
[15 / 20] tensor([[0.934, 0.443],
        [0.865, 0.927]]) {'epoch': 15, 'valid/acc': 84.7, 'valid/acc_unbiased': 77.086, 'valid/diff': 31.131, 'valid/acc_skew': 88.15, 'valid/acc_align': 66.022, 'test/acc': 86.911, 'test/acc_unbiased': 79.238, 'test/diff': 27.653, 'test/acc_skew': 89.954, 'test/acc_align': 68.523}
[15 / 20] best valid accuracy: 79.503 at epoch 10 
 best_stats: {'best_valid_epoch': 10, 'best_valid_valid/acc': 85.185, 'best_valid_valid/acc_unbiased': 79.503, 'best_valid_valid/diff': 25.909, 'best_valid_valid/acc_skew': 87.599, 'best_valid_valid/acc_align': 71.406, 'best_valid_test/acc': 86.426, 'best_valid_test/acc_unbiased': 78.334, 'best_valid_test/diff': 25.96, 'best_valid_test/acc_skew': 89.661, 'best_valid_test/acc_align': 67.008}
[15 / 20] best test accuracy: 79.238 at epoch 15 
 best_stats: {'best_test_epoch': 15, 'best_test_valid/acc': 84.7, 'best_test_valid/acc_unbiased': 77.086, 'best_test_valid/diff': 31.131, 'best_test_valid/acc_skew': 88.15, 'best_test_valid/acc_align': 66.022, 'best_test_test/acc': 86.911, 'best_test_test/acc_unbiased': 79.238, 'best_test_test/diff': 27.653, 'best_test_test/acc_skew': 89.954, 'best_test_test/acc_align': 68.523}
[16 / 20] Learning rate: 1e-05 weight: 0.01
[16 / 20] Loss: 4.445983936891822 CE Loss: 0.2198855569974366 Con Loss: 4.4437850856047705
[16 / 20] tensor([[0.930, 0.449],
        [0.872, 0.927]]) {'epoch': 16, 'valid/acc': 84.568, 'valid/acc_unbiased': 77.009, 'valid/diff': 31.489, 'valid/acc_skew': 88.004, 'valid/acc_align': 66.013, 'test/acc': 87.043, 'test/acc_unbiased': 79.459, 'test/diff': 26.835, 'test/acc_skew': 90.111, 'test/acc_align': 68.807}
[16 / 20] best valid accuracy: 79.503 at epoch 10 
 best_stats: {'best_valid_epoch': 10, 'best_valid_valid/acc': 85.185, 'best_valid_valid/acc_unbiased': 79.503, 'best_valid_valid/diff': 25.909, 'best_valid_valid/acc_skew': 87.599, 'best_valid_valid/acc_align': 71.406, 'best_valid_test/acc': 86.426, 'best_valid_test/acc_unbiased': 78.334, 'best_valid_test/diff': 25.96, 'best_valid_test/acc_skew': 89.661, 'best_valid_test/acc_align': 67.008}
[16 / 20] best test accuracy: 79.459 at epoch 16 
 best_stats: {'best_test_epoch': 16, 'best_test_valid/acc': 84.568, 'best_test_valid/acc_unbiased': 77.009, 'best_test_valid/diff': 31.489, 'best_test_valid/acc_skew': 88.004, 'best_test_valid/acc_align': 66.013, 'best_test_test/acc': 87.043, 'best_test_test/acc_unbiased': 79.459, 'best_test_test/diff': 26.835, 'best_test_test/acc_skew': 90.111, 'best_test_test/acc_align': 68.807}
[17 / 20] Learning rate: 1e-05 weight: 0.01
[17 / 20] Loss: 4.448695109470418 CE Loss: 0.21462611042382215 Con Loss: 4.446548842071571
[17 / 20] tensor([[0.919, 0.432],
        [0.885, 0.939]]) {'epoch': 17, 'valid/acc': 84.612, 'valid/acc_unbiased': 76.494, 'valid/diff': 32.935, 'valid/acc_skew': 88.54, 'valid/acc_align': 64.448, 'test/acc': 86.955, 'test/acc_unbiased': 79.37, 'test/diff': 27.093, 'test/acc_skew': 90.18, 'test/acc_align': 68.561}
[17 / 20] best valid accuracy: 79.503 at epoch 10 
 best_stats: {'best_valid_epoch': 10, 'best_valid_valid/acc': 85.185, 'best_valid_valid/acc_unbiased': 79.503, 'best_valid_valid/diff': 25.909, 'best_valid_valid/acc_skew': 87.599, 'best_valid_valid/acc_align': 71.406, 'best_valid_test/acc': 86.426, 'best_valid_test/acc_unbiased': 78.334, 'best_valid_test/diff': 25.96, 'best_valid_test/acc_skew': 89.661, 'best_valid_test/acc_align': 67.008}
[17 / 20] best test accuracy: 79.459 at epoch 16 
 best_stats: {'best_test_epoch': 16, 'best_test_valid/acc': 84.568, 'best_test_valid/acc_unbiased': 77.009, 'best_test_valid/diff': 31.489, 'best_test_valid/acc_skew': 88.004, 'best_test_valid/acc_align': 66.013, 'best_test_test/acc': 87.043, 'best_test_test/acc_unbiased': 79.459, 'best_test_test/diff': 26.835, 'best_test_test/acc_skew': 90.111, 'best_test_test/acc_align': 68.807}
[18 / 20] Learning rate: 1e-05 weight: 0.01
[18 / 20] Loss: 4.445192112994069 CE Loss: 0.21424422959768064 Con Loss: 4.443049666660607
[18 / 20] tensor([[0.923, 0.415],
        [0.884, 0.939]]) {'epoch': 18, 'valid/acc': 84.436, 'valid/acc_unbiased': 76.271, 'valid/diff': 33.478, 'valid/acc_skew': 88.351, 'valid/acc_align': 64.191, 'test/acc': 86.955, 'test/acc_unbiased': 79.01, 'test/diff': 28.191, 'test/acc_skew': 90.311, 'test/acc_align': 67.708}
[18 / 20] best valid accuracy: 79.503 at epoch 10 
 best_stats: {'best_valid_epoch': 10, 'best_valid_valid/acc': 85.185, 'best_valid_valid/acc_unbiased': 79.503, 'best_valid_valid/diff': 25.909, 'best_valid_valid/acc_skew': 87.599, 'best_valid_valid/acc_align': 71.406, 'best_valid_test/acc': 86.426, 'best_valid_test/acc_unbiased': 78.334, 'best_valid_test/diff': 25.96, 'best_valid_test/acc_skew': 89.661, 'best_valid_test/acc_align': 67.008}
[18 / 20] best test accuracy: 79.459 at epoch 16 
 best_stats: {'best_test_epoch': 16, 'best_test_valid/acc': 84.568, 'best_test_valid/acc_unbiased': 77.009, 'best_test_valid/diff': 31.489, 'best_test_valid/acc_skew': 88.004, 'best_test_valid/acc_align': 66.013, 'best_test_test/acc': 87.043, 'best_test_test/acc_unbiased': 79.459, 'best_test_test/diff': 26.835, 'best_test_test/acc_skew': 90.111, 'best_test_test/acc_align': 68.807}
[19 / 20] Learning rate: 1e-05 weight: 0.01
[19 / 20] Loss: 4.4370738501878755 CE Loss: 0.21619667071820464 Con Loss: 4.434911864337435
[19 / 20] tensor([[0.928, 0.438],
        [0.872, 0.939]]) {'epoch': 19, 'valid/acc': 84.656, 'valid/acc_unbiased': 76.858, 'valid/diff': 33.276, 'valid/acc_skew': 88.242, 'valid/acc_align': 65.473, 'test/acc': 86.955, 'test/acc_unbiased': 79.431, 'test/diff': 27.915, 'test/acc_skew': 90.017, 'test/acc_align': 68.845}
[19 / 20] best valid accuracy: 79.503 at epoch 10 
 best_stats: {'best_valid_epoch': 10, 'best_valid_valid/acc': 85.185, 'best_valid_valid/acc_unbiased': 79.503, 'best_valid_valid/diff': 25.909, 'best_valid_valid/acc_skew': 87.599, 'best_valid_valid/acc_align': 71.406, 'best_valid_test/acc': 86.426, 'best_valid_test/acc_unbiased': 78.334, 'best_valid_test/diff': 25.96, 'best_valid_test/acc_skew': 89.661, 'best_valid_test/acc_align': 67.008}
[19 / 20] best test accuracy: 79.459 at epoch 16 
 best_stats: {'best_test_epoch': 16, 'best_test_valid/acc': 84.568, 'best_test_valid/acc_unbiased': 77.009, 'best_test_valid/diff': 31.489, 'best_test_valid/acc_skew': 88.004, 'best_test_valid/acc_align': 66.013, 'best_test_test/acc': 87.043, 'best_test_test/acc_unbiased': 79.459, 'best_test_test/diff': 26.835, 'best_test_test/acc_skew': 90.111, 'best_test_test/acc_align': 68.807}
[20 / 20] Learning rate: 1e-05 weight: 0.01
[20 / 20] Loss: 4.437050750891432 CE Loss: 0.2209629416345151 Con Loss: 4.434841123972283
[20 / 20] tensor([[0.916, 0.420],
        [0.892, 0.933]]) {'epoch': 20, 'valid/acc': 84.568, 'valid/acc_unbiased': 76.688, 'valid/diff': 31.665, 'valid/acc_skew': 88.406, 'valid/acc_align': 64.97, 'test/acc': 86.955, 'test/acc_unbiased': 79.037, 'test/diff': 26.871, 'test/acc_skew': 90.385, 'test/acc_align': 67.689}
[20 / 20] best valid accuracy: 79.503 at epoch 10 
 best_stats: {'best_valid_epoch': 10, 'best_valid_valid/acc': 85.185, 'best_valid_valid/acc_unbiased': 79.503, 'best_valid_valid/diff': 25.909, 'best_valid_valid/acc_skew': 87.599, 'best_valid_valid/acc_align': 71.406, 'best_valid_test/acc': 86.426, 'best_valid_test/acc_unbiased': 78.334, 'best_valid_test/diff': 25.96, 'best_valid_test/acc_skew': 89.661, 'best_valid_test/acc_align': 67.008}
[20 / 20] best test accuracy: 79.459 at epoch 16 
 best_stats: {'best_test_epoch': 16, 'best_test_valid/acc': 84.568, 'best_test_valid/acc_unbiased': 77.009, 'best_test_valid/diff': 31.489, 'best_test_valid/acc_skew': 88.004, 'best_test_valid/acc_align': 66.013, 'best_test_test/acc': 87.043, 'best_test_test/acc_unbiased': 79.459, 'best_test_test/diff': 26.835, 'best_test_test/acc_skew': 90.111, 'best_test_test/acc_align': 68.807}
Total training time: 0:40:09
