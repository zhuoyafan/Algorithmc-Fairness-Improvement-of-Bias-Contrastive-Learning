Log level set to: INFO
Set seed: 1
=======> Using Fixed Random Seed: 1 <========
save_path: exp_results/bc-bb0-utk_face_race-crop_rotate_color-0.9-lr0.001-bs128-cbs64-w0.01-ratio10-aug1-seed1
get_utk_face - split: train, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_race-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [4407, 552]
Target 1: [440, 5529]
Binary Target 1
---------------------------
Target 0: [4407, 552]
Target 1: [440, 5529]
===================================
Normal Label Distribution: 
Target 0: [4407, 552]
Target 1: [440, 5529]
===================================
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [4407, 552]
Target 1: [440, 5529]
Binary Target 1
---------------------------
Target 0: [4407, 552]
Target 1: [440, 5529]
===================================
Normal Label Distribution: 
Target 0: [4407, 552]
Target 1: [440, 5529]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 10928, target_attr: gender, bias_attr: race bias_rate: 0.9
['[train] target_0-bias_0: 4407', '[train] target_0-bias_1: 552', '[train] target_1-bias_0: 440', '[train] target_1-bias_1: 5529']
confusion_matrix - 
 original: tensor([[4407.,  440.],
        [ 552., 5529.]]), 
 normalized: tensor([[0.909, 0.091],
        [0.091, 0.909]]), 
 b|y: tensor([[0.889, 0.111],
        [0.074, 0.926]])
get_utk_face - split: train, aug: 1, given_y: True, ratio: 10
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_race-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [4407, 552]
Target 1: [440, 5529]
Binary Target 1
---------------------------
Target 0: [4407, 552]
Target 1: [440, 5529]
===================================
Normal Label Distribution: 
Target 0: [4407, 552]
Target 1: [440, 5529]
===================================
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [4407, 552]
Target 1: [440, 5529]
Binary Target 1
---------------------------
Target 0: [4407, 552]
Target 1: [440, 5529]
===================================
Normal Label Distribution: 
Target 0: [4407, 552]
Target 1: [440, 5529]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 10928, target_attr: gender, bias_attr: race bias_rate: 0.9
['[train] target_0-bias_0: 4407', '[train] target_0-bias_1: 552', '[train] target_1-bias_0: 440', '[train] target_1-bias_1: 5529']
get_utk_face - split: valid, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_race-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [583, 684]
Target 1: [457, 646]
Binary Target 1
---------------------------
Target 0: [583, 684]
Target 1: [457, 646]
===================================
Normal Label Distribution: 
Target 0: [583, 684]
Target 1: [457, 646]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 2370, target_attr: gender, bias_attr: race bias_rate: 0.9
['[valid] target_0-bias_0: 583', '[valid] target_0-bias_1: 684', '[valid] target_1-bias_0: 457', '[valid] target_1-bias_1: 646']
get_utk_face - split: test, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_race-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [558, 677]
Target 1: [462, 673]
Binary Target 1
---------------------------
Target 0: [558, 677]
Target 1: [462, 673]
===================================
Normal Label Distribution: 
Target 0: [558, 677]
Target 1: [462, 673]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 2370, target_attr: gender, bias_attr: race bias_rate: 0.9
['[test] target_0-bias_0: 558', '[test] target_0-bias_1: 677', '[test] target_1-bias_0: 462', '[test] target_1-bias_1: 673']
decay_epochs: [6, 13]
[1 / 20] Learning rate: 0.001 weight: 0.01
[1 / 20] Loss: 4.920698824948134 CE Loss: 0.6553389492006986 Con Loss: 4.914145431267221
[1 / 20] tensor([[0.649, 0.560],
        [0.734, 0.810]]) {'epoch': 1, 'valid/acc': 67.173, 'valid/acc_unbiased': 67.65, 'valid/diff': 3.079, 'valid/acc_skew': 66.11, 'valid/acc_align': 69.19, 'test/acc': 68.565, 'test/acc_unbiased': 68.804, 'test/diff': 8.248, 'test/acc_skew': 64.679, 'test/acc_align': 72.928}
[1 / 20] best valid accuracy: 67.650 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 67.173, 'best_valid_valid/acc_unbiased': 67.65, 'best_valid_valid/diff': 3.079, 'best_valid_valid/acc_skew': 66.11, 'best_valid_valid/acc_align': 69.19, 'best_valid_test/acc': 68.565, 'best_valid_test/acc_unbiased': 68.804, 'best_valid_test/diff': 8.248, 'best_valid_test/acc_skew': 64.679, 'best_valid_test/acc_align': 72.928}
[1 / 20] best test accuracy: 68.804 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 67.173, 'best_test_valid/acc_unbiased': 67.65, 'best_test_valid/diff': 3.079, 'best_test_valid/acc_skew': 66.11, 'best_test_valid/acc_align': 69.19, 'best_test_test/acc': 68.565, 'best_test_test/acc_unbiased': 68.804, 'best_test_test/diff': 8.248, 'best_test_test/acc_skew': 64.679, 'best_test_test/acc_align': 72.928}
[2 / 20] Learning rate: 0.001 weight: 0.01
[2 / 20] Loss: 4.842427208343327 CE Loss: 0.5816169834939836 Con Loss: 4.836611017475715
[2 / 20] tensor([[0.876, 0.839],
        [0.563, 0.603]]) {'epoch': 2, 'valid/acc': 72.489, 'valid/acc_unbiased': 71.481, 'valid/diff': 1.638, 'valid/acc_skew': 70.662, 'valid/acc_align': 72.3, 'test/acc': 72.7, 'test/acc_unbiased': 72.034, 'test/diff': 3.892, 'test/acc_skew': 70.088, 'test/acc_align': 73.981}
[2 / 20] best valid accuracy: 71.481 at epoch 2 
 best_stats: {'best_valid_epoch': 2, 'best_valid_valid/acc': 72.489, 'best_valid_valid/acc_unbiased': 71.481, 'best_valid_valid/diff': 1.638, 'best_valid_valid/acc_skew': 70.662, 'best_valid_valid/acc_align': 72.3, 'best_valid_test/acc': 72.7, 'best_valid_test/acc_unbiased': 72.034, 'best_valid_test/diff': 3.892, 'best_valid_test/acc_skew': 70.088, 'best_valid_test/acc_align': 73.981}
[2 / 20] best test accuracy: 72.034 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 72.489, 'best_test_valid/acc_unbiased': 71.481, 'best_test_valid/diff': 1.638, 'best_test_valid/acc_skew': 70.662, 'best_test_valid/acc_align': 72.3, 'best_test_test/acc': 72.7, 'best_test_test/acc_unbiased': 72.034, 'best_test_test/diff': 3.892, 'best_test_test/acc_skew': 70.088, 'best_test_test/acc_align': 73.981}
[3 / 20] Learning rate: 0.001 weight: 0.01
[3 / 20] Loss: 4.834536837274822 CE Loss: 0.5582265848645703 Con Loss: 4.828954584252957
[3 / 20] tensor([[0.914, 0.888],
        [0.489, 0.519]]) {'epoch': 3, 'valid/acc': 70.549, 'valid/acc_unbiased': 69.115, 'valid/diff': 3.758, 'valid/acc_skew': 67.236, 'valid/acc_align': 70.994, 'test/acc': 71.139, 'test/acc_unbiased': 70.237, 'test/diff': 2.782, 'test/acc_skew': 68.846, 'test/acc_align': 71.628}
[3 / 20] best valid accuracy: 71.481 at epoch 2 
 best_stats: {'best_valid_epoch': 2, 'best_valid_valid/acc': 72.489, 'best_valid_valid/acc_unbiased': 71.481, 'best_valid_valid/diff': 1.638, 'best_valid_valid/acc_skew': 70.662, 'best_valid_valid/acc_align': 72.3, 'best_valid_test/acc': 72.7, 'best_valid_test/acc_unbiased': 72.034, 'best_valid_test/diff': 3.892, 'best_valid_test/acc_skew': 70.088, 'best_valid_test/acc_align': 73.981}
[3 / 20] best test accuracy: 72.034 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 72.489, 'best_test_valid/acc_unbiased': 71.481, 'best_test_valid/diff': 1.638, 'best_test_valid/acc_skew': 70.662, 'best_test_valid/acc_align': 72.3, 'best_test_test/acc': 72.7, 'best_test_test/acc_unbiased': 72.034, 'best_test_test/diff': 3.892, 'best_test_test/acc_skew': 70.088, 'best_test_test/acc_align': 73.981}
[4 / 20] Learning rate: 0.001 weight: 0.01
[4 / 20] Loss: 4.831469361988028 CE Loss: 0.5534625644216077 Con Loss: 4.825934739622504
[4 / 20] tensor([[0.880, 0.805],
        [0.606, 0.703]]) {'epoch': 4, 'valid/acc': 74.515, 'valid/acc_unbiased': 73.796, 'valid/diff': 5.986, 'valid/acc_skew': 70.802, 'valid/acc_align': 76.789, 'test/acc': 75.485, 'test/acc_unbiased': 74.846, 'test/diff': 8.583, 'test/acc_skew': 70.554, 'test/acc_align': 79.138}
[4 / 20] best valid accuracy: 73.796 at epoch 4 
 best_stats: {'best_valid_epoch': 4, 'best_valid_valid/acc': 74.515, 'best_valid_valid/acc_unbiased': 73.796, 'best_valid_valid/diff': 5.986, 'best_valid_valid/acc_skew': 70.802, 'best_valid_valid/acc_align': 76.789, 'best_valid_test/acc': 75.485, 'best_valid_test/acc_unbiased': 74.846, 'best_valid_test/diff': 8.583, 'best_valid_test/acc_skew': 70.554, 'best_valid_test/acc_align': 79.138}
[4 / 20] best test accuracy: 74.846 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 74.515, 'best_test_valid/acc_unbiased': 73.796, 'best_test_valid/diff': 5.986, 'best_test_valid/acc_skew': 70.802, 'best_test_valid/acc_align': 76.789, 'best_test_test/acc': 75.485, 'best_test_test/acc_unbiased': 74.846, 'best_test_test/diff': 8.583, 'best_test_test/acc_skew': 70.554, 'best_test_test/acc_align': 79.138}
[5 / 20] Learning rate: 0.001 weight: 0.01
[5 / 20] Loss: 4.824790077712142 CE Loss: 0.5431614571399604 Con Loss: 4.81935845287094
[5 / 20] tensor([[0.756, 0.687],
        [0.738, 0.768]]) {'epoch': 5, 'valid/acc': 72.447, 'valid/acc_unbiased': 72.501, 'valid/diff': 2.033, 'valid/acc_skew': 71.484, 'valid/acc_align': 73.517, 'test/acc': 73.629, 'test/acc_unbiased': 73.736, 'test/diff': 4.976, 'test/acc_skew': 71.247, 'test/acc_align': 76.224}
[5 / 20] best valid accuracy: 73.796 at epoch 4 
 best_stats: {'best_valid_epoch': 4, 'best_valid_valid/acc': 74.515, 'best_valid_valid/acc_unbiased': 73.796, 'best_valid_valid/diff': 5.986, 'best_valid_valid/acc_skew': 70.802, 'best_valid_valid/acc_align': 76.789, 'best_valid_test/acc': 75.485, 'best_valid_test/acc_unbiased': 74.846, 'best_valid_test/diff': 8.583, 'best_valid_test/acc_skew': 70.554, 'best_valid_test/acc_align': 79.138}
[5 / 20] best test accuracy: 74.846 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 74.515, 'best_test_valid/acc_unbiased': 73.796, 'best_test_valid/diff': 5.986, 'best_test_valid/acc_skew': 70.802, 'best_test_valid/acc_align': 76.789, 'best_test_test/acc': 75.485, 'best_test_test/acc_unbiased': 74.846, 'best_test_test/diff': 8.583, 'best_test_test/acc_skew': 70.554, 'best_test_test/acc_align': 79.138}
[6 / 20] Learning rate: 0.001 weight: 0.01
[6 / 20] Loss: 4.814044446233076 CE Loss: 0.5432252619486427 Con Loss: 4.808612179791072
[6 / 20] tensor([[0.794, 0.722],
        [0.695, 0.792]]) {'epoch': 6, 'valid/acc': 74.262, 'valid/acc_unbiased': 74.294, 'valid/diff': 5.693, 'valid/acc_skew': 71.447, 'valid/acc_align': 77.14, 'test/acc': 75.359, 'test/acc_unbiased': 75.075, 'test/diff': 8.439, 'test/acc_skew': 70.855, 'test/acc_align': 79.294}
[6 / 20] best valid accuracy: 74.294 at epoch 6 
 best_stats: {'best_valid_epoch': 6, 'best_valid_valid/acc': 74.262, 'best_valid_valid/acc_unbiased': 74.294, 'best_valid_valid/diff': 5.693, 'best_valid_valid/acc_skew': 71.447, 'best_valid_valid/acc_align': 77.14, 'best_valid_test/acc': 75.359, 'best_valid_test/acc_unbiased': 75.075, 'best_valid_test/diff': 8.439, 'best_valid_test/acc_skew': 70.855, 'best_valid_test/acc_align': 79.294}
[6 / 20] best test accuracy: 75.075 at epoch 6 
 best_stats: {'best_test_epoch': 6, 'best_test_valid/acc': 74.262, 'best_test_valid/acc_unbiased': 74.294, 'best_test_valid/diff': 5.693, 'best_test_valid/acc_skew': 71.447, 'best_test_valid/acc_align': 77.14, 'best_test_test/acc': 75.359, 'best_test_test/acc_unbiased': 75.075, 'best_test_test/diff': 8.439, 'best_test_test/acc_skew': 70.855, 'best_test_test/acc_align': 79.294}
[7 / 20] Learning rate: 0.0001 weight: 0.01
[7 / 20] Loss: 4.793188951724096 CE Loss: 0.5006766896558541 Con Loss: 4.788182185300098
[7 / 20] tensor([[0.729, 0.674],
        [0.844, 0.854]]) {'epoch': 7, 'valid/acc': 76.498, 'valid/acc_unbiased': 77.091, 'valid/diff': 3.342, 'valid/acc_skew': 75.42, 'valid/acc_align': 78.762, 'test/acc': 77.131, 'test/acc_unbiased': 77.537, 'test/diff': 3.303, 'test/acc_skew': 75.886, 'test/acc_align': 79.189}
[7 / 20] best valid accuracy: 77.091 at epoch 7 
 best_stats: {'best_valid_epoch': 7, 'best_valid_valid/acc': 76.498, 'best_valid_valid/acc_unbiased': 77.091, 'best_valid_valid/diff': 3.342, 'best_valid_valid/acc_skew': 75.42, 'best_valid_valid/acc_align': 78.762, 'best_valid_test/acc': 77.131, 'best_valid_test/acc_unbiased': 77.537, 'best_valid_test/diff': 3.303, 'best_valid_test/acc_skew': 75.886, 'best_valid_test/acc_align': 79.189}
[7 / 20] best test accuracy: 77.537 at epoch 7 
 best_stats: {'best_test_epoch': 7, 'best_test_valid/acc': 76.498, 'best_test_valid/acc_unbiased': 77.091, 'best_test_valid/diff': 3.342, 'best_test_valid/acc_skew': 75.42, 'best_test_valid/acc_align': 78.762, 'best_test_test/acc': 77.131, 'best_test_test/acc_unbiased': 77.537, 'best_test_test/diff': 3.303, 'best_test_test/acc_skew': 75.886, 'best_test_test/acc_align': 79.189}
[8 / 20] Learning rate: 0.0001 weight: 0.01
[8 / 20] Loss: 4.777223938206104 CE Loss: 0.4841459979075464 Con Loss: 4.772382536534858
[8 / 20] tensor([[0.758, 0.699],
        [0.797, 0.840]]) {'epoch': 8, 'valid/acc': 76.835, 'valid/acc_unbiased': 77.078, 'valid/diff': 5.426, 'valid/acc_skew': 74.365, 'valid/acc_align': 79.791, 'test/acc': 77.173, 'test/acc_unbiased': 77.32, 'test/diff': 5.119, 'test/acc_skew': 74.76, 'test/acc_align': 79.879}
[8 / 20] best valid accuracy: 77.091 at epoch 7 
 best_stats: {'best_valid_epoch': 7, 'best_valid_valid/acc': 76.498, 'best_valid_valid/acc_unbiased': 77.091, 'best_valid_valid/diff': 3.342, 'best_valid_valid/acc_skew': 75.42, 'best_valid_valid/acc_align': 78.762, 'best_valid_test/acc': 77.131, 'best_valid_test/acc_unbiased': 77.537, 'best_valid_test/diff': 3.303, 'best_valid_test/acc_skew': 75.886, 'best_valid_test/acc_align': 79.189}
[8 / 20] best test accuracy: 77.537 at epoch 7 
 best_stats: {'best_test_epoch': 7, 'best_test_valid/acc': 76.498, 'best_test_valid/acc_unbiased': 77.091, 'best_test_valid/diff': 3.342, 'best_test_valid/acc_skew': 75.42, 'best_test_valid/acc_align': 78.762, 'best_test_test/acc': 77.131, 'best_test_test/acc_unbiased': 77.537, 'best_test_test/diff': 3.303, 'best_test_test/acc_skew': 75.886, 'best_test_test/acc_align': 79.189}
[9 / 20] Learning rate: 0.0001 weight: 0.01
[9 / 20] Loss: 4.769151696698033 CE Loss: 0.4770445542663641 Con Loss: 4.764381253701876
[9 / 20] tensor([[0.765, 0.693],
        [0.807, 0.859]]) {'epoch': 9, 'valid/acc': 78.059, 'valid/acc_unbiased': 78.43, 'valid/diff': 5.214, 'valid/acc_skew': 75.823, 'valid/acc_align': 81.038, 'test/acc': 77.932, 'test/acc_unbiased': 78.105, 'test/diff': 6.198, 'test/acc_skew': 75.006, 'test/acc_align': 81.204}
[9 / 20] best valid accuracy: 78.430 at epoch 9 
 best_stats: {'best_valid_epoch': 9, 'best_valid_valid/acc': 78.059, 'best_valid_valid/acc_unbiased': 78.43, 'best_valid_valid/diff': 5.214, 'best_valid_valid/acc_skew': 75.823, 'best_valid_valid/acc_align': 81.038, 'best_valid_test/acc': 77.932, 'best_valid_test/acc_unbiased': 78.105, 'best_valid_test/diff': 6.198, 'best_valid_test/acc_skew': 75.006, 'best_valid_test/acc_align': 81.204}
[9 / 20] best test accuracy: 78.105 at epoch 9 
 best_stats: {'best_test_epoch': 9, 'best_test_valid/acc': 78.059, 'best_test_valid/acc_unbiased': 78.43, 'best_test_valid/diff': 5.214, 'best_test_valid/acc_skew': 75.823, 'best_test_valid/acc_align': 81.038, 'best_test_test/acc': 77.932, 'best_test_test/acc_unbiased': 78.105, 'best_test_test/diff': 6.198, 'best_test_test/acc_skew': 75.006, 'best_test_test/acc_align': 81.204}
[10 / 20] Learning rate: 0.0001 weight: 0.01
[10 / 20] Loss: 4.770336438063123 CE Loss: 0.4660981537918744 Con Loss: 4.765675494471895
[10 / 20] tensor([[0.720, 0.647],
        [0.857, 0.890]]) {'epoch': 10, 'valid/acc': 77.637, 'valid/acc_unbiased': 78.333, 'valid/diff': 4.954, 'valid/acc_skew': 75.855, 'valid/acc_align': 80.81, 'test/acc': 77.426, 'test/acc_unbiased': 77.865, 'test/diff': 5.318, 'test/acc_skew': 75.206, 'test/acc_align': 80.524}
[10 / 20] best valid accuracy: 78.430 at epoch 9 
 best_stats: {'best_valid_epoch': 9, 'best_valid_valid/acc': 78.059, 'best_valid_valid/acc_unbiased': 78.43, 'best_valid_valid/diff': 5.214, 'best_valid_valid/acc_skew': 75.823, 'best_valid_valid/acc_align': 81.038, 'best_valid_test/acc': 77.932, 'best_valid_test/acc_unbiased': 78.105, 'best_valid_test/diff': 6.198, 'best_valid_test/acc_skew': 75.006, 'best_valid_test/acc_align': 81.204}
[10 / 20] best test accuracy: 78.105 at epoch 9 
 best_stats: {'best_test_epoch': 9, 'best_test_valid/acc': 78.059, 'best_test_valid/acc_unbiased': 78.43, 'best_test_valid/diff': 5.214, 'best_test_valid/acc_skew': 75.823, 'best_test_valid/acc_align': 81.038, 'best_test_test/acc': 77.932, 'best_test_test/acc_unbiased': 78.105, 'best_test_test/diff': 6.198, 'best_test_test/acc_skew': 75.006, 'best_test_test/acc_align': 81.204}
[11 / 20] Learning rate: 0.0001 weight: 0.01
[11 / 20] Loss: 4.752781738124864 CE Loss: 0.46295221038653595 Con Loss: 4.748152223198864
[11 / 20] tensor([[0.769, 0.693],
        [0.833, 0.862]]) {'epoch': 11, 'valid/acc': 78.565, 'valid/acc_unbiased': 79.119, 'valid/diff': 4.916, 'valid/acc_skew': 76.661, 'valid/acc_align': 81.577, 'test/acc': 78.608, 'test/acc_unbiased': 78.918, 'test/diff': 5.227, 'test/acc_skew': 76.305, 'test/acc_align': 81.532}
[11 / 20] best valid accuracy: 79.119 at epoch 11 
 best_stats: {'best_valid_epoch': 11, 'best_valid_valid/acc': 78.565, 'best_valid_valid/acc_unbiased': 79.119, 'best_valid_valid/diff': 4.916, 'best_valid_valid/acc_skew': 76.661, 'best_valid_valid/acc_align': 81.577, 'best_valid_test/acc': 78.608, 'best_valid_test/acc_unbiased': 78.918, 'best_valid_test/diff': 5.227, 'best_valid_test/acc_skew': 76.305, 'best_valid_test/acc_align': 81.532}
[11 / 20] best test accuracy: 78.918 at epoch 11 
 best_stats: {'best_test_epoch': 11, 'best_test_valid/acc': 78.565, 'best_test_valid/acc_unbiased': 79.119, 'best_test_valid/diff': 4.916, 'best_test_valid/acc_skew': 76.661, 'best_test_valid/acc_align': 81.577, 'best_test_test/acc': 78.608, 'best_test_test/acc_unbiased': 78.918, 'best_test_test/diff': 5.227, 'best_test_test/acc_skew': 76.305, 'best_test_test/acc_align': 81.532}
[12 / 20] Learning rate: 0.0001 weight: 0.01
[12 / 20] Loss: 4.748076919929873 CE Loss: 0.4595303473500521 Con Loss: 4.743481595554603
[12 / 20] tensor([[0.726, 0.629],
        [0.859, 0.890]]) {'epoch': 12, 'valid/acc': 77.384, 'valid/acc_unbiased': 78.191, 'valid/diff': 4.894, 'valid/acc_skew': 75.744, 'valid/acc_align': 80.638, 'test/acc': 77.089, 'test/acc_unbiased': 77.61, 'test/diff': 6.365, 'test/acc_skew': 74.428, 'test/acc_align': 80.793}
[12 / 20] best valid accuracy: 79.119 at epoch 11 
 best_stats: {'best_valid_epoch': 11, 'best_valid_valid/acc': 78.565, 'best_valid_valid/acc_unbiased': 79.119, 'best_valid_valid/diff': 4.916, 'best_valid_valid/acc_skew': 76.661, 'best_valid_valid/acc_align': 81.577, 'best_valid_test/acc': 78.608, 'best_valid_test/acc_unbiased': 78.918, 'best_valid_test/diff': 5.227, 'best_valid_test/acc_skew': 76.305, 'best_valid_test/acc_align': 81.532}
[12 / 20] best test accuracy: 78.918 at epoch 11 
 best_stats: {'best_test_epoch': 11, 'best_test_valid/acc': 78.565, 'best_test_valid/acc_unbiased': 79.119, 'best_test_valid/diff': 4.916, 'best_test_valid/acc_skew': 76.661, 'best_test_valid/acc_align': 81.577, 'best_test_test/acc': 78.608, 'best_test_test/acc_unbiased': 78.918, 'best_test_test/diff': 5.227, 'best_test_test/acc_skew': 76.305, 'best_test_test/acc_align': 81.532}
[13 / 20] Learning rate: 0.0001 weight: 0.01
[13 / 20] Loss: 4.746495098181036 CE Loss: 0.4460846126341366 Con Loss: 4.742034251658494
[13 / 20] tensor([[0.751, 0.662],
        [0.842, 0.899]]) {'epoch': 13, 'valid/acc': 79.03, 'valid/acc_unbiased': 79.704, 'valid/diff': 7.478, 'valid/acc_skew': 75.965, 'valid/acc_align': 83.443, 'test/acc': 78.523, 'test/acc_unbiased': 78.84, 'test/diff': 7.306, 'test/acc_skew': 75.187, 'test/acc_align': 82.493}
[13 / 20] best valid accuracy: 79.704 at epoch 13 
 best_stats: {'best_valid_epoch': 13, 'best_valid_valid/acc': 79.03, 'best_valid_valid/acc_unbiased': 79.704, 'best_valid_valid/diff': 7.478, 'best_valid_valid/acc_skew': 75.965, 'best_valid_valid/acc_align': 83.443, 'best_valid_test/acc': 78.523, 'best_valid_test/acc_unbiased': 78.84, 'best_valid_test/diff': 7.306, 'best_valid_test/acc_skew': 75.187, 'best_valid_test/acc_align': 82.493}
[13 / 20] best test accuracy: 78.918 at epoch 11 
 best_stats: {'best_test_epoch': 11, 'best_test_valid/acc': 78.565, 'best_test_valid/acc_unbiased': 79.119, 'best_test_valid/diff': 4.916, 'best_test_valid/acc_skew': 76.661, 'best_test_valid/acc_align': 81.577, 'best_test_test/acc': 78.608, 'best_test_test/acc_unbiased': 78.918, 'best_test_test/diff': 5.227, 'best_test_test/acc_skew': 76.305, 'best_test_test/acc_align': 81.532}
[14 / 20] Learning rate: 1e-05 weight: 0.01
[14 / 20] Loss: 4.737237788573191 CE Loss: 0.4361936416406059 Con Loss: 4.732875825370911
[14 / 20] tensor([[0.744, 0.656],
        [0.846, 0.902]]) {'epoch': 14, 'valid/acc': 79.156, 'valid/acc_unbiased': 79.807, 'valid/diff': 6.807, 'valid/acc_skew': 76.404, 'valid/acc_align': 83.211, 'test/acc': 78.354, 'test/acc_unbiased': 78.695, 'test/diff': 7.175, 'test/acc_skew': 75.108, 'test/acc_align': 82.283}
[14 / 20] best valid accuracy: 79.807 at epoch 14 
 best_stats: {'best_valid_epoch': 14, 'best_valid_valid/acc': 79.156, 'best_valid_valid/acc_unbiased': 79.807, 'best_valid_valid/diff': 6.807, 'best_valid_valid/acc_skew': 76.404, 'best_valid_valid/acc_align': 83.211, 'best_valid_test/acc': 78.354, 'best_valid_test/acc_unbiased': 78.695, 'best_valid_test/diff': 7.175, 'best_valid_test/acc_skew': 75.108, 'best_valid_test/acc_align': 82.283}
[14 / 20] best test accuracy: 78.918 at epoch 11 
 best_stats: {'best_test_epoch': 11, 'best_test_valid/acc': 78.565, 'best_test_valid/acc_unbiased': 79.119, 'best_test_valid/diff': 4.916, 'best_test_valid/acc_skew': 76.661, 'best_test_valid/acc_align': 81.577, 'best_test_test/acc': 78.608, 'best_test_test/acc_unbiased': 78.918, 'best_test_test/diff': 5.227, 'best_test_test/acc_skew': 76.305, 'best_test_test/acc_align': 81.532}
[15 / 20] Learning rate: 1e-05 weight: 0.01
[15 / 20] Loss: 4.730065495866633 CE Loss: 0.4384864313885199 Con Loss: 4.7256806381974
[15 / 20] tensor([[0.751, 0.663],
        [0.857, 0.905]]) {'epoch': 15, 'valid/acc': 79.072, 'valid/acc_unbiased': 79.785, 'valid/diff': 6.254, 'valid/acc_skew': 76.658, 'valid/acc_align': 82.912, 'test/acc': 79.03, 'test/acc_unbiased': 79.404, 'test/diff': 6.772, 'test/acc_skew': 76.018, 'test/acc_align': 82.79}
[15 / 20] best valid accuracy: 79.807 at epoch 14 
 best_stats: {'best_valid_epoch': 14, 'best_valid_valid/acc': 79.156, 'best_valid_valid/acc_unbiased': 79.807, 'best_valid_valid/diff': 6.807, 'best_valid_valid/acc_skew': 76.404, 'best_valid_valid/acc_align': 83.211, 'best_valid_test/acc': 78.354, 'best_valid_test/acc_unbiased': 78.695, 'best_valid_test/diff': 7.175, 'best_valid_test/acc_skew': 75.108, 'best_valid_test/acc_align': 82.283}
[15 / 20] best test accuracy: 79.404 at epoch 15 
 best_stats: {'best_test_epoch': 15, 'best_test_valid/acc': 79.072, 'best_test_valid/acc_unbiased': 79.785, 'best_test_valid/diff': 6.254, 'best_test_valid/acc_skew': 76.658, 'best_test_valid/acc_align': 82.912, 'best_test_test/acc': 79.03, 'best_test_test/acc_unbiased': 79.404, 'best_test_test/diff': 6.772, 'best_test_test/acc_skew': 76.018, 'best_test_test/acc_align': 82.79}
[16 / 20] Learning rate: 1e-05 weight: 0.01
[16 / 20] Loss: 4.733079655453192 CE Loss: 0.43209923103473546 Con Loss: 4.728758683490893
[16 / 20] tensor([[0.742, 0.654],
        [0.859, 0.905]]) {'epoch': 16, 'valid/acc': 78.734, 'valid/acc_unbiased': 79.512, 'valid/diff': 6.219, 'valid/acc_skew': 76.402, 'valid/acc_align': 82.621, 'test/acc': 78.608, 'test/acc_unbiased': 79.013, 'test/diff': 6.659, 'test/acc_skew': 75.683, 'test/acc_align': 82.342}
[16 / 20] best valid accuracy: 79.807 at epoch 14 
 best_stats: {'best_valid_epoch': 14, 'best_valid_valid/acc': 79.156, 'best_valid_valid/acc_unbiased': 79.807, 'best_valid_valid/diff': 6.807, 'best_valid_valid/acc_skew': 76.404, 'best_valid_valid/acc_align': 83.211, 'best_valid_test/acc': 78.354, 'best_valid_test/acc_unbiased': 78.695, 'best_valid_test/diff': 7.175, 'best_valid_test/acc_skew': 75.108, 'best_valid_test/acc_align': 82.283}
[16 / 20] best test accuracy: 79.404 at epoch 15 
 best_stats: {'best_test_epoch': 15, 'best_test_valid/acc': 79.072, 'best_test_valid/acc_unbiased': 79.785, 'best_test_valid/diff': 6.254, 'best_test_valid/acc_skew': 76.658, 'best_test_valid/acc_align': 82.912, 'best_test_test/acc': 79.03, 'best_test_test/acc_unbiased': 79.404, 'best_test_test/diff': 6.772, 'best_test_test/acc_skew': 76.018, 'best_test_test/acc_align': 82.79}
[17 / 20] Learning rate: 1e-05 weight: 0.01
[17 / 20] Loss: 4.727940921727595 CE Loss: 0.4324321827113541 Con Loss: 4.723616594451413
[17 / 20] tensor([[0.753, 0.668],
        [0.859, 0.902]]) {'epoch': 17, 'valid/acc': 79.198, 'valid/acc_unbiased': 79.879, 'valid/diff': 6.149, 'valid/acc_skew': 76.805, 'valid/acc_align': 82.954, 'test/acc': 79.156, 'test/acc_unbiased': 79.539, 'test/diff': 6.383, 'test/acc_skew': 76.348, 'test/acc_align': 82.731}
[17 / 20] best valid accuracy: 79.879 at epoch 17 
 best_stats: {'best_valid_epoch': 17, 'best_valid_valid/acc': 79.198, 'best_valid_valid/acc_unbiased': 79.879, 'best_valid_valid/diff': 6.149, 'best_valid_valid/acc_skew': 76.805, 'best_valid_valid/acc_align': 82.954, 'best_valid_test/acc': 79.156, 'best_valid_test/acc_unbiased': 79.539, 'best_valid_test/diff': 6.383, 'best_valid_test/acc_skew': 76.348, 'best_valid_test/acc_align': 82.731}
[17 / 20] best test accuracy: 79.539 at epoch 17 
 best_stats: {'best_test_epoch': 17, 'best_test_valid/acc': 79.198, 'best_test_valid/acc_unbiased': 79.879, 'best_test_valid/diff': 6.149, 'best_test_valid/acc_skew': 76.805, 'best_test_valid/acc_align': 82.954, 'best_test_test/acc': 79.156, 'best_test_test/acc_unbiased': 79.539, 'best_test_test/diff': 6.383, 'best_test_test/acc_skew': 76.348, 'best_test_test/acc_align': 82.731}
[18 / 20] Learning rate: 1e-05 weight: 0.01
[18 / 20] Loss: 4.723869350260208 CE Loss: 0.43960997200466007 Con Loss: 4.719473260737094
[18 / 20] tensor([[0.754, 0.679],
        [0.840, 0.890]]) {'epoch': 18, 'valid/acc': 79.916, 'valid/acc_unbiased': 80.465, 'valid/diff': 6.074, 'valid/acc_skew': 77.428, 'valid/acc_align': 83.502, 'test/acc': 78.819, 'test/acc_unbiased': 79.095, 'test/diff': 6.261, 'test/acc_skew': 75.965, 'test/acc_align': 82.226}
[18 / 20] best valid accuracy: 80.465 at epoch 18 
 best_stats: {'best_valid_epoch': 18, 'best_valid_valid/acc': 79.916, 'best_valid_valid/acc_unbiased': 80.465, 'best_valid_valid/diff': 6.074, 'best_valid_valid/acc_skew': 77.428, 'best_valid_valid/acc_align': 83.502, 'best_valid_test/acc': 78.819, 'best_valid_test/acc_unbiased': 79.095, 'best_valid_test/diff': 6.261, 'best_valid_test/acc_skew': 75.965, 'best_valid_test/acc_align': 82.226}
[18 / 20] best test accuracy: 79.539 at epoch 17 
 best_stats: {'best_test_epoch': 17, 'best_test_valid/acc': 79.198, 'best_test_valid/acc_unbiased': 79.879, 'best_test_valid/diff': 6.149, 'best_test_valid/acc_skew': 76.805, 'best_test_valid/acc_align': 82.954, 'best_test_test/acc': 79.156, 'best_test_test/acc_unbiased': 79.539, 'best_test_test/diff': 6.383, 'best_test_test/acc_skew': 76.348, 'best_test_test/acc_align': 82.731}
[19 / 20] Learning rate: 1e-05 weight: 0.01
[19 / 20] Loss: 4.727476617776807 CE Loss: 0.4350240249759456 Con Loss: 4.723126359076661
[19 / 20] tensor([[0.754, 0.679],
        [0.851, 0.897]]) {'epoch': 19, 'valid/acc': 79.283, 'valid/acc_unbiased': 79.923, 'valid/diff': 6.162, 'valid/acc_skew': 76.842, 'valid/acc_align': 83.004, 'test/acc': 79.241, 'test/acc_unbiased': 79.552, 'test/diff': 6.092, 'test/acc_skew': 76.506, 'test/acc_align': 82.598}
[19 / 20] best valid accuracy: 80.465 at epoch 18 
 best_stats: {'best_valid_epoch': 18, 'best_valid_valid/acc': 79.916, 'best_valid_valid/acc_unbiased': 80.465, 'best_valid_valid/diff': 6.074, 'best_valid_valid/acc_skew': 77.428, 'best_valid_valid/acc_align': 83.502, 'best_valid_test/acc': 78.819, 'best_valid_test/acc_unbiased': 79.095, 'best_valid_test/diff': 6.261, 'best_valid_test/acc_skew': 75.965, 'best_valid_test/acc_align': 82.226}
[19 / 20] best test accuracy: 79.552 at epoch 19 
 best_stats: {'best_test_epoch': 19, 'best_test_valid/acc': 79.283, 'best_test_valid/acc_unbiased': 79.923, 'best_test_valid/diff': 6.162, 'best_test_valid/acc_skew': 76.842, 'best_test_valid/acc_align': 83.004, 'best_test_test/acc': 79.241, 'best_test_test/acc_unbiased': 79.552, 'best_test_test/diff': 6.092, 'best_test_test/acc_skew': 76.506, 'best_test_test/acc_align': 82.598}
[20 / 20] Learning rate: 1e-05 weight: 0.01
[20 / 20] Loss: 4.7234127720487935 CE Loss: 0.4333395196525803 Con Loss: 4.7190793639220745
[20 / 20] tensor([[0.756, 0.681],
        [0.842, 0.887]]) {'epoch': 20, 'valid/acc': 79.747, 'valid/acc_unbiased': 80.383, 'valid/diff': 5.912, 'valid/acc_skew': 77.427, 'valid/acc_align': 83.339, 'test/acc': 78.861, 'test/acc_unbiased': 79.157, 'test/diff': 6.02, 'test/acc_skew': 76.147, 'test/acc_align': 82.167}
[20 / 20] best valid accuracy: 80.465 at epoch 18 
 best_stats: {'best_valid_epoch': 18, 'best_valid_valid/acc': 79.916, 'best_valid_valid/acc_unbiased': 80.465, 'best_valid_valid/diff': 6.074, 'best_valid_valid/acc_skew': 77.428, 'best_valid_valid/acc_align': 83.502, 'best_valid_test/acc': 78.819, 'best_valid_test/acc_unbiased': 79.095, 'best_valid_test/diff': 6.261, 'best_valid_test/acc_skew': 75.965, 'best_valid_test/acc_align': 82.226}
[20 / 20] best test accuracy: 79.552 at epoch 19 
 best_stats: {'best_test_epoch': 19, 'best_test_valid/acc': 79.283, 'best_test_valid/acc_unbiased': 79.923, 'best_test_valid/diff': 6.162, 'best_test_valid/acc_skew': 76.842, 'best_test_valid/acc_align': 83.004, 'best_test_test/acc': 79.241, 'best_test_test/acc_unbiased': 79.552, 'best_test_test/diff': 6.092, 'best_test_test/acc_skew': 76.506, 'best_test_test/acc_align': 82.598}
Total training time: 0:12:33
