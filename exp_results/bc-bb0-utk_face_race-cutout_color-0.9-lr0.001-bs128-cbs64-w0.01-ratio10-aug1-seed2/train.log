Log level set to: INFO
Set seed: 2
=======> Using Fixed Random Seed: 2 <========
save_path: exp_results/bc-bb0-utk_face_race-cutout_color-0.9-lr0.001-bs128-cbs64-w0.01-ratio10-aug1-seed2
get_utk_face - split: train, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_race-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [4407, 552]
Target 1: [440, 5529]
Binary Target 1
---------------------------
Target 0: [4407, 552]
Target 1: [440, 5529]
===================================
Normal Label Distribution: 
Target 0: [4407, 552]
Target 1: [440, 5529]
===================================
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [4407, 552]
Target 1: [440, 5529]
Binary Target 1
---------------------------
Target 0: [4407, 552]
Target 1: [440, 5529]
===================================
Normal Label Distribution: 
Target 0: [4407, 552]
Target 1: [440, 5529]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 10928, target_attr: gender, bias_attr: race bias_rate: 0.9
['[train] target_0-bias_0: 4407', '[train] target_0-bias_1: 552', '[train] target_1-bias_0: 440', '[train] target_1-bias_1: 5529']
confusion_matrix - 
 original: tensor([[4407.,  440.],
        [ 552., 5529.]]), 
 normalized: tensor([[0.909, 0.091],
        [0.091, 0.909]]), 
 b|y: tensor([[0.889, 0.111],
        [0.074, 0.926]])
get_utk_face - split: train, aug: 1, given_y: True, ratio: 10
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_race-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [4407, 552]
Target 1: [440, 5529]
Binary Target 1
---------------------------
Target 0: [4407, 552]
Target 1: [440, 5529]
===================================
Normal Label Distribution: 
Target 0: [4407, 552]
Target 1: [440, 5529]
===================================
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [4407, 552]
Target 1: [440, 5529]
Binary Target 1
---------------------------
Target 0: [4407, 552]
Target 1: [440, 5529]
===================================
Normal Label Distribution: 
Target 0: [4407, 552]
Target 1: [440, 5529]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 10928, target_attr: gender, bias_attr: race bias_rate: 0.9
['[train] target_0-bias_0: 4407', '[train] target_0-bias_1: 552', '[train] target_1-bias_0: 440', '[train] target_1-bias_1: 5529']
get_utk_face - split: valid, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_race-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [583, 684]
Target 1: [457, 646]
Binary Target 1
---------------------------
Target 0: [583, 684]
Target 1: [457, 646]
===================================
Normal Label Distribution: 
Target 0: [583, 684]
Target 1: [457, 646]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 2370, target_attr: gender, bias_attr: race bias_rate: 0.9
['[valid] target_0-bias_0: 583', '[valid] target_0-bias_1: 684', '[valid] target_1-bias_0: 457', '[valid] target_1-bias_1: 646']
get_utk_face - split: test, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_race-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [558, 677]
Target 1: [462, 673]
Binary Target 1
---------------------------
Target 0: [558, 677]
Target 1: [462, 673]
===================================
Normal Label Distribution: 
Target 0: [558, 677]
Target 1: [462, 673]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 2370, target_attr: gender, bias_attr: race bias_rate: 0.9
['[test] target_0-bias_0: 558', '[test] target_0-bias_1: 677', '[test] target_1-bias_0: 462', '[test] target_1-bias_1: 673']
decay_epochs: [6, 13]
[1 / 20] Learning rate: 0.001 weight: 0.01
[1 / 20] Loss: 4.894481385260341 CE Loss: 0.5850533384878849 Con Loss: 4.8886308670043945
[1 / 20] tensor([[0.884, 0.842],
        [0.686, 0.692]]) {'epoch': 1, 'valid/acc': 78.27, 'valid/acc_unbiased': 77.67, 'valid/diff': 1.736, 'valid/acc_skew': 77.082, 'valid/acc_align': 78.257, 'test/acc': 77.89, 'test/acc_unbiased': 77.601, 'test/diff': 2.392, 'test/acc_skew': 76.405, 'test/acc_align': 78.797}
[1 / 20] best valid accuracy: 77.670 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 78.27, 'best_valid_valid/acc_unbiased': 77.67, 'best_valid_valid/diff': 1.736, 'best_valid_valid/acc_skew': 77.082, 'best_valid_valid/acc_align': 78.257, 'best_valid_test/acc': 77.89, 'best_valid_test/acc_unbiased': 77.601, 'best_valid_test/diff': 2.392, 'best_valid_test/acc_skew': 76.405, 'best_valid_test/acc_align': 78.797}
[1 / 20] best test accuracy: 77.601 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 78.27, 'best_test_valid/acc_unbiased': 77.67, 'best_test_valid/diff': 1.736, 'best_test_valid/acc_skew': 77.082, 'best_test_valid/acc_align': 78.257, 'best_test_test/acc': 77.89, 'best_test_test/acc_unbiased': 77.601, 'best_test_test/diff': 2.392, 'best_test_test/acc_skew': 76.405, 'best_test_test/acc_align': 78.797}
[2 / 20] Learning rate: 0.001 weight: 0.01
[2 / 20] Loss: 4.743417894159543 CE Loss: 0.5154631150065544 Con Loss: 4.738263258647779
[2 / 20] tensor([[0.832, 0.778],
        [0.753, 0.832]]) {'epoch': 2, 'valid/acc': 78.523, 'valid/acc_unbiased': 78.376, 'valid/diff': 5.821, 'valid/acc_skew': 75.466, 'valid/acc_align': 81.286, 'test/acc': 80.127, 'test/acc_unbiased': 79.883, 'test/diff': 6.598, 'test/acc_skew': 76.584, 'test/acc_align': 83.182}
[2 / 20] best valid accuracy: 78.376 at epoch 2 
 best_stats: {'best_valid_epoch': 2, 'best_valid_valid/acc': 78.523, 'best_valid_valid/acc_unbiased': 78.376, 'best_valid_valid/diff': 5.821, 'best_valid_valid/acc_skew': 75.466, 'best_valid_valid/acc_align': 81.286, 'best_valid_test/acc': 80.127, 'best_valid_test/acc_unbiased': 79.883, 'best_valid_test/diff': 6.598, 'best_valid_test/acc_skew': 76.584, 'best_valid_test/acc_align': 83.182}
[2 / 20] best test accuracy: 79.883 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 78.523, 'best_test_valid/acc_unbiased': 78.376, 'best_test_valid/diff': 5.821, 'best_test_valid/acc_skew': 75.466, 'best_test_valid/acc_align': 81.286, 'best_test_test/acc': 80.127, 'best_test_test/acc_unbiased': 79.883, 'best_test_test/diff': 6.598, 'best_test_test/acc_skew': 76.584, 'best_test_test/acc_align': 83.182}
[3 / 20] Learning rate: 0.001 weight: 0.01
[3 / 20] Loss: 4.68953150432246 CE Loss: 0.49932634708298423 Con Loss: 4.684538253404385
[3 / 20] tensor([[0.686, 0.616],
        [0.898, 0.930]]) {'epoch': 3, 'valid/acc': 77.595, 'valid/acc_unbiased': 78.688, 'valid/diff': 7.063, 'valid/acc_skew': 75.156, 'valid/acc_align': 82.22, 'test/acc': 77.679, 'test/acc_unbiased': 78.269, 'test/diff': 5.116, 'test/acc_skew': 75.711, 'test/acc_align': 80.827}
[3 / 20] best valid accuracy: 78.688 at epoch 3 
 best_stats: {'best_valid_epoch': 3, 'best_valid_valid/acc': 77.595, 'best_valid_valid/acc_unbiased': 78.688, 'best_valid_valid/diff': 7.063, 'best_valid_valid/acc_skew': 75.156, 'best_valid_valid/acc_align': 82.22, 'best_valid_test/acc': 77.679, 'best_valid_test/acc_unbiased': 78.269, 'best_valid_test/diff': 5.116, 'best_valid_test/acc_skew': 75.711, 'best_valid_test/acc_align': 80.827}
[3 / 20] best test accuracy: 79.883 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 78.523, 'best_test_valid/acc_unbiased': 78.376, 'best_test_valid/diff': 5.821, 'best_test_valid/acc_skew': 75.466, 'best_test_valid/acc_align': 81.286, 'best_test_test/acc': 80.127, 'best_test_test/acc_unbiased': 79.883, 'best_test_test/diff': 6.598, 'best_test_test/acc_skew': 76.584, 'best_test_test/acc_align': 83.182}
[4 / 20] Learning rate: 0.001 weight: 0.01
[4 / 20] Loss: 4.640287779086156 CE Loss: 0.47798668234274994 Con Loss: 4.635507903371339
[4 / 20] tensor([[0.772, 0.682],
        [0.887, 0.905]]) {'epoch': 4, 'valid/acc': 79.241, 'valid/acc_unbiased': 79.925, 'valid/diff': 4.049, 'valid/acc_skew': 77.901, 'valid/acc_align': 81.95, 'test/acc': 80.675, 'test/acc_unbiased': 81.179, 'test/diff': 5.372, 'test/acc_skew': 78.493, 'test/acc_align': 83.865}
[4 / 20] best valid accuracy: 79.925 at epoch 4 
 best_stats: {'best_valid_epoch': 4, 'best_valid_valid/acc': 79.241, 'best_valid_valid/acc_unbiased': 79.925, 'best_valid_valid/diff': 4.049, 'best_valid_valid/acc_skew': 77.901, 'best_valid_valid/acc_align': 81.95, 'best_valid_test/acc': 80.675, 'best_valid_test/acc_unbiased': 81.179, 'best_valid_test/diff': 5.372, 'best_valid_test/acc_skew': 78.493, 'best_valid_test/acc_align': 83.865}
[4 / 20] best test accuracy: 81.179 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 79.241, 'best_test_valid/acc_unbiased': 79.925, 'best_test_valid/diff': 4.049, 'best_test_valid/acc_skew': 77.901, 'best_test_valid/acc_align': 81.95, 'best_test_test/acc': 80.675, 'best_test_test/acc_unbiased': 81.179, 'best_test_test/diff': 5.372, 'best_test_test/acc_skew': 78.493, 'best_test_test/acc_align': 83.865}
[5 / 20] Learning rate: 0.001 weight: 0.01
[5 / 20] Loss: 4.613094520429217 CE Loss: 0.4606748738191138 Con Loss: 4.608487777095588
[5 / 20] tensor([[0.837, 0.728],
        [0.829, 0.872]]) {'epoch': 5, 'valid/acc': 79.283, 'valid/acc_unbiased': 79.6, 'valid/diff': 7.039, 'valid/acc_skew': 76.08, 'valid/acc_align': 83.119, 'test/acc': 81.435, 'test/acc_unbiased': 81.659, 'test/diff': 7.596, 'test/acc_skew': 77.861, 'test/acc_align': 85.457}
[5 / 20] best valid accuracy: 79.925 at epoch 4 
 best_stats: {'best_valid_epoch': 4, 'best_valid_valid/acc': 79.241, 'best_valid_valid/acc_unbiased': 79.925, 'best_valid_valid/diff': 4.049, 'best_valid_valid/acc_skew': 77.901, 'best_valid_valid/acc_align': 81.95, 'best_valid_test/acc': 80.675, 'best_valid_test/acc_unbiased': 81.179, 'best_valid_test/diff': 5.372, 'best_valid_test/acc_skew': 78.493, 'best_valid_test/acc_align': 83.865}
[5 / 20] best test accuracy: 81.659 at epoch 5 
 best_stats: {'best_test_epoch': 5, 'best_test_valid/acc': 79.283, 'best_test_valid/acc_unbiased': 79.6, 'best_test_valid/diff': 7.039, 'best_test_valid/acc_skew': 76.08, 'best_test_valid/acc_align': 83.119, 'best_test_test/acc': 81.435, 'best_test_test/acc_unbiased': 81.659, 'best_test_test/diff': 7.596, 'best_test_test/acc_skew': 77.861, 'best_test_test/acc_align': 85.457}
[6 / 20] Learning rate: 0.001 weight: 0.01
[6 / 20] Loss: 4.600260009179178 CE Loss: 0.4632259527900383 Con Loss: 4.595627757501114
[6 / 20] tensor([[0.837, 0.727],
        [0.853, 0.893]]) {'epoch': 6, 'valid/acc': 81.561, 'valid/acc_unbiased': 81.735, 'valid/diff': 8.094, 'valid/acc_skew': 77.688, 'valid/acc_align': 85.782, 'test/acc': 82.447, 'test/acc_unbiased': 82.737, 'test/diff': 7.519, 'test/acc_skew': 78.977, 'test/acc_align': 86.497}
[6 / 20] best valid accuracy: 81.735 at epoch 6 
 best_stats: {'best_valid_epoch': 6, 'best_valid_valid/acc': 81.561, 'best_valid_valid/acc_unbiased': 81.735, 'best_valid_valid/diff': 8.094, 'best_valid_valid/acc_skew': 77.688, 'best_valid_valid/acc_align': 85.782, 'best_valid_test/acc': 82.447, 'best_valid_test/acc_unbiased': 82.737, 'best_valid_test/diff': 7.519, 'best_valid_test/acc_skew': 78.977, 'best_valid_test/acc_align': 86.497}
[6 / 20] best test accuracy: 82.737 at epoch 6 
 best_stats: {'best_test_epoch': 6, 'best_test_valid/acc': 81.561, 'best_test_valid/acc_unbiased': 81.735, 'best_test_valid/diff': 8.094, 'best_test_valid/acc_skew': 77.688, 'best_test_valid/acc_align': 85.782, 'best_test_test/acc': 82.447, 'best_test_test/acc_unbiased': 82.737, 'best_test_test/diff': 7.519, 'best_test_test/acc_skew': 78.977, 'best_test_test/acc_align': 86.497}
[7 / 20] Learning rate: 0.0001 weight: 0.01
[7 / 20] Loss: 4.493663301928676 CE Loss: 0.42714338224943 Con Loss: 4.489391878443616
[7 / 20] tensor([[0.849, 0.703],
        [0.851, 0.923]]) {'epoch': 7, 'valid/acc': 81.73, 'valid/acc_unbiased': 82.046, 'valid/diff': 8.283, 'valid/acc_skew': 77.905, 'valid/acc_align': 86.188, 'test/acc': 82.869, 'test/acc_unbiased': 83.149, 'test/diff': 10.922, 'test/acc_skew': 77.688, 'test/acc_align': 88.61}
[7 / 20] best valid accuracy: 82.046 at epoch 7 
 best_stats: {'best_valid_epoch': 7, 'best_valid_valid/acc': 81.73, 'best_valid_valid/acc_unbiased': 82.046, 'best_valid_valid/diff': 8.283, 'best_valid_valid/acc_skew': 77.905, 'best_valid_valid/acc_align': 86.188, 'best_valid_test/acc': 82.869, 'best_valid_test/acc_unbiased': 83.149, 'best_valid_test/diff': 10.922, 'best_valid_test/acc_skew': 77.688, 'best_valid_test/acc_align': 88.61}
[7 / 20] best test accuracy: 83.149 at epoch 7 
 best_stats: {'best_test_epoch': 7, 'best_test_valid/acc': 81.73, 'best_test_valid/acc_unbiased': 82.046, 'best_test_valid/diff': 8.283, 'best_test_valid/acc_skew': 77.905, 'best_test_valid/acc_align': 86.188, 'best_test_test/acc': 82.869, 'best_test_test/acc_unbiased': 83.149, 'best_test_test/diff': 10.922, 'best_test_test/acc_skew': 77.688, 'best_test_test/acc_align': 88.61}
[8 / 20] Learning rate: 0.0001 weight: 0.01
[8 / 20] Loss: 4.46942589817075 CE Loss: 0.40338226079417183 Con Loss: 4.465392098768913
[8 / 20] tensor([[0.855, 0.712],
        [0.844, 0.927]]) {'epoch': 8, 'valid/acc': 81.772, 'valid/acc_unbiased': 81.992, 'valid/diff': 9.779, 'valid/acc_skew': 77.103, 'valid/acc_align': 86.882, 'test/acc': 83.249, 'test/acc_unbiased': 83.454, 'test/diff': 11.296, 'test/acc_skew': 77.806, 'test/acc_align': 89.102}
[8 / 20] best valid accuracy: 82.046 at epoch 7 
 best_stats: {'best_valid_epoch': 7, 'best_valid_valid/acc': 81.73, 'best_valid_valid/acc_unbiased': 82.046, 'best_valid_valid/diff': 8.283, 'best_valid_valid/acc_skew': 77.905, 'best_valid_valid/acc_align': 86.188, 'best_valid_test/acc': 82.869, 'best_valid_test/acc_unbiased': 83.149, 'best_valid_test/diff': 10.922, 'best_valid_test/acc_skew': 77.688, 'best_valid_test/acc_align': 88.61}
[8 / 20] best test accuracy: 83.454 at epoch 8 
 best_stats: {'best_test_epoch': 8, 'best_test_valid/acc': 81.772, 'best_test_valid/acc_unbiased': 81.992, 'best_test_valid/diff': 9.779, 'best_test_valid/acc_skew': 77.103, 'best_test_valid/acc_align': 86.882, 'best_test_test/acc': 83.249, 'best_test_test/acc_unbiased': 83.454, 'best_test_test/diff': 11.296, 'best_test_test/acc_skew': 77.806, 'best_test_test/acc_align': 89.102}
[9 / 20] Learning rate: 0.0001 weight: 0.01
[9 / 20] Loss: 4.419377128690438 CE Loss: 0.4061789474672315 Con Loss: 4.415315315978244
[9 / 20] tensor([[0.864, 0.750],
        [0.831, 0.905]]) {'epoch': 9, 'valid/acc': 82.574, 'valid/acc_unbiased': 82.715, 'valid/diff': 8.519, 'valid/acc_skew': 78.455, 'valid/acc_align': 86.974, 'test/acc': 83.671, 'test/acc_unbiased': 83.756, 'test/diff': 9.358, 'test/acc_skew': 79.077, 'test/acc_align': 88.435}
[9 / 20] best valid accuracy: 82.715 at epoch 9 
 best_stats: {'best_valid_epoch': 9, 'best_valid_valid/acc': 82.574, 'best_valid_valid/acc_unbiased': 82.715, 'best_valid_valid/diff': 8.519, 'best_valid_valid/acc_skew': 78.455, 'best_valid_valid/acc_align': 86.974, 'best_valid_test/acc': 83.671, 'best_valid_test/acc_unbiased': 83.756, 'best_valid_test/diff': 9.358, 'best_valid_test/acc_skew': 79.077, 'best_valid_test/acc_align': 88.435}
[9 / 20] best test accuracy: 83.756 at epoch 9 
 best_stats: {'best_test_epoch': 9, 'best_test_valid/acc': 82.574, 'best_test_valid/acc_unbiased': 82.715, 'best_test_valid/diff': 8.519, 'best_test_valid/acc_skew': 78.455, 'best_test_valid/acc_align': 86.974, 'best_test_test/acc': 83.671, 'best_test_test/acc_unbiased': 83.756, 'best_test_test/diff': 9.358, 'best_test_test/acc_skew': 79.077, 'best_test_test/acc_align': 88.435}
[10 / 20] Learning rate: 0.0001 weight: 0.01
[10 / 20] Loss: 4.400265669927416 CE Loss: 0.40317901680968693 Con Loss: 4.396233862350487
[10 / 20] tensor([[0.866, 0.733],
        [0.823, 0.908]]) {'epoch': 10, 'valid/acc': 81.983, 'valid/acc_unbiased': 82.08, 'valid/diff': 9.002, 'valid/acc_skew': 77.579, 'valid/acc_align': 86.581, 'test/acc': 83.122, 'test/acc_unbiased': 83.216, 'test/diff': 10.916, 'test/acc_skew': 77.758, 'test/acc_align': 88.673}
[10 / 20] best valid accuracy: 82.715 at epoch 9 
 best_stats: {'best_valid_epoch': 9, 'best_valid_valid/acc': 82.574, 'best_valid_valid/acc_unbiased': 82.715, 'best_valid_valid/diff': 8.519, 'best_valid_valid/acc_skew': 78.455, 'best_valid_valid/acc_align': 86.974, 'best_valid_test/acc': 83.671, 'best_valid_test/acc_unbiased': 83.756, 'best_valid_test/diff': 9.358, 'best_valid_test/acc_skew': 79.077, 'best_valid_test/acc_align': 88.435}
[10 / 20] best test accuracy: 83.756 at epoch 9 
 best_stats: {'best_test_epoch': 9, 'best_test_valid/acc': 82.574, 'best_test_valid/acc_unbiased': 82.715, 'best_test_valid/diff': 8.519, 'best_test_valid/acc_skew': 78.455, 'best_test_valid/acc_align': 86.974, 'best_test_test/acc': 83.671, 'best_test_test/acc_unbiased': 83.756, 'best_test_test/diff': 9.358, 'best_test_test/acc_skew': 79.077, 'best_test_test/acc_align': 88.435}
[11 / 20] Learning rate: 0.0001 weight: 0.01
[11 / 20] Loss: 4.392306741823389 CE Loss: 0.40122439794100573 Con Loss: 4.388294506212628
[11 / 20] tensor([[0.875, 0.752],
        [0.818, 0.899]]) {'epoch': 11, 'valid/acc': 82.489, 'valid/acc_unbiased': 82.478, 'valid/diff': 8.699, 'valid/acc_skew': 78.129, 'valid/acc_align': 86.828, 'test/acc': 83.544, 'test/acc_unbiased': 83.588, 'test/diff': 10.174, 'test/acc_skew': 78.501, 'test/acc_align': 88.676}
[11 / 20] best valid accuracy: 82.715 at epoch 9 
 best_stats: {'best_valid_epoch': 9, 'best_valid_valid/acc': 82.574, 'best_valid_valid/acc_unbiased': 82.715, 'best_valid_valid/diff': 8.519, 'best_valid_valid/acc_skew': 78.455, 'best_valid_valid/acc_align': 86.974, 'best_valid_test/acc': 83.671, 'best_valid_test/acc_unbiased': 83.756, 'best_valid_test/diff': 9.358, 'best_valid_test/acc_skew': 79.077, 'best_valid_test/acc_align': 88.435}
[11 / 20] best test accuracy: 83.756 at epoch 9 
 best_stats: {'best_test_epoch': 9, 'best_test_valid/acc': 82.574, 'best_test_valid/acc_unbiased': 82.715, 'best_test_valid/diff': 8.519, 'best_test_valid/acc_skew': 78.455, 'best_test_valid/acc_align': 86.974, 'best_test_test/acc': 83.671, 'best_test_test/acc_unbiased': 83.756, 'best_test_test/diff': 9.358, 'best_test_test/acc_skew': 79.077, 'best_test_test/acc_align': 88.435}
[12 / 20] Learning rate: 0.0001 weight: 0.01
[12 / 20] Loss: 4.369205672430259 CE Loss: 0.39135677905243277 Con Loss: 4.365292082768408
[12 / 20] tensor([[0.876, 0.773],
        [0.786, 0.889]]) {'epoch': 12, 'valid/acc': 81.899, 'valid/acc_unbiased': 81.712, 'valid/diff': 10.449, 'valid/acc_skew': 76.488, 'valid/acc_align': 86.936, 'test/acc': 83.249, 'test/acc_unbiased': 83.079, 'test/diff': 10.333, 'test/acc_skew': 77.912, 'test/acc_align': 88.245}
[12 / 20] best valid accuracy: 82.715 at epoch 9 
 best_stats: {'best_valid_epoch': 9, 'best_valid_valid/acc': 82.574, 'best_valid_valid/acc_unbiased': 82.715, 'best_valid_valid/diff': 8.519, 'best_valid_valid/acc_skew': 78.455, 'best_valid_valid/acc_align': 86.974, 'best_valid_test/acc': 83.671, 'best_valid_test/acc_unbiased': 83.756, 'best_valid_test/diff': 9.358, 'best_valid_test/acc_skew': 79.077, 'best_valid_test/acc_align': 88.435}
[12 / 20] best test accuracy: 83.756 at epoch 9 
 best_stats: {'best_test_epoch': 9, 'best_test_valid/acc': 82.574, 'best_test_valid/acc_unbiased': 82.715, 'best_test_valid/diff': 8.519, 'best_test_valid/acc_skew': 78.455, 'best_test_valid/acc_align': 86.974, 'best_test_test/acc': 83.671, 'best_test_test/acc_unbiased': 83.756, 'best_test_test/diff': 9.358, 'best_test_test/acc_skew': 79.077, 'best_test_test/acc_align': 88.435}
[13 / 20] Learning rate: 0.0001 weight: 0.01
[13 / 20] Loss: 4.3781071826270175 CE Loss: 0.38367766312065793 Con Loss: 4.374270407033001
[13 / 20] tensor([[0.889, 0.777],
        [0.779, 0.887]]) {'epoch': 13, 'valid/acc': 82.363, 'valid/acc_unbiased': 82.187, 'valid/diff': 10.667, 'valid/acc_skew': 76.853, 'valid/acc_align': 87.52, 'test/acc': 83.502, 'test/acc_unbiased': 83.303, 'test/diff': 10.989, 'test/acc_skew': 77.809, 'test/acc_align': 88.798}
[13 / 20] best valid accuracy: 82.715 at epoch 9 
 best_stats: {'best_valid_epoch': 9, 'best_valid_valid/acc': 82.574, 'best_valid_valid/acc_unbiased': 82.715, 'best_valid_valid/diff': 8.519, 'best_valid_valid/acc_skew': 78.455, 'best_valid_valid/acc_align': 86.974, 'best_valid_test/acc': 83.671, 'best_valid_test/acc_unbiased': 83.756, 'best_valid_test/diff': 9.358, 'best_valid_test/acc_skew': 79.077, 'best_valid_test/acc_align': 88.435}
[13 / 20] best test accuracy: 83.756 at epoch 9 
 best_stats: {'best_test_epoch': 9, 'best_test_valid/acc': 82.574, 'best_test_valid/acc_unbiased': 82.715, 'best_test_valid/diff': 8.519, 'best_test_valid/acc_skew': 78.455, 'best_test_valid/acc_align': 86.974, 'best_test_test/acc': 83.671, 'best_test_test/acc_unbiased': 83.756, 'best_test_test/diff': 9.358, 'best_test_test/acc_skew': 79.077, 'best_test_test/acc_align': 88.435}
[14 / 20] Learning rate: 1e-05 weight: 0.01
[14 / 20] Loss: 4.361804646593934 CE Loss: 0.39495752374389337 Con Loss: 4.357855058170168
[14 / 20] tensor([[0.873, 0.736],
        [0.829, 0.909]]) {'epoch': 14, 'valid/acc': 81.857, 'valid/acc_unbiased': 81.952, 'valid/diff': 11.814, 'valid/acc_skew': 76.045, 'valid/acc_align': 87.859, 'test/acc': 83.544, 'test/acc_unbiased': 83.668, 'test/diff': 10.876, 'test/acc_skew': 78.23, 'test/acc_align': 89.106}
[14 / 20] best valid accuracy: 82.715 at epoch 9 
 best_stats: {'best_valid_epoch': 9, 'best_valid_valid/acc': 82.574, 'best_valid_valid/acc_unbiased': 82.715, 'best_valid_valid/diff': 8.519, 'best_valid_valid/acc_skew': 78.455, 'best_valid_valid/acc_align': 86.974, 'best_valid_test/acc': 83.671, 'best_valid_test/acc_unbiased': 83.756, 'best_valid_test/diff': 9.358, 'best_valid_test/acc_skew': 79.077, 'best_valid_test/acc_align': 88.435}
[14 / 20] best test accuracy: 83.756 at epoch 9 
 best_stats: {'best_test_epoch': 9, 'best_test_valid/acc': 82.574, 'best_test_valid/acc_unbiased': 82.715, 'best_test_valid/diff': 8.519, 'best_test_valid/acc_skew': 78.455, 'best_test_valid/acc_align': 86.974, 'best_test_test/acc': 83.671, 'best_test_test/acc_unbiased': 83.756, 'best_test_test/diff': 9.358, 'best_test_test/acc_skew': 79.077, 'best_test_test/acc_align': 88.435}
[15 / 20] Learning rate: 1e-05 weight: 0.01
[15 / 20] Loss: 4.330138376132636 CE Loss: 0.38248200594593457 Con Loss: 4.326313570338147
[15 / 20] tensor([[0.873, 0.733],
        [0.833, 0.918]]) {'epoch': 15, 'valid/acc': 81.899, 'valid/acc_unbiased': 82.065, 'valid/diff': 11.091, 'valid/acc_skew': 76.519, 'valid/acc_align': 87.61, 'test/acc': 83.797, 'test/acc_unbiased': 83.925, 'test/diff': 11.253, 'test/acc_skew': 78.299, 'test/acc_align': 89.552}
[15 / 20] best valid accuracy: 82.715 at epoch 9 
 best_stats: {'best_valid_epoch': 9, 'best_valid_valid/acc': 82.574, 'best_valid_valid/acc_unbiased': 82.715, 'best_valid_valid/diff': 8.519, 'best_valid_valid/acc_skew': 78.455, 'best_valid_valid/acc_align': 86.974, 'best_valid_test/acc': 83.671, 'best_valid_test/acc_unbiased': 83.756, 'best_valid_test/diff': 9.358, 'best_valid_test/acc_skew': 79.077, 'best_valid_test/acc_align': 88.435}
[15 / 20] best test accuracy: 83.925 at epoch 15 
 best_stats: {'best_test_epoch': 15, 'best_test_valid/acc': 81.899, 'best_test_valid/acc_unbiased': 82.065, 'best_test_valid/diff': 11.091, 'best_test_valid/acc_skew': 76.519, 'best_test_valid/acc_align': 87.61, 'best_test_test/acc': 83.797, 'best_test_test/acc_unbiased': 83.925, 'best_test_test/diff': 11.253, 'best_test_test/acc_skew': 78.299, 'best_test_test/acc_align': 89.552}
[16 / 20] Learning rate: 1e-05 weight: 0.01
[16 / 20] Loss: 4.354433289384074 CE Loss: 0.3807638726506715 Con Loss: 4.350625663690302
[16 / 20] tensor([[0.880, 0.743],
        [0.831, 0.915]]) {'epoch': 16, 'valid/acc': 81.772, 'valid/acc_unbiased': 81.921, 'valid/diff': 10.948, 'valid/acc_skew': 76.447, 'valid/acc_align': 87.395, 'test/acc': 84.135, 'test/acc_unbiased': 84.235, 'test/diff': 11.054, 'test/acc_skew': 78.708, 'test/acc_align': 89.762}
[16 / 20] best valid accuracy: 82.715 at epoch 9 
 best_stats: {'best_valid_epoch': 9, 'best_valid_valid/acc': 82.574, 'best_valid_valid/acc_unbiased': 82.715, 'best_valid_valid/diff': 8.519, 'best_valid_valid/acc_skew': 78.455, 'best_valid_valid/acc_align': 86.974, 'best_valid_test/acc': 83.671, 'best_valid_test/acc_unbiased': 83.756, 'best_valid_test/diff': 9.358, 'best_valid_test/acc_skew': 79.077, 'best_valid_test/acc_align': 88.435}
[16 / 20] best test accuracy: 84.235 at epoch 16 
 best_stats: {'best_test_epoch': 16, 'best_test_valid/acc': 81.772, 'best_test_valid/acc_unbiased': 81.921, 'best_test_valid/diff': 10.948, 'best_test_valid/acc_skew': 76.447, 'best_test_valid/acc_align': 87.395, 'best_test_test/acc': 84.135, 'best_test_test/acc_unbiased': 84.235, 'best_test_test/diff': 11.054, 'best_test_test/acc_skew': 78.708, 'best_test_test/acc_align': 89.762}
[17 / 20] Learning rate: 1e-05 weight: 0.01
[17 / 20] Loss: 4.34292743565572 CE Loss: 0.38741159757618326 Con Loss: 4.33905332294425
[17 / 20] tensor([[0.878, 0.743],
        [0.833, 0.914]]) {'epoch': 17, 'valid/acc': 82.194, 'valid/acc_unbiased': 82.319, 'valid/diff': 10.941, 'valid/acc_skew': 76.849, 'valid/acc_align': 87.79, 'test/acc': 84.093, 'test/acc_unbiased': 84.207, 'test/diff': 10.782, 'test/acc_skew': 78.816, 'test/acc_align': 89.598}
[17 / 20] best valid accuracy: 82.715 at epoch 9 
 best_stats: {'best_valid_epoch': 9, 'best_valid_valid/acc': 82.574, 'best_valid_valid/acc_unbiased': 82.715, 'best_valid_valid/diff': 8.519, 'best_valid_valid/acc_skew': 78.455, 'best_valid_valid/acc_align': 86.974, 'best_valid_test/acc': 83.671, 'best_valid_test/acc_unbiased': 83.756, 'best_valid_test/diff': 9.358, 'best_valid_test/acc_skew': 79.077, 'best_valid_test/acc_align': 88.435}
[17 / 20] best test accuracy: 84.235 at epoch 16 
 best_stats: {'best_test_epoch': 16, 'best_test_valid/acc': 81.772, 'best_test_valid/acc_unbiased': 81.921, 'best_test_valid/diff': 10.948, 'best_test_valid/acc_skew': 76.447, 'best_test_valid/acc_align': 87.395, 'best_test_test/acc': 84.135, 'best_test_test/acc_unbiased': 84.235, 'best_test_test/diff': 11.054, 'best_test_test/acc_skew': 78.708, 'best_test_test/acc_align': 89.762}
[18 / 20] Learning rate: 1e-05 weight: 0.01
[18 / 20] Loss: 4.339649547420518 CE Loss: 0.38340811503404754 Con Loss: 4.335815451330182
[18 / 20] tensor([[0.878, 0.743],
        [0.829, 0.912]]) {'epoch': 18, 'valid/acc': 82.152, 'valid/acc_unbiased': 82.281, 'valid/diff': 10.864, 'valid/acc_skew': 76.849, 'valid/acc_align': 87.713, 'test/acc': 83.966, 'test/acc_unbiased': 84.061, 'test/diff': 10.924, 'test/acc_skew': 78.599, 'test/acc_align': 89.523}
[18 / 20] best valid accuracy: 82.715 at epoch 9 
 best_stats: {'best_valid_epoch': 9, 'best_valid_valid/acc': 82.574, 'best_valid_valid/acc_unbiased': 82.715, 'best_valid_valid/diff': 8.519, 'best_valid_valid/acc_skew': 78.455, 'best_valid_valid/acc_align': 86.974, 'best_valid_test/acc': 83.671, 'best_valid_test/acc_unbiased': 83.756, 'best_valid_test/diff': 9.358, 'best_valid_test/acc_skew': 79.077, 'best_valid_test/acc_align': 88.435}
[18 / 20] best test accuracy: 84.235 at epoch 16 
 best_stats: {'best_test_epoch': 16, 'best_test_valid/acc': 81.772, 'best_test_valid/acc_unbiased': 81.921, 'best_test_valid/diff': 10.948, 'best_test_valid/acc_skew': 76.447, 'best_test_valid/acc_align': 87.395, 'best_test_test/acc': 84.135, 'best_test_test/acc_unbiased': 84.235, 'best_test_test/diff': 11.054, 'best_test_test/acc_skew': 78.708, 'best_test_test/acc_align': 89.762}
[19 / 20] Learning rate: 1e-05 weight: 0.01
[19 / 20] Loss: 4.359042749223388 CE Loss: 0.3860691228600582 Con Loss: 4.355182055672999
[19 / 20] tensor([[0.871, 0.737],
        [0.831, 0.915]]) {'epoch': 19, 'valid/acc': 82.025, 'valid/acc_unbiased': 82.161, 'valid/diff': 11.429, 'valid/acc_skew': 76.447, 'valid/acc_align': 87.876, 'test/acc': 83.755, 'test/acc_unbiased': 83.863, 'test/diff': 10.901, 'test/acc_skew': 78.412, 'test/acc_align': 89.314}
[19 / 20] best valid accuracy: 82.715 at epoch 9 
 best_stats: {'best_valid_epoch': 9, 'best_valid_valid/acc': 82.574, 'best_valid_valid/acc_unbiased': 82.715, 'best_valid_valid/diff': 8.519, 'best_valid_valid/acc_skew': 78.455, 'best_valid_valid/acc_align': 86.974, 'best_valid_test/acc': 83.671, 'best_valid_test/acc_unbiased': 83.756, 'best_valid_test/diff': 9.358, 'best_valid_test/acc_skew': 79.077, 'best_valid_test/acc_align': 88.435}
[19 / 20] best test accuracy: 84.235 at epoch 16 
 best_stats: {'best_test_epoch': 16, 'best_test_valid/acc': 81.772, 'best_test_valid/acc_unbiased': 81.921, 'best_test_valid/diff': 10.948, 'best_test_valid/acc_skew': 76.447, 'best_test_valid/acc_align': 87.395, 'best_test_test/acc': 84.135, 'best_test_test/acc_unbiased': 84.235, 'best_test_test/diff': 11.054, 'best_test_test/acc_skew': 78.708, 'best_test_test/acc_align': 89.762}
[20 / 20] Learning rate: 1e-05 weight: 0.01
[20 / 20] Loss: 4.34985983808079 CE Loss: 0.3821539040627626 Con Loss: 4.3460383198795345
[20 / 20] tensor([[0.862, 0.710],
        [0.838, 0.927]]) {'epoch': 20, 'valid/acc': 81.899, 'valid/acc_unbiased': 82.186, 'valid/diff': 11.556, 'valid/acc_skew': 76.408, 'valid/acc_align': 87.964, 'test/acc': 83.249, 'test/acc_unbiased': 83.434, 'test/diff': 12.052, 'test/acc_skew': 77.407, 'test/acc_align': 89.46}
[20 / 20] best valid accuracy: 82.715 at epoch 9 
 best_stats: {'best_valid_epoch': 9, 'best_valid_valid/acc': 82.574, 'best_valid_valid/acc_unbiased': 82.715, 'best_valid_valid/diff': 8.519, 'best_valid_valid/acc_skew': 78.455, 'best_valid_valid/acc_align': 86.974, 'best_valid_test/acc': 83.671, 'best_valid_test/acc_unbiased': 83.756, 'best_valid_test/diff': 9.358, 'best_valid_test/acc_skew': 79.077, 'best_valid_test/acc_align': 88.435}
[20 / 20] best test accuracy: 84.235 at epoch 16 
 best_stats: {'best_test_epoch': 16, 'best_test_valid/acc': 81.772, 'best_test_valid/acc_unbiased': 81.921, 'best_test_valid/diff': 10.948, 'best_test_valid/acc_skew': 76.447, 'best_test_valid/acc_align': 87.395, 'best_test_test/acc': 84.135, 'best_test_test/acc_unbiased': 84.235, 'best_test_test/diff': 11.054, 'best_test_test/acc_skew': 78.708, 'best_test_test/acc_align': 89.762}
Total training time: 0:16:38
