Log level set to: INFO
Set seed: 2
=======> Using Fixed Random Seed: 2 <========
save_path: exp_results/bc-bb0-utk_face_age-test-0.6-lr0.001-bs128-cbs64-w0.01-ratio10-aug1-seed2
get_utk_face - split: train, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_age-0.6
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [8237, 590]
Target 1: [3294, 1477]
Binary Target 1
---------------------------
Target 0: [8237, 590]
Target 1: [3294, 1477]
===================================
Normal Label Distribution: 
Target 0: [8237, 590]
Target 1: [3294, 1477]
===================================
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [8237, 590]
Target 1: [3294, 1477]
Binary Target 1
---------------------------
Target 0: [8237, 590]
Target 1: [3294, 1477]
===================================
Normal Label Distribution: 
Target 0: [8237, 590]
Target 1: [3294, 1477]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 13598, target_attr: gender, bias_attr: age bias_rate: 0.6
['[train] target_0-bias_0: 8237', '[train] target_0-bias_1: 590', '[train] target_1-bias_0: 3294', '[train] target_1-bias_1: 1477']
confusion_matrix - 
 original: tensor([[8237., 3294.],
        [ 590., 1477.]]), 
 normalized: tensor([[0.714, 0.286],
        [0.285, 0.715]]), 
 b|y: tensor([[0.933, 0.067],
        [0.690, 0.310]])
get_utk_face - split: train, aug: 1, given_y: True, ratio: 10
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_age-0.6
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [8237, 590]
Target 1: [3294, 1477]
Binary Target 1
---------------------------
Target 0: [8237, 590]
Target 1: [3294, 1477]
===================================
Normal Label Distribution: 
Target 0: [8237, 590]
Target 1: [3294, 1477]
===================================
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [8237, 590]
Target 1: [3294, 1477]
Binary Target 1
---------------------------
Target 0: [8237, 590]
Target 1: [3294, 1477]
===================================
Normal Label Distribution: 
Target 0: [8237, 590]
Target 1: [3294, 1477]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 13598, target_attr: gender, bias_attr: age bias_rate: 0.6
['[train] target_0-bias_0: 8237', '[train] target_0-bias_1: 590', '[train] target_1-bias_0: 3294', '[train] target_1-bias_1: 1477']
get_utk_face - split: valid, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_age-0.6
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [1030, 195]
Target 1: [841, 202]
Binary Target 1
---------------------------
Target 0: [1030, 195]
Target 1: [841, 202]
===================================
Normal Label Distribution: 
Target 0: [1030, 195]
Target 1: [841, 202]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 2268, target_attr: gender, bias_attr: age bias_rate: 0.6
['[valid] target_0-bias_0: 1030', '[valid] target_0-bias_1: 195', '[valid] target_1-bias_0: 841', '[valid] target_1-bias_1: 202']
get_utk_face - split: test, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_age-0.6
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [1061, 176]
Target 1: [867, 165]
Binary Target 1
---------------------------
Target 0: [1061, 176]
Target 1: [867, 165]
===================================
Normal Label Distribution: 
Target 0: [1061, 176]
Target 1: [867, 165]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 2269, target_attr: gender, bias_attr: age bias_rate: 0.6
['[test] target_0-bias_0: 1061', '[test] target_0-bias_1: 176', '[test] target_1-bias_0: 867', '[test] target_1-bias_1: 165']
decay_epochs: [6, 13]
[1 / 20] Learning rate: 0.001 weight: 0.01
[1 / 20] Loss: 4.912165108139435 CE Loss: 0.5983068994396415 Con Loss: 4.90618201076397
[1 / 20] tensor([[0.848, 0.722],
        [0.690, 0.545]]) {'epoch': 1, 'valid/acc': 75.75, 'valid/acc_unbiased': 70.901, 'valid/diff': 12.795, 'valid/acc_skew': 64.504, 'valid/acc_align': 77.298, 'test/acc': 75.584, 'test/acc_unbiased': 70.126, 'test/diff': 13.547, 'test/acc_skew': 63.352, 'test/acc_align': 76.9}
[1 / 20] best valid accuracy: 70.901 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 75.75, 'best_valid_valid/acc_unbiased': 70.901, 'best_valid_valid/diff': 12.795, 'best_valid_valid/acc_skew': 64.504, 'best_valid_valid/acc_align': 77.298, 'best_valid_test/acc': 75.584, 'best_valid_test/acc_unbiased': 70.126, 'best_valid_test/diff': 13.547, 'best_valid_test/acc_skew': 63.352, 'best_valid_test/acc_align': 76.9}
[1 / 20] best test accuracy: 70.126 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 75.75, 'best_test_valid/acc_unbiased': 70.901, 'best_test_valid/diff': 12.795, 'best_test_valid/acc_skew': 64.504, 'best_test_valid/acc_align': 77.298, 'best_test_test/acc': 75.584, 'best_test_test/acc_unbiased': 70.126, 'best_test_test/diff': 13.547, 'best_test_test/acc_skew': 63.352, 'best_test_test/acc_align': 76.9}
[2 / 20] Learning rate: 0.001 weight: 0.01
[2 / 20] Loss: 4.827006930971097 CE Loss: 0.5086564080498467 Con Loss: 4.821920336336051
[2 / 20] tensor([[0.844, 0.727],
        [0.781, 0.618]]) {'epoch': 2, 'valid/acc': 80.291, 'valid/acc_unbiased': 76.36, 'valid/diff': 11.511, 'valid/acc_skew': 70.604, 'valid/acc_align': 82.115, 'test/acc': 79.462, 'test/acc_unbiased': 74.27, 'test/diff': 13.994, 'test/acc_skew': 67.273, 'test/acc_align': 81.267}
[2 / 20] best valid accuracy: 76.360 at epoch 2 
 best_stats: {'best_valid_epoch': 2, 'best_valid_valid/acc': 80.291, 'best_valid_valid/acc_unbiased': 76.36, 'best_valid_valid/diff': 11.511, 'best_valid_valid/acc_skew': 70.604, 'best_valid_valid/acc_align': 82.115, 'best_valid_test/acc': 79.462, 'best_valid_test/acc_unbiased': 74.27, 'best_valid_test/diff': 13.994, 'best_valid_test/acc_skew': 67.273, 'best_valid_test/acc_align': 81.267}
[2 / 20] best test accuracy: 74.270 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 80.291, 'best_test_valid/acc_unbiased': 76.36, 'best_test_valid/diff': 11.511, 'best_test_valid/acc_skew': 70.604, 'best_test_valid/acc_align': 82.115, 'best_test_test/acc': 79.462, 'best_test_test/acc_unbiased': 74.27, 'best_test_test/diff': 13.994, 'best_test_test/acc_skew': 67.273, 'best_test_test/acc_align': 81.267}
[3 / 20] Learning rate: 0.001 weight: 0.01
[3 / 20] Loss: 4.809684234781289 CE Loss: 0.489279718228273 Con Loss: 4.8047914249719215
[3 / 20] tensor([[0.919, 0.847],
        [0.690, 0.473]]) {'epoch': 3, 'valid/acc': 79.453, 'valid/acc_unbiased': 74.344, 'valid/diff': 13.029, 'valid/acc_skew': 67.829, 'valid/acc_align': 80.859, 'test/acc': 79.33, 'test/acc_unbiased': 73.2, 'test/diff': 14.468, 'test/acc_skew': 65.966, 'test/acc_align': 80.434}
[3 / 20] best valid accuracy: 76.360 at epoch 2 
 best_stats: {'best_valid_epoch': 2, 'best_valid_valid/acc': 80.291, 'best_valid_valid/acc_unbiased': 76.36, 'best_valid_valid/diff': 11.511, 'best_valid_valid/acc_skew': 70.604, 'best_valid_valid/acc_align': 82.115, 'best_valid_test/acc': 79.462, 'best_valid_test/acc_unbiased': 74.27, 'best_valid_test/diff': 13.994, 'best_valid_test/acc_skew': 67.273, 'best_valid_test/acc_align': 81.267}
[3 / 20] best test accuracy: 74.270 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 80.291, 'best_test_valid/acc_unbiased': 76.36, 'best_test_valid/diff': 11.511, 'best_test_valid/acc_skew': 70.604, 'best_test_valid/acc_align': 82.115, 'best_test_test/acc': 79.462, 'best_test_test/acc_unbiased': 74.27, 'best_test_test/diff': 13.994, 'best_test_test/acc_skew': 67.273, 'best_test_test/acc_align': 81.267}
[4 / 20] Learning rate: 0.001 weight: 0.01
[4 / 20] Loss: 4.803296301536375 CE Loss: 0.4584787232172035 Con Loss: 4.798711524814135
[4 / 20] tensor([[0.943, 0.892],
        [0.679, 0.418]]) {'epoch': 4, 'valid/acc': 79.586, 'valid/acc_unbiased': 74.675, 'valid/diff': 11.639, 'valid/acc_skew': 68.855, 'valid/acc_align': 80.494, 'test/acc': 80.035, 'test/acc_unbiased': 73.326, 'test/diff': 15.629, 'test/acc_skew': 65.511, 'test/acc_align': 81.14}
[4 / 20] best valid accuracy: 76.360 at epoch 2 
 best_stats: {'best_valid_epoch': 2, 'best_valid_valid/acc': 80.291, 'best_valid_valid/acc_unbiased': 76.36, 'best_valid_valid/diff': 11.511, 'best_valid_valid/acc_skew': 70.604, 'best_valid_valid/acc_align': 82.115, 'best_valid_test/acc': 79.462, 'best_valid_test/acc_unbiased': 74.27, 'best_valid_test/diff': 13.994, 'best_valid_test/acc_skew': 67.273, 'best_valid_test/acc_align': 81.267}
[4 / 20] best test accuracy: 74.270 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 80.291, 'best_test_valid/acc_unbiased': 76.36, 'best_test_valid/diff': 11.511, 'best_test_valid/acc_skew': 70.604, 'best_test_valid/acc_align': 82.115, 'best_test_test/acc': 79.462, 'best_test_test/acc_unbiased': 74.27, 'best_test_test/diff': 13.994, 'best_test_test/acc_skew': 67.273, 'best_test_test/acc_align': 81.267}
[5 / 20] Learning rate: 0.001 weight: 0.01
[5 / 20] Loss: 4.7980485947838005 CE Loss: 0.4494859071439953 Con Loss: 4.793553715787366
[5 / 20] tensor([[0.964, 0.875],
        [0.597, 0.352]]) {'epoch': 5, 'valid/acc': 75.926, 'valid/acc_unbiased': 71.507, 'valid/diff': 8.698, 'valid/acc_skew': 67.158, 'valid/acc_align': 75.856, 'test/acc': 77.259, 'test/acc_unbiased': 69.704, 'test/diff': 16.757, 'test/acc_skew': 61.326, 'test/acc_align': 78.082}
[5 / 20] best valid accuracy: 76.360 at epoch 2 
 best_stats: {'best_valid_epoch': 2, 'best_valid_valid/acc': 80.291, 'best_valid_valid/acc_unbiased': 76.36, 'best_valid_valid/diff': 11.511, 'best_valid_valid/acc_skew': 70.604, 'best_valid_valid/acc_align': 82.115, 'best_valid_test/acc': 79.462, 'best_valid_test/acc_unbiased': 74.27, 'best_valid_test/diff': 13.994, 'best_valid_test/acc_skew': 67.273, 'best_valid_test/acc_align': 81.267}
[5 / 20] best test accuracy: 74.270 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 80.291, 'best_test_valid/acc_unbiased': 76.36, 'best_test_valid/diff': 11.511, 'best_test_valid/acc_skew': 70.604, 'best_test_valid/acc_align': 82.115, 'best_test_test/acc': 79.462, 'best_test_test/acc_unbiased': 74.27, 'best_test_test/diff': 13.994, 'best_test_test/acc_skew': 67.273, 'best_test_test/acc_align': 81.267}
[6 / 20] Learning rate: 0.001 weight: 0.01
[6 / 20] Loss: 4.781328182918988 CE Loss: 0.4405070006505481 Con Loss: 4.776923109282639
[6 / 20] tensor([[0.926, 0.858],
        [0.740, 0.436]]) {'epoch': 6, 'valid/acc': 80.952, 'valid/acc_unbiased': 75.303, 'valid/diff': 15.001, 'valid/acc_skew': 67.803, 'valid/acc_align': 82.804, 'test/acc': 81.401, 'test/acc_unbiased': 74.009, 'test/diff': 18.585, 'test/acc_skew': 64.716, 'test/acc_align': 83.301}
[6 / 20] best valid accuracy: 76.360 at epoch 2 
 best_stats: {'best_valid_epoch': 2, 'best_valid_valid/acc': 80.291, 'best_valid_valid/acc_unbiased': 76.36, 'best_valid_valid/diff': 11.511, 'best_valid_valid/acc_skew': 70.604, 'best_valid_valid/acc_align': 82.115, 'best_valid_test/acc': 79.462, 'best_valid_test/acc_unbiased': 74.27, 'best_valid_test/diff': 13.994, 'best_valid_test/acc_skew': 67.273, 'best_valid_test/acc_align': 81.267}
[6 / 20] best test accuracy: 74.270 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 80.291, 'best_test_valid/acc_unbiased': 76.36, 'best_test_valid/diff': 11.511, 'best_test_valid/acc_skew': 70.604, 'best_test_valid/acc_align': 82.115, 'best_test_test/acc': 79.462, 'best_test_test/acc_unbiased': 74.27, 'best_test_test/diff': 13.994, 'best_test_test/acc_skew': 67.273, 'best_test_test/acc_align': 81.267}
[7 / 20] Learning rate: 0.0001 weight: 0.01
[7 / 20] Loss: 4.753189290511396 CE Loss: 0.409364332410584 Con Loss: 4.749095624151397
[7 / 20] tensor([[0.957, 0.841],
        [0.765, 0.570]]) {'epoch': 7, 'valid/acc': 83.642, 'valid/acc_unbiased': 78.264, 'valid/diff': 13.992, 'valid/acc_skew': 71.268, 'valid/acc_align': 85.26, 'test/acc': 84.619, 'test/acc_unbiased': 78.299, 'test/diff': 15.537, 'test/acc_skew': 70.53, 'test/acc_align': 86.068}
[7 / 20] best valid accuracy: 78.264 at epoch 7 
 best_stats: {'best_valid_epoch': 7, 'best_valid_valid/acc': 83.642, 'best_valid_valid/acc_unbiased': 78.264, 'best_valid_valid/diff': 13.992, 'best_valid_valid/acc_skew': 71.268, 'best_valid_valid/acc_align': 85.26, 'best_valid_test/acc': 84.619, 'best_valid_test/acc_unbiased': 78.299, 'best_valid_test/diff': 15.537, 'best_valid_test/acc_skew': 70.53, 'best_valid_test/acc_align': 86.068}
[7 / 20] best test accuracy: 78.299 at epoch 7 
 best_stats: {'best_test_epoch': 7, 'best_test_valid/acc': 83.642, 'best_test_valid/acc_unbiased': 78.264, 'best_test_valid/diff': 13.992, 'best_test_valid/acc_skew': 71.268, 'best_test_valid/acc_align': 85.26, 'best_test_test/acc': 84.619, 'best_test_test/acc_unbiased': 78.299, 'best_test_test/diff': 15.537, 'best_test_test/acc_skew': 70.53, 'best_test_test/acc_align': 86.068}
[8 / 20] Learning rate: 0.0001 weight: 0.01
[8 / 20] Loss: 4.726517017842531 CE Loss: 0.38255387554275305 Con Loss: 4.7226914801235
[8 / 20] tensor([[0.953, 0.830],
        [0.774, 0.600]]) {'epoch': 8, 'valid/acc': 83.642, 'valid/acc_unbiased': 78.164, 'valid/diff': 14.376, 'valid/acc_skew': 70.976, 'valid/acc_align': 85.352, 'test/acc': 84.927, 'test/acc_unbiased': 78.909, 'test/diff': 14.863, 'test/acc_skew': 71.477, 'test/acc_align': 86.34}
[8 / 20] best valid accuracy: 78.264 at epoch 7 
 best_stats: {'best_valid_epoch': 7, 'best_valid_valid/acc': 83.642, 'best_valid_valid/acc_unbiased': 78.264, 'best_valid_valid/diff': 13.992, 'best_valid_valid/acc_skew': 71.268, 'best_valid_valid/acc_align': 85.26, 'best_valid_test/acc': 84.619, 'best_valid_test/acc_unbiased': 78.299, 'best_valid_test/diff': 15.537, 'best_valid_test/acc_skew': 70.53, 'best_valid_test/acc_align': 86.068}
[8 / 20] best test accuracy: 78.909 at epoch 8 
 best_stats: {'best_test_epoch': 8, 'best_test_valid/acc': 83.642, 'best_test_valid/acc_unbiased': 78.164, 'best_test_valid/diff': 14.376, 'best_test_valid/acc_skew': 70.976, 'best_test_valid/acc_align': 85.352, 'best_test_test/acc': 84.927, 'best_test_test/acc_unbiased': 78.909, 'best_test_test/diff': 14.863, 'best_test_test/acc_skew': 71.477, 'best_test_test/acc_align': 86.34}
[9 / 20] Learning rate: 0.0001 weight: 0.01
[9 / 20] Loss: 4.718846443067983 CE Loss: 0.3825588021002757 Con Loss: 4.715020884168658
[9 / 20] tensor([[0.943, 0.830],
        [0.807, 0.606]]) {'epoch': 9, 'valid/acc': 84.744, 'valid/acc_unbiased': 79.606, 'valid/diff': 13.83, 'valid/acc_skew': 72.691, 'valid/acc_align': 86.521, 'test/acc': 85.765, 'test/acc_unbiased': 79.637, 'test/diff': 15.714, 'test/acc_skew': 71.78, 'test/acc_align': 87.494}
[9 / 20] best valid accuracy: 79.606 at epoch 9 
 best_stats: {'best_valid_epoch': 9, 'best_valid_valid/acc': 84.744, 'best_valid_valid/acc_unbiased': 79.606, 'best_valid_valid/diff': 13.83, 'best_valid_valid/acc_skew': 72.691, 'best_valid_valid/acc_align': 86.521, 'best_valid_test/acc': 85.765, 'best_valid_test/acc_unbiased': 79.637, 'best_valid_test/diff': 15.714, 'best_valid_test/acc_skew': 71.78, 'best_valid_test/acc_align': 87.494}
[9 / 20] best test accuracy: 79.637 at epoch 9 
 best_stats: {'best_test_epoch': 9, 'best_test_valid/acc': 84.744, 'best_test_valid/acc_unbiased': 79.606, 'best_test_valid/diff': 13.83, 'best_test_valid/acc_skew': 72.691, 'best_test_valid/acc_align': 86.521, 'best_test_test/acc': 85.765, 'best_test_test/acc_unbiased': 79.637, 'best_test_test/diff': 15.714, 'best_test_test/acc_skew': 71.78, 'best_test_test/acc_align': 87.494}
[10 / 20] Learning rate: 0.0001 weight: 0.01
[10 / 20] Loss: 4.698617480155001 CE Loss: 0.3752050840174351 Con Loss: 4.694865436444547
[10 / 20] tensor([[0.958, 0.801],
        [0.796, 0.648]]) {'epoch': 10, 'valid/acc': 84.259, 'valid/acc_unbiased': 78.693, 'valid/diff': 14.657, 'valid/acc_skew': 71.365, 'valid/acc_align': 86.022, 'test/acc': 86.117, 'test/acc_unbiased': 80.076, 'test/diff': 15.191, 'test/acc_skew': 72.481, 'test/acc_align': 87.672}
[10 / 20] best valid accuracy: 79.606 at epoch 9 
 best_stats: {'best_valid_epoch': 9, 'best_valid_valid/acc': 84.744, 'best_valid_valid/acc_unbiased': 79.606, 'best_valid_valid/diff': 13.83, 'best_valid_valid/acc_skew': 72.691, 'best_valid_valid/acc_align': 86.521, 'best_valid_test/acc': 85.765, 'best_valid_test/acc_unbiased': 79.637, 'best_valid_test/diff': 15.714, 'best_valid_test/acc_skew': 71.78, 'best_valid_test/acc_align': 87.494}
[10 / 20] best test accuracy: 80.076 at epoch 10 
 best_stats: {'best_test_epoch': 10, 'best_test_valid/acc': 84.259, 'best_test_valid/acc_unbiased': 78.693, 'best_test_valid/diff': 14.657, 'best_test_valid/acc_skew': 71.365, 'best_test_valid/acc_align': 86.022, 'best_test_test/acc': 86.117, 'best_test_test/acc_unbiased': 80.076, 'best_test_test/diff': 15.191, 'best_test_test/acc_skew': 72.481, 'best_test_test/acc_align': 87.672}
[11 / 20] Learning rate: 0.0001 weight: 0.01
[11 / 20] Loss: 4.695900887176384 CE Loss: 0.37132040743162253 Con Loss: 4.692187692614439
[11 / 20] tensor([[0.965, 0.881],
        [0.773, 0.539]]) {'epoch': 11, 'valid/acc': 83.377, 'valid/acc_unbiased': 78.076, 'valid/diff': 13.545, 'valid/acc_skew': 71.304, 'valid/acc_align': 84.849, 'test/acc': 85.412, 'test/acc_unbiased': 78.95, 'test/diff': 15.892, 'test/acc_skew': 71.004, 'test/acc_align': 86.895}
[11 / 20] best valid accuracy: 79.606 at epoch 9 
 best_stats: {'best_valid_epoch': 9, 'best_valid_valid/acc': 84.744, 'best_valid_valid/acc_unbiased': 79.606, 'best_valid_valid/diff': 13.83, 'best_valid_valid/acc_skew': 72.691, 'best_valid_valid/acc_align': 86.521, 'best_valid_test/acc': 85.765, 'best_valid_test/acc_unbiased': 79.637, 'best_valid_test/diff': 15.714, 'best_valid_test/acc_skew': 71.78, 'best_valid_test/acc_align': 87.494}
[11 / 20] best test accuracy: 80.076 at epoch 10 
 best_stats: {'best_test_epoch': 10, 'best_test_valid/acc': 84.259, 'best_test_valid/acc_unbiased': 78.693, 'best_test_valid/diff': 14.657, 'best_test_valid/acc_skew': 71.365, 'best_test_valid/acc_align': 86.022, 'best_test_test/acc': 86.117, 'best_test_test/acc_unbiased': 80.076, 'best_test_test/diff': 15.191, 'best_test_test/acc_skew': 72.481, 'best_test_test/acc_align': 87.672}
[12 / 20] Learning rate: 0.0001 weight: 0.01
[12 / 20] Loss: 4.687066056234273 CE Loss: 0.3573682880792605 Con Loss: 4.683492366803676
[12 / 20] tensor([[0.959, 0.818],
        [0.785, 0.642]]) {'epoch': 12, 'valid/acc': 83.862, 'valid/acc_unbiased': 78.135, 'valid/diff': 14.973, 'valid/acc_skew': 70.649, 'valid/acc_align': 85.622, 'test/acc': 85.853, 'test/acc_unbiased': 80.115, 'test/diff': 14.17, 'test/acc_skew': 73.03, 'test/acc_align': 87.2}
[12 / 20] best valid accuracy: 79.606 at epoch 9 
 best_stats: {'best_valid_epoch': 9, 'best_valid_valid/acc': 84.744, 'best_valid_valid/acc_unbiased': 79.606, 'best_valid_valid/diff': 13.83, 'best_valid_valid/acc_skew': 72.691, 'best_valid_valid/acc_align': 86.521, 'best_valid_test/acc': 85.765, 'best_valid_test/acc_unbiased': 79.637, 'best_valid_test/diff': 15.714, 'best_valid_test/acc_skew': 71.78, 'best_valid_test/acc_align': 87.494}
[12 / 20] best test accuracy: 80.115 at epoch 12 
 best_stats: {'best_test_epoch': 12, 'best_test_valid/acc': 83.862, 'best_test_valid/acc_unbiased': 78.135, 'best_test_valid/diff': 14.973, 'best_test_valid/acc_skew': 70.649, 'best_test_valid/acc_align': 85.622, 'best_test_test/acc': 85.853, 'best_test_test/acc_unbiased': 80.115, 'best_test_test/diff': 14.17, 'best_test_test/acc_skew': 73.03, 'best_test_test/acc_align': 87.2}
[13 / 20] Learning rate: 0.0001 weight: 0.01
[13 / 20] Loss: 4.663135777467979 CE Loss: 0.3442681536795129 Con Loss: 4.659693116632555
[13 / 20] tensor([[0.958, 0.847],
        [0.794, 0.624]]) {'epoch': 13, 'valid/acc': 84.436, 'valid/acc_unbiased': 78.747, 'valid/diff': 15.1, 'valid/acc_skew': 71.197, 'valid/acc_align': 86.297, 'test/acc': 86.205, 'test/acc_unbiased': 80.549, 'test/diff': 14.015, 'test/acc_skew': 73.542, 'test/acc_align': 87.556}
[13 / 20] best valid accuracy: 79.606 at epoch 9 
 best_stats: {'best_valid_epoch': 9, 'best_valid_valid/acc': 84.744, 'best_valid_valid/acc_unbiased': 79.606, 'best_valid_valid/diff': 13.83, 'best_valid_valid/acc_skew': 72.691, 'best_valid_valid/acc_align': 86.521, 'best_valid_test/acc': 85.765, 'best_valid_test/acc_unbiased': 79.637, 'best_valid_test/diff': 15.714, 'best_valid_test/acc_skew': 71.78, 'best_valid_test/acc_align': 87.494}
[13 / 20] best test accuracy: 80.549 at epoch 13 
 best_stats: {'best_test_epoch': 13, 'best_test_valid/acc': 84.436, 'best_test_valid/acc_unbiased': 78.747, 'best_test_valid/diff': 15.1, 'best_test_valid/acc_skew': 71.197, 'best_test_valid/acc_align': 86.297, 'best_test_test/acc': 86.205, 'best_test_test/acc_unbiased': 80.549, 'best_test_test/diff': 14.015, 'best_test_test/acc_skew': 73.542, 'best_test_test/acc_align': 87.556}
[14 / 20] Learning rate: 1e-05 weight: 0.01
[14 / 20] Loss: 4.662057493097345 CE Loss: 0.3552861263917148 Con Loss: 4.658504634556445
[14 / 20] tensor([[0.934, 0.784],
        [0.840, 0.697]]) {'epoch': 14, 'valid/acc': 85.67, 'valid/acc_unbiased': 80.419, 'valid/diff': 14.768, 'valid/acc_skew': 73.035, 'valid/acc_align': 87.803, 'test/acc': 86.911, 'test/acc_unbiased': 81.369, 'test/diff': 14.632, 'test/acc_skew': 74.053, 'test/acc_align': 88.685}
[14 / 20] best valid accuracy: 80.419 at epoch 14 
 best_stats: {'best_valid_epoch': 14, 'best_valid_valid/acc': 85.67, 'best_valid_valid/acc_unbiased': 80.419, 'best_valid_valid/diff': 14.768, 'best_valid_valid/acc_skew': 73.035, 'best_valid_valid/acc_align': 87.803, 'best_valid_test/acc': 86.911, 'best_valid_test/acc_unbiased': 81.369, 'best_valid_test/diff': 14.632, 'best_valid_test/acc_skew': 74.053, 'best_valid_test/acc_align': 88.685}
[14 / 20] best test accuracy: 81.369 at epoch 14 
 best_stats: {'best_test_epoch': 14, 'best_test_valid/acc': 85.67, 'best_test_valid/acc_unbiased': 80.419, 'best_test_valid/diff': 14.768, 'best_test_valid/acc_skew': 73.035, 'best_test_valid/acc_align': 87.803, 'best_test_test/acc': 86.911, 'best_test_test/acc_unbiased': 81.369, 'best_test_test/diff': 14.632, 'best_test_test/acc_skew': 74.053, 'best_test_test/acc_align': 88.685}
[15 / 20] Learning rate: 1e-05 weight: 0.01
[15 / 20] Loss: 4.661943951360021 CE Loss: 0.34582954557928414 Con Loss: 4.658485639198753
[15 / 20] tensor([[0.951, 0.824],
        [0.817, 0.667]]) {'epoch': 15, 'valid/acc': 85.097, 'valid/acc_unbiased': 79.451, 'valid/diff': 15.164, 'valid/acc_skew': 71.868, 'valid/acc_align': 87.033, 'test/acc': 86.911, 'test/acc_unbiased': 81.453, 'test/diff': 13.853, 'test/acc_skew': 74.527, 'test/acc_align': 88.38}
[15 / 20] best valid accuracy: 80.419 at epoch 14 
 best_stats: {'best_valid_epoch': 14, 'best_valid_valid/acc': 85.67, 'best_valid_valid/acc_unbiased': 80.419, 'best_valid_valid/diff': 14.768, 'best_valid_valid/acc_skew': 73.035, 'best_valid_valid/acc_align': 87.803, 'best_valid_test/acc': 86.911, 'best_valid_test/acc_unbiased': 81.369, 'best_valid_test/diff': 14.632, 'best_valid_test/acc_skew': 74.053, 'best_valid_test/acc_align': 88.685}
[15 / 20] best test accuracy: 81.453 at epoch 15 
 best_stats: {'best_test_epoch': 15, 'best_test_valid/acc': 85.097, 'best_test_valid/acc_unbiased': 79.451, 'best_test_valid/diff': 15.164, 'best_test_valid/acc_skew': 71.868, 'best_test_valid/acc_align': 87.033, 'best_test_test/acc': 86.911, 'best_test_test/acc_unbiased': 81.453, 'best_test_test/diff': 13.853, 'best_test_test/acc_skew': 74.527, 'best_test_test/acc_align': 88.38}
[16 / 20] Learning rate: 1e-05 weight: 0.01
[16 / 20] Loss: 4.651794061185262 CE Loss: 0.34462079195822665 Con Loss: 4.648347843673443
[16 / 20] tensor([[0.960, 0.824],
        [0.804, 0.655]]) {'epoch': 16, 'valid/acc': 84.303, 'valid/acc_unbiased': 78.898, 'valid/diff': 14.042, 'valid/acc_skew': 71.877, 'valid/acc_align': 85.919, 'test/acc': 86.778, 'test/acc_unbiased': 81.069, 'test/diff': 14.296, 'test/acc_skew': 73.92, 'test/acc_align': 88.217}
[16 / 20] best valid accuracy: 80.419 at epoch 14 
 best_stats: {'best_valid_epoch': 14, 'best_valid_valid/acc': 85.67, 'best_valid_valid/acc_unbiased': 80.419, 'best_valid_valid/diff': 14.768, 'best_valid_valid/acc_skew': 73.035, 'best_valid_valid/acc_align': 87.803, 'best_valid_test/acc': 86.911, 'best_valid_test/acc_unbiased': 81.369, 'best_valid_test/diff': 14.632, 'best_valid_test/acc_skew': 74.053, 'best_valid_test/acc_align': 88.685}
[16 / 20] best test accuracy: 81.453 at epoch 15 
 best_stats: {'best_test_epoch': 15, 'best_test_valid/acc': 85.097, 'best_test_valid/acc_unbiased': 79.451, 'best_test_valid/diff': 15.164, 'best_test_valid/acc_skew': 71.868, 'best_test_valid/acc_align': 87.033, 'best_test_test/acc': 86.911, 'best_test_test/acc_unbiased': 81.453, 'best_test_test/diff': 13.853, 'best_test_test/acc_skew': 74.527, 'best_test_test/acc_align': 88.38}
[17 / 20] Learning rate: 1e-05 weight: 0.01
[17 / 20] Loss: 4.64685980686985 CE Loss: 0.34445993263662905 Con Loss: 4.643415219960168
[17 / 20] tensor([[0.936, 0.812],
        [0.832, 0.697]]) {'epoch': 17, 'valid/acc': 85.229, 'valid/acc_unbiased': 79.599, 'valid/diff': 15.551, 'valid/acc_skew': 71.824, 'valid/acc_align': 87.375, 'test/acc': 86.911, 'test/acc_unbiased': 81.925, 'test/diff': 12.902, 'test/acc_skew': 75.473, 'test/acc_align': 88.376}
[17 / 20] best valid accuracy: 80.419 at epoch 14 
 best_stats: {'best_valid_epoch': 14, 'best_valid_valid/acc': 85.67, 'best_valid_valid/acc_unbiased': 80.419, 'best_valid_valid/diff': 14.768, 'best_valid_valid/acc_skew': 73.035, 'best_valid_valid/acc_align': 87.803, 'best_valid_test/acc': 86.911, 'best_valid_test/acc_unbiased': 81.369, 'best_valid_test/diff': 14.632, 'best_valid_test/acc_skew': 74.053, 'best_valid_test/acc_align': 88.685}
[17 / 20] best test accuracy: 81.925 at epoch 17 
 best_stats: {'best_test_epoch': 17, 'best_test_valid/acc': 85.229, 'best_test_valid/acc_unbiased': 79.599, 'best_test_valid/diff': 15.551, 'best_test_valid/acc_skew': 71.824, 'best_test_valid/acc_align': 87.375, 'best_test_test/acc': 86.911, 'best_test_test/acc_unbiased': 81.925, 'best_test_test/diff': 12.902, 'best_test_test/acc_skew': 75.473, 'best_test_test/acc_align': 88.376}
[18 / 20] Learning rate: 1e-05 weight: 0.01
[18 / 20] Loss: 4.6618587271152725 CE Loss: 0.33805118375603704 Con Loss: 4.65847821676796
[18 / 20] tensor([[0.942, 0.812],
        [0.829, 0.703]]) {'epoch': 18, 'valid/acc': 85.758, 'valid/acc_unbiased': 80.397, 'valid/diff': 14.635, 'valid/acc_skew': 73.079, 'valid/acc_align': 87.715, 'test/acc': 87.131, 'test/acc_unbiased': 82.16, 'test/diff': 12.767, 'test/acc_skew': 75.777, 'test/acc_align': 88.543}
[18 / 20] best valid accuracy: 80.419 at epoch 14 
 best_stats: {'best_valid_epoch': 14, 'best_valid_valid/acc': 85.67, 'best_valid_valid/acc_unbiased': 80.419, 'best_valid_valid/diff': 14.768, 'best_valid_valid/acc_skew': 73.035, 'best_valid_valid/acc_align': 87.803, 'best_valid_test/acc': 86.911, 'best_valid_test/acc_unbiased': 81.369, 'best_valid_test/diff': 14.632, 'best_valid_test/acc_skew': 74.053, 'best_valid_test/acc_align': 88.685}
[18 / 20] best test accuracy: 82.160 at epoch 18 
 best_stats: {'best_test_epoch': 18, 'best_test_valid/acc': 85.758, 'best_test_valid/acc_unbiased': 80.397, 'best_test_valid/diff': 14.635, 'best_test_valid/acc_skew': 73.079, 'best_test_valid/acc_align': 87.715, 'best_test_test/acc': 87.131, 'best_test_test/acc_unbiased': 82.16, 'best_test_test/diff': 12.767, 'best_test_test/acc_skew': 75.777, 'best_test_test/acc_align': 88.543}
[19 / 20] Learning rate: 1e-05 weight: 0.01
[19 / 20] Loss: 4.637845398661213 CE Loss: 0.34212046784940126 Con Loss: 4.634424216608069
[19 / 20] tensor([[0.943, 0.812],
        [0.832, 0.703]]) {'epoch': 19, 'valid/acc': 85.714, 'valid/acc_unbiased': 80.387, 'valid/diff': 14.58, 'valid/acc_skew': 73.097, 'valid/acc_align': 87.677, 'test/acc': 87.307, 'test/acc_unbiased': 82.265, 'test/diff': 12.976, 'test/acc_skew': 75.777, 'test/acc_align': 88.753}
[19 / 20] best valid accuracy: 80.419 at epoch 14 
 best_stats: {'best_valid_epoch': 14, 'best_valid_valid/acc': 85.67, 'best_valid_valid/acc_unbiased': 80.419, 'best_valid_valid/diff': 14.768, 'best_valid_valid/acc_skew': 73.035, 'best_valid_valid/acc_align': 87.803, 'best_valid_test/acc': 86.911, 'best_valid_test/acc_unbiased': 81.369, 'best_valid_test/diff': 14.632, 'best_valid_test/acc_skew': 74.053, 'best_valid_test/acc_align': 88.685}
[19 / 20] best test accuracy: 82.265 at epoch 19 
 best_stats: {'best_test_epoch': 19, 'best_test_valid/acc': 85.714, 'best_test_valid/acc_unbiased': 80.387, 'best_test_valid/diff': 14.58, 'best_test_valid/acc_skew': 73.097, 'best_test_valid/acc_align': 87.677, 'best_test_test/acc': 87.307, 'best_test_test/acc_unbiased': 82.265, 'best_test_test/diff': 12.976, 'best_test_test/acc_skew': 75.777, 'best_test_test/acc_align': 88.753}
[20 / 20] Learning rate: 1e-05 weight: 0.01
[20 / 20] Loss: 4.651346687429669 CE Loss: 0.33453391498284296 Con Loss: 4.648001342753239
[20 / 20] tensor([[0.945, 0.818],
        [0.828, 0.691]]) {'epoch': 20, 'valid/acc': 85.802, 'valid/acc_unbiased': 80.491, 'valid/diff': 14.293, 'valid/acc_skew': 73.345, 'valid/acc_align': 87.638, 'test/acc': 87.219, 'test/acc_unbiased': 82.064, 'test/diff': 13.219, 'test/acc_skew': 75.455, 'test/acc_align': 88.674}
[20 / 20] best valid accuracy: 80.491 at epoch 20 
 best_stats: {'best_valid_epoch': 20, 'best_valid_valid/acc': 85.802, 'best_valid_valid/acc_unbiased': 80.491, 'best_valid_valid/diff': 14.293, 'best_valid_valid/acc_skew': 73.345, 'best_valid_valid/acc_align': 87.638, 'best_valid_test/acc': 87.219, 'best_valid_test/acc_unbiased': 82.064, 'best_valid_test/diff': 13.219, 'best_valid_test/acc_skew': 75.455, 'best_valid_test/acc_align': 88.674}
[20 / 20] best test accuracy: 82.265 at epoch 19 
 best_stats: {'best_test_epoch': 19, 'best_test_valid/acc': 85.714, 'best_test_valid/acc_unbiased': 80.387, 'best_test_valid/diff': 14.58, 'best_test_valid/acc_skew': 73.097, 'best_test_valid/acc_align': 87.677, 'best_test_test/acc': 87.307, 'best_test_test/acc_unbiased': 82.265, 'best_test_test/diff': 12.976, 'best_test_test/acc_skew': 75.777, 'best_test_test/acc_align': 88.753}
Total training time: 0:44:47
