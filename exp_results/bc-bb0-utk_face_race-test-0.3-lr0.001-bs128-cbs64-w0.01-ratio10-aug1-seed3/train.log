Log level set to: INFO
Set seed: 3
=======> Using Fixed Random Seed: 3 <========
save_path: exp_results/bc-bb0-utk_face_race-test-0.3-lr0.001-bs128-cbs64-w0.01-ratio10-aug1-seed3
get_utk_face - split: train, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_race-0.3
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [4407, 3870]
Target 1: [3084, 5529]
Binary Target 1
---------------------------
Target 0: [4407, 3870]
Target 1: [3084, 5529]
===================================
Normal Label Distribution: 
Target 0: [4407, 3870]
Target 1: [3084, 5529]
===================================
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [4407, 3870]
Target 1: [3084, 5529]
Binary Target 1
---------------------------
Target 0: [4407, 3870]
Target 1: [3084, 5529]
===================================
Normal Label Distribution: 
Target 0: [4407, 3870]
Target 1: [3084, 5529]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 16890, target_attr: gender, bias_attr: race bias_rate: 0.3
['[train] target_0-bias_0: 4407', '[train] target_0-bias_1: 3870', '[train] target_1-bias_0: 3084', '[train] target_1-bias_1: 5529']
confusion_matrix - 
 original: tensor([[4407., 3084.],
        [3870., 5529.]]), 
 normalized: tensor([[0.588, 0.412],
        [0.412, 0.588]]), 
 b|y: tensor([[0.532, 0.468],
        [0.358, 0.642]])
get_utk_face - split: train, aug: 1, given_y: True, ratio: 10
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_race-0.3
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [4407, 3870]
Target 1: [3084, 5529]
Binary Target 1
---------------------------
Target 0: [4407, 3870]
Target 1: [3084, 5529]
===================================
Normal Label Distribution: 
Target 0: [4407, 3870]
Target 1: [3084, 5529]
===================================
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [4407, 3870]
Target 1: [3084, 5529]
Binary Target 1
---------------------------
Target 0: [4407, 3870]
Target 1: [3084, 5529]
===================================
Normal Label Distribution: 
Target 0: [4407, 3870]
Target 1: [3084, 5529]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 16890, target_attr: gender, bias_attr: race bias_rate: 0.3
['[train] target_0-bias_0: 4407', '[train] target_0-bias_1: 3870', '[train] target_1-bias_0: 3084', '[train] target_1-bias_1: 5529']
get_utk_face - split: valid, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_race-0.3
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [583, 684]
Target 1: [457, 646]
Binary Target 1
---------------------------
Target 0: [583, 684]
Target 1: [457, 646]
===================================
Normal Label Distribution: 
Target 0: [583, 684]
Target 1: [457, 646]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 2370, target_attr: gender, bias_attr: race bias_rate: 0.3
['[valid] target_0-bias_0: 583', '[valid] target_0-bias_1: 684', '[valid] target_1-bias_0: 457', '[valid] target_1-bias_1: 646']
get_utk_face - split: test, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_race-0.3
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [558, 677]
Target 1: [462, 673]
Binary Target 1
---------------------------
Target 0: [558, 677]
Target 1: [462, 673]
===================================
Normal Label Distribution: 
Target 0: [558, 677]
Target 1: [462, 673]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 2370, target_attr: gender, bias_attr: race bias_rate: 0.3
['[test] target_0-bias_0: 558', '[test] target_0-bias_1: 677', '[test] target_1-bias_0: 462', '[test] target_1-bias_1: 673']
decay_epochs: [6, 13]
[1 / 20] Learning rate: 0.001 weight: 0.01
[1 / 20] Loss: 4.856961387794635 CE Loss: 0.5546432067262413 Con Loss: 4.851414945070528
[1 / 20] tensor([[0.928, 0.886],
        [0.697, 0.694]]) {'epoch': 1, 'valid/acc': 80.042, 'valid/acc_unbiased': 79.49, 'valid/diff': 4.009, 'valid/acc_skew': 79.602, 'valid/acc_align': 79.378, 'test/acc': 80.464, 'test/acc_unbiased': 80.136, 'test/diff': 2.256, 'test/acc_skew': 79.162, 'test/acc_align': 81.111}
[1 / 20] best valid accuracy: 79.490 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 80.042, 'best_valid_valid/acc_unbiased': 79.49, 'best_valid_valid/diff': 4.009, 'best_valid_valid/acc_skew': 79.602, 'best_valid_valid/acc_align': 79.378, 'best_valid_test/acc': 80.464, 'best_valid_test/acc_unbiased': 80.136, 'best_valid_test/diff': 2.256, 'best_valid_test/acc_skew': 79.162, 'best_valid_test/acc_align': 81.111}
[1 / 20] best test accuracy: 80.136 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 80.042, 'best_test_valid/acc_unbiased': 79.49, 'best_test_valid/diff': 4.009, 'best_test_valid/acc_skew': 79.602, 'best_test_valid/acc_align': 79.378, 'best_test_test/acc': 80.464, 'best_test_test/acc_unbiased': 80.136, 'best_test_test/diff': 2.256, 'best_test_test/acc_skew': 79.162, 'best_test_test/acc_align': 81.111}
[2 / 20] Learning rate: 0.001 weight: 0.01
[2 / 20] Loss: 4.7550748571550585 CE Loss: 0.4479183898090681 Con Loss: 4.750595665881449
[2 / 20] tensor([[0.819, 0.801],
        [0.805, 0.840]]) {'epoch': 2, 'valid/acc': 82.321, 'valid/acc_unbiased': 82.326, 'valid/diff': 1.321, 'valid/acc_skew': 82.987, 'valid/acc_align': 81.665, 'test/acc': 81.688, 'test/acc_unbiased': 81.608, 'test/diff': 2.637, 'test/acc_skew': 80.289, 'test/acc_align': 82.926}
[2 / 20] best valid accuracy: 82.326 at epoch 2 
 best_stats: {'best_valid_epoch': 2, 'best_valid_valid/acc': 82.321, 'best_valid_valid/acc_unbiased': 82.326, 'best_valid_valid/diff': 1.321, 'best_valid_valid/acc_skew': 82.987, 'best_valid_valid/acc_align': 81.665, 'best_valid_test/acc': 81.688, 'best_valid_test/acc_unbiased': 81.608, 'best_valid_test/diff': 2.637, 'best_valid_test/acc_skew': 80.289, 'best_valid_test/acc_align': 82.926}
[2 / 20] best test accuracy: 81.608 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 82.321, 'best_test_valid/acc_unbiased': 82.326, 'best_test_valid/diff': 1.321, 'best_test_valid/acc_skew': 82.987, 'best_test_valid/acc_align': 81.665, 'best_test_test/acc': 81.688, 'best_test_test/acc_unbiased': 81.608, 'best_test_test/diff': 2.637, 'best_test_test/acc_skew': 80.289, 'best_test_test/acc_align': 82.926}
[3 / 20] Learning rate: 0.001 weight: 0.01
[3 / 20] Loss: 4.734031977803133 CE Loss: 0.4197738360942222 Con Loss: 4.729834252578256
[3 / 20] tensor([[0.860, 0.827],
        [0.838, 0.822]]) {'epoch': 3, 'valid/acc': 84.599, 'valid/acc_unbiased': 84.672, 'valid/diff': 3.331, 'valid/acc_skew': 85.178, 'valid/acc_align': 84.167, 'test/acc': 83.544, 'test/acc_unbiased': 83.669, 'test/diff': 2.45, 'test/acc_skew': 83.242, 'test/acc_align': 84.095}
[3 / 20] best valid accuracy: 84.672 at epoch 3 
 best_stats: {'best_valid_epoch': 3, 'best_valid_valid/acc': 84.599, 'best_valid_valid/acc_unbiased': 84.672, 'best_valid_valid/diff': 3.331, 'best_valid_valid/acc_skew': 85.178, 'best_valid_valid/acc_align': 84.167, 'best_valid_test/acc': 83.544, 'best_valid_test/acc_unbiased': 83.669, 'best_valid_test/diff': 2.45, 'best_valid_test/acc_skew': 83.242, 'best_valid_test/acc_align': 84.095}
[3 / 20] best test accuracy: 83.669 at epoch 3 
 best_stats: {'best_test_epoch': 3, 'best_test_valid/acc': 84.599, 'best_test_valid/acc_unbiased': 84.672, 'best_test_valid/diff': 3.331, 'best_test_valid/acc_skew': 85.178, 'best_test_valid/acc_align': 84.167, 'best_test_test/acc': 83.544, 'best_test_test/acc_unbiased': 83.669, 'best_test_test/diff': 2.45, 'best_test_test/acc_skew': 83.242, 'best_test_test/acc_align': 84.095}
[4 / 20] Learning rate: 0.001 weight: 0.01
[4 / 20] Loss: 4.712777914698834 CE Loss: 0.39691404804384445 Con Loss: 4.708808766066357
[4 / 20] tensor([[0.842, 0.790],
        [0.866, 0.908]]) {'epoch': 4, 'valid/acc': 85.443, 'valid/acc_unbiased': 85.815, 'valid/diff': 2.943, 'valid/acc_skew': 84.588, 'valid/acc_align': 87.043, 'test/acc': 85.063, 'test/acc_unbiased': 85.156, 'test/diff': 4.706, 'test/acc_skew': 82.803, 'test/acc_align': 87.508}
[4 / 20] best valid accuracy: 85.815 at epoch 4 
 best_stats: {'best_valid_epoch': 4, 'best_valid_valid/acc': 85.443, 'best_valid_valid/acc_unbiased': 85.815, 'best_valid_valid/diff': 2.943, 'best_valid_valid/acc_skew': 84.588, 'best_valid_valid/acc_align': 87.043, 'best_valid_test/acc': 85.063, 'best_valid_test/acc_unbiased': 85.156, 'best_valid_test/diff': 4.706, 'best_valid_test/acc_skew': 82.803, 'best_valid_test/acc_align': 87.508}
[4 / 20] best test accuracy: 85.156 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 85.443, 'best_test_valid/acc_unbiased': 85.815, 'best_test_valid/diff': 2.943, 'best_test_valid/acc_skew': 84.588, 'best_test_valid/acc_align': 87.043, 'best_test_test/acc': 85.063, 'best_test_test/acc_unbiased': 85.156, 'best_test_test/diff': 4.706, 'best_test_test/acc_skew': 82.803, 'best_test_test/acc_align': 87.508}
[5 / 20] Learning rate: 0.001 weight: 0.01
[5 / 20] Loss: 4.707467001863596 CE Loss: 0.3996049734069583 Con Loss: 4.703470968310829
[5 / 20] tensor([[0.873, 0.820],
        [0.833, 0.845]]) {'epoch': 5, 'valid/acc': 84.895, 'valid/acc_unbiased': 84.953, 'valid/diff': 2.13, 'valid/acc_skew': 84.775, 'valid/acc_align': 85.131, 'test/acc': 84.219, 'test/acc_unbiased': 84.284, 'test/diff': 3.255, 'test/acc_skew': 82.656, 'test/acc_align': 85.911}
[5 / 20] best valid accuracy: 85.815 at epoch 4 
 best_stats: {'best_valid_epoch': 4, 'best_valid_valid/acc': 85.443, 'best_valid_valid/acc_unbiased': 85.815, 'best_valid_valid/diff': 2.943, 'best_valid_valid/acc_skew': 84.588, 'best_valid_valid/acc_align': 87.043, 'best_valid_test/acc': 85.063, 'best_valid_test/acc_unbiased': 85.156, 'best_valid_test/diff': 4.706, 'best_valid_test/acc_skew': 82.803, 'best_valid_test/acc_align': 87.508}
[5 / 20] best test accuracy: 85.156 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 85.443, 'best_test_valid/acc_unbiased': 85.815, 'best_test_valid/diff': 2.943, 'best_test_valid/acc_skew': 84.588, 'best_test_valid/acc_align': 87.043, 'best_test_test/acc': 85.063, 'best_test_test/acc_unbiased': 85.156, 'best_test_test/diff': 4.706, 'best_test_test/acc_skew': 82.803, 'best_test_test/acc_align': 87.508}
[6 / 20] Learning rate: 0.001 weight: 0.01
[6 / 20] Loss: 4.6947446638483346 CE Loss: 0.39258822516056824 Con Loss: 4.690818782442769
[6 / 20] tensor([[0.797, 0.790],
        [0.868, 0.897]]) {'epoch': 6, 'valid/acc': 84.768, 'valid/acc_unbiased': 85.075, 'valid/diff': 1.833, 'valid/acc_skew': 84.662, 'valid/acc_align': 85.489, 'test/acc': 83.755, 'test/acc_unbiased': 83.83, 'test/diff': 1.837, 'test/acc_skew': 82.911, 'test/acc_align': 84.748}
[6 / 20] best valid accuracy: 85.815 at epoch 4 
 best_stats: {'best_valid_epoch': 4, 'best_valid_valid/acc': 85.443, 'best_valid_valid/acc_unbiased': 85.815, 'best_valid_valid/diff': 2.943, 'best_valid_valid/acc_skew': 84.588, 'best_valid_valid/acc_align': 87.043, 'best_valid_test/acc': 85.063, 'best_valid_test/acc_unbiased': 85.156, 'best_valid_test/diff': 4.706, 'best_valid_test/acc_skew': 82.803, 'best_valid_test/acc_align': 87.508}
[6 / 20] best test accuracy: 85.156 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 85.443, 'best_test_valid/acc_unbiased': 85.815, 'best_test_valid/diff': 2.943, 'best_test_valid/acc_skew': 84.588, 'best_test_valid/acc_align': 87.043, 'best_test_test/acc': 85.063, 'best_test_test/acc_unbiased': 85.156, 'best_test_test/diff': 4.706, 'best_test_test/acc_skew': 82.803, 'best_test_test/acc_align': 87.508}
[7 / 20] Learning rate: 0.0001 weight: 0.01
[7 / 20] Loss: 4.658262571546014 CE Loss: 0.3508588861896838 Con Loss: 4.654753970930462
[7 / 20] tensor([[0.891, 0.861],
        [0.874, 0.887]]) {'epoch': 7, 'valid/acc': 87.722, 'valid/acc_unbiased': 87.883, 'valid/diff': 3.639, 'valid/acc_skew': 87.914, 'valid/acc_align': 87.853, 'test/acc': 87.806, 'test/acc_unbiased': 87.834, 'test/diff': 2.107, 'test/acc_skew': 86.781, 'test/acc_align': 88.888}
[7 / 20] best valid accuracy: 87.883 at epoch 7 
 best_stats: {'best_valid_epoch': 7, 'best_valid_valid/acc': 87.722, 'best_valid_valid/acc_unbiased': 87.883, 'best_valid_valid/diff': 3.639, 'best_valid_valid/acc_skew': 87.914, 'best_valid_valid/acc_align': 87.853, 'best_valid_test/acc': 87.806, 'best_valid_test/acc_unbiased': 87.834, 'best_valid_test/diff': 2.107, 'best_valid_test/acc_skew': 86.781, 'best_valid_test/acc_align': 88.888}
[7 / 20] best test accuracy: 87.834 at epoch 7 
 best_stats: {'best_test_epoch': 7, 'best_test_valid/acc': 87.722, 'best_test_valid/acc_unbiased': 87.883, 'best_test_valid/diff': 3.639, 'best_test_valid/acc_skew': 87.914, 'best_test_valid/acc_align': 87.853, 'best_test_test/acc': 87.806, 'best_test_test/acc_unbiased': 87.834, 'best_test_test/diff': 2.107, 'best_test_test/acc_skew': 86.781, 'best_test_test/acc_align': 88.888}
[8 / 20] Learning rate: 0.0001 weight: 0.01
[8 / 20] Loss: 4.6374908293119335 CE Loss: 0.33361257853911713 Con Loss: 4.634154703039753
[8 / 20] tensor([[0.849, 0.846],
        [0.887, 0.905]]) {'epoch': 8, 'valid/acc': 88.523, 'valid/acc_unbiased': 88.807, 'valid/diff': 2.923, 'valid/acc_skew': 88.606, 'valid/acc_align': 89.007, 'test/acc': 87.173, 'test/acc_unbiased': 87.205, 'test/diff': 1.027, 'test/acc_skew': 86.691, 'test/acc_align': 87.718}
[8 / 20] best valid accuracy: 88.807 at epoch 8 
 best_stats: {'best_valid_epoch': 8, 'best_valid_valid/acc': 88.523, 'best_valid_valid/acc_unbiased': 88.807, 'best_valid_valid/diff': 2.923, 'best_valid_valid/acc_skew': 88.606, 'best_valid_valid/acc_align': 89.007, 'best_valid_test/acc': 87.173, 'best_valid_test/acc_unbiased': 87.205, 'best_valid_test/diff': 1.027, 'best_valid_test/acc_skew': 86.691, 'best_valid_test/acc_align': 87.718}
[8 / 20] best test accuracy: 87.834 at epoch 7 
 best_stats: {'best_test_epoch': 7, 'best_test_valid/acc': 87.722, 'best_test_valid/acc_unbiased': 87.883, 'best_test_valid/diff': 3.639, 'best_test_valid/acc_skew': 87.914, 'best_test_valid/acc_align': 87.853, 'best_test_test/acc': 87.806, 'best_test_test/acc_unbiased': 87.834, 'best_test_test/diff': 2.107, 'best_test_test/acc_skew': 86.781, 'best_test_test/acc_align': 88.888}
[9 / 20] Learning rate: 0.0001 weight: 0.01
[9 / 20] Loss: 4.628063848528233 CE Loss: 0.3147346873725216 Con Loss: 4.624916493815032
[9 / 20] tensor([[0.857, 0.838],
        [0.898, 0.914]]) {'epoch': 9, 'valid/acc': 88.354, 'valid/acc_unbiased': 88.677, 'valid/diff': 2.294, 'valid/acc_skew': 88.422, 'valid/acc_align': 88.932, 'test/acc': 87.553, 'test/acc_unbiased': 87.656, 'test/diff': 1.733, 'test/acc_skew': 86.789, 'test/acc_align': 88.522}
[9 / 20] best valid accuracy: 88.807 at epoch 8 
 best_stats: {'best_valid_epoch': 8, 'best_valid_valid/acc': 88.523, 'best_valid_valid/acc_unbiased': 88.807, 'best_valid_valid/diff': 2.923, 'best_valid_valid/acc_skew': 88.606, 'best_valid_valid/acc_align': 89.007, 'best_valid_test/acc': 87.173, 'best_valid_test/acc_unbiased': 87.205, 'best_valid_test/diff': 1.027, 'best_valid_test/acc_skew': 86.691, 'best_valid_test/acc_align': 87.718}
[9 / 20] best test accuracy: 87.834 at epoch 7 
 best_stats: {'best_test_epoch': 7, 'best_test_valid/acc': 87.722, 'best_test_valid/acc_unbiased': 87.883, 'best_test_valid/diff': 3.639, 'best_test_valid/acc_skew': 87.914, 'best_test_valid/acc_align': 87.853, 'best_test_test/acc': 87.806, 'best_test_test/acc_unbiased': 87.834, 'best_test_test/diff': 2.107, 'best_test_test/acc_skew': 86.781, 'best_test_test/acc_align': 88.888}
[10 / 20] Learning rate: 0.0001 weight: 0.01
[10 / 20] Loss: 4.620047576615202 CE Loss: 0.315601004041674 Con Loss: 4.616891579207335
[10 / 20] tensor([[0.869, 0.843],
        [0.885, 0.908]]) {'epoch': 10, 'valid/acc': 88.65, 'valid/acc_unbiased': 88.902, 'valid/diff': 2.512, 'valid/acc_skew': 88.642, 'valid/acc_align': 89.162, 'test/acc': 87.595, 'test/acc_unbiased': 87.644, 'test/diff': 2.417, 'test/acc_skew': 86.435, 'test/acc_align': 88.853}
[10 / 20] best valid accuracy: 88.902 at epoch 10 
 best_stats: {'best_valid_epoch': 10, 'best_valid_valid/acc': 88.65, 'best_valid_valid/acc_unbiased': 88.902, 'best_valid_valid/diff': 2.512, 'best_valid_valid/acc_skew': 88.642, 'best_valid_valid/acc_align': 89.162, 'best_valid_test/acc': 87.595, 'best_valid_test/acc_unbiased': 87.644, 'best_valid_test/diff': 2.417, 'best_valid_test/acc_skew': 86.435, 'best_valid_test/acc_align': 88.853}
[10 / 20] best test accuracy: 87.834 at epoch 7 
 best_stats: {'best_test_epoch': 7, 'best_test_valid/acc': 87.722, 'best_test_valid/acc_unbiased': 87.883, 'best_test_valid/diff': 3.639, 'best_test_valid/acc_skew': 87.914, 'best_test_valid/acc_align': 87.853, 'best_test_test/acc': 87.806, 'best_test_test/acc_unbiased': 87.834, 'best_test_test/diff': 2.107, 'best_test_test/acc_skew': 86.781, 'best_test_test/acc_align': 88.888}
[11 / 20] Learning rate: 0.0001 weight: 0.01
[11 / 20] Loss: 4.60418688597377 CE Loss: 0.3103778080272562 Con Loss: 4.601083104352121
[11 / 20] tensor([[0.887, 0.883],
        [0.877, 0.875]]) {'epoch': 11, 'valid/acc': 88.397, 'valid/acc_unbiased': 88.569, 'valid/diff': 3.487, 'valid/acc_skew': 88.571, 'valid/acc_align': 88.566, 'test/acc': 88.059, 'test/acc_unbiased': 88.055, 'test/diff': 0.261, 'test/acc_skew': 87.997, 'test/acc_align': 88.114}
[11 / 20] best valid accuracy: 88.902 at epoch 10 
 best_stats: {'best_valid_epoch': 10, 'best_valid_valid/acc': 88.65, 'best_valid_valid/acc_unbiased': 88.902, 'best_valid_valid/diff': 2.512, 'best_valid_valid/acc_skew': 88.642, 'best_valid_valid/acc_align': 89.162, 'best_valid_test/acc': 87.595, 'best_valid_test/acc_unbiased': 87.644, 'best_valid_test/diff': 2.417, 'best_valid_test/acc_skew': 86.435, 'best_valid_test/acc_align': 88.853}
[11 / 20] best test accuracy: 88.055 at epoch 11 
 best_stats: {'best_test_epoch': 11, 'best_test_valid/acc': 88.397, 'best_test_valid/acc_unbiased': 88.569, 'best_test_valid/diff': 3.487, 'best_test_valid/acc_skew': 88.571, 'best_test_valid/acc_align': 88.566, 'best_test_test/acc': 88.059, 'best_test_test/acc_unbiased': 88.055, 'best_test_test/diff': 0.261, 'best_test_test/acc_skew': 87.997, 'best_test_test/acc_align': 88.114}
[12 / 20] Learning rate: 0.0001 weight: 0.01
[12 / 20] Loss: 4.61763560321643 CE Loss: 0.3101920297507212 Con Loss: 4.614533680497435
[12 / 20] tensor([[0.855, 0.833],
        [0.896, 0.909]]) {'epoch': 12, 'valid/acc': 88.776, 'valid/acc_unbiased': 89.105, 'valid/diff': 2.437, 'valid/acc_skew': 89.262, 'valid/acc_align': 88.949, 'test/acc': 87.215, 'test/acc_unbiased': 87.335, 'test/diff': 1.75, 'test/acc_skew': 86.46, 'test/acc_align': 88.21}
[12 / 20] best valid accuracy: 89.105 at epoch 12 
 best_stats: {'best_valid_epoch': 12, 'best_valid_valid/acc': 88.776, 'best_valid_valid/acc_unbiased': 89.105, 'best_valid_valid/diff': 2.437, 'best_valid_valid/acc_skew': 89.262, 'best_valid_valid/acc_align': 88.949, 'best_valid_test/acc': 87.215, 'best_valid_test/acc_unbiased': 87.335, 'best_valid_test/diff': 1.75, 'best_valid_test/acc_skew': 86.46, 'best_valid_test/acc_align': 88.21}
[12 / 20] best test accuracy: 88.055 at epoch 11 
 best_stats: {'best_test_epoch': 11, 'best_test_valid/acc': 88.397, 'best_test_valid/acc_unbiased': 88.569, 'best_test_valid/diff': 3.487, 'best_test_valid/acc_skew': 88.571, 'best_test_valid/acc_align': 88.566, 'best_test_test/acc': 88.059, 'best_test_test/acc_unbiased': 88.055, 'best_test_test/diff': 0.261, 'best_test_test/acc_skew': 87.997, 'best_test_test/acc_align': 88.114}
[13 / 20] Learning rate: 0.0001 weight: 0.01
[13 / 20] Loss: 4.604558798573722 CE Loss: 0.30484840329262264 Con Loss: 4.6015102964664365
[13 / 20] tensor([[0.867, 0.858],
        [0.894, 0.896]]) {'epoch': 13, 'valid/acc': 88.734, 'valid/acc_unbiased': 88.921, 'valid/diff': 2.162, 'valid/acc_skew': 88.972, 'valid/acc_align': 88.869, 'test/acc': 87.806, 'test/acc_unbiased': 87.888, 'test/diff': 0.562, 'test/acc_skew': 87.607, 'test/acc_align': 88.169}
[13 / 20] best valid accuracy: 89.105 at epoch 12 
 best_stats: {'best_valid_epoch': 12, 'best_valid_valid/acc': 88.776, 'best_valid_valid/acc_unbiased': 89.105, 'best_valid_valid/diff': 2.437, 'best_valid_valid/acc_skew': 89.262, 'best_valid_valid/acc_align': 88.949, 'best_valid_test/acc': 87.215, 'best_valid_test/acc_unbiased': 87.335, 'best_valid_test/diff': 1.75, 'best_valid_test/acc_skew': 86.46, 'best_valid_test/acc_align': 88.21}
[13 / 20] best test accuracy: 88.055 at epoch 11 
 best_stats: {'best_test_epoch': 11, 'best_test_valid/acc': 88.397, 'best_test_valid/acc_unbiased': 88.569, 'best_test_valid/diff': 3.487, 'best_test_valid/acc_skew': 88.571, 'best_test_valid/acc_align': 88.566, 'best_test_test/acc': 88.059, 'best_test_test/acc_unbiased': 88.055, 'best_test_test/diff': 0.261, 'best_test_test/acc_skew': 87.997, 'best_test_test/acc_align': 88.114}
[14 / 20] Learning rate: 1e-05 weight: 0.01
[14 / 20] Loss: 4.599735152446144 CE Loss: 0.29695291456349016 Con Loss: 4.5967656344475305
[14 / 20] tensor([[0.860, 0.855],
        [0.896, 0.895]]) {'epoch': 14, 'valid/acc': 88.903, 'valid/acc_unbiased': 89.122, 'valid/diff': 2.368, 'valid/acc_skew': 88.825, 'valid/acc_align': 89.42, 'test/acc': 87.553, 'test/acc_unbiased': 87.652, 'test/diff': 0.329, 'test/acc_skew': 87.567, 'test/acc_align': 87.736}
[14 / 20] best valid accuracy: 89.122 at epoch 14 
 best_stats: {'best_valid_epoch': 14, 'best_valid_valid/acc': 88.903, 'best_valid_valid/acc_unbiased': 89.122, 'best_valid_valid/diff': 2.368, 'best_valid_valid/acc_skew': 88.825, 'best_valid_valid/acc_align': 89.42, 'best_valid_test/acc': 87.553, 'best_valid_test/acc_unbiased': 87.652, 'best_valid_test/diff': 0.329, 'best_valid_test/acc_skew': 87.567, 'best_valid_test/acc_align': 87.736}
[14 / 20] best test accuracy: 88.055 at epoch 11 
 best_stats: {'best_test_epoch': 11, 'best_test_valid/acc': 88.397, 'best_test_valid/acc_unbiased': 88.569, 'best_test_valid/diff': 3.487, 'best_test_valid/acc_skew': 88.571, 'best_test_valid/acc_align': 88.566, 'best_test_test/acc': 88.059, 'best_test_test/acc_unbiased': 88.055, 'best_test_test/diff': 0.261, 'best_test_test/acc_skew': 87.997, 'best_test_test/acc_align': 88.114}
[15 / 20] Learning rate: 1e-05 weight: 0.01
[15 / 20] Loss: 4.614996429870226 CE Loss: 0.28800207725144333 Con Loss: 4.612116409604404
[15 / 20] tensor([[0.858, 0.849],
        [0.896, 0.899]]) {'epoch': 15, 'valid/acc': 89.283, 'valid/acc_unbiased': 89.55, 'valid/diff': 2.139, 'valid/acc_skew': 89.482, 'valid/acc_align': 89.618, 'test/acc': 87.468, 'test/acc_unbiased': 87.571, 'test/diff': 0.597, 'test/acc_skew': 87.272, 'test/acc_align': 87.869}
[15 / 20] best valid accuracy: 89.550 at epoch 15 
 best_stats: {'best_valid_epoch': 15, 'best_valid_valid/acc': 89.283, 'best_valid_valid/acc_unbiased': 89.55, 'best_valid_valid/diff': 2.139, 'best_valid_valid/acc_skew': 89.482, 'best_valid_valid/acc_align': 89.618, 'best_valid_test/acc': 87.468, 'best_valid_test/acc_unbiased': 87.571, 'best_valid_test/diff': 0.597, 'best_valid_test/acc_skew': 87.272, 'best_valid_test/acc_align': 87.869}
[15 / 20] best test accuracy: 88.055 at epoch 11 
 best_stats: {'best_test_epoch': 11, 'best_test_valid/acc': 88.397, 'best_test_valid/acc_unbiased': 88.569, 'best_test_valid/diff': 3.487, 'best_test_valid/acc_skew': 88.571, 'best_test_valid/acc_align': 88.566, 'best_test_test/acc': 88.059, 'best_test_test/acc_unbiased': 88.055, 'best_test_test/diff': 0.261, 'best_test_test/acc_skew': 87.997, 'best_test_test/acc_align': 88.114}
[16 / 20] Learning rate: 1e-05 weight: 0.01
[16 / 20] Loss: 4.5862964732891145 CE Loss: 0.2902303319735383 Con Loss: 4.5833941717695525
[16 / 20] tensor([[0.853, 0.845],
        [0.900, 0.906]]) {'epoch': 16, 'valid/acc': 89.283, 'valid/acc_unbiased': 89.568, 'valid/diff': 2.322, 'valid/acc_skew': 89.518, 'valid/acc_align': 89.618, 'test/acc': 87.511, 'test/acc_unbiased': 87.619, 'test/diff': 0.705, 'test/acc_skew': 87.267, 'test/acc_align': 87.972}
[16 / 20] best valid accuracy: 89.568 at epoch 16 
 best_stats: {'best_valid_epoch': 16, 'best_valid_valid/acc': 89.283, 'best_valid_valid/acc_unbiased': 89.568, 'best_valid_valid/diff': 2.322, 'best_valid_valid/acc_skew': 89.518, 'best_valid_valid/acc_align': 89.618, 'best_valid_test/acc': 87.511, 'best_valid_test/acc_unbiased': 87.619, 'best_valid_test/diff': 0.705, 'best_valid_test/acc_skew': 87.267, 'best_valid_test/acc_align': 87.972}
[16 / 20] best test accuracy: 88.055 at epoch 11 
 best_stats: {'best_test_epoch': 11, 'best_test_valid/acc': 88.397, 'best_test_valid/acc_unbiased': 88.569, 'best_test_valid/diff': 3.487, 'best_test_valid/acc_skew': 88.571, 'best_test_valid/acc_align': 88.566, 'best_test_test/acc': 88.059, 'best_test_test/acc_unbiased': 88.055, 'best_test_test/diff': 0.261, 'best_test_test/acc_skew': 87.997, 'best_test_test/acc_align': 88.114}
[17 / 20] Learning rate: 1e-05 weight: 0.01
[17 / 20] Loss: 4.595011401642279 CE Loss: 0.291356427659644 Con Loss: 4.592097844733085
[17 / 20] tensor([[0.864, 0.848],
        [0.892, 0.896]]) {'epoch': 17, 'valid/acc': 89.451, 'valid/acc_unbiased': 89.683, 'valid/diff': 2.122, 'valid/acc_skew': 89.482, 'valid/acc_align': 89.884, 'test/acc': 87.384, 'test/acc_unbiased': 87.486, 'test/diff': 1.008, 'test/acc_skew': 86.982, 'test/acc_align': 87.989}
[17 / 20] best valid accuracy: 89.683 at epoch 17 
 best_stats: {'best_valid_epoch': 17, 'best_valid_valid/acc': 89.451, 'best_valid_valid/acc_unbiased': 89.683, 'best_valid_valid/diff': 2.122, 'best_valid_valid/acc_skew': 89.482, 'best_valid_valid/acc_align': 89.884, 'best_valid_test/acc': 87.384, 'best_valid_test/acc_unbiased': 87.486, 'best_valid_test/diff': 1.008, 'best_valid_test/acc_skew': 86.982, 'best_valid_test/acc_align': 87.989}
[17 / 20] best test accuracy: 88.055 at epoch 11 
 best_stats: {'best_test_epoch': 11, 'best_test_valid/acc': 88.397, 'best_test_valid/acc_unbiased': 88.569, 'best_test_valid/diff': 3.487, 'best_test_valid/acc_skew': 88.571, 'best_test_valid/acc_align': 88.566, 'best_test_test/acc': 88.059, 'best_test_test/acc_unbiased': 88.055, 'best_test_test/diff': 0.261, 'best_test_test/acc_skew': 87.997, 'best_test_test/acc_align': 88.114}
[18 / 20] Learning rate: 1e-05 weight: 0.01
[18 / 20] Loss: 4.587864636443225 CE Loss: 0.28774906721885846 Con Loss: 4.584987152476788
[18 / 20] tensor([[0.866, 0.869],
        [0.885, 0.892]]) {'epoch': 18, 'valid/acc': 89.409, 'valid/acc_unbiased': 89.596, 'valid/diff': 1.982, 'valid/acc_skew': 89.446, 'valid/acc_align': 89.746, 'test/acc': 87.764, 'test/acc_unbiased': 87.774, 'test/diff': 0.46, 'test/acc_skew': 87.691, 'test/acc_align': 87.856}
[18 / 20] best valid accuracy: 89.683 at epoch 17 
 best_stats: {'best_valid_epoch': 17, 'best_valid_valid/acc': 89.451, 'best_valid_valid/acc_unbiased': 89.683, 'best_valid_valid/diff': 2.122, 'best_valid_valid/acc_skew': 89.482, 'best_valid_valid/acc_align': 89.884, 'best_valid_test/acc': 87.384, 'best_valid_test/acc_unbiased': 87.486, 'best_valid_test/diff': 1.008, 'best_valid_test/acc_skew': 86.982, 'best_valid_test/acc_align': 87.989}
[18 / 20] best test accuracy: 88.055 at epoch 11 
 best_stats: {'best_test_epoch': 11, 'best_test_valid/acc': 88.397, 'best_test_valid/acc_unbiased': 88.569, 'best_test_valid/diff': 3.487, 'best_test_valid/acc_skew': 88.571, 'best_test_valid/acc_align': 88.566, 'best_test_test/acc': 88.059, 'best_test_test/acc_unbiased': 88.055, 'best_test_test/diff': 0.261, 'best_test_test/acc_skew': 87.997, 'best_test_test/acc_align': 88.114}
[19 / 20] Learning rate: 1e-05 weight: 0.01
[19 / 20] Loss: 4.593342228906969 CE Loss: 0.28307552968629934 Con Loss: 4.590511476393632
[19 / 20] tensor([[0.866, 0.864],
        [0.887, 0.892]]) {'epoch': 19, 'valid/acc': 89.494, 'valid/acc_unbiased': 89.712, 'valid/diff': 2.36, 'valid/acc_skew': 89.592, 'valid/acc_align': 89.832, 'test/acc': 87.679, 'test/acc_unbiased': 87.717, 'test/diff': 0.278, 'test/acc_skew': 87.578, 'test/acc_align': 87.856}
[19 / 20] best valid accuracy: 89.712 at epoch 19 
 best_stats: {'best_valid_epoch': 19, 'best_valid_valid/acc': 89.494, 'best_valid_valid/acc_unbiased': 89.712, 'best_valid_valid/diff': 2.36, 'best_valid_valid/acc_skew': 89.592, 'best_valid_valid/acc_align': 89.832, 'best_valid_test/acc': 87.679, 'best_valid_test/acc_unbiased': 87.717, 'best_valid_test/diff': 0.278, 'best_valid_test/acc_skew': 87.578, 'best_valid_test/acc_align': 87.856}
[19 / 20] best test accuracy: 88.055 at epoch 11 
 best_stats: {'best_test_epoch': 11, 'best_test_valid/acc': 88.397, 'best_test_valid/acc_unbiased': 88.569, 'best_test_valid/diff': 3.487, 'best_test_valid/acc_skew': 88.571, 'best_test_valid/acc_align': 88.566, 'best_test_test/acc': 88.059, 'best_test_test/acc_unbiased': 88.055, 'best_test_test/diff': 0.261, 'best_test_test/acc_skew': 87.997, 'best_test_test/acc_align': 88.114}
[20 / 20] Learning rate: 1e-05 weight: 0.01
[20 / 20] Loss: 4.596675799173883 CE Loss: 0.2852980976841589 Con Loss: 4.593822817240614
[20 / 20] tensor([[0.858, 0.857],
        [0.898, 0.906]]) {'epoch': 20, 'valid/acc': 89.072, 'valid/acc_unbiased': 89.417, 'valid/diff': 3.061, 'valid/acc_skew': 89.371, 'valid/acc_align': 89.463, 'test/acc': 87.932, 'test/acc_unbiased': 87.995, 'test/diff': 0.491, 'test/acc_skew': 87.749, 'test/acc_align': 88.241}
[20 / 20] best valid accuracy: 89.712 at epoch 19 
 best_stats: {'best_valid_epoch': 19, 'best_valid_valid/acc': 89.494, 'best_valid_valid/acc_unbiased': 89.712, 'best_valid_valid/diff': 2.36, 'best_valid_valid/acc_skew': 89.592, 'best_valid_valid/acc_align': 89.832, 'best_valid_test/acc': 87.679, 'best_valid_test/acc_unbiased': 87.717, 'best_valid_test/diff': 0.278, 'best_valid_test/acc_skew': 87.578, 'best_valid_test/acc_align': 87.856}
[20 / 20] best test accuracy: 88.055 at epoch 11 
 best_stats: {'best_test_epoch': 11, 'best_test_valid/acc': 88.397, 'best_test_valid/acc_unbiased': 88.569, 'best_test_valid/diff': 3.487, 'best_test_valid/acc_skew': 88.571, 'best_test_valid/acc_align': 88.566, 'best_test_test/acc': 88.059, 'best_test_test/acc_unbiased': 88.055, 'best_test_test/diff': 0.261, 'best_test_test/acc_skew': 87.997, 'best_test_test/acc_align': 88.114}
Total training time: 1:03:45
