Log level set to: INFO
Set seed: 1
=======> Using Fixed Random Seed: 1 <========
save_path: exp_results/bc-bb0-utk_face_age-crop_auto2-0.9-lr0.001-bs128-cbs64-w0.01-ratio10-aug1-seed1
get_utk_face - split: train, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_age-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
Binary Target 1
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Normal Label Distribution: 
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
Binary Target 1
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Normal Label Distribution: 
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 10684, target_attr: gender, bias_attr: age bias_rate: 0.9
['[train] target_0-bias_0: 8237', '[train] target_0-bias_1: 147', '[train] target_1-bias_0: 823', '[train] target_1-bias_1: 1477']
confusion_matrix - 
 original: tensor([[8237.,  823.],
        [ 147., 1477.]]), 
 normalized: tensor([[0.909, 0.091],
        [0.091, 0.909]]), 
 b|y: tensor([[0.982, 0.018],
        [0.358, 0.642]])
get_utk_face - split: train, aug: 1, given_y: True, ratio: 10
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_age-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
Binary Target 1
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Normal Label Distribution: 
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
Binary Target 1
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Normal Label Distribution: 
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 10684, target_attr: gender, bias_attr: age bias_rate: 0.9
['[train] target_0-bias_0: 8237', '[train] target_0-bias_1: 147', '[train] target_1-bias_0: 823', '[train] target_1-bias_1: 1477']
get_utk_face - split: valid, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_age-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [1030, 195]
Target 1: [841, 202]
Binary Target 1
---------------------------
Target 0: [1030, 195]
Target 1: [841, 202]
===================================
Normal Label Distribution: 
Target 0: [1030, 195]
Target 1: [841, 202]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 2268, target_attr: gender, bias_attr: age bias_rate: 0.9
['[valid] target_0-bias_0: 1030', '[valid] target_0-bias_1: 195', '[valid] target_1-bias_0: 841', '[valid] target_1-bias_1: 202']
get_utk_face - split: test, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_age-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [1061, 176]
Target 1: [867, 165]
Binary Target 1
---------------------------
Target 0: [1061, 176]
Target 1: [867, 165]
===================================
Normal Label Distribution: 
Target 0: [1061, 176]
Target 1: [867, 165]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 2269, target_attr: gender, bias_attr: age bias_rate: 0.9
['[test] target_0-bias_0: 1061', '[test] target_0-bias_1: 176', '[test] target_1-bias_0: 867', '[test] target_1-bias_1: 165']
decay_epochs: [6, 13]
[1 / 20] Learning rate: 0.001 weight: 0.01
[1 / 20] Loss: 4.822115631774765 CE Loss: 0.5590675708418346 Con Loss: 4.816524962636247
[1 / 20] tensor([[0.996, 1.000],
        [0.106, 0.042]]) {'epoch': 1, 'valid/acc': 58.069, 'valid/acc_unbiased': 53.221, 'valid/diff': 4.259, 'valid/acc_skew': 55.351, 'valid/acc_align': 51.092, 'test/acc': 58.704, 'test/acc_unbiased': 53.619, 'test/diff': 3.373, 'test/acc_skew': 55.306, 'test/acc_align': 51.933}
[1 / 20] best valid accuracy: 53.221 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 58.069, 'best_valid_valid/acc_unbiased': 53.221, 'best_valid_valid/diff': 4.259, 'best_valid_valid/acc_skew': 55.351, 'best_valid_valid/acc_align': 51.092, 'best_valid_test/acc': 58.704, 'best_valid_test/acc_unbiased': 53.619, 'best_valid_test/diff': 3.373, 'best_valid_test/acc_skew': 55.306, 'best_valid_test/acc_align': 51.933}
[1 / 20] best test accuracy: 53.619 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 58.069, 'best_test_valid/acc_unbiased': 53.221, 'best_test_valid/diff': 4.259, 'best_test_valid/acc_skew': 55.351, 'best_test_valid/acc_align': 51.092, 'best_test_test/acc': 58.704, 'best_test_test/acc_unbiased': 53.619, 'best_test_test/diff': 3.373, 'best_test_test/acc_skew': 55.306, 'best_test_test/acc_align': 51.933}
[2 / 20] Learning rate: 0.001 weight: 0.01
[2 / 20] Loss: 4.661945026851869 CE Loss: 0.5001762974177438 Con Loss: 4.656943243391636
[2 / 20] tensor([[0.985, 0.989],
        [0.377, 0.139]]) {'epoch': 2, 'valid/acc': 67.681, 'valid/acc_unbiased': 61.095, 'valid/diff': 12.891, 'valid/acc_skew': 67.07, 'valid/acc_align': 55.12, 'test/acc': 69.149, 'test/acc_unbiased': 62.253, 'test/diff': 12.074, 'test/acc_skew': 68.29, 'test/acc_align': 56.216}
[2 / 20] best valid accuracy: 61.095 at epoch 2 
 best_stats: {'best_valid_epoch': 2, 'best_valid_valid/acc': 67.681, 'best_valid_valid/acc_unbiased': 61.095, 'best_valid_valid/diff': 12.891, 'best_valid_valid/acc_skew': 67.07, 'best_valid_valid/acc_align': 55.12, 'best_valid_test/acc': 69.149, 'best_valid_test/acc_unbiased': 62.253, 'best_valid_test/diff': 12.074, 'best_valid_test/acc_skew': 68.29, 'best_valid_test/acc_align': 56.216}
[2 / 20] best test accuracy: 62.253 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 67.681, 'best_test_valid/acc_unbiased': 61.095, 'best_test_valid/diff': 12.891, 'best_test_valid/acc_skew': 67.07, 'best_test_valid/acc_align': 55.12, 'best_test_test/acc': 69.149, 'best_test_test/acc_unbiased': 62.253, 'best_test_test/diff': 12.074, 'best_test_test/acc_skew': 68.29, 'best_test_test/acc_align': 56.216}
[3 / 20] Learning rate: 0.001 weight: 0.01
[3 / 20] Loss: 4.579651745460936 CE Loss: 0.4962092195276641 Con Loss: 4.5746896515978
[3 / 20] tensor([[0.980, 0.972],
        [0.416, 0.133]]) {'epoch': 3, 'valid/acc': 68.254, 'valid/acc_unbiased': 62.846, 'valid/diff': 9.793, 'valid/acc_skew': 67.743, 'valid/acc_align': 57.95, 'test/acc': 70.251, 'test/acc_unbiased': 62.538, 'test/diff': 14.583, 'test/acc_skew': 69.398, 'test/acc_align': 55.677}
[3 / 20] best valid accuracy: 62.846 at epoch 3 
 best_stats: {'best_valid_epoch': 3, 'best_valid_valid/acc': 68.254, 'best_valid_valid/acc_unbiased': 62.846, 'best_valid_valid/diff': 9.793, 'best_valid_valid/acc_skew': 67.743, 'best_valid_valid/acc_align': 57.95, 'best_valid_test/acc': 70.251, 'best_valid_test/acc_unbiased': 62.538, 'best_valid_test/diff': 14.583, 'best_valid_test/acc_skew': 69.398, 'best_valid_test/acc_align': 55.677}
[3 / 20] best test accuracy: 62.538 at epoch 3 
 best_stats: {'best_test_epoch': 3, 'best_test_valid/acc': 68.254, 'best_test_valid/acc_unbiased': 62.846, 'best_test_valid/diff': 9.793, 'best_test_valid/acc_skew': 67.743, 'best_test_valid/acc_align': 57.95, 'best_test_test/acc': 70.251, 'best_test_test/acc_unbiased': 62.538, 'best_test_test/diff': 14.583, 'best_test_test/acc_skew': 69.398, 'best_test_test/acc_align': 55.677}
[4 / 20] Learning rate: 0.001 weight: 0.01
[4 / 20] Loss: 4.621186840895721 CE Loss: 0.48522006624068986 Con Loss: 4.6163346516599555
[4 / 20] tensor([[0.998, 1.000],
        [0.115, 0.048]]) {'epoch': 4, 'valid/acc': 58.377, 'valid/acc_unbiased': 53.702, 'valid/diff': 3.461, 'valid/acc_skew': 55.273, 'valid/acc_align': 52.131, 'test/acc': 59.189, 'test/acc_unbiased': 54.049, 'test/diff': 3.437, 'test/acc_skew': 55.767, 'test/acc_align': 52.33}
[4 / 20] best valid accuracy: 62.846 at epoch 3 
 best_stats: {'best_valid_epoch': 3, 'best_valid_valid/acc': 68.254, 'best_valid_valid/acc_unbiased': 62.846, 'best_valid_valid/diff': 9.793, 'best_valid_valid/acc_skew': 67.743, 'best_valid_valid/acc_align': 57.95, 'best_valid_test/acc': 70.251, 'best_valid_test/acc_unbiased': 62.538, 'best_valid_test/diff': 14.583, 'best_valid_test/acc_skew': 69.398, 'best_valid_test/acc_align': 55.677}
[4 / 20] best test accuracy: 62.538 at epoch 3 
 best_stats: {'best_test_epoch': 3, 'best_test_valid/acc': 68.254, 'best_test_valid/acc_unbiased': 62.846, 'best_test_valid/diff': 9.793, 'best_test_valid/acc_skew': 67.743, 'best_test_valid/acc_align': 57.95, 'best_test_test/acc': 70.251, 'best_test_test/acc_unbiased': 62.538, 'best_test_test/diff': 14.583, 'best_test_test/acc_skew': 69.398, 'best_test_test/acc_align': 55.677}
[5 / 20] Learning rate: 0.001 weight: 0.01
[5 / 20] Loss: 4.570761251967304 CE Loss: 0.4757500060351767 Con Loss: 4.566003744810184
[5 / 20] tensor([[0.926, 0.920],
        [0.638, 0.303]]) {'epoch': 5, 'valid/acc': 76.499, 'valid/acc_unbiased': 70.433, 'valid/diff': 15.09, 'valid/acc_skew': 74.903, 'valid/acc_align': 65.962, 'test/acc': 77.038, 'test/acc_unbiased': 69.695, 'test/diff': 17.042, 'test/acc_skew': 77.914, 'test/acc_align': 61.476}
[5 / 20] best valid accuracy: 70.433 at epoch 5 
 best_stats: {'best_valid_epoch': 5, 'best_valid_valid/acc': 76.499, 'best_valid_valid/acc_unbiased': 70.433, 'best_valid_valid/diff': 15.09, 'best_valid_valid/acc_skew': 74.903, 'best_valid_valid/acc_align': 65.962, 'best_valid_test/acc': 77.038, 'best_valid_test/acc_unbiased': 69.695, 'best_valid_test/diff': 17.042, 'best_valid_test/acc_skew': 77.914, 'best_valid_test/acc_align': 61.476}
[5 / 20] best test accuracy: 69.695 at epoch 5 
 best_stats: {'best_test_epoch': 5, 'best_test_valid/acc': 76.499, 'best_test_valid/acc_unbiased': 70.433, 'best_test_valid/diff': 15.09, 'best_test_valid/acc_skew': 74.903, 'best_test_valid/acc_align': 65.962, 'best_test_test/acc': 77.038, 'best_test_test/acc_unbiased': 69.695, 'best_test_test/diff': 17.042, 'best_test_test/acc_skew': 77.914, 'best_test_test/acc_align': 61.476}
[6 / 20] Learning rate: 0.001 weight: 0.01
[6 / 20] Loss: 4.515384252398972 CE Loss: 0.4422125664934689 Con Loss: 4.510962109581802
[6 / 20] tensor([[0.993, 0.983],
        [0.212, 0.194]]) {'epoch': 6, 'valid/acc': 63.272, 'valid/acc_unbiased': 60.365, 'valid/diff': 4.225, 'valid/acc_skew': 58.253, 'valid/acc_align': 62.478, 'test/acc': 63.596, 'test/acc_unbiased': 59.563, 'test/diff': 1.437, 'test/acc_skew': 59.759, 'test/acc_align': 59.367}
[6 / 20] best valid accuracy: 70.433 at epoch 5 
 best_stats: {'best_valid_epoch': 5, 'best_valid_valid/acc': 76.499, 'best_valid_valid/acc_unbiased': 70.433, 'best_valid_valid/diff': 15.09, 'best_valid_valid/acc_skew': 74.903, 'best_valid_valid/acc_align': 65.962, 'best_valid_test/acc': 77.038, 'best_valid_test/acc_unbiased': 69.695, 'best_valid_test/diff': 17.042, 'best_valid_test/acc_skew': 77.914, 'best_valid_test/acc_align': 61.476}
[6 / 20] best test accuracy: 69.695 at epoch 5 
 best_stats: {'best_test_epoch': 5, 'best_test_valid/acc': 76.499, 'best_test_valid/acc_unbiased': 70.433, 'best_test_valid/diff': 15.09, 'best_test_valid/acc_skew': 74.903, 'best_test_valid/acc_align': 65.962, 'best_test_test/acc': 77.038, 'best_test_test/acc_unbiased': 69.695, 'best_test_test/diff': 17.042, 'best_test_test/acc_skew': 77.914, 'best_test_test/acc_align': 61.476}
[7 / 20] Learning rate: 0.0001 weight: 0.01
[7 / 20] Loss: 4.541242837459574 CE Loss: 0.41718492278977753 Con Loss: 4.537070970417453
[7 / 20] tensor([[0.973, 0.875],
        [0.600, 0.424]]) {'epoch': 7, 'valid/acc': 78.351, 'valid/acc_unbiased': 73.981, 'valid/diff': 8.926, 'valid/acc_skew': 71.938, 'valid/acc_align': 76.024, 'test/acc': 78.272, 'test/acc_unbiased': 71.792, 'test/diff': 13.66, 'test/acc_skew': 73.738, 'test/acc_align': 69.845}
[7 / 20] best valid accuracy: 73.981 at epoch 7 
 best_stats: {'best_valid_epoch': 7, 'best_valid_valid/acc': 78.351, 'best_valid_valid/acc_unbiased': 73.981, 'best_valid_valid/diff': 8.926, 'best_valid_valid/acc_skew': 71.938, 'best_valid_valid/acc_align': 76.024, 'best_valid_test/acc': 78.272, 'best_valid_test/acc_unbiased': 71.792, 'best_valid_test/diff': 13.66, 'best_valid_test/acc_skew': 73.738, 'best_valid_test/acc_align': 69.845}
[7 / 20] best test accuracy: 71.792 at epoch 7 
 best_stats: {'best_test_epoch': 7, 'best_test_valid/acc': 78.351, 'best_test_valid/acc_unbiased': 73.981, 'best_test_valid/diff': 8.926, 'best_test_valid/acc_skew': 71.938, 'best_test_valid/acc_align': 76.024, 'best_test_test/acc': 78.272, 'best_test_test/acc_unbiased': 71.792, 'best_test_test/diff': 13.66, 'best_test_test/acc_skew': 73.738, 'best_test_test/acc_align': 69.845}
[8 / 20] Learning rate: 0.0001 weight: 0.01
[8 / 20] Loss: 4.463949053709715 CE Loss: 0.41942087272185596 Con Loss: 4.4597548488729775
[8 / 20] tensor([[0.973, 0.824],
        [0.615, 0.412]]) {'epoch': 8, 'valid/acc': 78.131, 'valid/acc_unbiased': 73.066, 'valid/diff': 11.111, 'valid/acc_skew': 71.347, 'valid/acc_align': 74.786, 'test/acc': 78.361, 'test/acc_unbiased': 70.585, 'test/diff': 17.572, 'test/acc_skew': 71.931, 'test/acc_align': 69.239}
[8 / 20] best valid accuracy: 73.981 at epoch 7 
 best_stats: {'best_valid_epoch': 7, 'best_valid_valid/acc': 78.351, 'best_valid_valid/acc_unbiased': 73.981, 'best_valid_valid/diff': 8.926, 'best_valid_valid/acc_skew': 71.938, 'best_valid_valid/acc_align': 76.024, 'best_valid_test/acc': 78.272, 'best_valid_test/acc_unbiased': 71.792, 'best_valid_test/diff': 13.66, 'best_valid_test/acc_skew': 73.738, 'best_valid_test/acc_align': 69.845}
[8 / 20] best test accuracy: 71.792 at epoch 7 
 best_stats: {'best_test_epoch': 7, 'best_test_valid/acc': 78.351, 'best_test_valid/acc_unbiased': 73.981, 'best_test_valid/diff': 8.926, 'best_test_valid/acc_skew': 71.938, 'best_test_valid/acc_align': 76.024, 'best_test_test/acc': 78.272, 'best_test_test/acc_unbiased': 71.792, 'best_test_test/diff': 13.66, 'best_test_test/acc_skew': 73.738, 'best_test_test/acc_align': 69.845}
[9 / 20] Learning rate: 0.0001 weight: 0.01
[9 / 20] Loss: 4.465333805419854 CE Loss: 0.398208852365016 Con Loss: 4.461351715639172
[9 / 20] tensor([[0.970, 0.778],
        [0.641, 0.558]]) {'epoch': 9, 'valid/acc': 78.836, 'valid/acc_unbiased': 73.527, 'valid/diff': 14.098, 'valid/acc_skew': 66.479, 'valid/acc_align': 80.576, 'test/acc': 79.947, 'test/acc_unbiased': 73.678, 'test/diff': 13.757, 'test/acc_skew': 70.985, 'test/acc_align': 76.371}
[9 / 20] best valid accuracy: 73.981 at epoch 7 
 best_stats: {'best_valid_epoch': 7, 'best_valid_valid/acc': 78.351, 'best_valid_valid/acc_unbiased': 73.981, 'best_valid_valid/diff': 8.926, 'best_valid_valid/acc_skew': 71.938, 'best_valid_valid/acc_align': 76.024, 'best_valid_test/acc': 78.272, 'best_valid_test/acc_unbiased': 71.792, 'best_valid_test/diff': 13.66, 'best_valid_test/acc_skew': 73.738, 'best_valid_test/acc_align': 69.845}
[9 / 20] best test accuracy: 73.678 at epoch 9 
 best_stats: {'best_test_epoch': 9, 'best_test_valid/acc': 78.836, 'best_test_valid/acc_unbiased': 73.527, 'best_test_valid/diff': 14.098, 'best_test_valid/acc_skew': 66.479, 'best_test_valid/acc_align': 80.576, 'best_test_test/acc': 79.947, 'best_test_test/acc_unbiased': 73.678, 'best_test_test/diff': 13.757, 'best_test_test/acc_skew': 70.985, 'best_test_test/acc_align': 76.371}
[10 / 20] Learning rate: 0.0001 weight: 0.01
[10 / 20] Loss: 4.418996354070597 CE Loss: 0.39952174176084376 Con Loss: 4.415001135468706
[10 / 20] tensor([[0.975, 0.756],
        [0.619, 0.533]]) {'epoch': 10, 'valid/acc': 78.483, 'valid/acc_unbiased': 73.488, 'valid/diff': 12.488, 'valid/acc_skew': 67.244, 'valid/acc_align': 79.732, 'test/acc': 78.978, 'test/acc_unbiased': 72.074, 'test/diff': 15.246, 'test/acc_skew': 68.753, 'test/acc_align': 75.394}
[10 / 20] best valid accuracy: 73.981 at epoch 7 
 best_stats: {'best_valid_epoch': 7, 'best_valid_valid/acc': 78.351, 'best_valid_valid/acc_unbiased': 73.981, 'best_valid_valid/diff': 8.926, 'best_valid_valid/acc_skew': 71.938, 'best_valid_valid/acc_align': 76.024, 'best_valid_test/acc': 78.272, 'best_valid_test/acc_unbiased': 71.792, 'best_valid_test/diff': 13.66, 'best_valid_test/acc_skew': 73.738, 'best_valid_test/acc_align': 69.845}
[10 / 20] best test accuracy: 73.678 at epoch 9 
 best_stats: {'best_test_epoch': 9, 'best_test_valid/acc': 78.836, 'best_test_valid/acc_unbiased': 73.527, 'best_test_valid/diff': 14.098, 'best_test_valid/acc_skew': 66.479, 'best_test_valid/acc_align': 80.576, 'best_test_test/acc': 79.947, 'best_test_test/acc_unbiased': 73.678, 'best_test_test/diff': 13.757, 'best_test_test/acc_skew': 70.985, 'best_test_test/acc_align': 76.371}
[11 / 20] Learning rate: 0.0001 weight: 0.01
[11 / 20] Loss: 4.3831380321398425 CE Loss: 0.4026952568443024 Con Loss: 4.379111083783
[11 / 20] tensor([[0.971, 0.744],
        [0.666, 0.588]]) {'epoch': 11, 'valid/acc': 79.586, 'valid/acc_unbiased': 74.038, 'valid/diff': 15.067, 'valid/acc_skew': 66.504, 'valid/acc_align': 81.571, 'test/acc': 80.873, 'test/acc_unbiased': 74.212, 'test/diff': 15.205, 'test/acc_skew': 70.492, 'test/acc_align': 77.933}
[11 / 20] best valid accuracy: 74.038 at epoch 11 
 best_stats: {'best_valid_epoch': 11, 'best_valid_valid/acc': 79.586, 'best_valid_valid/acc_unbiased': 74.038, 'best_valid_valid/diff': 15.067, 'best_valid_valid/acc_skew': 66.504, 'best_valid_valid/acc_align': 81.571, 'best_valid_test/acc': 80.873, 'best_valid_test/acc_unbiased': 74.212, 'best_valid_test/diff': 15.205, 'best_valid_test/acc_skew': 70.492, 'best_valid_test/acc_align': 77.933}
[11 / 20] best test accuracy: 74.212 at epoch 11 
 best_stats: {'best_test_epoch': 11, 'best_test_valid/acc': 79.586, 'best_test_valid/acc_unbiased': 74.038, 'best_test_valid/diff': 15.067, 'best_test_valid/acc_skew': 66.504, 'best_test_valid/acc_align': 81.571, 'best_test_test/acc': 80.873, 'best_test_test/acc_unbiased': 74.212, 'best_test_test/diff': 15.205, 'best_test_test/acc_skew': 70.492, 'best_test_test/acc_align': 77.933}
[12 / 20] Learning rate: 0.0001 weight: 0.01
[12 / 20] Loss: 4.40004649121232 CE Loss: 0.3779240030779994 Con Loss: 4.396267225214802
[12 / 20] tensor([[0.976, 0.676],
        [0.633, 0.655]]) {'epoch': 12, 'valid/acc': 79.012, 'valid/acc_unbiased': 73.362, 'valid/diff': 22.641, 'valid/acc_skew': 62.042, 'valid/acc_align': 84.682, 'test/acc': 79.859, 'test/acc_unbiased': 73.508, 'test/diff': 16.081, 'test/acc_skew': 65.468, 'test/acc_align': 81.549}
[12 / 20] best valid accuracy: 74.038 at epoch 11 
 best_stats: {'best_valid_epoch': 11, 'best_valid_valid/acc': 79.586, 'best_valid_valid/acc_unbiased': 74.038, 'best_valid_valid/diff': 15.067, 'best_valid_valid/acc_skew': 66.504, 'best_valid_valid/acc_align': 81.571, 'best_valid_test/acc': 80.873, 'best_valid_test/acc_unbiased': 74.212, 'best_valid_test/diff': 15.205, 'best_valid_test/acc_skew': 70.492, 'best_valid_test/acc_align': 77.933}
[12 / 20] best test accuracy: 74.212 at epoch 11 
 best_stats: {'best_test_epoch': 11, 'best_test_valid/acc': 79.586, 'best_test_valid/acc_unbiased': 74.038, 'best_test_valid/diff': 15.067, 'best_test_valid/acc_skew': 66.504, 'best_test_valid/acc_align': 81.571, 'best_test_test/acc': 80.873, 'best_test_test/acc_unbiased': 74.212, 'best_test_test/diff': 15.205, 'best_test_test/acc_skew': 70.492, 'best_test_test/acc_align': 77.933}
[13 / 20] Learning rate: 0.0001 weight: 0.01
[13 / 20] Loss: 4.40925444114168 CE Loss: 0.3673894556998671 Con Loss: 4.405580545980267
[13 / 20] tensor([[0.982, 0.710],
        [0.603, 0.612]]) {'epoch': 13, 'valid/acc': 77.293, 'valid/acc_unbiased': 71.328, 'valid/diff': 22.341, 'valid/acc_skew': 60.158, 'valid/acc_align': 82.498, 'test/acc': 78.933, 'test/acc_unbiased': 72.692, 'test/diff': 14.038, 'test/acc_skew': 65.673, 'test/acc_align': 79.711}
[13 / 20] best valid accuracy: 74.038 at epoch 11 
 best_stats: {'best_valid_epoch': 11, 'best_valid_valid/acc': 79.586, 'best_valid_valid/acc_unbiased': 74.038, 'best_valid_valid/diff': 15.067, 'best_valid_valid/acc_skew': 66.504, 'best_valid_valid/acc_align': 81.571, 'best_valid_test/acc': 80.873, 'best_valid_test/acc_unbiased': 74.212, 'best_valid_test/diff': 15.205, 'best_valid_test/acc_skew': 70.492, 'best_valid_test/acc_align': 77.933}
[13 / 20] best test accuracy: 74.212 at epoch 11 
 best_stats: {'best_test_epoch': 11, 'best_test_valid/acc': 79.586, 'best_test_valid/acc_unbiased': 74.038, 'best_test_valid/diff': 15.067, 'best_test_valid/acc_skew': 66.504, 'best_test_valid/acc_align': 81.571, 'best_test_test/acc': 80.873, 'best_test_test/acc_unbiased': 74.212, 'best_test_test/diff': 15.205, 'best_test_test/acc_skew': 70.492, 'best_test_test/acc_align': 77.933}
[14 / 20] Learning rate: 1e-05 weight: 0.01
[14 / 20] Loss: 4.365391786783119 CE Loss: 0.3658316577922445 Con Loss: 4.361733473895954
[14 / 20] tensor([[0.979, 0.761],
        [0.611, 0.582]]) {'epoch': 14, 'valid/acc': 78.439, 'valid/acc_unbiased': 73.283, 'valid/diff': 18.431, 'valid/acc_skew': 64.067, 'valid/acc_align': 82.498, 'test/acc': 79.286, 'test/acc_unbiased': 73.344, 'test/diff': 12.369, 'test/acc_skew': 68.633, 'test/acc_align': 78.054}
[14 / 20] best valid accuracy: 74.038 at epoch 11 
 best_stats: {'best_valid_epoch': 11, 'best_valid_valid/acc': 79.586, 'best_valid_valid/acc_unbiased': 74.038, 'best_valid_valid/diff': 15.067, 'best_valid_valid/acc_skew': 66.504, 'best_valid_valid/acc_align': 81.571, 'best_valid_test/acc': 80.873, 'best_valid_test/acc_unbiased': 74.212, 'best_valid_test/diff': 15.205, 'best_valid_test/acc_skew': 70.492, 'best_valid_test/acc_align': 77.933}
[14 / 20] best test accuracy: 74.212 at epoch 11 
 best_stats: {'best_test_epoch': 11, 'best_test_valid/acc': 79.586, 'best_test_valid/acc_unbiased': 74.038, 'best_test_valid/diff': 15.067, 'best_test_valid/acc_skew': 66.504, 'best_test_valid/acc_align': 81.571, 'best_test_test/acc': 80.873, 'best_test_test/acc_unbiased': 74.212, 'best_test_test/diff': 15.205, 'best_test_test/acc_skew': 70.492, 'best_test_test/acc_align': 77.933}
[15 / 20] Learning rate: 1e-05 weight: 0.01
[15 / 20] Loss: 4.339433571498789 CE Loss: 0.37112963711755725 Con Loss: 4.335722277558104
[15 / 20] tensor([[0.975, 0.739],
        [0.638, 0.606]]) {'epoch': 15, 'valid/acc': 79.938, 'valid/acc_unbiased': 74.683, 'valid/diff': 18.61, 'valid/acc_skew': 65.379, 'valid/acc_align': 83.988, 'test/acc': 80.079, 'test/acc_unbiased': 73.927, 'test/diff': 13.384, 'test/acc_skew': 68.823, 'test/acc_align': 79.031}
[15 / 20] best valid accuracy: 74.683 at epoch 15 
 best_stats: {'best_valid_epoch': 15, 'best_valid_valid/acc': 79.938, 'best_valid_valid/acc_unbiased': 74.683, 'best_valid_valid/diff': 18.61, 'best_valid_valid/acc_skew': 65.379, 'best_valid_valid/acc_align': 83.988, 'best_valid_test/acc': 80.079, 'best_valid_test/acc_unbiased': 73.927, 'best_valid_test/diff': 13.384, 'best_valid_test/acc_skew': 68.823, 'best_valid_test/acc_align': 79.031}
[15 / 20] best test accuracy: 74.212 at epoch 11 
 best_stats: {'best_test_epoch': 11, 'best_test_valid/acc': 79.586, 'best_test_valid/acc_unbiased': 74.038, 'best_test_valid/diff': 15.067, 'best_test_valid/acc_skew': 66.504, 'best_test_valid/acc_align': 81.571, 'best_test_test/acc': 80.873, 'best_test_test/acc_unbiased': 74.212, 'best_test_test/diff': 15.205, 'best_test_test/acc_skew': 70.492, 'best_test_test/acc_align': 77.933}
[16 / 20] Learning rate: 1e-05 weight: 0.01
[16 / 20] Loss: 4.287284866605792 CE Loss: 0.3738965412196663 Con Loss: 4.2835458943300235
[16 / 20] tensor([[0.973, 0.756],
        [0.652, 0.612]]) {'epoch': 16, 'valid/acc': 80.423, 'valid/acc_unbiased': 75.426, 'valid/diff': 16.736, 'valid/acc_skew': 67.058, 'valid/acc_align': 83.794, 'test/acc': 80.696, 'test/acc_unbiased': 74.804, 'test/diff': 12.827, 'test/acc_skew': 70.368, 'test/acc_align': 79.239}
[16 / 20] best valid accuracy: 75.426 at epoch 16 
 best_stats: {'best_valid_epoch': 16, 'best_valid_valid/acc': 80.423, 'best_valid_valid/acc_unbiased': 75.426, 'best_valid_valid/diff': 16.736, 'best_valid_valid/acc_skew': 67.058, 'best_valid_valid/acc_align': 83.794, 'best_valid_test/acc': 80.696, 'best_valid_test/acc_unbiased': 74.804, 'best_valid_test/diff': 12.827, 'best_valid_test/acc_skew': 70.368, 'best_valid_test/acc_align': 79.239}
[16 / 20] best test accuracy: 74.804 at epoch 16 
 best_stats: {'best_test_epoch': 16, 'best_test_valid/acc': 80.423, 'best_test_valid/acc_unbiased': 75.426, 'best_test_valid/diff': 16.736, 'best_test_valid/acc_skew': 67.058, 'best_test_valid/acc_align': 83.794, 'best_test_test/acc': 80.696, 'best_test_test/acc_unbiased': 74.804, 'best_test_test/diff': 12.827, 'best_test_test/acc_skew': 70.368, 'best_test_test/acc_align': 79.239}
[17 / 20] Learning rate: 1e-05 weight: 0.01
[17 / 20] Loss: 4.312396333173883 CE Loss: 0.3696343154551964 Con Loss: 4.3087000031008875
[17 / 20] tensor([[0.972, 0.756],
        [0.659, 0.624]]) {'epoch': 17, 'valid/acc': 80.556, 'valid/acc_unbiased': 75.917, 'valid/diff': 16.454, 'valid/acc_skew': 67.69, 'valid/acc_align': 84.144, 'test/acc': 81.005, 'test/acc_unbiased': 75.256, 'test/diff': 12.52, 'test/acc_skew': 70.714, 'test/acc_align': 79.798}
[17 / 20] best valid accuracy: 75.917 at epoch 17 
 best_stats: {'best_valid_epoch': 17, 'best_valid_valid/acc': 80.556, 'best_valid_valid/acc_unbiased': 75.917, 'best_valid_valid/diff': 16.454, 'best_valid_valid/acc_skew': 67.69, 'best_valid_valid/acc_align': 84.144, 'best_valid_test/acc': 81.005, 'best_valid_test/acc_unbiased': 75.256, 'best_valid_test/diff': 12.52, 'best_valid_test/acc_skew': 70.714, 'best_valid_test/acc_align': 79.798}
[17 / 20] best test accuracy: 75.256 at epoch 17 
 best_stats: {'best_test_epoch': 17, 'best_test_valid/acc': 80.556, 'best_test_valid/acc_unbiased': 75.917, 'best_test_valid/diff': 16.454, 'best_test_valid/acc_skew': 67.69, 'best_test_valid/acc_align': 84.144, 'best_test_test/acc': 81.005, 'best_test_test/acc_unbiased': 75.256, 'best_test_test/diff': 12.52, 'best_test_test/acc_skew': 70.714, 'best_test_test/acc_align': 79.798}
[18 / 20] Learning rate: 1e-05 weight: 0.01
[18 / 20] Loss: 4.330679620352187 CE Loss: 0.37179576885338717 Con Loss: 4.326961689788007
[18 / 20] tensor([[0.974, 0.761],
        [0.645, 0.618]]) {'epoch': 18, 'valid/acc': 80.071, 'valid/acc_unbiased': 75.478, 'valid/diff': 16.729, 'valid/acc_skew': 67.114, 'valid/acc_align': 83.843, 'test/acc': 80.564, 'test/acc_unbiased': 74.948, 'test/diff': 11.941, 'test/acc_skew': 70.306, 'test/acc_align': 79.59}
[18 / 20] best valid accuracy: 75.917 at epoch 17 
 best_stats: {'best_valid_epoch': 17, 'best_valid_valid/acc': 80.556, 'best_valid_valid/acc_unbiased': 75.917, 'best_valid_valid/diff': 16.454, 'best_valid_valid/acc_skew': 67.69, 'best_valid_valid/acc_align': 84.144, 'best_valid_test/acc': 81.005, 'best_valid_test/acc_unbiased': 75.256, 'best_valid_test/diff': 12.52, 'best_valid_test/acc_skew': 70.714, 'best_valid_test/acc_align': 79.798}
[18 / 20] best test accuracy: 75.256 at epoch 17 
 best_stats: {'best_test_epoch': 17, 'best_test_valid/acc': 80.556, 'best_test_valid/acc_unbiased': 75.917, 'best_test_valid/diff': 16.454, 'best_test_valid/acc_skew': 67.69, 'best_test_valid/acc_align': 84.144, 'best_test_test/acc': 81.005, 'best_test_test/acc_unbiased': 75.256, 'best_test_test/diff': 12.52, 'best_test_test/acc_skew': 70.714, 'best_test_test/acc_align': 79.798}
[19 / 20] Learning rate: 1e-05 weight: 0.01
[19 / 20] Loss: 4.357917164560116 CE Loss: 0.36794311217670805 Con Loss: 4.354237742122306
[19 / 20] tensor([[0.973, 0.756],
        [0.648, 0.618]]) {'epoch': 19, 'valid/acc': 80.203, 'valid/acc_unbiased': 75.274, 'valid/diff': 17.933, 'valid/acc_skew': 66.308, 'valid/acc_align': 84.241, 'test/acc': 80.608, 'test/acc_unbiased': 74.869, 'test/diff': 12.351, 'test/acc_skew': 70.195, 'test/acc_align': 79.542}
[19 / 20] best valid accuracy: 75.917 at epoch 17 
 best_stats: {'best_valid_epoch': 17, 'best_valid_valid/acc': 80.556, 'best_valid_valid/acc_unbiased': 75.917, 'best_valid_valid/diff': 16.454, 'best_valid_valid/acc_skew': 67.69, 'best_valid_valid/acc_align': 84.144, 'best_valid_test/acc': 81.005, 'best_valid_test/acc_unbiased': 75.256, 'best_valid_test/diff': 12.52, 'best_valid_test/acc_skew': 70.714, 'best_valid_test/acc_align': 79.798}
[19 / 20] best test accuracy: 75.256 at epoch 17 
 best_stats: {'best_test_epoch': 17, 'best_test_valid/acc': 80.556, 'best_test_valid/acc_unbiased': 75.917, 'best_test_valid/diff': 16.454, 'best_test_valid/acc_skew': 67.69, 'best_test_valid/acc_align': 84.144, 'best_test_test/acc': 81.005, 'best_test_test/acc_unbiased': 75.256, 'best_test_test/diff': 12.52, 'best_test_test/acc_skew': 70.714, 'best_test_test/acc_align': 79.798}
[20 / 20] Learning rate: 1e-05 weight: 0.01
[20 / 20] Loss: 4.343555999221716 CE Loss: 0.3656991260500715 Con Loss: 4.339898990629675
[20 / 20] tensor([[0.974, 0.699],
        [0.660, 0.655]]) {'epoch': 20, 'valid/acc': 79.982, 'valid/acc_unbiased': 73.851, 'valid/diff': 20.683, 'valid/acc_skew': 63.509, 'valid/acc_align': 84.192, 'test/acc': 80.917, 'test/acc_unbiased': 74.669, 'test/diff': 13.997, 'test/acc_skew': 67.93, 'test/acc_align': 81.408}
[20 / 20] best valid accuracy: 75.917 at epoch 17 
 best_stats: {'best_valid_epoch': 17, 'best_valid_valid/acc': 80.556, 'best_valid_valid/acc_unbiased': 75.917, 'best_valid_valid/diff': 16.454, 'best_valid_valid/acc_skew': 67.69, 'best_valid_valid/acc_align': 84.144, 'best_valid_test/acc': 81.005, 'best_valid_test/acc_unbiased': 75.256, 'best_valid_test/diff': 12.52, 'best_valid_test/acc_skew': 70.714, 'best_valid_test/acc_align': 79.798}
[20 / 20] best test accuracy: 75.256 at epoch 17 
 best_stats: {'best_test_epoch': 17, 'best_test_valid/acc': 80.556, 'best_test_valid/acc_unbiased': 75.917, 'best_test_valid/diff': 16.454, 'best_test_valid/acc_skew': 67.69, 'best_test_valid/acc_align': 84.144, 'best_test_test/acc': 81.005, 'best_test_test/acc_unbiased': 75.256, 'best_test_test/diff': 12.52, 'best_test_test/acc_skew': 70.714, 'best_test_test/acc_align': 79.798}
Total training time: 0:33:43
