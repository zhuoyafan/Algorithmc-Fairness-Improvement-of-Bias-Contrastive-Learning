Log level set to: INFO
Set seed: 1
=======> Using Fixed Random Seed: 1 <========
save_path: exp_results/os-celeba_smiling-test-lr0.001-bs128-seed1
get_celeba - split:train, aug: False, given_y: True, ratio: 0
get_celeba - split:train_valid, aug: False, given_y: True, ratio: 0
get_celeba - split:valid, aug: False, given_y: True, ratio: 0
decay_epochs: [3, 6]
[1 / 10] Learning rate: 0.001
[1 / 10] Loss: 0.1860
[1 / 10] tensor([[0.905, 0.911],
        [0.948, 0.917]]) {'epoch': 1, 'valid/acc': 92.998, 'valid/acc_unbiased': 92.629, 'valid/diff': 2.389, 'valid/acc_skew': 93.823, 'valid/acc_align': 91.434, 'test/acc': 92.198, 'test/acc_unbiased': 92.03, 'test/diff': 1.902, 'test/acc_skew': 92.64, 'test/acc_align': 91.421}
[1 / 10] best valid accuracy: 92.629 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 92.998, 'best_valid_valid/acc_unbiased': 92.629, 'best_valid_valid/diff': 2.389, 'best_valid_valid/acc_skew': 93.823, 'best_valid_valid/acc_align': 91.434, 'best_valid_test/acc': 92.198, 'best_valid_test/acc_unbiased': 92.03, 'best_valid_test/diff': 1.902, 'best_valid_test/acc_skew': 92.64, 'best_valid_test/acc_align': 91.421}
[1 / 10] best test accuracy: 92.030 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 92.998, 'best_test_valid/acc_unbiased': 92.629, 'best_test_valid/diff': 2.389, 'best_test_valid/acc_skew': 93.823, 'best_test_valid/acc_align': 91.434, 'best_test_test/acc': 92.198, 'best_test_test/acc_unbiased': 92.03, 'best_test_test/diff': 1.902, 'best_test_test/acc_skew': 92.64, 'best_test_test/acc_align': 91.421}
[2 / 10] Learning rate: 0.001
[2 / 10] Loss: 0.1642
[2 / 10] tensor([[0.942, 0.943],
        [0.924, 0.894]]) {'epoch': 2, 'valid/acc': 93.651, 'valid/acc_unbiased': 93.481, 'valid/diff': 2.384, 'valid/acc_skew': 94.673, 'valid/acc_align': 92.289, 'test/acc': 92.822, 'test/acc_unbiased': 92.566, 'test/diff': 1.543, 'test/acc_skew': 93.277, 'test/acc_align': 91.854}
[2 / 10] best valid accuracy: 93.481 at epoch 2 
 best_stats: {'best_valid_epoch': 2, 'best_valid_valid/acc': 93.651, 'best_valid_valid/acc_unbiased': 93.481, 'best_valid_valid/diff': 2.384, 'best_valid_valid/acc_skew': 94.673, 'best_valid_valid/acc_align': 92.289, 'best_valid_test/acc': 92.822, 'best_valid_test/acc_unbiased': 92.566, 'best_valid_test/diff': 1.543, 'best_valid_test/acc_skew': 93.277, 'best_valid_test/acc_align': 91.854}
[2 / 10] best test accuracy: 92.566 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 93.651, 'best_test_valid/acc_unbiased': 93.481, 'best_test_valid/diff': 2.384, 'best_test_valid/acc_skew': 94.673, 'best_test_valid/acc_align': 92.289, 'best_test_test/acc': 92.822, 'best_test_test/acc_unbiased': 92.566, 'best_test_test/diff': 1.543, 'best_test_test/acc_skew': 93.277, 'best_test_test/acc_align': 91.854}
[3 / 10] Learning rate: 0.001
[3 / 10] Loss: 0.1514
[3 / 10] tensor([[0.940, 0.934],
        [0.920, 0.892]]) {'epoch': 3, 'valid/acc': 93.374, 'valid/acc_unbiased': 93.852, 'valid/diff': 1.999, 'valid/acc_skew': 94.851, 'valid/acc_align': 92.853, 'test/acc': 92.364, 'test/acc_unbiased': 92.121, 'test/diff': 1.683, 'test/acc_skew': 92.962, 'test/acc_align': 91.28}
[3 / 10] best valid accuracy: 93.852 at epoch 3 
 best_stats: {'best_valid_epoch': 3, 'best_valid_valid/acc': 93.374, 'best_valid_valid/acc_unbiased': 93.852, 'best_valid_valid/diff': 1.999, 'best_valid_valid/acc_skew': 94.851, 'best_valid_valid/acc_align': 92.853, 'best_valid_test/acc': 92.364, 'best_valid_test/acc_unbiased': 92.121, 'best_valid_test/diff': 1.683, 'best_valid_test/acc_skew': 92.962, 'best_valid_test/acc_align': 91.28}
[3 / 10] best test accuracy: 92.566 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 93.651, 'best_test_valid/acc_unbiased': 93.481, 'best_test_valid/diff': 2.384, 'best_test_valid/acc_skew': 94.673, 'best_test_valid/acc_align': 92.289, 'best_test_test/acc': 92.822, 'best_test_test/acc_unbiased': 92.566, 'best_test_test/diff': 1.543, 'best_test_test/acc_skew': 93.277, 'best_test_test/acc_align': 91.854}
[4 / 10] Learning rate: 0.0001
[4 / 10] Loss: 0.0968
[4 / 10] tensor([[0.915, 0.947],
        [0.943, 0.873]]) {'epoch': 4, 'valid/acc': 95.828, 'valid/acc_unbiased': 95.777, 'valid/diff': 0.577, 'valid/acc_skew': 96.065, 'valid/acc_align': 95.489, 'test/acc': 92.445, 'test/acc_unbiased': 91.945, 'test/diff': 5.152, 'test/acc_skew': 92.899, 'test/acc_align': 90.99}
[4 / 10] best valid accuracy: 95.777 at epoch 4 
 best_stats: {'best_valid_epoch': 4, 'best_valid_valid/acc': 95.828, 'best_valid_valid/acc_unbiased': 95.777, 'best_valid_valid/diff': 0.577, 'best_valid_valid/acc_skew': 96.065, 'best_valid_valid/acc_align': 95.489, 'best_valid_test/acc': 92.445, 'best_valid_test/acc_unbiased': 91.945, 'best_valid_test/diff': 5.152, 'best_valid_test/acc_skew': 92.899, 'best_valid_test/acc_align': 90.99}
[4 / 10] best test accuracy: 92.566 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 93.651, 'best_test_valid/acc_unbiased': 93.481, 'best_test_valid/diff': 2.384, 'best_test_valid/acc_skew': 94.673, 'best_test_valid/acc_align': 92.289, 'best_test_test/acc': 92.822, 'best_test_test/acc_unbiased': 92.566, 'best_test_test/diff': 1.543, 'best_test_test/acc_skew': 93.277, 'best_test_test/acc_align': 91.854}
[5 / 10] Learning rate: 0.0001
[5 / 10] Loss: 0.0601
[5 / 10] tensor([[0.895, 0.938],
        [0.949, 0.885]]) {'epoch': 5, 'valid/acc': 96.512, 'valid/acc_unbiased': 96.69, 'valid/diff': 0.949, 'valid/acc_skew': 97.165, 'valid/acc_align': 96.216, 'test/acc': 92.092, 'test/acc_unbiased': 91.684, 'test/diff': 5.344, 'test/acc_skew': 92.203, 'test/acc_align': 91.165}
[5 / 10] best valid accuracy: 96.690 at epoch 5 
 best_stats: {'best_valid_epoch': 5, 'best_valid_valid/acc': 96.512, 'best_valid_valid/acc_unbiased': 96.69, 'best_valid_valid/diff': 0.949, 'best_valid_valid/acc_skew': 97.165, 'best_valid_valid/acc_align': 96.216, 'best_valid_test/acc': 92.092, 'best_valid_test/acc_unbiased': 91.684, 'best_valid_test/diff': 5.344, 'best_valid_test/acc_skew': 92.203, 'best_valid_test/acc_align': 91.165}
[5 / 10] best test accuracy: 92.566 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 93.651, 'best_test_valid/acc_unbiased': 93.481, 'best_test_valid/diff': 2.384, 'best_test_valid/acc_skew': 94.673, 'best_test_valid/acc_align': 92.289, 'best_test_test/acc': 92.822, 'best_test_test/acc_unbiased': 92.566, 'best_test_test/diff': 1.543, 'best_test_test/acc_skew': 93.277, 'best_test_test/acc_align': 91.854}
[6 / 10] Learning rate: 0.0001
[6 / 10] Loss: 0.0363
[6 / 10] tensor([[0.883, 0.948],
        [0.952, 0.864]]) {'epoch': 6, 'valid/acc': 97.219, 'valid/acc_unbiased': 97.128, 'valid/diff': 0.691, 'valid/acc_skew': 97.473, 'valid/acc_align': 96.782, 'test/acc': 91.745, 'test/acc_unbiased': 91.175, 'test/diff': 7.596, 'test/acc_skew': 91.751, 'test/acc_align': 90.599}
[6 / 10] best valid accuracy: 97.128 at epoch 6 
 best_stats: {'best_valid_epoch': 6, 'best_valid_valid/acc': 97.219, 'best_valid_valid/acc_unbiased': 97.128, 'best_valid_valid/diff': 0.691, 'best_valid_valid/acc_skew': 97.473, 'best_valid_valid/acc_align': 96.782, 'best_valid_test/acc': 91.745, 'best_valid_test/acc_unbiased': 91.175, 'best_valid_test/diff': 7.596, 'best_valid_test/acc_skew': 91.751, 'best_valid_test/acc_align': 90.599}
[6 / 10] best test accuracy: 92.566 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 93.651, 'best_test_valid/acc_unbiased': 93.481, 'best_test_valid/diff': 2.384, 'best_test_valid/acc_skew': 94.673, 'best_test_valid/acc_align': 92.289, 'best_test_test/acc': 92.822, 'best_test_test/acc_unbiased': 92.566, 'best_test_test/diff': 1.543, 'best_test_test/acc_skew': 93.277, 'best_test_test/acc_align': 91.854}
[7 / 10] Learning rate: 1e-05
[7 / 10] Loss: 0.0192
[7 / 10] tensor([[0.890, 0.950],
        [0.949, 0.848]]) {'epoch': 7, 'valid/acc': 97.375, 'valid/acc_unbiased': 97.303, 'valid/diff': 0.567, 'valid/acc_skew': 97.587, 'valid/acc_align': 97.019, 'test/acc': 91.634, 'test/acc_unbiased': 90.944, 'test/diff': 8.037, 'test/acc_skew': 91.983, 'test/acc_align': 89.906}
[7 / 10] best valid accuracy: 97.303 at epoch 7 
 best_stats: {'best_valid_epoch': 7, 'best_valid_valid/acc': 97.375, 'best_valid_valid/acc_unbiased': 97.303, 'best_valid_valid/diff': 0.567, 'best_valid_valid/acc_skew': 97.587, 'best_valid_valid/acc_align': 97.019, 'best_valid_test/acc': 91.634, 'best_valid_test/acc_unbiased': 90.944, 'best_valid_test/diff': 8.037, 'best_valid_test/acc_skew': 91.983, 'best_valid_test/acc_align': 89.906}
[7 / 10] best test accuracy: 92.566 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 93.651, 'best_test_valid/acc_unbiased': 93.481, 'best_test_valid/diff': 2.384, 'best_test_valid/acc_skew': 94.673, 'best_test_valid/acc_align': 92.289, 'best_test_test/acc': 92.822, 'best_test_test/acc_unbiased': 92.566, 'best_test_test/diff': 1.543, 'best_test_test/acc_skew': 93.277, 'best_test_test/acc_align': 91.854}
[8 / 10] Learning rate: 1e-05
[8 / 10] Loss: 0.0155
[8 / 10] tensor([[0.880, 0.952],
        [0.953, 0.851]]) {'epoch': 8, 'valid/acc': 97.501, 'valid/acc_unbiased': 97.435, 'valid/diff': 0.984, 'valid/acc_skew': 97.927, 'valid/acc_align': 96.943, 'test/acc': 91.569, 'test/acc_unbiased': 90.891, 'test/diff': 8.708, 'test/acc_skew': 91.641, 'test/acc_align': 90.142}
[8 / 10] best valid accuracy: 97.435 at epoch 8 
 best_stats: {'best_valid_epoch': 8, 'best_valid_valid/acc': 97.501, 'best_valid_valid/acc_unbiased': 97.435, 'best_valid_valid/diff': 0.984, 'best_valid_valid/acc_skew': 97.927, 'best_valid_valid/acc_align': 96.943, 'best_valid_test/acc': 91.569, 'best_valid_test/acc_unbiased': 90.891, 'best_valid_test/diff': 8.708, 'best_valid_test/acc_skew': 91.641, 'best_valid_test/acc_align': 90.142}
[8 / 10] best test accuracy: 92.566 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 93.651, 'best_test_valid/acc_unbiased': 93.481, 'best_test_valid/diff': 2.384, 'best_test_valid/acc_skew': 94.673, 'best_test_valid/acc_align': 92.289, 'best_test_test/acc': 92.822, 'best_test_test/acc_unbiased': 92.566, 'best_test_test/diff': 1.543, 'best_test_test/acc_skew': 93.277, 'best_test_test/acc_align': 91.854}
[9 / 10] Learning rate: 1e-05
[9 / 10] Loss: 0.0113
[9 / 10] tensor([[0.879, 0.956],
        [0.951, 0.843]]) {'epoch': 9, 'valid/acc': 97.617, 'valid/acc_unbiased': 97.384, 'valid/diff': 0.731, 'valid/acc_skew': 97.743, 'valid/acc_align': 97.026, 'test/acc': 91.428, 'test/acc_unbiased': 90.706, 'test/diff': 9.235, 'test/acc_skew': 91.474, 'test/acc_align': 89.938}
[9 / 10] best valid accuracy: 97.435 at epoch 8 
 best_stats: {'best_valid_epoch': 8, 'best_valid_valid/acc': 97.501, 'best_valid_valid/acc_unbiased': 97.435, 'best_valid_valid/diff': 0.984, 'best_valid_valid/acc_skew': 97.927, 'best_valid_valid/acc_align': 96.943, 'best_valid_test/acc': 91.569, 'best_valid_test/acc_unbiased': 90.891, 'best_valid_test/diff': 8.708, 'best_valid_test/acc_skew': 91.641, 'best_valid_test/acc_align': 90.142}
[9 / 10] best test accuracy: 92.566 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 93.651, 'best_test_valid/acc_unbiased': 93.481, 'best_test_valid/diff': 2.384, 'best_test_valid/acc_skew': 94.673, 'best_test_valid/acc_align': 92.289, 'best_test_test/acc': 92.822, 'best_test_test/acc_unbiased': 92.566, 'best_test_test/diff': 1.543, 'best_test_test/acc_skew': 93.277, 'best_test_test/acc_align': 91.854}
[10 / 10] Learning rate: 1e-05
[10 / 10] Loss: 0.0097
[10 / 10] tensor([[0.868, 0.951],
        [0.953, 0.849]]) {'epoch': 10, 'valid/acc': 97.715, 'valid/acc_unbiased': 97.47, 'valid/diff': 0.75, 'valid/acc_skew': 97.832, 'valid/acc_align': 97.108, 'test/acc': 91.196, 'test/acc_unbiased': 90.522, 'test/diff': 9.362, 'test/acc_skew': 91.039, 'test/acc_align': 90.005}
[10 / 10] best valid accuracy: 97.470 at epoch 10 
 best_stats: {'best_valid_epoch': 10, 'best_valid_valid/acc': 97.715, 'best_valid_valid/acc_unbiased': 97.47, 'best_valid_valid/diff': 0.75, 'best_valid_valid/acc_skew': 97.832, 'best_valid_valid/acc_align': 97.108, 'best_valid_test/acc': 91.196, 'best_valid_test/acc_unbiased': 90.522, 'best_valid_test/diff': 9.362, 'best_valid_test/acc_skew': 91.039, 'best_valid_test/acc_align': 90.005}
[10 / 10] best test accuracy: 92.566 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 93.651, 'best_test_valid/acc_unbiased': 93.481, 'best_test_valid/diff': 2.384, 'best_test_valid/acc_skew': 94.673, 'best_test_valid/acc_align': 92.289, 'best_test_test/acc': 92.822, 'best_test_test/acc_unbiased': 92.566, 'best_test_test/diff': 1.543, 'best_test_test/acc_skew': 93.277, 'best_test_test/acc_align': 91.854}
Total training time: 1:10:12
