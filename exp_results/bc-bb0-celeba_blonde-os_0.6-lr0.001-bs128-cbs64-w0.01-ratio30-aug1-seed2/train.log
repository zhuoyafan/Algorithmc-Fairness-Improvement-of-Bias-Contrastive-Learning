Log level set to: INFO
Set seed: 2
=======> Using Fixed Random Seed: 2 <========
save_path: exp_results/bc-bb0-celeba_blonde-os_0.6-lr0.001-bs128-cbs64-w0.01-ratio30-aug1-seed2
get_celeba - split:train, aug: False, given_y: True, ratio: 0
use existing blonde indices from data/celeba/pickles/blonde
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [32132, 32132]
Target 1: [32132, 32132]
Binary Target 1
---------------------------
Target 0: [32132, 32132]
Target 1: [32132, 32132]
===================================
Normal Label Distribution: 
Target 0: [32132, 32132]
Target 1: [32132, 32132]
===================================
Use BiasedCelebASplit 
 target_attr: blonde split: train 
 tensor([[32132., 32132.],
        [32132., 32132.]])
get_celeba - split:train, aug: 1, given_y: True, ratio: 30
use existing blonde indices from data/celeba/pickles/blonde
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [32084, 32084]
Target 1: [32084, 32084]
Binary Target 1
---------------------------
Target 0: [32084, 32084]
Target 1: [32084, 32084]
===================================
Normal Label Distribution: 
Target 0: [32084, 32084]
Target 1: [32084, 32084]
===================================
Use BiasedCelebASplit 
 target_attr: blonde split: train 
 tensor([[32084., 32084.],
        [32084., 32084.]])
get_celeba - split:train_valid, aug: False, given_y: True, ratio: 0
use existing blonde indices from data/celeba/pickles/blonde
Use BiasedCelebASplit 
 target_attr: blonde split: train_valid 
 tensor([[  403.,  4597.],
        [13344.,   285.]])
get_celeba - split:valid, aug: False, given_y: True, ratio: 0
Use BiasedCelebASplit 
 target_attr: blonde split: valid 
 tensor([[8535., 2874.],
        [8276.,  182.]])
decay_epochs: [3, 6]
[1 / 10] Learning rate: 0.001 weight: 0.01
[1 / 10] Loss: 4.626042222020992 CE Loss: 0.2503686949887104 Con Loss: 4.623538531091254
[1 / 10] tensor([[0.822, 0.881],
        [0.973, 0.923]]) {'epoch': 1, 'valid/acc': 90.059, 'valid/acc_unbiased': 92.266, 'valid/diff': 2.183, 'valid/acc_skew': 93.358, 'valid/acc_align': 91.175, 'test/acc': 86.963, 'test/acc_unbiased': 89.986, 'test/diff': 5.426, 'test/acc_skew': 89.745, 'test/acc_align': 90.227}
[1 / 10] best valid accuracy: 92.266 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 90.059, 'best_valid_valid/acc_unbiased': 92.266, 'best_valid_valid/diff': 2.183, 'best_valid_valid/acc_skew': 93.358, 'best_valid_valid/acc_align': 91.175, 'best_valid_test/acc': 86.963, 'best_valid_test/acc_unbiased': 89.986, 'best_valid_test/diff': 5.426, 'best_valid_test/acc_skew': 89.745, 'best_valid_test/acc_align': 90.227}
[1 / 10] best test accuracy: 89.986 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 90.059, 'best_test_valid/acc_unbiased': 92.266, 'best_test_valid/diff': 2.183, 'best_test_valid/acc_skew': 93.358, 'best_test_valid/acc_align': 91.175, 'best_test_test/acc': 86.963, 'best_test_test/acc_unbiased': 89.986, 'best_test_test/diff': 5.426, 'best_test_test/acc_skew': 89.745, 'best_test_test/acc_align': 90.227}
[2 / 10] Learning rate: 0.001 weight: 0.01
[2 / 10] Loss: 4.577610583348691 CE Loss: 0.2138626176099188 Con Loss: 4.57547196317369
[2 / 10] tensor([[0.798, 0.907],
        [0.975, 0.940]]) {'epoch': 2, 'valid/acc': 91.728, 'valid/acc_unbiased': 91.958, 'valid/diff': 3.4, 'valid/acc_skew': 93.031, 'valid/acc_align': 90.884, 'test/acc': 87.009, 'test/acc_unbiased': 90.469, 'test/diff': 7.193, 'test/acc_skew': 88.625, 'test/acc_align': 92.314}
[2 / 10] best valid accuracy: 92.266 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 90.059, 'best_valid_valid/acc_unbiased': 92.266, 'best_valid_valid/diff': 2.183, 'best_valid_valid/acc_skew': 93.358, 'best_valid_valid/acc_align': 91.175, 'best_valid_test/acc': 86.963, 'best_valid_test/acc_unbiased': 89.986, 'best_valid_test/diff': 5.426, 'best_valid_test/acc_skew': 89.745, 'best_valid_test/acc_align': 90.227}
[2 / 10] best test accuracy: 90.469 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 91.728, 'best_test_valid/acc_unbiased': 91.958, 'best_test_valid/diff': 3.4, 'best_test_valid/acc_skew': 93.031, 'best_test_valid/acc_align': 90.884, 'best_test_test/acc': 87.009, 'best_test_test/acc_unbiased': 90.469, 'best_test_test/diff': 7.193, 'best_test_test/acc_skew': 88.625, 'best_test_test/acc_align': 92.314}
[3 / 10] Learning rate: 0.001 weight: 0.01
[3 / 10] Loss: 4.557381595455812 CE Loss: 0.19680142175226747 Con Loss: 4.555413579519342
[3 / 10] tensor([[0.850, 0.925],
        [0.958, 0.918]]) {'epoch': 3, 'valid/acc': 92.759, 'valid/acc_unbiased': 93.238, 'valid/diff': 4.089, 'valid/acc_skew': 95.282, 'valid/acc_align': 91.194, 'test/acc': 89.772, 'test/acc_unbiased': 91.282, 'test/diff': 5.78, 'test/acc_skew': 90.425, 'test/acc_align': 92.139}
[3 / 10] best valid accuracy: 93.238 at epoch 3 
 best_stats: {'best_valid_epoch': 3, 'best_valid_valid/acc': 92.759, 'best_valid_valid/acc_unbiased': 93.238, 'best_valid_valid/diff': 4.089, 'best_valid_valid/acc_skew': 95.282, 'best_valid_valid/acc_align': 91.194, 'best_valid_test/acc': 89.772, 'best_valid_test/acc_unbiased': 91.282, 'best_valid_test/diff': 5.78, 'best_valid_test/acc_skew': 90.425, 'best_valid_test/acc_align': 92.139}
[3 / 10] best test accuracy: 91.282 at epoch 3 
 best_stats: {'best_test_epoch': 3, 'best_test_valid/acc': 92.759, 'best_test_valid/acc_unbiased': 93.238, 'best_test_valid/diff': 4.089, 'best_test_valid/acc_skew': 95.282, 'best_test_valid/acc_align': 91.194, 'best_test_test/acc': 89.772, 'best_test_test/acc_unbiased': 91.282, 'best_test_test/diff': 5.78, 'best_test_test/acc_skew': 90.425, 'best_test_test/acc_align': 92.139}
[4 / 10] Learning rate: 0.0001 weight: 0.01
[4 / 10] Loss: 4.478353009223344 CE Loss: 0.15874596207788602 Con Loss: 4.476765558429663
[4 / 10] tensor([[0.858, 0.945],
        [0.962, 0.896]]) {'epoch': 4, 'valid/acc': 94.369, 'valid/acc_unbiased': 95.185, 'valid/diff': 1.883, 'valid/acc_skew': 96.127, 'valid/acc_align': 94.243, 'test/acc': 90.94, 'test/acc_unbiased': 91.503, 'test/diff': 7.692, 'test/acc_skew': 90.98, 'test/acc_align': 92.025}
[4 / 10] best valid accuracy: 95.185 at epoch 4 
 best_stats: {'best_valid_epoch': 4, 'best_valid_valid/acc': 94.369, 'best_valid_valid/acc_unbiased': 95.185, 'best_valid_valid/diff': 1.883, 'best_valid_valid/acc_skew': 96.127, 'best_valid_valid/acc_align': 94.243, 'best_valid_test/acc': 90.94, 'best_valid_test/acc_unbiased': 91.503, 'best_valid_test/diff': 7.692, 'best_valid_test/acc_skew': 90.98, 'best_valid_test/acc_align': 92.025}
[4 / 10] best test accuracy: 91.503 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 94.369, 'best_test_valid/acc_unbiased': 95.185, 'best_test_valid/diff': 1.883, 'best_test_valid/acc_skew': 96.127, 'best_test_valid/acc_align': 94.243, 'best_test_test/acc': 90.94, 'best_test_test/acc_unbiased': 91.503, 'best_test_test/diff': 7.692, 'best_test_test/acc_skew': 90.98, 'best_test_test/acc_align': 92.025}
[5 / 10] Learning rate: 0.0001 weight: 0.01
[5 / 10] Loss: 4.446720441459466 CE Loss: 0.14426925669037122 Con Loss: 4.445277744608057
[5 / 10] tensor([[0.871, 0.955],
        [0.955, 0.896]]) {'epoch': 5, 'valid/acc': 94.906, 'valid/acc_unbiased': 95.861, 'valid/diff': 2.038, 'valid/acc_skew': 96.88, 'valid/acc_align': 94.842, 'test/acc': 91.841, 'test/acc_unbiased': 91.913, 'test/diff': 7.131, 'test/acc_skew': 91.306, 'test/acc_align': 92.521}
[5 / 10] best valid accuracy: 95.861 at epoch 5 
 best_stats: {'best_valid_epoch': 5, 'best_valid_valid/acc': 94.906, 'best_valid_valid/acc_unbiased': 95.861, 'best_valid_valid/diff': 2.038, 'best_valid_valid/acc_skew': 96.88, 'best_valid_valid/acc_align': 94.842, 'best_valid_test/acc': 91.841, 'best_valid_test/acc_unbiased': 91.913, 'best_valid_test/diff': 7.131, 'best_valid_test/acc_skew': 91.306, 'best_valid_test/acc_align': 92.521}
[5 / 10] best test accuracy: 91.913 at epoch 5 
 best_stats: {'best_test_epoch': 5, 'best_test_valid/acc': 94.906, 'best_test_valid/acc_unbiased': 95.861, 'best_test_valid/diff': 2.038, 'best_test_valid/acc_skew': 96.88, 'best_test_valid/acc_align': 94.842, 'best_test_test/acc': 91.841, 'best_test_test/acc_unbiased': 91.913, 'best_test_test/diff': 7.131, 'best_test_test/acc_skew': 91.306, 'best_test_test/acc_align': 92.521}
[6 / 10] Learning rate: 0.0001 weight: 0.01
[6 / 10] Loss: 4.428536300001474 CE Loss: 0.13806579685605924 Con Loss: 4.427155643920442
[6 / 10] tensor([[0.842, 0.959],
        [0.966, 0.874]]) {'epoch': 6, 'valid/acc': 95.486, 'valid/acc_unbiased': 96.068, 'valid/diff': 2.01, 'valid/acc_skew': 97.073, 'valid/acc_align': 95.063, 'test/acc': 90.884, 'test/acc_unbiased': 91.001, 'test/diff': 10.457, 'test/acc_skew': 90.369, 'test/acc_align': 91.633}
[6 / 10] best valid accuracy: 96.068 at epoch 6 
 best_stats: {'best_valid_epoch': 6, 'best_valid_valid/acc': 95.486, 'best_valid_valid/acc_unbiased': 96.068, 'best_valid_valid/diff': 2.01, 'best_valid_valid/acc_skew': 97.073, 'best_valid_valid/acc_align': 95.063, 'best_valid_test/acc': 90.884, 'best_valid_test/acc_unbiased': 91.001, 'best_valid_test/diff': 10.457, 'best_valid_test/acc_skew': 90.369, 'best_valid_test/acc_align': 91.633}
[6 / 10] best test accuracy: 91.913 at epoch 5 
 best_stats: {'best_test_epoch': 5, 'best_test_valid/acc': 94.906, 'best_test_valid/acc_unbiased': 95.861, 'best_test_valid/diff': 2.038, 'best_test_valid/acc_skew': 96.88, 'best_test_valid/acc_align': 94.842, 'best_test_test/acc': 91.841, 'best_test_test/acc_unbiased': 91.913, 'best_test_test/diff': 7.131, 'best_test_test/acc_skew': 91.306, 'best_test_test/acc_align': 92.521}
[7 / 10] Learning rate: 1e-05 weight: 0.01
[7 / 10] Loss: 4.409338789236704 CE Loss: 0.13009747682556883 Con Loss: 4.408037809302853
[7 / 10] tensor([[0.844, 0.955],
        [0.968, 0.890]]) {'epoch': 7, 'valid/acc': 95.545, 'valid/acc_unbiased': 96.693, 'valid/diff': 1.325, 'valid/acc_skew': 97.345, 'valid/acc_align': 96.041, 'test/acc': 90.859, 'test/acc_unbiased': 91.427, 'test/diff': 9.485, 'test/acc_skew': 90.579, 'test/acc_align': 92.276}
[7 / 10] best valid accuracy: 96.693 at epoch 7 
 best_stats: {'best_valid_epoch': 7, 'best_valid_valid/acc': 95.545, 'best_valid_valid/acc_unbiased': 96.693, 'best_valid_valid/diff': 1.325, 'best_valid_valid/acc_skew': 97.345, 'best_valid_valid/acc_align': 96.041, 'best_valid_test/acc': 90.859, 'best_valid_test/acc_unbiased': 91.427, 'best_valid_test/diff': 9.485, 'best_valid_test/acc_skew': 90.579, 'best_valid_test/acc_align': 92.276}
[7 / 10] best test accuracy: 91.913 at epoch 5 
 best_stats: {'best_test_epoch': 5, 'best_test_valid/acc': 94.906, 'best_test_valid/acc_unbiased': 95.861, 'best_test_valid/diff': 2.038, 'best_test_valid/acc_skew': 96.88, 'best_test_valid/acc_align': 94.842, 'best_test_test/acc': 91.841, 'best_test_test/acc_unbiased': 91.913, 'best_test_test/diff': 7.131, 'best_test_test/acc_skew': 91.306, 'best_test_test/acc_align': 92.521}
[8 / 10] Learning rate: 1e-05 weight: 0.01
[8 / 10] Loss: 4.399654271904475 CE Loss: 0.1284044937976238 Con Loss: 4.398370222984209
[8 / 10] tensor([[0.825, 0.945],
        [0.973, 0.890]]) {'epoch': 8, 'valid/acc': 95.035, 'valid/acc_unbiased': 96.446, 'valid/diff': 1.328, 'valid/acc_skew': 97.11, 'valid/acc_align': 95.782, 'test/acc': 89.702, 'test/acc_unbiased': 90.821, 'test/diff': 10.112, 'test/acc_skew': 89.885, 'test/acc_align': 91.757}
[8 / 10] best valid accuracy: 96.693 at epoch 7 
 best_stats: {'best_valid_epoch': 7, 'best_valid_valid/acc': 95.545, 'best_valid_valid/acc_unbiased': 96.693, 'best_valid_valid/diff': 1.325, 'best_valid_valid/acc_skew': 97.345, 'best_valid_valid/acc_align': 96.041, 'best_valid_test/acc': 90.859, 'best_valid_test/acc_unbiased': 91.427, 'best_valid_test/diff': 9.485, 'best_valid_test/acc_skew': 90.579, 'best_valid_test/acc_align': 92.276}
[8 / 10] best test accuracy: 91.913 at epoch 5 
 best_stats: {'best_test_epoch': 5, 'best_test_valid/acc': 94.906, 'best_test_valid/acc_unbiased': 95.861, 'best_test_valid/diff': 2.038, 'best_test_valid/acc_skew': 96.88, 'best_test_valid/acc_align': 94.842, 'best_test_test/acc': 91.841, 'best_test_test/acc_unbiased': 91.913, 'best_test_test/diff': 7.131, 'best_test_test/acc_skew': 91.306, 'best_test_test/acc_align': 92.521}
[9 / 10] Learning rate: 1e-05 weight: 0.01
[9 / 10] Loss: 4.39913312444707 CE Loss: 0.12661373789077765 Con Loss: 4.397866982415264
[9 / 10] tensor([[0.841, 0.952],
        [0.967, 0.885]]) {'epoch': 9, 'valid/acc': 95.448, 'valid/acc_unbiased': 96.808, 'valid/diff': 1.744, 'valid/acc_skew': 97.68, 'valid/acc_align': 95.936, 'test/acc': 90.572, 'test/acc_unbiased': 91.101, 'test/diff': 9.686, 'test/acc_skew': 90.357, 'test/acc_align': 91.844}
[9 / 10] best valid accuracy: 96.808 at epoch 9 
 best_stats: {'best_valid_epoch': 9, 'best_valid_valid/acc': 95.448, 'best_valid_valid/acc_unbiased': 96.808, 'best_valid_valid/diff': 1.744, 'best_valid_valid/acc_skew': 97.68, 'best_valid_valid/acc_align': 95.936, 'best_valid_test/acc': 90.572, 'best_valid_test/acc_unbiased': 91.101, 'best_valid_test/diff': 9.686, 'best_valid_test/acc_skew': 90.357, 'best_valid_test/acc_align': 91.844}
[9 / 10] best test accuracy: 91.913 at epoch 5 
 best_stats: {'best_test_epoch': 5, 'best_test_valid/acc': 94.906, 'best_test_valid/acc_unbiased': 95.861, 'best_test_valid/diff': 2.038, 'best_test_valid/acc_skew': 96.88, 'best_test_valid/acc_align': 94.842, 'best_test_test/acc': 91.841, 'best_test_test/acc_unbiased': 91.913, 'best_test_test/diff': 7.131, 'best_test_test/acc_skew': 91.306, 'best_test_test/acc_align': 92.521}
[10 / 10] Learning rate: 1e-05 weight: 0.01
[10 / 10] Loss: 4.393529790165741 CE Loss: 0.1250650899749786 Con Loss: 4.392279141572231
[10 / 10] tensor([[0.838, 0.955],
        [0.971, 0.885]]) {'epoch': 10, 'valid/acc': 95.641, 'valid/acc_unbiased': 96.609, 'valid/diff': 1.398, 'valid/acc_skew': 97.308, 'valid/acc_align': 95.911, 'test/acc': 90.633, 'test/acc_unbiased': 91.207, 'test/diff': 10.156, 'test/acc_skew': 90.437, 'test/acc_align': 91.977}
[10 / 10] best valid accuracy: 96.808 at epoch 9 
 best_stats: {'best_valid_epoch': 9, 'best_valid_valid/acc': 95.448, 'best_valid_valid/acc_unbiased': 96.808, 'best_valid_valid/diff': 1.744, 'best_valid_valid/acc_skew': 97.68, 'best_valid_valid/acc_align': 95.936, 'best_valid_test/acc': 90.572, 'best_valid_test/acc_unbiased': 91.101, 'best_valid_test/diff': 9.686, 'best_valid_test/acc_skew': 90.357, 'best_valid_test/acc_align': 91.844}
[10 / 10] best test accuracy: 91.913 at epoch 5 
 best_stats: {'best_test_epoch': 5, 'best_test_valid/acc': 94.906, 'best_test_valid/acc_unbiased': 95.861, 'best_test_valid/diff': 2.038, 'best_test_valid/acc_skew': 96.88, 'best_test_valid/acc_align': 94.842, 'best_test_test/acc': 91.841, 'best_test_test/acc_unbiased': 91.913, 'best_test_test/diff': 7.131, 'best_test_test/acc_skew': 91.306, 'best_test_test/acc_align': 92.521}
Total training time: 1:47:21
