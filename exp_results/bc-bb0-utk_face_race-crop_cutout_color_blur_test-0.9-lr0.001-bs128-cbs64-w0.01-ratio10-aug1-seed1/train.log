Log level set to: INFO
Set seed: 1
=======> Using Fixed Random Seed: 1 <========
save_path: exp_results/bc-bb0-utk_face_race-crop_cutout_color_blur_test-0.9-lr0.001-bs128-cbs64-w0.01-ratio10-aug1-seed1
get_utk_face - split: train, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_race-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [4407, 552]
Target 1: [440, 5529]
Binary Target 1
---------------------------
Target 0: [4407, 552]
Target 1: [440, 5529]
===================================
Normal Label Distribution: 
Target 0: [4407, 552]
Target 1: [440, 5529]
===================================
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [4407, 552]
Target 1: [440, 5529]
Binary Target 1
---------------------------
Target 0: [4407, 552]
Target 1: [440, 5529]
===================================
Normal Label Distribution: 
Target 0: [4407, 552]
Target 1: [440, 5529]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 10928, target_attr: gender, bias_attr: race bias_rate: 0.9
['[train] target_0-bias_0: 4407', '[train] target_0-bias_1: 552', '[train] target_1-bias_0: 440', '[train] target_1-bias_1: 5529']
confusion_matrix - 
 original: tensor([[4407.,  440.],
        [ 552., 5529.]]), 
 normalized: tensor([[0.909, 0.091],
        [0.091, 0.909]]), 
 b|y: tensor([[0.889, 0.111],
        [0.074, 0.926]])
get_utk_face - split: train, aug: 1, given_y: True, ratio: 10
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_race-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [4407, 552]
Target 1: [440, 5529]
Binary Target 1
---------------------------
Target 0: [4407, 552]
Target 1: [440, 5529]
===================================
Normal Label Distribution: 
Target 0: [4407, 552]
Target 1: [440, 5529]
===================================
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [4407, 552]
Target 1: [440, 5529]
Binary Target 1
---------------------------
Target 0: [4407, 552]
Target 1: [440, 5529]
===================================
Normal Label Distribution: 
Target 0: [4407, 552]
Target 1: [440, 5529]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 10928, target_attr: gender, bias_attr: race bias_rate: 0.9
['[train] target_0-bias_0: 4407', '[train] target_0-bias_1: 552', '[train] target_1-bias_0: 440', '[train] target_1-bias_1: 5529']
get_utk_face - split: valid, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_race-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [583, 684]
Target 1: [457, 646]
Binary Target 1
---------------------------
Target 0: [583, 684]
Target 1: [457, 646]
===================================
Normal Label Distribution: 
Target 0: [583, 684]
Target 1: [457, 646]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 2370, target_attr: gender, bias_attr: race bias_rate: 0.9
['[valid] target_0-bias_0: 583', '[valid] target_0-bias_1: 684', '[valid] target_1-bias_0: 457', '[valid] target_1-bias_1: 646']
get_utk_face - split: test, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_race-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [558, 677]
Target 1: [462, 673]
Binary Target 1
---------------------------
Target 0: [558, 677]
Target 1: [462, 673]
===================================
Normal Label Distribution: 
Target 0: [558, 677]
Target 1: [462, 673]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 2370, target_attr: gender, bias_attr: race bias_rate: 0.9
['[test] target_0-bias_0: 558', '[test] target_0-bias_1: 677', '[test] target_1-bias_0: 462', '[test] target_1-bias_1: 673']
decay_epochs: [6, 13]
[1 / 20] Learning rate: 0.001 weight: 0.01
[1 / 20] Loss: 4.916655841369406 CE Loss: 0.6214486052054438 Con Loss: 4.910441380468678
[1 / 20] tensor([[0.771, 0.731],
        [0.682, 0.761]]) {'epoch': 1, 'valid/acc': 73.587, 'valid/acc_unbiased': 73.276, 'valid/diff': 4.596, 'valid/acc_skew': 70.978, 'valid/acc_align': 75.574, 'test/acc': 73.924, 'test/acc_unbiased': 73.609, 'test/diff': 5.92, 'test/acc_skew': 70.649, 'test/acc_align': 76.569}
[1 / 20] best valid accuracy: 73.276 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 73.587, 'best_valid_valid/acc_unbiased': 73.276, 'best_valid_valid/diff': 4.596, 'best_valid_valid/acc_skew': 70.978, 'best_valid_valid/acc_align': 75.574, 'best_valid_test/acc': 73.924, 'best_valid_test/acc_unbiased': 73.609, 'best_valid_test/diff': 5.92, 'best_valid_test/acc_skew': 70.649, 'best_valid_test/acc_align': 76.569}
[1 / 20] best test accuracy: 73.609 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 73.587, 'best_test_valid/acc_unbiased': 73.276, 'best_test_valid/diff': 4.596, 'best_test_valid/acc_skew': 70.978, 'best_test_valid/acc_align': 75.574, 'best_test_test/acc': 73.924, 'best_test_test/acc_unbiased': 73.609, 'best_test_test/diff': 5.92, 'best_test_test/acc_skew': 70.649, 'best_test_test/acc_align': 76.569}
[2 / 20] Learning rate: 0.001 weight: 0.01
[2 / 20] Loss: 4.83299819756392 CE Loss: 0.5375691287514057 Con Loss: 4.82762247158179
[2 / 20] tensor([[0.668, 0.609],
        [0.870, 0.906]]) {'epoch': 2, 'valid/acc': 75.57, 'valid/acc_unbiased': 76.413, 'valid/diff': 0.561, 'valid/acc_skew': 76.694, 'valid/acc_align': 76.132, 'test/acc': 75.823, 'test/acc_unbiased': 76.339, 'test/diff': 4.808, 'test/acc_skew': 73.935, 'test/acc_align': 78.742}
[2 / 20] best valid accuracy: 76.413 at epoch 2 
 best_stats: {'best_valid_epoch': 2, 'best_valid_valid/acc': 75.57, 'best_valid_valid/acc_unbiased': 76.413, 'best_valid_valid/diff': 0.561, 'best_valid_valid/acc_skew': 76.694, 'best_valid_valid/acc_align': 76.132, 'best_valid_test/acc': 75.823, 'best_valid_test/acc_unbiased': 76.339, 'best_valid_test/diff': 4.808, 'best_valid_test/acc_skew': 73.935, 'best_valid_test/acc_align': 78.742}
[2 / 20] best test accuracy: 76.339 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 75.57, 'best_test_valid/acc_unbiased': 76.413, 'best_test_valid/diff': 0.561, 'best_test_valid/acc_skew': 76.694, 'best_test_valid/acc_align': 76.132, 'best_test_test/acc': 75.823, 'best_test_test/acc_unbiased': 76.339, 'best_test_test/diff': 4.808, 'best_test_test/acc_skew': 73.935, 'best_test_test/acc_align': 78.742}
[3 / 20] Learning rate: 0.001 weight: 0.01
[3 / 20] Loss: 4.8211042898465735 CE Loss: 0.504108133288114 Con Loss: 4.8160632065065085
[3 / 20] tensor([[0.946, 0.911],
        [0.554, 0.548]]) {'epoch': 3, 'valid/acc': 75.527, 'valid/acc_unbiased': 74.377, 'valid/diff': 2.65, 'valid/acc_skew': 74.718, 'valid/acc_align': 74.036, 'test/acc': 74.684, 'test/acc_unbiased': 74.0, 'test/diff': 2.034, 'test/acc_skew': 73.274, 'test/acc_align': 74.726}
[3 / 20] best valid accuracy: 76.413 at epoch 2 
 best_stats: {'best_valid_epoch': 2, 'best_valid_valid/acc': 75.57, 'best_valid_valid/acc_unbiased': 76.413, 'best_valid_valid/diff': 0.561, 'best_valid_valid/acc_skew': 76.694, 'best_valid_valid/acc_align': 76.132, 'best_valid_test/acc': 75.823, 'best_valid_test/acc_unbiased': 76.339, 'best_valid_test/diff': 4.808, 'best_valid_test/acc_skew': 73.935, 'best_valid_test/acc_align': 78.742}
[3 / 20] best test accuracy: 76.339 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 75.57, 'best_test_valid/acc_unbiased': 76.413, 'best_test_valid/diff': 0.561, 'best_test_valid/acc_skew': 76.694, 'best_test_valid/acc_align': 76.132, 'best_test_test/acc': 75.823, 'best_test_test/acc_unbiased': 76.339, 'best_test_test/diff': 4.808, 'best_test_test/acc_skew': 73.935, 'best_test_test/acc_align': 78.742}
[4 / 20] Learning rate: 0.001 weight: 0.01
[4 / 20] Loss: 4.812006489598733 CE Loss: 0.47784014262182645 Con Loss: 4.807228096058568
[4 / 20] tensor([[0.756, 0.669],
        [0.827, 0.887]]) {'epoch': 4, 'valid/acc': 79.578, 'valid/acc_unbiased': 80.155, 'valid/diff': 4.287, 'valid/acc_skew': 78.012, 'valid/acc_align': 82.299, 'test/acc': 78.228, 'test/acc_unbiased': 78.483, 'test/diff': 7.369, 'test/acc_skew': 74.798, 'test/acc_align': 82.167}
[4 / 20] best valid accuracy: 80.155 at epoch 4 
 best_stats: {'best_valid_epoch': 4, 'best_valid_valid/acc': 79.578, 'best_valid_valid/acc_unbiased': 80.155, 'best_valid_valid/diff': 4.287, 'best_valid_valid/acc_skew': 78.012, 'best_valid_valid/acc_align': 82.299, 'best_valid_test/acc': 78.228, 'best_valid_test/acc_unbiased': 78.483, 'best_valid_test/diff': 7.369, 'best_valid_test/acc_skew': 74.798, 'best_valid_test/acc_align': 82.167}
[4 / 20] best test accuracy: 78.483 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 79.578, 'best_test_valid/acc_unbiased': 80.155, 'best_test_valid/diff': 4.287, 'best_test_valid/acc_skew': 78.012, 'best_test_valid/acc_align': 82.299, 'best_test_test/acc': 78.228, 'best_test_test/acc_unbiased': 78.483, 'best_test_test/diff': 7.369, 'best_test_test/acc_skew': 74.798, 'best_test_test/acc_align': 82.167}
[5 / 20] Learning rate: 0.001 weight: 0.01
[5 / 20] Loss: 4.810759977924352 CE Loss: 0.4645854359053588 Con Loss: 4.806114108810313
[5 / 20] tensor([[0.554, 0.530],
        [0.948, 0.955]]) {'epoch': 5, 'valid/acc': 74.051, 'valid/acc_unbiased': 75.465, 'valid/diff': 2.952, 'valid/acc_skew': 76.941, 'valid/acc_align': 73.988, 'test/acc': 73.797, 'test/acc_unbiased': 74.688, 'test/diff': 1.543, 'test/acc_skew': 73.917, 'test/acc_align': 75.459}
[5 / 20] best valid accuracy: 80.155 at epoch 4 
 best_stats: {'best_valid_epoch': 4, 'best_valid_valid/acc': 79.578, 'best_valid_valid/acc_unbiased': 80.155, 'best_valid_valid/diff': 4.287, 'best_valid_valid/acc_skew': 78.012, 'best_valid_valid/acc_align': 82.299, 'best_valid_test/acc': 78.228, 'best_valid_test/acc_unbiased': 78.483, 'best_valid_test/diff': 7.369, 'best_valid_test/acc_skew': 74.798, 'best_valid_test/acc_align': 82.167}
[5 / 20] best test accuracy: 78.483 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 79.578, 'best_test_valid/acc_unbiased': 80.155, 'best_test_valid/diff': 4.287, 'best_test_valid/acc_skew': 78.012, 'best_test_valid/acc_align': 82.299, 'best_test_test/acc': 78.228, 'best_test_test/acc_unbiased': 78.483, 'best_test_test/diff': 7.369, 'best_test_test/acc_skew': 74.798, 'best_test_test/acc_align': 82.167}
[6 / 20] Learning rate: 0.001 weight: 0.01
[6 / 20] Loss: 4.805147282026523 CE Loss: 0.4630144159493649 Con Loss: 4.800517162501725
[6 / 20] tensor([[0.794, 0.767],
        [0.842, 0.866]]) {'epoch': 6, 'valid/acc': 81.139, 'valid/acc_unbiased': 81.585, 'valid/diff': 2.48, 'valid/acc_skew': 81.63, 'valid/acc_align': 81.54, 'test/acc': 81.603, 'test/acc_unbiased': 81.72, 'test/diff': 2.578, 'test/acc_skew': 80.43, 'test/acc_align': 83.009}
[6 / 20] best valid accuracy: 81.585 at epoch 6 
 best_stats: {'best_valid_epoch': 6, 'best_valid_valid/acc': 81.139, 'best_valid_valid/acc_unbiased': 81.585, 'best_valid_valid/diff': 2.48, 'best_valid_valid/acc_skew': 81.63, 'best_valid_valid/acc_align': 81.54, 'best_valid_test/acc': 81.603, 'best_valid_test/acc_unbiased': 81.72, 'best_valid_test/diff': 2.578, 'best_valid_test/acc_skew': 80.43, 'best_valid_test/acc_align': 83.009}
[6 / 20] best test accuracy: 81.720 at epoch 6 
 best_stats: {'best_test_epoch': 6, 'best_test_valid/acc': 81.139, 'best_test_valid/acc_unbiased': 81.585, 'best_test_valid/diff': 2.48, 'best_test_valid/acc_skew': 81.63, 'best_test_valid/acc_align': 81.54, 'best_test_test/acc': 81.603, 'best_test_test/acc_unbiased': 81.72, 'best_test_test/diff': 2.578, 'best_test_test/acc_skew': 80.43, 'best_test_test/acc_align': 83.009}
[7 / 20] Learning rate: 0.0001 weight: 0.01
[7 / 20] Loss: 4.776149307826253 CE Loss: 0.4240209496475069 Con Loss: 4.771909095881449
[7 / 20] tensor([[0.830, 0.795],
        [0.840, 0.866]]) {'epoch': 7, 'valid/acc': 82.996, 'valid/acc_unbiased': 83.266, 'valid/diff': 2.359, 'valid/acc_skew': 83.166, 'valid/acc_align': 83.366, 'test/acc': 83.207, 'test/acc_unbiased': 83.263, 'test/diff': 3.076, 'test/acc_skew': 81.725, 'test/acc_align': 84.801}
[7 / 20] best valid accuracy: 83.266 at epoch 7 
 best_stats: {'best_valid_epoch': 7, 'best_valid_valid/acc': 82.996, 'best_valid_valid/acc_unbiased': 83.266, 'best_valid_valid/diff': 2.359, 'best_valid_valid/acc_skew': 83.166, 'best_valid_valid/acc_align': 83.366, 'best_valid_test/acc': 83.207, 'best_valid_test/acc_unbiased': 83.263, 'best_valid_test/diff': 3.076, 'best_valid_test/acc_skew': 81.725, 'best_valid_test/acc_align': 84.801}
[7 / 20] best test accuracy: 83.263 at epoch 7 
 best_stats: {'best_test_epoch': 7, 'best_test_valid/acc': 82.996, 'best_test_valid/acc_unbiased': 83.266, 'best_test_valid/diff': 2.359, 'best_test_valid/acc_skew': 83.166, 'best_test_valid/acc_align': 83.366, 'best_test_test/acc': 83.207, 'best_test_test/acc_unbiased': 83.263, 'best_test_test/diff': 3.076, 'best_test_test/acc_skew': 81.725, 'best_test_test/acc_align': 84.801}
[8 / 20] Learning rate: 0.0001 weight: 0.01
[8 / 20] Loss: 4.7646261601985636 CE Loss: 0.4040026893378351 Con Loss: 4.760586147950648
[8 / 20] tensor([[0.783, 0.730],
        [0.890, 0.918]]) {'epoch': 8, 'valid/acc': 82.827, 'valid/acc_unbiased': 83.392, 'valid/diff': 2.74, 'valid/acc_skew': 82.175, 'valid/acc_align': 84.608, 'test/acc': 82.7, 'test/acc_unbiased': 83.018, 'test/diff': 4.107, 'test/acc_skew': 80.965, 'test/acc_align': 85.072}
[8 / 20] best valid accuracy: 83.392 at epoch 8 
 best_stats: {'best_valid_epoch': 8, 'best_valid_valid/acc': 82.827, 'best_valid_valid/acc_unbiased': 83.392, 'best_valid_valid/diff': 2.74, 'best_valid_valid/acc_skew': 82.175, 'best_valid_valid/acc_align': 84.608, 'best_valid_test/acc': 82.7, 'best_valid_test/acc_unbiased': 83.018, 'best_valid_test/diff': 4.107, 'best_valid_test/acc_skew': 80.965, 'best_valid_test/acc_align': 85.072}
[8 / 20] best test accuracy: 83.263 at epoch 7 
 best_stats: {'best_test_epoch': 7, 'best_test_valid/acc': 82.996, 'best_test_valid/acc_unbiased': 83.266, 'best_test_valid/diff': 2.359, 'best_test_valid/acc_skew': 83.166, 'best_test_valid/acc_align': 83.366, 'best_test_test/acc': 83.207, 'best_test_test/acc_unbiased': 83.263, 'best_test_test/diff': 3.076, 'best_test_test/acc_skew': 81.725, 'best_test_test/acc_align': 84.801}
[9 / 20] Learning rate: 0.0001 weight: 0.01
[9 / 20] Loss: 4.753724904570014 CE Loss: 0.3973311407499746 Con Loss: 4.749751602748128
[9 / 20] tensor([[0.814, 0.774],
        [0.866, 0.895]]) {'epoch': 9, 'valid/acc': 83.249, 'valid/acc_unbiased': 83.78, 'valid/diff': 3.258, 'valid/acc_skew': 84.148, 'valid/acc_align': 83.412, 'test/acc': 83.544, 'test/acc_unbiased': 83.698, 'test/diff': 3.416, 'test/acc_skew': 81.99, 'test/acc_align': 85.406}
[9 / 20] best valid accuracy: 83.780 at epoch 9 
 best_stats: {'best_valid_epoch': 9, 'best_valid_valid/acc': 83.249, 'best_valid_valid/acc_unbiased': 83.78, 'best_valid_valid/diff': 3.258, 'best_valid_valid/acc_skew': 84.148, 'best_valid_valid/acc_align': 83.412, 'best_valid_test/acc': 83.544, 'best_valid_test/acc_unbiased': 83.698, 'best_valid_test/diff': 3.416, 'best_valid_test/acc_skew': 81.99, 'best_valid_test/acc_align': 85.406}
[9 / 20] best test accuracy: 83.698 at epoch 9 
 best_stats: {'best_test_epoch': 9, 'best_test_valid/acc': 83.249, 'best_test_valid/acc_unbiased': 83.78, 'best_test_valid/diff': 3.258, 'best_test_valid/acc_skew': 84.148, 'best_test_valid/acc_align': 83.412, 'best_test_test/acc': 83.544, 'best_test_test/acc_unbiased': 83.698, 'best_test_test/diff': 3.416, 'best_test_test/acc_skew': 81.99, 'best_test_test/acc_align': 85.406}
[10 / 20] Learning rate: 0.0001 weight: 0.01
[10 / 20] Loss: 4.745070967806904 CE Loss: 0.38648061892822233 Con Loss: 4.741206150976491
[10 / 20] tensor([[0.799, 0.773],
        [0.874, 0.906]]) {'epoch': 10, 'valid/acc': 83.587, 'valid/acc_unbiased': 84.149, 'valid/diff': 3.472, 'valid/acc_skew': 83.855, 'valid/acc_align': 84.443, 'test/acc': 83.671, 'test/acc_unbiased': 83.816, 'test/diff': 2.934, 'test/acc_skew': 82.349, 'test/acc_align': 85.284}
[10 / 20] best valid accuracy: 84.149 at epoch 10 
 best_stats: {'best_valid_epoch': 10, 'best_valid_valid/acc': 83.587, 'best_valid_valid/acc_unbiased': 84.149, 'best_valid_valid/diff': 3.472, 'best_valid_valid/acc_skew': 83.855, 'best_valid_valid/acc_align': 84.443, 'best_valid_test/acc': 83.671, 'best_valid_test/acc_unbiased': 83.816, 'best_valid_test/diff': 2.934, 'best_valid_test/acc_skew': 82.349, 'best_valid_test/acc_align': 85.284}
[10 / 20] best test accuracy: 83.816 at epoch 10 
 best_stats: {'best_test_epoch': 10, 'best_test_valid/acc': 83.587, 'best_test_valid/acc_unbiased': 84.149, 'best_test_valid/diff': 3.472, 'best_test_valid/acc_skew': 83.855, 'best_test_valid/acc_align': 84.443, 'best_test_test/acc': 83.671, 'best_test_test/acc_unbiased': 83.816, 'best_test_test/diff': 2.934, 'best_test_test/acc_skew': 82.349, 'best_test_test/acc_align': 85.284}
[11 / 20] Learning rate: 0.0001 weight: 0.01
[11 / 20] Loss: 4.7324168029327165 CE Loss: 0.37832895706722713 Con Loss: 4.728633528747112
[11 / 20] tensor([[0.832, 0.806],
        [0.855, 0.890]]) {'epoch': 11, 'valid/acc': 84.726, 'valid/acc_unbiased': 84.952, 'valid/diff': 1.156, 'valid/acc_skew': 84.407, 'valid/acc_align': 85.497, 'test/acc': 84.557, 'test/acc_unbiased': 84.577, 'test/diff': 3.005, 'test/acc_skew': 83.074, 'test/acc_align': 86.079}
[11 / 20] best valid accuracy: 84.952 at epoch 11 
 best_stats: {'best_valid_epoch': 11, 'best_valid_valid/acc': 84.726, 'best_valid_valid/acc_unbiased': 84.952, 'best_valid_valid/diff': 1.156, 'best_valid_valid/acc_skew': 84.407, 'best_valid_valid/acc_align': 85.497, 'best_valid_test/acc': 84.557, 'best_valid_test/acc_unbiased': 84.577, 'best_valid_test/diff': 3.005, 'best_valid_test/acc_skew': 83.074, 'best_valid_test/acc_align': 86.079}
[11 / 20] best test accuracy: 84.577 at epoch 11 
 best_stats: {'best_test_epoch': 11, 'best_test_valid/acc': 84.726, 'best_test_valid/acc_unbiased': 84.952, 'best_test_valid/diff': 1.156, 'best_test_valid/acc_skew': 84.407, 'best_test_valid/acc_align': 85.497, 'best_test_test/acc': 84.557, 'best_test_test/acc_unbiased': 84.577, 'best_test_test/diff': 3.005, 'best_test_test/acc_skew': 83.074, 'best_test_test/acc_align': 86.079}
[12 / 20] Learning rate: 0.0001 weight: 0.01
[12 / 20] Loss: 4.736579692555731 CE Loss: 0.3780222611929976 Con Loss: 4.732799481158724
[12 / 20] tensor([[0.815, 0.777],
        [0.883, 0.921]]) {'epoch': 12, 'valid/acc': 84.346, 'valid/acc_unbiased': 84.824, 'valid/diff': 2.522, 'valid/acc_skew': 83.563, 'valid/acc_align': 86.085, 'test/acc': 84.768, 'test/acc_unbiased': 84.918, 'test/diff': 3.829, 'test/acc_skew': 83.004, 'test/acc_align': 86.833}
[12 / 20] best valid accuracy: 84.952 at epoch 11 
 best_stats: {'best_valid_epoch': 11, 'best_valid_valid/acc': 84.726, 'best_valid_valid/acc_unbiased': 84.952, 'best_valid_valid/diff': 1.156, 'best_valid_valid/acc_skew': 84.407, 'best_valid_valid/acc_align': 85.497, 'best_valid_test/acc': 84.557, 'best_valid_test/acc_unbiased': 84.577, 'best_valid_test/diff': 3.005, 'best_valid_test/acc_skew': 83.074, 'best_valid_test/acc_align': 86.079}
[12 / 20] best test accuracy: 84.918 at epoch 12 
 best_stats: {'best_test_epoch': 12, 'best_test_valid/acc': 84.346, 'best_test_valid/acc_unbiased': 84.824, 'best_test_valid/diff': 2.522, 'best_test_valid/acc_skew': 83.563, 'best_test_valid/acc_align': 86.085, 'best_test_test/acc': 84.768, 'best_test_test/acc_unbiased': 84.918, 'best_test_test/diff': 3.829, 'best_test_test/acc_skew': 83.004, 'best_test_test/acc_align': 86.833}
[13 / 20] Learning rate: 0.0001 weight: 0.01
[13 / 20] Loss: 4.723664688680043 CE Loss: 0.37162881858352337 Con Loss: 4.719948400690126
[13 / 20] tensor([[0.823, 0.789],
        [0.857, 0.903]]) {'epoch': 13, 'valid/acc': 84.388, 'valid/acc_unbiased': 84.734, 'valid/diff': 2.001, 'valid/acc_skew': 84.004, 'valid/acc_align': 85.464, 'test/acc': 84.262, 'test/acc_unbiased': 84.298, 'test/diff': 4.004, 'test/acc_skew': 82.296, 'test/acc_align': 86.3}
[13 / 20] best valid accuracy: 84.952 at epoch 11 
 best_stats: {'best_valid_epoch': 11, 'best_valid_valid/acc': 84.726, 'best_valid_valid/acc_unbiased': 84.952, 'best_valid_valid/diff': 1.156, 'best_valid_valid/acc_skew': 84.407, 'best_valid_valid/acc_align': 85.497, 'best_valid_test/acc': 84.557, 'best_valid_test/acc_unbiased': 84.577, 'best_valid_test/diff': 3.005, 'best_valid_test/acc_skew': 83.074, 'best_valid_test/acc_align': 86.079}
[13 / 20] best test accuracy: 84.918 at epoch 12 
 best_stats: {'best_test_epoch': 12, 'best_test_valid/acc': 84.346, 'best_test_valid/acc_unbiased': 84.824, 'best_test_valid/diff': 2.522, 'best_test_valid/acc_skew': 83.563, 'best_test_valid/acc_align': 86.085, 'best_test_test/acc': 84.768, 'best_test_test/acc_unbiased': 84.918, 'best_test_test/diff': 3.829, 'best_test_test/acc_skew': 83.004, 'best_test_test/acc_align': 86.833}
[14 / 20] Learning rate: 1e-05 weight: 0.01
[14 / 20] Loss: 4.730409058086345 CE Loss: 0.36296396478901494 Con Loss: 4.726779396677087
[14 / 20] tensor([[0.821, 0.786],
        [0.870, 0.914]]) {'epoch': 14, 'valid/acc': 84.684, 'valid/acc_unbiased': 85.111, 'valid/diff': 1.921, 'valid/acc_skew': 84.258, 'valid/acc_align': 85.964, 'test/acc': 84.684, 'test/acc_unbiased': 84.764, 'test/diff': 3.933, 'test/acc_skew': 82.797, 'test/acc_align': 86.73}
[14 / 20] best valid accuracy: 85.111 at epoch 14 
 best_stats: {'best_valid_epoch': 14, 'best_valid_valid/acc': 84.684, 'best_valid_valid/acc_unbiased': 85.111, 'best_valid_valid/diff': 1.921, 'best_valid_valid/acc_skew': 84.258, 'best_valid_valid/acc_align': 85.964, 'best_valid_test/acc': 84.684, 'best_valid_test/acc_unbiased': 84.764, 'best_valid_test/diff': 3.933, 'best_valid_test/acc_skew': 82.797, 'best_valid_test/acc_align': 86.73}
[14 / 20] best test accuracy: 84.918 at epoch 12 
 best_stats: {'best_test_epoch': 12, 'best_test_valid/acc': 84.346, 'best_test_valid/acc_unbiased': 84.824, 'best_test_valid/diff': 2.522, 'best_test_valid/acc_skew': 83.563, 'best_test_valid/acc_align': 86.085, 'best_test_test/acc': 84.768, 'best_test_test/acc_unbiased': 84.918, 'best_test_test/diff': 3.829, 'best_test_test/acc_skew': 83.004, 'best_test_test/acc_align': 86.833}
[15 / 20] Learning rate: 1e-05 weight: 0.01
[15 / 20] Loss: 4.719045815670298 CE Loss: 0.3635767223981603 Con Loss: 4.715410050326525
[15 / 20] tensor([[0.823, 0.781],
        [0.877, 0.914]]) {'epoch': 15, 'valid/acc': 84.979, 'valid/acc_unbiased': 85.4, 'valid/diff': 1.919, 'valid/acc_skew': 84.44, 'valid/acc_align': 86.359, 'test/acc': 84.726, 'test/acc_unbiased': 84.86, 'test/diff': 3.919, 'test/acc_skew': 82.901, 'test/acc_align': 86.82}
[15 / 20] best valid accuracy: 85.400 at epoch 15 
 best_stats: {'best_valid_epoch': 15, 'best_valid_valid/acc': 84.979, 'best_valid_valid/acc_unbiased': 85.4, 'best_valid_valid/diff': 1.919, 'best_valid_valid/acc_skew': 84.44, 'best_valid_valid/acc_align': 86.359, 'best_valid_test/acc': 84.726, 'best_valid_test/acc_unbiased': 84.86, 'best_valid_test/diff': 3.919, 'best_valid_test/acc_skew': 82.901, 'best_valid_test/acc_align': 86.82}
[15 / 20] best test accuracy: 84.918 at epoch 12 
 best_stats: {'best_test_epoch': 12, 'best_test_valid/acc': 84.346, 'best_test_valid/acc_unbiased': 84.824, 'best_test_valid/diff': 2.522, 'best_test_valid/acc_skew': 83.563, 'best_test_valid/acc_align': 86.085, 'best_test_test/acc': 84.768, 'best_test_test/acc_unbiased': 84.918, 'best_test_test/diff': 3.829, 'best_test_test/acc_skew': 83.004, 'best_test_test/acc_align': 86.833}
[16 / 20] Learning rate: 1e-05 weight: 0.01
[16 / 20] Loss: 4.719763908693417 CE Loss: 0.3539536771191336 Con Loss: 4.716224379281174
[16 / 20] tensor([[0.821, 0.783],
        [0.868, 0.911]]) {'epoch': 16, 'valid/acc': 84.895, 'valid/acc_unbiased': 85.325, 'valid/diff': 1.915, 'valid/acc_skew': 84.367, 'valid/acc_align': 86.282, 'test/acc': 84.473, 'test/acc_unbiased': 84.562, 'test/diff': 4.04, 'test/acc_skew': 82.542, 'test/acc_align': 86.582}
[16 / 20] best valid accuracy: 85.400 at epoch 15 
 best_stats: {'best_valid_epoch': 15, 'best_valid_valid/acc': 84.979, 'best_valid_valid/acc_unbiased': 85.4, 'best_valid_valid/diff': 1.919, 'best_valid_valid/acc_skew': 84.44, 'best_valid_valid/acc_align': 86.359, 'best_valid_test/acc': 84.726, 'best_valid_test/acc_unbiased': 84.86, 'best_valid_test/diff': 3.919, 'best_valid_test/acc_skew': 82.901, 'best_valid_test/acc_align': 86.82}
[16 / 20] best test accuracy: 84.918 at epoch 12 
 best_stats: {'best_test_epoch': 12, 'best_test_valid/acc': 84.346, 'best_test_valid/acc_unbiased': 84.824, 'best_test_valid/diff': 2.522, 'best_test_valid/acc_skew': 83.563, 'best_test_valid/acc_align': 86.085, 'best_test_test/acc': 84.768, 'best_test_test/acc_unbiased': 84.918, 'best_test_test/diff': 3.829, 'best_test_test/acc_skew': 83.004, 'best_test_test/acc_align': 86.833}
[17 / 20] Learning rate: 1e-05 weight: 0.01
[17 / 20] Loss: 4.711663503772518 CE Loss: 0.3595540542291862 Con Loss: 4.708067958211829
[17 / 20] tensor([[0.824, 0.786],
        [0.872, 0.912]]) {'epoch': 17, 'valid/acc': 85.274, 'valid/acc_unbiased': 85.698, 'valid/diff': 2.661, 'valid/acc_skew': 84.367, 'valid/acc_align': 87.029, 'test/acc': 84.768, 'test/acc_unbiased': 84.87, 'test/diff': 3.93, 'test/acc_skew': 82.906, 'test/acc_align': 86.835}
[17 / 20] best valid accuracy: 85.698 at epoch 17 
 best_stats: {'best_valid_epoch': 17, 'best_valid_valid/acc': 85.274, 'best_valid_valid/acc_unbiased': 85.698, 'best_valid_valid/diff': 2.661, 'best_valid_valid/acc_skew': 84.367, 'best_valid_valid/acc_align': 87.029, 'best_valid_test/acc': 84.768, 'best_valid_test/acc_unbiased': 84.87, 'best_valid_test/diff': 3.93, 'best_valid_test/acc_skew': 82.906, 'best_valid_test/acc_align': 86.835}
[17 / 20] best test accuracy: 84.918 at epoch 12 
 best_stats: {'best_test_epoch': 12, 'best_test_valid/acc': 84.346, 'best_test_valid/acc_unbiased': 84.824, 'best_test_valid/diff': 2.522, 'best_test_valid/acc_skew': 83.563, 'best_test_valid/acc_align': 86.085, 'best_test_test/acc': 84.768, 'best_test_test/acc_unbiased': 84.918, 'best_test_test/diff': 3.829, 'best_test_test/acc_skew': 83.004, 'best_test_test/acc_align': 86.833}
[18 / 20] Learning rate: 1e-05 weight: 0.01
[18 / 20] Loss: 4.710367927439566 CE Loss: 0.3578284512414416 Con Loss: 4.706789673683758
[18 / 20] tensor([[0.830, 0.801],
        [0.864, 0.903]]) {'epoch': 18, 'valid/acc': 85.485, 'valid/acc_unbiased': 85.818, 'valid/diff': 1.908, 'valid/acc_skew': 84.953, 'valid/acc_align': 86.683, 'test/acc': 84.895, 'test/acc_unbiased': 84.935, 'test/diff': 3.447, 'test/acc_skew': 83.211, 'test/acc_align': 86.658}
[18 / 20] best valid accuracy: 85.818 at epoch 18 
 best_stats: {'best_valid_epoch': 18, 'best_valid_valid/acc': 85.485, 'best_valid_valid/acc_unbiased': 85.818, 'best_valid_valid/diff': 1.908, 'best_valid_valid/acc_skew': 84.953, 'best_valid_valid/acc_align': 86.683, 'best_valid_test/acc': 84.895, 'best_valid_test/acc_unbiased': 84.935, 'best_valid_test/diff': 3.447, 'best_valid_test/acc_skew': 83.211, 'best_valid_test/acc_align': 86.658}
[18 / 20] best test accuracy: 84.935 at epoch 18 
 best_stats: {'best_test_epoch': 18, 'best_test_valid/acc': 85.485, 'best_test_valid/acc_unbiased': 85.818, 'best_test_valid/diff': 1.908, 'best_test_valid/acc_skew': 84.953, 'best_test_valid/acc_align': 86.683, 'best_test_test/acc': 84.895, 'best_test_test/acc_unbiased': 84.935, 'best_test_test/diff': 3.447, 'best_test_test/acc_skew': 83.211, 'best_test_test/acc_align': 86.658}
[19 / 20] Learning rate: 1e-05 weight: 0.01
[19 / 20] Loss: 4.715737407064368 CE Loss: 0.3633558050692518 Con Loss: 4.712103849274173
[19 / 20] tensor([[0.833, 0.796],
        [0.866, 0.903]]) {'epoch': 19, 'valid/acc': 85.359, 'valid/acc_unbiased': 85.678, 'valid/diff': 1.668, 'valid/acc_skew': 84.844, 'valid/acc_align': 86.512, 'test/acc': 84.895, 'test/acc_unbiased': 84.968, 'test/diff': 3.74, 'test/acc_skew': 83.098, 'test/acc_align': 86.838}
[19 / 20] best valid accuracy: 85.818 at epoch 18 
 best_stats: {'best_valid_epoch': 18, 'best_valid_valid/acc': 85.485, 'best_valid_valid/acc_unbiased': 85.818, 'best_valid_valid/diff': 1.908, 'best_valid_valid/acc_skew': 84.953, 'best_valid_valid/acc_align': 86.683, 'best_valid_test/acc': 84.895, 'best_valid_test/acc_unbiased': 84.935, 'best_valid_test/diff': 3.447, 'best_valid_test/acc_skew': 83.211, 'best_valid_test/acc_align': 86.658}
[19 / 20] best test accuracy: 84.968 at epoch 19 
 best_stats: {'best_test_epoch': 19, 'best_test_valid/acc': 85.359, 'best_test_valid/acc_unbiased': 85.678, 'best_test_valid/diff': 1.668, 'best_test_valid/acc_skew': 84.844, 'best_test_valid/acc_align': 86.512, 'best_test_test/acc': 84.895, 'best_test_test/acc_unbiased': 84.968, 'best_test_test/diff': 3.74, 'best_test_test/acc_skew': 83.098, 'best_test_test/acc_align': 86.838}
[20 / 20] Learning rate: 1e-05 weight: 0.01
[20 / 20] Loss: 4.71786024629808 CE Loss: 0.3520755727678581 Con Loss: 4.714339469920838
[20 / 20] tensor([[0.828, 0.790],
        [0.870, 0.908]]) {'epoch': 20, 'valid/acc': 85.316, 'valid/acc_unbiased': 85.643, 'valid/diff': 2.185, 'valid/acc_skew': 84.551, 'valid/acc_align': 86.736, 'test/acc': 84.81, 'test/acc_unbiased': 84.905, 'test/diff': 3.773, 'test/acc_skew': 83.019, 'test/acc_align': 86.792}
[20 / 20] best valid accuracy: 85.818 at epoch 18 
 best_stats: {'best_valid_epoch': 18, 'best_valid_valid/acc': 85.485, 'best_valid_valid/acc_unbiased': 85.818, 'best_valid_valid/diff': 1.908, 'best_valid_valid/acc_skew': 84.953, 'best_valid_valid/acc_align': 86.683, 'best_valid_test/acc': 84.895, 'best_valid_test/acc_unbiased': 84.935, 'best_valid_test/diff': 3.447, 'best_valid_test/acc_skew': 83.211, 'best_valid_test/acc_align': 86.658}
[20 / 20] best test accuracy: 84.968 at epoch 19 
 best_stats: {'best_test_epoch': 19, 'best_test_valid/acc': 85.359, 'best_test_valid/acc_unbiased': 85.678, 'best_test_valid/diff': 1.668, 'best_test_valid/acc_skew': 84.844, 'best_test_valid/acc_align': 86.512, 'best_test_test/acc': 84.895, 'best_test_test/acc_unbiased': 84.968, 'best_test_test/diff': 3.74, 'best_test_test/acc_skew': 83.098, 'best_test_test/acc_align': 86.838}
Total training time: 0:18:06
