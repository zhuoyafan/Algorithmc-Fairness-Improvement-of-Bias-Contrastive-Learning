Log level set to: INFO
Set seed: 3
=======> Using Fixed Random Seed: 3 <========
save_path: exp_results/bc-bb0-utk_face_race-os_0.8-0.9-lr0.001-bs128-cbs64-w0.01-ratio10-aug1-seed3
get_utk_face - split: train, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_race-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [4407, 552]
Target 1: [440, 5529]
Binary Target 1
---------------------------
Target 0: [4407, 552]
Target 1: [440, 5529]
===================================
Normal Label Distribution: 
Target 0: [4407, 552]
Target 1: [440, 5529]
===================================
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [4423, 4423]
Target 1: [4423, 4423]
Binary Target 1
---------------------------
Target 0: [4423, 4423]
Target 1: [4423, 4423]
===================================
Normal Label Distribution: 
Target 0: [4423, 4423]
Target 1: [4423, 4423]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 17692, target_attr: gender, bias_attr: race bias_rate: 0.9
['[train] target_0-bias_0: 4423', '[train] target_0-bias_1: 4423', '[train] target_1-bias_0: 4423', '[train] target_1-bias_1: 4423']
confusion_matrix - 
 original: tensor([[4423., 4423.],
        [4423., 4423.]]), 
 normalized: tensor([[0.500, 0.500],
        [0.500, 0.500]]), 
 b|y: tensor([[0.500, 0.500],
        [0.500, 0.500]])
get_utk_face - split: train, aug: 1, given_y: True, ratio: 10
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_race-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [4407, 552]
Target 1: [440, 5529]
Binary Target 1
---------------------------
Target 0: [4407, 552]
Target 1: [440, 5529]
===================================
Normal Label Distribution: 
Target 0: [4407, 552]
Target 1: [440, 5529]
===================================
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [4423, 4423]
Target 1: [4423, 4423]
Binary Target 1
---------------------------
Target 0: [4423, 4423]
Target 1: [4423, 4423]
===================================
Normal Label Distribution: 
Target 0: [4423, 4423]
Target 1: [4423, 4423]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 17692, target_attr: gender, bias_attr: race bias_rate: 0.9
['[train] target_0-bias_0: 4423', '[train] target_0-bias_1: 4423', '[train] target_1-bias_0: 4423', '[train] target_1-bias_1: 4423']
get_utk_face - split: valid, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_race-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [583, 684]
Target 1: [457, 646]
Binary Target 1
---------------------------
Target 0: [583, 684]
Target 1: [457, 646]
===================================
Normal Label Distribution: 
Target 0: [583, 684]
Target 1: [457, 646]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 2370, target_attr: gender, bias_attr: race bias_rate: 0.9
['[valid] target_0-bias_0: 583', '[valid] target_0-bias_1: 684', '[valid] target_1-bias_0: 457', '[valid] target_1-bias_1: 646']
get_utk_face - split: test, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_race-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [558, 677]
Target 1: [462, 673]
Binary Target 1
---------------------------
Target 0: [558, 677]
Target 1: [462, 673]
===================================
Normal Label Distribution: 
Target 0: [558, 677]
Target 1: [462, 673]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 2370, target_attr: gender, bias_attr: race bias_rate: 0.9
['[test] target_0-bias_0: 558', '[test] target_0-bias_1: 677', '[test] target_1-bias_0: 462', '[test] target_1-bias_1: 673']
decay_epochs: [6, 13]
[1 / 20] Learning rate: 0.001 weight: 0.01
[1 / 20] Loss: 4.840300349016252 CE Loss: 0.5225867461678455 Con Loss: 4.835074454714426
[1 / 20] tensor([[0.918, 0.883],
        [0.693, 0.716]]) {'epoch': 1, 'valid/acc': 80.759, 'valid/acc_unbiased': 80.125, 'valid/diff': 2.52, 'valid/acc_skew': 81.385, 'valid/acc_align': 78.866, 'test/acc': 80.675, 'test/acc_unbiased': 80.243, 'test/diff': 2.89, 'test/acc_skew': 80.51, 'test/acc_align': 79.975}
[1 / 20] best valid accuracy: 80.125 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 80.759, 'best_valid_valid/acc_unbiased': 80.125, 'best_valid_valid/diff': 2.52, 'best_valid_valid/acc_skew': 81.385, 'best_valid_valid/acc_align': 78.866, 'best_valid_test/acc': 80.675, 'best_valid_test/acc_unbiased': 80.243, 'best_valid_test/diff': 2.89, 'best_valid_test/acc_skew': 80.51, 'best_valid_test/acc_align': 79.975}
[1 / 20] best test accuracy: 80.243 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 80.759, 'best_test_valid/acc_unbiased': 80.125, 'best_test_valid/diff': 2.52, 'best_test_valid/acc_skew': 81.385, 'best_test_valid/acc_align': 78.866, 'best_test_test/acc': 80.675, 'best_test_test/acc_unbiased': 80.243, 'best_test_test/diff': 2.89, 'best_test_test/acc_skew': 80.51, 'best_test_test/acc_align': 79.975}
[2 / 20] Learning rate: 0.001 weight: 0.01
[2 / 20] Loss: 4.721808101698039 CE Loss: 0.42463420846600786 Con Loss: 4.717561746921147
[2 / 20] tensor([[0.740, 0.653],
        [0.935, 0.944]]) {'epoch': 2, 'valid/acc': 79.873, 'valid/acc_unbiased': 80.906, 'valid/diff': 3.904, 'valid/acc_skew': 82.271, 'valid/acc_align': 79.541, 'test/acc': 81.097, 'test/acc_unbiased': 81.791, 'test/diff': 4.787, 'test/acc_skew': 83.76, 'test/acc_align': 79.821}
[2 / 20] best valid accuracy: 80.906 at epoch 2 
 best_stats: {'best_valid_epoch': 2, 'best_valid_valid/acc': 79.873, 'best_valid_valid/acc_unbiased': 80.906, 'best_valid_valid/diff': 3.904, 'best_valid_valid/acc_skew': 82.271, 'best_valid_valid/acc_align': 79.541, 'best_valid_test/acc': 81.097, 'best_valid_test/acc_unbiased': 81.791, 'best_valid_test/diff': 4.787, 'best_valid_test/acc_skew': 83.76, 'best_valid_test/acc_align': 79.821}
[2 / 20] best test accuracy: 81.791 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 79.873, 'best_test_valid/acc_unbiased': 80.906, 'best_test_valid/diff': 3.904, 'best_test_valid/acc_skew': 82.271, 'best_test_valid/acc_align': 79.541, 'best_test_test/acc': 81.097, 'best_test_test/acc_unbiased': 81.791, 'best_test_test/diff': 4.787, 'best_test_test/acc_skew': 83.76, 'best_test_test/acc_align': 79.821}
[3 / 20] Learning rate: 0.001 weight: 0.01
[3 / 20] Loss: 4.692059257303781 CE Loss: 0.4160299628076849 Con Loss: 4.687898954115059
[3 / 20] tensor([[0.742, 0.691],
        [0.900, 0.932]]) {'epoch': 3, 'valid/acc': 80.549, 'valid/acc_unbiased': 81.291, 'valid/diff': 3.276, 'valid/acc_skew': 82.727, 'valid/acc_align': 79.855, 'test/acc': 81.224, 'test/acc_unbiased': 81.633, 'test/diff': 4.093, 'test/acc_skew': 82.118, 'test/acc_align': 81.147}
[3 / 20] best valid accuracy: 81.291 at epoch 3 
 best_stats: {'best_valid_epoch': 3, 'best_valid_valid/acc': 80.549, 'best_valid_valid/acc_unbiased': 81.291, 'best_valid_valid/diff': 3.276, 'best_valid_valid/acc_skew': 82.727, 'best_valid_valid/acc_align': 79.855, 'best_valid_test/acc': 81.224, 'best_valid_test/acc_unbiased': 81.633, 'best_valid_test/diff': 4.093, 'best_valid_test/acc_skew': 82.118, 'best_valid_test/acc_align': 81.147}
[3 / 20] best test accuracy: 81.791 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 79.873, 'best_test_valid/acc_unbiased': 80.906, 'best_test_valid/diff': 3.904, 'best_test_valid/acc_skew': 82.271, 'best_test_valid/acc_align': 79.541, 'best_test_test/acc': 81.097, 'best_test_test/acc_unbiased': 81.791, 'best_test_test/diff': 4.787, 'best_test_test/acc_skew': 83.76, 'best_test_test/acc_align': 79.821}
[4 / 20] Learning rate: 0.001 weight: 0.01
[4 / 20] Loss: 4.667714925473184 CE Loss: 0.38163354703804875 Con Loss: 4.663898598897142
[4 / 20] tensor([[0.885, 0.846],
        [0.805, 0.834]]) {'epoch': 4, 'valid/acc': 84.726, 'valid/acc_unbiased': 84.487, 'valid/diff': 2.849, 'valid/acc_skew': 84.579, 'valid/acc_align': 84.395, 'test/acc': 84.388, 'test/acc_unbiased': 84.262, 'test/diff': 3.365, 'test/acc_skew': 84.525, 'test/acc_align': 83.998}
[4 / 20] best valid accuracy: 84.487 at epoch 4 
 best_stats: {'best_valid_epoch': 4, 'best_valid_valid/acc': 84.726, 'best_valid_valid/acc_unbiased': 84.487, 'best_valid_valid/diff': 2.849, 'best_valid_valid/acc_skew': 84.579, 'best_valid_valid/acc_align': 84.395, 'best_valid_test/acc': 84.388, 'best_valid_test/acc_unbiased': 84.262, 'best_valid_test/diff': 3.365, 'best_valid_test/acc_skew': 84.525, 'best_valid_test/acc_align': 83.998}
[4 / 20] best test accuracy: 84.262 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 84.726, 'best_test_valid/acc_unbiased': 84.487, 'best_test_valid/diff': 2.849, 'best_test_valid/acc_skew': 84.579, 'best_test_valid/acc_align': 84.395, 'best_test_test/acc': 84.388, 'best_test_test/acc_unbiased': 84.262, 'best_test_test/diff': 3.365, 'best_test_test/acc_skew': 84.525, 'best_test_test/acc_align': 83.998}
[5 / 20] Learning rate: 0.001 weight: 0.01
[5 / 20] Loss: 4.65838451006012 CE Loss: 0.36754213431532123 Con Loss: 4.654709092260297
[5 / 20] tensor([[0.855, 0.808],
        [0.838, 0.871]]) {'epoch': 5, 'valid/acc': 83.797, 'valid/acc_unbiased': 83.849, 'valid/diff': 4.356, 'valid/acc_skew': 84.691, 'valid/acc_align': 83.007, 'test/acc': 84.262, 'test/acc_unbiased': 84.28, 'test/diff': 3.996, 'test/acc_skew': 84.625, 'test/acc_align': 83.935}
[5 / 20] best valid accuracy: 84.487 at epoch 4 
 best_stats: {'best_valid_epoch': 4, 'best_valid_valid/acc': 84.726, 'best_valid_valid/acc_unbiased': 84.487, 'best_valid_valid/diff': 2.849, 'best_valid_valid/acc_skew': 84.579, 'best_valid_valid/acc_align': 84.395, 'best_valid_test/acc': 84.388, 'best_valid_test/acc_unbiased': 84.262, 'best_valid_test/diff': 3.365, 'best_valid_test/acc_skew': 84.525, 'best_valid_test/acc_align': 83.998}
[5 / 20] best test accuracy: 84.280 at epoch 5 
 best_stats: {'best_test_epoch': 5, 'best_test_valid/acc': 83.797, 'best_test_valid/acc_unbiased': 83.849, 'best_test_valid/diff': 4.356, 'best_test_valid/acc_skew': 84.691, 'best_test_valid/acc_align': 83.007, 'best_test_test/acc': 84.262, 'best_test_test/acc_unbiased': 84.28, 'best_test_test/diff': 3.996, 'best_test_test/acc_skew': 84.625, 'best_test_test/acc_align': 83.935}
[6 / 20] Learning rate: 0.001 weight: 0.01
[6 / 20] Loss: 4.636937302807836 CE Loss: 0.3497522947490687 Con Loss: 4.6334397859118415
[6 / 20] tensor([[0.815, 0.756],
        [0.890, 0.902]]) {'epoch': 6, 'valid/acc': 84.515, 'valid/acc_unbiased': 84.946, 'valid/diff': 1.316, 'valid/acc_skew': 85.604, 'valid/acc_align': 84.288, 'test/acc': 83.755, 'test/acc_unbiased': 84.081, 'test/diff': 3.573, 'test/acc_skew': 85.251, 'test/acc_align': 82.91}
[6 / 20] best valid accuracy: 84.946 at epoch 6 
 best_stats: {'best_valid_epoch': 6, 'best_valid_valid/acc': 84.515, 'best_valid_valid/acc_unbiased': 84.946, 'best_valid_valid/diff': 1.316, 'best_valid_valid/acc_skew': 85.604, 'best_valid_valid/acc_align': 84.288, 'best_valid_test/acc': 83.755, 'best_valid_test/acc_unbiased': 84.081, 'best_valid_test/diff': 3.573, 'best_valid_test/acc_skew': 85.251, 'best_valid_test/acc_align': 82.91}
[6 / 20] best test accuracy: 84.280 at epoch 5 
 best_stats: {'best_test_epoch': 5, 'best_test_valid/acc': 83.797, 'best_test_valid/acc_unbiased': 83.849, 'best_test_valid/diff': 4.356, 'best_test_valid/acc_skew': 84.691, 'best_test_valid/acc_align': 83.007, 'best_test_test/acc': 84.262, 'best_test_test/acc_unbiased': 84.28, 'best_test_test/diff': 3.996, 'best_test_test/acc_skew': 84.625, 'best_test_test/acc_align': 83.935}
[7 / 20] Learning rate: 0.0001 weight: 0.01
[7 / 20] Loss: 4.57412345393761 CE Loss: 0.30731600635520157 Con Loss: 4.5710502877214925
[7 / 20] tensor([[0.864, 0.833],
        [0.855, 0.883]]) {'epoch': 7, 'valid/acc': 87.384, 'valid/acc_unbiased': 87.458, 'valid/diff': 2.157, 'valid/acc_skew': 87.55, 'valid/acc_align': 87.367, 'test/acc': 85.865, 'test/acc_unbiased': 85.862, 'test/diff': 2.917, 'test/acc_skew': 85.939, 'test/acc_align': 85.785}
[7 / 20] best valid accuracy: 87.458 at epoch 7 
 best_stats: {'best_valid_epoch': 7, 'best_valid_valid/acc': 87.384, 'best_valid_valid/acc_unbiased': 87.458, 'best_valid_valid/diff': 2.157, 'best_valid_valid/acc_skew': 87.55, 'best_valid_valid/acc_align': 87.367, 'best_valid_test/acc': 85.865, 'best_valid_test/acc_unbiased': 85.862, 'best_valid_test/diff': 2.917, 'best_valid_test/acc_skew': 85.939, 'best_valid_test/acc_align': 85.785}
[7 / 20] best test accuracy: 85.862 at epoch 7 
 best_stats: {'best_test_epoch': 7, 'best_test_valid/acc': 87.384, 'best_test_valid/acc_unbiased': 87.458, 'best_test_valid/diff': 2.157, 'best_test_valid/acc_skew': 87.55, 'best_test_valid/acc_align': 87.367, 'best_test_test/acc': 85.865, 'best_test_test/acc_unbiased': 85.862, 'best_test_test/diff': 2.917, 'best_test_test/acc_skew': 85.939, 'best_test_test/acc_align': 85.785}
[8 / 20] Learning rate: 0.0001 weight: 0.01
[8 / 20] Loss: 4.55809532385888 CE Loss: 0.2821858431819659 Con Loss: 4.5552734579404985
[8 / 20] tensor([[0.866, 0.811],
        [0.861, 0.906]]) {'epoch': 8, 'valid/acc': 87.342, 'valid/acc_unbiased': 87.629, 'valid/diff': 1.699, 'valid/acc_skew': 88.372, 'valid/acc_align': 86.885, 'test/acc': 86.076, 'test/acc_unbiased': 86.11, 'test/diff': 4.979, 'test/acc_skew': 86.353, 'test/acc_align': 85.866}
[8 / 20] best valid accuracy: 87.629 at epoch 8 
 best_stats: {'best_valid_epoch': 8, 'best_valid_valid/acc': 87.342, 'best_valid_valid/acc_unbiased': 87.629, 'best_valid_valid/diff': 1.699, 'best_valid_valid/acc_skew': 88.372, 'best_valid_valid/acc_align': 86.885, 'best_valid_test/acc': 86.076, 'best_valid_test/acc_unbiased': 86.11, 'best_valid_test/diff': 4.979, 'best_valid_test/acc_skew': 86.353, 'best_valid_test/acc_align': 85.866}
[8 / 20] best test accuracy: 86.110 at epoch 8 
 best_stats: {'best_test_epoch': 8, 'best_test_valid/acc': 87.342, 'best_test_valid/acc_unbiased': 87.629, 'best_test_valid/diff': 1.699, 'best_test_valid/acc_skew': 88.372, 'best_test_valid/acc_align': 86.885, 'best_test_test/acc': 86.076, 'best_test_test/acc_unbiased': 86.11, 'best_test_test/diff': 4.979, 'best_test_test/acc_skew': 86.353, 'best_test_test/acc_align': 85.866}
[9 / 20] Learning rate: 0.0001 weight: 0.01
[9 / 20] Loss: 4.546480501827384 CE Loss: 0.2766846391563364 Con Loss: 4.5437136660219455
[9 / 20] tensor([[0.885, 0.836],
        [0.840, 0.887]]) {'epoch': 9, 'valid/acc': 88.059, 'valid/acc_unbiased': 88.173, 'valid/diff': 2.199, 'valid/acc_skew': 89.079, 'valid/acc_align': 87.268, 'test/acc': 86.287, 'test/acc_unbiased': 86.206, 'test/diff': 4.825, 'test/acc_skew': 86.257, 'test/acc_align': 86.156}
[9 / 20] best valid accuracy: 88.173 at epoch 9 
 best_stats: {'best_valid_epoch': 9, 'best_valid_valid/acc': 88.059, 'best_valid_valid/acc_unbiased': 88.173, 'best_valid_valid/diff': 2.199, 'best_valid_valid/acc_skew': 89.079, 'best_valid_valid/acc_align': 87.268, 'best_valid_test/acc': 86.287, 'best_valid_test/acc_unbiased': 86.206, 'best_valid_test/diff': 4.825, 'best_valid_test/acc_skew': 86.257, 'best_valid_test/acc_align': 86.156}
[9 / 20] best test accuracy: 86.206 at epoch 9 
 best_stats: {'best_test_epoch': 9, 'best_test_valid/acc': 88.059, 'best_test_valid/acc_unbiased': 88.173, 'best_test_valid/diff': 2.199, 'best_test_valid/acc_skew': 89.079, 'best_test_valid/acc_align': 87.268, 'best_test_test/acc': 86.287, 'best_test_test/acc_unbiased': 86.206, 'best_test_test/diff': 4.825, 'best_test_test/acc_skew': 86.257, 'best_test_test/acc_align': 86.156}
[10 / 20] Learning rate: 0.0001 weight: 0.01
[10 / 20] Loss: 4.535068109621431 CE Loss: 0.26354359592311716 Con Loss: 4.532432649406728
[10 / 20] tensor([[0.860, 0.830],
        [0.872, 0.896]]) {'epoch': 10, 'valid/acc': 87.257, 'valid/acc_unbiased': 87.51, 'valid/diff': 2.484, 'valid/acc_skew': 88.363, 'valid/acc_align': 86.657, 'test/acc': 86.414, 'test/acc_unbiased': 86.466, 'test/diff': 2.689, 'test/acc_skew': 86.625, 'test/acc_align': 86.306}
[10 / 20] best valid accuracy: 88.173 at epoch 9 
 best_stats: {'best_valid_epoch': 9, 'best_valid_valid/acc': 88.059, 'best_valid_valid/acc_unbiased': 88.173, 'best_valid_valid/diff': 2.199, 'best_valid_valid/acc_skew': 89.079, 'best_valid_valid/acc_align': 87.268, 'best_valid_test/acc': 86.287, 'best_valid_test/acc_unbiased': 86.206, 'best_valid_test/diff': 4.825, 'best_valid_test/acc_skew': 86.257, 'best_valid_test/acc_align': 86.156}
[10 / 20] best test accuracy: 86.466 at epoch 10 
 best_stats: {'best_test_epoch': 10, 'best_test_valid/acc': 87.257, 'best_test_valid/acc_unbiased': 87.51, 'best_test_valid/diff': 2.484, 'best_test_valid/acc_skew': 88.363, 'best_test_valid/acc_align': 86.657, 'best_test_test/acc': 86.414, 'best_test_test/acc_unbiased': 86.466, 'best_test_test/diff': 2.689, 'best_test_test/acc_skew': 86.625, 'best_test_test/acc_align': 86.306}
[11 / 20] Learning rate: 0.0001 weight: 0.01
[11 / 20] Loss: 4.522186937467992 CE Loss: 0.25510171017386973 Con Loss: 4.519635935107858
[11 / 20] tensor([[0.912, 0.870],
        [0.831, 0.871]]) {'epoch': 11, 'valid/acc': 87.764, 'valid/acc_unbiased': 87.676, 'valid/diff': 2.879, 'valid/acc_skew': 88.21, 'valid/acc_align': 87.143, 'test/acc': 87.257, 'test/acc_unbiased': 87.102, 'test/diff': 4.087, 'test/acc_skew': 87.168, 'test/acc_align': 87.037}
[11 / 20] best valid accuracy: 88.173 at epoch 9 
 best_stats: {'best_valid_epoch': 9, 'best_valid_valid/acc': 88.059, 'best_valid_valid/acc_unbiased': 88.173, 'best_valid_valid/diff': 2.199, 'best_valid_valid/acc_skew': 89.079, 'best_valid_valid/acc_align': 87.268, 'best_valid_test/acc': 86.287, 'best_valid_test/acc_unbiased': 86.206, 'best_valid_test/diff': 4.825, 'best_valid_test/acc_skew': 86.257, 'best_valid_test/acc_align': 86.156}
[11 / 20] best test accuracy: 87.102 at epoch 11 
 best_stats: {'best_test_epoch': 11, 'best_test_valid/acc': 87.764, 'best_test_valid/acc_unbiased': 87.676, 'best_test_valid/diff': 2.879, 'best_test_valid/acc_skew': 88.21, 'best_test_valid/acc_align': 87.143, 'best_test_test/acc': 87.257, 'best_test_test/acc_unbiased': 87.102, 'best_test_test/diff': 4.087, 'best_test_test/acc_skew': 87.168, 'best_test_test/acc_align': 87.037}
[12 / 20] Learning rate: 0.0001 weight: 0.01
[12 / 20] Loss: 4.508765240694478 CE Loss: 0.24962731142699543 Con Loss: 4.506268964642829
[12 / 20] tensor([[0.871, 0.820],
        [0.859, 0.897]]) {'epoch': 12, 'valid/acc': 87.511, 'valid/acc_unbiased': 87.703, 'valid/diff': 2.65, 'valid/acc_skew': 87.911, 'valid/acc_align': 87.496, 'test/acc': 86.16, 'test/acc_unbiased': 86.189, 'test/diff': 4.467, 'test/acc_skew': 86.514, 'test/acc_align': 85.863}
[12 / 20] best valid accuracy: 88.173 at epoch 9 
 best_stats: {'best_valid_epoch': 9, 'best_valid_valid/acc': 88.059, 'best_valid_valid/acc_unbiased': 88.173, 'best_valid_valid/diff': 2.199, 'best_valid_valid/acc_skew': 89.079, 'best_valid_valid/acc_align': 87.268, 'best_valid_test/acc': 86.287, 'best_valid_test/acc_unbiased': 86.206, 'best_valid_test/diff': 4.825, 'best_valid_test/acc_skew': 86.257, 'best_valid_test/acc_align': 86.156}
[12 / 20] best test accuracy: 87.102 at epoch 11 
 best_stats: {'best_test_epoch': 11, 'best_test_valid/acc': 87.764, 'best_test_valid/acc_unbiased': 87.676, 'best_test_valid/diff': 2.879, 'best_test_valid/acc_skew': 88.21, 'best_test_valid/acc_align': 87.143, 'best_test_test/acc': 87.257, 'best_test_test/acc_unbiased': 87.102, 'best_test_test/diff': 4.087, 'best_test_test/acc_skew': 87.168, 'best_test_test/acc_align': 87.037}
[13 / 20] Learning rate: 0.0001 weight: 0.01
[13 / 20] Loss: 4.5095686792869145 CE Loss: 0.2521291204317377 Con Loss: 4.507047375699068
[13 / 20] tensor([[0.896, 0.840],
        [0.838, 0.886]]) {'epoch': 13, 'valid/acc': 87.384, 'valid/acc_unbiased': 87.454, 'valid/diff': 4.412, 'valid/acc_skew': 88.204, 'valid/acc_align': 86.705, 'test/acc': 86.582, 'test/acc_unbiased': 86.494, 'test/diff': 5.175, 'test/acc_skew': 86.686, 'test/acc_align': 86.303}
[13 / 20] best valid accuracy: 88.173 at epoch 9 
 best_stats: {'best_valid_epoch': 9, 'best_valid_valid/acc': 88.059, 'best_valid_valid/acc_unbiased': 88.173, 'best_valid_valid/diff': 2.199, 'best_valid_valid/acc_skew': 89.079, 'best_valid_valid/acc_align': 87.268, 'best_valid_test/acc': 86.287, 'best_valid_test/acc_unbiased': 86.206, 'best_valid_test/diff': 4.825, 'best_valid_test/acc_skew': 86.257, 'best_valid_test/acc_align': 86.156}
[13 / 20] best test accuracy: 87.102 at epoch 11 
 best_stats: {'best_test_epoch': 11, 'best_test_valid/acc': 87.764, 'best_test_valid/acc_unbiased': 87.676, 'best_test_valid/diff': 2.879, 'best_test_valid/acc_skew': 88.21, 'best_test_valid/acc_align': 87.143, 'best_test_test/acc': 87.257, 'best_test_test/acc_unbiased': 87.102, 'best_test_test/diff': 4.087, 'best_test_test/acc_skew': 87.168, 'best_test_test/acc_align': 87.037}
[14 / 20] Learning rate: 1e-05 weight: 0.01
[14 / 20] Loss: 4.499528051419897 CE Loss: 0.24524340153468185 Con Loss: 4.497075616033158
[14 / 20] tensor([[0.876, 0.823],
        [0.855, 0.902]]) {'epoch': 14, 'valid/acc': 87.215, 'valid/acc_unbiased': 87.396, 'valid/diff': 4.809, 'valid/acc_skew': 88.026, 'valid/acc_align': 86.765, 'test/acc': 86.414, 'test/acc_unbiased': 86.4, 'test/diff': 5.027, 'test/acc_skew': 86.566, 'test/acc_align': 86.234}
[14 / 20] best valid accuracy: 88.173 at epoch 9 
 best_stats: {'best_valid_epoch': 9, 'best_valid_valid/acc': 88.059, 'best_valid_valid/acc_unbiased': 88.173, 'best_valid_valid/diff': 2.199, 'best_valid_valid/acc_skew': 89.079, 'best_valid_valid/acc_align': 87.268, 'best_valid_test/acc': 86.287, 'best_valid_test/acc_unbiased': 86.206, 'best_valid_test/diff': 4.825, 'best_valid_test/acc_skew': 86.257, 'best_valid_test/acc_align': 86.156}
[14 / 20] best test accuracy: 87.102 at epoch 11 
 best_stats: {'best_test_epoch': 11, 'best_test_valid/acc': 87.764, 'best_test_valid/acc_unbiased': 87.676, 'best_test_valid/diff': 2.879, 'best_test_valid/acc_skew': 88.21, 'best_test_valid/acc_align': 87.143, 'best_test_test/acc': 87.257, 'best_test_test/acc_unbiased': 87.102, 'best_test_test/diff': 4.087, 'best_test_test/acc_skew': 87.168, 'best_test_test/acc_align': 87.037}
[15 / 20] Learning rate: 1e-05 weight: 0.01
[15 / 20] Loss: 4.494650053756959 CE Loss: 0.2475105314746098 Con Loss: 4.492174946342742
[15 / 20] tensor([[0.889, 0.835],
        [0.844, 0.897]]) {'epoch': 15, 'valid/acc': 87.595, 'valid/acc_unbiased': 87.666, 'valid/diff': 5.055, 'valid/acc_skew': 88.228, 'valid/acc_align': 87.104, 'test/acc': 86.709, 'test/acc_unbiased': 86.627, 'test/diff': 5.382, 'test/acc_skew': 86.652, 'test/acc_align': 86.602}
[15 / 20] best valid accuracy: 88.173 at epoch 9 
 best_stats: {'best_valid_epoch': 9, 'best_valid_valid/acc': 88.059, 'best_valid_valid/acc_unbiased': 88.173, 'best_valid_valid/diff': 2.199, 'best_valid_valid/acc_skew': 89.079, 'best_valid_valid/acc_align': 87.268, 'best_valid_test/acc': 86.287, 'best_valid_test/acc_unbiased': 86.206, 'best_valid_test/diff': 4.825, 'best_valid_test/acc_skew': 86.257, 'best_valid_test/acc_align': 86.156}
[15 / 20] best test accuracy: 87.102 at epoch 11 
 best_stats: {'best_test_epoch': 11, 'best_test_valid/acc': 87.764, 'best_test_valid/acc_unbiased': 87.676, 'best_test_valid/diff': 2.879, 'best_test_valid/acc_skew': 88.21, 'best_test_valid/acc_align': 87.143, 'best_test_test/acc': 87.257, 'best_test_test/acc_unbiased': 87.102, 'best_test_test/diff': 4.087, 'best_test_test/acc_skew': 87.168, 'best_test_test/acc_align': 87.037}
[16 / 20] Learning rate: 1e-05 weight: 0.01
[16 / 20] Loss: 4.488711008248274 CE Loss: 0.25205017476364305 Con Loss: 4.486190509343347
[16 / 20] tensor([[0.891, 0.842],
        [0.846, 0.884]]) {'epoch': 16, 'valid/acc': 87.764, 'valid/acc_unbiased': 87.789, 'valid/diff': 3.62, 'valid/acc_skew': 88.375, 'valid/acc_align': 87.203, 'test/acc': 86.624, 'test/acc_unbiased': 86.576, 'test/diff': 4.326, 'test/acc_skew': 86.85, 'test/acc_align': 86.303}
[16 / 20] best valid accuracy: 88.173 at epoch 9 
 best_stats: {'best_valid_epoch': 9, 'best_valid_valid/acc': 88.059, 'best_valid_valid/acc_unbiased': 88.173, 'best_valid_valid/diff': 2.199, 'best_valid_valid/acc_skew': 89.079, 'best_valid_valid/acc_align': 87.268, 'best_valid_test/acc': 86.287, 'best_valid_test/acc_unbiased': 86.206, 'best_valid_test/diff': 4.825, 'best_valid_test/acc_skew': 86.257, 'best_valid_test/acc_align': 86.156}
[16 / 20] best test accuracy: 87.102 at epoch 11 
 best_stats: {'best_test_epoch': 11, 'best_test_valid/acc': 87.764, 'best_test_valid/acc_unbiased': 87.676, 'best_test_valid/diff': 2.879, 'best_test_valid/acc_skew': 88.21, 'best_test_valid/acc_align': 87.143, 'best_test_test/acc': 87.257, 'best_test_test/acc_unbiased': 87.102, 'best_test_test/diff': 4.087, 'best_test_test/acc_skew': 87.168, 'best_test_test/acc_align': 87.037}
[17 / 20] Learning rate: 1e-05 weight: 0.01
[17 / 20] Loss: 4.479542344990505 CE Loss: 0.24089773488130986 Con Loss: 4.4771333537488776
[17 / 20] tensor([[0.898, 0.848],
        [0.833, 0.874]]) {'epoch': 17, 'valid/acc': 87.764, 'valid/acc_unbiased': 87.755, 'valid/diff': 3.258, 'valid/acc_skew': 88.328, 'valid/acc_align': 87.182, 'test/acc': 86.414, 'test/acc_unbiased': 86.319, 'test/diff': 4.518, 'test/acc_skew': 86.559, 'test/acc_align': 86.078}
[17 / 20] best valid accuracy: 88.173 at epoch 9 
 best_stats: {'best_valid_epoch': 9, 'best_valid_valid/acc': 88.059, 'best_valid_valid/acc_unbiased': 88.173, 'best_valid_valid/diff': 2.199, 'best_valid_valid/acc_skew': 89.079, 'best_valid_valid/acc_align': 87.268, 'best_valid_test/acc': 86.287, 'best_valid_test/acc_unbiased': 86.206, 'best_valid_test/diff': 4.825, 'best_valid_test/acc_skew': 86.257, 'best_valid_test/acc_align': 86.156}
[17 / 20] best test accuracy: 87.102 at epoch 11 
 best_stats: {'best_test_epoch': 11, 'best_test_valid/acc': 87.764, 'best_test_valid/acc_unbiased': 87.676, 'best_test_valid/diff': 2.879, 'best_test_valid/acc_skew': 88.21, 'best_test_valid/acc_align': 87.143, 'best_test_test/acc': 87.257, 'best_test_test/acc_unbiased': 87.102, 'best_test_test/diff': 4.087, 'best_test_test/acc_skew': 87.168, 'best_test_test/acc_align': 87.037}
[18 / 20] Learning rate: 1e-05 weight: 0.01
[18 / 20] Loss: 4.482825984627096 CE Loss: 0.24192505893652294 Con Loss: 4.480406741332663
[18 / 20] tensor([[0.887, 0.836],
        [0.846, 0.889]]) {'epoch': 18, 'valid/acc': 87.679, 'valid/acc_unbiased': 87.779, 'valid/diff': 4.039, 'valid/acc_skew': 88.47, 'valid/acc_align': 87.087, 'test/acc': 86.498, 'test/acc_unbiased': 86.45, 'test/diff': 4.665, 'test/acc_skew': 86.671, 'test/acc_align': 86.23}
[18 / 20] best valid accuracy: 88.173 at epoch 9 
 best_stats: {'best_valid_epoch': 9, 'best_valid_valid/acc': 88.059, 'best_valid_valid/acc_unbiased': 88.173, 'best_valid_valid/diff': 2.199, 'best_valid_valid/acc_skew': 89.079, 'best_valid_valid/acc_align': 87.268, 'best_valid_test/acc': 86.287, 'best_valid_test/acc_unbiased': 86.206, 'best_valid_test/diff': 4.825, 'best_valid_test/acc_skew': 86.257, 'best_valid_test/acc_align': 86.156}
[18 / 20] best test accuracy: 87.102 at epoch 11 
 best_stats: {'best_test_epoch': 11, 'best_test_valid/acc': 87.764, 'best_test_valid/acc_unbiased': 87.676, 'best_test_valid/diff': 2.879, 'best_test_valid/acc_skew': 88.21, 'best_test_valid/acc_align': 87.143, 'best_test_test/acc': 87.257, 'best_test_test/acc_unbiased': 87.102, 'best_test_test/diff': 4.087, 'best_test_test/acc_skew': 87.168, 'best_test_test/acc_align': 87.037}
[19 / 20] Learning rate: 1e-05 weight: 0.01
[19 / 20] Loss: 4.480555322734635 CE Loss: 0.22968684878388115 Con Loss: 4.478258455066478
[19 / 20] tensor([[0.891, 0.843],
        [0.840, 0.884]]) {'epoch': 19, 'valid/acc': 87.848, 'valid/acc_unbiased': 87.912, 'valid/diff': 3.136, 'valid/acc_skew': 88.384, 'valid/acc_align': 87.44, 'test/acc': 86.54, 'test/acc_unbiased': 86.451, 'test/diff': 4.576, 'test/acc_skew': 86.525, 'test/acc_align': 86.376}
[19 / 20] best valid accuracy: 88.173 at epoch 9 
 best_stats: {'best_valid_epoch': 9, 'best_valid_valid/acc': 88.059, 'best_valid_valid/acc_unbiased': 88.173, 'best_valid_valid/diff': 2.199, 'best_valid_valid/acc_skew': 89.079, 'best_valid_valid/acc_align': 87.268, 'best_valid_test/acc': 86.287, 'best_valid_test/acc_unbiased': 86.206, 'best_valid_test/diff': 4.825, 'best_valid_test/acc_skew': 86.257, 'best_valid_test/acc_align': 86.156}
[19 / 20] best test accuracy: 87.102 at epoch 11 
 best_stats: {'best_test_epoch': 11, 'best_test_valid/acc': 87.764, 'best_test_valid/acc_unbiased': 87.676, 'best_test_valid/diff': 2.879, 'best_test_valid/acc_skew': 88.21, 'best_test_valid/acc_align': 87.143, 'best_test_test/acc': 87.257, 'best_test_test/acc_unbiased': 87.102, 'best_test_test/diff': 4.087, 'best_test_test/acc_skew': 87.168, 'best_test_test/acc_align': 87.037}
[20 / 20] Learning rate: 1e-05 weight: 0.01
[20 / 20] Loss: 4.477024318458752 CE Loss: 0.23819189152646436 Con Loss: 4.474642410338693
[20 / 20] tensor([[0.903, 0.861],
        [0.827, 0.874]]) {'epoch': 20, 'valid/acc': 87.932, 'valid/acc_unbiased': 87.815, 'valid/diff': 3.376, 'valid/acc_skew': 88.1, 'valid/acc_align': 87.53, 'test/acc': 86.793, 'test/acc_unbiased': 86.623, 'test/diff': 4.447, 'test/acc_skew': 86.503, 'test/acc_align': 86.743}
[20 / 20] best valid accuracy: 88.173 at epoch 9 
 best_stats: {'best_valid_epoch': 9, 'best_valid_valid/acc': 88.059, 'best_valid_valid/acc_unbiased': 88.173, 'best_valid_valid/diff': 2.199, 'best_valid_valid/acc_skew': 89.079, 'best_valid_valid/acc_align': 87.268, 'best_valid_test/acc': 86.287, 'best_valid_test/acc_unbiased': 86.206, 'best_valid_test/diff': 4.825, 'best_valid_test/acc_skew': 86.257, 'best_valid_test/acc_align': 86.156}
[20 / 20] best test accuracy: 87.102 at epoch 11 
 best_stats: {'best_test_epoch': 11, 'best_test_valid/acc': 87.764, 'best_test_valid/acc_unbiased': 87.676, 'best_test_valid/diff': 2.879, 'best_test_valid/acc_skew': 88.21, 'best_test_valid/acc_align': 87.143, 'best_test_test/acc': 87.257, 'best_test_test/acc_unbiased': 87.102, 'best_test_test/diff': 4.087, 'best_test_test/acc_skew': 87.168, 'best_test_test/acc_align': 87.037}
Total training time: 0:42:04
