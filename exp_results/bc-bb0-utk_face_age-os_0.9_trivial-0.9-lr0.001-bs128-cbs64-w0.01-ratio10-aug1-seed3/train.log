Log level set to: INFO
Set seed: 3
=======> Using Fixed Random Seed: 3 <========
save_path: exp_results/bc-bb0-utk_face_age-os_0.9_trivial-0.9-lr0.001-bs128-cbs64-w0.01-ratio10-aug1-seed3
get_utk_face - split: train, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_age-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
Binary Target 1
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Normal Label Distribution: 
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [7413, 7413]
Target 1: [7413, 7413]
Binary Target 1
---------------------------
Target 0: [7413, 7413]
Target 1: [7413, 7413]
===================================
Normal Label Distribution: 
Target 0: [7413, 7413]
Target 1: [7413, 7413]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 29652, target_attr: gender, bias_attr: age bias_rate: 0.9
['[train] target_0-bias_0: 7413', '[train] target_0-bias_1: 7413', '[train] target_1-bias_0: 7413', '[train] target_1-bias_1: 7413']
confusion_matrix - 
 original: tensor([[7413., 7413.],
        [7413., 7413.]]), 
 normalized: tensor([[0.500, 0.500],
        [0.500, 0.500]]), 
 b|y: tensor([[0.500, 0.500],
        [0.500, 0.500]])
get_utk_face - split: train, aug: 1, given_y: True, ratio: 10
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_age-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
Binary Target 1
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Normal Label Distribution: 
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [7413, 7413]
Target 1: [7413, 7413]
Binary Target 1
---------------------------
Target 0: [7413, 7413]
Target 1: [7413, 7413]
===================================
Normal Label Distribution: 
Target 0: [7413, 7413]
Target 1: [7413, 7413]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 29652, target_attr: gender, bias_attr: age bias_rate: 0.9
['[train] target_0-bias_0: 7413', '[train] target_0-bias_1: 7413', '[train] target_1-bias_0: 7413', '[train] target_1-bias_1: 7413']
get_utk_face - split: valid, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_age-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [1030, 195]
Target 1: [841, 202]
Binary Target 1
---------------------------
Target 0: [1030, 195]
Target 1: [841, 202]
===================================
Normal Label Distribution: 
Target 0: [1030, 195]
Target 1: [841, 202]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 2268, target_attr: gender, bias_attr: age bias_rate: 0.9
['[valid] target_0-bias_0: 1030', '[valid] target_0-bias_1: 195', '[valid] target_1-bias_0: 841', '[valid] target_1-bias_1: 202']
get_utk_face - split: test, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_age-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [1061, 176]
Target 1: [867, 165]
Binary Target 1
---------------------------
Target 0: [1061, 176]
Target 1: [867, 165]
===================================
Normal Label Distribution: 
Target 0: [1061, 176]
Target 1: [867, 165]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 2269, target_attr: gender, bias_attr: age bias_rate: 0.9
['[test] target_0-bias_0: 1061', '[test] target_0-bias_1: 176', '[test] target_1-bias_0: 867', '[test] target_1-bias_1: 165']
decay_epochs: [6, 13]
[1 / 20] Learning rate: 0.001 weight: 0.01
[1 / 20] Loss: 4.860205915089032 CE Loss: 0.5659697948961658 Con Loss: 4.854546209361314
[1 / 20] tensor([[0.723, 0.506],
        [0.893, 0.794]]) {'epoch': 1, 'valid/acc': 78.042, 'valid/acc_unbiased': 71.716, 'valid/diff': 21.218, 'valid/acc_skew': 82.325, 'valid/acc_align': 61.107, 'test/acc': 77.611, 'test/acc_unbiased': 72.881, 'test/diff': 15.801, 'test/acc_skew': 80.782, 'test/acc_align': 64.981}
[1 / 20] best valid accuracy: 71.716 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 78.042, 'best_valid_valid/acc_unbiased': 71.716, 'best_valid_valid/diff': 21.218, 'best_valid_valid/acc_skew': 82.325, 'best_valid_valid/acc_align': 61.107, 'best_valid_test/acc': 77.611, 'best_valid_test/acc_unbiased': 72.881, 'best_valid_test/diff': 15.801, 'best_valid_test/acc_skew': 80.782, 'best_valid_test/acc_align': 64.981}
[1 / 20] best test accuracy: 72.881 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 78.042, 'best_test_valid/acc_unbiased': 71.716, 'best_test_valid/diff': 21.218, 'best_test_valid/acc_skew': 82.325, 'best_test_valid/acc_align': 61.107, 'best_test_test/acc': 77.611, 'best_test_test/acc_unbiased': 72.881, 'best_test_test/diff': 15.801, 'best_test_test/acc_skew': 80.782, 'best_test_test/acc_align': 64.981}
[2 / 20] Learning rate: 0.001 weight: 0.01
[2 / 20] Loss: 4.795695484335825 CE Loss: 0.4604867628658572 Con Loss: 4.791090607498397
[2 / 20] tensor([[0.907, 0.727],
        [0.746, 0.661]]) {'epoch': 2, 'valid/acc': 79.938, 'valid/acc_unbiased': 73.859, 'valid/diff': 16.587, 'valid/acc_skew': 82.152, 'valid/acc_align': 65.565, 'test/acc': 81.357, 'test/acc_unbiased': 76.021, 'test/diff': 13.253, 'test/acc_skew': 82.647, 'test/acc_align': 69.394}
[2 / 20] best valid accuracy: 73.859 at epoch 2 
 best_stats: {'best_valid_epoch': 2, 'best_valid_valid/acc': 79.938, 'best_valid_valid/acc_unbiased': 73.859, 'best_valid_valid/diff': 16.587, 'best_valid_valid/acc_skew': 82.152, 'best_valid_valid/acc_align': 65.565, 'best_valid_test/acc': 81.357, 'best_valid_test/acc_unbiased': 76.021, 'best_valid_test/diff': 13.253, 'best_valid_test/acc_skew': 82.647, 'best_valid_test/acc_align': 69.394}
[2 / 20] best test accuracy: 76.021 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 79.938, 'best_test_valid/acc_unbiased': 73.859, 'best_test_valid/diff': 16.587, 'best_test_valid/acc_skew': 82.152, 'best_test_valid/acc_align': 65.565, 'best_test_test/acc': 81.357, 'best_test_test/acc_unbiased': 76.021, 'best_test_test/diff': 13.253, 'best_test_test/acc_skew': 82.647, 'best_test_test/acc_align': 69.394}
[3 / 20] Learning rate: 0.001 weight: 0.01
[3 / 20] Loss: 4.770545748617105 CE Loss: 0.42110727411218296 Con Loss: 4.766334673404114
[3 / 20] tensor([[0.731, 0.466],
        [0.903, 0.788]]) {'epoch': 3, 'valid/acc': 78.616, 'valid/acc_unbiased': 73.663, 'valid/diff': 17.12, 'valid/acc_skew': 82.223, 'valid/acc_align': 65.103, 'test/acc': 78.052, 'test/acc_unbiased': 72.207, 'test/diff': 19.036, 'test/acc_skew': 81.725, 'test/acc_align': 62.689}
[3 / 20] best valid accuracy: 73.859 at epoch 2 
 best_stats: {'best_valid_epoch': 2, 'best_valid_valid/acc': 79.938, 'best_valid_valid/acc_unbiased': 73.859, 'best_valid_valid/diff': 16.587, 'best_valid_valid/acc_skew': 82.152, 'best_valid_valid/acc_align': 65.565, 'best_valid_test/acc': 81.357, 'best_valid_test/acc_unbiased': 76.021, 'best_valid_test/diff': 13.253, 'best_valid_test/acc_skew': 82.647, 'best_valid_test/acc_align': 69.394}
[3 / 20] best test accuracy: 76.021 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 79.938, 'best_test_valid/acc_unbiased': 73.859, 'best_test_valid/diff': 16.587, 'best_test_valid/acc_skew': 82.152, 'best_test_valid/acc_align': 65.565, 'best_test_test/acc': 81.357, 'best_test_test/acc_unbiased': 76.021, 'best_test_test/diff': 13.253, 'best_test_test/acc_skew': 82.647, 'best_test_test/acc_align': 69.394}
[4 / 20] Learning rate: 0.001 weight: 0.01
[4 / 20] Loss: 4.75485768498928 CE Loss: 0.4003480675369079 Con Loss: 4.750854220995613
[4 / 20] tensor([[0.776, 0.415],
        [0.931, 0.933]]) {'epoch': 4, 'valid/acc': 81.041, 'valid/acc_unbiased': 74.692, 'valid/diff': 21.929, 'valid/acc_skew': 85.148, 'valid/acc_align': 64.236, 'test/acc': 81.842, 'test/acc_unbiased': 76.365, 'test/diff': 18.172, 'test/acc_skew': 85.324, 'test/acc_align': 67.405}
[4 / 20] best valid accuracy: 74.692 at epoch 4 
 best_stats: {'best_valid_epoch': 4, 'best_valid_valid/acc': 81.041, 'best_valid_valid/acc_unbiased': 74.692, 'best_valid_valid/diff': 21.929, 'best_valid_valid/acc_skew': 85.148, 'best_valid_valid/acc_align': 64.236, 'best_valid_test/acc': 81.842, 'best_valid_test/acc_unbiased': 76.365, 'best_valid_test/diff': 18.172, 'best_valid_test/acc_skew': 85.324, 'best_valid_test/acc_align': 67.405}
[4 / 20] best test accuracy: 76.365 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 81.041, 'best_test_valid/acc_unbiased': 74.692, 'best_test_valid/diff': 21.929, 'best_test_valid/acc_skew': 85.148, 'best_test_valid/acc_align': 64.236, 'best_test_test/acc': 81.842, 'best_test_test/acc_unbiased': 76.365, 'best_test_test/diff': 18.172, 'best_test_test/acc_skew': 85.324, 'best_test_test/acc_align': 67.405}
[5 / 20] Learning rate: 0.001 weight: 0.01
[5 / 20] Loss: 4.736955980725187 CE Loss: 0.3775293047042506 Con Loss: 4.733180696273098
[5 / 20] tensor([[0.882, 0.631],
        [0.822, 0.727]]) {'epoch': 5, 'valid/acc': 84.171, 'valid/acc_unbiased': 79.274, 'valid/diff': 14.266, 'valid/acc_skew': 86.407, 'valid/acc_align': 72.141, 'test/acc': 82.856, 'test/acc_unbiased': 76.563, 'test/diff': 17.33, 'test/acc_skew': 85.228, 'test/acc_align': 67.898}
[5 / 20] best valid accuracy: 79.274 at epoch 5 
 best_stats: {'best_valid_epoch': 5, 'best_valid_valid/acc': 84.171, 'best_valid_valid/acc_unbiased': 79.274, 'best_valid_valid/diff': 14.266, 'best_valid_valid/acc_skew': 86.407, 'best_valid_valid/acc_align': 72.141, 'best_valid_test/acc': 82.856, 'best_valid_test/acc_unbiased': 76.563, 'best_valid_test/diff': 17.33, 'best_valid_test/acc_skew': 85.228, 'best_valid_test/acc_align': 67.898}
[5 / 20] best test accuracy: 76.563 at epoch 5 
 best_stats: {'best_test_epoch': 5, 'best_test_valid/acc': 84.171, 'best_test_valid/acc_unbiased': 79.274, 'best_test_valid/diff': 14.266, 'best_test_valid/acc_skew': 86.407, 'best_test_valid/acc_align': 72.141, 'best_test_test/acc': 82.856, 'best_test_test/acc_unbiased': 76.563, 'best_test_test/diff': 17.33, 'best_test_test/acc_skew': 85.228, 'best_test_test/acc_align': 67.898}
[6 / 20] Learning rate: 0.001 weight: 0.01
[6 / 20] Loss: 4.722214216422443 CE Loss: 0.3497792550761031 Con Loss: 4.718716434600719
[6 / 20] tensor([[0.863, 0.568],
        [0.864, 0.806]]) {'epoch': 6, 'valid/acc': 82.76, 'valid/acc_unbiased': 76.602, 'valid/diff': 19.119, 'valid/acc_skew': 85.749, 'valid/acc_align': 67.455, 'test/acc': 83.649, 'test/acc_unbiased': 77.537, 'test/diff': 17.65, 'test/acc_skew': 86.362, 'test/acc_align': 68.712}
[6 / 20] best valid accuracy: 79.274 at epoch 5 
 best_stats: {'best_valid_epoch': 5, 'best_valid_valid/acc': 84.171, 'best_valid_valid/acc_unbiased': 79.274, 'best_valid_valid/diff': 14.266, 'best_valid_valid/acc_skew': 86.407, 'best_valid_valid/acc_align': 72.141, 'best_valid_test/acc': 82.856, 'best_valid_test/acc_unbiased': 76.563, 'best_valid_test/diff': 17.33, 'best_valid_test/acc_skew': 85.228, 'best_valid_test/acc_align': 67.898}
[6 / 20] best test accuracy: 77.537 at epoch 6 
 best_stats: {'best_test_epoch': 6, 'best_test_valid/acc': 82.76, 'best_test_valid/acc_unbiased': 76.602, 'best_test_valid/diff': 19.119, 'best_test_valid/acc_skew': 85.749, 'best_test_valid/acc_align': 67.455, 'best_test_test/acc': 83.649, 'best_test_test/acc_unbiased': 77.537, 'best_test_test/diff': 17.65, 'best_test_test/acc_skew': 86.362, 'best_test_test/acc_align': 68.712}
[7 / 20] Learning rate: 0.0001 weight: 0.01
[7 / 20] Loss: 4.662487229306447 CE Loss: 0.29149622877696163 Con Loss: 4.659572272105817
[7 / 20] tensor([[0.907, 0.585],
        [0.848, 0.830]]) {'epoch': 7, 'valid/acc': 84.612, 'valid/acc_unbiased': 78.122, 'valid/diff': 23.341, 'valid/acc_skew': 87.578, 'valid/acc_align': 68.666, 'test/acc': 85.368, 'test/acc_unbiased': 79.249, 'test/diff': 16.946, 'test/acc_skew': 87.722, 'test/acc_align': 70.777}
[7 / 20] best valid accuracy: 79.274 at epoch 5 
 best_stats: {'best_valid_epoch': 5, 'best_valid_valid/acc': 84.171, 'best_valid_valid/acc_unbiased': 79.274, 'best_valid_valid/diff': 14.266, 'best_valid_valid/acc_skew': 86.407, 'best_valid_valid/acc_align': 72.141, 'best_valid_test/acc': 82.856, 'best_valid_test/acc_unbiased': 76.563, 'best_valid_test/diff': 17.33, 'best_valid_test/acc_skew': 85.228, 'best_valid_test/acc_align': 67.898}
[7 / 20] best test accuracy: 79.249 at epoch 7 
 best_stats: {'best_test_epoch': 7, 'best_test_valid/acc': 84.612, 'best_test_valid/acc_unbiased': 78.122, 'best_test_valid/diff': 23.341, 'best_test_valid/acc_skew': 87.578, 'best_test_valid/acc_align': 68.666, 'best_test_test/acc': 85.368, 'best_test_test/acc_unbiased': 79.249, 'best_test_test/diff': 16.946, 'best_test_test/acc_skew': 87.722, 'best_test_test/acc_align': 70.777}
[8 / 20] Learning rate: 0.0001 weight: 0.01
[8 / 20] Loss: 4.626477350481734 CE Loss: 0.2656997556541993 Con Loss: 4.623820350219344
[8 / 20] tensor([[0.910, 0.494],
        [0.864, 0.891]]) {'epoch': 8, 'valid/acc': 83.73, 'valid/acc_unbiased': 76.071, 'valid/diff': 28.744, 'valid/acc_skew': 87.357, 'valid/acc_align': 64.784, 'test/acc': 85.853, 'test/acc_unbiased': 78.966, 'test/diff': 22.111, 'test/acc_skew': 88.671, 'test/acc_align': 69.261}
[8 / 20] best valid accuracy: 79.274 at epoch 5 
 best_stats: {'best_valid_epoch': 5, 'best_valid_valid/acc': 84.171, 'best_valid_valid/acc_unbiased': 79.274, 'best_valid_valid/diff': 14.266, 'best_valid_valid/acc_skew': 86.407, 'best_valid_valid/acc_align': 72.141, 'best_valid_test/acc': 82.856, 'best_valid_test/acc_unbiased': 76.563, 'best_valid_test/diff': 17.33, 'best_valid_test/acc_skew': 85.228, 'best_valid_test/acc_align': 67.898}
[8 / 20] best test accuracy: 79.249 at epoch 7 
 best_stats: {'best_test_epoch': 7, 'best_test_valid/acc': 84.612, 'best_test_valid/acc_unbiased': 78.122, 'best_test_valid/diff': 23.341, 'best_test_valid/acc_skew': 87.578, 'best_test_valid/acc_align': 68.666, 'best_test_test/acc': 85.368, 'best_test_test/acc_unbiased': 79.249, 'best_test_test/diff': 16.946, 'best_test_test/acc_skew': 87.722, 'best_test_test/acc_align': 70.777}
[9 / 20] Learning rate: 0.0001 weight: 0.01
[9 / 20] Loss: 4.617803079403639 CE Loss: 0.2492957563353955 Con Loss: 4.615310120129093
[9 / 20] tensor([[0.926, 0.517],
        [0.867, 0.897]]) {'epoch': 9, 'valid/acc': 84.347, 'valid/acc_unbiased': 76.599, 'valid/diff': 27.95, 'valid/acc_skew': 87.874, 'valid/acc_align': 65.324, 'test/acc': 86.999, 'test/acc_unbiased': 80.196, 'test/diff': 21.953, 'test/acc_skew': 89.692, 'test/acc_align': 70.701}
[9 / 20] best valid accuracy: 79.274 at epoch 5 
 best_stats: {'best_valid_epoch': 5, 'best_valid_valid/acc': 84.171, 'best_valid_valid/acc_unbiased': 79.274, 'best_valid_valid/diff': 14.266, 'best_valid_valid/acc_skew': 86.407, 'best_valid_valid/acc_align': 72.141, 'best_valid_test/acc': 82.856, 'best_valid_test/acc_unbiased': 76.563, 'best_valid_test/diff': 17.33, 'best_valid_test/acc_skew': 85.228, 'best_valid_test/acc_align': 67.898}
[9 / 20] best test accuracy: 80.196 at epoch 9 
 best_stats: {'best_test_epoch': 9, 'best_test_valid/acc': 84.347, 'best_test_valid/acc_unbiased': 76.599, 'best_test_valid/diff': 27.95, 'best_test_valid/acc_skew': 87.874, 'best_test_valid/acc_align': 65.324, 'best_test_test/acc': 86.999, 'best_test_test/acc_unbiased': 80.196, 'best_test_test/diff': 21.953, 'best_test_test/acc_skew': 89.692, 'best_test_test/acc_align': 70.701}
[10 / 20] Learning rate: 0.0001 weight: 0.01
[10 / 20] Loss: 4.595361786719744 CE Loss: 0.23645571751840905 Con Loss: 4.592997227412365
[10 / 20] tensor([[0.923, 0.489],
        [0.856, 0.903]]) {'epoch': 10, 'valid/acc': 84.7, 'valid/acc_unbiased': 76.555, 'valid/diff': 30.388, 'valid/acc_skew': 88.316, 'valid/acc_align': 64.793, 'test/acc': 86.205, 'test/acc_unbiased': 79.255, 'test/diff': 24.064, 'test/acc_skew': 88.927, 'test/acc_align': 69.583}
[10 / 20] best valid accuracy: 79.274 at epoch 5 
 best_stats: {'best_valid_epoch': 5, 'best_valid_valid/acc': 84.171, 'best_valid_valid/acc_unbiased': 79.274, 'best_valid_valid/diff': 14.266, 'best_valid_valid/acc_skew': 86.407, 'best_valid_valid/acc_align': 72.141, 'best_valid_test/acc': 82.856, 'best_valid_test/acc_unbiased': 76.563, 'best_valid_test/diff': 17.33, 'best_valid_test/acc_skew': 85.228, 'best_valid_test/acc_align': 67.898}
[10 / 20] best test accuracy: 80.196 at epoch 9 
 best_stats: {'best_test_epoch': 9, 'best_test_valid/acc': 84.347, 'best_test_valid/acc_unbiased': 76.599, 'best_test_valid/diff': 27.95, 'best_test_valid/acc_skew': 87.874, 'best_test_valid/acc_align': 65.324, 'best_test_test/acc': 86.999, 'best_test_test/acc_unbiased': 80.196, 'best_test_test/diff': 21.953, 'best_test_test/acc_skew': 89.692, 'best_test_test/acc_align': 70.701}
[11 / 20] Learning rate: 0.0001 weight: 0.01
[11 / 20] Loss: 4.59564380872174 CE Loss: 0.23396406851484758 Con Loss: 4.593304162531685
[11 / 20] tensor([[0.904, 0.472],
        [0.878, 0.927]]) {'epoch': 11, 'valid/acc': 84.568, 'valid/acc_unbiased': 76.897, 'valid/diff': 29.363, 'valid/acc_skew': 88.276, 'valid/acc_align': 65.518, 'test/acc': 86.205, 'test/acc_unbiased': 79.512, 'test/diff': 24.09, 'test/acc_skew': 89.08, 'test/acc_align': 69.943}
[11 / 20] best valid accuracy: 79.274 at epoch 5 
 best_stats: {'best_valid_epoch': 5, 'best_valid_valid/acc': 84.171, 'best_valid_valid/acc_unbiased': 79.274, 'best_valid_valid/diff': 14.266, 'best_valid_valid/acc_skew': 86.407, 'best_valid_valid/acc_align': 72.141, 'best_valid_test/acc': 82.856, 'best_valid_test/acc_unbiased': 76.563, 'best_valid_test/diff': 17.33, 'best_valid_test/acc_skew': 85.228, 'best_valid_test/acc_align': 67.898}
[11 / 20] best test accuracy: 80.196 at epoch 9 
 best_stats: {'best_test_epoch': 9, 'best_test_valid/acc': 84.347, 'best_test_valid/acc_unbiased': 76.599, 'best_test_valid/diff': 27.95, 'best_test_valid/acc_skew': 87.874, 'best_test_valid/acc_align': 65.324, 'best_test_test/acc': 86.999, 'best_test_test/acc_unbiased': 80.196, 'best_test_test/diff': 21.953, 'best_test_test/acc_skew': 89.692, 'best_test_test/acc_align': 70.701}
[12 / 20] Learning rate: 0.0001 weight: 0.01
[12 / 20] Loss: 4.582443168734822 CE Loss: 0.22902819448744063 Con Loss: 4.580152887637422
[12 / 20] tensor([[0.917, 0.466],
        [0.871, 0.909]]) {'epoch': 12, 'valid/acc': 84.877, 'valid/acc_unbiased': 76.934, 'valid/diff': 29.756, 'valid/acc_skew': 88.588, 'valid/acc_align': 65.279, 'test/acc': 86.382, 'test/acc_unbiased': 79.072, 'test/diff': 24.471, 'test/acc_skew': 89.394, 'test/acc_align': 68.75}
[12 / 20] best valid accuracy: 79.274 at epoch 5 
 best_stats: {'best_valid_epoch': 5, 'best_valid_valid/acc': 84.171, 'best_valid_valid/acc_unbiased': 79.274, 'best_valid_valid/diff': 14.266, 'best_valid_valid/acc_skew': 86.407, 'best_valid_valid/acc_align': 72.141, 'best_valid_test/acc': 82.856, 'best_valid_test/acc_unbiased': 76.563, 'best_valid_test/diff': 17.33, 'best_valid_test/acc_skew': 85.228, 'best_valid_test/acc_align': 67.898}
[12 / 20] best test accuracy: 80.196 at epoch 9 
 best_stats: {'best_test_epoch': 9, 'best_test_valid/acc': 84.347, 'best_test_valid/acc_unbiased': 76.599, 'best_test_valid/diff': 27.95, 'best_test_valid/acc_skew': 87.874, 'best_test_valid/acc_align': 65.324, 'best_test_test/acc': 86.999, 'best_test_test/acc_unbiased': 80.196, 'best_test_test/diff': 21.953, 'best_test_test/acc_skew': 89.692, 'best_test_test/acc_align': 70.701}
[13 / 20] Learning rate: 0.0001 weight: 0.01
[13 / 20] Loss: 4.579360495111518 CE Loss: 0.222120601054179 Con Loss: 4.5771392881186825
[13 / 20] tensor([[0.922, 0.426],
        [0.865, 0.945]]) {'epoch': 13, 'valid/acc': 85.494, 'valid/acc_unbiased': 77.502, 'valid/diff': 28.998, 'valid/acc_skew': 89.203, 'valid/acc_align': 65.801, 'test/acc': 86.338, 'test/acc_unbiased': 78.96, 'test/diff': 28.802, 'test/acc_skew': 89.341, 'test/acc_align': 68.58}
[13 / 20] best valid accuracy: 79.274 at epoch 5 
 best_stats: {'best_valid_epoch': 5, 'best_valid_valid/acc': 84.171, 'best_valid_valid/acc_unbiased': 79.274, 'best_valid_valid/diff': 14.266, 'best_valid_valid/acc_skew': 86.407, 'best_valid_valid/acc_align': 72.141, 'best_valid_test/acc': 82.856, 'best_valid_test/acc_unbiased': 76.563, 'best_valid_test/diff': 17.33, 'best_valid_test/acc_skew': 85.228, 'best_valid_test/acc_align': 67.898}
[13 / 20] best test accuracy: 80.196 at epoch 9 
 best_stats: {'best_test_epoch': 9, 'best_test_valid/acc': 84.347, 'best_test_valid/acc_unbiased': 76.599, 'best_test_valid/diff': 27.95, 'best_test_valid/acc_skew': 87.874, 'best_test_valid/acc_align': 65.324, 'best_test_test/acc': 86.999, 'best_test_test/acc_unbiased': 80.196, 'best_test_test/diff': 21.953, 'best_test_test/acc_skew': 89.692, 'best_test_test/acc_align': 70.701}
[14 / 20] Learning rate: 1e-05 weight: 0.01
[14 / 20] Loss: 4.568727564300327 CE Loss: 0.21861671264694557 Con Loss: 4.566541386088041
[14 / 20] tensor([[0.927, 0.460],
        [0.863, 0.939]]) {'epoch': 14, 'valid/acc': 84.744, 'valid/acc_unbiased': 76.605, 'valid/diff': 29.5, 'valid/acc_skew': 88.408, 'valid/acc_align': 64.802, 'test/acc': 86.734, 'test/acc_unbiased': 79.745, 'test/diff': 27.192, 'test/acc_skew': 89.509, 'test/acc_align': 69.981}
[14 / 20] best valid accuracy: 79.274 at epoch 5 
 best_stats: {'best_valid_epoch': 5, 'best_valid_valid/acc': 84.171, 'best_valid_valid/acc_unbiased': 79.274, 'best_valid_valid/diff': 14.266, 'best_valid_valid/acc_skew': 86.407, 'best_valid_valid/acc_align': 72.141, 'best_valid_test/acc': 82.856, 'best_valid_test/acc_unbiased': 76.563, 'best_valid_test/diff': 17.33, 'best_valid_test/acc_skew': 85.228, 'best_valid_test/acc_align': 67.898}
[14 / 20] best test accuracy: 80.196 at epoch 9 
 best_stats: {'best_test_epoch': 9, 'best_test_valid/acc': 84.347, 'best_test_valid/acc_unbiased': 76.599, 'best_test_valid/diff': 27.95, 'best_test_valid/acc_skew': 87.874, 'best_test_valid/acc_align': 65.324, 'best_test_test/acc': 86.999, 'best_test_test/acc_unbiased': 80.196, 'best_test_test/diff': 21.953, 'best_test_test/acc_skew': 89.692, 'best_test_test/acc_align': 70.701}
[15 / 20] Learning rate: 1e-05 weight: 0.01
[15 / 20] Loss: 4.558491627664745 CE Loss: 0.2126465838628148 Con Loss: 4.556365170717465
[15 / 20] tensor([[0.917, 0.432],
        [0.873, 0.964]]) {'epoch': 15, 'valid/acc': 85.185, 'valid/acc_unbiased': 76.918, 'valid/diff': 30.67, 'valid/acc_skew': 89.079, 'valid/acc_align': 64.758, 'test/acc': 86.602, 'test/acc_unbiased': 79.641, 'test/diff': 28.788, 'test/acc_skew': 89.509, 'test/acc_align': 69.773}
[15 / 20] best valid accuracy: 79.274 at epoch 5 
 best_stats: {'best_valid_epoch': 5, 'best_valid_valid/acc': 84.171, 'best_valid_valid/acc_unbiased': 79.274, 'best_valid_valid/diff': 14.266, 'best_valid_valid/acc_skew': 86.407, 'best_valid_valid/acc_align': 72.141, 'best_valid_test/acc': 82.856, 'best_valid_test/acc_unbiased': 76.563, 'best_valid_test/diff': 17.33, 'best_valid_test/acc_skew': 85.228, 'best_valid_test/acc_align': 67.898}
[15 / 20] best test accuracy: 80.196 at epoch 9 
 best_stats: {'best_test_epoch': 9, 'best_test_valid/acc': 84.347, 'best_test_valid/acc_unbiased': 76.599, 'best_test_valid/diff': 27.95, 'best_test_valid/acc_skew': 87.874, 'best_test_valid/acc_align': 65.324, 'best_test_test/acc': 86.999, 'best_test_test/acc_unbiased': 80.196, 'best_test_test/diff': 21.953, 'best_test_test/acc_skew': 89.692, 'best_test_test/acc_align': 70.701}
[16 / 20] Learning rate: 1e-05 weight: 0.01
[16 / 20] Loss: 4.558057746632482 CE Loss: 0.20805780046239936 Con Loss: 4.555977173216926
[16 / 20] tensor([[0.924, 0.455],
        [0.874, 0.927]]) {'epoch': 16, 'valid/acc': 84.965, 'valid/acc_unbiased': 76.963, 'valid/diff': 28.989, 'valid/acc_skew': 88.619, 'valid/acc_align': 65.306, 'test/acc': 86.866, 'test/acc_unbiased': 79.494, 'test/diff': 26.105, 'test/acc_skew': 89.897, 'test/acc_align': 69.091}
[16 / 20] best valid accuracy: 79.274 at epoch 5 
 best_stats: {'best_valid_epoch': 5, 'best_valid_valid/acc': 84.171, 'best_valid_valid/acc_unbiased': 79.274, 'best_valid_valid/diff': 14.266, 'best_valid_valid/acc_skew': 86.407, 'best_valid_valid/acc_align': 72.141, 'best_valid_test/acc': 82.856, 'best_valid_test/acc_unbiased': 76.563, 'best_valid_test/diff': 17.33, 'best_valid_test/acc_skew': 85.228, 'best_valid_test/acc_align': 67.898}
[16 / 20] best test accuracy: 80.196 at epoch 9 
 best_stats: {'best_test_epoch': 9, 'best_test_valid/acc': 84.347, 'best_test_valid/acc_unbiased': 76.599, 'best_test_valid/diff': 27.95, 'best_test_valid/acc_skew': 87.874, 'best_test_valid/acc_align': 65.324, 'best_test_test/acc': 86.999, 'best_test_test/acc_unbiased': 80.196, 'best_test_test/diff': 21.953, 'best_test_test/acc_skew': 89.692, 'best_test_test/acc_align': 70.701}
[17 / 20] Learning rate: 1e-05 weight: 0.01
[17 / 20] Loss: 4.561464304417778 CE Loss: 0.21050666213743152 Con Loss: 4.559359233678151
[17 / 20] tensor([[0.935, 0.477],
        [0.859, 0.927]]) {'epoch': 17, 'valid/acc': 85.053, 'valid/acc_unbiased': 76.986, 'valid/diff': 28.33, 'valid/acc_skew': 88.64, 'valid/acc_align': 65.333, 'test/acc': 86.999, 'test/acc_unbiased': 79.97, 'test/diff': 26.284, 'test/acc_skew': 89.713, 'test/acc_align': 70.227}
[17 / 20] best valid accuracy: 79.274 at epoch 5 
 best_stats: {'best_valid_epoch': 5, 'best_valid_valid/acc': 84.171, 'best_valid_valid/acc_unbiased': 79.274, 'best_valid_valid/diff': 14.266, 'best_valid_valid/acc_skew': 86.407, 'best_valid_valid/acc_align': 72.141, 'best_valid_test/acc': 82.856, 'best_valid_test/acc_unbiased': 76.563, 'best_valid_test/diff': 17.33, 'best_valid_test/acc_skew': 85.228, 'best_valid_test/acc_align': 67.898}
[17 / 20] best test accuracy: 80.196 at epoch 9 
 best_stats: {'best_test_epoch': 9, 'best_test_valid/acc': 84.347, 'best_test_valid/acc_unbiased': 76.599, 'best_test_valid/diff': 27.95, 'best_test_valid/acc_skew': 87.874, 'best_test_valid/acc_align': 65.324, 'best_test_test/acc': 86.999, 'best_test_test/acc_unbiased': 80.196, 'best_test_test/diff': 21.953, 'best_test_test/acc_skew': 89.692, 'best_test_test/acc_align': 70.701}
[18 / 20] Learning rate: 1e-05 weight: 0.01
[18 / 20] Loss: 4.549641648944405 CE Loss: 0.20797997310156605 Con Loss: 4.547561865754734
[18 / 20] tensor([[0.930, 0.483],
        [0.859, 0.921]]) {'epoch': 18, 'valid/acc': 84.788, 'valid/acc_unbiased': 76.513, 'valid/diff': 29.278, 'valid/acc_skew': 88.462, 'valid/acc_align': 64.563, 'test/acc': 86.778, 'test/acc_unbiased': 79.843, 'test/diff': 25.461, 'test/acc_skew': 89.477, 'test/acc_align': 70.208}
[18 / 20] best valid accuracy: 79.274 at epoch 5 
 best_stats: {'best_valid_epoch': 5, 'best_valid_valid/acc': 84.171, 'best_valid_valid/acc_unbiased': 79.274, 'best_valid_valid/diff': 14.266, 'best_valid_valid/acc_skew': 86.407, 'best_valid_valid/acc_align': 72.141, 'best_valid_test/acc': 82.856, 'best_valid_test/acc_unbiased': 76.563, 'best_valid_test/diff': 17.33, 'best_valid_test/acc_skew': 85.228, 'best_valid_test/acc_align': 67.898}
[18 / 20] best test accuracy: 80.196 at epoch 9 
 best_stats: {'best_test_epoch': 9, 'best_test_valid/acc': 84.347, 'best_test_valid/acc_unbiased': 76.599, 'best_test_valid/diff': 27.95, 'best_test_valid/acc_skew': 87.874, 'best_test_valid/acc_align': 65.324, 'best_test_test/acc': 86.999, 'best_test_test/acc_unbiased': 80.196, 'best_test_test/diff': 21.953, 'best_test_test/acc_skew': 89.692, 'best_test_test/acc_align': 70.701}
[19 / 20] Learning rate: 1e-05 weight: 0.01
[19 / 20] Loss: 4.557141722446669 CE Loss: 0.20669058939191023 Con Loss: 4.555074833672201
[19 / 20] tensor([[0.923, 0.455],
        [0.867, 0.927]]) {'epoch': 19, 'valid/acc': 85.097, 'valid/acc_unbiased': 77.141, 'valid/diff': 29.622, 'valid/acc_skew': 88.738, 'valid/acc_align': 65.545, 'test/acc': 86.558, 'test/acc_unbiased': 79.297, 'test/diff': 26.404, 'test/acc_skew': 89.504, 'test/acc_align': 69.091}
[19 / 20] best valid accuracy: 79.274 at epoch 5 
 best_stats: {'best_valid_epoch': 5, 'best_valid_valid/acc': 84.171, 'best_valid_valid/acc_unbiased': 79.274, 'best_valid_valid/diff': 14.266, 'best_valid_valid/acc_skew': 86.407, 'best_valid_valid/acc_align': 72.141, 'best_valid_test/acc': 82.856, 'best_valid_test/acc_unbiased': 76.563, 'best_valid_test/diff': 17.33, 'best_valid_test/acc_skew': 85.228, 'best_valid_test/acc_align': 67.898}
[19 / 20] best test accuracy: 80.196 at epoch 9 
 best_stats: {'best_test_epoch': 9, 'best_test_valid/acc': 84.347, 'best_test_valid/acc_unbiased': 76.599, 'best_test_valid/diff': 27.95, 'best_test_valid/acc_skew': 87.874, 'best_test_valid/acc_align': 65.324, 'best_test_test/acc': 86.999, 'best_test_test/acc_unbiased': 80.196, 'best_test_test/diff': 21.953, 'best_test_test/acc_skew': 89.692, 'best_test_test/acc_align': 70.701}
[20 / 20] Learning rate: 1e-05 weight: 0.01
[20 / 20] Loss: 4.551983870170899 CE Loss: 0.21071789841347663 Con Loss: 4.54987668560115
[20 / 20] tensor([[0.923, 0.432],
        [0.874, 0.939]]) {'epoch': 20, 'valid/acc': 84.877, 'valid/acc_unbiased': 76.825, 'valid/diff': 30.565, 'valid/acc_skew': 88.636, 'valid/acc_align': 65.014, 'test/acc': 86.734, 'test/acc_unbiased': 79.205, 'test/diff': 27.801, 'test/acc_skew': 89.85, 'test/acc_align': 68.561}
[20 / 20] best valid accuracy: 79.274 at epoch 5 
 best_stats: {'best_valid_epoch': 5, 'best_valid_valid/acc': 84.171, 'best_valid_valid/acc_unbiased': 79.274, 'best_valid_valid/diff': 14.266, 'best_valid_valid/acc_skew': 86.407, 'best_valid_valid/acc_align': 72.141, 'best_valid_test/acc': 82.856, 'best_valid_test/acc_unbiased': 76.563, 'best_valid_test/diff': 17.33, 'best_valid_test/acc_skew': 85.228, 'best_valid_test/acc_align': 67.898}
[20 / 20] best test accuracy: 80.196 at epoch 9 
 best_stats: {'best_test_epoch': 9, 'best_test_valid/acc': 84.347, 'best_test_valid/acc_unbiased': 76.599, 'best_test_valid/diff': 27.95, 'best_test_valid/acc_skew': 87.874, 'best_test_valid/acc_align': 65.324, 'best_test_test/acc': 86.999, 'best_test_test/acc_unbiased': 80.196, 'best_test_test/diff': 21.953, 'best_test_test/acc_skew': 89.692, 'best_test_test/acc_align': 70.701}
Total training time: 1:10:19
