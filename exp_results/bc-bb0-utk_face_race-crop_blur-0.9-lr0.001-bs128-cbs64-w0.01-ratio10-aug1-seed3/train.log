Log level set to: INFO
Set seed: 3
=======> Using Fixed Random Seed: 3 <========
save_path: exp_results/bc-bb0-utk_face_race-crop_blur-0.9-lr0.001-bs128-cbs64-w0.01-ratio10-aug1-seed3
get_utk_face - split: train, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_race-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [4407, 552]
Target 1: [440, 5529]
Binary Target 1
---------------------------
Target 0: [4407, 552]
Target 1: [440, 5529]
===================================
Normal Label Distribution: 
Target 0: [4407, 552]
Target 1: [440, 5529]
===================================
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [4407, 552]
Target 1: [440, 5529]
Binary Target 1
---------------------------
Target 0: [4407, 552]
Target 1: [440, 5529]
===================================
Normal Label Distribution: 
Target 0: [4407, 552]
Target 1: [440, 5529]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 10928, target_attr: gender, bias_attr: race bias_rate: 0.9
['[train] target_0-bias_0: 4407', '[train] target_0-bias_1: 552', '[train] target_1-bias_0: 440', '[train] target_1-bias_1: 5529']
confusion_matrix - 
 original: tensor([[4407.,  440.],
        [ 552., 5529.]]), 
 normalized: tensor([[0.909, 0.091],
        [0.091, 0.909]]), 
 b|y: tensor([[0.889, 0.111],
        [0.074, 0.926]])
get_utk_face - split: train, aug: 1, given_y: True, ratio: 10
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_race-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [4407, 552]
Target 1: [440, 5529]
Binary Target 1
---------------------------
Target 0: [4407, 552]
Target 1: [440, 5529]
===================================
Normal Label Distribution: 
Target 0: [4407, 552]
Target 1: [440, 5529]
===================================
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [4407, 552]
Target 1: [440, 5529]
Binary Target 1
---------------------------
Target 0: [4407, 552]
Target 1: [440, 5529]
===================================
Normal Label Distribution: 
Target 0: [4407, 552]
Target 1: [440, 5529]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 10928, target_attr: gender, bias_attr: race bias_rate: 0.9
['[train] target_0-bias_0: 4407', '[train] target_0-bias_1: 552', '[train] target_1-bias_0: 440', '[train] target_1-bias_1: 5529']
get_utk_face - split: valid, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_race-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [583, 684]
Target 1: [457, 646]
Binary Target 1
---------------------------
Target 0: [583, 684]
Target 1: [457, 646]
===================================
Normal Label Distribution: 
Target 0: [583, 684]
Target 1: [457, 646]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 2370, target_attr: gender, bias_attr: race bias_rate: 0.9
['[valid] target_0-bias_0: 583', '[valid] target_0-bias_1: 684', '[valid] target_1-bias_0: 457', '[valid] target_1-bias_1: 646']
get_utk_face - split: test, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_race-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [558, 677]
Target 1: [462, 673]
Binary Target 1
---------------------------
Target 0: [558, 677]
Target 1: [462, 673]
===================================
Normal Label Distribution: 
Target 0: [558, 677]
Target 1: [462, 673]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 2370, target_attr: gender, bias_attr: race bias_rate: 0.9
['[test] target_0-bias_0: 558', '[test] target_0-bias_1: 677', '[test] target_1-bias_0: 462', '[test] target_1-bias_1: 673']
decay_epochs: [6, 13]
[1 / 20] Learning rate: 0.001 weight: 0.01
[1 / 20] Loss: 4.904646180908292 CE Loss: 0.5898412994025916 Con Loss: 4.898747765302309
[1 / 20] tensor([[0.713, 0.645],
        [0.829, 0.889]]) {'epoch': 1, 'valid/acc': 75.359, 'valid/acc_unbiased': 75.852, 'valid/diff': 2.543, 'valid/acc_skew': 74.581, 'valid/acc_align': 77.124, 'test/acc': 76.624, 'test/acc_unbiased': 76.908, 'test/diff': 6.366, 'test/acc_skew': 73.725, 'test/acc_align': 80.091}
[1 / 20] best valid accuracy: 75.852 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 75.359, 'best_valid_valid/acc_unbiased': 75.852, 'best_valid_valid/diff': 2.543, 'best_valid_valid/acc_skew': 74.581, 'best_valid_valid/acc_align': 77.124, 'best_valid_test/acc': 76.624, 'best_valid_test/acc_unbiased': 76.908, 'best_valid_test/diff': 6.366, 'best_valid_test/acc_skew': 73.725, 'best_valid_test/acc_align': 80.091}
[1 / 20] best test accuracy: 76.908 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 75.359, 'best_test_valid/acc_unbiased': 75.852, 'best_test_valid/diff': 2.543, 'best_test_valid/acc_skew': 74.581, 'best_test_valid/acc_align': 77.124, 'best_test_test/acc': 76.624, 'best_test_test/acc_unbiased': 76.908, 'best_test_test/diff': 6.366, 'best_test_test/acc_skew': 73.725, 'best_test_test/acc_align': 80.091}
[2 / 20] Learning rate: 0.001 weight: 0.01
[2 / 20] Loss: 4.779351145770853 CE Loss: 0.46861291232779295 Con Loss: 4.774664997530891
[2 / 20] tensor([[0.432, 0.405],
        [0.981, 0.970]]) {'epoch': 2, 'valid/acc': 67.932, 'valid/acc_unbiased': 69.805, 'valid/diff': 1.661, 'valid/acc_skew': 70.47, 'valid/acc_align': 69.14, 'test/acc': 68.397, 'test/acc_unbiased': 69.686, 'test/diff': 1.871, 'test/acc_skew': 69.262, 'test/acc_align': 70.109}
[2 / 20] best valid accuracy: 75.852 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 75.359, 'best_valid_valid/acc_unbiased': 75.852, 'best_valid_valid/diff': 2.543, 'best_valid_valid/acc_skew': 74.581, 'best_valid_valid/acc_align': 77.124, 'best_valid_test/acc': 76.624, 'best_valid_test/acc_unbiased': 76.908, 'best_valid_test/diff': 6.366, 'best_valid_test/acc_skew': 73.725, 'best_valid_test/acc_align': 80.091}
[2 / 20] best test accuracy: 76.908 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 75.359, 'best_test_valid/acc_unbiased': 75.852, 'best_test_valid/diff': 2.543, 'best_test_valid/acc_skew': 74.581, 'best_test_valid/acc_align': 77.124, 'best_test_test/acc': 76.624, 'best_test_test/acc_unbiased': 76.908, 'best_test_test/diff': 6.366, 'best_test_test/acc_skew': 73.725, 'best_test_test/acc_align': 80.091}
[3 / 20] Learning rate: 0.001 weight: 0.01
[3 / 20] Loss: 4.751575904918799 CE Loss: 0.46356457066047246 Con Loss: 4.746940260226695
[3 / 20] tensor([[0.622, 0.595],
        [0.931, 0.948]]) {'epoch': 3, 'valid/acc': 76.582, 'valid/acc_unbiased': 77.81, 'valid/diff': 0.676, 'valid/acc_skew': 78.039, 'valid/acc_align': 77.582, 'test/acc': 76.709, 'test/acc_unbiased': 77.397, 'test/diff': 2.192, 'test/acc_skew': 76.3, 'test/acc_align': 78.493}
[3 / 20] best valid accuracy: 77.810 at epoch 3 
 best_stats: {'best_valid_epoch': 3, 'best_valid_valid/acc': 76.582, 'best_valid_valid/acc_unbiased': 77.81, 'best_valid_valid/diff': 0.676, 'best_valid_valid/acc_skew': 78.039, 'best_valid_valid/acc_align': 77.582, 'best_valid_test/acc': 76.709, 'best_valid_test/acc_unbiased': 77.397, 'best_valid_test/diff': 2.192, 'best_valid_test/acc_skew': 76.3, 'best_valid_test/acc_align': 78.493}
[3 / 20] best test accuracy: 77.397 at epoch 3 
 best_stats: {'best_test_epoch': 3, 'best_test_valid/acc': 76.582, 'best_test_valid/acc_unbiased': 77.81, 'best_test_valid/diff': 0.676, 'best_test_valid/acc_skew': 78.039, 'best_test_valid/acc_align': 77.582, 'best_test_test/acc': 76.709, 'best_test_test/acc_unbiased': 77.397, 'best_test_test/diff': 2.192, 'best_test_test/acc_skew': 76.3, 'best_test_test/acc_align': 78.493}
[4 / 20] Learning rate: 0.001 weight: 0.01
[4 / 20] Loss: 4.745262171827682 CE Loss: 0.43481185984297344 Con Loss: 4.740914032015933
[4 / 20] tensor([[0.892, 0.842],
        [0.686, 0.774]]) {'epoch': 4, 'valid/acc': 80.802, 'valid/acc_unbiased': 80.316, 'valid/diff': 2.677, 'valid/acc_skew': 78.978, 'valid/acc_align': 81.654, 'test/acc': 80.422, 'test/acc_unbiased': 79.868, 'test/diff': 6.926, 'test/acc_skew': 76.405, 'test/acc_align': 83.331}
[4 / 20] best valid accuracy: 80.316 at epoch 4 
 best_stats: {'best_valid_epoch': 4, 'best_valid_valid/acc': 80.802, 'best_valid_valid/acc_unbiased': 80.316, 'best_valid_valid/diff': 2.677, 'best_valid_valid/acc_skew': 78.978, 'best_valid_valid/acc_align': 81.654, 'best_valid_test/acc': 80.422, 'best_valid_test/acc_unbiased': 79.868, 'best_valid_test/diff': 6.926, 'best_valid_test/acc_skew': 76.405, 'best_valid_test/acc_align': 83.331}
[4 / 20] best test accuracy: 79.868 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 80.802, 'best_test_valid/acc_unbiased': 80.316, 'best_test_valid/diff': 2.677, 'best_test_valid/acc_skew': 78.978, 'best_test_valid/acc_align': 81.654, 'best_test_test/acc': 80.422, 'best_test_test/acc_unbiased': 79.868, 'best_test_test/diff': 6.926, 'best_test_test/acc_skew': 76.405, 'best_test_test/acc_align': 83.331}
[5 / 20] Learning rate: 0.001 weight: 0.01
[5 / 20] Loss: 4.721557150124457 CE Loss: 0.4395598543161529 Con Loss: 4.717161534645896
[5 / 20] tensor([[0.600, 0.578],
        [0.952, 0.955]]) {'epoch': 5, 'valid/acc': 76.709, 'valid/acc_unbiased': 77.966, 'valid/diff': 1.897, 'valid/acc_skew': 78.914, 'valid/acc_align': 77.017, 'test/acc': 76.329, 'test/acc_unbiased': 77.143, 'test/diff': 1.293, 'test/acc_skew': 76.496, 'test/acc_align': 77.789}
[5 / 20] best valid accuracy: 80.316 at epoch 4 
 best_stats: {'best_valid_epoch': 4, 'best_valid_valid/acc': 80.802, 'best_valid_valid/acc_unbiased': 80.316, 'best_valid_valid/diff': 2.677, 'best_valid_valid/acc_skew': 78.978, 'best_valid_valid/acc_align': 81.654, 'best_valid_test/acc': 80.422, 'best_valid_test/acc_unbiased': 79.868, 'best_valid_test/diff': 6.926, 'best_valid_test/acc_skew': 76.405, 'best_valid_test/acc_align': 83.331}
[5 / 20] best test accuracy: 79.868 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 80.802, 'best_test_valid/acc_unbiased': 80.316, 'best_test_valid/diff': 2.677, 'best_test_valid/acc_skew': 78.978, 'best_test_valid/acc_align': 81.654, 'best_test_test/acc': 80.422, 'best_test_test/acc_unbiased': 79.868, 'best_test_test/diff': 6.926, 'best_test_test/acc_skew': 76.405, 'best_test_test/acc_align': 83.331}
[6 / 20] Learning rate: 0.001 weight: 0.01
[6 / 20] Loss: 4.7011044175523615 CE Loss: 0.4208040401055907 Con Loss: 4.696896393861114
[6 / 20] tensor([[0.694, 0.648],
        [0.931, 0.936]]) {'epoch': 6, 'valid/acc': 78.819, 'valid/acc_unbiased': 79.75, 'valid/diff': 0.821, 'valid/acc_skew': 80.16, 'valid/acc_align': 79.339, 'test/acc': 79.578, 'test/acc_unbiased': 80.221, 'test/diff': 2.524, 'test/acc_skew': 78.959, 'test/acc_align': 81.483}
[6 / 20] best valid accuracy: 80.316 at epoch 4 
 best_stats: {'best_valid_epoch': 4, 'best_valid_valid/acc': 80.802, 'best_valid_valid/acc_unbiased': 80.316, 'best_valid_valid/diff': 2.677, 'best_valid_valid/acc_skew': 78.978, 'best_valid_valid/acc_align': 81.654, 'best_valid_test/acc': 80.422, 'best_valid_test/acc_unbiased': 79.868, 'best_valid_test/diff': 6.926, 'best_valid_test/acc_skew': 76.405, 'best_valid_test/acc_align': 83.331}
[6 / 20] best test accuracy: 80.221 at epoch 6 
 best_stats: {'best_test_epoch': 6, 'best_test_valid/acc': 78.819, 'best_test_valid/acc_unbiased': 79.75, 'best_test_valid/diff': 0.821, 'best_test_valid/acc_skew': 80.16, 'best_test_valid/acc_align': 79.339, 'best_test_test/acc': 79.578, 'best_test_test/acc_unbiased': 80.221, 'best_test_test/diff': 2.524, 'best_test_test/acc_skew': 78.959, 'best_test_test/acc_align': 81.483}
[7 / 20] Learning rate: 0.0001 weight: 0.01
[7 / 20] Loss: 4.668556614815753 CE Loss: 0.3783853099426448 Con Loss: 4.6647727793167135
[7 / 20] tensor([[0.823, 0.774],
        [0.868, 0.884]]) {'epoch': 7, 'valid/acc': 83.671, 'valid/acc_unbiased': 83.859, 'valid/diff': 0.875, 'valid/acc_skew': 83.421, 'valid/acc_align': 84.297, 'test/acc': 83.502, 'test/acc_unbiased': 83.716, 'test/diff': 3.236, 'test/acc_skew': 82.098, 'test/acc_align': 85.334}
[7 / 20] best valid accuracy: 83.859 at epoch 7 
 best_stats: {'best_valid_epoch': 7, 'best_valid_valid/acc': 83.671, 'best_valid_valid/acc_unbiased': 83.859, 'best_valid_valid/diff': 0.875, 'best_valid_valid/acc_skew': 83.421, 'best_valid_valid/acc_align': 84.297, 'best_valid_test/acc': 83.502, 'best_valid_test/acc_unbiased': 83.716, 'best_valid_test/diff': 3.236, 'best_valid_test/acc_skew': 82.098, 'best_valid_test/acc_align': 85.334}
[7 / 20] best test accuracy: 83.716 at epoch 7 
 best_stats: {'best_test_epoch': 7, 'best_test_valid/acc': 83.671, 'best_test_valid/acc_unbiased': 83.859, 'best_test_valid/diff': 0.875, 'best_test_valid/acc_skew': 83.421, 'best_test_valid/acc_align': 84.297, 'best_test_test/acc': 83.502, 'best_test_test/acc_unbiased': 83.716, 'best_test_test/diff': 3.236, 'best_test_test/acc_skew': 82.098, 'best_test_test/acc_align': 85.334}
[8 / 20] Learning rate: 0.0001 weight: 0.01
[8 / 20] Loss: 4.622813302985397 CE Loss: 0.3620029765987117 Con Loss: 4.61919327047524
[8 / 20] tensor([[0.814, 0.765],
        [0.877, 0.900]]) {'epoch': 8, 'valid/acc': 84.177, 'valid/acc_unbiased': 84.457, 'valid/diff': 2.002, 'valid/acc_skew': 83.456, 'valid/acc_align': 85.458, 'test/acc': 83.671, 'test/acc_unbiased': 83.896, 'test/diff': 3.615, 'test/acc_skew': 82.088, 'test/acc_align': 85.703}
[8 / 20] best valid accuracy: 84.457 at epoch 8 
 best_stats: {'best_valid_epoch': 8, 'best_valid_valid/acc': 84.177, 'best_valid_valid/acc_unbiased': 84.457, 'best_valid_valid/diff': 2.002, 'best_valid_valid/acc_skew': 83.456, 'best_valid_valid/acc_align': 85.458, 'best_valid_test/acc': 83.671, 'best_valid_test/acc_unbiased': 83.896, 'best_valid_test/diff': 3.615, 'best_valid_test/acc_skew': 82.088, 'best_valid_test/acc_align': 85.703}
[8 / 20] best test accuracy: 83.896 at epoch 8 
 best_stats: {'best_test_epoch': 8, 'best_test_valid/acc': 84.177, 'best_test_valid/acc_unbiased': 84.457, 'best_test_valid/diff': 2.002, 'best_test_valid/acc_skew': 83.456, 'best_test_valid/acc_align': 85.458, 'best_test_test/acc': 83.671, 'best_test_test/acc_unbiased': 83.896, 'best_test_test/diff': 3.615, 'best_test_test/acc_skew': 82.088, 'best_test_test/acc_align': 85.703}
[9 / 20] Learning rate: 0.0001 weight: 0.01
[9 / 20] Loss: 4.618939230068536 CE Loss: 0.3475736460783471 Con Loss: 4.615463485829477
[9 / 20] tensor([[0.803, 0.733],
        [0.883, 0.905]]) {'epoch': 9, 'valid/acc': 84.937, 'valid/acc_unbiased': 85.262, 'valid/diff': 2.592, 'valid/acc_skew': 83.966, 'valid/acc_align': 86.558, 'test/acc': 82.743, 'test/acc_unbiased': 83.088, 'test/diff': 4.6, 'test/acc_skew': 80.788, 'test/acc_align': 85.389}
[9 / 20] best valid accuracy: 85.262 at epoch 9 
 best_stats: {'best_valid_epoch': 9, 'best_valid_valid/acc': 84.937, 'best_valid_valid/acc_unbiased': 85.262, 'best_valid_valid/diff': 2.592, 'best_valid_valid/acc_skew': 83.966, 'best_valid_valid/acc_align': 86.558, 'best_valid_test/acc': 82.743, 'best_valid_test/acc_unbiased': 83.088, 'best_valid_test/diff': 4.6, 'best_valid_test/acc_skew': 80.788, 'best_valid_test/acc_align': 85.389}
[9 / 20] best test accuracy: 83.896 at epoch 8 
 best_stats: {'best_test_epoch': 8, 'best_test_valid/acc': 84.177, 'best_test_valid/acc_unbiased': 84.457, 'best_test_valid/diff': 2.002, 'best_test_valid/acc_skew': 83.456, 'best_test_valid/acc_align': 85.458, 'best_test_test/acc': 83.671, 'best_test_test/acc_unbiased': 83.896, 'best_test_test/diff': 3.615, 'best_test_test/acc_skew': 82.088, 'best_test_test/acc_align': 85.703}
[10 / 20] Learning rate: 0.0001 weight: 0.01
[10 / 20] Loss: 4.607319013615129 CE Loss: 0.340669156648055 Con Loss: 4.603912326287735
[10 / 20] tensor([[0.826, 0.752],
        [0.870, 0.889]]) {'epoch': 10, 'valid/acc': 84.219, 'valid/acc_unbiased': 84.494, 'valid/diff': 3.317, 'valid/acc_skew': 82.836, 'valid/acc_align': 86.152, 'test/acc': 83.122, 'test/acc_unbiased': 83.417, 'test/diff': 4.637, 'test/acc_skew': 81.099, 'test/acc_align': 85.736}
[10 / 20] best valid accuracy: 85.262 at epoch 9 
 best_stats: {'best_valid_epoch': 9, 'best_valid_valid/acc': 84.937, 'best_valid_valid/acc_unbiased': 85.262, 'best_valid_valid/diff': 2.592, 'best_valid_valid/acc_skew': 83.966, 'best_valid_valid/acc_align': 86.558, 'best_valid_test/acc': 82.743, 'best_valid_test/acc_unbiased': 83.088, 'best_valid_test/diff': 4.6, 'best_valid_test/acc_skew': 80.788, 'best_valid_test/acc_align': 85.389}
[10 / 20] best test accuracy: 83.896 at epoch 8 
 best_stats: {'best_test_epoch': 8, 'best_test_valid/acc': 84.177, 'best_test_valid/acc_unbiased': 84.457, 'best_test_valid/diff': 2.002, 'best_test_valid/acc_skew': 83.456, 'best_test_valid/acc_align': 85.458, 'best_test_test/acc': 83.671, 'best_test_test/acc_unbiased': 83.896, 'best_test_test/diff': 3.615, 'best_test_test/acc_skew': 82.088, 'best_test_test/acc_align': 85.703}
[11 / 20] Learning rate: 0.0001 weight: 0.01
[11 / 20] Loss: 4.588805073700398 CE Loss: 0.3392463155843503 Con Loss: 4.585412595142906
[11 / 20] tensor([[0.817, 0.771],
        [0.864, 0.896]]) {'epoch': 11, 'valid/acc': 84.641, 'valid/acc_unbiased': 84.877, 'valid/diff': 3.79, 'valid/acc_skew': 82.982, 'valid/acc_align': 86.771, 'test/acc': 83.544, 'test/acc_unbiased': 83.697, 'test/diff': 3.925, 'test/acc_skew': 81.734, 'test/acc_align': 85.66}
[11 / 20] best valid accuracy: 85.262 at epoch 9 
 best_stats: {'best_valid_epoch': 9, 'best_valid_valid/acc': 84.937, 'best_valid_valid/acc_unbiased': 85.262, 'best_valid_valid/diff': 2.592, 'best_valid_valid/acc_skew': 83.966, 'best_valid_valid/acc_align': 86.558, 'best_valid_test/acc': 82.743, 'best_valid_test/acc_unbiased': 83.088, 'best_valid_test/diff': 4.6, 'best_valid_test/acc_skew': 80.788, 'best_valid_test/acc_align': 85.389}
[11 / 20] best test accuracy: 83.896 at epoch 8 
 best_stats: {'best_test_epoch': 8, 'best_test_valid/acc': 84.177, 'best_test_valid/acc_unbiased': 84.457, 'best_test_valid/diff': 2.002, 'best_test_valid/acc_skew': 83.456, 'best_test_valid/acc_align': 85.458, 'best_test_test/acc': 83.671, 'best_test_test/acc_unbiased': 83.896, 'best_test_test/diff': 3.615, 'best_test_test/acc_skew': 82.088, 'best_test_test/acc_align': 85.703}
[12 / 20] Learning rate: 0.0001 weight: 0.01
[12 / 20] Loss: 4.593373987021942 CE Loss: 0.3387092368058195 Con Loss: 4.589986886321888
[12 / 20] tensor([[0.808, 0.753],
        [0.874, 0.908]]) {'epoch': 12, 'valid/acc': 84.81, 'valid/acc_unbiased': 85.151, 'valid/diff': 2.881, 'valid/acc_skew': 83.711, 'valid/acc_align': 86.591, 'test/acc': 83.376, 'test/acc_unbiased': 83.598, 'test/diff': 4.417, 'test/acc_skew': 81.389, 'test/acc_align': 85.806}
[12 / 20] best valid accuracy: 85.262 at epoch 9 
 best_stats: {'best_valid_epoch': 9, 'best_valid_valid/acc': 84.937, 'best_valid_valid/acc_unbiased': 85.262, 'best_valid_valid/diff': 2.592, 'best_valid_valid/acc_skew': 83.966, 'best_valid_valid/acc_align': 86.558, 'best_valid_test/acc': 82.743, 'best_valid_test/acc_unbiased': 83.088, 'best_valid_test/diff': 4.6, 'best_valid_test/acc_skew': 80.788, 'best_valid_test/acc_align': 85.389}
[12 / 20] best test accuracy: 83.896 at epoch 8 
 best_stats: {'best_test_epoch': 8, 'best_test_valid/acc': 84.177, 'best_test_valid/acc_unbiased': 84.457, 'best_test_valid/diff': 2.002, 'best_test_valid/acc_skew': 83.456, 'best_test_valid/acc_align': 85.458, 'best_test_test/acc': 83.671, 'best_test_test/acc_unbiased': 83.896, 'best_test_test/diff': 3.615, 'best_test_test/acc_skew': 82.088, 'best_test_test/acc_align': 85.703}
[13 / 20] Learning rate: 0.0001 weight: 0.01
[13 / 20] Loss: 4.566576208586574 CE Loss: 0.3276874705341864 Con Loss: 4.563299308933241
[13 / 20] tensor([[0.851, 0.809],
        [0.829, 0.880]]) {'epoch': 13, 'valid/acc': 85.359, 'valid/acc_unbiased': 85.475, 'valid/diff': 2.79, 'valid/acc_skew': 84.08, 'valid/acc_align': 86.87, 'test/acc': 84.304, 'test/acc_unbiased': 84.234, 'test/diff': 4.622, 'test/acc_skew': 81.923, 'test/acc_align': 86.545}
[13 / 20] best valid accuracy: 85.475 at epoch 13 
 best_stats: {'best_valid_epoch': 13, 'best_valid_valid/acc': 85.359, 'best_valid_valid/acc_unbiased': 85.475, 'best_valid_valid/diff': 2.79, 'best_valid_valid/acc_skew': 84.08, 'best_valid_valid/acc_align': 86.87, 'best_valid_test/acc': 84.304, 'best_valid_test/acc_unbiased': 84.234, 'best_valid_test/diff': 4.622, 'best_valid_test/acc_skew': 81.923, 'best_valid_test/acc_align': 86.545}
[13 / 20] best test accuracy: 84.234 at epoch 13 
 best_stats: {'best_test_epoch': 13, 'best_test_valid/acc': 85.359, 'best_test_valid/acc_unbiased': 85.475, 'best_test_valid/diff': 2.79, 'best_test_valid/acc_skew': 84.08, 'best_test_valid/acc_align': 86.87, 'best_test_test/acc': 84.304, 'best_test_test/acc_unbiased': 84.234, 'best_test_test/diff': 4.622, 'best_test_test/acc_skew': 81.923, 'best_test_test/acc_align': 86.545}
[14 / 20] Learning rate: 1e-05 weight: 0.01
[14 / 20] Loss: 4.5462238729261895 CE Loss: 0.3286406808855942 Con Loss: 4.542937467248339
[14 / 20] tensor([[0.839, 0.784],
        [0.853, 0.893]]) {'epoch': 14, 'valid/acc': 85.316, 'valid/acc_unbiased': 85.547, 'valid/diff': 2.135, 'valid/acc_skew': 84.48, 'valid/acc_align': 86.614, 'test/acc': 84.135, 'test/acc_unbiased': 84.222, 'test/diff': 4.728, 'test/acc_skew': 81.858, 'test/acc_align': 86.586}
[14 / 20] best valid accuracy: 85.547 at epoch 14 
 best_stats: {'best_valid_epoch': 14, 'best_valid_valid/acc': 85.316, 'best_valid_valid/acc_unbiased': 85.547, 'best_valid_valid/diff': 2.135, 'best_valid_valid/acc_skew': 84.48, 'best_valid_valid/acc_align': 86.614, 'best_valid_test/acc': 84.135, 'best_valid_test/acc_unbiased': 84.222, 'best_valid_test/diff': 4.728, 'best_valid_test/acc_skew': 81.858, 'best_valid_test/acc_align': 86.586}
[14 / 20] best test accuracy: 84.234 at epoch 13 
 best_stats: {'best_test_epoch': 13, 'best_test_valid/acc': 85.359, 'best_test_valid/acc_unbiased': 85.475, 'best_test_valid/diff': 2.79, 'best_test_valid/acc_skew': 84.08, 'best_test_valid/acc_align': 86.87, 'best_test_test/acc': 84.304, 'best_test_test/acc_unbiased': 84.234, 'best_test_test/diff': 4.622, 'best_test_test/acc_skew': 81.923, 'best_test_test/acc_align': 86.545}
[15 / 20] Learning rate: 1e-05 weight: 0.01
[15 / 20] Loss: 4.55799662211629 CE Loss: 0.3291234926021989 Con Loss: 4.554705405479643
[15 / 20] tensor([[0.824, 0.770],
        [0.872, 0.902]]) {'epoch': 15, 'valid/acc': 85.359, 'valid/acc_unbiased': 85.616, 'valid/diff': 2.859, 'valid/acc_skew': 84.187, 'valid/acc_align': 87.045, 'test/acc': 84.008, 'test/acc_unbiased': 84.204, 'test/diff': 4.222, 'test/acc_skew': 82.093, 'test/acc_align': 86.315}
[15 / 20] best valid accuracy: 85.616 at epoch 15 
 best_stats: {'best_valid_epoch': 15, 'best_valid_valid/acc': 85.359, 'best_valid_valid/acc_unbiased': 85.616, 'best_valid_valid/diff': 2.859, 'best_valid_valid/acc_skew': 84.187, 'best_valid_valid/acc_align': 87.045, 'best_valid_test/acc': 84.008, 'best_valid_test/acc_unbiased': 84.204, 'best_valid_test/diff': 4.222, 'best_valid_test/acc_skew': 82.093, 'best_valid_test/acc_align': 86.315}
[15 / 20] best test accuracy: 84.234 at epoch 13 
 best_stats: {'best_test_epoch': 13, 'best_test_valid/acc': 85.359, 'best_test_valid/acc_unbiased': 85.475, 'best_test_valid/diff': 2.79, 'best_test_valid/acc_skew': 84.08, 'best_test_valid/acc_align': 86.87, 'best_test_test/acc': 84.304, 'best_test_test/acc_unbiased': 84.234, 'best_test_test/diff': 4.622, 'best_test_test/acc_skew': 81.923, 'best_test_test/acc_align': 86.545}
[16 / 20] Learning rate: 1e-05 weight: 0.01
[16 / 20] Loss: 4.542068765592784 CE Loss: 0.32262244982042215 Con Loss: 4.53884254472322
[16 / 20] tensor([[0.821, 0.771],
        [0.870, 0.902]]) {'epoch': 16, 'valid/acc': 85.57, 'valid/acc_unbiased': 85.87, 'valid/diff': 3.296, 'valid/acc_skew': 84.223, 'valid/acc_align': 87.518, 'test/acc': 83.924, 'test/acc_unbiased': 84.097, 'test/diff': 4.077, 'test/acc_skew': 82.059, 'test/acc_align': 86.136}
[16 / 20] best valid accuracy: 85.870 at epoch 16 
 best_stats: {'best_valid_epoch': 16, 'best_valid_valid/acc': 85.57, 'best_valid_valid/acc_unbiased': 85.87, 'best_valid_valid/diff': 3.296, 'best_valid_valid/acc_skew': 84.223, 'best_valid_valid/acc_align': 87.518, 'best_valid_test/acc': 83.924, 'best_valid_test/acc_unbiased': 84.097, 'best_valid_test/diff': 4.077, 'best_valid_test/acc_skew': 82.059, 'best_valid_test/acc_align': 86.136}
[16 / 20] best test accuracy: 84.234 at epoch 13 
 best_stats: {'best_test_epoch': 13, 'best_test_valid/acc': 85.359, 'best_test_valid/acc_unbiased': 85.475, 'best_test_valid/diff': 2.79, 'best_test_valid/acc_skew': 84.08, 'best_test_valid/acc_align': 86.87, 'best_test_test/acc': 84.304, 'best_test_test/acc_unbiased': 84.234, 'best_test_test/diff': 4.622, 'best_test_test/acc_skew': 81.923, 'best_test_test/acc_align': 86.545}
[17 / 20] Learning rate: 1e-05 weight: 0.01
[17 / 20] Loss: 4.5513857824736075 CE Loss: 0.31735521733848104 Con Loss: 4.548212232910871
[17 / 20] tensor([[0.823, 0.768],
        [0.866, 0.905]]) {'epoch': 17, 'valid/acc': 85.443, 'valid/acc_unbiased': 85.774, 'valid/diff': 3.25, 'valid/acc_skew': 84.149, 'valid/acc_align': 87.399, 'test/acc': 83.882, 'test/acc_unbiased': 84.034, 'test/diff': 4.679, 'test/acc_skew': 81.695, 'test/acc_align': 86.374}
[17 / 20] best valid accuracy: 85.870 at epoch 16 
 best_stats: {'best_valid_epoch': 16, 'best_valid_valid/acc': 85.57, 'best_valid_valid/acc_unbiased': 85.87, 'best_valid_valid/diff': 3.296, 'best_valid_valid/acc_skew': 84.223, 'best_valid_valid/acc_align': 87.518, 'best_valid_test/acc': 83.924, 'best_valid_test/acc_unbiased': 84.097, 'best_valid_test/diff': 4.077, 'best_valid_test/acc_skew': 82.059, 'best_valid_test/acc_align': 86.136}
[17 / 20] best test accuracy: 84.234 at epoch 13 
 best_stats: {'best_test_epoch': 13, 'best_test_valid/acc': 85.359, 'best_test_valid/acc_unbiased': 85.475, 'best_test_valid/diff': 2.79, 'best_test_valid/acc_skew': 84.08, 'best_test_valid/acc_align': 86.87, 'best_test_test/acc': 84.304, 'best_test_test/acc_unbiased': 84.234, 'best_test_test/diff': 4.622, 'best_test_test/acc_skew': 81.923, 'best_test_test/acc_align': 86.545}
[18 / 20] Learning rate: 1e-05 weight: 0.01
[18 / 20] Loss: 4.556100766445847 CE Loss: 0.3268411702764156 Con Loss: 4.552832366083237
[18 / 20] tensor([[0.832, 0.777],
        [0.857, 0.900]]) {'epoch': 18, 'valid/acc': 85.527, 'valid/acc_unbiased': 85.758, 'valid/diff': 3.726, 'valid/acc_skew': 83.895, 'valid/acc_align': 87.621, 'test/acc': 84.051, 'test/acc_unbiased': 84.152, 'test/diff': 4.894, 'test/acc_skew': 81.705, 'test/acc_align': 86.599}
[18 / 20] best valid accuracy: 85.870 at epoch 16 
 best_stats: {'best_valid_epoch': 16, 'best_valid_valid/acc': 85.57, 'best_valid_valid/acc_unbiased': 85.87, 'best_valid_valid/diff': 3.296, 'best_valid_valid/acc_skew': 84.223, 'best_valid_valid/acc_align': 87.518, 'best_valid_test/acc': 83.924, 'best_valid_test/acc_unbiased': 84.097, 'best_valid_test/diff': 4.077, 'best_valid_test/acc_skew': 82.059, 'best_valid_test/acc_align': 86.136}
[18 / 20] best test accuracy: 84.234 at epoch 13 
 best_stats: {'best_test_epoch': 13, 'best_test_valid/acc': 85.359, 'best_test_valid/acc_unbiased': 85.475, 'best_test_valid/diff': 2.79, 'best_test_valid/acc_skew': 84.08, 'best_test_valid/acc_align': 86.87, 'best_test_test/acc': 84.304, 'best_test_test/acc_unbiased': 84.234, 'best_test_test/diff': 4.622, 'best_test_test/acc_skew': 81.923, 'best_test_test/acc_align': 86.545}
[19 / 20] Learning rate: 1e-05 weight: 0.01
[19 / 20] Loss: 4.549317568671476 CE Loss: 0.31554078663076174 Con Loss: 4.546162128448486
[19 / 20] tensor([[0.826, 0.777],
        [0.864, 0.906]]) {'epoch': 19, 'valid/acc': 85.612, 'valid/acc_unbiased': 85.867, 'valid/diff': 3.507, 'valid/acc_skew': 84.114, 'valid/acc_align': 87.621, 'test/acc': 84.219, 'test/acc_unbiased': 84.329, 'test/diff': 4.598, 'test/acc_skew': 82.03, 'test/acc_align': 86.628}
[19 / 20] best valid accuracy: 85.870 at epoch 16 
 best_stats: {'best_valid_epoch': 16, 'best_valid_valid/acc': 85.57, 'best_valid_valid/acc_unbiased': 85.87, 'best_valid_valid/diff': 3.296, 'best_valid_valid/acc_skew': 84.223, 'best_valid_valid/acc_align': 87.518, 'best_valid_test/acc': 83.924, 'best_valid_test/acc_unbiased': 84.097, 'best_valid_test/diff': 4.077, 'best_valid_test/acc_skew': 82.059, 'best_valid_test/acc_align': 86.136}
[19 / 20] best test accuracy: 84.329 at epoch 19 
 best_stats: {'best_test_epoch': 19, 'best_test_valid/acc': 85.612, 'best_test_valid/acc_unbiased': 85.867, 'best_test_valid/diff': 3.507, 'best_test_valid/acc_skew': 84.114, 'best_test_valid/acc_align': 87.621, 'best_test_test/acc': 84.219, 'best_test_test/acc_unbiased': 84.329, 'best_test_test/diff': 4.598, 'best_test_test/acc_skew': 82.03, 'best_test_test/acc_align': 86.628}
[20 / 20] Learning rate: 1e-05 weight: 0.01
[20 / 20] Loss: 4.543252064577832 CE Loss: 0.3116854053116124 Con Loss: 4.540135222333068
[20 / 20] tensor([[0.828, 0.775],
        [0.861, 0.903]]) {'epoch': 20, 'valid/acc': 85.57, 'valid/acc_unbiased': 85.814, 'valid/diff': 3.474, 'valid/acc_skew': 84.077, 'valid/acc_align': 87.552, 'test/acc': 84.093, 'test/acc_unbiased': 84.208, 'test/diff': 4.721, 'test/acc_skew': 81.848, 'test/acc_align': 86.569}
[20 / 20] best valid accuracy: 85.870 at epoch 16 
 best_stats: {'best_valid_epoch': 16, 'best_valid_valid/acc': 85.57, 'best_valid_valid/acc_unbiased': 85.87, 'best_valid_valid/diff': 3.296, 'best_valid_valid/acc_skew': 84.223, 'best_valid_valid/acc_align': 87.518, 'best_valid_test/acc': 83.924, 'best_valid_test/acc_unbiased': 84.097, 'best_valid_test/diff': 4.077, 'best_valid_test/acc_skew': 82.059, 'best_valid_test/acc_align': 86.136}
[20 / 20] best test accuracy: 84.329 at epoch 19 
 best_stats: {'best_test_epoch': 19, 'best_test_valid/acc': 85.612, 'best_test_valid/acc_unbiased': 85.867, 'best_test_valid/diff': 3.507, 'best_test_valid/acc_skew': 84.114, 'best_test_valid/acc_align': 87.621, 'best_test_test/acc': 84.219, 'best_test_test/acc_unbiased': 84.329, 'best_test_test/diff': 4.598, 'best_test_test/acc_skew': 82.03, 'best_test_test/acc_align': 86.628}
Total training time: 0:16:52
