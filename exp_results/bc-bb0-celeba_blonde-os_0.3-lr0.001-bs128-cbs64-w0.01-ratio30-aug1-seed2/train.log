Log level set to: INFO
Set seed: 2
=======> Using Fixed Random Seed: 2 <========
save_path: exp_results/bc-bb0-celeba_blonde-os_0.3-lr0.001-bs128-cbs64-w0.01-ratio30-aug1-seed2
get_celeba - split:train, aug: False, given_y: True, ratio: 0
use existing blonde indices from data/celeba/pickles/blonde
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [16066, 16066]
Target 1: [16066, 16066]
Binary Target 1
---------------------------
Target 0: [16066, 16066]
Target 1: [16066, 16066]
===================================
Normal Label Distribution: 
Target 0: [16066, 16066]
Target 1: [16066, 16066]
===================================
Use BiasedCelebASplit 
 target_attr: blonde split: train 
 tensor([[16066., 16066.],
        [16066., 16066.]])
get_celeba - split:train, aug: 1, given_y: True, ratio: 30
use existing blonde indices from data/celeba/pickles/blonde
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [16042, 16042]
Target 1: [16042, 16042]
Binary Target 1
---------------------------
Target 0: [16042, 16042]
Target 1: [16042, 16042]
===================================
Normal Label Distribution: 
Target 0: [16042, 16042]
Target 1: [16042, 16042]
===================================
Use BiasedCelebASplit 
 target_attr: blonde split: train 
 tensor([[16042., 16042.],
        [16042., 16042.]])
get_celeba - split:train_valid, aug: False, given_y: True, ratio: 0
use existing blonde indices from data/celeba/pickles/blonde
Use BiasedCelebASplit 
 target_attr: blonde split: train_valid 
 tensor([[  403.,  4597.],
        [13344.,   285.]])
get_celeba - split:valid, aug: False, given_y: True, ratio: 0
Use BiasedCelebASplit 
 target_attr: blonde split: valid 
 tensor([[8535., 2874.],
        [8276.,  182.]])
decay_epochs: [3, 6]
[1 / 10] Learning rate: 0.001 weight: 0.01
[1 / 10] Loss: 4.647904421997355 CE Loss: 0.26742882634918047 Con Loss: 4.645230127422685
[1 / 10] tensor([[0.917, 0.963],
        [0.879, 0.830]]) {'epoch': 1, 'valid/acc': 93.392, 'valid/acc_unbiased': 89.377, 'valid/diff': 4.354, 'valid/acc_skew': 91.554, 'valid/acc_align': 87.2, 'test/acc': 92.978, 'test/acc_unbiased': 89.705, 'test/diff': 4.726, 'test/acc_skew': 89.787, 'test/acc_align': 89.623}
[1 / 10] best valid accuracy: 89.377 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 93.392, 'best_valid_valid/acc_unbiased': 89.377, 'best_valid_valid/diff': 4.354, 'best_valid_valid/acc_skew': 91.554, 'best_valid_valid/acc_align': 87.2, 'best_valid_test/acc': 92.978, 'best_valid_test/acc_unbiased': 89.705, 'best_valid_test/diff': 4.726, 'best_valid_test/acc_skew': 89.787, 'best_valid_test/acc_align': 89.623}
[1 / 10] best test accuracy: 89.705 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 93.392, 'best_test_valid/acc_unbiased': 89.377, 'best_test_valid/diff': 4.354, 'best_test_valid/acc_skew': 91.554, 'best_test_valid/acc_align': 87.2, 'best_test_test/acc': 92.978, 'best_test_test/acc_unbiased': 89.705, 'best_test_test/diff': 4.726, 'best_test_test/acc_skew': 89.787, 'best_test_test/acc_align': 89.623}
[2 / 10] Learning rate: 0.001 weight: 0.01
[2 / 10] Loss: 4.597929052319427 CE Loss: 0.2340103439772454 Con Loss: 4.595588949776432
[2 / 10] tensor([[0.897, 0.950],
        [0.915, 0.857]]) {'epoch': 2, 'valid/acc': 93.338, 'valid/acc_unbiased': 91.131, 'valid/diff': 3.926, 'valid/acc_skew': 93.094, 'valid/acc_align': 89.168, 'test/acc': 92.153, 'test/acc_unbiased': 90.493, 'test/diff': 5.558, 'test/acc_skew': 90.612, 'test/acc_align': 90.374}
[2 / 10] best valid accuracy: 91.131 at epoch 2 
 best_stats: {'best_valid_epoch': 2, 'best_valid_valid/acc': 93.338, 'best_valid_valid/acc_unbiased': 91.131, 'best_valid_valid/diff': 3.926, 'best_valid_valid/acc_skew': 93.094, 'best_valid_valid/acc_align': 89.168, 'best_valid_test/acc': 92.153, 'best_valid_test/acc_unbiased': 90.493, 'best_valid_test/diff': 5.558, 'best_valid_test/acc_skew': 90.612, 'best_valid_test/acc_align': 90.374}
[2 / 10] best test accuracy: 90.493 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 93.338, 'best_test_valid/acc_unbiased': 91.131, 'best_test_valid/diff': 3.926, 'best_test_valid/acc_skew': 93.094, 'best_test_valid/acc_align': 89.168, 'best_test_test/acc': 92.153, 'best_test_test/acc_unbiased': 90.493, 'best_test_test/diff': 5.558, 'best_test_test/acc_skew': 90.612, 'best_test_test/acc_align': 90.374}
[3 / 10] Learning rate: 0.001 weight: 0.01
[3 / 10] Loss: 4.575190116025643 CE Loss: 0.2202176403879867 Con Loss: 4.572987943245883
[3 / 10] tensor([[0.902, 0.948],
        [0.921, 0.868]]) {'epoch': 3, 'valid/acc': 93.295, 'valid/acc_unbiased': 92.447, 'valid/diff': 0.698, 'valid/acc_skew': 92.796, 'valid/acc_align': 92.098, 'test/acc': 92.339, 'test/acc_unbiased': 90.966, 'test/diff': 4.926, 'test/acc_skew': 91.147, 'test/acc_align': 90.785}
[3 / 10] best valid accuracy: 92.447 at epoch 3 
 best_stats: {'best_valid_epoch': 3, 'best_valid_valid/acc': 93.295, 'best_valid_valid/acc_unbiased': 92.447, 'best_valid_valid/diff': 0.698, 'best_valid_valid/acc_skew': 92.796, 'best_valid_valid/acc_align': 92.098, 'best_valid_test/acc': 92.339, 'best_valid_test/acc_unbiased': 90.966, 'best_valid_test/diff': 4.926, 'best_valid_test/acc_skew': 91.147, 'best_valid_test/acc_align': 90.785}
[3 / 10] best test accuracy: 90.966 at epoch 3 
 best_stats: {'best_test_epoch': 3, 'best_test_valid/acc': 93.295, 'best_test_valid/acc_unbiased': 92.447, 'best_test_valid/diff': 0.698, 'best_test_valid/acc_skew': 92.796, 'best_test_valid/acc_align': 92.098, 'best_test_test/acc': 92.339, 'best_test_test/acc_unbiased': 90.966, 'best_test_test/diff': 4.926, 'best_test_test/acc_skew': 91.147, 'best_test_test/acc_align': 90.785}
[4 / 10] Learning rate: 0.0001 weight: 0.01
[4 / 10] Loss: 4.509447283515089 CE Loss: 0.17707495512268054 Con Loss: 4.507676531009206
[4 / 10] tensor([[0.853, 0.933],
        [0.963, 0.923]]) {'epoch': 4, 'valid/acc': 93.784, 'valid/acc_unbiased': 94.286, 'valid/diff': 1.679, 'valid/acc_skew': 95.125, 'valid/acc_align': 93.447, 'test/acc': 90.306, 'test/acc_unbiased': 91.82, 'test/diff': 6.013, 'test/acc_skew': 90.833, 'test/acc_align': 92.807}
[4 / 10] best valid accuracy: 94.286 at epoch 4 
 best_stats: {'best_valid_epoch': 4, 'best_valid_valid/acc': 93.784, 'best_valid_valid/acc_unbiased': 94.286, 'best_valid_valid/diff': 1.679, 'best_valid_valid/acc_skew': 95.125, 'best_valid_valid/acc_align': 93.447, 'best_valid_test/acc': 90.306, 'best_valid_test/acc_unbiased': 91.82, 'best_valid_test/diff': 6.013, 'best_valid_test/acc_skew': 90.833, 'best_valid_test/acc_align': 92.807}
[4 / 10] best test accuracy: 91.820 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 93.784, 'best_test_valid/acc_unbiased': 94.286, 'best_test_valid/diff': 1.679, 'best_test_valid/acc_skew': 95.125, 'best_test_valid/acc_align': 93.447, 'best_test_test/acc': 90.306, 'best_test_test/acc_unbiased': 91.82, 'best_test_test/diff': 6.013, 'best_test_test/acc_skew': 90.833, 'best_test_test/acc_align': 92.807}
[5 / 10] Learning rate: 0.0001 weight: 0.01
[5 / 10] Loss: 4.4876847899926195 CE Loss: 0.16365711835103908 Con Loss: 4.48604821167505
[5 / 10] tensor([[0.860, 0.943],
        [0.962, 0.912]]) {'epoch': 5, 'valid/acc': 94.423, 'valid/acc_unbiased': 94.36, 'valid/diff': 2.241, 'valid/acc_skew': 95.48, 'valid/acc_align': 93.239, 'test/acc': 90.975, 'test/acc_unbiased': 91.919, 'test/diff': 6.607, 'test/acc_skew': 91.097, 'test/acc_align': 92.741}
[5 / 10] best valid accuracy: 94.360 at epoch 5 
 best_stats: {'best_valid_epoch': 5, 'best_valid_valid/acc': 94.423, 'best_valid_valid/acc_unbiased': 94.36, 'best_valid_valid/diff': 2.241, 'best_valid_valid/acc_skew': 95.48, 'best_valid_valid/acc_align': 93.239, 'best_valid_test/acc': 90.975, 'best_valid_test/acc_unbiased': 91.919, 'best_valid_test/diff': 6.607, 'best_valid_test/acc_skew': 91.097, 'best_valid_test/acc_align': 92.741}
[5 / 10] best test accuracy: 91.919 at epoch 5 
 best_stats: {'best_test_epoch': 5, 'best_test_valid/acc': 94.423, 'best_test_valid/acc_unbiased': 94.36, 'best_test_valid/diff': 2.241, 'best_test_valid/acc_skew': 95.48, 'best_test_valid/acc_align': 93.239, 'best_test_test/acc': 90.975, 'best_test_test/acc_unbiased': 91.919, 'best_test_test/diff': 6.607, 'best_test_test/acc_skew': 91.097, 'best_test_test/acc_align': 92.741}
[6 / 10] Learning rate: 0.0001 weight: 0.01
[6 / 10] Loss: 4.467354091303324 CE Loss: 0.15614516785644023 Con Loss: 4.465792643716709
[6 / 10] tensor([[0.861, 0.933],
        [0.963, 0.940]]) {'epoch': 6, 'valid/acc': 93.784, 'valid/acc_unbiased': 94.905, 'valid/diff': 1.529, 'valid/acc_skew': 95.67, 'valid/acc_align': 94.141, 'test/acc': 90.663, 'test/acc_unbiased': 92.42, 'test/diff': 4.744, 'test/acc_skew': 91.208, 'test/acc_align': 93.631}
[6 / 10] best valid accuracy: 94.905 at epoch 6 
 best_stats: {'best_valid_epoch': 6, 'best_valid_valid/acc': 93.784, 'best_valid_valid/acc_unbiased': 94.905, 'best_valid_valid/diff': 1.529, 'best_valid_valid/acc_skew': 95.67, 'best_valid_valid/acc_align': 94.141, 'best_valid_test/acc': 90.663, 'best_valid_test/acc_unbiased': 92.42, 'best_valid_test/diff': 4.744, 'best_valid_test/acc_skew': 91.208, 'best_valid_test/acc_align': 93.631}
[6 / 10] best test accuracy: 92.420 at epoch 6 
 best_stats: {'best_test_epoch': 6, 'best_test_valid/acc': 93.784, 'best_test_valid/acc_unbiased': 94.905, 'best_test_valid/diff': 1.529, 'best_test_valid/acc_skew': 95.67, 'best_test_valid/acc_align': 94.141, 'best_test_test/acc': 90.663, 'best_test_test/acc_unbiased': 92.42, 'best_test_test/diff': 4.744, 'best_test_test/acc_skew': 91.208, 'best_test_test/acc_align': 93.631}
[7 / 10] Learning rate: 1e-05 weight: 0.01
[7 / 10] Loss: 4.454794720132458 CE Loss: 0.1460548339224494 Con Loss: 4.45333417403094
[7 / 10] tensor([[0.866, 0.944],
        [0.960, 0.918]]) {'epoch': 7, 'valid/acc': 94.568, 'valid/acc_unbiased': 95.393, 'valid/diff': 2.194, 'valid/acc_skew': 96.49, 'valid/acc_align': 94.296, 'test/acc': 91.267, 'test/acc_unbiased': 92.202, 'test/diff': 6.072, 'test/acc_skew': 91.303, 'test/acc_align': 93.1}
[7 / 10] best valid accuracy: 95.393 at epoch 7 
 best_stats: {'best_valid_epoch': 7, 'best_valid_valid/acc': 94.568, 'best_valid_valid/acc_unbiased': 95.393, 'best_valid_valid/diff': 2.194, 'best_valid_valid/acc_skew': 96.49, 'best_valid_valid/acc_align': 94.296, 'best_valid_test/acc': 91.267, 'best_valid_test/acc_unbiased': 92.202, 'best_valid_test/diff': 6.072, 'best_valid_test/acc_skew': 91.303, 'best_valid_test/acc_align': 93.1}
[7 / 10] best test accuracy: 92.420 at epoch 6 
 best_stats: {'best_test_epoch': 6, 'best_test_valid/acc': 93.784, 'best_test_valid/acc_unbiased': 94.905, 'best_test_valid/diff': 1.529, 'best_test_valid/acc_skew': 95.67, 'best_test_valid/acc_align': 94.141, 'best_test_test/acc': 90.663, 'best_test_test/acc_unbiased': 92.42, 'best_test_test/diff': 4.744, 'best_test_test/acc_skew': 91.208, 'best_test_test/acc_align': 93.631}
[8 / 10] Learning rate: 1e-05 weight: 0.01
[8 / 10] Loss: 4.450658352663222 CE Loss: 0.14463876157101221 Con Loss: 4.449211968263208
[8 / 10] tensor([[0.858, 0.940],
        [0.964, 0.929]]) {'epoch': 8, 'valid/acc': 94.423, 'valid/acc_unbiased': 95.285, 'valid/diff': 1.204, 'valid/acc_skew': 95.887, 'valid/acc_align': 94.684, 'test/acc': 90.784, 'test/acc_unbiased': 92.249, 'test/diff': 5.888, 'test/acc_skew': 91.084, 'test/acc_align': 93.414}
[8 / 10] best valid accuracy: 95.393 at epoch 7 
 best_stats: {'best_valid_epoch': 7, 'best_valid_valid/acc': 94.568, 'best_valid_valid/acc_unbiased': 95.393, 'best_valid_valid/diff': 2.194, 'best_valid_valid/acc_skew': 96.49, 'best_valid_valid/acc_align': 94.296, 'best_valid_test/acc': 91.267, 'best_valid_test/acc_unbiased': 92.202, 'best_valid_test/diff': 6.072, 'best_valid_test/acc_skew': 91.303, 'best_valid_test/acc_align': 93.1}
[8 / 10] best test accuracy: 92.420 at epoch 6 
 best_stats: {'best_test_epoch': 6, 'best_test_valid/acc': 93.784, 'best_test_valid/acc_unbiased': 94.905, 'best_test_valid/diff': 1.529, 'best_test_valid/acc_skew': 95.67, 'best_test_valid/acc_align': 94.141, 'best_test_test/acc': 90.663, 'best_test_test/acc_unbiased': 92.42, 'best_test_test/diff': 4.744, 'best_test_test/acc_skew': 91.208, 'best_test_test/acc_align': 93.631}
[9 / 10] Learning rate: 1e-05 weight: 0.01
[9 / 10] Loss: 4.441541323904586 CE Loss: 0.14312887389514747 Con Loss: 4.44011004437371
[9 / 10] tensor([[0.843, 0.934],
        [0.971, 0.934]]) {'epoch': 9, 'valid/acc': 94.305, 'valid/acc_unbiased': 95.693, 'valid/diff': 1.721, 'valid/acc_skew': 96.553, 'valid/acc_align': 94.832, 'test/acc': 90.029, 'test/acc_unbiased': 92.049, 'test/diff': 6.345, 'test/acc_skew': 90.712, 'test/acc_align': 93.386}
[9 / 10] best valid accuracy: 95.693 at epoch 9 
 best_stats: {'best_valid_epoch': 9, 'best_valid_valid/acc': 94.305, 'best_valid_valid/acc_unbiased': 95.693, 'best_valid_valid/diff': 1.721, 'best_valid_valid/acc_skew': 96.553, 'best_valid_valid/acc_align': 94.832, 'best_valid_test/acc': 90.029, 'best_valid_test/acc_unbiased': 92.049, 'best_valid_test/diff': 6.345, 'best_valid_test/acc_skew': 90.712, 'best_valid_test/acc_align': 93.386}
[9 / 10] best test accuracy: 92.420 at epoch 6 
 best_stats: {'best_test_epoch': 6, 'best_test_valid/acc': 93.784, 'best_test_valid/acc_unbiased': 94.905, 'best_test_valid/diff': 1.529, 'best_test_valid/acc_skew': 95.67, 'best_test_valid/acc_align': 94.141, 'best_test_test/acc': 90.663, 'best_test_test/acc_unbiased': 92.42, 'best_test_test/diff': 4.744, 'best_test_test/acc_skew': 91.208, 'best_test_test/acc_align': 93.631}
[10 / 10] Learning rate: 1e-05 weight: 0.01
[10 / 10] Loss: 4.442055698054288 CE Loss: 0.14246305041817434 Con Loss: 4.440631076138892
[10 / 10] tensor([[0.854, 0.944],
        [0.967, 0.923]]) {'epoch': 10, 'valid/acc': 94.686, 'valid/acc_unbiased': 95.349, 'valid/diff': 2.404, 'valid/acc_skew': 96.551, 'valid/acc_align': 94.147, 'test/acc': 90.859, 'test/acc_unbiased': 92.202, 'test/diff': 6.672, 'test/acc_skew': 91.042, 'test/acc_align': 93.363}
[10 / 10] best valid accuracy: 95.693 at epoch 9 
 best_stats: {'best_valid_epoch': 9, 'best_valid_valid/acc': 94.305, 'best_valid_valid/acc_unbiased': 95.693, 'best_valid_valid/diff': 1.721, 'best_valid_valid/acc_skew': 96.553, 'best_valid_valid/acc_align': 94.832, 'best_valid_test/acc': 90.029, 'best_valid_test/acc_unbiased': 92.049, 'best_valid_test/diff': 6.345, 'best_valid_test/acc_skew': 90.712, 'best_valid_test/acc_align': 93.386}
[10 / 10] best test accuracy: 92.420 at epoch 6 
 best_stats: {'best_test_epoch': 6, 'best_test_valid/acc': 93.784, 'best_test_valid/acc_unbiased': 94.905, 'best_test_valid/diff': 1.529, 'best_test_valid/acc_skew': 95.67, 'best_test_valid/acc_align': 94.141, 'best_test_test/acc': 90.663, 'best_test_test/acc_unbiased': 92.42, 'best_test_test/diff': 4.744, 'best_test_test/acc_skew': 91.208, 'best_test_test/acc_align': 93.631}
Total training time: 1:00:01
