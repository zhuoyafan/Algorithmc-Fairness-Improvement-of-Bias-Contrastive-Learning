Log level set to: INFO
Set seed: 1
=======> Using Fixed Random Seed: 1 <========
save_path: exp_results/bc-bb0-utk_face_age-cutout_blur-0.9-lr0.001-bs128-cbs64-w0.01-ratio10-aug1-seed1
get_utk_face - split: train, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_age-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
Binary Target 1
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Normal Label Distribution: 
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
Binary Target 1
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Normal Label Distribution: 
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 10684, target_attr: gender, bias_attr: age bias_rate: 0.9
['[train] target_0-bias_0: 8237', '[train] target_0-bias_1: 147', '[train] target_1-bias_0: 823', '[train] target_1-bias_1: 1477']
confusion_matrix - 
 original: tensor([[8237.,  823.],
        [ 147., 1477.]]), 
 normalized: tensor([[0.909, 0.091],
        [0.091, 0.909]]), 
 b|y: tensor([[0.982, 0.018],
        [0.358, 0.642]])
get_utk_face - split: train, aug: 1, given_y: True, ratio: 10
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_age-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
Binary Target 1
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Normal Label Distribution: 
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
Binary Target 1
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Normal Label Distribution: 
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 10684, target_attr: gender, bias_attr: age bias_rate: 0.9
['[train] target_0-bias_0: 8237', '[train] target_0-bias_1: 147', '[train] target_1-bias_0: 823', '[train] target_1-bias_1: 1477']
get_utk_face - split: valid, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_age-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [1030, 195]
Target 1: [841, 202]
Binary Target 1
---------------------------
Target 0: [1030, 195]
Target 1: [841, 202]
===================================
Normal Label Distribution: 
Target 0: [1030, 195]
Target 1: [841, 202]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 2268, target_attr: gender, bias_attr: age bias_rate: 0.9
['[valid] target_0-bias_0: 1030', '[valid] target_0-bias_1: 195', '[valid] target_1-bias_0: 841', '[valid] target_1-bias_1: 202']
get_utk_face - split: test, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_age-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [1061, 176]
Target 1: [867, 165]
Binary Target 1
---------------------------
Target 0: [1061, 176]
Target 1: [867, 165]
===================================
Normal Label Distribution: 
Target 0: [1061, 176]
Target 1: [867, 165]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 2269, target_attr: gender, bias_attr: age bias_rate: 0.9
['[test] target_0-bias_0: 1061', '[test] target_0-bias_1: 176', '[test] target_1-bias_0: 867', '[test] target_1-bias_1: 165']
decay_epochs: [6, 13]
[1 / 20] Learning rate: 0.001 weight: 0.01
[1 / 20] Loss: 4.80375062067024 CE Loss: 0.5902942171796616 Con Loss: 4.797847671037486
[1 / 20] tensor([[0.995, 0.989],
        [0.051, 0.012]]) {'epoch': 1, 'valid/acc': 55.952, 'valid/acc_unbiased': 51.724, 'valid/diff': 1.504, 'valid/acc_skew': 52.4, 'valid/acc_align': 51.048, 'test/acc': 56.236, 'test/acc_unbiased': 51.17, 'test/diff': 2.264, 'test/acc_skew': 51.969, 'test/acc_align': 50.37}
[1 / 20] best valid accuracy: 51.724 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 55.952, 'best_valid_valid/acc_unbiased': 51.724, 'best_valid_valid/diff': 1.504, 'best_valid_valid/acc_skew': 52.4, 'best_valid_valid/acc_align': 51.048, 'best_valid_test/acc': 56.236, 'best_valid_test/acc_unbiased': 51.17, 'best_valid_test/diff': 2.264, 'best_valid_test/acc_skew': 51.969, 'best_valid_test/acc_align': 50.37}
[1 / 20] best test accuracy: 51.170 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 55.952, 'best_test_valid/acc_unbiased': 51.724, 'best_test_valid/diff': 1.504, 'best_test_valid/acc_skew': 52.4, 'best_test_valid/acc_align': 51.048, 'best_test_test/acc': 56.236, 'best_test_test/acc_unbiased': 51.17, 'best_test_test/diff': 2.264, 'best_test_test/acc_skew': 51.969, 'best_test_test/acc_align': 50.37}
[2 / 20] Learning rate: 0.001 weight: 0.01
[2 / 20] Loss: 4.557464636920856 CE Loss: 0.5325205693058377 Con Loss: 4.552139440041631
[2 / 20] tensor([[0.983, 0.949],
        [0.253, 0.164]]) {'epoch': 2, 'valid/acc': 63.316, 'valid/acc_unbiased': 58.752, 'valid/diff': 4.864, 'valid/acc_skew': 58.676, 'valid/acc_align': 58.828, 'test/acc': 64.169, 'test/acc_unbiased': 58.703, 'test/diff': 6.157, 'test/acc_skew': 60.073, 'test/acc_align': 57.334}
[2 / 20] best valid accuracy: 58.752 at epoch 2 
 best_stats: {'best_valid_epoch': 2, 'best_valid_valid/acc': 63.316, 'best_valid_valid/acc_unbiased': 58.752, 'best_valid_valid/diff': 4.864, 'best_valid_valid/acc_skew': 58.676, 'best_valid_valid/acc_align': 58.828, 'best_valid_test/acc': 64.169, 'best_valid_test/acc_unbiased': 58.703, 'best_valid_test/diff': 6.157, 'best_valid_test/acc_skew': 60.073, 'best_valid_test/acc_align': 57.334}
[2 / 20] best test accuracy: 58.703 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 63.316, 'best_test_valid/acc_unbiased': 58.752, 'best_test_valid/diff': 4.864, 'best_test_valid/acc_skew': 58.676, 'best_test_valid/acc_align': 58.828, 'best_test_test/acc': 64.169, 'best_test_test/acc_unbiased': 58.703, 'best_test_test/diff': 6.157, 'best_test_test/acc_skew': 60.073, 'best_test_test/acc_align': 57.334}
[3 / 20] Learning rate: 0.001 weight: 0.01
[3 / 20] Loss: 4.402013103330863 CE Loss: 0.5135902701714922 Con Loss: 4.396877200984633
[3 / 20] tensor([[0.843, 0.665],
        [0.671, 0.491]]) {'epoch': 3, 'valid/acc': 73.06, 'valid/acc_unbiased': 65.544, 'valid/diff': 20.415, 'valid/acc_skew': 64.966, 'valid/acc_align': 66.122, 'test/acc': 73.777, 'test/acc_unbiased': 66.739, 'test/diff': 17.91, 'test/acc_skew': 66.803, 'test/acc_align': 66.676}
[3 / 20] best valid accuracy: 65.544 at epoch 3 
 best_stats: {'best_valid_epoch': 3, 'best_valid_valid/acc': 73.06, 'best_valid_valid/acc_unbiased': 65.544, 'best_valid_valid/diff': 20.415, 'best_valid_valid/acc_skew': 64.966, 'best_valid_valid/acc_align': 66.122, 'best_valid_test/acc': 73.777, 'best_valid_test/acc_unbiased': 66.739, 'best_valid_test/diff': 17.91, 'best_valid_test/acc_skew': 66.803, 'best_valid_test/acc_align': 66.676}
[3 / 20] best test accuracy: 66.739 at epoch 3 
 best_stats: {'best_test_epoch': 3, 'best_test_valid/acc': 73.06, 'best_test_valid/acc_unbiased': 65.544, 'best_test_valid/diff': 20.415, 'best_test_valid/acc_skew': 64.966, 'best_test_valid/acc_align': 66.122, 'best_test_test/acc': 73.777, 'best_test_test/acc_unbiased': 66.739, 'best_test_test/diff': 17.91, 'best_test_test/acc_skew': 66.803, 'best_test_test/acc_align': 66.676}
[4 / 20] Learning rate: 0.001 weight: 0.01
[4 / 20] Loss: 4.4258783257262 CE Loss: 0.4783720442392727 Con Loss: 4.421094595560283
[4 / 20] tensor([[0.988, 0.898],
        [0.317, 0.388]]) {'epoch': 4, 'valid/acc': 65.697, 'valid/acc_unbiased': 61.472, 'valid/diff': 10.147, 'valid/acc_skew': 56.398, 'valid/acc_align': 66.545, 'test/acc': 68.092, 'test/acc_unbiased': 64.763, 'test/diff': 8.036, 'test/acc_skew': 60.746, 'test/acc_align': 68.781}
[4 / 20] best valid accuracy: 65.544 at epoch 3 
 best_stats: {'best_valid_epoch': 3, 'best_valid_valid/acc': 73.06, 'best_valid_valid/acc_unbiased': 65.544, 'best_valid_valid/diff': 20.415, 'best_valid_valid/acc_skew': 64.966, 'best_valid_valid/acc_align': 66.122, 'best_valid_test/acc': 73.777, 'best_valid_test/acc_unbiased': 66.739, 'best_valid_test/diff': 17.91, 'best_valid_test/acc_skew': 66.803, 'best_valid_test/acc_align': 66.676}
[4 / 20] best test accuracy: 66.739 at epoch 3 
 best_stats: {'best_test_epoch': 3, 'best_test_valid/acc': 73.06, 'best_test_valid/acc_unbiased': 65.544, 'best_test_valid/diff': 20.415, 'best_test_valid/acc_skew': 64.966, 'best_test_valid/acc_align': 66.122, 'best_test_test/acc': 73.777, 'best_test_test/acc_unbiased': 66.739, 'best_test_test/diff': 17.91, 'best_test_test/acc_skew': 66.803, 'best_test_test/acc_align': 66.676}
[5 / 20] Learning rate: 0.001 weight: 0.01
[5 / 20] Loss: 4.3382311086893885 CE Loss: 0.4751611007973747 Con Loss: 4.333479493532856
[5 / 20] tensor([[0.977, 0.727],
        [0.452, 0.418]]) {'epoch': 5, 'valid/acc': 69.797, 'valid/acc_unbiased': 64.602, 'valid/diff': 15.205, 'valid/acc_skew': 57.0, 'valid/acc_align': 72.204, 'test/acc': 71.662, 'test/acc_unbiased': 64.374, 'test/diff': 14.203, 'test/acc_skew': 58.97, 'test/acc_align': 69.778}
[5 / 20] best valid accuracy: 65.544 at epoch 3 
 best_stats: {'best_valid_epoch': 3, 'best_valid_valid/acc': 73.06, 'best_valid_valid/acc_unbiased': 65.544, 'best_valid_valid/diff': 20.415, 'best_valid_valid/acc_skew': 64.966, 'best_valid_valid/acc_align': 66.122, 'best_valid_test/acc': 73.777, 'best_valid_test/acc_unbiased': 66.739, 'best_valid_test/diff': 17.91, 'best_valid_test/acc_skew': 66.803, 'best_valid_test/acc_align': 66.676}
[5 / 20] best test accuracy: 66.739 at epoch 3 
 best_stats: {'best_test_epoch': 3, 'best_test_valid/acc': 73.06, 'best_test_valid/acc_unbiased': 65.544, 'best_test_valid/diff': 20.415, 'best_test_valid/acc_skew': 64.966, 'best_test_valid/acc_align': 66.122, 'best_test_test/acc': 73.777, 'best_test_test/acc_unbiased': 66.739, 'best_test_test/diff': 17.91, 'best_test_test/acc_skew': 66.803, 'best_test_test/acc_align': 66.676}
[6 / 20] Learning rate: 0.001 weight: 0.01
[6 / 20] Loss: 4.286690479180019 CE Loss: 0.44455775481312965 Con Loss: 4.282244880294942
[6 / 20] tensor([[0.977, 0.847],
        [0.406, 0.406]]) {'epoch': 6, 'valid/acc': 68.43, 'valid/acc_unbiased': 63.187, 'valid/diff': 13.065, 'valid/acc_skew': 56.654, 'valid/acc_align': 69.719, 'test/acc': 70.736, 'test/acc_unbiased': 65.901, 'test/diff': 6.543, 'test/acc_skew': 62.629, 'test/acc_align': 69.172}
[6 / 20] best valid accuracy: 65.544 at epoch 3 
 best_stats: {'best_valid_epoch': 3, 'best_valid_valid/acc': 73.06, 'best_valid_valid/acc_unbiased': 65.544, 'best_valid_valid/diff': 20.415, 'best_valid_valid/acc_skew': 64.966, 'best_valid_valid/acc_align': 66.122, 'best_valid_test/acc': 73.777, 'best_valid_test/acc_unbiased': 66.739, 'best_valid_test/diff': 17.91, 'best_valid_test/acc_skew': 66.803, 'best_valid_test/acc_align': 66.676}
[6 / 20] best test accuracy: 66.739 at epoch 3 
 best_stats: {'best_test_epoch': 3, 'best_test_valid/acc': 73.06, 'best_test_valid/acc_unbiased': 65.544, 'best_test_valid/diff': 20.415, 'best_test_valid/acc_skew': 64.966, 'best_test_valid/acc_align': 66.122, 'best_test_test/acc': 73.777, 'best_test_test/acc_unbiased': 66.739, 'best_test_test/diff': 17.91, 'best_test_test/acc_skew': 66.803, 'best_test_test/acc_align': 66.676}
[7 / 20] Learning rate: 0.0001 weight: 0.01
[7 / 20] Loss: 4.196422386062319 CE Loss: 0.42366980001168586 Con Loss: 4.192185699158686
[7 / 20] tensor([[0.975, 0.670],
        [0.525, 0.624]]) {'epoch': 7, 'valid/acc': 73.545, 'valid/acc_unbiased': 67.255, 'valid/diff': 24.138, 'valid/acc_skew': 55.186, 'valid/acc_align': 79.324, 'test/acc': 75.364, 'test/acc_unbiased': 69.851, 'test/diff': 20.177, 'test/acc_skew': 59.763, 'test/acc_align': 79.94}
[7 / 20] best valid accuracy: 67.255 at epoch 7 
 best_stats: {'best_valid_epoch': 7, 'best_valid_valid/acc': 73.545, 'best_valid_valid/acc_unbiased': 67.255, 'best_valid_valid/diff': 24.138, 'best_valid_valid/acc_skew': 55.186, 'best_valid_valid/acc_align': 79.324, 'best_valid_test/acc': 75.364, 'best_valid_test/acc_unbiased': 69.851, 'best_valid_test/diff': 20.177, 'best_valid_test/acc_skew': 59.763, 'best_valid_test/acc_align': 79.94}
[7 / 20] best test accuracy: 69.851 at epoch 7 
 best_stats: {'best_test_epoch': 7, 'best_test_valid/acc': 73.545, 'best_test_valid/acc_unbiased': 67.255, 'best_test_valid/diff': 24.138, 'best_test_valid/acc_skew': 55.186, 'best_test_valid/acc_align': 79.324, 'best_test_test/acc': 75.364, 'best_test_test/acc_unbiased': 69.851, 'best_test_test/diff': 20.177, 'best_test_test/acc_skew': 59.763, 'best_test_test/acc_align': 79.94}
[8 / 20] Learning rate: 0.0001 weight: 0.01
[8 / 20] Loss: 4.102584061128109 CE Loss: 0.38958940597251757 Con Loss: 4.098688182737978
[8 / 20] tensor([[0.966, 0.591],
        [0.587, 0.691]]) {'epoch': 8, 'valid/acc': 75.397, 'valid/acc_unbiased': 68.269, 'valid/diff': 29.846, 'valid/acc_skew': 53.346, 'valid/acc_align': 83.192, 'test/acc': 77.215, 'test/acc_unbiased': 70.874, 'test/diff': 23.949, 'test/acc_skew': 58.9, 'test/acc_align': 82.849}
[8 / 20] best valid accuracy: 68.269 at epoch 8 
 best_stats: {'best_valid_epoch': 8, 'best_valid_valid/acc': 75.397, 'best_valid_valid/acc_unbiased': 68.269, 'best_valid_valid/diff': 29.846, 'best_valid_valid/acc_skew': 53.346, 'best_valid_valid/acc_align': 83.192, 'best_valid_test/acc': 77.215, 'best_valid_test/acc_unbiased': 70.874, 'best_valid_test/diff': 23.949, 'best_valid_test/acc_skew': 58.9, 'best_valid_test/acc_align': 82.849}
[8 / 20] best test accuracy: 70.874 at epoch 8 
 best_stats: {'best_test_epoch': 8, 'best_test_valid/acc': 75.397, 'best_test_valid/acc_unbiased': 68.269, 'best_test_valid/diff': 29.846, 'best_test_valid/acc_skew': 53.346, 'best_test_valid/acc_align': 83.192, 'best_test_test/acc': 77.215, 'best_test_test/acc_unbiased': 70.874, 'best_test_test/diff': 23.949, 'best_test_test/acc_skew': 58.9, 'best_test_test/acc_align': 82.849}
[9 / 20] Learning rate: 0.0001 weight: 0.01
[9 / 20] Loss: 4.0522532416657535 CE Loss: 0.3722507732051091 Con Loss: 4.048530726252491
[9 / 20] tensor([[0.969, 0.562],
        [0.602, 0.703]]) {'epoch': 9, 'valid/acc': 75.309, 'valid/acc_unbiased': 68.397, 'valid/diff': 30.183, 'valid/acc_skew': 53.305, 'valid/acc_align': 83.488, 'test/acc': 77.788, 'test/acc_unbiased': 70.913, 'test/diff': 25.368, 'test/acc_skew': 58.229, 'test/acc_align': 83.596}
[9 / 20] best valid accuracy: 68.397 at epoch 9 
 best_stats: {'best_valid_epoch': 9, 'best_valid_valid/acc': 75.309, 'best_valid_valid/acc_unbiased': 68.397, 'best_valid_valid/diff': 30.183, 'best_valid_valid/acc_skew': 53.305, 'best_valid_valid/acc_align': 83.488, 'best_valid_test/acc': 77.788, 'best_valid_test/acc_unbiased': 70.913, 'best_valid_test/diff': 25.368, 'best_valid_test/acc_skew': 58.229, 'best_valid_test/acc_align': 83.596}
[9 / 20] best test accuracy: 70.913 at epoch 9 
 best_stats: {'best_test_epoch': 9, 'best_test_valid/acc': 75.309, 'best_test_valid/acc_unbiased': 68.397, 'best_test_valid/diff': 30.183, 'best_test_valid/acc_skew': 53.305, 'best_test_valid/acc_align': 83.488, 'best_test_test/acc': 77.788, 'best_test_test/acc_unbiased': 70.913, 'best_test_test/diff': 25.368, 'best_test_test/acc_skew': 58.229, 'best_test_test/acc_align': 83.596}
[10 / 20] Learning rate: 0.0001 weight: 0.01
[10 / 20] Loss: 3.971395223875342 CE Loss: 0.3658513812057448 Con Loss: 3.967736714790484
[10 / 20] tensor([[0.974, 0.574],
        [0.591, 0.673]]) {'epoch': 10, 'valid/acc': 74.559, 'valid/acc_unbiased': 67.689, 'valid/diff': 29.608, 'valid/acc_skew': 52.885, 'valid/acc_align': 82.494, 'test/acc': 77.435, 'test/acc_unbiased': 70.269, 'test/diff': 24.097, 'test/acc_skew': 58.22, 'test/acc_align': 82.317}
[10 / 20] best valid accuracy: 68.397 at epoch 9 
 best_stats: {'best_valid_epoch': 9, 'best_valid_valid/acc': 75.309, 'best_valid_valid/acc_unbiased': 68.397, 'best_valid_valid/diff': 30.183, 'best_valid_valid/acc_skew': 53.305, 'best_valid_valid/acc_align': 83.488, 'best_valid_test/acc': 77.788, 'best_valid_test/acc_unbiased': 70.913, 'best_valid_test/diff': 25.368, 'best_valid_test/acc_skew': 58.229, 'best_valid_test/acc_align': 83.596}
[10 / 20] best test accuracy: 70.913 at epoch 9 
 best_stats: {'best_test_epoch': 9, 'best_test_valid/acc': 75.309, 'best_test_valid/acc_unbiased': 68.397, 'best_test_valid/diff': 30.183, 'best_test_valid/acc_skew': 53.305, 'best_test_valid/acc_align': 83.488, 'best_test_test/acc': 77.788, 'best_test_test/acc_unbiased': 70.913, 'best_test_test/diff': 25.368, 'best_test_test/acc_skew': 58.229, 'best_test_test/acc_align': 83.596}
[11 / 20] Learning rate: 0.0001 weight: 0.01
[11 / 20] Loss: 3.941345955003562 CE Loss: 0.345552387598167 Con Loss: 3.937890431265936
[11 / 20] tensor([[0.961, 0.432],
        [0.638, 0.794]]) {'epoch': 11, 'valid/acc': 76.852, 'valid/acc_unbiased': 69.039, 'valid/diff': 38.537, 'valid/acc_skew': 49.771, 'valid/acc_align': 88.308, 'test/acc': 78.449, 'test/acc_unbiased': 70.624, 'test/diff': 34.282, 'test/acc_skew': 53.482, 'test/acc_align': 87.765}
[11 / 20] best valid accuracy: 69.039 at epoch 11 
 best_stats: {'best_valid_epoch': 11, 'best_valid_valid/acc': 76.852, 'best_valid_valid/acc_unbiased': 69.039, 'best_valid_valid/diff': 38.537, 'best_valid_valid/acc_skew': 49.771, 'best_valid_valid/acc_align': 88.308, 'best_valid_test/acc': 78.449, 'best_valid_test/acc_unbiased': 70.624, 'best_valid_test/diff': 34.282, 'best_valid_test/acc_skew': 53.482, 'best_valid_test/acc_align': 87.765}
[11 / 20] best test accuracy: 70.913 at epoch 9 
 best_stats: {'best_test_epoch': 9, 'best_test_valid/acc': 75.309, 'best_test_valid/acc_unbiased': 68.397, 'best_test_valid/diff': 30.183, 'best_test_valid/acc_skew': 53.305, 'best_test_valid/acc_align': 83.488, 'best_test_test/acc': 77.788, 'best_test_test/acc_unbiased': 70.913, 'best_test_test/diff': 25.368, 'best_test_test/acc_skew': 58.229, 'best_test_test/acc_align': 83.596}
[12 / 20] Learning rate: 0.0001 weight: 0.01
[12 / 20] Loss: 3.941149091952662 CE Loss: 0.34206591134257014 Con Loss: 3.9377284119612086
[12 / 20] tensor([[0.977, 0.523],
        [0.572, 0.721]]) {'epoch': 12, 'valid/acc': 74.118, 'valid/acc_unbiased': 67.504, 'valid/diff': 30.582, 'valid/acc_skew': 52.213, 'valid/acc_align': 82.794, 'test/acc': 76.862, 'test/acc_unbiased': 69.835, 'test/diff': 30.189, 'test/acc_skew': 54.741, 'test/acc_align': 84.93}
[12 / 20] best valid accuracy: 69.039 at epoch 11 
 best_stats: {'best_valid_epoch': 11, 'best_valid_valid/acc': 76.852, 'best_valid_valid/acc_unbiased': 69.039, 'best_valid_valid/diff': 38.537, 'best_valid_valid/acc_skew': 49.771, 'best_valid_valid/acc_align': 88.308, 'best_valid_test/acc': 78.449, 'best_valid_test/acc_unbiased': 70.624, 'best_valid_test/diff': 34.282, 'best_valid_test/acc_skew': 53.482, 'best_valid_test/acc_align': 87.765}
[12 / 20] best test accuracy: 70.913 at epoch 9 
 best_stats: {'best_test_epoch': 9, 'best_test_valid/acc': 75.309, 'best_test_valid/acc_unbiased': 68.397, 'best_test_valid/diff': 30.183, 'best_test_valid/acc_skew': 53.305, 'best_test_valid/acc_align': 83.488, 'best_test_test/acc': 77.788, 'best_test_test/acc_unbiased': 70.913, 'best_test_test/diff': 25.368, 'best_test_test/acc_skew': 58.229, 'best_test_test/acc_align': 83.596}
[13 / 20] Learning rate: 0.0001 weight: 0.01
[13 / 20] Loss: 3.915008718089993 CE Loss: 0.3302635637529331 Con Loss: 3.911706078949603
[13 / 20] tensor([[0.975, 0.500],
        [0.587, 0.715]]) {'epoch': 13, 'valid/acc': 74.735, 'valid/acc_unbiased': 68.494, 'valid/diff': 30.979, 'valid/acc_skew': 53.004, 'valid/acc_align': 83.983, 'test/acc': 77.082, 'test/acc_unbiased': 69.42, 'test/diff': 30.131, 'test/acc_skew': 54.354, 'test/acc_align': 84.485}
[13 / 20] best valid accuracy: 69.039 at epoch 11 
 best_stats: {'best_valid_epoch': 11, 'best_valid_valid/acc': 76.852, 'best_valid_valid/acc_unbiased': 69.039, 'best_valid_valid/diff': 38.537, 'best_valid_valid/acc_skew': 49.771, 'best_valid_valid/acc_align': 88.308, 'best_valid_test/acc': 78.449, 'best_valid_test/acc_unbiased': 70.624, 'best_valid_test/diff': 34.282, 'best_valid_test/acc_skew': 53.482, 'best_valid_test/acc_align': 87.765}
[13 / 20] best test accuracy: 70.913 at epoch 9 
 best_stats: {'best_test_epoch': 9, 'best_test_valid/acc': 75.309, 'best_test_valid/acc_unbiased': 68.397, 'best_test_valid/diff': 30.183, 'best_test_valid/acc_skew': 53.305, 'best_test_valid/acc_align': 83.488, 'best_test_test/acc': 77.788, 'best_test_test/acc_unbiased': 70.913, 'best_test_test/diff': 25.368, 'best_test_test/acc_skew': 58.229, 'best_test_test/acc_align': 83.596}
[14 / 20] Learning rate: 1e-05 weight: 0.01
[14 / 20] Loss: 3.8720106249309043 CE Loss: 0.33424078916084093 Con Loss: 3.868668221302668
[14 / 20] tensor([[0.975, 0.511],
        [0.567, 0.758]]) {'epoch': 14, 'valid/acc': 74.162, 'valid/acc_unbiased': 67.689, 'valid/diff': 34.268, 'valid/acc_skew': 50.556, 'valid/acc_align': 84.823, 'test/acc': 76.774, 'test/acc_unbiased': 70.298, 'test/diff': 32.712, 'test/acc_skew': 53.942, 'test/acc_align': 86.654}
[14 / 20] best valid accuracy: 69.039 at epoch 11 
 best_stats: {'best_valid_epoch': 11, 'best_valid_valid/acc': 76.852, 'best_valid_valid/acc_unbiased': 69.039, 'best_valid_valid/diff': 38.537, 'best_valid_valid/acc_skew': 49.771, 'best_valid_valid/acc_align': 88.308, 'best_valid_test/acc': 78.449, 'best_valid_test/acc_unbiased': 70.624, 'best_valid_test/diff': 34.282, 'best_valid_test/acc_skew': 53.482, 'best_valid_test/acc_align': 87.765}
[14 / 20] best test accuracy: 70.913 at epoch 9 
 best_stats: {'best_test_epoch': 9, 'best_test_valid/acc': 75.309, 'best_test_valid/acc_unbiased': 68.397, 'best_test_valid/diff': 30.183, 'best_test_valid/acc_skew': 53.305, 'best_test_valid/acc_align': 83.488, 'best_test_test/acc': 77.788, 'best_test_test/acc_unbiased': 70.913, 'best_test_test/diff': 25.368, 'best_test_test/acc_skew': 58.229, 'best_test_test/acc_align': 83.596}
[15 / 20] Learning rate: 1e-05 weight: 0.01
[15 / 20] Loss: 3.85295444425685 CE Loss: 0.3232000672841777 Con Loss: 3.8497224287877856
[15 / 20] tensor([[0.975, 0.494],
        [0.585, 0.745]]) {'epoch': 15, 'valid/acc': 75.132, 'valid/acc_unbiased': 68.533, 'valid/diff': 34.365, 'valid/acc_skew': 51.351, 'valid/acc_align': 85.716, 'test/acc': 77.215, 'test/acc_unbiased': 70.001, 'test/diff': 32.093, 'test/acc_skew': 53.955, 'test/acc_align': 86.047}
[15 / 20] best valid accuracy: 69.039 at epoch 11 
 best_stats: {'best_valid_epoch': 11, 'best_valid_valid/acc': 76.852, 'best_valid_valid/acc_unbiased': 69.039, 'best_valid_valid/diff': 38.537, 'best_valid_valid/acc_skew': 49.771, 'best_valid_valid/acc_align': 88.308, 'best_valid_test/acc': 78.449, 'best_valid_test/acc_unbiased': 70.624, 'best_valid_test/diff': 34.282, 'best_valid_test/acc_skew': 53.482, 'best_valid_test/acc_align': 87.765}
[15 / 20] best test accuracy: 70.913 at epoch 9 
 best_stats: {'best_test_epoch': 9, 'best_test_valid/acc': 75.309, 'best_test_valid/acc_unbiased': 68.397, 'best_test_valid/diff': 30.183, 'best_test_valid/acc_skew': 53.305, 'best_test_valid/acc_align': 83.488, 'best_test_test/acc': 77.788, 'best_test_test/acc_unbiased': 70.913, 'best_test_test/diff': 25.368, 'best_test_test/acc_skew': 58.229, 'best_test_test/acc_align': 83.596}
[16 / 20] Learning rate: 1e-05 weight: 0.01
[16 / 20] Loss: 3.816832091468231 CE Loss: 0.3226003947551667 Con Loss: 3.8136061060879394
[16 / 20] tensor([[0.975, 0.494],
        [0.589, 0.758]]) {'epoch': 16, 'valid/acc': 75.309, 'valid/acc_unbiased': 68.35, 'valid/diff': 34.431, 'valid/acc_skew': 51.135, 'valid/acc_align': 85.566, 'test/acc': 77.435, 'test/acc_unbiased': 70.396, 'test/diff': 32.421, 'test/acc_skew': 54.185, 'test/acc_align': 86.606}
[16 / 20] best valid accuracy: 69.039 at epoch 11 
 best_stats: {'best_valid_epoch': 11, 'best_valid_valid/acc': 76.852, 'best_valid_valid/acc_unbiased': 69.039, 'best_valid_valid/diff': 38.537, 'best_valid_valid/acc_skew': 49.771, 'best_valid_valid/acc_align': 88.308, 'best_valid_test/acc': 78.449, 'best_valid_test/acc_unbiased': 70.624, 'best_valid_test/diff': 34.282, 'best_valid_test/acc_skew': 53.482, 'best_valid_test/acc_align': 87.765}
[16 / 20] best test accuracy: 70.913 at epoch 9 
 best_stats: {'best_test_epoch': 9, 'best_test_valid/acc': 75.309, 'best_test_valid/acc_unbiased': 68.397, 'best_test_valid/diff': 30.183, 'best_test_valid/acc_skew': 53.305, 'best_test_valid/acc_align': 83.488, 'best_test_test/acc': 77.788, 'best_test_test/acc_unbiased': 70.913, 'best_test_test/diff': 25.368, 'best_test_test/acc_skew': 58.229, 'best_test_test/acc_align': 83.596}
[17 / 20] Learning rate: 1e-05 weight: 0.01
[17 / 20] Loss: 3.807254488483345 CE Loss: 0.30822480859626145 Con Loss: 3.804172252010915
[17 / 20] tensor([[0.973, 0.466],
        [0.581, 0.782]]) {'epoch': 17, 'valid/acc': 74.647, 'valid/acc_unbiased': 67.019, 'valid/diff': 37.491, 'valid/acc_skew': 48.274, 'valid/acc_align': 85.765, 'test/acc': 76.994, 'test/acc_unbiased': 70.043, 'test/diff': 35.363, 'test/acc_skew': 52.361, 'test/acc_align': 87.724}
[17 / 20] best valid accuracy: 69.039 at epoch 11 
 best_stats: {'best_valid_epoch': 11, 'best_valid_valid/acc': 76.852, 'best_valid_valid/acc_unbiased': 69.039, 'best_valid_valid/diff': 38.537, 'best_valid_valid/acc_skew': 49.771, 'best_valid_valid/acc_align': 88.308, 'best_valid_test/acc': 78.449, 'best_valid_test/acc_unbiased': 70.624, 'best_valid_test/diff': 34.282, 'best_valid_test/acc_skew': 53.482, 'best_valid_test/acc_align': 87.765}
[17 / 20] best test accuracy: 70.913 at epoch 9 
 best_stats: {'best_test_epoch': 9, 'best_test_valid/acc': 75.309, 'best_test_valid/acc_unbiased': 68.397, 'best_test_valid/diff': 30.183, 'best_test_valid/acc_skew': 53.305, 'best_test_valid/acc_align': 83.488, 'best_test_test/acc': 77.788, 'best_test_test/acc_unbiased': 70.913, 'best_test_test/diff': 25.368, 'best_test_test/acc_skew': 58.229, 'best_test_test/acc_align': 83.596}
[18 / 20] Learning rate: 1e-05 weight: 0.01
[18 / 20] Loss: 3.8179610553014505 CE Loss: 0.31850184334525006 Con Loss: 3.814776052298594
[18 / 20] tensor([[0.977, 0.517],
        [0.549, 0.745]]) {'epoch': 18, 'valid/acc': 74.03, 'valid/acc_unbiased': 67.784, 'valid/diff': 33.476, 'valid/acc_skew': 51.046, 'valid/acc_align': 84.522, 'test/acc': 76.113, 'test/acc_unbiased': 69.722, 'test/diff': 32.838, 'test/acc_skew': 53.303, 'test/acc_align': 86.142}
[18 / 20] best valid accuracy: 69.039 at epoch 11 
 best_stats: {'best_valid_epoch': 11, 'best_valid_valid/acc': 76.852, 'best_valid_valid/acc_unbiased': 69.039, 'best_valid_valid/diff': 38.537, 'best_valid_valid/acc_skew': 49.771, 'best_valid_valid/acc_align': 88.308, 'best_valid_test/acc': 78.449, 'best_valid_test/acc_unbiased': 70.624, 'best_valid_test/diff': 34.282, 'best_valid_test/acc_skew': 53.482, 'best_valid_test/acc_align': 87.765}
[18 / 20] best test accuracy: 70.913 at epoch 9 
 best_stats: {'best_test_epoch': 9, 'best_test_valid/acc': 75.309, 'best_test_valid/acc_unbiased': 68.397, 'best_test_valid/diff': 30.183, 'best_test_valid/acc_skew': 53.305, 'best_test_valid/acc_align': 83.488, 'best_test_test/acc': 77.788, 'best_test_test/acc_unbiased': 70.913, 'best_test_test/diff': 25.368, 'best_test_test/acc_skew': 58.229, 'best_test_test/acc_align': 83.596}
[19 / 20] Learning rate: 1e-05 weight: 0.01
[19 / 20] Loss: 3.849156549654396 CE Loss: 0.3110352938249289 Con Loss: 3.8460462049614934
[19 / 20] tensor([[0.972, 0.472],
        [0.592, 0.770]]) {'epoch': 19, 'valid/acc': 75.132, 'valid/acc_unbiased': 68.312, 'valid/diff': 36.487, 'valid/acc_skew': 50.069, 'valid/acc_align': 86.556, 'test/acc': 77.303, 'test/acc_unbiased': 70.118, 'test/diff': 33.907, 'test/acc_skew': 53.164, 'test/acc_align': 87.071}
[19 / 20] best valid accuracy: 69.039 at epoch 11 
 best_stats: {'best_valid_epoch': 11, 'best_valid_valid/acc': 76.852, 'best_valid_valid/acc_unbiased': 69.039, 'best_valid_valid/diff': 38.537, 'best_valid_valid/acc_skew': 49.771, 'best_valid_valid/acc_align': 88.308, 'best_valid_test/acc': 78.449, 'best_valid_test/acc_unbiased': 70.624, 'best_valid_test/diff': 34.282, 'best_valid_test/acc_skew': 53.482, 'best_valid_test/acc_align': 87.765}
[19 / 20] best test accuracy: 70.913 at epoch 9 
 best_stats: {'best_test_epoch': 9, 'best_test_valid/acc': 75.309, 'best_test_valid/acc_unbiased': 68.397, 'best_test_valid/diff': 30.183, 'best_test_valid/acc_skew': 53.305, 'best_test_valid/acc_align': 83.488, 'best_test_test/acc': 77.788, 'best_test_test/acc_unbiased': 70.913, 'best_test_test/diff': 25.368, 'best_test_test/acc_skew': 58.229, 'best_test_test/acc_align': 83.596}
[20 / 20] Learning rate: 1e-05 weight: 0.01
[20 / 20] Loss: 3.8403142065378844 CE Loss: 0.3173998456485974 Con Loss: 3.8371401979252893
[20 / 20] tensor([[0.974, 0.472],
        [0.596, 0.770]]) {'epoch': 20, 'valid/acc': 75.397, 'valid/acc_unbiased': 68.698, 'valid/diff': 35.521, 'valid/acc_skew': 50.938, 'valid/acc_align': 86.459, 'test/acc': 77.567, 'test/acc_unbiased': 70.28, 'test/diff': 33.77, 'test/acc_skew': 53.395, 'test/acc_align': 87.165}
[20 / 20] best valid accuracy: 69.039 at epoch 11 
 best_stats: {'best_valid_epoch': 11, 'best_valid_valid/acc': 76.852, 'best_valid_valid/acc_unbiased': 69.039, 'best_valid_valid/diff': 38.537, 'best_valid_valid/acc_skew': 49.771, 'best_valid_valid/acc_align': 88.308, 'best_valid_test/acc': 78.449, 'best_valid_test/acc_unbiased': 70.624, 'best_valid_test/diff': 34.282, 'best_valid_test/acc_skew': 53.482, 'best_valid_test/acc_align': 87.765}
[20 / 20] best test accuracy: 70.913 at epoch 9 
 best_stats: {'best_test_epoch': 9, 'best_test_valid/acc': 75.309, 'best_test_valid/acc_unbiased': 68.397, 'best_test_valid/diff': 30.183, 'best_test_valid/acc_skew': 53.305, 'best_test_valid/acc_align': 83.488, 'best_test_test/acc': 77.788, 'best_test_test/acc_unbiased': 70.913, 'best_test_test/diff': 25.368, 'best_test_test/acc_skew': 58.229, 'best_test_test/acc_align': 83.596}
Total training time: 0:16:09
