Log level set to: INFO
Set seed: 2
=======> Using Fixed Random Seed: 2 <========
save_path: exp_results/ce-celeba_blonde-test-lr0.001-bs128-seed2
get_celeba - split:train, aug: False, given_y: True, ratio: 0
use existing blonde indices from data/celeba/pickles/blonde
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [1586, 53554]
Target 1: [18282, 1090]
Binary Target 1
---------------------------
Target 0: [1586, 53554]
Target 1: [18282, 1090]
===================================
Normal Label Distribution: 
Target 0: [1586, 53554]
Target 1: [18282, 1090]
===================================
Use BiasedCelebASplit 
 target_attr: blonde split: train 
 tensor([[ 1586., 18282.],
        [53554.,  1090.]])
get_celeba - split:train_valid, aug: False, given_y: True, ratio: 0
use existing blonde indices from data/celeba/pickles/blonde
Use BiasedCelebASplit 
 target_attr: blonde split: train_valid 
 tensor([[  385.,  4582.],
        [13400.,   262.]])
get_celeba - split:valid, aug: False, given_y: True, ratio: 0
Use BiasedCelebASplit 
 target_attr: blonde split: valid 
 tensor([[8535., 2874.],
        [8276.,  182.]])
decay_epochs: [3, 6]
[1 / 10] Learning rate: 0.001
[1 / 10] Loss: 0.0865
[1 / 10] tensor([[0.521, 0.993],
        [0.987, 0.330]]) {'epoch': 1, 'valid/acc': 97.52, 'valid/acc_unbiased': 75.183, 'valid/diff': 47.601, 'valid/acc_skew': 51.382, 'valid/acc_align': 98.983, 'test/acc': 78.351, 'test/acc_unbiased': 70.782, 'test/diff': 56.483, 'test/acc_skew': 42.541, 'test/acc_align': 99.024}
[1 / 10] best valid accuracy: 75.183 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 97.52, 'best_valid_valid/acc_unbiased': 75.183, 'best_valid_valid/diff': 47.601, 'best_valid_valid/acc_skew': 51.382, 'best_valid_valid/acc_align': 98.983, 'best_valid_test/acc': 78.351, 'best_valid_test/acc_unbiased': 70.782, 'best_valid_test/diff': 56.483, 'best_valid_test/acc_skew': 42.541, 'best_valid_test/acc_align': 99.024}
[1 / 10] best test accuracy: 70.782 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 97.52, 'best_test_valid/acc_unbiased': 75.183, 'best_test_valid/diff': 47.601, 'best_test_valid/acc_skew': 51.382, 'best_test_valid/acc_align': 98.983, 'best_test_test/acc': 78.351, 'best_test_test/acc_unbiased': 70.782, 'best_test_test/diff': 56.483, 'best_test_test/acc_skew': 42.541, 'best_test_test/acc_align': 99.024}
[2 / 10] Learning rate: 0.001
[2 / 10] Loss: 0.0741
[2 / 10] tensor([[0.918, 0.999],
        [0.840, 0.148]]) {'epoch': 2, 'valid/acc': 94.691, 'valid/acc_unbiased': 74.922, 'valid/diff': 34.014, 'valid/acc_skew': 57.915, 'valid/acc_align': 91.929, 'test/acc': 93.321, 'test/acc_unbiased': 72.627, 'test/diff': 38.631, 'test/acc_skew': 53.311, 'test/acc_align': 91.942}
[2 / 10] best valid accuracy: 75.183 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 97.52, 'best_valid_valid/acc_unbiased': 75.183, 'best_valid_valid/diff': 47.601, 'best_valid_valid/acc_skew': 51.382, 'best_valid_valid/acc_align': 98.983, 'best_valid_test/acc': 78.351, 'best_valid_test/acc_unbiased': 70.782, 'best_valid_test/diff': 56.483, 'best_valid_test/acc_skew': 42.541, 'best_valid_test/acc_align': 99.024}
[2 / 10] best test accuracy: 72.627 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 94.691, 'best_test_valid/acc_unbiased': 74.922, 'best_test_valid/diff': 34.014, 'best_test_valid/acc_skew': 57.915, 'best_test_valid/acc_align': 91.929, 'best_test_test/acc': 93.321, 'best_test_test/acc_unbiased': 72.627, 'best_test_test/diff': 38.631, 'best_test_test/acc_skew': 53.311, 'best_test_test/acc_align': 91.942}
[3 / 10] Learning rate: 0.001
[3 / 10] Loss: 0.0716
[3 / 10] tensor([[0.705, 0.990],
        [0.977, 0.385]]) {'epoch': 3, 'valid/acc': 97.574, 'valid/acc_unbiased': 81.812, 'valid/diff': 33.074, 'valid/acc_skew': 65.276, 'valid/acc_align': 98.349, 'test/acc': 86.012, 'test/acc_unbiased': 76.415, 'test/diff': 43.894, 'test/acc_skew': 54.468, 'test/acc_align': 98.362}
[3 / 10] best valid accuracy: 81.812 at epoch 3 
 best_stats: {'best_valid_epoch': 3, 'best_valid_valid/acc': 97.574, 'best_valid_valid/acc_unbiased': 81.812, 'best_valid_valid/diff': 33.074, 'best_valid_valid/acc_skew': 65.276, 'best_valid_valid/acc_align': 98.349, 'best_valid_test/acc': 86.012, 'best_valid_test/acc_unbiased': 76.415, 'best_valid_test/diff': 43.894, 'best_valid_test/acc_skew': 54.468, 'best_valid_test/acc_align': 98.362}
[3 / 10] best test accuracy: 76.415 at epoch 3 
 best_stats: {'best_test_epoch': 3, 'best_test_valid/acc': 97.574, 'best_test_valid/acc_unbiased': 81.812, 'best_test_valid/diff': 33.074, 'best_test_valid/acc_skew': 65.276, 'best_test_valid/acc_align': 98.349, 'best_test_test/acc': 86.012, 'best_test_test/acc_unbiased': 76.415, 'best_test_test/diff': 43.894, 'best_test_test/acc_skew': 54.468, 'best_test_test/acc_align': 98.362}
[4 / 10] Learning rate: 0.0001
[4 / 10] Loss: 0.0536
[4 / 10] tensor([[0.733, 0.995],
        [0.988, 0.434]]) {'epoch': 4, 'valid/acc': 98.4, 'valid/acc_unbiased': 83.986, 'valid/diff': 30.545, 'valid/acc_skew': 68.713, 'valid/acc_align': 99.258, 'test/acc': 87.653, 'test/acc_unbiased': 78.763, 'test/diff': 40.774, 'test/acc_skew': 58.376, 'test/acc_align': 99.149}
[4 / 10] best valid accuracy: 83.986 at epoch 4 
 best_stats: {'best_valid_epoch': 4, 'best_valid_valid/acc': 98.4, 'best_valid_valid/acc_unbiased': 83.986, 'best_valid_valid/diff': 30.545, 'best_valid_valid/acc_skew': 68.713, 'best_valid_valid/acc_align': 99.258, 'best_valid_test/acc': 87.653, 'best_valid_test/acc_unbiased': 78.763, 'best_valid_test/diff': 40.774, 'best_valid_test/acc_skew': 58.376, 'best_valid_test/acc_align': 99.149}
[4 / 10] best test accuracy: 78.763 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 98.4, 'best_test_valid/acc_unbiased': 83.986, 'best_test_valid/diff': 30.545, 'best_test_valid/acc_skew': 68.713, 'best_test_valid/acc_align': 99.258, 'best_test_test/acc': 87.653, 'best_test_test/acc_unbiased': 78.763, 'best_test_test/diff': 40.774, 'best_test_test/acc_skew': 58.376, 'best_test_test/acc_align': 99.149}
[5 / 10] Learning rate: 0.0001
[5 / 10] Loss: 0.0463
[5 / 10] tensor([[0.734, 0.997],
        [0.985, 0.324]]) {'epoch': 5, 'valid/acc': 98.486, 'valid/acc_unbiased': 82.402, 'valid/diff': 33.987, 'valid/acc_skew': 65.408, 'valid/acc_align': 99.395, 'test/acc': 87.587, 'test/acc_unbiased': 75.991, 'test/diff': 46.184, 'test/acc_skew': 52.899, 'test/acc_align': 99.083}
[5 / 10] best valid accuracy: 83.986 at epoch 4 
 best_stats: {'best_valid_epoch': 4, 'best_valid_valid/acc': 98.4, 'best_valid_valid/acc_unbiased': 83.986, 'best_valid_valid/diff': 30.545, 'best_valid_valid/acc_skew': 68.713, 'best_valid_valid/acc_align': 99.258, 'best_valid_test/acc': 87.653, 'best_valid_test/acc_unbiased': 78.763, 'best_valid_test/diff': 40.774, 'best_valid_test/acc_skew': 58.376, 'best_valid_test/acc_align': 99.149}
[5 / 10] best test accuracy: 78.763 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 98.4, 'best_test_valid/acc_unbiased': 83.986, 'best_test_valid/diff': 30.545, 'best_test_valid/acc_skew': 68.713, 'best_test_valid/acc_align': 99.258, 'best_test_test/acc': 87.653, 'best_test_test/acc_unbiased': 78.763, 'best_test_test/diff': 40.774, 'best_test_test/acc_skew': 58.376, 'best_test_test/acc_align': 99.149}
[6 / 10] Learning rate: 0.0001
[6 / 10] Loss: 0.0425
[6 / 10] tensor([[0.679, 0.996],
        [0.986, 0.297]]) {'epoch': 6, 'valid/acc': 98.696, 'valid/acc_unbiased': 83.583, 'valid/diff': 31.983, 'valid/acc_skew': 67.592, 'valid/acc_align': 99.575, 'test/acc': 85.192, 'test/acc_unbiased': 73.947, 'test/diff': 50.315, 'test/acc_skew': 48.789, 'test/acc_align': 99.104}
[6 / 10] best valid accuracy: 83.986 at epoch 4 
 best_stats: {'best_valid_epoch': 4, 'best_valid_valid/acc': 98.4, 'best_valid_valid/acc_unbiased': 83.986, 'best_valid_valid/diff': 30.545, 'best_valid_valid/acc_skew': 68.713, 'best_valid_valid/acc_align': 99.258, 'best_valid_test/acc': 87.653, 'best_valid_test/acc_unbiased': 78.763, 'best_valid_test/diff': 40.774, 'best_valid_test/acc_skew': 58.376, 'best_valid_test/acc_align': 99.149}
[6 / 10] best test accuracy: 78.763 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 98.4, 'best_test_valid/acc_unbiased': 83.986, 'best_test_valid/diff': 30.545, 'best_test_valid/acc_skew': 68.713, 'best_test_valid/acc_align': 99.258, 'best_test_test/acc': 87.653, 'best_test_test/acc_unbiased': 78.763, 'best_test_test/diff': 40.774, 'best_test_test/acc_skew': 58.376, 'best_test_test/acc_align': 99.149}
[7 / 10] Learning rate: 1e-05
[7 / 10] Loss: 0.0347
[7 / 10] tensor([[0.759, 0.994],
        [0.985, 0.429]]) {'epoch': 7, 'valid/acc': 98.814, 'valid/acc_unbiased': 87.704, 'valid/diff': 23.489, 'valid/acc_skew': 75.96, 'valid/acc_align': 99.449, 'test/acc': 88.66, 'test/acc_unbiased': 79.161, 'test/diff': 39.543, 'test/acc_skew': 59.39, 'test/acc_align': 98.932}
[7 / 10] best valid accuracy: 87.704 at epoch 7 
 best_stats: {'best_valid_epoch': 7, 'best_valid_valid/acc': 98.814, 'best_valid_valid/acc_unbiased': 87.704, 'best_valid_valid/diff': 23.489, 'best_valid_valid/acc_skew': 75.96, 'best_valid_valid/acc_align': 99.449, 'best_valid_test/acc': 88.66, 'best_valid_test/acc_unbiased': 79.161, 'best_valid_test/diff': 39.543, 'best_valid_test/acc_skew': 59.39, 'best_valid_test/acc_align': 98.932}
[7 / 10] best test accuracy: 79.161 at epoch 7 
 best_stats: {'best_test_epoch': 7, 'best_test_valid/acc': 98.814, 'best_test_valid/acc_unbiased': 87.704, 'best_test_valid/diff': 23.489, 'best_test_valid/acc_skew': 75.96, 'best_test_valid/acc_align': 99.449, 'best_test_test/acc': 88.66, 'best_test_test/acc_unbiased': 79.161, 'best_test_test/diff': 39.543, 'best_test_test/acc_skew': 59.39, 'best_test_test/acc_align': 98.932}
[8 / 10] Learning rate: 1e-05
[8 / 10] Loss: 0.0319
[8 / 10] tensor([[0.749, 0.994],
        [0.985, 0.456]]) {'epoch': 8, 'valid/acc': 98.943, 'valid/acc_unbiased': 88.679, 'valid/diff': 21.744, 'valid/acc_skew': 77.807, 'valid/acc_align': 99.552, 'test/acc': 88.237, 'test/acc_unbiased': 79.599, 'test/diff': 38.737, 'test/acc_skew': 60.23, 'test/acc_align': 98.967}
[8 / 10] best valid accuracy: 88.679 at epoch 8 
 best_stats: {'best_valid_epoch': 8, 'best_valid_valid/acc': 98.943, 'best_valid_valid/acc_unbiased': 88.679, 'best_valid_valid/diff': 21.744, 'best_valid_valid/acc_skew': 77.807, 'best_valid_valid/acc_align': 99.552, 'best_valid_test/acc': 88.237, 'best_valid_test/acc_unbiased': 79.599, 'best_valid_test/diff': 38.737, 'best_valid_test/acc_skew': 60.23, 'best_valid_test/acc_align': 98.967}
[8 / 10] best test accuracy: 79.599 at epoch 8 
 best_stats: {'best_test_epoch': 8, 'best_test_valid/acc': 98.943, 'best_test_valid/acc_unbiased': 88.679, 'best_test_valid/diff': 21.744, 'best_test_valid/acc_skew': 77.807, 'best_test_valid/acc_align': 99.552, 'best_test_test/acc': 88.237, 'best_test_test/acc_unbiased': 79.599, 'best_test_test/diff': 38.737, 'best_test_test/acc_skew': 60.23, 'best_test_test/acc_align': 98.967}
[9 / 10] Learning rate: 1e-05
[9 / 10] Loss: 0.0295
[9 / 10] tensor([[0.766, 0.995],
        [0.984, 0.418]]) {'epoch': 9, 'valid/acc': 98.964, 'valid/acc_unbiased': 88.107, 'valid/diff': 22.842, 'valid/acc_skew': 76.686, 'valid/acc_align': 99.527, 'test/acc': 88.946, 'test/acc_unbiased': 79.043, 'test/diff': 39.772, 'test/acc_skew': 59.157, 'test/acc_align': 98.929}
[9 / 10] best valid accuracy: 88.679 at epoch 8 
 best_stats: {'best_valid_epoch': 8, 'best_valid_valid/acc': 98.943, 'best_valid_valid/acc_unbiased': 88.679, 'best_valid_valid/diff': 21.744, 'best_valid_valid/acc_skew': 77.807, 'best_valid_valid/acc_align': 99.552, 'best_valid_test/acc': 88.237, 'best_valid_test/acc_unbiased': 79.599, 'best_valid_test/diff': 38.737, 'best_valid_test/acc_skew': 60.23, 'best_valid_test/acc_align': 98.967}
[9 / 10] best test accuracy: 79.599 at epoch 8 
 best_stats: {'best_test_epoch': 8, 'best_test_valid/acc': 98.943, 'best_test_valid/acc_unbiased': 88.679, 'best_test_valid/diff': 21.744, 'best_test_valid/acc_skew': 77.807, 'best_test_valid/acc_align': 99.552, 'best_test_test/acc': 88.237, 'best_test_test/acc_unbiased': 79.599, 'best_test_test/diff': 38.737, 'best_test_test/acc_skew': 60.23, 'best_test_test/acc_align': 98.967}
[10 / 10] Learning rate: 1e-05
[10 / 10] Loss: 0.0278
[10 / 10] tensor([[0.776, 0.994],
        [0.983, 0.429]]) {'epoch': 10, 'valid/acc': 99.05, 'valid/acc_unbiased': 89.302, 'valid/diff': 20.515, 'valid/acc_skew': 79.045, 'valid/acc_align': 99.56, 'test/acc': 89.364, 'test/acc_unbiased': 79.537, 'test/diff': 38.619, 'test/acc_skew': 60.228, 'test/acc_align': 98.846}
[10 / 10] best valid accuracy: 89.302 at epoch 10 
 best_stats: {'best_valid_epoch': 10, 'best_valid_valid/acc': 99.05, 'best_valid_valid/acc_unbiased': 89.302, 'best_valid_valid/diff': 20.515, 'best_valid_valid/acc_skew': 79.045, 'best_valid_valid/acc_align': 99.56, 'best_valid_test/acc': 89.364, 'best_valid_test/acc_unbiased': 79.537, 'best_valid_test/diff': 38.619, 'best_valid_test/acc_skew': 60.228, 'best_valid_test/acc_align': 98.846}
[10 / 10] best test accuracy: 79.599 at epoch 8 
 best_stats: {'best_test_epoch': 8, 'best_test_valid/acc': 98.943, 'best_test_valid/acc_unbiased': 88.679, 'best_test_valid/diff': 21.744, 'best_test_valid/acc_skew': 77.807, 'best_test_valid/acc_align': 99.552, 'best_test_test/acc': 88.237, 'best_test_test/acc_unbiased': 79.599, 'best_test_test/diff': 38.737, 'best_test_test/acc_skew': 60.23, 'best_test_test/acc_align': 98.967}
Total training time: 0:48:17
