Log level set to: INFO
Set seed: 1
=======> Using Fixed Random Seed: 1 <========
save_path: exp_results/bc-bb0-utk_face_age-uw-0.3-lr0.001-bs128-cbs64-w0.01-ratio10-aug1-seed1
get_utk_face - split: train, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_age-0.3
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [8237, 1033]
Target 1: [5765, 1477]
Binary Target 1
---------------------------
Target 0: [8237, 1033]
Target 1: [5765, 1477]
===================================
Normal Label Distribution: 
Target 0: [8237, 1033]
Target 1: [5765, 1477]
===================================
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [8237, 1033]
Target 1: [5765, 1477]
Binary Target 1
---------------------------
Target 0: [8237, 1033]
Target 1: [5765, 1477]
===================================
Normal Label Distribution: 
Target 0: [8237, 1033]
Target 1: [5765, 1477]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 16512, target_attr: gender, bias_attr: age bias_rate: 0.3
['[train] target_0-bias_0: 8237', '[train] target_0-bias_1: 1033', '[train] target_1-bias_0: 5765', '[train] target_1-bias_1: 1477']
confusion_matrix - 
 original: tensor([[8237., 5765.],
        [1033., 1477.]]), 
 normalized: tensor([[0.588, 0.412],
        [0.412, 0.588]]), 
 b|y: tensor([[0.889, 0.111],
        [0.796, 0.204]])
get_utk_face - split: train, aug: 1, given_y: True, ratio: 10
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_age-0.3
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [8237, 1033]
Target 1: [5765, 1477]
Binary Target 1
---------------------------
Target 0: [8237, 1033]
Target 1: [5765, 1477]
===================================
Normal Label Distribution: 
Target 0: [8237, 1033]
Target 1: [5765, 1477]
===================================
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [8237, 1033]
Target 1: [5765, 1477]
Binary Target 1
---------------------------
Target 0: [8237, 1033]
Target 1: [5765, 1477]
===================================
Normal Label Distribution: 
Target 0: [8237, 1033]
Target 1: [5765, 1477]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 16512, target_attr: gender, bias_attr: age bias_rate: 0.3
['[train] target_0-bias_0: 8237', '[train] target_0-bias_1: 1033', '[train] target_1-bias_0: 5765', '[train] target_1-bias_1: 1477']
get_utk_face - split: valid, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_age-0.3
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [1030, 195]
Target 1: [841, 202]
Binary Target 1
---------------------------
Target 0: [1030, 195]
Target 1: [841, 202]
===================================
Normal Label Distribution: 
Target 0: [1030, 195]
Target 1: [841, 202]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 2268, target_attr: gender, bias_attr: age bias_rate: 0.3
['[valid] target_0-bias_0: 1030', '[valid] target_0-bias_1: 195', '[valid] target_1-bias_0: 841', '[valid] target_1-bias_1: 202']
get_utk_face - split: test, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_age-0.3
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [1061, 176]
Target 1: [867, 165]
Binary Target 1
---------------------------
Target 0: [1061, 176]
Target 1: [867, 165]
===================================
Normal Label Distribution: 
Target 0: [1061, 176]
Target 1: [867, 165]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 2269, target_attr: gender, bias_attr: age bias_rate: 0.3
['[test] target_0-bias_0: 1061', '[test] target_0-bias_1: 176', '[test] target_1-bias_0: 867', '[test] target_1-bias_1: 165']
decay_epochs: [6, 13]
[1 / 20] Learning rate: 0.001 weight: 0.01
[1 / 20] Loss: 4.911625037821689 CE Loss: 2.530296273009722 Con Loss: 4.88632206584132
[1 / 20] tensor([[0.886, 0.830],
        [0.710, 0.461]]) {'epoch': 1, 'valid/acc': 77.381, 'valid/acc_unbiased': 73.133, 'valid/diff': 11.226, 'valid/acc_skew': 67.52, 'valid/acc_align': 78.746, 'test/acc': 78.361, 'test/acc_unbiased': 72.165, 'test/diff': 15.315, 'test/acc_skew': 64.508, 'test/acc_align': 79.823}
[1 / 20] best valid accuracy: 73.133 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 77.381, 'best_valid_valid/acc_unbiased': 73.133, 'best_valid_valid/diff': 11.226, 'best_valid_valid/acc_skew': 67.52, 'best_valid_valid/acc_align': 78.746, 'best_valid_test/acc': 78.361, 'best_valid_test/acc_unbiased': 72.165, 'best_valid_test/diff': 15.315, 'best_valid_test/acc_skew': 64.508, 'best_valid_test/acc_align': 79.823}
[1 / 20] best test accuracy: 72.165 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 77.381, 'best_test_valid/acc_unbiased': 73.133, 'best_test_valid/diff': 11.226, 'best_test_valid/acc_skew': 67.52, 'best_test_valid/acc_align': 78.746, 'best_test_test/acc': 78.361, 'best_test_test/acc_unbiased': 72.165, 'best_test_test/diff': 15.315, 'best_test_test/acc_skew': 64.508, 'best_test_test/acc_align': 79.823}
[2 / 20] Learning rate: 0.001 weight: 0.01
[2 / 20] Loss: 4.838754639145016 CE Loss: 2.20498620354852 Con Loss: 4.816704757453859
[2 / 20] tensor([[0.870, 0.648],
        [0.785, 0.606]]) {'epoch': 2, 'valid/acc': 80.688, 'valid/acc_unbiased': 74.749, 'valid/diff': 16.865, 'valid/acc_skew': 66.316, 'valid/acc_align': 83.181, 'test/acc': 80.123, 'test/acc_unbiased': 72.73, 'test/diff': 20.081, 'test/acc_skew': 62.689, 'test/acc_align': 82.77}
[2 / 20] best valid accuracy: 74.749 at epoch 2 
 best_stats: {'best_valid_epoch': 2, 'best_valid_valid/acc': 80.688, 'best_valid_valid/acc_unbiased': 74.749, 'best_valid_valid/diff': 16.865, 'best_valid_valid/acc_skew': 66.316, 'best_valid_valid/acc_align': 83.181, 'best_valid_test/acc': 80.123, 'best_valid_test/acc_unbiased': 72.73, 'best_valid_test/diff': 20.081, 'best_valid_test/acc_skew': 62.689, 'best_valid_test/acc_align': 82.77}
[2 / 20] best test accuracy: 72.730 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 80.688, 'best_test_valid/acc_unbiased': 74.749, 'best_test_valid/diff': 16.865, 'best_test_valid/acc_skew': 66.316, 'best_test_valid/acc_align': 83.181, 'best_test_test/acc': 80.123, 'best_test_test/acc_unbiased': 72.73, 'best_test_test/diff': 20.081, 'best_test_test/acc_skew': 62.689, 'best_test_test/acc_align': 82.77}
[3 / 20] Learning rate: 0.001 weight: 0.01
[3 / 20] Loss: 4.831392121869464 CE Loss: 2.099062995393147 Con Loss: 4.810401484023693
[3 / 20] tensor([[0.913, 0.767],
        [0.753, 0.667]]) {'epoch': 3, 'valid/acc': 82.407, 'valid/acc_unbiased': 77.577, 'valid/diff': 12.974, 'valid/acc_skew': 71.09, 'valid/acc_align': 84.064, 'test/acc': 82.283, 'test/acc_unbiased': 77.504, 'test/diff': 11.637, 'test/acc_skew': 71.686, 'test/acc_align': 83.323}
[3 / 20] best valid accuracy: 77.577 at epoch 3 
 best_stats: {'best_valid_epoch': 3, 'best_valid_valid/acc': 82.407, 'best_valid_valid/acc_unbiased': 77.577, 'best_valid_valid/diff': 12.974, 'best_valid_valid/acc_skew': 71.09, 'best_valid_valid/acc_align': 84.064, 'best_valid_test/acc': 82.283, 'best_valid_test/acc_unbiased': 77.504, 'best_valid_test/diff': 11.637, 'best_valid_test/acc_skew': 71.686, 'best_valid_test/acc_align': 83.323}
[3 / 20] best test accuracy: 77.504 at epoch 3 
 best_stats: {'best_test_epoch': 3, 'best_test_valid/acc': 82.407, 'best_test_valid/acc_unbiased': 77.577, 'best_test_valid/diff': 12.974, 'best_test_valid/acc_skew': 71.09, 'best_test_valid/acc_align': 84.064, 'best_test_test/acc': 82.283, 'best_test_test/acc_unbiased': 77.504, 'best_test_test/diff': 11.637, 'best_test_test/acc_skew': 71.686, 'best_test_test/acc_align': 83.323}
[4 / 20] Learning rate: 0.001 weight: 0.01
[4 / 20] Loss: 4.8184687444405965 CE Loss: 2.031030023744864 Con Loss: 4.79815844602363
[4 / 20] tensor([[0.943, 0.858],
        [0.691, 0.430]]) {'epoch': 4, 'valid/acc': 80.908, 'valid/acc_unbiased': 76.503, 'valid/diff': 10.381, 'valid/acc_skew': 71.313, 'valid/acc_align': 81.694, 'test/acc': 80.3, 'test/acc_unbiased': 73.065, 'test/diff': 17.304, 'test/acc_skew': 64.413, 'test/acc_align': 81.717}
[4 / 20] best valid accuracy: 77.577 at epoch 3 
 best_stats: {'best_valid_epoch': 3, 'best_valid_valid/acc': 82.407, 'best_valid_valid/acc_unbiased': 77.577, 'best_valid_valid/diff': 12.974, 'best_valid_valid/acc_skew': 71.09, 'best_valid_valid/acc_align': 84.064, 'best_valid_test/acc': 82.283, 'best_valid_test/acc_unbiased': 77.504, 'best_valid_test/diff': 11.637, 'best_valid_test/acc_skew': 71.686, 'best_valid_test/acc_align': 83.323}
[4 / 20] best test accuracy: 77.504 at epoch 3 
 best_stats: {'best_test_epoch': 3, 'best_test_valid/acc': 82.407, 'best_test_valid/acc_unbiased': 77.577, 'best_test_valid/diff': 12.974, 'best_test_valid/acc_skew': 71.09, 'best_test_valid/acc_align': 84.064, 'best_test_test/acc': 82.283, 'best_test_test/acc_unbiased': 77.504, 'best_test_test/diff': 11.637, 'best_test_test/acc_skew': 71.686, 'best_test_test/acc_align': 83.323}
[5 / 20] Learning rate: 0.001 weight: 0.01
[5 / 20] Loss: 4.813376116198163 CE Loss: 2.0226715322612794 Con Loss: 4.793149393658306
[5 / 20] tensor([[0.822, 0.636],
        [0.877, 0.752]]) {'epoch': 5, 'valid/acc': 82.099, 'valid/acc_unbiased': 77.963, 'valid/diff': 13.163, 'valid/acc_skew': 71.381, 'valid/acc_align': 84.544, 'test/acc': 82.327, 'test/acc_unbiased': 77.158, 'test/diff': 15.529, 'test/acc_skew': 69.394, 'test/acc_align': 84.923}
[5 / 20] best valid accuracy: 77.963 at epoch 5 
 best_stats: {'best_valid_epoch': 5, 'best_valid_valid/acc': 82.099, 'best_valid_valid/acc_unbiased': 77.963, 'best_valid_valid/diff': 13.163, 'best_valid_valid/acc_skew': 71.381, 'best_valid_valid/acc_align': 84.544, 'best_valid_test/acc': 82.327, 'best_valid_test/acc_unbiased': 77.158, 'best_valid_test/diff': 15.529, 'best_valid_test/acc_skew': 69.394, 'best_valid_test/acc_align': 84.923}
[5 / 20] best test accuracy: 77.504 at epoch 3 
 best_stats: {'best_test_epoch': 3, 'best_test_valid/acc': 82.407, 'best_test_valid/acc_unbiased': 77.577, 'best_test_valid/diff': 12.974, 'best_test_valid/acc_skew': 71.09, 'best_test_valid/acc_align': 84.064, 'best_test_test/acc': 82.283, 'best_test_test/acc_unbiased': 77.504, 'best_test_test/diff': 11.637, 'best_test_test/acc_skew': 71.686, 'best_test_test/acc_align': 83.323}
[6 / 20] Learning rate: 0.001 weight: 0.01
[6 / 20] Loss: 4.807422342226487 CE Loss: 1.945518926132557 Con Loss: 4.7879671532978385
[6 / 20] tensor([[0.928, 0.767],
        [0.753, 0.606]]) {'epoch': 6, 'valid/acc': 81.526, 'valid/acc_unbiased': 76.196, 'valid/diff': 14.136, 'valid/acc_skew': 69.128, 'valid/acc_align': 83.264, 'test/acc': 82.547, 'test/acc_unbiased': 76.366, 'test/diff': 15.422, 'test/acc_skew': 68.655, 'test/acc_align': 84.077}
[6 / 20] best valid accuracy: 77.963 at epoch 5 
 best_stats: {'best_valid_epoch': 5, 'best_valid_valid/acc': 82.099, 'best_valid_valid/acc_unbiased': 77.963, 'best_valid_valid/diff': 13.163, 'best_valid_valid/acc_skew': 71.381, 'best_valid_valid/acc_align': 84.544, 'best_valid_test/acc': 82.327, 'best_valid_test/acc_unbiased': 77.158, 'best_valid_test/diff': 15.529, 'best_valid_test/acc_skew': 69.394, 'best_valid_test/acc_align': 84.923}
[6 / 20] best test accuracy: 77.504 at epoch 3 
 best_stats: {'best_test_epoch': 3, 'best_test_valid/acc': 82.407, 'best_test_valid/acc_unbiased': 77.577, 'best_test_valid/diff': 12.974, 'best_test_valid/acc_skew': 71.09, 'best_test_valid/acc_align': 84.064, 'best_test_test/acc': 82.283, 'best_test_test/acc_unbiased': 77.504, 'best_test_test/diff': 11.637, 'best_test_test/acc_skew': 71.686, 'best_test_test/acc_align': 83.323}
[7 / 20] Learning rate: 0.0001 weight: 0.01
[7 / 20] Loss: 4.781386508498081 CE Loss: 1.8089471269947615 Con Loss: 4.763297051422356
[7 / 20] tensor([[0.909, 0.733],
        [0.851, 0.691]]) {'epoch': 7, 'valid/acc': 84.744, 'valid/acc_unbiased': 78.668, 'valid/diff': 17.951, 'valid/acc_skew': 69.693, 'valid/acc_align': 87.644, 'test/acc': 85.721, 'test/acc_unbiased': 79.591, 'test/diff': 16.796, 'test/acc_skew': 71.193, 'test/acc_align': 87.989}
[7 / 20] best valid accuracy: 78.668 at epoch 7 
 best_stats: {'best_valid_epoch': 7, 'best_valid_valid/acc': 84.744, 'best_valid_valid/acc_unbiased': 78.668, 'best_valid_valid/diff': 17.951, 'best_valid_valid/acc_skew': 69.693, 'best_valid_valid/acc_align': 87.644, 'best_valid_test/acc': 85.721, 'best_valid_test/acc_unbiased': 79.591, 'best_valid_test/diff': 16.796, 'best_valid_test/acc_skew': 71.193, 'best_valid_test/acc_align': 87.989}
[7 / 20] best test accuracy: 79.591 at epoch 7 
 best_stats: {'best_test_epoch': 7, 'best_test_valid/acc': 84.744, 'best_test_valid/acc_unbiased': 78.668, 'best_test_valid/diff': 17.951, 'best_test_valid/acc_skew': 69.693, 'best_test_valid/acc_align': 87.644, 'best_test_test/acc': 85.721, 'best_test_test/acc_unbiased': 79.591, 'best_test_test/diff': 16.796, 'best_test_test/acc_skew': 71.193, 'best_test_test/acc_align': 87.989}
[8 / 20] Learning rate: 0.0001 weight: 0.01
[8 / 20] Loss: 4.7508848064629605 CE Loss: 1.6957725868668667 Con Loss: 4.73392709465914
[8 / 20] tensor([[0.928, 0.750],
        [0.834, 0.667]]) {'epoch': 8, 'valid/acc': 85.406, 'valid/acc_unbiased': 79.628, 'valid/diff': 16.599, 'valid/acc_skew': 71.329, 'valid/acc_align': 87.928, 'test/acc': 85.941, 'test/acc_unbiased': 79.474, 'test/diff': 17.281, 'test/acc_skew': 70.833, 'test/acc_align': 88.114}
[8 / 20] best valid accuracy: 79.628 at epoch 8 
 best_stats: {'best_valid_epoch': 8, 'best_valid_valid/acc': 85.406, 'best_valid_valid/acc_unbiased': 79.628, 'best_valid_valid/diff': 16.599, 'best_valid_valid/acc_skew': 71.329, 'best_valid_valid/acc_align': 87.928, 'best_valid_test/acc': 85.941, 'best_valid_test/acc_unbiased': 79.474, 'best_valid_test/diff': 17.281, 'best_valid_test/acc_skew': 70.833, 'best_valid_test/acc_align': 88.114}
[8 / 20] best test accuracy: 79.591 at epoch 7 
 best_stats: {'best_test_epoch': 7, 'best_test_valid/acc': 84.744, 'best_test_valid/acc_unbiased': 78.668, 'best_test_valid/diff': 17.951, 'best_test_valid/acc_skew': 69.693, 'best_test_valid/acc_align': 87.644, 'best_test_test/acc': 85.721, 'best_test_test/acc_unbiased': 79.591, 'best_test_test/diff': 16.796, 'best_test_test/acc_skew': 71.193, 'best_test_test/acc_align': 87.989}
[9 / 20] Learning rate: 0.0001 weight: 0.01
[9 / 20] Loss: 4.745940034703691 CE Loss: 1.656013052592906 Con Loss: 4.729379897893861
[9 / 20] tensor([[0.882, 0.659],
        [0.884, 0.764]]) {'epoch': 9, 'valid/acc': 85.097, 'valid/acc_unbiased': 79.404, 'valid/diff': 17.142, 'valid/acc_skew': 70.833, 'valid/acc_align': 87.975, 'test/acc': 85.677, 'test/acc_unbiased': 79.711, 'test/diff': 17.148, 'test/acc_skew': 71.136, 'test/acc_align': 88.285}
[9 / 20] best valid accuracy: 79.628 at epoch 8 
 best_stats: {'best_valid_epoch': 8, 'best_valid_valid/acc': 85.406, 'best_valid_valid/acc_unbiased': 79.628, 'best_valid_valid/diff': 16.599, 'best_valid_valid/acc_skew': 71.329, 'best_valid_valid/acc_align': 87.928, 'best_valid_test/acc': 85.941, 'best_valid_test/acc_unbiased': 79.474, 'best_valid_test/diff': 17.281, 'best_valid_test/acc_skew': 70.833, 'best_valid_test/acc_align': 88.114}
[9 / 20] best test accuracy: 79.711 at epoch 9 
 best_stats: {'best_test_epoch': 9, 'best_test_valid/acc': 85.097, 'best_test_valid/acc_unbiased': 79.404, 'best_test_valid/diff': 17.142, 'best_test_valid/acc_skew': 70.833, 'best_test_valid/acc_align': 87.975, 'best_test_test/acc': 85.677, 'best_test_test/acc_unbiased': 79.711, 'best_test_test/diff': 17.148, 'best_test_test/acc_skew': 71.136, 'best_test_test/acc_align': 88.285}
[10 / 20] Learning rate: 0.0001 weight: 0.01
[10 / 20] Loss: 4.735461600991183 CE Loss: 1.5953076574229454 Con Loss: 4.719508514847866
[10 / 20] tensor([[0.926, 0.778],
        [0.855, 0.661]]) {'epoch': 10, 'valid/acc': 86.464, 'valid/acc_unbiased': 80.989, 'valid/diff': 15.747, 'valid/acc_skew': 73.115, 'valid/acc_align': 88.862, 'test/acc': 86.778, 'test/acc_unbiased': 80.481, 'test/diff': 17.06, 'test/acc_skew': 71.951, 'test/acc_align': 89.011}
[10 / 20] best valid accuracy: 80.989 at epoch 10 
 best_stats: {'best_valid_epoch': 10, 'best_valid_valid/acc': 86.464, 'best_valid_valid/acc_unbiased': 80.989, 'best_valid_valid/diff': 15.747, 'best_valid_valid/acc_skew': 73.115, 'best_valid_valid/acc_align': 88.862, 'best_valid_test/acc': 86.778, 'best_valid_test/acc_unbiased': 80.481, 'best_valid_test/diff': 17.06, 'best_valid_test/acc_skew': 71.951, 'best_valid_test/acc_align': 89.011}
[10 / 20] best test accuracy: 80.481 at epoch 10 
 best_stats: {'best_test_epoch': 10, 'best_test_valid/acc': 86.464, 'best_test_valid/acc_unbiased': 80.989, 'best_test_valid/diff': 15.747, 'best_test_valid/acc_skew': 73.115, 'best_test_valid/acc_align': 88.862, 'best_test_test/acc': 86.778, 'best_test_test/acc_unbiased': 80.481, 'best_test_test/diff': 17.06, 'best_test_test/acc_skew': 71.951, 'best_test_test/acc_align': 89.011}
[11 / 20] Learning rate: 0.0001 weight: 0.01
[11 / 20] Loss: 4.7152134762253874 CE Loss: 1.5361291682997416 Con Loss: 4.699852181959522
[11 / 20] tensor([[0.907, 0.688],
        [0.880, 0.770]]) {'epoch': 11, 'valid/acc': 86.067, 'valid/acc_unbiased': 80.663, 'valid/diff': 15.928, 'valid/acc_skew': 72.699, 'valid/acc_align': 88.627, 'test/acc': 86.955, 'test/acc_unbiased': 81.098, 'test/diff': 16.477, 'test/acc_skew': 72.86, 'test/acc_align': 89.337}
[11 / 20] best valid accuracy: 80.989 at epoch 10 
 best_stats: {'best_valid_epoch': 10, 'best_valid_valid/acc': 86.464, 'best_valid_valid/acc_unbiased': 80.989, 'best_valid_valid/diff': 15.747, 'best_valid_valid/acc_skew': 73.115, 'best_valid_valid/acc_align': 88.862, 'best_valid_test/acc': 86.778, 'best_valid_test/acc_unbiased': 80.481, 'best_valid_test/diff': 17.06, 'best_valid_test/acc_skew': 71.951, 'best_valid_test/acc_align': 89.011}
[11 / 20] best test accuracy: 81.098 at epoch 11 
 best_stats: {'best_test_epoch': 11, 'best_test_valid/acc': 86.067, 'best_test_valid/acc_unbiased': 80.663, 'best_test_valid/diff': 15.928, 'best_test_valid/acc_skew': 72.699, 'best_test_valid/acc_align': 88.627, 'best_test_test/acc': 86.955, 'best_test_test/acc_unbiased': 81.098, 'best_test_test/diff': 16.477, 'best_test_test/acc_skew': 72.86, 'best_test_test/acc_align': 89.337}
[12 / 20] Learning rate: 0.0001 weight: 0.01
[12 / 20] Loss: 4.708256266837896 CE Loss: 1.5083265956058058 Con Loss: 4.693173005599384
[12 / 20] tensor([[0.909, 0.761],
        [0.872, 0.727]]) {'epoch': 12, 'valid/acc': 86.905, 'valid/acc_unbiased': 81.973, 'valid/diff': 14.375, 'valid/acc_skew': 74.785, 'valid/acc_align': 89.161, 'test/acc': 86.999, 'test/acc_unbiased': 81.73, 'test/diff': 14.596, 'test/acc_skew': 74.432, 'test/acc_align': 89.027}
[12 / 20] best valid accuracy: 81.973 at epoch 12 
 best_stats: {'best_valid_epoch': 12, 'best_valid_valid/acc': 86.905, 'best_valid_valid/acc_unbiased': 81.973, 'best_valid_valid/diff': 14.375, 'best_valid_valid/acc_skew': 74.785, 'best_valid_valid/acc_align': 89.161, 'best_valid_test/acc': 86.999, 'best_valid_test/acc_unbiased': 81.73, 'best_valid_test/diff': 14.596, 'best_valid_test/acc_skew': 74.432, 'best_valid_test/acc_align': 89.027}
[12 / 20] best test accuracy: 81.730 at epoch 12 
 best_stats: {'best_test_epoch': 12, 'best_test_valid/acc': 86.905, 'best_test_valid/acc_unbiased': 81.973, 'best_test_valid/diff': 14.375, 'best_test_valid/acc_skew': 74.785, 'best_test_valid/acc_align': 89.161, 'best_test_test/acc': 86.999, 'best_test_test/acc_unbiased': 81.73, 'best_test_test/diff': 14.596, 'best_test_test/acc_skew': 74.432, 'best_test_test/acc_align': 89.027}
[13 / 20] Learning rate: 0.0001 weight: 0.01
[13 / 20] Loss: 4.716923373614171 CE Loss: 1.5265694302181865 Con Loss: 4.701657683350319
[13 / 20] tensor([[0.922, 0.767],
        [0.850, 0.709]]) {'epoch': 13, 'valid/acc': 86.42, 'valid/acc_unbiased': 81.052, 'valid/diff': 15.469, 'valid/acc_skew': 73.318, 'valid/acc_align': 88.787, 'test/acc': 86.69, 'test/acc_unbiased': 81.199, 'test/diff': 14.785, 'test/acc_skew': 73.807, 'test/acc_align': 88.591}
[13 / 20] best valid accuracy: 81.973 at epoch 12 
 best_stats: {'best_valid_epoch': 12, 'best_valid_valid/acc': 86.905, 'best_valid_valid/acc_unbiased': 81.973, 'best_valid_valid/diff': 14.375, 'best_valid_valid/acc_skew': 74.785, 'best_valid_valid/acc_align': 89.161, 'best_valid_test/acc': 86.999, 'best_valid_test/acc_unbiased': 81.73, 'best_valid_test/diff': 14.596, 'best_valid_test/acc_skew': 74.432, 'best_valid_test/acc_align': 89.027}
[13 / 20] best test accuracy: 81.730 at epoch 12 
 best_stats: {'best_test_epoch': 12, 'best_test_valid/acc': 86.905, 'best_test_valid/acc_unbiased': 81.973, 'best_test_valid/diff': 14.375, 'best_test_valid/acc_skew': 74.785, 'best_test_valid/acc_align': 89.161, 'best_test_test/acc': 86.999, 'best_test_test/acc_unbiased': 81.73, 'best_test_test/diff': 14.596, 'best_test_test/acc_skew': 74.432, 'best_test_test/acc_align': 89.027}
[14 / 20] Learning rate: 1e-05 weight: 0.01
[14 / 20] Loss: 4.696615451990172 CE Loss: 1.4851864451585814 Con Loss: 4.68176360093346
[14 / 20] tensor([[0.926, 0.767],
        [0.866, 0.733]]) {'epoch': 14, 'valid/acc': 86.905, 'valid/acc_unbiased': 81.435, 'valid/diff': 15.739, 'valid/acc_skew': 73.566, 'valid/acc_align': 89.305, 'test/acc': 87.704, 'test/acc_unbiased': 82.327, 'test/diff': 14.616, 'test/acc_skew': 75.019, 'test/acc_align': 89.634}
[14 / 20] best valid accuracy: 81.973 at epoch 12 
 best_stats: {'best_valid_epoch': 12, 'best_valid_valid/acc': 86.905, 'best_valid_valid/acc_unbiased': 81.973, 'best_valid_valid/diff': 14.375, 'best_valid_valid/acc_skew': 74.785, 'best_valid_valid/acc_align': 89.161, 'best_valid_test/acc': 86.999, 'best_valid_test/acc_unbiased': 81.73, 'best_valid_test/diff': 14.596, 'best_valid_test/acc_skew': 74.432, 'best_valid_test/acc_align': 89.027}
[14 / 20] best test accuracy: 82.327 at epoch 14 
 best_stats: {'best_test_epoch': 14, 'best_test_valid/acc': 86.905, 'best_test_valid/acc_unbiased': 81.435, 'best_test_valid/diff': 15.739, 'best_test_valid/acc_skew': 73.566, 'best_test_valid/acc_align': 89.305, 'best_test_test/acc': 87.704, 'best_test_test/acc_unbiased': 82.327, 'best_test_test/diff': 14.616, 'best_test_test/acc_skew': 75.019, 'best_test_test/acc_align': 89.634}
[15 / 20] Learning rate: 1e-05 weight: 0.01
[15 / 20] Loss: 4.708063846410707 CE Loss: 1.4433904091517131 Con Loss: 4.693629948667778
[15 / 20] tensor([[0.915, 0.739],
        [0.884, 0.764]]) {'epoch': 15, 'valid/acc': 86.905, 'valid/acc_unbiased': 81.604, 'valid/diff': 15.741, 'valid/acc_skew': 73.733, 'valid/acc_align': 89.475, 'test/acc': 87.836, 'test/acc_unbiased': 82.524, 'test/diff': 14.82, 'test/acc_skew': 75.114, 'test/acc_align': 89.934}
[15 / 20] best valid accuracy: 81.973 at epoch 12 
 best_stats: {'best_valid_epoch': 12, 'best_valid_valid/acc': 86.905, 'best_valid_valid/acc_unbiased': 81.973, 'best_valid_valid/diff': 14.375, 'best_valid_valid/acc_skew': 74.785, 'best_valid_valid/acc_align': 89.161, 'best_valid_test/acc': 86.999, 'best_valid_test/acc_unbiased': 81.73, 'best_valid_test/diff': 14.596, 'best_valid_test/acc_skew': 74.432, 'best_valid_test/acc_align': 89.027}
[15 / 20] best test accuracy: 82.524 at epoch 15 
 best_stats: {'best_test_epoch': 15, 'best_test_valid/acc': 86.905, 'best_test_valid/acc_unbiased': 81.604, 'best_test_valid/diff': 15.741, 'best_test_valid/acc_skew': 73.733, 'best_test_valid/acc_align': 89.475, 'best_test_test/acc': 87.836, 'best_test_test/acc_unbiased': 82.524, 'best_test_test/diff': 14.82, 'best_test_test/acc_skew': 75.114, 'best_test_test/acc_align': 89.934}
[16 / 20] Learning rate: 1e-05 weight: 0.01
[16 / 20] Loss: 4.696052259252977 CE Loss: 1.4226726538451142 Con Loss: 4.681825526925021
[16 / 20] tensor([[0.923, 0.750],
        [0.882, 0.752]]) {'epoch': 16, 'valid/acc': 87.125, 'valid/acc_unbiased': 81.941, 'valid/diff': 15.337, 'valid/acc_skew': 74.273, 'valid/acc_align': 89.609, 'test/acc': 88.145, 'test/acc_unbiased': 82.665, 'test/diff': 15.178, 'test/acc_skew': 75.076, 'test/acc_align': 90.253}
[16 / 20] best valid accuracy: 81.973 at epoch 12 
 best_stats: {'best_valid_epoch': 12, 'best_valid_valid/acc': 86.905, 'best_valid_valid/acc_unbiased': 81.973, 'best_valid_valid/diff': 14.375, 'best_valid_valid/acc_skew': 74.785, 'best_valid_valid/acc_align': 89.161, 'best_valid_test/acc': 86.999, 'best_valid_test/acc_unbiased': 81.73, 'best_valid_test/diff': 14.596, 'best_valid_test/acc_skew': 74.432, 'best_valid_test/acc_align': 89.027}
[16 / 20] best test accuracy: 82.665 at epoch 16 
 best_stats: {'best_test_epoch': 16, 'best_test_valid/acc': 87.125, 'best_test_valid/acc_unbiased': 81.941, 'best_test_valid/diff': 15.337, 'best_test_valid/acc_skew': 74.273, 'best_test_valid/acc_align': 89.609, 'best_test_test/acc': 88.145, 'best_test_test/acc_unbiased': 82.665, 'best_test_test/diff': 15.178, 'best_test_test/acc_skew': 75.076, 'best_test_test/acc_align': 90.253}
[17 / 20] Learning rate: 1e-05 weight: 0.01
[17 / 20] Loss: 4.687638619149378 CE Loss: 1.4095024406447891 Con Loss: 4.673543601073036
[17 / 20] tensor([[0.931, 0.773],
        [0.866, 0.745]]) {'epoch': 17, 'valid/acc': 87.302, 'valid/acc_unbiased': 82.101, 'valid/diff': 15.09, 'valid/acc_skew': 74.556, 'valid/acc_align': 89.646, 'test/acc': 88.056, 'test/acc_unbiased': 82.89, 'test/diff': 13.961, 'test/acc_skew': 75.909, 'test/acc_align': 89.87}
[17 / 20] best valid accuracy: 82.101 at epoch 17 
 best_stats: {'best_valid_epoch': 17, 'best_valid_valid/acc': 87.302, 'best_valid_valid/acc_unbiased': 82.101, 'best_valid_valid/diff': 15.09, 'best_valid_valid/acc_skew': 74.556, 'best_valid_valid/acc_align': 89.646, 'best_valid_test/acc': 88.056, 'best_valid_test/acc_unbiased': 82.89, 'best_valid_test/diff': 13.961, 'best_valid_test/acc_skew': 75.909, 'best_valid_test/acc_align': 89.87}
[17 / 20] best test accuracy: 82.890 at epoch 17 
 best_stats: {'best_test_epoch': 17, 'best_test_valid/acc': 87.302, 'best_test_valid/acc_unbiased': 82.101, 'best_test_valid/diff': 15.09, 'best_test_valid/acc_skew': 74.556, 'best_test_valid/acc_align': 89.646, 'best_test_test/acc': 88.056, 'best_test_test/acc_unbiased': 82.89, 'best_test_test/diff': 13.961, 'best_test_test/acc_skew': 75.909, 'best_test_test/acc_align': 89.87}
[18 / 20] Learning rate: 1e-05 weight: 0.01
[18 / 20] Loss: 4.690002659494563 CE Loss: 1.402305620585301 Con Loss: 4.675979617954225
[18 / 20] tensor([[0.926, 0.761],
        [0.881, 0.745]]) {'epoch': 18, 'valid/acc': 87.39, 'valid/acc_unbiased': 82.179, 'valid/diff': 15.281, 'valid/acc_skew': 74.538, 'valid/acc_align': 89.819, 'test/acc': 88.321, 'test/acc_unbiased': 82.863, 'test/diff': 15.043, 'test/acc_skew': 75.341, 'test/acc_align': 90.384}
[18 / 20] best valid accuracy: 82.179 at epoch 18 
 best_stats: {'best_valid_epoch': 18, 'best_valid_valid/acc': 87.39, 'best_valid_valid/acc_unbiased': 82.179, 'best_valid_valid/diff': 15.281, 'best_valid_valid/acc_skew': 74.538, 'best_valid_valid/acc_align': 89.819, 'best_valid_test/acc': 88.321, 'best_valid_test/acc_unbiased': 82.863, 'best_valid_test/diff': 15.043, 'best_valid_test/acc_skew': 75.341, 'best_valid_test/acc_align': 90.384}
[18 / 20] best test accuracy: 82.890 at epoch 17 
 best_stats: {'best_test_epoch': 17, 'best_test_valid/acc': 87.302, 'best_test_valid/acc_unbiased': 82.101, 'best_test_valid/diff': 15.09, 'best_test_valid/acc_skew': 74.556, 'best_test_valid/acc_align': 89.646, 'best_test_test/acc': 88.056, 'best_test_test/acc_unbiased': 82.89, 'best_test_test/diff': 13.961, 'best_test_test/acc_skew': 75.909, 'best_test_test/acc_align': 89.87}
[19 / 20] Learning rate: 1e-05 weight: 0.01
[19 / 20] Loss: 4.687107869821001 CE Loss: 1.4036601800327153 Con Loss: 4.6730712661447456
[19 / 20] tensor([[0.929, 0.756],
        [0.875, 0.745]]) {'epoch': 19, 'valid/acc': 87.478, 'valid/acc_unbiased': 82.316, 'valid/diff': 15.061, 'valid/acc_skew': 74.785, 'valid/acc_align': 89.846, 'test/acc': 88.189, 'test/acc_unbiased': 82.647, 'test/diff': 15.18, 'test/acc_skew': 75.057, 'test/acc_align': 90.237}
[19 / 20] best valid accuracy: 82.316 at epoch 19 
 best_stats: {'best_valid_epoch': 19, 'best_valid_valid/acc': 87.478, 'best_valid_valid/acc_unbiased': 82.316, 'best_valid_valid/diff': 15.061, 'best_valid_valid/acc_skew': 74.785, 'best_valid_valid/acc_align': 89.846, 'best_valid_test/acc': 88.189, 'best_valid_test/acc_unbiased': 82.647, 'best_valid_test/diff': 15.18, 'best_valid_test/acc_skew': 75.057, 'best_valid_test/acc_align': 90.237}
[19 / 20] best test accuracy: 82.890 at epoch 17 
 best_stats: {'best_test_epoch': 17, 'best_test_valid/acc': 87.302, 'best_test_valid/acc_unbiased': 82.101, 'best_test_valid/diff': 15.09, 'best_test_valid/acc_skew': 74.556, 'best_test_valid/acc_align': 89.646, 'best_test_test/acc': 88.056, 'best_test_test/acc_unbiased': 82.89, 'best_test_test/diff': 13.961, 'best_test_test/acc_skew': 75.909, 'best_test_test/acc_align': 89.87}
[20 / 20] Learning rate: 1e-05 weight: 0.01
[20 / 20] Loss: 4.687877740046774 CE Loss: 1.424705442070037 Con Loss: 4.673630684845207
[20 / 20] tensor([[0.928, 0.761],
        [0.875, 0.745]]) {'epoch': 20, 'valid/acc': 87.257, 'valid/acc_unbiased': 81.703, 'valid/diff': 16.329, 'valid/acc_skew': 73.539, 'valid/acc_align': 89.868, 'test/acc': 88.189, 'test/acc_unbiased': 82.766, 'test/diff': 14.849, 'test/acc_skew': 75.341, 'test/acc_align': 90.19}
[20 / 20] best valid accuracy: 82.316 at epoch 19 
 best_stats: {'best_valid_epoch': 19, 'best_valid_valid/acc': 87.478, 'best_valid_valid/acc_unbiased': 82.316, 'best_valid_valid/diff': 15.061, 'best_valid_valid/acc_skew': 74.785, 'best_valid_valid/acc_align': 89.846, 'best_valid_test/acc': 88.189, 'best_valid_test/acc_unbiased': 82.647, 'best_valid_test/diff': 15.18, 'best_valid_test/acc_skew': 75.057, 'best_valid_test/acc_align': 90.237}
[20 / 20] best test accuracy: 82.890 at epoch 17 
 best_stats: {'best_test_epoch': 17, 'best_test_valid/acc': 87.302, 'best_test_valid/acc_unbiased': 82.101, 'best_test_valid/diff': 15.09, 'best_test_valid/acc_skew': 74.556, 'best_test_valid/acc_align': 89.646, 'best_test_test/acc': 88.056, 'best_test_test/acc_unbiased': 82.89, 'best_test_test/diff': 13.961, 'best_test_test/acc_skew': 75.909, 'best_test_test/acc_align': 89.87}
Total training time: 1:18:34
