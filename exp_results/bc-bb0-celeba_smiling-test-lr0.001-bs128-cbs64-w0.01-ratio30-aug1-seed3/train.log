Log level set to: INFO
Set seed: 3
=======> Using Fixed Random Seed: 3 <========
save_path: exp_results/bc-bb0-celeba_smiling-test-lr0.001-bs128-cbs64-w0.01-ratio30-aug1-seed3
get_celeba - split:train, aug: False, given_y: True, ratio: 0
use existing smiling indices from data/celeba/pickles/smiling
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [8009, 32847]
Target 1: [40621, 7981]
Binary Target 1
---------------------------
Target 0: [8009, 32847]
Target 1: [40621, 7981]
===================================
Normal Label Distribution: 
Target 0: [8009, 32847]
Target 1: [40621, 7981]
===================================
Use BiasedCelebASplit 
 target_attr: smiling split: train 
 tensor([[ 8009., 40621.],
        [32847.,  7981.]])
get_celeba - split:train, aug: 1, given_y: True, ratio: 30
use existing smiling indices from data/celeba/pickles/smiling
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [8017, 32729]
Target 1: [40802, 7910]
Binary Target 1
---------------------------
Target 0: [8017, 32729]
Target 1: [40802, 7910]
===================================
Normal Label Distribution: 
Target 0: [8017, 32729]
Target 1: [40802, 7910]
===================================
Use BiasedCelebASplit 
 target_attr: smiling split: train 
 tensor([[ 8017., 40802.],
        [32729.,  7910.]])
get_celeba - split:train_valid, aug: False, given_y: True, ratio: 0
use existing smiling indices from data/celeba/pickles/smiling
Use BiasedCelebASplit 
 target_attr: smiling split: train_valid 
 tensor([[ 1944., 10217.],
        [ 8222.,  1982.]])
get_celeba - split:valid, aug: False, given_y: True, ratio: 0
Use BiasedCelebASplit 
 target_attr: smiling split: valid 
 tensor([[5252., 6157.],
        [5013., 3445.]])
decay_epochs: [3, 6]
[1 / 10] Learning rate: 0.001 weight: 0.01
[1 / 10] Loss: 4.6396518491633145 CE Loss: 0.24963462343124848 Con Loss: 4.637155501761319
[1 / 10] tensor([[0.941, 0.924],
        [0.904, 0.884]]) {'epoch': 1, 'valid/acc': 90.673, 'valid/acc_unbiased': 90.685, 'valid/diff': 2.007, 'valid/acc_skew': 90.506, 'valid/acc_align': 90.863, 'test/acc': 91.549, 'test/acc_unbiased': 91.332, 'test/diff': 1.885, 'test/acc_skew': 91.238, 'test/acc_align': 91.427}
[1 / 10] best valid accuracy: 90.685 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 90.673, 'best_valid_valid/acc_unbiased': 90.685, 'best_valid_valid/diff': 2.007, 'best_valid_valid/acc_skew': 90.506, 'best_valid_valid/acc_align': 90.863, 'best_valid_test/acc': 91.549, 'best_valid_test/acc_unbiased': 91.332, 'best_valid_test/diff': 1.885, 'best_valid_test/acc_skew': 91.238, 'best_valid_test/acc_align': 91.427}
[1 / 10] best test accuracy: 91.332 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 90.673, 'best_test_valid/acc_unbiased': 90.685, 'best_test_valid/diff': 2.007, 'best_test_valid/acc_skew': 90.506, 'best_test_valid/acc_align': 90.863, 'best_test_test/acc': 91.549, 'best_test_test/acc_unbiased': 91.332, 'best_test_test/diff': 1.885, 'best_test_test/acc_skew': 91.238, 'best_test_test/acc_align': 91.427}
[2 / 10] Learning rate: 0.001 weight: 0.01
[2 / 10] Loss: 4.603393020762927 CE Loss: 0.22015564659063494 Con Loss: 4.601191460714485
[2 / 10] tensor([[0.910, 0.915],
        [0.931, 0.913]]) {'epoch': 2, 'valid/acc': 92.202, 'valid/acc_unbiased': 91.666, 'valid/diff': 1.41, 'valid/acc_skew': 90.961, 'valid/acc_align': 92.371, 'test/acc': 91.826, 'test/acc_unbiased': 91.721, 'test/diff': 1.166, 'test/acc_skew': 91.138, 'test/acc_align': 92.304}
[2 / 10] best valid accuracy: 91.666 at epoch 2 
 best_stats: {'best_valid_epoch': 2, 'best_valid_valid/acc': 92.202, 'best_valid_valid/acc_unbiased': 91.666, 'best_valid_valid/diff': 1.41, 'best_valid_valid/acc_skew': 90.961, 'best_valid_valid/acc_align': 92.371, 'best_valid_test/acc': 91.826, 'best_valid_test/acc_unbiased': 91.721, 'best_valid_test/diff': 1.166, 'best_valid_test/acc_skew': 91.138, 'best_valid_test/acc_align': 92.304}
[2 / 10] best test accuracy: 91.721 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 92.202, 'best_test_valid/acc_unbiased': 91.666, 'best_test_valid/diff': 1.41, 'best_test_valid/acc_skew': 90.961, 'best_test_valid/acc_align': 92.371, 'best_test_test/acc': 91.826, 'best_test_test/acc_unbiased': 91.721, 'best_test_test/diff': 1.166, 'best_test_test/acc_skew': 91.138, 'best_test_test/acc_align': 92.304}
[3 / 10] Learning rate: 0.001 weight: 0.01
[3 / 10] Loss: 4.601520888850004 CE Loss: 0.21284690132181944 Con Loss: 4.5993924165982545
[3 / 10] tensor([[0.962, 0.957],
        [0.884, 0.846]]) {'epoch': 3, 'valid/acc': 91.241, 'valid/acc_unbiased': 91.176, 'valid/diff': 1.731, 'valid/acc_skew': 90.528, 'valid/acc_align': 91.824, 'test/acc': 91.634, 'test/acc_unbiased': 91.215, 'test/diff': 2.152, 'test/acc_skew': 90.399, 'test/acc_align': 92.031}
[3 / 10] best valid accuracy: 91.666 at epoch 2 
 best_stats: {'best_valid_epoch': 2, 'best_valid_valid/acc': 92.202, 'best_valid_valid/acc_unbiased': 91.666, 'best_valid_valid/diff': 1.41, 'best_valid_valid/acc_skew': 90.961, 'best_valid_valid/acc_align': 92.371, 'best_valid_test/acc': 91.826, 'best_valid_test/acc_unbiased': 91.721, 'best_valid_test/diff': 1.166, 'best_valid_test/acc_skew': 91.138, 'best_valid_test/acc_align': 92.304}
[3 / 10] best test accuracy: 91.721 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 92.202, 'best_test_valid/acc_unbiased': 91.666, 'best_test_valid/diff': 1.41, 'best_test_valid/acc_skew': 90.961, 'best_test_valid/acc_align': 92.371, 'best_test_test/acc': 91.826, 'best_test_test/acc_unbiased': 91.721, 'best_test_test/diff': 1.166, 'best_test_test/acc_skew': 91.138, 'best_test_test/acc_align': 92.304}
[4 / 10] Learning rate: 0.0001 weight: 0.01
[4 / 10] Loss: 4.566072799925508 CE Loss: 0.19174058486512682 Con Loss: 4.5641553845480525
[4 / 10] tensor([[0.941, 0.926],
        [0.923, 0.912]]) {'epoch': 4, 'valid/acc': 92.305, 'valid/acc_unbiased': 92.365, 'valid/diff': 1.128, 'valid/acc_skew': 92.423, 'valid/acc_align': 92.307, 'test/acc': 92.646, 'test/acc_unbiased': 92.539, 'test/diff': 1.273, 'test/acc_skew': 92.651, 'test/acc_align': 92.426}
[4 / 10] best valid accuracy: 92.365 at epoch 4 
 best_stats: {'best_valid_epoch': 4, 'best_valid_valid/acc': 92.305, 'best_valid_valid/acc_unbiased': 92.365, 'best_valid_valid/diff': 1.128, 'best_valid_valid/acc_skew': 92.423, 'best_valid_valid/acc_align': 92.307, 'best_valid_test/acc': 92.646, 'best_valid_test/acc_unbiased': 92.539, 'best_valid_test/diff': 1.273, 'best_valid_test/acc_skew': 92.651, 'best_valid_test/acc_align': 92.426}
[4 / 10] best test accuracy: 92.539 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 92.305, 'best_test_valid/acc_unbiased': 92.365, 'best_test_valid/diff': 1.128, 'best_test_valid/acc_skew': 92.423, 'best_test_valid/acc_align': 92.307, 'best_test_test/acc': 92.646, 'best_test_test/acc_unbiased': 92.539, 'best_test_test/diff': 1.273, 'best_test_test/acc_skew': 92.651, 'best_test_test/acc_align': 92.426}
[5 / 10] Learning rate: 0.0001 weight: 0.01
[5 / 10] Loss: 4.5490733440174616 CE Loss: 0.18266480352379175 Con Loss: 4.5472466938452305
[5 / 10] tensor([[0.920, 0.928],
        [0.940, 0.913]]) {'epoch': 5, 'valid/acc': 92.949, 'valid/acc_unbiased': 92.372, 'valid/diff': 1.645, 'valid/acc_skew': 91.55, 'valid/acc_align': 93.195, 'test/acc': 92.691, 'test/acc_unbiased': 92.512, 'test/diff': 1.778, 'test/acc_skew': 91.623, 'test/acc_align': 93.401}
[5 / 10] best valid accuracy: 92.372 at epoch 5 
 best_stats: {'best_valid_epoch': 5, 'best_valid_valid/acc': 92.949, 'best_valid_valid/acc_unbiased': 92.372, 'best_valid_valid/diff': 1.645, 'best_valid_valid/acc_skew': 91.55, 'best_valid_valid/acc_align': 93.195, 'best_valid_test/acc': 92.691, 'best_valid_test/acc_unbiased': 92.512, 'best_valid_test/diff': 1.778, 'best_valid_test/acc_skew': 91.623, 'best_valid_test/acc_align': 93.401}
[5 / 10] best test accuracy: 92.539 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 92.305, 'best_test_valid/acc_unbiased': 92.365, 'best_test_valid/diff': 1.128, 'best_test_valid/acc_skew': 92.423, 'best_test_valid/acc_align': 92.307, 'best_test_test/acc': 92.646, 'best_test_test/acc_unbiased': 92.539, 'best_test_test/diff': 1.273, 'best_test_test/acc_skew': 92.651, 'best_test_test/acc_align': 92.426}
[6 / 10] Learning rate: 0.0001 weight: 0.01
[6 / 10] Loss: 4.537089804378766 CE Loss: 0.18006510723457775 Con Loss: 4.535289159821389
[6 / 10] tensor([[0.942, 0.937],
        [0.929, 0.904]]) {'epoch': 6, 'valid/acc': 92.926, 'valid/acc_unbiased': 92.606, 'valid/diff': 1.22, 'valid/acc_skew': 91.996, 'valid/acc_align': 93.215, 'test/acc': 93.029, 'test/acc_unbiased': 92.821, 'test/diff': 1.475, 'test/acc_skew': 92.34, 'test/acc_align': 93.301}
[6 / 10] best valid accuracy: 92.606 at epoch 6 
 best_stats: {'best_valid_epoch': 6, 'best_valid_valid/acc': 92.926, 'best_valid_valid/acc_unbiased': 92.606, 'best_valid_valid/diff': 1.22, 'best_valid_valid/acc_skew': 91.996, 'best_valid_valid/acc_align': 93.215, 'best_valid_test/acc': 93.029, 'best_valid_test/acc_unbiased': 92.821, 'best_valid_test/diff': 1.475, 'best_valid_test/acc_skew': 92.34, 'best_valid_test/acc_align': 93.301}
[6 / 10] best test accuracy: 92.821 at epoch 6 
 best_stats: {'best_test_epoch': 6, 'best_test_valid/acc': 92.926, 'best_test_valid/acc_unbiased': 92.606, 'best_test_valid/diff': 1.22, 'best_test_valid/acc_skew': 91.996, 'best_test_valid/acc_align': 93.215, 'best_test_test/acc': 93.029, 'best_test_test/acc_unbiased': 92.821, 'best_test_test/diff': 1.475, 'best_test_test/acc_skew': 92.34, 'best_test_test/acc_align': 93.301}
[7 / 10] Learning rate: 1e-05 weight: 0.01
[7 / 10] Loss: 4.540605545118569 CE Loss: 0.17537294957919972 Con Loss: 4.538851818943193
[7 / 10] tensor([[0.927, 0.928],
        [0.943, 0.915]]) {'epoch': 7, 'valid/acc': 93.195, 'valid/acc_unbiased': 92.694, 'valid/diff': 1.373, 'valid/acc_skew': 92.008, 'valid/acc_align': 93.381, 'test/acc': 92.993, 'test/acc_unbiased': 92.805, 'test/diff': 1.495, 'test/acc_skew': 92.058, 'test/acc_align': 93.553}
[7 / 10] best valid accuracy: 92.694 at epoch 7 
 best_stats: {'best_valid_epoch': 7, 'best_valid_valid/acc': 93.195, 'best_valid_valid/acc_unbiased': 92.694, 'best_valid_valid/diff': 1.373, 'best_valid_valid/acc_skew': 92.008, 'best_valid_valid/acc_align': 93.381, 'best_valid_test/acc': 92.993, 'best_valid_test/acc_unbiased': 92.805, 'best_valid_test/diff': 1.495, 'best_valid_test/acc_skew': 92.058, 'best_valid_test/acc_align': 93.553}
[7 / 10] best test accuracy: 92.821 at epoch 6 
 best_stats: {'best_test_epoch': 6, 'best_test_valid/acc': 92.926, 'best_test_valid/acc_unbiased': 92.606, 'best_test_valid/diff': 1.22, 'best_test_valid/acc_skew': 91.996, 'best_test_valid/acc_align': 93.215, 'best_test_test/acc': 93.029, 'best_test_test/acc_unbiased': 92.821, 'best_test_test/diff': 1.475, 'best_test_test/acc_skew': 92.34, 'best_test_test/acc_align': 93.301}
[8 / 10] Learning rate: 1e-05 weight: 0.01
[8 / 10] Loss: 4.5410588891797925 CE Loss: 0.17123835664699327 Con Loss: 4.53934650399395
[8 / 10] tensor([[0.938, 0.936],
        [0.935, 0.910]]) {'epoch': 8, 'valid/acc': 92.962, 'valid/acc_unbiased': 92.584, 'valid/diff': 1.272, 'valid/acc_skew': 91.966, 'valid/acc_align': 93.202, 'test/acc': 93.154, 'test/acc_unbiased': 92.961, 'test/diff': 1.325, 'test/acc_skew': 92.397, 'test/acc_align': 93.526}
[8 / 10] best valid accuracy: 92.694 at epoch 7 
 best_stats: {'best_valid_epoch': 7, 'best_valid_valid/acc': 93.195, 'best_valid_valid/acc_unbiased': 92.694, 'best_valid_valid/diff': 1.373, 'best_valid_valid/acc_skew': 92.008, 'best_valid_valid/acc_align': 93.381, 'best_valid_test/acc': 92.993, 'best_valid_test/acc_unbiased': 92.805, 'best_valid_test/diff': 1.495, 'best_valid_test/acc_skew': 92.058, 'best_valid_test/acc_align': 93.553}
[8 / 10] best test accuracy: 92.961 at epoch 8 
 best_stats: {'best_test_epoch': 8, 'best_test_valid/acc': 92.962, 'best_test_valid/acc_unbiased': 92.584, 'best_test_valid/diff': 1.272, 'best_test_valid/acc_skew': 91.966, 'best_test_valid/acc_align': 93.202, 'best_test_test/acc': 93.154, 'best_test_test/acc_unbiased': 92.961, 'best_test_test/diff': 1.325, 'best_test_test/acc_skew': 92.397, 'best_test_test/acc_align': 93.526}
[9 / 10] Learning rate: 1e-05 weight: 0.01
[9 / 10] Loss: 4.529299250156279 CE Loss: 0.17140626543722853 Con Loss: 4.5275851894254915
[9 / 10] tensor([[0.937, 0.938],
        [0.933, 0.903]]) {'epoch': 9, 'valid/acc': 93.289, 'valid/acc_unbiased': 92.785, 'valid/diff': 1.687, 'valid/acc_skew': 91.941, 'valid/acc_align': 93.629, 'test/acc': 93.019, 'test/acc_unbiased': 92.782, 'test/diff': 1.543, 'test/acc_skew': 92.011, 'test/acc_align': 93.554}
[9 / 10] best valid accuracy: 92.785 at epoch 9 
 best_stats: {'best_valid_epoch': 9, 'best_valid_valid/acc': 93.289, 'best_valid_valid/acc_unbiased': 92.785, 'best_valid_valid/diff': 1.687, 'best_valid_valid/acc_skew': 91.941, 'best_valid_valid/acc_align': 93.629, 'best_valid_test/acc': 93.019, 'best_valid_test/acc_unbiased': 92.782, 'best_valid_test/diff': 1.543, 'best_valid_test/acc_skew': 92.011, 'best_valid_test/acc_align': 93.554}
[9 / 10] best test accuracy: 92.961 at epoch 8 
 best_stats: {'best_test_epoch': 8, 'best_test_valid/acc': 92.962, 'best_test_valid/acc_unbiased': 92.584, 'best_test_valid/diff': 1.272, 'best_test_valid/acc_skew': 91.966, 'best_test_valid/acc_align': 93.202, 'best_test_test/acc': 93.154, 'best_test_test/acc_unbiased': 92.961, 'best_test_test/diff': 1.325, 'best_test_test/acc_skew': 92.397, 'best_test_test/acc_align': 93.526}
[10 / 10] Learning rate: 1e-05 weight: 0.01
[10 / 10] Loss: 4.531490478576604 CE Loss: 0.17045602047054145 Con Loss: 4.5297859198461445
[10 / 10] tensor([[0.928, 0.928],
        [0.939, 0.916]]) {'epoch': 10, 'valid/acc': 93.159, 'valid/acc_unbiased': 92.7, 'valid/diff': 1.282, 'valid/acc_skew': 92.059, 'valid/acc_align': 93.341, 'test/acc': 92.943, 'test/acc_unbiased': 92.782, 'test/diff': 1.217, 'test/acc_skew': 92.173, 'test/acc_align': 93.39}
[10 / 10] best valid accuracy: 92.785 at epoch 9 
 best_stats: {'best_valid_epoch': 9, 'best_valid_valid/acc': 93.289, 'best_valid_valid/acc_unbiased': 92.785, 'best_valid_valid/diff': 1.687, 'best_valid_valid/acc_skew': 91.941, 'best_valid_valid/acc_align': 93.629, 'best_valid_test/acc': 93.019, 'best_valid_test/acc_unbiased': 92.782, 'best_valid_test/diff': 1.543, 'best_valid_test/acc_skew': 92.011, 'best_valid_test/acc_align': 93.554}
[10 / 10] best test accuracy: 92.961 at epoch 8 
 best_stats: {'best_test_epoch': 8, 'best_test_valid/acc': 92.962, 'best_test_valid/acc_unbiased': 92.584, 'best_test_valid/diff': 1.272, 'best_test_valid/acc_skew': 91.966, 'best_test_valid/acc_align': 93.202, 'best_test_test/acc': 93.154, 'best_test_test/acc_unbiased': 92.961, 'best_test_test/diff': 1.325, 'best_test_test/acc_skew': 92.397, 'best_test_test/acc_align': 93.526}
Total training time: 1:17:07
