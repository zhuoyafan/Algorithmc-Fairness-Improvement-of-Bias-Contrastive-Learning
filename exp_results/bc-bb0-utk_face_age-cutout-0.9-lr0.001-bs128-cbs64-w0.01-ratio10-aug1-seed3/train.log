Log level set to: INFO
Set seed: 3
=======> Using Fixed Random Seed: 3 <========
save_path: exp_results/bc-bb0-utk_face_age-cutout-0.9-lr0.001-bs128-cbs64-w0.01-ratio10-aug1-seed3
get_utk_face - split: train, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_age-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
Binary Target 1
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Normal Label Distribution: 
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
Binary Target 1
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Normal Label Distribution: 
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 10684, target_attr: gender, bias_attr: age bias_rate: 0.9
['[train] target_0-bias_0: 8237', '[train] target_0-bias_1: 147', '[train] target_1-bias_0: 823', '[train] target_1-bias_1: 1477']
confusion_matrix - 
 original: tensor([[8237.,  823.],
        [ 147., 1477.]]), 
 normalized: tensor([[0.909, 0.091],
        [0.091, 0.909]]), 
 b|y: tensor([[0.982, 0.018],
        [0.358, 0.642]])
get_utk_face - split: train, aug: 1, given_y: True, ratio: 10
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_age-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
Binary Target 1
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Normal Label Distribution: 
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
Binary Target 1
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Normal Label Distribution: 
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 10684, target_attr: gender, bias_attr: age bias_rate: 0.9
['[train] target_0-bias_0: 8237', '[train] target_0-bias_1: 147', '[train] target_1-bias_0: 823', '[train] target_1-bias_1: 1477']
get_utk_face - split: valid, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_age-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [1030, 195]
Target 1: [841, 202]
Binary Target 1
---------------------------
Target 0: [1030, 195]
Target 1: [841, 202]
===================================
Normal Label Distribution: 
Target 0: [1030, 195]
Target 1: [841, 202]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 2268, target_attr: gender, bias_attr: age bias_rate: 0.9
['[valid] target_0-bias_0: 1030', '[valid] target_0-bias_1: 195', '[valid] target_1-bias_0: 841', '[valid] target_1-bias_1: 202']
get_utk_face - split: test, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_age-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [1061, 176]
Target 1: [867, 165]
Binary Target 1
---------------------------
Target 0: [1061, 176]
Target 1: [867, 165]
===================================
Normal Label Distribution: 
Target 0: [1061, 176]
Target 1: [867, 165]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 2269, target_attr: gender, bias_attr: age bias_rate: 0.9
['[test] target_0-bias_0: 1061', '[test] target_0-bias_1: 176', '[test] target_1-bias_0: 867', '[test] target_1-bias_1: 165']
decay_epochs: [6, 13]
[1 / 20] Learning rate: 0.001 weight: 0.01
[1 / 20] Loss: 4.816687334347021 CE Loss: 0.5599131451167225 Con Loss: 4.811088200143909
[1 / 20] tensor([[0.925, 0.915],
        [0.473, 0.285]]) {'epoch': 1, 'valid/acc': 69.621, 'valid/acc_unbiased': 63.775, 'valid/diff': 12.647, 'valid/acc_skew': 67.668, 'valid/acc_align': 59.881, 'test/acc': 70.472, 'test/acc_unbiased': 64.928, 'test/diff': 9.894, 'test/acc_skew': 69.383, 'test/acc_align': 60.472}
[1 / 20] best valid accuracy: 63.775 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 69.621, 'best_valid_valid/acc_unbiased': 63.775, 'best_valid_valid/diff': 12.647, 'best_valid_valid/acc_skew': 67.668, 'best_valid_valid/acc_align': 59.881, 'best_valid_test/acc': 70.472, 'best_valid_test/acc_unbiased': 64.928, 'best_valid_test/diff': 9.894, 'best_valid_test/acc_skew': 69.383, 'best_valid_test/acc_align': 60.472}
[1 / 20] best test accuracy: 64.928 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 69.621, 'best_test_valid/acc_unbiased': 63.775, 'best_test_valid/diff': 12.647, 'best_test_valid/acc_skew': 67.668, 'best_test_valid/acc_align': 59.881, 'best_test_test/acc': 70.472, 'best_test_test/acc_unbiased': 64.928, 'best_test_test/diff': 9.894, 'best_test_test/acc_skew': 69.383, 'best_test_test/acc_align': 60.472}
[2 / 20] Learning rate: 0.001 weight: 0.01
[2 / 20] Loss: 4.504396056914677 CE Loss: 0.49353968325021874 Con Loss: 4.499460665932402
[2 / 20] tensor([[0.928, 0.716],
        [0.633, 0.582]]) {'epoch': 2, 'valid/acc': 75.75, 'valid/acc_unbiased': 70.431, 'valid/diff': 12.261, 'valid/acc_skew': 64.305, 'valid/acc_align': 76.557, 'test/acc': 77.391, 'test/acc_unbiased': 71.483, 'test/diff': 13.193, 'test/acc_skew': 67.456, 'test/acc_align': 75.509}
[2 / 20] best valid accuracy: 70.431 at epoch 2 
 best_stats: {'best_valid_epoch': 2, 'best_valid_valid/acc': 75.75, 'best_valid_valid/acc_unbiased': 70.431, 'best_valid_valid/diff': 12.261, 'best_valid_valid/acc_skew': 64.305, 'best_valid_valid/acc_align': 76.557, 'best_valid_test/acc': 77.391, 'best_valid_test/acc_unbiased': 71.483, 'best_valid_test/diff': 13.193, 'best_valid_test/acc_skew': 67.456, 'best_valid_test/acc_align': 75.509}
[2 / 20] best test accuracy: 71.483 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 75.75, 'best_test_valid/acc_unbiased': 70.431, 'best_test_valid/diff': 12.261, 'best_test_valid/acc_skew': 64.305, 'best_test_valid/acc_align': 76.557, 'best_test_test/acc': 77.391, 'best_test_test/acc_unbiased': 71.483, 'best_test_test/diff': 13.193, 'best_test_test/acc_skew': 67.456, 'best_test_test/acc_align': 75.509}
[3 / 20] Learning rate: 0.001 weight: 0.01
[3 / 20] Loss: 4.38152051070173 CE Loss: 0.49313789854911955 Con Loss: 4.37658913239965
[3 / 20] tensor([[0.941, 0.818],
        [0.562, 0.388]]) {'epoch': 3, 'valid/acc': 73.016, 'valid/acc_unbiased': 67.453, 'valid/diff': 12.368, 'valid/acc_skew': 66.717, 'valid/acc_align': 68.19, 'test/acc': 74.614, 'test/acc_unbiased': 67.71, 'test/diff': 14.813, 'test/acc_skew': 68.994, 'test/acc_align': 66.425}
[3 / 20] best valid accuracy: 70.431 at epoch 2 
 best_stats: {'best_valid_epoch': 2, 'best_valid_valid/acc': 75.75, 'best_valid_valid/acc_unbiased': 70.431, 'best_valid_valid/diff': 12.261, 'best_valid_valid/acc_skew': 64.305, 'best_valid_valid/acc_align': 76.557, 'best_valid_test/acc': 77.391, 'best_valid_test/acc_unbiased': 71.483, 'best_valid_test/diff': 13.193, 'best_valid_test/acc_skew': 67.456, 'best_valid_test/acc_align': 75.509}
[3 / 20] best test accuracy: 71.483 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 75.75, 'best_test_valid/acc_unbiased': 70.431, 'best_test_valid/diff': 12.261, 'best_test_valid/acc_skew': 64.305, 'best_test_valid/acc_align': 76.557, 'best_test_test/acc': 77.391, 'best_test_test/acc_unbiased': 71.483, 'best_test_test/diff': 13.193, 'best_test_test/acc_skew': 67.456, 'best_test_test/acc_align': 75.509}
[4 / 20] Learning rate: 0.001 weight: 0.01
[4 / 20] Loss: 4.337024767449713 CE Loss: 0.4637013901958123 Con Loss: 4.332387739779216
[4 / 20] tensor([[0.967, 0.699],
        [0.607, 0.618]]) {'epoch': 4, 'valid/acc': 76.631, 'valid/acc_unbiased': 70.927, 'valid/diff': 27.336, 'valid/acc_skew': 57.259, 'valid/acc_align': 84.595, 'test/acc': 78.316, 'test/acc_unbiased': 72.269, 'test/diff': 13.982, 'test/acc_skew': 65.278, 'test/acc_align': 79.26}
[4 / 20] best valid accuracy: 70.927 at epoch 4 
 best_stats: {'best_valid_epoch': 4, 'best_valid_valid/acc': 76.631, 'best_valid_valid/acc_unbiased': 70.927, 'best_valid_valid/diff': 27.336, 'best_valid_valid/acc_skew': 57.259, 'best_valid_valid/acc_align': 84.595, 'best_valid_test/acc': 78.316, 'best_valid_test/acc_unbiased': 72.269, 'best_valid_test/diff': 13.982, 'best_valid_test/acc_skew': 65.278, 'best_valid_test/acc_align': 79.26}
[4 / 20] best test accuracy: 72.269 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 76.631, 'best_test_valid/acc_unbiased': 70.927, 'best_test_valid/diff': 27.336, 'best_test_valid/acc_skew': 57.259, 'best_test_valid/acc_align': 84.595, 'best_test_test/acc': 78.316, 'best_test_test/acc_unbiased': 72.269, 'best_test_test/diff': 13.982, 'best_test_test/acc_skew': 65.278, 'best_test_test/acc_align': 79.26}
[5 / 20] Learning rate: 0.001 weight: 0.01
[5 / 20] Loss: 4.26317372513103 CE Loss: 0.4236309867322958 Con Loss: 4.258937424731496
[5 / 20] tensor([[0.963, 0.756],
        [0.676, 0.642]]) {'epoch': 5, 'valid/acc': 77.778, 'valid/acc_unbiased': 71.414, 'valid/diff': 19.451, 'valid/acc_skew': 61.688, 'valid/acc_align': 81.139, 'test/acc': 81.401, 'test/acc_unbiased': 75.931, 'test/diff': 12.052, 'test/acc_skew': 71.579, 'test/acc_align': 80.283}
[5 / 20] best valid accuracy: 71.414 at epoch 5 
 best_stats: {'best_valid_epoch': 5, 'best_valid_valid/acc': 77.778, 'best_valid_valid/acc_unbiased': 71.414, 'best_valid_valid/diff': 19.451, 'best_valid_valid/acc_skew': 61.688, 'best_valid_valid/acc_align': 81.139, 'best_valid_test/acc': 81.401, 'best_valid_test/acc_unbiased': 75.931, 'best_valid_test/diff': 12.052, 'best_valid_test/acc_skew': 71.579, 'best_valid_test/acc_align': 80.283}
[5 / 20] best test accuracy: 75.931 at epoch 5 
 best_stats: {'best_test_epoch': 5, 'best_test_valid/acc': 77.778, 'best_test_valid/acc_unbiased': 71.414, 'best_test_valid/diff': 19.451, 'best_test_valid/acc_skew': 61.688, 'best_test_valid/acc_align': 81.139, 'best_test_test/acc': 81.401, 'best_test_test/acc_unbiased': 75.931, 'best_test_test/diff': 12.052, 'best_test_test/acc_skew': 71.579, 'best_test_test/acc_align': 80.283}
[6 / 20] Learning rate: 0.001 weight: 0.01
[6 / 20] Loss: 4.213988301817373 CE Loss: 0.40670109383178893 Con Loss: 4.209921296104337
[6 / 20] tensor([[0.979, 0.801],
        [0.577, 0.564]]) {'epoch': 6, 'valid/acc': 75.75, 'valid/acc_unbiased': 71.265, 'valid/diff': 13.362, 'valid/acc_skew': 64.584, 'valid/acc_align': 77.946, 'test/acc': 78.14, 'test/acc_unbiased': 73.018, 'test/diff': 9.56, 'test/acc_skew': 68.892, 'test/acc_align': 77.145}
[6 / 20] best valid accuracy: 71.414 at epoch 5 
 best_stats: {'best_valid_epoch': 5, 'best_valid_valid/acc': 77.778, 'best_valid_valid/acc_unbiased': 71.414, 'best_valid_valid/diff': 19.451, 'best_valid_valid/acc_skew': 61.688, 'best_valid_valid/acc_align': 81.139, 'best_valid_test/acc': 81.401, 'best_valid_test/acc_unbiased': 75.931, 'best_valid_test/diff': 12.052, 'best_valid_test/acc_skew': 71.579, 'best_valid_test/acc_align': 80.283}
[6 / 20] best test accuracy: 75.931 at epoch 5 
 best_stats: {'best_test_epoch': 5, 'best_test_valid/acc': 77.778, 'best_test_valid/acc_unbiased': 71.414, 'best_test_valid/diff': 19.451, 'best_test_valid/acc_skew': 61.688, 'best_test_valid/acc_align': 81.139, 'best_test_test/acc': 81.401, 'best_test_test/acc_unbiased': 75.931, 'best_test_test/diff': 12.052, 'best_test_test/acc_skew': 71.579, 'best_test_test/acc_align': 80.283}
[7 / 20] Learning rate: 0.0001 weight: 0.01
[7 / 20] Loss: 4.070697640265833 CE Loss: 0.3457007371433127 Con Loss: 4.067240638440131
[7 / 20] tensor([[0.975, 0.540],
        [0.637, 0.752]]) {'epoch': 7, 'valid/acc': 77.69, 'valid/acc_unbiased': 71.691, 'valid/diff': 33.398, 'valid/acc_skew': 54.992, 'valid/acc_align': 88.39, 'test/acc': 79.55, 'test/acc_unbiased': 72.563, 'test/diff': 27.481, 'test/acc_skew': 58.823, 'test/acc_align': 86.303}
[7 / 20] best valid accuracy: 71.691 at epoch 7 
 best_stats: {'best_valid_epoch': 7, 'best_valid_valid/acc': 77.69, 'best_valid_valid/acc_unbiased': 71.691, 'best_valid_valid/diff': 33.398, 'best_valid_valid/acc_skew': 54.992, 'best_valid_valid/acc_align': 88.39, 'best_valid_test/acc': 79.55, 'best_valid_test/acc_unbiased': 72.563, 'best_valid_test/diff': 27.481, 'best_valid_test/acc_skew': 58.823, 'best_valid_test/acc_align': 86.303}
[7 / 20] best test accuracy: 75.931 at epoch 5 
 best_stats: {'best_test_epoch': 5, 'best_test_valid/acc': 77.778, 'best_test_valid/acc_unbiased': 71.414, 'best_test_valid/diff': 19.451, 'best_test_valid/acc_skew': 61.688, 'best_test_valid/acc_align': 81.139, 'best_test_test/acc': 81.401, 'best_test_test/acc_unbiased': 75.931, 'best_test_test/diff': 12.052, 'best_test_test/acc_skew': 71.579, 'best_test_test/acc_align': 80.283}
[8 / 20] Learning rate: 0.0001 weight: 0.01
[8 / 20] Loss: 3.9812393200080614 CE Loss: 0.31229970154803327 Con Loss: 3.9781163117270575
[8 / 20] tensor([[0.978, 0.517],
        [0.618, 0.776]]) {'epoch': 8, 'valid/acc': 76.852, 'valid/acc_unbiased': 71.381, 'valid/diff': 38.076, 'valid/acc_skew': 52.343, 'valid/acc_align': 90.419, 'test/acc': 79.022, 'test/acc_unbiased': 72.234, 'test/diff': 30.941, 'test/acc_skew': 56.763, 'test/acc_align': 87.704}
[8 / 20] best valid accuracy: 71.691 at epoch 7 
 best_stats: {'best_valid_epoch': 7, 'best_valid_valid/acc': 77.69, 'best_valid_valid/acc_unbiased': 71.691, 'best_valid_valid/diff': 33.398, 'best_valid_valid/acc_skew': 54.992, 'best_valid_valid/acc_align': 88.39, 'best_valid_test/acc': 79.55, 'best_valid_test/acc_unbiased': 72.563, 'best_valid_test/diff': 27.481, 'best_valid_test/acc_skew': 58.823, 'best_valid_test/acc_align': 86.303}
[8 / 20] best test accuracy: 75.931 at epoch 5 
 best_stats: {'best_test_epoch': 5, 'best_test_valid/acc': 77.778, 'best_test_valid/acc_unbiased': 71.414, 'best_test_valid/diff': 19.451, 'best_test_valid/acc_skew': 61.688, 'best_test_valid/acc_align': 81.139, 'best_test_test/acc': 81.401, 'best_test_test/acc_unbiased': 75.931, 'best_test_test/diff': 12.052, 'best_test_test/acc_skew': 71.579, 'best_test_test/acc_align': 80.283}
[9 / 20] Learning rate: 0.0001 weight: 0.01
[9 / 20] Loss: 3.939043824836048 CE Loss: 0.3023044487279437 Con Loss: 3.9360207649082426
[9 / 20] tensor([[0.974, 0.483],
        [0.653, 0.818]]) {'epoch': 9, 'valid/acc': 78.307, 'valid/acc_unbiased': 72.46, 'valid/diff': 38.005, 'valid/acc_skew': 53.457, 'valid/acc_align': 91.463, 'test/acc': 80.167, 'test/acc_unbiased': 73.189, 'test/diff': 32.801, 'test/acc_skew': 56.789, 'test/acc_align': 89.59}
[9 / 20] best valid accuracy: 72.460 at epoch 9 
 best_stats: {'best_valid_epoch': 9, 'best_valid_valid/acc': 78.307, 'best_valid_valid/acc_unbiased': 72.46, 'best_valid_valid/diff': 38.005, 'best_valid_valid/acc_skew': 53.457, 'best_valid_valid/acc_align': 91.463, 'best_valid_test/acc': 80.167, 'best_valid_test/acc_unbiased': 73.189, 'best_valid_test/diff': 32.801, 'best_valid_test/acc_skew': 56.789, 'best_valid_test/acc_align': 89.59}
[9 / 20] best test accuracy: 75.931 at epoch 5 
 best_stats: {'best_test_epoch': 5, 'best_test_valid/acc': 77.778, 'best_test_valid/acc_unbiased': 71.414, 'best_test_valid/diff': 19.451, 'best_test_valid/acc_skew': 61.688, 'best_test_valid/acc_align': 81.139, 'best_test_test/acc': 81.401, 'best_test_test/acc_unbiased': 75.931, 'best_test_test/diff': 12.052, 'best_test_test/acc_skew': 71.579, 'best_test_test/acc_align': 80.283}
[10 / 20] Learning rate: 0.0001 weight: 0.01
[10 / 20] Loss: 3.895395468076665 CE Loss: 0.28721596650397097 Con Loss: 3.8925233014019986
[10 / 20] tensor([[0.980, 0.545],
        [0.623, 0.782]]) {'epoch': 10, 'valid/acc': 76.984, 'valid/acc_unbiased': 70.987, 'valid/diff': 35.787, 'valid/acc_skew': 53.093, 'valid/acc_align': 88.881, 'test/acc': 79.55, 'test/acc_unbiased': 73.258, 'test/diff': 29.687, 'test/acc_skew': 58.415, 'test/acc_align': 88.101}
[10 / 20] best valid accuracy: 72.460 at epoch 9 
 best_stats: {'best_valid_epoch': 9, 'best_valid_valid/acc': 78.307, 'best_valid_valid/acc_unbiased': 72.46, 'best_valid_valid/diff': 38.005, 'best_valid_valid/acc_skew': 53.457, 'best_valid_valid/acc_align': 91.463, 'best_valid_test/acc': 80.167, 'best_valid_test/acc_unbiased': 73.189, 'best_valid_test/diff': 32.801, 'best_valid_test/acc_skew': 56.789, 'best_valid_test/acc_align': 89.59}
[10 / 20] best test accuracy: 75.931 at epoch 5 
 best_stats: {'best_test_epoch': 5, 'best_test_valid/acc': 77.778, 'best_test_valid/acc_unbiased': 71.414, 'best_test_valid/diff': 19.451, 'best_test_valid/acc_skew': 61.688, 'best_test_valid/acc_align': 81.139, 'best_test_test/acc': 81.401, 'best_test_test/acc_unbiased': 75.931, 'best_test_test/diff': 12.052, 'best_test_test/acc_skew': 71.579, 'best_test_test/acc_align': 80.283}
[11 / 20] Learning rate: 0.0001 weight: 0.01
[11 / 20] Loss: 3.865136187605892 CE Loss: 0.2895081959963291 Con Loss: 3.862241118108677
[11 / 20] tensor([[0.983, 0.523],
        [0.619, 0.776]]) {'epoch': 11, 'valid/acc': 76.631, 'valid/acc_unbiased': 70.354, 'valid/diff': 36.655, 'valid/acc_skew': 52.027, 'valid/acc_align': 88.682, 'test/acc': 79.33, 'test/acc_unbiased': 72.522, 'test/diff': 30.834, 'test/acc_skew': 57.105, 'test/acc_align': 87.94}
[11 / 20] best valid accuracy: 72.460 at epoch 9 
 best_stats: {'best_valid_epoch': 9, 'best_valid_valid/acc': 78.307, 'best_valid_valid/acc_unbiased': 72.46, 'best_valid_valid/diff': 38.005, 'best_valid_valid/acc_skew': 53.457, 'best_valid_valid/acc_align': 91.463, 'best_valid_test/acc': 80.167, 'best_valid_test/acc_unbiased': 73.189, 'best_valid_test/diff': 32.801, 'best_valid_test/acc_skew': 56.789, 'best_valid_test/acc_align': 89.59}
[11 / 20] best test accuracy: 75.931 at epoch 5 
 best_stats: {'best_test_epoch': 5, 'best_test_valid/acc': 77.778, 'best_test_valid/acc_unbiased': 71.414, 'best_test_valid/diff': 19.451, 'best_test_valid/acc_skew': 61.688, 'best_test_valid/acc_align': 81.139, 'best_test_test/acc': 81.401, 'best_test_test/acc_unbiased': 75.931, 'best_test_test/diff': 12.052, 'best_test_test/acc_skew': 71.579, 'best_test_test/acc_align': 80.283}
[12 / 20] Learning rate: 0.0001 weight: 0.01
[12 / 20] Loss: 3.8076991710891352 CE Loss: 0.2944916902198545 Con Loss: 3.80475426193303
[12 / 20] tensor([[0.979, 0.494],
        [0.617, 0.788]]) {'epoch': 12, 'valid/acc': 76.587, 'valid/acc_unbiased': 70.492, 'valid/diff': 38.156, 'valid/acc_skew': 51.414, 'valid/acc_align': 89.57, 'test/acc': 78.933, 'test/acc_unbiased': 71.963, 'test/diff': 32.788, 'test/acc_skew': 55.569, 'test/acc_align': 88.357}
[12 / 20] best valid accuracy: 72.460 at epoch 9 
 best_stats: {'best_valid_epoch': 9, 'best_valid_valid/acc': 78.307, 'best_valid_valid/acc_unbiased': 72.46, 'best_valid_valid/diff': 38.005, 'best_valid_valid/acc_skew': 53.457, 'best_valid_valid/acc_align': 91.463, 'best_valid_test/acc': 80.167, 'best_valid_test/acc_unbiased': 73.189, 'best_valid_test/diff': 32.801, 'best_valid_test/acc_skew': 56.789, 'best_valid_test/acc_align': 89.59}
[12 / 20] best test accuracy: 75.931 at epoch 5 
 best_stats: {'best_test_epoch': 5, 'best_test_valid/acc': 77.778, 'best_test_valid/acc_unbiased': 71.414, 'best_test_valid/diff': 19.451, 'best_test_valid/acc_skew': 61.688, 'best_test_valid/acc_align': 81.139, 'best_test_test/acc': 81.401, 'best_test_test/acc_unbiased': 75.931, 'best_test_test/diff': 12.052, 'best_test_test/acc_skew': 71.579, 'best_test_test/acc_align': 80.283}
[13 / 20] Learning rate: 0.0001 weight: 0.01
[13 / 20] Loss: 3.8516084173117537 CE Loss: 0.285871139584923 Con Loss: 3.8487497168683418
[13 / 20] tensor([[0.975, 0.426],
        [0.648, 0.830]]) {'epoch': 13, 'valid/acc': 77.205, 'valid/acc_unbiased': 70.597, 'valid/diff': 43.206, 'valid/acc_skew': 48.994, 'valid/acc_align': 92.2, 'test/acc': 79.727, 'test/acc_unbiased': 72.004, 'test/diff': 36.572, 'test/acc_skew': 53.717, 'test/acc_align': 90.29}
[13 / 20] best valid accuracy: 72.460 at epoch 9 
 best_stats: {'best_valid_epoch': 9, 'best_valid_valid/acc': 78.307, 'best_valid_valid/acc_unbiased': 72.46, 'best_valid_valid/diff': 38.005, 'best_valid_valid/acc_skew': 53.457, 'best_valid_valid/acc_align': 91.463, 'best_valid_test/acc': 80.167, 'best_valid_test/acc_unbiased': 73.189, 'best_valid_test/diff': 32.801, 'best_valid_test/acc_skew': 56.789, 'best_valid_test/acc_align': 89.59}
[13 / 20] best test accuracy: 75.931 at epoch 5 
 best_stats: {'best_test_epoch': 5, 'best_test_valid/acc': 77.778, 'best_test_valid/acc_unbiased': 71.414, 'best_test_valid/diff': 19.451, 'best_test_valid/acc_skew': 61.688, 'best_test_valid/acc_align': 81.139, 'best_test_test/acc': 81.401, 'best_test_test/acc_unbiased': 75.931, 'best_test_test/diff': 12.052, 'best_test_test/acc_skew': 71.579, 'best_test_test/acc_align': 80.283}
[14 / 20] Learning rate: 1e-05 weight: 0.01
[14 / 20] Loss: 3.8075962077361822 CE Loss: 0.2739772826645179 Con Loss: 3.804856456383834
[14 / 20] tensor([[0.980, 0.460],
        [0.632, 0.818]]) {'epoch': 14, 'valid/acc': 76.19, 'valid/acc_unbiased': 69.529, 'valid/diff': 42.266, 'valid/acc_skew': 48.396, 'valid/acc_align': 90.662, 'test/acc': 79.506, 'test/acc_unbiased': 72.267, 'test/diff': 35.305, 'test/acc_skew': 54.615, 'test/acc_align': 89.919}
[14 / 20] best valid accuracy: 72.460 at epoch 9 
 best_stats: {'best_valid_epoch': 9, 'best_valid_valid/acc': 78.307, 'best_valid_valid/acc_unbiased': 72.46, 'best_valid_valid/diff': 38.005, 'best_valid_valid/acc_skew': 53.457, 'best_valid_valid/acc_align': 91.463, 'best_valid_test/acc': 80.167, 'best_valid_test/acc_unbiased': 73.189, 'best_valid_test/diff': 32.801, 'best_valid_test/acc_skew': 56.789, 'best_valid_test/acc_align': 89.59}
[14 / 20] best test accuracy: 75.931 at epoch 5 
 best_stats: {'best_test_epoch': 5, 'best_test_valid/acc': 77.778, 'best_test_valid/acc_unbiased': 71.414, 'best_test_valid/diff': 19.451, 'best_test_valid/acc_skew': 61.688, 'best_test_valid/acc_align': 81.139, 'best_test_test/acc': 81.401, 'best_test_test/acc_unbiased': 75.931, 'best_test_test/diff': 12.052, 'best_test_test/acc_skew': 71.579, 'best_test_test/acc_align': 80.283}
[15 / 20] Learning rate: 1e-05 weight: 0.01
[15 / 20] Loss: 3.7966996998610187 CE Loss: 0.278397611612597 Con Loss: 3.7939157294941412
[15 / 20] tensor([[0.975, 0.438],
        [0.663, 0.836]]) {'epoch': 15, 'valid/acc': 77.822, 'valid/acc_unbiased': 71.018, 'valid/diff': 41.87, 'valid/acc_skew': 50.083, 'valid/acc_align': 91.953, 'test/acc': 80.388, 'test/acc_unbiased': 72.791, 'test/diff': 35.51, 'test/acc_skew': 55.035, 'test/acc_align': 90.546}
[15 / 20] best valid accuracy: 72.460 at epoch 9 
 best_stats: {'best_valid_epoch': 9, 'best_valid_valid/acc': 78.307, 'best_valid_valid/acc_unbiased': 72.46, 'best_valid_valid/diff': 38.005, 'best_valid_valid/acc_skew': 53.457, 'best_valid_valid/acc_align': 91.463, 'best_valid_test/acc': 80.167, 'best_valid_test/acc_unbiased': 73.189, 'best_valid_test/diff': 32.801, 'best_valid_test/acc_skew': 56.789, 'best_valid_test/acc_align': 89.59}
[15 / 20] best test accuracy: 75.931 at epoch 5 
 best_stats: {'best_test_epoch': 5, 'best_test_valid/acc': 77.778, 'best_test_valid/acc_unbiased': 71.414, 'best_test_valid/diff': 19.451, 'best_test_valid/acc_skew': 61.688, 'best_test_valid/acc_align': 81.139, 'best_test_test/acc': 81.401, 'best_test_test/acc_unbiased': 75.931, 'best_test_test/diff': 12.052, 'best_test_test/acc_skew': 71.579, 'best_test_test/acc_align': 80.283}
[16 / 20] Learning rate: 1e-05 weight: 0.01
[16 / 20] Loss: 3.8019128461671383 CE Loss: 0.27542583171859836 Con Loss: 3.799158583326493
[16 / 20] tensor([[0.979, 0.500],
        [0.619, 0.794]]) {'epoch': 16, 'valid/acc': 75.75, 'valid/acc_unbiased': 69.446, 'valid/diff': 40.054, 'valid/acc_skew': 49.418, 'valid/acc_align': 89.473, 'test/acc': 79.11, 'test/acc_unbiased': 72.315, 'test/diff': 32.691, 'test/acc_skew': 55.969, 'test/acc_align': 88.66}
[16 / 20] best valid accuracy: 72.460 at epoch 9 
 best_stats: {'best_valid_epoch': 9, 'best_valid_valid/acc': 78.307, 'best_valid_valid/acc_unbiased': 72.46, 'best_valid_valid/diff': 38.005, 'best_valid_valid/acc_skew': 53.457, 'best_valid_valid/acc_align': 91.463, 'best_valid_test/acc': 80.167, 'best_valid_test/acc_unbiased': 73.189, 'best_valid_test/diff': 32.801, 'best_valid_test/acc_skew': 56.789, 'best_valid_test/acc_align': 89.59}
[16 / 20] best test accuracy: 75.931 at epoch 5 
 best_stats: {'best_test_epoch': 5, 'best_test_valid/acc': 77.778, 'best_test_valid/acc_unbiased': 71.414, 'best_test_valid/diff': 19.451, 'best_test_valid/acc_skew': 61.688, 'best_test_valid/acc_align': 81.139, 'best_test_test/acc': 81.401, 'best_test_test/acc_unbiased': 75.931, 'best_test_test/diff': 12.052, 'best_test_test/acc_skew': 71.579, 'best_test_test/acc_align': 80.283}
[17 / 20] Learning rate: 1e-05 weight: 0.01
[17 / 20] Loss: 3.7004130757823503 CE Loss: 0.2665279997015481 Con Loss: 3.69774778591743
[17 / 20] tensor([[0.979, 0.472],
        [0.622, 0.800]]) {'epoch': 17, 'valid/acc': 75.926, 'valid/acc_unbiased': 69.752, 'valid/diff': 40.431, 'valid/acc_skew': 49.537, 'valid/acc_align': 89.968, 'test/acc': 79.022, 'test/acc_unbiased': 71.813, 'test/diff': 34.3, 'test/acc_skew': 54.664, 'test/acc_align': 88.963}
[17 / 20] best valid accuracy: 72.460 at epoch 9 
 best_stats: {'best_valid_epoch': 9, 'best_valid_valid/acc': 78.307, 'best_valid_valid/acc_unbiased': 72.46, 'best_valid_valid/diff': 38.005, 'best_valid_valid/acc_skew': 53.457, 'best_valid_valid/acc_align': 91.463, 'best_valid_test/acc': 80.167, 'best_valid_test/acc_unbiased': 73.189, 'best_valid_test/diff': 32.801, 'best_valid_test/acc_skew': 56.789, 'best_valid_test/acc_align': 89.59}
[17 / 20] best test accuracy: 75.931 at epoch 5 
 best_stats: {'best_test_epoch': 5, 'best_test_valid/acc': 77.778, 'best_test_valid/acc_unbiased': 71.414, 'best_test_valid/diff': 19.451, 'best_test_valid/acc_skew': 61.688, 'best_test_valid/acc_align': 81.139, 'best_test_test/acc': 81.401, 'best_test_test/acc_unbiased': 75.931, 'best_test_test/diff': 12.052, 'best_test_test/acc_skew': 71.579, 'best_test_test/acc_align': 80.283}
[18 / 20] Learning rate: 1e-05 weight: 0.01
[18 / 20] Loss: 3.8215356607733484 CE Loss: 0.26600035095607594 Con Loss: 3.8188756416460765
[18 / 20] tensor([[0.977, 0.443],
        [0.645, 0.842]]) {'epoch': 18, 'valid/acc': 76.94, 'valid/acc_unbiased': 69.64, 'valid/diff': 42.043, 'valid/acc_skew': 48.619, 'valid/acc_align': 90.662, 'test/acc': 79.903, 'test/acc_unbiased': 72.693, 'test/diff': 36.594, 'test/acc_skew': 54.397, 'test/acc_align': 90.99}
[18 / 20] best valid accuracy: 72.460 at epoch 9 
 best_stats: {'best_valid_epoch': 9, 'best_valid_valid/acc': 78.307, 'best_valid_valid/acc_unbiased': 72.46, 'best_valid_valid/diff': 38.005, 'best_valid_valid/acc_skew': 53.457, 'best_valid_valid/acc_align': 91.463, 'best_valid_test/acc': 80.167, 'best_valid_test/acc_unbiased': 73.189, 'best_valid_test/diff': 32.801, 'best_valid_test/acc_skew': 56.789, 'best_valid_test/acc_align': 89.59}
[18 / 20] best test accuracy: 75.931 at epoch 5 
 best_stats: {'best_test_epoch': 5, 'best_test_valid/acc': 77.778, 'best_test_valid/acc_unbiased': 71.414, 'best_test_valid/diff': 19.451, 'best_test_valid/acc_skew': 61.688, 'best_test_valid/acc_align': 81.139, 'best_test_test/acc': 81.401, 'best_test_test/acc_unbiased': 75.931, 'best_test_test/diff': 12.052, 'best_test_test/acc_skew': 71.579, 'best_test_test/acc_align': 80.283}
[19 / 20] Learning rate: 1e-05 weight: 0.01
[19 / 20] Loss: 3.7799015069266733 CE Loss: 0.2703455063576825 Con Loss: 3.7771980574139046
[19 / 20] tensor([[0.978, 0.472],
        [0.627, 0.818]]) {'epoch': 19, 'valid/acc': 76.367, 'valid/acc_unbiased': 69.935, 'valid/diff': 40.357, 'valid/acc_skew': 49.756, 'valid/acc_align': 90.113, 'test/acc': 79.33, 'test/acc_unbiased': 72.389, 'test/diff': 34.873, 'test/acc_skew': 54.952, 'test/acc_align': 89.825}
[19 / 20] best valid accuracy: 72.460 at epoch 9 
 best_stats: {'best_valid_epoch': 9, 'best_valid_valid/acc': 78.307, 'best_valid_valid/acc_unbiased': 72.46, 'best_valid_valid/diff': 38.005, 'best_valid_valid/acc_skew': 53.457, 'best_valid_valid/acc_align': 91.463, 'best_valid_test/acc': 80.167, 'best_valid_test/acc_unbiased': 73.189, 'best_valid_test/diff': 32.801, 'best_valid_test/acc_skew': 56.789, 'best_valid_test/acc_align': 89.59}
[19 / 20] best test accuracy: 75.931 at epoch 5 
 best_stats: {'best_test_epoch': 5, 'best_test_valid/acc': 77.778, 'best_test_valid/acc_unbiased': 71.414, 'best_test_valid/diff': 19.451, 'best_test_valid/acc_skew': 61.688, 'best_test_valid/acc_align': 81.139, 'best_test_test/acc': 81.401, 'best_test_test/acc_unbiased': 75.931, 'best_test_test/diff': 12.052, 'best_test_test/acc_skew': 71.579, 'best_test_test/acc_align': 80.283}
[20 / 20] Learning rate: 1e-05 weight: 0.01
[20 / 20] Loss: 3.794556450281461 CE Loss: 0.26623521416609497 Con Loss: 3.79189410481012
[20 / 20] tensor([[0.979, 0.477],
        [0.631, 0.818]]) {'epoch': 20, 'valid/acc': 76.367, 'valid/acc_unbiased': 69.542, 'valid/diff': 41.541, 'valid/acc_skew': 48.772, 'valid/acc_align': 90.312, 'test/acc': 79.55, 'test/acc_unbiased': 72.641, 'test/diff': 34.463, 'test/acc_skew': 55.409, 'test/acc_align': 89.872}
[20 / 20] best valid accuracy: 72.460 at epoch 9 
 best_stats: {'best_valid_epoch': 9, 'best_valid_valid/acc': 78.307, 'best_valid_valid/acc_unbiased': 72.46, 'best_valid_valid/diff': 38.005, 'best_valid_valid/acc_skew': 53.457, 'best_valid_valid/acc_align': 91.463, 'best_valid_test/acc': 80.167, 'best_valid_test/acc_unbiased': 73.189, 'best_valid_test/diff': 32.801, 'best_valid_test/acc_skew': 56.789, 'best_valid_test/acc_align': 89.59}
[20 / 20] best test accuracy: 75.931 at epoch 5 
 best_stats: {'best_test_epoch': 5, 'best_test_valid/acc': 77.778, 'best_test_valid/acc_unbiased': 71.414, 'best_test_valid/diff': 19.451, 'best_test_valid/acc_skew': 61.688, 'best_test_valid/acc_align': 81.139, 'best_test_test/acc': 81.401, 'best_test_test/acc_unbiased': 75.931, 'best_test_test/diff': 12.052, 'best_test_test/acc_skew': 71.579, 'best_test_test/acc_align': 80.283}
Total training time: 0:15:49
