Log level set to: INFO
Set seed: 1
=======> Using Fixed Random Seed: 1 <========
save_path: exp_results/bc-bb0-celeba_blonde-os_0.9-lr0.001-bs128-cbs64-w0.01-ratio30-aug1-seed1
get_celeba - split:train, aug: False, given_y: True, ratio: 0
use existing blonde indices from data/celeba/pickles/blonde
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [48219, 48219]
Target 1: [48219, 48219]
Binary Target 1
---------------------------
Target 0: [48219, 48219]
Target 1: [48219, 48219]
===================================
Normal Label Distribution: 
Target 0: [48219, 48219]
Target 1: [48219, 48219]
===================================
Use BiasedCelebASplit 
 target_attr: blonde split: train 
 tensor([[48219., 48219.],
        [48219., 48219.]])
get_celeba - split:train, aug: 1, given_y: True, ratio: 30
use existing blonde indices from data/celeba/pickles/blonde
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [48082, 48082]
Target 1: [48082, 48082]
Binary Target 1
---------------------------
Target 0: [48082, 48082]
Target 1: [48082, 48082]
===================================
Normal Label Distribution: 
Target 0: [48082, 48082]
Target 1: [48082, 48082]
===================================
Use BiasedCelebASplit 
 target_attr: blonde split: train 
 tensor([[48082., 48082.],
        [48082., 48082.]])
get_celeba - split:train_valid, aug: False, given_y: True, ratio: 0
use existing blonde indices from data/celeba/pickles/blonde
Use BiasedCelebASplit 
 target_attr: blonde split: train_valid 
 tensor([[  390.,  4598.],
        [13361.,   280.]])
get_celeba - split:valid, aug: False, given_y: True, ratio: 0
Use BiasedCelebASplit 
 target_attr: blonde split: valid 
 tensor([[8535., 2874.],
        [8276.,  182.]])
decay_epochs: [3, 6]
[1 / 10] Learning rate: 0.001 weight: 0.01
[1 / 10] Loss: 4.608548211241484 CE Loss: 0.23498514356183284 Con Loss: 4.606198354106488
[1 / 10] tensor([[0.790, 0.881],
        [0.980, 0.967]]) {'epoch': 1, 'valid/acc': 90.338, 'valid/acc_unbiased': 91.724, 'valid/diff': 1.827, 'valid/acc_skew': 92.519, 'valid/acc_align': 90.928, 'test/acc': 85.69, 'test/acc_unbiased': 90.441, 'test/diff': 5.162, 'test/acc_skew': 88.499, 'test/acc_align': 92.383}
[1 / 10] best valid accuracy: 91.724 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 90.338, 'best_valid_valid/acc_unbiased': 91.724, 'best_valid_valid/diff': 1.827, 'best_valid_valid/acc_skew': 92.519, 'best_valid_valid/acc_align': 90.928, 'best_valid_test/acc': 85.69, 'best_valid_test/acc_unbiased': 90.441, 'best_valid_test/diff': 5.162, 'best_valid_test/acc_skew': 88.499, 'best_valid_test/acc_align': 92.383}
[1 / 10] best test accuracy: 90.441 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 90.338, 'best_test_valid/acc_unbiased': 91.724, 'best_test_valid/diff': 1.827, 'best_test_valid/acc_skew': 92.519, 'best_test_valid/acc_align': 90.928, 'best_test_test/acc': 85.69, 'best_test_test/acc_unbiased': 90.441, 'best_test_test/diff': 5.162, 'best_test_test/acc_skew': 88.499, 'best_test_test/acc_align': 92.383}
[2 / 10] Learning rate: 0.001 weight: 0.01
[2 / 10] Loss: 4.5632918984771464 CE Loss: 0.20118257471267809 Con Loss: 4.561280072191511
[2 / 10] tensor([[0.888, 0.932],
        [0.936, 0.912]]) {'epoch': 2, 'valid/acc': 92.667, 'valid/acc_unbiased': 93.294, 'valid/diff': 1.35, 'valid/acc_skew': 93.969, 'valid/acc_align': 92.619, 'test/acc': 91.378, 'test/acc_unbiased': 91.719, 'test/diff': 3.406, 'test/acc_skew': 91.21, 'test/acc_align': 92.227}
[2 / 10] best valid accuracy: 93.294 at epoch 2 
 best_stats: {'best_valid_epoch': 2, 'best_valid_valid/acc': 92.667, 'best_valid_valid/acc_unbiased': 93.294, 'best_valid_valid/diff': 1.35, 'best_valid_valid/acc_skew': 93.969, 'best_valid_valid/acc_align': 92.619, 'best_valid_test/acc': 91.378, 'best_valid_test/acc_unbiased': 91.719, 'best_valid_test/diff': 3.406, 'best_valid_test/acc_skew': 91.21, 'best_valid_test/acc_align': 92.227}
[2 / 10] best test accuracy: 91.719 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 92.667, 'best_test_valid/acc_unbiased': 93.294, 'best_test_valid/diff': 1.35, 'best_test_valid/acc_skew': 93.969, 'best_test_valid/acc_align': 92.619, 'best_test_test/acc': 91.378, 'best_test_test/acc_unbiased': 91.719, 'best_test_test/diff': 3.406, 'best_test_test/acc_skew': 91.21, 'best_test_test/acc_align': 92.227}
[3 / 10] Learning rate: 0.001 weight: 0.01
[3 / 10] Loss: 4.532819462607695 CE Loss: 0.1834150069666343 Con Loss: 4.53098531260732
[3 / 10] tensor([[0.869, 0.943],
        [0.951, 0.890]]) {'epoch': 3, 'valid/acc': 93.902, 'valid/acc_unbiased': 94.47, 'valid/diff': 2.846, 'valid/acc_skew': 95.893, 'valid/acc_align': 93.047, 'test/acc': 91.201, 'test/acc_unbiased': 91.329, 'test/diff': 6.746, 'test/acc_skew': 90.98, 'test/acc_align': 91.678}
[3 / 10] best valid accuracy: 94.470 at epoch 3 
 best_stats: {'best_valid_epoch': 3, 'best_valid_valid/acc': 93.902, 'best_valid_valid/acc_unbiased': 94.47, 'best_valid_valid/diff': 2.846, 'best_valid_valid/acc_skew': 95.893, 'best_valid_valid/acc_align': 93.047, 'best_valid_test/acc': 91.201, 'best_valid_test/acc_unbiased': 91.329, 'best_valid_test/diff': 6.746, 'best_valid_test/acc_skew': 90.98, 'best_valid_test/acc_align': 91.678}
[3 / 10] best test accuracy: 91.719 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 92.667, 'best_test_valid/acc_unbiased': 93.294, 'best_test_valid/diff': 1.35, 'best_test_valid/acc_skew': 93.969, 'best_test_valid/acc_align': 92.619, 'best_test_test/acc': 91.378, 'best_test_test/acc_unbiased': 91.719, 'best_test_test/diff': 3.406, 'best_test_test/acc_skew': 91.21, 'best_test_test/acc_align': 92.227}
[4 / 10] Learning rate: 0.0001 weight: 0.01
[4 / 10] Loss: 4.449905286323485 CE Loss: 0.14152202626455057 Con Loss: 4.448490067705506
[4 / 10] tensor([[0.854, 0.956],
        [0.962, 0.835]]) {'epoch': 4, 'valid/acc': 95.426, 'valid/acc_unbiased': 95.816, 'valid/diff': 1.802, 'valid/acc_skew': 96.717, 'valid/acc_align': 94.915, 'test/acc': 91.191, 'test/acc_unbiased': 90.179, 'test/diff': 11.487, 'test/acc_skew': 90.781, 'test/acc_align': 89.577}
[4 / 10] best valid accuracy: 95.816 at epoch 4 
 best_stats: {'best_valid_epoch': 4, 'best_valid_valid/acc': 95.426, 'best_valid_valid/acc_unbiased': 95.816, 'best_valid_valid/diff': 1.802, 'best_valid_valid/acc_skew': 96.717, 'best_valid_valid/acc_align': 94.915, 'best_valid_test/acc': 91.191, 'best_valid_test/acc_unbiased': 90.179, 'best_valid_test/diff': 11.487, 'best_valid_test/acc_skew': 90.781, 'best_valid_test/acc_align': 89.577}
[4 / 10] best test accuracy: 91.719 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 92.667, 'best_test_valid/acc_unbiased': 93.294, 'best_test_valid/diff': 1.35, 'best_test_valid/acc_skew': 93.969, 'best_test_valid/acc_align': 92.619, 'best_test_test/acc': 91.378, 'best_test_test/acc_unbiased': 91.719, 'best_test_test/diff': 3.406, 'best_test_test/acc_skew': 91.21, 'best_test_test/acc_align': 92.227}
[5 / 10] Learning rate: 0.0001 weight: 0.01
[5 / 10] Loss: 4.411646862566408 CE Loss: 0.1277032929283479 Con Loss: 4.41036983631917
[5 / 10] tensor([[0.832, 0.946],
        [0.966, 0.874]]) {'epoch': 5, 'valid/acc': 95.115, 'valid/acc_unbiased': 96.546, 'valid/diff': 1.744, 'valid/acc_skew': 97.346, 'valid/acc_align': 95.746, 'test/acc': 89.908, 'test/acc_unbiased': 90.434, 'test/diff': 10.343, 'test/acc_skew': 89.894, 'test/acc_align': 90.975}
[5 / 10] best valid accuracy: 96.546 at epoch 5 
 best_stats: {'best_valid_epoch': 5, 'best_valid_valid/acc': 95.115, 'best_valid_valid/acc_unbiased': 96.546, 'best_valid_valid/diff': 1.744, 'best_valid_valid/acc_skew': 97.346, 'best_valid_valid/acc_align': 95.746, 'best_valid_test/acc': 89.908, 'best_valid_test/acc_unbiased': 90.434, 'best_valid_test/diff': 10.343, 'best_valid_test/acc_skew': 89.894, 'best_valid_test/acc_align': 90.975}
[5 / 10] best test accuracy: 91.719 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 92.667, 'best_test_valid/acc_unbiased': 93.294, 'best_test_valid/diff': 1.35, 'best_test_valid/acc_skew': 93.969, 'best_test_valid/acc_align': 92.619, 'best_test_test/acc': 91.378, 'best_test_test/acc_unbiased': 91.719, 'best_test_test/diff': 3.406, 'best_test_test/acc_skew': 91.21, 'best_test_test/acc_align': 92.227}
[6 / 10] Learning rate: 0.0001 weight: 0.01
[6 / 10] Loss: 4.393273449252629 CE Loss: 0.12051392193294877 Con Loss: 4.39206831037767
[6 / 10] tensor([[0.826, 0.951],
        [0.969, 0.846]]) {'epoch': 6, 'valid/acc': 95.448, 'valid/acc_unbiased': 96.369, 'valid/diff': 2.301, 'valid/acc_skew': 97.519, 'valid/acc_align': 95.219, 'test/acc': 89.913, 'test/acc_unbiased': 89.821, 'test/diff': 12.402, 'test/acc_skew': 89.781, 'test/acc_align': 89.861}
[6 / 10] best valid accuracy: 96.546 at epoch 5 
 best_stats: {'best_valid_epoch': 5, 'best_valid_valid/acc': 95.115, 'best_valid_valid/acc_unbiased': 96.546, 'best_valid_valid/diff': 1.744, 'best_valid_valid/acc_skew': 97.346, 'best_valid_valid/acc_align': 95.746, 'best_valid_test/acc': 89.908, 'best_valid_test/acc_unbiased': 90.434, 'best_valid_test/diff': 10.343, 'best_valid_test/acc_skew': 89.894, 'best_valid_test/acc_align': 90.975}
[6 / 10] best test accuracy: 91.719 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 92.667, 'best_test_valid/acc_unbiased': 93.294, 'best_test_valid/diff': 1.35, 'best_test_valid/acc_skew': 93.969, 'best_test_valid/acc_align': 92.619, 'best_test_test/acc': 91.378, 'best_test_test/acc_unbiased': 91.719, 'best_test_test/diff': 3.406, 'best_test_test/acc_skew': 91.21, 'best_test_test/acc_align': 92.227}
[7 / 10] Learning rate: 1e-05 weight: 0.01
[7 / 10] Loss: 4.381153236927438 CE Loss: 0.11525711732718735 Con Loss: 4.380000671398665
[7 / 10] tensor([[0.830, 0.958],
        [0.968, 0.846]]) {'epoch': 7, 'valid/acc': 95.797, 'valid/acc_unbiased': 96.612, 'valid/diff': 1.488, 'valid/acc_skew': 97.356, 'valid/acc_align': 95.868, 'test/acc': 90.341, 'test/acc_unbiased': 90.052, 'test/diff': 12.525, 'test/acc_skew': 89.882, 'test/acc_align': 90.223}
[7 / 10] best valid accuracy: 96.612 at epoch 7 
 best_stats: {'best_valid_epoch': 7, 'best_valid_valid/acc': 95.797, 'best_valid_valid/acc_unbiased': 96.612, 'best_valid_valid/diff': 1.488, 'best_valid_valid/acc_skew': 97.356, 'best_valid_valid/acc_align': 95.868, 'best_valid_test/acc': 90.341, 'best_valid_test/acc_unbiased': 90.052, 'best_valid_test/diff': 12.525, 'best_valid_test/acc_skew': 89.882, 'best_valid_test/acc_align': 90.223}
[7 / 10] best test accuracy: 91.719 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 92.667, 'best_test_valid/acc_unbiased': 93.294, 'best_test_valid/diff': 1.35, 'best_test_valid/acc_skew': 93.969, 'best_test_valid/acc_align': 92.619, 'best_test_test/acc': 91.378, 'best_test_test/acc_unbiased': 91.719, 'best_test_test/diff': 3.406, 'best_test_test/acc_skew': 91.21, 'best_test_test/acc_align': 92.227}
[8 / 10] Learning rate: 1e-05 weight: 0.01
[8 / 10] Loss: 4.3741654972169846 CE Loss: 0.1129420882634782 Con Loss: 4.373036067462422
[8 / 10] tensor([[0.834, 0.959],
        [0.966, 0.786]]) {'epoch': 8, 'valid/acc': 96.065, 'valid/acc_unbiased': 97.016, 'valid/diff': 1.317, 'valid/acc_skew': 97.645, 'valid/acc_align': 96.386, 'test/acc': 90.467, 'test/acc_unbiased': 88.619, 'test/diff': 15.315, 'test/acc_skew': 89.988, 'test/acc_align': 87.25}
[8 / 10] best valid accuracy: 97.016 at epoch 8 
 best_stats: {'best_valid_epoch': 8, 'best_valid_valid/acc': 96.065, 'best_valid_valid/acc_unbiased': 97.016, 'best_valid_valid/diff': 1.317, 'best_valid_valid/acc_skew': 97.645, 'best_valid_valid/acc_align': 96.386, 'best_valid_test/acc': 90.467, 'best_valid_test/acc_unbiased': 88.619, 'best_valid_test/diff': 15.315, 'best_valid_test/acc_skew': 89.988, 'best_valid_test/acc_align': 87.25}
[8 / 10] best test accuracy: 91.719 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 92.667, 'best_test_valid/acc_unbiased': 93.294, 'best_test_valid/diff': 1.35, 'best_test_valid/acc_skew': 93.969, 'best_test_valid/acc_align': 92.619, 'best_test_test/acc': 91.378, 'best_test_test/acc_unbiased': 91.719, 'best_test_test/diff': 3.406, 'best_test_test/acc_skew': 91.21, 'best_test_test/acc_align': 92.227}
[9 / 10] Learning rate: 1e-05 weight: 0.01
[9 / 10] Loss: 4.365323505861647 CE Loss: 0.11281680861095245 Con Loss: 4.3641953411461065
[9 / 10] tensor([[0.824, 0.959],
        [0.973, 0.802]]) {'epoch': 9, 'valid/acc': 95.877, 'valid/acc_unbiased': 96.861, 'valid/diff': 1.273, 'valid/acc_skew': 97.498, 'valid/acc_align': 96.225, 'test/acc': 90.185, 'test/acc_unbiased': 88.973, 'test/diff': 15.29, 'test/acc_skew': 89.879, 'test/acc_align': 88.068}
[9 / 10] best valid accuracy: 97.016 at epoch 8 
 best_stats: {'best_valid_epoch': 8, 'best_valid_valid/acc': 96.065, 'best_valid_valid/acc_unbiased': 97.016, 'best_valid_valid/diff': 1.317, 'best_valid_valid/acc_skew': 97.645, 'best_valid_valid/acc_align': 96.386, 'best_valid_test/acc': 90.467, 'best_valid_test/acc_unbiased': 88.619, 'best_valid_test/diff': 15.315, 'best_valid_test/acc_skew': 89.988, 'best_valid_test/acc_align': 87.25}
[9 / 10] best test accuracy: 91.719 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 92.667, 'best_test_valid/acc_unbiased': 93.294, 'best_test_valid/diff': 1.35, 'best_test_valid/acc_skew': 93.969, 'best_test_valid/acc_align': 92.619, 'best_test_test/acc': 91.378, 'best_test_test/acc_unbiased': 91.719, 'best_test_test/diff': 3.406, 'best_test_test/acc_skew': 91.21, 'best_test_test/acc_align': 92.227}
[10 / 10] Learning rate: 1e-05 weight: 0.01
[10 / 10] Loss: 4.367193165906108 CE Loss: 0.11110198242806268 Con Loss: 4.366082142912349
[10 / 10] tensor([[0.820, 0.958],
        [0.966, 0.808]]) {'epoch': 10, 'valid/acc': 95.856, 'valid/acc_unbiased': 96.788, 'valid/diff': 1.141, 'valid/acc_skew': 97.359, 'valid/acc_align': 96.218, 'test/acc': 89.847, 'test/acc_unbiased': 88.795, 'test/diff': 14.806, 'test/acc_skew': 89.32, 'test/acc_align': 88.27}
[10 / 10] best valid accuracy: 97.016 at epoch 8 
 best_stats: {'best_valid_epoch': 8, 'best_valid_valid/acc': 96.065, 'best_valid_valid/acc_unbiased': 97.016, 'best_valid_valid/diff': 1.317, 'best_valid_valid/acc_skew': 97.645, 'best_valid_valid/acc_align': 96.386, 'best_valid_test/acc': 90.467, 'best_valid_test/acc_unbiased': 88.619, 'best_valid_test/diff': 15.315, 'best_valid_test/acc_skew': 89.988, 'best_valid_test/acc_align': 87.25}
[10 / 10] best test accuracy: 91.719 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 92.667, 'best_test_valid/acc_unbiased': 93.294, 'best_test_valid/diff': 1.35, 'best_test_valid/acc_skew': 93.969, 'best_test_valid/acc_align': 92.619, 'best_test_test/acc': 91.378, 'best_test_test/acc_unbiased': 91.719, 'best_test_test/diff': 3.406, 'best_test_test/acc_skew': 91.21, 'best_test_test/acc_align': 92.227}
Total training time: 2:29:01
