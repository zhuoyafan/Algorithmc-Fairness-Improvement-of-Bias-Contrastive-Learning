Log level set to: INFO
Set seed: 3
=======> Using Fixed Random Seed: 3 <========
save_path: exp_results/bc-bb0-utk_face_age-crop_rotate_color-0.9-lr0.001-bs128-cbs64-w0.01-ratio10-aug1-seed3
get_utk_face - split: train, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_age-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
Binary Target 1
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Normal Label Distribution: 
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
Binary Target 1
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Normal Label Distribution: 
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 10684, target_attr: gender, bias_attr: age bias_rate: 0.9
['[train] target_0-bias_0: 8237', '[train] target_0-bias_1: 147', '[train] target_1-bias_0: 823', '[train] target_1-bias_1: 1477']
confusion_matrix - 
 original: tensor([[8237.,  823.],
        [ 147., 1477.]]), 
 normalized: tensor([[0.909, 0.091],
        [0.091, 0.909]]), 
 b|y: tensor([[0.982, 0.018],
        [0.358, 0.642]])
get_utk_face - split: train, aug: 1, given_y: True, ratio: 10
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_age-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
Binary Target 1
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Normal Label Distribution: 
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
Binary Target 1
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Normal Label Distribution: 
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 10684, target_attr: gender, bias_attr: age bias_rate: 0.9
['[train] target_0-bias_0: 8237', '[train] target_0-bias_1: 147', '[train] target_1-bias_0: 823', '[train] target_1-bias_1: 1477']
get_utk_face - split: valid, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_age-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [1030, 195]
Target 1: [841, 202]
Binary Target 1
---------------------------
Target 0: [1030, 195]
Target 1: [841, 202]
===================================
Normal Label Distribution: 
Target 0: [1030, 195]
Target 1: [841, 202]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 2268, target_attr: gender, bias_attr: age bias_rate: 0.9
['[valid] target_0-bias_0: 1030', '[valid] target_0-bias_1: 195', '[valid] target_1-bias_0: 841', '[valid] target_1-bias_1: 202']
get_utk_face - split: test, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_age-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [1061, 176]
Target 1: [867, 165]
Binary Target 1
---------------------------
Target 0: [1061, 176]
Target 1: [867, 165]
===================================
Normal Label Distribution: 
Target 0: [1061, 176]
Target 1: [867, 165]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 2269, target_attr: gender, bias_attr: age bias_rate: 0.9
['[test] target_0-bias_0: 1061', '[test] target_0-bias_1: 176', '[test] target_1-bias_0: 867', '[test] target_1-bias_1: 165']
decay_epochs: [6, 13]
[1 / 20] Learning rate: 0.001 weight: 0.01
[1 / 20] Loss: 4.876110463943967 CE Loss: 0.5849972217996127 Con Loss: 4.8702604991137335
[1 / 20] tensor([[1., 1.],
        [0., 0.]]) {'epoch': 1, 'valid/acc': 54.012, 'valid/acc_unbiased': 50.0, 'valid/diff': 0.0, 'valid/acc_skew': 50.0, 'valid/acc_align': 50.0, 'test/acc': 54.517, 'test/acc_unbiased': 50.0, 'test/diff': 0.0, 'test/acc_skew': 50.0, 'test/acc_align': 50.0}
[1 / 20] best valid accuracy: 50.000 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 54.012, 'best_valid_valid/acc_unbiased': 50.0, 'best_valid_valid/diff': 0.0, 'best_valid_valid/acc_skew': 50.0, 'best_valid_valid/acc_align': 50.0, 'best_valid_test/acc': 54.517, 'best_valid_test/acc_unbiased': 50.0, 'best_valid_test/diff': 0.0, 'best_valid_test/acc_skew': 50.0, 'best_valid_test/acc_align': 50.0}
[1 / 20] best test accuracy: 50.000 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 54.012, 'best_test_valid/acc_unbiased': 50.0, 'best_test_valid/diff': 0.0, 'best_test_valid/acc_skew': 50.0, 'best_test_valid/acc_align': 50.0, 'best_test_test/acc': 54.517, 'best_test_test/acc_unbiased': 50.0, 'best_test_test/diff': 0.0, 'best_test_test/acc_skew': 50.0, 'best_test_test/acc_align': 50.0}
[2 / 20] Learning rate: 0.001 weight: 0.01
[2 / 20] Loss: 4.716982114542651 CE Loss: 0.5437160835244691 Con Loss: 4.711544930734067
[2 / 20] tensor([[1., 1.],
        [0., 0.]]) {'epoch': 2, 'valid/acc': 54.056, 'valid/acc_unbiased': 50.124, 'valid/diff': 0.248, 'valid/acc_skew': 50.0, 'valid/acc_align': 50.248, 'test/acc': 54.517, 'test/acc_unbiased': 50.0, 'test/diff': 0.0, 'test/acc_skew': 50.0, 'test/acc_align': 50.0}
[2 / 20] best valid accuracy: 50.124 at epoch 2 
 best_stats: {'best_valid_epoch': 2, 'best_valid_valid/acc': 54.056, 'best_valid_valid/acc_unbiased': 50.124, 'best_valid_valid/diff': 0.248, 'best_valid_valid/acc_skew': 50.0, 'best_valid_valid/acc_align': 50.248, 'best_valid_test/acc': 54.517, 'best_valid_test/acc_unbiased': 50.0, 'best_valid_test/diff': 0.0, 'best_valid_test/acc_skew': 50.0, 'best_valid_test/acc_align': 50.0}
[2 / 20] best test accuracy: 50.000 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 54.012, 'best_test_valid/acc_unbiased': 50.0, 'best_test_valid/diff': 0.0, 'best_test_valid/acc_skew': 50.0, 'best_test_valid/acc_align': 50.0, 'best_test_test/acc': 54.517, 'best_test_test/acc_unbiased': 50.0, 'best_test_test/diff': 0.0, 'best_test_test/acc_skew': 50.0, 'best_test_test/acc_align': 50.0}
[3 / 20] Learning rate: 0.001 weight: 0.01
[3 / 20] Loss: 4.698068172464831 CE Loss: 0.5278707256659905 Con Loss: 4.6927894876495095
[3 / 20] tensor([[1., 1.],
        [0., 0.]]) {'epoch': 3, 'valid/acc': 53.968, 'valid/acc_unbiased': 49.877, 'valid/diff': 0.267, 'valid/acc_skew': 49.803, 'valid/acc_align': 49.951, 'test/acc': 54.517, 'test/acc_unbiased': 50.0, 'test/diff': 0.0, 'test/acc_skew': 50.0, 'test/acc_align': 50.0}
[3 / 20] best valid accuracy: 50.124 at epoch 2 
 best_stats: {'best_valid_epoch': 2, 'best_valid_valid/acc': 54.056, 'best_valid_valid/acc_unbiased': 50.124, 'best_valid_valid/diff': 0.248, 'best_valid_valid/acc_skew': 50.0, 'best_valid_valid/acc_align': 50.248, 'best_valid_test/acc': 54.517, 'best_valid_test/acc_unbiased': 50.0, 'best_valid_test/diff': 0.0, 'best_valid_test/acc_skew': 50.0, 'best_valid_test/acc_align': 50.0}
[3 / 20] best test accuracy: 50.000 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 54.012, 'best_test_valid/acc_unbiased': 50.0, 'best_test_valid/diff': 0.0, 'best_test_valid/acc_skew': 50.0, 'best_test_valid/acc_align': 50.0, 'best_test_test/acc': 54.517, 'best_test_test/acc_unbiased': 50.0, 'best_test_test/diff': 0.0, 'best_test_test/acc_skew': 50.0, 'best_test_test/acc_align': 50.0}
[4 / 20] Learning rate: 0.001 weight: 0.01
[4 / 20] Loss: 4.695651852026811 CE Loss: 0.5209430883502925 Con Loss: 4.690442400539203
[4 / 20] tensor([[0.993, 0.994],
        [0.052, 0.018]]) {'epoch': 4, 'valid/acc': 55.6, 'valid/acc_unbiased': 51.408, 'valid/diff': 1.903, 'valid/acc_skew': 52.36, 'valid/acc_align': 50.456, 'test/acc': 56.28, 'test/acc_unbiased': 51.445, 'test/diff': 1.732, 'test/acc_skew': 52.311, 'test/acc_align': 50.579}
[4 / 20] best valid accuracy: 51.408 at epoch 4 
 best_stats: {'best_valid_epoch': 4, 'best_valid_valid/acc': 55.6, 'best_valid_valid/acc_unbiased': 51.408, 'best_valid_valid/diff': 1.903, 'best_valid_valid/acc_skew': 52.36, 'best_valid_valid/acc_align': 50.456, 'best_valid_test/acc': 56.28, 'best_valid_test/acc_unbiased': 51.445, 'best_valid_test/diff': 1.732, 'best_valid_test/acc_skew': 52.311, 'best_valid_test/acc_align': 50.579}
[4 / 20] best test accuracy: 51.445 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 55.6, 'best_test_valid/acc_unbiased': 51.408, 'best_test_valid/diff': 1.903, 'best_test_valid/acc_skew': 52.36, 'best_test_valid/acc_align': 50.456, 'best_test_test/acc': 56.28, 'best_test_test/acc_unbiased': 51.445, 'best_test_test/diff': 1.732, 'best_test_test/acc_skew': 52.311, 'best_test_test/acc_align': 50.579}
[5 / 20] Learning rate: 0.001 weight: 0.01
[5 / 20] Loss: 4.687154832202279 CE Loss: 0.5003433913516891 Con Loss: 4.682151409893257
[5 / 20] tensor([[0.970, 0.994],
        [0.134, 0.024]]) {'epoch': 5, 'valid/acc': 57.451, 'valid/acc_unbiased': 53.028, 'valid/diff': 4.416, 'valid/acc_skew': 55.236, 'valid/acc_align': 50.82, 'test/acc': 58.352, 'test/acc_unbiased': 53.055, 'test/diff': 6.702, 'test/acc_skew': 56.406, 'test/acc_align': 49.704}
[5 / 20] best valid accuracy: 53.028 at epoch 5 
 best_stats: {'best_valid_epoch': 5, 'best_valid_valid/acc': 57.451, 'best_valid_valid/acc_unbiased': 53.028, 'best_valid_valid/diff': 4.416, 'best_valid_valid/acc_skew': 55.236, 'best_valid_valid/acc_align': 50.82, 'best_valid_test/acc': 58.352, 'best_valid_test/acc_unbiased': 53.055, 'best_valid_test/diff': 6.702, 'best_valid_test/acc_skew': 56.406, 'best_valid_test/acc_align': 49.704}
[5 / 20] best test accuracy: 53.055 at epoch 5 
 best_stats: {'best_test_epoch': 5, 'best_test_valid/acc': 57.451, 'best_test_valid/acc_unbiased': 53.028, 'best_test_valid/diff': 4.416, 'best_test_valid/acc_skew': 55.236, 'best_test_valid/acc_align': 50.82, 'best_test_test/acc': 58.352, 'best_test_test/acc_unbiased': 53.055, 'best_test_test/diff': 6.702, 'best_test_test/acc_skew': 56.406, 'best_test_test/acc_align': 49.704}
[6 / 20] Learning rate: 0.001 weight: 0.01
[6 / 20] Loss: 4.695579308688708 CE Loss: 0.5030018418681439 Con Loss: 4.6905493182843205
[6 / 20] tensor([[0.986, 0.994],
        [0.098, 0.048]]) {'epoch': 6, 'valid/acc': 56.878, 'valid/acc_unbiased': 52.86, 'valid/diff': 1.353, 'valid/acc_skew': 53.177, 'valid/acc_align': 52.543, 'test/acc': 57.911, 'test/acc_unbiased': 53.168, 'test/diff': 2.901, 'test/acc_skew': 54.618, 'test/acc_align': 51.717}
[6 / 20] best valid accuracy: 53.028 at epoch 5 
 best_stats: {'best_valid_epoch': 5, 'best_valid_valid/acc': 57.451, 'best_valid_valid/acc_unbiased': 53.028, 'best_valid_valid/diff': 4.416, 'best_valid_valid/acc_skew': 55.236, 'best_valid_valid/acc_align': 50.82, 'best_valid_test/acc': 58.352, 'best_valid_test/acc_unbiased': 53.055, 'best_valid_test/diff': 6.702, 'best_valid_test/acc_skew': 56.406, 'best_valid_test/acc_align': 49.704}
[6 / 20] best test accuracy: 53.168 at epoch 6 
 best_stats: {'best_test_epoch': 6, 'best_test_valid/acc': 56.878, 'best_test_valid/acc_unbiased': 52.86, 'best_test_valid/diff': 1.353, 'best_test_valid/acc_skew': 53.177, 'best_test_valid/acc_align': 52.543, 'best_test_test/acc': 57.911, 'best_test_test/acc_unbiased': 53.168, 'best_test_test/diff': 2.901, 'best_test_test/acc_skew': 54.618, 'best_test_test/acc_align': 51.717}
[7 / 20] Learning rate: 0.0001 weight: 0.01
[7 / 20] Loss: 4.652602401220678 CE Loss: 0.49173408102917787 Con Loss: 4.647685067388548
[7 / 20] tensor([[0.965, 0.972],
        [0.191, 0.048]]) {'epoch': 7, 'valid/acc': 58.862, 'valid/acc_unbiased': 54.194, 'valid/diff': 4.57, 'valid/acc_skew': 56.272, 'valid/acc_align': 52.116, 'test/acc': 60.335, 'test/acc_unbiased': 54.417, 'test/diff': 7.472, 'test/acc_skew': 58.153, 'test/acc_align': 50.681}
[7 / 20] best valid accuracy: 54.194 at epoch 7 
 best_stats: {'best_valid_epoch': 7, 'best_valid_valid/acc': 58.862, 'best_valid_valid/acc_unbiased': 54.194, 'best_valid_valid/diff': 4.57, 'best_valid_valid/acc_skew': 56.272, 'best_valid_valid/acc_align': 52.116, 'best_valid_test/acc': 60.335, 'best_valid_test/acc_unbiased': 54.417, 'best_valid_test/diff': 7.472, 'best_valid_test/acc_skew': 58.153, 'best_valid_test/acc_align': 50.681}
[7 / 20] best test accuracy: 54.417 at epoch 7 
 best_stats: {'best_test_epoch': 7, 'best_test_valid/acc': 58.862, 'best_test_valid/acc_unbiased': 54.194, 'best_test_valid/diff': 4.57, 'best_test_valid/acc_skew': 56.272, 'best_test_valid/acc_align': 52.116, 'best_test_test/acc': 60.335, 'best_test_test/acc_unbiased': 54.417, 'best_test_test/diff': 7.472, 'best_test_test/acc_skew': 58.153, 'best_test_test/acc_align': 50.681}
[8 / 20] Learning rate: 0.0001 weight: 0.01
[8 / 20] Loss: 4.632557869671615 CE Loss: 0.485252235208902 Con Loss: 4.627705329100945
[8 / 20] tensor([[0.968, 0.972],
        [0.225, 0.036]]) {'epoch': 8, 'valid/acc': 60.979, 'valid/acc_unbiased': 55.801, 'valid/diff': 7.08, 'valid/acc_skew': 59.341, 'valid/acc_align': 52.261, 'test/acc': 61.657, 'test/acc_unbiased': 55.021, 'test/diff': 9.609, 'test/acc_skew': 59.825, 'test/acc_align': 50.216}
[8 / 20] best valid accuracy: 55.801 at epoch 8 
 best_stats: {'best_valid_epoch': 8, 'best_valid_valid/acc': 60.979, 'best_valid_valid/acc_unbiased': 55.801, 'best_valid_valid/diff': 7.08, 'best_valid_valid/acc_skew': 59.341, 'best_valid_valid/acc_align': 52.261, 'best_valid_test/acc': 61.657, 'best_valid_test/acc_unbiased': 55.021, 'best_valid_test/diff': 9.609, 'best_valid_test/acc_skew': 59.825, 'best_valid_test/acc_align': 50.216}
[8 / 20] best test accuracy: 55.021 at epoch 8 
 best_stats: {'best_test_epoch': 8, 'best_test_valid/acc': 60.979, 'best_test_valid/acc_unbiased': 55.801, 'best_test_valid/diff': 7.08, 'best_test_valid/acc_skew': 59.341, 'best_test_valid/acc_align': 52.261, 'best_test_test/acc': 61.657, 'best_test_test/acc_unbiased': 55.021, 'best_test_test/diff': 9.609, 'best_test_test/acc_skew': 59.825, 'best_test_test/acc_align': 50.216}
[9 / 20] Learning rate: 0.0001 weight: 0.01
[9 / 20] Loss: 4.622424247603164 CE Loss: 0.4817365990600886 Con Loss: 4.617606882118902
[9 / 20] tensor([[0.946, 0.966],
        [0.328, 0.085]]) {'epoch': 9, 'valid/acc': 63.845, 'valid/acc_unbiased': 58.267, 'valid/diff': 11.157, 'valid/acc_skew': 63.845, 'valid/acc_align': 52.688, 'test/acc': 64.874, 'test/acc_unbiased': 58.115, 'test/diff': 13.117, 'test/acc_skew': 64.674, 'test/acc_align': 51.556}
[9 / 20] best valid accuracy: 58.267 at epoch 9 
 best_stats: {'best_valid_epoch': 9, 'best_valid_valid/acc': 63.845, 'best_valid_valid/acc_unbiased': 58.267, 'best_valid_valid/diff': 11.157, 'best_valid_valid/acc_skew': 63.845, 'best_valid_valid/acc_align': 52.688, 'best_valid_test/acc': 64.874, 'best_valid_test/acc_unbiased': 58.115, 'best_valid_test/diff': 13.117, 'best_valid_test/acc_skew': 64.674, 'best_valid_test/acc_align': 51.556}
[9 / 20] best test accuracy: 58.115 at epoch 9 
 best_stats: {'best_test_epoch': 9, 'best_test_valid/acc': 63.845, 'best_test_valid/acc_unbiased': 58.267, 'best_test_valid/diff': 11.157, 'best_test_valid/acc_skew': 63.845, 'best_test_valid/acc_align': 52.688, 'best_test_test/acc': 64.874, 'best_test_test/acc_unbiased': 58.115, 'best_test_test/diff': 13.117, 'best_test_test/acc_skew': 64.674, 'best_test_test/acc_align': 51.556}
[10 / 20] Learning rate: 0.0001 weight: 0.01
[10 / 20] Loss: 4.6097043530854425 CE Loss: 0.4738319704970899 Con Loss: 4.6049660122470435
[10 / 20] tensor([[0.938, 0.972],
        [0.378, 0.085]]) {'epoch': 10, 'valid/acc': 65.168, 'valid/acc_unbiased': 59.218, 'valid/diff': 12.777, 'valid/acc_skew': 65.606, 'valid/acc_align': 52.829, 'test/acc': 66.461, 'test/acc_unbiased': 59.314, 'test/diff': 16.363, 'test/acc_skew': 67.495, 'test/acc_align': 51.132}
[10 / 20] best valid accuracy: 59.218 at epoch 10 
 best_stats: {'best_valid_epoch': 10, 'best_valid_valid/acc': 65.168, 'best_valid_valid/acc_unbiased': 59.218, 'best_valid_valid/diff': 12.777, 'best_valid_valid/acc_skew': 65.606, 'best_valid_valid/acc_align': 52.829, 'best_valid_test/acc': 66.461, 'best_valid_test/acc_unbiased': 59.314, 'best_valid_test/diff': 16.363, 'best_valid_test/acc_skew': 67.495, 'best_valid_test/acc_align': 51.132}
[10 / 20] best test accuracy: 59.314 at epoch 10 
 best_stats: {'best_test_epoch': 10, 'best_test_valid/acc': 65.168, 'best_test_valid/acc_unbiased': 59.218, 'best_test_valid/diff': 12.777, 'best_test_valid/acc_skew': 65.606, 'best_test_valid/acc_align': 52.829, 'best_test_test/acc': 66.461, 'best_test_test/acc_unbiased': 59.314, 'best_test_test/diff': 16.363, 'best_test_test/acc_skew': 67.495, 'best_test_test/acc_align': 51.132}
[11 / 20] Learning rate: 0.0001 weight: 0.01
[11 / 20] Loss: 4.591913285035848 CE Loss: 0.46854098302422725 Con Loss: 4.587227877585105
[11 / 20] tensor([[0.923, 0.909],
        [0.469, 0.230]]) {'epoch': 11, 'valid/acc': 68.386, 'valid/acc_unbiased': 62.932, 'valid/diff': 10.98, 'valid/acc_skew': 65.688, 'valid/acc_align': 60.177, 'test/acc': 69.81, 'test/acc_unbiased': 63.289, 'test/diff': 12.638, 'test/acc_skew': 68.926, 'test/acc_align': 57.651}
[11 / 20] best valid accuracy: 62.932 at epoch 11 
 best_stats: {'best_valid_epoch': 11, 'best_valid_valid/acc': 68.386, 'best_valid_valid/acc_unbiased': 62.932, 'best_valid_valid/diff': 10.98, 'best_valid_valid/acc_skew': 65.688, 'best_valid_valid/acc_align': 60.177, 'best_valid_test/acc': 69.81, 'best_valid_test/acc_unbiased': 63.289, 'best_valid_test/diff': 12.638, 'best_valid_test/acc_skew': 68.926, 'best_valid_test/acc_align': 57.651}
[11 / 20] best test accuracy: 63.289 at epoch 11 
 best_stats: {'best_test_epoch': 11, 'best_test_valid/acc': 68.386, 'best_test_valid/acc_unbiased': 62.932, 'best_test_valid/diff': 10.98, 'best_test_valid/acc_skew': 65.688, 'best_test_valid/acc_align': 60.177, 'best_test_test/acc': 69.81, 'best_test_test/acc_unbiased': 63.289, 'best_test_test/diff': 12.638, 'best_test_test/acc_skew': 68.926, 'best_test_test/acc_align': 57.651}
[12 / 20] Learning rate: 0.0001 weight: 0.01
[12 / 20] Loss: 4.54660553505518 CE Loss: 0.4713256194635261 Con Loss: 4.541892282349569
[12 / 20] tensor([[0.949, 0.909],
        [0.420, 0.248]]) {'epoch': 12, 'valid/acc': 68.21, 'valid/acc_unbiased': 62.615, 'valid/diff': 10.31, 'valid/acc_skew': 63.703, 'valid/acc_align': 61.526, 'test/acc': 69.282, 'test/acc_unbiased': 63.163, 'test/diff': 10.568, 'test/acc_skew': 66.446, 'test/acc_align': 59.879}
[12 / 20] best valid accuracy: 62.932 at epoch 11 
 best_stats: {'best_valid_epoch': 11, 'best_valid_valid/acc': 68.386, 'best_valid_valid/acc_unbiased': 62.932, 'best_valid_valid/diff': 10.98, 'best_valid_valid/acc_skew': 65.688, 'best_valid_valid/acc_align': 60.177, 'best_valid_test/acc': 69.81, 'best_valid_test/acc_unbiased': 63.289, 'best_valid_test/diff': 12.638, 'best_valid_test/acc_skew': 68.926, 'best_valid_test/acc_align': 57.651}
[12 / 20] best test accuracy: 63.289 at epoch 11 
 best_stats: {'best_test_epoch': 11, 'best_test_valid/acc': 68.386, 'best_test_valid/acc_unbiased': 62.932, 'best_test_valid/diff': 10.98, 'best_test_valid/acc_skew': 65.688, 'best_test_valid/acc_align': 60.177, 'best_test_test/acc': 69.81, 'best_test_test/acc_unbiased': 63.289, 'best_test_test/diff': 12.638, 'best_test_test/acc_skew': 68.926, 'best_test_test/acc_align': 57.651}
[13 / 20] Learning rate: 0.0001 weight: 0.01
[13 / 20] Loss: 4.580157553823821 CE Loss: 0.45962354424784396 Con Loss: 4.5755613188491875
[13 / 20] tensor([[0.958, 0.932],
        [0.403, 0.212]]) {'epoch': 13, 'valid/acc': 66.975, 'valid/acc_unbiased': 61.465, 'valid/diff': 9.441, 'valid/acc_skew': 62.451, 'valid/acc_align': 60.478, 'test/acc': 68.929, 'test/acc_unbiased': 62.602, 'test/diff': 10.809, 'test/acc_skew': 66.718, 'test/acc_align': 58.485}
[13 / 20] best valid accuracy: 62.932 at epoch 11 
 best_stats: {'best_valid_epoch': 11, 'best_valid_valid/acc': 68.386, 'best_valid_valid/acc_unbiased': 62.932, 'best_valid_valid/diff': 10.98, 'best_valid_valid/acc_skew': 65.688, 'best_valid_valid/acc_align': 60.177, 'best_valid_test/acc': 69.81, 'best_valid_test/acc_unbiased': 63.289, 'best_valid_test/diff': 12.638, 'best_valid_test/acc_skew': 68.926, 'best_valid_test/acc_align': 57.651}
[13 / 20] best test accuracy: 63.289 at epoch 11 
 best_stats: {'best_test_epoch': 11, 'best_test_valid/acc': 68.386, 'best_test_valid/acc_unbiased': 62.932, 'best_test_valid/diff': 10.98, 'best_test_valid/acc_skew': 65.688, 'best_test_valid/acc_align': 60.177, 'best_test_test/acc': 69.81, 'best_test_test/acc_unbiased': 63.289, 'best_test_test/diff': 12.638, 'best_test_test/acc_skew': 68.926, 'best_test_test/acc_align': 57.651}
[14 / 20] Learning rate: 1e-05 weight: 0.01
[14 / 20] Loss: 4.54620638772014 CE Loss: 0.4516610410699055 Con Loss: 4.54168979312007
[14 / 20] tensor([[0.948, 0.903],
        [0.457, 0.236]]) {'epoch': 14, 'valid/acc': 68.871, 'valid/acc_unbiased': 63.254, 'valid/diff': 10.599, 'valid/acc_skew': 64.536, 'valid/acc_align': 61.973, 'test/acc': 70.516, 'test/acc_unbiased': 63.617, 'test/diff': 13.257, 'test/acc_skew': 68.008, 'test/acc_align': 59.226}
[14 / 20] best valid accuracy: 63.254 at epoch 14 
 best_stats: {'best_valid_epoch': 14, 'best_valid_valid/acc': 68.871, 'best_valid_valid/acc_unbiased': 63.254, 'best_valid_valid/diff': 10.599, 'best_valid_valid/acc_skew': 64.536, 'best_valid_valid/acc_align': 61.973, 'best_valid_test/acc': 70.516, 'best_valid_test/acc_unbiased': 63.617, 'best_valid_test/diff': 13.257, 'best_valid_test/acc_skew': 68.008, 'best_valid_test/acc_align': 59.226}
[14 / 20] best test accuracy: 63.617 at epoch 14 
 best_stats: {'best_test_epoch': 14, 'best_test_valid/acc': 68.871, 'best_test_valid/acc_unbiased': 63.254, 'best_test_valid/diff': 10.599, 'best_test_valid/acc_skew': 64.536, 'best_test_valid/acc_align': 61.973, 'best_test_test/acc': 70.516, 'best_test_test/acc_unbiased': 63.617, 'best_test_test/diff': 13.257, 'best_test_test/acc_skew': 68.008, 'best_test_test/acc_align': 59.226}
[15 / 20] Learning rate: 1e-05 weight: 0.01
[15 / 20] Loss: 4.559594170603579 CE Loss: 0.4495542045725905 Con Loss: 4.55509863467486
[15 / 20] tensor([[0.951, 0.909],
        [0.450, 0.242]]) {'epoch': 15, 'valid/acc': 68.871, 'valid/acc_unbiased': 63.224, 'valid/diff': 10.573, 'valid/acc_skew': 63.785, 'valid/acc_align': 62.662, 'test/acc': 70.472, 'test/acc_unbiased': 63.808, 'test/diff': 12.465, 'test/acc_skew': 67.946, 'test/acc_align': 59.671}
[15 / 20] best valid accuracy: 63.254 at epoch 14 
 best_stats: {'best_valid_epoch': 14, 'best_valid_valid/acc': 68.871, 'best_valid_valid/acc_unbiased': 63.254, 'best_valid_valid/diff': 10.599, 'best_valid_valid/acc_skew': 64.536, 'best_valid_valid/acc_align': 61.973, 'best_valid_test/acc': 70.516, 'best_valid_test/acc_unbiased': 63.617, 'best_valid_test/diff': 13.257, 'best_valid_test/acc_skew': 68.008, 'best_valid_test/acc_align': 59.226}
[15 / 20] best test accuracy: 63.808 at epoch 15 
 best_stats: {'best_test_epoch': 15, 'best_test_valid/acc': 68.871, 'best_test_valid/acc_unbiased': 63.224, 'best_test_valid/diff': 10.573, 'best_test_valid/acc_skew': 63.785, 'best_test_valid/acc_align': 62.662, 'best_test_test/acc': 70.472, 'best_test_test/acc_unbiased': 63.808, 'best_test_test/diff': 12.465, 'best_test_test/acc_skew': 67.946, 'best_test_test/acc_align': 59.671}
[16 / 20] Learning rate: 1e-05 weight: 0.01
[16 / 20] Loss: 4.534882311426446 CE Loss: 0.4453832274159882 Con Loss: 4.530428472238281
[16 / 20] tensor([[0.955, 0.920],
        [0.434, 0.230]]) {'epoch': 16, 'valid/acc': 67.989, 'valid/acc_unbiased': 62.226, 'valid/diff': 10.557, 'valid/acc_skew': 62.537, 'valid/acc_align': 61.915, 'test/acc': 70.031, 'test/acc_unbiased': 63.48, 'test/diff': 11.884, 'test/acc_skew': 67.707, 'test/acc_align': 59.253}
[16 / 20] best valid accuracy: 63.254 at epoch 14 
 best_stats: {'best_valid_epoch': 14, 'best_valid_valid/acc': 68.871, 'best_valid_valid/acc_unbiased': 63.254, 'best_valid_valid/diff': 10.599, 'best_valid_valid/acc_skew': 64.536, 'best_valid_valid/acc_align': 61.973, 'best_valid_test/acc': 70.516, 'best_valid_test/acc_unbiased': 63.617, 'best_valid_test/diff': 13.257, 'best_valid_test/acc_skew': 68.008, 'best_valid_test/acc_align': 59.226}
[16 / 20] best test accuracy: 63.808 at epoch 15 
 best_stats: {'best_test_epoch': 15, 'best_test_valid/acc': 68.871, 'best_test_valid/acc_unbiased': 63.224, 'best_test_valid/diff': 10.573, 'best_test_valid/acc_skew': 63.785, 'best_test_valid/acc_align': 62.662, 'best_test_test/acc': 70.472, 'best_test_test/acc_unbiased': 63.808, 'best_test_test/diff': 12.465, 'best_test_test/acc_skew': 67.946, 'best_test_test/acc_align': 59.671}
[17 / 20] Learning rate: 1e-05 weight: 0.01
[17 / 20] Loss: 4.4806611171066875 CE Loss: 0.44562549858403894 Con Loss: 4.476204849815868
[17 / 20] tensor([[0.955, 0.903],
        [0.427, 0.230]]) {'epoch': 17, 'valid/acc': 68.122, 'valid/acc_unbiased': 62.209, 'valid/diff': 11.001, 'valid/acc_skew': 62.853, 'valid/acc_align': 61.565, 'test/acc': 69.634, 'test/acc_unbiased': 62.881, 'test/diff': 12.39, 'test/acc_skew': 66.508, 'test/acc_align': 59.253}
[17 / 20] best valid accuracy: 63.254 at epoch 14 
 best_stats: {'best_valid_epoch': 14, 'best_valid_valid/acc': 68.871, 'best_valid_valid/acc_unbiased': 63.254, 'best_valid_valid/diff': 10.599, 'best_valid_valid/acc_skew': 64.536, 'best_valid_valid/acc_align': 61.973, 'best_valid_test/acc': 70.516, 'best_valid_test/acc_unbiased': 63.617, 'best_valid_test/diff': 13.257, 'best_valid_test/acc_skew': 68.008, 'best_valid_test/acc_align': 59.226}
[17 / 20] best test accuracy: 63.808 at epoch 15 
 best_stats: {'best_test_epoch': 15, 'best_test_valid/acc': 68.871, 'best_test_valid/acc_unbiased': 63.224, 'best_test_valid/diff': 10.573, 'best_test_valid/acc_skew': 63.785, 'best_test_valid/acc_align': 62.662, 'best_test_test/acc': 70.472, 'best_test_test/acc_unbiased': 63.808, 'best_test_test/diff': 12.465, 'best_test_test/acc_skew': 67.946, 'best_test_test/acc_align': 59.671}
[18 / 20] Learning rate: 1e-05 weight: 0.01
[18 / 20] Loss: 4.53097704991291 CE Loss: 0.4461544081652401 Con Loss: 4.5265155113488715
[18 / 20] tensor([[0.956, 0.898],
        [0.429, 0.224]]) {'epoch': 18, 'valid/acc': 68.21, 'valid/acc_unbiased': 62.357, 'valid/diff': 10.802, 'valid/acc_skew': 62.853, 'valid/acc_align': 61.861, 'test/acc': 69.678, 'test/acc_unbiased': 62.668, 'test/diff': 13.14, 'test/acc_skew': 66.34, 'test/acc_align': 58.997}
[18 / 20] best valid accuracy: 63.254 at epoch 14 
 best_stats: {'best_valid_epoch': 14, 'best_valid_valid/acc': 68.871, 'best_valid_valid/acc_unbiased': 63.254, 'best_valid_valid/diff': 10.599, 'best_valid_valid/acc_skew': 64.536, 'best_valid_valid/acc_align': 61.973, 'best_valid_test/acc': 70.516, 'best_valid_test/acc_unbiased': 63.617, 'best_valid_test/diff': 13.257, 'best_valid_test/acc_skew': 68.008, 'best_valid_test/acc_align': 59.226}
[18 / 20] best test accuracy: 63.808 at epoch 15 
 best_stats: {'best_test_epoch': 15, 'best_test_valid/acc': 68.871, 'best_test_valid/acc_unbiased': 63.224, 'best_test_valid/diff': 10.573, 'best_test_valid/acc_skew': 63.785, 'best_test_valid/acc_align': 62.662, 'best_test_test/acc': 70.472, 'best_test_test/acc_unbiased': 63.808, 'best_test_test/diff': 12.465, 'best_test_test/acc_skew': 67.946, 'best_test_test/acc_align': 59.671}
[19 / 20] Learning rate: 1e-05 weight: 0.01
[19 / 20] Loss: 4.54535315394714 CE Loss: 0.43905474087666235 Con Loss: 4.540962616275286
[19 / 20] tensor([[0.953, 0.886],
        [0.424, 0.236]]) {'epoch': 19, 'valid/acc': 67.945, 'valid/acc_unbiased': 62.166, 'valid/diff': 10.492, 'valid/acc_skew': 61.53, 'valid/acc_align': 62.803, 'test/acc': 69.37, 'test/acc_unbiased': 62.501, 'test/diff': 12.73, 'test/acc_skew': 65.541, 'test/acc_align': 59.462}
[19 / 20] best valid accuracy: 63.254 at epoch 14 
 best_stats: {'best_valid_epoch': 14, 'best_valid_valid/acc': 68.871, 'best_valid_valid/acc_unbiased': 63.254, 'best_valid_valid/diff': 10.599, 'best_valid_valid/acc_skew': 64.536, 'best_valid_valid/acc_align': 61.973, 'best_valid_test/acc': 70.516, 'best_valid_test/acc_unbiased': 63.617, 'best_valid_test/diff': 13.257, 'best_valid_test/acc_skew': 68.008, 'best_valid_test/acc_align': 59.226}
[19 / 20] best test accuracy: 63.808 at epoch 15 
 best_stats: {'best_test_epoch': 15, 'best_test_valid/acc': 68.871, 'best_test_valid/acc_unbiased': 63.224, 'best_test_valid/diff': 10.573, 'best_test_valid/acc_skew': 63.785, 'best_test_valid/acc_align': 62.662, 'best_test_test/acc': 70.472, 'best_test_test/acc_unbiased': 63.808, 'best_test_test/diff': 12.465, 'best_test_test/acc_skew': 67.946, 'best_test_test/acc_align': 59.671}
[20 / 20] Learning rate: 1e-05 weight: 0.01
[20 / 20] Loss: 4.530075752168325 CE Loss: 0.4404820948560244 Con Loss: 4.5256709017052
[20 / 20] tensor([[0.952, 0.886],
        [0.431, 0.242]]) {'epoch': 20, 'valid/acc': 68.474, 'valid/acc_unbiased': 62.426, 'valid/diff': 11.541, 'valid/acc_skew': 61.849, 'valid/acc_align': 63.002, 'test/acc': 69.634, 'test/acc_unbiased': 62.802, 'test/diff': 12.726, 'test/acc_skew': 65.887, 'test/acc_align': 59.718}
[20 / 20] best valid accuracy: 63.254 at epoch 14 
 best_stats: {'best_valid_epoch': 14, 'best_valid_valid/acc': 68.871, 'best_valid_valid/acc_unbiased': 63.254, 'best_valid_valid/diff': 10.599, 'best_valid_valid/acc_skew': 64.536, 'best_valid_valid/acc_align': 61.973, 'best_valid_test/acc': 70.516, 'best_valid_test/acc_unbiased': 63.617, 'best_valid_test/diff': 13.257, 'best_valid_test/acc_skew': 68.008, 'best_valid_test/acc_align': 59.226}
[20 / 20] best test accuracy: 63.808 at epoch 15 
 best_stats: {'best_test_epoch': 15, 'best_test_valid/acc': 68.871, 'best_test_valid/acc_unbiased': 63.224, 'best_test_valid/diff': 10.573, 'best_test_valid/acc_skew': 63.785, 'best_test_valid/acc_align': 62.662, 'best_test_test/acc': 70.472, 'best_test_test/acc_unbiased': 63.808, 'best_test_test/diff': 12.465, 'best_test_test/acc_skew': 67.946, 'best_test_test/acc_align': 59.671}
Total training time: 0:16:32
