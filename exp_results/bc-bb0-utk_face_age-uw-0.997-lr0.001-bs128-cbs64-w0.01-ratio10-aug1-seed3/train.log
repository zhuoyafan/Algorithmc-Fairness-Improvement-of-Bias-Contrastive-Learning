Log level set to: INFO
Set seed: 3
=======> Using Fixed Random Seed: 3 <========
save_path: exp_results/bc-bb0-utk_face_age-uw-0.997-lr0.001-bs128-cbs64-w0.01-ratio10-aug1-seed3
get_utk_face - split: train, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_age-0.997
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [8237, 4]
Target 1: [24, 1477]
Binary Target 1
---------------------------
Target 0: [8237, 4]
Target 1: [24, 1477]
===================================
Normal Label Distribution: 
Target 0: [8237, 4]
Target 1: [24, 1477]
===================================
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [8237, 4]
Target 1: [24, 1477]
Binary Target 1
---------------------------
Target 0: [8237, 4]
Target 1: [24, 1477]
===================================
Normal Label Distribution: 
Target 0: [8237, 4]
Target 1: [24, 1477]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 9742, target_attr: gender, bias_attr: age bias_rate: 0.997
['[train] target_0-bias_0: 8237', '[train] target_0-bias_1: 4', '[train] target_1-bias_0: 24', '[train] target_1-bias_1: 1477']
confusion_matrix - 
 original: tensor([[8.237e+03, 2.400e+01],
        [4.000e+00, 1.477e+03]]), 
 normalized: tensor([[0.997, 0.003],
        [0.003, 0.997]]), 
 b|y: tensor([[9.995e-01, 4.854e-04],
        [1.599e-02, 9.840e-01]])
get_utk_face - split: train, aug: 1, given_y: True, ratio: 10
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_age-0.997
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [8237, 4]
Target 1: [24, 1477]
Binary Target 1
---------------------------
Target 0: [8237, 4]
Target 1: [24, 1477]
===================================
Normal Label Distribution: 
Target 0: [8237, 4]
Target 1: [24, 1477]
===================================
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [8237, 4]
Target 1: [24, 1477]
Binary Target 1
---------------------------
Target 0: [8237, 4]
Target 1: [24, 1477]
===================================
Normal Label Distribution: 
Target 0: [8237, 4]
Target 1: [24, 1477]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 9742, target_attr: gender, bias_attr: age bias_rate: 0.997
['[train] target_0-bias_0: 8237', '[train] target_0-bias_1: 4', '[train] target_1-bias_0: 24', '[train] target_1-bias_1: 1477']
get_utk_face - split: valid, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_age-0.997
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [1030, 195]
Target 1: [841, 202]
Binary Target 1
---------------------------
Target 0: [1030, 195]
Target 1: [841, 202]
===================================
Normal Label Distribution: 
Target 0: [1030, 195]
Target 1: [841, 202]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 2268, target_attr: gender, bias_attr: age bias_rate: 0.997
['[valid] target_0-bias_0: 1030', '[valid] target_0-bias_1: 195', '[valid] target_1-bias_0: 841', '[valid] target_1-bias_1: 202']
get_utk_face - split: test, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_age-0.997
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [1061, 176]
Target 1: [867, 165]
Binary Target 1
---------------------------
Target 0: [1061, 176]
Target 1: [867, 165]
===================================
Normal Label Distribution: 
Target 0: [1061, 176]
Target 1: [867, 165]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 2269, target_attr: gender, bias_attr: age bias_rate: 0.997
['[test] target_0-bias_0: 1061', '[test] target_0-bias_1: 176', '[test] target_1-bias_0: 867', '[test] target_1-bias_1: 165']
decay_epochs: [6, 13]
[1 / 20] Learning rate: 0.001 weight: 0.01
[1 / 20] Loss: 1.9387937318958117 CE Loss: 3.7445579829389275 Con Loss: 1.9013481508214674
[1 / 20] tensor([[0.116, 0.011],
        [0.980, 0.988]]) {'epoch': 1, 'valid/acc': 51.279, 'valid/acc_unbiased': 52.844, 'valid/diff': 5.933, 'valid/acc_skew': 49.877, 'valid/acc_align': 55.811, 'test/acc': 50.154, 'test/acc_unbiased': 52.389, 'test/diff': 5.603, 'test/acc_skew': 49.588, 'test/acc_align': 55.19}
[1 / 20] best valid accuracy: 52.844 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 51.279, 'best_valid_valid/acc_unbiased': 52.844, 'best_valid_valid/diff': 5.933, 'best_valid_valid/acc_skew': 49.877, 'best_valid_valid/acc_align': 55.811, 'best_valid_test/acc': 50.154, 'best_valid_test/acc_unbiased': 52.389, 'best_valid_test/diff': 5.603, 'best_valid_test/acc_skew': 49.588, 'best_valid_test/acc_align': 55.19}
[1 / 20] best test accuracy: 52.389 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 51.279, 'best_test_valid/acc_unbiased': 52.844, 'best_test_valid/diff': 5.933, 'best_test_valid/acc_skew': 49.877, 'best_test_valid/acc_align': 55.811, 'best_test_test/acc': 50.154, 'best_test_test/acc_unbiased': 52.389, 'best_test_test/diff': 5.603, 'best_test_test/acc_skew': 49.588, 'best_test_test/acc_align': 55.19}
[2 / 20] Learning rate: 0.001 weight: 0.01
[2 / 20] Loss: 1.4497743378282648 CE Loss: 3.01644953154754 Con Loss: 1.4196098451373562
[2 / 20] tensor([[0.003, 0.000],
        [0.999, 1.000]]) {'epoch': 2, 'valid/acc': 45.855, 'valid/acc_unbiased': 49.817, 'valid/diff': 0.129, 'valid/acc_skew': 49.881, 'valid/acc_align': 49.752, 'test/acc': 45.571, 'test/acc_unbiased': 50.042, 'test/diff': 0.199, 'test/acc_skew': 49.942, 'test/acc_align': 50.141}
[2 / 20] best valid accuracy: 52.844 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 51.279, 'best_valid_valid/acc_unbiased': 52.844, 'best_valid_valid/diff': 5.933, 'best_valid_valid/acc_skew': 49.877, 'best_valid_valid/acc_align': 55.811, 'best_valid_test/acc': 50.154, 'best_valid_test/acc_unbiased': 52.389, 'best_valid_test/diff': 5.603, 'best_valid_test/acc_skew': 49.588, 'best_valid_test/acc_align': 55.19}
[2 / 20] best test accuracy: 52.389 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 51.279, 'best_test_valid/acc_unbiased': 52.844, 'best_test_valid/diff': 5.933, 'best_test_valid/acc_skew': 49.877, 'best_test_valid/acc_align': 55.811, 'best_test_test/acc': 50.154, 'best_test_test/acc_unbiased': 52.389, 'best_test_test/diff': 5.603, 'best_test_test/acc_skew': 49.588, 'best_test_test/acc_align': 55.19}
[3 / 20] Learning rate: 0.001 weight: 0.01
[3 / 20] Loss: 1.3565579717640415 CE Loss: 2.990341906061997 Con Loss: 1.32665455632571
[3 / 20] tensor([[0.023, 0.000],
        [0.998, 1.000]]) {'epoch': 3, 'valid/acc': 46.869, 'valid/acc_unbiased': 50.479, 'valid/diff': 0.94, 'valid/acc_skew': 50.138, 'valid/acc_align': 50.82, 'test/acc': 46.452, 'test/acc_unbiased': 50.508, 'test/diff': 1.246, 'test/acc_skew': 49.885, 'test/acc_align': 51.131}
[3 / 20] best valid accuracy: 52.844 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 51.279, 'best_valid_valid/acc_unbiased': 52.844, 'best_valid_valid/diff': 5.933, 'best_valid_valid/acc_skew': 49.877, 'best_valid_valid/acc_align': 55.811, 'best_valid_test/acc': 50.154, 'best_valid_test/acc_unbiased': 52.389, 'best_valid_test/diff': 5.603, 'best_valid_test/acc_skew': 49.588, 'best_valid_test/acc_align': 55.19}
[3 / 20] best test accuracy: 52.389 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 51.279, 'best_test_valid/acc_unbiased': 52.844, 'best_test_valid/diff': 5.933, 'best_test_valid/acc_skew': 49.877, 'best_test_valid/acc_align': 55.811, 'best_test_test/acc': 50.154, 'best_test_test/acc_unbiased': 52.389, 'best_test_test/diff': 5.603, 'best_test_test/acc_skew': 49.588, 'best_test_test/acc_align': 55.19}
[4 / 20] Learning rate: 0.001 weight: 0.01
[4 / 20] Loss: 1.8397380065389346 CE Loss: 3.6967280853996285 Con Loss: 1.8027707211806334
[4 / 20] tensor([[0.276, 0.068],
        [0.851, 0.994]]) {'epoch': 4, 'valid/acc': 53.439, 'valid/acc_unbiased': 54.492, 'valid/diff': 15.522, 'valid/acc_skew': 46.73, 'valid/acc_align': 62.253, 'test/acc': 53.195, 'test/acc_unbiased': 54.737, 'test/diff': 17.535, 'test/acc_skew': 45.97, 'test/acc_align': 63.505}
[4 / 20] best valid accuracy: 54.492 at epoch 4 
 best_stats: {'best_valid_epoch': 4, 'best_valid_valid/acc': 53.439, 'best_valid_valid/acc_unbiased': 54.492, 'best_valid_valid/diff': 15.522, 'best_valid_valid/acc_skew': 46.73, 'best_valid_valid/acc_align': 62.253, 'best_valid_test/acc': 53.195, 'best_valid_test/acc_unbiased': 54.737, 'best_valid_test/diff': 17.535, 'best_valid_test/acc_skew': 45.97, 'best_valid_test/acc_align': 63.505}
[4 / 20] best test accuracy: 54.737 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 53.439, 'best_test_valid/acc_unbiased': 54.492, 'best_test_valid/diff': 15.522, 'best_test_valid/acc_skew': 46.73, 'best_test_valid/acc_align': 62.253, 'best_test_test/acc': 53.195, 'best_test_test/acc_unbiased': 54.737, 'best_test_test/diff': 17.535, 'best_test_test/acc_skew': 45.97, 'best_test_test/acc_align': 63.505}
[5 / 20] Learning rate: 0.001 weight: 0.01
[5 / 20] Loss: 1.468322960154718 CE Loss: 3.140690915223828 Con Loss: 1.4369160399204943
[5 / 20] tensor([[0.917, 0.983],
        [0.057, 0.000]]) {'epoch': 5, 'valid/acc': 51.631, 'valid/acc_unbiased': 48.552, 'valid/diff': 5.162, 'valid/acc_skew': 51.133, 'valid/acc_align': 45.971, 'test/acc': 52.666, 'test/acc_unbiased': 48.913, 'test/diff': 6.121, 'test/acc_skew': 51.974, 'test/acc_align': 45.853}
[5 / 20] best valid accuracy: 54.492 at epoch 4 
 best_stats: {'best_valid_epoch': 4, 'best_valid_valid/acc': 53.439, 'best_valid_valid/acc_unbiased': 54.492, 'best_valid_valid/diff': 15.522, 'best_valid_valid/acc_skew': 46.73, 'best_valid_valid/acc_align': 62.253, 'best_valid_test/acc': 53.195, 'best_valid_test/acc_unbiased': 54.737, 'best_valid_test/diff': 17.535, 'best_valid_test/acc_skew': 45.97, 'best_valid_test/acc_align': 63.505}
[5 / 20] best test accuracy: 54.737 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 53.439, 'best_test_valid/acc_unbiased': 54.492, 'best_test_valid/diff': 15.522, 'best_test_valid/acc_skew': 46.73, 'best_test_valid/acc_align': 62.253, 'best_test_test/acc': 53.195, 'best_test_test/acc_unbiased': 54.737, 'best_test_test/diff': 17.535, 'best_test_test/acc_skew': 45.97, 'best_test_test/acc_align': 63.505}
[6 / 20] Learning rate: 0.001 weight: 0.01
[6 / 20] Loss: 1.674726834179219 CE Loss: 3.026417275176012 Con Loss: 1.6444626706161922
[6 / 20] tensor([[0.873, 0.881],
        [0.227, 0.158]]) {'epoch': 6, 'valid/acc': 55.82, 'valid/acc_unbiased': 51.588, 'valid/diff': 5.176, 'valid/acc_skew': 53.682, 'valid/acc_align': 49.494, 'test/acc': 57.47, 'test/acc_unbiased': 53.456, 'test/diff': 3.878, 'test/acc_skew': 55.395, 'test/acc_align': 51.517}
[6 / 20] best valid accuracy: 54.492 at epoch 4 
 best_stats: {'best_valid_epoch': 4, 'best_valid_valid/acc': 53.439, 'best_valid_valid/acc_unbiased': 54.492, 'best_valid_valid/diff': 15.522, 'best_valid_valid/acc_skew': 46.73, 'best_valid_valid/acc_align': 62.253, 'best_valid_test/acc': 53.195, 'best_valid_test/acc_unbiased': 54.737, 'best_valid_test/diff': 17.535, 'best_valid_test/acc_skew': 45.97, 'best_valid_test/acc_align': 63.505}
[6 / 20] best test accuracy: 54.737 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 53.439, 'best_test_valid/acc_unbiased': 54.492, 'best_test_valid/diff': 15.522, 'best_test_valid/acc_skew': 46.73, 'best_test_valid/acc_align': 62.253, 'best_test_test/acc': 53.195, 'best_test_test/acc_unbiased': 54.737, 'best_test_test/diff': 17.535, 'best_test_test/acc_skew': 45.97, 'best_test_test/acc_align': 63.505}
[7 / 20] Learning rate: 0.0001 weight: 0.01
[7 / 20] Loss: 1.2897698496112928 CE Loss: 2.7094066420073286 Con Loss: 1.2626757838108829
[7 / 20] tensor([[0.611, 0.244],
        [0.651, 0.867]]) {'epoch': 7, 'valid/acc': 60.891, 'valid/acc_unbiased': 56.728, 'valid/diff': 27.567, 'valid/acc_skew': 42.944, 'valid/acc_align': 70.511, 'test/acc': 61.613, 'test/acc_unbiased': 59.306, 'test/diff': 29.129, 'test/acc_skew': 44.742, 'test/acc_align': 73.871}
[7 / 20] best valid accuracy: 56.728 at epoch 7 
 best_stats: {'best_valid_epoch': 7, 'best_valid_valid/acc': 60.891, 'best_valid_valid/acc_unbiased': 56.728, 'best_valid_valid/diff': 27.567, 'best_valid_valid/acc_skew': 42.944, 'best_valid_valid/acc_align': 70.511, 'best_valid_test/acc': 61.613, 'best_valid_test/acc_unbiased': 59.306, 'best_valid_test/diff': 29.129, 'best_valid_test/acc_skew': 44.742, 'best_valid_test/acc_align': 73.871}
[7 / 20] best test accuracy: 59.306 at epoch 7 
 best_stats: {'best_test_epoch': 7, 'best_test_valid/acc': 60.891, 'best_test_valid/acc_unbiased': 56.728, 'best_test_valid/diff': 27.567, 'best_test_valid/acc_skew': 42.944, 'best_test_valid/acc_align': 70.511, 'best_test_test/acc': 61.613, 'best_test_test/acc_unbiased': 59.306, 'best_test_test/diff': 29.129, 'best_test_test/acc_skew': 44.742, 'best_test_test/acc_align': 73.871}
[8 / 20] Learning rate: 0.0001 weight: 0.01
[8 / 20] Loss: 1.3612411330794192 CE Loss: 2.681985737581905 Con Loss: 1.3344212631698604
[8 / 20] tensor([[0.856, 0.824],
        [0.189, 0.152]]) {'epoch': 8, 'valid/acc': 54.982, 'valid/acc_unbiased': 50.836, 'valid/diff': 4.876, 'valid/acc_skew': 50.189, 'valid/acc_align': 51.484, 'test/acc': 54.738, 'test/acc_unbiased': 50.508, 'test/diff': 3.479, 'test/acc_skew': 50.651, 'test/acc_align': 50.366}
[8 / 20] best valid accuracy: 56.728 at epoch 7 
 best_stats: {'best_valid_epoch': 7, 'best_valid_valid/acc': 60.891, 'best_valid_valid/acc_unbiased': 56.728, 'best_valid_valid/diff': 27.567, 'best_valid_valid/acc_skew': 42.944, 'best_valid_valid/acc_align': 70.511, 'best_valid_test/acc': 61.613, 'best_valid_test/acc_unbiased': 59.306, 'best_valid_test/diff': 29.129, 'best_valid_test/acc_skew': 44.742, 'best_valid_test/acc_align': 73.871}
[8 / 20] best test accuracy: 59.306 at epoch 7 
 best_stats: {'best_test_epoch': 7, 'best_test_valid/acc': 60.891, 'best_test_valid/acc_unbiased': 56.728, 'best_test_valid/diff': 27.567, 'best_test_valid/acc_skew': 42.944, 'best_test_valid/acc_align': 70.511, 'best_test_test/acc': 61.613, 'best_test_test/acc_unbiased': 59.306, 'best_test_test/diff': 29.129, 'best_test_test/acc_skew': 44.742, 'best_test_test/acc_align': 73.871}
[9 / 20] Learning rate: 0.0001 weight: 0.01
[9 / 20] Loss: 1.7460443975927404 CE Loss: 2.690363368858818 Con Loss: 1.7191407664359117
[9 / 20] tensor([[0.839, 0.864],
        [0.183, 0.170]]) {'epoch': 9, 'valid/acc': 54.277, 'valid/acc_unbiased': 50.366, 'valid/diff': 4.252, 'valid/acc_skew': 52.456, 'valid/acc_align': 48.275, 'test/acc': 54.165, 'test/acc_unbiased': 51.389, 'test/diff': 1.925, 'test/acc_skew': 52.351, 'test/acc_align': 50.426}
[9 / 20] best valid accuracy: 56.728 at epoch 7 
 best_stats: {'best_valid_epoch': 7, 'best_valid_valid/acc': 60.891, 'best_valid_valid/acc_unbiased': 56.728, 'best_valid_valid/diff': 27.567, 'best_valid_valid/acc_skew': 42.944, 'best_valid_valid/acc_align': 70.511, 'best_valid_test/acc': 61.613, 'best_valid_test/acc_unbiased': 59.306, 'best_valid_test/diff': 29.129, 'best_valid_test/acc_skew': 44.742, 'best_valid_test/acc_align': 73.871}
[9 / 20] best test accuracy: 59.306 at epoch 7 
 best_stats: {'best_test_epoch': 7, 'best_test_valid/acc': 60.891, 'best_test_valid/acc_unbiased': 56.728, 'best_test_valid/diff': 27.567, 'best_test_valid/acc_skew': 42.944, 'best_test_valid/acc_align': 70.511, 'best_test_test/acc': 61.613, 'best_test_test/acc_unbiased': 59.306, 'best_test_test/diff': 29.129, 'best_test_test/acc_skew': 44.742, 'best_test_test/acc_align': 73.871}
[10 / 20] Learning rate: 0.0001 weight: 0.01
[10 / 20] Loss: 1.4474692610078121 CE Loss: 2.6528287123077288 Con Loss: 1.4209409854515356
[10 / 20] tensor([[0.790, 0.733],
        [0.265, 0.273]]) {'epoch': 10, 'valid/acc': 54.982, 'valid/acc_unbiased': 51.117, 'valid/diff': 5.668, 'valid/acc_skew': 50.541, 'valid/acc_align': 51.692, 'test/acc': 54.738, 'test/acc_unbiased': 51.52, 'test/diff': 3.216, 'test/acc_skew': 49.912, 'test/acc_align': 53.127}
[10 / 20] best valid accuracy: 56.728 at epoch 7 
 best_stats: {'best_valid_epoch': 7, 'best_valid_valid/acc': 60.891, 'best_valid_valid/acc_unbiased': 56.728, 'best_valid_valid/diff': 27.567, 'best_valid_valid/acc_skew': 42.944, 'best_valid_valid/acc_align': 70.511, 'best_valid_test/acc': 61.613, 'best_valid_test/acc_unbiased': 59.306, 'best_valid_test/diff': 29.129, 'best_valid_test/acc_skew': 44.742, 'best_valid_test/acc_align': 73.871}
[10 / 20] best test accuracy: 59.306 at epoch 7 
 best_stats: {'best_test_epoch': 7, 'best_test_valid/acc': 60.891, 'best_test_valid/acc_unbiased': 56.728, 'best_test_valid/diff': 27.567, 'best_test_valid/acc_skew': 42.944, 'best_test_valid/acc_align': 70.511, 'best_test_test/acc': 61.613, 'best_test_test/acc_unbiased': 59.306, 'best_test_test/diff': 29.129, 'best_test_test/acc_skew': 44.742, 'best_test_test/acc_align': 73.871}
[11 / 20] Learning rate: 0.0001 weight: 0.01
[11 / 20] Loss: 1.490616198683441 CE Loss: 2.6322090844064494 Con Loss: 1.4642941124799975
[11 / 20] tensor([[0.770, 0.659],
        [0.324, 0.315]]) {'epoch': 11, 'valid/acc': 57.451, 'valid/acc_unbiased': 52.903, 'valid/diff': 8.429, 'valid/acc_skew': 50.95, 'valid/acc_align': 54.856, 'test/acc': 55.796, 'test/acc_unbiased': 51.709, 'test/diff': 5.995, 'test/acc_skew': 49.16, 'test/acc_align': 54.259}
[11 / 20] best valid accuracy: 56.728 at epoch 7 
 best_stats: {'best_valid_epoch': 7, 'best_valid_valid/acc': 60.891, 'best_valid_valid/acc_unbiased': 56.728, 'best_valid_valid/diff': 27.567, 'best_valid_valid/acc_skew': 42.944, 'best_valid_valid/acc_align': 70.511, 'best_valid_test/acc': 61.613, 'best_valid_test/acc_unbiased': 59.306, 'best_valid_test/diff': 29.129, 'best_valid_test/acc_skew': 44.742, 'best_valid_test/acc_align': 73.871}
[11 / 20] best test accuracy: 59.306 at epoch 7 
 best_stats: {'best_test_epoch': 7, 'best_test_valid/acc': 60.891, 'best_test_valid/acc_unbiased': 56.728, 'best_test_valid/diff': 27.567, 'best_test_valid/acc_skew': 42.944, 'best_test_valid/acc_align': 70.511, 'best_test_test/acc': 61.613, 'best_test_test/acc_unbiased': 59.306, 'best_test_test/diff': 29.129, 'best_test_test/acc_skew': 44.742, 'best_test_test/acc_align': 73.871}
[12 / 20] Learning rate: 0.0001 weight: 0.01
[12 / 20] Loss: 1.4761909860968467 CE Loss: 2.684015686569261 Con Loss: 1.4493508443184346
[12 / 20] tensor([[0.659, 0.278],
        [0.705, 0.891]]) {'epoch': 12, 'valid/acc': 66.755, 'valid/acc_unbiased': 62.571, 'valid/diff': 26.812, 'valid/acc_skew': 49.165, 'valid/acc_align': 75.977, 'test/acc': 66.373, 'test/acc_unbiased': 63.321, 'test/diff': 28.329, 'test/acc_skew': 49.157, 'test/acc_align': 77.486}
[12 / 20] best valid accuracy: 62.571 at epoch 12 
 best_stats: {'best_valid_epoch': 12, 'best_valid_valid/acc': 66.755, 'best_valid_valid/acc_unbiased': 62.571, 'best_valid_valid/diff': 26.812, 'best_valid_valid/acc_skew': 49.165, 'best_valid_valid/acc_align': 75.977, 'best_valid_test/acc': 66.373, 'best_valid_test/acc_unbiased': 63.321, 'best_valid_test/diff': 28.329, 'best_valid_test/acc_skew': 49.157, 'best_valid_test/acc_align': 77.486}
[12 / 20] best test accuracy: 63.321 at epoch 12 
 best_stats: {'best_test_epoch': 12, 'best_test_valid/acc': 66.755, 'best_test_valid/acc_unbiased': 62.571, 'best_test_valid/diff': 26.812, 'best_test_valid/acc_skew': 49.165, 'best_test_valid/acc_align': 75.977, 'best_test_test/acc': 66.373, 'best_test_test/acc_unbiased': 63.321, 'best_test_test/diff': 28.329, 'best_test_test/acc_skew': 49.157, 'best_test_test/acc_align': 77.486}
[13 / 20] Learning rate: 0.0001 weight: 0.01
[13 / 20] Loss: 1.3423271609806373 CE Loss: 2.9328300446314723 Con Loss: 1.3129988628304046
[13 / 20] tensor([[0.957, 0.972],
        [0.030, 0.042]]) {'epoch': 13, 'valid/acc': 53.924, 'valid/acc_unbiased': 50.105, 'valid/diff': 1.846, 'valid/acc_skew': 49.182, 'valid/acc_align': 51.029, 'test/acc': 53.724, 'test/acc_unbiased': 50.016, 'test/diff': 1.369, 'test/acc_skew': 50.079, 'test/acc_align': 49.953}
[13 / 20] best valid accuracy: 62.571 at epoch 12 
 best_stats: {'best_valid_epoch': 12, 'best_valid_valid/acc': 66.755, 'best_valid_valid/acc_unbiased': 62.571, 'best_valid_valid/diff': 26.812, 'best_valid_valid/acc_skew': 49.165, 'best_valid_valid/acc_align': 75.977, 'best_valid_test/acc': 66.373, 'best_valid_test/acc_unbiased': 63.321, 'best_valid_test/diff': 28.329, 'best_valid_test/acc_skew': 49.157, 'best_valid_test/acc_align': 77.486}
[13 / 20] best test accuracy: 63.321 at epoch 12 
 best_stats: {'best_test_epoch': 12, 'best_test_valid/acc': 66.755, 'best_test_valid/acc_unbiased': 62.571, 'best_test_valid/diff': 26.812, 'best_test_valid/acc_skew': 49.165, 'best_test_valid/acc_align': 75.977, 'best_test_test/acc': 66.373, 'best_test_test/acc_unbiased': 63.321, 'best_test_test/diff': 28.329, 'best_test_test/acc_skew': 49.157, 'best_test_test/acc_align': 77.486}
[14 / 20] Learning rate: 1e-05 weight: 0.01
[14 / 20] Loss: 1.255851871165189 CE Loss: 2.6342729652865273 Con Loss: 1.2295091367066457
[14 / 20] tensor([[0.849, 0.801],
        [0.231, 0.218]]) {'epoch': 14, 'valid/acc': 56.526, 'valid/acc_unbiased': 51.693, 'valid/diff': 7.65, 'valid/acc_skew': 51.601, 'valid/acc_align': 51.785, 'test/acc': 56.324, 'test/acc_unbiased': 52.48, 'test/diff': 3.028, 'test/acc_skew': 51.591, 'test/acc_align': 53.369}
[14 / 20] best valid accuracy: 62.571 at epoch 12 
 best_stats: {'best_valid_epoch': 12, 'best_valid_valid/acc': 66.755, 'best_valid_valid/acc_unbiased': 62.571, 'best_valid_valid/diff': 26.812, 'best_valid_valid/acc_skew': 49.165, 'best_valid_valid/acc_align': 75.977, 'best_valid_test/acc': 66.373, 'best_valid_test/acc_unbiased': 63.321, 'best_valid_test/diff': 28.329, 'best_valid_test/acc_skew': 49.157, 'best_valid_test/acc_align': 77.486}
[14 / 20] best test accuracy: 63.321 at epoch 12 
 best_stats: {'best_test_epoch': 12, 'best_test_valid/acc': 66.755, 'best_test_valid/acc_unbiased': 62.571, 'best_test_valid/diff': 26.812, 'best_test_valid/acc_skew': 49.165, 'best_test_valid/acc_align': 75.977, 'best_test_test/acc': 66.373, 'best_test_test/acc_unbiased': 63.321, 'best_test_test/diff': 28.329, 'best_test_test/acc_skew': 49.157, 'best_test_test/acc_align': 77.486}
[15 / 20] Learning rate: 1e-05 weight: 0.01
[15 / 20] Loss: 1.5352820677327512 CE Loss: 2.6960722234209467 Con Loss: 1.5083213374615205
[15 / 20] tensor([[0.844, 0.767],
        [0.344, 0.261]]) {'epoch': 15, 'valid/acc': 59.7, 'valid/acc_unbiased': 53.673, 'valid/diff': 12.283, 'valid/acc_skew': 53.139, 'valid/acc_align': 54.206, 'test/acc': 60.467, 'test/acc_unbiased': 55.396, 'test/diff': 8.027, 'test/acc_skew': 55.538, 'test/acc_align': 55.255}
[15 / 20] best valid accuracy: 62.571 at epoch 12 
 best_stats: {'best_valid_epoch': 12, 'best_valid_valid/acc': 66.755, 'best_valid_valid/acc_unbiased': 62.571, 'best_valid_valid/diff': 26.812, 'best_valid_valid/acc_skew': 49.165, 'best_valid_valid/acc_align': 75.977, 'best_valid_test/acc': 66.373, 'best_valid_test/acc_unbiased': 63.321, 'best_valid_test/diff': 28.329, 'best_valid_test/acc_skew': 49.157, 'best_valid_test/acc_align': 77.486}
[15 / 20] best test accuracy: 63.321 at epoch 12 
 best_stats: {'best_test_epoch': 12, 'best_test_valid/acc': 66.755, 'best_test_valid/acc_unbiased': 62.571, 'best_test_valid/diff': 26.812, 'best_test_valid/acc_skew': 49.165, 'best_test_valid/acc_align': 75.977, 'best_test_test/acc': 66.373, 'best_test_test/acc_unbiased': 63.321, 'best_test_test/diff': 28.329, 'best_test_test/acc_skew': 49.157, 'best_test_test/acc_align': 77.486}
[16 / 20] Learning rate: 1e-05 weight: 0.01
[16 / 20] Loss: 1.2964316208341533 CE Loss: 2.5170148944639372 Con Loss: 1.2712614710779804
[16 / 20] tensor([[0.778, 0.665],
        [0.517, 0.400]]) {'epoch': 16, 'valid/acc': 62.963, 'valid/acc_unbiased': 56.936, 'valid/diff': 15.24, 'valid/acc_skew': 55.881, 'valid/acc_align': 57.991, 'test/acc': 64.169, 'test/acc_unbiased': 58.977, 'test/diff': 11.476, 'test/acc_skew': 59.075, 'test/acc_align': 58.878}
[16 / 20] best valid accuracy: 62.571 at epoch 12 
 best_stats: {'best_valid_epoch': 12, 'best_valid_valid/acc': 66.755, 'best_valid_valid/acc_unbiased': 62.571, 'best_valid_valid/diff': 26.812, 'best_valid_valid/acc_skew': 49.165, 'best_valid_valid/acc_align': 75.977, 'best_valid_test/acc': 66.373, 'best_valid_test/acc_unbiased': 63.321, 'best_valid_test/diff': 28.329, 'best_valid_test/acc_skew': 49.157, 'best_valid_test/acc_align': 77.486}
[16 / 20] best test accuracy: 63.321 at epoch 12 
 best_stats: {'best_test_epoch': 12, 'best_test_valid/acc': 66.755, 'best_test_valid/acc_unbiased': 62.571, 'best_test_valid/diff': 26.812, 'best_test_valid/acc_skew': 49.165, 'best_test_valid/acc_align': 75.977, 'best_test_test/acc': 66.373, 'best_test_test/acc_unbiased': 63.321, 'best_test_test/diff': 28.329, 'best_test_test/acc_skew': 49.157, 'best_test_test/acc_align': 77.486}
[17 / 20] Learning rate: 1e-05 weight: 0.01
[17 / 20] Loss: 1.2034928966195058 CE Loss: 2.4557503951547868 Con Loss: 1.1789354031836319
[17 / 20] tensor([[0.709, 0.511],
        [0.646, 0.636]]) {'epoch': 17, 'valid/acc': 64.771, 'valid/acc_unbiased': 59.157, 'valid/diff': 16.184, 'valid/acc_skew': 55.159, 'valid/acc_align': 63.155, 'test/acc': 66.417, 'test/acc_unbiased': 62.56, 'test/diff': 10.347, 'test/acc_skew': 57.863, 'test/acc_align': 67.256}
[17 / 20] best valid accuracy: 62.571 at epoch 12 
 best_stats: {'best_valid_epoch': 12, 'best_valid_valid/acc': 66.755, 'best_valid_valid/acc_unbiased': 62.571, 'best_valid_valid/diff': 26.812, 'best_valid_valid/acc_skew': 49.165, 'best_valid_valid/acc_align': 75.977, 'best_valid_test/acc': 66.373, 'best_valid_test/acc_unbiased': 63.321, 'best_valid_test/diff': 28.329, 'best_valid_test/acc_skew': 49.157, 'best_valid_test/acc_align': 77.486}
[17 / 20] best test accuracy: 63.321 at epoch 12 
 best_stats: {'best_test_epoch': 12, 'best_test_valid/acc': 66.755, 'best_test_valid/acc_unbiased': 62.571, 'best_test_valid/diff': 26.812, 'best_test_valid/acc_skew': 49.165, 'best_test_valid/acc_align': 75.977, 'best_test_test/acc': 66.373, 'best_test_test/acc_unbiased': 63.321, 'best_test_test/diff': 28.329, 'best_test_test/acc_skew': 49.157, 'best_test_test/acc_align': 77.486}
[18 / 20] Learning rate: 1e-05 weight: 0.01
[18 / 20] Loss: 1.4715000606126498 CE Loss: 2.5221145857386316 Con Loss: 1.4462789153935263
[18 / 20] tensor([[0.765, 0.557],
        [0.543, 0.539]]) {'epoch': 18, 'valid/acc': 63.624, 'valid/acc_unbiased': 57.71, 'valid/diff': 15.622, 'valid/acc_skew': 53.346, 'valid/acc_align': 62.073, 'test/acc': 64.786, 'test/acc_unbiased': 60.12, 'test/diff': 10.618, 'test/acc_skew': 55.004, 'test/acc_align': 65.235}
[18 / 20] best valid accuracy: 62.571 at epoch 12 
 best_stats: {'best_valid_epoch': 12, 'best_valid_valid/acc': 66.755, 'best_valid_valid/acc_unbiased': 62.571, 'best_valid_valid/diff': 26.812, 'best_valid_valid/acc_skew': 49.165, 'best_valid_valid/acc_align': 75.977, 'best_valid_test/acc': 66.373, 'best_valid_test/acc_unbiased': 63.321, 'best_valid_test/diff': 28.329, 'best_valid_test/acc_skew': 49.157, 'best_valid_test/acc_align': 77.486}
[18 / 20] best test accuracy: 63.321 at epoch 12 
 best_stats: {'best_test_epoch': 12, 'best_test_valid/acc': 66.755, 'best_test_valid/acc_unbiased': 62.571, 'best_test_valid/diff': 26.812, 'best_test_valid/acc_skew': 49.165, 'best_test_valid/acc_align': 75.977, 'best_test_test/acc': 66.373, 'best_test_test/acc_unbiased': 63.321, 'best_test_test/diff': 28.329, 'best_test_test/acc_skew': 49.157, 'best_test_test/acc_align': 77.486}
[19 / 20] Learning rate: 1e-05 weight: 0.01
[19 / 20] Loss: 1.3449784702550849 CE Loss: 2.5511596797061293 Con Loss: 1.3194668763375483
[19 / 20] tensor([[0.763, 0.489],
        [0.597, 0.612]]) {'epoch': 19, 'valid/acc': 65.52, 'valid/acc_unbiased': 59.706, 'valid/diff': 15.814, 'valid/acc_skew': 53.179, 'valid/acc_align': 66.232, 'test/acc': 66.77, 'test/acc_unbiased': 61.541, 'test/diff': 14.473, 'test/acc_skew': 54.305, 'test/acc_align': 68.778}
[19 / 20] best valid accuracy: 62.571 at epoch 12 
 best_stats: {'best_valid_epoch': 12, 'best_valid_valid/acc': 66.755, 'best_valid_valid/acc_unbiased': 62.571, 'best_valid_valid/diff': 26.812, 'best_valid_valid/acc_skew': 49.165, 'best_valid_valid/acc_align': 75.977, 'best_valid_test/acc': 66.373, 'best_valid_test/acc_unbiased': 63.321, 'best_valid_test/diff': 28.329, 'best_valid_test/acc_skew': 49.157, 'best_valid_test/acc_align': 77.486}
[19 / 20] best test accuracy: 63.321 at epoch 12 
 best_stats: {'best_test_epoch': 12, 'best_test_valid/acc': 66.755, 'best_test_valid/acc_unbiased': 62.571, 'best_test_valid/diff': 26.812, 'best_test_valid/acc_skew': 49.165, 'best_test_valid/acc_align': 75.977, 'best_test_test/acc': 66.373, 'best_test_test/acc_unbiased': 63.321, 'best_test_test/diff': 28.329, 'best_test_test/acc_skew': 49.157, 'best_test_test/acc_align': 77.486}
[20 / 20] Learning rate: 1e-05 weight: 0.01
[20 / 20] Loss: 1.4284389821490917 CE Loss: 2.4960479137589617 Con Loss: 1.403478500682014
[20 / 20] tensor([[0.741, 0.500],
        [0.607, 0.618]]) {'epoch': 20, 'valid/acc': 64.55, 'valid/acc_unbiased': 59.006, 'valid/diff': 15.423, 'valid/acc_skew': 53.339, 'valid/acc_align': 64.674, 'test/acc': 66.197, 'test/acc_unbiased': 61.642, 'test/diff': 12.615, 'test/acc_skew': 55.334, 'test/acc_align': 67.95}
[20 / 20] best valid accuracy: 62.571 at epoch 12 
 best_stats: {'best_valid_epoch': 12, 'best_valid_valid/acc': 66.755, 'best_valid_valid/acc_unbiased': 62.571, 'best_valid_valid/diff': 26.812, 'best_valid_valid/acc_skew': 49.165, 'best_valid_valid/acc_align': 75.977, 'best_valid_test/acc': 66.373, 'best_valid_test/acc_unbiased': 63.321, 'best_valid_test/diff': 28.329, 'best_valid_test/acc_skew': 49.157, 'best_valid_test/acc_align': 77.486}
[20 / 20] best test accuracy: 63.321 at epoch 12 
 best_stats: {'best_test_epoch': 12, 'best_test_valid/acc': 66.755, 'best_test_valid/acc_unbiased': 62.571, 'best_test_valid/diff': 26.812, 'best_test_valid/acc_skew': 49.165, 'best_test_valid/acc_align': 75.977, 'best_test_test/acc': 66.373, 'best_test_test/acc_unbiased': 63.321, 'best_test_test/diff': 28.329, 'best_test_test/acc_skew': 49.157, 'best_test_test/acc_align': 77.486}
Total training time: 0:22:54
