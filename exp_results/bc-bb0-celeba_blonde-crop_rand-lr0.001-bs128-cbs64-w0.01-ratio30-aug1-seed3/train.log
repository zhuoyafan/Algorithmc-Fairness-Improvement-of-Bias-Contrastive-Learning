Log level set to: INFO
Set seed: 3
=======> Using Fixed Random Seed: 3 <========
save_path: exp_results/bc-bb0-celeba_blonde-crop_rand-lr0.001-bs128-cbs64-w0.01-ratio30-aug1-seed3
get_celeba - split:train, aug: False, given_y: True, ratio: 0
use existing blonde indices from data/celeba/pickles/blonde
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [1628, 53486]
Target 1: [18293, 1105]
Binary Target 1
---------------------------
Target 0: [1628, 53486]
Target 1: [18293, 1105]
===================================
Normal Label Distribution: 
Target 0: [1628, 53486]
Target 1: [18293, 1105]
===================================
Use BiasedCelebASplit 
 target_attr: blonde split: train 
 tensor([[ 1628., 18293.],
        [53486.,  1105.]])
get_celeba - split:train, aug: 1, given_y: True, ratio: 30
use existing blonde indices from data/celeba/pickles/blonde
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [1599, 53508]
Target 1: [18327, 1078]
Binary Target 1
---------------------------
Target 0: [1599, 53508]
Target 1: [18327, 1078]
===================================
Normal Label Distribution: 
Target 0: [1599, 53508]
Target 1: [18327, 1078]
===================================
Use BiasedCelebASplit 
 target_attr: blonde split: train 
 tensor([[ 1599., 18327.],
        [53508.,  1078.]])
get_celeba - split:train_valid, aug: False, given_y: True, ratio: 0
use existing blonde indices from data/celeba/pickles/blonde
Use BiasedCelebASplit 
 target_attr: blonde split: train_valid 
 tensor([[  386.,  4517.],
        [13446.,   280.]])
get_celeba - split:valid, aug: False, given_y: True, ratio: 0
Use BiasedCelebASplit 
 target_attr: blonde split: valid 
 tensor([[8535., 2874.],
        [8276.,  182.]])
decay_epochs: [3, 6]
[1 / 10] Learning rate: 0.001 weight: 0.01
[1 / 10] Loss: 4.715661433369196 CE Loss: 0.21049151747270103 Con Loss: 4.713556512271945
[1 / 10] tensor([[0.817, 0.902],
        [0.964, 0.918]]) {'epoch': 1, 'valid/acc': 91.041, 'valid/acc_unbiased': 91.231, 'valid/diff': 3.147, 'valid/acc_skew': 89.658, 'valid/acc_align': 92.804, 'test/acc': 87.447, 'test/acc_unbiased': 90.004, 'test/diff': 6.586, 'test/acc_skew': 86.711, 'test/acc_align': 93.297}
[1 / 10] best valid accuracy: 91.231 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 91.041, 'best_valid_valid/acc_unbiased': 91.231, 'best_valid_valid/diff': 3.147, 'best_valid_valid/acc_skew': 89.658, 'best_valid_valid/acc_align': 92.804, 'best_valid_test/acc': 87.447, 'best_valid_test/acc_unbiased': 90.004, 'best_valid_test/diff': 6.586, 'best_valid_test/acc_skew': 86.711, 'best_valid_test/acc_align': 93.297}
[1 / 10] best test accuracy: 90.004 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 91.041, 'best_test_valid/acc_unbiased': 91.231, 'best_test_valid/diff': 3.147, 'best_test_valid/acc_skew': 89.658, 'best_test_valid/acc_align': 92.804, 'best_test_test/acc': 87.447, 'best_test_test/acc_unbiased': 90.004, 'best_test_test/diff': 6.586, 'best_test_test/acc_skew': 86.711, 'best_test_test/acc_align': 93.297}
[2 / 10] Learning rate: 0.001 weight: 0.01
[2 / 10] Loss: 4.67428904120339 CE Loss: 0.17753790613661413 Con Loss: 4.672513654105572
[2 / 10] tensor([[0.940, 0.982],
        [0.844, 0.637]]) {'epoch': 2, 'valid/acc': 93.795, 'valid/acc_unbiased': 85.323, 'valid/diff': 10.835, 'valid/acc_skew': 79.906, 'valid/acc_align': 90.741, 'test/acc': 94.096, 'test/acc_unbiased': 85.087, 'test/diff': 12.39, 'test/acc_skew': 78.892, 'test/acc_align': 91.282}
[2 / 10] best valid accuracy: 91.231 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 91.041, 'best_valid_valid/acc_unbiased': 91.231, 'best_valid_valid/diff': 3.147, 'best_valid_valid/acc_skew': 89.658, 'best_valid_valid/acc_align': 92.804, 'best_valid_test/acc': 87.447, 'best_valid_test/acc_unbiased': 90.004, 'best_valid_test/diff': 6.586, 'best_valid_test/acc_skew': 86.711, 'best_valid_test/acc_align': 93.297}
[2 / 10] best test accuracy: 90.004 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 91.041, 'best_test_valid/acc_unbiased': 91.231, 'best_test_valid/diff': 3.147, 'best_test_valid/acc_skew': 89.658, 'best_test_valid/acc_align': 92.804, 'best_test_test/acc': 87.447, 'best_test_test/acc_unbiased': 90.004, 'best_test_test/diff': 6.586, 'best_test_test/acc_skew': 86.711, 'best_test_test/acc_align': 93.297}
[3 / 10] Learning rate: 0.001 weight: 0.01
[3 / 10] Loss: 4.657221774571644 CE Loss: 0.1741965780087057 Con Loss: 4.655479796382781
[3 / 10] tensor([[0.950, 0.986],
        [0.841, 0.588]]) {'epoch': 3, 'valid/acc': 94.16, 'valid/acc_unbiased': 87.388, 'valid/diff': 6.849, 'valid/acc_skew': 83.964, 'valid/acc_align': 90.813, 'test/acc': 94.609, 'test/acc_unbiased': 84.139, 'test/diff': 14.49, 'test/acc_skew': 76.894, 'test/acc_align': 91.384}
[3 / 10] best valid accuracy: 91.231 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 91.041, 'best_valid_valid/acc_unbiased': 91.231, 'best_valid_valid/diff': 3.147, 'best_valid_valid/acc_skew': 89.658, 'best_valid_valid/acc_align': 92.804, 'best_valid_test/acc': 87.447, 'best_valid_test/acc_unbiased': 90.004, 'best_valid_test/diff': 6.586, 'best_valid_test/acc_skew': 86.711, 'best_valid_test/acc_align': 93.297}
[3 / 10] best test accuracy: 90.004 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 91.041, 'best_test_valid/acc_unbiased': 91.231, 'best_test_valid/diff': 3.147, 'best_test_valid/acc_skew': 89.658, 'best_test_valid/acc_align': 92.804, 'best_test_test/acc': 87.447, 'best_test_test/acc_unbiased': 90.004, 'best_test_test/diff': 6.586, 'best_test_test/acc_skew': 86.711, 'best_test_test/acc_align': 93.297}
[4 / 10] Learning rate: 0.0001 weight: 0.01
[4 / 10] Loss: 4.607725275005679 CE Loss: 0.14821572002565014 Con Loss: 4.606243113885756
[4 / 10] tensor([[0.919, 0.975],
        [0.910, 0.791]]) {'epoch': 4, 'valid/acc': 95.314, 'valid/acc_unbiased': 91.584, 'valid/diff': 5.956, 'valid/acc_skew': 89.013, 'valid/acc_align': 94.154, 'test/acc': 93.985, 'test/acc_unbiased': 89.884, 'test/diff': 8.731, 'test/acc_skew': 85.518, 'test/acc_align': 94.249}
[4 / 10] best valid accuracy: 91.584 at epoch 4 
 best_stats: {'best_valid_epoch': 4, 'best_valid_valid/acc': 95.314, 'best_valid_valid/acc_unbiased': 91.584, 'best_valid_valid/diff': 5.956, 'best_valid_valid/acc_skew': 89.013, 'best_valid_valid/acc_align': 94.154, 'best_valid_test/acc': 93.985, 'best_valid_test/acc_unbiased': 89.884, 'best_valid_test/diff': 8.731, 'best_valid_test/acc_skew': 85.518, 'best_valid_test/acc_align': 94.249}
[4 / 10] best test accuracy: 90.004 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 91.041, 'best_test_valid/acc_unbiased': 91.231, 'best_test_valid/diff': 3.147, 'best_test_valid/acc_skew': 89.658, 'best_test_valid/acc_align': 92.804, 'best_test_test/acc': 87.447, 'best_test_test/acc_unbiased': 90.004, 'best_test_test/diff': 6.586, 'best_test_test/acc_skew': 86.711, 'best_test_test/acc_align': 93.297}
[5 / 10] Learning rate: 0.0001 weight: 0.01
[5 / 10] Loss: 4.584126013247322 CE Loss: 0.140375484554635 Con Loss: 4.582722260661716
[5 / 10] tensor([[0.909, 0.975],
        [0.914, 0.775]]) {'epoch': 5, 'valid/acc': 95.437, 'valid/acc_unbiased': 91.674, 'valid/diff': 6.181, 'valid/acc_skew': 88.883, 'valid/acc_align': 94.464, 'test/acc': 93.597, 'test/acc_unbiased': 89.324, 'test/diff': 10.315, 'test/acc_skew': 84.167, 'test/acc_align': 94.482}
[5 / 10] best valid accuracy: 91.674 at epoch 5 
 best_stats: {'best_valid_epoch': 5, 'best_valid_valid/acc': 95.437, 'best_valid_valid/acc_unbiased': 91.674, 'best_valid_valid/diff': 6.181, 'best_valid_valid/acc_skew': 88.883, 'best_valid_valid/acc_align': 94.464, 'best_valid_test/acc': 93.597, 'best_valid_test/acc_unbiased': 89.324, 'best_valid_test/diff': 10.315, 'best_valid_test/acc_skew': 84.167, 'best_valid_test/acc_align': 94.482}
[5 / 10] best test accuracy: 90.004 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 91.041, 'best_test_valid/acc_unbiased': 91.231, 'best_test_valid/diff': 3.147, 'best_test_valid/acc_skew': 89.658, 'best_test_valid/acc_align': 92.804, 'best_test_test/acc': 87.447, 'best_test_test/acc_unbiased': 90.004, 'best_test_test/diff': 6.586, 'best_test_test/acc_skew': 86.711, 'best_test_test/acc_align': 93.297}
[6 / 10] Learning rate: 0.0001 weight: 0.01
[6 / 10] Loss: 4.573139063094034 CE Loss: 0.13795529172506 Con Loss: 4.571759510736546
[6 / 10] tensor([[0.921, 0.975],
        [0.906, 0.786]]) {'epoch': 6, 'valid/acc': 95.319, 'valid/acc_unbiased': 91.681, 'valid/diff': 5.571, 'valid/acc_skew': 89.45, 'valid/acc_align': 93.912, 'test/acc': 94.01, 'test/acc_unbiased': 89.695, 'test/diff': 8.751, 'test/acc_skew': 85.32, 'test/acc_align': 94.07}
[6 / 10] best valid accuracy: 91.681 at epoch 6 
 best_stats: {'best_valid_epoch': 6, 'best_valid_valid/acc': 95.319, 'best_valid_valid/acc_unbiased': 91.681, 'best_valid_valid/diff': 5.571, 'best_valid_valid/acc_skew': 89.45, 'best_valid_valid/acc_align': 93.912, 'best_valid_test/acc': 94.01, 'best_valid_test/acc_unbiased': 89.695, 'best_valid_test/diff': 8.751, 'best_valid_test/acc_skew': 85.32, 'best_valid_test/acc_align': 94.07}
[6 / 10] best test accuracy: 90.004 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 91.041, 'best_test_valid/acc_unbiased': 91.231, 'best_test_valid/diff': 3.147, 'best_test_valid/acc_skew': 89.658, 'best_test_valid/acc_align': 92.804, 'best_test_test/acc': 87.447, 'best_test_test/acc_unbiased': 90.004, 'best_test_test/diff': 6.586, 'best_test_test/acc_skew': 86.711, 'best_test_test/acc_align': 93.297}
[7 / 10] Learning rate: 1e-05 weight: 0.01
[7 / 10] Loss: 4.564985249773074 CE Loss: 0.1309141950977381 Con Loss: 4.563676112656023
[7 / 10] tensor([[0.914, 0.974],
        [0.916, 0.786]]) {'epoch': 7, 'valid/acc': 95.582, 'valid/acc_unbiased': 92.952, 'valid/diff': 4.631, 'valid/acc_skew': 91.495, 'valid/acc_align': 94.409, 'test/acc': 93.819, 'test/acc_unbiased': 89.75, 'test/diff': 9.552, 'test/acc_skew': 84.974, 'test/acc_align': 94.526}
[7 / 10] best valid accuracy: 92.952 at epoch 7 
 best_stats: {'best_valid_epoch': 7, 'best_valid_valid/acc': 95.582, 'best_valid_valid/acc_unbiased': 92.952, 'best_valid_valid/diff': 4.631, 'best_valid_valid/acc_skew': 91.495, 'best_valid_valid/acc_align': 94.409, 'best_valid_test/acc': 93.819, 'best_valid_test/acc_unbiased': 89.75, 'best_valid_test/diff': 9.552, 'best_valid_test/acc_skew': 84.974, 'best_valid_test/acc_align': 94.526}
[7 / 10] best test accuracy: 90.004 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 91.041, 'best_test_valid/acc_unbiased': 91.231, 'best_test_valid/diff': 3.147, 'best_test_valid/acc_skew': 89.658, 'best_test_valid/acc_align': 92.804, 'best_test_test/acc': 87.447, 'best_test_test/acc_unbiased': 90.004, 'best_test_test/diff': 6.586, 'best_test_test/acc_skew': 86.711, 'best_test_test/acc_align': 93.297}
[8 / 10] Learning rate: 1e-05 weight: 0.01
[8 / 10] Loss: 4.563395371579397 CE Loss: 0.12996059775893232 Con Loss: 4.562095758406573
[8 / 10] tensor([[0.923, 0.979],
        [0.908, 0.764]]) {'epoch': 8, 'valid/acc': 95.577, 'valid/acc_unbiased': 92.554, 'valid/diff': 4.906, 'valid/acc_skew': 91.04, 'valid/acc_align': 94.068, 'test/acc': 94.262, 'test/acc_unbiased': 89.347, 'test/diff': 10.053, 'test/acc_skew': 84.32, 'test/acc_align': 94.373}
[8 / 10] best valid accuracy: 92.952 at epoch 7 
 best_stats: {'best_valid_epoch': 7, 'best_valid_valid/acc': 95.582, 'best_valid_valid/acc_unbiased': 92.952, 'best_valid_valid/diff': 4.631, 'best_valid_valid/acc_skew': 91.495, 'best_valid_valid/acc_align': 94.409, 'best_valid_test/acc': 93.819, 'best_valid_test/acc_unbiased': 89.75, 'best_valid_test/diff': 9.552, 'best_valid_test/acc_skew': 84.974, 'best_valid_test/acc_align': 94.526}
[8 / 10] best test accuracy: 90.004 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 91.041, 'best_test_valid/acc_unbiased': 91.231, 'best_test_valid/diff': 3.147, 'best_test_valid/acc_skew': 89.658, 'best_test_valid/acc_align': 92.804, 'best_test_test/acc': 87.447, 'best_test_test/acc_unbiased': 90.004, 'best_test_test/diff': 6.586, 'best_test_test/acc_skew': 86.711, 'best_test_test/acc_align': 93.297}
[9 / 10] Learning rate: 1e-05 weight: 0.01
[9 / 10] Loss: 4.555350016748954 CE Loss: 0.1286981022547365 Con Loss: 4.554063024146121
[9 / 10] tensor([[0.914, 0.976],
        [0.919, 0.797]]) {'epoch': 9, 'valid/acc': 95.652, 'valid/acc_unbiased': 93.287, 'valid/diff': 4.25, 'valid/acc_skew': 92.031, 'valid/acc_align': 94.542, 'test/acc': 93.94, 'test/acc_unbiased': 90.137, 'test/diff': 9.191, 'test/acc_skew': 85.541, 'test/acc_align': 94.732}
[9 / 10] best valid accuracy: 93.287 at epoch 9 
 best_stats: {'best_valid_epoch': 9, 'best_valid_valid/acc': 95.652, 'best_valid_valid/acc_unbiased': 93.287, 'best_valid_valid/diff': 4.25, 'best_valid_valid/acc_skew': 92.031, 'best_valid_valid/acc_align': 94.542, 'best_valid_test/acc': 93.94, 'best_valid_test/acc_unbiased': 90.137, 'best_valid_test/diff': 9.191, 'best_valid_test/acc_skew': 85.541, 'best_valid_test/acc_align': 94.732}
[9 / 10] best test accuracy: 90.137 at epoch 9 
 best_stats: {'best_test_epoch': 9, 'best_test_valid/acc': 95.652, 'best_test_valid/acc_unbiased': 93.287, 'best_test_valid/diff': 4.25, 'best_test_valid/acc_skew': 92.031, 'best_test_valid/acc_align': 94.542, 'best_test_test/acc': 93.94, 'best_test_test/acc_unbiased': 90.137, 'best_test_test/diff': 9.191, 'best_test_test/acc_skew': 85.541, 'best_test_test/acc_align': 94.732}
[10 / 10] Learning rate: 1e-05 weight: 0.01
[10 / 10] Loss: 4.552174796918853 CE Loss: 0.12762271874780842 Con Loss: 4.550898566070943
[10 / 10] tensor([[0.916, 0.976],
        [0.916, 0.780]]) {'epoch': 10, 'valid/acc': 95.625, 'valid/acc_unbiased': 93.36, 'valid/diff': 3.549, 'valid/acc_skew': 92.388, 'valid/acc_align': 94.332, 'test/acc': 93.955, 'test/acc_unbiased': 89.696, 'test/diff': 9.806, 'test/acc_skew': 84.793, 'test/acc_align': 94.599}
[10 / 10] best valid accuracy: 93.360 at epoch 10 
 best_stats: {'best_valid_epoch': 10, 'best_valid_valid/acc': 95.625, 'best_valid_valid/acc_unbiased': 93.36, 'best_valid_valid/diff': 3.549, 'best_valid_valid/acc_skew': 92.388, 'best_valid_valid/acc_align': 94.332, 'best_valid_test/acc': 93.955, 'best_valid_test/acc_unbiased': 89.696, 'best_valid_test/diff': 9.806, 'best_valid_test/acc_skew': 84.793, 'best_valid_test/acc_align': 94.599}
[10 / 10] best test accuracy: 90.137 at epoch 9 
 best_stats: {'best_test_epoch': 9, 'best_test_valid/acc': 95.652, 'best_test_valid/acc_unbiased': 93.287, 'best_test_valid/diff': 4.25, 'best_test_valid/acc_skew': 92.031, 'best_test_valid/acc_align': 94.542, 'best_test_test/acc': 93.94, 'best_test_test/acc_unbiased': 90.137, 'best_test_test/diff': 9.191, 'best_test_test/acc_skew': 85.541, 'best_test_test/acc_align': 94.732}
Total training time: 1:20:10
