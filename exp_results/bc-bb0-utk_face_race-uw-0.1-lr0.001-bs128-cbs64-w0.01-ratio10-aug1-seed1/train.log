Log level set to: INFO
Set seed: 1
=======> Using Fixed Random Seed: 1 <========
save_path: exp_results/bc-bb0-utk_face_race-uw-0.1-lr0.001-bs128-cbs64-w0.01-ratio10-aug1-seed1
get_utk_face - split: train, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_race-0.1
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [4407, 4976]
Target 1: [3755, 5529]
Binary Target 1
---------------------------
Target 0: [4407, 4976]
Target 1: [3755, 5529]
===================================
Normal Label Distribution: 
Target 0: [4407, 4976]
Target 1: [3755, 5529]
===================================
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [4407, 4976]
Target 1: [3755, 5529]
Binary Target 1
---------------------------
Target 0: [4407, 4976]
Target 1: [3755, 5529]
===================================
Normal Label Distribution: 
Target 0: [4407, 4976]
Target 1: [3755, 5529]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 18667, target_attr: gender, bias_attr: race bias_rate: 0.1
['[train] target_0-bias_0: 4407', '[train] target_0-bias_1: 4976', '[train] target_1-bias_0: 3755', '[train] target_1-bias_1: 5529']
confusion_matrix - 
 original: tensor([[4407., 3755.],
        [4976., 5529.]]), 
 normalized: tensor([[0.540, 0.460],
        [0.474, 0.526]]), 
 b|y: tensor([[0.470, 0.530],
        [0.404, 0.596]])
get_utk_face - split: train, aug: 1, given_y: True, ratio: 10
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_race-0.1
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [4407, 4976]
Target 1: [3755, 5529]
Binary Target 1
---------------------------
Target 0: [4407, 4976]
Target 1: [3755, 5529]
===================================
Normal Label Distribution: 
Target 0: [4407, 4976]
Target 1: [3755, 5529]
===================================
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [4407, 4976]
Target 1: [3755, 5529]
Binary Target 1
---------------------------
Target 0: [4407, 4976]
Target 1: [3755, 5529]
===================================
Normal Label Distribution: 
Target 0: [4407, 4976]
Target 1: [3755, 5529]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 18667, target_attr: gender, bias_attr: race bias_rate: 0.1
['[train] target_0-bias_0: 4407', '[train] target_0-bias_1: 4976', '[train] target_1-bias_0: 3755', '[train] target_1-bias_1: 5529']
get_utk_face - split: valid, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_race-0.1
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [583, 684]
Target 1: [457, 646]
Binary Target 1
---------------------------
Target 0: [583, 684]
Target 1: [457, 646]
===================================
Normal Label Distribution: 
Target 0: [583, 684]
Target 1: [457, 646]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 2370, target_attr: gender, bias_attr: race bias_rate: 0.1
['[valid] target_0-bias_0: 583', '[valid] target_0-bias_1: 684', '[valid] target_1-bias_0: 457', '[valid] target_1-bias_1: 646']
get_utk_face - split: test, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_race-0.1
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [558, 677]
Target 1: [462, 673]
Binary Target 1
---------------------------
Target 0: [558, 677]
Target 1: [462, 673]
===================================
Normal Label Distribution: 
Target 0: [558, 677]
Target 1: [462, 673]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 2370, target_attr: gender, bias_attr: race bias_rate: 0.1
['[test] target_0-bias_0: 558', '[test] target_0-bias_1: 677', '[test] target_1-bias_0: 462', '[test] target_1-bias_1: 673']
decay_epochs: [6, 13]
[1 / 20] Learning rate: 0.001 weight: 0.01
[1 / 20] Loss: 4.85534133117724 CE Loss: 2.068300357582471 Con Loss: 4.8346583315867235
[1 / 20] tensor([[0.891, 0.863],
        [0.736, 0.743]]) {'epoch': 1, 'valid/acc': 81.35, 'valid/acc_unbiased': 80.938, 'valid/diff': 2.604, 'valid/acc_skew': 82.24, 'valid/acc_align': 79.635, 'test/acc': 81.055, 'test/acc_unbiased': 80.805, 'test/diff': 1.753, 'test/acc_skew': 81.331, 'test/acc_align': 80.279}
[1 / 20] best valid accuracy: 80.938 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 81.35, 'best_valid_valid/acc_unbiased': 80.938, 'best_valid_valid/diff': 2.604, 'best_valid_valid/acc_skew': 82.24, 'best_valid_valid/acc_align': 79.635, 'best_valid_test/acc': 81.055, 'best_valid_test/acc_unbiased': 80.805, 'best_valid_test/diff': 1.753, 'best_valid_test/acc_skew': 81.331, 'best_valid_test/acc_align': 80.279}
[1 / 20] best test accuracy: 80.805 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 81.35, 'best_test_valid/acc_unbiased': 80.938, 'best_test_valid/diff': 2.604, 'best_test_valid/acc_skew': 82.24, 'best_test_valid/acc_align': 79.635, 'best_test_test/acc': 81.055, 'best_test_test/acc_unbiased': 80.805, 'best_test_test/diff': 1.753, 'best_test_test/acc_skew': 81.331, 'best_test_test/acc_align': 80.279}
[2 / 20] Learning rate: 0.001 weight: 0.01
[2 / 20] Loss: 4.75192255515805 CE Loss: 1.715020001799917 Con Loss: 4.734772345795848
[2 / 20] tensor([[0.767, 0.762],
        [0.887, 0.903]]) {'epoch': 2, 'valid/acc': 83.207, 'valid/acc_unbiased': 83.815, 'valid/diff': 3.844, 'valid/acc_skew': 85.737, 'valid/acc_align': 81.893, 'test/acc': 82.785, 'test/acc_unbiased': 83.002, 'test/diff': 1.041, 'test/acc_skew': 82.724, 'test/acc_align': 83.28}
[2 / 20] best valid accuracy: 83.815 at epoch 2 
 best_stats: {'best_valid_epoch': 2, 'best_valid_valid/acc': 83.207, 'best_valid_valid/acc_unbiased': 83.815, 'best_valid_valid/diff': 3.844, 'best_valid_valid/acc_skew': 85.737, 'best_valid_valid/acc_align': 81.893, 'best_valid_test/acc': 82.785, 'best_valid_test/acc_unbiased': 83.002, 'best_valid_test/diff': 1.041, 'best_valid_test/acc_skew': 82.724, 'best_valid_test/acc_align': 83.28}
[2 / 20] best test accuracy: 83.002 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 83.207, 'best_test_valid/acc_unbiased': 83.815, 'best_test_valid/diff': 3.844, 'best_test_valid/acc_skew': 85.737, 'best_test_valid/acc_align': 81.893, 'best_test_test/acc': 82.785, 'best_test_test/acc_unbiased': 83.002, 'best_test_test/diff': 1.041, 'best_test_test/acc_skew': 82.724, 'best_test_test/acc_align': 83.28}
[3 / 20] Learning rate: 0.001 weight: 0.01
[3 / 20] Loss: 4.733654300318588 CE Loss: 1.6442976585765117 Con Loss: 4.717211349894176
[3 / 20] tensor([[0.638, 0.641],
        [0.948, 0.923]]) {'epoch': 3, 'valid/acc': 78.186, 'valid/acc_unbiased': 79.338, 'valid/diff': 2.37, 'valid/acc_skew': 80.254, 'valid/acc_align': 78.423, 'test/acc': 78.017, 'test/acc_unbiased': 78.746, 'test/diff': 1.419, 'test/acc_skew': 79.302, 'test/acc_align': 78.19}
[3 / 20] best valid accuracy: 83.815 at epoch 2 
 best_stats: {'best_valid_epoch': 2, 'best_valid_valid/acc': 83.207, 'best_valid_valid/acc_unbiased': 83.815, 'best_valid_valid/diff': 3.844, 'best_valid_valid/acc_skew': 85.737, 'best_valid_valid/acc_align': 81.893, 'best_valid_test/acc': 82.785, 'best_valid_test/acc_unbiased': 83.002, 'best_valid_test/diff': 1.041, 'best_valid_test/acc_skew': 82.724, 'best_valid_test/acc_align': 83.28}
[3 / 20] best test accuracy: 83.002 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 83.207, 'best_test_valid/acc_unbiased': 83.815, 'best_test_valid/diff': 3.844, 'best_test_valid/acc_skew': 85.737, 'best_test_valid/acc_align': 81.893, 'best_test_test/acc': 82.785, 'best_test_test/acc_unbiased': 83.002, 'best_test_test/diff': 1.041, 'best_test_test/acc_skew': 82.724, 'best_test_test/acc_align': 83.28}
[4 / 20] Learning rate: 0.001 weight: 0.01
[4 / 20] Loss: 4.717556415976176 CE Loss: 1.5708361599194625 Con Loss: 4.701848063706751
[4 / 20] tensor([[0.839, 0.823],
        [0.866, 0.889]]) {'epoch': 4, 'valid/acc': 84.473, 'valid/acc_unbiased': 84.99, 'valid/diff': 3.304, 'valid/acc_skew': 86.642, 'valid/acc_align': 83.338, 'test/acc': 85.359, 'test/acc_unbiased': 85.395, 'test/diff': 1.936, 'test/acc_skew': 85.226, 'test/acc_align': 85.565}
[4 / 20] best valid accuracy: 84.990 at epoch 4 
 best_stats: {'best_valid_epoch': 4, 'best_valid_valid/acc': 84.473, 'best_valid_valid/acc_unbiased': 84.99, 'best_valid_valid/diff': 3.304, 'best_valid_valid/acc_skew': 86.642, 'best_valid_valid/acc_align': 83.338, 'best_valid_test/acc': 85.359, 'best_valid_test/acc_unbiased': 85.395, 'best_valid_test/diff': 1.936, 'best_valid_test/acc_skew': 85.226, 'best_valid_test/acc_align': 85.565}
[4 / 20] best test accuracy: 85.395 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 84.473, 'best_test_valid/acc_unbiased': 84.99, 'best_test_valid/diff': 3.304, 'best_test_valid/acc_skew': 86.642, 'best_test_valid/acc_align': 83.338, 'best_test_test/acc': 85.359, 'best_test_test/acc_unbiased': 85.395, 'best_test_test/diff': 1.936, 'best_test_test/acc_skew': 85.226, 'best_test_test/acc_align': 85.565}
[5 / 20] Learning rate: 0.001 weight: 0.01
[5 / 20] Loss: 4.711469469899606 CE Loss: 1.5252639058061959 Con Loss: 4.696216835375099
[5 / 20] tensor([[0.799, 0.798],
        [0.892, 0.902]]) {'epoch': 5, 'valid/acc': 84.895, 'valid/acc_unbiased': 85.287, 'valid/diff': 1.374, 'valid/acc_skew': 85.332, 'valid/acc_align': 85.243, 'test/acc': 84.599, 'test/acc_unbiased': 84.766, 'test/diff': 0.59, 'test/acc_skew': 84.553, 'test/acc_align': 84.978}
[5 / 20] best valid accuracy: 85.287 at epoch 5 
 best_stats: {'best_valid_epoch': 5, 'best_valid_valid/acc': 84.895, 'best_valid_valid/acc_unbiased': 85.287, 'best_valid_valid/diff': 1.374, 'best_valid_valid/acc_skew': 85.332, 'best_valid_valid/acc_align': 85.243, 'best_valid_test/acc': 84.599, 'best_valid_test/acc_unbiased': 84.766, 'best_valid_test/diff': 0.59, 'best_valid_test/acc_skew': 84.553, 'best_valid_test/acc_align': 84.978}
[5 / 20] best test accuracy: 85.395 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 84.473, 'best_test_valid/acc_unbiased': 84.99, 'best_test_valid/diff': 3.304, 'best_test_valid/acc_skew': 86.642, 'best_test_valid/acc_align': 83.338, 'best_test_test/acc': 85.359, 'best_test_test/acc_unbiased': 85.395, 'best_test_test/diff': 1.936, 'best_test_test/acc_skew': 85.226, 'best_test_test/acc_align': 85.565}
[6 / 20] Learning rate: 0.001 weight: 0.01
[6 / 20] Loss: 4.694250060857163 CE Loss: 1.5045615537015755 Con Loss: 4.679204429601533
[6 / 20] tensor([[0.663, 0.654],
        [0.978, 0.967]]) {'epoch': 6, 'valid/acc': 80.422, 'valid/acc_unbiased': 81.585, 'valid/diff': 1.672, 'valid/acc_skew': 81.996, 'valid/acc_align': 81.175, 'test/acc': 80.844, 'test/acc_unbiased': 81.578, 'test/diff': 0.988, 'test/acc_skew': 82.072, 'test/acc_align': 81.083}
[6 / 20] best valid accuracy: 85.287 at epoch 5 
 best_stats: {'best_valid_epoch': 5, 'best_valid_valid/acc': 84.895, 'best_valid_valid/acc_unbiased': 85.287, 'best_valid_valid/diff': 1.374, 'best_valid_valid/acc_skew': 85.332, 'best_valid_valid/acc_align': 85.243, 'best_valid_test/acc': 84.599, 'best_valid_test/acc_unbiased': 84.766, 'best_valid_test/diff': 0.59, 'best_valid_test/acc_skew': 84.553, 'best_valid_test/acc_align': 84.978}
[6 / 20] best test accuracy: 85.395 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 84.473, 'best_test_valid/acc_unbiased': 84.99, 'best_test_valid/diff': 3.304, 'best_test_valid/acc_skew': 86.642, 'best_test_valid/acc_align': 83.338, 'best_test_test/acc': 85.359, 'best_test_test/acc_unbiased': 85.395, 'best_test_test/diff': 1.936, 'best_test_test/acc_skew': 85.226, 'best_test_test/acc_align': 85.565}
[7 / 20] Learning rate: 0.0001 weight: 0.01
[7 / 20] Loss: 4.656171431173348 CE Loss: 1.3389841520569796 Con Loss: 4.6427815737156966
[7 / 20] tensor([[0.849, 0.814],
        [0.909, 0.917]]) {'epoch': 7, 'valid/acc': 87.3, 'valid/acc_unbiased': 87.755, 'valid/diff': 2.144, 'valid/acc_skew': 88.828, 'valid/acc_align': 86.683, 'test/acc': 87.004, 'test/acc_unbiased': 87.231, 'test/diff': 2.164, 'test/acc_skew': 87.928, 'test/acc_align': 86.534}
[7 / 20] best valid accuracy: 87.755 at epoch 7 
 best_stats: {'best_valid_epoch': 7, 'best_valid_valid/acc': 87.3, 'best_valid_valid/acc_unbiased': 87.755, 'best_valid_valid/diff': 2.144, 'best_valid_valid/acc_skew': 88.828, 'best_valid_valid/acc_align': 86.683, 'best_valid_test/acc': 87.004, 'best_valid_test/acc_unbiased': 87.231, 'best_valid_test/diff': 2.164, 'best_valid_test/acc_skew': 87.928, 'best_valid_test/acc_align': 86.534}
[7 / 20] best test accuracy: 87.231 at epoch 7 
 best_stats: {'best_test_epoch': 7, 'best_test_valid/acc': 87.3, 'best_test_valid/acc_unbiased': 87.755, 'best_test_valid/diff': 2.144, 'best_test_valid/acc_skew': 88.828, 'best_test_valid/acc_align': 86.683, 'best_test_test/acc': 87.004, 'best_test_test/acc_unbiased': 87.231, 'best_test_test/diff': 2.164, 'best_test_test/acc_skew': 87.928, 'best_test_test/acc_align': 86.534}
[8 / 20] Learning rate: 0.0001 weight: 0.01
[8 / 20] Loss: 4.643280526620635 CE Loss: 1.2717811672141008 Con Loss: 4.630562729359618
[8 / 20] tensor([[0.867, 0.843],
        [0.883, 0.896]]) {'epoch': 8, 'valid/acc': 88.734, 'valid/acc_unbiased': 89.005, 'valid/diff': 3.087, 'valid/acc_skew': 90.549, 'valid/acc_align': 87.461, 'test/acc': 87.173, 'test/acc_unbiased': 87.248, 'test/diff': 1.841, 'test/acc_skew': 87.525, 'test/acc_align': 86.971}
[8 / 20] best valid accuracy: 89.005 at epoch 8 
 best_stats: {'best_valid_epoch': 8, 'best_valid_valid/acc': 88.734, 'best_valid_valid/acc_unbiased': 89.005, 'best_valid_valid/diff': 3.087, 'best_valid_valid/acc_skew': 90.549, 'best_valid_valid/acc_align': 87.461, 'best_valid_test/acc': 87.173, 'best_valid_test/acc_unbiased': 87.248, 'best_valid_test/diff': 1.841, 'best_valid_test/acc_skew': 87.525, 'best_valid_test/acc_align': 86.971}
[8 / 20] best test accuracy: 87.248 at epoch 8 
 best_stats: {'best_test_epoch': 8, 'best_test_valid/acc': 88.734, 'best_test_valid/acc_unbiased': 89.005, 'best_test_valid/diff': 3.087, 'best_test_valid/acc_skew': 90.549, 'best_test_valid/acc_align': 87.461, 'best_test_test/acc': 87.173, 'best_test_test/acc_unbiased': 87.248, 'best_test_test/diff': 1.841, 'best_test_test/acc_skew': 87.525, 'best_test_test/acc_align': 86.971}
[9 / 20] Learning rate: 0.0001 weight: 0.01
[9 / 20] Loss: 4.628338332653122 CE Loss: 1.2416098181944792 Con Loss: 4.615922213737433
[9 / 20] tensor([[0.853, 0.830],
        [0.894, 0.918]]) {'epoch': 9, 'valid/acc': 88.228, 'valid/acc_unbiased': 88.642, 'valid/diff': 2.868, 'valid/acc_skew': 90.075, 'valid/acc_align': 87.208, 'test/acc': 87.3, 'test/acc_unbiased': 87.385, 'test/diff': 2.363, 'test/acc_skew': 87.349, 'test/acc_align': 87.42}
[9 / 20] best valid accuracy: 89.005 at epoch 8 
 best_stats: {'best_valid_epoch': 8, 'best_valid_valid/acc': 88.734, 'best_valid_valid/acc_unbiased': 89.005, 'best_valid_valid/diff': 3.087, 'best_valid_valid/acc_skew': 90.549, 'best_valid_valid/acc_align': 87.461, 'best_valid_test/acc': 87.173, 'best_valid_test/acc_unbiased': 87.248, 'best_valid_test/diff': 1.841, 'best_valid_test/acc_skew': 87.525, 'best_valid_test/acc_align': 86.971}
[9 / 20] best test accuracy: 87.385 at epoch 9 
 best_stats: {'best_test_epoch': 9, 'best_test_valid/acc': 88.228, 'best_test_valid/acc_unbiased': 88.642, 'best_test_valid/diff': 2.868, 'best_test_valid/acc_skew': 90.075, 'best_test_valid/acc_align': 87.208, 'best_test_test/acc': 87.3, 'best_test_test/acc_unbiased': 87.385, 'best_test_test/diff': 2.363, 'best_test_test/acc_skew': 87.349, 'best_test_test/acc_align': 87.42}
[10 / 20] Learning rate: 0.0001 weight: 0.01
[10 / 20] Loss: 4.6260589697802015 CE Loss: 1.208312451836254 Con Loss: 4.613975857771311
[10 / 20] tensor([[0.871, 0.866],
        [0.883, 0.899]]) {'epoch': 10, 'valid/acc': 88.861, 'valid/acc_unbiased': 89.062, 'valid/diff': 2.488, 'valid/acc_skew': 90.306, 'valid/acc_align': 87.818, 'test/acc': 87.975, 'test/acc_unbiased': 87.966, 'test/diff': 1.061, 'test/acc_skew': 87.704, 'test/acc_align': 88.227}
[10 / 20] best valid accuracy: 89.062 at epoch 10 
 best_stats: {'best_valid_epoch': 10, 'best_valid_valid/acc': 88.861, 'best_valid_valid/acc_unbiased': 89.062, 'best_valid_valid/diff': 2.488, 'best_valid_valid/acc_skew': 90.306, 'best_valid_valid/acc_align': 87.818, 'best_valid_test/acc': 87.975, 'best_valid_test/acc_unbiased': 87.966, 'best_valid_test/diff': 1.061, 'best_valid_test/acc_skew': 87.704, 'best_valid_test/acc_align': 88.227}
[10 / 20] best test accuracy: 87.966 at epoch 10 
 best_stats: {'best_test_epoch': 10, 'best_test_valid/acc': 88.861, 'best_test_valid/acc_unbiased': 89.062, 'best_test_valid/diff': 2.488, 'best_test_valid/acc_skew': 90.306, 'best_test_valid/acc_align': 87.818, 'best_test_test/acc': 87.975, 'best_test_test/acc_unbiased': 87.966, 'best_test_test/diff': 1.061, 'best_test_test/acc_skew': 87.704, 'best_test_test/acc_align': 88.227}
[11 / 20] Learning rate: 0.0001 weight: 0.01
[11 / 20] Loss: 4.615493590928698 CE Loss: 1.166359905419534 Con Loss: 4.6038299875407045
[11 / 20] tensor([[0.860, 0.858],
        [0.903, 0.915]]) {'epoch': 11, 'valid/acc': 88.059, 'valid/acc_unbiased': 88.409, 'valid/diff': 2.877, 'valid/acc_skew': 89.848, 'valid/acc_align': 86.971, 'test/acc': 88.354, 'test/acc_unbiased': 88.408, 'test/diff': 0.736, 'test/acc_skew': 88.141, 'test/acc_align': 88.675}
[11 / 20] best valid accuracy: 89.062 at epoch 10 
 best_stats: {'best_valid_epoch': 10, 'best_valid_valid/acc': 88.861, 'best_valid_valid/acc_unbiased': 89.062, 'best_valid_valid/diff': 2.488, 'best_valid_valid/acc_skew': 90.306, 'best_valid_valid/acc_align': 87.818, 'best_valid_test/acc': 87.975, 'best_valid_test/acc_unbiased': 87.966, 'best_valid_test/diff': 1.061, 'best_valid_test/acc_skew': 87.704, 'best_valid_test/acc_align': 88.227}
[11 / 20] best test accuracy: 88.408 at epoch 11 
 best_stats: {'best_test_epoch': 11, 'best_test_valid/acc': 88.059, 'best_test_valid/acc_unbiased': 88.409, 'best_test_valid/diff': 2.877, 'best_test_valid/acc_skew': 89.848, 'best_test_valid/acc_align': 86.971, 'best_test_test/acc': 88.354, 'best_test_test/acc_unbiased': 88.408, 'best_test_test/diff': 0.736, 'best_test_test/acc_skew': 88.141, 'best_test_test/acc_align': 88.675}
[12 / 20] Learning rate: 0.0001 weight: 0.01
[12 / 20] Loss: 4.609637399807212 CE Loss: 1.169038714673872 Con Loss: 4.597947013124616
[12 / 20] tensor([[0.858, 0.845],
        [0.900, 0.920]]) {'epoch': 12, 'valid/acc': 88.692, 'valid/acc_unbiased': 89.02, 'valid/diff': 2.094, 'valid/acc_skew': 90.067, 'valid/acc_align': 87.973, 'test/acc': 88.017, 'test/acc_unbiased': 88.088, 'test/diff': 1.642, 'test/acc_skew': 87.943, 'test/acc_align': 88.233}
[12 / 20] best valid accuracy: 89.062 at epoch 10 
 best_stats: {'best_valid_epoch': 10, 'best_valid_valid/acc': 88.861, 'best_valid_valid/acc_unbiased': 89.062, 'best_valid_valid/diff': 2.488, 'best_valid_valid/acc_skew': 90.306, 'best_valid_valid/acc_align': 87.818, 'best_valid_test/acc': 87.975, 'best_valid_test/acc_unbiased': 87.966, 'best_valid_test/diff': 1.061, 'best_valid_test/acc_skew': 87.704, 'best_valid_test/acc_align': 88.227}
[12 / 20] best test accuracy: 88.408 at epoch 11 
 best_stats: {'best_test_epoch': 11, 'best_test_valid/acc': 88.059, 'best_test_valid/acc_unbiased': 88.409, 'best_test_valid/diff': 2.877, 'best_test_valid/acc_skew': 89.848, 'best_test_valid/acc_align': 86.971, 'best_test_test/acc': 88.354, 'best_test_test/acc_unbiased': 88.408, 'best_test_test/diff': 0.736, 'best_test_test/acc_skew': 88.141, 'best_test_test/acc_align': 88.675}
[13 / 20] Learning rate: 0.0001 weight: 0.01
[13 / 20] Loss: 4.608217956181056 CE Loss: 1.1515875867491472 Con Loss: 4.596702093482113
[13 / 20] tensor([[0.869, 0.851],
        [0.900, 0.914]]) {'epoch': 13, 'valid/acc': 89.072, 'valid/acc_unbiased': 89.36, 'valid/diff': 2.224, 'valid/acc_skew': 90.472, 'valid/acc_align': 88.248, 'test/acc': 88.27, 'test/acc_unbiased': 88.356, 'test/diff': 1.587, 'test/acc_skew': 88.48, 'test/acc_align': 88.232}
[13 / 20] best valid accuracy: 89.360 at epoch 13 
 best_stats: {'best_valid_epoch': 13, 'best_valid_valid/acc': 89.072, 'best_valid_valid/acc_unbiased': 89.36, 'best_valid_valid/diff': 2.224, 'best_valid_valid/acc_skew': 90.472, 'best_valid_valid/acc_align': 88.248, 'best_valid_test/acc': 88.27, 'best_valid_test/acc_unbiased': 88.356, 'best_valid_test/diff': 1.587, 'best_valid_test/acc_skew': 88.48, 'best_valid_test/acc_align': 88.232}
[13 / 20] best test accuracy: 88.408 at epoch 11 
 best_stats: {'best_test_epoch': 11, 'best_test_valid/acc': 88.059, 'best_test_valid/acc_unbiased': 88.409, 'best_test_valid/diff': 2.877, 'best_test_valid/acc_skew': 89.848, 'best_test_valid/acc_align': 86.971, 'best_test_test/acc': 88.354, 'best_test_test/acc_unbiased': 88.408, 'best_test_test/diff': 0.736, 'best_test_test/acc_skew': 88.141, 'best_test_test/acc_align': 88.675}
[14 / 20] Learning rate: 1e-05 weight: 0.01
[14 / 20] Loss: 4.595115267292321 CE Loss: 1.1475359675726766 Con Loss: 4.583639907065473
[14 / 20] tensor([[0.885, 0.874],
        [0.894, 0.906]]) {'epoch': 14, 'valid/acc': 89.241, 'valid/acc_unbiased': 89.447, 'valid/diff': 2.328, 'valid/acc_skew': 90.611, 'valid/acc_align': 88.283, 'test/acc': 88.987, 'test/acc_unbiased': 89.002, 'test/diff': 1.165, 'test/acc_skew': 88.962, 'test/acc_align': 89.042}
[14 / 20] best valid accuracy: 89.447 at epoch 14 
 best_stats: {'best_valid_epoch': 14, 'best_valid_valid/acc': 89.241, 'best_valid_valid/acc_unbiased': 89.447, 'best_valid_valid/diff': 2.328, 'best_valid_valid/acc_skew': 90.611, 'best_valid_valid/acc_align': 88.283, 'best_valid_test/acc': 88.987, 'best_valid_test/acc_unbiased': 89.002, 'best_valid_test/diff': 1.165, 'best_valid_test/acc_skew': 88.962, 'best_valid_test/acc_align': 89.042}
[14 / 20] best test accuracy: 89.002 at epoch 14 
 best_stats: {'best_test_epoch': 14, 'best_test_valid/acc': 89.241, 'best_test_valid/acc_unbiased': 89.447, 'best_test_valid/diff': 2.328, 'best_test_valid/acc_skew': 90.611, 'best_test_valid/acc_align': 88.283, 'best_test_test/acc': 88.987, 'best_test_test/acc_unbiased': 89.002, 'best_test_test/diff': 1.165, 'best_test_test/acc_skew': 88.962, 'best_test_test/acc_align': 89.042}
[15 / 20] Learning rate: 1e-05 weight: 0.01
[15 / 20] Loss: 4.593947999254 CE Loss: 1.1435017715040947 Con Loss: 4.582512980211961
[15 / 20] tensor([[0.869, 0.861],
        [0.903, 0.912]]) {'epoch': 15, 'valid/acc': 88.987, 'valid/acc_unbiased': 89.229, 'valid/diff': 2.125, 'valid/acc_skew': 90.291, 'valid/acc_align': 88.166, 'test/acc': 88.565, 'test/acc_unbiased': 88.631, 'test/diff': 0.888, 'test/acc_skew': 88.589, 'test/acc_align': 88.674}
[15 / 20] best valid accuracy: 89.447 at epoch 14 
 best_stats: {'best_valid_epoch': 14, 'best_valid_valid/acc': 89.241, 'best_valid_valid/acc_unbiased': 89.447, 'best_valid_valid/diff': 2.328, 'best_valid_valid/acc_skew': 90.611, 'best_valid_valid/acc_align': 88.283, 'best_valid_test/acc': 88.987, 'best_valid_test/acc_unbiased': 89.002, 'best_valid_test/diff': 1.165, 'best_valid_test/acc_skew': 88.962, 'best_valid_test/acc_align': 89.042}
[15 / 20] best test accuracy: 89.002 at epoch 14 
 best_stats: {'best_test_epoch': 14, 'best_test_valid/acc': 89.241, 'best_test_valid/acc_unbiased': 89.447, 'best_test_valid/diff': 2.328, 'best_test_valid/acc_skew': 90.611, 'best_test_valid/acc_align': 88.283, 'best_test_test/acc': 88.987, 'best_test_test/acc_unbiased': 89.002, 'best_test_test/diff': 1.165, 'best_test_test/acc_skew': 88.962, 'best_test_test/acc_align': 89.042}
[16 / 20] Learning rate: 1e-05 weight: 0.01
[16 / 20] Loss: 4.6060658968235115 CE Loss: 1.1248104009042308 Con Loss: 4.594817772684084
[16 / 20] tensor([[0.873, 0.870],
        [0.898, 0.909]]) {'epoch': 16, 'valid/acc': 89.241, 'valid/acc_unbiased': 89.457, 'valid/diff': 1.841, 'valid/acc_skew': 90.377, 'valid/acc_align': 88.536, 'test/acc': 88.734, 'test/acc_unbiased': 88.76, 'test/diff': 0.692, 'test/acc_skew': 88.551, 'test/acc_align': 88.969}
[16 / 20] best valid accuracy: 89.457 at epoch 16 
 best_stats: {'best_valid_epoch': 16, 'best_valid_valid/acc': 89.241, 'best_valid_valid/acc_unbiased': 89.457, 'best_valid_valid/diff': 1.841, 'best_valid_valid/acc_skew': 90.377, 'best_valid_valid/acc_align': 88.536, 'best_valid_test/acc': 88.734, 'best_valid_test/acc_unbiased': 88.76, 'best_valid_test/diff': 0.692, 'best_valid_test/acc_skew': 88.551, 'best_valid_test/acc_align': 88.969}
[16 / 20] best test accuracy: 89.002 at epoch 14 
 best_stats: {'best_test_epoch': 14, 'best_test_valid/acc': 89.241, 'best_test_valid/acc_unbiased': 89.447, 'best_test_valid/diff': 2.328, 'best_test_valid/acc_skew': 90.611, 'best_test_valid/acc_align': 88.283, 'best_test_test/acc': 88.987, 'best_test_test/acc_unbiased': 89.002, 'best_test_test/diff': 1.165, 'best_test_test/acc_skew': 88.962, 'best_test_test/acc_align': 89.042}
[17 / 20] Learning rate: 1e-05 weight: 0.01
[17 / 20] Loss: 4.581023673619891 CE Loss: 1.1204871508703111 Con Loss: 4.569818806353217
[17 / 20] tensor([[0.880, 0.871],
        [0.900, 0.906]]) {'epoch': 17, 'valid/acc': 89.156, 'valid/acc_unbiased': 89.378, 'valid/diff': 2.294, 'valid/acc_skew': 90.525, 'valid/acc_align': 88.231, 'test/acc': 88.903, 'test/acc_unbiased': 88.956, 'test/diff': 0.72, 'test/acc_skew': 89.018, 'test/acc_align': 88.894}
[17 / 20] best valid accuracy: 89.457 at epoch 16 
 best_stats: {'best_valid_epoch': 16, 'best_valid_valid/acc': 89.241, 'best_valid_valid/acc_unbiased': 89.457, 'best_valid_valid/diff': 1.841, 'best_valid_valid/acc_skew': 90.377, 'best_valid_valid/acc_align': 88.536, 'best_valid_test/acc': 88.734, 'best_valid_test/acc_unbiased': 88.76, 'best_valid_test/diff': 0.692, 'best_valid_test/acc_skew': 88.551, 'best_valid_test/acc_align': 88.969}
[17 / 20] best test accuracy: 89.002 at epoch 14 
 best_stats: {'best_test_epoch': 14, 'best_test_valid/acc': 89.241, 'best_test_valid/acc_unbiased': 89.447, 'best_test_valid/diff': 2.328, 'best_test_valid/acc_skew': 90.611, 'best_test_valid/acc_align': 88.283, 'best_test_test/acc': 88.987, 'best_test_test/acc_unbiased': 89.002, 'best_test_test/diff': 1.165, 'best_test_test/acc_skew': 88.962, 'best_test_test/acc_align': 89.042}
[18 / 20] Learning rate: 1e-05 weight: 0.01
[18 / 20] Loss: 4.592065646421445 CE Loss: 1.1163565832966875 Con Loss: 4.580902107477048
[18 / 20] tensor([[0.885, 0.888],
        [0.890, 0.899]]) {'epoch': 18, 'valid/acc': 88.987, 'valid/acc_unbiased': 89.146, 'valid/diff': 2.398, 'valid/acc_skew': 90.345, 'valid/acc_align': 87.947, 'test/acc': 89.072, 'test/acc_unbiased': 89.04, 'test/diff': 0.589, 'test/acc_skew': 88.746, 'test/acc_align': 89.335}
[18 / 20] best valid accuracy: 89.457 at epoch 16 
 best_stats: {'best_valid_epoch': 16, 'best_valid_valid/acc': 89.241, 'best_valid_valid/acc_unbiased': 89.457, 'best_valid_valid/diff': 1.841, 'best_valid_valid/acc_skew': 90.377, 'best_valid_valid/acc_align': 88.536, 'best_valid_test/acc': 88.734, 'best_valid_test/acc_unbiased': 88.76, 'best_valid_test/diff': 0.692, 'best_valid_test/acc_skew': 88.551, 'best_valid_test/acc_align': 88.969}
[18 / 20] best test accuracy: 89.040 at epoch 18 
 best_stats: {'best_test_epoch': 18, 'best_test_valid/acc': 88.987, 'best_test_valid/acc_unbiased': 89.146, 'best_test_valid/diff': 2.398, 'best_test_valid/acc_skew': 90.345, 'best_test_valid/acc_align': 87.947, 'best_test_test/acc': 89.072, 'best_test_test/acc_unbiased': 89.04, 'best_test_test/diff': 0.589, 'best_test_test/acc_skew': 88.746, 'best_test_test/acc_align': 89.335}
[19 / 20] Learning rate: 1e-05 weight: 0.01
[19 / 20] Loss: 4.591304042607924 CE Loss: 1.099452003340911 Con Loss: 4.580309520225262
[19 / 20] tensor([[0.887, 0.891],
        [0.887, 0.897]]) {'epoch': 19, 'valid/acc': 89.072, 'valid/acc_unbiased': 89.191, 'valid/diff': 2.041, 'valid/acc_skew': 90.212, 'valid/acc_align': 88.171, 'test/acc': 89.114, 'test/acc_unbiased': 89.068, 'test/diff': 0.681, 'test/acc_skew': 88.727, 'test/acc_align': 89.408}
[19 / 20] best valid accuracy: 89.457 at epoch 16 
 best_stats: {'best_valid_epoch': 16, 'best_valid_valid/acc': 89.241, 'best_valid_valid/acc_unbiased': 89.457, 'best_valid_valid/diff': 1.841, 'best_valid_valid/acc_skew': 90.377, 'best_valid_valid/acc_align': 88.536, 'best_valid_test/acc': 88.734, 'best_valid_test/acc_unbiased': 88.76, 'best_valid_test/diff': 0.692, 'best_valid_test/acc_skew': 88.551, 'best_valid_test/acc_align': 88.969}
[19 / 20] best test accuracy: 89.068 at epoch 19 
 best_stats: {'best_test_epoch': 19, 'best_test_valid/acc': 89.072, 'best_test_valid/acc_unbiased': 89.191, 'best_test_valid/diff': 2.041, 'best_test_valid/acc_skew': 90.212, 'best_test_valid/acc_align': 88.171, 'best_test_test/acc': 89.114, 'best_test_test/acc_unbiased': 89.068, 'best_test_test/diff': 0.681, 'best_test_test/acc_skew': 88.727, 'best_test_test/acc_align': 89.408}
[20 / 20] Learning rate: 1e-05 weight: 0.01
[20 / 20] Loss: 4.588232746860968 CE Loss: 1.12040912348897 Con Loss: 4.577028651060465
[20 / 20] tensor([[0.884, 0.886],
        [0.890, 0.908]]) {'epoch': 20, 'valid/acc': 89.072, 'valid/acc_unbiased': 89.278, 'valid/diff': 2.619, 'valid/acc_skew': 90.587, 'valid/acc_align': 87.969, 'test/acc': 89.241, 'test/acc_unbiased': 89.182, 'test/diff': 1.051, 'test/acc_skew': 88.656, 'test/acc_align': 89.707}
[20 / 20] best valid accuracy: 89.457 at epoch 16 
 best_stats: {'best_valid_epoch': 16, 'best_valid_valid/acc': 89.241, 'best_valid_valid/acc_unbiased': 89.457, 'best_valid_valid/diff': 1.841, 'best_valid_valid/acc_skew': 90.377, 'best_valid_valid/acc_align': 88.536, 'best_valid_test/acc': 88.734, 'best_valid_test/acc_unbiased': 88.76, 'best_valid_test/diff': 0.692, 'best_valid_test/acc_skew': 88.551, 'best_valid_test/acc_align': 88.969}
[20 / 20] best test accuracy: 89.182 at epoch 20 
 best_stats: {'best_test_epoch': 20, 'best_test_valid/acc': 89.072, 'best_test_valid/acc_unbiased': 89.278, 'best_test_valid/diff': 2.619, 'best_test_valid/acc_skew': 90.587, 'best_test_valid/acc_align': 87.969, 'best_test_test/acc': 89.241, 'best_test_test/acc_unbiased': 89.182, 'best_test_test/diff': 1.051, 'best_test_test/acc_skew': 88.656, 'best_test_test/acc_align': 89.707}
Total training time: 1:25:17
