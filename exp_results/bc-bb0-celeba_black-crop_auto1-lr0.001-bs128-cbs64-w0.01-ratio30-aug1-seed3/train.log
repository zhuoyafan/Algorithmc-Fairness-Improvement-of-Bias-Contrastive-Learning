Log level set to: INFO
Set seed: 3
=======> Using Fixed Random Seed: 3 <========
save_path: exp_results/bc-bb0-celeba_black-crop_auto1-lr0.001-bs128-cbs64-w0.01-ratio30-aug1-seed3
get_celeba - split:train, aug: False, given_y: True, ratio: 0
use existing black indices from data/celeba/pickles/black
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [60544, 38546]
Target 1: [8005, 16093]
Binary Target 1
---------------------------
Target 0: [60544, 38546]
Target 1: [8005, 16093]
===================================
Normal Label Distribution: 
Target 0: [60544, 38546]
Target 1: [8005, 16093]
===================================
Use BiasedCelebASplit 
 target_attr: black split: train 
 tensor([[60544.,  8005.],
        [38546., 16093.]])
get_celeba - split:train, aug: 1, given_y: True, ratio: 30
use existing black indices from data/celeba/pickles/black
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [60623, 38503]
Target 1: [7983, 16079]
Binary Target 1
---------------------------
Target 0: [60623, 38503]
Target 1: [7983, 16079]
===================================
Normal Label Distribution: 
Target 0: [60623, 38503]
Target 1: [7983, 16079]
===================================
Use BiasedCelebASplit 
 target_attr: black split: train 
 tensor([[60623.,  7983.],
        [38503., 16079.]])
get_celeba - split:train_valid, aug: False, given_y: True, ratio: 0
use existing black indices from data/celeba/pickles/black
Use BiasedCelebASplit 
 target_attr: black split: train_valid 
 tensor([[15141.,  1962.],
        [ 9689.,  4006.]])
get_celeba - split:valid, aug: False, given_y: True, ratio: 0
Use BiasedCelebASplit 
 target_attr: black split: valid 
 tensor([[9752., 1657.],
        [5971., 2487.]])
decay_epochs: [3, 6]
[1 / 10] Learning rate: 0.001 weight: 0.01
[1 / 10] Loss: 4.823186647250606 CE Loss: 0.32521879482366833 Con Loss: 4.819934459283344
[1 / 10] tensor([[0.995, 0.992],
        [0.177, 0.188]]) {'epoch': 1, 'valid/acc': 83.609, 'valid/acc_unbiased': 58.99, 'valid/diff': 0.447, 'valid/acc_skew': 59.087, 'valid/acc_align': 58.893, 'test/acc': 82.463, 'test/acc_unbiased': 58.793, 'test/diff': 0.648, 'test/acc_skew': 58.47, 'test/acc_align': 59.117}
[1 / 10] best valid accuracy: 58.990 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 83.609, 'best_valid_valid/acc_unbiased': 58.99, 'best_valid_valid/diff': 0.447, 'best_valid_valid/acc_skew': 59.087, 'best_valid_valid/acc_align': 58.893, 'best_valid_test/acc': 82.463, 'best_valid_test/acc_unbiased': 58.793, 'best_valid_test/diff': 0.648, 'best_valid_test/acc_skew': 58.47, 'best_valid_test/acc_align': 59.117}
[1 / 10] best test accuracy: 58.793 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 83.609, 'best_test_valid/acc_unbiased': 58.99, 'best_test_valid/diff': 0.447, 'best_test_valid/acc_skew': 59.087, 'best_test_valid/acc_align': 58.893, 'best_test_test/acc': 82.463, 'best_test_test/acc_unbiased': 58.793, 'best_test_test/diff': 0.648, 'best_test_test/acc_skew': 58.47, 'best_test_test/acc_align': 59.117}
[2 / 10] Learning rate: 0.001 weight: 0.01
[2 / 10] Loss: 4.808740665065928 CE Loss: 0.2911829319626967 Con Loss: 4.805828839969173
[2 / 10] tensor([[0.949, 0.922],
        [0.614, 0.595]]) {'epoch': 2, 'valid/acc': 86.821, 'valid/acc_unbiased': 76.444, 'valid/diff': 3.062, 'valid/acc_skew': 76.878, 'valid/acc_align': 76.009, 'test/acc': 86.858, 'test/acc_unbiased': 77.008, 'test/diff': 2.294, 'test/acc_skew': 76.824, 'test/acc_align': 77.191}
[2 / 10] best valid accuracy: 76.444 at epoch 2 
 best_stats: {'best_valid_epoch': 2, 'best_valid_valid/acc': 86.821, 'best_valid_valid/acc_unbiased': 76.444, 'best_valid_valid/diff': 3.062, 'best_valid_valid/acc_skew': 76.878, 'best_valid_valid/acc_align': 76.009, 'best_valid_test/acc': 86.858, 'best_valid_test/acc_unbiased': 77.008, 'best_valid_test/diff': 2.294, 'best_valid_test/acc_skew': 76.824, 'best_valid_test/acc_align': 77.191}
[2 / 10] best test accuracy: 77.008 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 86.821, 'best_test_valid/acc_unbiased': 76.444, 'best_test_valid/diff': 3.062, 'best_test_valid/acc_skew': 76.878, 'best_test_valid/acc_align': 76.009, 'best_test_test/acc': 86.858, 'best_test_test/acc_unbiased': 77.008, 'best_test_test/diff': 2.294, 'best_test_test/acc_skew': 76.824, 'best_test_test/acc_align': 77.191}
[3 / 10] Learning rate: 0.001 weight: 0.01
[3 / 10] Loss: 4.8042335161881145 CE Loss: 0.2797656564366939 Con Loss: 4.801435856330347
[3 / 10] tensor([[0.992, 0.976],
        [0.365, 0.440]]) {'epoch': 3, 'valid/acc': 86.954, 'valid/acc_unbiased': 68.544, 'valid/diff': 3.336, 'valid/acc_skew': 66.876, 'valid/acc_align': 70.212, 'test/acc': 86.561, 'test/acc_unbiased': 69.306, 'test/diff': 4.606, 'test/acc_skew': 67.003, 'test/acc_align': 71.609}
[3 / 10] best valid accuracy: 76.444 at epoch 2 
 best_stats: {'best_valid_epoch': 2, 'best_valid_valid/acc': 86.821, 'best_valid_valid/acc_unbiased': 76.444, 'best_valid_valid/diff': 3.062, 'best_valid_valid/acc_skew': 76.878, 'best_valid_valid/acc_align': 76.009, 'best_valid_test/acc': 86.858, 'best_valid_test/acc_unbiased': 77.008, 'best_valid_test/diff': 2.294, 'best_valid_test/acc_skew': 76.824, 'best_valid_test/acc_align': 77.191}
[3 / 10] best test accuracy: 77.008 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 86.821, 'best_test_valid/acc_unbiased': 76.444, 'best_test_valid/diff': 3.062, 'best_test_valid/acc_skew': 76.878, 'best_test_valid/acc_align': 76.009, 'best_test_test/acc': 86.858, 'best_test_test/acc_unbiased': 77.008, 'best_test_test/diff': 2.294, 'best_test_test/acc_skew': 76.824, 'best_test_test/acc_align': 77.191}
[4 / 10] Learning rate: 0.0001 weight: 0.01
[4 / 10] Loss: 4.777791174695906 CE Loss: 0.24501350931718016 Con Loss: 4.775341039571444
[4 / 10] tensor([[0.965, 0.926],
        [0.667, 0.717]]) {'epoch': 4, 'valid/acc': 89.71, 'valid/acc_unbiased': 81.173, 'valid/diff': 2.625, 'valid/acc_skew': 79.861, 'valid/acc_align': 82.485, 'test/acc': 89.717, 'test/acc_unbiased': 81.867, 'test/diff': 4.45, 'test/acc_skew': 79.642, 'test/acc_align': 84.093}
[4 / 10] best valid accuracy: 81.173 at epoch 4 
 best_stats: {'best_valid_epoch': 4, 'best_valid_valid/acc': 89.71, 'best_valid_valid/acc_unbiased': 81.173, 'best_valid_valid/diff': 2.625, 'best_valid_valid/acc_skew': 79.861, 'best_valid_valid/acc_align': 82.485, 'best_valid_test/acc': 89.717, 'best_valid_test/acc_unbiased': 81.867, 'best_valid_test/diff': 4.45, 'best_valid_test/acc_skew': 79.642, 'best_valid_test/acc_align': 84.093}
[4 / 10] best test accuracy: 81.867 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 89.71, 'best_test_valid/acc_unbiased': 81.173, 'best_test_valid/diff': 2.625, 'best_test_valid/acc_skew': 79.861, 'best_test_valid/acc_align': 82.485, 'best_test_test/acc': 89.717, 'best_test_test/acc_unbiased': 81.867, 'best_test_test/diff': 4.45, 'best_test_test/acc_skew': 79.642, 'best_test_test/acc_align': 84.093}
[5 / 10] Learning rate: 0.0001 weight: 0.01
[5 / 10] Loss: 4.766083119058545 CE Loss: 0.23640527944346196 Con Loss: 4.763719071117815
[5 / 10] tensor([[0.973, 0.953],
        [0.648, 0.680]]) {'epoch': 5, 'valid/acc': 90.197, 'valid/acc_unbiased': 80.776, 'valid/diff': 0.93, 'valid/acc_skew': 80.372, 'valid/acc_align': 81.18, 'test/acc': 90.326, 'test/acc_unbiased': 81.347, 'test/diff': 2.584, 'test/acc_skew': 80.055, 'test/acc_align': 82.638}
[5 / 10] best valid accuracy: 81.173 at epoch 4 
 best_stats: {'best_valid_epoch': 4, 'best_valid_valid/acc': 89.71, 'best_valid_valid/acc_unbiased': 81.173, 'best_valid_valid/diff': 2.625, 'best_valid_valid/acc_skew': 79.861, 'best_valid_valid/acc_align': 82.485, 'best_valid_test/acc': 89.717, 'best_valid_test/acc_unbiased': 81.867, 'best_valid_test/diff': 4.45, 'best_valid_test/acc_skew': 79.642, 'best_valid_test/acc_align': 84.093}
[5 / 10] best test accuracy: 81.867 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 89.71, 'best_test_valid/acc_unbiased': 81.173, 'best_test_valid/diff': 2.625, 'best_test_valid/acc_skew': 79.861, 'best_test_valid/acc_align': 82.485, 'best_test_test/acc': 89.717, 'best_test_test/acc_unbiased': 81.867, 'best_test_test/diff': 4.45, 'best_test_test/acc_skew': 79.642, 'best_test_test/acc_align': 84.093}
[6 / 10] Learning rate: 0.0001 weight: 0.01
[6 / 10] Loss: 4.7650237003386735 CE Loss: 0.23134896823596338 Con Loss: 4.762710211520637
[6 / 10] tensor([[0.962, 0.929],
        [0.686, 0.730]]) {'epoch': 6, 'valid/acc': 89.921, 'valid/acc_unbiased': 82.117, 'valid/diff': 2.222, 'valid/acc_skew': 81.006, 'valid/acc_align': 83.228, 'test/acc': 89.983, 'test/acc_unbiased': 82.651, 'test/diff': 3.862, 'test/acc_skew': 80.72, 'test/acc_align': 84.582}
[6 / 10] best valid accuracy: 82.117 at epoch 6 
 best_stats: {'best_valid_epoch': 6, 'best_valid_valid/acc': 89.921, 'best_valid_valid/acc_unbiased': 82.117, 'best_valid_valid/diff': 2.222, 'best_valid_valid/acc_skew': 81.006, 'best_valid_valid/acc_align': 83.228, 'best_valid_test/acc': 89.983, 'best_valid_test/acc_unbiased': 82.651, 'best_valid_test/diff': 3.862, 'best_valid_test/acc_skew': 80.72, 'best_valid_test/acc_align': 84.582}
[6 / 10] best test accuracy: 82.651 at epoch 6 
 best_stats: {'best_test_epoch': 6, 'best_test_valid/acc': 89.921, 'best_test_valid/acc_unbiased': 82.117, 'best_test_valid/diff': 2.222, 'best_test_valid/acc_skew': 81.006, 'best_test_valid/acc_align': 83.228, 'best_test_test/acc': 89.983, 'best_test_test/acc_unbiased': 82.651, 'best_test_test/diff': 3.862, 'best_test_test/acc_skew': 80.72, 'best_test_test/acc_align': 84.582}
[7 / 10] Learning rate: 1e-05 weight: 0.01
[7 / 10] Loss: 4.762039778723935 CE Loss: 0.22713623508720518 Con Loss: 4.75976842144238
[7 / 10] tensor([[0.965, 0.940],
        [0.705, 0.724]]) {'epoch': 7, 'valid/acc': 90.379, 'valid/acc_unbiased': 82.818, 'valid/diff': 1.293, 'valid/acc_skew': 82.511, 'valid/acc_align': 83.124, 'test/acc': 90.527, 'test/acc_unbiased': 83.333, 'test/diff': 2.163, 'test/acc_skew': 82.252, 'test/acc_align': 84.414}
[7 / 10] best valid accuracy: 82.818 at epoch 7 
 best_stats: {'best_valid_epoch': 7, 'best_valid_valid/acc': 90.379, 'best_valid_valid/acc_unbiased': 82.818, 'best_valid_valid/diff': 1.293, 'best_valid_valid/acc_skew': 82.511, 'best_valid_valid/acc_align': 83.124, 'best_valid_test/acc': 90.527, 'best_valid_test/acc_unbiased': 83.333, 'best_valid_test/diff': 2.163, 'best_valid_test/acc_skew': 82.252, 'best_valid_test/acc_align': 84.414}
[7 / 10] best test accuracy: 83.333 at epoch 7 
 best_stats: {'best_test_epoch': 7, 'best_test_valid/acc': 90.379, 'best_test_valid/acc_unbiased': 82.818, 'best_test_valid/diff': 1.293, 'best_test_valid/acc_skew': 82.511, 'best_test_valid/acc_align': 83.124, 'best_test_test/acc': 90.527, 'best_test_test/acc_unbiased': 83.333, 'best_test_test/diff': 2.163, 'best_test_test/acc_skew': 82.252, 'best_test_test/acc_align': 84.414}
[8 / 10] Learning rate: 1e-05 weight: 0.01
[8 / 10] Loss: 4.756700980584722 CE Loss: 0.22512752572897987 Con Loss: 4.7544497079685435
[8 / 10] tensor([[0.964, 0.939],
        [0.696, 0.725]]) {'epoch': 8, 'valid/acc': 90.347, 'valid/acc_unbiased': 82.734, 'valid/diff': 0.968, 'valid/acc_skew': 82.261, 'valid/acc_align': 83.207, 'test/acc': 90.416, 'test/acc_unbiased': 83.101, 'test/diff': 2.715, 'test/acc_skew': 81.744, 'test/acc_align': 84.459}
[8 / 10] best valid accuracy: 82.818 at epoch 7 
 best_stats: {'best_valid_epoch': 7, 'best_valid_valid/acc': 90.379, 'best_valid_valid/acc_unbiased': 82.818, 'best_valid_valid/diff': 1.293, 'best_valid_valid/acc_skew': 82.511, 'best_valid_valid/acc_align': 83.124, 'best_valid_test/acc': 90.527, 'best_valid_test/acc_unbiased': 83.333, 'best_valid_test/diff': 2.163, 'best_valid_test/acc_skew': 82.252, 'best_valid_test/acc_align': 84.414}
[8 / 10] best test accuracy: 83.333 at epoch 7 
 best_stats: {'best_test_epoch': 7, 'best_test_valid/acc': 90.379, 'best_test_valid/acc_unbiased': 82.818, 'best_test_valid/diff': 1.293, 'best_test_valid/acc_skew': 82.511, 'best_test_valid/acc_align': 83.124, 'best_test_test/acc': 90.527, 'best_test_test/acc_unbiased': 83.333, 'best_test_test/diff': 2.163, 'best_test_test/acc_skew': 82.252, 'best_test_test/acc_align': 84.414}
[9 / 10] Learning rate: 1e-05 weight: 0.01
[9 / 10] Loss: 4.758798604445531 CE Loss: 0.22324171517610775 Con Loss: 4.75656618752851
[9 / 10] tensor([[0.966, 0.945],
        [0.688, 0.714]]) {'epoch': 9, 'valid/acc': 90.538, 'valid/acc_unbiased': 82.786, 'valid/diff': 1.126, 'valid/acc_skew': 82.534, 'valid/acc_align': 83.039, 'test/acc': 90.507, 'test/acc_unbiased': 82.827, 'test/diff': 2.332, 'test/acc_skew': 81.661, 'test/acc_align': 83.994}
[9 / 10] best valid accuracy: 82.818 at epoch 7 
 best_stats: {'best_valid_epoch': 7, 'best_valid_valid/acc': 90.379, 'best_valid_valid/acc_unbiased': 82.818, 'best_valid_valid/diff': 1.293, 'best_valid_valid/acc_skew': 82.511, 'best_valid_valid/acc_align': 83.124, 'best_valid_test/acc': 90.527, 'best_valid_test/acc_unbiased': 83.333, 'best_valid_test/diff': 2.163, 'best_valid_test/acc_skew': 82.252, 'best_valid_test/acc_align': 84.414}
[9 / 10] best test accuracy: 83.333 at epoch 7 
 best_stats: {'best_test_epoch': 7, 'best_test_valid/acc': 90.379, 'best_test_valid/acc_unbiased': 82.818, 'best_test_valid/diff': 1.293, 'best_test_valid/acc_skew': 82.511, 'best_test_valid/acc_align': 83.124, 'best_test_test/acc': 90.527, 'best_test_test/acc_unbiased': 83.333, 'best_test_test/diff': 2.163, 'best_test_test/acc_skew': 82.252, 'best_test_test/acc_align': 84.414}
[10 / 10] Learning rate: 1e-05 weight: 0.01
[10 / 10] Loss: 4.758548070297739 CE Loss: 0.22281661998177787 Con Loss: 4.756319912477767
[10 / 10] tensor([[0.967, 0.942],
        [0.675, 0.718]]) {'epoch': 10, 'valid/acc': 90.389, 'valid/acc_unbiased': 82.27, 'valid/diff': 1.994, 'valid/acc_skew': 81.273, 'valid/acc_align': 83.267, 'test/acc': 90.396, 'test/acc_unbiased': 82.545, 'test/diff': 3.431, 'test/acc_skew': 80.83, 'test/acc_align': 84.261}
[10 / 10] best valid accuracy: 82.818 at epoch 7 
 best_stats: {'best_valid_epoch': 7, 'best_valid_valid/acc': 90.379, 'best_valid_valid/acc_unbiased': 82.818, 'best_valid_valid/diff': 1.293, 'best_valid_valid/acc_skew': 82.511, 'best_valid_valid/acc_align': 83.124, 'best_valid_test/acc': 90.527, 'best_valid_test/acc_unbiased': 83.333, 'best_valid_test/diff': 2.163, 'best_valid_test/acc_skew': 82.252, 'best_valid_test/acc_align': 84.414}
[10 / 10] best test accuracy: 83.333 at epoch 7 
 best_stats: {'best_test_epoch': 7, 'best_test_valid/acc': 90.379, 'best_test_valid/acc_unbiased': 82.818, 'best_test_valid/diff': 1.293, 'best_test_valid/acc_skew': 82.511, 'best_test_valid/acc_align': 83.124, 'best_test_test/acc': 90.527, 'best_test_test/acc_unbiased': 83.333, 'best_test_test/diff': 2.163, 'best_test_test/acc_skew': 82.252, 'best_test_test/acc_align': 84.414}
Total training time: 2:08:35
