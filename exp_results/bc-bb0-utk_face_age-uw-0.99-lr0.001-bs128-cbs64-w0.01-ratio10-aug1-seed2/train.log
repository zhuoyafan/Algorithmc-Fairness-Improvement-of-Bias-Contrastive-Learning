Log level set to: INFO
Set seed: 2
=======> Using Fixed Random Seed: 2 <========
save_path: exp_results/bc-bb0-utk_face_age-uw-0.99-lr0.001-bs128-cbs64-w0.01-ratio10-aug1-seed2
get_utk_face - split: train, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_age-0.99
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [8237, 14]
Target 1: [82, 1477]
Binary Target 1
---------------------------
Target 0: [8237, 14]
Target 1: [82, 1477]
===================================
Normal Label Distribution: 
Target 0: [8237, 14]
Target 1: [82, 1477]
===================================
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [8237, 14]
Target 1: [82, 1477]
Binary Target 1
---------------------------
Target 0: [8237, 14]
Target 1: [82, 1477]
===================================
Normal Label Distribution: 
Target 0: [8237, 14]
Target 1: [82, 1477]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 9810, target_attr: gender, bias_attr: age bias_rate: 0.99
['[train] target_0-bias_0: 8237', '[train] target_0-bias_1: 14', '[train] target_1-bias_0: 82', '[train] target_1-bias_1: 1477']
confusion_matrix - 
 original: tensor([[8237.,   82.],
        [  14., 1477.]]), 
 normalized: tensor([[0.990, 0.010],
        [0.009, 0.991]]), 
 b|y: tensor([[0.998, 0.002],
        [0.053, 0.947]])
get_utk_face - split: train, aug: 1, given_y: True, ratio: 10
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_age-0.99
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [8237, 14]
Target 1: [82, 1477]
Binary Target 1
---------------------------
Target 0: [8237, 14]
Target 1: [82, 1477]
===================================
Normal Label Distribution: 
Target 0: [8237, 14]
Target 1: [82, 1477]
===================================
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [8237, 14]
Target 1: [82, 1477]
Binary Target 1
---------------------------
Target 0: [8237, 14]
Target 1: [82, 1477]
===================================
Normal Label Distribution: 
Target 0: [8237, 14]
Target 1: [82, 1477]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 9810, target_attr: gender, bias_attr: age bias_rate: 0.99
['[train] target_0-bias_0: 8237', '[train] target_0-bias_1: 14', '[train] target_1-bias_0: 82', '[train] target_1-bias_1: 1477']
get_utk_face - split: valid, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_age-0.99
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [1030, 195]
Target 1: [841, 202]
Binary Target 1
---------------------------
Target 0: [1030, 195]
Target 1: [841, 202]
===================================
Normal Label Distribution: 
Target 0: [1030, 195]
Target 1: [841, 202]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 2268, target_attr: gender, bias_attr: age bias_rate: 0.99
['[valid] target_0-bias_0: 1030', '[valid] target_0-bias_1: 195', '[valid] target_1-bias_0: 841', '[valid] target_1-bias_1: 202']
get_utk_face - split: test, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_age-0.99
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [1061, 176]
Target 1: [867, 165]
Binary Target 1
---------------------------
Target 0: [1061, 176]
Target 1: [867, 165]
===================================
Normal Label Distribution: 
Target 0: [1061, 176]
Target 1: [867, 165]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 2269, target_attr: gender, bias_attr: age bias_rate: 0.99
['[test] target_0-bias_0: 1061', '[test] target_0-bias_1: 176', '[test] target_1-bias_0: 867', '[test] target_1-bias_1: 165']
decay_epochs: [6, 13]
[1 / 20] Learning rate: 0.001 weight: 0.01
[1 / 20] Loss: 3.172698610686867 CE Loss: 3.0374318937764375 Con Loss: 3.142324290533192
[1 / 20] tensor([[0.930, 0.949],
        [0.099, 0.055]]) {'epoch': 1, 'valid/acc': 54.541, 'valid/acc_unbiased': 50.424, 'valid/diff': 3.975, 'valid/acc_skew': 52.411, 'valid/acc_align': 48.437, 'test/acc': 55.046, 'test/acc_unbiased': 50.821, 'test/diff': 3.163, 'test/acc_skew': 52.403, 'test/acc_align': 49.24}
[1 / 20] best valid accuracy: 50.424 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 54.541, 'best_valid_valid/acc_unbiased': 50.424, 'best_valid_valid/diff': 3.975, 'best_valid_valid/acc_skew': 52.411, 'best_valid_valid/acc_align': 48.437, 'best_valid_test/acc': 55.046, 'best_valid_test/acc_unbiased': 50.821, 'best_valid_test/diff': 3.163, 'best_valid_test/acc_skew': 52.403, 'best_valid_test/acc_align': 49.24}
[1 / 20] best test accuracy: 50.821 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 54.541, 'best_test_valid/acc_unbiased': 50.424, 'best_test_valid/diff': 3.975, 'best_test_valid/acc_skew': 52.411, 'best_test_valid/acc_align': 48.437, 'best_test_test/acc': 55.046, 'best_test_test/acc_unbiased': 50.821, 'best_test_test/diff': 3.163, 'best_test_test/acc_skew': 52.403, 'best_test_test/acc_align': 49.24}
[2 / 20] Learning rate: 0.001 weight: 0.01
[2 / 20] Loss: 2.827185543779204 CE Loss: 3.184902870302657 Con Loss: 2.7953365240135932
[2 / 20] tensor([[0.500, 0.131],
        [0.776, 0.885]]) {'epoch': 2, 'valid/acc': 61.023, 'valid/acc_unbiased': 57.734, 'valid/diff': 24.243, 'valid/acc_skew': 45.612, 'valid/acc_align': 69.855, 'test/acc': 60.511, 'test/acc_unbiased': 57.306, 'test/diff': 23.92, 'test/acc_skew': 45.346, 'test/acc_align': 69.266}
[2 / 20] best valid accuracy: 57.734 at epoch 2 
 best_stats: {'best_valid_epoch': 2, 'best_valid_valid/acc': 61.023, 'best_valid_valid/acc_unbiased': 57.734, 'best_valid_valid/diff': 24.243, 'best_valid_valid/acc_skew': 45.612, 'best_valid_valid/acc_align': 69.855, 'best_valid_test/acc': 60.511, 'best_valid_test/acc_unbiased': 57.306, 'best_valid_test/diff': 23.92, 'best_valid_test/acc_skew': 45.346, 'best_valid_test/acc_align': 69.266}
[2 / 20] best test accuracy: 57.306 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 61.023, 'best_test_valid/acc_unbiased': 57.734, 'best_test_valid/diff': 24.243, 'best_test_valid/acc_skew': 45.612, 'best_test_valid/acc_align': 69.855, 'best_test_test/acc': 60.511, 'best_test_test/acc_unbiased': 57.306, 'best_test_test/diff': 23.92, 'best_test_test/acc_skew': 45.346, 'best_test_test/acc_align': 69.266}
[3 / 20] Learning rate: 0.001 weight: 0.01
[3 / 20] Loss: 2.9643431416588335 CE Loss: 2.8511450263945943 Con Loss: 2.935831691827492
[3 / 20] tensor([[0.788, 0.233],
        [0.731, 0.842]]) {'epoch': 3, 'valid/acc': 69.577, 'valid/acc_unbiased': 62.389, 'valid/diff': 35.07, 'valid/acc_skew': 44.854, 'valid/acc_align': 79.924, 'test/acc': 72.719, 'test/acc_unbiased': 64.864, 'test/diff': 33.307, 'test/acc_skew': 48.211, 'test/acc_align': 81.518}
[3 / 20] best valid accuracy: 62.389 at epoch 3 
 best_stats: {'best_valid_epoch': 3, 'best_valid_valid/acc': 69.577, 'best_valid_valid/acc_unbiased': 62.389, 'best_valid_valid/diff': 35.07, 'best_valid_valid/acc_skew': 44.854, 'best_valid_valid/acc_align': 79.924, 'best_valid_test/acc': 72.719, 'best_valid_test/acc_unbiased': 64.864, 'best_valid_test/diff': 33.307, 'best_valid_test/acc_skew': 48.211, 'best_valid_test/acc_align': 81.518}
[3 / 20] best test accuracy: 64.864 at epoch 3 
 best_stats: {'best_test_epoch': 3, 'best_test_valid/acc': 69.577, 'best_test_valid/acc_unbiased': 62.389, 'best_test_valid/diff': 35.07, 'best_test_valid/acc_skew': 44.854, 'best_test_valid/acc_align': 79.924, 'best_test_test/acc': 72.719, 'best_test_test/acc_unbiased': 64.864, 'best_test_test/diff': 33.307, 'best_test_test/acc_skew': 48.211, 'best_test_test/acc_align': 81.518}
[4 / 20] Learning rate: 0.001 weight: 0.01
[4 / 20] Loss: 2.843347237477123 CE Loss: 3.1609641766815497 Con Loss: 2.811737590949227
[4 / 20] tensor([[0.405, 0.045],
        [0.911, 0.958]]) {'epoch': 4, 'valid/acc': 61.817, 'valid/acc_unbiased': 58.336, 'valid/diff': 21.999, 'valid/acc_skew': 47.336, 'valid/acc_align': 69.335, 'test/acc': 61.084, 'test/acc_unbiased': 57.987, 'test/diff': 20.311, 'test/acc_skew': 47.832, 'test/acc_align': 68.143}
[4 / 20] best valid accuracy: 62.389 at epoch 3 
 best_stats: {'best_valid_epoch': 3, 'best_valid_valid/acc': 69.577, 'best_valid_valid/acc_unbiased': 62.389, 'best_valid_valid/diff': 35.07, 'best_valid_valid/acc_skew': 44.854, 'best_valid_valid/acc_align': 79.924, 'best_valid_test/acc': 72.719, 'best_valid_test/acc_unbiased': 64.864, 'best_valid_test/diff': 33.307, 'best_valid_test/acc_skew': 48.211, 'best_valid_test/acc_align': 81.518}
[4 / 20] best test accuracy: 64.864 at epoch 3 
 best_stats: {'best_test_epoch': 3, 'best_test_valid/acc': 69.577, 'best_test_valid/acc_unbiased': 62.389, 'best_test_valid/diff': 35.07, 'best_test_valid/acc_skew': 44.854, 'best_test_valid/acc_align': 79.924, 'best_test_test/acc': 72.719, 'best_test_test/acc_unbiased': 64.864, 'best_test_test/diff': 33.307, 'best_test_test/acc_skew': 48.211, 'best_test_test/acc_align': 81.518}
[5 / 20] Learning rate: 0.001 weight: 0.01
[5 / 20] Loss: 3.2069321091872593 CE Loss: 3.300724654994852 Con Loss: 3.1739248895985392
[5 / 20] tensor([[0.358, 0.028],
        [0.940, 0.988]]) {'epoch': 5, 'valid/acc': 61.067, 'valid/acc_unbiased': 58.4, 'valid/diff': 19.899, 'valid/acc_skew': 48.451, 'valid/acc_align': 68.35, 'test/acc': 60.071, 'test/acc_unbiased': 57.862, 'test/diff': 18.88, 'test/acc_skew': 48.422, 'test/acc_align': 67.302}
[5 / 20] best valid accuracy: 62.389 at epoch 3 
 best_stats: {'best_valid_epoch': 3, 'best_valid_valid/acc': 69.577, 'best_valid_valid/acc_unbiased': 62.389, 'best_valid_valid/diff': 35.07, 'best_valid_valid/acc_skew': 44.854, 'best_valid_valid/acc_align': 79.924, 'best_valid_test/acc': 72.719, 'best_valid_test/acc_unbiased': 64.864, 'best_valid_test/diff': 33.307, 'best_valid_test/acc_skew': 48.211, 'best_valid_test/acc_align': 81.518}
[5 / 20] best test accuracy: 64.864 at epoch 3 
 best_stats: {'best_test_epoch': 3, 'best_test_valid/acc': 69.577, 'best_test_valid/acc_unbiased': 62.389, 'best_test_valid/diff': 35.07, 'best_test_valid/acc_skew': 44.854, 'best_test_valid/acc_align': 79.924, 'best_test_test/acc': 72.719, 'best_test_test/acc_unbiased': 64.864, 'best_test_test/diff': 33.307, 'best_test_test/acc_skew': 48.211, 'best_test_test/acc_align': 81.518}
[6 / 20] Learning rate: 0.001 weight: 0.01
[6 / 20] Loss: 2.6921553997332413 CE Loss: 3.1329167449146236 Con Loss: 2.6608262436591645
[6 / 20] tensor([[0.450, 0.040],
        [0.865, 0.939]]) {'epoch': 6, 'valid/acc': 61.332, 'valid/acc_unbiased': 58.186, 'valid/diff': 26.977, 'valid/acc_skew': 44.698, 'valid/acc_align': 71.675, 'test/acc': 61.216, 'test/acc_unbiased': 57.345, 'test/diff': 24.207, 'test/acc_skew': 45.241, 'test/acc_align': 69.448}
[6 / 20] best valid accuracy: 62.389 at epoch 3 
 best_stats: {'best_valid_epoch': 3, 'best_valid_valid/acc': 69.577, 'best_valid_valid/acc_unbiased': 62.389, 'best_valid_valid/diff': 35.07, 'best_valid_valid/acc_skew': 44.854, 'best_valid_valid/acc_align': 79.924, 'best_valid_test/acc': 72.719, 'best_valid_test/acc_unbiased': 64.864, 'best_valid_test/diff': 33.307, 'best_valid_test/acc_skew': 48.211, 'best_valid_test/acc_align': 81.518}
[6 / 20] best test accuracy: 64.864 at epoch 3 
 best_stats: {'best_test_epoch': 3, 'best_test_valid/acc': 69.577, 'best_test_valid/acc_unbiased': 62.389, 'best_test_valid/diff': 35.07, 'best_test_valid/acc_skew': 44.854, 'best_test_valid/acc_align': 79.924, 'best_test_test/acc': 72.719, 'best_test_test/acc_unbiased': 64.864, 'best_test_test/diff': 33.307, 'best_test_test/acc_skew': 48.211, 'best_test_test/acc_align': 81.518}
[7 / 20] Learning rate: 0.0001 weight: 0.01
[7 / 20] Loss: 2.7859939502648987 CE Loss: 2.7497962639115516 Con Loss: 2.7584959880049196
[7 / 20] tensor([[0.714, 0.506],
        [0.640, 0.497]]) {'epoch': 7, 'valid/acc': 62.302, 'valid/acc_unbiased': 54.98, 'valid/diff': 21.178, 'valid/acc_skew': 53.929, 'valid/acc_align': 56.03, 'test/acc': 65.403, 'test/acc_unbiased': 58.93, 'test/diff': 17.595, 'test/acc_skew': 57.291, 'test/acc_align': 60.57}
[7 / 20] best valid accuracy: 62.389 at epoch 3 
 best_stats: {'best_valid_epoch': 3, 'best_valid_valid/acc': 69.577, 'best_valid_valid/acc_unbiased': 62.389, 'best_valid_valid/diff': 35.07, 'best_valid_valid/acc_skew': 44.854, 'best_valid_valid/acc_align': 79.924, 'best_valid_test/acc': 72.719, 'best_valid_test/acc_unbiased': 64.864, 'best_valid_test/diff': 33.307, 'best_valid_test/acc_skew': 48.211, 'best_valid_test/acc_align': 81.518}
[7 / 20] best test accuracy: 64.864 at epoch 3 
 best_stats: {'best_test_epoch': 3, 'best_test_valid/acc': 69.577, 'best_test_valid/acc_unbiased': 62.389, 'best_test_valid/diff': 35.07, 'best_test_valid/acc_skew': 44.854, 'best_test_valid/acc_align': 79.924, 'best_test_test/acc': 72.719, 'best_test_test/acc_unbiased': 64.864, 'best_test_test/diff': 33.307, 'best_test_test/acc_skew': 48.211, 'best_test_test/acc_align': 81.518}
[8 / 20] Learning rate: 0.0001 weight: 0.01
[8 / 20] Loss: 2.4535771481730766 CE Loss: 2.3712825434409637 Con Loss: 2.4298643232728607
[8 / 20] tensor([[0.760, 0.534],
        [0.648, 0.473]]) {'epoch': 8, 'valid/acc': 64.727, 'valid/acc_unbiased': 57.404, 'valid/diff': 20.916, 'valid/acc_skew': 56.832, 'valid/acc_align': 57.977, 'test/acc': 67.871, 'test/acc_unbiased': 60.367, 'test/diff': 20.053, 'test/acc_skew': 59.115, 'test/acc_align': 61.619}
[8 / 20] best valid accuracy: 62.389 at epoch 3 
 best_stats: {'best_valid_epoch': 3, 'best_valid_valid/acc': 69.577, 'best_valid_valid/acc_unbiased': 62.389, 'best_valid_valid/diff': 35.07, 'best_valid_valid/acc_skew': 44.854, 'best_valid_valid/acc_align': 79.924, 'best_valid_test/acc': 72.719, 'best_valid_test/acc_unbiased': 64.864, 'best_valid_test/diff': 33.307, 'best_valid_test/acc_skew': 48.211, 'best_valid_test/acc_align': 81.518}
[8 / 20] best test accuracy: 64.864 at epoch 3 
 best_stats: {'best_test_epoch': 3, 'best_test_valid/acc': 69.577, 'best_test_valid/acc_unbiased': 62.389, 'best_test_valid/diff': 35.07, 'best_test_valid/acc_skew': 44.854, 'best_test_valid/acc_align': 79.924, 'best_test_test/acc': 72.719, 'best_test_test/acc_unbiased': 64.864, 'best_test_test/diff': 33.307, 'best_test_test/acc_skew': 48.211, 'best_test_test/acc_align': 81.518}
[9 / 20] Learning rate: 0.0001 weight: 0.01
[9 / 20] Loss: 2.399498662477118 CE Loss: 2.1750396608212674 Con Loss: 2.3777482625298303
[9 / 20] tensor([[0.773, 0.392],
        [0.768, 0.721]]) {'epoch': 9, 'valid/acc': 71.076, 'valid/acc_unbiased': 61.832, 'valid/diff': 28.379, 'valid/acc_skew': 55.802, 'valid/acc_align': 67.863, 'test/acc': 73.777, 'test/acc_unbiased': 66.357, 'test/diff': 21.388, 'test/acc_skew': 58.011, 'test/acc_align': 74.703}
[9 / 20] best valid accuracy: 62.389 at epoch 3 
 best_stats: {'best_valid_epoch': 3, 'best_valid_valid/acc': 69.577, 'best_valid_valid/acc_unbiased': 62.389, 'best_valid_valid/diff': 35.07, 'best_valid_valid/acc_skew': 44.854, 'best_valid_valid/acc_align': 79.924, 'best_valid_test/acc': 72.719, 'best_valid_test/acc_unbiased': 64.864, 'best_valid_test/diff': 33.307, 'best_valid_test/acc_skew': 48.211, 'best_valid_test/acc_align': 81.518}
[9 / 20] best test accuracy: 66.357 at epoch 9 
 best_stats: {'best_test_epoch': 9, 'best_test_valid/acc': 71.076, 'best_test_valid/acc_unbiased': 61.832, 'best_test_valid/diff': 28.379, 'best_test_valid/acc_skew': 55.802, 'best_test_valid/acc_align': 67.863, 'best_test_test/acc': 73.777, 'best_test_test/acc_unbiased': 66.357, 'best_test_test/diff': 21.388, 'best_test_test/acc_skew': 58.011, 'best_test_test/acc_align': 74.703}
[10 / 20] Learning rate: 0.0001 weight: 0.01
[10 / 20] Loss: 2.7853943706166366 CE Loss: 2.463084403406468 Con Loss: 2.760763537652874
[10 / 20] tensor([[0.773, 0.386],
        [0.781, 0.697]]) {'epoch': 10, 'valid/acc': 69.18, 'valid/acc_unbiased': 59.108, 'valid/diff': 31.011, 'valid/acc_skew': 52.959, 'valid/acc_align': 65.257, 'test/acc': 74.041, 'test/acc_unbiased': 65.926, 'test/diff': 23.519, 'test/acc_skew': 58.361, 'test/acc_align': 73.491}
[10 / 20] best valid accuracy: 62.389 at epoch 3 
 best_stats: {'best_valid_epoch': 3, 'best_valid_valid/acc': 69.577, 'best_valid_valid/acc_unbiased': 62.389, 'best_valid_valid/diff': 35.07, 'best_valid_valid/acc_skew': 44.854, 'best_valid_valid/acc_align': 79.924, 'best_valid_test/acc': 72.719, 'best_valid_test/acc_unbiased': 64.864, 'best_valid_test/diff': 33.307, 'best_valid_test/acc_skew': 48.211, 'best_valid_test/acc_align': 81.518}
[10 / 20] best test accuracy: 66.357 at epoch 9 
 best_stats: {'best_test_epoch': 9, 'best_test_valid/acc': 71.076, 'best_test_valid/acc_unbiased': 61.832, 'best_test_valid/diff': 28.379, 'best_test_valid/acc_skew': 55.802, 'best_test_valid/acc_align': 67.863, 'best_test_test/acc': 73.777, 'best_test_test/acc_unbiased': 66.357, 'best_test_test/diff': 21.388, 'best_test_test/acc_skew': 58.011, 'best_test_test/acc_align': 74.703}
[11 / 20] Learning rate: 0.0001 weight: 0.01
[11 / 20] Loss: 2.5436686950356955 CE Loss: 2.2537867561635863 Con Loss: 2.5211308305295113
[11 / 20] tensor([[0.758, 0.256],
        [0.833, 0.842]]) {'epoch': 11, 'valid/acc': 71.649, 'valid/acc_unbiased': 61.99, 'valid/diff': 30.73, 'valid/acc_skew': 50.885, 'valid/acc_align': 73.095, 'test/acc': 75.364, 'test/acc_unbiased': 67.216, 'test/diff': 25.588, 'test/acc_skew': 54.422, 'test/acc_align': 80.01}
[11 / 20] best valid accuracy: 62.389 at epoch 3 
 best_stats: {'best_valid_epoch': 3, 'best_valid_valid/acc': 69.577, 'best_valid_valid/acc_unbiased': 62.389, 'best_valid_valid/diff': 35.07, 'best_valid_valid/acc_skew': 44.854, 'best_valid_valid/acc_align': 79.924, 'best_valid_test/acc': 72.719, 'best_valid_test/acc_unbiased': 64.864, 'best_valid_test/diff': 33.307, 'best_valid_test/acc_skew': 48.211, 'best_valid_test/acc_align': 81.518}
[11 / 20] best test accuracy: 67.216 at epoch 11 
 best_stats: {'best_test_epoch': 11, 'best_test_valid/acc': 71.649, 'best_test_valid/acc_unbiased': 61.99, 'best_test_valid/diff': 30.73, 'best_test_valid/acc_skew': 50.885, 'best_test_valid/acc_align': 73.095, 'best_test_test/acc': 75.364, 'best_test_test/acc_unbiased': 67.216, 'best_test_test/diff': 25.588, 'best_test_test/acc_skew': 54.422, 'best_test_test/acc_align': 80.01}
[12 / 20] Learning rate: 0.0001 weight: 0.01
[12 / 20] Loss: 2.294474767447733 CE Loss: 2.2183191227499743 Con Loss: 2.2722915710659204
[12 / 20] tensor([[0.802, 0.273],
        [0.829, 0.806]]) {'epoch': 12, 'valid/acc': 73.016, 'valid/acc_unbiased': 62.749, 'valid/diff': 31.646, 'valid/acc_skew': 51.116, 'valid/acc_align': 74.381, 'test/acc': 77.171, 'test/acc_unbiased': 67.754, 'test/diff': 27.629, 'test/acc_skew': 55.101, 'test/acc_align': 80.407}
[12 / 20] best valid accuracy: 62.749 at epoch 12 
 best_stats: {'best_valid_epoch': 12, 'best_valid_valid/acc': 73.016, 'best_valid_valid/acc_unbiased': 62.749, 'best_valid_valid/diff': 31.646, 'best_valid_valid/acc_skew': 51.116, 'best_valid_valid/acc_align': 74.381, 'best_valid_test/acc': 77.171, 'best_valid_test/acc_unbiased': 67.754, 'best_valid_test/diff': 27.629, 'best_valid_test/acc_skew': 55.101, 'best_valid_test/acc_align': 80.407}
[12 / 20] best test accuracy: 67.754 at epoch 12 
 best_stats: {'best_test_epoch': 12, 'best_test_valid/acc': 73.016, 'best_test_valid/acc_unbiased': 62.749, 'best_test_valid/diff': 31.646, 'best_test_valid/acc_skew': 51.116, 'best_test_valid/acc_align': 74.381, 'best_test_test/acc': 77.171, 'best_test_test/acc_unbiased': 67.754, 'best_test_test/diff': 27.629, 'best_test_test/acc_skew': 55.101, 'best_test_test/acc_align': 80.407}
[13 / 20] Learning rate: 0.0001 weight: 0.01
[13 / 20] Loss: 2.4655928257043938 CE Loss: 1.7410110828465764 Con Loss: 2.4481827116887502
[13 / 20] tensor([[0.741, 0.278],
        [0.873, 0.703]]) {'epoch': 13, 'valid/acc': 72.09, 'valid/acc_unbiased': 63.065, 'valid/diff': 29.22, 'valid/acc_skew': 54.657, 'valid/acc_align': 71.474, 'test/acc': 75.275, 'test/acc_unbiased': 64.884, 'test/diff': 31.625, 'test/acc_skew': 57.577, 'test/acc_align': 72.192}
[13 / 20] best valid accuracy: 63.065 at epoch 13 
 best_stats: {'best_valid_epoch': 13, 'best_valid_valid/acc': 72.09, 'best_valid_valid/acc_unbiased': 63.065, 'best_valid_valid/diff': 29.22, 'best_valid_valid/acc_skew': 54.657, 'best_valid_valid/acc_align': 71.474, 'best_valid_test/acc': 75.275, 'best_valid_test/acc_unbiased': 64.884, 'best_valid_test/diff': 31.625, 'best_valid_test/acc_skew': 57.577, 'best_valid_test/acc_align': 72.192}
[13 / 20] best test accuracy: 67.754 at epoch 12 
 best_stats: {'best_test_epoch': 12, 'best_test_valid/acc': 73.016, 'best_test_valid/acc_unbiased': 62.749, 'best_test_valid/diff': 31.646, 'best_test_valid/acc_skew': 51.116, 'best_test_valid/acc_align': 74.381, 'best_test_test/acc': 77.171, 'best_test_test/acc_unbiased': 67.754, 'best_test_test/diff': 27.629, 'best_test_test/acc_skew': 55.101, 'best_test_test/acc_align': 80.407}
[14 / 20] Learning rate: 1e-05 weight: 0.01
[14 / 20] Loss: 2.286754185040306 CE Loss: 1.7295652624056366 Con Loss: 2.269458538700924
[14 / 20] tensor([[0.773, 0.250],
        [0.849, 0.873]]) {'epoch': 14, 'valid/acc': 74.603, 'valid/acc_unbiased': 64.81, 'valid/diff': 30.942, 'valid/acc_skew': 51.758, 'valid/acc_align': 77.861, 'test/acc': 76.862, 'test/acc_unbiased': 68.612, 'test/diff': 27.334, 'test/acc_skew': 54.945, 'test/acc_align': 82.279}
[14 / 20] best valid accuracy: 64.810 at epoch 14 
 best_stats: {'best_valid_epoch': 14, 'best_valid_valid/acc': 74.603, 'best_valid_valid/acc_unbiased': 64.81, 'best_valid_valid/diff': 30.942, 'best_valid_valid/acc_skew': 51.758, 'best_valid_valid/acc_align': 77.861, 'best_valid_test/acc': 76.862, 'best_valid_test/acc_unbiased': 68.612, 'best_valid_test/diff': 27.334, 'best_valid_test/acc_skew': 54.945, 'best_valid_test/acc_align': 82.279}
[14 / 20] best test accuracy: 68.612 at epoch 14 
 best_stats: {'best_test_epoch': 14, 'best_test_valid/acc': 74.603, 'best_test_valid/acc_unbiased': 64.81, 'best_test_valid/diff': 30.942, 'best_test_valid/acc_skew': 51.758, 'best_test_valid/acc_align': 77.861, 'best_test_test/acc': 76.862, 'best_test_test/acc_unbiased': 68.612, 'best_test_test/diff': 27.334, 'best_test_test/acc_skew': 54.945, 'best_test_test/acc_align': 82.279}
[15 / 20] Learning rate: 1e-05 weight: 0.01
[15 / 20] Loss: 2.7075722871752688 CE Loss: 1.774581462843581 Con Loss: 2.6898264706317074
[15 / 20] tensor([[0.792, 0.301],
        [0.830, 0.848]]) {'epoch': 15, 'valid/acc': 74.339, 'valid/acc_unbiased': 64.461, 'valid/diff': 30.652, 'valid/acc_skew': 51.673, 'valid/acc_align': 77.25, 'test/acc': 77.259, 'test/acc_unbiased': 69.294, 'test/diff': 25.43, 'test/acc_skew': 56.579, 'test/acc_align': 82.01}
[15 / 20] best valid accuracy: 64.810 at epoch 14 
 best_stats: {'best_valid_epoch': 14, 'best_valid_valid/acc': 74.603, 'best_valid_valid/acc_unbiased': 64.81, 'best_valid_valid/diff': 30.942, 'best_valid_valid/acc_skew': 51.758, 'best_valid_valid/acc_align': 77.861, 'best_valid_test/acc': 76.862, 'best_valid_test/acc_unbiased': 68.612, 'best_valid_test/diff': 27.334, 'best_valid_test/acc_skew': 54.945, 'best_valid_test/acc_align': 82.279}
[15 / 20] best test accuracy: 69.294 at epoch 15 
 best_stats: {'best_test_epoch': 15, 'best_test_valid/acc': 74.339, 'best_test_valid/acc_unbiased': 64.461, 'best_test_valid/diff': 30.652, 'best_test_valid/acc_skew': 51.673, 'best_test_valid/acc_align': 77.25, 'best_test_test/acc': 77.259, 'best_test_test/acc_unbiased': 69.294, 'best_test_test/diff': 25.43, 'best_test_test/acc_skew': 56.579, 'best_test_test/acc_align': 82.01}
[16 / 20] Learning rate: 1e-05 weight: 0.01
[16 / 20] Loss: 2.6078621382620963 CE Loss: 1.6881624550386793 Con Loss: 2.5909805195533293
[16 / 20] tensor([[0.796, 0.290],
        [0.827, 0.861]]) {'epoch': 16, 'valid/acc': 75.0, 'valid/acc_unbiased': 65.062, 'valid/diff': 30.844, 'valid/acc_skew': 52.286, 'valid/acc_align': 77.837, 'test/acc': 77.347, 'test/acc_unbiased': 69.345, 'test/diff': 27.013, 'test/acc_skew': 55.838, 'test/acc_align': 82.851}
[16 / 20] best valid accuracy: 65.062 at epoch 16 
 best_stats: {'best_valid_epoch': 16, 'best_valid_valid/acc': 75.0, 'best_valid_valid/acc_unbiased': 65.062, 'best_valid_valid/diff': 30.844, 'best_valid_valid/acc_skew': 52.286, 'best_valid_valid/acc_align': 77.837, 'best_valid_test/acc': 77.347, 'best_valid_test/acc_unbiased': 69.345, 'best_valid_test/diff': 27.013, 'best_valid_test/acc_skew': 55.838, 'best_valid_test/acc_align': 82.851}
[16 / 20] best test accuracy: 69.345 at epoch 16 
 best_stats: {'best_test_epoch': 16, 'best_test_valid/acc': 75.0, 'best_test_valid/acc_unbiased': 65.062, 'best_test_valid/diff': 30.844, 'best_test_valid/acc_skew': 52.286, 'best_test_valid/acc_align': 77.837, 'best_test_test/acc': 77.347, 'best_test_test/acc_unbiased': 69.345, 'best_test_test/diff': 27.013, 'best_test_test/acc_skew': 55.838, 'best_test_test/acc_align': 82.851}
[17 / 20] Learning rate: 1e-05 weight: 0.01
[17 / 20] Loss: 2.3610280601499523 CE Loss: 1.6319168514675564 Con Loss: 2.3447088896073818
[17 / 20] tensor([[0.794, 0.284],
        [0.833, 0.836]]) {'epoch': 17, 'valid/acc': 74.383, 'valid/acc_unbiased': 64.274, 'valid/diff': 31.339, 'valid/acc_skew': 50.707, 'valid/acc_align': 77.842, 'test/acc': 77.215, 'test/acc_unbiased': 68.67, 'test/diff': 25.655, 'test/acc_skew': 55.842, 'test/acc_align': 81.498}
[17 / 20] best valid accuracy: 65.062 at epoch 16 
 best_stats: {'best_valid_epoch': 16, 'best_valid_valid/acc': 75.0, 'best_valid_valid/acc_unbiased': 65.062, 'best_valid_valid/diff': 30.844, 'best_valid_valid/acc_skew': 52.286, 'best_valid_valid/acc_align': 77.837, 'best_valid_test/acc': 77.347, 'best_valid_test/acc_unbiased': 69.345, 'best_valid_test/diff': 27.013, 'best_valid_test/acc_skew': 55.838, 'best_valid_test/acc_align': 82.851}
[17 / 20] best test accuracy: 69.345 at epoch 16 
 best_stats: {'best_test_epoch': 16, 'best_test_valid/acc': 75.0, 'best_test_valid/acc_unbiased': 65.062, 'best_test_valid/diff': 30.844, 'best_test_valid/acc_skew': 52.286, 'best_test_valid/acc_align': 77.837, 'best_test_test/acc': 77.347, 'best_test_test/acc_unbiased': 69.345, 'best_test_test/diff': 27.013, 'best_test_test/acc_skew': 55.838, 'best_test_test/acc_align': 82.851}
[18 / 20] Learning rate: 1e-05 weight: 0.01
[18 / 20] Loss: 2.597417844277517 CE Loss: 1.6165158258422556 Con Loss: 2.5812526897795944
[18 / 20] tensor([[0.819, 0.284],
        [0.817, 0.848]]) {'epoch': 18, 'valid/acc': 74.295, 'valid/acc_unbiased': 63.896, 'valid/diff': 31.484, 'valid/acc_skew': 50.324, 'valid/acc_align': 77.469, 'test/acc': 77.876, 'test/acc_unbiased': 69.206, 'test/diff': 28.341, 'test/acc_skew': 55.035, 'test/acc_align': 83.376}
[18 / 20] best valid accuracy: 65.062 at epoch 16 
 best_stats: {'best_valid_epoch': 16, 'best_valid_valid/acc': 75.0, 'best_valid_valid/acc_unbiased': 65.062, 'best_valid_valid/diff': 30.844, 'best_valid_valid/acc_skew': 52.286, 'best_valid_valid/acc_align': 77.837, 'best_valid_test/acc': 77.347, 'best_valid_test/acc_unbiased': 69.345, 'best_valid_test/diff': 27.013, 'best_valid_test/acc_skew': 55.838, 'best_valid_test/acc_align': 82.851}
[18 / 20] best test accuracy: 69.345 at epoch 16 
 best_stats: {'best_test_epoch': 16, 'best_test_valid/acc': 75.0, 'best_test_valid/acc_unbiased': 65.062, 'best_test_valid/diff': 30.844, 'best_test_valid/acc_skew': 52.286, 'best_test_valid/acc_align': 77.837, 'best_test_test/acc': 77.347, 'best_test_test/acc_unbiased': 69.345, 'best_test_test/diff': 27.013, 'best_test_test/acc_skew': 55.838, 'best_test_test/acc_align': 82.851}
[19 / 20] Learning rate: 1e-05 weight: 0.01
[19 / 20] Loss: 2.6924138892073635 CE Loss: 1.9928065036293443 Con Loss: 2.672485824170827
[19 / 20] tensor([[0.808, 0.318],
        [0.821, 0.830]]) {'epoch': 19, 'valid/acc': 73.765, 'valid/acc_unbiased': 63.115, 'valid/diff': 32.432, 'valid/acc_skew': 49.99, 'valid/acc_align': 76.241, 'test/acc': 77.655, 'test/acc_unbiased': 69.436, 'test/diff': 24.931, 'test/acc_skew': 56.97, 'test/acc_align': 81.902}
[19 / 20] best valid accuracy: 65.062 at epoch 16 
 best_stats: {'best_valid_epoch': 16, 'best_valid_valid/acc': 75.0, 'best_valid_valid/acc_unbiased': 65.062, 'best_valid_valid/diff': 30.844, 'best_valid_valid/acc_skew': 52.286, 'best_valid_valid/acc_align': 77.837, 'best_valid_test/acc': 77.347, 'best_valid_test/acc_unbiased': 69.345, 'best_valid_test/diff': 27.013, 'best_valid_test/acc_skew': 55.838, 'best_valid_test/acc_align': 82.851}
[19 / 20] best test accuracy: 69.436 at epoch 19 
 best_stats: {'best_test_epoch': 19, 'best_test_valid/acc': 73.765, 'best_test_valid/acc_unbiased': 63.115, 'best_test_valid/diff': 32.432, 'best_test_valid/acc_skew': 49.99, 'best_test_valid/acc_align': 76.241, 'best_test_test/acc': 77.655, 'best_test_test/acc_unbiased': 69.436, 'best_test_test/diff': 24.931, 'best_test_test/acc_skew': 56.97, 'best_test_test/acc_align': 81.902}
[20 / 20] Learning rate: 1e-05 weight: 0.01
[20 / 20] Loss: 2.449411217225801 CE Loss: 1.6869363402007918 Con Loss: 2.4325418521869437
[20 / 20] tensor([[0.806, 0.261],
        [0.830, 0.861]]) {'epoch': 20, 'valid/acc': 74.868, 'valid/acc_unbiased': 64.905, 'valid/diff': 30.583, 'valid/acc_skew': 50.744, 'valid/acc_align': 79.065, 'test/acc': 77.699, 'test/acc_unbiased': 68.957, 'test/diff': 28.732, 'test/acc_skew': 54.591, 'test/acc_align': 83.322}
[20 / 20] best valid accuracy: 65.062 at epoch 16 
 best_stats: {'best_valid_epoch': 16, 'best_valid_valid/acc': 75.0, 'best_valid_valid/acc_unbiased': 65.062, 'best_valid_valid/diff': 30.844, 'best_valid_valid/acc_skew': 52.286, 'best_valid_valid/acc_align': 77.837, 'best_valid_test/acc': 77.347, 'best_valid_test/acc_unbiased': 69.345, 'best_valid_test/diff': 27.013, 'best_valid_test/acc_skew': 55.838, 'best_valid_test/acc_align': 82.851}
[20 / 20] best test accuracy: 69.436 at epoch 19 
 best_stats: {'best_test_epoch': 19, 'best_test_valid/acc': 73.765, 'best_test_valid/acc_unbiased': 63.115, 'best_test_valid/diff': 32.432, 'best_test_valid/acc_skew': 49.99, 'best_test_valid/acc_align': 76.241, 'best_test_test/acc': 77.655, 'best_test_test/acc_unbiased': 69.436, 'best_test_test/diff': 24.931, 'best_test_test/acc_skew': 56.97, 'best_test_test/acc_align': 81.902}
Total training time: 0:48:12
