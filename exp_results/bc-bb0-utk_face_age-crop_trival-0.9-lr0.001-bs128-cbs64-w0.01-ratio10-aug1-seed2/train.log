Log level set to: INFO
Set seed: 2
=======> Using Fixed Random Seed: 2 <========
save_path: exp_results/bc-bb0-utk_face_age-crop_trival-0.9-lr0.001-bs128-cbs64-w0.01-ratio10-aug1-seed2
get_utk_face - split: train, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_age-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
Binary Target 1
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Normal Label Distribution: 
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
Binary Target 1
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Normal Label Distribution: 
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 10684, target_attr: gender, bias_attr: age bias_rate: 0.9
['[train] target_0-bias_0: 8237', '[train] target_0-bias_1: 147', '[train] target_1-bias_0: 823', '[train] target_1-bias_1: 1477']
confusion_matrix - 
 original: tensor([[8237.,  823.],
        [ 147., 1477.]]), 
 normalized: tensor([[0.909, 0.091],
        [0.091, 0.909]]), 
 b|y: tensor([[0.982, 0.018],
        [0.358, 0.642]])
get_utk_face - split: train, aug: 1, given_y: True, ratio: 10
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_age-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
Binary Target 1
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Normal Label Distribution: 
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
Binary Target 1
---------------------------
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Normal Label Distribution: 
Target 0: [8237, 147]
Target 1: [823, 1477]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 10684, target_attr: gender, bias_attr: age bias_rate: 0.9
['[train] target_0-bias_0: 8237', '[train] target_0-bias_1: 147', '[train] target_1-bias_0: 823', '[train] target_1-bias_1: 1477']
get_utk_face - split: valid, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_age-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [1030, 195]
Target 1: [841, 202]
Binary Target 1
---------------------------
Target 0: [1030, 195]
Target 1: [841, 202]
===================================
Normal Label Distribution: 
Target 0: [1030, 195]
Target 1: [841, 202]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 2268, target_attr: gender, bias_attr: age bias_rate: 0.9
['[valid] target_0-bias_0: 1030', '[valid] target_0-bias_1: 195', '[valid] target_1-bias_0: 841', '[valid] target_1-bias_1: 202']
get_utk_face - split: test, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_age-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [1061, 176]
Target 1: [867, 165]
Binary Target 1
---------------------------
Target 0: [1061, 176]
Target 1: [867, 165]
===================================
Normal Label Distribution: 
Target 0: [1061, 176]
Target 1: [867, 165]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 2269, target_attr: gender, bias_attr: age bias_rate: 0.9
['[test] target_0-bias_0: 1061', '[test] target_0-bias_1: 176', '[test] target_1-bias_0: 867', '[test] target_1-bias_1: 165']
decay_epochs: [6, 13]
[1 / 20] Learning rate: 0.001 weight: 0.01
[1 / 20] Loss: 4.81387350827913 CE Loss: 0.5677658682546112 Con Loss: 4.808195818947835
[1 / 20] tensor([[0.997, 1.000],
        [0.022, 0.006]]) {'epoch': 1, 'valid/acc': 55.511, 'valid/acc_unbiased': 50.918, 'valid/diff': 2.348, 'valid/acc_skew': 51.884, 'valid/acc_align': 49.951, 'test/acc': 55.267, 'test/acc_unbiased': 50.629, 'test/diff': 0.934, 'test/acc_skew': 51.096, 'test/acc_align': 50.162}
[1 / 20] best valid accuracy: 50.918 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 55.511, 'best_valid_valid/acc_unbiased': 50.918, 'best_valid_valid/diff': 2.348, 'best_valid_valid/acc_skew': 51.884, 'best_valid_valid/acc_align': 49.951, 'best_valid_test/acc': 55.267, 'best_valid_test/acc_unbiased': 50.629, 'best_valid_test/diff': 0.934, 'best_valid_test/acc_skew': 51.096, 'best_valid_test/acc_align': 50.162}
[1 / 20] best test accuracy: 50.629 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 55.511, 'best_test_valid/acc_unbiased': 50.918, 'best_test_valid/diff': 2.348, 'best_test_valid/acc_skew': 51.884, 'best_test_valid/acc_align': 49.951, 'best_test_test/acc': 55.267, 'best_test_test/acc_unbiased': 50.629, 'best_test_test/diff': 0.934, 'best_test_test/acc_skew': 51.096, 'best_test_test/acc_align': 50.162}
[2 / 20] Learning rate: 0.001 weight: 0.01
[2 / 20] Loss: 4.648682185301214 CE Loss: 0.5183201143019479 Con Loss: 4.643498981280168
[2 / 20] tensor([[0.921, 0.938],
        [0.428, 0.127]]) {'epoch': 2, 'valid/acc': 66.005, 'valid/acc_unbiased': 61.021, 'valid/diff': 13.734, 'valid/acc_skew': 67.888, 'valid/acc_align': 54.154, 'test/acc': 67.607, 'test/acc_unbiased': 60.338, 'test/diff': 15.866, 'test/acc_skew': 68.271, 'test/acc_align': 52.405}
[2 / 20] best valid accuracy: 61.021 at epoch 2 
 best_stats: {'best_valid_epoch': 2, 'best_valid_valid/acc': 66.005, 'best_valid_valid/acc_unbiased': 61.021, 'best_valid_valid/diff': 13.734, 'best_valid_valid/acc_skew': 67.888, 'best_valid_valid/acc_align': 54.154, 'best_valid_test/acc': 67.607, 'best_valid_test/acc_unbiased': 60.338, 'best_valid_test/diff': 15.866, 'best_valid_test/acc_skew': 68.271, 'best_valid_test/acc_align': 52.405}
[2 / 20] best test accuracy: 60.338 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 66.005, 'best_test_valid/acc_unbiased': 61.021, 'best_test_valid/diff': 13.734, 'best_test_valid/acc_skew': 67.888, 'best_test_valid/acc_align': 54.154, 'best_test_test/acc': 67.607, 'best_test_test/acc_unbiased': 60.338, 'best_test_test/diff': 15.866, 'best_test_test/acc_skew': 68.271, 'best_test_test/acc_align': 52.405}
[3 / 20] Learning rate: 0.001 weight: 0.01
[3 / 20] Loss: 4.6469609077750675 CE Loss: 0.49067915940900636 Con Loss: 4.642054102207471
[3 / 20] tensor([[0.861, 0.903],
        [0.611, 0.267]]) {'epoch': 3, 'valid/acc': 74.25, 'valid/acc_unbiased': 68.858, 'valid/diff': 16.839, 'valid/acc_skew': 77.277, 'valid/acc_align': 60.438, 'test/acc': 72.587, 'test/acc_unbiased': 66.071, 'test/diff': 19.33, 'test/acc_skew': 75.736, 'test/acc_align': 56.406}
[3 / 20] best valid accuracy: 68.858 at epoch 3 
 best_stats: {'best_valid_epoch': 3, 'best_valid_valid/acc': 74.25, 'best_valid_valid/acc_unbiased': 68.858, 'best_valid_valid/diff': 16.839, 'best_valid_valid/acc_skew': 77.277, 'best_valid_valid/acc_align': 60.438, 'best_valid_test/acc': 72.587, 'best_valid_test/acc_unbiased': 66.071, 'best_valid_test/diff': 19.33, 'best_valid_test/acc_skew': 75.736, 'best_valid_test/acc_align': 56.406}
[3 / 20] best test accuracy: 66.071 at epoch 3 
 best_stats: {'best_test_epoch': 3, 'best_test_valid/acc': 74.25, 'best_test_valid/acc_unbiased': 68.858, 'best_test_valid/diff': 16.839, 'best_test_valid/acc_skew': 77.277, 'best_test_valid/acc_align': 60.438, 'best_test_test/acc': 72.587, 'best_test_test/acc_unbiased': 66.071, 'best_test_test/diff': 19.33, 'best_test_test/acc_skew': 75.736, 'best_test_test/acc_align': 56.406}
[4 / 20] Learning rate: 0.001 weight: 0.01
[4 / 20] Loss: 4.580304629969624 CE Loss: 0.47466254897083693 Con Loss: 4.575557983309889
[4 / 20] tensor([[0.959, 0.943],
        [0.511, 0.261]]) {'epoch': 4, 'valid/acc': 71.384, 'valid/acc_unbiased': 66.131, 'valid/diff': 10.197, 'valid/acc_skew': 70.288, 'valid/acc_align': 61.973, 'test/acc': 73.601, 'test/acc_unbiased': 66.855, 'test/diff': 13.332, 'test/acc_skew': 72.707, 'test/acc_align': 61.004}
[4 / 20] best valid accuracy: 68.858 at epoch 3 
 best_stats: {'best_valid_epoch': 3, 'best_valid_valid/acc': 74.25, 'best_valid_valid/acc_unbiased': 68.858, 'best_valid_valid/diff': 16.839, 'best_valid_valid/acc_skew': 77.277, 'best_valid_valid/acc_align': 60.438, 'best_valid_test/acc': 72.587, 'best_valid_test/acc_unbiased': 66.071, 'best_valid_test/diff': 19.33, 'best_valid_test/acc_skew': 75.736, 'best_valid_test/acc_align': 56.406}
[4 / 20] best test accuracy: 66.855 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 71.384, 'best_test_valid/acc_unbiased': 66.131, 'best_test_valid/diff': 10.197, 'best_test_valid/acc_skew': 70.288, 'best_test_valid/acc_align': 61.973, 'best_test_test/acc': 73.601, 'best_test_test/acc_unbiased': 66.855, 'best_test_test/diff': 13.332, 'best_test_test/acc_skew': 72.707, 'best_test_test/acc_align': 61.004}
[5 / 20] Learning rate: 0.001 weight: 0.01
[5 / 20] Loss: 4.5809160937356035 CE Loss: 0.4752996822101532 Con Loss: 4.5761631091227475
[5 / 20] tensor([[0.942, 0.710],
        [0.670, 0.630]]) {'epoch': 5, 'valid/acc': 78.131, 'valid/acc_unbiased': 71.835, 'valid/diff': 16.258, 'valid/acc_skew': 63.706, 'valid/acc_align': 79.964, 'test/acc': 79.727, 'test/acc_unbiased': 73.806, 'test/diff': 13.558, 'test/acc_skew': 69.018, 'test/acc_align': 78.593}
[5 / 20] best valid accuracy: 71.835 at epoch 5 
 best_stats: {'best_valid_epoch': 5, 'best_valid_valid/acc': 78.131, 'best_valid_valid/acc_unbiased': 71.835, 'best_valid_valid/diff': 16.258, 'best_valid_valid/acc_skew': 63.706, 'best_valid_valid/acc_align': 79.964, 'best_valid_test/acc': 79.727, 'best_valid_test/acc_unbiased': 73.806, 'best_valid_test/diff': 13.558, 'best_valid_test/acc_skew': 69.018, 'best_valid_test/acc_align': 78.593}
[5 / 20] best test accuracy: 73.806 at epoch 5 
 best_stats: {'best_test_epoch': 5, 'best_test_valid/acc': 78.131, 'best_test_valid/acc_unbiased': 71.835, 'best_test_valid/diff': 16.258, 'best_test_valid/acc_skew': 63.706, 'best_test_valid/acc_align': 79.964, 'best_test_test/acc': 79.727, 'best_test_test/acc_unbiased': 73.806, 'best_test_test/diff': 13.558, 'best_test_test/acc_skew': 69.018, 'best_test_test/acc_align': 78.593}
[6 / 20] Learning rate: 0.001 weight: 0.01
[6 / 20] Loss: 4.5818788186747765 CE Loss: 0.44423955480332056 Con Loss: 4.577436431790505
[6 / 20] tensor([[0.915, 0.722],
        [0.700, 0.473]]) {'epoch': 6, 'valid/acc': 78.968, 'valid/acc_unbiased': 73.749, 'valid/diff': 13.149, 'valid/acc_skew': 72.766, 'valid/acc_align': 74.732, 'test/acc': 78.581, 'test/acc_unbiased': 70.24, 'test/diff': 21.049, 'test/acc_skew': 71.085, 'test/acc_align': 69.395}
[6 / 20] best valid accuracy: 73.749 at epoch 6 
 best_stats: {'best_valid_epoch': 6, 'best_valid_valid/acc': 78.968, 'best_valid_valid/acc_unbiased': 73.749, 'best_valid_valid/diff': 13.149, 'best_valid_valid/acc_skew': 72.766, 'best_valid_valid/acc_align': 74.732, 'best_valid_test/acc': 78.581, 'best_valid_test/acc_unbiased': 70.24, 'best_valid_test/diff': 21.049, 'best_valid_test/acc_skew': 71.085, 'best_valid_test/acc_align': 69.395}
[6 / 20] best test accuracy: 73.806 at epoch 5 
 best_stats: {'best_test_epoch': 5, 'best_test_valid/acc': 78.131, 'best_test_valid/acc_unbiased': 71.835, 'best_test_valid/diff': 16.258, 'best_test_valid/acc_skew': 63.706, 'best_test_valid/acc_align': 79.964, 'best_test_test/acc': 79.727, 'best_test_test/acc_unbiased': 73.806, 'best_test_test/diff': 13.558, 'best_test_test/acc_skew': 69.018, 'best_test_test/acc_align': 78.593}
[7 / 20] Learning rate: 0.0001 weight: 0.01
[7 / 20] Loss: 4.500055933123624 CE Loss: 0.423113911440202 Con Loss: 4.49582481277163
[7 / 20] tensor([[0.963, 0.858],
        [0.641, 0.430]]) {'epoch': 7, 'valid/acc': 78.704, 'valid/acc_unbiased': 73.579, 'valid/diff': 11.623, 'valid/acc_skew': 72.614, 'valid/acc_align': 74.543, 'test/acc': 79.33, 'test/acc_unbiased': 72.32, 'test/diff': 15.814, 'test/acc_skew': 74.962, 'test/acc_align': 69.677}
[7 / 20] best valid accuracy: 73.749 at epoch 6 
 best_stats: {'best_valid_epoch': 6, 'best_valid_valid/acc': 78.968, 'best_valid_valid/acc_unbiased': 73.749, 'best_valid_valid/diff': 13.149, 'best_valid_valid/acc_skew': 72.766, 'best_valid_valid/acc_align': 74.732, 'best_valid_test/acc': 78.581, 'best_valid_test/acc_unbiased': 70.24, 'best_valid_test/diff': 21.049, 'best_valid_test/acc_skew': 71.085, 'best_valid_test/acc_align': 69.395}
[7 / 20] best test accuracy: 73.806 at epoch 5 
 best_stats: {'best_test_epoch': 5, 'best_test_valid/acc': 78.131, 'best_test_valid/acc_unbiased': 71.835, 'best_test_valid/diff': 16.258, 'best_test_valid/acc_skew': 63.706, 'best_test_valid/acc_align': 79.964, 'best_test_test/acc': 79.727, 'best_test_test/acc_unbiased': 73.806, 'best_test_test/diff': 13.558, 'best_test_test/acc_skew': 69.018, 'best_test_test/acc_align': 78.593}
[8 / 20] Learning rate: 0.0001 weight: 0.01
[8 / 20] Loss: 4.47321653044746 CE Loss: 0.4142661928929715 Con Loss: 4.469073862227908
[8 / 20] tensor([[0.958, 0.739],
        [0.689, 0.521]]) {'epoch': 8, 'valid/acc': 79.277, 'valid/acc_unbiased': 72.825, 'valid/diff': 16.005, 'valid/acc_skew': 67.69, 'valid/acc_align': 77.96, 'test/acc': 80.608, 'test/acc_unbiased': 72.65, 'test/diff': 19.316, 'test/acc_skew': 71.361, 'test/acc_align': 73.94}
[8 / 20] best valid accuracy: 73.749 at epoch 6 
 best_stats: {'best_valid_epoch': 6, 'best_valid_valid/acc': 78.968, 'best_valid_valid/acc_unbiased': 73.749, 'best_valid_valid/diff': 13.149, 'best_valid_valid/acc_skew': 72.766, 'best_valid_valid/acc_align': 74.732, 'best_valid_test/acc': 78.581, 'best_valid_test/acc_unbiased': 70.24, 'best_valid_test/diff': 21.049, 'best_valid_test/acc_skew': 71.085, 'best_valid_test/acc_align': 69.395}
[8 / 20] best test accuracy: 73.806 at epoch 5 
 best_stats: {'best_test_epoch': 5, 'best_test_valid/acc': 78.131, 'best_test_valid/acc_unbiased': 71.835, 'best_test_valid/diff': 16.258, 'best_test_valid/acc_skew': 63.706, 'best_test_valid/acc_align': 79.964, 'best_test_test/acc': 79.727, 'best_test_test/acc_unbiased': 73.806, 'best_test_test/diff': 13.558, 'best_test_test/acc_skew': 69.018, 'best_test_test/acc_align': 78.593}
[9 / 20] Learning rate: 0.0001 weight: 0.01
[9 / 20] Loss: 4.414898830243864 CE Loss: 0.3975165473839086 Con Loss: 4.4109236679020025
[9 / 20] tensor([[0.969, 0.835],
        [0.632, 0.515]]) {'epoch': 9, 'valid/acc': 78.924, 'valid/acc_unbiased': 73.835, 'valid/diff': 11.358, 'valid/acc_skew': 69.418, 'valid/acc_align': 78.251, 'test/acc': 79.683, 'test/acc_unbiased': 73.784, 'test/diff': 12.529, 'test/acc_skew': 73.365, 'test/acc_align': 74.202}
[9 / 20] best valid accuracy: 73.835 at epoch 9 
 best_stats: {'best_valid_epoch': 9, 'best_valid_valid/acc': 78.924, 'best_valid_valid/acc_unbiased': 73.835, 'best_valid_valid/diff': 11.358, 'best_valid_valid/acc_skew': 69.418, 'best_valid_valid/acc_align': 78.251, 'best_valid_test/acc': 79.683, 'best_valid_test/acc_unbiased': 73.784, 'best_valid_test/diff': 12.529, 'best_valid_test/acc_skew': 73.365, 'best_valid_test/acc_align': 74.202}
[9 / 20] best test accuracy: 73.806 at epoch 5 
 best_stats: {'best_test_epoch': 5, 'best_test_valid/acc': 78.131, 'best_test_valid/acc_unbiased': 71.835, 'best_test_valid/diff': 16.258, 'best_test_valid/acc_skew': 63.706, 'best_test_valid/acc_align': 79.964, 'best_test_test/acc': 79.727, 'best_test_test/acc_unbiased': 73.806, 'best_test_test/diff': 13.558, 'best_test_test/acc_skew': 69.018, 'best_test_test/acc_align': 78.593}
[10 / 20] Learning rate: 0.0001 weight: 0.01
[10 / 20] Loss: 4.364155098812628 CE Loss: 0.3842946628714625 Con Loss: 4.360312162825607
[10 / 20] tensor([[0.965, 0.841],
        [0.699, 0.533]]) {'epoch': 10, 'valid/acc': 80.203, 'valid/acc_unbiased': 74.165, 'valid/diff': 15.078, 'valid/acc_skew': 70.811, 'valid/acc_align': 77.519, 'test/acc': 82.239, 'test/acc_unbiased': 75.958, 'test/diff': 14.492, 'test/acc_skew': 76.994, 'test/acc_align': 74.923}
[10 / 20] best valid accuracy: 74.165 at epoch 10 
 best_stats: {'best_valid_epoch': 10, 'best_valid_valid/acc': 80.203, 'best_valid_valid/acc_unbiased': 74.165, 'best_valid_valid/diff': 15.078, 'best_valid_valid/acc_skew': 70.811, 'best_valid_valid/acc_align': 77.519, 'best_valid_test/acc': 82.239, 'best_valid_test/acc_unbiased': 75.958, 'best_valid_test/diff': 14.492, 'best_valid_test/acc_skew': 76.994, 'best_valid_test/acc_align': 74.923}
[10 / 20] best test accuracy: 75.958 at epoch 10 
 best_stats: {'best_test_epoch': 10, 'best_test_valid/acc': 80.203, 'best_test_valid/acc_unbiased': 74.165, 'best_test_valid/diff': 15.078, 'best_test_valid/acc_skew': 70.811, 'best_test_valid/acc_align': 77.519, 'best_test_test/acc': 82.239, 'best_test_test/acc_unbiased': 75.958, 'best_test_test/diff': 14.492, 'best_test_test/acc_skew': 76.994, 'best_test_test/acc_align': 74.923}
[11 / 20] Learning rate: 0.0001 weight: 0.01
[11 / 20] Loss: 4.3623175994147525 CE Loss: 0.38547640292441876 Con Loss: 4.358462820692216
[11 / 20] tensor([[0.972, 0.807],
        [0.646, 0.545]]) {'epoch': 11, 'valid/acc': 79.012, 'valid/acc_unbiased': 73.765, 'valid/diff': 11.767, 'valid/acc_skew': 68.589, 'valid/acc_align': 78.941, 'test/acc': 80.344, 'test/acc_unbiased': 74.248, 'test/diff': 13.268, 'test/acc_skew': 72.636, 'test/acc_align': 75.859}
[11 / 20] best valid accuracy: 74.165 at epoch 10 
 best_stats: {'best_valid_epoch': 10, 'best_valid_valid/acc': 80.203, 'best_valid_valid/acc_unbiased': 74.165, 'best_valid_valid/diff': 15.078, 'best_valid_valid/acc_skew': 70.811, 'best_valid_valid/acc_align': 77.519, 'best_valid_test/acc': 82.239, 'best_valid_test/acc_unbiased': 75.958, 'best_valid_test/diff': 14.492, 'best_valid_test/acc_skew': 76.994, 'best_valid_test/acc_align': 74.923}
[11 / 20] best test accuracy: 75.958 at epoch 10 
 best_stats: {'best_test_epoch': 10, 'best_test_valid/acc': 80.203, 'best_test_valid/acc_unbiased': 74.165, 'best_test_valid/diff': 15.078, 'best_test_valid/acc_skew': 70.811, 'best_test_valid/acc_align': 77.519, 'best_test_test/acc': 82.239, 'best_test_test/acc_unbiased': 75.958, 'best_test_test/diff': 14.492, 'best_test_test/acc_skew': 76.994, 'best_test_test/acc_align': 74.923}
[12 / 20] Learning rate: 0.0001 weight: 0.01
[12 / 20] Loss: 4.407683299124264 CE Loss: 0.3765380669180171 Con Loss: 4.403917898537291
[12 / 20] tensor([[0.972, 0.790],
        [0.661, 0.600]]) {'epoch': 12, 'valid/acc': 80.247, 'valid/acc_unbiased': 75.409, 'valid/diff': 13.393, 'valid/acc_skew': 68.712, 'valid/acc_align': 82.105, 'test/acc': 81.181, 'test/acc_unbiased': 75.56, 'test/diff': 12.143, 'test/acc_skew': 72.534, 'test/acc_align': 78.586}
[12 / 20] best valid accuracy: 75.409 at epoch 12 
 best_stats: {'best_valid_epoch': 12, 'best_valid_valid/acc': 80.247, 'best_valid_valid/acc_unbiased': 75.409, 'best_valid_valid/diff': 13.393, 'best_valid_valid/acc_skew': 68.712, 'best_valid_valid/acc_align': 82.105, 'best_valid_test/acc': 81.181, 'best_valid_test/acc_unbiased': 75.56, 'best_valid_test/diff': 12.143, 'best_valid_test/acc_skew': 72.534, 'best_valid_test/acc_align': 78.586}
[12 / 20] best test accuracy: 75.958 at epoch 10 
 best_stats: {'best_test_epoch': 10, 'best_test_valid/acc': 80.203, 'best_test_valid/acc_unbiased': 74.165, 'best_test_valid/diff': 15.078, 'best_test_valid/acc_skew': 70.811, 'best_test_valid/acc_align': 77.519, 'best_test_test/acc': 82.239, 'best_test_test/acc_unbiased': 75.958, 'best_test_test/diff': 14.492, 'best_test_test/acc_skew': 76.994, 'best_test_test/acc_align': 74.923}
[13 / 20] Learning rate: 0.0001 weight: 0.01
[13 / 20] Loss: 4.35197435234067 CE Loss: 0.37820719113871204 Con Loss: 4.348192292980736
[13 / 20] tensor([[0.970, 0.722],
        [0.668, 0.667]]) {'epoch': 13, 'valid/acc': 79.189, 'valid/acc_unbiased': 73.151, 'valid/diff': 16.928, 'valid/acc_skew': 64.687, 'valid/acc_align': 81.615, 'test/acc': 81.313, 'test/acc_unbiased': 75.648, 'test/diff': 12.47, 'test/acc_skew': 69.471, 'test/acc_align': 81.825}
[13 / 20] best valid accuracy: 75.409 at epoch 12 
 best_stats: {'best_valid_epoch': 12, 'best_valid_valid/acc': 80.247, 'best_valid_valid/acc_unbiased': 75.409, 'best_valid_valid/diff': 13.393, 'best_valid_valid/acc_skew': 68.712, 'best_valid_valid/acc_align': 82.105, 'best_valid_test/acc': 81.181, 'best_valid_test/acc_unbiased': 75.56, 'best_valid_test/diff': 12.143, 'best_valid_test/acc_skew': 72.534, 'best_valid_test/acc_align': 78.586}
[13 / 20] best test accuracy: 75.958 at epoch 10 
 best_stats: {'best_test_epoch': 10, 'best_test_valid/acc': 80.203, 'best_test_valid/acc_unbiased': 74.165, 'best_test_valid/diff': 15.078, 'best_test_valid/acc_skew': 70.811, 'best_test_valid/acc_align': 77.519, 'best_test_test/acc': 82.239, 'best_test_test/acc_unbiased': 75.958, 'best_test_test/diff': 14.492, 'best_test_test/acc_skew': 76.994, 'best_test_test/acc_align': 74.923}
[14 / 20] Learning rate: 1e-05 weight: 0.01
[14 / 20] Loss: 4.349432516794265 CE Loss: 0.36814684215800586 Con Loss: 4.345751023837039
[14 / 20] tensor([[0.968, 0.784],
        [0.693, 0.600]]) {'epoch': 14, 'valid/acc': 79.894, 'valid/acc_unbiased': 73.783, 'valid/diff': 14.933, 'valid/acc_skew': 68.125, 'valid/acc_align': 79.441, 'test/acc': 82.195, 'test/acc_unbiased': 76.131, 'test/diff': 13.853, 'test/acc_skew': 73.864, 'test/acc_align': 78.398}
[14 / 20] best valid accuracy: 75.409 at epoch 12 
 best_stats: {'best_valid_epoch': 12, 'best_valid_valid/acc': 80.247, 'best_valid_valid/acc_unbiased': 75.409, 'best_valid_valid/diff': 13.393, 'best_valid_valid/acc_skew': 68.712, 'best_valid_valid/acc_align': 82.105, 'best_valid_test/acc': 81.181, 'best_valid_test/acc_unbiased': 75.56, 'best_valid_test/diff': 12.143, 'best_valid_test/acc_skew': 72.534, 'best_valid_test/acc_align': 78.586}
[14 / 20] best test accuracy: 76.131 at epoch 14 
 best_stats: {'best_test_epoch': 14, 'best_test_valid/acc': 79.894, 'best_test_valid/acc_unbiased': 73.783, 'best_test_valid/diff': 14.933, 'best_test_valid/acc_skew': 68.125, 'best_test_valid/acc_align': 79.441, 'best_test_test/acc': 82.195, 'best_test_test/acc_unbiased': 76.131, 'best_test_test/diff': 13.853, 'best_test_test/acc_skew': 73.864, 'best_test_test/acc_align': 78.398}
[15 / 20] Learning rate: 1e-05 weight: 0.01
[15 / 20] Loss: 4.333628846036054 CE Loss: 0.3769368564131911 Con Loss: 4.329859487575701
[15 / 20] tensor([[0.966, 0.767],
        [0.705, 0.642]]) {'epoch': 15, 'valid/acc': 80.423, 'valid/acc_unbiased': 74.02, 'valid/diff': 16.026, 'valid/acc_skew': 67.162, 'valid/acc_align': 80.877, 'test/acc': 82.724, 'test/acc_unbiased': 77.007, 'test/diff': 13.066, 'test/acc_skew': 73.589, 'test/acc_align': 80.425}
[15 / 20] best valid accuracy: 75.409 at epoch 12 
 best_stats: {'best_valid_epoch': 12, 'best_valid_valid/acc': 80.247, 'best_valid_valid/acc_unbiased': 75.409, 'best_valid_valid/diff': 13.393, 'best_valid_valid/acc_skew': 68.712, 'best_valid_valid/acc_align': 82.105, 'best_valid_test/acc': 81.181, 'best_valid_test/acc_unbiased': 75.56, 'best_valid_test/diff': 12.143, 'best_valid_test/acc_skew': 72.534, 'best_valid_test/acc_align': 78.586}
[15 / 20] best test accuracy: 77.007 at epoch 15 
 best_stats: {'best_test_epoch': 15, 'best_test_valid/acc': 80.423, 'best_test_valid/acc_unbiased': 74.02, 'best_test_valid/diff': 16.026, 'best_test_valid/acc_skew': 67.162, 'best_test_valid/acc_align': 80.877, 'best_test_test/acc': 82.724, 'best_test_test/acc_unbiased': 77.007, 'best_test_test/diff': 13.066, 'best_test_test/acc_skew': 73.589, 'best_test_test/acc_align': 80.425}
[16 / 20] Learning rate: 1e-05 weight: 0.01
[16 / 20] Loss: 4.305406180359995 CE Loss: 0.36845555290083276 Con Loss: 4.301721623219698
[16 / 20] tensor([[0.970, 0.778],
        [0.697, 0.618]]) {'epoch': 16, 'valid/acc': 79.982, 'valid/acc_unbiased': 73.917, 'valid/diff': 14.76, 'valid/acc_skew': 67.355, 'valid/acc_align': 80.479, 'test/acc': 82.503, 'test/acc_unbiased': 76.577, 'test/diff': 13.495, 'test/acc_skew': 73.753, 'test/acc_align': 79.401}
[16 / 20] best valid accuracy: 75.409 at epoch 12 
 best_stats: {'best_valid_epoch': 12, 'best_valid_valid/acc': 80.247, 'best_valid_valid/acc_unbiased': 75.409, 'best_valid_valid/diff': 13.393, 'best_valid_valid/acc_skew': 68.712, 'best_valid_valid/acc_align': 82.105, 'best_valid_test/acc': 81.181, 'best_valid_test/acc_unbiased': 75.56, 'best_valid_test/diff': 12.143, 'best_valid_test/acc_skew': 72.534, 'best_valid_test/acc_align': 78.586}
[16 / 20] best test accuracy: 77.007 at epoch 15 
 best_stats: {'best_test_epoch': 15, 'best_test_valid/acc': 80.423, 'best_test_valid/acc_unbiased': 74.02, 'best_test_valid/diff': 16.026, 'best_test_valid/acc_skew': 67.162, 'best_test_valid/acc_align': 80.877, 'best_test_test/acc': 82.724, 'best_test_test/acc_unbiased': 77.007, 'best_test_test/diff': 13.066, 'best_test_test/acc_skew': 73.589, 'best_test_test/acc_align': 80.425}
[17 / 20] Learning rate: 1e-05 weight: 0.01
[17 / 20] Loss: 4.355961836218968 CE Loss: 0.3750206401333832 Con Loss: 4.352211644434385
[17 / 20] tensor([[0.972, 0.801],
        [0.684, 0.624]]) {'epoch': 17, 'valid/acc': 79.541, 'valid/acc_unbiased': 73.722, 'valid/diff': 13.821, 'valid/acc_skew': 67.411, 'valid/acc_align': 80.033, 'test/acc': 82.327, 'test/acc_unbiased': 77.027, 'test/diff': 11.516, 'test/acc_skew': 74.255, 'test/acc_align': 79.798}
[17 / 20] best valid accuracy: 75.409 at epoch 12 
 best_stats: {'best_valid_epoch': 12, 'best_valid_valid/acc': 80.247, 'best_valid_valid/acc_unbiased': 75.409, 'best_valid_valid/diff': 13.393, 'best_valid_valid/acc_skew': 68.712, 'best_valid_valid/acc_align': 82.105, 'best_valid_test/acc': 81.181, 'best_valid_test/acc_unbiased': 75.56, 'best_valid_test/diff': 12.143, 'best_valid_test/acc_skew': 72.534, 'best_valid_test/acc_align': 78.586}
[17 / 20] best test accuracy: 77.027 at epoch 17 
 best_stats: {'best_test_epoch': 17, 'best_test_valid/acc': 79.541, 'best_test_valid/acc_unbiased': 73.722, 'best_test_valid/diff': 13.821, 'best_test_valid/acc_skew': 67.411, 'best_test_valid/acc_align': 80.033, 'best_test_test/acc': 82.327, 'best_test_test/acc_unbiased': 77.027, 'best_test_test/diff': 11.516, 'best_test_test/acc_skew': 74.255, 'best_test_test/acc_align': 79.798}
[18 / 20] Learning rate: 1e-05 weight: 0.01
[18 / 20] Loss: 4.313787586900546 CE Loss: 0.36660624713051504 Con Loss: 4.310121526971644
[18 / 20] tensor([[0.965, 0.756],
        [0.710, 0.655]]) {'epoch': 18, 'valid/acc': 80.864, 'valid/acc_unbiased': 74.666, 'valid/diff': 17.372, 'valid/acc_skew': 65.98, 'valid/acc_align': 83.352, 'test/acc': 82.9, 'test/acc_unbiased': 77.146, 'test/diff': 13.27, 'test/acc_skew': 73.309, 'test/acc_align': 80.984}
[18 / 20] best valid accuracy: 75.409 at epoch 12 
 best_stats: {'best_valid_epoch': 12, 'best_valid_valid/acc': 80.247, 'best_valid_valid/acc_unbiased': 75.409, 'best_valid_valid/diff': 13.393, 'best_valid_valid/acc_skew': 68.712, 'best_valid_valid/acc_align': 82.105, 'best_valid_test/acc': 81.181, 'best_valid_test/acc_unbiased': 75.56, 'best_valid_test/diff': 12.143, 'best_valid_test/acc_skew': 72.534, 'best_valid_test/acc_align': 78.586}
[18 / 20] best test accuracy: 77.146 at epoch 18 
 best_stats: {'best_test_epoch': 18, 'best_test_valid/acc': 80.864, 'best_test_valid/acc_unbiased': 74.666, 'best_test_valid/diff': 17.372, 'best_test_valid/acc_skew': 65.98, 'best_test_valid/acc_align': 83.352, 'best_test_test/acc': 82.9, 'best_test_test/acc_unbiased': 77.146, 'best_test_test/diff': 13.27, 'best_test_test/acc_skew': 73.309, 'best_test_test/acc_align': 80.984}
[19 / 20] Learning rate: 1e-05 weight: 0.01
[19 / 20] Loss: 4.310292192364132 CE Loss: 0.36134161780899005 Con Loss: 4.306678792145849
[19 / 20] tensor([[0.969, 0.761],
        [0.710, 0.661]]) {'epoch': 19, 'valid/acc': 81.085, 'valid/acc_unbiased': 74.908, 'valid/diff': 16.986, 'valid/acc_skew': 66.415, 'valid/acc_align': 83.401, 'test/acc': 83.164, 'test/acc_unbiased': 77.534, 'test/diff': 12.871, 'test/acc_skew': 73.593, 'test/acc_align': 81.475}
[19 / 20] best valid accuracy: 75.409 at epoch 12 
 best_stats: {'best_valid_epoch': 12, 'best_valid_valid/acc': 80.247, 'best_valid_valid/acc_unbiased': 75.409, 'best_valid_valid/diff': 13.393, 'best_valid_valid/acc_skew': 68.712, 'best_valid_valid/acc_align': 82.105, 'best_valid_test/acc': 81.181, 'best_valid_test/acc_unbiased': 75.56, 'best_valid_test/diff': 12.143, 'best_valid_test/acc_skew': 72.534, 'best_valid_test/acc_align': 78.586}
[19 / 20] best test accuracy: 77.534 at epoch 19 
 best_stats: {'best_test_epoch': 19, 'best_test_valid/acc': 81.085, 'best_test_valid/acc_unbiased': 74.908, 'best_test_valid/diff': 16.986, 'best_test_valid/acc_skew': 66.415, 'best_test_valid/acc_align': 83.401, 'best_test_test/acc': 83.164, 'best_test_test/acc_unbiased': 77.534, 'best_test_test/diff': 12.871, 'best_test_test/acc_skew': 73.593, 'best_test_test/acc_align': 81.475}
[20 / 20] Learning rate: 1e-05 weight: 0.01
[20 / 20] Loss: 4.289549913445647 CE Loss: 0.3613962461242333 Con Loss: 4.285935963195435
[20 / 20] tensor([[0.969, 0.756],
        [0.709, 0.655]]) {'epoch': 20, 'valid/acc': 80.6, 'valid/acc_unbiased': 74.2, 'valid/diff': 16.916, 'valid/acc_skew': 65.743, 'valid/acc_align': 82.658, 'test/acc': 83.032, 'test/acc_unbiased': 77.212, 'test/diff': 13.401, 'test/acc_skew': 73.251, 'test/acc_align': 81.172}
[20 / 20] best valid accuracy: 75.409 at epoch 12 
 best_stats: {'best_valid_epoch': 12, 'best_valid_valid/acc': 80.247, 'best_valid_valid/acc_unbiased': 75.409, 'best_valid_valid/diff': 13.393, 'best_valid_valid/acc_skew': 68.712, 'best_valid_valid/acc_align': 82.105, 'best_valid_test/acc': 81.181, 'best_valid_test/acc_unbiased': 75.56, 'best_valid_test/diff': 12.143, 'best_valid_test/acc_skew': 72.534, 'best_valid_test/acc_align': 78.586}
[20 / 20] best test accuracy: 77.534 at epoch 19 
 best_stats: {'best_test_epoch': 19, 'best_test_valid/acc': 81.085, 'best_test_valid/acc_unbiased': 74.908, 'best_test_valid/diff': 16.986, 'best_test_valid/acc_skew': 66.415, 'best_test_valid/acc_align': 83.401, 'best_test_test/acc': 83.164, 'best_test_test/acc_unbiased': 77.534, 'best_test_test/diff': 12.871, 'best_test_test/acc_skew': 73.593, 'best_test_test/acc_align': 81.475}
Total training time: 0:13:42
