Log level set to: INFO
Set seed: 1
=======> Using Fixed Random Seed: 1 <========
save_path: exp_results/bc-bb0-celeba_black-test-lr0.001-bs128-cbs64-w0.01-ratio30-aug1-seed1
get_celeba - split:train, aug: False, given_y: True, ratio: 0
get_celeba - split:train, aug: 1, given_y: True, ratio: 30
get_celeba - split:train_valid, aug: False, given_y: True, ratio: 0
get_celeba - split:valid, aug: False, given_y: True, ratio: 0
decay_epochs: [3, 6]
[1 / 10] Learning rate: 0.001 weight: 0.01
[1 / 10] Loss: 4.811001067866512 CE Loss: 0.3050853116859046 Con Loss: 4.807950210791151
[1 / 10] tensor([[0.939, 0.923],
        [0.756, 0.707]]) {'epoch': 1, 'valid/acc': 88.694, 'valid/acc_unbiased': 81.567, 'valid/diff': 2.07, 'valid/acc_skew': 82.004, 'valid/acc_align': 81.129, 'test/acc': 88.987, 'test/acc_unbiased': 83.119, 'test/diff': 3.23, 'test/acc_skew': 83.919, 'test/acc_align': 82.318}
[1 / 10] best valid accuracy: 81.567 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 88.694, 'best_valid_valid/acc_unbiased': 81.567, 'best_valid_valid/diff': 2.07, 'best_valid_valid/acc_skew': 82.004, 'best_valid_valid/acc_align': 81.129, 'best_valid_test/acc': 88.987, 'best_valid_test/acc_unbiased': 83.119, 'best_valid_test/diff': 3.23, 'best_valid_test/acc_skew': 83.919, 'best_valid_test/acc_align': 82.318}
[1 / 10] best test accuracy: 83.119 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 88.694, 'best_test_valid/acc_unbiased': 81.567, 'best_test_valid/diff': 2.07, 'best_test_valid/acc_skew': 82.004, 'best_test_valid/acc_align': 81.129, 'best_test_test/acc': 88.987, 'best_test_test/acc_unbiased': 83.119, 'best_test_test/diff': 3.23, 'best_test_test/acc_skew': 83.919, 'best_test_test/acc_align': 82.318}
[2 / 10] Learning rate: 0.001 weight: 0.01
[2 / 10] Loss: 4.796762955886658 CE Loss: 0.27603606911403394 Con Loss: 4.794002598205332
[2 / 10] tensor([[0.924, 0.878],
        [0.754, 0.721]]) {'epoch': 2, 'valid/acc': 86.902, 'valid/acc_unbiased': 80.589, 'valid/diff': 2.855, 'valid/acc_skew': 80.056, 'valid/acc_align': 81.122, 'test/acc': 87.029, 'test/acc_unbiased': 81.908, 'test/diff': 3.971, 'test/acc_skew': 81.614, 'test/acc_align': 82.202}
[2 / 10] best valid accuracy: 81.567 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 88.694, 'best_valid_valid/acc_unbiased': 81.567, 'best_valid_valid/diff': 2.07, 'best_valid_valid/acc_skew': 82.004, 'best_valid_valid/acc_align': 81.129, 'best_valid_test/acc': 88.987, 'best_valid_test/acc_unbiased': 83.119, 'best_valid_test/diff': 3.23, 'best_valid_test/acc_skew': 83.919, 'best_valid_test/acc_align': 82.318}
[2 / 10] best test accuracy: 83.119 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 88.694, 'best_test_valid/acc_unbiased': 81.567, 'best_test_valid/diff': 2.07, 'best_test_valid/acc_skew': 82.004, 'best_test_valid/acc_align': 81.129, 'best_test_test/acc': 88.987, 'best_test_test/acc_unbiased': 83.119, 'best_test_test/diff': 3.23, 'best_test_test/acc_skew': 83.919, 'best_test_test/acc_align': 82.318}
[3 / 10] Learning rate: 0.001 weight: 0.01
[3 / 10] Loss: 4.7890088641729065 CE Loss: 0.2684228797027553 Con Loss: 4.786324625182168
[3 / 10] tensor([[0.995, 0.981],
        [0.246, 0.357]]) {'epoch': 3, 'valid/acc': 85.976, 'valid/acc_unbiased': 64.28, 'valid/diff': 7.847, 'valid/acc_skew': 60.357, 'valid/acc_align': 68.204, 'test/acc': 84.854, 'test/acc_unbiased': 64.482, 'test/diff': 6.2, 'test/acc_skew': 61.382, 'test/acc_align': 67.581}
[3 / 10] best valid accuracy: 81.567 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 88.694, 'best_valid_valid/acc_unbiased': 81.567, 'best_valid_valid/diff': 2.07, 'best_valid_valid/acc_skew': 82.004, 'best_valid_valid/acc_align': 81.129, 'best_valid_test/acc': 88.987, 'best_valid_test/acc_unbiased': 83.119, 'best_valid_test/diff': 3.23, 'best_valid_test/acc_skew': 83.919, 'best_valid_test/acc_align': 82.318}
[3 / 10] best test accuracy: 83.119 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 88.694, 'best_test_valid/acc_unbiased': 81.567, 'best_test_valid/diff': 2.07, 'best_test_valid/acc_skew': 82.004, 'best_test_valid/acc_align': 81.129, 'best_test_test/acc': 88.987, 'best_test_test/acc_unbiased': 83.119, 'best_test_test/diff': 3.23, 'best_test_test/acc_skew': 83.919, 'best_test_test/acc_align': 82.318}
[4 / 10] Learning rate: 0.0001 weight: 0.01
[4 / 10] Loss: 4.764898460190122 CE Loss: 0.23859512765343616 Con Loss: 4.762512518646818
[4 / 10] tensor([[0.952, 0.929],
        [0.736, 0.727]]) {'epoch': 4, 'valid/acc': 90.223, 'valid/acc_unbiased': 83.252, 'valid/diff': 1.511, 'valid/acc_skew': 82.856, 'valid/acc_align': 83.648, 'test/acc': 89.883, 'test/acc_unbiased': 83.593, 'test/diff': 1.582, 'test/acc_skew': 83.216, 'test/acc_align': 83.97}
[4 / 10] best valid accuracy: 83.252 at epoch 4 
 best_stats: {'best_valid_epoch': 4, 'best_valid_valid/acc': 90.223, 'best_valid_valid/acc_unbiased': 83.252, 'best_valid_valid/diff': 1.511, 'best_valid_valid/acc_skew': 82.856, 'best_valid_valid/acc_align': 83.648, 'best_valid_test/acc': 89.883, 'best_valid_test/acc_unbiased': 83.593, 'best_valid_test/diff': 1.582, 'best_valid_test/acc_skew': 83.216, 'best_valid_test/acc_align': 83.97}
[4 / 10] best test accuracy: 83.593 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 90.223, 'best_test_valid/acc_unbiased': 83.252, 'best_test_valid/diff': 1.511, 'best_test_valid/acc_skew': 82.856, 'best_test_valid/acc_align': 83.648, 'best_test_test/acc': 89.883, 'best_test_test/acc_unbiased': 83.593, 'best_test_test/diff': 1.582, 'best_test_test/acc_skew': 83.216, 'best_test_test/acc_align': 83.97}
[5 / 10] Learning rate: 0.0001 weight: 0.01
[5 / 10] Loss: 4.7581915879251895 CE Loss: 0.23205551501992158 Con Loss: 4.755871031552734
[5 / 10] tensor([[0.948, 0.910],
        [0.791, 0.778]]) {'epoch': 5, 'valid/acc': 90.46, 'valid/acc_unbiased': 85.169, 'valid/diff': 1.946, 'valid/acc_skew': 84.328, 'valid/acc_align': 86.011, 'test/acc': 90.2, 'test/acc_unbiased': 85.658, 'test/diff': 2.595, 'test/acc_skew': 85.038, 'test/acc_align': 86.278}
[5 / 10] best valid accuracy: 85.169 at epoch 5 
 best_stats: {'best_valid_epoch': 5, 'best_valid_valid/acc': 90.46, 'best_valid_valid/acc_unbiased': 85.169, 'best_valid_valid/diff': 1.946, 'best_valid_valid/acc_skew': 84.328, 'best_valid_valid/acc_align': 86.011, 'best_valid_test/acc': 90.2, 'best_valid_test/acc_unbiased': 85.658, 'best_valid_test/diff': 2.595, 'best_valid_test/acc_skew': 85.038, 'best_valid_test/acc_align': 86.278}
[5 / 10] best test accuracy: 85.658 at epoch 5 
 best_stats: {'best_test_epoch': 5, 'best_test_valid/acc': 90.46, 'best_test_valid/acc_unbiased': 85.169, 'best_test_valid/diff': 1.946, 'best_test_valid/acc_skew': 84.328, 'best_test_valid/acc_align': 86.011, 'best_test_test/acc': 90.2, 'best_test_test/acc_unbiased': 85.658, 'best_test_test/diff': 2.595, 'best_test_test/acc_skew': 85.038, 'best_test_test/acc_align': 86.278}
[6 / 10] Learning rate: 0.0001 weight: 0.01
[6 / 10] Loss: 4.753325372925632 CE Loss: 0.22773785037861152 Con Loss: 4.751047994214366
[6 / 10] tensor([[0.952, 0.929],
        [0.788, 0.763]]) {'epoch': 6, 'valid/acc': 90.71, 'valid/acc_unbiased': 85.008, 'valid/diff': 2.699, 'valid/acc_skew': 85.255, 'valid/acc_align': 84.762, 'test/acc': 90.754, 'test/acc_unbiased': 85.774, 'test/diff': 2.389, 'test/acc_skew': 85.82, 'test/acc_align': 85.729}
[6 / 10] best valid accuracy: 85.169 at epoch 5 
 best_stats: {'best_valid_epoch': 5, 'best_valid_valid/acc': 90.46, 'best_valid_valid/acc_unbiased': 85.169, 'best_valid_valid/diff': 1.946, 'best_valid_valid/acc_skew': 84.328, 'best_valid_valid/acc_align': 86.011, 'best_valid_test/acc': 90.2, 'best_valid_test/acc_unbiased': 85.658, 'best_valid_test/diff': 2.595, 'best_valid_test/acc_skew': 85.038, 'best_valid_test/acc_align': 86.278}
[6 / 10] best test accuracy: 85.774 at epoch 6 
 best_stats: {'best_test_epoch': 6, 'best_test_valid/acc': 90.71, 'best_test_valid/acc_unbiased': 85.008, 'best_test_valid/diff': 2.699, 'best_test_valid/acc_skew': 85.255, 'best_test_valid/acc_align': 84.762, 'best_test_test/acc': 90.754, 'best_test_test/acc_unbiased': 85.774, 'best_test_test/diff': 2.389, 'best_test_test/acc_skew': 85.82, 'best_test_test/acc_align': 85.729}
[7 / 10] Learning rate: 1e-05 weight: 0.01
[7 / 10] Loss: 4.747553775042424 CE Loss: 0.22338458735044736 Con Loss: 4.745319925554659
[7 / 10] tensor([[0.961, 0.937],
        [0.749, 0.742]]) {'epoch': 7, 'valid/acc': 90.944, 'valid/acc_unbiased': 83.896, 'valid/diff': 1.276, 'valid/acc_skew': 83.374, 'valid/acc_align': 84.419, 'test/acc': 90.884, 'test/acc_unbiased': 84.738, 'test/diff': 1.531, 'test/acc_skew': 84.307, 'test/acc_align': 85.17}
[7 / 10] best valid accuracy: 85.169 at epoch 5 
 best_stats: {'best_valid_epoch': 5, 'best_valid_valid/acc': 90.46, 'best_valid_valid/acc_unbiased': 85.169, 'best_valid_valid/diff': 1.946, 'best_valid_valid/acc_skew': 84.328, 'best_valid_valid/acc_align': 86.011, 'best_valid_test/acc': 90.2, 'best_valid_test/acc_unbiased': 85.658, 'best_valid_test/diff': 2.595, 'best_valid_test/acc_skew': 85.038, 'best_valid_test/acc_align': 86.278}
[7 / 10] best test accuracy: 85.774 at epoch 6 
 best_stats: {'best_test_epoch': 6, 'best_test_valid/acc': 90.71, 'best_test_valid/acc_unbiased': 85.008, 'best_test_valid/diff': 2.699, 'best_test_valid/acc_skew': 85.255, 'best_test_valid/acc_align': 84.762, 'best_test_test/acc': 90.754, 'best_test_test/acc_unbiased': 85.774, 'best_test_test/diff': 2.389, 'best_test_test/acc_skew': 85.82, 'best_test_test/acc_align': 85.729}
[8 / 10] Learning rate: 1e-05 weight: 0.01
[8 / 10] Loss: 4.7456752615640445 CE Loss: 0.2218339650740185 Con Loss: 4.74345691794679
[8 / 10] tensor([[0.954, 0.929],
        [0.779, 0.766]]) {'epoch': 8, 'valid/acc': 90.973, 'valid/acc_unbiased': 85.233, 'valid/diff': 2.108, 'valid/acc_skew': 85.026, 'valid/acc_align': 85.44, 'test/acc': 90.834, 'test/acc_unbiased': 85.691, 'test/diff': 1.957, 'test/acc_skew': 85.389, 'test/acc_align': 85.992}
[8 / 10] best valid accuracy: 85.233 at epoch 8 
 best_stats: {'best_valid_epoch': 8, 'best_valid_valid/acc': 90.973, 'best_valid_valid/acc_unbiased': 85.233, 'best_valid_valid/diff': 2.108, 'best_valid_valid/acc_skew': 85.026, 'best_valid_valid/acc_align': 85.44, 'best_valid_test/acc': 90.834, 'best_valid_test/acc_unbiased': 85.691, 'best_valid_test/diff': 1.957, 'best_valid_test/acc_skew': 85.389, 'best_valid_test/acc_align': 85.992}
[8 / 10] best test accuracy: 85.774 at epoch 6 
 best_stats: {'best_test_epoch': 6, 'best_test_valid/acc': 90.71, 'best_test_valid/acc_unbiased': 85.008, 'best_test_valid/diff': 2.699, 'best_test_valid/acc_skew': 85.255, 'best_test_valid/acc_align': 84.762, 'best_test_test/acc': 90.754, 'best_test_test/acc_unbiased': 85.774, 'best_test_test/diff': 2.389, 'best_test_test/acc_skew': 85.82, 'best_test_test/acc_align': 85.729}
[9 / 10] Learning rate: 1e-05 weight: 0.01
[9 / 10] Loss: 4.746017198088525 CE Loss: 0.22118548670529073 Con Loss: 4.743805346281632
[9 / 10] tensor([[0.955, 0.931],
        [0.766, 0.759]]) {'epoch': 9, 'valid/acc': 90.977, 'valid/acc_unbiased': 84.903, 'valid/diff': 2.127, 'valid/acc_skew': 84.788, 'valid/acc_align': 85.018, 'test/acc': 90.779, 'test/acc_unbiased': 85.296, 'test/diff': 1.601, 'test/acc_skew': 84.881, 'test/acc_align': 85.712}
[9 / 10] best valid accuracy: 85.233 at epoch 8 
 best_stats: {'best_valid_epoch': 8, 'best_valid_valid/acc': 90.973, 'best_valid_valid/acc_unbiased': 85.233, 'best_valid_valid/diff': 2.108, 'best_valid_valid/acc_skew': 85.026, 'best_valid_valid/acc_align': 85.44, 'best_valid_test/acc': 90.834, 'best_valid_test/acc_unbiased': 85.691, 'best_valid_test/diff': 1.957, 'best_valid_test/acc_skew': 85.389, 'best_valid_test/acc_align': 85.992}
[9 / 10] best test accuracy: 85.774 at epoch 6 
 best_stats: {'best_test_epoch': 6, 'best_test_valid/acc': 90.71, 'best_test_valid/acc_unbiased': 85.008, 'best_test_valid/diff': 2.699, 'best_test_valid/acc_skew': 85.255, 'best_test_valid/acc_align': 84.762, 'best_test_test/acc': 90.754, 'best_test_test/acc_unbiased': 85.774, 'best_test_test/diff': 2.389, 'best_test_test/acc_skew': 85.82, 'best_test_test/acc_align': 85.729}
[10 / 10] Learning rate: 1e-05 weight: 0.01
[10 / 10] Loss: 4.745385841831401 CE Loss: 0.22020513431990762 Con Loss: 4.74318378577121
[10 / 10] tensor([[0.967, 0.942],
        [0.726, 0.723]]) {'epoch': 10, 'valid/acc': 91.133, 'valid/acc_unbiased': 83.634, 'valid/diff': 1.623, 'valid/acc_skew': 83.513, 'valid/acc_align': 83.755, 'test/acc': 90.894, 'test/acc_unbiased': 83.951, 'test/diff': 1.407, 'test/acc_skew': 83.42, 'test/acc_align': 84.482}
[10 / 10] best valid accuracy: 85.233 at epoch 8 
 best_stats: {'best_valid_epoch': 8, 'best_valid_valid/acc': 90.973, 'best_valid_valid/acc_unbiased': 85.233, 'best_valid_valid/diff': 2.108, 'best_valid_valid/acc_skew': 85.026, 'best_valid_valid/acc_align': 85.44, 'best_valid_test/acc': 90.834, 'best_valid_test/acc_unbiased': 85.691, 'best_valid_test/diff': 1.957, 'best_valid_test/acc_skew': 85.389, 'best_valid_test/acc_align': 85.992}
[10 / 10] best test accuracy: 85.774 at epoch 6 
 best_stats: {'best_test_epoch': 6, 'best_test_valid/acc': 90.71, 'best_test_valid/acc_unbiased': 85.008, 'best_test_valid/diff': 2.699, 'best_test_valid/acc_skew': 85.255, 'best_test_valid/acc_align': 84.762, 'best_test_test/acc': 90.754, 'best_test_test/acc_unbiased': 85.774, 'best_test_test/diff': 2.389, 'best_test_test/acc_skew': 85.82, 'best_test_test/acc_align': 85.729}
Total training time: 1:36:39
