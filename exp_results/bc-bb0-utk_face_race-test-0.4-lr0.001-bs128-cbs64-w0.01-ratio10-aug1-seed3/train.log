Log level set to: INFO
Set seed: 3
=======> Using Fixed Random Seed: 3 <========
save_path: exp_results/bc-bb0-utk_face_race-test-0.4-lr0.001-bs128-cbs64-w0.01-ratio10-aug1-seed3
get_utk_face - split: train, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_race-0.4
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [4407, 3317]
Target 1: [2644, 5529]
Binary Target 1
---------------------------
Target 0: [4407, 3317]
Target 1: [2644, 5529]
===================================
Normal Label Distribution: 
Target 0: [4407, 3317]
Target 1: [2644, 5529]
===================================
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [4407, 3317]
Target 1: [2644, 5529]
Binary Target 1
---------------------------
Target 0: [4407, 3317]
Target 1: [2644, 5529]
===================================
Normal Label Distribution: 
Target 0: [4407, 3317]
Target 1: [2644, 5529]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 15897, target_attr: gender, bias_attr: race bias_rate: 0.4
['[train] target_0-bias_0: 4407', '[train] target_0-bias_1: 3317', '[train] target_1-bias_0: 2644', '[train] target_1-bias_1: 5529']
confusion_matrix - 
 original: tensor([[4407., 2644.],
        [3317., 5529.]]), 
 normalized: tensor([[0.625, 0.375],
        [0.375, 0.625]]), 
 b|y: tensor([[0.571, 0.429],
        [0.324, 0.676]])
get_utk_face - split: train, aug: 1, given_y: True, ratio: 10
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_race-0.4
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [4407, 3317]
Target 1: [2644, 5529]
Binary Target 1
---------------------------
Target 0: [4407, 3317]
Target 1: [2644, 5529]
===================================
Normal Label Distribution: 
Target 0: [4407, 3317]
Target 1: [2644, 5529]
===================================
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [4407, 3317]
Target 1: [2644, 5529]
Binary Target 1
---------------------------
Target 0: [4407, 3317]
Target 1: [2644, 5529]
===================================
Normal Label Distribution: 
Target 0: [4407, 3317]
Target 1: [2644, 5529]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 15897, target_attr: gender, bias_attr: race bias_rate: 0.4
['[train] target_0-bias_0: 4407', '[train] target_0-bias_1: 3317', '[train] target_1-bias_0: 2644', '[train] target_1-bias_1: 5529']
get_utk_face - split: valid, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_race-0.4
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [583, 684]
Target 1: [457, 646]
Binary Target 1
---------------------------
Target 0: [583, 684]
Target 1: [457, 646]
===================================
Normal Label Distribution: 
Target 0: [583, 684]
Target 1: [457, 646]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 2370, target_attr: gender, bias_attr: race bias_rate: 0.4
['[valid] target_0-bias_0: 583', '[valid] target_0-bias_1: 684', '[valid] target_1-bias_0: 457', '[valid] target_1-bias_1: 646']
get_utk_face - split: test, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_race-0.4
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [558, 677]
Target 1: [462, 673]
Binary Target 1
---------------------------
Target 0: [558, 677]
Target 1: [462, 673]
===================================
Normal Label Distribution: 
Target 0: [558, 677]
Target 1: [462, 673]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 2370, target_attr: gender, bias_attr: race bias_rate: 0.4
['[test] target_0-bias_0: 558', '[test] target_0-bias_1: 677', '[test] target_1-bias_0: 462', '[test] target_1-bias_1: 673']
decay_epochs: [6, 13]
[1 / 20] Learning rate: 0.001 weight: 0.01
[1 / 20] Loss: 4.865473908388803 CE Loss: 0.5767258794613512 Con Loss: 4.859706643498033
[1 / 20] tensor([[0.509, 0.536],
        [0.955, 0.976]]) {'epoch': 1, 'valid/acc': 72.363, 'valid/acc_unbiased': 73.921, 'valid/diff': 4.064, 'valid/acc_skew': 75.953, 'valid/acc_align': 71.888, 'test/acc': 73.629, 'test/acc_unbiased': 74.398, 'test/diff': 2.445, 'test/acc_skew': 74.537, 'test/acc_align': 74.259}
[1 / 20] best valid accuracy: 73.921 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 72.363, 'best_valid_valid/acc_unbiased': 73.921, 'best_valid_valid/diff': 4.064, 'best_valid_valid/acc_skew': 75.953, 'best_valid_valid/acc_align': 71.888, 'best_valid_test/acc': 73.629, 'best_valid_test/acc_unbiased': 74.398, 'best_valid_test/diff': 2.445, 'best_valid_test/acc_skew': 74.537, 'best_valid_test/acc_align': 74.259}
[1 / 20] best test accuracy: 74.398 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 72.363, 'best_test_valid/acc_unbiased': 73.921, 'best_test_valid/diff': 4.064, 'best_test_valid/acc_skew': 75.953, 'best_test_valid/acc_align': 71.888, 'best_test_test/acc': 73.629, 'best_test_test/acc_unbiased': 74.398, 'best_test_test/diff': 2.445, 'best_test_test/acc_skew': 74.537, 'best_test_test/acc_align': 74.259}
[2 / 20] Learning rate: 0.001 weight: 0.01
[2 / 20] Loss: 4.757461128545616 CE Loss: 0.44279339066682283 Con Loss: 4.753033183449926
[2 / 20] tensor([[0.758, 0.710],
        [0.905, 0.932]]) {'epoch': 2, 'valid/acc': 81.519, 'valid/acc_unbiased': 82.216, 'valid/diff': 1.773, 'valid/acc_skew': 81.442, 'valid/acc_align': 82.989, 'test/acc': 82.236, 'test/acc_unbiased': 82.624, 'test/diff': 3.723, 'test/acc_skew': 80.762, 'test/acc_align': 84.486}
[2 / 20] best valid accuracy: 82.216 at epoch 2 
 best_stats: {'best_valid_epoch': 2, 'best_valid_valid/acc': 81.519, 'best_valid_valid/acc_unbiased': 82.216, 'best_valid_valid/diff': 1.773, 'best_valid_valid/acc_skew': 81.442, 'best_valid_valid/acc_align': 82.989, 'best_valid_test/acc': 82.236, 'best_valid_test/acc_unbiased': 82.624, 'best_valid_test/diff': 3.723, 'best_valid_test/acc_skew': 80.762, 'best_valid_test/acc_align': 84.486}
[2 / 20] best test accuracy: 82.624 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 81.519, 'best_test_valid/acc_unbiased': 82.216, 'best_test_valid/diff': 1.773, 'best_test_valid/acc_skew': 81.442, 'best_test_valid/acc_align': 82.989, 'best_test_test/acc': 82.236, 'best_test_test/acc_unbiased': 82.624, 'best_test_test/diff': 3.723, 'best_test_test/acc_skew': 80.762, 'best_test_test/acc_align': 84.486}
[3 / 20] Learning rate: 0.001 weight: 0.01
[3 / 20] Loss: 4.737411667117759 CE Loss: 0.4262481254924504 Con Loss: 4.733149177137093
[3 / 20] tensor([[0.726, 0.710],
        [0.916, 0.941]]) {'epoch': 3, 'valid/acc': 80.591, 'valid/acc_unbiased': 81.384, 'valid/diff': 1.614, 'valid/acc_skew': 81.624, 'valid/acc_align': 81.144, 'test/acc': 81.941, 'test/acc_unbiased': 82.311, 'test/diff': 2.015, 'test/acc_skew': 81.304, 'test/acc_align': 83.319}
[3 / 20] best valid accuracy: 82.216 at epoch 2 
 best_stats: {'best_valid_epoch': 2, 'best_valid_valid/acc': 81.519, 'best_valid_valid/acc_unbiased': 82.216, 'best_valid_valid/diff': 1.773, 'best_valid_valid/acc_skew': 81.442, 'best_valid_valid/acc_align': 82.989, 'best_valid_test/acc': 82.236, 'best_valid_test/acc_unbiased': 82.624, 'best_valid_test/diff': 3.723, 'best_valid_test/acc_skew': 80.762, 'best_valid_test/acc_align': 84.486}
[3 / 20] best test accuracy: 82.624 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 81.519, 'best_test_valid/acc_unbiased': 82.216, 'best_test_valid/diff': 1.773, 'best_test_valid/acc_skew': 81.442, 'best_test_valid/acc_align': 82.989, 'best_test_test/acc': 82.236, 'best_test_test/acc_unbiased': 82.624, 'best_test_test/diff': 3.723, 'best_test_test/acc_skew': 80.762, 'best_test_test/acc_align': 84.486}
[4 / 20] Learning rate: 0.001 weight: 0.01
[4 / 20] Loss: 4.713701114029437 CE Loss: 0.40076453453895916 Con Loss: 4.709693466918892
[4 / 20] tensor([[0.860, 0.832],
        [0.835, 0.866]]) {'epoch': 4, 'valid/acc': 85.148, 'valid/acc_unbiased': 85.374, 'valid/diff': 2.886, 'valid/acc_skew': 85.357, 'valid/acc_align': 85.391, 'test/acc': 84.895, 'test/acc_unbiased': 84.84, 'test/diff': 2.969, 'test/acc_skew': 83.355, 'test/acc_align': 86.324}
[4 / 20] best valid accuracy: 85.374 at epoch 4 
 best_stats: {'best_valid_epoch': 4, 'best_valid_valid/acc': 85.148, 'best_valid_valid/acc_unbiased': 85.374, 'best_valid_valid/diff': 2.886, 'best_valid_valid/acc_skew': 85.357, 'best_valid_valid/acc_align': 85.391, 'best_valid_test/acc': 84.895, 'best_valid_test/acc_unbiased': 84.84, 'best_valid_test/diff': 2.969, 'best_valid_test/acc_skew': 83.355, 'best_valid_test/acc_align': 86.324}
[4 / 20] best test accuracy: 84.840 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 85.148, 'best_test_valid/acc_unbiased': 85.374, 'best_test_valid/diff': 2.886, 'best_test_valid/acc_skew': 85.357, 'best_test_valid/acc_align': 85.391, 'best_test_test/acc': 84.895, 'best_test_test/acc_unbiased': 84.84, 'best_test_test/diff': 2.969, 'best_test_test/acc_skew': 83.355, 'best_test_test/acc_align': 86.324}
[5 / 20] Learning rate: 0.001 weight: 0.01
[5 / 20] Loss: 4.704075597326448 CE Loss: 0.39082157959981245 Con Loss: 4.700167391295252
[5 / 20] tensor([[0.894, 0.882],
        [0.773, 0.740]]) {'epoch': 5, 'valid/acc': 82.152, 'valid/acc_unbiased': 81.891, 'valid/diff': 3.59, 'valid/acc_skew': 82.043, 'valid/acc_align': 81.738, 'test/acc': 82.321, 'test/acc_unbiased': 82.22, 'test/diff': 2.26, 'test/acc_skew': 82.728, 'test/acc_align': 81.712}
[5 / 20] best valid accuracy: 85.374 at epoch 4 
 best_stats: {'best_valid_epoch': 4, 'best_valid_valid/acc': 85.148, 'best_valid_valid/acc_unbiased': 85.374, 'best_valid_valid/diff': 2.886, 'best_valid_valid/acc_skew': 85.357, 'best_valid_valid/acc_align': 85.391, 'best_valid_test/acc': 84.895, 'best_valid_test/acc_unbiased': 84.84, 'best_valid_test/diff': 2.969, 'best_valid_test/acc_skew': 83.355, 'best_valid_test/acc_align': 86.324}
[5 / 20] best test accuracy: 84.840 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 85.148, 'best_test_valid/acc_unbiased': 85.374, 'best_test_valid/diff': 2.886, 'best_test_valid/acc_skew': 85.357, 'best_test_valid/acc_align': 85.391, 'best_test_test/acc': 84.895, 'best_test_test/acc_unbiased': 84.84, 'best_test_test/diff': 2.969, 'best_test_test/acc_skew': 83.355, 'best_test_test/acc_align': 86.324}
[6 / 20] Learning rate: 0.001 weight: 0.01
[6 / 20] Loss: 4.699421145641977 CE Loss: 0.38900417325676195 Con Loss: 4.695531084648939
[6 / 20] tensor([[0.896, 0.876],
        [0.799, 0.795]]) {'epoch': 6, 'valid/acc': 84.135, 'valid/acc_unbiased': 84.03, 'valid/diff': 3.905, 'valid/acc_skew': 84.852, 'valid/acc_align': 83.209, 'test/acc': 84.262, 'test/acc_unbiased': 84.141, 'test/diff': 1.194, 'test/acc_skew': 83.731, 'test/acc_align': 84.55}
[6 / 20] best valid accuracy: 85.374 at epoch 4 
 best_stats: {'best_valid_epoch': 4, 'best_valid_valid/acc': 85.148, 'best_valid_valid/acc_unbiased': 85.374, 'best_valid_valid/diff': 2.886, 'best_valid_valid/acc_skew': 85.357, 'best_valid_valid/acc_align': 85.391, 'best_valid_test/acc': 84.895, 'best_valid_test/acc_unbiased': 84.84, 'best_valid_test/diff': 2.969, 'best_valid_test/acc_skew': 83.355, 'best_valid_test/acc_align': 86.324}
[6 / 20] best test accuracy: 84.840 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 85.148, 'best_test_valid/acc_unbiased': 85.374, 'best_test_valid/diff': 2.886, 'best_test_valid/acc_skew': 85.357, 'best_test_valid/acc_align': 85.391, 'best_test_test/acc': 84.895, 'best_test_test/acc_unbiased': 84.84, 'best_test_test/diff': 2.969, 'best_test_test/acc_skew': 83.355, 'best_test_test/acc_align': 86.324}
[7 / 20] Learning rate: 0.0001 weight: 0.01
[7 / 20] Loss: 4.657144129932425 CE Loss: 0.34489647633640796 Con Loss: 4.653695157858503
[7 / 20] tensor([[0.846, 0.842],
        [0.896, 0.908]]) {'epoch': 7, 'valid/acc': 87.511, 'valid/acc_unbiased': 87.761, 'valid/diff': 1.27, 'valid/acc_skew': 88.058, 'valid/acc_align': 87.464, 'test/acc': 87.215, 'test/acc_unbiased': 87.295, 'test/diff': 0.785, 'test/acc_skew': 86.903, 'test/acc_align': 87.688}
[7 / 20] best valid accuracy: 87.761 at epoch 7 
 best_stats: {'best_valid_epoch': 7, 'best_valid_valid/acc': 87.511, 'best_valid_valid/acc_unbiased': 87.761, 'best_valid_valid/diff': 1.27, 'best_valid_valid/acc_skew': 88.058, 'best_valid_valid/acc_align': 87.464, 'best_valid_test/acc': 87.215, 'best_valid_test/acc_unbiased': 87.295, 'best_valid_test/diff': 0.785, 'best_valid_test/acc_skew': 86.903, 'best_valid_test/acc_align': 87.688}
[7 / 20] best test accuracy: 87.295 at epoch 7 
 best_stats: {'best_test_epoch': 7, 'best_test_valid/acc': 87.511, 'best_test_valid/acc_unbiased': 87.761, 'best_test_valid/diff': 1.27, 'best_test_valid/acc_skew': 88.058, 'best_test_valid/acc_align': 87.464, 'best_test_test/acc': 87.215, 'best_test_test/acc_unbiased': 87.295, 'best_test_test/diff': 0.785, 'best_test_test/acc_skew': 86.903, 'best_test_test/acc_align': 87.688}
[8 / 20] Learning rate: 0.0001 weight: 0.01
[8 / 20] Loss: 4.643951406327105 CE Loss: 0.3267657712393454 Con Loss: 4.640683749475412
[8 / 20] tensor([[0.835, 0.832],
        [0.903, 0.906]]) {'epoch': 8, 'valid/acc': 87.595, 'valid/acc_unbiased': 87.869, 'valid/diff': 0.978, 'valid/acc_skew': 87.911, 'valid/acc_align': 87.826, 'test/acc': 86.751, 'test/acc_unbiased': 86.893, 'test/diff': 0.365, 'test/acc_skew': 86.71, 'test/acc_align': 87.076}
[8 / 20] best valid accuracy: 87.869 at epoch 8 
 best_stats: {'best_valid_epoch': 8, 'best_valid_valid/acc': 87.595, 'best_valid_valid/acc_unbiased': 87.869, 'best_valid_valid/diff': 0.978, 'best_valid_valid/acc_skew': 87.911, 'best_valid_valid/acc_align': 87.826, 'best_valid_test/acc': 86.751, 'best_valid_test/acc_unbiased': 86.893, 'best_valid_test/diff': 0.365, 'best_valid_test/acc_skew': 86.71, 'best_valid_test/acc_align': 87.076}
[8 / 20] best test accuracy: 87.295 at epoch 7 
 best_stats: {'best_test_epoch': 7, 'best_test_valid/acc': 87.511, 'best_test_valid/acc_unbiased': 87.761, 'best_test_valid/diff': 1.27, 'best_test_valid/acc_skew': 88.058, 'best_test_valid/acc_align': 87.464, 'best_test_test/acc': 87.215, 'best_test_test/acc_unbiased': 87.295, 'best_test_test/diff': 0.785, 'best_test_test/acc_skew': 86.903, 'best_test_test/acc_align': 87.688}
[9 / 20] Learning rate: 0.0001 weight: 0.01
[9 / 20] Loss: 4.637190031016961 CE Loss: 0.3268142746924424 Con Loss: 4.633921895888329
[9 / 20] tensor([[0.875, 0.877],
        [0.885, 0.886]]) {'epoch': 9, 'valid/acc': 87.932, 'valid/acc_unbiased': 88.109, 'valid/diff': 2.568, 'valid/acc_skew': 88.681, 'valid/acc_align': 87.537, 'test/acc': 88.059, 'test/acc_unbiased': 88.071, 'test/diff': 0.158, 'test/acc_skew': 88.134, 'test/acc_align': 88.007}
[9 / 20] best valid accuracy: 88.109 at epoch 9 
 best_stats: {'best_valid_epoch': 9, 'best_valid_valid/acc': 87.932, 'best_valid_valid/acc_unbiased': 88.109, 'best_valid_valid/diff': 2.568, 'best_valid_valid/acc_skew': 88.681, 'best_valid_valid/acc_align': 87.537, 'best_valid_test/acc': 88.059, 'best_valid_test/acc_unbiased': 88.071, 'best_valid_test/diff': 0.158, 'best_valid_test/acc_skew': 88.134, 'best_valid_test/acc_align': 88.007}
[9 / 20] best test accuracy: 88.071 at epoch 9 
 best_stats: {'best_test_epoch': 9, 'best_test_valid/acc': 87.932, 'best_test_valid/acc_unbiased': 88.109, 'best_test_valid/diff': 2.568, 'best_test_valid/acc_skew': 88.681, 'best_test_valid/acc_align': 87.537, 'best_test_test/acc': 88.059, 'best_test_test/acc_unbiased': 88.071, 'best_test_test/diff': 0.158, 'best_test_test/acc_skew': 88.134, 'best_test_test/acc_align': 88.007}
[10 / 20] Learning rate: 0.0001 weight: 0.01
[10 / 20] Loss: 4.617698165120633 CE Loss: 0.3203042102413462 Con Loss: 4.614495140325725
[10 / 20] tensor([[0.864, 0.854],
        [0.890, 0.900]]) {'epoch': 10, 'valid/acc': 88.017, 'valid/acc_unbiased': 88.205, 'valid/diff': 2.08, 'valid/acc_skew': 88.278, 'valid/acc_align': 88.131, 'test/acc': 87.637, 'test/acc_unbiased': 87.691, 'test/diff': 1.043, 'test/acc_skew': 87.169, 'test/acc_align': 88.212}
[10 / 20] best valid accuracy: 88.205 at epoch 10 
 best_stats: {'best_valid_epoch': 10, 'best_valid_valid/acc': 88.017, 'best_valid_valid/acc_unbiased': 88.205, 'best_valid_valid/diff': 2.08, 'best_valid_valid/acc_skew': 88.278, 'best_valid_valid/acc_align': 88.131, 'best_valid_test/acc': 87.637, 'best_valid_test/acc_unbiased': 87.691, 'best_valid_test/diff': 1.043, 'best_valid_test/acc_skew': 87.169, 'best_valid_test/acc_align': 88.212}
[10 / 20] best test accuracy: 88.071 at epoch 9 
 best_stats: {'best_test_epoch': 9, 'best_test_valid/acc': 87.932, 'best_test_valid/acc_unbiased': 88.109, 'best_test_valid/diff': 2.568, 'best_test_valid/acc_skew': 88.681, 'best_test_valid/acc_align': 87.537, 'best_test_test/acc': 88.059, 'best_test_test/acc_unbiased': 88.071, 'best_test_test/diff': 0.158, 'best_test_test/acc_skew': 88.134, 'best_test_test/acc_align': 88.007}
[11 / 20] Learning rate: 0.0001 weight: 0.01
[11 / 20] Loss: 4.625212460154518 CE Loss: 0.30953098263835477 Con Loss: 4.622117141826337
[11 / 20] tensor([[0.866, 0.869],
        [0.881, 0.900]]) {'epoch': 11, 'valid/acc': 88.27, 'valid/acc_unbiased': 88.459, 'valid/diff': 1.712, 'valid/acc_skew': 89.045, 'valid/acc_align': 87.874, 'test/acc': 87.932, 'test/acc_unbiased': 87.888, 'test/diff': 1.122, 'test/acc_skew': 87.475, 'test/acc_align': 88.302}
[11 / 20] best valid accuracy: 88.459 at epoch 11 
 best_stats: {'best_valid_epoch': 11, 'best_valid_valid/acc': 88.27, 'best_valid_valid/acc_unbiased': 88.459, 'best_valid_valid/diff': 1.712, 'best_valid_valid/acc_skew': 89.045, 'best_valid_valid/acc_align': 87.874, 'best_valid_test/acc': 87.932, 'best_valid_test/acc_unbiased': 87.888, 'best_valid_test/diff': 1.122, 'best_valid_test/acc_skew': 87.475, 'best_valid_test/acc_align': 88.302}
[11 / 20] best test accuracy: 88.071 at epoch 9 
 best_stats: {'best_test_epoch': 9, 'best_test_valid/acc': 87.932, 'best_test_valid/acc_unbiased': 88.109, 'best_test_valid/diff': 2.568, 'best_test_valid/acc_skew': 88.681, 'best_test_valid/acc_align': 87.537, 'best_test_test/acc': 88.059, 'best_test_test/acc_unbiased': 88.071, 'best_test_test/diff': 0.158, 'best_test_test/acc_skew': 88.134, 'best_test_test/acc_align': 88.007}
[12 / 20] Learning rate: 0.0001 weight: 0.01
[12 / 20] Loss: 4.611715957114642 CE Loss: 0.30481286685766873 Con Loss: 4.60866784476526
[12 / 20] tensor([[0.882, 0.877],
        [0.872, 0.902]]) {'epoch': 12, 'valid/acc': 88.903, 'valid/acc_unbiased': 89.054, 'valid/diff': 2.144, 'valid/acc_skew': 88.973, 'valid/acc_align': 89.135, 'test/acc': 88.439, 'test/acc_unbiased': 88.334, 'test/diff': 1.698, 'test/acc_skew': 87.485, 'test/acc_align': 89.183}
[12 / 20] best valid accuracy: 89.054 at epoch 12 
 best_stats: {'best_valid_epoch': 12, 'best_valid_valid/acc': 88.903, 'best_valid_valid/acc_unbiased': 89.054, 'best_valid_valid/diff': 2.144, 'best_valid_valid/acc_skew': 88.973, 'best_valid_valid/acc_align': 89.135, 'best_valid_test/acc': 88.439, 'best_valid_test/acc_unbiased': 88.334, 'best_valid_test/diff': 1.698, 'best_valid_test/acc_skew': 87.485, 'best_valid_test/acc_align': 89.183}
[12 / 20] best test accuracy: 88.334 at epoch 12 
 best_stats: {'best_test_epoch': 12, 'best_test_valid/acc': 88.903, 'best_test_valid/acc_unbiased': 89.054, 'best_test_valid/diff': 2.144, 'best_test_valid/acc_skew': 88.973, 'best_test_valid/acc_align': 89.135, 'best_test_test/acc': 88.439, 'best_test_test/acc_unbiased': 88.334, 'best_test_test/diff': 1.698, 'best_test_test/acc_skew': 87.485, 'best_test_test/acc_align': 89.183}
[13 / 20] Learning rate: 0.0001 weight: 0.01
[13 / 20] Loss: 4.608134884320468 CE Loss: 0.3066694730050445 Con Loss: 4.605068190979524
[13 / 20] tensor([[0.884, 0.869],
        [0.872, 0.883]]) {'epoch': 13, 'valid/acc': 88.945, 'valid/acc_unbiased': 89.063, 'valid/diff': 2.67, 'valid/acc_skew': 89.01, 'valid/acc_align': 89.116, 'test/acc': 87.679, 'test/acc_unbiased': 87.674, 'test/diff': 1.265, 'test/acc_skew': 87.042, 'test/acc_align': 88.306}
[13 / 20] best valid accuracy: 89.063 at epoch 13 
 best_stats: {'best_valid_epoch': 13, 'best_valid_valid/acc': 88.945, 'best_valid_valid/acc_unbiased': 89.063, 'best_valid_valid/diff': 2.67, 'best_valid_valid/acc_skew': 89.01, 'best_valid_valid/acc_align': 89.116, 'best_valid_test/acc': 87.679, 'best_valid_test/acc_unbiased': 87.674, 'best_valid_test/diff': 1.265, 'best_valid_test/acc_skew': 87.042, 'best_valid_test/acc_align': 88.306}
[13 / 20] best test accuracy: 88.334 at epoch 12 
 best_stats: {'best_test_epoch': 12, 'best_test_valid/acc': 88.903, 'best_test_valid/acc_unbiased': 89.054, 'best_test_valid/diff': 2.144, 'best_test_valid/acc_skew': 88.973, 'best_test_valid/acc_align': 89.135, 'best_test_test/acc': 88.439, 'best_test_test/acc_unbiased': 88.334, 'best_test_test/diff': 1.698, 'best_test_test/acc_skew': 87.485, 'best_test_test/acc_align': 89.183}
[14 / 20] Learning rate: 1e-05 weight: 0.01
[14 / 20] Loss: 4.592936301970771 CE Loss: 0.2979779208974508 Con Loss: 4.58995653655069
[14 / 20] tensor([[0.885, 0.869],
        [0.872, 0.890]]) {'epoch': 14, 'valid/acc': 89.114, 'valid/acc_unbiased': 89.237, 'valid/diff': 2.588, 'valid/acc_skew': 89.521, 'valid/acc_align': 88.953, 'test/acc': 87.932, 'test/acc_unbiased': 87.905, 'test/diff': 1.726, 'test/acc_skew': 87.042, 'test/acc_align': 88.767}
[14 / 20] best valid accuracy: 89.237 at epoch 14 
 best_stats: {'best_valid_epoch': 14, 'best_valid_valid/acc': 89.114, 'best_valid_valid/acc_unbiased': 89.237, 'best_valid_valid/diff': 2.588, 'best_valid_valid/acc_skew': 89.521, 'best_valid_valid/acc_align': 88.953, 'best_valid_test/acc': 87.932, 'best_valid_test/acc_unbiased': 87.905, 'best_valid_test/diff': 1.726, 'best_valid_test/acc_skew': 87.042, 'best_valid_test/acc_align': 88.767}
[14 / 20] best test accuracy: 88.334 at epoch 12 
 best_stats: {'best_test_epoch': 12, 'best_test_valid/acc': 88.903, 'best_test_valid/acc_unbiased': 89.054, 'best_test_valid/diff': 2.144, 'best_test_valid/acc_skew': 88.973, 'best_test_valid/acc_align': 89.135, 'best_test_test/acc': 88.439, 'best_test_test/acc_unbiased': 88.334, 'best_test_test/diff': 1.698, 'best_test_test/acc_skew': 87.485, 'best_test_test/acc_align': 89.183}
[15 / 20] Learning rate: 1e-05 weight: 0.01
[15 / 20] Loss: 4.607021707749677 CE Loss: 0.2941446653186746 Con Loss: 4.604080256586698
[15 / 20] tensor([[0.887, 0.876],
        [0.872, 0.887]]) {'epoch': 15, 'valid/acc': 89.03, 'valid/acc_unbiased': 89.176, 'valid/diff': 2.758, 'valid/acc_skew': 89.484, 'valid/acc_align': 88.867, 'test/acc': 88.101, 'test/acc_unbiased': 88.06, 'test/diff': 1.298, 'test/acc_skew': 87.411, 'test/acc_align': 88.708}
[15 / 20] best valid accuracy: 89.237 at epoch 14 
 best_stats: {'best_valid_epoch': 14, 'best_valid_valid/acc': 89.114, 'best_valid_valid/acc_unbiased': 89.237, 'best_valid_valid/diff': 2.588, 'best_valid_valid/acc_skew': 89.521, 'best_valid_valid/acc_align': 88.953, 'best_valid_test/acc': 87.932, 'best_valid_test/acc_unbiased': 87.905, 'best_valid_test/diff': 1.726, 'best_valid_test/acc_skew': 87.042, 'best_valid_test/acc_align': 88.767}
[15 / 20] best test accuracy: 88.334 at epoch 12 
 best_stats: {'best_test_epoch': 12, 'best_test_valid/acc': 88.903, 'best_test_valid/acc_unbiased': 89.054, 'best_test_valid/diff': 2.144, 'best_test_valid/acc_skew': 88.973, 'best_test_valid/acc_align': 89.135, 'best_test_test/acc': 88.439, 'best_test_test/acc_unbiased': 88.334, 'best_test_test/diff': 1.698, 'best_test_test/acc_skew': 87.485, 'best_test_test/acc_align': 89.183}
[16 / 20] Learning rate: 1e-05 weight: 0.01
[16 / 20] Loss: 4.613044260012666 CE Loss: 0.2953465876113906 Con Loss: 4.610090803483631
[16 / 20] tensor([[0.875, 0.860],
        [0.885, 0.905]]) {'epoch': 16, 'valid/acc': 89.072, 'valid/acc_unbiased': 89.279, 'valid/diff': 2.569, 'valid/acc_skew': 89.191, 'valid/acc_align': 89.367, 'test/acc': 88.101, 'test/acc_unbiased': 88.11, 'test/diff': 1.725, 'test/acc_skew': 87.248, 'test/acc_align': 88.973}
[16 / 20] best valid accuracy: 89.279 at epoch 16 
 best_stats: {'best_valid_epoch': 16, 'best_valid_valid/acc': 89.072, 'best_valid_valid/acc_unbiased': 89.279, 'best_valid_valid/diff': 2.569, 'best_valid_valid/acc_skew': 89.191, 'best_valid_valid/acc_align': 89.367, 'best_valid_test/acc': 88.101, 'best_valid_test/acc_unbiased': 88.11, 'best_valid_test/diff': 1.725, 'best_valid_test/acc_skew': 87.248, 'best_valid_test/acc_align': 88.973}
[16 / 20] best test accuracy: 88.334 at epoch 12 
 best_stats: {'best_test_epoch': 12, 'best_test_valid/acc': 88.903, 'best_test_valid/acc_unbiased': 89.054, 'best_test_valid/diff': 2.144, 'best_test_valid/acc_skew': 88.973, 'best_test_valid/acc_align': 89.135, 'best_test_test/acc': 88.439, 'best_test_test/acc_unbiased': 88.334, 'best_test_test/diff': 1.698, 'best_test_test/acc_skew': 87.485, 'best_test_test/acc_align': 89.183}
[17 / 20] Learning rate: 1e-05 weight: 0.01
[17 / 20] Loss: 4.58895036269413 CE Loss: 0.2900093346421746 Con Loss: 4.586050256225323
[17 / 20] tensor([[0.885, 0.867],
        [0.881, 0.892]]) {'epoch': 17, 'valid/acc': 89.072, 'valid/acc_unbiased': 89.196, 'valid/diff': 2.326, 'valid/acc_skew': 89.302, 'valid/acc_align': 89.091, 'test/acc': 88.101, 'test/acc_unbiased': 88.121, 'test/diff': 1.441, 'test/acc_skew': 87.401, 'test/acc_align': 88.842}
[17 / 20] best valid accuracy: 89.279 at epoch 16 
 best_stats: {'best_valid_epoch': 16, 'best_valid_valid/acc': 89.072, 'best_valid_valid/acc_unbiased': 89.279, 'best_valid_valid/diff': 2.569, 'best_valid_valid/acc_skew': 89.191, 'best_valid_valid/acc_align': 89.367, 'best_valid_test/acc': 88.101, 'best_valid_test/acc_unbiased': 88.11, 'best_valid_test/diff': 1.725, 'best_valid_test/acc_skew': 87.248, 'best_valid_test/acc_align': 88.973}
[17 / 20] best test accuracy: 88.334 at epoch 12 
 best_stats: {'best_test_epoch': 12, 'best_test_valid/acc': 88.903, 'best_test_valid/acc_unbiased': 89.054, 'best_test_valid/diff': 2.144, 'best_test_valid/acc_skew': 88.973, 'best_test_valid/acc_align': 89.135, 'best_test_test/acc': 88.439, 'best_test_test/acc_unbiased': 88.334, 'best_test_test/diff': 1.698, 'best_test_test/acc_skew': 87.485, 'best_test_test/acc_align': 89.183}
[18 / 20] Learning rate: 1e-05 weight: 0.01
[18 / 20] Loss: 4.599358213857457 CE Loss: 0.2889266493013462 Con Loss: 4.596468961080635
[18 / 20] tensor([[0.887, 0.870],
        [0.877, 0.895]]) {'epoch': 18, 'valid/acc': 89.367, 'valid/acc_unbiased': 89.486, 'valid/diff': 2.184, 'valid/acc_skew': 89.959, 'valid/acc_align': 89.014, 'test/acc': 88.228, 'test/acc_unbiased': 88.206, 'test/diff': 1.748, 'test/acc_skew': 87.332, 'test/acc_align': 89.08}
[18 / 20] best valid accuracy: 89.486 at epoch 18 
 best_stats: {'best_valid_epoch': 18, 'best_valid_valid/acc': 89.367, 'best_valid_valid/acc_unbiased': 89.486, 'best_valid_valid/diff': 2.184, 'best_valid_valid/acc_skew': 89.959, 'best_valid_valid/acc_align': 89.014, 'best_valid_test/acc': 88.228, 'best_valid_test/acc_unbiased': 88.206, 'best_valid_test/diff': 1.748, 'best_valid_test/acc_skew': 87.332, 'best_valid_test/acc_align': 89.08}
[18 / 20] best test accuracy: 88.334 at epoch 12 
 best_stats: {'best_test_epoch': 12, 'best_test_valid/acc': 88.903, 'best_test_valid/acc_unbiased': 89.054, 'best_test_valid/diff': 2.144, 'best_test_valid/acc_skew': 88.973, 'best_test_valid/acc_align': 89.135, 'best_test_test/acc': 88.439, 'best_test_test/acc_unbiased': 88.334, 'best_test_test/diff': 1.698, 'best_test_test/acc_skew': 87.485, 'best_test_test/acc_align': 89.183}
[19 / 20] Learning rate: 1e-05 weight: 0.01
[19 / 20] Loss: 4.59363113352808 CE Loss: 0.29159056037643794 Con Loss: 4.590715229702481
[19 / 20] tensor([[0.884, 0.864],
        [0.883, 0.897]]) {'epoch': 19, 'valid/acc': 89.283, 'valid/acc_unbiased': 89.409, 'valid/diff': 1.995, 'valid/acc_skew': 89.667, 'valid/acc_align': 89.152, 'test/acc': 88.186, 'test/acc_unbiased': 88.205, 'test/diff': 1.688, 'test/acc_skew': 87.361, 'test/acc_align': 89.049}
[19 / 20] best valid accuracy: 89.486 at epoch 18 
 best_stats: {'best_valid_epoch': 18, 'best_valid_valid/acc': 89.367, 'best_valid_valid/acc_unbiased': 89.486, 'best_valid_valid/diff': 2.184, 'best_valid_valid/acc_skew': 89.959, 'best_valid_valid/acc_align': 89.014, 'best_valid_test/acc': 88.228, 'best_valid_test/acc_unbiased': 88.206, 'best_valid_test/diff': 1.748, 'best_valid_test/acc_skew': 87.332, 'best_valid_test/acc_align': 89.08}
[19 / 20] best test accuracy: 88.334 at epoch 12 
 best_stats: {'best_test_epoch': 12, 'best_test_valid/acc': 88.903, 'best_test_valid/acc_unbiased': 89.054, 'best_test_valid/diff': 2.144, 'best_test_valid/acc_skew': 88.973, 'best_test_valid/acc_align': 89.135, 'best_test_test/acc': 88.439, 'best_test_test/acc_unbiased': 88.334, 'best_test_test/diff': 1.698, 'best_test_test/acc_skew': 87.485, 'best_test_test/acc_align': 89.183}
[20 / 20] Learning rate: 1e-05 weight: 0.01
[20 / 20] Loss: 4.603146761387723 CE Loss: 0.293997862599305 Con Loss: 4.600206765122493
[20 / 20] tensor([[0.866, 0.854],
        [0.894, 0.911]]) {'epoch': 20, 'valid/acc': 88.945, 'valid/acc_unbiased': 89.194, 'valid/diff': 2.071, 'valid/acc_skew': 89.482, 'valid/acc_align': 88.905, 'test/acc': 88.059, 'test/acc_unbiased': 88.104, 'test/diff': 1.437, 'test/acc_skew': 87.385, 'test/acc_align': 88.822}
[20 / 20] best valid accuracy: 89.486 at epoch 18 
 best_stats: {'best_valid_epoch': 18, 'best_valid_valid/acc': 89.367, 'best_valid_valid/acc_unbiased': 89.486, 'best_valid_valid/diff': 2.184, 'best_valid_valid/acc_skew': 89.959, 'best_valid_valid/acc_align': 89.014, 'best_valid_test/acc': 88.228, 'best_valid_test/acc_unbiased': 88.206, 'best_valid_test/diff': 1.748, 'best_valid_test/acc_skew': 87.332, 'best_valid_test/acc_align': 89.08}
[20 / 20] best test accuracy: 88.334 at epoch 12 
 best_stats: {'best_test_epoch': 12, 'best_test_valid/acc': 88.903, 'best_test_valid/acc_unbiased': 89.054, 'best_test_valid/diff': 2.144, 'best_test_valid/acc_skew': 88.973, 'best_test_valid/acc_align': 89.135, 'best_test_test/acc': 88.439, 'best_test_test/acc_unbiased': 88.334, 'best_test_test/diff': 1.698, 'best_test_test/acc_skew': 87.485, 'best_test_test/acc_align': 89.183}
Total training time: 1:03:20
