Log level set to: INFO
Set seed: 2
=======> Using Fixed Random Seed: 2 <========
save_path: exp_results/bc-bb0-utk_face_race-crop_rotate_color-0.9-lr0.001-bs128-cbs64-w0.01-ratio10-aug1-seed2
get_utk_face - split: train, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_race-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [4407, 552]
Target 1: [440, 5529]
Binary Target 1
---------------------------
Target 0: [4407, 552]
Target 1: [440, 5529]
===================================
Normal Label Distribution: 
Target 0: [4407, 552]
Target 1: [440, 5529]
===================================
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [4407, 552]
Target 1: [440, 5529]
Binary Target 1
---------------------------
Target 0: [4407, 552]
Target 1: [440, 5529]
===================================
Normal Label Distribution: 
Target 0: [4407, 552]
Target 1: [440, 5529]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 10928, target_attr: gender, bias_attr: race bias_rate: 0.9
['[train] target_0-bias_0: 4407', '[train] target_0-bias_1: 552', '[train] target_1-bias_0: 440', '[train] target_1-bias_1: 5529']
confusion_matrix - 
 original: tensor([[4407.,  440.],
        [ 552., 5529.]]), 
 normalized: tensor([[0.909, 0.091],
        [0.091, 0.909]]), 
 b|y: tensor([[0.889, 0.111],
        [0.074, 0.926]])
get_utk_face - split: train, aug: 1, given_y: True, ratio: 10
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_race-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [4407, 552]
Target 1: [440, 5529]
Binary Target 1
---------------------------
Target 0: [4407, 552]
Target 1: [440, 5529]
===================================
Normal Label Distribution: 
Target 0: [4407, 552]
Target 1: [440, 5529]
===================================
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [4407, 552]
Target 1: [440, 5529]
Binary Target 1
---------------------------
Target 0: [4407, 552]
Target 1: [440, 5529]
===================================
Normal Label Distribution: 
Target 0: [4407, 552]
Target 1: [440, 5529]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 10928, target_attr: gender, bias_attr: race bias_rate: 0.9
['[train] target_0-bias_0: 4407', '[train] target_0-bias_1: 552', '[train] target_1-bias_0: 440', '[train] target_1-bias_1: 5529']
get_utk_face - split: valid, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_race-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [583, 684]
Target 1: [457, 646]
Binary Target 1
---------------------------
Target 0: [583, 684]
Target 1: [457, 646]
===================================
Normal Label Distribution: 
Target 0: [583, 684]
Target 1: [457, 646]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 2370, target_attr: gender, bias_attr: race bias_rate: 0.9
['[valid] target_0-bias_0: 583', '[valid] target_0-bias_1: 684', '[valid] target_1-bias_0: 457', '[valid] target_1-bias_1: 646']
get_utk_face - split: test, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_race-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [558, 677]
Target 1: [462, 673]
Binary Target 1
---------------------------
Target 0: [558, 677]
Target 1: [462, 673]
===================================
Normal Label Distribution: 
Target 0: [558, 677]
Target 1: [462, 673]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 2370, target_attr: gender, bias_attr: race bias_rate: 0.9
['[test] target_0-bias_0: 558', '[test] target_0-bias_1: 677', '[test] target_1-bias_0: 462', '[test] target_1-bias_1: 673']
decay_epochs: [6, 13]
[1 / 20] Learning rate: 0.001 weight: 0.01
[1 / 20] Loss: 4.92130844065944 CE Loss: 0.654126817014172 Con Loss: 4.914767187126908
[1 / 20] tensor([[0.821, 0.767],
        [0.457, 0.602]]) {'epoch': 1, 'valid/acc': 67.595, 'valid/acc_unbiased': 66.012, 'valid/diff': 8.288, 'valid/acc_skew': 61.868, 'valid/acc_align': 70.156, 'test/acc': 67.215, 'test/acc_unbiased': 66.147, 'test/diff': 9.962, 'test/acc_skew': 61.166, 'test/acc_align': 71.129}
[1 / 20] best valid accuracy: 66.012 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 67.595, 'best_valid_valid/acc_unbiased': 66.012, 'best_valid_valid/diff': 8.288, 'best_valid_valid/acc_skew': 61.868, 'best_valid_valid/acc_align': 70.156, 'best_valid_test/acc': 67.215, 'best_valid_test/acc_unbiased': 66.147, 'best_valid_test/diff': 9.962, 'best_valid_test/acc_skew': 61.166, 'best_valid_test/acc_align': 71.129}
[1 / 20] best test accuracy: 66.147 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 67.595, 'best_test_valid/acc_unbiased': 66.012, 'best_test_valid/diff': 8.288, 'best_test_valid/acc_skew': 61.868, 'best_test_valid/acc_align': 70.156, 'best_test_test/acc': 67.215, 'best_test_test/acc_unbiased': 66.147, 'best_test_test/diff': 9.962, 'best_test_test/acc_skew': 61.166, 'best_test_test/acc_align': 71.129}
[2 / 20] Learning rate: 0.001 weight: 0.01
[2 / 20] Loss: 4.8475658638760075 CE Loss: 0.5911401234468988 Con Loss: 4.841654483605269
[2 / 20] tensor([[0.762, 0.672],
        [0.639, 0.709]]) {'epoch': 2, 'valid/acc': 70.717, 'valid/acc_unbiased': 70.518, 'valid/diff': 5.069, 'valid/acc_skew': 67.984, 'valid/acc_align': 73.053, 'test/acc': 69.705, 'test/acc_unbiased': 69.526, 'test/diff': 7.99, 'test/acc_skew': 65.531, 'test/acc_align': 73.521}
[2 / 20] best valid accuracy: 70.518 at epoch 2 
 best_stats: {'best_valid_epoch': 2, 'best_valid_valid/acc': 70.717, 'best_valid_valid/acc_unbiased': 70.518, 'best_valid_valid/diff': 5.069, 'best_valid_valid/acc_skew': 67.984, 'best_valid_valid/acc_align': 73.053, 'best_valid_test/acc': 69.705, 'best_valid_test/acc_unbiased': 69.526, 'best_valid_test/diff': 7.99, 'best_valid_test/acc_skew': 65.531, 'best_valid_test/acc_align': 73.521}
[2 / 20] best test accuracy: 69.526 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 70.717, 'best_test_valid/acc_unbiased': 70.518, 'best_test_valid/diff': 5.069, 'best_test_valid/acc_skew': 67.984, 'best_test_valid/acc_align': 73.053, 'best_test_test/acc': 69.705, 'best_test_test/acc_unbiased': 69.526, 'best_test_test/diff': 7.99, 'best_test_test/acc_skew': 65.531, 'best_test_test/acc_align': 73.521}
[3 / 20] Learning rate: 0.001 weight: 0.01
[3 / 20] Loss: 4.840507031883362 CE Loss: 0.5698315938430161 Con Loss: 4.834808711251612
[3 / 20] tensor([[0.833, 0.775],
        [0.591, 0.643]]) {'epoch': 3, 'valid/acc': 73.207, 'valid/acc_unbiased': 72.462, 'valid/diff': 2.662, 'valid/acc_skew': 71.132, 'valid/acc_align': 73.793, 'test/acc': 71.561, 'test/acc_unbiased': 71.078, 'test/diff': 5.517, 'test/acc_skew': 68.319, 'test/acc_align': 73.836}
[3 / 20] best valid accuracy: 72.462 at epoch 3 
 best_stats: {'best_valid_epoch': 3, 'best_valid_valid/acc': 73.207, 'best_valid_valid/acc_unbiased': 72.462, 'best_valid_valid/diff': 2.662, 'best_valid_valid/acc_skew': 71.132, 'best_valid_valid/acc_align': 73.793, 'best_valid_test/acc': 71.561, 'best_valid_test/acc_unbiased': 71.078, 'best_valid_test/diff': 5.517, 'best_valid_test/acc_skew': 68.319, 'best_valid_test/acc_align': 73.836}
[3 / 20] best test accuracy: 71.078 at epoch 3 
 best_stats: {'best_test_epoch': 3, 'best_test_valid/acc': 73.207, 'best_test_valid/acc_unbiased': 72.462, 'best_test_valid/diff': 2.662, 'best_test_valid/acc_skew': 71.132, 'best_test_valid/acc_align': 73.793, 'best_test_test/acc': 71.561, 'best_test_test/acc_unbiased': 71.078, 'best_test_test/diff': 5.517, 'best_test_test/acc_skew': 68.319, 'best_test_test/acc_align': 73.836}
[4 / 20] Learning rate: 0.001 weight: 0.01
[4 / 20] Loss: 4.835012629999074 CE Loss: 0.5607246859967272 Con Loss: 4.829405389453447
[4 / 20] tensor([[0.647, 0.510],
        [0.835, 0.880]]) {'epoch': 4, 'valid/acc': 70.675, 'valid/acc_unbiased': 71.653, 'valid/diff': 6.281, 'valid/acc_skew': 68.512, 'valid/acc_align': 74.794, 'test/acc': 71.055, 'test/acc_unbiased': 71.792, 'test/diff': 9.075, 'test/acc_skew': 67.255, 'test/acc_align': 76.33}
[4 / 20] best valid accuracy: 72.462 at epoch 3 
 best_stats: {'best_valid_epoch': 3, 'best_valid_valid/acc': 73.207, 'best_valid_valid/acc_unbiased': 72.462, 'best_valid_valid/diff': 2.662, 'best_valid_valid/acc_skew': 71.132, 'best_valid_valid/acc_align': 73.793, 'best_valid_test/acc': 71.561, 'best_valid_test/acc_unbiased': 71.078, 'best_valid_test/diff': 5.517, 'best_valid_test/acc_skew': 68.319, 'best_valid_test/acc_align': 73.836}
[4 / 20] best test accuracy: 71.792 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 70.675, 'best_test_valid/acc_unbiased': 71.653, 'best_test_valid/diff': 6.281, 'best_test_valid/acc_skew': 68.512, 'best_test_valid/acc_align': 74.794, 'best_test_test/acc': 71.055, 'best_test_test/acc_unbiased': 71.792, 'best_test_test/diff': 9.075, 'best_test_test/acc_skew': 67.255, 'best_test_test/acc_align': 76.33}
[5 / 20] Learning rate: 0.001 weight: 0.01
[5 / 20] Loss: 4.827730033617592 CE Loss: 0.5571459815844261 Con Loss: 4.822158553066226
[5 / 20] tensor([[0.545, 0.455],
        [0.905, 0.927]]) {'epoch': 5, 'valid/acc': 67.131, 'valid/acc_unbiased': 68.609, 'valid/diff': 0.923, 'valid/acc_skew': 68.249, 'valid/acc_align': 68.968, 'test/acc': 69.789, 'test/acc_unbiased': 70.793, 'test/diff': 5.614, 'test/acc_skew': 67.986, 'test/acc_align': 73.6}
[5 / 20] best valid accuracy: 72.462 at epoch 3 
 best_stats: {'best_valid_epoch': 3, 'best_valid_valid/acc': 73.207, 'best_valid_valid/acc_unbiased': 72.462, 'best_valid_valid/diff': 2.662, 'best_valid_valid/acc_skew': 71.132, 'best_valid_valid/acc_align': 73.793, 'best_valid_test/acc': 71.561, 'best_valid_test/acc_unbiased': 71.078, 'best_valid_test/diff': 5.517, 'best_valid_test/acc_skew': 68.319, 'best_valid_test/acc_align': 73.836}
[5 / 20] best test accuracy: 71.792 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 70.675, 'best_test_valid/acc_unbiased': 71.653, 'best_test_valid/diff': 6.281, 'best_test_valid/acc_skew': 68.512, 'best_test_valid/acc_align': 74.794, 'best_test_test/acc': 71.055, 'best_test_test/acc_unbiased': 71.792, 'best_test_test/diff': 9.075, 'best_test_test/acc_skew': 67.255, 'best_test_test/acc_align': 76.33}
[6 / 20] Learning rate: 0.001 weight: 0.01
[6 / 20] Loss: 4.825258478413215 CE Loss: 0.543363392658499 Con Loss: 4.81982483870812
[6 / 20] tensor([[0.833, 0.767],
        [0.639, 0.682]]) {'epoch': 6, 'valid/acc': 73.46, 'valid/acc_unbiased': 72.846, 'valid/diff': 6.866, 'valid/acc_skew': 69.413, 'valid/acc_align': 76.278, 'test/acc': 73.333, 'test/acc_unbiased': 73.012, 'test/diff': 5.51, 'test/acc_skew': 70.257, 'test/acc_align': 75.768}
[6 / 20] best valid accuracy: 72.846 at epoch 6 
 best_stats: {'best_valid_epoch': 6, 'best_valid_valid/acc': 73.46, 'best_valid_valid/acc_unbiased': 72.846, 'best_valid_valid/diff': 6.866, 'best_valid_valid/acc_skew': 69.413, 'best_valid_valid/acc_align': 76.278, 'best_valid_test/acc': 73.333, 'best_valid_test/acc_unbiased': 73.012, 'best_valid_test/diff': 5.51, 'best_valid_test/acc_skew': 70.257, 'best_valid_test/acc_align': 75.768}
[6 / 20] best test accuracy: 73.012 at epoch 6 
 best_stats: {'best_test_epoch': 6, 'best_test_valid/acc': 73.46, 'best_test_valid/acc_unbiased': 72.846, 'best_test_valid/diff': 6.866, 'best_test_valid/acc_skew': 69.413, 'best_test_valid/acc_align': 76.278, 'best_test_test/acc': 73.333, 'best_test_test/acc_unbiased': 73.012, 'best_test_test/diff': 5.51, 'best_test_test/acc_skew': 70.257, 'best_test_test/acc_align': 75.768}
[7 / 20] Learning rate: 0.0001 weight: 0.01
[7 / 20] Loss: 4.790395036448846 CE Loss: 0.5009128921726612 Con Loss: 4.78538590817989
[7 / 20] tensor([[0.685, 0.583],
        [0.851, 0.886]]) {'epoch': 7, 'valid/acc': 72.954, 'valid/acc_unbiased': 73.836, 'valid/diff': 4.438, 'valid/acc_skew': 71.617, 'valid/acc_align': 76.055, 'test/acc': 74.515, 'test/acc_unbiased': 75.107, 'test/diff': 6.803, 'test/acc_skew': 71.705, 'test/acc_align': 78.509}
[7 / 20] best valid accuracy: 73.836 at epoch 7 
 best_stats: {'best_valid_epoch': 7, 'best_valid_valid/acc': 72.954, 'best_valid_valid/acc_unbiased': 73.836, 'best_valid_valid/diff': 4.438, 'best_valid_valid/acc_skew': 71.617, 'best_valid_valid/acc_align': 76.055, 'best_valid_test/acc': 74.515, 'best_valid_test/acc_unbiased': 75.107, 'best_valid_test/diff': 6.803, 'best_valid_test/acc_skew': 71.705, 'best_valid_test/acc_align': 78.509}
[7 / 20] best test accuracy: 75.107 at epoch 7 
 best_stats: {'best_test_epoch': 7, 'best_test_valid/acc': 72.954, 'best_test_valid/acc_unbiased': 73.836, 'best_test_valid/diff': 4.438, 'best_test_valid/acc_skew': 71.617, 'best_test_valid/acc_align': 76.055, 'best_test_test/acc': 74.515, 'best_test_test/acc_unbiased': 75.107, 'best_test_test/diff': 6.803, 'best_test_test/acc_skew': 71.705, 'best_test_test/acc_align': 78.509}
[8 / 20] Learning rate: 0.0001 weight: 0.01
[8 / 20] Loss: 4.785274566354374 CE Loss: 0.47804424664111994 Con Loss: 4.780494118853858
[8 / 20] tensor([[0.769, 0.654],
        [0.807, 0.853]]) {'epoch': 8, 'valid/acc': 75.654, 'valid/acc_unbiased': 76.033, 'valid/diff': 7.721, 'valid/acc_skew': 72.172, 'valid/acc_align': 79.893, 'test/acc': 76.751, 'test/acc_unbiased': 77.086, 'test/diff': 8.0, 'test/acc_skew': 73.086, 'test/acc_align': 81.086}
[8 / 20] best valid accuracy: 76.033 at epoch 8 
 best_stats: {'best_valid_epoch': 8, 'best_valid_valid/acc': 75.654, 'best_valid_valid/acc_unbiased': 76.033, 'best_valid_valid/diff': 7.721, 'best_valid_valid/acc_skew': 72.172, 'best_valid_valid/acc_align': 79.893, 'best_valid_test/acc': 76.751, 'best_valid_test/acc_unbiased': 77.086, 'best_valid_test/diff': 8.0, 'best_valid_test/acc_skew': 73.086, 'best_valid_test/acc_align': 81.086}
[8 / 20] best test accuracy: 77.086 at epoch 8 
 best_stats: {'best_test_epoch': 8, 'best_test_valid/acc': 75.654, 'best_test_valid/acc_unbiased': 76.033, 'best_test_valid/diff': 7.721, 'best_test_valid/acc_skew': 72.172, 'best_test_valid/acc_align': 79.893, 'best_test_test/acc': 76.751, 'best_test_test/acc_unbiased': 77.086, 'best_test_test/diff': 8.0, 'best_test_test/acc_skew': 73.086, 'best_test_test/acc_align': 81.086}
[9 / 20] Learning rate: 0.0001 weight: 0.01
[9 / 20] Loss: 4.77226219135357 CE Loss: 0.4696671538174938 Con Loss: 4.767565514297821
[9 / 20] tensor([[0.783, 0.688],
        [0.818, 0.863]]) {'epoch': 9, 'valid/acc': 76.751, 'valid/acc_unbiased': 77.114, 'valid/diff': 5.94, 'valid/acc_skew': 74.144, 'valid/acc_align': 80.084, 'test/acc': 78.565, 'test/acc_unbiased': 78.824, 'test/diff': 6.997, 'test/acc_skew': 75.326, 'test/acc_align': 82.323}
[9 / 20] best valid accuracy: 77.114 at epoch 9 
 best_stats: {'best_valid_epoch': 9, 'best_valid_valid/acc': 76.751, 'best_valid_valid/acc_unbiased': 77.114, 'best_valid_valid/diff': 5.94, 'best_valid_valid/acc_skew': 74.144, 'best_valid_valid/acc_align': 80.084, 'best_valid_test/acc': 78.565, 'best_valid_test/acc_unbiased': 78.824, 'best_valid_test/diff': 6.997, 'best_valid_test/acc_skew': 75.326, 'best_valid_test/acc_align': 82.323}
[9 / 20] best test accuracy: 78.824 at epoch 9 
 best_stats: {'best_test_epoch': 9, 'best_test_valid/acc': 76.751, 'best_test_valid/acc_unbiased': 77.114, 'best_test_valid/diff': 5.94, 'best_test_valid/acc_skew': 74.144, 'best_test_valid/acc_align': 80.084, 'best_test_test/acc': 78.565, 'best_test_test/acc_unbiased': 78.824, 'best_test_test/diff': 6.997, 'best_test_test/acc_skew': 75.326, 'best_test_test/acc_align': 82.323}
[10 / 20] Learning rate: 0.0001 weight: 0.01
[10 / 20] Loss: 4.769960306399389 CE Loss: 0.46995626989953865 Con Loss: 4.765260762037331
[10 / 20] tensor([[0.765, 0.669],
        [0.818, 0.871]]) {'epoch': 10, 'valid/acc': 76.245, 'valid/acc_unbiased': 76.602, 'valid/diff': 7.327, 'valid/acc_skew': 72.939, 'valid/acc_align': 80.266, 'test/acc': 77.806, 'test/acc_unbiased': 78.082, 'test/diff': 7.433, 'test/acc_skew': 74.366, 'test/acc_align': 81.798}
[10 / 20] best valid accuracy: 77.114 at epoch 9 
 best_stats: {'best_valid_epoch': 9, 'best_valid_valid/acc': 76.751, 'best_valid_valid/acc_unbiased': 77.114, 'best_valid_valid/diff': 5.94, 'best_valid_valid/acc_skew': 74.144, 'best_valid_valid/acc_align': 80.084, 'best_valid_test/acc': 78.565, 'best_valid_test/acc_unbiased': 78.824, 'best_valid_test/diff': 6.997, 'best_valid_test/acc_skew': 75.326, 'best_valid_test/acc_align': 82.323}
[10 / 20] best test accuracy: 78.824 at epoch 9 
 best_stats: {'best_test_epoch': 9, 'best_test_valid/acc': 76.751, 'best_test_valid/acc_unbiased': 77.114, 'best_test_valid/diff': 5.94, 'best_test_valid/acc_skew': 74.144, 'best_test_valid/acc_align': 80.084, 'best_test_test/acc': 78.565, 'best_test_test/acc_unbiased': 78.824, 'best_test_test/diff': 6.997, 'best_test_test/acc_skew': 75.326, 'best_test_test/acc_align': 82.323}
[11 / 20] Learning rate: 0.0001 weight: 0.01
[11 / 20] Loss: 4.759832427581966 CE Loss: 0.46693422818777325 Con Loss: 4.755163072667045
[11 / 20] tensor([[0.749, 0.690],
        [0.812, 0.859]]) {'epoch': 11, 'valid/acc': 77.848, 'valid/acc_unbiased': 78.271, 'valid/diff': 5.48, 'valid/acc_skew': 75.531, 'valid/acc_align': 81.01, 'test/acc': 77.553, 'test/acc_unbiased': 77.736, 'test/diff': 5.322, 'test/acc_skew': 75.075, 'test/acc_align': 80.397}
[11 / 20] best valid accuracy: 78.271 at epoch 11 
 best_stats: {'best_valid_epoch': 11, 'best_valid_valid/acc': 77.848, 'best_valid_valid/acc_unbiased': 78.271, 'best_valid_valid/diff': 5.48, 'best_valid_valid/acc_skew': 75.531, 'best_valid_valid/acc_align': 81.01, 'best_valid_test/acc': 77.553, 'best_valid_test/acc_unbiased': 77.736, 'best_valid_test/diff': 5.322, 'best_valid_test/acc_skew': 75.075, 'best_valid_test/acc_align': 80.397}
[11 / 20] best test accuracy: 78.824 at epoch 9 
 best_stats: {'best_test_epoch': 9, 'best_test_valid/acc': 76.751, 'best_test_valid/acc_unbiased': 77.114, 'best_test_valid/diff': 5.94, 'best_test_valid/acc_skew': 74.144, 'best_test_valid/acc_align': 80.084, 'best_test_test/acc': 78.565, 'best_test_test/acc_unbiased': 78.824, 'best_test_test/diff': 6.997, 'best_test_test/acc_skew': 75.326, 'best_test_test/acc_align': 82.323}
[12 / 20] Learning rate: 0.0001 weight: 0.01
[12 / 20] Loss: 4.755006959113683 CE Loss: 0.45186330943121567 Con Loss: 4.75048831476125
[12 / 20] tensor([[0.783, 0.710],
        [0.797, 0.860]]) {'epoch': 12, 'valid/acc': 78.439, 'valid/acc_unbiased': 78.531, 'valid/diff': 8.549, 'valid/acc_skew': 74.256, 'valid/acc_align': 82.805, 'test/acc': 78.692, 'test/acc_unbiased': 78.763, 'test/diff': 6.823, 'test/acc_skew': 75.351, 'test/acc_align': 82.174}
[12 / 20] best valid accuracy: 78.531 at epoch 12 
 best_stats: {'best_valid_epoch': 12, 'best_valid_valid/acc': 78.439, 'best_valid_valid/acc_unbiased': 78.531, 'best_valid_valid/diff': 8.549, 'best_valid_valid/acc_skew': 74.256, 'best_valid_valid/acc_align': 82.805, 'best_valid_test/acc': 78.692, 'best_valid_test/acc_unbiased': 78.763, 'best_valid_test/diff': 6.823, 'best_valid_test/acc_skew': 75.351, 'best_valid_test/acc_align': 82.174}
[12 / 20] best test accuracy: 78.824 at epoch 9 
 best_stats: {'best_test_epoch': 9, 'best_test_valid/acc': 76.751, 'best_test_valid/acc_unbiased': 77.114, 'best_test_valid/diff': 5.94, 'best_test_valid/acc_skew': 74.144, 'best_test_valid/acc_align': 80.084, 'best_test_test/acc': 78.565, 'best_test_test/acc_unbiased': 78.824, 'best_test_test/diff': 6.997, 'best_test_test/acc_skew': 75.326, 'best_test_test/acc_align': 82.323}
[13 / 20] Learning rate: 0.0001 weight: 0.01
[13 / 20] Loss: 4.754356372408776 CE Loss: 0.4524341288894022 Con Loss: 4.749832027653126
[13 / 20] tensor([[0.846, 0.786],
        [0.721, 0.820]]) {'epoch': 13, 'valid/acc': 79.873, 'valid/acc_unbiased': 79.766, 'valid/diff': 5.46, 'valid/acc_skew': 77.036, 'valid/acc_align': 82.496, 'test/acc': 79.705, 'test/acc_unbiased': 79.317, 'test/diff': 7.974, 'test/acc_skew': 75.33, 'test/acc_align': 83.304}
[13 / 20] best valid accuracy: 79.766 at epoch 13 
 best_stats: {'best_valid_epoch': 13, 'best_valid_valid/acc': 79.873, 'best_valid_valid/acc_unbiased': 79.766, 'best_valid_valid/diff': 5.46, 'best_valid_valid/acc_skew': 77.036, 'best_valid_valid/acc_align': 82.496, 'best_valid_test/acc': 79.705, 'best_valid_test/acc_unbiased': 79.317, 'best_valid_test/diff': 7.974, 'best_valid_test/acc_skew': 75.33, 'best_valid_test/acc_align': 83.304}
[13 / 20] best test accuracy: 79.317 at epoch 13 
 best_stats: {'best_test_epoch': 13, 'best_test_valid/acc': 79.873, 'best_test_valid/acc_unbiased': 79.766, 'best_test_valid/diff': 5.46, 'best_test_valid/acc_skew': 77.036, 'best_test_valid/acc_align': 82.496, 'best_test_test/acc': 79.705, 'best_test_test/acc_unbiased': 79.317, 'best_test_test/diff': 7.974, 'best_test_test/acc_skew': 75.33, 'best_test_test/acc_align': 83.304}
[14 / 20] Learning rate: 1e-05 weight: 0.01
[14 / 20] Loss: 4.755383721207805 CE Loss: 0.44722389703613774 Con Loss: 4.750911483652945
[14 / 20] tensor([[0.776, 0.700],
        [0.807, 0.863]]) {'epoch': 14, 'valid/acc': 79.156, 'valid/acc_unbiased': 79.578, 'valid/diff': 5.613, 'valid/acc_skew': 76.772, 'valid/acc_align': 82.385, 'test/acc': 78.523, 'test/acc_unbiased': 78.67, 'test/diff': 6.589, 'test/acc_skew': 75.375, 'test/acc_align': 81.964}
[14 / 20] best valid accuracy: 79.766 at epoch 13 
 best_stats: {'best_valid_epoch': 13, 'best_valid_valid/acc': 79.873, 'best_valid_valid/acc_unbiased': 79.766, 'best_valid_valid/diff': 5.46, 'best_valid_valid/acc_skew': 77.036, 'best_valid_valid/acc_align': 82.496, 'best_valid_test/acc': 79.705, 'best_valid_test/acc_unbiased': 79.317, 'best_valid_test/diff': 7.974, 'best_valid_test/acc_skew': 75.33, 'best_valid_test/acc_align': 83.304}
[14 / 20] best test accuracy: 79.317 at epoch 13 
 best_stats: {'best_test_epoch': 13, 'best_test_valid/acc': 79.873, 'best_test_valid/acc_unbiased': 79.766, 'best_test_valid/diff': 5.46, 'best_test_valid/acc_skew': 77.036, 'best_test_valid/acc_align': 82.496, 'best_test_test/acc': 79.705, 'best_test_test/acc_unbiased': 79.317, 'best_test_test/diff': 7.974, 'best_test_test/acc_skew': 75.33, 'best_test_test/acc_align': 83.304}
[15 / 20] Learning rate: 1e-05 weight: 0.01
[15 / 20] Loss: 4.736505846327954 CE Loss: 0.4395917613893791 Con Loss: 4.732109902020254
[15 / 20] tensor([[0.776, 0.694],
        [0.810, 0.871]]) {'epoch': 15, 'valid/acc': 78.819, 'valid/acc_unbiased': 79.253, 'valid/diff': 6.058, 'valid/acc_skew': 76.224, 'valid/acc_align': 82.282, 'test/acc': 78.608, 'test/acc_unbiased': 78.762, 'test/diff': 7.148, 'test/acc_skew': 75.188, 'test/acc_align': 82.336}
[15 / 20] best valid accuracy: 79.766 at epoch 13 
 best_stats: {'best_valid_epoch': 13, 'best_valid_valid/acc': 79.873, 'best_valid_valid/acc_unbiased': 79.766, 'best_valid_valid/diff': 5.46, 'best_valid_valid/acc_skew': 77.036, 'best_valid_valid/acc_align': 82.496, 'best_valid_test/acc': 79.705, 'best_valid_test/acc_unbiased': 79.317, 'best_valid_test/diff': 7.974, 'best_valid_test/acc_skew': 75.33, 'best_valid_test/acc_align': 83.304}
[15 / 20] best test accuracy: 79.317 at epoch 13 
 best_stats: {'best_test_epoch': 13, 'best_test_valid/acc': 79.873, 'best_test_valid/acc_unbiased': 79.766, 'best_test_valid/diff': 5.46, 'best_test_valid/acc_skew': 77.036, 'best_test_valid/acc_align': 82.496, 'best_test_test/acc': 79.705, 'best_test_test/acc_unbiased': 79.317, 'best_test_test/diff': 7.974, 'best_test_test/acc_skew': 75.33, 'best_test_test/acc_align': 83.304}
[16 / 20] Learning rate: 1e-05 weight: 0.01
[16 / 20] Loss: 4.742475858719073 CE Loss: 0.4402629665888595 Con Loss: 4.738073247068972
[16 / 20] tensor([[0.792, 0.706],
        [0.797, 0.865]]) {'epoch': 16, 'valid/acc': 79.156, 'valid/acc_unbiased': 79.52, 'valid/diff': 5.641, 'valid/acc_skew': 76.7, 'valid/acc_align': 82.341, 'test/acc': 78.903, 'test/acc_unbiased': 78.987, 'test/diff': 7.715, 'test/acc_skew': 75.13, 'test/acc_align': 82.845}
[16 / 20] best valid accuracy: 79.766 at epoch 13 
 best_stats: {'best_valid_epoch': 13, 'best_valid_valid/acc': 79.873, 'best_valid_valid/acc_unbiased': 79.766, 'best_valid_valid/diff': 5.46, 'best_valid_valid/acc_skew': 77.036, 'best_valid_valid/acc_align': 82.496, 'best_valid_test/acc': 79.705, 'best_valid_test/acc_unbiased': 79.317, 'best_valid_test/diff': 7.974, 'best_valid_test/acc_skew': 75.33, 'best_valid_test/acc_align': 83.304}
[16 / 20] best test accuracy: 79.317 at epoch 13 
 best_stats: {'best_test_epoch': 13, 'best_test_valid/acc': 79.873, 'best_test_valid/acc_unbiased': 79.766, 'best_test_valid/diff': 5.46, 'best_test_valid/acc_skew': 77.036, 'best_test_valid/acc_align': 82.496, 'best_test_test/acc': 79.705, 'best_test_test/acc_unbiased': 79.317, 'best_test_test/diff': 7.974, 'best_test_test/acc_skew': 75.33, 'best_test_test/acc_align': 83.304}
[17 / 20] Learning rate: 1e-05 weight: 0.01
[17 / 20] Loss: 4.738612415151749 CE Loss: 0.4426326774398893 Con Loss: 4.734186094292435
[17 / 20] tensor([[0.797, 0.703],
        [0.810, 0.865]]) {'epoch': 17, 'valid/acc': 79.494, 'valid/acc_unbiased': 79.852, 'valid/diff': 5.647, 'valid/acc_skew': 77.029, 'valid/acc_align': 82.676, 'test/acc': 79.198, 'test/acc_unbiased': 79.373, 'test/diff': 7.482, 'test/acc_skew': 75.631, 'test/acc_align': 83.114}
[17 / 20] best valid accuracy: 79.852 at epoch 17 
 best_stats: {'best_valid_epoch': 17, 'best_valid_valid/acc': 79.494, 'best_valid_valid/acc_unbiased': 79.852, 'best_valid_valid/diff': 5.647, 'best_valid_valid/acc_skew': 77.029, 'best_valid_valid/acc_align': 82.676, 'best_valid_test/acc': 79.198, 'best_valid_test/acc_unbiased': 79.373, 'best_valid_test/diff': 7.482, 'best_valid_test/acc_skew': 75.631, 'best_valid_test/acc_align': 83.114}
[17 / 20] best test accuracy: 79.373 at epoch 17 
 best_stats: {'best_test_epoch': 17, 'best_test_valid/acc': 79.494, 'best_test_valid/acc_unbiased': 79.852, 'best_test_valid/diff': 5.647, 'best_test_valid/acc_skew': 77.029, 'best_test_valid/acc_align': 82.676, 'best_test_test/acc': 79.198, 'best_test_test/acc_unbiased': 79.373, 'best_test_test/diff': 7.482, 'best_test_test/acc_skew': 75.631, 'best_test_test/acc_align': 83.114}
[18 / 20] Learning rate: 1e-05 weight: 0.01
[18 / 20] Loss: 4.7269600516356975 CE Loss: 0.4324519211865449 Con Loss: 4.722635542840245
[18 / 20] tensor([[0.783, 0.697],
        [0.825, 0.874]]) {'epoch': 18, 'valid/acc': 79.451, 'valid/acc_unbiased': 79.852, 'valid/diff': 5.94, 'valid/acc_skew': 76.882, 'valid/acc_align': 82.822, 'test/acc': 79.241, 'test/acc_unbiased': 79.468, 'test/diff': 6.749, 'test/acc_skew': 76.093, 'test/acc_align': 82.843}
[18 / 20] best valid accuracy: 79.852 at epoch 17 
 best_stats: {'best_valid_epoch': 17, 'best_valid_valid/acc': 79.494, 'best_valid_valid/acc_unbiased': 79.852, 'best_valid_valid/diff': 5.647, 'best_valid_valid/acc_skew': 77.029, 'best_valid_valid/acc_align': 82.676, 'best_valid_test/acc': 79.198, 'best_valid_test/acc_unbiased': 79.373, 'best_valid_test/diff': 7.482, 'best_valid_test/acc_skew': 75.631, 'best_valid_test/acc_align': 83.114}
[18 / 20] best test accuracy: 79.468 at epoch 18 
 best_stats: {'best_test_epoch': 18, 'best_test_valid/acc': 79.451, 'best_test_valid/acc_unbiased': 79.852, 'best_test_valid/diff': 5.94, 'best_test_valid/acc_skew': 76.882, 'best_test_valid/acc_align': 82.822, 'best_test_test/acc': 79.241, 'best_test_test/acc_unbiased': 79.468, 'best_test_test/diff': 6.749, 'best_test_test/acc_skew': 76.093, 'best_test_test/acc_align': 82.843}
[19 / 20] Learning rate: 1e-05 weight: 0.01
[19 / 20] Loss: 4.7378340046716465 CE Loss: 0.44545672569931166 Con Loss: 4.733379422658359
[19 / 20] tensor([[0.774, 0.688],
        [0.831, 0.878]]) {'epoch': 19, 'valid/acc': 78.945, 'valid/acc_unbiased': 79.436, 'valid/diff': 5.986, 'valid/acc_skew': 76.442, 'valid/acc_align': 82.429, 'test/acc': 79.03, 'test/acc_unbiased': 79.296, 'test/diff': 6.643, 'test/acc_skew': 75.975, 'test/acc_align': 82.618}
[19 / 20] best valid accuracy: 79.852 at epoch 17 
 best_stats: {'best_valid_epoch': 17, 'best_valid_valid/acc': 79.494, 'best_valid_valid/acc_unbiased': 79.852, 'best_valid_valid/diff': 5.647, 'best_valid_valid/acc_skew': 77.029, 'best_valid_valid/acc_align': 82.676, 'best_valid_test/acc': 79.198, 'best_valid_test/acc_unbiased': 79.373, 'best_valid_test/diff': 7.482, 'best_valid_test/acc_skew': 75.631, 'best_valid_test/acc_align': 83.114}
[19 / 20] best test accuracy: 79.468 at epoch 18 
 best_stats: {'best_test_epoch': 18, 'best_test_valid/acc': 79.451, 'best_test_valid/acc_unbiased': 79.852, 'best_test_valid/diff': 5.94, 'best_test_valid/acc_skew': 76.882, 'best_test_valid/acc_align': 82.822, 'best_test_test/acc': 79.241, 'best_test_test/acc_unbiased': 79.468, 'best_test_test/diff': 6.749, 'best_test_test/acc_skew': 76.093, 'best_test_test/acc_align': 82.843}
[20 / 20] Learning rate: 1e-05 weight: 0.01
[20 / 20] Loss: 4.739355252742069 CE Loss: 0.4398907812238612 Con Loss: 4.734956330820198
[20 / 20] tensor([[0.738, 0.659],
        [0.866, 0.895]]) {'epoch': 20, 'valid/acc': 78.228, 'valid/acc_unbiased': 78.855, 'valid/diff': 5.779, 'valid/acc_skew': 75.966, 'valid/acc_align': 81.745, 'test/acc': 78.481, 'test/acc_unbiased': 78.936, 'test/diff': 5.413, 'test/acc_skew': 76.229, 'test/acc_align': 81.643}
[20 / 20] best valid accuracy: 79.852 at epoch 17 
 best_stats: {'best_valid_epoch': 17, 'best_valid_valid/acc': 79.494, 'best_valid_valid/acc_unbiased': 79.852, 'best_valid_valid/diff': 5.647, 'best_valid_valid/acc_skew': 77.029, 'best_valid_valid/acc_align': 82.676, 'best_valid_test/acc': 79.198, 'best_valid_test/acc_unbiased': 79.373, 'best_valid_test/diff': 7.482, 'best_valid_test/acc_skew': 75.631, 'best_valid_test/acc_align': 83.114}
[20 / 20] best test accuracy: 79.468 at epoch 18 
 best_stats: {'best_test_epoch': 18, 'best_test_valid/acc': 79.451, 'best_test_valid/acc_unbiased': 79.852, 'best_test_valid/diff': 5.94, 'best_test_valid/acc_skew': 76.882, 'best_test_valid/acc_align': 82.822, 'best_test_test/acc': 79.241, 'best_test_test/acc_unbiased': 79.468, 'best_test_test/diff': 6.749, 'best_test_test/acc_skew': 76.093, 'best_test_test/acc_align': 82.843}
Total training time: 0:17:31
