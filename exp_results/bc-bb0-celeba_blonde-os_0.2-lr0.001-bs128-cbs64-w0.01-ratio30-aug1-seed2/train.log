Log level set to: INFO
Set seed: 2
=======> Using Fixed Random Seed: 2 <========
save_path: exp_results/bc-bb0-celeba_blonde-os_0.2-lr0.001-bs128-cbs64-w0.01-ratio30-aug1-seed2
get_celeba - split:train, aug: False, given_y: True, ratio: 0
use existing blonde indices from data/celeba/pickles/blonde
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [10710, 10710]
Target 1: [10710, 10710]
Binary Target 1
---------------------------
Target 0: [10710, 10710]
Target 1: [10710, 10710]
===================================
Normal Label Distribution: 
Target 0: [10710, 10710]
Target 1: [10710, 10710]
===================================
Use BiasedCelebASplit 
 target_attr: blonde split: train 
 tensor([[10710., 10710.],
        [10710., 10710.]])
get_celeba - split:train, aug: 1, given_y: True, ratio: 30
use existing blonde indices from data/celeba/pickles/blonde
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [10694, 10694]
Target 1: [10694, 10694]
Binary Target 1
---------------------------
Target 0: [10694, 10694]
Target 1: [10694, 10694]
===================================
Normal Label Distribution: 
Target 0: [10694, 10694]
Target 1: [10694, 10694]
===================================
Use BiasedCelebASplit 
 target_attr: blonde split: train 
 tensor([[10694., 10694.],
        [10694., 10694.]])
get_celeba - split:train_valid, aug: False, given_y: True, ratio: 0
use existing blonde indices from data/celeba/pickles/blonde
Use BiasedCelebASplit 
 target_attr: blonde split: train_valid 
 tensor([[  403.,  4597.],
        [13344.,   285.]])
get_celeba - split:valid, aug: False, given_y: True, ratio: 0
Use BiasedCelebASplit 
 target_attr: blonde split: valid 
 tensor([[8535., 2874.],
        [8276.,  182.]])
decay_epochs: [3, 6]
[1 / 10] Learning rate: 0.001 weight: 0.01
[1 / 10] Loss: 4.672633478910872 CE Loss: 0.29775413443116133 Con Loss: 4.669655942872348
[1 / 10] tensor([[0.929, 0.960],
        [0.866, 0.808]]) {'epoch': 1, 'valid/acc': 92.742, 'valid/acc_unbiased': 88.631, 'valid/diff': 4.081, 'valid/acc_skew': 90.671, 'valid/acc_align': 86.591, 'test/acc': 93.149, 'test/acc_unbiased': 89.057, 'test/diff': 4.479, 'test/acc_skew': 89.734, 'test/acc_align': 88.379}
[1 / 10] best valid accuracy: 88.631 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 92.742, 'best_valid_valid/acc_unbiased': 88.631, 'best_valid_valid/diff': 4.081, 'best_valid_valid/acc_skew': 90.671, 'best_valid_valid/acc_align': 86.591, 'best_valid_test/acc': 93.149, 'best_valid_test/acc_unbiased': 89.057, 'best_valid_test/diff': 4.479, 'best_valid_test/acc_skew': 89.734, 'best_valid_test/acc_align': 88.379}
[1 / 10] best test accuracy: 89.057 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 92.742, 'best_test_valid/acc_unbiased': 88.631, 'best_test_valid/diff': 4.081, 'best_test_valid/acc_skew': 90.671, 'best_test_valid/acc_align': 86.591, 'best_test_test/acc': 93.149, 'best_test_test/acc_unbiased': 89.057, 'best_test_test/diff': 4.479, 'best_test_test/acc_skew': 89.734, 'best_test_test/acc_align': 88.379}
[2 / 10] Learning rate: 0.001 weight: 0.01
[2 / 10] Loss: 4.617751895502057 CE Loss: 0.23835708044824147 Con Loss: 4.615368340151205
[2 / 10] tensor([[0.829, 0.904],
        [0.953, 0.885]]) {'epoch': 2, 'valid/acc': 91.261, 'valid/acc_unbiased': 89.477, 'valid/diff': 5.849, 'valid/acc_skew': 91.114, 'valid/acc_align': 87.839, 'test/acc': 87.879, 'test/acc_unbiased': 89.278, 'test/diff': 7.2, 'test/acc_skew': 89.116, 'test/acc_align': 89.44}
[2 / 10] best valid accuracy: 89.477 at epoch 2 
 best_stats: {'best_valid_epoch': 2, 'best_valid_valid/acc': 91.261, 'best_valid_valid/acc_unbiased': 89.477, 'best_valid_valid/diff': 5.849, 'best_valid_valid/acc_skew': 91.114, 'best_valid_valid/acc_align': 87.839, 'best_valid_test/acc': 87.879, 'best_valid_test/acc_unbiased': 89.278, 'best_valid_test/diff': 7.2, 'best_valid_test/acc_skew': 89.116, 'best_valid_test/acc_align': 89.44}
[2 / 10] best test accuracy: 89.278 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 91.261, 'best_test_valid/acc_unbiased': 89.477, 'best_test_valid/diff': 5.849, 'best_test_valid/acc_skew': 91.114, 'best_test_valid/acc_align': 87.839, 'best_test_test/acc': 87.879, 'best_test_test/acc_unbiased': 89.278, 'best_test_test/diff': 7.2, 'best_test_test/acc_skew': 89.116, 'best_test_test/acc_align': 89.44}
[3 / 10] Learning rate: 0.001 weight: 0.01
[3 / 10] Loss: 4.604805437367615 CE Loss: 0.2279471214578933 Con Loss: 4.602525972318249
[3 / 10] tensor([[0.871, 0.918],
        [0.952, 0.901]]) {'epoch': 3, 'valid/acc': 92.114, 'valid/acc_unbiased': 92.532, 'valid/diff': 4.374, 'valid/acc_skew': 94.719, 'valid/acc_align': 90.345, 'test/acc': 90.295, 'test/acc_unbiased': 91.08, 'test/diff': 4.904, 'test/acc_skew': 91.19, 'test/acc_align': 90.971}
[3 / 10] best valid accuracy: 92.532 at epoch 3 
 best_stats: {'best_valid_epoch': 3, 'best_valid_valid/acc': 92.114, 'best_valid_valid/acc_unbiased': 92.532, 'best_valid_valid/diff': 4.374, 'best_valid_valid/acc_skew': 94.719, 'best_valid_valid/acc_align': 90.345, 'best_valid_test/acc': 90.295, 'best_valid_test/acc_unbiased': 91.08, 'best_valid_test/diff': 4.904, 'best_valid_test/acc_skew': 91.19, 'best_valid_test/acc_align': 90.971}
[3 / 10] best test accuracy: 91.080 at epoch 3 
 best_stats: {'best_test_epoch': 3, 'best_test_valid/acc': 92.114, 'best_test_valid/acc_unbiased': 92.532, 'best_test_valid/diff': 4.374, 'best_test_valid/acc_skew': 94.719, 'best_test_valid/acc_align': 90.345, 'best_test_test/acc': 90.295, 'best_test_test/acc_unbiased': 91.08, 'best_test_test/diff': 4.904, 'best_test_test/acc_skew': 91.19, 'best_test_test/acc_align': 90.971}
[4 / 10] Learning rate: 0.0001 weight: 0.01
[4 / 10] Loss: 4.542122317117358 CE Loss: 0.19420746950542225 Con Loss: 4.540180248862444
[4 / 10] tensor([[0.873, 0.940],
        [0.954, 0.907]]) {'epoch': 4, 'valid/acc': 93.891, 'valid/acc_unbiased': 94.048, 'valid/diff': 2.381, 'valid/acc_skew': 95.239, 'valid/acc_align': 92.858, 'test/acc': 91.297, 'test/acc_unbiased': 91.843, 'test/diff': 5.763, 'test/acc_skew': 91.336, 'test/acc_align': 92.351}
[4 / 10] best valid accuracy: 94.048 at epoch 4 
 best_stats: {'best_valid_epoch': 4, 'best_valid_valid/acc': 93.891, 'best_valid_valid/acc_unbiased': 94.048, 'best_valid_valid/diff': 2.381, 'best_valid_valid/acc_skew': 95.239, 'best_valid_valid/acc_align': 92.858, 'best_valid_test/acc': 91.297, 'best_valid_test/acc_unbiased': 91.843, 'best_valid_test/diff': 5.763, 'best_valid_test/acc_skew': 91.336, 'best_valid_test/acc_align': 92.351}
[4 / 10] best test accuracy: 91.843 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 93.891, 'best_test_valid/acc_unbiased': 94.048, 'best_test_valid/diff': 2.381, 'best_test_valid/acc_skew': 95.239, 'best_test_valid/acc_align': 92.858, 'best_test_test/acc': 91.297, 'best_test_test/acc_unbiased': 91.843, 'best_test_test/diff': 5.763, 'best_test_test/acc_skew': 91.336, 'best_test_test/acc_align': 92.351}
[5 / 10] Learning rate: 0.0001 weight: 0.01
[5 / 10] Loss: 4.509208788991976 CE Loss: 0.17814666501948145 Con Loss: 4.5074273309787785
[5 / 10] tensor([[0.865, 0.942],
        [0.955, 0.907]]) {'epoch': 5, 'valid/acc': 94.047, 'valid/acc_unbiased': 93.851, 'valid/diff': 2.24, 'valid/acc_skew': 94.971, 'valid/acc_align': 92.731, 'test/acc': 91.061, 'test/acc_unbiased': 91.73, 'test/diff': 6.31, 'test/acc_skew': 91.019, 'test/acc_align': 92.442}
[5 / 10] best valid accuracy: 94.048 at epoch 4 
 best_stats: {'best_valid_epoch': 4, 'best_valid_valid/acc': 93.891, 'best_valid_valid/acc_unbiased': 94.048, 'best_valid_valid/diff': 2.381, 'best_valid_valid/acc_skew': 95.239, 'best_valid_valid/acc_align': 92.858, 'best_valid_test/acc': 91.297, 'best_valid_test/acc_unbiased': 91.843, 'best_valid_test/diff': 5.763, 'best_valid_test/acc_skew': 91.336, 'best_valid_test/acc_align': 92.351}
[5 / 10] best test accuracy: 91.843 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 93.891, 'best_test_valid/acc_unbiased': 94.048, 'best_test_valid/diff': 2.381, 'best_test_valid/acc_skew': 95.239, 'best_test_valid/acc_align': 92.858, 'best_test_test/acc': 91.297, 'best_test_test/acc_unbiased': 91.843, 'best_test_test/diff': 5.763, 'best_test_test/acc_skew': 91.336, 'best_test_test/acc_align': 92.351}
[6 / 10] Learning rate: 0.0001 weight: 0.01
[6 / 10] Loss: 4.491147386371032 CE Loss: 0.17395744321782605 Con Loss: 4.489407807928062
[6 / 10] tensor([[0.873, 0.944],
        [0.953, 0.901]]) {'epoch': 6, 'valid/acc': 94.208, 'valid/acc_unbiased': 94.53, 'valid/diff': 1.992, 'valid/acc_skew': 95.526, 'valid/acc_align': 93.534, 'test/acc': 91.428, 'test/acc_unbiased': 91.77, 'test/diff': 6.155, 'test/acc_skew': 91.289, 'test/acc_align': 92.252}
[6 / 10] best valid accuracy: 94.530 at epoch 6 
 best_stats: {'best_valid_epoch': 6, 'best_valid_valid/acc': 94.208, 'best_valid_valid/acc_unbiased': 94.53, 'best_valid_valid/diff': 1.992, 'best_valid_valid/acc_skew': 95.526, 'best_valid_valid/acc_align': 93.534, 'best_valid_test/acc': 91.428, 'best_valid_test/acc_unbiased': 91.77, 'best_valid_test/diff': 6.155, 'best_valid_test/acc_skew': 91.289, 'best_valid_test/acc_align': 92.252}
[6 / 10] best test accuracy: 91.843 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 93.891, 'best_test_valid/acc_unbiased': 94.048, 'best_test_valid/diff': 2.381, 'best_test_valid/acc_skew': 95.239, 'best_test_valid/acc_align': 92.858, 'best_test_test/acc': 91.297, 'best_test_test/acc_unbiased': 91.843, 'best_test_test/diff': 5.763, 'best_test_test/acc_skew': 91.336, 'best_test_test/acc_align': 92.351}
[7 / 10] Learning rate: 1e-05 weight: 0.01
[7 / 10] Loss: 4.478484664867127 CE Loss: 0.16482383593513406 Con Loss: 4.476836429991308
[7 / 10] tensor([[0.872, 0.942],
        [0.949, 0.912]]) {'epoch': 7, 'valid/acc': 93.999, 'valid/acc_unbiased': 94.698, 'valid/diff': 1.148, 'valid/acc_skew': 95.272, 'valid/acc_align': 94.124, 'test/acc': 91.262, 'test/acc_unbiased': 91.872, 'test/diff': 5.341, 'test/acc_skew': 91.04, 'test/acc_align': 92.704}
[7 / 10] best valid accuracy: 94.698 at epoch 7 
 best_stats: {'best_valid_epoch': 7, 'best_valid_valid/acc': 93.999, 'best_valid_valid/acc_unbiased': 94.698, 'best_valid_valid/diff': 1.148, 'best_valid_valid/acc_skew': 95.272, 'best_valid_valid/acc_align': 94.124, 'best_valid_test/acc': 91.262, 'best_valid_test/acc_unbiased': 91.872, 'best_valid_test/diff': 5.341, 'best_valid_test/acc_skew': 91.04, 'best_valid_test/acc_align': 92.704}
[7 / 10] best test accuracy: 91.872 at epoch 7 
 best_stats: {'best_test_epoch': 7, 'best_test_valid/acc': 93.999, 'best_test_valid/acc_unbiased': 94.698, 'best_test_valid/diff': 1.148, 'best_test_valid/acc_skew': 95.272, 'best_test_valid/acc_align': 94.124, 'best_test_test/acc': 91.262, 'best_test_test/acc_unbiased': 91.872, 'best_test_test/diff': 5.341, 'best_test_test/acc_skew': 91.04, 'best_test_test/acc_align': 92.704}
[8 / 10] Learning rate: 1e-05 weight: 0.01
[8 / 10] Loss: 4.467502977868088 CE Loss: 0.164188232831483 Con Loss: 4.465861080963961
[8 / 10] tensor([[0.869, 0.944],
        [0.954, 0.901]]) {'epoch': 8, 'valid/acc': 94.186, 'valid/acc_unbiased': 94.918, 'valid/diff': 1.821, 'valid/acc_skew': 95.829, 'valid/acc_align': 94.008, 'test/acc': 91.272, 'test/acc_unbiased': 91.691, 'test/diff': 6.383, 'test/acc_skew': 91.131, 'test/acc_align': 92.252}
[8 / 10] best valid accuracy: 94.918 at epoch 8 
 best_stats: {'best_valid_epoch': 8, 'best_valid_valid/acc': 94.186, 'best_valid_valid/acc_unbiased': 94.918, 'best_valid_valid/diff': 1.821, 'best_valid_valid/acc_skew': 95.829, 'best_valid_valid/acc_align': 94.008, 'best_valid_test/acc': 91.272, 'best_valid_test/acc_unbiased': 91.691, 'best_valid_test/diff': 6.383, 'best_valid_test/acc_skew': 91.131, 'best_valid_test/acc_align': 92.252}
[8 / 10] best test accuracy: 91.872 at epoch 7 
 best_stats: {'best_test_epoch': 7, 'best_test_valid/acc': 93.999, 'best_test_valid/acc_unbiased': 94.698, 'best_test_valid/diff': 1.148, 'best_test_valid/acc_skew': 95.272, 'best_test_valid/acc_align': 94.124, 'best_test_test/acc': 91.262, 'best_test_test/acc_unbiased': 91.872, 'best_test_test/diff': 5.341, 'best_test_test/acc_skew': 91.04, 'best_test_test/acc_align': 92.704}
[9 / 10] Learning rate: 1e-05 weight: 0.01
[9 / 10] Loss: 4.4674886914528384 CE Loss: 0.16401050871605077 Con Loss: 4.465848593262175
[9 / 10] tensor([[0.867, 0.938],
        [0.958, 0.929]]) {'epoch': 9, 'valid/acc': 93.972, 'valid/acc_unbiased': 95.212, 'valid/diff': 1.507, 'valid/acc_skew': 95.966, 'valid/acc_align': 94.459, 'test/acc': 91.005, 'test/acc_unbiased': 92.273, 'test/diff': 4.998, 'test/acc_skew': 91.24, 'test/acc_align': 93.305}
[9 / 10] best valid accuracy: 95.212 at epoch 9 
 best_stats: {'best_valid_epoch': 9, 'best_valid_valid/acc': 93.972, 'best_valid_valid/acc_unbiased': 95.212, 'best_valid_valid/diff': 1.507, 'best_valid_valid/acc_skew': 95.966, 'best_valid_valid/acc_align': 94.459, 'best_valid_test/acc': 91.005, 'best_valid_test/acc_unbiased': 92.273, 'best_valid_test/diff': 4.998, 'best_valid_test/acc_skew': 91.24, 'best_valid_test/acc_align': 93.305}
[9 / 10] best test accuracy: 92.273 at epoch 9 
 best_stats: {'best_test_epoch': 9, 'best_test_valid/acc': 93.972, 'best_test_valid/acc_unbiased': 95.212, 'best_test_valid/diff': 1.507, 'best_test_valid/acc_skew': 95.966, 'best_test_valid/acc_align': 94.459, 'best_test_test/acc': 91.005, 'best_test_test/acc_unbiased': 92.273, 'best_test_test/diff': 4.998, 'best_test_test/acc_skew': 91.24, 'best_test_test/acc_align': 93.305}
[10 / 10] Learning rate: 1e-05 weight: 0.01
[10 / 10] Loss: 4.461875715264642 CE Loss: 0.1622726728435324 Con Loss: 4.460252978754979
[10 / 10] tensor([[0.879, 0.945],
        [0.950, 0.923]]) {'epoch': 10, 'valid/acc': 94.133, 'valid/acc_unbiased': 94.635, 'valid/diff': 1.821, 'valid/acc_skew': 95.546, 'valid/acc_align': 93.725, 'test/acc': 91.675, 'test/acc_unbiased': 92.395, 'test/diff': 4.631, 'test/acc_skew': 91.402, 'test/acc_align': 93.387}
[10 / 10] best valid accuracy: 95.212 at epoch 9 
 best_stats: {'best_valid_epoch': 9, 'best_valid_valid/acc': 93.972, 'best_valid_valid/acc_unbiased': 95.212, 'best_valid_valid/diff': 1.507, 'best_valid_valid/acc_skew': 95.966, 'best_valid_valid/acc_align': 94.459, 'best_valid_test/acc': 91.005, 'best_valid_test/acc_unbiased': 92.273, 'best_valid_test/diff': 4.998, 'best_valid_test/acc_skew': 91.24, 'best_valid_test/acc_align': 93.305}
[10 / 10] best test accuracy: 92.395 at epoch 10 
 best_stats: {'best_test_epoch': 10, 'best_test_valid/acc': 94.133, 'best_test_valid/acc_unbiased': 94.635, 'best_test_valid/diff': 1.821, 'best_test_valid/acc_skew': 95.546, 'best_test_valid/acc_align': 93.725, 'best_test_test/acc': 91.675, 'best_test_test/acc_unbiased': 92.395, 'best_test_test/diff': 4.631, 'best_test_test/acc_skew': 91.402, 'best_test_test/acc_align': 93.387}
Total training time: 0:42:34
