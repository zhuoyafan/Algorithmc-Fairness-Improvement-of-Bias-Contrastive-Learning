Log level set to: INFO
Set seed: 3
=======> Using Fixed Random Seed: 3 <========
save_path: exp_results/bc-bb0-celeba_blonde-crop_auto2-lr0.001-bs128-cbs64-w0.01-ratio30-aug1-seed3
get_celeba - split:train, aug: False, given_y: True, ratio: 0
use existing blonde indices from data/celeba/pickles/blonde
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [1628, 53486]
Target 1: [18293, 1105]
Binary Target 1
---------------------------
Target 0: [1628, 53486]
Target 1: [18293, 1105]
===================================
Normal Label Distribution: 
Target 0: [1628, 53486]
Target 1: [18293, 1105]
===================================
Use BiasedCelebASplit 
 target_attr: blonde split: train 
 tensor([[ 1628., 18293.],
        [53486.,  1105.]])
get_celeba - split:train, aug: 1, given_y: True, ratio: 30
use existing blonde indices from data/celeba/pickles/blonde
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [1599, 53508]
Target 1: [18327, 1078]
Binary Target 1
---------------------------
Target 0: [1599, 53508]
Target 1: [18327, 1078]
===================================
Normal Label Distribution: 
Target 0: [1599, 53508]
Target 1: [18327, 1078]
===================================
Use BiasedCelebASplit 
 target_attr: blonde split: train 
 tensor([[ 1599., 18327.],
        [53508.,  1078.]])
get_celeba - split:train_valid, aug: False, given_y: True, ratio: 0
use existing blonde indices from data/celeba/pickles/blonde
Use BiasedCelebASplit 
 target_attr: blonde split: train_valid 
 tensor([[  386.,  4517.],
        [13446.,   280.]])
get_celeba - split:valid, aug: False, given_y: True, ratio: 0
Use BiasedCelebASplit 
 target_attr: blonde split: valid 
 tensor([[8535., 2874.],
        [8276.,  182.]])
decay_epochs: [3, 6]
[1 / 10] Learning rate: 0.001 weight: 0.01
[1 / 10] Loss: 4.762901048842535 CE Loss: 0.21959385949544752 Con Loss: 4.760705117890577
[1 / 10] tensor([[0.701, 0.846],
        [0.982, 0.940]]) {'epoch': 1, 'valid/acc': 87.455, 'valid/acc_unbiased': 88.35, 'valid/diff': 5.311, 'valid/acc_skew': 85.695, 'valid/acc_align': 91.005, 'test/acc': 80.42, 'test/acc_unbiased': 86.704, 'test/diff': 9.317, 'test/acc_skew': 82.045, 'test/acc_align': 91.363}
[1 / 10] best valid accuracy: 88.350 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 87.455, 'best_valid_valid/acc_unbiased': 88.35, 'best_valid_valid/diff': 5.311, 'best_valid_valid/acc_skew': 85.695, 'best_valid_valid/acc_align': 91.005, 'best_valid_test/acc': 80.42, 'best_valid_test/acc_unbiased': 86.704, 'best_valid_test/diff': 9.317, 'best_valid_test/acc_skew': 82.045, 'best_valid_test/acc_align': 91.363}
[1 / 10] best test accuracy: 86.704 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 87.455, 'best_test_valid/acc_unbiased': 88.35, 'best_test_valid/diff': 5.311, 'best_test_valid/acc_skew': 85.695, 'best_test_valid/acc_align': 91.005, 'best_test_test/acc': 80.42, 'best_test_test/acc_unbiased': 86.704, 'best_test_test/diff': 9.317, 'best_test_test/acc_skew': 82.045, 'best_test_test/acc_align': 91.363}
[2 / 10] Learning rate: 0.001 weight: 0.01
[2 / 10] Loss: 4.717606673610295 CE Loss: 0.1850098593247303 Con Loss: 4.715756570522381
[2 / 10] tensor([[0.921, 0.975],
        [0.875, 0.764]]) {'epoch': 2, 'valid/acc': 94.149, 'valid/acc_unbiased': 88.542, 'valid/diff': 7.041, 'valid/acc_skew': 85.021, 'valid/acc_align': 92.062, 'test/acc': 93.542, 'test/acc_unbiased': 88.371, 'test/diff': 8.301, 'test/acc_skew': 84.221, 'test/acc_align': 92.522}
[2 / 10] best valid accuracy: 88.542 at epoch 2 
 best_stats: {'best_valid_epoch': 2, 'best_valid_valid/acc': 94.149, 'best_valid_valid/acc_unbiased': 88.542, 'best_valid_valid/diff': 7.041, 'best_valid_valid/acc_skew': 85.021, 'best_valid_valid/acc_align': 92.062, 'best_valid_test/acc': 93.542, 'best_valid_test/acc_unbiased': 88.371, 'best_valid_test/diff': 8.301, 'best_valid_test/acc_skew': 84.221, 'best_valid_test/acc_align': 92.522}
[2 / 10] best test accuracy: 88.371 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 94.149, 'best_test_valid/acc_unbiased': 88.542, 'best_test_valid/diff': 7.041, 'best_test_valid/acc_skew': 85.021, 'best_test_valid/acc_align': 92.062, 'best_test_test/acc': 93.542, 'best_test_test/acc_unbiased': 88.371, 'best_test_test/diff': 8.301, 'best_test_test/acc_skew': 84.221, 'best_test_test/acc_align': 92.522}
[3 / 10] Learning rate: 0.001 weight: 0.01
[3 / 10] Loss: 4.701493356420882 CE Loss: 0.1773618140596067 Con Loss: 4.699719728613606
[3 / 10] tensor([[0.899, 0.977],
        [0.892, 0.698]]) {'epoch': 3, 'valid/acc': 94.6, 'valid/acc_unbiased': 88.511, 'valid/diff': 8.793, 'valid/acc_skew': 84.115, 'valid/acc_align': 92.908, 'test/acc': 92.857, 'test/acc_unbiased': 86.638, 'test/diff': 13.631, 'test/acc_skew': 79.823, 'test/acc_align': 93.454}
[3 / 10] best valid accuracy: 88.542 at epoch 2 
 best_stats: {'best_valid_epoch': 2, 'best_valid_valid/acc': 94.149, 'best_valid_valid/acc_unbiased': 88.542, 'best_valid_valid/diff': 7.041, 'best_valid_valid/acc_skew': 85.021, 'best_valid_valid/acc_align': 92.062, 'best_valid_test/acc': 93.542, 'best_valid_test/acc_unbiased': 88.371, 'best_valid_test/diff': 8.301, 'best_valid_test/acc_skew': 84.221, 'best_valid_test/acc_align': 92.522}
[3 / 10] best test accuracy: 88.371 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 94.149, 'best_test_valid/acc_unbiased': 88.542, 'best_test_valid/diff': 7.041, 'best_test_valid/acc_skew': 85.021, 'best_test_valid/acc_align': 92.062, 'best_test_test/acc': 93.542, 'best_test_test/acc_unbiased': 88.371, 'best_test_test/diff': 8.301, 'best_test_test/acc_skew': 84.221, 'best_test_test/acc_align': 92.522}
[4 / 10] Learning rate: 0.0001 weight: 0.01
[4 / 10] Loss: 4.6457233965486475 CE Loss: 0.14719484558471774 Con Loss: 4.644251442119393
[4 / 10] tensor([[0.923, 0.973],
        [0.892, 0.813]]) {'epoch': 4, 'valid/acc': 94.455, 'valid/acc_unbiased': 90.755, 'valid/diff': 5.348, 'valid/acc_skew': 88.785, 'valid/acc_align': 92.725, 'test/acc': 93.829, 'test/acc_unbiased': 90.023, 'test/diff': 6.39, 'test/acc_skew': 86.828, 'test/acc_align': 93.218}
[4 / 10] best valid accuracy: 90.755 at epoch 4 
 best_stats: {'best_valid_epoch': 4, 'best_valid_valid/acc': 94.455, 'best_valid_valid/acc_unbiased': 90.755, 'best_valid_valid/diff': 5.348, 'best_valid_valid/acc_skew': 88.785, 'best_valid_valid/acc_align': 92.725, 'best_valid_test/acc': 93.829, 'best_valid_test/acc_unbiased': 90.023, 'best_valid_test/diff': 6.39, 'best_valid_test/acc_skew': 86.828, 'best_valid_test/acc_align': 93.218}
[4 / 10] best test accuracy: 90.023 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 94.455, 'best_test_valid/acc_unbiased': 90.755, 'best_test_valid/diff': 5.348, 'best_test_valid/acc_skew': 88.785, 'best_test_valid/acc_align': 92.725, 'best_test_test/acc': 93.829, 'best_test_test/acc_unbiased': 90.023, 'best_test_test/diff': 6.39, 'best_test_test/acc_skew': 86.828, 'best_test_test/acc_align': 93.218}
[5 / 10] Learning rate: 0.0001 weight: 0.01
[5 / 10] Loss: 4.628073476685304 CE Loss: 0.14280227730912612 Con Loss: 4.626645454859718
[5 / 10] tensor([[0.905, 0.969],
        [0.914, 0.808]]) {'epoch': 5, 'valid/acc': 94.852, 'valid/acc_unbiased': 91.358, 'valid/diff': 5.437, 'valid/acc_skew': 88.852, 'valid/acc_align': 93.864, 'test/acc': 93.22, 'test/acc_unbiased': 89.907, 'test/diff': 8.546, 'test/acc_skew': 85.634, 'test/acc_align': 94.18}
[5 / 10] best valid accuracy: 91.358 at epoch 5 
 best_stats: {'best_valid_epoch': 5, 'best_valid_valid/acc': 94.852, 'best_valid_valid/acc_unbiased': 91.358, 'best_valid_valid/diff': 5.437, 'best_valid_valid/acc_skew': 88.852, 'best_valid_valid/acc_align': 93.864, 'best_valid_test/acc': 93.22, 'best_valid_test/acc_unbiased': 89.907, 'best_valid_test/diff': 8.546, 'best_valid_test/acc_skew': 85.634, 'best_valid_test/acc_align': 94.18}
[5 / 10] best test accuracy: 90.023 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 94.455, 'best_test_valid/acc_unbiased': 90.755, 'best_test_valid/diff': 5.348, 'best_test_valid/acc_skew': 88.785, 'best_test_valid/acc_align': 92.725, 'best_test_test/acc': 93.829, 'best_test_test/acc_unbiased': 90.023, 'best_test_test/diff': 6.39, 'best_test_test/acc_skew': 86.828, 'best_test_test/acc_align': 93.218}
[6 / 10] Learning rate: 0.0001 weight: 0.01
[6 / 10] Loss: 4.612823073178472 CE Loss: 0.14312381629322332 Con Loss: 4.611391831242989
[6 / 10] tensor([[0.920, 0.974],
        [0.906, 0.797]]) {'epoch': 6, 'valid/acc': 94.949, 'valid/acc_unbiased': 91.604, 'valid/diff': 5.386, 'valid/acc_skew': 89.759, 'valid/acc_align': 93.449, 'test/acc': 93.92, 'test/acc_unbiased': 89.905, 'test/diff': 8.188, 'test/acc_skew': 85.811, 'test/acc_align': 93.998}
[6 / 10] best valid accuracy: 91.604 at epoch 6 
 best_stats: {'best_valid_epoch': 6, 'best_valid_valid/acc': 94.949, 'best_valid_valid/acc_unbiased': 91.604, 'best_valid_valid/diff': 5.386, 'best_valid_valid/acc_skew': 89.759, 'best_valid_valid/acc_align': 93.449, 'best_valid_test/acc': 93.92, 'best_valid_test/acc_unbiased': 89.905, 'best_valid_test/diff': 8.188, 'best_valid_test/acc_skew': 85.811, 'best_valid_test/acc_align': 93.998}
[6 / 10] best test accuracy: 90.023 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 94.455, 'best_test_valid/acc_unbiased': 90.755, 'best_test_valid/diff': 5.348, 'best_test_valid/acc_skew': 88.785, 'best_test_valid/acc_align': 92.725, 'best_test_test/acc': 93.829, 'best_test_test/acc_unbiased': 90.023, 'best_test_test/diff': 6.39, 'best_test_test/acc_skew': 86.828, 'best_test_test/acc_align': 93.218}
[7 / 10] Learning rate: 1e-05 weight: 0.01
[7 / 10] Loss: 4.6028597870430055 CE Loss: 0.13740132139851305 Con Loss: 4.601485760446933
[7 / 10] tensor([[0.919, 0.974],
        [0.903, 0.797]]) {'epoch': 7, 'valid/acc': 94.815, 'valid/acc_unbiased': 91.294, 'valid/diff': 5.592, 'valid/acc_skew': 89.272, 'valid/acc_align': 93.316, 'test/acc': 93.849, 'test/acc_unbiased': 89.811, 'test/diff': 8.013, 'test/acc_skew': 85.805, 'test/acc_align': 93.818}
[7 / 10] best valid accuracy: 91.604 at epoch 6 
 best_stats: {'best_valid_epoch': 6, 'best_valid_valid/acc': 94.949, 'best_valid_valid/acc_unbiased': 91.604, 'best_valid_valid/diff': 5.386, 'best_valid_valid/acc_skew': 89.759, 'best_valid_valid/acc_align': 93.449, 'best_valid_test/acc': 93.92, 'best_valid_test/acc_unbiased': 89.905, 'best_valid_test/diff': 8.188, 'best_valid_test/acc_skew': 85.811, 'best_valid_test/acc_align': 93.998}
[7 / 10] best test accuracy: 90.023 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 94.455, 'best_test_valid/acc_unbiased': 90.755, 'best_test_valid/diff': 5.348, 'best_test_valid/acc_skew': 88.785, 'best_test_valid/acc_align': 92.725, 'best_test_test/acc': 93.829, 'best_test_test/acc_unbiased': 90.023, 'best_test_test/diff': 6.39, 'best_test_test/acc_skew': 86.828, 'best_test_test/acc_align': 93.218}
[8 / 10] Learning rate: 1e-05 weight: 0.01
[8 / 10] Loss: 4.604090192478205 CE Loss: 0.13739603100312942 Con Loss: 4.602716231207902
[8 / 10] tensor([[0.921, 0.975],
        [0.902, 0.802]]) {'epoch': 8, 'valid/acc': 94.804, 'valid/acc_unbiased': 90.973, 'valid/diff': 5.902, 'valid/acc_skew': 88.736, 'valid/acc_align': 93.209, 'test/acc': 93.93, 'test/acc_unbiased': 89.976, 'test/diff': 7.676, 'test/acc_skew': 86.138, 'test/acc_align': 93.814}
[8 / 10] best valid accuracy: 91.604 at epoch 6 
 best_stats: {'best_valid_epoch': 6, 'best_valid_valid/acc': 94.949, 'best_valid_valid/acc_unbiased': 91.604, 'best_valid_valid/diff': 5.386, 'best_valid_valid/acc_skew': 89.759, 'best_valid_valid/acc_align': 93.449, 'best_valid_test/acc': 93.92, 'best_valid_test/acc_unbiased': 89.905, 'best_valid_test/diff': 8.188, 'best_valid_test/acc_skew': 85.811, 'best_valid_test/acc_align': 93.998}
[8 / 10] best test accuracy: 90.023 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 94.455, 'best_test_valid/acc_unbiased': 90.755, 'best_test_valid/diff': 5.348, 'best_test_valid/acc_skew': 88.785, 'best_test_valid/acc_align': 92.725, 'best_test_test/acc': 93.829, 'best_test_test/acc_unbiased': 90.023, 'best_test_test/diff': 6.39, 'best_test_test/acc_skew': 86.828, 'best_test_test/acc_align': 93.218}
[9 / 10] Learning rate: 1e-05 weight: 0.01
[9 / 10] Loss: 4.60106939682767 CE Loss: 0.1363788652514756 Con Loss: 4.599705610506673
[9 / 10] tensor([[0.923, 0.977],
        [0.897, 0.775]]) {'epoch': 9, 'valid/acc': 94.836, 'valid/acc_unbiased': 90.743, 'valid/diff': 5.964, 'valid/acc_skew': 88.379, 'valid/acc_align': 93.107, 'test/acc': 94.055, 'test/acc_unbiased': 89.309, 'test/diff': 8.809, 'test/acc_skew': 84.905, 'test/acc_align': 93.714}
[9 / 10] best valid accuracy: 91.604 at epoch 6 
 best_stats: {'best_valid_epoch': 6, 'best_valid_valid/acc': 94.949, 'best_valid_valid/acc_unbiased': 91.604, 'best_valid_valid/diff': 5.386, 'best_valid_valid/acc_skew': 89.759, 'best_valid_valid/acc_align': 93.449, 'best_valid_test/acc': 93.92, 'best_valid_test/acc_unbiased': 89.905, 'best_valid_test/diff': 8.188, 'best_valid_test/acc_skew': 85.811, 'best_valid_test/acc_align': 93.998}
[9 / 10] best test accuracy: 90.023 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 94.455, 'best_test_valid/acc_unbiased': 90.755, 'best_test_valid/diff': 5.348, 'best_test_valid/acc_skew': 88.785, 'best_test_valid/acc_align': 92.725, 'best_test_test/acc': 93.829, 'best_test_test/acc_unbiased': 90.023, 'best_test_test/diff': 6.39, 'best_test_test/acc_skew': 86.828, 'best_test_test/acc_align': 93.218}
[10 / 10] Learning rate: 1e-05 weight: 0.01
[10 / 10] Loss: 4.597267662529171 CE Loss: 0.13435741116080593 Con Loss: 4.595924085011317
[10 / 10] tensor([[0.922, 0.977],
        [0.897, 0.808]]) {'epoch': 10, 'valid/acc': 94.976, 'valid/acc_unbiased': 90.946, 'valid/diff': 6.37, 'valid/acc_skew': 88.509, 'valid/acc_align': 93.384, 'test/acc': 94.03, 'test/acc_unbiased': 90.101, 'test/diff': 7.201, 'test/acc_skew': 86.501, 'test/acc_align': 93.702}
[10 / 10] best valid accuracy: 91.604 at epoch 6 
 best_stats: {'best_valid_epoch': 6, 'best_valid_valid/acc': 94.949, 'best_valid_valid/acc_unbiased': 91.604, 'best_valid_valid/diff': 5.386, 'best_valid_valid/acc_skew': 89.759, 'best_valid_valid/acc_align': 93.449, 'best_valid_test/acc': 93.92, 'best_valid_test/acc_unbiased': 89.905, 'best_valid_test/diff': 8.188, 'best_valid_test/acc_skew': 85.811, 'best_valid_test/acc_align': 93.998}
[10 / 10] best test accuracy: 90.101 at epoch 10 
 best_stats: {'best_test_epoch': 10, 'best_test_valid/acc': 94.976, 'best_test_valid/acc_unbiased': 90.946, 'best_test_valid/diff': 6.37, 'best_test_valid/acc_skew': 88.509, 'best_test_valid/acc_align': 93.384, 'best_test_test/acc': 94.03, 'best_test_test/acc_unbiased': 90.101, 'best_test_test/diff': 7.201, 'best_test_test/acc_skew': 86.501, 'best_test_test/acc_align': 93.702}
Total training time: 1:28:46
