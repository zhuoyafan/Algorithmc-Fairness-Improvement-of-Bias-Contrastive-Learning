Log level set to: INFO
Set seed: 1
=======> Using Fixed Random Seed: 1 <========
save_path: exp_results/bc-bb0-celeba_smiling-os_trival-lr0.001-bs128-cbs64-w0.01-ratio30-aug1-seed1
get_celeba - split:train, aug: False, given_y: True, ratio: 0
use existing smiling indices from data/celeba/pickles/smiling
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [40613, 40613]
Target 1: [40613, 40613]
Binary Target 1
---------------------------
Target 0: [40613, 40613]
Target 1: [40613, 40613]
===================================
Normal Label Distribution: 
Target 0: [40613, 40613]
Target 1: [40613, 40613]
===================================
Use BiasedCelebASplit 
 target_attr: smiling split: train 
 tensor([[40613., 40613.],
        [40613., 40613.]])
get_celeba - split:train, aug: 1, given_y: True, ratio: 30
use existing smiling indices from data/celeba/pickles/smiling
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [40701, 40701]
Target 1: [40701, 40701]
Binary Target 1
---------------------------
Target 0: [40701, 40701]
Target 1: [40701, 40701]
===================================
Normal Label Distribution: 
Target 0: [40701, 40701]
Target 1: [40701, 40701]
===================================
Use BiasedCelebASplit 
 target_attr: smiling split: train 
 tensor([[40701., 40701.],
        [40701., 40701.]])
get_celeba - split:train_valid, aug: False, given_y: True, ratio: 0
use existing smiling indices from data/celeba/pickles/smiling
Use BiasedCelebASplit 
 target_attr: smiling split: train_valid 
 tensor([[ 2019., 10233.],
        [ 8156.,  1957.]])
get_celeba - split:valid, aug: False, given_y: True, ratio: 0
Use BiasedCelebASplit 
 target_attr: smiling split: valid 
 tensor([[5252., 6157.],
        [5013., 3445.]])
decay_epochs: [3, 6]
[1 / 10] Learning rate: 0.001 weight: 0.01
[1 / 10] Loss: 4.692777778914881 CE Loss: 0.25841215520937943 Con Loss: 4.690193654022488
[1 / 10] tensor([[0.892, 0.859],
        [0.947, 0.940]]) {'epoch': 1, 'valid/acc': 90.521, 'valid/acc_unbiased': 90.671, 'valid/diff': 2.147, 'valid/acc_skew': 91.744, 'valid/acc_align': 89.597, 'test/acc': 90.889, 'test/acc_unbiased': 90.942, 'test/diff': 1.958, 'test/acc_skew': 91.921, 'test/acc_align': 89.963}
[1 / 10] best valid accuracy: 90.671 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 90.521, 'best_valid_valid/acc_unbiased': 90.671, 'best_valid_valid/diff': 2.147, 'best_valid_valid/acc_skew': 91.744, 'best_valid_valid/acc_align': 89.597, 'best_valid_test/acc': 90.889, 'best_valid_test/acc_unbiased': 90.942, 'best_valid_test/diff': 1.958, 'best_valid_test/acc_skew': 91.921, 'best_valid_test/acc_align': 89.963}
[1 / 10] best test accuracy: 90.942 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 90.521, 'best_test_valid/acc_unbiased': 90.671, 'best_test_valid/diff': 2.147, 'best_test_valid/acc_skew': 91.744, 'best_test_valid/acc_align': 89.597, 'best_test_test/acc': 90.889, 'best_test_test/acc_unbiased': 90.942, 'best_test_test/diff': 1.958, 'best_test_test/acc_skew': 91.921, 'best_test_test/acc_align': 89.963}
[2 / 10] Learning rate: 0.001 weight: 0.01
[2 / 10] Loss: 4.65356506701483 CE Loss: 0.2253002935142074 Con Loss: 4.651312065098682
[2 / 10] tensor([[0.939, 0.924],
        [0.909, 0.901]]) {'epoch': 2, 'valid/acc': 91.438, 'valid/acc_unbiased': 91.794, 'valid/diff': 1.839, 'valid/acc_skew': 92.714, 'valid/acc_align': 90.875, 'test/acc': 91.906, 'test/acc_unbiased': 91.799, 'test/diff': 1.165, 'test/acc_skew': 92.382, 'test/acc_align': 91.216}
[2 / 10] best valid accuracy: 91.794 at epoch 2 
 best_stats: {'best_valid_epoch': 2, 'best_valid_valid/acc': 91.438, 'best_valid_valid/acc_unbiased': 91.794, 'best_valid_valid/diff': 1.839, 'best_valid_valid/acc_skew': 92.714, 'best_valid_valid/acc_align': 90.875, 'best_valid_test/acc': 91.906, 'best_valid_test/acc_unbiased': 91.799, 'best_valid_test/diff': 1.165, 'best_valid_test/acc_skew': 92.382, 'best_valid_test/acc_align': 91.216}
[2 / 10] best test accuracy: 91.799 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 91.438, 'best_test_valid/acc_unbiased': 91.794, 'best_test_valid/diff': 1.839, 'best_test_valid/acc_skew': 92.714, 'best_test_valid/acc_align': 90.875, 'best_test_test/acc': 91.906, 'best_test_test/acc_unbiased': 91.799, 'best_test_test/diff': 1.165, 'best_test_test/acc_skew': 92.382, 'best_test_test/acc_align': 91.216}
[3 / 10] Learning rate: 0.001 weight: 0.01
[3 / 10] Loss: 4.641603697647479 CE Loss: 0.22189021075605198 Con Loss: 4.639384799526898
[3 / 10] tensor([[0.967, 0.949],
        [0.880, 0.858]]) {'epoch': 3, 'valid/acc': 91.241, 'valid/acc_unbiased': 91.794, 'valid/diff': 1.612, 'valid/acc_skew': 92.6, 'valid/acc_align': 90.988, 'test/acc': 91.655, 'test/acc_unbiased': 91.346, 'test/diff': 1.993, 'test/acc_skew': 92.342, 'test/acc_align': 90.349}
[3 / 10] best valid accuracy: 91.794 at epoch 2 
 best_stats: {'best_valid_epoch': 2, 'best_valid_valid/acc': 91.438, 'best_valid_valid/acc_unbiased': 91.794, 'best_valid_valid/diff': 1.839, 'best_valid_valid/acc_skew': 92.714, 'best_valid_valid/acc_align': 90.875, 'best_valid_test/acc': 91.906, 'best_valid_test/acc_unbiased': 91.799, 'best_valid_test/diff': 1.165, 'best_valid_test/acc_skew': 92.382, 'best_valid_test/acc_align': 91.216}
[3 / 10] best test accuracy: 91.799 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 91.438, 'best_test_valid/acc_unbiased': 91.794, 'best_test_valid/diff': 1.839, 'best_test_valid/acc_skew': 92.714, 'best_test_valid/acc_align': 90.875, 'best_test_test/acc': 91.906, 'best_test_test/acc_unbiased': 91.799, 'best_test_test/diff': 1.165, 'best_test_test/acc_skew': 92.382, 'best_test_test/acc_align': 91.216}
[4 / 10] Learning rate: 0.0001 weight: 0.01
[4 / 10] Loss: 4.5994201146886775 CE Loss: 0.19498445806934073 Con Loss: 4.597470269524772
[4 / 10] tensor([[0.953, 0.933],
        [0.911, 0.904]]) {'epoch': 4, 'valid/acc': 92.216, 'valid/acc_unbiased': 92.699, 'valid/diff': 1.655, 'valid/acc_skew': 93.527, 'valid/acc_align': 91.872, 'test/acc': 92.616, 'test/acc_unbiased': 92.497, 'test/diff': 1.334, 'test/acc_skew': 93.164, 'test/acc_align': 91.83}
[4 / 10] best valid accuracy: 92.699 at epoch 4 
 best_stats: {'best_valid_epoch': 4, 'best_valid_valid/acc': 92.216, 'best_valid_valid/acc_unbiased': 92.699, 'best_valid_valid/diff': 1.655, 'best_valid_valid/acc_skew': 93.527, 'best_valid_valid/acc_align': 91.872, 'best_valid_test/acc': 92.616, 'best_valid_test/acc_unbiased': 92.497, 'best_valid_test/diff': 1.334, 'best_valid_test/acc_skew': 93.164, 'best_valid_test/acc_align': 91.83}
[4 / 10] best test accuracy: 92.497 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 92.216, 'best_test_valid/acc_unbiased': 92.699, 'best_test_valid/diff': 1.655, 'best_test_valid/acc_skew': 93.527, 'best_test_valid/acc_align': 91.872, 'best_test_test/acc': 92.616, 'best_test_test/acc_unbiased': 92.497, 'best_test_test/diff': 1.334, 'best_test_test/acc_skew': 93.164, 'best_test_test/acc_align': 91.83}
[5 / 10] Learning rate: 0.0001 weight: 0.01
[5 / 10] Loss: 4.580681976499359 CE Loss: 0.18878076260641274 Con Loss: 4.578794171896857
[5 / 10] tensor([[0.945, 0.935],
        [0.921, 0.904]]) {'epoch': 5, 'valid/acc': 92.578, 'valid/acc_unbiased': 92.639, 'valid/diff': 1.55, 'valid/acc_skew': 93.414, 'valid/acc_align': 91.864, 'test/acc': 92.802, 'test/acc_unbiased': 92.638, 'test/diff': 1.318, 'test/acc_skew': 93.297, 'test/acc_align': 91.979}
[5 / 10] best valid accuracy: 92.699 at epoch 4 
 best_stats: {'best_valid_epoch': 4, 'best_valid_valid/acc': 92.216, 'best_valid_valid/acc_unbiased': 92.699, 'best_valid_valid/diff': 1.655, 'best_valid_valid/acc_skew': 93.527, 'best_valid_valid/acc_align': 91.872, 'best_valid_test/acc': 92.616, 'best_valid_test/acc_unbiased': 92.497, 'best_valid_test/diff': 1.334, 'best_valid_test/acc_skew': 93.164, 'best_valid_test/acc_align': 91.83}
[5 / 10] best test accuracy: 92.638 at epoch 5 
 best_stats: {'best_test_epoch': 5, 'best_test_valid/acc': 92.578, 'best_test_valid/acc_unbiased': 92.639, 'best_test_valid/diff': 1.55, 'best_test_valid/acc_skew': 93.414, 'best_test_valid/acc_align': 91.864, 'best_test_test/acc': 92.802, 'best_test_test/acc_unbiased': 92.638, 'best_test_test/diff': 1.318, 'best_test_test/acc_skew': 93.297, 'best_test_test/acc_align': 91.979}
[6 / 10] Learning rate: 0.0001 weight: 0.01
[6 / 10] Loss: 4.574767328261437 CE Loss: 0.1873018486479445 Con Loss: 4.572894307418953
[6 / 10] tensor([[0.962, 0.951],
        [0.904, 0.882]]) {'epoch': 6, 'valid/acc': 92.43, 'valid/acc_unbiased': 92.673, 'valid/diff': 2.047, 'valid/acc_skew': 93.697, 'valid/acc_align': 91.65, 'test/acc': 92.712, 'test/acc_unbiased': 92.449, 'test/diff': 1.66, 'test/acc_skew': 93.279, 'test/acc_align': 91.619}
[6 / 10] best valid accuracy: 92.699 at epoch 4 
 best_stats: {'best_valid_epoch': 4, 'best_valid_valid/acc': 92.216, 'best_valid_valid/acc_unbiased': 92.699, 'best_valid_valid/diff': 1.655, 'best_valid_valid/acc_skew': 93.527, 'best_valid_valid/acc_align': 91.872, 'best_valid_test/acc': 92.616, 'best_valid_test/acc_unbiased': 92.497, 'best_valid_test/diff': 1.334, 'best_valid_test/acc_skew': 93.164, 'best_valid_test/acc_align': 91.83}
[6 / 10] best test accuracy: 92.638 at epoch 5 
 best_stats: {'best_test_epoch': 5, 'best_test_valid/acc': 92.578, 'best_test_valid/acc_unbiased': 92.639, 'best_test_valid/diff': 1.55, 'best_test_valid/acc_skew': 93.414, 'best_test_valid/acc_align': 91.864, 'best_test_test/acc': 92.802, 'best_test_test/acc_unbiased': 92.638, 'best_test_test/diff': 1.318, 'best_test_test/acc_skew': 93.297, 'best_test_test/acc_align': 91.979}
[7 / 10] Learning rate: 1e-05 weight: 0.01
[7 / 10] Loss: 4.563875049852372 CE Loss: 0.1838252488201303 Con Loss: 4.562036798132598
[7 / 10] tensor([[0.945, 0.934],
        [0.925, 0.906]]) {'epoch': 7, 'valid/acc': 92.774, 'valid/acc_unbiased': 92.919, 'valid/diff': 1.886, 'valid/acc_skew': 93.862, 'valid/acc_align': 91.976, 'test/acc': 92.923, 'test/acc_unbiased': 92.744, 'test/diff': 1.516, 'test/acc_skew': 93.502, 'test/acc_align': 91.986}
[7 / 10] best valid accuracy: 92.919 at epoch 7 
 best_stats: {'best_valid_epoch': 7, 'best_valid_valid/acc': 92.774, 'best_valid_valid/acc_unbiased': 92.919, 'best_valid_valid/diff': 1.886, 'best_valid_valid/acc_skew': 93.862, 'best_valid_valid/acc_align': 91.976, 'best_valid_test/acc': 92.923, 'best_valid_test/acc_unbiased': 92.744, 'best_valid_test/diff': 1.516, 'best_valid_test/acc_skew': 93.502, 'best_valid_test/acc_align': 91.986}
[7 / 10] best test accuracy: 92.744 at epoch 7 
 best_stats: {'best_test_epoch': 7, 'best_test_valid/acc': 92.774, 'best_test_valid/acc_unbiased': 92.919, 'best_test_valid/diff': 1.886, 'best_test_valid/acc_skew': 93.862, 'best_test_valid/acc_align': 91.976, 'best_test_test/acc': 92.923, 'best_test_test/acc_unbiased': 92.744, 'best_test_test/diff': 1.516, 'best_test_test/acc_skew': 93.502, 'best_test_test/acc_align': 91.986}
[8 / 10] Learning rate: 1e-05 weight: 0.01
[8 / 10] Loss: 4.5623609705670845 CE Loss: 0.18201341496142234 Con Loss: 4.560540835160505
[8 / 10] tensor([[0.943, 0.931],
        [0.925, 0.910]]) {'epoch': 8, 'valid/acc': 92.734, 'valid/acc_unbiased': 92.877, 'valid/diff': 1.544, 'valid/acc_skew': 93.649, 'valid/acc_align': 92.105, 'test/acc': 92.878, 'test/acc_unbiased': 92.733, 'test/diff': 1.386, 'test/acc_skew': 93.426, 'test/acc_align': 92.04}
[8 / 10] best valid accuracy: 92.919 at epoch 7 
 best_stats: {'best_valid_epoch': 7, 'best_valid_valid/acc': 92.774, 'best_valid_valid/acc_unbiased': 92.919, 'best_valid_valid/diff': 1.886, 'best_valid_valid/acc_skew': 93.862, 'best_valid_valid/acc_align': 91.976, 'best_valid_test/acc': 92.923, 'best_valid_test/acc_unbiased': 92.744, 'best_valid_test/diff': 1.516, 'best_valid_test/acc_skew': 93.502, 'best_valid_test/acc_align': 91.986}
[8 / 10] best test accuracy: 92.744 at epoch 7 
 best_stats: {'best_test_epoch': 7, 'best_test_valid/acc': 92.774, 'best_test_valid/acc_unbiased': 92.919, 'best_test_valid/diff': 1.886, 'best_test_valid/acc_skew': 93.862, 'best_test_valid/acc_align': 91.976, 'best_test_test/acc': 92.923, 'best_test_test/acc_unbiased': 92.744, 'best_test_test/diff': 1.516, 'best_test_test/acc_skew': 93.502, 'best_test_test/acc_align': 91.986}
[9 / 10] Learning rate: 1e-05 weight: 0.01
[9 / 10] Loss: 4.565014912624048 CE Loss: 0.18166700499607188 Con Loss: 4.563198241070227
[9 / 10] tensor([[0.953, 0.939],
        [0.918, 0.904]]) {'epoch': 9, 'valid/acc': 92.721, 'valid/acc_unbiased': 92.997, 'valid/diff': 1.81, 'valid/acc_skew': 93.901, 'valid/acc_align': 92.092, 'test/acc': 93.024, 'test/acc_unbiased': 92.862, 'test/diff': 1.387, 'test/acc_skew': 93.556, 'test/acc_align': 92.168}
[9 / 10] best valid accuracy: 92.997 at epoch 9 
 best_stats: {'best_valid_epoch': 9, 'best_valid_valid/acc': 92.721, 'best_valid_valid/acc_unbiased': 92.997, 'best_valid_valid/diff': 1.81, 'best_valid_valid/acc_skew': 93.901, 'best_valid_valid/acc_align': 92.092, 'best_valid_test/acc': 93.024, 'best_valid_test/acc_unbiased': 92.862, 'best_valid_test/diff': 1.387, 'best_valid_test/acc_skew': 93.556, 'best_valid_test/acc_align': 92.168}
[9 / 10] best test accuracy: 92.862 at epoch 9 
 best_stats: {'best_test_epoch': 9, 'best_test_valid/acc': 92.721, 'best_test_valid/acc_unbiased': 92.997, 'best_test_valid/diff': 1.81, 'best_test_valid/acc_skew': 93.901, 'best_test_valid/acc_align': 92.092, 'best_test_test/acc': 93.024, 'best_test_test/acc_unbiased': 92.862, 'best_test_test/diff': 1.387, 'best_test_test/acc_skew': 93.556, 'best_test_test/acc_align': 92.168}
[10 / 10] Learning rate: 1e-05 weight: 0.01
[10 / 10] Loss: 4.5630648627206165 CE Loss: 0.18100978106401924 Con Loss: 4.5612547624977955
[10 / 10] tensor([[0.958, 0.944],
        [0.914, 0.896]]) {'epoch': 10, 'valid/acc': 92.631, 'valid/acc_unbiased': 92.943, 'valid/diff': 1.924, 'valid/acc_skew': 93.905, 'valid/acc_align': 91.981, 'test/acc': 92.993, 'test/acc_unbiased': 92.783, 'test/diff': 1.612, 'test/acc_skew': 93.589, 'test/acc_align': 91.977}
[10 / 10] best valid accuracy: 92.997 at epoch 9 
 best_stats: {'best_valid_epoch': 9, 'best_valid_valid/acc': 92.721, 'best_valid_valid/acc_unbiased': 92.997, 'best_valid_valid/diff': 1.81, 'best_valid_valid/acc_skew': 93.901, 'best_valid_valid/acc_align': 92.092, 'best_valid_test/acc': 93.024, 'best_valid_test/acc_unbiased': 92.862, 'best_valid_test/diff': 1.387, 'best_valid_test/acc_skew': 93.556, 'best_valid_test/acc_align': 92.168}
[10 / 10] best test accuracy: 92.862 at epoch 9 
 best_stats: {'best_test_epoch': 9, 'best_test_valid/acc': 92.721, 'best_test_valid/acc_unbiased': 92.997, 'best_test_valid/diff': 1.81, 'best_test_valid/acc_skew': 93.901, 'best_test_valid/acc_align': 92.092, 'best_test_test/acc': 93.024, 'best_test_test/acc_unbiased': 92.862, 'best_test_test/diff': 1.387, 'best_test_test/acc_skew': 93.556, 'best_test_test/acc_align': 92.168}
Total training time: 2:34:39
