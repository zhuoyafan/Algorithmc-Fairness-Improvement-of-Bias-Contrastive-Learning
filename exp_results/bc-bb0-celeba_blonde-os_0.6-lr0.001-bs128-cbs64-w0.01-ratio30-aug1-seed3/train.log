Log level set to: INFO
Set seed: 3
=======> Using Fixed Random Seed: 3 <========
save_path: exp_results/bc-bb0-celeba_blonde-os_0.6-lr0.001-bs128-cbs64-w0.01-ratio30-aug1-seed3
get_celeba - split:train, aug: False, given_y: True, ratio: 0
use existing blonde indices from data/celeba/pickles/blonde
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [32091, 32091]
Target 1: [32091, 32091]
Binary Target 1
---------------------------
Target 0: [32091, 32091]
Target 1: [32091, 32091]
===================================
Normal Label Distribution: 
Target 0: [32091, 32091]
Target 1: [32091, 32091]
===================================
Use BiasedCelebASplit 
 target_attr: blonde split: train 
 tensor([[32091., 32091.],
        [32091., 32091.]])
get_celeba - split:train, aug: 1, given_y: True, ratio: 30
use existing blonde indices from data/celeba/pickles/blonde
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [32104, 32104]
Target 1: [32104, 32104]
Binary Target 1
---------------------------
Target 0: [32104, 32104]
Target 1: [32104, 32104]
===================================
Normal Label Distribution: 
Target 0: [32104, 32104]
Target 1: [32104, 32104]
===================================
Use BiasedCelebASplit 
 target_attr: blonde split: train 
 tensor([[32104., 32104.],
        [32104., 32104.]])
get_celeba - split:train_valid, aug: False, given_y: True, ratio: 0
use existing blonde indices from data/celeba/pickles/blonde
Use BiasedCelebASplit 
 target_attr: blonde split: train_valid 
 tensor([[  386.,  4517.],
        [13446.,   280.]])
get_celeba - split:valid, aug: False, given_y: True, ratio: 0
Use BiasedCelebASplit 
 target_attr: blonde split: valid 
 tensor([[8535., 2874.],
        [8276.,  182.]])
decay_epochs: [3, 6]
[1 / 10] Learning rate: 0.001 weight: 0.01
[1 / 10] Loss: 4.6263127181942405 CE Loss: 0.2516994517347514 Con Loss: 4.6237957186706495
[1 / 10] tensor([[0.873, 0.927],
        [0.913, 0.879]]) {'epoch': 1, 'valid/acc': 91.599, 'valid/acc_unbiased': 90.665, 'valid/diff': 0.701, 'valid/acc_skew': 91.016, 'valid/acc_align': 90.314, 'test/acc': 90.16, 'test/acc_unbiased': 89.824, 'test/diff': 4.39, 'test/acc_skew': 89.341, 'test/acc_align': 90.307}
[1 / 10] best valid accuracy: 90.665 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 91.599, 'best_valid_valid/acc_unbiased': 90.665, 'best_valid_valid/diff': 0.701, 'best_valid_valid/acc_skew': 91.016, 'best_valid_valid/acc_align': 90.314, 'best_valid_test/acc': 90.16, 'best_valid_test/acc_unbiased': 89.824, 'best_valid_test/diff': 4.39, 'best_valid_test/acc_skew': 89.341, 'best_valid_test/acc_align': 90.307}
[1 / 10] best test accuracy: 89.824 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 91.599, 'best_test_valid/acc_unbiased': 90.665, 'best_test_valid/diff': 0.701, 'best_test_valid/acc_skew': 91.016, 'best_test_valid/acc_align': 90.314, 'best_test_test/acc': 90.16, 'best_test_test/acc_unbiased': 89.824, 'best_test_test/diff': 4.39, 'best_test_test/acc_skew': 89.341, 'best_test_test/acc_align': 90.307}
[2 / 10] Learning rate: 0.001 weight: 0.01
[2 / 10] Loss: 4.5766890671346 CE Loss: 0.21478864373537362 Con Loss: 4.5745411812209715
[2 / 10] tensor([[0.946, 0.979],
        [0.804, 0.670]]) {'epoch': 2, 'valid/acc': 92.737, 'valid/acc_unbiased': 86.272, 'valid/diff': 5.519, 'valid/acc_skew': 89.031, 'valid/acc_align': 83.512, 'test/acc': 93.658, 'test/acc_unbiased': 84.974, 'test/diff': 8.362, 'test/acc_skew': 87.464, 'test/acc_align': 82.483}
[2 / 10] best valid accuracy: 90.665 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 91.599, 'best_valid_valid/acc_unbiased': 90.665, 'best_valid_valid/diff': 0.701, 'best_valid_valid/acc_skew': 91.016, 'best_valid_valid/acc_align': 90.314, 'best_valid_test/acc': 90.16, 'best_valid_test/acc_unbiased': 89.824, 'best_valid_test/diff': 4.39, 'best_valid_test/acc_skew': 89.341, 'best_valid_test/acc_align': 90.307}
[2 / 10] best test accuracy: 89.824 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 91.599, 'best_test_valid/acc_unbiased': 90.665, 'best_test_valid/diff': 0.701, 'best_test_valid/acc_skew': 91.016, 'best_test_valid/acc_align': 90.314, 'best_test_test/acc': 90.16, 'best_test_test/acc_unbiased': 89.824, 'best_test_test/diff': 4.39, 'best_test_test/acc_skew': 89.341, 'best_test_test/acc_align': 90.307}
[3 / 10] Learning rate: 0.001 weight: 0.01
[3 / 10] Loss: 4.553498385631672 CE Loss: 0.19855668503461527 Con Loss: 4.551512823045125
[3 / 10] tensor([[0.859, 0.931],
        [0.948, 0.896]]) {'epoch': 3, 'valid/acc': 93.059, 'valid/acc_unbiased': 94.111, 'valid/diff': 2.304, 'valid/acc_skew': 95.263, 'valid/acc_align': 92.959, 'test/acc': 90.205, 'test/acc_unbiased': 90.828, 'test/diff': 6.214, 'test/acc_skew': 90.331, 'test/acc_align': 91.324}
[3 / 10] best valid accuracy: 94.111 at epoch 3 
 best_stats: {'best_valid_epoch': 3, 'best_valid_valid/acc': 93.059, 'best_valid_valid/acc_unbiased': 94.111, 'best_valid_valid/diff': 2.304, 'best_valid_valid/acc_skew': 95.263, 'best_valid_valid/acc_align': 92.959, 'best_valid_test/acc': 90.205, 'best_valid_test/acc_unbiased': 90.828, 'best_valid_test/diff': 6.214, 'best_valid_test/acc_skew': 90.331, 'best_valid_test/acc_align': 91.324}
[3 / 10] best test accuracy: 90.828 at epoch 3 
 best_stats: {'best_test_epoch': 3, 'best_test_valid/acc': 93.059, 'best_test_valid/acc_unbiased': 94.111, 'best_test_valid/diff': 2.304, 'best_test_valid/acc_skew': 95.263, 'best_test_valid/acc_align': 92.959, 'best_test_test/acc': 90.205, 'best_test_test/acc_unbiased': 90.828, 'best_test_test/diff': 6.214, 'best_test_test/acc_skew': 90.331, 'best_test_test/acc_align': 91.324}
[4 / 10] Learning rate: 0.0001 weight: 0.01
[4 / 10] Loss: 4.478186282619445 CE Loss: 0.15965645927878377 Con Loss: 4.476589717801394
[4 / 10] tensor([[0.861, 0.946],
        [0.957, 0.901]]) {'epoch': 4, 'valid/acc': 94.664, 'valid/acc_unbiased': 95.68, 'valid/diff': 3.136, 'valid/acc_skew': 97.248, 'valid/acc_align': 94.112, 'test/acc': 91.045, 'test/acc_unbiased': 91.613, 'test/diff': 7.058, 'test/acc_skew': 90.871, 'test/acc_align': 92.354}
[4 / 10] best valid accuracy: 95.680 at epoch 4 
 best_stats: {'best_valid_epoch': 4, 'best_valid_valid/acc': 94.664, 'best_valid_valid/acc_unbiased': 95.68, 'best_valid_valid/diff': 3.136, 'best_valid_valid/acc_skew': 97.248, 'best_valid_valid/acc_align': 94.112, 'best_valid_test/acc': 91.045, 'best_valid_test/acc_unbiased': 91.613, 'best_valid_test/diff': 7.058, 'best_valid_test/acc_skew': 90.871, 'best_valid_test/acc_align': 92.354}
[4 / 10] best test accuracy: 91.613 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 94.664, 'best_test_valid/acc_unbiased': 95.68, 'best_test_valid/diff': 3.136, 'best_test_valid/acc_skew': 97.248, 'best_test_valid/acc_align': 94.112, 'best_test_test/acc': 91.045, 'best_test_test/acc_unbiased': 91.613, 'best_test_test/diff': 7.058, 'best_test_test/acc_skew': 90.871, 'best_test_test/acc_align': 92.354}
[5 / 10] Learning rate: 0.0001 weight: 0.01
[5 / 10] Loss: 4.443237187435871 CE Loss: 0.14727474028849244 Con Loss: 4.441764444082131
[5 / 10] tensor([[0.852, 0.950],
        [0.960, 0.896]]) {'epoch': 5, 'valid/acc': 94.981, 'valid/acc_unbiased': 95.394, 'valid/diff': 3.145, 'valid/acc_skew': 96.967, 'valid/acc_align': 93.822, 'test/acc': 90.879, 'test/acc_unbiased': 91.443, 'test/diff': 8.158, 'test/acc_skew': 90.6, 'test/acc_align': 92.285}
[5 / 10] best valid accuracy: 95.680 at epoch 4 
 best_stats: {'best_valid_epoch': 4, 'best_valid_valid/acc': 94.664, 'best_valid_valid/acc_unbiased': 95.68, 'best_valid_valid/diff': 3.136, 'best_valid_valid/acc_skew': 97.248, 'best_valid_valid/acc_align': 94.112, 'best_valid_test/acc': 91.045, 'best_valid_test/acc_unbiased': 91.613, 'best_valid_test/diff': 7.058, 'best_valid_test/acc_skew': 90.871, 'best_valid_test/acc_align': 92.354}
[5 / 10] best test accuracy: 91.613 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 94.664, 'best_test_valid/acc_unbiased': 95.68, 'best_test_valid/diff': 3.136, 'best_test_valid/acc_skew': 97.248, 'best_test_valid/acc_align': 94.112, 'best_test_test/acc': 91.045, 'best_test_test/acc_unbiased': 91.613, 'best_test_test/diff': 7.058, 'best_test_test/acc_skew': 90.871, 'best_test_test/acc_align': 92.354}
[6 / 10] Learning rate: 0.0001 weight: 0.01
[6 / 10] Loss: 4.427118426295567 CE Loss: 0.14067125830698696 Con Loss: 4.425711714717317
[6 / 10] tensor([[0.811, 0.937],
        [0.971, 0.929]]) {'epoch': 6, 'valid/acc': 94.267, 'valid/acc_unbiased': 95.746, 'valid/diff': 2.844, 'valid/acc_skew': 97.168, 'valid/acc_align': 94.324, 'test/acc': 88.806, 'test/acc_unbiased': 91.217, 'test/diff': 8.453, 'test/acc_skew': 89.136, 'test/acc_align': 93.299}
[6 / 10] best valid accuracy: 95.746 at epoch 6 
 best_stats: {'best_valid_epoch': 6, 'best_valid_valid/acc': 94.267, 'best_valid_valid/acc_unbiased': 95.746, 'best_valid_valid/diff': 2.844, 'best_valid_valid/acc_skew': 97.168, 'best_valid_valid/acc_align': 94.324, 'best_valid_test/acc': 88.806, 'best_valid_test/acc_unbiased': 91.217, 'best_valid_test/diff': 8.453, 'best_valid_test/acc_skew': 89.136, 'best_valid_test/acc_align': 93.299}
[6 / 10] best test accuracy: 91.613 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 94.664, 'best_test_valid/acc_unbiased': 95.68, 'best_test_valid/diff': 3.136, 'best_test_valid/acc_skew': 97.248, 'best_test_valid/acc_align': 94.112, 'best_test_test/acc': 91.045, 'best_test_test/acc_unbiased': 91.613, 'best_test_test/diff': 7.058, 'best_test_test/acc_skew': 90.871, 'best_test_test/acc_align': 92.354}
[7 / 10] Learning rate: 1e-05 weight: 0.01
[7 / 10] Loss: 4.411541972689762 CE Loss: 0.13365518901723375 Con Loss: 4.410205428254321
[7 / 10] tensor([[0.836, 0.948],
        [0.965, 0.912]]) {'epoch': 7, 'valid/acc': 94.97, 'valid/acc_unbiased': 96.172, 'valid/diff': 2.609, 'valid/acc_skew': 97.476, 'valid/acc_align': 94.867, 'test/acc': 90.19, 'test/acc_unbiased': 91.513, 'test/diff': 8.266, 'test/acc_skew': 90.001, 'test/acc_align': 93.025}
[7 / 10] best valid accuracy: 96.172 at epoch 7 
 best_stats: {'best_valid_epoch': 7, 'best_valid_valid/acc': 94.97, 'best_valid_valid/acc_unbiased': 96.172, 'best_valid_valid/diff': 2.609, 'best_valid_valid/acc_skew': 97.476, 'best_valid_valid/acc_align': 94.867, 'best_valid_test/acc': 90.19, 'best_valid_test/acc_unbiased': 91.513, 'best_valid_test/diff': 8.266, 'best_valid_test/acc_skew': 90.001, 'best_valid_test/acc_align': 93.025}
[7 / 10] best test accuracy: 91.613 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 94.664, 'best_test_valid/acc_unbiased': 95.68, 'best_test_valid/diff': 3.136, 'best_test_valid/acc_skew': 97.248, 'best_test_valid/acc_align': 94.112, 'best_test_test/acc': 91.045, 'best_test_test/acc_unbiased': 91.613, 'best_test_test/diff': 7.058, 'best_test_test/acc_skew': 90.871, 'best_test_test/acc_align': 92.354}
[8 / 10] Learning rate: 1e-05 weight: 0.01
[8 / 10] Loss: 4.404863246785658 CE Loss: 0.13238942586037597 Con Loss: 4.403539351112975
[8 / 10] tensor([[0.840, 0.949],
        [0.966, 0.890]]) {'epoch': 8, 'valid/acc': 95.201, 'valid/acc_unbiased': 96.087, 'valid/diff': 2.313, 'valid/acc_skew': 97.244, 'valid/acc_align': 94.931, 'test/acc': 90.421, 'test/acc_unbiased': 91.127, 'test/diff': 9.213, 'test/acc_skew': 90.293, 'test/acc_align': 91.962}
[8 / 10] best valid accuracy: 96.172 at epoch 7 
 best_stats: {'best_valid_epoch': 7, 'best_valid_valid/acc': 94.97, 'best_valid_valid/acc_unbiased': 96.172, 'best_valid_valid/diff': 2.609, 'best_valid_valid/acc_skew': 97.476, 'best_valid_valid/acc_align': 94.867, 'best_valid_test/acc': 90.19, 'best_valid_test/acc_unbiased': 91.513, 'best_valid_test/diff': 8.266, 'best_valid_test/acc_skew': 90.001, 'best_valid_test/acc_align': 93.025}
[8 / 10] best test accuracy: 91.613 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 94.664, 'best_test_valid/acc_unbiased': 95.68, 'best_test_valid/diff': 3.136, 'best_test_valid/acc_skew': 97.248, 'best_test_valid/acc_align': 94.112, 'best_test_test/acc': 91.045, 'best_test_test/acc_unbiased': 91.613, 'best_test_test/diff': 7.058, 'best_test_test/acc_skew': 90.871, 'best_test_test/acc_align': 92.354}
[9 / 10] Learning rate: 1e-05 weight: 0.01
[9 / 10] Loss: 4.395933456328179 CE Loss: 0.13023664419440628 Con Loss: 4.394631087020337
[9 / 10] tensor([[0.828, 0.947],
        [0.970, 0.907]]) {'epoch': 9, 'valid/acc': 95.115, 'valid/acc_unbiased': 96.24, 'valid/diff': 2.582, 'valid/acc_skew': 97.531, 'valid/acc_align': 94.949, 'test/acc': 89.893, 'test/acc_unbiased': 91.291, 'test/diff': 9.087, 'test/acc_skew': 89.904, 'test/acc_align': 92.677}
[9 / 10] best valid accuracy: 96.240 at epoch 9 
 best_stats: {'best_valid_epoch': 9, 'best_valid_valid/acc': 95.115, 'best_valid_valid/acc_unbiased': 96.24, 'best_valid_valid/diff': 2.582, 'best_valid_valid/acc_skew': 97.531, 'best_valid_valid/acc_align': 94.949, 'best_valid_test/acc': 89.893, 'best_valid_test/acc_unbiased': 91.291, 'best_valid_test/diff': 9.087, 'best_valid_test/acc_skew': 89.904, 'best_valid_test/acc_align': 92.677}
[9 / 10] best test accuracy: 91.613 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 94.664, 'best_test_valid/acc_unbiased': 95.68, 'best_test_valid/diff': 3.136, 'best_test_valid/acc_skew': 97.248, 'best_test_valid/acc_align': 94.112, 'best_test_test/acc': 91.045, 'best_test_test/acc_unbiased': 91.613, 'best_test_test/diff': 7.058, 'best_test_test/acc_skew': 90.871, 'best_test_test/acc_align': 92.354}
[10 / 10] Learning rate: 1e-05 weight: 0.01
[10 / 10] Loss: 4.395472001183947 CE Loss: 0.12867819167528946 Con Loss: 4.394185220547744
[10 / 10] tensor([[0.830, 0.945],
        [0.968, 0.929]]) {'epoch': 10, 'valid/acc': 94.986, 'valid/acc_unbiased': 96.045, 'valid/diff': 2.713, 'valid/acc_skew': 97.402, 'valid/acc_align': 94.689, 'test/acc': 89.853, 'test/acc_unbiased': 91.769, 'test/diff': 7.728, 'test/acc_skew': 89.858, 'test/acc_align': 93.68}
[10 / 10] best valid accuracy: 96.240 at epoch 9 
 best_stats: {'best_valid_epoch': 9, 'best_valid_valid/acc': 95.115, 'best_valid_valid/acc_unbiased': 96.24, 'best_valid_valid/diff': 2.582, 'best_valid_valid/acc_skew': 97.531, 'best_valid_valid/acc_align': 94.949, 'best_valid_test/acc': 89.893, 'best_valid_test/acc_unbiased': 91.291, 'best_valid_test/diff': 9.087, 'best_valid_test/acc_skew': 89.904, 'best_valid_test/acc_align': 92.677}
[10 / 10] best test accuracy: 91.769 at epoch 10 
 best_stats: {'best_test_epoch': 10, 'best_test_valid/acc': 94.986, 'best_test_valid/acc_unbiased': 96.045, 'best_test_valid/diff': 2.713, 'best_test_valid/acc_skew': 97.402, 'best_test_valid/acc_align': 94.689, 'best_test_test/acc': 89.853, 'best_test_test/acc_unbiased': 91.769, 'best_test_test/diff': 7.728, 'best_test_test/acc_skew': 89.858, 'best_test_test/acc_align': 93.68}
Total training time: 1:46:40
