Log level set to: INFO
Set seed: 3
=======> Using Fixed Random Seed: 3 <========
save_path: exp_results/bc-bb0-utk_face_age-os-0.5-lr0.001-bs128-cbs64-w0.01-ratio10-aug1-seed3
get_utk_face - split: train, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_age-0.5
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [8237, 738]
Target 1: [4118, 1477]
Binary Target 1
---------------------------
Target 0: [8237, 738]
Target 1: [4118, 1477]
===================================
Normal Label Distribution: 
Target 0: [8237, 738]
Target 1: [4118, 1477]
===================================
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [8237, 8237]
Target 1: [8237, 8237]
Binary Target 1
---------------------------
Target 0: [8237, 8237]
Target 1: [8237, 8237]
===================================
Normal Label Distribution: 
Target 0: [8237, 8237]
Target 1: [8237, 8237]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 32948, target_attr: gender, bias_attr: age bias_rate: 0.5
['[train] target_0-bias_0: 8237', '[train] target_0-bias_1: 8237', '[train] target_1-bias_0: 8237', '[train] target_1-bias_1: 8237']
confusion_matrix - 
 original: tensor([[8237., 8237.],
        [8237., 8237.]]), 
 normalized: tensor([[0.500, 0.500],
        [0.500, 0.500]]), 
 b|y: tensor([[0.500, 0.500],
        [0.500, 0.500]])
get_utk_face - split: train, aug: 1, given_y: True, ratio: 10
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_age-0.5
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [8237, 738]
Target 1: [4118, 1477]
Binary Target 1
---------------------------
Target 0: [8237, 738]
Target 1: [4118, 1477]
===================================
Normal Label Distribution: 
Target 0: [8237, 738]
Target 1: [4118, 1477]
===================================
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [8237, 8237]
Target 1: [8237, 8237]
Binary Target 1
---------------------------
Target 0: [8237, 8237]
Target 1: [8237, 8237]
===================================
Normal Label Distribution: 
Target 0: [8237, 8237]
Target 1: [8237, 8237]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 32948, target_attr: gender, bias_attr: age bias_rate: 0.5
['[train] target_0-bias_0: 8237', '[train] target_0-bias_1: 8237', '[train] target_1-bias_0: 8237', '[train] target_1-bias_1: 8237']
get_utk_face - split: valid, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_age-0.5
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [1030, 195]
Target 1: [841, 202]
Binary Target 1
---------------------------
Target 0: [1030, 195]
Target 1: [841, 202]
===================================
Normal Label Distribution: 
Target 0: [1030, 195]
Target 1: [841, 202]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 2268, target_attr: gender, bias_attr: age bias_rate: 0.5
['[valid] target_0-bias_0: 1030', '[valid] target_0-bias_1: 195', '[valid] target_1-bias_0: 841', '[valid] target_1-bias_1: 202']
get_utk_face - split: test, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_age-0.5
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [1061, 176]
Target 1: [867, 165]
Binary Target 1
---------------------------
Target 0: [1061, 176]
Target 1: [867, 165]
===================================
Normal Label Distribution: 
Target 0: [1061, 176]
Target 1: [867, 165]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 2269, target_attr: gender, bias_attr: age bias_rate: 0.5
['[test] target_0-bias_0: 1061', '[test] target_0-bias_1: 176', '[test] target_1-bias_0: 867', '[test] target_1-bias_1: 165']
decay_epochs: [6, 13]
[1 / 20] Learning rate: 0.001 weight: 0.01
[1 / 20] Loss: 4.861546448224433 CE Loss: 0.589602916734491 Con Loss: 4.855650420036654
[1 / 20] tensor([[0.831, 0.665],
        [0.812, 0.721]]) {'epoch': 1, 'valid/acc': 78.66, 'valid/acc_unbiased': 73.989, 'valid/diff': 14.128, 'valid/acc_skew': 81.053, 'valid/acc_align': 66.926, 'test/acc': 80.3, 'test/acc_unbiased': 75.732, 'test/diff': 12.865, 'test/acc_skew': 82.164, 'test/acc_align': 69.299}
[1 / 20] best valid accuracy: 73.989 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 78.66, 'best_valid_valid/acc_unbiased': 73.989, 'best_valid_valid/diff': 14.128, 'best_valid_valid/acc_skew': 81.053, 'best_valid_valid/acc_align': 66.926, 'best_valid_test/acc': 80.3, 'best_valid_test/acc_unbiased': 75.732, 'best_valid_test/diff': 12.865, 'best_valid_test/acc_skew': 82.164, 'best_valid_test/acc_align': 69.299}
[1 / 20] best test accuracy: 75.732 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 78.66, 'best_test_valid/acc_unbiased': 73.989, 'best_test_valid/diff': 14.128, 'best_test_valid/acc_skew': 81.053, 'best_test_valid/acc_align': 66.926, 'best_test_test/acc': 80.3, 'best_test_test/acc_unbiased': 75.732, 'best_test_test/diff': 12.865, 'best_test_test/acc_skew': 82.164, 'best_test_test/acc_align': 69.299}
[2 / 20] Learning rate: 0.001 weight: 0.01
[2 / 20] Loss: 4.803931044883862 CE Loss: 0.512608289338727 Con Loss: 4.798804971971196
[2 / 20] tensor([[0.527, 0.330],
        [0.964, 0.909]]) {'epoch': 2, 'valid/acc': 70.459, 'valid/acc_unbiased': 67.824, 'valid/diff': 13.276, 'valid/acc_skew': 74.462, 'valid/acc_align': 61.186, 'test/acc': 70.648, 'test/acc_unbiased': 68.244, 'test/diff': 12.623, 'test/acc_skew': 74.555, 'test/acc_align': 61.932}
[2 / 20] best valid accuracy: 73.989 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 78.66, 'best_valid_valid/acc_unbiased': 73.989, 'best_valid_valid/diff': 14.128, 'best_valid_valid/acc_skew': 81.053, 'best_valid_valid/acc_align': 66.926, 'best_valid_test/acc': 80.3, 'best_valid_test/acc_unbiased': 75.732, 'best_valid_test/diff': 12.865, 'best_valid_test/acc_skew': 82.164, 'best_valid_test/acc_align': 69.299}
[2 / 20] best test accuracy: 75.732 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 78.66, 'best_test_valid/acc_unbiased': 73.989, 'best_test_valid/diff': 14.128, 'best_test_valid/acc_skew': 81.053, 'best_test_valid/acc_align': 66.926, 'best_test_test/acc': 80.3, 'best_test_test/acc_unbiased': 75.732, 'best_test_test/diff': 12.865, 'best_test_test/acc_skew': 82.164, 'best_test_test/acc_align': 69.299}
[3 / 20] Learning rate: 0.001 weight: 0.01
[3 / 20] Loss: 4.788472682595818 CE Loss: 0.48350983046929613 Con Loss: 4.7836375815986765
[3 / 20] tensor([[0.963, 0.801],
        [0.675, 0.442]]) {'epoch': 3, 'valid/acc': 79.85, 'valid/acc_unbiased': 74.784, 'valid/diff': 11.577, 'valid/acc_skew': 80.573, 'valid/acc_align': 68.996, 'test/acc': 80.256, 'test/acc_unbiased': 72.039, 'test/diff': 19.721, 'test/acc_skew': 81.899, 'test/acc_align': 62.178}
[3 / 20] best valid accuracy: 74.784 at epoch 3 
 best_stats: {'best_valid_epoch': 3, 'best_valid_valid/acc': 79.85, 'best_valid_valid/acc_unbiased': 74.784, 'best_valid_valid/diff': 11.577, 'best_valid_valid/acc_skew': 80.573, 'best_valid_valid/acc_align': 68.996, 'best_valid_test/acc': 80.256, 'best_valid_test/acc_unbiased': 72.039, 'best_valid_test/diff': 19.721, 'best_valid_test/acc_skew': 81.899, 'best_valid_test/acc_align': 62.178}
[3 / 20] best test accuracy: 75.732 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 78.66, 'best_test_valid/acc_unbiased': 73.989, 'best_test_valid/diff': 14.128, 'best_test_valid/acc_skew': 81.053, 'best_test_valid/acc_align': 66.926, 'best_test_test/acc': 80.3, 'best_test_test/acc_unbiased': 75.732, 'best_test_test/diff': 12.865, 'best_test_test/acc_skew': 82.164, 'best_test_test/acc_align': 69.299}
[4 / 20] Learning rate: 0.001 weight: 0.01
[4 / 20] Loss: 4.773290204440301 CE Loss: 0.47149637100895414 Con Loss: 4.768575226578939
[4 / 20] tensor([[0.941, 0.778],
        [0.755, 0.624]]) {'epoch': 4, 'valid/acc': 81.922, 'valid/acc_unbiased': 76.784, 'valid/diff': 13.314, 'valid/acc_skew': 83.441, 'valid/acc_align': 70.127, 'test/acc': 83.429, 'test/acc_unbiased': 77.469, 'test/diff': 14.672, 'test/acc_skew': 84.805, 'test/acc_align': 70.133}
[4 / 20] best valid accuracy: 76.784 at epoch 4 
 best_stats: {'best_valid_epoch': 4, 'best_valid_valid/acc': 81.922, 'best_valid_valid/acc_unbiased': 76.784, 'best_valid_valid/diff': 13.314, 'best_valid_valid/acc_skew': 83.441, 'best_valid_valid/acc_align': 70.127, 'best_valid_test/acc': 83.429, 'best_valid_test/acc_unbiased': 77.469, 'best_valid_test/diff': 14.672, 'best_valid_test/acc_skew': 84.805, 'best_valid_test/acc_align': 70.133}
[4 / 20] best test accuracy: 77.469 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 81.922, 'best_test_valid/acc_unbiased': 76.784, 'best_test_valid/diff': 13.314, 'best_test_valid/acc_skew': 83.441, 'best_test_valid/acc_align': 70.127, 'best_test_test/acc': 83.429, 'best_test_test/acc_unbiased': 77.469, 'best_test_test/diff': 14.672, 'best_test_test/acc_skew': 84.805, 'best_test_test/acc_align': 70.133}
[5 / 20] Learning rate: 0.001 weight: 0.01
[5 / 20] Loss: 4.765731174737139 CE Loss: 0.4538294669203175 Con Loss: 4.761192878733796
[5 / 20] tensor([[0.862, 0.659],
        [0.857, 0.733]]) {'epoch': 5, 'valid/acc': 83.951, 'valid/acc_unbiased': 79.706, 'valid/diff': 13.008, 'valid/acc_skew': 86.21, 'valid/acc_align': 73.203, 'test/acc': 83.517, 'test/acc_unbiased': 77.795, 'test/diff': 16.347, 'test/acc_skew': 85.969, 'test/acc_align': 69.621}
[5 / 20] best valid accuracy: 79.706 at epoch 5 
 best_stats: {'best_valid_epoch': 5, 'best_valid_valid/acc': 83.951, 'best_valid_valid/acc_unbiased': 79.706, 'best_valid_valid/diff': 13.008, 'best_valid_valid/acc_skew': 86.21, 'best_valid_valid/acc_align': 73.203, 'best_valid_test/acc': 83.517, 'best_valid_test/acc_unbiased': 77.795, 'best_valid_test/diff': 16.347, 'best_valid_test/acc_skew': 85.969, 'best_valid_test/acc_align': 69.621}
[5 / 20] best test accuracy: 77.795 at epoch 5 
 best_stats: {'best_test_epoch': 5, 'best_test_valid/acc': 83.951, 'best_test_valid/acc_unbiased': 79.706, 'best_test_valid/diff': 13.008, 'best_test_valid/acc_skew': 86.21, 'best_test_valid/acc_align': 73.203, 'best_test_test/acc': 83.517, 'best_test_test/acc_unbiased': 77.795, 'best_test_test/diff': 16.347, 'best_test_test/acc_skew': 85.969, 'best_test_test/acc_align': 69.621}
[6 / 20] Learning rate: 0.001 weight: 0.01
[6 / 20] Loss: 4.749096608413747 CE Loss: 0.4308160121679393 Con Loss: 4.744788444778852
[6 / 20] tensor([[0.912, 0.716],
        [0.829, 0.758]]) {'epoch': 6, 'valid/acc': 83.554, 'valid/acc_unbiased': 77.951, 'valid/diff': 15.86, 'valid/acc_skew': 85.881, 'valid/acc_align': 70.02, 'test/acc': 85.412, 'test/acc_unbiased': 80.378, 'test/diff': 13.408, 'test/acc_skew': 87.082, 'test/acc_align': 73.674}
[6 / 20] best valid accuracy: 79.706 at epoch 5 
 best_stats: {'best_valid_epoch': 5, 'best_valid_valid/acc': 83.951, 'best_valid_valid/acc_unbiased': 79.706, 'best_valid_valid/diff': 13.008, 'best_valid_valid/acc_skew': 86.21, 'best_valid_valid/acc_align': 73.203, 'best_valid_test/acc': 83.517, 'best_valid_test/acc_unbiased': 77.795, 'best_valid_test/diff': 16.347, 'best_valid_test/acc_skew': 85.969, 'best_valid_test/acc_align': 69.621}
[6 / 20] best test accuracy: 80.378 at epoch 6 
 best_stats: {'best_test_epoch': 6, 'best_test_valid/acc': 83.554, 'best_test_valid/acc_unbiased': 77.951, 'best_test_valid/diff': 15.86, 'best_test_valid/acc_skew': 85.881, 'best_test_valid/acc_align': 70.02, 'best_test_test/acc': 85.412, 'best_test_test/acc_unbiased': 80.378, 'best_test_test/diff': 13.408, 'best_test_test/acc_skew': 87.082, 'best_test_test/acc_align': 73.674}
[7 / 20] Learning rate: 0.0001 weight: 0.01
[7 / 20] Loss: 4.694215456490322 CE Loss: 0.38465681990489403 Con Loss: 4.690368879965907
[7 / 20] tensor([[0.901, 0.710],
        [0.874, 0.752]]) {'epoch': 7, 'valid/acc': 86.376, 'valid/acc_unbiased': 80.403, 'valid/diff': 17.83, 'valid/acc_skew': 89.318, 'valid/acc_align': 71.488, 'test/acc': 86.514, 'test/acc_unbiased': 80.926, 'test/diff': 15.679, 'test/acc_skew': 88.766, 'test/acc_align': 73.087}
[7 / 20] best valid accuracy: 80.403 at epoch 7 
 best_stats: {'best_valid_epoch': 7, 'best_valid_valid/acc': 86.376, 'best_valid_valid/acc_unbiased': 80.403, 'best_valid_valid/diff': 17.83, 'best_valid_valid/acc_skew': 89.318, 'best_valid_valid/acc_align': 71.488, 'best_valid_test/acc': 86.514, 'best_valid_test/acc_unbiased': 80.926, 'best_valid_test/diff': 15.679, 'best_valid_test/acc_skew': 88.766, 'best_valid_test/acc_align': 73.087}
[7 / 20] best test accuracy: 80.926 at epoch 7 
 best_stats: {'best_test_epoch': 7, 'best_test_valid/acc': 86.376, 'best_test_valid/acc_unbiased': 80.403, 'best_test_valid/diff': 17.83, 'best_test_valid/acc_skew': 89.318, 'best_test_valid/acc_align': 71.488, 'best_test_test/acc': 86.514, 'best_test_test/acc_unbiased': 80.926, 'best_test_test/diff': 15.679, 'best_test_test/acc_skew': 88.766, 'best_test_test/acc_align': 73.087}
[8 / 20] Learning rate: 0.0001 weight: 0.01
[8 / 20] Loss: 4.662647649126607 CE Loss: 0.360291279406459 Con Loss: 4.659044736621593
[8 / 20] tensor([[0.895, 0.682],
        [0.888, 0.770]]) {'epoch': 8, 'valid/acc': 86.508, 'valid/acc_unbiased': 80.109, 'valid/diff': 19.382, 'valid/acc_skew': 89.8, 'valid/acc_align': 70.418, 'test/acc': 86.69, 'test/acc_unbiased': 80.875, 'test/diff': 16.599, 'test/acc_skew': 89.175, 'test/acc_align': 72.576}
[8 / 20] best valid accuracy: 80.403 at epoch 7 
 best_stats: {'best_valid_epoch': 7, 'best_valid_valid/acc': 86.376, 'best_valid_valid/acc_unbiased': 80.403, 'best_valid_valid/diff': 17.83, 'best_valid_valid/acc_skew': 89.318, 'best_valid_valid/acc_align': 71.488, 'best_valid_test/acc': 86.514, 'best_valid_test/acc_unbiased': 80.926, 'best_valid_test/diff': 15.679, 'best_valid_test/acc_skew': 88.766, 'best_valid_test/acc_align': 73.087}
[8 / 20] best test accuracy: 80.926 at epoch 7 
 best_stats: {'best_test_epoch': 7, 'best_test_valid/acc': 86.376, 'best_test_valid/acc_unbiased': 80.403, 'best_test_valid/diff': 17.83, 'best_test_valid/acc_skew': 89.318, 'best_test_valid/acc_align': 71.488, 'best_test_test/acc': 86.514, 'best_test_test/acc_unbiased': 80.926, 'best_test_test/diff': 15.679, 'best_test_test/acc_skew': 88.766, 'best_test_test/acc_align': 73.087}
[9 / 20] Learning rate: 0.0001 weight: 0.01
[9 / 20] Loss: 4.642300007426364 CE Loss: 0.3434740712309225 Con Loss: 4.638865268967084
[9 / 20] tensor([[0.891, 0.693],
        [0.900, 0.782]]) {'epoch': 9, 'valid/acc': 86.067, 'valid/acc_unbiased': 79.881, 'valid/diff': 18.91, 'valid/acc_skew': 89.336, 'valid/acc_align': 70.427, 'test/acc': 87.087, 'test/acc_unbiased': 81.633, 'test/diff': 15.766, 'test/acc_skew': 89.516, 'test/acc_align': 73.75}
[9 / 20] best valid accuracy: 80.403 at epoch 7 
 best_stats: {'best_valid_epoch': 7, 'best_valid_valid/acc': 86.376, 'best_valid_valid/acc_unbiased': 80.403, 'best_valid_valid/diff': 17.83, 'best_valid_valid/acc_skew': 89.318, 'best_valid_valid/acc_align': 71.488, 'best_valid_test/acc': 86.514, 'best_valid_test/acc_unbiased': 80.926, 'best_valid_test/diff': 15.679, 'best_valid_test/acc_skew': 88.766, 'best_valid_test/acc_align': 73.087}
[9 / 20] best test accuracy: 81.633 at epoch 9 
 best_stats: {'best_test_epoch': 9, 'best_test_valid/acc': 86.067, 'best_test_valid/acc_unbiased': 79.881, 'best_test_valid/diff': 18.91, 'best_test_valid/acc_skew': 89.336, 'best_test_valid/acc_align': 70.427, 'best_test_test/acc': 87.087, 'best_test_test/acc_unbiased': 81.633, 'best_test_test/diff': 15.766, 'best_test_test/acc_skew': 89.516, 'best_test_test/acc_align': 73.75}
[10 / 20] Learning rate: 0.0001 weight: 0.01
[10 / 20] Loss: 4.628581135281952 CE Loss: 0.3351489602216922 Con Loss: 4.625229654199828
[10 / 20] tensor([[0.898, 0.693],
        [0.897, 0.739]]) {'epoch': 10, 'valid/acc': 86.552, 'valid/acc_unbiased': 80.65, 'valid/diff': 17.847, 'valid/acc_skew': 89.573, 'valid/acc_align': 71.726, 'test/acc': 87.043, 'test/acc_unbiased': 80.703, 'test/diff': 18.149, 'test/acc_skew': 89.778, 'test/acc_align': 71.629}
[10 / 20] best valid accuracy: 80.650 at epoch 10 
 best_stats: {'best_valid_epoch': 10, 'best_valid_valid/acc': 86.552, 'best_valid_valid/acc_unbiased': 80.65, 'best_valid_valid/diff': 17.847, 'best_valid_valid/acc_skew': 89.573, 'best_valid_valid/acc_align': 71.726, 'best_valid_test/acc': 87.043, 'best_valid_test/acc_unbiased': 80.703, 'best_valid_test/diff': 18.149, 'best_valid_test/acc_skew': 89.778, 'best_valid_test/acc_align': 71.629}
[10 / 20] best test accuracy: 81.633 at epoch 9 
 best_stats: {'best_test_epoch': 9, 'best_test_valid/acc': 86.067, 'best_test_valid/acc_unbiased': 79.881, 'best_test_valid/diff': 18.91, 'best_test_valid/acc_skew': 89.336, 'best_test_valid/acc_align': 70.427, 'best_test_test/acc': 87.087, 'best_test_test/acc_unbiased': 81.633, 'best_test_test/diff': 15.766, 'best_test_test/acc_skew': 89.516, 'best_test_test/acc_align': 73.75}
[11 / 20] Learning rate: 0.0001 weight: 0.01
[11 / 20] Loss: 4.618058648085701 CE Loss: 0.3293201534713633 Con Loss: 4.614765448001196
[11 / 20] tensor([[0.910, 0.693],
        [0.886, 0.788]]) {'epoch': 11, 'valid/acc': 86.596, 'valid/acc_unbiased': 79.814, 'valid/diff': 20.348, 'valid/acc_skew': 89.988, 'valid/acc_align': 69.64, 'test/acc': 87.483, 'test/acc_unbiased': 81.91, 'test/diff': 15.714, 'test/acc_skew': 89.767, 'test/acc_align': 74.053}
[11 / 20] best valid accuracy: 80.650 at epoch 10 
 best_stats: {'best_valid_epoch': 10, 'best_valid_valid/acc': 86.552, 'best_valid_valid/acc_unbiased': 80.65, 'best_valid_valid/diff': 17.847, 'best_valid_valid/acc_skew': 89.573, 'best_valid_valid/acc_align': 71.726, 'best_valid_test/acc': 87.043, 'best_valid_test/acc_unbiased': 80.703, 'best_valid_test/diff': 18.149, 'best_valid_test/acc_skew': 89.778, 'best_valid_test/acc_align': 71.629}
[11 / 20] best test accuracy: 81.910 at epoch 11 
 best_stats: {'best_test_epoch': 11, 'best_test_valid/acc': 86.596, 'best_test_valid/acc_unbiased': 79.814, 'best_test_valid/diff': 20.348, 'best_test_valid/acc_skew': 89.988, 'best_test_valid/acc_align': 69.64, 'best_test_test/acc': 87.483, 'best_test_test/acc_unbiased': 81.91, 'best_test_test/diff': 15.714, 'best_test_test/acc_skew': 89.767, 'best_test_test/acc_align': 74.053}
[12 / 20] Learning rate: 0.0001 weight: 0.01
[12 / 20] Loss: 4.609341311515557 CE Loss: 0.32521467469112525 Con Loss: 4.606089174248169
[12 / 20] tensor([[0.898, 0.710],
        [0.887, 0.770]]) {'epoch': 12, 'valid/acc': 86.464, 'valid/acc_unbiased': 80.397, 'valid/diff': 18.102, 'valid/acc_skew': 89.448, 'valid/acc_align': 71.346, 'test/acc': 86.999, 'test/acc_unbiased': 81.628, 'test/diff': 15.263, 'test/acc_skew': 89.259, 'test/acc_align': 73.996}
[12 / 20] best valid accuracy: 80.650 at epoch 10 
 best_stats: {'best_valid_epoch': 10, 'best_valid_valid/acc': 86.552, 'best_valid_valid/acc_unbiased': 80.65, 'best_valid_valid/diff': 17.847, 'best_valid_valid/acc_skew': 89.573, 'best_valid_valid/acc_align': 71.726, 'best_valid_test/acc': 87.043, 'best_valid_test/acc_unbiased': 80.703, 'best_valid_test/diff': 18.149, 'best_valid_test/acc_skew': 89.778, 'best_valid_test/acc_align': 71.629}
[12 / 20] best test accuracy: 81.910 at epoch 11 
 best_stats: {'best_test_epoch': 11, 'best_test_valid/acc': 86.596, 'best_test_valid/acc_unbiased': 79.814, 'best_test_valid/diff': 20.348, 'best_test_valid/acc_skew': 89.988, 'best_test_valid/acc_align': 69.64, 'best_test_test/acc': 87.483, 'best_test_test/acc_unbiased': 81.91, 'best_test_test/diff': 15.714, 'best_test_test/acc_skew': 89.767, 'best_test_test/acc_align': 74.053}
[13 / 20] Learning rate: 0.0001 weight: 0.01
[13 / 20] Loss: 4.592004637355233 CE Loss: 0.31018415366950597 Con Loss: 4.588902800236857
[13 / 20] tensor([[0.908, 0.710],
        [0.897, 0.752]]) {'epoch': 13, 'valid/acc': 86.508, 'valid/acc_unbiased': 80.353, 'valid/diff': 18.385, 'valid/acc_skew': 89.545, 'valid/acc_align': 71.16, 'test/acc': 87.704, 'test/acc_unbiased': 81.668, 'test/diff': 17.162, 'test/acc_skew': 90.249, 'test/acc_align': 73.087}
[13 / 20] best valid accuracy: 80.650 at epoch 10 
 best_stats: {'best_valid_epoch': 10, 'best_valid_valid/acc': 86.552, 'best_valid_valid/acc_unbiased': 80.65, 'best_valid_valid/diff': 17.847, 'best_valid_valid/acc_skew': 89.573, 'best_valid_valid/acc_align': 71.726, 'best_valid_test/acc': 87.043, 'best_valid_test/acc_unbiased': 80.703, 'best_valid_test/diff': 18.149, 'best_valid_test/acc_skew': 89.778, 'best_valid_test/acc_align': 71.629}
[13 / 20] best test accuracy: 81.910 at epoch 11 
 best_stats: {'best_test_epoch': 11, 'best_test_valid/acc': 86.596, 'best_test_valid/acc_unbiased': 79.814, 'best_test_valid/diff': 20.348, 'best_test_valid/acc_skew': 89.988, 'best_test_valid/acc_align': 69.64, 'best_test_test/acc': 87.483, 'best_test_test/acc_unbiased': 81.91, 'best_test_test/diff': 15.714, 'best_test_test/acc_skew': 89.767, 'best_test_test/acc_align': 74.053}
[14 / 20] Learning rate: 1e-05 weight: 0.01
[14 / 20] Loss: 4.594434810868597 CE Loss: 0.3056152954967158 Con Loss: 4.591378659462197
[14 / 20] tensor([[0.901, 0.693],
        [0.905, 0.806]]) {'epoch': 14, 'valid/acc': 86.684, 'valid/acc_unbiased': 80.498, 'valid/diff': 18.765, 'valid/acc_skew': 89.881, 'valid/acc_align': 71.116, 'test/acc': 87.968, 'test/acc_unbiased': 82.643, 'test/diff': 15.361, 'test/acc_skew': 90.323, 'test/acc_align': 74.962}
[14 / 20] best valid accuracy: 80.650 at epoch 10 
 best_stats: {'best_valid_epoch': 10, 'best_valid_valid/acc': 86.552, 'best_valid_valid/acc_unbiased': 80.65, 'best_valid_valid/diff': 17.847, 'best_valid_valid/acc_skew': 89.573, 'best_valid_valid/acc_align': 71.726, 'best_valid_test/acc': 87.043, 'best_valid_test/acc_unbiased': 80.703, 'best_valid_test/diff': 18.149, 'best_valid_test/acc_skew': 89.778, 'best_valid_test/acc_align': 71.629}
[14 / 20] best test accuracy: 82.643 at epoch 14 
 best_stats: {'best_test_epoch': 14, 'best_test_valid/acc': 86.684, 'best_test_valid/acc_unbiased': 80.498, 'best_test_valid/diff': 18.765, 'best_test_valid/acc_skew': 89.881, 'best_test_valid/acc_align': 71.116, 'best_test_test/acc': 87.968, 'best_test_test/acc_unbiased': 82.643, 'best_test_test/diff': 15.361, 'best_test_test/acc_skew': 90.323, 'best_test_test/acc_align': 74.962}
[15 / 20] Learning rate: 1e-05 weight: 0.01
[15 / 20] Loss: 4.5795697852710475 CE Loss: 0.3024468461391459 Con Loss: 4.576545326545051
[15 / 20] tensor([[0.906, 0.699],
        [0.901, 0.788]]) {'epoch': 15, 'valid/acc': 86.64, 'valid/acc_unbiased': 80.644, 'valid/diff': 18.03, 'valid/acc_skew': 89.659, 'valid/acc_align': 71.629, 'test/acc': 87.924, 'test/acc_unbiased': 82.332, 'test/diff': 15.991, 'test/acc_skew': 90.328, 'test/acc_align': 74.337}
[15 / 20] best valid accuracy: 80.650 at epoch 10 
 best_stats: {'best_valid_epoch': 10, 'best_valid_valid/acc': 86.552, 'best_valid_valid/acc_unbiased': 80.65, 'best_valid_valid/diff': 17.847, 'best_valid_valid/acc_skew': 89.573, 'best_valid_valid/acc_align': 71.726, 'best_valid_test/acc': 87.043, 'best_valid_test/acc_unbiased': 80.703, 'best_valid_test/diff': 18.149, 'best_valid_test/acc_skew': 89.778, 'best_valid_test/acc_align': 71.629}
[15 / 20] best test accuracy: 82.643 at epoch 14 
 best_stats: {'best_test_epoch': 14, 'best_test_valid/acc': 86.684, 'best_test_valid/acc_unbiased': 80.498, 'best_test_valid/diff': 18.765, 'best_test_valid/acc_skew': 89.881, 'best_test_valid/acc_align': 71.116, 'best_test_test/acc': 87.968, 'best_test_test/acc_unbiased': 82.643, 'best_test_test/diff': 15.361, 'best_test_test/acc_skew': 90.323, 'best_test_test/acc_align': 74.962}
[16 / 20] Learning rate: 1e-05 weight: 0.01
[16 / 20] Loss: 4.5803397906207195 CE Loss: 0.3013966174123935 Con Loss: 4.577325816407458
[16 / 20] tensor([[0.903, 0.682],
        [0.901, 0.782]]) {'epoch': 16, 'valid/acc': 86.905, 'valid/acc_unbiased': 80.719, 'valid/diff': 18.712, 'valid/acc_skew': 90.075, 'valid/acc_align': 71.363, 'test/acc': 87.616, 'test/acc_unbiased': 81.684, 'test/diff': 17.005, 'test/acc_skew': 90.186, 'test/acc_align': 73.182}
[16 / 20] best valid accuracy: 80.719 at epoch 16 
 best_stats: {'best_valid_epoch': 16, 'best_valid_valid/acc': 86.905, 'best_valid_valid/acc_unbiased': 80.719, 'best_valid_valid/diff': 18.712, 'best_valid_valid/acc_skew': 90.075, 'best_valid_valid/acc_align': 71.363, 'best_valid_test/acc': 87.616, 'best_valid_test/acc_unbiased': 81.684, 'best_valid_test/diff': 17.005, 'best_valid_test/acc_skew': 90.186, 'best_valid_test/acc_align': 73.182}
[16 / 20] best test accuracy: 82.643 at epoch 14 
 best_stats: {'best_test_epoch': 14, 'best_test_valid/acc': 86.684, 'best_test_valid/acc_unbiased': 80.498, 'best_test_valid/diff': 18.765, 'best_test_valid/acc_skew': 89.881, 'best_test_valid/acc_align': 71.116, 'best_test_test/acc': 87.968, 'best_test_test/acc_unbiased': 82.643, 'best_test_test/diff': 15.361, 'best_test_test/acc_skew': 90.323, 'best_test_test/acc_align': 74.962}
[17 / 20] Learning rate: 1e-05 weight: 0.01
[17 / 20] Loss: 4.5685231298646025 CE Loss: 0.29681510205362643 Con Loss: 4.565554986492702
[17 / 20] tensor([[0.913, 0.716],
        [0.892, 0.764]]) {'epoch': 17, 'valid/acc': 87.434, 'valid/acc_unbiased': 81.697, 'valid/diff': 17.024, 'valid/acc_skew': 90.209, 'valid/acc_align': 73.185, 'test/acc': 87.88, 'test/acc_unbiased': 82.11, 'test/diff': 16.266, 'test/acc_skew': 90.243, 'test/acc_align': 73.977}
[17 / 20] best valid accuracy: 81.697 at epoch 17 
 best_stats: {'best_valid_epoch': 17, 'best_valid_valid/acc': 87.434, 'best_valid_valid/acc_unbiased': 81.697, 'best_valid_valid/diff': 17.024, 'best_valid_valid/acc_skew': 90.209, 'best_valid_valid/acc_align': 73.185, 'best_valid_test/acc': 87.88, 'best_valid_test/acc_unbiased': 82.11, 'best_valid_test/diff': 16.266, 'best_valid_test/acc_skew': 90.243, 'best_valid_test/acc_align': 73.977}
[17 / 20] best test accuracy: 82.643 at epoch 14 
 best_stats: {'best_test_epoch': 14, 'best_test_valid/acc': 86.684, 'best_test_valid/acc_unbiased': 80.498, 'best_test_valid/diff': 18.765, 'best_test_valid/acc_skew': 89.881, 'best_test_valid/acc_align': 71.116, 'best_test_test/acc': 87.968, 'best_test_test/acc_unbiased': 82.643, 'best_test_test/diff': 15.361, 'best_test_test/acc_skew': 90.323, 'best_test_test/acc_align': 74.962}
[18 / 20] Learning rate: 1e-05 weight: 0.01
[18 / 20] Loss: 4.5768655139265 CE Loss: 0.2978986607089094 Con Loss: 4.573886513984998
[18 / 20] tensor([[0.908, 0.705],
        [0.902, 0.788]]) {'epoch': 18, 'valid/acc': 86.993, 'valid/acc_unbiased': 81.257, 'valid/diff': 17.258, 'valid/acc_skew': 89.886, 'valid/acc_align': 72.628, 'test/acc': 88.1, 'test/acc_unbiased': 82.55, 'test/diff': 15.859, 'test/acc_skew': 90.48, 'test/acc_align': 74.621}
[18 / 20] best valid accuracy: 81.697 at epoch 17 
 best_stats: {'best_valid_epoch': 17, 'best_valid_valid/acc': 87.434, 'best_valid_valid/acc_unbiased': 81.697, 'best_valid_valid/diff': 17.024, 'best_valid_valid/acc_skew': 90.209, 'best_valid_valid/acc_align': 73.185, 'best_valid_test/acc': 87.88, 'best_valid_test/acc_unbiased': 82.11, 'best_valid_test/diff': 16.266, 'best_valid_test/acc_skew': 90.243, 'best_valid_test/acc_align': 73.977}
[18 / 20] best test accuracy: 82.643 at epoch 14 
 best_stats: {'best_test_epoch': 14, 'best_test_valid/acc': 86.684, 'best_test_valid/acc_unbiased': 80.498, 'best_test_valid/diff': 18.765, 'best_test_valid/acc_skew': 89.881, 'best_test_valid/acc_align': 71.116, 'best_test_test/acc': 87.968, 'best_test_test/acc_unbiased': 82.643, 'best_test_test/diff': 15.361, 'best_test_test/acc_skew': 90.323, 'best_test_test/acc_align': 74.962}
[19 / 20] Learning rate: 1e-05 weight: 0.01
[19 / 20] Loss: 4.561149971077305 CE Loss: 0.29756117871812904 Con Loss: 4.558174377884609
[19 / 20] tensor([[0.916, 0.722],
        [0.894, 0.770]]) {'epoch': 19, 'valid/acc': 87.478, 'valid/acc_unbiased': 81.706, 'valid/diff': 17.06, 'valid/acc_skew': 90.236, 'valid/acc_align': 73.176, 'test/acc': 88.189, 'test/acc_unbiased': 82.532, 'test/diff': 15.936, 'test/acc_skew': 90.5, 'test/acc_align': 74.564}
[19 / 20] best valid accuracy: 81.706 at epoch 19 
 best_stats: {'best_valid_epoch': 19, 'best_valid_valid/acc': 87.478, 'best_valid_valid/acc_unbiased': 81.706, 'best_valid_valid/diff': 17.06, 'best_valid_valid/acc_skew': 90.236, 'best_valid_valid/acc_align': 73.176, 'best_valid_test/acc': 88.189, 'best_valid_test/acc_unbiased': 82.532, 'best_valid_test/diff': 15.936, 'best_valid_test/acc_skew': 90.5, 'best_valid_test/acc_align': 74.564}
[19 / 20] best test accuracy: 82.643 at epoch 14 
 best_stats: {'best_test_epoch': 14, 'best_test_valid/acc': 86.684, 'best_test_valid/acc_unbiased': 80.498, 'best_test_valid/diff': 18.765, 'best_test_valid/acc_skew': 89.881, 'best_test_valid/acc_align': 71.116, 'best_test_test/acc': 87.968, 'best_test_test/acc_unbiased': 82.643, 'best_test_test/diff': 15.361, 'best_test_test/acc_skew': 90.323, 'best_test_test/acc_align': 74.962}
[20 / 20] Learning rate: 1e-05 weight: 0.01
[20 / 20] Loss: 4.5627285992186 CE Loss: 0.29267975838493776 Con Loss: 4.559801802670505
[20 / 20] tensor([[0.910, 0.688],
        [0.901, 0.794]]) {'epoch': 20, 'valid/acc': 86.993, 'valid/acc_unbiased': 81.235, 'valid/diff': 17.215, 'valid/acc_skew': 89.842, 'valid/acc_align': 72.628, 'test/acc': 88.056, 'test/acc_unbiased': 82.294, 'test/diff': 16.444, 'test/acc_skew': 90.516, 'test/acc_align': 74.072}
[20 / 20] best valid accuracy: 81.706 at epoch 19 
 best_stats: {'best_valid_epoch': 19, 'best_valid_valid/acc': 87.478, 'best_valid_valid/acc_unbiased': 81.706, 'best_valid_valid/diff': 17.06, 'best_valid_valid/acc_skew': 90.236, 'best_valid_valid/acc_align': 73.176, 'best_valid_test/acc': 88.189, 'best_valid_test/acc_unbiased': 82.532, 'best_valid_test/diff': 15.936, 'best_valid_test/acc_skew': 90.5, 'best_valid_test/acc_align': 74.564}
[20 / 20] best test accuracy: 82.643 at epoch 14 
 best_stats: {'best_test_epoch': 14, 'best_test_valid/acc': 86.684, 'best_test_valid/acc_unbiased': 80.498, 'best_test_valid/diff': 18.765, 'best_test_valid/acc_skew': 89.881, 'best_test_valid/acc_align': 71.116, 'best_test_test/acc': 87.968, 'best_test_test/acc_unbiased': 82.643, 'best_test_test/diff': 15.361, 'best_test_test/acc_skew': 90.323, 'best_test_test/acc_align': 74.962}
Total training time: 1:56:12
