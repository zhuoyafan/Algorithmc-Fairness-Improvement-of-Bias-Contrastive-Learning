Log level set to: INFO
Set seed: 3
=======> Using Fixed Random Seed: 3 <========
save_path: exp_results/bc-bb0-utk_face_race-test-0.995-lr0.001-bs128-cbs64-w0.01-ratio10-aug1-seed3
get_utk_face - split: train, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_race-0.995
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [4407, 27]
Target 1: [22, 5529]
Binary Target 1
---------------------------
Target 0: [4407, 27]
Target 1: [22, 5529]
===================================
Normal Label Distribution: 
Target 0: [4407, 27]
Target 1: [22, 5529]
===================================
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [4407, 27]
Target 1: [22, 5529]
Binary Target 1
---------------------------
Target 0: [4407, 27]
Target 1: [22, 5529]
===================================
Normal Label Distribution: 
Target 0: [4407, 27]
Target 1: [22, 5529]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 9985, target_attr: gender, bias_attr: race bias_rate: 0.995
['[train] target_0-bias_0: 4407', '[train] target_0-bias_1: 27', '[train] target_1-bias_0: 22', '[train] target_1-bias_1: 5529']
confusion_matrix - 
 original: tensor([[4407.,   22.],
        [  27., 5529.]]), 
 normalized: tensor([[0.995, 0.005],
        [0.005, 0.995]]), 
 b|y: tensor([[0.994, 0.006],
        [0.004, 0.996]])
get_utk_face - split: train, aug: 1, given_y: True, ratio: 10
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_race-0.995
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [4407, 27]
Target 1: [22, 5529]
Binary Target 1
---------------------------
Target 0: [4407, 27]
Target 1: [22, 5529]
===================================
Normal Label Distribution: 
Target 0: [4407, 27]
Target 1: [22, 5529]
===================================
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [4407, 27]
Target 1: [22, 5529]
Binary Target 1
---------------------------
Target 0: [4407, 27]
Target 1: [22, 5529]
===================================
Normal Label Distribution: 
Target 0: [4407, 27]
Target 1: [22, 5529]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 9985, target_attr: gender, bias_attr: race bias_rate: 0.995
['[train] target_0-bias_0: 4407', '[train] target_0-bias_1: 27', '[train] target_1-bias_0: 22', '[train] target_1-bias_1: 5529']
get_utk_face - split: valid, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_race-0.995
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [583, 684]
Target 1: [457, 646]
Binary Target 1
---------------------------
Target 0: [583, 684]
Target 1: [457, 646]
===================================
Normal Label Distribution: 
Target 0: [583, 684]
Target 1: [457, 646]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 2370, target_attr: gender, bias_attr: race bias_rate: 0.995
['[valid] target_0-bias_0: 583', '[valid] target_0-bias_1: 684', '[valid] target_1-bias_0: 457', '[valid] target_1-bias_1: 646']
get_utk_face - split: test, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_race-0.995
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [558, 677]
Target 1: [462, 673]
Binary Target 1
---------------------------
Target 0: [558, 677]
Target 1: [462, 673]
===================================
Normal Label Distribution: 
Target 0: [558, 677]
Target 1: [462, 673]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 2370, target_attr: gender, bias_attr: race bias_rate: 0.995
['[test] target_0-bias_0: 558', '[test] target_0-bias_1: 677', '[test] target_1-bias_0: 462', '[test] target_1-bias_1: 673']
decay_epochs: [6, 13]
[1 / 20] Learning rate: 0.001 weight: 0.01
[1 / 20] Loss: 4.0605575472877575 CE Loss: 0.6622167446103523 Con Loss: 4.0539353869709895
[1 / 20] tensor([[0.285, 0.204],
        [0.913, 0.932]]) {'epoch': 1, 'valid/acc': 56.034, 'valid/acc_unbiased': 58.021, 'valid/diff': 5.996, 'valid/acc_skew': 55.023, 'valid/acc_align': 61.019, 'test/acc': 56.793, 'test/acc_unbiased': 58.346, 'test/diff': 4.967, 'test/acc_skew': 55.863, 'test/acc_align': 60.83}
[1 / 20] best valid accuracy: 58.021 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 56.034, 'best_valid_valid/acc_unbiased': 58.021, 'best_valid_valid/diff': 5.996, 'best_valid_valid/acc_skew': 55.023, 'best_valid_valid/acc_align': 61.019, 'best_valid_test/acc': 56.793, 'best_valid_test/acc_unbiased': 58.346, 'best_valid_test/diff': 4.967, 'best_valid_test/acc_skew': 55.863, 'best_valid_test/acc_align': 60.83}
[1 / 20] best test accuracy: 58.346 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 56.034, 'best_test_valid/acc_unbiased': 58.021, 'best_test_valid/diff': 5.996, 'best_test_valid/acc_skew': 55.023, 'best_test_valid/acc_align': 61.019, 'best_test_test/acc': 56.793, 'best_test_test/acc_unbiased': 58.346, 'best_test_test/diff': 4.967, 'best_test_test/acc_skew': 55.863, 'best_test_test/acc_align': 60.83}
[2 / 20] Learning rate: 0.001 weight: 0.01
[2 / 20] Loss: 3.856298979712416 CE Loss: 0.6649907710436409 Con Loss: 3.8496490654732862
[2 / 20] tensor([[0.896, 0.839],
        [0.132, 0.330]]) {'epoch': 2, 'valid/acc': 57.764, 'valid/acc_unbiased': 55.158, 'valid/diff': 6.846, 'valid/acc_skew': 51.735, 'valid/acc_align': 58.581, 'test/acc': 57.004, 'test/acc_unbiased': 54.924, 'test/diff': 12.745, 'test/acc_skew': 48.552, 'test/acc_align': 61.296}
[2 / 20] best valid accuracy: 58.021 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 56.034, 'best_valid_valid/acc_unbiased': 58.021, 'best_valid_valid/diff': 5.996, 'best_valid_valid/acc_skew': 55.023, 'best_valid_valid/acc_align': 61.019, 'best_valid_test/acc': 56.793, 'best_valid_test/acc_unbiased': 58.346, 'best_valid_test/diff': 4.967, 'best_valid_test/acc_skew': 55.863, 'best_valid_test/acc_align': 60.83}
[2 / 20] best test accuracy: 58.346 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 56.034, 'best_test_valid/acc_unbiased': 58.021, 'best_test_valid/diff': 5.996, 'best_test_valid/acc_skew': 55.023, 'best_test_valid/acc_align': 61.019, 'best_test_test/acc': 56.793, 'best_test_test/acc_unbiased': 58.346, 'best_test_test/diff': 4.967, 'best_test_test/acc_skew': 55.863, 'best_test_test/acc_align': 60.83}
[3 / 20] Learning rate: 0.001 weight: 0.01
[3 / 20] Loss: 3.548828684889679 CE Loss: 0.6879990464577271 Con Loss: 3.541948677935956
[3 / 20] tensor([[0.961, 0.907],
        [0.100, 0.153]]) {'epoch': 3, 'valid/acc': 56.118, 'valid/acc_unbiased': 53.23, 'valid/diff': 3.414, 'valid/acc_skew': 51.523, 'valid/acc_align': 54.937, 'test/acc': 54.81, 'test/acc_unbiased': 53.003, 'test/diff': 5.356, 'test/acc_skew': 50.325, 'test/acc_align': 55.681}
[3 / 20] best valid accuracy: 58.021 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 56.034, 'best_valid_valid/acc_unbiased': 58.021, 'best_valid_valid/diff': 5.996, 'best_valid_valid/acc_skew': 55.023, 'best_valid_valid/acc_align': 61.019, 'best_valid_test/acc': 56.793, 'best_valid_test/acc_unbiased': 58.346, 'best_valid_test/diff': 4.967, 'best_valid_test/acc_skew': 55.863, 'best_valid_test/acc_align': 60.83}
[3 / 20] best test accuracy: 58.346 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 56.034, 'best_test_valid/acc_unbiased': 58.021, 'best_test_valid/diff': 5.996, 'best_test_valid/acc_skew': 55.023, 'best_test_valid/acc_align': 61.019, 'best_test_test/acc': 56.793, 'best_test_test/acc_unbiased': 58.346, 'best_test_test/diff': 4.967, 'best_test_test/acc_skew': 55.863, 'best_test_test/acc_align': 60.83}
[4 / 20] Learning rate: 0.001 weight: 0.01
[4 / 20] Loss: 3.6942511345066307 CE Loss: 0.6942543497071245 Con Loss: 3.6873085994271557
[4 / 20] tensor([[0.961, 0.944],
        [0.056, 0.117]]) {'epoch': 4, 'valid/acc': 54.895, 'valid/acc_unbiased': 51.654, 'valid/diff': 2.808, 'valid/acc_skew': 50.25, 'valid/acc_align': 53.058, 'test/acc': 54.008, 'test/acc_unbiased': 51.953, 'test/diff': 3.891, 'test/acc_skew': 50.007, 'test/acc_align': 53.898}
[4 / 20] best valid accuracy: 58.021 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 56.034, 'best_valid_valid/acc_unbiased': 58.021, 'best_valid_valid/diff': 5.996, 'best_valid_valid/acc_skew': 55.023, 'best_valid_valid/acc_align': 61.019, 'best_valid_test/acc': 56.793, 'best_valid_test/acc_unbiased': 58.346, 'best_valid_test/diff': 4.967, 'best_valid_test/acc_skew': 55.863, 'best_valid_test/acc_align': 60.83}
[4 / 20] best test accuracy: 58.346 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 56.034, 'best_test_valid/acc_unbiased': 58.021, 'best_test_valid/diff': 5.996, 'best_test_valid/acc_skew': 55.023, 'best_test_valid/acc_align': 61.019, 'best_test_test/acc': 56.793, 'best_test_test/acc_unbiased': 58.346, 'best_test_test/diff': 4.967, 'best_test_test/acc_skew': 55.863, 'best_test_test/acc_align': 60.83}
[5 / 20] Learning rate: 0.001 weight: 0.01
[5 / 20] Loss: 4.00281597486304 CE Loss: 0.6819668171223128 Con Loss: 3.9959963073357976
[5 / 20] tensor([[0.025, 0.013],
        [0.989, 0.996]]) {'epoch': 5, 'valid/acc': 47.511, 'valid/acc_unbiased': 50.905, 'valid/diff': 0.373, 'valid/acc_skew': 50.841, 'valid/acc_align': 50.968, 'test/acc': 48.523, 'test/acc_unbiased': 50.578, 'test/diff': 0.908, 'test/acc_skew': 50.124, 'test/acc_align': 51.032}
[5 / 20] best valid accuracy: 58.021 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 56.034, 'best_valid_valid/acc_unbiased': 58.021, 'best_valid_valid/diff': 5.996, 'best_valid_valid/acc_skew': 55.023, 'best_valid_valid/acc_align': 61.019, 'best_valid_test/acc': 56.793, 'best_valid_test/acc_unbiased': 58.346, 'best_valid_test/diff': 4.967, 'best_valid_test/acc_skew': 55.863, 'best_valid_test/acc_align': 60.83}
[5 / 20] best test accuracy: 58.346 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 56.034, 'best_test_valid/acc_unbiased': 58.021, 'best_test_valid/diff': 5.996, 'best_test_valid/acc_skew': 55.023, 'best_test_valid/acc_align': 61.019, 'best_test_test/acc': 56.793, 'best_test_test/acc_unbiased': 58.346, 'best_test_test/diff': 4.967, 'best_test_test/acc_skew': 55.863, 'best_test_test/acc_align': 60.83}
[6 / 20] Learning rate: 0.001 weight: 0.01
[6 / 20] Loss: 3.8374589965829387 CE Loss: 0.6696518939915572 Con Loss: 3.8307624767706523
[6 / 20] tensor([[0.038, 0.021],
        [0.976, 0.988]]) {'epoch': 6, 'valid/acc': 46.878, 'valid/acc_unbiased': 50.13, 'valid/diff': 2.446, 'valid/acc_skew': 48.907, 'valid/acc_align': 51.353, 'test/acc': 48.565, 'test/acc_unbiased': 50.565, 'test/diff': 1.444, 'test/acc_skew': 49.843, 'test/acc_align': 51.287}
[6 / 20] best valid accuracy: 58.021 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 56.034, 'best_valid_valid/acc_unbiased': 58.021, 'best_valid_valid/diff': 5.996, 'best_valid_valid/acc_skew': 55.023, 'best_valid_valid/acc_align': 61.019, 'best_valid_test/acc': 56.793, 'best_valid_test/acc_unbiased': 58.346, 'best_valid_test/diff': 4.967, 'best_valid_test/acc_skew': 55.863, 'best_valid_test/acc_align': 60.83}
[6 / 20] best test accuracy: 58.346 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 56.034, 'best_test_valid/acc_unbiased': 58.021, 'best_test_valid/diff': 5.996, 'best_test_valid/acc_skew': 55.023, 'best_test_valid/acc_align': 61.019, 'best_test_test/acc': 56.793, 'best_test_test/acc_unbiased': 58.346, 'best_test_test/diff': 4.967, 'best_test_test/acc_skew': 55.863, 'best_test_test/acc_align': 60.83}
[7 / 20] Learning rate: 0.0001 weight: 0.01
[7 / 20] Loss: 3.4853155077906566 CE Loss: 0.6582792474558548 Con Loss: 3.47873271427336
[7 / 20] tensor([[0.131, 0.084],
        [0.911, 0.960]]) {'epoch': 7, 'valid/acc': 47.384, 'valid/acc_unbiased': 50.171, 'valid/diff': 6.092, 'valid/acc_skew': 47.125, 'valid/acc_align': 53.217, 'test/acc': 50.506, 'test/acc_unbiased': 52.154, 'test/diff': 4.763, 'test/acc_skew': 49.773, 'test/acc_align': 54.535}
[7 / 20] best valid accuracy: 58.021 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 56.034, 'best_valid_valid/acc_unbiased': 58.021, 'best_valid_valid/diff': 5.996, 'best_valid_valid/acc_skew': 55.023, 'best_valid_valid/acc_align': 61.019, 'best_valid_test/acc': 56.793, 'best_valid_test/acc_unbiased': 58.346, 'best_valid_test/diff': 4.967, 'best_valid_test/acc_skew': 55.863, 'best_valid_test/acc_align': 60.83}
[7 / 20] best test accuracy: 58.346 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 56.034, 'best_test_valid/acc_unbiased': 58.021, 'best_test_valid/diff': 5.996, 'best_test_valid/acc_skew': 55.023, 'best_test_valid/acc_align': 61.019, 'best_test_test/acc': 56.793, 'best_test_test/acc_unbiased': 58.346, 'best_test_test/diff': 4.967, 'best_test_test/acc_skew': 55.863, 'best_test_test/acc_align': 60.83}
[8 / 20] Learning rate: 0.0001 weight: 0.01
[8 / 20] Loss: 3.847379519137133 CE Loss: 0.6472871427961033 Con Loss: 3.8409066562719447
[8 / 20] tensor([[0.317, 0.198],
        [0.816, 0.875]]) {'epoch': 8, 'valid/acc': 51.646, 'valid/acc_unbiased': 53.691, 'valid/diff': 11.503, 'valid/acc_skew': 47.939, 'valid/acc_align': 59.442, 'test/acc': 53.882, 'test/acc_unbiased': 55.158, 'test/diff': 8.922, 'test/acc_skew': 50.697, 'test/acc_align': 59.619}
[8 / 20] best valid accuracy: 58.021 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 56.034, 'best_valid_valid/acc_unbiased': 58.021, 'best_valid_valid/diff': 5.996, 'best_valid_valid/acc_skew': 55.023, 'best_valid_valid/acc_align': 61.019, 'best_valid_test/acc': 56.793, 'best_valid_test/acc_unbiased': 58.346, 'best_valid_test/diff': 4.967, 'best_valid_test/acc_skew': 55.863, 'best_valid_test/acc_align': 60.83}
[8 / 20] best test accuracy: 58.346 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 56.034, 'best_test_valid/acc_unbiased': 58.021, 'best_test_valid/diff': 5.996, 'best_test_valid/acc_skew': 55.023, 'best_test_valid/acc_align': 61.019, 'best_test_test/acc': 56.793, 'best_test_test/acc_unbiased': 58.346, 'best_test_test/diff': 4.967, 'best_test_test/acc_skew': 55.863, 'best_test_test/acc_align': 60.83}
[9 / 20] Learning rate: 0.0001 weight: 0.01
[9 / 20] Loss: 3.7920038796987425 CE Loss: 0.6486561323561307 Con Loss: 3.78551732804934
[9 / 20] tensor([[0.369, 0.247],
        [0.775, 0.856]]) {'epoch': 9, 'valid/acc': 54.051, 'valid/acc_unbiased': 55.729, 'valid/diff': 12.501, 'valid/acc_skew': 49.478, 'valid/acc_align': 61.979, 'test/acc': 55.148, 'test/acc_unbiased': 56.165, 'test/diff': 10.174, 'test/acc_skew': 51.078, 'test/acc_align': 61.252}
[9 / 20] best valid accuracy: 58.021 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 56.034, 'best_valid_valid/acc_unbiased': 58.021, 'best_valid_valid/diff': 5.996, 'best_valid_valid/acc_skew': 55.023, 'best_valid_valid/acc_align': 61.019, 'best_valid_test/acc': 56.793, 'best_valid_test/acc_unbiased': 58.346, 'best_valid_test/diff': 4.967, 'best_valid_test/acc_skew': 55.863, 'best_valid_test/acc_align': 60.83}
[9 / 20] best test accuracy: 58.346 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 56.034, 'best_test_valid/acc_unbiased': 58.021, 'best_test_valid/diff': 5.996, 'best_test_valid/acc_skew': 55.023, 'best_test_valid/acc_align': 61.019, 'best_test_test/acc': 56.793, 'best_test_test/acc_unbiased': 58.346, 'best_test_test/diff': 4.967, 'best_test_test/acc_skew': 55.863, 'best_test_test/acc_align': 60.83}
[10 / 20] Learning rate: 0.0001 weight: 0.01
[10 / 20] Loss: 3.7937326673811893 CE Loss: 0.6466746330320925 Con Loss: 3.787265900414648
[10 / 20] tensor([[0.375, 0.253],
        [0.773, 0.865]]) {'epoch': 10, 'valid/acc': 54.304, 'valid/acc_unbiased': 55.911, 'valid/diff': 9.287, 'valid/acc_skew': 51.268, 'valid/acc_align': 60.555, 'test/acc': 55.654, 'test/acc_unbiased': 56.616, 'test/diff': 10.701, 'test/acc_skew': 51.266, 'test/acc_align': 61.967}
[10 / 20] best valid accuracy: 58.021 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 56.034, 'best_valid_valid/acc_unbiased': 58.021, 'best_valid_valid/diff': 5.996, 'best_valid_valid/acc_skew': 55.023, 'best_valid_valid/acc_align': 61.019, 'best_valid_test/acc': 56.793, 'best_valid_test/acc_unbiased': 58.346, 'best_valid_test/diff': 4.967, 'best_valid_test/acc_skew': 55.863, 'best_valid_test/acc_align': 60.83}
[10 / 20] best test accuracy: 58.346 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 56.034, 'best_test_valid/acc_unbiased': 58.021, 'best_test_valid/diff': 5.996, 'best_test_valid/acc_skew': 55.023, 'best_test_valid/acc_align': 61.019, 'best_test_test/acc': 56.793, 'best_test_test/acc_unbiased': 58.346, 'best_test_test/diff': 4.967, 'best_test_test/acc_skew': 55.863, 'best_test_test/acc_align': 60.83}
[11 / 20] Learning rate: 0.0001 weight: 0.01
[11 / 20] Loss: 3.6030591219857624 CE Loss: 0.6449725533522662 Con Loss: 3.596609411588238
[11 / 20] tensor([[0.310, 0.205],
        [0.814, 0.893]]) {'epoch': 11, 'valid/acc': 53.924, 'valid/acc_unbiased': 55.948, 'valid/diff': 6.303, 'valid/acc_skew': 52.796, 'valid/acc_align': 59.099, 'test/acc': 54.388, 'test/acc_unbiased': 55.556, 'test/diff': 9.194, 'test/acc_skew': 50.959, 'test/acc_align': 60.153}
[11 / 20] best valid accuracy: 58.021 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 56.034, 'best_valid_valid/acc_unbiased': 58.021, 'best_valid_valid/diff': 5.996, 'best_valid_valid/acc_skew': 55.023, 'best_valid_valid/acc_align': 61.019, 'best_valid_test/acc': 56.793, 'best_valid_test/acc_unbiased': 58.346, 'best_valid_test/diff': 4.967, 'best_valid_test/acc_skew': 55.863, 'best_valid_test/acc_align': 60.83}
[11 / 20] best test accuracy: 58.346 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 56.034, 'best_test_valid/acc_unbiased': 58.021, 'best_test_valid/diff': 5.996, 'best_test_valid/acc_skew': 55.023, 'best_test_valid/acc_align': 61.019, 'best_test_test/acc': 56.793, 'best_test_test/acc_unbiased': 58.346, 'best_test_test/diff': 4.967, 'best_test_test/acc_skew': 55.863, 'best_test_test/acc_align': 60.83}
[12 / 20] Learning rate: 0.0001 weight: 0.01
[12 / 20] Loss: 3.452566839703095 CE Loss: 0.637372759591954 Con Loss: 3.446193116333226
[12 / 20] tensor([[0.462, 0.346],
        [0.721, 0.782]]) {'epoch': 12, 'valid/acc': 56.16, 'valid/acc_unbiased': 57.179, 'valid/diff': 8.442, 'valid/acc_skew': 52.958, 'valid/acc_align': 61.4, 'test/acc': 57.004, 'test/acc_unbiased': 57.759, 'test/diff': 8.876, 'test/acc_skew': 53.321, 'test/acc_align': 62.197}
[12 / 20] best valid accuracy: 58.021 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 56.034, 'best_valid_valid/acc_unbiased': 58.021, 'best_valid_valid/diff': 5.996, 'best_valid_valid/acc_skew': 55.023, 'best_valid_valid/acc_align': 61.019, 'best_valid_test/acc': 56.793, 'best_valid_test/acc_unbiased': 58.346, 'best_valid_test/diff': 4.967, 'best_valid_test/acc_skew': 55.863, 'best_valid_test/acc_align': 60.83}
[12 / 20] best test accuracy: 58.346 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 56.034, 'best_test_valid/acc_unbiased': 58.021, 'best_test_valid/diff': 5.996, 'best_test_valid/acc_skew': 55.023, 'best_test_valid/acc_align': 61.019, 'best_test_test/acc': 56.793, 'best_test_test/acc_unbiased': 58.346, 'best_test_test/diff': 4.967, 'best_test_test/acc_skew': 55.863, 'best_test_test/acc_align': 60.83}
[13 / 20] Learning rate: 0.0001 weight: 0.01
[13 / 20] Loss: 3.8550429041288945 CE Loss: 0.6300357347497 Con Loss: 3.8487425363833867
[13 / 20] tensor([[0.396, 0.267],
        [0.788, 0.880]]) {'epoch': 13, 'valid/acc': 55.316, 'valid/acc_unbiased': 56.941, 'valid/diff': 8.424, 'valid/acc_skew': 52.729, 'valid/acc_align': 61.153, 'test/acc': 57.3, 'test/acc_unbiased': 58.273, 'test/diff': 11.023, 'test/acc_skew': 52.762, 'test/acc_align': 63.785}
[13 / 20] best valid accuracy: 58.021 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 56.034, 'best_valid_valid/acc_unbiased': 58.021, 'best_valid_valid/diff': 5.996, 'best_valid_valid/acc_skew': 55.023, 'best_valid_valid/acc_align': 61.019, 'best_valid_test/acc': 56.793, 'best_valid_test/acc_unbiased': 58.346, 'best_valid_test/diff': 4.967, 'best_valid_test/acc_skew': 55.863, 'best_valid_test/acc_align': 60.83}
[13 / 20] best test accuracy: 58.346 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 56.034, 'best_test_valid/acc_unbiased': 58.021, 'best_test_valid/diff': 5.996, 'best_test_valid/acc_skew': 55.023, 'best_test_valid/acc_align': 61.019, 'best_test_test/acc': 56.793, 'best_test_test/acc_unbiased': 58.346, 'best_test_test/diff': 4.967, 'best_test_test/acc_skew': 55.863, 'best_test_test/acc_align': 60.83}
[14 / 20] Learning rate: 1e-05 weight: 0.01
[14 / 20] Loss: 3.5909028633570874 CE Loss: 0.6251147535961153 Con Loss: 3.584651722046036
[14 / 20] tensor([[0.412, 0.285],
        [0.773, 0.862]]) {'epoch': 14, 'valid/acc': 57.046, 'valid/acc_unbiased': 58.488, 'valid/diff': 7.35, 'valid/acc_skew': 54.813, 'valid/acc_align': 62.163, 'test/acc': 57.384, 'test/acc_unbiased': 58.295, 'test/diff': 10.81, 'test/acc_skew': 52.89, 'test/acc_align': 63.7}
[14 / 20] best valid accuracy: 58.488 at epoch 14 
 best_stats: {'best_valid_epoch': 14, 'best_valid_valid/acc': 57.046, 'best_valid_valid/acc_unbiased': 58.488, 'best_valid_valid/diff': 7.35, 'best_valid_valid/acc_skew': 54.813, 'best_valid_valid/acc_align': 62.163, 'best_valid_test/acc': 57.384, 'best_valid_test/acc_unbiased': 58.295, 'best_valid_test/diff': 10.81, 'best_valid_test/acc_skew': 52.89, 'best_valid_test/acc_align': 63.7}
[14 / 20] best test accuracy: 58.346 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 56.034, 'best_test_valid/acc_unbiased': 58.021, 'best_test_valid/diff': 5.996, 'best_test_valid/acc_skew': 55.023, 'best_test_valid/acc_align': 61.019, 'best_test_test/acc': 56.793, 'best_test_test/acc_unbiased': 58.346, 'best_test_test/diff': 4.967, 'best_test_test/acc_skew': 55.863, 'best_test_test/acc_align': 60.83}
[15 / 20] Learning rate: 1e-05 weight: 0.01
[15 / 20] Loss: 3.4836783520752377 CE Loss: 0.6221653222261695 Con Loss: 3.4774566849052877
[15 / 20] tensor([[0.457, 0.329],
        [0.747, 0.838]]) {'epoch': 15, 'valid/acc': 57.553, 'valid/acc_unbiased': 58.745, 'valid/diff': 7.929, 'valid/acc_skew': 54.78, 'valid/acc_align': 62.709, 'test/acc': 58.523, 'test/acc_unbiased': 59.279, 'test/diff': 10.944, 'test/acc_skew': 53.807, 'test/acc_align': 64.751}
[15 / 20] best valid accuracy: 58.745 at epoch 15 
 best_stats: {'best_valid_epoch': 15, 'best_valid_valid/acc': 57.553, 'best_valid_valid/acc_unbiased': 58.745, 'best_valid_valid/diff': 7.929, 'best_valid_valid/acc_skew': 54.78, 'best_valid_valid/acc_align': 62.709, 'best_valid_test/acc': 58.523, 'best_valid_test/acc_unbiased': 59.279, 'best_valid_test/diff': 10.944, 'best_valid_test/acc_skew': 53.807, 'best_valid_test/acc_align': 64.751}
[15 / 20] best test accuracy: 59.279 at epoch 15 
 best_stats: {'best_test_epoch': 15, 'best_test_valid/acc': 57.553, 'best_test_valid/acc_unbiased': 58.745, 'best_test_valid/diff': 7.929, 'best_test_valid/acc_skew': 54.78, 'best_test_valid/acc_align': 62.709, 'best_test_test/acc': 58.523, 'best_test_test/acc_unbiased': 59.279, 'best_test_test/diff': 10.944, 'best_test_test/acc_skew': 53.807, 'best_test_test/acc_align': 64.751}
[16 / 20] Learning rate: 1e-05 weight: 0.01
[16 / 20] Loss: 3.5051992724821694 CE Loss: 0.6244646493112319 Con Loss: 3.4989545949172784
[16 / 20] tensor([[0.538, 0.387],
        [0.675, 0.808]]) {'epoch': 16, 'valid/acc': 60.38, 'valid/acc_unbiased': 61.199, 'valid/diff': 7.422, 'valid/acc_skew': 57.488, 'valid/acc_align': 64.91, 'test/acc': 59.831, 'test/acc_unbiased': 60.207, 'test/diff': 14.181, 'test/acc_skew': 53.116, 'test/acc_align': 67.298}
[16 / 20] best valid accuracy: 61.199 at epoch 16 
 best_stats: {'best_valid_epoch': 16, 'best_valid_valid/acc': 60.38, 'best_valid_valid/acc_unbiased': 61.199, 'best_valid_valid/diff': 7.422, 'best_valid_valid/acc_skew': 57.488, 'best_valid_valid/acc_align': 64.91, 'best_valid_test/acc': 59.831, 'best_valid_test/acc_unbiased': 60.207, 'best_valid_test/diff': 14.181, 'best_valid_test/acc_skew': 53.116, 'best_valid_test/acc_align': 67.298}
[16 / 20] best test accuracy: 60.207 at epoch 16 
 best_stats: {'best_test_epoch': 16, 'best_test_valid/acc': 60.38, 'best_test_valid/acc_unbiased': 61.199, 'best_test_valid/diff': 7.422, 'best_test_valid/acc_skew': 57.488, 'best_test_valid/acc_align': 64.91, 'best_test_test/acc': 59.831, 'best_test_test/acc_unbiased': 60.207, 'best_test_test/diff': 14.181, 'best_test_test/acc_skew': 53.116, 'best_test_test/acc_align': 67.298}
[17 / 20] Learning rate: 1e-05 weight: 0.01
[17 / 20] Loss: 3.3303206680115904 CE Loss: 0.6236614973114083 Con Loss: 3.324084039515236
[17 / 20] tensor([[0.518, 0.387],
        [0.675, 0.779]]) {'epoch': 17, 'valid/acc': 59.325, 'valid/acc_unbiased': 60.144, 'valid/diff': 8.305, 'valid/acc_skew': 55.991, 'valid/acc_align': 64.297, 'test/acc': 58.523, 'test/acc_unbiased': 58.971, 'test/diff': 11.71, 'test/acc_skew': 53.116, 'test/acc_align': 64.826}
[17 / 20] best valid accuracy: 61.199 at epoch 16 
 best_stats: {'best_valid_epoch': 16, 'best_valid_valid/acc': 60.38, 'best_valid_valid/acc_unbiased': 61.199, 'best_valid_valid/diff': 7.422, 'best_valid_valid/acc_skew': 57.488, 'best_valid_valid/acc_align': 64.91, 'best_valid_test/acc': 59.831, 'best_valid_test/acc_unbiased': 60.207, 'best_valid_test/diff': 14.181, 'best_valid_test/acc_skew': 53.116, 'best_valid_test/acc_align': 67.298}
[17 / 20] best test accuracy: 60.207 at epoch 16 
 best_stats: {'best_test_epoch': 16, 'best_test_valid/acc': 60.38, 'best_test_valid/acc_unbiased': 61.199, 'best_test_valid/diff': 7.422, 'best_test_valid/acc_skew': 57.488, 'best_test_valid/acc_align': 64.91, 'best_test_test/acc': 59.831, 'best_test_test/acc_unbiased': 60.207, 'best_test_test/diff': 14.181, 'best_test_test/acc_skew': 53.116, 'best_test_test/acc_align': 67.298}
[18 / 20] Learning rate: 1e-05 weight: 0.01
[18 / 20] Loss: 3.496075008920747 CE Loss: 0.6190293428536111 Con Loss: 3.4898847080435105
[18 / 20] tensor([[0.446, 0.310],
        [0.760, 0.838]]) {'epoch': 18, 'valid/acc': 58.143, 'valid/acc_unbiased': 59.34, 'valid/diff': 6.638, 'valid/acc_skew': 56.022, 'valid/acc_align': 62.659, 'test/acc': 57.975, 'test/acc_unbiased': 58.855, 'test/diff': 10.717, 'test/acc_skew': 53.497, 'test/acc_align': 64.214}
[18 / 20] best valid accuracy: 61.199 at epoch 16 
 best_stats: {'best_valid_epoch': 16, 'best_valid_valid/acc': 60.38, 'best_valid_valid/acc_unbiased': 61.199, 'best_valid_valid/diff': 7.422, 'best_valid_valid/acc_skew': 57.488, 'best_valid_valid/acc_align': 64.91, 'best_valid_test/acc': 59.831, 'best_valid_test/acc_unbiased': 60.207, 'best_valid_test/diff': 14.181, 'best_valid_test/acc_skew': 53.116, 'best_valid_test/acc_align': 67.298}
[18 / 20] best test accuracy: 60.207 at epoch 16 
 best_stats: {'best_test_epoch': 16, 'best_test_valid/acc': 60.38, 'best_test_valid/acc_unbiased': 61.199, 'best_test_valid/diff': 7.422, 'best_test_valid/acc_skew': 57.488, 'best_test_valid/acc_align': 64.91, 'best_test_test/acc': 59.831, 'best_test_test/acc_unbiased': 60.207, 'best_test_test/diff': 14.181, 'best_test_test/acc_skew': 53.116, 'best_test_test/acc_align': 67.298}
[19 / 20] Learning rate: 1e-05 weight: 0.01
[19 / 20] Loss: 3.42776867966086 CE Loss: 0.6214572272661273 Con Loss: 3.421554091111624
[19 / 20] tensor([[0.525, 0.408],
        [0.684, 0.793]]) {'epoch': 19, 'valid/acc': 60.338, 'valid/acc_unbiased': 61.1, 'valid/diff': 6.93, 'valid/acc_skew': 57.635, 'valid/acc_align': 64.565, 'test/acc': 59.873, 'test/acc_unbiased': 60.255, 'test/diff': 11.344, 'test/acc_skew': 54.583, 'test/acc_align': 65.928}
[19 / 20] best valid accuracy: 61.199 at epoch 16 
 best_stats: {'best_valid_epoch': 16, 'best_valid_valid/acc': 60.38, 'best_valid_valid/acc_unbiased': 61.199, 'best_valid_valid/diff': 7.422, 'best_valid_valid/acc_skew': 57.488, 'best_valid_valid/acc_align': 64.91, 'best_valid_test/acc': 59.831, 'best_valid_test/acc_unbiased': 60.207, 'best_valid_test/diff': 14.181, 'best_valid_test/acc_skew': 53.116, 'best_valid_test/acc_align': 67.298}
[19 / 20] best test accuracy: 60.255 at epoch 19 
 best_stats: {'best_test_epoch': 19, 'best_test_valid/acc': 60.338, 'best_test_valid/acc_unbiased': 61.1, 'best_test_valid/diff': 6.93, 'best_test_valid/acc_skew': 57.635, 'best_test_valid/acc_align': 64.565, 'best_test_test/acc': 59.873, 'best_test_test/acc_unbiased': 60.255, 'best_test_test/diff': 11.344, 'best_test_test/acc_skew': 54.583, 'best_test_test/acc_align': 65.928}
[20 / 20] Learning rate: 1e-05 weight: 0.01
[20 / 20] Loss: 3.6560077247765284 CE Loss: 0.6160566398664062 Con Loss: 3.6498471472582104
[20 / 20] tensor([[0.509, 0.378],
        [0.708, 0.816]]) {'epoch': 20, 'valid/acc': 59.662, 'valid/acc_unbiased': 60.602, 'valid/diff': 7.692, 'valid/acc_skew': 56.756, 'valid/acc_align': 64.448, 'test/acc': 59.747, 'test/acc_unbiased': 60.266, 'test/diff': 11.939, 'test/acc_skew': 54.297, 'test/acc_align': 66.236}
[20 / 20] best valid accuracy: 61.199 at epoch 16 
 best_stats: {'best_valid_epoch': 16, 'best_valid_valid/acc': 60.38, 'best_valid_valid/acc_unbiased': 61.199, 'best_valid_valid/diff': 7.422, 'best_valid_valid/acc_skew': 57.488, 'best_valid_valid/acc_align': 64.91, 'best_valid_test/acc': 59.831, 'best_valid_test/acc_unbiased': 60.207, 'best_valid_test/diff': 14.181, 'best_valid_test/acc_skew': 53.116, 'best_valid_test/acc_align': 67.298}
[20 / 20] best test accuracy: 60.266 at epoch 20 
 best_stats: {'best_test_epoch': 20, 'best_test_valid/acc': 59.662, 'best_test_valid/acc_unbiased': 60.602, 'best_test_valid/diff': 7.692, 'best_test_valid/acc_skew': 56.756, 'best_test_valid/acc_align': 64.448, 'best_test_test/acc': 59.747, 'best_test_test/acc_unbiased': 60.266, 'best_test_test/diff': 11.939, 'best_test_test/acc_skew': 54.297, 'best_test_test/acc_align': 66.236}
Total training time: 0:52:45
