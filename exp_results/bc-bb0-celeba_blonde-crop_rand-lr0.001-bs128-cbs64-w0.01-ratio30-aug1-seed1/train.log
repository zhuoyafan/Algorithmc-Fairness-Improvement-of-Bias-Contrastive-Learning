Log level set to: INFO
Set seed: 1
=======> Using Fixed Random Seed: 1 <========
save_path: exp_results/bc-bb0-celeba_blonde-crop_rand-lr0.001-bs128-cbs64-w0.01-ratio30-aug1-seed1
get_celeba - split:train, aug: False, given_y: True, ratio: 0
use existing blonde indices from data/celeba/pickles/blonde
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [1558, 53577]
Target 1: [18279, 1098]
Binary Target 1
---------------------------
Target 0: [1558, 53577]
Target 1: [18279, 1098]
===================================
Normal Label Distribution: 
Target 0: [1558, 53577]
Target 1: [18279, 1098]
===================================
Use BiasedCelebASplit 
 target_attr: blonde split: train 
 tensor([[ 1558., 18279.],
        [53577.,  1098.]])
get_celeba - split:train, aug: 1, given_y: True, ratio: 30
use existing blonde indices from data/celeba/pickles/blonde
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [1606, 53425]
Target 1: [18350, 1131]
Binary Target 1
---------------------------
Target 0: [1606, 53425]
Target 1: [18350, 1131]
===================================
Normal Label Distribution: 
Target 0: [1606, 53425]
Target 1: [18350, 1131]
===================================
Use BiasedCelebASplit 
 target_attr: blonde split: train 
 tensor([[ 1606., 18350.],
        [53425.,  1131.]])
get_celeba - split:train_valid, aug: False, given_y: True, ratio: 0
use existing blonde indices from data/celeba/pickles/blonde
Use BiasedCelebASplit 
 target_attr: blonde split: train_valid 
 tensor([[  390.,  4598.],
        [13361.,   280.]])
get_celeba - split:valid, aug: False, given_y: True, ratio: 0
Use BiasedCelebASplit 
 target_attr: blonde split: valid 
 tensor([[8535., 2874.],
        [8276.,  182.]])
decay_epochs: [3, 6]
[1 / 10] Learning rate: 0.001 weight: 0.01
[1 / 10] Loss: 4.709052971050876 CE Loss: 0.21149564421635111 Con Loss: 4.706938011594563
[1 / 10] tensor([[0.923, 0.948],
        [0.860, 0.775]]) {'epoch': 1, 'valid/acc': 91.91, 'valid/acc_unbiased': 88.491, 'valid/diff': 3.406, 'valid/acc_skew': 87.079, 'valid/acc_align': 89.902, 'test/acc': 92.274, 'test/acc_unbiased': 87.627, 'test/diff': 5.479, 'test/acc_skew': 84.887, 'test/acc_align': 90.367}
[1 / 10] best valid accuracy: 88.491 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 91.91, 'best_valid_valid/acc_unbiased': 88.491, 'best_valid_valid/diff': 3.406, 'best_valid_valid/acc_skew': 87.079, 'best_valid_valid/acc_align': 89.902, 'best_valid_test/acc': 92.274, 'best_valid_test/acc_unbiased': 87.627, 'best_valid_test/diff': 5.479, 'best_valid_test/acc_skew': 84.887, 'best_valid_test/acc_align': 90.367}
[1 / 10] best test accuracy: 87.627 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 91.91, 'best_test_valid/acc_unbiased': 88.491, 'best_test_valid/diff': 3.406, 'best_test_valid/acc_skew': 87.079, 'best_test_valid/acc_align': 89.902, 'best_test_test/acc': 92.274, 'best_test_test/acc_unbiased': 87.627, 'best_test_test/diff': 5.479, 'best_test_test/acc_skew': 84.887, 'best_test_test/acc_align': 90.367}
[2 / 10] Learning rate: 0.001 weight: 0.01
[2 / 10] Loss: 4.668818235653317 CE Loss: 0.18595138672136918 Con Loss: 4.666958727702476
[2 / 10] tensor([[0.956, 0.984],
        [0.781, 0.604]]) {'epoch': 2, 'valid/acc': 92.388, 'valid/acc_unbiased': 84.68, 'valid/diff': 7.192, 'valid/acc_skew': 81.63, 'valid/acc_align': 87.73, 'test/acc': 93.91, 'test/acc_unbiased': 83.136, 'test/diff': 10.272, 'test/acc_skew': 78.0, 'test/acc_align': 88.272}
[2 / 10] best valid accuracy: 88.491 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 91.91, 'best_valid_valid/acc_unbiased': 88.491, 'best_valid_valid/diff': 3.406, 'best_valid_valid/acc_skew': 87.079, 'best_valid_valid/acc_align': 89.902, 'best_valid_test/acc': 92.274, 'best_valid_test/acc_unbiased': 87.627, 'best_valid_test/diff': 5.479, 'best_valid_test/acc_skew': 84.887, 'best_valid_test/acc_align': 90.367}
[2 / 10] best test accuracy: 87.627 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 91.91, 'best_test_valid/acc_unbiased': 88.491, 'best_test_valid/diff': 3.406, 'best_test_valid/acc_skew': 87.079, 'best_test_valid/acc_align': 89.902, 'best_test_test/acc': 92.274, 'best_test_test/acc_unbiased': 87.627, 'best_test_test/diff': 5.479, 'best_test_test/acc_skew': 84.887, 'best_test_test/acc_align': 90.367}
[3 / 10] Learning rate: 0.001 weight: 0.01
[3 / 10] Loss: 4.6554977693653985 CE Loss: 0.1735529803029196 Con Loss: 4.653762239690039
[3 / 10] tensor([[0.955, 0.984],
        [0.783, 0.621]]) {'epoch': 3, 'valid/acc': 92.351, 'valid/acc_unbiased': 84.563, 'valid/diff': 6.794, 'valid/acc_skew': 81.63, 'valid/acc_align': 87.497, 'test/acc': 93.894, 'test/acc_unbiased': 83.564, 'test/diff': 9.587, 'test/acc_skew': 78.771, 'test/acc_align': 88.358}
[3 / 10] best valid accuracy: 88.491 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 91.91, 'best_valid_valid/acc_unbiased': 88.491, 'best_valid_valid/diff': 3.406, 'best_valid_valid/acc_skew': 87.079, 'best_valid_valid/acc_align': 89.902, 'best_valid_test/acc': 92.274, 'best_valid_test/acc_unbiased': 87.627, 'best_valid_test/diff': 5.479, 'best_valid_test/acc_skew': 84.887, 'best_valid_test/acc_align': 90.367}
[3 / 10] best test accuracy: 87.627 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 91.91, 'best_test_valid/acc_unbiased': 88.491, 'best_test_valid/diff': 3.406, 'best_test_valid/acc_skew': 87.079, 'best_test_valid/acc_align': 89.902, 'best_test_test/acc': 92.274, 'best_test_test/acc_unbiased': 87.627, 'best_test_test/diff': 5.479, 'best_test_test/acc_skew': 84.887, 'best_test_test/acc_align': 90.367}
[4 / 10] Learning rate: 0.0001 weight: 0.01
[4 / 10] Loss: 4.600597764024004 CE Loss: 0.14760092448219994 Con Loss: 4.5991217482363895
[4 / 10] tensor([[0.909, 0.973],
        [0.916, 0.813]]) {'epoch': 4, 'valid/acc': 95.115, 'valid/acc_unbiased': 92.199, 'valid/diff': 4.574, 'valid/acc_skew': 90.453, 'valid/acc_align': 93.944, 'test/acc': 93.567, 'test/acc_unbiased': 90.275, 'test/diff': 8.346, 'test/acc_skew': 86.102, 'test/acc_align': 94.448}
[4 / 10] best valid accuracy: 92.199 at epoch 4 
 best_stats: {'best_valid_epoch': 4, 'best_valid_valid/acc': 95.115, 'best_valid_valid/acc_unbiased': 92.199, 'best_valid_valid/diff': 4.574, 'best_valid_valid/acc_skew': 90.453, 'best_valid_valid/acc_align': 93.944, 'best_valid_test/acc': 93.567, 'best_valid_test/acc_unbiased': 90.275, 'best_valid_test/diff': 8.346, 'best_valid_test/acc_skew': 86.102, 'best_valid_test/acc_align': 94.448}
[4 / 10] best test accuracy: 90.275 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 95.115, 'best_test_valid/acc_unbiased': 92.199, 'best_test_valid/diff': 4.574, 'best_test_valid/acc_skew': 90.453, 'best_test_valid/acc_align': 93.944, 'best_test_test/acc': 93.567, 'best_test_test/acc_unbiased': 90.275, 'best_test_test/diff': 8.346, 'best_test_test/acc_skew': 86.102, 'best_test_test/acc_align': 94.448}
[5 / 10] Learning rate: 0.0001 weight: 0.01
[5 / 10] Loss: 4.574578261155286 CE Loss: 0.13982903082639664 Con Loss: 4.573179974944033
[5 / 10] tensor([[0.926, 0.979],
        [0.904, 0.791]]) {'epoch': 5, 'valid/acc': 95.104, 'valid/acc_unbiased': 91.408, 'valid/diff': 5.25, 'valid/acc_skew': 89.409, 'valid/acc_align': 93.406, 'test/acc': 94.347, 'test/acc_unbiased': 89.994, 'test/diff': 8.295, 'test/acc_skew': 85.846, 'test/acc_align': 94.141}
[5 / 10] best valid accuracy: 92.199 at epoch 4 
 best_stats: {'best_valid_epoch': 4, 'best_valid_valid/acc': 95.115, 'best_valid_valid/acc_unbiased': 92.199, 'best_valid_valid/diff': 4.574, 'best_valid_valid/acc_skew': 90.453, 'best_valid_valid/acc_align': 93.944, 'best_valid_test/acc': 93.567, 'best_valid_test/acc_unbiased': 90.275, 'best_valid_test/diff': 8.346, 'best_valid_test/acc_skew': 86.102, 'best_valid_test/acc_align': 94.448}
[5 / 10] best test accuracy: 90.275 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 95.115, 'best_test_valid/acc_unbiased': 92.199, 'best_test_valid/diff': 4.574, 'best_test_valid/acc_skew': 90.453, 'best_test_valid/acc_align': 93.944, 'best_test_test/acc': 93.567, 'best_test_test/acc_unbiased': 90.275, 'best_test_test/diff': 8.346, 'best_test_test/acc_skew': 86.102, 'best_test_test/acc_align': 94.448}
[6 / 10] Learning rate: 0.0001 weight: 0.01
[6 / 10] Loss: 4.568604589199748 CE Loss: 0.13557715078190669 Con Loss: 4.567248818289192
[6 / 10] tensor([[0.930, 0.980],
        [0.894, 0.758]]) {'epoch': 6, 'valid/acc': 95.185, 'valid/acc_unbiased': 91.044, 'valid/diff': 6.829, 'valid/acc_skew': 88.672, 'valid/acc_align': 93.417, 'test/acc': 94.388, 'test/acc_unbiased': 89.05, 'test/diff': 9.293, 'test/acc_skew': 84.403, 'test/acc_align': 93.696}
[6 / 10] best valid accuracy: 92.199 at epoch 4 
 best_stats: {'best_valid_epoch': 4, 'best_valid_valid/acc': 95.115, 'best_valid_valid/acc_unbiased': 92.199, 'best_valid_valid/diff': 4.574, 'best_valid_valid/acc_skew': 90.453, 'best_valid_valid/acc_align': 93.944, 'best_valid_test/acc': 93.567, 'best_valid_test/acc_unbiased': 90.275, 'best_valid_test/diff': 8.346, 'best_valid_test/acc_skew': 86.102, 'best_valid_test/acc_align': 94.448}
[6 / 10] best test accuracy: 90.275 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 95.115, 'best_test_valid/acc_unbiased': 92.199, 'best_test_valid/diff': 4.574, 'best_test_valid/acc_skew': 90.453, 'best_test_valid/acc_align': 93.944, 'best_test_test/acc': 93.567, 'best_test_test/acc_unbiased': 90.275, 'best_test_test/diff': 8.346, 'best_test_test/acc_skew': 86.102, 'best_test_test/acc_align': 94.448}
[7 / 10] Learning rate: 1e-05 weight: 0.01
[7 / 10] Loss: 4.559820828530982 CE Loss: 0.13241331023619055 Con Loss: 4.558496695156642
[7 / 10] tensor([[0.921, 0.977],
        [0.914, 0.808]]) {'epoch': 7, 'valid/acc': 95.308, 'valid/acc_unbiased': 92.445, 'valid/diff': 5.376, 'valid/acc_skew': 90.994, 'valid/acc_align': 93.896, 'test/acc': 94.237, 'test/acc_unbiased': 90.499, 'test/diff': 8.149, 'test/acc_skew': 86.424, 'test/acc_align': 94.573}
[7 / 10] best valid accuracy: 92.445 at epoch 7 
 best_stats: {'best_valid_epoch': 7, 'best_valid_valid/acc': 95.308, 'best_valid_valid/acc_unbiased': 92.445, 'best_valid_valid/diff': 5.376, 'best_valid_valid/acc_skew': 90.994, 'best_valid_valid/acc_align': 93.896, 'best_valid_test/acc': 94.237, 'best_valid_test/acc_unbiased': 90.499, 'best_valid_test/diff': 8.149, 'best_valid_test/acc_skew': 86.424, 'best_valid_test/acc_align': 94.573}
[7 / 10] best test accuracy: 90.499 at epoch 7 
 best_stats: {'best_test_epoch': 7, 'best_test_valid/acc': 95.308, 'best_test_valid/acc_unbiased': 92.445, 'best_test_valid/diff': 5.376, 'best_test_valid/acc_skew': 90.994, 'best_test_valid/acc_align': 93.896, 'best_test_test/acc': 94.237, 'best_test_test/acc_unbiased': 90.499, 'best_test_test/diff': 8.149, 'best_test_test/acc_skew': 86.424, 'best_test_test/acc_align': 94.573}
[8 / 10] Learning rate: 1e-05 weight: 0.01
[8 / 10] Loss: 4.553306634266898 CE Loss: 0.1293280996639815 Con Loss: 4.552013358512815
[8 / 10] tensor([[0.927, 0.979],
        [0.903, 0.786]]) {'epoch': 8, 'valid/acc': 95.174, 'valid/acc_unbiased': 91.59, 'valid/diff': 5.889, 'valid/acc_skew': 89.744, 'valid/acc_align': 93.437, 'test/acc': 94.403, 'test/acc_unbiased': 89.88, 'test/diff': 8.465, 'test/acc_skew': 85.648, 'test/acc_align': 94.112}
[8 / 10] best valid accuracy: 92.445 at epoch 7 
 best_stats: {'best_valid_epoch': 7, 'best_valid_valid/acc': 95.308, 'best_valid_valid/acc_unbiased': 92.445, 'best_valid_valid/diff': 5.376, 'best_valid_valid/acc_skew': 90.994, 'best_valid_valid/acc_align': 93.896, 'best_valid_test/acc': 94.237, 'best_valid_test/acc_unbiased': 90.499, 'best_valid_test/diff': 8.149, 'best_valid_test/acc_skew': 86.424, 'best_valid_test/acc_align': 94.573}
[8 / 10] best test accuracy: 90.499 at epoch 7 
 best_stats: {'best_test_epoch': 7, 'best_test_valid/acc': 95.308, 'best_test_valid/acc_unbiased': 92.445, 'best_test_valid/diff': 5.376, 'best_test_valid/acc_skew': 90.994, 'best_test_valid/acc_align': 93.896, 'best_test_test/acc': 94.237, 'best_test_test/acc_unbiased': 90.499, 'best_test_test/diff': 8.149, 'best_test_test/acc_skew': 86.424, 'best_test_test/acc_align': 94.573}
[9 / 10] Learning rate: 1e-05 weight: 0.01
[9 / 10] Loss: 4.550776820544242 CE Loss: 0.12913722474674363 Con Loss: 4.549485453981839
[9 / 10] tensor([[0.900, 0.968],
        [0.929, 0.830]]) {'epoch': 9, 'valid/acc': 95.486, 'valid/acc_unbiased': 93.863, 'valid/diff': 4.659, 'valid/acc_skew': 92.88, 'valid/acc_align': 94.845, 'test/acc': 93.18, 'test/acc_unbiased': 90.656, 'test/diff': 8.328, 'test/acc_skew': 86.492, 'test/acc_align': 94.82}
[9 / 10] best valid accuracy: 93.863 at epoch 9 
 best_stats: {'best_valid_epoch': 9, 'best_valid_valid/acc': 95.486, 'best_valid_valid/acc_unbiased': 93.863, 'best_valid_valid/diff': 4.659, 'best_valid_valid/acc_skew': 92.88, 'best_valid_valid/acc_align': 94.845, 'best_valid_test/acc': 93.18, 'best_valid_test/acc_unbiased': 90.656, 'best_valid_test/diff': 8.328, 'best_valid_test/acc_skew': 86.492, 'best_valid_test/acc_align': 94.82}
[9 / 10] best test accuracy: 90.656 at epoch 9 
 best_stats: {'best_test_epoch': 9, 'best_test_valid/acc': 95.486, 'best_test_valid/acc_unbiased': 93.863, 'best_test_valid/diff': 4.659, 'best_test_valid/acc_skew': 92.88, 'best_test_valid/acc_align': 94.845, 'best_test_test/acc': 93.18, 'best_test_test/acc_unbiased': 90.656, 'best_test_test/diff': 8.328, 'best_test_test/acc_skew': 86.492, 'best_test_test/acc_align': 94.82}
[10 / 10] Learning rate: 1e-05 weight: 0.01
[10 / 10] Loss: 4.5486166852468175 CE Loss: 0.12695022560584077 Con Loss: 4.547347172509198
[10 / 10] tensor([[0.912, 0.976],
        [0.916, 0.775]]) {'epoch': 10, 'valid/acc': 95.41, 'valid/acc_unbiased': 92.9, 'valid/diff': 5.014, 'valid/acc_skew': 91.58, 'valid/acc_align': 94.22, 'test/acc': 93.814, 'test/acc_unbiased': 89.474, 'test/diff': 10.263, 'test/acc_skew': 84.343, 'test/acc_align': 94.606}
[10 / 10] best valid accuracy: 93.863 at epoch 9 
 best_stats: {'best_valid_epoch': 9, 'best_valid_valid/acc': 95.486, 'best_valid_valid/acc_unbiased': 93.863, 'best_valid_valid/diff': 4.659, 'best_valid_valid/acc_skew': 92.88, 'best_valid_valid/acc_align': 94.845, 'best_valid_test/acc': 93.18, 'best_valid_test/acc_unbiased': 90.656, 'best_valid_test/diff': 8.328, 'best_valid_test/acc_skew': 86.492, 'best_valid_test/acc_align': 94.82}
[10 / 10] best test accuracy: 90.656 at epoch 9 
 best_stats: {'best_test_epoch': 9, 'best_test_valid/acc': 95.486, 'best_test_valid/acc_unbiased': 93.863, 'best_test_valid/diff': 4.659, 'best_test_valid/acc_skew': 92.88, 'best_test_valid/acc_align': 94.845, 'best_test_test/acc': 93.18, 'best_test_test/acc_unbiased': 90.656, 'best_test_test/diff': 8.328, 'best_test_test/acc_skew': 86.492, 'best_test_test/acc_align': 94.82}
Total training time: 1:21:00
