Log level set to: INFO
Set seed: 2
=======> Using Fixed Random Seed: 2 <========
save_path: exp_results/bc-bb0-utk_face_age-test-0.8-lr0.001-bs128-cbs64-w0.01-ratio10-aug1-seed2
get_utk_face - split: train, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_age-0.8
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [8237, 295]
Target 1: [1647, 1477]
Binary Target 1
---------------------------
Target 0: [8237, 295]
Target 1: [1647, 1477]
===================================
Normal Label Distribution: 
Target 0: [8237, 295]
Target 1: [1647, 1477]
===================================
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [8237, 295]
Target 1: [1647, 1477]
Binary Target 1
---------------------------
Target 0: [8237, 295]
Target 1: [1647, 1477]
===================================
Normal Label Distribution: 
Target 0: [8237, 295]
Target 1: [1647, 1477]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 11656, target_attr: gender, bias_attr: age bias_rate: 0.8
['[train] target_0-bias_0: 8237', '[train] target_0-bias_1: 295', '[train] target_1-bias_0: 1647', '[train] target_1-bias_1: 1477']
confusion_matrix - 
 original: tensor([[8237., 1647.],
        [ 295., 1477.]]), 
 normalized: tensor([[0.833, 0.167],
        [0.166, 0.834]]), 
 b|y: tensor([[0.965, 0.035],
        [0.527, 0.473]])
get_utk_face - split: train, aug: 1, given_y: True, ratio: 10
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_age-0.8
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [8237, 295]
Target 1: [1647, 1477]
Binary Target 1
---------------------------
Target 0: [8237, 295]
Target 1: [1647, 1477]
===================================
Normal Label Distribution: 
Target 0: [8237, 295]
Target 1: [1647, 1477]
===================================
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [8237, 295]
Target 1: [1647, 1477]
Binary Target 1
---------------------------
Target 0: [8237, 295]
Target 1: [1647, 1477]
===================================
Normal Label Distribution: 
Target 0: [8237, 295]
Target 1: [1647, 1477]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 11656, target_attr: gender, bias_attr: age bias_rate: 0.8
['[train] target_0-bias_0: 8237', '[train] target_0-bias_1: 295', '[train] target_1-bias_0: 1647', '[train] target_1-bias_1: 1477']
get_utk_face - split: valid, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_age-0.8
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [1030, 195]
Target 1: [841, 202]
Binary Target 1
---------------------------
Target 0: [1030, 195]
Target 1: [841, 202]
===================================
Normal Label Distribution: 
Target 0: [1030, 195]
Target 1: [841, 202]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 2268, target_attr: gender, bias_attr: age bias_rate: 0.8
['[valid] target_0-bias_0: 1030', '[valid] target_0-bias_1: 195', '[valid] target_1-bias_0: 841', '[valid] target_1-bias_1: 202']
get_utk_face - split: test, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_age-0.8
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [1061, 176]
Target 1: [867, 165]
Binary Target 1
---------------------------
Target 0: [1061, 176]
Target 1: [867, 165]
===================================
Normal Label Distribution: 
Target 0: [1061, 176]
Target 1: [867, 165]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 2269, target_attr: gender, bias_attr: age bias_rate: 0.8
['[test] target_0-bias_0: 1061', '[test] target_0-bias_1: 176', '[test] target_1-bias_0: 867', '[test] target_1-bias_1: 165']
decay_epochs: [6, 13]
[1 / 20] Learning rate: 0.001 weight: 0.01
[1 / 20] Loss: 4.870405512307716 CE Loss: 0.6012092480204575 Con Loss: 4.864393434871446
[1 / 20] tensor([[0.972, 0.960],
        [0.378, 0.212]]) {'epoch': 1, 'valid/acc': 68.695, 'valid/acc_unbiased': 63.181, 'valid/diff': 9.78, 'valid/acc_skew': 58.291, 'valid/acc_align': 68.071, 'test/acc': 68.885, 'test/acc_unbiased': 63.06, 'test/diff': 8.885, 'test/acc_skew': 58.617, 'test/acc_align': 67.502}
[1 / 20] best valid accuracy: 63.181 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 68.695, 'best_valid_valid/acc_unbiased': 63.181, 'best_valid_valid/diff': 9.78, 'best_valid_valid/acc_skew': 58.291, 'best_valid_valid/acc_align': 68.071, 'best_valid_test/acc': 68.885, 'best_valid_test/acc_unbiased': 63.06, 'best_valid_test/diff': 8.885, 'best_valid_test/acc_skew': 58.617, 'best_valid_test/acc_align': 67.502}
[1 / 20] best test accuracy: 63.060 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 68.695, 'best_test_valid/acc_unbiased': 63.181, 'best_test_valid/diff': 9.78, 'best_test_valid/acc_skew': 58.291, 'best_test_valid/acc_align': 68.071, 'best_test_test/acc': 68.885, 'best_test_test/acc_unbiased': 63.06, 'best_test_test/diff': 8.885, 'best_test_test/acc_skew': 58.617, 'best_test_test/acc_align': 67.502}
[2 / 20] Learning rate: 0.001 weight: 0.01
[2 / 20] Loss: 4.736634884456616 CE Loss: 0.5258314400174966 Con Loss: 4.731376545839957
[2 / 20] tensor([[0.919, 0.966],
        [0.534, 0.176]]) {'epoch': 2, 'valid/acc': 70.37, 'valid/acc_unbiased': 64.058, 'valid/diff': 17.566, 'valid/acc_skew': 56.851, 'valid/acc_align': 71.265, 'test/acc': 72.146, 'test/acc_unbiased': 64.866, 'test/diff': 20.262, 'test/acc_skew': 57.083, 'test/acc_align': 72.648}
[2 / 20] best valid accuracy: 64.058 at epoch 2 
 best_stats: {'best_valid_epoch': 2, 'best_valid_valid/acc': 70.37, 'best_valid_valid/acc_unbiased': 64.058, 'best_valid_valid/diff': 17.566, 'best_valid_valid/acc_skew': 56.851, 'best_valid_valid/acc_align': 71.265, 'best_valid_test/acc': 72.146, 'best_valid_test/acc_unbiased': 64.866, 'best_valid_test/diff': 20.262, 'best_valid_test/acc_skew': 57.083, 'best_valid_test/acc_align': 72.648}
[2 / 20] best test accuracy: 64.866 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 70.37, 'best_test_valid/acc_unbiased': 64.058, 'best_test_valid/diff': 17.566, 'best_test_valid/acc_skew': 56.851, 'best_test_valid/acc_align': 71.265, 'best_test_test/acc': 72.146, 'best_test_test/acc_unbiased': 64.866, 'best_test_test/diff': 20.262, 'best_test_test/acc_skew': 57.083, 'best_test_test/acc_align': 72.648}
[3 / 20] Learning rate: 0.001 weight: 0.01
[3 / 20] Loss: 4.707152669693234 CE Loss: 0.5058282416572125 Con Loss: 4.702094378500829
[3 / 20] tensor([[0.996, 0.994],
        [0.198, 0.091]]) {'epoch': 3, 'valid/acc': 62.213, 'valid/acc_unbiased': 57.996, 'valid/diff': 3.509, 'valid/acc_skew': 56.436, 'valid/acc_align': 59.556, 'test/acc': 62.539, 'test/acc_unbiased': 56.996, 'test/diff': 5.469, 'test/acc_skew': 54.261, 'test/acc_align': 59.731}
[3 / 20] best valid accuracy: 64.058 at epoch 2 
 best_stats: {'best_valid_epoch': 2, 'best_valid_valid/acc': 70.37, 'best_valid_valid/acc_unbiased': 64.058, 'best_valid_valid/diff': 17.566, 'best_valid_valid/acc_skew': 56.851, 'best_valid_valid/acc_align': 71.265, 'best_valid_test/acc': 72.146, 'best_valid_test/acc_unbiased': 64.866, 'best_valid_test/diff': 20.262, 'best_valid_test/acc_skew': 57.083, 'best_valid_test/acc_align': 72.648}
[3 / 20] best test accuracy: 64.866 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 70.37, 'best_test_valid/acc_unbiased': 64.058, 'best_test_valid/diff': 17.566, 'best_test_valid/acc_skew': 56.851, 'best_test_valid/acc_align': 71.265, 'best_test_test/acc': 72.146, 'best_test_test/acc_unbiased': 64.866, 'best_test_test/diff': 20.262, 'best_test_test/acc_skew': 57.083, 'best_test_test/acc_align': 72.648}
[4 / 20] Learning rate: 0.001 weight: 0.01
[4 / 20] Loss: 4.703165375049096 CE Loss: 0.46849454017886577 Con Loss: 4.698480420187883
[4 / 20] tensor([[0.944, 0.824],
        [0.670, 0.509]]) {'epoch': 4, 'valid/acc': 79.63, 'valid/acc_unbiased': 73.148, 'valid/diff': 16.42, 'valid/acc_skew': 64.938, 'valid/acc_align': 81.358, 'test/acc': 79.859, 'test/acc_unbiased': 73.687, 'test/diff': 14.078, 'test/acc_skew': 66.648, 'test/acc_align': 80.726}
[4 / 20] best valid accuracy: 73.148 at epoch 4 
 best_stats: {'best_valid_epoch': 4, 'best_valid_valid/acc': 79.63, 'best_valid_valid/acc_unbiased': 73.148, 'best_valid_valid/diff': 16.42, 'best_valid_valid/acc_skew': 64.938, 'best_valid_valid/acc_align': 81.358, 'best_valid_test/acc': 79.859, 'best_valid_test/acc_unbiased': 73.687, 'best_valid_test/diff': 14.078, 'best_valid_test/acc_skew': 66.648, 'best_valid_test/acc_align': 80.726}
[4 / 20] best test accuracy: 73.687 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 79.63, 'best_test_valid/acc_unbiased': 73.148, 'best_test_valid/diff': 16.42, 'best_test_valid/acc_skew': 64.938, 'best_test_valid/acc_align': 81.358, 'best_test_test/acc': 79.859, 'best_test_test/acc_unbiased': 73.687, 'best_test_test/diff': 14.078, 'best_test_test/acc_skew': 66.648, 'best_test_test/acc_align': 80.726}
[5 / 20] Learning rate: 0.001 weight: 0.01
[5 / 20] Loss: 4.677357295971663 CE Loss: 0.46257517623345 Con Loss: 4.672731541572733
[5 / 20] tensor([[0.943, 0.835],
        [0.766, 0.509]]) {'epoch': 5, 'valid/acc': 80.688, 'valid/acc_unbiased': 74.468, 'valid/diff': 16.497, 'valid/acc_skew': 66.22, 'valid/acc_align': 82.717, 'test/acc': 83.517, 'test/acc_unbiased': 76.317, 'test/diff': 18.202, 'test/acc_skew': 67.216, 'test/acc_align': 85.418}
[5 / 20] best valid accuracy: 74.468 at epoch 5 
 best_stats: {'best_valid_epoch': 5, 'best_valid_valid/acc': 80.688, 'best_valid_valid/acc_unbiased': 74.468, 'best_valid_valid/diff': 16.497, 'best_valid_valid/acc_skew': 66.22, 'best_valid_valid/acc_align': 82.717, 'best_valid_test/acc': 83.517, 'best_valid_test/acc_unbiased': 76.317, 'best_valid_test/diff': 18.202, 'best_valid_test/acc_skew': 67.216, 'best_valid_test/acc_align': 85.418}
[5 / 20] best test accuracy: 76.317 at epoch 5 
 best_stats: {'best_test_epoch': 5, 'best_test_valid/acc': 80.688, 'best_test_valid/acc_unbiased': 74.468, 'best_test_valid/diff': 16.497, 'best_test_valid/acc_skew': 66.22, 'best_test_valid/acc_align': 82.717, 'best_test_test/acc': 83.517, 'best_test_test/acc_unbiased': 76.317, 'best_test_test/diff': 18.202, 'best_test_test/acc_skew': 67.216, 'best_test_test/acc_align': 85.418}
[6 / 20] Learning rate: 0.001 weight: 0.01
[6 / 20] Loss: 4.667790987267425 CE Loss: 0.44453061935054006 Con Loss: 4.663345676296446
[6 / 20] tensor([[0.949, 0.824],
        [0.685, 0.600]]) {'epoch': 6, 'valid/acc': 80.247, 'valid/acc_unbiased': 74.223, 'valid/diff': 15.123, 'valid/acc_skew': 66.662, 'valid/acc_align': 81.785, 'test/acc': 81.313, 'test/acc_unbiased': 76.452, 'test/diff': 10.518, 'test/acc_skew': 71.193, 'test/acc_align': 81.711}
[6 / 20] best valid accuracy: 74.468 at epoch 5 
 best_stats: {'best_valid_epoch': 5, 'best_valid_valid/acc': 80.688, 'best_valid_valid/acc_unbiased': 74.468, 'best_valid_valid/diff': 16.497, 'best_valid_valid/acc_skew': 66.22, 'best_valid_valid/acc_align': 82.717, 'best_valid_test/acc': 83.517, 'best_valid_test/acc_unbiased': 76.317, 'best_valid_test/diff': 18.202, 'best_valid_test/acc_skew': 67.216, 'best_valid_test/acc_align': 85.418}
[6 / 20] best test accuracy: 76.452 at epoch 6 
 best_stats: {'best_test_epoch': 6, 'best_test_valid/acc': 80.247, 'best_test_valid/acc_unbiased': 74.223, 'best_test_valid/diff': 15.123, 'best_test_valid/acc_skew': 66.662, 'best_test_valid/acc_align': 81.785, 'best_test_test/acc': 81.313, 'best_test_test/acc_unbiased': 76.452, 'best_test_test/diff': 10.518, 'best_test_test/acc_skew': 71.193, 'best_test_test/acc_align': 81.711}
[7 / 20] Learning rate: 0.0001 weight: 0.01
[7 / 20] Loss: 4.588250469817801 CE Loss: 0.41608889210731426 Con Loss: 4.5840895776480295
[7 / 20] tensor([[0.954, 0.812],
        [0.767, 0.594]]) {'epoch': 7, 'valid/acc': 82.804, 'valid/acc_unbiased': 77.171, 'valid/diff': 14.601, 'valid/acc_skew': 69.871, 'valid/acc_align': 84.471, 'test/acc': 84.531, 'test/acc_unbiased': 78.182, 'test/diff': 15.72, 'test/acc_skew': 70.322, 'test/acc_align': 86.041}
[7 / 20] best valid accuracy: 77.171 at epoch 7 
 best_stats: {'best_valid_epoch': 7, 'best_valid_valid/acc': 82.804, 'best_valid_valid/acc_unbiased': 77.171, 'best_valid_valid/diff': 14.601, 'best_valid_valid/acc_skew': 69.871, 'best_valid_valid/acc_align': 84.471, 'best_valid_test/acc': 84.531, 'best_valid_test/acc_unbiased': 78.182, 'best_valid_test/diff': 15.72, 'best_valid_test/acc_skew': 70.322, 'best_valid_test/acc_align': 86.041}
[7 / 20] best test accuracy: 78.182 at epoch 7 
 best_stats: {'best_test_epoch': 7, 'best_test_valid/acc': 82.804, 'best_test_valid/acc_unbiased': 77.171, 'best_test_valid/diff': 14.601, 'best_test_valid/acc_skew': 69.871, 'best_test_valid/acc_align': 84.471, 'best_test_test/acc': 84.531, 'best_test_test/acc_unbiased': 78.182, 'best_test_test/diff': 15.72, 'best_test_test/acc_skew': 70.322, 'best_test_test/acc_align': 86.041}
[8 / 20] Learning rate: 0.0001 weight: 0.01
[8 / 20] Loss: 4.570056073209073 CE Loss: 0.40170932646557006 Con Loss: 4.5660389767334575
[8 / 20] tensor([[0.976, 0.847],
        [0.705, 0.527]]) {'epoch': 8, 'valid/acc': 81.217, 'valid/acc_unbiased': 76.041, 'valid/diff': 12.145, 'valid/acc_skew': 69.968, 'valid/acc_align': 82.113, 'test/acc': 82.988, 'test/acc_unbiased': 76.376, 'test/diff': 15.365, 'test/acc_skew': 68.693, 'test/acc_align': 84.058}
[8 / 20] best valid accuracy: 77.171 at epoch 7 
 best_stats: {'best_valid_epoch': 7, 'best_valid_valid/acc': 82.804, 'best_valid_valid/acc_unbiased': 77.171, 'best_valid_valid/diff': 14.601, 'best_valid_valid/acc_skew': 69.871, 'best_valid_valid/acc_align': 84.471, 'best_valid_test/acc': 84.531, 'best_valid_test/acc_unbiased': 78.182, 'best_valid_test/diff': 15.72, 'best_valid_test/acc_skew': 70.322, 'best_valid_test/acc_align': 86.041}
[8 / 20] best test accuracy: 78.182 at epoch 7 
 best_stats: {'best_test_epoch': 7, 'best_test_valid/acc': 82.804, 'best_test_valid/acc_unbiased': 77.171, 'best_test_valid/diff': 14.601, 'best_test_valid/acc_skew': 69.871, 'best_test_valid/acc_align': 84.471, 'best_test_test/acc': 84.531, 'best_test_test/acc_unbiased': 78.182, 'best_test_test/diff': 15.72, 'best_test_test/acc_skew': 70.322, 'best_test_test/acc_align': 86.041}
[9 / 20] Learning rate: 0.0001 weight: 0.01
[9 / 20] Loss: 4.536956608745442 CE Loss: 0.39944045651670834 Con Loss: 4.532962185434879
[9 / 20] tensor([[0.974, 0.830],
        [0.724, 0.558]]) {'epoch': 9, 'valid/acc': 81.614, 'valid/acc_unbiased': 76.191, 'valid/diff': 13.011, 'valid/acc_skew': 69.685, 'valid/acc_align': 82.696, 'test/acc': 83.693, 'test/acc_unbiased': 77.127, 'test/diff': 15.541, 'test/acc_skew': 69.356, 'test/acc_align': 84.897}
[9 / 20] best valid accuracy: 77.171 at epoch 7 
 best_stats: {'best_valid_epoch': 7, 'best_valid_valid/acc': 82.804, 'best_valid_valid/acc_unbiased': 77.171, 'best_valid_valid/diff': 14.601, 'best_valid_valid/acc_skew': 69.871, 'best_valid_valid/acc_align': 84.471, 'best_valid_test/acc': 84.531, 'best_valid_test/acc_unbiased': 78.182, 'best_valid_test/diff': 15.72, 'best_valid_test/acc_skew': 70.322, 'best_valid_test/acc_align': 86.041}
[9 / 20] best test accuracy: 78.182 at epoch 7 
 best_stats: {'best_test_epoch': 7, 'best_test_valid/acc': 82.804, 'best_test_valid/acc_unbiased': 77.171, 'best_test_valid/diff': 14.601, 'best_test_valid/acc_skew': 69.871, 'best_test_valid/acc_align': 84.471, 'best_test_test/acc': 84.531, 'best_test_test/acc_unbiased': 78.182, 'best_test_test/diff': 15.72, 'best_test_test/acc_skew': 70.322, 'best_test_test/acc_align': 86.041}
[10 / 20] Learning rate: 0.0001 weight: 0.01
[10 / 20] Loss: 4.541783309261032 CE Loss: 0.39167658051932275 Con Loss: 4.537866521716199
[10 / 20] tensor([[0.969, 0.767],
        [0.765, 0.661]]) {'epoch': 10, 'valid/acc': 83.333, 'valid/acc_unbiased': 77.227, 'valid/diff': 15.827, 'valid/acc_skew': 69.313, 'valid/acc_align': 85.14, 'test/acc': 85.28, 'test/acc_unbiased': 79.031, 'test/diff': 15.298, 'test/acc_skew': 71.383, 'test/acc_align': 86.68}
[10 / 20] best valid accuracy: 77.227 at epoch 10 
 best_stats: {'best_valid_epoch': 10, 'best_valid_valid/acc': 83.333, 'best_valid_valid/acc_unbiased': 77.227, 'best_valid_valid/diff': 15.827, 'best_valid_valid/acc_skew': 69.313, 'best_valid_valid/acc_align': 85.14, 'best_valid_test/acc': 85.28, 'best_valid_test/acc_unbiased': 79.031, 'best_valid_test/diff': 15.298, 'best_valid_test/acc_skew': 71.383, 'best_valid_test/acc_align': 86.68}
[10 / 20] best test accuracy: 79.031 at epoch 10 
 best_stats: {'best_test_epoch': 10, 'best_test_valid/acc': 83.333, 'best_test_valid/acc_unbiased': 77.227, 'best_test_valid/diff': 15.827, 'best_test_valid/acc_skew': 69.313, 'best_test_valid/acc_align': 85.14, 'best_test_test/acc': 85.28, 'best_test_test/acc_unbiased': 79.031, 'best_test_test/diff': 15.298, 'best_test_test/acc_skew': 71.383, 'best_test_test/acc_align': 86.68}
[11 / 20] Learning rate: 0.0001 weight: 0.01
[11 / 20] Loss: 4.5366342589719375 CE Loss: 0.37978195604103104 Con Loss: 4.532836437552615
[11 / 20] tensor([[0.976, 0.824],
        [0.712, 0.661]]) {'epoch': 11, 'valid/acc': 82.407, 'valid/acc_unbiased': 77.035, 'valid/diff': 12.879, 'valid/acc_skew': 70.595, 'valid/acc_align': 83.474, 'test/acc': 84.046, 'test/acc_unbiased': 79.314, 'test/diff': 10.181, 'test/acc_skew': 74.223, 'test/acc_align': 84.404}
[11 / 20] best valid accuracy: 77.227 at epoch 10 
 best_stats: {'best_valid_epoch': 10, 'best_valid_valid/acc': 83.333, 'best_valid_valid/acc_unbiased': 77.227, 'best_valid_valid/diff': 15.827, 'best_valid_valid/acc_skew': 69.313, 'best_valid_valid/acc_align': 85.14, 'best_valid_test/acc': 85.28, 'best_valid_test/acc_unbiased': 79.031, 'best_valid_test/diff': 15.298, 'best_valid_test/acc_skew': 71.383, 'best_valid_test/acc_align': 86.68}
[11 / 20] best test accuracy: 79.314 at epoch 11 
 best_stats: {'best_test_epoch': 11, 'best_test_valid/acc': 82.407, 'best_test_valid/acc_unbiased': 77.035, 'best_test_valid/diff': 12.879, 'best_test_valid/acc_skew': 70.595, 'best_test_valid/acc_align': 83.474, 'best_test_test/acc': 84.046, 'best_test_test/acc_unbiased': 79.314, 'best_test_test/diff': 10.181, 'best_test_test/acc_skew': 74.223, 'best_test_test/acc_align': 84.404}
[12 / 20] Learning rate: 0.0001 weight: 0.01
[12 / 20] Loss: 4.49112149927824 CE Loss: 0.37518662807461983 Con Loss: 4.487369620480927
[12 / 20] tensor([[0.979, 0.812],
        [0.716, 0.600]]) {'epoch': 12, 'valid/acc': 81.966, 'valid/acc_unbiased': 76.951, 'valid/diff': 11.597, 'valid/acc_skew': 71.153, 'valid/acc_align': 82.75, 'test/acc': 83.825, 'test/acc_unbiased': 77.701, 'test/diff': 14.151, 'test/acc_skew': 70.625, 'test/acc_align': 84.776}
[12 / 20] best valid accuracy: 77.227 at epoch 10 
 best_stats: {'best_valid_epoch': 10, 'best_valid_valid/acc': 83.333, 'best_valid_valid/acc_unbiased': 77.227, 'best_valid_valid/diff': 15.827, 'best_valid_valid/acc_skew': 69.313, 'best_valid_valid/acc_align': 85.14, 'best_valid_test/acc': 85.28, 'best_valid_test/acc_unbiased': 79.031, 'best_valid_test/diff': 15.298, 'best_valid_test/acc_skew': 71.383, 'best_valid_test/acc_align': 86.68}
[12 / 20] best test accuracy: 79.314 at epoch 11 
 best_stats: {'best_test_epoch': 11, 'best_test_valid/acc': 82.407, 'best_test_valid/acc_unbiased': 77.035, 'best_test_valid/diff': 12.879, 'best_test_valid/acc_skew': 70.595, 'best_test_valid/acc_align': 83.474, 'best_test_test/acc': 84.046, 'best_test_test/acc_unbiased': 79.314, 'best_test_test/diff': 10.181, 'best_test_test/acc_skew': 74.223, 'best_test_test/acc_align': 84.404}
[13 / 20] Learning rate: 0.0001 weight: 0.01
[13 / 20] Loss: 4.508667866661685 CE Loss: 0.3677041614063815 Con Loss: 4.504990839516372
[13 / 20] tensor([[0.972, 0.750],
        [0.762, 0.685]]) {'epoch': 13, 'valid/acc': 83.422, 'valid/acc_unbiased': 77.331, 'valid/diff': 15.629, 'valid/acc_skew': 69.516, 'valid/acc_align': 85.145, 'test/acc': 85.368, 'test/acc_unbiased': 79.224, 'test/diff': 14.964, 'test/acc_skew': 71.742, 'test/acc_align': 86.706}
[13 / 20] best valid accuracy: 77.331 at epoch 13 
 best_stats: {'best_valid_epoch': 13, 'best_valid_valid/acc': 83.422, 'best_valid_valid/acc_unbiased': 77.331, 'best_valid_valid/diff': 15.629, 'best_valid_valid/acc_skew': 69.516, 'best_valid_valid/acc_align': 85.145, 'best_valid_test/acc': 85.368, 'best_valid_test/acc_unbiased': 79.224, 'best_valid_test/diff': 14.964, 'best_valid_test/acc_skew': 71.742, 'best_valid_test/acc_align': 86.706}
[13 / 20] best test accuracy: 79.314 at epoch 11 
 best_stats: {'best_test_epoch': 11, 'best_test_valid/acc': 82.407, 'best_test_valid/acc_unbiased': 77.035, 'best_test_valid/diff': 12.879, 'best_test_valid/acc_skew': 70.595, 'best_test_valid/acc_align': 83.474, 'best_test_test/acc': 84.046, 'best_test_test/acc_unbiased': 79.314, 'best_test_test/diff': 10.181, 'best_test_test/acc_skew': 74.223, 'best_test_test/acc_align': 84.404}
[14 / 20] Learning rate: 1e-05 weight: 0.01
[14 / 20] Loss: 4.504997204981525 CE Loss: 0.35615346962733063 Con Loss: 4.501435688937782
[14 / 20] tensor([[0.967, 0.722],
        [0.785, 0.709]]) {'epoch': 14, 'valid/acc': 83.686, 'valid/acc_unbiased': 77.823, 'valid/diff': 15.218, 'valid/acc_skew': 70.215, 'valid/acc_align': 85.432, 'test/acc': 85.985, 'test/acc_unbiased': 79.579, 'test/diff': 16.09, 'test/acc_skew': 71.534, 'test/acc_align': 87.624}
[14 / 20] best valid accuracy: 77.823 at epoch 14 
 best_stats: {'best_valid_epoch': 14, 'best_valid_valid/acc': 83.686, 'best_valid_valid/acc_unbiased': 77.823, 'best_valid_valid/diff': 15.218, 'best_valid_valid/acc_skew': 70.215, 'best_valid_valid/acc_align': 85.432, 'best_valid_test/acc': 85.985, 'best_valid_test/acc_unbiased': 79.579, 'best_valid_test/diff': 16.09, 'best_valid_test/acc_skew': 71.534, 'best_valid_test/acc_align': 87.624}
[14 / 20] best test accuracy: 79.579 at epoch 14 
 best_stats: {'best_test_epoch': 14, 'best_test_valid/acc': 83.686, 'best_test_valid/acc_unbiased': 77.823, 'best_test_valid/diff': 15.218, 'best_test_valid/acc_skew': 70.215, 'best_test_valid/acc_align': 85.432, 'best_test_test/acc': 85.985, 'best_test_test/acc_unbiased': 79.579, 'best_test_test/diff': 16.09, 'best_test_test/acc_skew': 71.534, 'best_test_test/acc_align': 87.624}
[15 / 20] Learning rate: 1e-05 weight: 0.01
[15 / 20] Loss: 4.483280880940476 CE Loss: 0.36651255481850226 Con Loss: 4.479615767524106
[15 / 20] tensor([[0.975, 0.795],
        [0.735, 0.624]]) {'epoch': 15, 'valid/acc': 82.54, 'valid/acc_unbiased': 77.332, 'valid/diff': 12.447, 'valid/acc_skew': 71.108, 'valid/acc_align': 83.556, 'test/acc': 84.398, 'test/acc_unbiased': 78.248, 'test/diff': 14.526, 'test/acc_skew': 70.985, 'test/acc_align': 85.511}
[15 / 20] best valid accuracy: 77.823 at epoch 14 
 best_stats: {'best_valid_epoch': 14, 'best_valid_valid/acc': 83.686, 'best_valid_valid/acc_unbiased': 77.823, 'best_valid_valid/diff': 15.218, 'best_valid_valid/acc_skew': 70.215, 'best_valid_valid/acc_align': 85.432, 'best_valid_test/acc': 85.985, 'best_valid_test/acc_unbiased': 79.579, 'best_valid_test/diff': 16.09, 'best_valid_test/acc_skew': 71.534, 'best_valid_test/acc_align': 87.624}
[15 / 20] best test accuracy: 79.579 at epoch 14 
 best_stats: {'best_test_epoch': 14, 'best_test_valid/acc': 83.686, 'best_test_valid/acc_unbiased': 77.823, 'best_test_valid/diff': 15.218, 'best_test_valid/acc_skew': 70.215, 'best_test_valid/acc_align': 85.432, 'best_test_test/acc': 85.985, 'best_test_test/acc_unbiased': 79.579, 'best_test_test/diff': 16.09, 'best_test_test/acc_skew': 71.534, 'best_test_test/acc_align': 87.624}
[16 / 20] Learning rate: 1e-05 weight: 0.01
[16 / 20] Loss: 4.485118362620503 CE Loss: 0.35971179954303645 Con Loss: 4.481521240553794
[16 / 20] tensor([[0.970, 0.727],
        [0.772, 0.703]]) {'epoch': 16, 'valid/acc': 83.642, 'valid/acc_unbiased': 77.581, 'valid/diff': 15.669, 'valid/acc_skew': 69.746, 'valid/acc_align': 85.415, 'test/acc': 85.588, 'test/acc_unbiased': 79.294, 'test/diff': 15.558, 'test/acc_skew': 71.515, 'test/acc_align': 87.073}
[16 / 20] best valid accuracy: 77.823 at epoch 14 
 best_stats: {'best_valid_epoch': 14, 'best_valid_valid/acc': 83.686, 'best_valid_valid/acc_unbiased': 77.823, 'best_valid_valid/diff': 15.218, 'best_valid_valid/acc_skew': 70.215, 'best_valid_valid/acc_align': 85.432, 'best_valid_test/acc': 85.985, 'best_valid_test/acc_unbiased': 79.579, 'best_valid_test/diff': 16.09, 'best_valid_test/acc_skew': 71.534, 'best_valid_test/acc_align': 87.624}
[16 / 20] best test accuracy: 79.579 at epoch 14 
 best_stats: {'best_test_epoch': 14, 'best_test_valid/acc': 83.686, 'best_test_valid/acc_unbiased': 77.823, 'best_test_valid/diff': 15.218, 'best_test_valid/acc_skew': 70.215, 'best_test_valid/acc_align': 85.432, 'best_test_test/acc': 85.985, 'best_test_test/acc_unbiased': 79.579, 'best_test_test/diff': 16.09, 'best_test_test/acc_skew': 71.534, 'best_test_test/acc_align': 87.624}
[17 / 20] Learning rate: 1e-05 weight: 0.01
[17 / 20] Loss: 4.456084515513339 CE Loss: 0.3648335237309142 Con Loss: 4.452436185324936
[17 / 20] tensor([[0.974, 0.778],
        [0.742, 0.667]]) {'epoch': 17, 'valid/acc': 83.157, 'valid/acc_unbiased': 77.543, 'valid/diff': 13.949, 'valid/acc_skew': 70.569, 'valid/acc_align': 84.518, 'test/acc': 84.751, 'test/acc_unbiased': 79.008, 'test/diff': 13.509, 'test/acc_skew': 72.254, 'test/acc_align': 85.762}
[17 / 20] best valid accuracy: 77.823 at epoch 14 
 best_stats: {'best_valid_epoch': 14, 'best_valid_valid/acc': 83.686, 'best_valid_valid/acc_unbiased': 77.823, 'best_valid_valid/diff': 15.218, 'best_valid_valid/acc_skew': 70.215, 'best_valid_valid/acc_align': 85.432, 'best_valid_test/acc': 85.985, 'best_valid_test/acc_unbiased': 79.579, 'best_valid_test/diff': 16.09, 'best_valid_test/acc_skew': 71.534, 'best_valid_test/acc_align': 87.624}
[17 / 20] best test accuracy: 79.579 at epoch 14 
 best_stats: {'best_test_epoch': 14, 'best_test_valid/acc': 83.686, 'best_test_valid/acc_unbiased': 77.823, 'best_test_valid/diff': 15.218, 'best_test_valid/acc_skew': 70.215, 'best_test_valid/acc_align': 85.432, 'best_test_test/acc': 85.985, 'best_test_test/acc_unbiased': 79.579, 'best_test_test/diff': 16.09, 'best_test_test/acc_skew': 71.534, 'best_test_test/acc_align': 87.624}
[18 / 20] Learning rate: 1e-05 weight: 0.01
[18 / 20] Loss: 4.459461214449116 CE Loss: 0.3551336421120551 Con Loss: 4.455909877585972
[18 / 20] tensor([[0.968, 0.727],
        [0.780, 0.703]]) {'epoch': 18, 'valid/acc': 83.818, 'valid/acc_unbiased': 77.229, 'valid/diff': 17.53, 'valid/acc_skew': 68.464, 'valid/acc_align': 85.994, 'test/acc': 85.809, 'test/acc_unbiased': 79.449, 'test/diff': 15.868, 'test/acc_skew': 71.515, 'test/acc_align': 87.383}
[18 / 20] best valid accuracy: 77.823 at epoch 14 
 best_stats: {'best_valid_epoch': 14, 'best_valid_valid/acc': 83.686, 'best_valid_valid/acc_unbiased': 77.823, 'best_valid_valid/diff': 15.218, 'best_valid_valid/acc_skew': 70.215, 'best_valid_valid/acc_align': 85.432, 'best_valid_test/acc': 85.985, 'best_valid_test/acc_unbiased': 79.579, 'best_valid_test/diff': 16.09, 'best_valid_test/acc_skew': 71.534, 'best_valid_test/acc_align': 87.624}
[18 / 20] best test accuracy: 79.579 at epoch 14 
 best_stats: {'best_test_epoch': 14, 'best_test_valid/acc': 83.686, 'best_test_valid/acc_unbiased': 77.823, 'best_test_valid/diff': 15.218, 'best_test_valid/acc_skew': 70.215, 'best_test_valid/acc_align': 85.432, 'best_test_test/acc': 85.985, 'best_test_test/acc_unbiased': 79.579, 'best_test_test/diff': 16.09, 'best_test_test/acc_skew': 71.534, 'best_test_test/acc_align': 87.624}
[19 / 20] Learning rate: 1e-05 weight: 0.01
[19 / 20] Loss: 4.473397519053378 CE Loss: 0.3523208969819194 Con Loss: 4.469874296927992
[19 / 20] tensor([[0.970, 0.705],
        [0.777, 0.715]]) {'epoch': 19, 'valid/acc': 83.333, 'valid/acc_unbiased': 76.701, 'valid/diff': 17.517, 'valid/acc_skew': 67.942, 'valid/acc_align': 85.459, 'test/acc': 85.721, 'test/acc_unbiased': 79.173, 'test/diff': 16.377, 'test/acc_skew': 70.985, 'test/acc_align': 87.362}
[19 / 20] best valid accuracy: 77.823 at epoch 14 
 best_stats: {'best_valid_epoch': 14, 'best_valid_valid/acc': 83.686, 'best_valid_valid/acc_unbiased': 77.823, 'best_valid_valid/diff': 15.218, 'best_valid_valid/acc_skew': 70.215, 'best_valid_valid/acc_align': 85.432, 'best_valid_test/acc': 85.985, 'best_valid_test/acc_unbiased': 79.579, 'best_valid_test/diff': 16.09, 'best_valid_test/acc_skew': 71.534, 'best_valid_test/acc_align': 87.624}
[19 / 20] best test accuracy: 79.579 at epoch 14 
 best_stats: {'best_test_epoch': 14, 'best_test_valid/acc': 83.686, 'best_test_valid/acc_unbiased': 77.823, 'best_test_valid/diff': 15.218, 'best_test_valid/acc_skew': 70.215, 'best_test_valid/acc_align': 85.432, 'best_test_test/acc': 85.985, 'best_test_test/acc_unbiased': 79.579, 'best_test_test/diff': 16.09, 'best_test_test/acc_skew': 71.534, 'best_test_test/acc_align': 87.624}
[20 / 20] Learning rate: 1e-05 weight: 0.01
[20 / 20] Loss: 4.4762190051003525 CE Loss: 0.3499726522189751 Con Loss: 4.472719255014078
[20 / 20] tensor([[0.975, 0.744],
        [0.764, 0.703]]) {'epoch': 20, 'valid/acc': 83.466, 'valid/acc_unbiased': 77.156, 'valid/diff': 16.357, 'valid/acc_skew': 68.977, 'valid/acc_align': 85.334, 'test/acc': 85.632, 'test/acc_unbiased': 79.636, 'test/diff': 14.538, 'test/acc_skew': 72.367, 'test/acc_align': 86.905}
[20 / 20] best valid accuracy: 77.823 at epoch 14 
 best_stats: {'best_valid_epoch': 14, 'best_valid_valid/acc': 83.686, 'best_valid_valid/acc_unbiased': 77.823, 'best_valid_valid/diff': 15.218, 'best_valid_valid/acc_skew': 70.215, 'best_valid_valid/acc_align': 85.432, 'best_valid_test/acc': 85.985, 'best_valid_test/acc_unbiased': 79.579, 'best_valid_test/diff': 16.09, 'best_valid_test/acc_skew': 71.534, 'best_valid_test/acc_align': 87.624}
[20 / 20] best test accuracy: 79.636 at epoch 20 
 best_stats: {'best_test_epoch': 20, 'best_test_valid/acc': 83.466, 'best_test_valid/acc_unbiased': 77.156, 'best_test_valid/diff': 16.357, 'best_test_valid/acc_skew': 68.977, 'best_test_valid/acc_align': 85.334, 'best_test_test/acc': 85.632, 'best_test_test/acc_unbiased': 79.636, 'best_test_test/diff': 14.538, 'best_test_test/acc_skew': 72.367, 'best_test_test/acc_align': 86.905}
Total training time: 0:40:49
