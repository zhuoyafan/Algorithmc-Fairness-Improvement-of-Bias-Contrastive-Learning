Log level set to: INFO
Set seed: 2
=======> Using Fixed Random Seed: 2 <========
save_path: exp_results/bc-bb0-utk_face_age-os-0.995-lr0.001-bs128-cbs64-w0.01-ratio10-aug1-seed2
get_utk_face - split: train, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_age-0.995
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [8237, 7]
Target 1: [41, 1477]
Binary Target 1
---------------------------
Target 0: [8237, 7]
Target 1: [41, 1477]
===================================
Normal Label Distribution: 
Target 0: [8237, 7]
Target 1: [41, 1477]
===================================
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [8237, 8237]
Target 1: [8237, 8237]
Binary Target 1
---------------------------
Target 0: [8237, 8237]
Target 1: [8237, 8237]
===================================
Normal Label Distribution: 
Target 0: [8237, 8237]
Target 1: [8237, 8237]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 32948, target_attr: gender, bias_attr: age bias_rate: 0.995
['[train] target_0-bias_0: 8237', '[train] target_0-bias_1: 8237', '[train] target_1-bias_0: 8237', '[train] target_1-bias_1: 8237']
confusion_matrix - 
 original: tensor([[8237., 8237.],
        [8237., 8237.]]), 
 normalized: tensor([[0.500, 0.500],
        [0.500, 0.500]]), 
 b|y: tensor([[0.500, 0.500],
        [0.500, 0.500]])
get_utk_face - split: train, aug: 1, given_y: True, ratio: 10
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_age-0.995
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [8237, 7]
Target 1: [41, 1477]
Binary Target 1
---------------------------
Target 0: [8237, 7]
Target 1: [41, 1477]
===================================
Normal Label Distribution: 
Target 0: [8237, 7]
Target 1: [41, 1477]
===================================
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [8237, 8237]
Target 1: [8237, 8237]
Binary Target 1
---------------------------
Target 0: [8237, 8237]
Target 1: [8237, 8237]
===================================
Normal Label Distribution: 
Target 0: [8237, 8237]
Target 1: [8237, 8237]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 32948, target_attr: gender, bias_attr: age bias_rate: 0.995
['[train] target_0-bias_0: 8237', '[train] target_0-bias_1: 8237', '[train] target_1-bias_0: 8237', '[train] target_1-bias_1: 8237']
get_utk_face - split: valid, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_age-0.995
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [1030, 195]
Target 1: [841, 202]
Binary Target 1
---------------------------
Target 0: [1030, 195]
Target 1: [841, 202]
===================================
Normal Label Distribution: 
Target 0: [1030, 195]
Target 1: [841, 202]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 2268, target_attr: gender, bias_attr: age bias_rate: 0.995
['[valid] target_0-bias_0: 1030', '[valid] target_0-bias_1: 195', '[valid] target_1-bias_0: 841', '[valid] target_1-bias_1: 202']
get_utk_face - split: test, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_age-0.995
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [1061, 176]
Target 1: [867, 165]
Binary Target 1
---------------------------
Target 0: [1061, 176]
Target 1: [867, 165]
===================================
Normal Label Distribution: 
Target 0: [1061, 176]
Target 1: [867, 165]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 2269, target_attr: gender, bias_attr: age bias_rate: 0.995
['[test] target_0-bias_0: 1061', '[test] target_0-bias_1: 176', '[test] target_1-bias_0: 867', '[test] target_1-bias_1: 165']
decay_epochs: [6, 13]
[1 / 20] Learning rate: 0.001 weight: 0.01
[1 / 20] Loss: 4.632870956171741 CE Loss: 0.315532913714868 Con Loss: 4.629715640929568
[1 / 20] tensor([[0.719, 0.091],
        [0.901, 0.988]]) {'epoch': 1, 'valid/acc': 74.383, 'valid/acc_unbiased': 66.095, 'valid/diff': 38.364, 'valid/acc_skew': 79.598, 'valid/acc_align': 52.591, 'test/acc': 75.937, 'test/acc_unbiased': 67.468, 'test/diff': 35.765, 'test/acc_skew': 80.997, 'test/acc_align': 53.939}
[1 / 20] best valid accuracy: 66.095 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 74.383, 'best_valid_valid/acc_unbiased': 66.095, 'best_valid_valid/diff': 38.364, 'best_valid_valid/acc_skew': 79.598, 'best_valid_valid/acc_align': 52.591, 'best_valid_test/acc': 75.937, 'best_valid_test/acc_unbiased': 67.468, 'best_valid_test/diff': 35.765, 'best_valid_test/acc_skew': 80.997, 'best_valid_test/acc_align': 53.939}
[1 / 20] best test accuracy: 67.468 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 74.383, 'best_test_valid/acc_unbiased': 66.095, 'best_test_valid/diff': 38.364, 'best_test_valid/acc_skew': 79.598, 'best_test_valid/acc_align': 52.591, 'best_test_test/acc': 75.937, 'best_test_test/acc_unbiased': 67.468, 'best_test_test/diff': 35.765, 'best_test_test/acc_skew': 80.997, 'best_test_test/acc_align': 53.939}
[2 / 20] Learning rate: 0.001 weight: 0.01
[2 / 20] Loss: 4.4559570631819385 CE Loss: 0.211887977332604 Con Loss: 4.453838195096843
[2 / 20] tensor([[0.971, 0.381],
        [0.501, 0.867]]) {'epoch': 2, 'valid/acc': 72.972, 'valid/acc_unbiased': 66.589, 'valid/diff': 50.737, 'valid/acc_skew': 73.195, 'valid/acc_align': 59.983, 'test/acc': 73.777, 'test/acc_unbiased': 67.968, 'test/diff': 47.81, 'test/acc_skew': 73.568, 'test/acc_align': 62.367}
[2 / 20] best valid accuracy: 66.589 at epoch 2 
 best_stats: {'best_valid_epoch': 2, 'best_valid_valid/acc': 72.972, 'best_valid_valid/acc_unbiased': 66.589, 'best_valid_valid/diff': 50.737, 'best_valid_valid/acc_skew': 73.195, 'best_valid_valid/acc_align': 59.983, 'best_valid_test/acc': 73.777, 'best_valid_test/acc_unbiased': 67.968, 'best_valid_test/diff': 47.81, 'best_valid_test/acc_skew': 73.568, 'best_valid_test/acc_align': 62.367}
[2 / 20] best test accuracy: 67.968 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 72.972, 'best_test_valid/acc_unbiased': 66.589, 'best_test_valid/diff': 50.737, 'best_test_valid/acc_skew': 73.195, 'best_test_valid/acc_align': 59.983, 'best_test_test/acc': 73.777, 'best_test_test/acc_unbiased': 67.968, 'best_test_test/diff': 47.81, 'best_test_test/acc_skew': 73.568, 'best_test_test/acc_align': 62.367}
[3 / 20] Learning rate: 0.001 weight: 0.01
[3 / 20] Loss: 4.396875276920994 CE Loss: 0.1808089996999338 Con Loss: 4.3950671839948505
[3 / 20] tensor([[0.948, 0.205],
        [0.630, 0.945]]) {'epoch': 3, 'valid/acc': 75.882, 'valid/acc_unbiased': 67.362, 'valid/diff': 53.801, 'valid/acc_skew': 78.208, 'valid/acc_align': 56.517, 'test/acc': 76.862, 'test/acc_unbiased': 68.198, 'test/diff': 52.966, 'test/acc_skew': 78.896, 'test/acc_align': 57.5}
[3 / 20] best valid accuracy: 67.362 at epoch 3 
 best_stats: {'best_valid_epoch': 3, 'best_valid_valid/acc': 75.882, 'best_valid_valid/acc_unbiased': 67.362, 'best_valid_valid/diff': 53.801, 'best_valid_valid/acc_skew': 78.208, 'best_valid_valid/acc_align': 56.517, 'best_valid_test/acc': 76.862, 'best_valid_test/acc_unbiased': 68.198, 'best_valid_test/diff': 52.966, 'best_valid_test/acc_skew': 78.896, 'best_valid_test/acc_align': 57.5}
[3 / 20] best test accuracy: 68.198 at epoch 3 
 best_stats: {'best_test_epoch': 3, 'best_test_valid/acc': 75.882, 'best_test_valid/acc_unbiased': 67.362, 'best_test_valid/diff': 53.801, 'best_test_valid/acc_skew': 78.208, 'best_test_valid/acc_align': 56.517, 'best_test_test/acc': 76.862, 'best_test_test/acc_unbiased': 68.198, 'best_test_test/diff': 52.966, 'best_test_test/acc_skew': 78.896, 'best_test_test/acc_align': 57.5}
[4 / 20] Learning rate: 0.001 weight: 0.01
[4 / 20] Loss: 4.389669851291754 CE Loss: 0.17615163555108504 Con Loss: 4.387908346577438
[4 / 20] tensor([[0.876, 0.131],
        [0.826, 0.988]]) {'epoch': 4, 'valid/acc': 77.866, 'valid/acc_unbiased': 67.803, 'valid/diff': 49.005, 'valid/acc_skew': 82.485, 'valid/acc_align': 53.121, 'test/acc': 80.696, 'test/acc_unbiased': 70.5, 'test/diff': 45.347, 'test/acc_skew': 85.071, 'test/acc_align': 55.928}
[4 / 20] best valid accuracy: 67.803 at epoch 4 
 best_stats: {'best_valid_epoch': 4, 'best_valid_valid/acc': 77.866, 'best_valid_valid/acc_unbiased': 67.803, 'best_valid_valid/diff': 49.005, 'best_valid_valid/acc_skew': 82.485, 'best_valid_valid/acc_align': 53.121, 'best_valid_test/acc': 80.696, 'best_valid_test/acc_unbiased': 70.5, 'best_valid_test/diff': 45.347, 'best_valid_test/acc_skew': 85.071, 'best_valid_test/acc_align': 55.928}
[4 / 20] best test accuracy: 70.500 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 77.866, 'best_test_valid/acc_unbiased': 67.803, 'best_test_valid/diff': 49.005, 'best_test_valid/acc_skew': 82.485, 'best_test_valid/acc_align': 53.121, 'best_test_test/acc': 80.696, 'best_test_test/acc_unbiased': 70.5, 'best_test_test/diff': 45.347, 'best_test_test/acc_skew': 85.071, 'best_test_test/acc_align': 55.928}
[5 / 20] Learning rate: 0.001 weight: 0.01
[5 / 20] Loss: 4.359943142356377 CE Loss: 0.16829482199961343 Con Loss: 4.358260198604486
[5 / 20] tensor([[0.963, 0.307],
        [0.591, 0.927]]) {'epoch': 5, 'valid/acc': 74.471, 'valid/acc_unbiased': 66.817, 'valid/diff': 54.358, 'valid/acc_skew': 75.79, 'valid/acc_align': 57.843, 'test/acc': 76.73, 'test/acc_unbiased': 69.697, 'test/diff': 49.658, 'test/acc_skew': 77.689, 'test/acc_align': 61.705}
[5 / 20] best valid accuracy: 67.803 at epoch 4 
 best_stats: {'best_valid_epoch': 4, 'best_valid_valid/acc': 77.866, 'best_valid_valid/acc_unbiased': 67.803, 'best_valid_valid/diff': 49.005, 'best_valid_valid/acc_skew': 82.485, 'best_valid_valid/acc_align': 53.121, 'best_valid_test/acc': 80.696, 'best_valid_test/acc_unbiased': 70.5, 'best_valid_test/diff': 45.347, 'best_valid_test/acc_skew': 85.071, 'best_valid_test/acc_align': 55.928}
[5 / 20] best test accuracy: 70.500 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 77.866, 'best_test_valid/acc_unbiased': 67.803, 'best_test_valid/diff': 49.005, 'best_test_valid/acc_skew': 82.485, 'best_test_valid/acc_align': 53.121, 'best_test_test/acc': 80.696, 'best_test_test/acc_unbiased': 70.5, 'best_test_test/diff': 45.347, 'best_test_test/acc_skew': 85.071, 'best_test_test/acc_align': 55.928}
[6 / 20] Learning rate: 0.001 weight: 0.01
[6 / 20] Loss: 4.358252378231955 CE Loss: 0.16395924855699756 Con Loss: 4.356612784170447
[6 / 20] tensor([[0.849, 0.085],
        [0.847, 1.000]]) {'epoch': 6, 'valid/acc': 79.145, 'valid/acc_unbiased': 68.916, 'valid/diff': 47.499, 'valid/acc_skew': 84.232, 'valid/acc_align': 53.599, 'test/acc': 79.991, 'test/acc_unbiased': 69.526, 'test/diff': 45.869, 'test/acc_skew': 84.79, 'test/acc_align': 54.261}
[6 / 20] best valid accuracy: 68.916 at epoch 6 
 best_stats: {'best_valid_epoch': 6, 'best_valid_valid/acc': 79.145, 'best_valid_valid/acc_unbiased': 68.916, 'best_valid_valid/diff': 47.499, 'best_valid_valid/acc_skew': 84.232, 'best_valid_valid/acc_align': 53.599, 'best_valid_test/acc': 79.991, 'best_valid_test/acc_unbiased': 69.526, 'best_valid_test/diff': 45.869, 'best_valid_test/acc_skew': 84.79, 'best_valid_test/acc_align': 54.261}
[6 / 20] best test accuracy: 70.500 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 77.866, 'best_test_valid/acc_unbiased': 67.803, 'best_test_valid/diff': 49.005, 'best_test_valid/acc_skew': 82.485, 'best_test_valid/acc_align': 53.121, 'best_test_test/acc': 80.696, 'best_test_test/acc_unbiased': 70.5, 'best_test_test/diff': 45.347, 'best_test_test/acc_skew': 85.071, 'best_test_test/acc_align': 55.928}
[7 / 20] Learning rate: 0.0001 weight: 0.01
[7 / 20] Loss: 4.307425269950894 CE Loss: 0.12332509975453901 Con Loss: 4.306192004421577
[7 / 20] tensor([[0.955, 0.188],
        [0.639, 0.964]]) {'epoch': 7, 'valid/acc': 76.72, 'valid/acc_unbiased': 67.753, 'valid/diff': 58.61, 'valid/acc_skew': 79.043, 'valid/acc_align': 56.464, 'test/acc': 77.523, 'test/acc_unbiased': 68.622, 'test/diff': 54.596, 'test/acc_skew': 79.687, 'test/acc_align': 57.557}
[7 / 20] best valid accuracy: 68.916 at epoch 6 
 best_stats: {'best_valid_epoch': 6, 'best_valid_valid/acc': 79.145, 'best_valid_valid/acc_unbiased': 68.916, 'best_valid_valid/diff': 47.499, 'best_valid_valid/acc_skew': 84.232, 'best_valid_valid/acc_align': 53.599, 'best_valid_test/acc': 79.991, 'best_valid_test/acc_unbiased': 69.526, 'best_valid_test/diff': 45.869, 'best_valid_test/acc_skew': 84.79, 'best_valid_test/acc_align': 54.261}
[7 / 20] best test accuracy: 70.500 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 77.866, 'best_test_valid/acc_unbiased': 67.803, 'best_test_valid/diff': 49.005, 'best_test_valid/acc_skew': 82.485, 'best_test_valid/acc_align': 53.121, 'best_test_test/acc': 80.696, 'best_test_test/acc_unbiased': 70.5, 'best_test_test/diff': 45.347, 'best_test_test/acc_skew': 85.071, 'best_test_test/acc_align': 55.928}
[8 / 20] Learning rate: 0.0001 weight: 0.01
[8 / 20] Loss: 4.281474062116224 CE Loss: 0.11253716555037689 Con Loss: 4.280348690820722
[8 / 20] tensor([[0.959, 0.170],
        [0.644, 0.976]]) {'epoch': 8, 'valid/acc': 76.455, 'valid/acc_unbiased': 67.202, 'valid/diff': 58.927, 'valid/acc_skew': 78.957, 'valid/acc_align': 55.447, 'test/acc': 77.876, 'test/acc_unbiased': 68.732, 'test/diff': 56.059, 'test/acc_skew': 80.154, 'test/acc_align': 57.311}
[8 / 20] best valid accuracy: 68.916 at epoch 6 
 best_stats: {'best_valid_epoch': 6, 'best_valid_valid/acc': 79.145, 'best_valid_valid/acc_unbiased': 68.916, 'best_valid_valid/diff': 47.499, 'best_valid_valid/acc_skew': 84.232, 'best_valid_valid/acc_align': 53.599, 'best_valid_test/acc': 79.991, 'best_valid_test/acc_unbiased': 69.526, 'best_valid_test/diff': 45.869, 'best_valid_test/acc_skew': 84.79, 'best_valid_test/acc_align': 54.261}
[8 / 20] best test accuracy: 70.500 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 77.866, 'best_test_valid/acc_unbiased': 67.803, 'best_test_valid/diff': 49.005, 'best_test_valid/acc_skew': 82.485, 'best_test_valid/acc_align': 53.121, 'best_test_test/acc': 80.696, 'best_test_test/acc_unbiased': 70.5, 'best_test_test/diff': 45.347, 'best_test_test/acc_skew': 85.071, 'best_test_test/acc_align': 55.928}
[9 / 20] Learning rate: 0.0001 weight: 0.01
[9 / 20] Loss: 4.269890627120614 CE Loss: 0.10501434099161178 Con Loss: 4.268840493631403
[9 / 20] tensor([[0.959, 0.165],
        [0.607, 0.964]]) {'epoch': 9, 'valid/acc': 75.132, 'valid/acc_unbiased': 66.689, 'valid/diff': 60.643, 'valid/acc_skew': 76.914, 'valid/acc_align': 56.464, 'test/acc': 76.289, 'test/acc_unbiased': 67.341, 'test/diff': 57.535, 'test/acc_skew': 78.261, 'test/acc_align': 56.42}
[9 / 20] best valid accuracy: 68.916 at epoch 6 
 best_stats: {'best_valid_epoch': 6, 'best_valid_valid/acc': 79.145, 'best_valid_valid/acc_unbiased': 68.916, 'best_valid_valid/diff': 47.499, 'best_valid_valid/acc_skew': 84.232, 'best_valid_valid/acc_align': 53.599, 'best_valid_test/acc': 79.991, 'best_valid_test/acc_unbiased': 69.526, 'best_valid_test/diff': 45.869, 'best_valid_test/acc_skew': 84.79, 'best_valid_test/acc_align': 54.261}
[9 / 20] best test accuracy: 70.500 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 77.866, 'best_test_valid/acc_unbiased': 67.803, 'best_test_valid/diff': 49.005, 'best_test_valid/acc_skew': 82.485, 'best_test_valid/acc_align': 53.121, 'best_test_test/acc': 80.696, 'best_test_test/acc_unbiased': 70.5, 'best_test_test/diff': 45.347, 'best_test_test/acc_skew': 85.071, 'best_test_test/acc_align': 55.928}
[10 / 20] Learning rate: 0.0001 weight: 0.01
[10 / 20] Loss: 4.258730686563332 CE Loss: 0.10241024260369264 Con Loss: 4.257706582756084
[10 / 20] tensor([[0.946, 0.142],
        [0.662, 0.976]]) {'epoch': 10, 'valid/acc': 76.808, 'valid/acc_unbiased': 67.042, 'valid/diff': 60.139, 'valid/acc_skew': 79.681, 'valid/acc_align': 54.403, 'test/acc': 77.743, 'test/acc_unbiased': 68.153, 'test/diff': 55.897, 'test/acc_skew': 80.417, 'test/acc_align': 55.89}
[10 / 20] best valid accuracy: 68.916 at epoch 6 
 best_stats: {'best_valid_epoch': 6, 'best_valid_valid/acc': 79.145, 'best_valid_valid/acc_unbiased': 68.916, 'best_valid_valid/diff': 47.499, 'best_valid_valid/acc_skew': 84.232, 'best_valid_valid/acc_align': 53.599, 'best_valid_test/acc': 79.991, 'best_valid_test/acc_unbiased': 69.526, 'best_valid_test/diff': 45.869, 'best_valid_test/acc_skew': 84.79, 'best_valid_test/acc_align': 54.261}
[10 / 20] best test accuracy: 70.500 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 77.866, 'best_test_valid/acc_unbiased': 67.803, 'best_test_valid/diff': 49.005, 'best_test_valid/acc_skew': 82.485, 'best_test_valid/acc_align': 53.121, 'best_test_test/acc': 80.696, 'best_test_test/acc_unbiased': 70.5, 'best_test_test/diff': 45.347, 'best_test_test/acc_skew': 85.071, 'best_test_test/acc_align': 55.928}
[11 / 20] Learning rate: 0.0001 weight: 0.01
[11 / 20] Loss: 4.253173113245546 CE Loss: 0.10049301370457349 Con Loss: 4.252168192046641
[11 / 20] tensor([[0.958, 0.165],
        [0.644, 0.970]]) {'epoch': 11, 'valid/acc': 76.058, 'valid/acc_unbiased': 67.009, 'valid/diff': 60.993, 'valid/acc_skew': 78.341, 'valid/acc_align': 55.677, 'test/acc': 77.699, 'test/acc_unbiased': 68.391, 'test/diff': 55.946, 'test/acc_skew': 80.059, 'test/acc_align': 56.723}
[11 / 20] best valid accuracy: 68.916 at epoch 6 
 best_stats: {'best_valid_epoch': 6, 'best_valid_valid/acc': 79.145, 'best_valid_valid/acc_unbiased': 68.916, 'best_valid_valid/diff': 47.499, 'best_valid_valid/acc_skew': 84.232, 'best_valid_valid/acc_align': 53.599, 'best_valid_test/acc': 79.991, 'best_valid_test/acc_unbiased': 69.526, 'best_valid_test/diff': 45.869, 'best_valid_test/acc_skew': 84.79, 'best_valid_test/acc_align': 54.261}
[11 / 20] best test accuracy: 70.500 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 77.866, 'best_test_valid/acc_unbiased': 67.803, 'best_test_valid/diff': 49.005, 'best_test_valid/acc_skew': 82.485, 'best_test_valid/acc_align': 53.121, 'best_test_test/acc': 80.696, 'best_test_test/acc_unbiased': 70.5, 'best_test_test/diff': 45.347, 'best_test_test/acc_skew': 85.071, 'best_test_test/acc_align': 55.928}
[12 / 20] Learning rate: 0.0001 weight: 0.01
[12 / 20] Loss: 4.251747595275419 CE Loss: 0.09529997617878265 Con Loss: 4.250794609325002
[12 / 20] tensor([[0.958, 0.119],
        [0.653, 0.982]]) {'epoch': 12, 'valid/acc': 76.455, 'valid/acc_unbiased': 66.875, 'valid/diff': 60.562, 'valid/acc_skew': 79.081, 'valid/acc_align': 54.669, 'test/acc': 77.788, 'test/acc_unbiased': 67.789, 'test/diff': 58.363, 'test/acc_skew': 80.521, 'test/acc_align': 55.057}
[12 / 20] best valid accuracy: 68.916 at epoch 6 
 best_stats: {'best_valid_epoch': 6, 'best_valid_valid/acc': 79.145, 'best_valid_valid/acc_unbiased': 68.916, 'best_valid_valid/diff': 47.499, 'best_valid_valid/acc_skew': 84.232, 'best_valid_valid/acc_align': 53.599, 'best_valid_test/acc': 79.991, 'best_valid_test/acc_unbiased': 69.526, 'best_valid_test/diff': 45.869, 'best_valid_test/acc_skew': 84.79, 'best_valid_test/acc_align': 54.261}
[12 / 20] best test accuracy: 70.500 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 77.866, 'best_test_valid/acc_unbiased': 67.803, 'best_test_valid/diff': 49.005, 'best_test_valid/acc_skew': 82.485, 'best_test_valid/acc_align': 53.121, 'best_test_test/acc': 80.696, 'best_test_test/acc_unbiased': 70.5, 'best_test_test/diff': 45.347, 'best_test_test/acc_skew': 85.071, 'best_test_test/acc_align': 55.928}
[13 / 20] Learning rate: 0.0001 weight: 0.01
[13 / 20] Loss: 4.248562265574186 CE Loss: 0.09294665283451703 Con Loss: 4.247632800309826
[13 / 20] tensor([[0.957, 0.114],
        [0.642, 0.982]]) {'epoch': 13, 'valid/acc': 76.543, 'valid/acc_unbiased': 67.121, 'valid/diff': 60.661, 'valid/acc_skew': 79.07, 'valid/acc_align': 55.173, 'test/acc': 77.303, 'test/acc_unbiased': 67.364, 'test/diff': 59.119, 'test/acc_skew': 79.954, 'test/acc_align': 54.773}
[13 / 20] best valid accuracy: 68.916 at epoch 6 
 best_stats: {'best_valid_epoch': 6, 'best_valid_valid/acc': 79.145, 'best_valid_valid/acc_unbiased': 68.916, 'best_valid_valid/diff': 47.499, 'best_valid_valid/acc_skew': 84.232, 'best_valid_valid/acc_align': 53.599, 'best_valid_test/acc': 79.991, 'best_valid_test/acc_unbiased': 69.526, 'best_valid_test/diff': 45.869, 'best_valid_test/acc_skew': 84.79, 'best_valid_test/acc_align': 54.261}
[13 / 20] best test accuracy: 70.500 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 77.866, 'best_test_valid/acc_unbiased': 67.803, 'best_test_valid/diff': 49.005, 'best_test_valid/acc_skew': 82.485, 'best_test_valid/acc_align': 53.121, 'best_test_test/acc': 80.696, 'best_test_test/acc_unbiased': 70.5, 'best_test_test/diff': 45.347, 'best_test_test/acc_skew': 85.071, 'best_test_test/acc_align': 55.928}
[14 / 20] Learning rate: 1e-05 weight: 0.01
[14 / 20] Loss: 4.240428781746747 CE Loss: 0.08966348380848985 Con Loss: 4.2395321542782245
[14 / 20] tensor([[0.958, 0.114],
        [0.633, 0.982]]) {'epoch': 14, 'valid/acc': 76.014, 'valid/acc_unbiased': 66.667, 'valid/diff': 61.967, 'valid/acc_skew': 78.427, 'valid/acc_align': 54.907, 'test/acc': 76.994, 'test/acc_unbiased': 67.156, 'test/diff': 59.628, 'test/acc_skew': 79.54, 'test/acc_align': 54.773}
[14 / 20] best valid accuracy: 68.916 at epoch 6 
 best_stats: {'best_valid_epoch': 6, 'best_valid_valid/acc': 79.145, 'best_valid_valid/acc_unbiased': 68.916, 'best_valid_valid/diff': 47.499, 'best_valid_valid/acc_skew': 84.232, 'best_valid_valid/acc_align': 53.599, 'best_valid_test/acc': 79.991, 'best_valid_test/acc_unbiased': 69.526, 'best_valid_test/diff': 45.869, 'best_valid_test/acc_skew': 84.79, 'best_valid_test/acc_align': 54.261}
[14 / 20] best test accuracy: 70.500 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 77.866, 'best_test_valid/acc_unbiased': 67.803, 'best_test_valid/diff': 49.005, 'best_test_valid/acc_skew': 82.485, 'best_test_valid/acc_align': 53.121, 'best_test_test/acc': 80.696, 'best_test_test/acc_unbiased': 70.5, 'best_test_test/diff': 45.347, 'best_test_test/acc_skew': 85.071, 'best_test_test/acc_align': 55.928}
[15 / 20] Learning rate: 1e-05 weight: 0.01
[15 / 20] Loss: 4.24407434451923 CE Loss: 0.08992317908124552 Con Loss: 4.2431751051848705
[15 / 20] tensor([[0.958, 0.119],
        [0.621, 0.976]]) {'epoch': 15, 'valid/acc': 76.014, 'valid/acc_unbiased': 66.953, 'valid/diff': 61.988, 'valid/acc_skew': 78.237, 'valid/acc_align': 55.668, 'test/acc': 76.509, 'test/acc_unbiased': 66.83, 'test/diff': 59.675, 'test/acc_skew': 78.906, 'test/acc_align': 54.754}
[15 / 20] best valid accuracy: 68.916 at epoch 6 
 best_stats: {'best_valid_epoch': 6, 'best_valid_valid/acc': 79.145, 'best_valid_valid/acc_unbiased': 68.916, 'best_valid_valid/diff': 47.499, 'best_valid_valid/acc_skew': 84.232, 'best_valid_valid/acc_align': 53.599, 'best_valid_test/acc': 79.991, 'best_valid_test/acc_unbiased': 69.526, 'best_valid_test/diff': 45.869, 'best_valid_test/acc_skew': 84.79, 'best_valid_test/acc_align': 54.261}
[15 / 20] best test accuracy: 70.500 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 77.866, 'best_test_valid/acc_unbiased': 67.803, 'best_test_valid/diff': 49.005, 'best_test_valid/acc_skew': 82.485, 'best_test_valid/acc_align': 53.121, 'best_test_test/acc': 80.696, 'best_test_test/acc_unbiased': 70.5, 'best_test_test/diff': 45.347, 'best_test_test/acc_skew': 85.071, 'best_test_test/acc_align': 55.928}
[16 / 20] Learning rate: 1e-05 weight: 0.01
[16 / 20] Loss: 4.236695528464568 CE Loss: 0.08589747485510134 Con Loss: 4.235836556022341
[16 / 20] tensor([[0.953, 0.114],
        [0.641, 0.982]]) {'epoch': 16, 'valid/acc': 76.014, 'valid/acc_unbiased': 66.788, 'valid/diff': 61.734, 'valid/acc_skew': 78.422, 'valid/acc_align': 55.155, 'test/acc': 77.082, 'test/acc_unbiased': 67.241, 'test/diff': 58.988, 'test/acc_skew': 79.708, 'test/acc_align': 54.773}
[16 / 20] best valid accuracy: 68.916 at epoch 6 
 best_stats: {'best_valid_epoch': 6, 'best_valid_valid/acc': 79.145, 'best_valid_valid/acc_unbiased': 68.916, 'best_valid_valid/diff': 47.499, 'best_valid_valid/acc_skew': 84.232, 'best_valid_valid/acc_align': 53.599, 'best_valid_test/acc': 79.991, 'best_valid_test/acc_unbiased': 69.526, 'best_valid_test/diff': 45.869, 'best_valid_test/acc_skew': 84.79, 'best_valid_test/acc_align': 54.261}
[16 / 20] best test accuracy: 70.500 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 77.866, 'best_test_valid/acc_unbiased': 67.803, 'best_test_valid/diff': 49.005, 'best_test_valid/acc_skew': 82.485, 'best_test_valid/acc_align': 53.121, 'best_test_test/acc': 80.696, 'best_test_test/acc_unbiased': 70.5, 'best_test_test/diff': 45.347, 'best_test_test/acc_skew': 85.071, 'best_test_test/acc_align': 55.928}
[17 / 20] Learning rate: 1e-05 weight: 0.01
[17 / 20] Loss: 4.234080962132117 CE Loss: 0.08785659485980842 Con Loss: 4.233202382345085
[17 / 20] tensor([[0.954, 0.119],
        [0.631, 0.982]]) {'epoch': 17, 'valid/acc': 76.058, 'valid/acc_unbiased': 66.802, 'valid/diff': 61.999, 'valid/acc_skew': 78.449, 'valid/acc_align': 55.155, 'test/acc': 76.774, 'test/acc_unbiased': 67.147, 'test/diff': 59.27, 'test/acc_skew': 79.236, 'test/acc_align': 55.057}
[17 / 20] best valid accuracy: 68.916 at epoch 6 
 best_stats: {'best_valid_epoch': 6, 'best_valid_valid/acc': 79.145, 'best_valid_valid/acc_unbiased': 68.916, 'best_valid_valid/diff': 47.499, 'best_valid_valid/acc_skew': 84.232, 'best_valid_valid/acc_align': 53.599, 'best_valid_test/acc': 79.991, 'best_valid_test/acc_unbiased': 69.526, 'best_valid_test/diff': 45.869, 'best_valid_test/acc_skew': 84.79, 'best_valid_test/acc_align': 54.261}
[17 / 20] best test accuracy: 70.500 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 77.866, 'best_test_valid/acc_unbiased': 67.803, 'best_test_valid/diff': 49.005, 'best_test_valid/acc_skew': 82.485, 'best_test_valid/acc_align': 53.121, 'best_test_test/acc': 80.696, 'best_test_test/acc_unbiased': 70.5, 'best_test_test/diff': 45.347, 'best_test_test/acc_skew': 85.071, 'best_test_test/acc_align': 55.928}
[18 / 20] Learning rate: 1e-05 weight: 0.01
[18 / 20] Loss: 4.235202592076557 CE Loss: 0.08640019942508734 Con Loss: 4.234338577907757
[18 / 20] tensor([[0.959, 0.114],
        [0.608, 0.970]]) {'epoch': 18, 'valid/acc': 75.132, 'valid/acc_unbiased': 66.367, 'valid/diff': 62.17, 'valid/acc_skew': 77.048, 'valid/acc_align': 55.685, 'test/acc': 76.025, 'test/acc_unbiased': 66.266, 'test/diff': 60.384, 'test/acc_skew': 78.366, 'test/acc_align': 54.167}
[18 / 20] best valid accuracy: 68.916 at epoch 6 
 best_stats: {'best_valid_epoch': 6, 'best_valid_valid/acc': 79.145, 'best_valid_valid/acc_unbiased': 68.916, 'best_valid_valid/diff': 47.499, 'best_valid_valid/acc_skew': 84.232, 'best_valid_valid/acc_align': 53.599, 'best_valid_test/acc': 79.991, 'best_valid_test/acc_unbiased': 69.526, 'best_valid_test/diff': 45.869, 'best_valid_test/acc_skew': 84.79, 'best_valid_test/acc_align': 54.261}
[18 / 20] best test accuracy: 70.500 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 77.866, 'best_test_valid/acc_unbiased': 67.803, 'best_test_valid/diff': 49.005, 'best_test_valid/acc_skew': 82.485, 'best_test_valid/acc_align': 53.121, 'best_test_test/acc': 80.696, 'best_test_test/acc_unbiased': 70.5, 'best_test_test/diff': 45.347, 'best_test_test/acc_skew': 85.071, 'best_test_test/acc_align': 55.928}
[19 / 20] Learning rate: 1e-05 weight: 0.01
[19 / 20] Loss: 4.233152643893549 CE Loss: 0.08662021473634442 Con Loss: 4.232286430206984
[19 / 20] tensor([[0.962, 0.119],
        [0.599, 0.970]]) {'epoch': 19, 'valid/acc': 75.0, 'valid/acc_unbiased': 66.156, 'valid/diff': 62.581, 'valid/acc_skew': 76.875, 'valid/acc_align': 55.438, 'test/acc': 75.848, 'test/acc_unbiased': 66.248, 'test/diff': 60.703, 'test/acc_skew': 78.046, 'test/acc_align': 54.451}
[19 / 20] best valid accuracy: 68.916 at epoch 6 
 best_stats: {'best_valid_epoch': 6, 'best_valid_valid/acc': 79.145, 'best_valid_valid/acc_unbiased': 68.916, 'best_valid_valid/diff': 47.499, 'best_valid_valid/acc_skew': 84.232, 'best_valid_valid/acc_align': 53.599, 'best_valid_test/acc': 79.991, 'best_valid_test/acc_unbiased': 69.526, 'best_valid_test/diff': 45.869, 'best_valid_test/acc_skew': 84.79, 'best_valid_test/acc_align': 54.261}
[19 / 20] best test accuracy: 70.500 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 77.866, 'best_test_valid/acc_unbiased': 67.803, 'best_test_valid/diff': 49.005, 'best_test_valid/acc_skew': 82.485, 'best_test_valid/acc_align': 53.121, 'best_test_test/acc': 80.696, 'best_test_test/acc_unbiased': 70.5, 'best_test_test/diff': 45.347, 'best_test_test/acc_skew': 85.071, 'best_test_test/acc_align': 55.928}
[20 / 20] Learning rate: 1e-05 weight: 0.01
[20 / 20] Loss: 4.238127873073261 CE Loss: 0.08684462748664204 Con Loss: 4.237259417667368
[20 / 20] tensor([[0.959, 0.119],
        [0.604, 0.976]]) {'epoch': 20, 'valid/acc': 75.088, 'valid/acc_unbiased': 66.317, 'valid/diff': 63.453, 'valid/acc_skew': 76.967, 'valid/acc_align': 55.668, 'test/acc': 75.937, 'test/acc_unbiased': 66.45, 'test/diff': 60.529, 'test/acc_skew': 78.146, 'test/acc_align': 54.754}
[20 / 20] best valid accuracy: 68.916 at epoch 6 
 best_stats: {'best_valid_epoch': 6, 'best_valid_valid/acc': 79.145, 'best_valid_valid/acc_unbiased': 68.916, 'best_valid_valid/diff': 47.499, 'best_valid_valid/acc_skew': 84.232, 'best_valid_valid/acc_align': 53.599, 'best_valid_test/acc': 79.991, 'best_valid_test/acc_unbiased': 69.526, 'best_valid_test/diff': 45.869, 'best_valid_test/acc_skew': 84.79, 'best_valid_test/acc_align': 54.261}
[20 / 20] best test accuracy: 70.500 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 77.866, 'best_test_valid/acc_unbiased': 67.803, 'best_test_valid/diff': 49.005, 'best_test_valid/acc_skew': 82.485, 'best_test_valid/acc_align': 53.121, 'best_test_test/acc': 80.696, 'best_test_test/acc_unbiased': 70.5, 'best_test_test/diff': 45.347, 'best_test_test/acc_skew': 85.071, 'best_test_test/acc_align': 55.928}
Total training time: 1:49:53
