Log level set to: INFO
Set seed: 1
=======> Using Fixed Random Seed: 1 <========
save_path: exp_results/bc-bb0-celeba_black-crop_trival-lr0.001-bs128-cbs64-w0.01-ratio30-aug1-seed1
get_celeba - split:train, aug: False, given_y: True, ratio: 0
use existing black indices from data/celeba/pickles/black
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [60539, 38593]
Target 1: [8008, 16048]
Binary Target 1
---------------------------
Target 0: [60539, 38593]
Target 1: [8008, 16048]
===================================
Normal Label Distribution: 
Target 0: [60539, 38593]
Target 1: [8008, 16048]
===================================
Use BiasedCelebASplit 
 target_attr: black split: train 
 tensor([[60539.,  8008.],
        [38593., 16048.]])
get_celeba - split:train, aug: 1, given_y: True, ratio: 30
use existing black indices from data/celeba/pickles/black
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [60508, 38612]
Target 1: [8008, 16060]
Binary Target 1
---------------------------
Target 0: [60508, 38612]
Target 1: [8008, 16060]
===================================
Normal Label Distribution: 
Target 0: [60508, 38612]
Target 1: [8008, 16060]
===================================
Use BiasedCelebASplit 
 target_attr: black split: train 
 tensor([[60508.,  8008.],
        [38612., 16060.]])
get_celeba - split:train_valid, aug: False, given_y: True, ratio: 0
use existing black indices from data/celeba/pickles/black
Use BiasedCelebASplit 
 target_attr: black split: train_valid 
 tensor([[15227.,  1970.],
        [ 9563.,  4038.]])
get_celeba - split:valid, aug: False, given_y: True, ratio: 0
Use BiasedCelebASplit 
 target_attr: black split: valid 
 tensor([[9752., 1657.],
        [5971., 2487.]])
decay_epochs: [3, 6]
[1 / 10] Learning rate: 0.001 weight: 0.01
[1 / 10] Loss: 4.81611404882823 CE Loss: 0.31039327538744654 Con Loss: 4.8130101142976445
[1 / 10] tensor([[0.961, 0.922],
        [0.648, 0.666]]) {'epoch': 1, 'valid/acc': 88.782, 'valid/acc_unbiased': 78.832, 'valid/diff': 2.475, 'valid/acc_skew': 77.595, 'valid/acc_align': 80.07, 'test/acc': 88.629, 'test/acc_unbiased': 79.92, 'test/diff': 2.921, 'test/acc_skew': 78.459, 'test/acc_align': 81.38}
[1 / 10] best valid accuracy: 78.832 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 88.782, 'best_valid_valid/acc_unbiased': 78.832, 'best_valid_valid/diff': 2.475, 'best_valid_valid/acc_skew': 77.595, 'best_valid_valid/acc_align': 80.07, 'best_valid_test/acc': 88.629, 'best_valid_test/acc_unbiased': 79.92, 'best_valid_test/diff': 2.921, 'best_valid_test/acc_skew': 78.459, 'best_valid_test/acc_align': 81.38}
[1 / 10] best test accuracy: 79.920 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 88.782, 'best_test_valid/acc_unbiased': 78.832, 'best_test_valid/diff': 2.475, 'best_test_valid/acc_skew': 77.595, 'best_test_valid/acc_align': 80.07, 'best_test_test/acc': 88.629, 'best_test_test/acc_unbiased': 79.92, 'best_test_test/diff': 2.921, 'best_test_test/acc_skew': 78.459, 'best_test_test/acc_align': 81.38}
[2 / 10] Learning rate: 0.001 weight: 0.01
[2 / 10] Loss: 4.80384411037512 CE Loss: 0.28135390942927463 Con Loss: 4.801030568125558
[2 / 10] tensor([[0.937, 0.937],
        [0.719, 0.617]]) {'epoch': 2, 'valid/acc': 87.584, 'valid/acc_unbiased': 78.695, 'valid/diff': 5.954, 'valid/acc_skew': 81.672, 'valid/acc_align': 75.718, 'test/acc': 87.869, 'test/acc_unbiased': 80.257, 'test/diff': 5.11, 'test/acc_skew': 82.812, 'test/acc_align': 77.702}
[2 / 10] best valid accuracy: 78.832 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 88.782, 'best_valid_valid/acc_unbiased': 78.832, 'best_valid_valid/diff': 2.475, 'best_valid_valid/acc_skew': 77.595, 'best_valid_valid/acc_align': 80.07, 'best_valid_test/acc': 88.629, 'best_valid_test/acc_unbiased': 79.92, 'best_valid_test/diff': 2.921, 'best_valid_test/acc_skew': 78.459, 'best_valid_test/acc_align': 81.38}
[2 / 10] best test accuracy: 80.257 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 87.584, 'best_test_valid/acc_unbiased': 78.695, 'best_test_valid/diff': 5.954, 'best_test_valid/acc_skew': 81.672, 'best_test_valid/acc_align': 75.718, 'best_test_test/acc': 87.869, 'best_test_test/acc_unbiased': 80.257, 'best_test_test/diff': 5.11, 'best_test_test/acc_skew': 82.812, 'best_test_test/acc_align': 77.702}
[3 / 10] Learning rate: 0.001 weight: 0.01
[3 / 10] Loss: 4.798693777411914 CE Loss: 0.27584702626824376 Con Loss: 4.795935312246283
[3 / 10] tensor([[0.995, 0.990],
        [0.208, 0.207]]) {'epoch': 3, 'valid/acc': 83.742, 'valid/acc_unbiased': 59.296, 'valid/diff': 0.149, 'valid/acc_skew': 59.222, 'valid/acc_align': 59.371, 'test/acc': 82.942, 'test/acc_unbiased': 60.019, 'test/diff': 0.301, 'test/acc_skew': 59.925, 'test/acc_align': 60.113}
[3 / 10] best valid accuracy: 78.832 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 88.782, 'best_valid_valid/acc_unbiased': 78.832, 'best_valid_valid/diff': 2.475, 'best_valid_valid/acc_skew': 77.595, 'best_valid_valid/acc_align': 80.07, 'best_valid_test/acc': 88.629, 'best_valid_test/acc_unbiased': 79.92, 'best_valid_test/diff': 2.921, 'best_valid_test/acc_skew': 78.459, 'best_valid_test/acc_align': 81.38}
[3 / 10] best test accuracy: 80.257 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 87.584, 'best_test_valid/acc_unbiased': 78.695, 'best_test_valid/diff': 5.954, 'best_test_valid/acc_skew': 81.672, 'best_test_valid/acc_align': 75.718, 'best_test_test/acc': 87.869, 'best_test_test/acc_unbiased': 80.257, 'best_test_test/diff': 5.11, 'best_test_test/acc_skew': 82.812, 'best_test_test/acc_align': 77.702}
[4 / 10] Learning rate: 0.0001 weight: 0.01
[4 / 10] Loss: 4.776796335306486 CE Loss: 0.24241689777697092 Con Loss: 4.774372165859661
[4 / 10] tensor([[0.949, 0.919],
        [0.758, 0.742]]) {'epoch': 4, 'valid/acc': 90.025, 'valid/acc_unbiased': 83.612, 'valid/diff': 2.255, 'valid/acc_skew': 83.486, 'valid/acc_align': 83.738, 'test/acc': 89.797, 'test/acc_unbiased': 84.192, 'test/diff': 2.298, 'test/acc_skew': 83.83, 'test/acc_align': 84.555}
[4 / 10] best valid accuracy: 83.612 at epoch 4 
 best_stats: {'best_valid_epoch': 4, 'best_valid_valid/acc': 90.025, 'best_valid_valid/acc_unbiased': 83.612, 'best_valid_valid/diff': 2.255, 'best_valid_valid/acc_skew': 83.486, 'best_valid_valid/acc_align': 83.738, 'best_valid_test/acc': 89.797, 'best_valid_test/acc_unbiased': 84.192, 'best_valid_test/diff': 2.298, 'best_valid_test/acc_skew': 83.83, 'best_valid_test/acc_align': 84.555}
[4 / 10] best test accuracy: 84.192 at epoch 4 
 best_stats: {'best_test_epoch': 4, 'best_test_valid/acc': 90.025, 'best_test_valid/acc_unbiased': 83.612, 'best_test_valid/diff': 2.255, 'best_test_valid/acc_skew': 83.486, 'best_test_valid/acc_align': 83.738, 'best_test_test/acc': 89.797, 'best_test_test/acc_unbiased': 84.192, 'best_test_test/diff': 2.298, 'best_test_test/acc_skew': 83.83, 'best_test_test/acc_align': 84.555}
[5 / 10] Learning rate: 0.0001 weight: 0.01
[5 / 10] Loss: 4.7697745854503815 CE Loss: 0.23343644819164963 Con Loss: 4.767440220928542
[5 / 10] tensor([[0.957, 0.932],
        [0.752, 0.737]]) {'epoch': 5, 'valid/acc': 90.438, 'valid/acc_unbiased': 83.341, 'valid/diff': 2.032, 'valid/acc_skew': 83.133, 'valid/acc_align': 83.548, 'test/acc': 90.462, 'test/acc_unbiased': 84.427, 'test/diff': 2.025, 'test/acc_skew': 84.182, 'test/acc_align': 84.673}
[5 / 10] best valid accuracy: 83.612 at epoch 4 
 best_stats: {'best_valid_epoch': 4, 'best_valid_valid/acc': 90.025, 'best_valid_valid/acc_unbiased': 83.612, 'best_valid_valid/diff': 2.255, 'best_valid_valid/acc_skew': 83.486, 'best_valid_valid/acc_align': 83.738, 'best_valid_test/acc': 89.797, 'best_valid_test/acc_unbiased': 84.192, 'best_valid_test/diff': 2.298, 'best_valid_test/acc_skew': 83.83, 'best_valid_test/acc_align': 84.555}
[5 / 10] best test accuracy: 84.427 at epoch 5 
 best_stats: {'best_test_epoch': 5, 'best_test_valid/acc': 90.438, 'best_test_valid/acc_unbiased': 83.341, 'best_test_valid/diff': 2.032, 'best_test_valid/acc_skew': 83.133, 'best_test_valid/acc_align': 83.548, 'best_test_test/acc': 90.462, 'best_test_test/acc_unbiased': 84.427, 'best_test_test/diff': 2.025, 'best_test_test/acc_skew': 84.182, 'best_test_test/acc_align': 84.673}
[6 / 10] Learning rate: 0.0001 weight: 0.01
[6 / 10] Loss: 4.762691268294756 CE Loss: 0.23090362985455323 Con Loss: 4.760382233647033
[6 / 10] tensor([[0.961, 0.947],
        [0.707, 0.695]]) {'epoch': 6, 'valid/acc': 90.444, 'valid/acc_unbiased': 82.579, 'valid/diff': 2.477, 'valid/acc_skew': 83.199, 'valid/acc_align': 81.959, 'test/acc': 90.215, 'test/acc_unbiased': 82.736, 'test/diff': 1.292, 'test/acc_skew': 82.664, 'test/acc_align': 82.807}
[6 / 10] best valid accuracy: 83.612 at epoch 4 
 best_stats: {'best_valid_epoch': 4, 'best_valid_valid/acc': 90.025, 'best_valid_valid/acc_unbiased': 83.612, 'best_valid_valid/diff': 2.255, 'best_valid_valid/acc_skew': 83.486, 'best_valid_valid/acc_align': 83.738, 'best_valid_test/acc': 89.797, 'best_valid_test/acc_unbiased': 84.192, 'best_valid_test/diff': 2.298, 'best_valid_test/acc_skew': 83.83, 'best_valid_test/acc_align': 84.555}
[6 / 10] best test accuracy: 84.427 at epoch 5 
 best_stats: {'best_test_epoch': 5, 'best_test_valid/acc': 90.438, 'best_test_valid/acc_unbiased': 83.341, 'best_test_valid/diff': 2.032, 'best_test_valid/acc_skew': 83.133, 'best_test_valid/acc_align': 83.548, 'best_test_test/acc': 90.462, 'best_test_test/acc_unbiased': 84.427, 'best_test_test/diff': 2.025, 'best_test_test/acc_skew': 84.182, 'best_test_test/acc_align': 84.673}
[7 / 10] Learning rate: 1e-05 weight: 0.01
[7 / 10] Loss: 4.756772344110925 CE Loss: 0.2262662579489787 Con Loss: 4.754509682786478
[7 / 10] tensor([[0.961, 0.933],
        [0.734, 0.743]]) {'epoch': 7, 'valid/acc': 90.723, 'valid/acc_unbiased': 83.633, 'valid/diff': 1.352, 'valid/acc_skew': 83.169, 'valid/acc_align': 84.097, 'test/acc': 90.628, 'test/acc_unbiased': 84.274, 'test/diff': 1.801, 'test/acc_skew': 83.373, 'test/acc_align': 85.175}
[7 / 10] best valid accuracy: 83.633 at epoch 7 
 best_stats: {'best_valid_epoch': 7, 'best_valid_valid/acc': 90.723, 'best_valid_valid/acc_unbiased': 83.633, 'best_valid_valid/diff': 1.352, 'best_valid_valid/acc_skew': 83.169, 'best_valid_valid/acc_align': 84.097, 'best_valid_test/acc': 90.628, 'best_valid_test/acc_unbiased': 84.274, 'best_valid_test/diff': 1.801, 'best_valid_test/acc_skew': 83.373, 'best_valid_test/acc_align': 85.175}
[7 / 10] best test accuracy: 84.427 at epoch 5 
 best_stats: {'best_test_epoch': 5, 'best_test_valid/acc': 90.438, 'best_test_valid/acc_unbiased': 83.341, 'best_test_valid/diff': 2.032, 'best_test_valid/acc_skew': 83.133, 'best_test_valid/acc_align': 83.548, 'best_test_test/acc': 90.462, 'best_test_test/acc_unbiased': 84.427, 'best_test_test/diff': 2.025, 'best_test_test/acc_skew': 84.182, 'best_test_test/acc_align': 84.673}
[8 / 10] Learning rate: 1e-05 weight: 0.01
[8 / 10] Loss: 4.755936206321916 CE Loss: 0.2238825628884207 Con Loss: 4.753697376837725
[8 / 10] tensor([[0.956, 0.934],
        [0.755, 0.745]]) {'epoch': 8, 'valid/acc': 90.73, 'valid/acc_unbiased': 84.325, 'valid/diff': 2.443, 'valid/acc_skew': 84.501, 'valid/acc_align': 84.149, 'test/acc': 90.628, 'test/acc_unbiased': 84.757, 'test/diff': 1.615, 'test/acc_skew': 84.425, 'test/acc_align': 85.09}
[8 / 10] best valid accuracy: 84.325 at epoch 8 
 best_stats: {'best_valid_epoch': 8, 'best_valid_valid/acc': 90.73, 'best_valid_valid/acc_unbiased': 84.325, 'best_valid_valid/diff': 2.443, 'best_valid_valid/acc_skew': 84.501, 'best_valid_valid/acc_align': 84.149, 'best_valid_test/acc': 90.628, 'best_valid_test/acc_unbiased': 84.757, 'best_valid_test/diff': 1.615, 'best_valid_test/acc_skew': 84.425, 'best_valid_test/acc_align': 85.09}
[8 / 10] best test accuracy: 84.757 at epoch 8 
 best_stats: {'best_test_epoch': 8, 'best_test_valid/acc': 90.73, 'best_test_valid/acc_unbiased': 84.325, 'best_test_valid/diff': 2.443, 'best_test_valid/acc_skew': 84.501, 'best_test_valid/acc_align': 84.149, 'best_test_test/acc': 90.628, 'best_test_test/acc_unbiased': 84.757, 'best_test_test/diff': 1.615, 'best_test_test/acc_skew': 84.425, 'best_test_test/acc_align': 85.09}
[9 / 10] Learning rate: 1e-05 weight: 0.01
[9 / 10] Loss: 4.754888962812151 CE Loss: 0.22346755090977427 Con Loss: 4.752654288207362
[9 / 10] tensor([[0.961, 0.940],
        [0.731, 0.737]]) {'epoch': 9, 'valid/acc': 90.853, 'valid/acc_unbiased': 83.749, 'valid/diff': 1.508, 'valid/acc_skew': 83.483, 'valid/acc_align': 84.016, 'test/acc': 90.738, 'test/acc_unbiased': 84.229, 'test/diff': 1.327, 'test/acc_skew': 83.566, 'test/acc_align': 84.893}
[9 / 10] best valid accuracy: 84.325 at epoch 8 
 best_stats: {'best_valid_epoch': 8, 'best_valid_valid/acc': 90.73, 'best_valid_valid/acc_unbiased': 84.325, 'best_valid_valid/diff': 2.443, 'best_valid_valid/acc_skew': 84.501, 'best_valid_valid/acc_align': 84.149, 'best_valid_test/acc': 90.628, 'best_valid_test/acc_unbiased': 84.757, 'best_valid_test/diff': 1.615, 'best_valid_test/acc_skew': 84.425, 'best_valid_test/acc_align': 85.09}
[9 / 10] best test accuracy: 84.757 at epoch 8 
 best_stats: {'best_test_epoch': 8, 'best_test_valid/acc': 90.73, 'best_test_valid/acc_unbiased': 84.325, 'best_test_valid/diff': 2.443, 'best_test_valid/acc_skew': 84.501, 'best_test_valid/acc_align': 84.149, 'best_test_test/acc': 90.628, 'best_test_test/acc_unbiased': 84.757, 'best_test_test/diff': 1.615, 'best_test_test/acc_skew': 84.425, 'best_test_test/acc_align': 85.09}
[10 / 10] Learning rate: 1e-05 weight: 0.01
[10 / 10] Loss: 4.753453034419737 CE Loss: 0.22245729372476755 Con Loss: 4.751228460921991
[10 / 10] tensor([[0.969, 0.952],
        [0.684, 0.688]]) {'epoch': 10, 'valid/acc': 90.775, 'valid/acc_unbiased': 81.965, 'valid/diff': 0.905, 'valid/acc_skew': 81.556, 'valid/acc_align': 82.375, 'test/acc': 90.512, 'test/acc_unbiased': 82.328, 'test/diff': 1.086, 'test/acc_skew': 81.785, 'test/acc_align': 82.871}
[10 / 10] best valid accuracy: 84.325 at epoch 8 
 best_stats: {'best_valid_epoch': 8, 'best_valid_valid/acc': 90.73, 'best_valid_valid/acc_unbiased': 84.325, 'best_valid_valid/diff': 2.443, 'best_valid_valid/acc_skew': 84.501, 'best_valid_valid/acc_align': 84.149, 'best_valid_test/acc': 90.628, 'best_valid_test/acc_unbiased': 84.757, 'best_valid_test/diff': 1.615, 'best_valid_test/acc_skew': 84.425, 'best_valid_test/acc_align': 85.09}
[10 / 10] best test accuracy: 84.757 at epoch 8 
 best_stats: {'best_test_epoch': 8, 'best_test_valid/acc': 90.73, 'best_test_valid/acc_unbiased': 84.325, 'best_test_valid/diff': 2.443, 'best_test_valid/acc_skew': 84.501, 'best_test_valid/acc_align': 84.149, 'best_test_test/acc': 90.628, 'best_test_test/acc_unbiased': 84.757, 'best_test_test/diff': 1.615, 'best_test_test/acc_skew': 84.425, 'best_test_test/acc_align': 85.09}
Total training time: 1:50:55
