Log level set to: INFO
Set seed: 3
=======> Using Fixed Random Seed: 3 <========
save_path: exp_results/bc-bb0-utk_face_race-crop_auto2-0.9-lr0.001-bs128-cbs64-w0.01-ratio10-aug1-seed3
get_utk_face - split: train, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_race-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [4407, 552]
Target 1: [440, 5529]
Binary Target 1
---------------------------
Target 0: [4407, 552]
Target 1: [440, 5529]
===================================
Normal Label Distribution: 
Target 0: [4407, 552]
Target 1: [440, 5529]
===================================
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [4407, 552]
Target 1: [440, 5529]
Binary Target 1
---------------------------
Target 0: [4407, 552]
Target 1: [440, 5529]
===================================
Normal Label Distribution: 
Target 0: [4407, 552]
Target 1: [440, 5529]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 10928, target_attr: gender, bias_attr: race bias_rate: 0.9
['[train] target_0-bias_0: 4407', '[train] target_0-bias_1: 552', '[train] target_1-bias_0: 440', '[train] target_1-bias_1: 5529']
confusion_matrix - 
 original: tensor([[4407.,  440.],
        [ 552., 5529.]]), 
 normalized: tensor([[0.909, 0.091],
        [0.091, 0.909]]), 
 b|y: tensor([[0.889, 0.111],
        [0.074, 0.926]])
get_utk_face - split: train, aug: 1, given_y: True, ratio: 10
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_race-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [4407, 552]
Target 1: [440, 5529]
Binary Target 1
---------------------------
Target 0: [4407, 552]
Target 1: [440, 5529]
===================================
Normal Label Distribution: 
Target 0: [4407, 552]
Target 1: [440, 5529]
===================================
Distribution After Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [4407, 552]
Target 1: [440, 5529]
Binary Target 1
---------------------------
Target 0: [4407, 552]
Target 1: [440, 5529]
===================================
Normal Label Distribution: 
Target 0: [4407, 552]
Target 1: [440, 5529]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 10928, target_attr: gender, bias_attr: race bias_rate: 0.9
['[train] target_0-bias_0: 4407', '[train] target_0-bias_1: 552', '[train] target_1-bias_0: 440', '[train] target_1-bias_1: 5529']
get_utk_face - split: valid, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_race-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [583, 684]
Target 1: [457, 646]
Binary Target 1
---------------------------
Target 0: [583, 684]
Target 1: [457, 646]
===================================
Normal Label Distribution: 
Target 0: [583, 684]
Target 1: [457, 646]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 2370, target_attr: gender, bias_attr: race bias_rate: 0.9
['[valid] target_0-bias_0: 583', '[valid] target_0-bias_1: 684', '[valid] target_1-bias_0: 457', '[valid] target_1-bias_1: 646']
get_utk_face - split: test, aug: False, given_y: True, ratio: 0
use existing biased_utk_face from data/utk_face/pickles/biased_utk_face-target_gender-bias_race-0.9
Distribution Before Sampling: 
===================================
Binary Labels Distribution: 
Binary Target 0
---------------------------
Target 0: [558, 677]
Target 1: [462, 673]
Binary Target 1
---------------------------
Target 0: [558, 677]
Target 1: [462, 673]
===================================
Normal Label Distribution: 
Target 0: [558, 677]
Target 1: [462, 673]
===================================
Use BiasedUTKFace - target_attr: gender
BiasedUTKFace -- total: 2370, target_attr: gender, bias_attr: race bias_rate: 0.9
['[test] target_0-bias_0: 558', '[test] target_0-bias_1: 677', '[test] target_1-bias_0: 462', '[test] target_1-bias_1: 673']
decay_epochs: [6, 13]
[1 / 20] Learning rate: 0.001 weight: 0.01
[1 / 20] Loss: 4.904691582368373 CE Loss: 0.5750592963150968 Con Loss: 4.898940987677735
[1 / 20] tensor([[0.747, 0.693],
        [0.779, 0.860]]) {'epoch': 1, 'valid/acc': 77.722, 'valid/acc_unbiased': 78.053, 'valid/diff': 0.952, 'valid/acc_skew': 77.577, 'valid/acc_align': 78.53, 'test/acc': 77.004, 'test/acc_unbiased': 76.991, 'test/diff': 6.783, 'test/acc_skew': 73.599, 'test/acc_align': 80.382}
[1 / 20] best valid accuracy: 78.053 at epoch 1 
 best_stats: {'best_valid_epoch': 1, 'best_valid_valid/acc': 77.722, 'best_valid_valid/acc_unbiased': 78.053, 'best_valid_valid/diff': 0.952, 'best_valid_valid/acc_skew': 77.577, 'best_valid_valid/acc_align': 78.53, 'best_valid_test/acc': 77.004, 'best_valid_test/acc_unbiased': 76.991, 'best_valid_test/diff': 6.783, 'best_valid_test/acc_skew': 73.599, 'best_valid_test/acc_align': 80.382}
[1 / 20] best test accuracy: 76.991 at epoch 1 
 best_stats: {'best_test_epoch': 1, 'best_test_valid/acc': 77.722, 'best_test_valid/acc_unbiased': 78.053, 'best_test_valid/diff': 0.952, 'best_test_valid/acc_skew': 77.577, 'best_test_valid/acc_align': 78.53, 'best_test_test/acc': 77.004, 'best_test_test/acc_unbiased': 76.991, 'best_test_test/diff': 6.783, 'best_test_test/acc_skew': 73.599, 'best_test_test/acc_align': 80.382}
[2 / 20] Learning rate: 0.001 weight: 0.01
[2 / 20] Loss: 4.791515191861511 CE Loss: 0.46296233780911167 Con Loss: 4.786885567325799
[2 / 20] tensor([[0.771, 0.752],
        [0.825, 0.871]]) {'epoch': 2, 'valid/acc': 80.211, 'valid/acc_unbiased': 80.599, 'valid/diff': 1.842, 'valid/acc_skew': 80.243, 'valid/acc_align': 80.956, 'test/acc': 80.422, 'test/acc_unbiased': 80.446, 'test/diff': 3.241, 'test/acc_skew': 78.826, 'test/acc_align': 82.067}
[2 / 20] best valid accuracy: 80.599 at epoch 2 
 best_stats: {'best_valid_epoch': 2, 'best_valid_valid/acc': 80.211, 'best_valid_valid/acc_unbiased': 80.599, 'best_valid_valid/diff': 1.842, 'best_valid_valid/acc_skew': 80.243, 'best_valid_valid/acc_align': 80.956, 'best_valid_test/acc': 80.422, 'best_valid_test/acc_unbiased': 80.446, 'best_valid_test/diff': 3.241, 'best_valid_test/acc_skew': 78.826, 'best_valid_test/acc_align': 82.067}
[2 / 20] best test accuracy: 80.446 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 80.211, 'best_test_valid/acc_unbiased': 80.599, 'best_test_valid/diff': 1.842, 'best_test_valid/acc_skew': 80.243, 'best_test_valid/acc_align': 80.956, 'best_test_test/acc': 80.422, 'best_test_test/acc_unbiased': 80.446, 'best_test_test/diff': 3.241, 'best_test_test/acc_skew': 78.826, 'best_test_test/acc_align': 82.067}
[3 / 20] Learning rate: 0.001 weight: 0.01
[3 / 20] Loss: 4.770594926390082 CE Loss: 0.44783751908717007 Con Loss: 4.766116543011645
[3 / 20] tensor([[0.582, 0.538],
        [0.959, 0.958]]) {'epoch': 3, 'valid/acc': 75.274, 'valid/acc_unbiased': 76.721, 'valid/diff': 2.191, 'valid/acc_skew': 75.625, 'valid/acc_align': 77.817, 'test/acc': 74.979, 'test/acc_unbiased': 75.934, 'test/diff': 2.263, 'test/acc_skew': 74.827, 'test/acc_align': 77.042}
[3 / 20] best valid accuracy: 80.599 at epoch 2 
 best_stats: {'best_valid_epoch': 2, 'best_valid_valid/acc': 80.211, 'best_valid_valid/acc_unbiased': 80.599, 'best_valid_valid/diff': 1.842, 'best_valid_valid/acc_skew': 80.243, 'best_valid_valid/acc_align': 80.956, 'best_valid_test/acc': 80.422, 'best_valid_test/acc_unbiased': 80.446, 'best_valid_test/diff': 3.241, 'best_valid_test/acc_skew': 78.826, 'best_valid_test/acc_align': 82.067}
[3 / 20] best test accuracy: 80.446 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 80.211, 'best_test_valid/acc_unbiased': 80.599, 'best_test_valid/diff': 1.842, 'best_test_valid/acc_skew': 80.243, 'best_test_valid/acc_align': 80.956, 'best_test_test/acc': 80.422, 'best_test_test/acc_unbiased': 80.446, 'best_test_test/diff': 3.241, 'best_test_test/acc_skew': 78.826, 'best_test_test/acc_align': 82.067}
[4 / 20] Learning rate: 0.001 weight: 0.01
[4 / 20] Loss: 4.765150099512773 CE Loss: 0.44037838666365753 Con Loss: 4.760746324743045
[4 / 20] tensor([[0.968, 0.917],
        [0.539, 0.642]]) {'epoch': 4, 'valid/acc': 78.565, 'valid/acc_unbiased': 77.3, 'valid/diff': 3.047, 'valid/acc_skew': 75.777, 'valid/acc_align': 78.824, 'test/acc': 77.722, 'test/acc_unbiased': 76.647, 'test/diff': 7.67, 'test/acc_skew': 72.812, 'test/acc_align': 80.482}
[4 / 20] best valid accuracy: 80.599 at epoch 2 
 best_stats: {'best_valid_epoch': 2, 'best_valid_valid/acc': 80.211, 'best_valid_valid/acc_unbiased': 80.599, 'best_valid_valid/diff': 1.842, 'best_valid_valid/acc_skew': 80.243, 'best_valid_valid/acc_align': 80.956, 'best_valid_test/acc': 80.422, 'best_valid_test/acc_unbiased': 80.446, 'best_valid_test/diff': 3.241, 'best_valid_test/acc_skew': 78.826, 'best_valid_test/acc_align': 82.067}
[4 / 20] best test accuracy: 80.446 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 80.211, 'best_test_valid/acc_unbiased': 80.599, 'best_test_valid/diff': 1.842, 'best_test_valid/acc_skew': 80.243, 'best_test_valid/acc_align': 80.956, 'best_test_test/acc': 80.422, 'best_test_test/acc_unbiased': 80.446, 'best_test_test/diff': 3.241, 'best_test_test/acc_skew': 78.826, 'best_test_test/acc_align': 82.067}
[5 / 20] Learning rate: 0.001 weight: 0.01
[5 / 20] Loss: 4.746665419806149 CE Loss: 0.4059913944273009 Con Loss: 4.74260548162949
[5 / 20] tensor([[0.665, 0.631],
        [0.952, 0.955]]) {'epoch': 5, 'valid/acc': 80.042, 'valid/acc_unbiased': 81.034, 'valid/diff': 0.297, 'valid/acc_skew': 81.182, 'valid/acc_align': 80.885, 'test/acc': 79.367, 'test/acc_unbiased': 80.085, 'test/diff': 1.86, 'test/acc_skew': 79.155, 'test/acc_align': 81.015}
[5 / 20] best valid accuracy: 81.034 at epoch 5 
 best_stats: {'best_valid_epoch': 5, 'best_valid_valid/acc': 80.042, 'best_valid_valid/acc_unbiased': 81.034, 'best_valid_valid/diff': 0.297, 'best_valid_valid/acc_skew': 81.182, 'best_valid_valid/acc_align': 80.885, 'best_valid_test/acc': 79.367, 'best_valid_test/acc_unbiased': 80.085, 'best_valid_test/diff': 1.86, 'best_valid_test/acc_skew': 79.155, 'best_valid_test/acc_align': 81.015}
[5 / 20] best test accuracy: 80.446 at epoch 2 
 best_stats: {'best_test_epoch': 2, 'best_test_valid/acc': 80.211, 'best_test_valid/acc_unbiased': 80.599, 'best_test_valid/diff': 1.842, 'best_test_valid/acc_skew': 80.243, 'best_test_valid/acc_align': 80.956, 'best_test_test/acc': 80.422, 'best_test_test/acc_unbiased': 80.446, 'best_test_test/diff': 3.241, 'best_test_test/acc_skew': 78.826, 'best_test_test/acc_align': 82.067}
[6 / 20] Learning rate: 0.001 weight: 0.01
[6 / 20] Loss: 4.743193234042926 CE Loss: 0.40558880872991737 Con Loss: 4.739137343047828
[6 / 20] tensor([[0.855, 0.818],
        [0.788, 0.811]]) {'epoch': 6, 'valid/acc': 82.827, 'valid/acc_unbiased': 82.708, 'valid/diff': 0.826, 'valid/acc_skew': 82.295, 'valid/acc_align': 83.121, 'test/acc': 81.899, 'test/acc_unbiased': 81.808, 'test/diff': 2.997, 'test/acc_skew': 80.31, 'test/acc_align': 83.307}
[6 / 20] best valid accuracy: 82.708 at epoch 6 
 best_stats: {'best_valid_epoch': 6, 'best_valid_valid/acc': 82.827, 'best_valid_valid/acc_unbiased': 82.708, 'best_valid_valid/diff': 0.826, 'best_valid_valid/acc_skew': 82.295, 'best_valid_valid/acc_align': 83.121, 'best_valid_test/acc': 81.899, 'best_valid_test/acc_unbiased': 81.808, 'best_valid_test/diff': 2.997, 'best_valid_test/acc_skew': 80.31, 'best_valid_test/acc_align': 83.307}
[6 / 20] best test accuracy: 81.808 at epoch 6 
 best_stats: {'best_test_epoch': 6, 'best_test_valid/acc': 82.827, 'best_test_valid/acc_unbiased': 82.708, 'best_test_valid/diff': 0.826, 'best_test_valid/acc_skew': 82.295, 'best_test_valid/acc_align': 83.121, 'best_test_test/acc': 81.899, 'best_test_test/acc_unbiased': 81.808, 'best_test_test/diff': 2.997, 'best_test_test/acc_skew': 80.31, 'best_test_test/acc_align': 83.307}
[7 / 20] Learning rate: 0.0001 weight: 0.01
[7 / 20] Loss: 4.707044595855222 CE Loss: 0.38420204475718395 Con Loss: 4.703202569467257
[7 / 20] tensor([[0.842, 0.799],
        [0.851, 0.895]]) {'epoch': 7, 'valid/acc': 85.612, 'valid/acc_unbiased': 85.791, 'valid/diff': 1.526, 'valid/acc_skew': 85.028, 'valid/acc_align': 86.554, 'test/acc': 84.641, 'test/acc_unbiased': 84.664, 'test/diff': 4.352, 'test/acc_skew': 82.488, 'test/acc_align': 86.84}
[7 / 20] best valid accuracy: 85.791 at epoch 7 
 best_stats: {'best_valid_epoch': 7, 'best_valid_valid/acc': 85.612, 'best_valid_valid/acc_unbiased': 85.791, 'best_valid_valid/diff': 1.526, 'best_valid_valid/acc_skew': 85.028, 'best_valid_valid/acc_align': 86.554, 'best_valid_test/acc': 84.641, 'best_valid_test/acc_unbiased': 84.664, 'best_valid_test/diff': 4.352, 'best_valid_test/acc_skew': 82.488, 'best_valid_test/acc_align': 86.84}
[7 / 20] best test accuracy: 84.664 at epoch 7 
 best_stats: {'best_test_epoch': 7, 'best_test_valid/acc': 85.612, 'best_test_valid/acc_unbiased': 85.791, 'best_test_valid/diff': 1.526, 'best_test_valid/acc_skew': 85.028, 'best_test_valid/acc_align': 86.554, 'best_test_test/acc': 84.641, 'best_test_test/acc_unbiased': 84.664, 'best_test_test/diff': 4.352, 'best_test_test/acc_skew': 82.488, 'best_test_test/acc_align': 86.84}
[8 / 20] Learning rate: 0.0001 weight: 0.01
[8 / 20] Loss: 4.686287281628409 CE Loss: 0.3511416171602414 Con Loss: 4.682775860475062
[8 / 20] tensor([[0.875, 0.812],
        [0.838, 0.871]]) {'epoch': 8, 'valid/acc': 86.245, 'valid/acc_unbiased': 86.279, 'valid/diff': 2.278, 'valid/acc_skew': 85.14, 'valid/acc_align': 87.418, 'test/acc': 84.852, 'test/acc_unbiased': 84.884, 'test/diff': 4.761, 'test/acc_skew': 82.503, 'test/acc_align': 87.264}
[8 / 20] best valid accuracy: 86.279 at epoch 8 
 best_stats: {'best_valid_epoch': 8, 'best_valid_valid/acc': 86.245, 'best_valid_valid/acc_unbiased': 86.279, 'best_valid_valid/diff': 2.278, 'best_valid_valid/acc_skew': 85.14, 'best_valid_valid/acc_align': 87.418, 'best_valid_test/acc': 84.852, 'best_valid_test/acc_unbiased': 84.884, 'best_valid_test/diff': 4.761, 'best_valid_test/acc_skew': 82.503, 'best_valid_test/acc_align': 87.264}
[8 / 20] best test accuracy: 84.884 at epoch 8 
 best_stats: {'best_test_epoch': 8, 'best_test_valid/acc': 86.245, 'best_test_valid/acc_unbiased': 86.279, 'best_test_valid/diff': 2.278, 'best_test_valid/acc_skew': 85.14, 'best_test_valid/acc_align': 87.418, 'best_test_test/acc': 84.852, 'best_test_test/acc_unbiased': 84.884, 'best_test_test/diff': 4.761, 'best_test_test/acc_skew': 82.503, 'best_test_test/acc_align': 87.264}
[9 / 20] Learning rate: 0.0001 weight: 0.01
[9 / 20] Loss: 4.6766904143952 CE Loss: 0.3343104565649745 Con Loss: 4.673347304191981
[9 / 20] tensor([[0.819, 0.767],
        [0.887, 0.920]]) {'epoch': 9, 'valid/acc': 85.148, 'valid/acc_unbiased': 85.67, 'valid/diff': 2.506, 'valid/acc_skew': 84.439, 'valid/acc_align': 86.901, 'test/acc': 84.599, 'test/acc_unbiased': 84.821, 'test/diff': 4.235, 'test/acc_skew': 82.703, 'test/acc_align': 86.938}
[9 / 20] best valid accuracy: 86.279 at epoch 8 
 best_stats: {'best_valid_epoch': 8, 'best_valid_valid/acc': 86.245, 'best_valid_valid/acc_unbiased': 86.279, 'best_valid_valid/diff': 2.278, 'best_valid_valid/acc_skew': 85.14, 'best_valid_valid/acc_align': 87.418, 'best_valid_test/acc': 84.852, 'best_valid_test/acc_unbiased': 84.884, 'best_valid_test/diff': 4.761, 'best_valid_test/acc_skew': 82.503, 'best_valid_test/acc_align': 87.264}
[9 / 20] best test accuracy: 84.884 at epoch 8 
 best_stats: {'best_test_epoch': 8, 'best_test_valid/acc': 86.245, 'best_test_valid/acc_unbiased': 86.279, 'best_test_valid/diff': 2.278, 'best_test_valid/acc_skew': 85.14, 'best_test_valid/acc_align': 87.418, 'best_test_test/acc': 84.852, 'best_test_test/acc_unbiased': 84.884, 'best_test_test/diff': 4.761, 'best_test_test/acc_skew': 82.503, 'best_test_test/acc_align': 87.264}
[10 / 20] Learning rate: 0.0001 weight: 0.01
[10 / 20] Loss: 4.655713016431817 CE Loss: 0.33290090991148663 Con Loss: 4.652384040994491
[10 / 20] tensor([[0.853, 0.793],
        [0.866, 0.915]]) {'epoch': 10, 'valid/acc': 86.329, 'valid/acc_unbiased': 86.646, 'valid/diff': 1.999, 'valid/acc_skew': 85.647, 'valid/acc_align': 87.646, 'test/acc': 85.612, 'test/acc_unbiased': 85.684, 'test/diff': 5.467, 'test/acc_skew': 82.95, 'test/acc_align': 88.418}
[10 / 20] best valid accuracy: 86.646 at epoch 10 
 best_stats: {'best_valid_epoch': 10, 'best_valid_valid/acc': 86.329, 'best_valid_valid/acc_unbiased': 86.646, 'best_valid_valid/diff': 1.999, 'best_valid_valid/acc_skew': 85.647, 'best_valid_valid/acc_align': 87.646, 'best_valid_test/acc': 85.612, 'best_valid_test/acc_unbiased': 85.684, 'best_valid_test/diff': 5.467, 'best_valid_test/acc_skew': 82.95, 'best_valid_test/acc_align': 88.418}
[10 / 20] best test accuracy: 85.684 at epoch 10 
 best_stats: {'best_test_epoch': 10, 'best_test_valid/acc': 86.329, 'best_test_valid/acc_unbiased': 86.646, 'best_test_valid/diff': 1.999, 'best_test_valid/acc_skew': 85.647, 'best_test_valid/acc_align': 87.646, 'best_test_test/acc': 85.612, 'best_test_test/acc_unbiased': 85.684, 'best_test_test/diff': 5.467, 'best_test_test/acc_skew': 82.95, 'best_test_test/acc_align': 88.418}
[11 / 20] Learning rate: 0.0001 weight: 0.01
[11 / 20] Loss: 4.6578367074097935 CE Loss: 0.3257477759311349 Con Loss: 4.654579228223854
[11 / 20] tensor([[0.837, 0.755],
        [0.885, 0.936]]) {'epoch': 11, 'valid/acc': 85.148, 'valid/acc_unbiased': 85.588, 'valid/diff': 2.663, 'valid/acc_skew': 84.257, 'valid/acc_align': 86.92, 'test/acc': 85.105, 'test/acc_unbiased': 85.328, 'test/diff': 6.647, 'test/acc_skew': 82.004, 'test/acc_align': 88.651}
[11 / 20] best valid accuracy: 86.646 at epoch 10 
 best_stats: {'best_valid_epoch': 10, 'best_valid_valid/acc': 86.329, 'best_valid_valid/acc_unbiased': 86.646, 'best_valid_valid/diff': 1.999, 'best_valid_valid/acc_skew': 85.647, 'best_valid_valid/acc_align': 87.646, 'best_valid_test/acc': 85.612, 'best_valid_test/acc_unbiased': 85.684, 'best_valid_test/diff': 5.467, 'best_valid_test/acc_skew': 82.95, 'best_valid_test/acc_align': 88.418}
[11 / 20] best test accuracy: 85.684 at epoch 10 
 best_stats: {'best_test_epoch': 10, 'best_test_valid/acc': 86.329, 'best_test_valid/acc_unbiased': 86.646, 'best_test_valid/diff': 1.999, 'best_test_valid/acc_skew': 85.647, 'best_test_valid/acc_align': 87.646, 'best_test_test/acc': 85.612, 'best_test_test/acc_unbiased': 85.684, 'best_test_test/diff': 5.467, 'best_test_test/acc_skew': 82.95, 'best_test_test/acc_align': 88.418}
[12 / 20] Learning rate: 0.0001 weight: 0.01
[12 / 20] Loss: 4.653697297304301 CE Loss: 0.32807076902375565 Con Loss: 4.650416581557401
[12 / 20] tensor([[0.871, 0.820],
        [0.870, 0.902]]) {'epoch': 12, 'valid/acc': 86.878, 'valid/acc_unbiased': 87.091, 'valid/diff': 3.251, 'valid/acc_skew': 85.466, 'valid/acc_align': 88.717, 'test/acc': 86.498, 'test/acc_unbiased': 86.571, 'test/diff': 4.149, 'test/acc_skew': 84.496, 'test/acc_align': 88.645}
[12 / 20] best valid accuracy: 87.091 at epoch 12 
 best_stats: {'best_valid_epoch': 12, 'best_valid_valid/acc': 86.878, 'best_valid_valid/acc_unbiased': 87.091, 'best_valid_valid/diff': 3.251, 'best_valid_valid/acc_skew': 85.466, 'best_valid_valid/acc_align': 88.717, 'best_valid_test/acc': 86.498, 'best_valid_test/acc_unbiased': 86.571, 'best_valid_test/diff': 4.149, 'best_valid_test/acc_skew': 84.496, 'best_valid_test/acc_align': 88.645}
[12 / 20] best test accuracy: 86.571 at epoch 12 
 best_stats: {'best_test_epoch': 12, 'best_test_valid/acc': 86.878, 'best_test_valid/acc_unbiased': 87.091, 'best_test_valid/diff': 3.251, 'best_test_valid/acc_skew': 85.466, 'best_test_valid/acc_align': 88.717, 'best_test_test/acc': 86.498, 'best_test_test/acc_unbiased': 86.571, 'best_test_test/diff': 4.149, 'best_test_test/acc_skew': 84.496, 'best_test_test/acc_align': 88.645}
[13 / 20] Learning rate: 0.0001 weight: 0.01
[13 / 20] Loss: 4.647160567790488 CE Loss: 0.31700375606339987 Con Loss: 4.643990527833014
[13 / 20] tensor([[0.855, 0.805],
        [0.861, 0.906]]) {'epoch': 13, 'valid/acc': 86.245, 'valid/acc_unbiased': 86.517, 'valid/diff': 4.077, 'valid/acc_skew': 84.479, 'valid/acc_align': 88.556, 'test/acc': 85.654, 'test/acc_unbiased': 85.693, 'test/diff': 4.737, 'test/acc_skew': 83.325, 'test/acc_align': 88.061}
[13 / 20] best valid accuracy: 87.091 at epoch 12 
 best_stats: {'best_valid_epoch': 12, 'best_valid_valid/acc': 86.878, 'best_valid_valid/acc_unbiased': 87.091, 'best_valid_valid/diff': 3.251, 'best_valid_valid/acc_skew': 85.466, 'best_valid_valid/acc_align': 88.717, 'best_valid_test/acc': 86.498, 'best_valid_test/acc_unbiased': 86.571, 'best_valid_test/diff': 4.149, 'best_valid_test/acc_skew': 84.496, 'best_valid_test/acc_align': 88.645}
[13 / 20] best test accuracy: 86.571 at epoch 12 
 best_stats: {'best_test_epoch': 12, 'best_test_valid/acc': 86.878, 'best_test_valid/acc_unbiased': 87.091, 'best_test_valid/diff': 3.251, 'best_test_valid/acc_skew': 85.466, 'best_test_valid/acc_align': 88.717, 'best_test_test/acc': 86.498, 'best_test_test/acc_unbiased': 86.571, 'best_test_test/diff': 4.149, 'best_test_test/acc_skew': 84.496, 'best_test_test/acc_align': 88.645}
[14 / 20] Learning rate: 1e-05 weight: 0.01
[14 / 20] Loss: 4.627851064522829 CE Loss: 0.31029356865547764 Con Loss: 4.624748099426225
[14 / 20] tensor([[0.858, 0.811],
        [0.861, 0.902]]) {'epoch': 14, 'valid/acc': 86.414, 'valid/acc_unbiased': 86.661, 'valid/diff': 3.342, 'valid/acc_skew': 84.99, 'valid/acc_align': 88.332, 'test/acc': 85.781, 'test/acc_unbiased': 85.819, 'test/diff': 4.398, 'test/acc_skew': 83.62, 'test/acc_align': 88.018}
[14 / 20] best valid accuracy: 87.091 at epoch 12 
 best_stats: {'best_valid_epoch': 12, 'best_valid_valid/acc': 86.878, 'best_valid_valid/acc_unbiased': 87.091, 'best_valid_valid/diff': 3.251, 'best_valid_valid/acc_skew': 85.466, 'best_valid_valid/acc_align': 88.717, 'best_valid_test/acc': 86.498, 'best_valid_test/acc_unbiased': 86.571, 'best_valid_test/diff': 4.149, 'best_valid_test/acc_skew': 84.496, 'best_valid_test/acc_align': 88.645}
[14 / 20] best test accuracy: 86.571 at epoch 12 
 best_stats: {'best_test_epoch': 12, 'best_test_valid/acc': 86.878, 'best_test_valid/acc_unbiased': 87.091, 'best_test_valid/diff': 3.251, 'best_test_valid/acc_skew': 85.466, 'best_test_valid/acc_align': 88.717, 'best_test_test/acc': 86.498, 'best_test_test/acc_unbiased': 86.571, 'best_test_test/diff': 4.149, 'best_test_test/acc_skew': 84.496, 'best_test_test/acc_align': 88.645}
[15 / 20] Learning rate: 1e-05 weight: 0.01
[15 / 20] Loss: 4.631074371309965 CE Loss: 0.3139405107428354 Con Loss: 4.627934983673766
[15 / 20] tensor([[0.855, 0.805],
        [0.866, 0.911]]) {'epoch': 15, 'valid/acc': 86.118, 'valid/acc_unbiased': 86.399, 'valid/diff': 3.112, 'valid/acc_skew': 84.844, 'valid/acc_align': 87.955, 'test/acc': 85.865, 'test/acc_unbiased': 85.913, 'test/diff': 4.743, 'test/acc_skew': 83.541, 'test/acc_align': 88.284}
[15 / 20] best valid accuracy: 87.091 at epoch 12 
 best_stats: {'best_valid_epoch': 12, 'best_valid_valid/acc': 86.878, 'best_valid_valid/acc_unbiased': 87.091, 'best_valid_valid/diff': 3.251, 'best_valid_valid/acc_skew': 85.466, 'best_valid_valid/acc_align': 88.717, 'best_valid_test/acc': 86.498, 'best_valid_test/acc_unbiased': 86.571, 'best_valid_test/diff': 4.149, 'best_valid_test/acc_skew': 84.496, 'best_valid_test/acc_align': 88.645}
[15 / 20] best test accuracy: 86.571 at epoch 12 
 best_stats: {'best_test_epoch': 12, 'best_test_valid/acc': 86.878, 'best_test_valid/acc_unbiased': 87.091, 'best_test_valid/diff': 3.251, 'best_test_valid/acc_skew': 85.466, 'best_test_valid/acc_align': 88.717, 'best_test_test/acc': 86.498, 'best_test_test/acc_unbiased': 86.571, 'best_test_test/diff': 4.149, 'best_test_test/acc_skew': 84.496, 'best_test_test/acc_align': 88.645}
[16 / 20] Learning rate: 1e-05 weight: 0.01
[16 / 20] Loss: 4.62907502731502 CE Loss: 0.31576526230460206 Con Loss: 4.625917355801316
[16 / 20] tensor([[0.851, 0.796],
        [0.883, 0.917]]) {'epoch': 16, 'valid/acc': 86.16, 'valid/acc_unbiased': 86.523, 'valid/diff': 3.141, 'valid/acc_skew': 84.952, 'valid/acc_align': 88.093, 'test/acc': 86.034, 'test/acc_unbiased': 86.183, 'test/diff': 4.438, 'test/acc_skew': 83.964, 'test/acc_align': 88.402}
[16 / 20] best valid accuracy: 87.091 at epoch 12 
 best_stats: {'best_valid_epoch': 12, 'best_valid_valid/acc': 86.878, 'best_valid_valid/acc_unbiased': 87.091, 'best_valid_valid/diff': 3.251, 'best_valid_valid/acc_skew': 85.466, 'best_valid_valid/acc_align': 88.717, 'best_valid_test/acc': 86.498, 'best_valid_test/acc_unbiased': 86.571, 'best_valid_test/diff': 4.149, 'best_valid_test/acc_skew': 84.496, 'best_valid_test/acc_align': 88.645}
[16 / 20] best test accuracy: 86.571 at epoch 12 
 best_stats: {'best_test_epoch': 12, 'best_test_valid/acc': 86.878, 'best_test_valid/acc_unbiased': 87.091, 'best_test_valid/diff': 3.251, 'best_test_valid/acc_skew': 85.466, 'best_test_valid/acc_align': 88.717, 'best_test_test/acc': 86.498, 'best_test_test/acc_unbiased': 86.571, 'best_test_test/diff': 4.149, 'best_test_test/acc_skew': 84.496, 'best_test_test/acc_align': 88.645}
[17 / 20] Learning rate: 1e-05 weight: 0.01
[17 / 20] Loss: 4.628080330341836 CE Loss: 0.3091621667277586 Con Loss: 4.624988707406978
[17 / 20] tensor([[0.857, 0.804],
        [0.877, 0.914]]) {'epoch': 17, 'valid/acc': 86.498, 'valid/acc_unbiased': 86.78, 'valid/diff': 2.849, 'valid/acc_skew': 85.355, 'valid/acc_align': 88.204, 'test/acc': 86.16, 'test/acc_unbiased': 86.265, 'test/diff': 4.514, 'test/acc_skew': 84.008, 'test/acc_align': 88.522}
[17 / 20] best valid accuracy: 87.091 at epoch 12 
 best_stats: {'best_valid_epoch': 12, 'best_valid_valid/acc': 86.878, 'best_valid_valid/acc_unbiased': 87.091, 'best_valid_valid/diff': 3.251, 'best_valid_valid/acc_skew': 85.466, 'best_valid_valid/acc_align': 88.717, 'best_valid_test/acc': 86.498, 'best_valid_test/acc_unbiased': 86.571, 'best_valid_test/diff': 4.149, 'best_valid_test/acc_skew': 84.496, 'best_valid_test/acc_align': 88.645}
[17 / 20] best test accuracy: 86.571 at epoch 12 
 best_stats: {'best_test_epoch': 12, 'best_test_valid/acc': 86.878, 'best_test_valid/acc_unbiased': 87.091, 'best_test_valid/diff': 3.251, 'best_test_valid/acc_skew': 85.466, 'best_test_valid/acc_align': 88.717, 'best_test_test/acc': 86.498, 'best_test_test/acc_unbiased': 86.571, 'best_test_test/diff': 4.149, 'best_test_test/acc_skew': 84.496, 'best_test_test/acc_align': 88.645}
[18 / 20] Learning rate: 1e-05 weight: 0.01
[18 / 20] Loss: 4.631595982290467 CE Loss: 0.3119384955783889 Con Loss: 4.628476583416605
[18 / 20] tensor([[0.862, 0.812],
        [0.864, 0.909]]) {'epoch': 18, 'valid/acc': 86.582, 'valid/acc_unbiased': 86.876, 'valid/diff': 2.896, 'valid/acc_skew': 85.428, 'valid/acc_align': 88.323, 'test/acc': 86.16, 'test/acc_unbiased': 86.185, 'test/diff': 4.766, 'test/acc_skew': 83.802, 'test/acc_align': 88.568}
[18 / 20] best valid accuracy: 87.091 at epoch 12 
 best_stats: {'best_valid_epoch': 12, 'best_valid_valid/acc': 86.878, 'best_valid_valid/acc_unbiased': 87.091, 'best_valid_valid/diff': 3.251, 'best_valid_valid/acc_skew': 85.466, 'best_valid_valid/acc_align': 88.717, 'best_valid_test/acc': 86.498, 'best_valid_test/acc_unbiased': 86.571, 'best_valid_test/diff': 4.149, 'best_valid_test/acc_skew': 84.496, 'best_valid_test/acc_align': 88.645}
[18 / 20] best test accuracy: 86.571 at epoch 12 
 best_stats: {'best_test_epoch': 12, 'best_test_valid/acc': 86.878, 'best_test_valid/acc_unbiased': 87.091, 'best_test_valid/diff': 3.251, 'best_test_valid/acc_skew': 85.466, 'best_test_valid/acc_align': 88.717, 'best_test_test/acc': 86.498, 'best_test_test/acc_unbiased': 86.571, 'best_test_test/diff': 4.149, 'best_test_test/acc_skew': 84.496, 'best_test_test/acc_align': 88.645}
[19 / 20] Learning rate: 1e-05 weight: 0.01
[19 / 20] Loss: 4.6294692480721205 CE Loss: 0.3060665691317786 Con Loss: 4.626408565794915
[19 / 20] tensor([[0.866, 0.814],
        [0.855, 0.909]]) {'epoch': 19, 'valid/acc': 86.835, 'valid/acc_unbiased': 87.121, 'valid/diff': 2.145, 'valid/acc_skew': 86.049, 'valid/acc_align': 88.194, 'test/acc': 86.118, 'test/acc_unbiased': 86.095, 'test/diff': 5.304, 'test/acc_skew': 83.443, 'test/acc_align': 88.748}
[19 / 20] best valid accuracy: 87.121 at epoch 19 
 best_stats: {'best_valid_epoch': 19, 'best_valid_valid/acc': 86.835, 'best_valid_valid/acc_unbiased': 87.121, 'best_valid_valid/diff': 2.145, 'best_valid_valid/acc_skew': 86.049, 'best_valid_valid/acc_align': 88.194, 'best_valid_test/acc': 86.118, 'best_valid_test/acc_unbiased': 86.095, 'best_valid_test/diff': 5.304, 'best_valid_test/acc_skew': 83.443, 'best_valid_test/acc_align': 88.748}
[19 / 20] best test accuracy: 86.571 at epoch 12 
 best_stats: {'best_test_epoch': 12, 'best_test_valid/acc': 86.878, 'best_test_valid/acc_unbiased': 87.091, 'best_test_valid/diff': 3.251, 'best_test_valid/acc_skew': 85.466, 'best_test_valid/acc_align': 88.717, 'best_test_test/acc': 86.498, 'best_test_test/acc_unbiased': 86.571, 'best_test_test/diff': 4.149, 'best_test_test/acc_skew': 84.496, 'best_test_test/acc_align': 88.645}
[20 / 20] Learning rate: 1e-05 weight: 0.01
[20 / 20] Loss: 4.629524901182027 CE Loss: 0.30287633668276787 Con Loss: 4.6264961425591355
[20 / 20] tensor([[0.858, 0.801],
        [0.866, 0.912]]) {'epoch': 20, 'valid/acc': 86.624, 'valid/acc_unbiased': 86.928, 'valid/diff': 3.221, 'valid/acc_skew': 85.318, 'valid/acc_align': 88.539, 'test/acc': 85.865, 'test/acc_unbiased': 85.929, 'test/diff': 5.218, 'test/acc_skew': 83.32, 'test/acc_align': 88.538}
[20 / 20] best valid accuracy: 87.121 at epoch 19 
 best_stats: {'best_valid_epoch': 19, 'best_valid_valid/acc': 86.835, 'best_valid_valid/acc_unbiased': 87.121, 'best_valid_valid/diff': 2.145, 'best_valid_valid/acc_skew': 86.049, 'best_valid_valid/acc_align': 88.194, 'best_valid_test/acc': 86.118, 'best_valid_test/acc_unbiased': 86.095, 'best_valid_test/diff': 5.304, 'best_valid_test/acc_skew': 83.443, 'best_valid_test/acc_align': 88.748}
[20 / 20] best test accuracy: 86.571 at epoch 12 
 best_stats: {'best_test_epoch': 12, 'best_test_valid/acc': 86.878, 'best_test_valid/acc_unbiased': 87.091, 'best_test_valid/diff': 3.251, 'best_test_valid/acc_skew': 85.466, 'best_test_valid/acc_align': 88.717, 'best_test_test/acc': 86.498, 'best_test_test/acc_unbiased': 86.571, 'best_test_test/diff': 4.149, 'best_test_test/acc_skew': 84.496, 'best_test_test/acc_align': 88.645}
Total training time: 0:34:13
